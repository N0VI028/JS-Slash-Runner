import*as __WEBPACK_EXTERNAL_MODULE__lib_jszip_min_js_715b4132__ from"../../../../../lib/jszip.min.js";import*as __WEBPACK_EXTERNAL_MODULE__script_js_588e7203__ from"../../../../../script.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_PromptManager_js_3415be00__ from"../../../../../scripts/PromptManager.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_RossAscends_mods_js_224b6398__ from"../../../../../scripts/RossAscends-mods.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_authors_note_js_60883899__ from"../../../../../scripts/authors-note.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_extensions_js_86ff8498__ from"../../../../../scripts/extensions.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_extensions_regex_engine_js_bce0a3be__ from"../../../../../scripts/extensions/regex/engine.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_i18n_js_b4bbac2e__ from"../../../../../scripts/i18n.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_macros_js_3c1c7442__ from"../../../../../scripts/macros.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_openai_js_991751fb__ from"../../../../../scripts/openai.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_popup_js_d782a329__ from"../../../../../scripts/popup.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_power_user_js_8eb57d1d__ from"../../../../../scripts/power-user.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_preset_manager_js_701cca77__ from"../../../../../scripts/preset-manager.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_js_aacea5c1__ from"../../../../../scripts/slash-commands.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_SlashCommand_js_7714abe5__ from"../../../../../scripts/slash-commands/SlashCommand.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_SlashCommandArgument_js_9ae1817d__ from"../../../../../scripts/slash-commands/SlashCommandArgument.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_SlashCommandCommonEnumsProvider_js_56229d14__ from"../../../../../scripts/slash-commands/SlashCommandCommonEnumsProvider.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_SlashCommandEnumValue_js_4a448917__ from"../../../../../scripts/slash-commands/SlashCommandEnumValue.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_SlashCommandParser_js_585e5f4d__ from"../../../../../scripts/slash-commands/SlashCommandParser.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_tokenizers_js_ea98bd2a__ from"../../../../../scripts/tokenizers.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_utils_js_ee651b62__ from"../../../../../scripts/utils.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_world_info_js_1b945dbf__ from"../../../../../scripts/world-info.js";import*as __WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_zod_esm_8a34751a__ from"https://testingcf.jsdelivr.net/npm/zod/+esm";var __webpack_modules__={"./node_modules/.pnpm/@socket.io+component-emitter@3.1.2/node_modules/@socket.io/component-emitter/lib/esm/index.js":
/*!**************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@socket.io+component-emitter@3.1.2/node_modules/@socket.io/component-emitter/lib/esm/index.js ***!
  \**************************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Emitter: () => (/* binding */ Emitter)\n/* harmony export */ });\n/**\n * Initialize a new `Emitter`.\n *\n * @api public\n */\n\nfunction Emitter(obj) {\n  if (obj) return mixin(obj);\n}\n\n/**\n * Mixin the emitter properties.\n *\n * @param {Object} obj\n * @return {Object}\n * @api private\n */\n\nfunction mixin(obj) {\n  for (var key in Emitter.prototype) {\n    obj[key] = Emitter.prototype[key];\n  }\n  return obj;\n}\n\n/**\n * Listen on the given `event` with `fn`.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.on =\nEmitter.prototype.addEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n  (this._callbacks['$' + event] = this._callbacks['$' + event] || [])\n    .push(fn);\n  return this;\n};\n\n/**\n * Adds an `event` listener that will be invoked a single\n * time then automatically removed.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.once = function(event, fn){\n  function on() {\n    this.off(event, on);\n    fn.apply(this, arguments);\n  }\n\n  on.fn = fn;\n  this.on(event, on);\n  return this;\n};\n\n/**\n * Remove the given callback for `event` or all\n * registered callbacks.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.off =\nEmitter.prototype.removeListener =\nEmitter.prototype.removeAllListeners =\nEmitter.prototype.removeEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n\n  // all\n  if (0 == arguments.length) {\n    this._callbacks = {};\n    return this;\n  }\n\n  // specific event\n  var callbacks = this._callbacks['$' + event];\n  if (!callbacks) return this;\n\n  // remove all handlers\n  if (1 == arguments.length) {\n    delete this._callbacks['$' + event];\n    return this;\n  }\n\n  // remove specific handler\n  var cb;\n  for (var i = 0; i < callbacks.length; i++) {\n    cb = callbacks[i];\n    if (cb === fn || cb.fn === fn) {\n      callbacks.splice(i, 1);\n      break;\n    }\n  }\n\n  // Remove event specific arrays for event types that no\n  // one is subscribed for to avoid memory leak.\n  if (callbacks.length === 0) {\n    delete this._callbacks['$' + event];\n  }\n\n  return this;\n};\n\n/**\n * Emit `event` with the given args.\n *\n * @param {String} event\n * @param {Mixed} ...\n * @return {Emitter}\n */\n\nEmitter.prototype.emit = function(event){\n  this._callbacks = this._callbacks || {};\n\n  var args = new Array(arguments.length - 1)\n    , callbacks = this._callbacks['$' + event];\n\n  for (var i = 1; i < arguments.length; i++) {\n    args[i - 1] = arguments[i];\n  }\n\n  if (callbacks) {\n    callbacks = callbacks.slice(0);\n    for (var i = 0, len = callbacks.length; i < len; ++i) {\n      callbacks[i].apply(this, args);\n    }\n  }\n\n  return this;\n};\n\n// alias used for reserved events (protected method)\nEmitter.prototype.emitReserved = Emitter.prototype.emit;\n\n/**\n * Return array of callbacks for `event`.\n *\n * @param {String} event\n * @return {Array}\n * @api public\n */\n\nEmitter.prototype.listeners = function(event){\n  this._callbacks = this._callbacks || {};\n  return this._callbacks['$' + event] || [];\n};\n\n/**\n * Check if this emitter has `event` handlers.\n *\n * @param {String} event\n * @return {Boolean}\n * @api public\n */\n\nEmitter.prototype.hasListeners = function(event){\n  return !! this.listeners(event).length;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vQHNvY2tldC5pbytjb21wb25lbnQtZW1pdHRlckAzLjEuMi9ub2RlX21vZHVsZXMvQHNvY2tldC5pby9jb21wb25lbnQtZW1pdHRlci9saWIvZXNtL2luZGV4LmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVPO0FBQ1A7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFFBQVE7QUFDbkIsWUFBWTtBQUNaO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsUUFBUTtBQUNuQixXQUFXLFVBQVU7QUFDckIsWUFBWTtBQUNaO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFFBQVE7QUFDbkIsV0FBVyxVQUFVO0FBQ3JCLFlBQVk7QUFDWjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFFBQVE7QUFDbkIsV0FBVyxVQUFVO0FBQ3JCLFlBQVk7QUFDWjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esa0JBQWtCLHNCQUFzQjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsUUFBUTtBQUNuQixXQUFXLE9BQU87QUFDbEIsWUFBWTtBQUNaOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSxrQkFBa0Isc0JBQXNCO0FBQ3hDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLDRDQUE0QyxTQUFTO0FBQ3JEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsV0FBVyxRQUFRO0FBQ25CLFlBQVk7QUFDWjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsUUFBUTtBQUNuQixZQUFZO0FBQ1o7QUFDQTs7QUFFQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9ub2RlX21vZHVsZXMvLnBucG0vQHNvY2tldC5pbytjb21wb25lbnQtZW1pdHRlckAzLjEuMi9ub2RlX21vZHVsZXMvQHNvY2tldC5pby9jb21wb25lbnQtZW1pdHRlci9saWIvZXNtL2luZGV4LmpzP2FmNDgiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBJbml0aWFsaXplIGEgbmV3IGBFbWl0dGVyYC5cbiAqXG4gKiBAYXBpIHB1YmxpY1xuICovXG5cbmV4cG9ydCBmdW5jdGlvbiBFbWl0dGVyKG9iaikge1xuICBpZiAob2JqKSByZXR1cm4gbWl4aW4ob2JqKTtcbn1cblxuLyoqXG4gKiBNaXhpbiB0aGUgZW1pdHRlciBwcm9wZXJ0aWVzLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBvYmpcbiAqIEByZXR1cm4ge09iamVjdH1cbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5cbmZ1bmN0aW9uIG1peGluKG9iaikge1xuICBmb3IgKHZhciBrZXkgaW4gRW1pdHRlci5wcm90b3R5cGUpIHtcbiAgICBvYmpba2V5XSA9IEVtaXR0ZXIucHJvdG90eXBlW2tleV07XG4gIH1cbiAgcmV0dXJuIG9iajtcbn1cblxuLyoqXG4gKiBMaXN0ZW4gb24gdGhlIGdpdmVuIGBldmVudGAgd2l0aCBgZm5gLlxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBldmVudFxuICogQHBhcmFtIHtGdW5jdGlvbn0gZm5cbiAqIEByZXR1cm4ge0VtaXR0ZXJ9XG4gKiBAYXBpIHB1YmxpY1xuICovXG5cbkVtaXR0ZXIucHJvdG90eXBlLm9uID1cbkVtaXR0ZXIucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbihldmVudCwgZm4pe1xuICB0aGlzLl9jYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3MgfHwge307XG4gICh0aGlzLl9jYWxsYmFja3NbJyQnICsgZXZlbnRdID0gdGhpcy5fY2FsbGJhY2tzWyckJyArIGV2ZW50XSB8fCBbXSlcbiAgICAucHVzaChmbik7XG4gIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBBZGRzIGFuIGBldmVudGAgbGlzdGVuZXIgdGhhdCB3aWxsIGJlIGludm9rZWQgYSBzaW5nbGVcbiAqIHRpbWUgdGhlbiBhdXRvbWF0aWNhbGx5IHJlbW92ZWQuXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IGV2ZW50XG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmblxuICogQHJldHVybiB7RW1pdHRlcn1cbiAqIEBhcGkgcHVibGljXG4gKi9cblxuRW1pdHRlci5wcm90b3R5cGUub25jZSA9IGZ1bmN0aW9uKGV2ZW50LCBmbil7XG4gIGZ1bmN0aW9uIG9uKCkge1xuICAgIHRoaXMub2ZmKGV2ZW50LCBvbik7XG4gICAgZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfVxuXG4gIG9uLmZuID0gZm47XG4gIHRoaXMub24oZXZlbnQsIG9uKTtcbiAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIFJlbW92ZSB0aGUgZ2l2ZW4gY2FsbGJhY2sgZm9yIGBldmVudGAgb3IgYWxsXG4gKiByZWdpc3RlcmVkIGNhbGxiYWNrcy5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gZXZlbnRcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGZuXG4gKiBAcmV0dXJuIHtFbWl0dGVyfVxuICogQGFwaSBwdWJsaWNcbiAqL1xuXG5FbWl0dGVyLnByb3RvdHlwZS5vZmYgPVxuRW1pdHRlci5wcm90b3R5cGUucmVtb3ZlTGlzdGVuZXIgPVxuRW1pdHRlci5wcm90b3R5cGUucmVtb3ZlQWxsTGlzdGVuZXJzID1cbkVtaXR0ZXIucHJvdG90eXBlLnJlbW92ZUV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbihldmVudCwgZm4pe1xuICB0aGlzLl9jYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3MgfHwge307XG5cbiAgLy8gYWxsXG4gIGlmICgwID09IGFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICB0aGlzLl9jYWxsYmFja3MgPSB7fTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8vIHNwZWNpZmljIGV2ZW50XG4gIHZhciBjYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3NbJyQnICsgZXZlbnRdO1xuICBpZiAoIWNhbGxiYWNrcykgcmV0dXJuIHRoaXM7XG5cbiAgLy8gcmVtb3ZlIGFsbCBoYW5kbGVyc1xuICBpZiAoMSA9PSBhcmd1bWVudHMubGVuZ3RoKSB7XG4gICAgZGVsZXRlIHRoaXMuX2NhbGxiYWNrc1snJCcgKyBldmVudF07XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvLyByZW1vdmUgc3BlY2lmaWMgaGFuZGxlclxuICB2YXIgY2I7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgY2FsbGJhY2tzLmxlbmd0aDsgaSsrKSB7XG4gICAgY2IgPSBjYWxsYmFja3NbaV07XG4gICAgaWYgKGNiID09PSBmbiB8fCBjYi5mbiA9PT0gZm4pIHtcbiAgICAgIGNhbGxiYWNrcy5zcGxpY2UoaSwgMSk7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICAvLyBSZW1vdmUgZXZlbnQgc3BlY2lmaWMgYXJyYXlzIGZvciBldmVudCB0eXBlcyB0aGF0IG5vXG4gIC8vIG9uZSBpcyBzdWJzY3JpYmVkIGZvciB0byBhdm9pZCBtZW1vcnkgbGVhay5cbiAgaWYgKGNhbGxiYWNrcy5sZW5ndGggPT09IDApIHtcbiAgICBkZWxldGUgdGhpcy5fY2FsbGJhY2tzWyckJyArIGV2ZW50XTtcbiAgfVxuXG4gIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBFbWl0IGBldmVudGAgd2l0aCB0aGUgZ2l2ZW4gYXJncy5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gZXZlbnRcbiAqIEBwYXJhbSB7TWl4ZWR9IC4uLlxuICogQHJldHVybiB7RW1pdHRlcn1cbiAqL1xuXG5FbWl0dGVyLnByb3RvdHlwZS5lbWl0ID0gZnVuY3Rpb24oZXZlbnQpe1xuICB0aGlzLl9jYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3MgfHwge307XG5cbiAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aCAtIDEpXG4gICAgLCBjYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3NbJyQnICsgZXZlbnRdO1xuXG4gIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgYXJnc1tpIC0gMV0gPSBhcmd1bWVudHNbaV07XG4gIH1cblxuICBpZiAoY2FsbGJhY2tzKSB7XG4gICAgY2FsbGJhY2tzID0gY2FsbGJhY2tzLnNsaWNlKDApO1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBjYWxsYmFja3MubGVuZ3RoOyBpIDwgbGVuOyArK2kpIHtcbiAgICAgIGNhbGxiYWNrc1tpXS5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdGhpcztcbn07XG5cbi8vIGFsaWFzIHVzZWQgZm9yIHJlc2VydmVkIGV2ZW50cyAocHJvdGVjdGVkIG1ldGhvZClcbkVtaXR0ZXIucHJvdG90eXBlLmVtaXRSZXNlcnZlZCA9IEVtaXR0ZXIucHJvdG90eXBlLmVtaXQ7XG5cbi8qKlxuICogUmV0dXJuIGFycmF5IG9mIGNhbGxiYWNrcyBmb3IgYGV2ZW50YC5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gZXZlbnRcbiAqIEByZXR1cm4ge0FycmF5fVxuICogQGFwaSBwdWJsaWNcbiAqL1xuXG5FbWl0dGVyLnByb3RvdHlwZS5saXN0ZW5lcnMgPSBmdW5jdGlvbihldmVudCl7XG4gIHRoaXMuX2NhbGxiYWNrcyA9IHRoaXMuX2NhbGxiYWNrcyB8fCB7fTtcbiAgcmV0dXJuIHRoaXMuX2NhbGxiYWNrc1snJCcgKyBldmVudF0gfHwgW107XG59O1xuXG4vKipcbiAqIENoZWNrIGlmIHRoaXMgZW1pdHRlciBoYXMgYGV2ZW50YCBoYW5kbGVycy5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gZXZlbnRcbiAqIEByZXR1cm4ge0Jvb2xlYW59XG4gKiBAYXBpIHB1YmxpY1xuICovXG5cbkVtaXR0ZXIucHJvdG90eXBlLmhhc0xpc3RlbmVycyA9IGZ1bmN0aW9uKGV2ZW50KXtcbiAgcmV0dXJuICEhIHRoaXMubGlzdGVuZXJzKGV2ZW50KS5sZW5ndGg7XG59O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/@socket.io+component-emitter@3.1.2/node_modules/@socket.io/component-emitter/lib/esm/index.js\n\n}")},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/has-cors.js":
/*!***************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/has-cors.js ***!
  \***************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   hasCORS: () => (/* binding */ hasCORS)\n/* harmony export */ });\n// imported from https://github.com/component/has-cors\nlet value = false;\ntry {\n    value = typeof XMLHttpRequest !== 'undefined' &&\n        'withCredentials' in new XMLHttpRequest();\n}\ncatch (err) {\n    // if XMLHttp support is disabled in IE then it will throw\n    // when trying to create\n}\nconst hasCORS = value;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vY29udHJpYi9oYXMtY29ycy5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL25vZGVfbW9kdWxlcy8ucG5wbS9lbmdpbmUuaW8tY2xpZW50QDYuNi4zL25vZGVfbW9kdWxlcy9lbmdpbmUuaW8tY2xpZW50L2J1aWxkL2VzbS9jb250cmliL2hhcy1jb3JzLmpzP2FmOGYiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gaW1wb3J0ZWQgZnJvbSBodHRwczovL2dpdGh1Yi5jb20vY29tcG9uZW50L2hhcy1jb3JzXG5sZXQgdmFsdWUgPSBmYWxzZTtcbnRyeSB7XG4gICAgdmFsdWUgPSB0eXBlb2YgWE1MSHR0cFJlcXVlc3QgIT09ICd1bmRlZmluZWQnICYmXG4gICAgICAgICd3aXRoQ3JlZGVudGlhbHMnIGluIG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xufVxuY2F0Y2ggKGVycikge1xuICAgIC8vIGlmIFhNTEh0dHAgc3VwcG9ydCBpcyBkaXNhYmxlZCBpbiBJRSB0aGVuIGl0IHdpbGwgdGhyb3dcbiAgICAvLyB3aGVuIHRyeWluZyB0byBjcmVhdGVcbn1cbmV4cG9ydCBjb25zdCBoYXNDT1JTID0gdmFsdWU7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/has-cors.js\n\n}")},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/parseqs.js":
/*!**************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/parseqs.js ***!
  \**************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   decode: () => (/* binding */ decode),\n/* harmony export */   encode: () => (/* binding */ encode)\n/* harmony export */ });\n// imported from https://github.com/galkn/querystring\n/**\n * Compiles a querystring\n * Returns string representation of the object\n *\n * @param {Object}\n * @api private\n */\nfunction encode(obj) {\n    let str = '';\n    for (let i in obj) {\n        if (obj.hasOwnProperty(i)) {\n            if (str.length)\n                str += '&';\n            str += encodeURIComponent(i) + '=' + encodeURIComponent(obj[i]);\n        }\n    }\n    return str;\n}\n/**\n * Parses a simple querystring into an object\n *\n * @param {String} qs\n * @api private\n */\nfunction decode(qs) {\n    let qry = {};\n    let pairs = qs.split('&');\n    for (let i = 0, l = pairs.length; i < l; i++) {\n        let pair = pairs[i].split('=');\n        qry[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);\n    }\n    return qry;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vY29udHJpYi9wYXJzZXFzLmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsUUFBUTtBQUNuQjtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0Esc0NBQXNDLE9BQU87QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL25vZGVfbW9kdWxlcy8ucG5wbS9lbmdpbmUuaW8tY2xpZW50QDYuNi4zL25vZGVfbW9kdWxlcy9lbmdpbmUuaW8tY2xpZW50L2J1aWxkL2VzbS9jb250cmliL3BhcnNlcXMuanM/YzBmMCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBpbXBvcnRlZCBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9nYWxrbi9xdWVyeXN0cmluZ1xuLyoqXG4gKiBDb21waWxlcyBhIHF1ZXJ5c3RyaW5nXG4gKiBSZXR1cm5zIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgb2JqZWN0XG4gKlxuICogQHBhcmFtIHtPYmplY3R9XG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGVuY29kZShvYmopIHtcbiAgICBsZXQgc3RyID0gJyc7XG4gICAgZm9yIChsZXQgaSBpbiBvYmopIHtcbiAgICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShpKSkge1xuICAgICAgICAgICAgaWYgKHN0ci5sZW5ndGgpXG4gICAgICAgICAgICAgICAgc3RyICs9ICcmJztcbiAgICAgICAgICAgIHN0ciArPSBlbmNvZGVVUklDb21wb25lbnQoaSkgKyAnPScgKyBlbmNvZGVVUklDb21wb25lbnQob2JqW2ldKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gc3RyO1xufVxuLyoqXG4gKiBQYXJzZXMgYSBzaW1wbGUgcXVlcnlzdHJpbmcgaW50byBhbiBvYmplY3RcbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gcXNcbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5leHBvcnQgZnVuY3Rpb24gZGVjb2RlKHFzKSB7XG4gICAgbGV0IHFyeSA9IHt9O1xuICAgIGxldCBwYWlycyA9IHFzLnNwbGl0KCcmJyk7XG4gICAgZm9yIChsZXQgaSA9IDAsIGwgPSBwYWlycy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgbGV0IHBhaXIgPSBwYWlyc1tpXS5zcGxpdCgnPScpO1xuICAgICAgICBxcnlbZGVjb2RlVVJJQ29tcG9uZW50KHBhaXJbMF0pXSA9IGRlY29kZVVSSUNvbXBvbmVudChwYWlyWzFdKTtcbiAgICB9XG4gICAgcmV0dXJuIHFyeTtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/parseqs.js\n\n}")},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/parseuri.js":
/*!***************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/parseuri.js ***!
  \***************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   parse: () => (/* binding */ parse)\n/* harmony export */ });\n// imported from https://github.com/galkn/parseuri\n/**\n * Parses a URI\n *\n * Note: we could also have used the built-in URL object, but it isn't supported on all platforms.\n *\n * See:\n * - https://developer.mozilla.org/en-US/docs/Web/API/URL\n * - https://caniuse.com/url\n * - https://www.rfc-editor.org/rfc/rfc3986#appendix-B\n *\n * History of the parse() method:\n * - first commit: https://github.com/socketio/socket.io-client/commit/4ee1d5d94b3906a9c052b459f1a818b15f38f91c\n * - export into its own module: https://github.com/socketio/engine.io-client/commit/de2c561e4564efeb78f1bdb1ba39ef81b2822cb3\n * - reimport: https://github.com/socketio/engine.io-client/commit/df32277c3f6d622eec5ed09f493cae3f3391d242\n *\n * @author Steven Levithan <stevenlevithan.com> (MIT license)\n * @api private\n */\nconst re = /^(?:(?![^:@\\/?#]+:[^:@\\/]*@)(http|https|ws|wss):\\/\\/)?((?:(([^:@\\/?#]*)(?::([^:@\\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/;\nconst parts = [\n    'source', 'protocol', 'authority', 'userInfo', 'user', 'password', 'host', 'port', 'relative', 'path', 'directory', 'file', 'query', 'anchor'\n];\nfunction parse(str) {\n    if (str.length > 8000) {\n        throw \"URI too long\";\n    }\n    const src = str, b = str.indexOf('['), e = str.indexOf(']');\n    if (b != -1 && e != -1) {\n        str = str.substring(0, b) + str.substring(b, e).replace(/:/g, ';') + str.substring(e, str.length);\n    }\n    let m = re.exec(str || ''), uri = {}, i = 14;\n    while (i--) {\n        uri[parts[i]] = m[i] || '';\n    }\n    if (b != -1 && e != -1) {\n        uri.source = src;\n        uri.host = uri.host.substring(1, uri.host.length - 1).replace(/;/g, ':');\n        uri.authority = uri.authority.replace('[', '').replace(']', '').replace(/;/g, ':');\n        uri.ipv6uri = true;\n    }\n    uri.pathNames = pathNames(uri, uri['path']);\n    uri.queryKey = queryKey(uri, uri['query']);\n    return uri;\n}\nfunction pathNames(obj, path) {\n    const regx = /\\/{2,9}/g, names = path.replace(regx, \"/\").split(\"/\");\n    if (path.slice(0, 1) == '/' || path.length === 0) {\n        names.splice(0, 1);\n    }\n    if (path.slice(-1) == '/') {\n        names.splice(names.length - 1, 1);\n    }\n    return names;\n}\nfunction queryKey(uri, query) {\n    const data = {};\n    query.replace(/(?:^|&)([^&=]*)=?([^&]*)/g, function ($0, $1, $2) {\n        if ($1) {\n            data[$1] = $2;\n        }\n    });\n    return data;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vY29udHJpYi9wYXJzZXVyaS5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1SEFBdUgsSUFBSSxHQUFHLElBQUksU0FBUyxJQUFJO0FBQy9JO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdFQUF3RTtBQUN4RTtBQUNBLHdDQUF3QztBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0VBQXdFO0FBQ3hFLGtGQUFrRjtBQUNsRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQixJQUFJO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL25vZGVfbW9kdWxlcy8ucG5wbS9lbmdpbmUuaW8tY2xpZW50QDYuNi4zL25vZGVfbW9kdWxlcy9lbmdpbmUuaW8tY2xpZW50L2J1aWxkL2VzbS9jb250cmliL3BhcnNldXJpLmpzPzdiNDkiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gaW1wb3J0ZWQgZnJvbSBodHRwczovL2dpdGh1Yi5jb20vZ2Fsa24vcGFyc2V1cmlcbi8qKlxuICogUGFyc2VzIGEgVVJJXG4gKlxuICogTm90ZTogd2UgY291bGQgYWxzbyBoYXZlIHVzZWQgdGhlIGJ1aWx0LWluIFVSTCBvYmplY3QsIGJ1dCBpdCBpc24ndCBzdXBwb3J0ZWQgb24gYWxsIHBsYXRmb3Jtcy5cbiAqXG4gKiBTZWU6XG4gKiAtIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9VUkxcbiAqIC0gaHR0cHM6Ly9jYW5pdXNlLmNvbS91cmxcbiAqIC0gaHR0cHM6Ly93d3cucmZjLWVkaXRvci5vcmcvcmZjL3JmYzM5ODYjYXBwZW5kaXgtQlxuICpcbiAqIEhpc3Rvcnkgb2YgdGhlIHBhcnNlKCkgbWV0aG9kOlxuICogLSBmaXJzdCBjb21taXQ6IGh0dHBzOi8vZ2l0aHViLmNvbS9zb2NrZXRpby9zb2NrZXQuaW8tY2xpZW50L2NvbW1pdC80ZWUxZDVkOTRiMzkwNmE5YzA1MmI0NTlmMWE4MThiMTVmMzhmOTFjXG4gKiAtIGV4cG9ydCBpbnRvIGl0cyBvd24gbW9kdWxlOiBodHRwczovL2dpdGh1Yi5jb20vc29ja2V0aW8vZW5naW5lLmlvLWNsaWVudC9jb21taXQvZGUyYzU2MWU0NTY0ZWZlYjc4ZjFiZGIxYmEzOWVmODFiMjgyMmNiM1xuICogLSByZWltcG9ydDogaHR0cHM6Ly9naXRodWIuY29tL3NvY2tldGlvL2VuZ2luZS5pby1jbGllbnQvY29tbWl0L2RmMzIyNzdjM2Y2ZDYyMmVlYzVlZDA5ZjQ5M2NhZTNmMzM5MWQyNDJcbiAqXG4gKiBAYXV0aG9yIFN0ZXZlbiBMZXZpdGhhbiA8c3RldmVubGV2aXRoYW4uY29tPiAoTUlUIGxpY2Vuc2UpXG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuY29uc3QgcmUgPSAvXig/Oig/IVteOkBcXC8/I10rOlteOkBcXC9dKkApKGh0dHB8aHR0cHN8d3N8d3NzKTpcXC9cXC8pPygoPzooKFteOkBcXC8/I10qKSg/OjooW146QFxcLz8jXSopKT8pP0ApPygoPzpbYS1mMC05XXswLDR9Oil7Miw3fVthLWYwLTldezAsNH18W146XFwvPyNdKikoPzo6KFxcZCopKT8pKCgoXFwvKD86W14/I10oPyFbXj8jXFwvXSpcXC5bXj8jXFwvLl0rKD86Wz8jXXwkKSkpKlxcLz8pPyhbXj8jXFwvXSopKSg/OlxcPyhbXiNdKikpPyg/OiMoLiopKT8pLztcbmNvbnN0IHBhcnRzID0gW1xuICAgICdzb3VyY2UnLCAncHJvdG9jb2wnLCAnYXV0aG9yaXR5JywgJ3VzZXJJbmZvJywgJ3VzZXInLCAncGFzc3dvcmQnLCAnaG9zdCcsICdwb3J0JywgJ3JlbGF0aXZlJywgJ3BhdGgnLCAnZGlyZWN0b3J5JywgJ2ZpbGUnLCAncXVlcnknLCAnYW5jaG9yJ1xuXTtcbmV4cG9ydCBmdW5jdGlvbiBwYXJzZShzdHIpIHtcbiAgICBpZiAoc3RyLmxlbmd0aCA+IDgwMDApIHtcbiAgICAgICAgdGhyb3cgXCJVUkkgdG9vIGxvbmdcIjtcbiAgICB9XG4gICAgY29uc3Qgc3JjID0gc3RyLCBiID0gc3RyLmluZGV4T2YoJ1snKSwgZSA9IHN0ci5pbmRleE9mKCddJyk7XG4gICAgaWYgKGIgIT0gLTEgJiYgZSAhPSAtMSkge1xuICAgICAgICBzdHIgPSBzdHIuc3Vic3RyaW5nKDAsIGIpICsgc3RyLnN1YnN0cmluZyhiLCBlKS5yZXBsYWNlKC86L2csICc7JykgKyBzdHIuc3Vic3RyaW5nKGUsIHN0ci5sZW5ndGgpO1xuICAgIH1cbiAgICBsZXQgbSA9IHJlLmV4ZWMoc3RyIHx8ICcnKSwgdXJpID0ge30sIGkgPSAxNDtcbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIHVyaVtwYXJ0c1tpXV0gPSBtW2ldIHx8ICcnO1xuICAgIH1cbiAgICBpZiAoYiAhPSAtMSAmJiBlICE9IC0xKSB7XG4gICAgICAgIHVyaS5zb3VyY2UgPSBzcmM7XG4gICAgICAgIHVyaS5ob3N0ID0gdXJpLmhvc3Quc3Vic3RyaW5nKDEsIHVyaS5ob3N0Lmxlbmd0aCAtIDEpLnJlcGxhY2UoLzsvZywgJzonKTtcbiAgICAgICAgdXJpLmF1dGhvcml0eSA9IHVyaS5hdXRob3JpdHkucmVwbGFjZSgnWycsICcnKS5yZXBsYWNlKCddJywgJycpLnJlcGxhY2UoLzsvZywgJzonKTtcbiAgICAgICAgdXJpLmlwdjZ1cmkgPSB0cnVlO1xuICAgIH1cbiAgICB1cmkucGF0aE5hbWVzID0gcGF0aE5hbWVzKHVyaSwgdXJpWydwYXRoJ10pO1xuICAgIHVyaS5xdWVyeUtleSA9IHF1ZXJ5S2V5KHVyaSwgdXJpWydxdWVyeSddKTtcbiAgICByZXR1cm4gdXJpO1xufVxuZnVuY3Rpb24gcGF0aE5hbWVzKG9iaiwgcGF0aCkge1xuICAgIGNvbnN0IHJlZ3ggPSAvXFwvezIsOX0vZywgbmFtZXMgPSBwYXRoLnJlcGxhY2UocmVneCwgXCIvXCIpLnNwbGl0KFwiL1wiKTtcbiAgICBpZiAocGF0aC5zbGljZSgwLCAxKSA9PSAnLycgfHwgcGF0aC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgbmFtZXMuc3BsaWNlKDAsIDEpO1xuICAgIH1cbiAgICBpZiAocGF0aC5zbGljZSgtMSkgPT0gJy8nKSB7XG4gICAgICAgIG5hbWVzLnNwbGljZShuYW1lcy5sZW5ndGggLSAxLCAxKTtcbiAgICB9XG4gICAgcmV0dXJuIG5hbWVzO1xufVxuZnVuY3Rpb24gcXVlcnlLZXkodXJpLCBxdWVyeSkge1xuICAgIGNvbnN0IGRhdGEgPSB7fTtcbiAgICBxdWVyeS5yZXBsYWNlKC8oPzpefCYpKFteJj1dKik9PyhbXiZdKikvZywgZnVuY3Rpb24gKCQwLCAkMSwgJDIpIHtcbiAgICAgICAgaWYgKCQxKSB7XG4gICAgICAgICAgICBkYXRhWyQxXSA9ICQyO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIGRhdGE7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/parseuri.js\n\n}")},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/globals.js":
/*!******************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/globals.js ***!
  \******************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createCookieJar: () => (/* binding */ createCookieJar),\n/* harmony export */   defaultBinaryType: () => (/* binding */ defaultBinaryType),\n/* harmony export */   globalThisShim: () => (/* binding */ globalThisShim),\n/* harmony export */   nextTick: () => (/* binding */ nextTick)\n/* harmony export */ });\nconst nextTick = (() => {\n    const isPromiseAvailable = typeof Promise === "function" && typeof Promise.resolve === "function";\n    if (isPromiseAvailable) {\n        return (cb) => Promise.resolve().then(cb);\n    }\n    else {\n        return (cb, setTimeoutFn) => setTimeoutFn(cb, 0);\n    }\n})();\nconst globalThisShim = (() => {\n    if (typeof self !== "undefined") {\n        return self;\n    }\n    else if (typeof window !== "undefined") {\n        return window;\n    }\n    else {\n        return Function("return this")();\n    }\n})();\nconst defaultBinaryType = "arraybuffer";\nfunction createCookieJar() { }\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vZ2xvYmFscy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDTTtBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDTTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2VuZ2luZS5pby1jbGllbnRANi42LjMvbm9kZV9tb2R1bGVzL2VuZ2luZS5pby1jbGllbnQvYnVpbGQvZXNtL2dsb2JhbHMuanM/N2I5NyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgbmV4dFRpY2sgPSAoKCkgPT4ge1xuICAgIGNvbnN0IGlzUHJvbWlzZUF2YWlsYWJsZSA9IHR5cGVvZiBQcm9taXNlID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFByb21pc2UucmVzb2x2ZSA9PT0gXCJmdW5jdGlvblwiO1xuICAgIGlmIChpc1Byb21pc2VBdmFpbGFibGUpIHtcbiAgICAgICAgcmV0dXJuIChjYikgPT4gUHJvbWlzZS5yZXNvbHZlKCkudGhlbihjYik7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gKGNiLCBzZXRUaW1lb3V0Rm4pID0+IHNldFRpbWVvdXRGbihjYiwgMCk7XG4gICAgfVxufSkoKTtcbmV4cG9ydCBjb25zdCBnbG9iYWxUaGlzU2hpbSA9ICgoKSA9PiB7XG4gICAgaWYgKHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgIHJldHVybiBzZWxmO1xuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgIHJldHVybiB3aW5kb3c7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gRnVuY3Rpb24oXCJyZXR1cm4gdGhpc1wiKSgpO1xuICAgIH1cbn0pKCk7XG5leHBvcnQgY29uc3QgZGVmYXVsdEJpbmFyeVR5cGUgPSBcImFycmF5YnVmZmVyXCI7XG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQ29va2llSmFyKCkgeyB9XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/globals.js\n\n}')},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/index.js":
/*!****************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/index.js ***!
  \****************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Fetch: () => (/* reexport safe */ _transports_polling_fetch_js__WEBPACK_IMPORTED_MODULE_6__.Fetch),\n/* harmony export */   NodeWebSocket: () => (/* reexport safe */ _transports_websocket_node_js__WEBPACK_IMPORTED_MODULE_8__.WS),\n/* harmony export */   NodeXHR: () => (/* reexport safe */ _transports_polling_xhr_node_js__WEBPACK_IMPORTED_MODULE_7__.XHR),\n/* harmony export */   Socket: () => (/* reexport safe */ _socket_js__WEBPACK_IMPORTED_MODULE_0__.Socket),\n/* harmony export */   SocketWithUpgrade: () => (/* reexport safe */ _socket_js__WEBPACK_IMPORTED_MODULE_0__.SocketWithUpgrade),\n/* harmony export */   SocketWithoutUpgrade: () => (/* reexport safe */ _socket_js__WEBPACK_IMPORTED_MODULE_0__.SocketWithoutUpgrade),\n/* harmony export */   Transport: () => (/* reexport safe */ _transport_js__WEBPACK_IMPORTED_MODULE_1__.Transport),\n/* harmony export */   TransportError: () => (/* reexport safe */ _transport_js__WEBPACK_IMPORTED_MODULE_1__.TransportError),\n/* harmony export */   WebSocket: () => (/* reexport safe */ _transports_websocket_node_js__WEBPACK_IMPORTED_MODULE_8__.WS),\n/* harmony export */   WebTransport: () => (/* reexport safe */ _transports_webtransport_js__WEBPACK_IMPORTED_MODULE_9__.WT),\n/* harmony export */   XHR: () => (/* reexport safe */ _transports_polling_xhr_node_js__WEBPACK_IMPORTED_MODULE_7__.XHR),\n/* harmony export */   installTimerFunctions: () => (/* reexport safe */ _util_js__WEBPACK_IMPORTED_MODULE_3__.installTimerFunctions),\n/* harmony export */   nextTick: () => (/* reexport safe */ _globals_node_js__WEBPACK_IMPORTED_MODULE_5__.nextTick),\n/* harmony export */   parse: () => (/* reexport safe */ _contrib_parseuri_js__WEBPACK_IMPORTED_MODULE_4__.parse),\n/* harmony export */   protocol: () => (/* binding */ protocol),\n/* harmony export */   transports: () => (/* reexport safe */ _transports_index_js__WEBPACK_IMPORTED_MODULE_2__.transports)\n/* harmony export */ });\n/* harmony import */ var _socket_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./socket.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/socket.js");\n/* harmony import */ var _transport_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./transport.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transport.js");\n/* harmony import */ var _transports_index_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./transports/index.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/index.js");\n/* harmony import */ var _util_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./util.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/util.js");\n/* harmony import */ var _contrib_parseuri_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./contrib/parseuri.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/parseuri.js");\n/* harmony import */ var _globals_node_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./globals.node.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/globals.js");\n/* harmony import */ var _transports_polling_fetch_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./transports/polling-fetch.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling-fetch.js");\n/* harmony import */ var _transports_polling_xhr_node_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./transports/polling-xhr.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling-xhr.js");\n/* harmony import */ var _transports_websocket_node_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./transports/websocket.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/websocket.js");\n/* harmony import */ var _transports_webtransport_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./transports/webtransport.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/webtransport.js");\n\n\n\nconst protocol = _socket_js__WEBPACK_IMPORTED_MODULE_0__.Socket.protocol;\n\n\n\n\n\n\n\n\n\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBcUM7QUFDbkI7QUFDcUQ7QUFDaEUsaUJBQWlCLDhDQUFNO0FBQzZCO0FBQ1I7QUFDRDtBQUNKO0FBQ0Q7QUFDUztBQUNZO0FBQ2hCO0FBQ21CO0FBQ1Q7QUFDTSIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL25vZGVfbW9kdWxlcy8ucG5wbS9lbmdpbmUuaW8tY2xpZW50QDYuNi4zL25vZGVfbW9kdWxlcy9lbmdpbmUuaW8tY2xpZW50L2J1aWxkL2VzbS9pbmRleC5qcz8xYzEyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFNvY2tldCB9IGZyb20gXCIuL3NvY2tldC5qc1wiO1xuZXhwb3J0IHsgU29ja2V0IH07XG5leHBvcnQgeyBTb2NrZXRXaXRob3V0VXBncmFkZSwgU29ja2V0V2l0aFVwZ3JhZGUsIH0gZnJvbSBcIi4vc29ja2V0LmpzXCI7XG5leHBvcnQgY29uc3QgcHJvdG9jb2wgPSBTb2NrZXQucHJvdG9jb2w7XG5leHBvcnQgeyBUcmFuc3BvcnQsIFRyYW5zcG9ydEVycm9yIH0gZnJvbSBcIi4vdHJhbnNwb3J0LmpzXCI7XG5leHBvcnQgeyB0cmFuc3BvcnRzIH0gZnJvbSBcIi4vdHJhbnNwb3J0cy9pbmRleC5qc1wiO1xuZXhwb3J0IHsgaW5zdGFsbFRpbWVyRnVuY3Rpb25zIH0gZnJvbSBcIi4vdXRpbC5qc1wiO1xuZXhwb3J0IHsgcGFyc2UgfSBmcm9tIFwiLi9jb250cmliL3BhcnNldXJpLmpzXCI7XG5leHBvcnQgeyBuZXh0VGljayB9IGZyb20gXCIuL2dsb2JhbHMubm9kZS5qc1wiO1xuZXhwb3J0IHsgRmV0Y2ggfSBmcm9tIFwiLi90cmFuc3BvcnRzL3BvbGxpbmctZmV0Y2guanNcIjtcbmV4cG9ydCB7IFhIUiBhcyBOb2RlWEhSIH0gZnJvbSBcIi4vdHJhbnNwb3J0cy9wb2xsaW5nLXhoci5ub2RlLmpzXCI7XG5leHBvcnQgeyBYSFIgfSBmcm9tIFwiLi90cmFuc3BvcnRzL3BvbGxpbmcteGhyLmpzXCI7XG5leHBvcnQgeyBXUyBhcyBOb2RlV2ViU29ja2V0IH0gZnJvbSBcIi4vdHJhbnNwb3J0cy93ZWJzb2NrZXQubm9kZS5qc1wiO1xuZXhwb3J0IHsgV1MgYXMgV2ViU29ja2V0IH0gZnJvbSBcIi4vdHJhbnNwb3J0cy93ZWJzb2NrZXQuanNcIjtcbmV4cG9ydCB7IFdUIGFzIFdlYlRyYW5zcG9ydCB9IGZyb20gXCIuL3RyYW5zcG9ydHMvd2VidHJhbnNwb3J0LmpzXCI7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/index.js\n\n}')},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/socket.js":
/*!*****************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/socket.js ***!
  \*****************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Socket: () => (/* binding */ Socket),\n/* harmony export */   SocketWithUpgrade: () => (/* binding */ SocketWithUpgrade),\n/* harmony export */   SocketWithoutUpgrade: () => (/* binding */ SocketWithoutUpgrade)\n/* harmony export */ });\n/* harmony import */ var _transports_index_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./transports/index.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/index.js");\n/* harmony import */ var _util_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./util.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/util.js");\n/* harmony import */ var _contrib_parseqs_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./contrib/parseqs.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/parseqs.js");\n/* harmony import */ var _contrib_parseuri_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./contrib/parseuri.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/parseuri.js");\n/* harmony import */ var _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @socket.io/component-emitter */ "./node_modules/.pnpm/@socket.io+component-emitter@3.1.2/node_modules/@socket.io/component-emitter/lib/esm/index.js");\n/* harmony import */ var engine_io_parser__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! engine.io-parser */ "./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/index.js");\n/* harmony import */ var _globals_node_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./globals.node.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/globals.js");\n\n\n\n\n\n\n\nconst withEventListeners = typeof addEventListener === "function" &&\n    typeof removeEventListener === "function";\nconst OFFLINE_EVENT_LISTENERS = [];\nif (withEventListeners) {\n    // within a ServiceWorker, any event handler for the \'offline\' event must be added on the initial evaluation of the\n    // script, so we create one single event listener here which will forward the event to the socket instances\n    addEventListener("offline", () => {\n        OFFLINE_EVENT_LISTENERS.forEach((listener) => listener());\n    }, false);\n}\n/**\n * This class provides a WebSocket-like interface to connect to an Engine.IO server. The connection will be established\n * with one of the available low-level transports, like HTTP long-polling, WebSocket or WebTransport.\n *\n * This class comes without upgrade mechanism, which means that it will keep the first low-level transport that\n * successfully establishes the connection.\n *\n * In order to allow tree-shaking, there are no transports included, that\'s why the `transports` option is mandatory.\n *\n * @example\n * import { SocketWithoutUpgrade, WebSocket } from "engine.io-client";\n *\n * const socket = new SocketWithoutUpgrade({\n *   transports: [WebSocket]\n * });\n *\n * socket.on("open", () => {\n *   socket.send("hello");\n * });\n *\n * @see SocketWithUpgrade\n * @see Socket\n */\nclass SocketWithoutUpgrade extends _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_4__.Emitter {\n    /**\n     * Socket constructor.\n     *\n     * @param {String|Object} uri - uri or options\n     * @param {Object} opts - options\n     */\n    constructor(uri, opts) {\n        super();\n        this.binaryType = _globals_node_js__WEBPACK_IMPORTED_MODULE_6__.defaultBinaryType;\n        this.writeBuffer = [];\n        this._prevBufferLen = 0;\n        this._pingInterval = -1;\n        this._pingTimeout = -1;\n        this._maxPayload = -1;\n        /**\n         * The expiration timestamp of the {@link _pingTimeoutTimer} object is tracked, in case the timer is throttled and the\n         * callback is not fired on time. This can happen for example when a laptop is suspended or when a phone is locked.\n         */\n        this._pingTimeoutTime = Infinity;\n        if (uri && "object" === typeof uri) {\n            opts = uri;\n            uri = null;\n        }\n        if (uri) {\n            const parsedUri = (0,_contrib_parseuri_js__WEBPACK_IMPORTED_MODULE_3__.parse)(uri);\n            opts.hostname = parsedUri.host;\n            opts.secure =\n                parsedUri.protocol === "https" || parsedUri.protocol === "wss";\n            opts.port = parsedUri.port;\n            if (parsedUri.query)\n                opts.query = parsedUri.query;\n        }\n        else if (opts.host) {\n            opts.hostname = (0,_contrib_parseuri_js__WEBPACK_IMPORTED_MODULE_3__.parse)(opts.host).host;\n        }\n        (0,_util_js__WEBPACK_IMPORTED_MODULE_1__.installTimerFunctions)(this, opts);\n        this.secure =\n            null != opts.secure\n                ? opts.secure\n                : typeof location !== "undefined" && "https:" === location.protocol;\n        if (opts.hostname && !opts.port) {\n            // if no port is specified manually, use the protocol default\n            opts.port = this.secure ? "443" : "80";\n        }\n        this.hostname =\n            opts.hostname ||\n                (typeof location !== "undefined" ? location.hostname : "localhost");\n        this.port =\n            opts.port ||\n                (typeof location !== "undefined" && location.port\n                    ? location.port\n                    : this.secure\n                        ? "443"\n                        : "80");\n        this.transports = [];\n        this._transportsByName = {};\n        opts.transports.forEach((t) => {\n            const transportName = t.prototype.name;\n            this.transports.push(transportName);\n            this._transportsByName[transportName] = t;\n        });\n        this.opts = Object.assign({\n            path: "/engine.io",\n            agent: false,\n            withCredentials: false,\n            upgrade: true,\n            timestampParam: "t",\n            rememberUpgrade: false,\n            addTrailingSlash: true,\n            rejectUnauthorized: true,\n            perMessageDeflate: {\n                threshold: 1024,\n            },\n            transportOptions: {},\n            closeOnBeforeunload: false,\n        }, opts);\n        this.opts.path =\n            this.opts.path.replace(/\\/$/, "") +\n                (this.opts.addTrailingSlash ? "/" : "");\n        if (typeof this.opts.query === "string") {\n            this.opts.query = (0,_contrib_parseqs_js__WEBPACK_IMPORTED_MODULE_2__.decode)(this.opts.query);\n        }\n        if (withEventListeners) {\n            if (this.opts.closeOnBeforeunload) {\n                // Firefox closes the connection when the "beforeunload" event is emitted but not Chrome. This event listener\n                // ensures every browser behaves the same (no "disconnect" event at the Socket.IO level when the page is\n                // closed/reloaded)\n                this._beforeunloadEventListener = () => {\n                    if (this.transport) {\n                        // silently close the transport\n                        this.transport.removeAllListeners();\n                        this.transport.close();\n                    }\n                };\n                addEventListener("beforeunload", this._beforeunloadEventListener, false);\n            }\n            if (this.hostname !== "localhost") {\n                this._offlineEventListener = () => {\n                    this._onClose("transport close", {\n                        description: "network connection lost",\n                    });\n                };\n                OFFLINE_EVENT_LISTENERS.push(this._offlineEventListener);\n            }\n        }\n        if (this.opts.withCredentials) {\n            this._cookieJar = (0,_globals_node_js__WEBPACK_IMPORTED_MODULE_6__.createCookieJar)();\n        }\n        this._open();\n    }\n    /**\n     * Creates transport of the given type.\n     *\n     * @param {String} name - transport name\n     * @return {Transport}\n     * @private\n     */\n    createTransport(name) {\n        const query = Object.assign({}, this.opts.query);\n        // append engine.io protocol identifier\n        query.EIO = engine_io_parser__WEBPACK_IMPORTED_MODULE_5__.protocol;\n        // transport name\n        query.transport = name;\n        // session id if we already have one\n        if (this.id)\n            query.sid = this.id;\n        const opts = Object.assign({}, this.opts, {\n            query,\n            socket: this,\n            hostname: this.hostname,\n            secure: this.secure,\n            port: this.port,\n        }, this.opts.transportOptions[name]);\n        return new this._transportsByName[name](opts);\n    }\n    /**\n     * Initializes transport to use and starts probe.\n     *\n     * @private\n     */\n    _open() {\n        if (this.transports.length === 0) {\n            // Emit error on next tick so it can be listened to\n            this.setTimeoutFn(() => {\n                this.emitReserved("error", "No transports available");\n            }, 0);\n            return;\n        }\n        const transportName = this.opts.rememberUpgrade &&\n            SocketWithoutUpgrade.priorWebsocketSuccess &&\n            this.transports.indexOf("websocket") !== -1\n            ? "websocket"\n            : this.transports[0];\n        this.readyState = "opening";\n        const transport = this.createTransport(transportName);\n        transport.open();\n        this.setTransport(transport);\n    }\n    /**\n     * Sets the current transport. Disables the existing one (if any).\n     *\n     * @private\n     */\n    setTransport(transport) {\n        if (this.transport) {\n            this.transport.removeAllListeners();\n        }\n        // set up transport\n        this.transport = transport;\n        // set up transport listeners\n        transport\n            .on("drain", this._onDrain.bind(this))\n            .on("packet", this._onPacket.bind(this))\n            .on("error", this._onError.bind(this))\n            .on("close", (reason) => this._onClose("transport close", reason));\n    }\n    /**\n     * Called when connection is deemed open.\n     *\n     * @private\n     */\n    onOpen() {\n        this.readyState = "open";\n        SocketWithoutUpgrade.priorWebsocketSuccess =\n            "websocket" === this.transport.name;\n        this.emitReserved("open");\n        this.flush();\n    }\n    /**\n     * Handles a packet.\n     *\n     * @private\n     */\n    _onPacket(packet) {\n        if ("opening" === this.readyState ||\n            "open" === this.readyState ||\n            "closing" === this.readyState) {\n            this.emitReserved("packet", packet);\n            // Socket is live - any packet counts\n            this.emitReserved("heartbeat");\n            switch (packet.type) {\n                case "open":\n                    this.onHandshake(JSON.parse(packet.data));\n                    break;\n                case "ping":\n                    this._sendPacket("pong");\n                    this.emitReserved("ping");\n                    this.emitReserved("pong");\n                    this._resetPingTimeout();\n                    break;\n                case "error":\n                    const err = new Error("server error");\n                    // @ts-ignore\n                    err.code = packet.data;\n                    this._onError(err);\n                    break;\n                case "message":\n                    this.emitReserved("data", packet.data);\n                    this.emitReserved("message", packet.data);\n                    break;\n            }\n        }\n        else {\n        }\n    }\n    /**\n     * Called upon handshake completion.\n     *\n     * @param {Object} data - handshake obj\n     * @private\n     */\n    onHandshake(data) {\n        this.emitReserved("handshake", data);\n        this.id = data.sid;\n        this.transport.query.sid = data.sid;\n        this._pingInterval = data.pingInterval;\n        this._pingTimeout = data.pingTimeout;\n        this._maxPayload = data.maxPayload;\n        this.onOpen();\n        // In case open handler closes socket\n        if ("closed" === this.readyState)\n            return;\n        this._resetPingTimeout();\n    }\n    /**\n     * Sets and resets ping timeout timer based on server pings.\n     *\n     * @private\n     */\n    _resetPingTimeout() {\n        this.clearTimeoutFn(this._pingTimeoutTimer);\n        const delay = this._pingInterval + this._pingTimeout;\n        this._pingTimeoutTime = Date.now() + delay;\n        this._pingTimeoutTimer = this.setTimeoutFn(() => {\n            this._onClose("ping timeout");\n        }, delay);\n        if (this.opts.autoUnref) {\n            this._pingTimeoutTimer.unref();\n        }\n    }\n    /**\n     * Called on `drain` event\n     *\n     * @private\n     */\n    _onDrain() {\n        this.writeBuffer.splice(0, this._prevBufferLen);\n        // setting prevBufferLen = 0 is very important\n        // for example, when upgrading, upgrade packet is sent over,\n        // and a nonzero prevBufferLen could cause problems on `drain`\n        this._prevBufferLen = 0;\n        if (0 === this.writeBuffer.length) {\n            this.emitReserved("drain");\n        }\n        else {\n            this.flush();\n        }\n    }\n    /**\n     * Flush write buffers.\n     *\n     * @private\n     */\n    flush() {\n        if ("closed" !== this.readyState &&\n            this.transport.writable &&\n            !this.upgrading &&\n            this.writeBuffer.length) {\n            const packets = this._getWritablePackets();\n            this.transport.send(packets);\n            // keep track of current length of writeBuffer\n            // splice writeBuffer and callbackBuffer on `drain`\n            this._prevBufferLen = packets.length;\n            this.emitReserved("flush");\n        }\n    }\n    /**\n     * Ensure the encoded size of the writeBuffer is below the maxPayload value sent by the server (only for HTTP\n     * long-polling)\n     *\n     * @private\n     */\n    _getWritablePackets() {\n        const shouldCheckPayloadSize = this._maxPayload &&\n            this.transport.name === "polling" &&\n            this.writeBuffer.length > 1;\n        if (!shouldCheckPayloadSize) {\n            return this.writeBuffer;\n        }\n        let payloadSize = 1; // first packet type\n        for (let i = 0; i < this.writeBuffer.length; i++) {\n            const data = this.writeBuffer[i].data;\n            if (data) {\n                payloadSize += (0,_util_js__WEBPACK_IMPORTED_MODULE_1__.byteLength)(data);\n            }\n            if (i > 0 && payloadSize > this._maxPayload) {\n                return this.writeBuffer.slice(0, i);\n            }\n            payloadSize += 2; // separator + packet type\n        }\n        return this.writeBuffer;\n    }\n    /**\n     * Checks whether the heartbeat timer has expired but the socket has not yet been notified.\n     *\n     * Note: this method is private for now because it does not really fit the WebSocket API, but if we put it in the\n     * `write()` method then the message would not be buffered by the Socket.IO client.\n     *\n     * @return {boolean}\n     * @private\n     */\n    /* private */ _hasPingExpired() {\n        if (!this._pingTimeoutTime)\n            return true;\n        const hasExpired = Date.now() > this._pingTimeoutTime;\n        if (hasExpired) {\n            this._pingTimeoutTime = 0;\n            (0,_globals_node_js__WEBPACK_IMPORTED_MODULE_6__.nextTick)(() => {\n                this._onClose("ping timeout");\n            }, this.setTimeoutFn);\n        }\n        return hasExpired;\n    }\n    /**\n     * Sends a message.\n     *\n     * @param {String} msg - message.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @return {Socket} for chaining.\n     */\n    write(msg, options, fn) {\n        this._sendPacket("message", msg, options, fn);\n        return this;\n    }\n    /**\n     * Sends a message. Alias of {@link Socket#write}.\n     *\n     * @param {String} msg - message.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @return {Socket} for chaining.\n     */\n    send(msg, options, fn) {\n        this._sendPacket("message", msg, options, fn);\n        return this;\n    }\n    /**\n     * Sends a packet.\n     *\n     * @param {String} type: packet type.\n     * @param {String} data.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @private\n     */\n    _sendPacket(type, data, options, fn) {\n        if ("function" === typeof data) {\n            fn = data;\n            data = undefined;\n        }\n        if ("function" === typeof options) {\n            fn = options;\n            options = null;\n        }\n        if ("closing" === this.readyState || "closed" === this.readyState) {\n            return;\n        }\n        options = options || {};\n        options.compress = false !== options.compress;\n        const packet = {\n            type: type,\n            data: data,\n            options: options,\n        };\n        this.emitReserved("packetCreate", packet);\n        this.writeBuffer.push(packet);\n        if (fn)\n            this.once("flush", fn);\n        this.flush();\n    }\n    /**\n     * Closes the connection.\n     */\n    close() {\n        const close = () => {\n            this._onClose("forced close");\n            this.transport.close();\n        };\n        const cleanupAndClose = () => {\n            this.off("upgrade", cleanupAndClose);\n            this.off("upgradeError", cleanupAndClose);\n            close();\n        };\n        const waitForUpgrade = () => {\n            // wait for upgrade to finish since we can\'t send packets while pausing a transport\n            this.once("upgrade", cleanupAndClose);\n            this.once("upgradeError", cleanupAndClose);\n        };\n        if ("opening" === this.readyState || "open" === this.readyState) {\n            this.readyState = "closing";\n            if (this.writeBuffer.length) {\n                this.once("drain", () => {\n                    if (this.upgrading) {\n                        waitForUpgrade();\n                    }\n                    else {\n                        close();\n                    }\n                });\n            }\n            else if (this.upgrading) {\n                waitForUpgrade();\n            }\n            else {\n                close();\n            }\n        }\n        return this;\n    }\n    /**\n     * Called upon transport error\n     *\n     * @private\n     */\n    _onError(err) {\n        SocketWithoutUpgrade.priorWebsocketSuccess = false;\n        if (this.opts.tryAllTransports &&\n            this.transports.length > 1 &&\n            this.readyState === "opening") {\n            this.transports.shift();\n            return this._open();\n        }\n        this.emitReserved("error", err);\n        this._onClose("transport error", err);\n    }\n    /**\n     * Called upon transport close.\n     *\n     * @private\n     */\n    _onClose(reason, description) {\n        if ("opening" === this.readyState ||\n            "open" === this.readyState ||\n            "closing" === this.readyState) {\n            // clear timers\n            this.clearTimeoutFn(this._pingTimeoutTimer);\n            // stop event from firing again for transport\n            this.transport.removeAllListeners("close");\n            // ensure transport won\'t stay open\n            this.transport.close();\n            // ignore further transport communication\n            this.transport.removeAllListeners();\n            if (withEventListeners) {\n                if (this._beforeunloadEventListener) {\n                    removeEventListener("beforeunload", this._beforeunloadEventListener, false);\n                }\n                if (this._offlineEventListener) {\n                    const i = OFFLINE_EVENT_LISTENERS.indexOf(this._offlineEventListener);\n                    if (i !== -1) {\n                        OFFLINE_EVENT_LISTENERS.splice(i, 1);\n                    }\n                }\n            }\n            // set ready state\n            this.readyState = "closed";\n            // clear session id\n            this.id = null;\n            // emit close event\n            this.emitReserved("close", reason, description);\n            // clean buffers after, so users can still\n            // grab the buffers on `close` event\n            this.writeBuffer = [];\n            this._prevBufferLen = 0;\n        }\n    }\n}\nSocketWithoutUpgrade.protocol = engine_io_parser__WEBPACK_IMPORTED_MODULE_5__.protocol;\n/**\n * This class provides a WebSocket-like interface to connect to an Engine.IO server. The connection will be established\n * with one of the available low-level transports, like HTTP long-polling, WebSocket or WebTransport.\n *\n * This class comes with an upgrade mechanism, which means that once the connection is established with the first\n * low-level transport, it will try to upgrade to a better transport.\n *\n * In order to allow tree-shaking, there are no transports included, that\'s why the `transports` option is mandatory.\n *\n * @example\n * import { SocketWithUpgrade, WebSocket } from "engine.io-client";\n *\n * const socket = new SocketWithUpgrade({\n *   transports: [WebSocket]\n * });\n *\n * socket.on("open", () => {\n *   socket.send("hello");\n * });\n *\n * @see SocketWithoutUpgrade\n * @see Socket\n */\nclass SocketWithUpgrade extends SocketWithoutUpgrade {\n    constructor() {\n        super(...arguments);\n        this._upgrades = [];\n    }\n    onOpen() {\n        super.onOpen();\n        if ("open" === this.readyState && this.opts.upgrade) {\n            for (let i = 0; i < this._upgrades.length; i++) {\n                this._probe(this._upgrades[i]);\n            }\n        }\n    }\n    /**\n     * Probes a transport.\n     *\n     * @param {String} name - transport name\n     * @private\n     */\n    _probe(name) {\n        let transport = this.createTransport(name);\n        let failed = false;\n        SocketWithoutUpgrade.priorWebsocketSuccess = false;\n        const onTransportOpen = () => {\n            if (failed)\n                return;\n            transport.send([{ type: "ping", data: "probe" }]);\n            transport.once("packet", (msg) => {\n                if (failed)\n                    return;\n                if ("pong" === msg.type && "probe" === msg.data) {\n                    this.upgrading = true;\n                    this.emitReserved("upgrading", transport);\n                    if (!transport)\n                        return;\n                    SocketWithoutUpgrade.priorWebsocketSuccess =\n                        "websocket" === transport.name;\n                    this.transport.pause(() => {\n                        if (failed)\n                            return;\n                        if ("closed" === this.readyState)\n                            return;\n                        cleanup();\n                        this.setTransport(transport);\n                        transport.send([{ type: "upgrade" }]);\n                        this.emitReserved("upgrade", transport);\n                        transport = null;\n                        this.upgrading = false;\n                        this.flush();\n                    });\n                }\n                else {\n                    const err = new Error("probe error");\n                    // @ts-ignore\n                    err.transport = transport.name;\n                    this.emitReserved("upgradeError", err);\n                }\n            });\n        };\n        function freezeTransport() {\n            if (failed)\n                return;\n            // Any callback called by transport should be ignored since now\n            failed = true;\n            cleanup();\n            transport.close();\n            transport = null;\n        }\n        // Handle any error that happens while probing\n        const onerror = (err) => {\n            const error = new Error("probe error: " + err);\n            // @ts-ignore\n            error.transport = transport.name;\n            freezeTransport();\n            this.emitReserved("upgradeError", error);\n        };\n        function onTransportClose() {\n            onerror("transport closed");\n        }\n        // When the socket is closed while we\'re probing\n        function onclose() {\n            onerror("socket closed");\n        }\n        // When the socket is upgraded while we\'re probing\n        function onupgrade(to) {\n            if (transport && to.name !== transport.name) {\n                freezeTransport();\n            }\n        }\n        // Remove all listeners on the transport and on self\n        const cleanup = () => {\n            transport.removeListener("open", onTransportOpen);\n            transport.removeListener("error", onerror);\n            transport.removeListener("close", onTransportClose);\n            this.off("close", onclose);\n            this.off("upgrading", onupgrade);\n        };\n        transport.once("open", onTransportOpen);\n        transport.once("error", onerror);\n        transport.once("close", onTransportClose);\n        this.once("close", onclose);\n        this.once("upgrading", onupgrade);\n        if (this._upgrades.indexOf("webtransport") !== -1 &&\n            name !== "webtransport") {\n            // favor WebTransport\n            this.setTimeoutFn(() => {\n                if (!failed) {\n                    transport.open();\n                }\n            }, 200);\n        }\n        else {\n            transport.open();\n        }\n    }\n    onHandshake(data) {\n        this._upgrades = this._filterUpgrades(data.upgrades);\n        super.onHandshake(data);\n    }\n    /**\n     * Filters upgrades, returning only those matching client transports.\n     *\n     * @param {Array} upgrades - server upgrades\n     * @private\n     */\n    _filterUpgrades(upgrades) {\n        const filteredUpgrades = [];\n        for (let i = 0; i < upgrades.length; i++) {\n            if (~this.transports.indexOf(upgrades[i]))\n                filteredUpgrades.push(upgrades[i]);\n        }\n        return filteredUpgrades;\n    }\n}\n/**\n * This class provides a WebSocket-like interface to connect to an Engine.IO server. The connection will be established\n * with one of the available low-level transports, like HTTP long-polling, WebSocket or WebTransport.\n *\n * This class comes with an upgrade mechanism, which means that once the connection is established with the first\n * low-level transport, it will try to upgrade to a better transport.\n *\n * @example\n * import { Socket } from "engine.io-client";\n *\n * const socket = new Socket();\n *\n * socket.on("open", () => {\n *   socket.send("hello");\n * });\n *\n * @see SocketWithoutUpgrade\n * @see SocketWithUpgrade\n */\nclass Socket extends SocketWithUpgrade {\n    constructor(uri, opts = {}) {\n        const o = typeof uri === "object" ? uri : opts;\n        if (!o.transports ||\n            (o.transports && typeof o.transports[0] === "string")) {\n            o.transports = (o.transports || ["polling", "websocket", "webtransport"])\n                .map((transportName) => _transports_index_js__WEBPACK_IMPORTED_MODULE_0__.transports[transportName])\n                .filter((t) => !!t);\n        }\n        super(uri, o);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vc29ja2V0LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBeUU7QUFDWDtBQUNoQjtBQUNBO0FBQ1M7QUFDWDtBQUNzQztBQUNsRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLGtDQUFrQztBQUM5QztBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ08sbUNBQW1DLGlFQUFPO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBLGVBQWUsZUFBZTtBQUM5QixlQUFlLFFBQVE7QUFDdkI7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLCtEQUFpQjtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEMseUJBQXlCO0FBQ3JFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsMkRBQUs7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QiwyREFBSztBQUNqQztBQUNBLFFBQVEsK0RBQXFCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLGdDQUFnQztBQUNoQztBQUNBLFNBQVM7QUFDVDtBQUNBO0FB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bW9kdWxlcy8ucG5wbS9lbmdpbmUuaW8tY2xpZW50QDYuNi4zL25vZGVfbW9kdWxlcy9lbmdpbmUuaW8tY2xpZW50L2J1aWxkL2VzbS9zb2NrZXQuanM/Yjg1NyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB0cmFuc3BvcnRzIGFzIERFRkFVTFRfVFJBTlNQT1JUUyB9IGZyb20gXCIuL3RyYW5zcG9ydHMvaW5kZXguanNcIjtcbmltcG9ydCB7IGluc3RhbGxUaW1lckZ1bmN0aW9ucywgYnl0ZUxlbmd0aCB9IGZyb20gXCIuL3V0aWwuanNcIjtcbmltcG9ydCB7IGRlY29kZSB9IGZyb20gXCIuL2NvbnRyaWIvcGFyc2Vxcy5qc1wiO1xuaW1wb3J0IHsgcGFyc2UgfSBmcm9tIFwiLi9jb250cmliL3BhcnNldXJpLmpzXCI7XG5pbXBvcnQgeyBFbWl0dGVyIH0gZnJvbSBcIkBzb2NrZXQuaW8vY29tcG9uZW50LWVtaXR0ZXJcIjtcbmltcG9ydCB7IHByb3RvY29sIH0gZnJvbSBcImVuZ2luZS5pby1wYXJzZXJcIjtcbmltcG9ydCB7IGNyZWF0ZUNvb2tpZUphciwgZGVmYXVsdEJpbmFyeVR5cGUsIG5leHRUaWNrLCB9IGZyb20gXCIuL2dsb2JhbHMubm9kZS5qc1wiO1xuY29uc3Qgd2l0aEV2ZW50TGlzdGVuZXJzID0gdHlwZW9mIGFkZEV2ZW50TGlzdGVuZXIgPT09IFwiZnVuY3Rpb25cIiAmJlxuICAgIHR5cGVvZiByZW1vdmVFdmVudExpc3RlbmVyID09PSBcImZ1bmN0aW9uXCI7XG5jb25zdCBPRkZMSU5FX0VWRU5UX0xJU1RFTkVSUyA9IFtdO1xuaWYgKHdpdGhFdmVudExpc3RlbmVycykge1xuICAgIC8vIHdpdGhpbiBhIFNlcnZpY2VXb3JrZXIsIGFueSBldmVudCBoYW5kbGVyIGZvciB0aGUgJ29mZmxpbmUnIGV2ZW50IG11c3QgYmUgYWRkZWQgb24gdGhlIGluaXRpYWwgZXZhbHVhdGlvbiBvZiB0aGVcbiAgICAvLyBzY3JpcHQsIHNvIHdlIGNyZWF0ZSBvbmUgc2luZ2xlIGV2ZW50IGxpc3RlbmVyIGhlcmUgd2hpY2ggd2lsbCBmb3J3YXJkIHRoZSBldmVudCB0byB0aGUgc29ja2V0IGluc3RhbmNlc1xuICAgIGFkZEV2ZW50TGlzdGVuZXIoXCJvZmZsaW5lXCIsICgpID0+IHtcbiAgICAgICAgT0ZGTElORV9FVkVOVF9MSVNURU5FUlMuZm9yRWFjaCgobGlzdGVuZXIpID0+IGxpc3RlbmVyKCkpO1xuICAgIH0sIGZhbHNlKTtcbn1cbi8qKlxuICogVGhpcyBjbGFzcyBwcm92aWRlcyBhIFdlYlNvY2tldC1saWtlIGludGVyZmFjZSB0byBjb25uZWN0IHRvIGFuIEVuZ2luZS5JTyBzZXJ2ZXIuIFRoZSBjb25uZWN0aW9uIHdpbGwgYmUgZXN0YWJsaXNoZWRcbiAqIHdpdGggb25lIG9mIHRoZSBhdmFpbGFibGUgbG93LWxldmVsIHRyYW5zcG9ydHMsIGxpa2UgSFRUUCBsb25nLXBvbGxpbmcsIFdlYlNvY2tldCBvciBXZWJUcmFuc3BvcnQuXG4gKlxuICogVGhpcyBjbGFzcyBjb21lcyB3aXRob3V0IHVwZ3JhZGUgbWVjaGFuaXNtLCB3aGljaCBtZWFucyB0aGF0IGl0IHdpbGwga2VlcCB0aGUgZmlyc3QgbG93LWxldmVsIHRyYW5zcG9ydCB0aGF0XG4gKiBzdWNjZXNzZnVsbHkgZXN0YWJsaXNoZXMgdGhlIGNvbm5lY3Rpb24uXG4gKlxuICogSW4gb3JkZXIgdG8gYWxsb3cgdHJlZS1zaGFraW5nLCB0aGVyZSBhcmUgbm8gdHJhbnNwb3J0cyBpbmNsdWRlZCwgdGhhdCdzIHdoeSB0aGUgYHRyYW5zcG9ydHNgIG9wdGlvbiBpcyBtYW5kYXRvcnkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IFNvY2tldFdpdGhvdXRVcGdyYWRlLCBXZWJTb2NrZXQgfSBmcm9tIFwiZW5naW5lLmlvLWNsaWVudFwiO1xuICpcbiAqIGNvbnN0IHNvY2tldCA9IG5ldyBTb2NrZXRXaXRob3V0VXBncmFkZSh7XG4gKiAgIHRyYW5zcG9ydHM6IFtXZWJTb2NrZXRdXG4gKiB9KTtcbiAqXG4gKiBzb2NrZXQub24oXCJvcGVuXCIsICgpID0+IHtcbiAqICAgc29ja2V0LnNlbmQoXCJoZWxsb1wiKTtcbiAqIH0pO1xuICpcbiAqIEBzZWUgU29ja2V0V2l0aFVwZ3JhZGVcbiAqIEBzZWUgU29ja2V0XG4gKi9cbmV4cG9ydCBjbGFzcyBTb2NrZXRXaXRob3V0VXBncmFkZSBleHRlbmRzIEVtaXR0ZXIge1xuICAgIC8qKlxuICAgICAqIFNvY2tldCBjb25zdHJ1Y3Rvci5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfE9iamVjdH0gdXJpIC0gdXJpIG9yIG9wdGlvbnNcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb3B0cyAtIG9wdGlvbnNcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih1cmksIG9wdHMpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5iaW5hcnlUeXBlID0gZGVmYXVsdEJpbmFyeVR5cGU7XG4gICAgICAgIHRoaXMud3JpdGVCdWZmZXIgPSBbXTtcbiAgICAgICAgdGhpcy5fcHJldkJ1ZmZlckxlbiA9IDA7XG4gICAgICAgIHRoaXMuX3BpbmdJbnRlcnZhbCA9IC0xO1xuICAgICAgICB0aGlzLl9waW5nVGltZW91dCA9IC0xO1xuICAgICAgICB0aGlzLl9tYXhQYXlsb2FkID0gLTE7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgZXhwaXJhdGlvbiB0aW1lc3RhbXAgb2YgdGhlIHtAbGluayBfcGluZ1RpbWVvdXRUaW1lcn0gb2JqZWN0IGlzIHRyYWNrZWQsIGluIGNhc2UgdGhlIHRpbWVyIGlzIHRocm90dGxlZCBhbmQgdGhlXG4gICAgICAgICAqIGNhbGxiYWNrIGlzIG5vdCBmaXJlZCBvbiB0aW1lLiBUaGlzIGNhbiBoYXBwZW4gZm9yIGV4YW1wbGUgd2hlbiBhIGxhcHRvcCBpcyBzdXNwZW5kZWQgb3Igd2hlbiBhIHBob25lIGlzIGxvY2tlZC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3BpbmdUaW1lb3V0VGltZSA9IEluZmluaXR5O1xuICAgICAgICBpZiAodXJpICYmIFwib2JqZWN0XCIgPT09IHR5cGVvZiB1cmkpIHtcbiAgICAgICAgICAgIG9wdHMgPSB1cmk7XG4gICAgICAgICAgICB1cmkgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmICh1cmkpIHtcbiAgICAgICAgICAgIGNvbnN0IHBhcnNlZFVyaSA9IHBhcnNlKHVyaSk7XG4gICAgICAgICAgICBvcHRzLmhvc3RuYW1lID0gcGFyc2VkVXJpLmhvc3Q7XG4gICAgICAgICAgICBvcHRzLnNlY3VyZSA9XG4gICAgICAgICAgICAgICAgcGFyc2VkVXJpLnByb3RvY29sID09PSBcImh0dHBzXCIgfHwgcGFyc2VkVXJpLnByb3RvY29sID09PSBcIndzc1wiO1xuICAgICAgICAgICAgb3B0cy5wb3J0ID0gcGFyc2VkVXJpLnBvcnQ7XG4gICAgICAgICAgICBpZiAocGFyc2VkVXJpLnF1ZXJ5KVxuICAgICAgICAgICAgICAgIG9wdHMucXVlcnkgPSBwYXJzZWRVcmkucXVlcnk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAob3B0cy5ob3N0KSB7XG4gICAgICAgICAgICBvcHRzLmhvc3RuYW1lID0gcGFyc2Uob3B0cy5ob3N0KS5ob3N0O1xuICAgICAgICB9XG4gICAgICAgIGluc3RhbGxUaW1lckZ1bmN0aW9ucyh0aGlzLCBvcHRzKTtcbiAgICAgICAgdGhpcy5zZWN1cmUgPVxuICAgICAgICAgICAgbnVsbCAhPSBvcHRzLnNlY3VyZVxuICAgICAgICAgICAgICAgID8gb3B0cy5zZWN1cmVcbiAgICAgICAgICAgICAgICA6IHR5cGVvZiBsb2NhdGlvbiAhPT0gXCJ1bmRlZmluZWRcIiAmJiBcImh0dHBzOlwiID09PSBsb2NhdGlvbi5wcm90b2NvbDtcbiAgICAgICAgaWYgKG9wdHMuaG9zdG5hbWUgJiYgIW9wdHMucG9ydCkge1xuICAgICAgICAgICAgLy8gaWYgbm8gcG9ydCBpcyBzcGVjaWZpZWQgbWFudWFsbHksIHVzZSB0aGUgcHJvdG9jb2wgZGVmYXVsdFxuICAgICAgICAgICAgb3B0cy5wb3J0ID0gdGhpcy5zZWN1cmUgPyBcIjQ0M1wiIDogXCI4MFwiO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaG9zdG5hbWUgPVxuICAgICAgICAgICAgb3B0cy5ob3N0bmFtZSB8fFxuICAgICAgICAgICAgICAgICh0eXBlb2YgbG9jYXRpb24gIT09IFwidW5kZWZpbmVkXCIgPyBsb2NhdGlvbi5ob3N0bmFtZSA6IFwibG9jYWxob3N0XCIpO1xuICAgICAgICB0aGlzLnBvcnQgPVxuICAgICAgICAgICAgb3B0cy5wb3J0IHx8XG4gICAgICAgICAgICAgICAgKHR5cGVvZiBsb2NhdGlvbiAhPT0gXCJ1bmRlZmluZWRcIiAmJiBsb2NhdGlvbi5wb3J0XG4gICAgICAgICAgICAgICAgICAgID8gbG9jYXRpb24ucG9ydFxuICAgICAgICAgICAgICAgICAgICA6IHRoaXMuc2VjdXJlXG4gICAgICAgICAgICAgICAgICAgICAgICA/IFwiNDQzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIDogXCI4MFwiKTtcbiAgICAgICAgdGhpcy50cmFuc3BvcnRzID0gW107XG4gICAgICAgIHRoaXMuX3RyYW5zcG9ydHNCeU5hbWUgPSB7fTtcbiAgICAgICAgb3B0cy50cmFuc3BvcnRzLmZvckVhY2goKHQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHRyYW5zcG9ydE5hbWUgPSB0LnByb3RvdHlwZS5uYW1lO1xuICAgICAgICAgICAgdGhpcy50cmFuc3BvcnRzLnB1c2godHJhbnNwb3J0TmFtZSk7XG4gICAgICAgICAgICB0aGlzLl90cmFuc3BvcnRzQnlOYW1lW3RyYW5zcG9ydE5hbWVdID0gdDtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMub3B0cyA9IE9iamVjdC5hc3NpZ24oe1xuICAgICAgICAgICAgcGF0aDogXCIvZW5naW5lLmlvXCIsXG4gICAgICAgICAgICBhZ2VudDogZmFsc2UsXG4gICAgICAgICAgICB3aXRoQ3JlZGVudGlhbHM6IGZhbHNlLFxuICAgICAgICAgICAgdXBncmFkZTogdHJ1ZSxcbiAgICAgICAgICAgIHRpbWVzdGFtcFBhcmFtOiBcInRcIixcbiAgICAgICAgICAgIHJlbWVtYmVyVXBncmFkZTogZmFsc2UsXG4gICAgICAgICAgICBhZGRUcmFpbGluZ1NsYXNoOiB0cnVlLFxuICAgICAgICAgICAgcmVqZWN0VW5hdXRob3JpemVkOiB0cnVlLFxuICAgICAgICAgICAgcGVyTWVzc2FnZURlZmxhdGU6IHtcbiAgICAgICAgICAgICAgICB0aHJlc2hvbGQ6IDEwMjQsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdHJhbnNwb3J0T3B0aW9uczoge30sXG4gICAgICAgICAgICBjbG9zZU9uQmVmb3JldW5sb2FkOiBmYWxzZSxcbiAgICAgICAgfSwgb3B0cyk7XG4gICAgICAgIHRoaXMub3B0cy5wYXRoID1cbiAgICAgICAgICAgIHRoaXMub3B0cy5wYXRoLnJlcGxhY2UoL1xcLyQvLCBcIlwiKSArXG4gICAgICAgICAgICAgICAgKHRoaXMub3B0cy5hZGRUcmFpbGluZ1NsYXNoID8gXCIvXCIgOiBcIlwiKTtcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLm9wdHMucXVlcnkgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHRoaXMub3B0cy5xdWVyeSA9IGRlY29kZSh0aGlzLm9wdHMucXVlcnkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh3aXRoRXZlbnRMaXN0ZW5lcnMpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLm9wdHMuY2xvc2VPbkJlZm9yZXVubG9hZCkge1xuICAgICAgICAgICAgICAgIC8vIEZpcmVmb3ggY2xvc2VzIHRoZSBjb25uZWN0aW9uIHdoZW4gdGhlIFwiYmVmb3JldW5sb2FkXCIgZXZlbnQgaXMgZW1pdHRlZCBidXQgbm90IENocm9tZS4gVGhpcyBldmVudCBsaXN0ZW5lclxuICAgICAgICAgICAgICAgIC8vIGVuc3VyZXMgZXZlcnkgYnJvd3NlciBiZWhhdmVzIHRoZSBzYW1lIChubyBcImRpc2Nvbm5lY3RcIiBldmVudCBhdCB0aGUgU29ja2V0LklPIGxldmVsIHdoZW4gdGhlIHBhZ2UgaXNcbiAgICAgICAgICAgICAgICAvLyBjbG9zZWQvcmVsb2FkZWQpXG4gICAgICAgICAgICAgICAgdGhpcy5fYmVmb3JldW5sb2FkRXZlbnRMaXN0ZW5lciA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMudHJhbnNwb3J0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzaWxlbnRseSBjbG9zZSB0aGUgdHJhbnNwb3J0XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRyYW5zcG9ydC5yZW1vdmVBbGxMaXN0ZW5lcnMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHJhbnNwb3J0LmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGFkZEV2ZW50TGlzdGVuZXIoXCJiZWZvcmV1bmxvYWRcIiwgdGhpcy5fYmVmb3JldW5sb2FkRXZlbnRMaXN0ZW5lciwgZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuaG9zdG5hbWUgIT09IFwibG9jYWxob3N0XCIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vZmZsaW5lRXZlbnRMaXN0ZW5lciA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fb25DbG9zZShcInRyYW5zcG9ydCBjbG9zZVwiLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJuZXR3b3JrIGNvbm5lY3Rpb24gbG9zdFwiLFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIE9GRkxJTkVfRVZFTlRfTElTVEVORVJTLnB1c2godGhpcy5fb2ZmbGluZUV2ZW50TGlzdGVuZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm9wdHMud2l0aENyZWRlbnRpYWxzKSB7XG4gICAgICAgICAgICB0aGlzLl9jb29raWVKYXIgPSBjcmVhdGVDb29raWVKYXIoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9vcGVuKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgdHJhbnNwb3J0IG9mIHRoZSBnaXZlbiB0eXBlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgLSB0cmFuc3BvcnQgbmFtZVxuICAgICAqIEByZXR1cm4ge1RyYW5zcG9ydH1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIGNyZWF0ZVRyYW5zcG9ydChuYW1lKSB7XG4gICAgICAgIGNvbnN0IHF1ZXJ5ID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5vcHRzLnF1ZXJ5KTtcbiAgICAgICAgLy8gYXBwZW5kIGVuZ2luZS5pbyBwcm90b2NvbCBpZGVudGlmaWVyXG4gICAgICAgIHF1ZXJ5LkVJTyA9IHByb3RvY29sO1xuICAgICAgICAvLyB0cmFuc3BvcnQgbmFtZVxuICAgICAgICBxdWVyeS50cmFuc3BvcnQgPSBuYW1lO1xuICAgICAgICAvLyBzZXNzaW9uIGlkIGlmIHdlIGFscmVhZHkgaGF2ZSBvbmVcbiAgICAgICAgaWYgKHRoaXMuaWQpXG4gICAgICAgICAgICBxdWVyeS5zaWQgPSB0aGlzLmlkO1xuICAgICAgICBjb25zdCBvcHRzID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5vcHRzLCB7XG4gICAgICAgICAgICBxdWVyeSxcbiAgICAgICAgICAgIHNvY2tldDogdGhpcyxcbiAgICAgICAgICAgIGhvc3RuYW1lOiB0aGlzLmhvc3RuYW1lLFxuICAgICAgICAgICAgc2VjdXJlOiB0aGlzLnNlY3VyZSxcbiAgICAgICAgICAgIHBvcnQ6IHRoaXMucG9ydCxcbiAgICAgICAgfSwgdGhpcy5vcHRzLnRyYW5zcG9ydE9wdGlvbnNbbmFtZV0pO1xuICAgICAgICByZXR1cm4gbmV3IHRoaXMuX3RyYW5zcG9ydHNCeU5hbWVbbmFtZV0ob3B0cyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEluaXRpYWxpemVzIHRyYW5zcG9ydCB0byB1c2UgYW5kIHN0YXJ0cyBwcm9iZS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX29wZW4oKSB7XG4gICAgICAgIGlmICh0aGlzLnRyYW5zcG9ydHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAvLyBFbWl0IGVycm9yIG9uIG5leHQgdGljayBzbyBpdCBjYW4gYmUgbGlzdGVuZWQgdG9cbiAgICAgICAgICAgIHRoaXMuc2V0VGltZW91dEZuKCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcImVycm9yXCIsIFwiTm8gdHJhbnNwb3J0cyBhdmFpbGFibGVcIik7XG4gICAgICAgICAgICB9LCAwKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB0cmFuc3BvcnROYW1lID0gdGhpcy5vcHRzLnJlbWVtYmVyVXBncmFkZSAmJlxuICAgICAgICAgICAgU29ja2V0V2l0aG91dFVwZ3JhZGUucHJpb3JXZWJzb2NrZXRTdWNjZXNzICYmXG4gICAgICAgICAgICB0aGlzLnRyYW5zcG9ydHMuaW5kZXhPZihcIndlYnNvY2tldFwiKSAhPT0gLTFcbiAgICAgICAgICAgID8gXCJ3ZWJzb2NrZXRcIlxuICAgICAgICAgICAgOiB0aGlzLnRyYW5zcG9ydHNbMF07XG4gICAgICAgIHRoaXMucmVhZHlTdGF0ZSA9IFwib3BlbmluZ1wiO1xuICAgICAgICBjb25zdCB0cmFuc3BvcnQgPSB0aGlzLmNyZWF0ZVRyYW5zcG9ydCh0cmFuc3BvcnROYW1lKTtcbiAgICAgICAgdHJhbnNwb3J0Lm9wZW4oKTtcbiAgICAgICAgdGhpcy5zZXRUcmFuc3BvcnQodHJhbnNwb3J0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgY3VycmVudCB0cmFuc3BvcnQuIERpc2FibGVzIHRoZSBleGlzdGluZyBvbmUgKGlmIGFueSkuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHNldFRyYW5zcG9ydCh0cmFuc3BvcnQpIHtcbiAgICAgICAgaWYgKHRoaXMudHJhbnNwb3J0KSB7XG4gICAgICAgICAgICB0aGlzLnRyYW5zcG9ydC5yZW1vdmVBbGxMaXN0ZW5lcnMoKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBzZXQgdXAgdHJhbnNwb3J0XG4gICAgICAgIHRoaXMudHJhbnNwb3J0ID0gdHJhbnNwb3J0O1xuICAgICAgICAvLyBzZXQgdXAgdHJhbnNwb3J0IGxpc3RlbmVyc1xuICAgICAgICB0cmFuc3BvcnRcbiAgICAgICAgICAgIC5vbihcImRyYWluXCIsIHRoaXMuX29uRHJhaW4uYmluZCh0aGlzKSlcbiAgICAgICAgICAgIC5vbihcInBhY2tldFwiLCB0aGlzLl9vblBhY2tldC5iaW5kKHRoaXMpKVxuICAgICAgICAgICAgLm9uKFwiZXJyb3JcIiwgdGhpcy5fb25FcnJvci5iaW5kKHRoaXMpKVxuICAgICAgICAgICAgLm9uKFwiY2xvc2VcIiwgKHJlYXNvbikgPT4gdGhpcy5fb25DbG9zZShcInRyYW5zcG9ydCBjbG9zZVwiLCByZWFzb24pKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHdoZW4gY29ubmVjdGlvbiBpcyBkZWVtZWQgb3Blbi5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgb25PcGVuKCkge1xuICAgICAgICB0aGlzLnJlYWR5U3RhdGUgPSBcIm9wZW5cIjtcbiAgICAgICAgU29ja2V0V2l0aG91dFVwZ3JhZGUucHJpb3JXZWJzb2NrZXRTdWNjZXNzID1cbiAgICAgICAgICAgIFwid2Vic29ja2V0XCIgPT09IHRoaXMudHJhbnNwb3J0Lm5hbWU7XG4gICAgICAgIHRoaXMuZW1pdFJlc2VydmVkKFwib3BlblwiKTtcbiAgICAgICAgdGhpcy5mbHVzaCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBIYW5kbGVzIGEgcGFja2V0LlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfb25QYWNrZXQocGFja2V0KSB7XG4gICAgICAgIGlmIChcIm9wZW5pbmdcIiA9PT0gdGhpcy5yZWFkeVN0YXRlIHx8XG4gICAgICAgICAgICBcIm9wZW5cIiA9PT0gdGhpcy5yZWFkeVN0YXRlIHx8XG4gICAgICAgICAgICBcImNsb3NpbmdcIiA9PT0gdGhpcy5yZWFkeVN0YXRlKSB7XG4gICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcInBhY2tldFwiLCBwYWNrZXQpO1xuICAgICAgICAgICAgLy8gU29ja2V0IGlzIGxpdmUgLSBhbnkgcGFja2V0IGNvdW50c1xuICAgICAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJoZWFydGJlYXRcIik7XG4gICAgICAgICAgICBzd2l0Y2ggKHBhY2tldC50eXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcIm9wZW5cIjpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkhhbmRzaGFrZShKU09OLnBhcnNlKHBhY2tldC5kYXRhKSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJwaW5nXCI6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3NlbmRQYWNrZXQoXCJwb25nXCIpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcInBpbmdcIik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdFJlc2VydmVkKFwicG9uZ1wiKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVzZXRQaW5nVGltZW91dCgpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwiZXJyb3JcIjpcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZXJyID0gbmV3IEVycm9yKFwic2VydmVyIGVycm9yXCIpO1xuICAgICAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICAgICAgICAgIGVyci5jb2RlID0gcGFja2V0LmRhdGE7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX29uRXJyb3IoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcIm1lc3NhZ2VcIjpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJkYXRhXCIsIHBhY2tldC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJtZXNzYWdlXCIsIHBhY2tldC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHVwb24gaGFuZHNoYWtlIGNvbXBsZXRpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YSAtIGhhbmRzaGFrZSBvYmpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIG9uSGFuZHNoYWtlKGRhdGEpIHtcbiAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJoYW5kc2hha2VcIiwgZGF0YSk7XG4gICAgICAgIHRoaXMuaWQgPSBkYXRhLnNpZDtcbiAgICAgICAgdGhpcy50cmFuc3BvcnQucXVlcnkuc2lkID0gZGF0YS5zaWQ7XG4gICAgICAgIHRoaXMuX3BpbmdJbnRlcnZhbCA9IGRhdGEucGluZ0ludGVydmFsO1xuICAgICAgICB0aGlzLl9waW5nVGltZW91dCA9IGRhdGEucGluZ1RpbWVvdXQ7XG4gICAgICAgIHRoaXMuX21heFBheWxvYWQgPSBkYXRhLm1heFBheWxvYWQ7XG4gICAgICAgIHRoaXMub25PcGVuKCk7XG4gICAgICAgIC8vIEluIGNhc2Ugb3BlbiBoYW5kbGVyIGNsb3NlcyBzb2NrZXRcbiAgICAgICAgaWYgKFwiY2xvc2VkXCIgPT09IHRoaXMucmVhZHlTdGF0ZSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdGhpcy5fcmVzZXRQaW5nVGltZW91dCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXRzIGFuZCByZXNldHMgcGluZyB0aW1lb3V0IHRpbWVyIGJhc2VkIG9uIHNlcnZlciBwaW5ncy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3Jlc2V0UGluZ1RpbWVvdXQoKSB7XG4gICAgICAgIHRoaXMuY2xlYXJUaW1lb3V0Rm4odGhpcy5fcGluZ1RpbWVvdXRUaW1lcik7XG4gICAgICAgIGNvbnN0IGRlbGF5ID0gdGhpcy5fcGluZ0ludGVydmFsICsgdGhpcy5fcGluZ1RpbWVvdXQ7XG4gICAgICAgIHRoaXMuX3BpbmdUaW1lb3V0VGltZSA9IERhdGUubm93KCkgKyBkZWxheTtcbiAgICAgICAgdGhpcy5fcGluZ1RpbWVvdXRUaW1lciA9IHRoaXMuc2V0VGltZW91dEZuKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX29uQ2xvc2UoXCJwaW5nIHRpbWVvdXRcIik7XG4gICAgICAgIH0sIGRlbGF5KTtcbiAgICAgICAgaWYgKHRoaXMub3B0cy5hdXRvVW5yZWYpIHtcbiAgICAgICAgICAgIHRoaXMuX3BpbmdUaW1lb3V0VGltZXIudW5yZWYoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgb24gYGRyYWluYCBldmVudFxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfb25EcmFpbigpIHtcbiAgICAgICAgdGhpcy53cml0ZUJ1ZmZlci5zcGxpY2UoMCwgdGhpcy5fcHJldkJ1ZmZlckxlbik7XG4gICAgICAgIC8vIHNldHRpbmcgcHJldkJ1ZmZlckxlbiA9IDAgaXMgdmVyeSBpbXBvcnRhbnRcbiAgICAgICAgLy8gZm9yIGV4YW1wbGUsIHdoZW4gdXBncmFkaW5nLCB1cGdyYWRlIHBhY2tldCBpcyBzZW50IG92ZXIsXG4gICAgICAgIC8vIGFuZCBhIG5vbnplcm8gcHJldkJ1ZmZlckxlbiBjb3VsZCBjYXVzZSBwcm9ibGVtcyBvbiBgZHJhaW5gXG4gICAgICAgIHRoaXMuX3ByZXZCdWZmZXJMZW4gPSAwO1xuICAgICAgICBpZiAoMCA9PT0gdGhpcy53cml0ZUJ1ZmZlci5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMuZW1pdFJlc2VydmVkKFwiZHJhaW5cIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmZsdXNoKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogRmx1c2ggd3JpdGUgYnVmZmVycy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgZmx1c2goKSB7XG4gICAgICAgIGlmIChcImNsb3NlZFwiICE9PSB0aGlzLnJlYWR5U3RhdGUgJiZcbiAgICAgICAgICAgIHRoaXMudHJhbnNwb3J0LndyaXRhYmxlICYmXG4gICAgICAgICAgICAhdGhpcy51cGdyYWRpbmcgJiZcbiAgICAgICAgICAgIHRoaXMud3JpdGVCdWZmZXIubGVuZ3RoKSB7XG4gICAgICAgICAgICBjb25zdCBwYWNrZXRzID0gdGhpcy5fZ2V0V3JpdGFibGVQYWNrZXRzKCk7XG4gICAgICAgICAgICB0aGlzLnRyYW5zcG9ydC5zZW5kKHBhY2tldHMpO1xuICAgICAgICAgICAgLy8ga2VlcCB0cmFjayBvZiBjdXJyZW50IGxlbmd0aCBvZiB3cml0ZUJ1ZmZlclxuICAgICAgICAgICAgLy8gc3BsaWNlIHdyaXRlQnVmZmVyIGFuZCBjYWxsYmFja0J1ZmZlciBvbiBgZHJhaW5gXG4gICAgICAgICAgICB0aGlzLl9wcmV2QnVmZmVyTGVuID0gcGFja2V0cy5sZW5ndGg7XG4gICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcImZsdXNoXCIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEVuc3VyZSB0aGUgZW5jb2RlZCBzaXplIG9mIHRoZSB3cml0ZUJ1ZmZlciBpcyBiZWxvdyB0aGUgbWF4UGF5bG9hZCB2YWx1ZSBzZW50IGJ5IHRoZSBzZXJ2ZXIgKG9ubHkgZm9yIEhUVFBcbiAgICAgKiBsb25nLXBvbGxpbmcpXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9nZXRXcml0YWJsZVBhY2tldHMoKSB7XG4gICAgICAgIGNvbnN0IHNob3VsZENoZWNrUGF5bG9hZFNpemUgPSB0aGlzLl9tYXhQYXlsb2FkICYmXG4gICAgICAgICAgICB0aGlzLnRyYW5zcG9ydC5uYW1lID09PSBcInBvbGxpbmdcIiAmJlxuICAgICAgICAgICAgdGhpcy53cml0ZUJ1ZmZlci5sZW5ndGggPiAxO1xuICAgICAgICBpZiAoIXNob3VsZENoZWNrUGF5bG9hZFNpemUpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLndyaXRlQnVmZmVyO1xuICAgICAgICB9XG4gICAgICAgIGxldCBwYXlsb2FkU2l6ZSA9IDE7IC8vIGZpcnN0IHBhY2tldCB0eXBlXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy53cml0ZUJ1ZmZlci5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMud3JpdGVCdWZmZXJbaV0uZGF0YTtcbiAgICAgICAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgcGF5bG9hZFNpemUgKz0gYnl0ZUxlbmd0aChkYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpID4gMCAmJiBwYXlsb2FkU2l6ZSA+IHRoaXMuX21heFBheWxvYWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy53cml0ZUJ1ZmZlci5zbGljZSgwLCBpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHBheWxvYWRTaXplICs9IDI7IC8vIHNlcGFyYXRvciArIHBhY2tldCB0eXBlXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMud3JpdGVCdWZmZXI7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENoZWNrcyB3aGV0aGVyIHRoZSBoZWFydGJlYXQgdGltZXIgaGFzIGV4cGlyZWQgYnV0IHRoZSBzb2NrZXQgaGFzIG5vdCB5ZXQgYmVlbiBub3RpZmllZC5cbiAgICAgKlxuICAgICAqIE5vdGU6IHRoaXMgbWV0aG9kIGlzIHByaXZhdGUgZm9yIG5vdyBiZWNhdXNlIGl0IGRvZXMgbm90IHJlYWxseSBmaXQgdGhlIFdlYlNvY2tldCBBUEksIGJ1dCBpZiB3ZSBwdXQgaXQgaW4gdGhlXG4gICAgICogYHdyaXRlKClgIG1ldGhvZCB0aGVuIHRoZSBtZXNzYWdlIHdvdWxkIG5vdCBiZSBidWZmZXJlZCBieSB0aGUgU29ja2V0LklPIGNsaWVudC5cbiAgICAgKlxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICAvKiBwcml2YXRlICovIF9oYXNQaW5nRXhwaXJlZCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9waW5nVGltZW91dFRpbWUpXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgY29uc3QgaGFzRXhwaXJlZCA9IERhdGUubm93KCkgPiB0aGlzLl9waW5nVGltZW91dFRpbWU7XG4gICAgICAgIGlmIChoYXNFeHBpcmVkKSB7XG4gICAgICAgICAgICB0aGlzLl9waW5nVGltZW91dFRpbWUgPSAwO1xuICAgICAgICAgICAgbmV4dFRpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uQ2xvc2UoXCJwaW5nIHRpbWVvdXRcIik7XG4gICAgICAgICAgICB9LCB0aGlzLnNldFRpbWVvdXRGbik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGhhc0V4cGlyZWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlbmRzIGEgbWVzc2FnZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBtc2cgLSBtZXNzYWdlLlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIC0gY2FsbGJhY2sgZnVuY3Rpb24uXG4gICAgICogQHJldHVybiB7U29ja2V0fSBmb3IgY2hhaW5pbmcuXG4gICAgICovXG4gICAgd3JpdGUobXNnLCBvcHRpb25zLCBmbikge1xuICAgICAgICB0aGlzLl9zZW5kUGFja2V0KFwibWVzc2FnZVwiLCBtc2csIG9wdGlvbnMsIGZuKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlbmRzIGEgbWVzc2FnZS4gQWxpYXMgb2Yge0BsaW5rIFNvY2tldCN3cml0ZX0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gbXNnIC0gbWVzc2FnZS5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucy5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiAtIGNhbGxiYWNrIGZ1bmN0aW9uLlxuICAgICAqIEByZXR1cm4ge1NvY2tldH0gZm9yIGNoYWluaW5nLlxuICAgICAqL1xuICAgIHNlbmQobXNnLCBvcHRpb25zLCBmbikge1xuICAgICAgICB0aGlzLl9zZW5kUGFja2V0KFwibWVzc2FnZVwiLCBtc2csIG9wdGlvbnMsIGZuKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlbmRzIGEgcGFja2V0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHR5cGU6IHBhY2tldCB0eXBlLlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBkYXRhLlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIC0gY2FsbGJhY2sgZnVuY3Rpb24uXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfc2VuZFBhY2tldCh0eXBlLCBkYXRhLCBvcHRpb25zLCBmbikge1xuICAgICAgICBpZiAoXCJmdW5jdGlvblwiID09PSB0eXBlb2YgZGF0YSkge1xuICAgICAgICAgICAgZm4gPSBkYXRhO1xuICAgICAgICAgICAgZGF0YSA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoXCJmdW5jdGlvblwiID09PSB0eXBlb2Ygb3B0aW9ucykge1xuICAgICAgICAgICAgZm4gPSBvcHRpb25zO1xuICAgICAgICAgICAgb3B0aW9ucyA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFwiY2xvc2luZ1wiID09PSB0aGlzLnJlYWR5U3RhdGUgfHwgXCJjbG9zZWRcIiA9PT0gdGhpcy5yZWFkeVN0YXRlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gICAgICAgIG9wdGlvbnMuY29tcHJlc3MgPSBmYWxzZSAhPT0gb3B0aW9ucy5jb21wcmVzcztcbiAgICAgICAgY29uc3QgcGFja2V0ID0ge1xuICAgICAgICAgICAgdHlwZTogdHlwZSxcbiAgICAgICAgICAgIGRhdGE6IGRhdGEsXG4gICAgICAgICAgICBvcHRpb25zOiBvcHRpb25zLFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcInBhY2tldENyZWF0ZVwiLCBwYWNrZXQpO1xuICAgICAgICB0aGlzLndyaXRlQnVmZmVyLnB1c2gocGFja2V0KTtcbiAgICAgICAgaWYgKGZuKVxuICAgICAgICAgICAgdGhpcy5vbmNlKFwiZmx1c2hcIiwgZm4pO1xuICAgICAgICB0aGlzLmZsdXNoKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENsb3NlcyB0aGUgY29ubmVjdGlvbi5cbiAgICAgKi9cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgY29uc3QgY2xvc2UgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9vbkNsb3NlKFwiZm9yY2VkIGNsb3NlXCIpO1xuICAgICAgICAgICAgdGhpcy50cmFuc3BvcnQuY2xvc2UoKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgY2xlYW51cEFuZENsb3NlID0gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5vZmYoXCJ1cGdyYWRlXCIsIGNsZWFudXBBbmRDbG9zZSk7XG4gICAgICAgICAgICB0aGlzLm9mZihcInVwZ3JhZGVFcnJvclwiLCBjbGVhbnVwQW5kQ2xvc2UpO1xuICAgICAgICAgICAgY2xvc2UoKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3Qgd2FpdEZvclVwZ3JhZGUgPSAoKSA9PiB7XG4gICAgICAgICAgICAvLyB3YWl0IGZvciB1cGdyYWRlIHRvIGZpbmlzaCBzaW5jZSB3ZSBjYW4ndCBzZW5kIHBhY2tldHMgd2hpbGUgcGF1c2luZyBhIHRyYW5zcG9ydFxuICAgICAgICAgICAgdGhpcy5vbmNlKFwidXBncmFkZVwiLCBjbGVhbnVwQW5kQ2xvc2UpO1xuICAgICAgICAgICAgdGhpcy5vbmNlKFwidXBncmFkZUVycm9yXCIsIGNsZWFudXBBbmRDbG9zZSk7XG4gICAgICAgIH07XG4gICAgICAgIGlmIChcIm9wZW5pbmdcIiA9PT0gdGhpcy5yZWFkeVN0YXRlIHx8IFwib3BlblwiID09PSB0aGlzLnJlYWR5U3RhdGUpIHtcbiAgICAgICAgICAgIHRoaXMucmVhZHlTdGF0ZSA9IFwiY2xvc2luZ1wiO1xuICAgICAgICAgICAgaWYgKHRoaXMud3JpdGVCdWZmZXIubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbmNlKFwiZHJhaW5cIiwgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy51cGdyYWRpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdhaXRGb3JVcGdyYWRlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLnVwZ3JhZGluZykge1xuICAgICAgICAgICAgICAgIHdhaXRGb3JVcGdyYWRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjbG9zZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgdXBvbiB0cmFuc3BvcnQgZXJyb3JcbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX29uRXJyb3IoZXJyKSB7XG4gICAgICAgIFNvY2tldFdpdGhvdXRVcGdyYWRlLnByaW9yV2Vic29ja2V0U3VjY2VzcyA9IGZhbHNlO1xuICAgICAgICBpZiAodGhpcy5vcHRzLnRyeUFsbFRyYW5zcG9ydHMgJiZcbiAgICAgICAgICAgIHRoaXMudHJhbnNwb3J0cy5sZW5ndGggPiAxICYmXG4gICAgICAgICAgICB0aGlzLnJlYWR5U3RhdGUgPT09IFwib3BlbmluZ1wiKSB7XG4gICAgICAgICAgICB0aGlzLnRyYW5zcG9ydHMuc2hpZnQoKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vcGVuKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJlcnJvclwiLCBlcnIpO1xuICAgICAgICB0aGlzLl9vbkNsb3NlKFwidHJhbnNwb3J0IGVycm9yXCIsIGVycik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxlZCB1cG9uIHRyYW5zcG9ydCBjbG9zZS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX29uQ2xvc2UocmVhc29uLCBkZXNjcmlwdGlvbikge1xuICAgICAgICBpZiAoXCJvcGVuaW5nXCIgPT09IHRoaXMucmVhZHlTdGF0ZSB8fFxuICAgICAgICAgICAgXCJvcGVuXCIgPT09IHRoaXMucmVhZHlTdGF0ZSB8fFxuICAgICAgICAgICAgXCJjbG9zaW5nXCIgPT09IHRoaXMucmVhZHlTdGF0ZSkge1xuICAgICAgICAgICAgLy8gY2xlYXIgdGltZXJzXG4gICAgICAgICAgICB0aGlzLmNsZWFyVGltZW91dEZuKHRoaXMuX3BpbmdUaW1lb3V0VGltZXIpO1xuICAgICAgICAgICAgLy8gc3RvcCBldmVudCBmcm9tIGZpcmluZyBhZ2FpbiBmb3IgdHJhbnNwb3J0XG4gICAgICAgICAgICB0aGlzLnRyYW5zcG9ydC5yZW1vdmVBbGxMaXN0ZW5lcnMoXCJjbG9zZVwiKTtcbiAgICAgICAgICAgIC8vIGVuc3VyZSB0cmFuc3BvcnQgd29uJ3Qgc3RheSBvcGVuXG4gICAgICAgICAgICB0aGlzLnRyYW5zcG9ydC5jbG9zZSgpO1xuICAgICAgICAgICAgLy8gaWdub3JlIGZ1cnRoZXIgdHJhbnNwb3J0IGNvbW11bmljYXRpb25cbiAgICAgICAgICAgIHRoaXMudHJhbnNwb3J0LnJlbW92ZUFsbExpc3RlbmVycygpO1xuICAgICAgICAgICAgaWYgKHdpdGhFdmVudExpc3RlbmVycykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9iZWZvcmV1bmxvYWRFdmVudExpc3RlbmVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZUV2ZW50TGlzdGVuZXIoXCJiZWZvcmV1bmxvYWRcIiwgdGhpcy5fYmVmb3JldW5sb2FkRXZlbnRMaXN0ZW5lciwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fb2ZmbGluZUV2ZW50TGlzdGVuZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IE9GRkxJTkVfRVZFTlRfTElTVEVORVJTLmluZGV4T2YodGhpcy5fb2ZmbGluZUV2ZW50TGlzdGVuZXIpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIE9GRkxJTkVfRVZFTlRfTElTVEVORVJTLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIHNldCByZWFkeSBzdGF0ZVxuICAgICAgICAgICAgdGhpcy5yZWFkeVN0YXRlID0gXCJjbG9zZWRcIjtcbiAgICAgICAgICAgIC8vIGNsZWFyIHNlc3Npb24gaWRcbiAgICAgICAgICAgIHRoaXMuaWQgPSBudWxsO1xuICAgICAgICAgICAgLy8gZW1pdCBjbG9zZSBldmVudFxuICAgICAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJjbG9zZVwiLCByZWFzb24sIGRlc2NyaXB0aW9uKTtcbiAgICAgICAgICAgIC8vIGNsZWFuIGJ1ZmZlcnMgYWZ0ZXIsIHNvIHVzZXJzIGNhbiBzdGlsbFxuICAgICAgICAgICAgLy8gZ3JhYiB0aGUgYnVmZmVycyBvbiBgY2xvc2VgIGV2ZW50XG4gICAgICAgICAgICB0aGlzLndyaXRlQnVmZmVyID0gW107XG4gICAgICAgICAgICB0aGlzLl9wcmV2QnVmZmVyTGVuID0gMDtcbiAgICAgICAgfVxuICAgIH1cbn1cblNvY2tldFdpdGhvdXRVcGdyYWRlLnByb3RvY29sID0gcHJvdG9jb2w7XG4vKipcbiAqIFRoaXMgY2xhc3MgcHJvdmlkZXMgYSBXZWJTb2NrZXQtbGlrZSBpbnRlcmZhY2UgdG8gY29ubmVjdCB0byBhbiBFbmdpbmUuSU8gc2VydmVyLiBUaGUgY29ubmVjdGlvbiB3aWxsIGJlIGVzdGFibGlzaGVkXG4gKiB3aXRoIG9uZSBvZiB0aGUgYXZhaWxhYmxlIGxvdy1sZXZlbCB0cmFuc3BvcnRzLCBsaWtlIEhUVFAgbG9uZy1wb2xsaW5nLCBXZWJTb2NrZXQgb3IgV2ViVHJhbnNwb3J0LlxuICpcbiAqIFRoaXMgY2xhc3MgY29tZXMgd2l0aCBhbiB1cGdyYWRlIG1lY2hhbmlzbSwgd2hpY2ggbWVhbnMgdGhhdCBvbmNlIHRoZSBjb25uZWN0aW9uIGlzIGVzdGFibGlzaGVkIHdpdGggdGhlIGZpcnN0XG4gKiBsb3ctbGV2ZWwgdHJhbnNwb3J0LCBpdCB3aWxsIHRyeSB0byB1cGdyYWRlIHRvIGEgYmV0dGVyIHRyYW5zcG9ydC5cbiAqXG4gKiBJbiBvcmRlciB0byBhbGxvdyB0cmVlLXNoYWtpbmcsIHRoZXJlIGFyZSBubyB0cmFuc3BvcnRzIGluY2x1ZGVkLCB0aGF0J3Mgd2h5IHRoZSBgdHJhbnNwb3J0c2Agb3B0aW9uIGlzIG1hbmRhdG9yeS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgU29ja2V0V2l0aFVwZ3JhZGUsIFdlYlNvY2tldCB9IGZyb20gXCJlbmdpbmUuaW8tY2xpZW50XCI7XG4gKlxuICogY29uc3Qgc29ja2V0ID0gbmV3IFNvY2tldFdpdGhVcGdyYWRlKHtcbiAqICAgdHJhbnNwb3J0czogW1dlYlNvY2tldF1cbiAqIH0pO1xuICpcbiAqIHNvY2tldC5vbihcIm9wZW5cIiwgKCkgPT4ge1xuICogICBzb2NrZXQuc2VuZChcImhlbGxvXCIpO1xuICogfSk7XG4gKlxuICogQHNlZSBTb2NrZXRXaXRob3V0VXBncmFkZVxuICogQHNlZSBTb2NrZXRcbiAqL1xuZXhwb3J0IGNsYXNzIFNvY2tldFdpdGhVcGdyYWRlIGV4dGVuZHMgU29ja2V0V2l0aG91dFVwZ3JhZGUge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlciguLi5hcmd1bWVudHMpO1xuICAgICAgICB0aGlzLl91cGdyYWRlcyA9IFtdO1xuICAgIH1cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIHN1cGVyLm9uT3BlbigpO1xuICAgICAgICBpZiAoXCJvcGVuXCIgPT09IHRoaXMucmVhZHlTdGF0ZSAmJiB0aGlzLm9wdHMudXBncmFkZSkge1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLl91cGdyYWRlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHRoaXMuX3Byb2JlKHRoaXMuX3VwZ3JhZGVzW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBQcm9iZXMgYSB0cmFuc3BvcnQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZSAtIHRyYW5zcG9ydCBuYW1lXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfcHJvYmUobmFtZSkge1xuICAgICAgICBsZXQgdHJhbnNwb3J0ID0gdGhpcy5jcmVhdGVUcmFuc3BvcnQobmFtZSk7XG4gICAgICAgIGxldCBmYWlsZWQgPSBmYWxzZTtcbiAgICAgICAgU29ja2V0V2l0aG91dFVwZ3JhZGUucHJpb3JXZWJzb2NrZXRTdWNjZXNzID0gZmFsc2U7XG4gICAgICAgIGNvbnN0IG9uVHJhbnNwb3J0T3BlbiA9ICgpID0+IHtcbiAgICAgICAgICAgIGlmIChmYWlsZWQpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgdHJhbnNwb3J0LnNlbmQoW3sgdHlwZTogXCJwaW5nXCIsIGRhdGE6IFwicHJvYmVcIiB9XSk7XG4gICAgICAgICAgICB0cmFuc3BvcnQub25jZShcInBhY2tldFwiLCAobXNnKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGZhaWxlZClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIGlmIChcInBvbmdcIiA9PT0gbXNnLnR5cGUgJiYgXCJwcm9iZVwiID09PSBtc2cuZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZ3JhZGluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdFJlc2VydmVkKFwidXBncmFkaW5nXCIsIHRyYW5zcG9ydCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghdHJhbnNwb3J0KVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICBTb2NrZXRXaXRob3V0VXBncmFkZS5wcmlvcldlYnNvY2tldFN1Y2Nlc3MgPVxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ3ZWJzb2NrZXRcIiA9PT0gdHJhbnNwb3J0Lm5hbWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudHJhbnNwb3J0LnBhdXNlKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmYWlsZWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFwiY2xvc2VkXCIgPT09IHRoaXMucmVhZHlTdGF0ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICBjbGVhbnVwKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFRyYW5zcG9ydCh0cmFuc3BvcnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNwb3J0LnNlbmQoW3sgdHlwZTogXCJ1cGdyYWRlXCIgfV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJ1cGdyYWRlXCIsIHRyYW5zcG9ydCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc3BvcnQgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGdyYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmx1c2goKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlcnIgPSBuZXcgRXJyb3IoXCJwcm9iZSBlcnJvclwiKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICBlcnIudHJhbnNwb3J0ID0gdHJhbnNwb3J0Lm5hbWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdFJlc2VydmVkKFwidXBncmFkZUVycm9yXCIsIGVycik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIGZ1bmN0aW9uIGZyZWV6ZVRyYW5zcG9ydCgpIHtcbiAgICAgICAgICAgIGlmIChmYWlsZWQpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgLy8gQW55IGNhbGxiYWNrIGNhbGxlZCBieSB0cmFuc3BvcnQgc2hvdWxkIGJlIGlnbm9yZWQgc2luY2Ugbm93XG4gICAgICAgICAgICBmYWlsZWQgPSB0cnVlO1xuICAgICAgICAgICAgY2xlYW51cCgpO1xuICAgICAgICAgICAgdHJhbnNwb3J0LmNsb3NlKCk7XG4gICAgICAgICAgICB0cmFuc3BvcnQgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIC8vIEhhbmRsZSBhbnkgZXJyb3IgdGhhdCBoYXBwZW5zIHdoaWxlIHByb2JpbmdcbiAgICAgICAgY29uc3Qgb25lcnJvciA9IChlcnIpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKFwicHJvYmUgZXJyb3I6IFwiICsgZXJyKTtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIGVycm9yLnRyYW5zcG9ydCA9IHRyYW5zcG9ydC5uYW1lO1xuICAgICAgICAgICAgZnJlZXplVHJhbnNwb3J0KCk7XG4gICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcInVwZ3JhZGVFcnJvclwiLCBlcnJvcik7XG4gICAgICAgIH07XG4gICAgICAgIGZ1bmN0aW9uIG9uVHJhbnNwb3J0Q2xvc2UoKSB7XG4gICAgICAgICAgICBvbmVycm9yKFwidHJhbnNwb3J0IGNsb3NlZFwiKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBXaGVuIHRoZSBzb2NrZXQgaXMgY2xvc2VkIHdoaWxlIHdlJ3JlIHByb2JpbmdcbiAgICAgICAgZnVuY3Rpb24gb25jbG9zZSgpIHtcbiAgICAgICAgICAgIG9uZXJyb3IoXCJzb2NrZXQgY2xvc2VkXCIpO1xuICAgICAgICB9XG4gICAgICAgIC8vIFdoZW4gdGhlIHNvY2tldCBpcyB1cGdyYWRlZCB3aGlsZSB3ZSdyZSBwcm9iaW5nXG4gICAgICAgIGZ1bmN0aW9uIG9udXBncmFkZSh0bykge1xuICAgICAgICAgICAgaWYgKHRyYW5zcG9ydCAmJiB0by5uYW1lICE9PSB0cmFuc3BvcnQubmFtZSkge1xuICAgICAgICAgICAgICAgIGZyZWV6ZVRyYW5zcG9ydCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIFJlbW92ZSBhbGwgbGlzdGVuZXJzIG9uIHRoZSB0cmFuc3BvcnQgYW5kIG9uIHNlbGZcbiAgICAgICAgY29uc3QgY2xlYW51cCA9ICgpID0+IHtcbiAgICAgICAgICAgIHRyYW5zcG9ydC5yZW1vdmVMaXN0ZW5lcihcIm9wZW5cIiwgb25UcmFuc3BvcnRPcGVuKTtcbiAgICAgICAgICAgIHRyYW5zcG9ydC5yZW1vdmVMaXN0ZW5lcihcImVycm9yXCIsIG9uZXJyb3IpO1xuICAgICAgICAgICAgdHJhbnNwb3J0LnJlbW92ZUxpc3RlbmVyKFwiY2xvc2VcIiwgb25UcmFuc3BvcnRDbG9zZSk7XG4gICAgICAgICAgICB0aGlzLm9mZihcImNsb3NlXCIsIG9uY2xvc2UpO1xuICAgICAgICAgICAgdGhpcy5vZmYoXCJ1cGdyYWRpbmdcIiwgb251cGdyYWRlKTtcbiAgICAgICAgfTtcbiAgICAgICAgdHJhbnNwb3J0Lm9uY2UoXCJvcGVuXCIsIG9uVHJhbnNwb3J0T3Blbik7XG4gICAgICAgIHRyYW5zcG9ydC5vbmNlKFwiZXJyb3JcIiwgb25lcnJvcik7XG4gICAgICAgIHRyYW5zcG9ydC5vbmNlKFwiY2xvc2VcIiwgb25UcmFuc3BvcnRDbG9zZSk7XG4gICAgICAgIHRoaXMub25jZShcImNsb3NlXCIsIG9uY2xvc2UpO1xuICAgICAgICB0aGlzLm9uY2UoXCJ1cGdyYWRpbmdcIiwgb251cGdyYWRlKTtcbiAgICAgICAgaWYgKHRoaXMuX3VwZ3JhZGVzLmluZGV4T2YoXCJ3ZWJ0cmFuc3BvcnRcIikgIT09IC0xICYmXG4gICAgICAgICAgICBuYW1lICE9PSBcIndlYnRyYW5zcG9ydFwiKSB7XG4gICAgICAgICAgICAvLyBmYXZvciBXZWJUcmFuc3BvcnRcbiAgICAgICAgICAgIHRoaXMuc2V0VGltZW91dEZuKCgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIWZhaWxlZCkge1xuICAgICAgICAgICAgICAgICAgICB0cmFuc3BvcnQub3BlbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIDIwMCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0cmFuc3BvcnQub3BlbigpO1xuICAgICAgICB9XG4gICAgfVxuICAgIG9uSGFuZHNoYWtlKGRhdGEpIHtcbiAgICAgICAgdGhpcy5fdXBncmFkZXMgPSB0aGlzLl9maWx0ZXJVcGdyYWRlcyhkYXRhLnVwZ3JhZGVzKTtcbiAgICAgICAgc3VwZXIub25IYW5kc2hha2UoZGF0YSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZpbHRlcnMgdXBncmFkZXMsIHJldHVybmluZyBvbmx5IHRob3NlIG1hdGNoaW5nIGNsaWVudCB0cmFuc3BvcnRzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtBcnJheX0gdXBncmFkZXMgLSBzZXJ2ZXIgdXBncmFkZXNcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9maWx0ZXJVcGdyYWRlcyh1cGdyYWRlcykge1xuICAgICAgICBjb25zdCBmaWx0ZXJlZFVwZ3JhZGVzID0gW107XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdXBncmFkZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmICh+dGhpcy50cmFuc3BvcnRzLmluZGV4T2YodXBncmFkZXNbaV0pKVxuICAgICAgICAgICAgICAgIGZpbHRlcmVkVXBncmFkZXMucHVzaCh1cGdyYWRlc1tpXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZpbHRlcmVkVXBncmFkZXM7XG4gICAgfVxufVxuLyoqXG4gKiBUaGlzIGNsYXNzIHByb3ZpZGVzIGEgV2ViU29ja2V0LWxpa2UgaW50ZXJmYWNlIHRvIGNvbm5lY3QgdG8gYW4gRW5naW5lLklPIHNlcnZlci4gVGhlIGNvbm5lY3Rpb24gd2lsbCBiZSBlc3RhYmxpc2hlZFxuICogd2l0aCBvbmUgb2YgdGhlIGF2YWlsYWJsZSBsb3ctbGV2ZWwgdHJhbnNwb3J0cywgbGlrZSBIVFRQIGxvbmctcG9sbGluZywgV2ViU29ja2V0IG9yIFdlYlRyYW5zcG9ydC5cbiAqXG4gKiBUaGlzIGNsYXNzIGNvbWVzIHdpdGggYW4gdXBncmFkZSBtZWNoYW5pc20sIHdoaWNoIG1lYW5zIHRoYXQgb25jZSB0aGUgY29ubmVjdGlvbiBpcyBlc3RhYmxpc2hlZCB3aXRoIHRoZSBmaXJzdFxuICogbG93LWxldmVsIHRyYW5zcG9ydCwgaXQgd2lsbCB0cnkgdG8gdXBncmFkZSB0byBhIGJldHRlciB0cmFuc3BvcnQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IFNvY2tldCB9IGZyb20gXCJlbmdpbmUuaW8tY2xpZW50XCI7XG4gKlxuICogY29uc3Qgc29ja2V0ID0gbmV3IFNvY2tldCgpO1xuICpcbiAqIHNvY2tldC5vbihcIm9wZW5cIiwgKCkgPT4ge1xuICogICBzb2NrZXQuc2VuZChcImhlbGxvXCIpO1xuICogfSk7XG4gKlxuICogQHNlZSBTb2NrZXRXaXRob3V0VXBncmFkZVxuICogQHNlZSBTb2NrZXRXaXRoVXBncmFkZVxuICovXG5leHBvcnQgY2xhc3MgU29ja2V0IGV4dGVuZHMgU29ja2V0V2l0aFVwZ3JhZGUge1xuICAgIGNvbnN0cnVjdG9yKHVyaSwgb3B0cyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG8gPSB0eXBlb2YgdXJpID09PSBcIm9iamVjdFwiID8gdXJpIDogb3B0cztcbiAgICAgICAgaWYgKCFvLnRyYW5zcG9ydHMgfHxcbiAgICAgICAgICAgIChvLnRyYW5zcG9ydHMgJiYgdHlwZW9mIG8udHJhbnNwb3J0c1swXSA9PT0gXCJzdHJpbmdcIikpIHtcbiAgICAgICAgICAgIG8udHJhbnNwb3J0cyA9IChvLnRyYW5zcG9ydHMgfHwgW1wicG9sbGluZ1wiLCBcIndlYnNvY2tldFwiLCBcIndlYnRyYW5zcG9ydFwiXSlcbiAgICAgICAgICAgICAgICAubWFwKCh0cmFuc3BvcnROYW1lKSA9PiBERUZBVUxUX1RSQU5TUE9SVFNbdHJhbnNwb3J0TmFtZV0pXG4gICAgICAgICAgICAgICAgLmZpbHRlcigodCkgPT4gISF0KTtcbiAgICAgICAgfVxuICAgICAgICBzdXBlcih1cmksIG8pO1xuICAgIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/socket.js\n\n}')},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transport.js":
/*!********************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transport.js ***!
  \********************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Transport: () => (/* binding */ Transport),\n/* harmony export */   TransportError: () => (/* binding */ TransportError)\n/* harmony export */ });\n/* harmony import */ var engine_io_parser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! engine.io-parser */ "./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/index.js");\n/* harmony import */ var _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @socket.io/component-emitter */ "./node_modules/.pnpm/@socket.io+component-emitter@3.1.2/node_modules/@socket.io/component-emitter/lib/esm/index.js");\n/* harmony import */ var _util_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./util.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/util.js");\n/* harmony import */ var _contrib_parseqs_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./contrib/parseqs.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/parseqs.js");\n\n\n\n\nclass TransportError extends Error {\n    constructor(reason, description, context) {\n        super(reason);\n        this.description = description;\n        this.context = context;\n        this.type = "TransportError";\n    }\n}\nclass Transport extends _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_1__.Emitter {\n    /**\n     * Transport abstract constructor.\n     *\n     * @param {Object} opts - options\n     * @protected\n     */\n    constructor(opts) {\n        super();\n        this.writable = false;\n        (0,_util_js__WEBPACK_IMPORTED_MODULE_2__.installTimerFunctions)(this, opts);\n        this.opts = opts;\n        this.query = opts.query;\n        this.socket = opts.socket;\n        this.supportsBinary = !opts.forceBase64;\n    }\n    /**\n     * Emits an error.\n     *\n     * @param {String} reason\n     * @param description\n     * @param context - the error context\n     * @return {Transport} for chaining\n     * @protected\n     */\n    onError(reason, description, context) {\n        super.emitReserved("error", new TransportError(reason, description, context));\n        return this;\n    }\n    /**\n     * Opens the transport.\n     */\n    open() {\n        this.readyState = "opening";\n        this.doOpen();\n        return this;\n    }\n    /**\n     * Closes the transport.\n     */\n    close() {\n        if (this.readyState === "opening" || this.readyState === "open") {\n            this.doClose();\n            this.onClose();\n        }\n        return this;\n    }\n    /**\n     * Sends multiple packets.\n     *\n     * @param {Array} packets\n     */\n    send(packets) {\n        if (this.readyState === "open") {\n            this.write(packets);\n        }\n        else {\n            // this might happen if the transport was silently closed in the beforeunload event handler\n        }\n    }\n    /**\n     * Called upon open\n     *\n     * @protected\n     */\n    onOpen() {\n        this.readyState = "open";\n        this.writable = true;\n        super.emitReserved("open");\n    }\n    /**\n     * Called with data.\n     *\n     * @param {String} data\n     * @protected\n     */\n    onData(data) {\n        const packet = (0,engine_io_parser__WEBPACK_IMPORTED_MODULE_0__.decodePacket)(data, this.socket.binaryType);\n        this.onPacket(packet);\n    }\n    /**\n     * Called with a decoded packet.\n     *\n     * @protected\n     */\n    onPacket(packet) {\n        super.emitReserved("packet", packet);\n    }\n    /**\n     * Called upon close.\n     *\n     * @protected\n     */\n    onClose(details) {\n        this.readyState = "closed";\n        super.emitReserved("close", details);\n    }\n    /**\n     * Pauses the transport, in order not to lose packets during an upgrade.\n     *\n     * @param onPause\n     */\n    pause(onPause) { }\n    createUri(schema, query = {}) {\n        return (schema +\n            "://" +\n            this._hostname() +\n            this._port() +\n            this.opts.path +\n            this._query(query));\n    }\n    _hostname() {\n        const hostname = this.opts.hostname;\n        return hostname.indexOf(":") === -1 ? hostname : "[" + hostname + "]";\n    }\n    _port() {\n        if (this.opts.port &&\n            ((this.opts.secure && Number(this.opts.port !== 443)) ||\n                (!this.opts.secure && Number(this.opts.port) !== 80))) {\n            return ":" + this.opts.port;\n        }\n        else {\n            return "";\n        }\n    }\n    _query(query) {\n        const encodedQuery = (0,_contrib_parseqs_js__WEBPACK_IMPORTED_MODULE_3__.encode)(query);\n        return encodedQuery.length ? "?" + encodedQuery : "";\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdHJhbnNwb3J0LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFnRDtBQUNPO0FBQ0w7QUFDSjtBQUN2QztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ08sd0JBQXdCLGlFQUFPO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSwrREFBcUI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0EsZ0JBQWdCLFdBQVc7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxPQUFPO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBLHVCQUF1Qiw4REFBWTtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQztBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QiwyREFBTTtBQUNuQztBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdHJhbnNwb3J0LmpzPzAzM2UiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZGVjb2RlUGFja2V0IH0gZnJvbSBcImVuZ2luZS5pby1wYXJzZXJcIjtcbmltcG9ydCB7IEVtaXR0ZXIgfSBmcm9tIFwiQHNvY2tldC5pby9jb21wb25lbnQtZW1pdHRlclwiO1xuaW1wb3J0IHsgaW5zdGFsbFRpbWVyRnVuY3Rpb25zIH0gZnJvbSBcIi4vdXRpbC5qc1wiO1xuaW1wb3J0IHsgZW5jb2RlIH0gZnJvbSBcIi4vY29udHJpYi9wYXJzZXFzLmpzXCI7XG5leHBvcnQgY2xhc3MgVHJhbnNwb3J0RXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gICAgY29uc3RydWN0b3IocmVhc29uLCBkZXNjcmlwdGlvbiwgY29udGV4dCkge1xuICAgICAgICBzdXBlcihyZWFzb24pO1xuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XG4gICAgICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQ7XG4gICAgICAgIHRoaXMudHlwZSA9IFwiVHJhbnNwb3J0RXJyb3JcIjtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgVHJhbnNwb3J0IGV4dGVuZHMgRW1pdHRlciB7XG4gICAgLyoqXG4gICAgICogVHJhbnNwb3J0IGFic3RyYWN0IGNvbnN0cnVjdG9yLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9wdHMgLSBvcHRpb25zXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKG9wdHMpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy53cml0YWJsZSA9IGZhbHNlO1xuICAgICAgICBpbnN0YWxsVGltZXJGdW5jdGlvbnModGhpcywgb3B0cyk7XG4gICAgICAgIHRoaXMub3B0cyA9IG9wdHM7XG4gICAgICAgIHRoaXMucXVlcnkgPSBvcHRzLnF1ZXJ5O1xuICAgICAgICB0aGlzLnNvY2tldCA9IG9wdHMuc29ja2V0O1xuICAgICAgICB0aGlzLnN1cHBvcnRzQmluYXJ5ID0gIW9wdHMuZm9yY2VCYXNlNjQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEVtaXRzIGFuIGVycm9yLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHJlYXNvblxuICAgICAqIEBwYXJhbSBkZXNjcmlwdGlvblxuICAgICAqIEBwYXJhbSBjb250ZXh0IC0gdGhlIGVycm9yIGNvbnRleHRcbiAgICAgKiBAcmV0dXJuIHtUcmFuc3BvcnR9IGZvciBjaGFpbmluZ1xuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBvbkVycm9yKHJlYXNvbiwgZGVzY3JpcHRpb24sIGNvbnRleHQpIHtcbiAgICAgICAgc3VwZXIuZW1pdFJlc2VydmVkKFwiZXJyb3JcIiwgbmV3IFRyYW5zcG9ydEVycm9yKHJlYXNvbiwgZGVzY3JpcHRpb24sIGNvbnRleHQpKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE9wZW5zIHRoZSB0cmFuc3BvcnQuXG4gICAgICovXG4gICAgb3BlbigpIHtcbiAgICAgICAgdGhpcy5yZWFkeVN0YXRlID0gXCJvcGVuaW5nXCI7XG4gICAgICAgIHRoaXMuZG9PcGVuKCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDbG9zZXMgdGhlIHRyYW5zcG9ydC5cbiAgICAgKi9cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgaWYgKHRoaXMucmVhZHlTdGF0ZSA9PT0gXCJvcGVuaW5nXCIgfHwgdGhpcy5yZWFkeVN0YXRlID09PSBcIm9wZW5cIikge1xuICAgICAgICAgICAgdGhpcy5kb0Nsb3NlKCk7XG4gICAgICAgICAgICB0aGlzLm9uQ2xvc2UoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VuZHMgbXVsdGlwbGUgcGFja2V0cy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IHBhY2tldHNcbiAgICAgKi9cbiAgICBzZW5kKHBhY2tldHMpIHtcbiAgICAgICAgaWYgKHRoaXMucmVhZHlTdGF0ZSA9PT0gXCJvcGVuXCIpIHtcbiAgICAgICAgICAgIHRoaXMud3JpdGUocGFja2V0cyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyB0aGlzIG1pZ2h0IGhhcHBlbiBpZiB0aGUgdHJhbnNwb3J0IHdhcyBzaWxlbnRseSBjbG9zZWQgaW4gdGhlIGJlZm9yZXVubG9hZCBldmVudCBoYW5kbGVyXG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHVwb24gb3BlblxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIG9uT3BlbigpIHtcbiAgICAgICAgdGhpcy5yZWFkeVN0YXRlID0gXCJvcGVuXCI7XG4gICAgICAgIHRoaXMud3JpdGFibGUgPSB0cnVlO1xuICAgICAgICBzdXBlci5lbWl0UmVzZXJ2ZWQoXCJvcGVuXCIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgd2l0aCBkYXRhLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGRhdGFcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgb25EYXRhKGRhdGEpIHtcbiAgICAgICAgY29uc3QgcGFja2V0ID0gZGVjb2RlUGFja2V0KGRhdGEsIHRoaXMuc29ja2V0LmJpbmFyeVR5cGUpO1xuICAgICAgICB0aGlzLm9uUGFja2V0KHBhY2tldCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxlZCB3aXRoIGEgZGVjb2RlZCBwYWNrZXQuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgb25QYWNrZXQocGFja2V0KSB7XG4gICAgICAgIHN1cGVyLmVtaXRSZXNlcnZlZChcInBhY2tldFwiLCBwYWNrZXQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgdXBvbiBjbG9zZS5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBvbkNsb3NlKGRldGFpbHMpIHtcbiAgICAgICAgdGhpcy5yZWFkeVN0YXRlID0gXCJjbG9zZWRcIjtcbiAgICAgICAgc3VwZXIuZW1pdFJlc2VydmVkKFwiY2xvc2VcIiwgZGV0YWlscyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBhdXNlcyB0aGUgdHJhbnNwb3J0LCBpbiBvcmRlciBub3QgdG8gbG9zZSBwYWNrZXRzIGR1cmluZyBhbiB1cGdyYWRlLlxuICAgICAqXG4gICAgICogQHBhcmFtIG9uUGF1c2VcbiAgICAgKi9cbiAgICBwYXVzZShvblBhdXNlKSB7IH1cbiAgICBjcmVhdGVVcmkoc2NoZW1hLCBxdWVyeSA9IHt9KSB7XG4gICAgICAgIHJldHVybiAoc2NoZW1hICtcbiAgICAgICAgICAgIFwiOi8vXCIgK1xuICAgICAgICAgICAgdGhpcy5faG9zdG5hbWUoKSArXG4gICAgICAgICAgICB0aGlzLl9wb3J0KCkgK1xuICAgICAgICAgICAgdGhpcy5vcHRzLnBhdGggK1xuICAgICAgICAgICAgdGhpcy5fcXVlcnkocXVlcnkpKTtcbiAgICB9XG4gICAgX2hvc3RuYW1lKCkge1xuICAgICAgICBjb25zdCBob3N0bmFtZSA9IHRoaXMub3B0cy5ob3N0bmFtZTtcbiAgICAgICAgcmV0dXJuIGhvc3RuYW1lLmluZGV4T2YoXCI6XCIpID09PSAtMSA/IGhvc3RuYW1lIDogXCJbXCIgKyBob3N0bmFtZSArIFwiXVwiO1xuICAgIH1cbiAgICBfcG9ydCgpIHtcbiAgICAgICAgaWYgKHRoaXMub3B0cy5wb3J0ICYmXG4gICAgICAgICAgICAoKHRoaXMub3B0cy5zZWN1cmUgJiYgTnVtYmVyKHRoaXMub3B0cy5wb3J0ICE9PSA0NDMpKSB8fFxuICAgICAgICAgICAgICAgICghdGhpcy5vcHRzLnNlY3VyZSAmJiBOdW1iZXIodGhpcy5vcHRzLnBvcnQpICE9PSA4MCkpKSB7XG4gICAgICAgICAgICByZXR1cm4gXCI6XCIgKyB0aGlzLm9wdHMucG9ydDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9xdWVyeShxdWVyeSkge1xuICAgICAgICBjb25zdCBlbmNvZGVkUXVlcnkgPSBlbmNvZGUocXVlcnkpO1xuICAgICAgICByZXR1cm4gZW5jb2RlZFF1ZXJ5Lmxlbmd0aCA/IFwiP1wiICsgZW5jb2RlZFF1ZXJ5IDogXCJcIjtcbiAgICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transport.js\n\n}')},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/index.js":
/*!***************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/index.js ***!
  \***************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   transports: () => (/* binding */ transports)\n/* harmony export */ });\n/* harmony import */ var _polling_xhr_node_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./polling-xhr.node.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling-xhr.js");\n/* harmony import */ var _websocket_node_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./websocket.node.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/websocket.js");\n/* harmony import */ var _webtransport_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./webtransport.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/webtransport.js");\n\n\n\nconst transports = {\n    websocket: _websocket_node_js__WEBPACK_IMPORTED_MODULE_1__.WS,\n    webtransport: _webtransport_js__WEBPACK_IMPORTED_MODULE_2__.WT,\n    polling: _polling_xhr_node_js__WEBPACK_IMPORTED_MODULE_0__.XHR,\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdHJhbnNwb3J0cy9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQTRDO0FBQ0g7QUFDRjtBQUNoQztBQUNQLGVBQWUsa0RBQUU7QUFDakIsa0JBQWtCLGdEQUFFO0FBQ3BCLGFBQWEscURBQUc7QUFDaEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdHJhbnNwb3J0cy9pbmRleC5qcz8zMDQ0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFhIUiB9IGZyb20gXCIuL3BvbGxpbmcteGhyLm5vZGUuanNcIjtcbmltcG9ydCB7IFdTIH0gZnJvbSBcIi4vd2Vic29ja2V0Lm5vZGUuanNcIjtcbmltcG9ydCB7IFdUIH0gZnJvbSBcIi4vd2VidHJhbnNwb3J0LmpzXCI7XG5leHBvcnQgY29uc3QgdHJhbnNwb3J0cyA9IHtcbiAgICB3ZWJzb2NrZXQ6IFdTLFxuICAgIHdlYnRyYW5zcG9ydDogV1QsXG4gICAgcG9sbGluZzogWEhSLFxufTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/index.js\n\n}')},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling-fetch.js":
/*!***********************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling-fetch.js ***!
  \***********************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Fetch: () => (/* binding */ Fetch)\n/* harmony export */ });\n/* harmony import */ var _polling_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./polling.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling.js");\n\n/**\n * HTTP long-polling based on the built-in `fetch()` method.\n *\n * Usage: browser, Node.js (since v18), Deno, Bun\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/fetch\n * @see https://caniuse.com/fetch\n * @see https://nodejs.org/api/globals.html#fetch\n */\nclass Fetch extends _polling_js__WEBPACK_IMPORTED_MODULE_0__.Polling {\n    doPoll() {\n        this._fetch()\n            .then((res) => {\n            if (!res.ok) {\n                return this.onError("fetch read error", res.status, res);\n            }\n            res.text().then((data) => this.onData(data));\n        })\n            .catch((err) => {\n            this.onError("fetch read error", err);\n        });\n    }\n    doWrite(data, callback) {\n        this._fetch(data)\n            .then((res) => {\n            if (!res.ok) {\n                return this.onError("fetch write error", res.status, res);\n            }\n            callback();\n        })\n            .catch((err) => {\n            this.onError("fetch write error", err);\n        });\n    }\n    _fetch(data) {\n        var _a;\n        const isPost = data !== undefined;\n        const headers = new Headers(this.opts.extraHeaders);\n        if (isPost) {\n            headers.set("content-type", "text/plain;charset=UTF-8");\n        }\n        (_a = this.socket._cookieJar) === null || _a === void 0 ? void 0 : _a.appendCookies(headers);\n        return fetch(this.uri(), {\n            method: isPost ? "POST" : "GET",\n            body: isPost ? data : null,\n            headers,\n            credentials: this.opts.withCredentials ? "include" : "omit",\n        }).then((res) => {\n            var _a;\n            // @ts-ignore getSetCookie() was added in Node.js v19.7.0\n            (_a = this.socket._cookieJar) === null || _a === void 0 ? void 0 : _a.parseCookies(res.headers.getSetCookie());\n            return res;\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdHJhbnNwb3J0cy9wb2xsaW5nLWZldGNoLmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQXVDO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPLG9CQUFvQixnREFBTztBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvREFBb0Q7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL25vZGVfbW9kdWxlcy8ucG5wbS9lbmdpbmUuaW8tY2xpZW50QDYuNi4zL25vZGVfbW9kdWxlcy9lbmdpbmUuaW8tY2xpZW50L2J1aWxkL2VzbS90cmFuc3BvcnRzL3BvbGxpbmctZmV0Y2guanM/N2ZkMiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQb2xsaW5nIH0gZnJvbSBcIi4vcG9sbGluZy5qc1wiO1xuLyoqXG4gKiBIVFRQIGxvbmctcG9sbGluZyBiYXNlZCBvbiB0aGUgYnVpbHQtaW4gYGZldGNoKClgIG1ldGhvZC5cbiAqXG4gKiBVc2FnZTogYnJvd3NlciwgTm9kZS5qcyAoc2luY2UgdjE4KSwgRGVubywgQnVuXG4gKlxuICogQHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvZmV0Y2hcbiAqIEBzZWUgaHR0cHM6Ly9jYW5pdXNlLmNvbS9mZXRjaFxuICogQHNlZSBodHRwczovL25vZGVqcy5vcmcvYXBpL2dsb2JhbHMuaHRtbCNmZXRjaFxuICovXG5leHBvcnQgY2xhc3MgRmV0Y2ggZXh0ZW5kcyBQb2xsaW5nIHtcbiAgICBkb1BvbGwoKSB7XG4gICAgICAgIHRoaXMuX2ZldGNoKClcbiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgIGlmICghcmVzLm9rKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMub25FcnJvcihcImZldGNoIHJlYWQgZXJyb3JcIiwgcmVzLnN0YXR1cywgcmVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlcy50ZXh0KCkudGhlbigoZGF0YSkgPT4gdGhpcy5vbkRhdGEoZGF0YSkpO1xuICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIHRoaXMub25FcnJvcihcImZldGNoIHJlYWQgZXJyb3JcIiwgZXJyKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGRvV3JpdGUoZGF0YSwgY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5fZmV0Y2goZGF0YSlcbiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgIGlmICghcmVzLm9rKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMub25FcnJvcihcImZldGNoIHdyaXRlIGVycm9yXCIsIHJlcy5zdGF0dXMsIHJlcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIHRoaXMub25FcnJvcihcImZldGNoIHdyaXRlIGVycm9yXCIsIGVycik7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBfZmV0Y2goZGF0YSkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGNvbnN0IGlzUG9zdCA9IGRhdGEgIT09IHVuZGVmaW5lZDtcbiAgICAgICAgY29uc3QgaGVhZGVycyA9IG5ldyBIZWFkZXJzKHRoaXMub3B0cy5leHRyYUhlYWRlcnMpO1xuICAgICAgICBpZiAoaXNQb3N0KSB7XG4gICAgICAgICAgICBoZWFkZXJzLnNldChcImNvbnRlbnQtdHlwZVwiLCBcInRleHQvcGxhaW47Y2hhcnNldD1VVEYtOFwiKTtcbiAgICAgICAgfVxuICAgICAgICAoX2EgPSB0aGlzLnNvY2tldC5fY29va2llSmFyKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuYXBwZW5kQ29va2llcyhoZWFkZXJzKTtcbiAgICAgICAgcmV0dXJuIGZldGNoKHRoaXMudXJpKCksIHtcbiAgICAgICAgICAgIG1ldGhvZDogaXNQb3N0ID8gXCJQT1NUXCIgOiBcIkdFVFwiLFxuICAgICAgICAgICAgYm9keTogaXNQb3N0ID8gZGF0YSA6IG51bGwsXG4gICAgICAgICAgICBoZWFkZXJzLFxuICAgICAgICAgICAgY3JlZGVudGlhbHM6IHRoaXMub3B0cy53aXRoQ3JlZGVudGlhbHMgPyBcImluY2x1ZGVcIiA6IFwib21pdFwiLFxuICAgICAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUgZ2V0U2V0Q29va2llKCkgd2FzIGFkZGVkIGluIE5vZGUuanMgdjE5LjcuMFxuICAgICAgICAgICAgKF9hID0gdGhpcy5zb2NrZXQuX2Nvb2tpZUphcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnBhcnNlQ29va2llcyhyZXMuaGVhZGVycy5nZXRTZXRDb29raWUoKSk7XG4gICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICB9KTtcbiAgICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling-fetch.js\n\n}')},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling-xhr.js":
/*!*********************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling-xhr.js ***!
  \*********************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BaseXHR: () => (/* binding */ BaseXHR),\n/* harmony export */   Request: () => (/* binding */ Request),\n/* harmony export */   XHR: () => (/* binding */ XHR)\n/* harmony export */ });\n/* harmony import */ var _polling_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./polling.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling.js");\n/* harmony import */ var _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @socket.io/component-emitter */ "./node_modules/.pnpm/@socket.io+component-emitter@3.1.2/node_modules/@socket.io/component-emitter/lib/esm/index.js");\n/* harmony import */ var _util_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../util.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/util.js");\n/* harmony import */ var _globals_node_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../globals.node.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/globals.js");\n/* harmony import */ var _contrib_has_cors_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../contrib/has-cors.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/has-cors.js");\n\n\n\n\n\nfunction empty() { }\nclass BaseXHR extends _polling_js__WEBPACK_IMPORTED_MODULE_0__.Polling {\n    /**\n     * XHR Polling constructor.\n     *\n     * @param {Object} opts\n     * @package\n     */\n    constructor(opts) {\n        super(opts);\n        if (typeof location !== "undefined") {\n            const isSSL = "https:" === location.protocol;\n            let port = location.port;\n            // some user agents have empty `location.port`\n            if (!port) {\n                port = isSSL ? "443" : "80";\n            }\n            this.xd =\n                (typeof location !== "undefined" &&\n                    opts.hostname !== location.hostname) ||\n                    port !== opts.port;\n        }\n    }\n    /**\n     * Sends data.\n     *\n     * @param {String} data to send.\n     * @param {Function} called upon flush.\n     * @private\n     */\n    doWrite(data, fn) {\n        const req = this.request({\n            method: "POST",\n            data: data,\n        });\n        req.on("success", fn);\n        req.on("error", (xhrStatus, context) => {\n            this.onError("xhr post error", xhrStatus, context);\n        });\n    }\n    /**\n     * Starts a poll cycle.\n     *\n     * @private\n     */\n    doPoll() {\n        const req = this.request();\n        req.on("data", this.onData.bind(this));\n        req.on("error", (xhrStatus, context) => {\n            this.onError("xhr poll error", xhrStatus, context);\n        });\n        this.pollXhr = req;\n    }\n}\nclass Request extends _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_1__.Emitter {\n    /**\n     * Request constructor\n     *\n     * @param {Object} options\n     * @package\n     */\n    constructor(createRequest, uri, opts) {\n        super();\n        this.createRequest = createRequest;\n        (0,_util_js__WEBPACK_IMPORTED_MODULE_2__.installTimerFunctions)(this, opts);\n        this._opts = opts;\n        this._method = opts.method || "GET";\n        this._uri = uri;\n        this._data = undefined !== opts.data ? opts.data : null;\n        this._create();\n    }\n    /**\n     * Creates the XHR object and sends the request.\n     *\n     * @private\n     */\n    _create() {\n        var _a;\n        const opts = (0,_util_js__WEBPACK_IMPORTED_MODULE_2__.pick)(this._opts, "agent", "pfx", "key", "passphrase", "cert", "ca", "ciphers", "rejectUnauthorized", "autoUnref");\n        opts.xdomain = !!this._opts.xd;\n        const xhr = (this._xhr = this.createRequest(opts));\n        try {\n            xhr.open(this._method, this._uri, true);\n            try {\n                if (this._opts.extraHeaders) {\n                    // @ts-ignore\n                    xhr.setDisableHeaderCheck && xhr.setDisableHeaderCheck(true);\n                    for (let i in this._opts.extraHeaders) {\n                        if (this._opts.extraHeaders.hasOwnProperty(i)) {\n                            xhr.setRequestHeader(i, this._opts.extraHeaders[i]);\n                        }\n                    }\n                }\n            }\n            catch (e) { }\n            if ("POST" === this._method) {\n                try {\n                    xhr.setRequestHeader("Content-type", "text/plain;charset=UTF-8");\n                }\n                catch (e) { }\n            }\n            try {\n                xhr.setRequestHeader("Accept", "*/*");\n            }\n            catch (e) { }\n            (_a = this._opts.cookieJar) === null || _a === void 0 ? void 0 : _a.addCookies(xhr);\n            // ie6 check\n            if ("withCredentials" in xhr) {\n                xhr.withCredentials = this._opts.withCredentials;\n            }\n            if (this._opts.requestTimeout) {\n                xhr.timeout = this._opts.requestTimeout;\n            }\n            xhr.onreadystatechange = () => {\n                var _a;\n                if (xhr.readyState === 3) {\n                    (_a = this._opts.cookieJar) === null || _a === void 0 ? void 0 : _a.parseCookies(\n                    // @ts-ignore\n                    xhr.getResponseHeader("set-cookie"));\n                }\n                if (4 !== xhr.readyState)\n                    return;\n                if (200 === xhr.status || 1223 === xhr.status) {\n                    this._onLoad();\n                }\n                else {\n                    // make sure the `error` event handler that\'s user-set\n                    // does not throw in the same tick and gets caught here\n                    this.setTimeoutFn(() => {\n                        this._onError(typeof xhr.status === "number" ? xhr.status : 0);\n                    }, 0);\n                }\n            };\n            xhr.send(this._data);\n        }\n        catch (e) {\n            // Need to defer since .create() is called directly from the constructor\n            // and thus the \'error\' event can only be only bound *after* this exception\n            // occurs.  Therefore, also, we cannot throw here at all.\n            this.setTimeoutFn(() => {\n                this._onError(e);\n            }, 0);\n            return;\n        }\n        if (typeof document !== "undefined") {\n            this._index = Request.requestsCount++;\n            Request.requests[this._index] = this;\n        }\n    }\n    /**\n     * Called upon error.\n     *\n     * @private\n     */\n    _onError(err) {\n        this.emitReserved("error", err, this._xhr);\n        this._cleanup(true);\n    }\n    /**\n     * Cleans up house.\n     *\n     * @private\n     */\n    _cleanup(fromError) {\n        if ("undefined" === typeof this._xhr || null === this._xhr) {\n            return;\n        }\n        this._xhr.onreadystatechange = empty;\n        if (fromError) {\n            try {\n                this._xhr.abort();\n            }\n            catch (e) { }\n        }\n        if (typeof document !== "undefined") {\n            delete Request.requests[this._index];\n        }\n        this._xhr = null;\n    }\n    /**\n     * Called upon load.\n     *\n     * @private\n     */\n    _onLoad() {\n        const data = this._xhr.responseText;\n        if (data !== null) {\n            this.emitReserved("data", data);\n            this.emitReserved("success");\n            this._cleanup();\n        }\n    }\n    /**\n     * Aborts the request.\n     *\n     * @package\n     */\n    abort() {\n        this._cleanup();\n    }\n}\nRequest.requestsCount = 0;\nRequest.requests = {};\n/**\n * Aborts pending requests when unloading the window. This is needed to prevent\n * memory leaks (e.g. when using IE) and to ensure that no spurious error is\n * emitted.\n */\nif (typeof document !== "undefined") {\n    // @ts-ignore\n    if (typeof attachEvent === "function") {\n        // @ts-ignore\n        attachEvent("onunload", unloadHandler);\n    }\n    else if (typeof addEventListener === "function") {\n        const terminationEvent = "onpagehide" in _globals_node_js__WEBPACK_IMPORTED_MODULE_3__.globalThisShim ? "pagehide" : "unload";\n        addEventListener(terminationEvent, unloadHandler, false);\n    }\n}\nfunction unloadHandler() {\n    for (let i in Request.requests) {\n        if (Request.requests.hasOwnProperty(i)) {\n            Request.requests[i].abort();\n        }\n    }\n}\nconst hasXHR2 = (function () {\n    const xhr = newRequest({\n        xdomain: false,\n    });\n    return xhr && xhr.responseType !== null;\n})();\n/**\n * HTTP long-polling based on the built-in `XMLHttpRequest` object.\n *\n * Usage: browser\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest\n */\nclass XHR extends BaseXHR {\n    constructor(opts) {\n        super(opts);\n        const forceBase64 = opts && opts.forceBase64;\n        this.supportsBinary = hasXHR2 && !forceBase64;\n    }\n    request(opts = {}) {\n        Object.assign(opts, { xd: this.xd }, this.opts);\n        return new Request(newRequest, this.uri(), opts);\n    }\n}\nfunction newRequest(opts) {\n    const xdomain = opts.xdomain;\n    // XMLHttpRequest can be disabled on IE\n    try {\n        if ("undefined" !== typeof XMLHttpRequest && (!xdomain || _contrib_has_cors_js__WEBPACK_IMPORTED_MODULE_4__.hasCORS)) {\n            return new XMLHttpRequest();\n        }\n    }\n    catch (e) { }\n    if (!xdomain) {\n        try {\n            return new _globals_node_js__WEBPACK_IMPORTED_MODULE_3__.globalThisShim[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP");\n        }\n        catch (e) { }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdHJhbnNwb3J0cy9wb2xsaW5nLXhoci5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUF1QztBQUNnQjtBQUNFO0FBQ1M7QUFDakI7QUFDakQ7QUFDTyxzQkFBc0IsZ0RBQU87QUFDcEM7QUFDQTtBQUNBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkIsZUFBZSxVQUFVO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDTyxzQkFBc0IsaUVBQU87QUFDcEM7QUFDQTtBQUNBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLCtEQUFxQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQiw4Q0FBSTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxRUFBcUU7QUFDckU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyw0RUFBMEI7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckIsOEJBQThCLGFBQWE7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrRUFBa0UseURBQU87QUFDekU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLDREQUFVO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2VuZ2luZS5pby1jbGllbnRANi42LjMvbm9kZV9tb2R1bGVzL2VuZ2luZS5pby1jbGllbnQvYnVpbGQvZXNtL3RyYW5zcG9ydHMvcG9sbGluZy14aHIuanM/ZjcxZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQb2xsaW5nIH0gZnJvbSBcIi4vcG9sbGluZy5qc1wiO1xuaW1wb3J0IHsgRW1pdHRlciB9IGZyb20gXCJAc29ja2V0LmlvL2NvbXBvbmVudC1lbWl0dGVyXCI7XG5pbXBvcnQgeyBpbnN0YWxsVGltZXJGdW5jdGlvbnMsIHBpY2sgfSBmcm9tIFwiLi4vdXRpbC5qc1wiO1xuaW1wb3J0IHsgZ2xvYmFsVGhpc1NoaW0gYXMgZ2xvYmFsVGhpcyB9IGZyb20gXCIuLi9nbG9iYWxzLm5vZGUuanNcIjtcbmltcG9ydCB7IGhhc0NPUlMgfSBmcm9tIFwiLi4vY29udHJpYi9oYXMtY29ycy5qc1wiO1xuZnVuY3Rpb24gZW1wdHkoKSB7IH1cbmV4cG9ydCBjbGFzcyBCYXNlWEhSIGV4dGVuZHMgUG9sbGluZyB7XG4gICAgLyoqXG4gICAgICogWEhSIFBvbGxpbmcgY29uc3RydWN0b3IuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb3B0c1xuICAgICAqIEBwYWNrYWdlXG4gICAgICovXG4gICAgY29uc3RydWN0b3Iob3B0cykge1xuICAgICAgICBzdXBlcihvcHRzKTtcbiAgICAgICAgaWYgKHR5cGVvZiBsb2NhdGlvbiAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgICAgY29uc3QgaXNTU0wgPSBcImh0dHBzOlwiID09PSBsb2NhdGlvbi5wcm90b2NvbDtcbiAgICAgICAgICAgIGxldCBwb3J0ID0gbG9jYXRpb24ucG9ydDtcbiAgICAgICAgICAgIC8vIHNvbWUgdXNlciBhZ2VudHMgaGF2ZSBlbXB0eSBgbG9jYXRpb24ucG9ydGBcbiAgICAgICAgICAgIGlmICghcG9ydCkge1xuICAgICAgICAgICAgICAgIHBvcnQgPSBpc1NTTCA/IFwiNDQzXCIgOiBcIjgwXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnhkID1cbiAgICAgICAgICAgICAgICAodHlwZW9mIGxvY2F0aW9uICE9PSBcInVuZGVmaW5lZFwiICYmXG4gICAgICAgICAgICAgICAgICAgIG9wdHMuaG9zdG5hbWUgIT09IGxvY2F0aW9uLmhvc3RuYW1lKSB8fFxuICAgICAgICAgICAgICAgICAgICBwb3J0ICE9PSBvcHRzLnBvcnQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VuZHMgZGF0YS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBkYXRhIHRvIHNlbmQuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGVkIHVwb24gZmx1c2guXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBkb1dyaXRlKGRhdGEsIGZuKSB7XG4gICAgICAgIGNvbnN0IHJlcSA9IHRoaXMucmVxdWVzdCh7XG4gICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgICAgZGF0YTogZGF0YSxcbiAgICAgICAgfSk7XG4gICAgICAgIHJlcS5vbihcInN1Y2Nlc3NcIiwgZm4pO1xuICAgICAgICByZXEub24oXCJlcnJvclwiLCAoeGhyU3RhdHVzLCBjb250ZXh0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLm9uRXJyb3IoXCJ4aHIgcG9zdCBlcnJvclwiLCB4aHJTdGF0dXMsIGNvbnRleHQpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3RhcnRzIGEgcG9sbCBjeWNsZS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgZG9Qb2xsKCkge1xuICAgICAgICBjb25zdCByZXEgPSB0aGlzLnJlcXVlc3QoKTtcbiAgICAgICAgcmVxLm9uKFwiZGF0YVwiLCB0aGlzLm9uRGF0YS5iaW5kKHRoaXMpKTtcbiAgICAgICAgcmVxLm9uKFwiZXJyb3JcIiwgKHhoclN0YXR1cywgY29udGV4dCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5vbkVycm9yKFwieGhyIHBvbGwgZXJyb3JcIiwgeGhyU3RhdHVzLCBjb250ZXh0KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMucG9sbFhociA9IHJlcTtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgUmVxdWVzdCBleHRlbmRzIEVtaXR0ZXIge1xuICAgIC8qKlxuICAgICAqIFJlcXVlc3QgY29uc3RydWN0b3JcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zXG4gICAgICogQHBhY2thZ2VcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihjcmVhdGVSZXF1ZXN0LCB1cmksIG9wdHMpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5jcmVhdGVSZXF1ZXN0ID0gY3JlYXRlUmVxdWVzdDtcbiAgICAgICAgaW5zdGFsbFRpbWVyRnVuY3Rpb25zKHRoaXMsIG9wdHMpO1xuICAgICAgICB0aGlzLl9vcHRzID0gb3B0cztcbiAgICAgICAgdGhpcy5fbWV0aG9kID0gb3B0cy5tZXRob2QgfHwgXCJHRVRcIjtcbiAgICAgICAgdGhpcy5fdXJpID0gdXJpO1xuICAgICAgICB0aGlzLl9kYXRhID0gdW5kZWZpbmVkICE9PSBvcHRzLmRhdGEgPyBvcHRzLmRhdGEgOiBudWxsO1xuICAgICAgICB0aGlzLl9jcmVhdGUoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyB0aGUgWEhSIG9iamVjdCBhbmQgc2VuZHMgdGhlIHJlcXVlc3QuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9jcmVhdGUoKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgY29uc3Qgb3B0cyA9IHBpY2sodGhpcy5fb3B0cywgXCJhZ2VudFwiLCBcInBmeFwiLCBcImtleVwiLCBcInBhc3NwaHJhc2VcIiwgXCJjZXJ0XCIsIFwiY2FcIiwgXCJjaXBoZXJzXCIsIFwicmVqZWN0VW5hdXRob3JpemVkXCIsIFwiYXV0b1VucmVmXCIpO1xuICAgICAgICBvcHRzLnhkb21haW4gPSAhIXRoaXMuX29wdHMueGQ7XG4gICAgICAgIGNvbnN0IHhociA9ICh0aGlzLl94aHIgPSB0aGlzLmNyZWF0ZVJlcXVlc3Qob3B0cykpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgeGhyLm9wZW4odGhpcy5fbWV0aG9kLCB0aGlzLl91cmksIHRydWUpO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fb3B0cy5leHRyYUhlYWRlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICB4aHIuc2V0RGlzYWJsZUhlYWRlckNoZWNrICYmIHhoci5zZXREaXNhYmxlSGVhZGVyQ2hlY2sodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgaW4gdGhpcy5fb3B0cy5leHRyYUhlYWRlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9vcHRzLmV4dHJhSGVhZGVycy5oYXNPd25Qcm9wZXJ0eShpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKGksIHRoaXMuX29wdHMuZXh0cmFIZWFkZXJzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7IH1cbiAgICAgICAgICAgIGlmIChcIlBPU1RcIiA9PT0gdGhpcy5fbWV0aG9kKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoXCJDb250ZW50LXR5cGVcIiwgXCJ0ZXh0L3BsYWluO2NoYXJzZXQ9VVRGLThcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7IH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoXCJBY2NlcHRcIiwgXCIqLypcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkgeyB9XG4gICAgICAgICAgICAoX2EgPSB0aGlzLl9vcHRzLmNvb2tpZUphcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmFkZENvb2tpZXMoeGhyKTtcbiAgICAgICAgICAgIC8vIGllNiBjaGVja1xuICAgICAgICAgICAgaWYgKFwid2l0aENyZWRlbnRpYWxzXCIgaW4geGhyKSB7XG4gICAgICAgICAgICAgICAgeGhyLndpdGhDcmVkZW50aWFscyA9IHRoaXMuX29wdHMud2l0aENyZWRlbnRpYWxzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuX29wdHMucmVxdWVzdFRpbWVvdXQpIHtcbiAgICAgICAgICAgICAgICB4aHIudGltZW91dCA9IHRoaXMuX29wdHMucmVxdWVzdFRpbWVvdXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgICAgICBpZiAoeGhyLnJlYWR5U3RhdGUgPT09IDMpIHtcbiAgICAgICAgICAgICAgICAgICAgKF9hID0gdGhpcy5fb3B0cy5jb29raWVKYXIpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5wYXJzZUNvb2tpZXMoXG4gICAgICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICAgICAgeGhyLmdldFJlc3BvbnNlSGVhZGVyKFwic2V0LWNvb2tpZVwiKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICg0ICE9PSB4aHIucmVhZHlTdGF0ZSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIGlmICgyMDAgPT09IHhoci5zdGF0dXMgfHwgMTIyMyA9PT0geGhyLnN0YXR1cykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9vbkxvYWQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIG1ha2Ugc3VyZSB0aGUgYGVycm9yYCBldmVudCBoYW5kbGVyIHRoYXQncyB1c2VyLXNldFxuICAgICAgICAgICAgICAgICAgICAvLyBkb2VzIG5vdCB0aHJvdyBpbiB0aGUgc2FtZSB0aWNrIGFuZCBnZXRzIGNhdWdodCBoZXJlXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0VGltZW91dEZuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX29uRXJyb3IodHlwZW9mIHhoci5zdGF0dXMgPT09IFwibnVtYmVyXCIgPyB4aHIuc3RhdHVzIDogMCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB4aHIuc2VuZCh0aGlzLl9kYXRhKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgLy8gTmVlZCB0byBkZWZlciBzaW5jZSAuY3JlYXRlKCkgaXMgY2FsbGVkIGRpcmVjdGx5IGZyb20gdGhlIGNvbnN0cnVjdG9yXG4gICAgICAgICAgICAvLyBhbmQgdGh1cyB0aGUgJ2Vycm9yJyBldmVudCBjYW4gb25seSBiZSBvbmx5IGJvdW5kICphZnRlciogdGhpcyBleGNlcHRpb25cbiAgICAgICAgICAgIC8vIG9jY3Vycy4gIFRoZXJlZm9yZSwgYWxzbywgd2UgY2Fubm90IHRocm93IGhlcmUgYXQgYWxsLlxuICAgICAgICAgICAgdGhpcy5zZXRUaW1lb3V0Rm4oKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uRXJyb3IoZSk7XG4gICAgICAgICAgICB9LCAwKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGRvY3VtZW50ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICB0aGlzLl9pbmRleCA9IFJlcXVlc3QucmVxdWVzdHNDb3VudCsrO1xuICAgICAgICAgICAgUmVxdWVzdC5yZXF1ZXN0c1t0aGlzLl9pbmRleF0gPSB0aGlzO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxlZCB1cG9uIGVycm9yLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfb25FcnJvcihlcnIpIHtcbiAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJlcnJvclwiLCBlcnIsIHRoaXMuX3hocik7XG4gICAgICAgIHRoaXMuX2NsZWFudXAodHJ1ZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENsZWFucyB1cCBob3VzZS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2NsZWFudXAoZnJvbUVycm9yKSB7XG4gICAgICAgIGlmIChcInVuZGVmaW5lZFwiID09PSB0eXBlb2YgdGhpcy5feGhyIHx8IG51bGwgPT09IHRoaXMuX3hocikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3hoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBlbXB0eTtcbiAgICAgICAgaWYgKGZyb21FcnJvcikge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0aGlzLl94aHIuYWJvcnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7IH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGRvY3VtZW50ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICBkZWxldGUgUmVxdWVzdC5yZXF1ZXN0c1t0aGlzLl9pbmRleF07XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5feGhyID0gbnVsbDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHVwb24gbG9hZC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX29uTG9hZCgpIHtcbiAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMuX3hoci5yZXNwb25zZVRleHQ7XG4gICAgICAgIGlmIChkYXRhICE9PSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcImRhdGFcIiwgZGF0YSk7XG4gICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcInN1Y2Nlc3NcIik7XG4gICAgICAgICAgICB0aGlzLl9jbGVhbnVwKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQWJvcnRzIHRoZSByZXF1ZXN0LlxuICAgICAqXG4gICAgICogQHBhY2thZ2VcbiAgICAgKi9cbiAgICBhYm9ydCgpIHtcbiAgICAgICAgdGhpcy5fY2xlYW51cCgpO1xuICAgIH1cbn1cblJlcXVlc3QucmVxdWVzdHNDb3VudCA9IDA7XG5SZXF1ZXN0LnJlcXVlc3RzID0ge307XG4vKipcbiAqIEFib3J0cyBwZW5kaW5nIHJlcXVlc3RzIHdoZW4gdW5sb2FkaW5nIHRoZSB3aW5kb3cuIFRoaXMgaXMgbmVlZGVkIHRvIHByZXZlbnRcbiAqIG1lbW9yeSBsZWFrcyAoZS5nLiB3aGVuIHVzaW5nIElFKSBhbmQgdG8gZW5zdXJlIHRoYXQgbm8gc3B1cmlvdXMgZXJyb3IgaXNcbiAqIGVtaXR0ZWQuXG4gKi9cbmlmICh0eXBlb2YgZG9jdW1lbnQgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgaWYgKHR5cGVvZiBhdHRhY2hFdmVudCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgYXR0YWNoRXZlbnQoXCJvbnVubG9hZFwiLCB1bmxvYWRIYW5kbGVyKTtcbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZW9mIGFkZEV2ZW50TGlzdGVuZXIgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICBjb25zdCB0ZXJtaW5hdGlvbkV2ZW50ID0gXCJvbnBhZ2VoaWRlXCIgaW4gZ2xvYmFsVGhpcyA/IFwicGFnZWhpZGVcIiA6IFwidW5sb2FkXCI7XG4gICAgICAgIGFkZEV2ZW50TGlzdGVuZXIodGVybWluYXRpb25FdmVudCwgdW5sb2FkSGFuZGxlciwgZmFsc2UpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHVubG9hZEhhbmRsZXIoKSB7XG4gICAgZm9yIChsZXQgaSBpbiBSZXF1ZXN0LnJlcXVlc3RzKSB7XG4gICAgICAgIGlmIChSZXF1ZXN0LnJlcXVlc3RzLmhhc093blByb3BlcnR5KGkpKSB7XG4gICAgICAgICAgICBSZXF1ZXN0LnJlcXVlc3RzW2ldLmFib3J0KCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5jb25zdCBoYXNYSFIyID0gKGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCB4aHIgPSBuZXdSZXF1ZXN0KHtcbiAgICAgICAgeGRvbWFpbjogZmFsc2UsXG4gICAgfSk7XG4gICAgcmV0dXJuIHhociAmJiB4aHIucmVzcG9uc2VUeXBlICE9PSBudWxsO1xufSkoKTtcbi8qKlxuICogSFRUUCBsb25nLXBvbGxpbmcgYmFzZWQgb24gdGhlIGJ1aWx0LWluIGBYTUxIdHRwUmVxdWVzdGAgb2JqZWN0LlxuICpcbiAqIFVzYWdlOiBicm93c2VyXG4gKlxuICogQHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvWE1MSHR0cFJlcXVlc3RcbiAqL1xuZXhwb3J0IGNsYXNzIFhIUiBleHRlbmRzIEJhc2VYSFIge1xuICAgIGNvbnN0cnVjdG9yKG9wdHMpIHtcbiAgICAgICAgc3VwZXIob3B0cyk7XG4gICAgICAgIGNvbnN0IGZvcmNlQmFzZTY0ID0gb3B0cyAmJiBvcHRzLmZvcmNlQmFzZTY0O1xuICAgICAgICB0aGlzLnN1cHBvcnRzQmluYXJ5ID0gaGFzWEhSMiAmJiAhZm9yY2VCYXNlNjQ7XG4gICAgfVxuICAgIHJlcXVlc3Qob3B0cyA9IHt9KSB7XG4gICAgICAgIE9iamVjdC5hc3NpZ24ob3B0cywgeyB4ZDogdGhpcy54ZCB9LCB0aGlzLm9wdHMpO1xuICAgICAgICByZXR1cm4gbmV3IFJlcXVlc3QobmV3UmVxdWVzdCwgdGhpcy51cmkoKSwgb3B0cyk7XG4gICAgfVxufVxuZnVuY3Rpb24gbmV3UmVxdWVzdChvcHRzKSB7XG4gICAgY29uc3QgeGRvbWFpbiA9IG9wdHMueGRvbWFpbjtcbiAgICAvLyBYTUxIdHRwUmVxdWVzdCBjYW4gYmUgZGlzYWJsZWQgb24gSUVcbiAgICB0cnkge1xuICAgICAgICBpZiAoXCJ1bmRlZmluZWRcIiAhPT0gdHlwZW9mIFhNTEh0dHBSZXF1ZXN0ICYmICgheGRvbWFpbiB8fCBoYXNDT1JTKSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNhdGNoIChlKSB7IH1cbiAgICBpZiAoIXhkb21haW4pIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgZ2xvYmFsVGhpc1tbXCJBY3RpdmVcIl0uY29uY2F0KFwiT2JqZWN0XCIpLmpvaW4oXCJYXCIpXShcIk1pY3Jvc29mdC5YTUxIVFRQXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7IH1cbiAgICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling-xhr.js\n\n}')},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling.js":
/*!*****************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling.js ***!
  \*****************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Polling: () => (/* binding */ Polling)\n/* harmony export */ });\n/* harmony import */ var _transport_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../transport.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transport.js");\n/* harmony import */ var _util_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../util.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/util.js");\n/* harmony import */ var engine_io_parser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! engine.io-parser */ "./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/index.js");\n\n\n\nclass Polling extends _transport_js__WEBPACK_IMPORTED_MODULE_0__.Transport {\n    constructor() {\n        super(...arguments);\n        this._polling = false;\n    }\n    get name() {\n        return "polling";\n    }\n    /**\n     * Opens the socket (triggers polling). We write a PING message to determine\n     * when the transport is open.\n     *\n     * @protected\n     */\n    doOpen() {\n        this._poll();\n    }\n    /**\n     * Pauses polling.\n     *\n     * @param {Function} onPause - callback upon buffers are flushed and transport is paused\n     * @package\n     */\n    pause(onPause) {\n        this.readyState = "pausing";\n        const pause = () => {\n            this.readyState = "paused";\n            onPause();\n        };\n        if (this._polling || !this.writable) {\n            let total = 0;\n            if (this._polling) {\n                total++;\n                this.once("pollComplete", function () {\n                    --total || pause();\n                });\n            }\n            if (!this.writable) {\n                total++;\n                this.once("drain", function () {\n                    --total || pause();\n                });\n            }\n        }\n        else {\n            pause();\n        }\n    }\n    /**\n     * Starts polling cycle.\n     *\n     * @private\n     */\n    _poll() {\n        this._polling = true;\n        this.doPoll();\n        this.emitReserved("poll");\n    }\n    /**\n     * Overloads onData to detect payloads.\n     *\n     * @protected\n     */\n    onData(data) {\n        const callback = (packet) => {\n            // if its the first message we consider the transport open\n            if ("opening" === this.readyState && packet.type === "open") {\n                this.onOpen();\n            }\n            // if its a close packet, we close the ongoing requests\n            if ("close" === packet.type) {\n                this.onClose({ description: "transport closed by the server" });\n                return false;\n            }\n            // otherwise bypass onData and handle the message\n            this.onPacket(packet);\n        };\n        // decode payload\n        (0,engine_io_parser__WEBPACK_IMPORTED_MODULE_2__.decodePayload)(data, this.socket.binaryType).forEach(callback);\n        // if an event did not trigger closing\n        if ("closed" !== this.readyState) {\n            // if we got data we\'re not polling\n            this._polling = false;\n            this.emitReserved("pollComplete");\n            if ("open" === this.readyState) {\n                this._poll();\n            }\n            else {\n            }\n        }\n    }\n    /**\n     * For polling, send a close packet.\n     *\n     * @protected\n     */\n    doClose() {\n        const close = () => {\n            this.write([{ type: "close" }]);\n        };\n        if ("open" === this.readyState) {\n            close();\n        }\n        else {\n            // in case we\'re trying to close while\n            // handshaking is in progress (GH-164)\n            this.once("open", close);\n        }\n    }\n    /**\n     * Writes a packets payload.\n     *\n     * @param {Array} packets - data packets\n     * @protected\n     */\n    write(packets) {\n        this.writable = false;\n        (0,engine_io_parser__WEBPACK_IMPORTED_MODULE_2__.encodePayload)(packets, (data) => {\n            this.doWrite(data, () => {\n                this.writable = true;\n                this.emitReserved("drain");\n            });\n        });\n    }\n    /**\n     * Generates uri for connection.\n     *\n     * @private\n     */\n    uri() {\n        const schema = this.opts.secure ? "https" : "http";\n        const query = this.query || {};\n        // cache busting is forced\n        if (false !== this.opts.timestampRequests) {\n            query[this.opts.timestampParam] = (0,_util_js__WEBPACK_IMPORTED_MODULE_1__.randomString)();\n        }\n        if (!this.supportsBinary && !query.sid) {\n            query.b64 = 1;\n        }\n        return this.createUri(schema, query);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdHJhbnNwb3J0cy9wb2xsaW5nLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBNEM7QUFDRjtBQUNzQjtBQUN6RCxzQkFBc0Isb0RBQVM7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFVBQVU7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsK0NBQStDO0FBQzlFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsK0RBQWE7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsZUFBZTtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsT0FBTztBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsK0RBQWE7QUFDckI7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLHNEQUFZO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2VuZ2luZS5pby1jbGllbnRANi42LjMvbm9kZV9tb2R1bGVzL2VuZ2luZS5pby1jbGllbnQvYnVpbGQvZXNtL3RyYW5zcG9ydHMvcG9sbGluZy5qcz9lYWEzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFRyYW5zcG9ydCB9IGZyb20gXCIuLi90cmFuc3BvcnQuanNcIjtcbmltcG9ydCB7IHJhbmRvbVN0cmluZyB9IGZyb20gXCIuLi91dGlsLmpzXCI7XG5pbXBvcnQgeyBlbmNvZGVQYXlsb2FkLCBkZWNvZGVQYXlsb2FkIH0gZnJvbSBcImVuZ2luZS5pby1wYXJzZXJcIjtcbmV4cG9ydCBjbGFzcyBQb2xsaW5nIGV4dGVuZHMgVHJhbnNwb3J0IHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoLi4uYXJndW1lbnRzKTtcbiAgICAgICAgdGhpcy5fcG9sbGluZyA9IGZhbHNlO1xuICAgIH1cbiAgICBnZXQgbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIFwicG9sbGluZ1wiO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBPcGVucyB0aGUgc29ja2V0ICh0cmlnZ2VycyBwb2xsaW5nKS4gV2Ugd3JpdGUgYSBQSU5HIG1lc3NhZ2UgdG8gZGV0ZXJtaW5lXG4gICAgICogd2hlbiB0aGUgdHJhbnNwb3J0IGlzIG9wZW4uXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgZG9PcGVuKCkge1xuICAgICAgICB0aGlzLl9wb2xsKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBhdXNlcyBwb2xsaW5nLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gb25QYXVzZSAtIGNhbGxiYWNrIHVwb24gYnVmZmVycyBhcmUgZmx1c2hlZCBhbmQgdHJhbnNwb3J0IGlzIHBhdXNlZFxuICAgICAqIEBwYWNrYWdlXG4gICAgICovXG4gICAgcGF1c2Uob25QYXVzZSkge1xuICAgICAgICB0aGlzLnJlYWR5U3RhdGUgPSBcInBhdXNpbmdcIjtcbiAgICAgICAgY29uc3QgcGF1c2UgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnJlYWR5U3RhdGUgPSBcInBhdXNlZFwiO1xuICAgICAgICAgICAgb25QYXVzZSgpO1xuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5fcG9sbGluZyB8fCAhdGhpcy53cml0YWJsZSkge1xuICAgICAgICAgICAgbGV0IHRvdGFsID0gMDtcbiAgICAgICAgICAgIGlmICh0aGlzLl9wb2xsaW5nKSB7XG4gICAgICAgICAgICAgICAgdG90YWwrKztcbiAgICAgICAgICAgICAgICB0aGlzLm9uY2UoXCJwb2xsQ29tcGxldGVcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAtLXRvdGFsIHx8IHBhdXNlKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXRoaXMud3JpdGFibGUpIHtcbiAgICAgICAgICAgICAgICB0b3RhbCsrO1xuICAgICAgICAgICAgICAgIHRoaXMub25jZShcImRyYWluXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgLS10b3RhbCB8fCBwYXVzZSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcGF1c2UoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdGFydHMgcG9sbGluZyBjeWNsZS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3BvbGwoKSB7XG4gICAgICAgIHRoaXMuX3BvbGxpbmcgPSB0cnVlO1xuICAgICAgICB0aGlzLmRvUG9sbCgpO1xuICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcInBvbGxcIik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE92ZXJsb2FkcyBvbkRhdGEgdG8gZGV0ZWN0IHBheWxvYWRzLlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIG9uRGF0YShkYXRhKSB7XG4gICAgICAgIGNvbnN0IGNhbGxiYWNrID0gKHBhY2tldCkgPT4ge1xuICAgICAgICAgICAgLy8gaWYgaXRzIHRoZSBmaXJzdCBtZXNzYWdlIHdlIGNvbnNpZGVyIHRoZSB0cmFuc3BvcnQgb3BlblxuICAgICAgICAgICAgaWYgKFwib3BlbmluZ1wiID09PSB0aGlzLnJlYWR5U3RhdGUgJiYgcGFja2V0LnR5cGUgPT09IFwib3BlblwiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbk9wZW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGlmIGl0cyBhIGNsb3NlIHBhY2tldCwgd2UgY2xvc2UgdGhlIG9uZ29pbmcgcmVxdWVzdHNcbiAgICAgICAgICAgIGlmIChcImNsb3NlXCIgPT09IHBhY2tldC50eXBlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbkNsb3NlKHsgZGVzY3JpcHRpb246IFwidHJhbnNwb3J0IGNsb3NlZCBieSB0aGUgc2VydmVyXCIgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gb3RoZXJ3aXNlIGJ5cGFzcyBvbkRhdGEgYW5kIGhhbmRsZSB0aGUgbWVzc2FnZVxuICAgICAgICAgICAgdGhpcy5vblBhY2tldChwYWNrZXQpO1xuICAgICAgICB9O1xuICAgICAgICAvLyBkZWNvZGUgcGF5bG9hZFxuICAgICAgICBkZWNvZGVQYXlsb2FkKGRhdGEsIHRoaXMuc29ja2V0LmJpbmFyeVR5cGUpLmZvckVhY2goY2FsbGJhY2spO1xuICAgICAgICAvLyBpZiBhbiBldmVudCBkaWQgbm90IHRyaWdnZXIgY2xvc2luZ1xuICAgICAgICBpZiAoXCJjbG9zZWRcIiAhPT0gdGhpcy5yZWFkeVN0YXRlKSB7XG4gICAgICAgICAgICAvLyBpZiB3ZSBnb3QgZGF0YSB3ZSdyZSBub3QgcG9sbGluZ1xuICAgICAgICAgICAgdGhpcy5fcG9sbGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJwb2xsQ29tcGxldGVcIik7XG4gICAgICAgICAgICBpZiAoXCJvcGVuXCIgPT09IHRoaXMucmVhZHlTdGF0ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3BvbGwoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZvciBwb2xsaW5nLCBzZW5kIGEgY2xvc2UgcGFja2V0LlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIGRvQ2xvc2UoKSB7XG4gICAgICAgIGNvbnN0IGNsb3NlID0gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy53cml0ZShbeyB0eXBlOiBcImNsb3NlXCIgfV0pO1xuICAgICAgICB9O1xuICAgICAgICBpZiAoXCJvcGVuXCIgPT09IHRoaXMucmVhZHlTdGF0ZSkge1xuICAgICAgICAgICAgY2xvc2UoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIGluIGNhc2Ugd2UncmUgdHJ5aW5nIHRvIGNsb3NlIHdoaWxlXG4gICAgICAgICAgICAvLyBoYW5kc2hha2luZyBpcyBpbiBwcm9ncmVzcyAoR0gtMTY0KVxuICAgICAgICAgICAgdGhpcy5vbmNlKFwib3BlblwiLCBjbG9zZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogV3JpdGVzIGEgcGFja2V0cyBwYXlsb2FkLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtBcnJheX0gcGFja2V0cyAtIGRhdGEgcGFja2V0c1xuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICB3cml0ZShwYWNrZXRzKSB7XG4gICAgICAgIHRoaXMud3JpdGFibGUgPSBmYWxzZTtcbiAgICAgICAgZW5jb2RlUGF5bG9hZChwYWNrZXRzLCAoZGF0YSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kb1dyaXRlKGRhdGEsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLndyaXRhYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcImRyYWluXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZW5lcmF0ZXMgdXJpIGZvciBjb25uZWN0aW9uLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICB1cmkoKSB7XG4gICAgICAgIGNvbnN0IHNjaGVtYSA9IHRoaXMub3B0cy5zZWN1cmUgPyBcImh0dHBzXCIgOiBcImh0dHBcIjtcbiAgICAgICAgY29uc3QgcXVlcnkgPSB0aGlzLnF1ZXJ5IHx8IHt9O1xuICAgICAgICAvLyBjYWNoZSBidXN0aW5nIGlzIGZvcmNlZFxuICAgICAgICBpZiAoZmFsc2UgIT09IHRoaXMub3B0cy50aW1lc3RhbXBSZXF1ZXN0cykge1xuICAgICAgICAgICAgcXVlcnlbdGhpcy5vcHRzLnRpbWVzdGFtcFBhcmFtXSA9IHJhbmRvbVN0cmluZygpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5zdXBwb3J0c0JpbmFyeSAmJiAhcXVlcnkuc2lkKSB7XG4gICAgICAgICAgICBxdWVyeS5iNjQgPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZVVyaShzY2hlbWEsIHF1ZXJ5KTtcbiAgICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling.js\n\n}')},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/websocket.js":
/*!*******************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/websocket.js ***!
  \*******************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BaseWS: () => (/* binding */ BaseWS),\n/* harmony export */   WS: () => (/* binding */ WS)\n/* harmony export */ });\n/* harmony import */ var _transport_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../transport.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transport.js");\n/* harmony import */ var _util_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../util.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/util.js");\n/* harmony import */ var engine_io_parser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! engine.io-parser */ "./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/index.js");\n/* harmony import */ var _globals_node_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../globals.node.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/globals.js");\n\n\n\n\n// detect ReactNative environment\nconst isReactNative = typeof navigator !== "undefined" &&\n    typeof navigator.product === "string" &&\n    navigator.product.toLowerCase() === "reactnative";\nclass BaseWS extends _transport_js__WEBPACK_IMPORTED_MODULE_0__.Transport {\n    get name() {\n        return "websocket";\n    }\n    doOpen() {\n        const uri = this.uri();\n        const protocols = this.opts.protocols;\n        // React Native only supports the \'headers\' option, and will print a warning if anything else is passed\n        const opts = isReactNative\n            ? {}\n            : (0,_util_js__WEBPACK_IMPORTED_MODULE_1__.pick)(this.opts, "agent", "perMessageDeflate", "pfx", "key", "passphrase", "cert", "ca", "ciphers", "rejectUnauthorized", "localAddress", "protocolVersion", "origin", "maxPayload", "family", "checkServerIdentity");\n        if (this.opts.extraHeaders) {\n            opts.headers = this.opts.extraHeaders;\n        }\n        try {\n            this.ws = this.createSocket(uri, protocols, opts);\n        }\n        catch (err) {\n            return this.emitReserved("error", err);\n        }\n        this.ws.binaryType = this.socket.binaryType;\n        this.addEventListeners();\n    }\n    /**\n     * Adds event listeners to the socket\n     *\n     * @private\n     */\n    addEventListeners() {\n        this.ws.onopen = () => {\n            if (this.opts.autoUnref) {\n                this.ws._socket.unref();\n            }\n            this.onOpen();\n        };\n        this.ws.onclose = (closeEvent) => this.onClose({\n            description: "websocket connection closed",\n            context: closeEvent,\n        });\n        this.ws.onmessage = (ev) => this.onData(ev.data);\n        this.ws.onerror = (e) => this.onError("websocket error", e);\n    }\n    write(packets) {\n        this.writable = false;\n        // encodePacket efficient as it uses WS framing\n        // no need for encodePayload\n        for (let i = 0; i < packets.length; i++) {\n            const packet = packets[i];\n            const lastPacket = i === packets.length - 1;\n            (0,engine_io_parser__WEBPACK_IMPORTED_MODULE_2__.encodePacket)(packet, this.supportsBinary, (data) => {\n                // Sometimes the websocket has already been closed but the browser didn\'t\n                // have a chance of informing us about it yet, in that case send will\n                // throw an error\n                try {\n                    this.doWrite(packet, data);\n                }\n                catch (e) {\n                }\n                if (lastPacket) {\n                    // fake drain\n                    // defer to next tick to allow Socket to clear writeBuffer\n                    (0,_globals_node_js__WEBPACK_IMPORTED_MODULE_3__.nextTick)(() => {\n                        this.writable = true;\n                        this.emitReserved("drain");\n                    }, this.setTimeoutFn);\n                }\n            });\n        }\n    }\n    doClose() {\n        if (typeof this.ws !== "undefined") {\n            this.ws.onerror = () => { };\n            this.ws.close();\n            this.ws = null;\n        }\n    }\n    /**\n     * Generates uri for connection.\n     *\n     * @private\n     */\n    uri() {\n        const schema = this.opts.secure ? "wss" : "ws";\n        const query = this.query || {};\n        // append timestamp to URI\n        if (this.opts.timestampRequests) {\n            query[this.opts.timestampParam] = (0,_util_js__WEBPACK_IMPORTED_MODULE_1__.randomString)();\n        }\n        // communicate binary support capabilities\n        if (!this.supportsBinary) {\n            query.b64 = 1;\n        }\n        return this.createUri(schema, query);\n    }\n}\nconst WebSocketCtor = _globals_node_js__WEBPACK_IMPORTED_MODULE_3__.globalThisShim.WebSocket || _globals_node_js__WEBPACK_IMPORTED_MODULE_3__.globalThisShim.MozWebSocket;\n/**\n * WebSocket transport based on the built-in `WebSocket` object.\n *\n * Usage: browser, Node.js (since v21), Deno, Bun\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/WebSocket\n * @see https://caniuse.com/mdn-api_websocket\n * @see https://nodejs.org/api/globals.html#websocket\n */\nclass WS extends BaseWS {\n    createSocket(uri, protocols, opts) {\n        return !isReactNative\n            ? protocols\n                ? new WebSocketCtor(uri, protocols)\n                : new WebSocketCtor(uri)\n            : new WebSocketCtor(uri, protocols, opts);\n    }\n    doWrite(_packet, data) {\n        this.ws.send(data);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdHJhbnNwb3J0cy93ZWJzb2NrZXQuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQTRDO0FBQ0k7QUFDQTtBQUM0QjtBQUM1RTtBQUNBO0FBQ0E7QUFDQTtBQUNPLHFCQUFxQixvREFBUztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLDhDQUFJO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixvQkFBb0I7QUFDNUM7QUFDQTtBQUNBLFlBQVksOERBQVk7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQiwwREFBUTtBQUM1QjtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLHNEQUFZO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsNERBQVUsY0FBYyw0REFBVTtBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdHJhbnNwb3J0cy93ZWJzb2NrZXQuanM/MjFhYSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUcmFuc3BvcnQgfSBmcm9tIFwiLi4vdHJhbnNwb3J0LmpzXCI7XG5pbXBvcnQgeyBwaWNrLCByYW5kb21TdHJpbmcgfSBmcm9tIFwiLi4vdXRpbC5qc1wiO1xuaW1wb3J0IHsgZW5jb2RlUGFja2V0IH0gZnJvbSBcImVuZ2luZS5pby1wYXJzZXJcIjtcbmltcG9ydCB7IGdsb2JhbFRoaXNTaGltIGFzIGdsb2JhbFRoaXMsIG5leHRUaWNrIH0gZnJvbSBcIi4uL2dsb2JhbHMubm9kZS5qc1wiO1xuLy8gZGV0ZWN0IFJlYWN0TmF0aXZlIGVudmlyb25tZW50XG5jb25zdCBpc1JlYWN0TmF0aXZlID0gdHlwZW9mIG5hdmlnYXRvciAhPT0gXCJ1bmRlZmluZWRcIiAmJlxuICAgIHR5cGVvZiBuYXZpZ2F0b3IucHJvZHVjdCA9PT0gXCJzdHJpbmdcIiAmJlxuICAgIG5hdmlnYXRvci5wcm9kdWN0LnRvTG93ZXJDYXNlKCkgPT09IFwicmVhY3RuYXRpdmVcIjtcbmV4cG9ydCBjbGFzcyBCYXNlV1MgZXh0ZW5kcyBUcmFuc3BvcnQge1xuICAgIGdldCBuYW1lKCkge1xuICAgICAgICByZXR1cm4gXCJ3ZWJzb2NrZXRcIjtcbiAgICB9XG4gICAgZG9PcGVuKCkge1xuICAgICAgICBjb25zdCB1cmkgPSB0aGlzLnVyaSgpO1xuICAgICAgICBjb25zdCBwcm90b2NvbHMgPSB0aGlzLm9wdHMucHJvdG9jb2xzO1xuICAgICAgICAvLyBSZWFjdCBOYXRpdmUgb25seSBzdXBwb3J0cyB0aGUgJ2hlYWRlcnMnIG9wdGlvbiwgYW5kIHdpbGwgcHJpbnQgYSB3YXJuaW5nIGlmIGFueXRoaW5nIGVsc2UgaXMgcGFzc2VkXG4gICAgICAgIGNvbnN0IG9wdHMgPSBpc1JlYWN0TmF0aXZlXG4gICAgICAgICAgICA/IHt9XG4gICAgICAgICAgICA6IHBpY2sodGhpcy5vcHRzLCBcImFnZW50XCIsIFwicGVyTWVzc2FnZURlZmxhdGVcIiwgXCJwZnhcIiwgXCJrZXlcIiwgXCJwYXNzcGhyYXNlXCIsIFwiY2VydFwiLCBcImNhXCIsIFwiY2lwaGVyc1wiLCBcInJlamVjdFVuYXV0aG9yaXplZFwiLCBcImxvY2FsQWRkcmVzc1wiLCBcInByb3RvY29sVmVyc2lvblwiLCBcIm9yaWdpblwiLCBcIm1heFBheWxvYWRcIiwgXCJmYW1pbHlcIiwgXCJjaGVja1NlcnZlcklkZW50aXR5XCIpO1xuICAgICAgICBpZiAodGhpcy5vcHRzLmV4dHJhSGVhZGVycykge1xuICAgICAgICAgICAgb3B0cy5oZWFkZXJzID0gdGhpcy5vcHRzLmV4dHJhSGVhZGVycztcbiAgICAgICAgfVxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdGhpcy53cyA9IHRoaXMuY3JlYXRlU29ja2V0KHVyaSwgcHJvdG9jb2xzLCBvcHRzKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5lbWl0UmVzZXJ2ZWQoXCJlcnJvclwiLCBlcnIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMud3MuYmluYXJ5VHlwZSA9IHRoaXMuc29ja2V0LmJpbmFyeVR5cGU7XG4gICAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyBldmVudCBsaXN0ZW5lcnMgdG8gdGhlIHNvY2tldFxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBhZGRFdmVudExpc3RlbmVycygpIHtcbiAgICAgICAgdGhpcy53cy5vbm9wZW4gPSAoKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5vcHRzLmF1dG9VbnJlZikge1xuICAgICAgICAgICAgICAgIHRoaXMud3MuX3NvY2tldC51bnJlZigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5vbk9wZW4oKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy53cy5vbmNsb3NlID0gKGNsb3NlRXZlbnQpID0+IHRoaXMub25DbG9zZSh7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJ3ZWJzb2NrZXQgY29ubmVjdGlvbiBjbG9zZWRcIixcbiAgICAgICAgICAgIGNvbnRleHQ6IGNsb3NlRXZlbnQsXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLndzLm9ubWVzc2FnZSA9IChldikgPT4gdGhpcy5vbkRhdGEoZXYuZGF0YSk7XG4gICAgICAgIHRoaXMud3Mub25lcnJvciA9IChlKSA9PiB0aGlzLm9uRXJyb3IoXCJ3ZWJzb2NrZXQgZXJyb3JcIiwgZSk7XG4gICAgfVxuICAgIHdyaXRlKHBhY2tldHMpIHtcbiAgICAgICAgdGhpcy53cml0YWJsZSA9IGZhbHNlO1xuICAgICAgICAvLyBlbmNvZGVQYWNrZXQgZWZmaWNpZW50IGFzIGl0IHVzZXMgV1MgZnJhbWluZ1xuICAgICAgICAvLyBubyBuZWVkIGZvciBlbmNvZGVQYXlsb2FkXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFja2V0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgcGFja2V0ID0gcGFja2V0c1tpXTtcbiAgICAgICAgICAgIGNvbnN0IGxhc3RQYWNrZXQgPSBpID09PSBwYWNrZXRzLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICBlbmNvZGVQYWNrZXQocGFja2V0LCB0aGlzLnN1cHBvcnRzQmluYXJ5LCAoZGF0YSkgPT4ge1xuICAgICAgICAgICAgICAgIC8vIFNvbWV0aW1lcyB0aGUgd2Vic29ja2V0IGhhcyBhbHJlYWR5IGJlZW4gY2xvc2VkIGJ1dCB0aGUgYnJvd3NlciBkaWRuJ3RcbiAgICAgICAgICAgICAgICAvLyBoYXZlIGEgY2hhbmNlIG9mIGluZm9ybWluZyB1cyBhYm91dCBpdCB5ZXQsIGluIHRoYXQgY2FzZSBzZW5kIHdpbGxcbiAgICAgICAgICAgICAgICAvLyB0aHJvdyBhbiBlcnJvclxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZG9Xcml0ZShwYWNrZXQsIGRhdGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobGFzdFBhY2tldCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBmYWtlIGRyYWluXG4gICAgICAgICAgICAgICAgICAgIC8vIGRlZmVyIHRvIG5leHQgdGljayB0byBhbGxvdyBTb2NrZXQgdG8gY2xlYXIgd3JpdGVCdWZmZXJcbiAgICAgICAgICAgICAgICAgICAgbmV4dFRpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy53cml0YWJsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcImRyYWluXCIpO1xuICAgICAgICAgICAgICAgICAgICB9LCB0aGlzLnNldFRpbWVvdXRGbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZG9DbG9zZSgpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLndzICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICB0aGlzLndzLm9uZXJyb3IgPSAoKSA9PiB7IH07XG4gICAgICAgICAgICB0aGlzLndzLmNsb3NlKCk7XG4gICAgICAgICAgICB0aGlzLndzID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZW5lcmF0ZXMgdXJpIGZvciBjb25uZWN0aW9uLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICB1cmkoKSB7XG4gICAgICAgIGNvbnN0IHNjaGVtYSA9IHRoaXMub3B0cy5zZWN1cmUgPyBcIndzc1wiIDogXCJ3c1wiO1xuICAgICAgICBjb25zdCBxdWVyeSA9IHRoaXMucXVlcnkgfHwge307XG4gICAgICAgIC8vIGFwcGVuZCB0aW1lc3RhbXAgdG8gVVJJXG4gICAgICAgIGlmICh0aGlzLm9wdHMudGltZXN0YW1wUmVxdWVzdHMpIHtcbiAgICAgICAgICAgIHF1ZXJ5W3RoaXMub3B0cy50aW1lc3RhbXBQYXJhbV0gPSByYW5kb21TdHJpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBjb21tdW5pY2F0ZSBiaW5hcnkgc3VwcG9ydCBjYXBhYmlsaXRpZXNcbiAgICAgICAgaWYgKCF0aGlzLnN1cHBvcnRzQmluYXJ5KSB7XG4gICAgICAgICAgICBxdWVyeS5iNjQgPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZVVyaShzY2hlbWEsIHF1ZXJ5KTtcbiAgICB9XG59XG5jb25zdCBXZWJTb2NrZXRDdG9yID0gZ2xvYmFsVGhpcy5XZWJTb2NrZXQgfHwgZ2xvYmFsVGhpcy5Nb3pXZWJTb2NrZXQ7XG4vKipcbiAqIFdlYlNvY2tldCB0cmFuc3BvcnQgYmFzZWQgb24gdGhlIGJ1aWx0LWluIGBXZWJTb2NrZXRgIG9iamVjdC5cbiAqXG4gKiBVc2FnZTogYnJvd3NlciwgTm9kZS5qcyAoc2luY2UgdjIxKSwgRGVubywgQnVuXG4gKlxuICogQHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvV2ViU29ja2V0XG4gKiBAc2VlIGh0dHBzOi8vY2FuaXVzZS5jb20vbWRuLWFwaV93ZWJzb2NrZXRcbiAqIEBzZWUgaHR0cHM6Ly9ub2RlanMub3JnL2FwaS9nbG9iYWxzLmh0bWwjd2Vic29ja2V0XG4gKi9cbmV4cG9ydCBjbGFzcyBXUyBleHRlbmRzIEJhc2VXUyB7XG4gICAgY3JlYXRlU29ja2V0KHVyaSwgcHJvdG9jb2xzLCBvcHRzKSB7XG4gICAgICAgIHJldHVybiAhaXNSZWFjdE5hdGl2ZVxuICAgICAgICAgICAgPyBwcm90b2NvbHNcbiAgICAgICAgICAgICAgICA/IG5ldyBXZWJTb2NrZXRDdG9yKHVyaSwgcHJvdG9jb2xzKVxuICAgICAgICAgICAgICAgIDogbmV3IFdlYlNvY2tldEN0b3IodXJpKVxuICAgICAgICAgICAgOiBuZXcgV2ViU29ja2V0Q3Rvcih1cmksIHByb3RvY29scywgb3B0cyk7XG4gICAgfVxuICAgIGRvV3JpdGUoX3BhY2tldCwgZGF0YSkge1xuICAgICAgICB0aGlzLndzLnNlbmQoZGF0YSk7XG4gICAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/websocket.js\n\n}')},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/webtransport.js":
/*!**********************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/webtransport.js ***!
  \**********************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   WT: () => (/* binding */ WT)\n/* harmony export */ });\n/* harmony import */ var _transport_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../transport.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transport.js");\n/* harmony import */ var _globals_node_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../globals.node.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/globals.js");\n/* harmony import */ var engine_io_parser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! engine.io-parser */ "./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/index.js");\n\n\n\n/**\n * WebTransport transport based on the built-in `WebTransport` object.\n *\n * Usage: browser, Node.js (with the `@fails-components/webtransport` package)\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/WebTransport\n * @see https://caniuse.com/webtransport\n */\nclass WT extends _transport_js__WEBPACK_IMPORTED_MODULE_0__.Transport {\n    get name() {\n        return "webtransport";\n    }\n    doOpen() {\n        try {\n            // @ts-ignore\n            this._transport = new WebTransport(this.createUri("https"), this.opts.transportOptions[this.name]);\n        }\n        catch (err) {\n            return this.emitReserved("error", err);\n        }\n        this._transport.closed\n            .then(() => {\n            this.onClose();\n        })\n            .catch((err) => {\n            this.onError("webtransport error", err);\n        });\n        // note: we could have used async/await, but that would require some additional polyfills\n        this._transport.ready.then(() => {\n            this._transport.createBidirectionalStream().then((stream) => {\n                const decoderStream = (0,engine_io_parser__WEBPACK_IMPORTED_MODULE_2__.createPacketDecoderStream)(Number.MAX_SAFE_INTEGER, this.socket.binaryType);\n                const reader = stream.readable.pipeThrough(decoderStream).getReader();\n                const encoderStream = (0,engine_io_parser__WEBPACK_IMPORTED_MODULE_2__.createPacketEncoderStream)();\n                encoderStream.readable.pipeTo(stream.writable);\n                this._writer = encoderStream.writable.getWriter();\n                const read = () => {\n                    reader\n                        .read()\n                        .then(({ done, value }) => {\n                        if (done) {\n                            return;\n                        }\n                        this.onPacket(value);\n                        read();\n                    })\n                        .catch((err) => {\n                    });\n                };\n                read();\n                const packet = { type: "open" };\n                if (this.query.sid) {\n                    packet.data = `{"sid":"${this.query.sid}"}`;\n                }\n                this._writer.write(packet).then(() => this.onOpen());\n            });\n        });\n    }\n    write(packets) {\n        this.writable = false;\n        for (let i = 0; i < packets.length; i++) {\n            const packet = packets[i];\n            const lastPacket = i === packets.length - 1;\n            this._writer.write(packet).then(() => {\n                if (lastPacket) {\n                    (0,_globals_node_js__WEBPACK_IMPORTED_MODULE_1__.nextTick)(() => {\n                        this.writable = true;\n                        this.emitReserved("drain");\n                    }, this.setTimeoutFn);\n                }\n            });\n        }\n    }\n    doClose() {\n        var _a;\n        (_a = this._transport) === null || _a === void 0 ? void 0 : _a.close();\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdHJhbnNwb3J0cy93ZWJ0cmFuc3BvcnQuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUE0QztBQUNFO0FBQzJDO0FBQ3pGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTyxpQkFBaUIsb0RBQVM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQywyRUFBeUI7QUFDL0Q7QUFDQSxzQ0FBc0MsMkVBQXlCO0FBQy9EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsYUFBYTtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQSxvQ0FBb0MsU0FBUyxlQUFlLEVBQUU7QUFDOUQ7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLG9CQUFvQjtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQiwwREFBUTtBQUM1QjtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2VuZ2luZS5pby1jbGllbnRANi42LjMvbm9kZV9tb2R1bGVzL2VuZ2luZS5pby1jbGllbnQvYnVpbGQvZXNtL3RyYW5zcG9ydHMvd2VidHJhbnNwb3J0LmpzPzQ2NDciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVHJhbnNwb3J0IH0gZnJvbSBcIi4uL3RyYW5zcG9ydC5qc1wiO1xuaW1wb3J0IHsgbmV4dFRpY2sgfSBmcm9tIFwiLi4vZ2xvYmFscy5ub2RlLmpzXCI7XG5pbXBvcnQgeyBjcmVhdGVQYWNrZXREZWNvZGVyU3RyZWFtLCBjcmVhdGVQYWNrZXRFbmNvZGVyU3RyZWFtLCB9IGZyb20gXCJlbmdpbmUuaW8tcGFyc2VyXCI7XG4vKipcbiAqIFdlYlRyYW5zcG9ydCB0cmFuc3BvcnQgYmFzZWQgb24gdGhlIGJ1aWx0LWluIGBXZWJUcmFuc3BvcnRgIG9iamVjdC5cbiAqXG4gKiBVc2FnZTogYnJvd3NlciwgTm9kZS5qcyAod2l0aCB0aGUgYEBmYWlscy1jb21wb25lbnRzL3dlYnRyYW5zcG9ydGAgcGFja2FnZSlcbiAqXG4gKiBAc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9XZWJUcmFuc3BvcnRcbiAqIEBzZWUgaHR0cHM6Ly9jYW5pdXNlLmNvbS93ZWJ0cmFuc3BvcnRcbiAqL1xuZXhwb3J0IGNsYXNzIFdUIGV4dGVuZHMgVHJhbnNwb3J0IHtcbiAgICBnZXQgbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIFwid2VidHJhbnNwb3J0XCI7XG4gICAgfVxuICAgIGRvT3BlbigpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIHRoaXMuX3RyYW5zcG9ydCA9IG5ldyBXZWJUcmFuc3BvcnQodGhpcy5jcmVhdGVVcmkoXCJodHRwc1wiKSwgdGhpcy5vcHRzLnRyYW5zcG9ydE9wdGlvbnNbdGhpcy5uYW1lXSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZW1pdFJlc2VydmVkKFwiZXJyb3JcIiwgZXJyKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl90cmFuc3BvcnQuY2xvc2VkXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLm9uQ2xvc2UoKTtcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICB0aGlzLm9uRXJyb3IoXCJ3ZWJ0cmFuc3BvcnQgZXJyb3JcIiwgZXJyKTtcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIG5vdGU6IHdlIGNvdWxkIGhhdmUgdXNlZCBhc3luYy9hd2FpdCwgYnV0IHRoYXQgd291bGQgcmVxdWlyZSBzb21lIGFkZGl0aW9uYWwgcG9seWZpbGxzXG4gICAgICAgIHRoaXMuX3RyYW5zcG9ydC5yZWFkeS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX3RyYW5zcG9ydC5jcmVhdGVCaWRpcmVjdGlvbmFsU3RyZWFtKCkudGhlbigoc3RyZWFtKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZGVjb2RlclN0cmVhbSA9IGNyZWF0ZVBhY2tldERlY29kZXJTdHJlYW0oTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIsIHRoaXMuc29ja2V0LmJpbmFyeVR5cGUpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlYWRlciA9IHN0cmVhbS5yZWFkYWJsZS5waXBlVGhyb3VnaChkZWNvZGVyU3RyZWFtKS5nZXRSZWFkZXIoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBlbmNvZGVyU3RyZWFtID0gY3JlYXRlUGFja2V0RW5jb2RlclN0cmVhbSgpO1xuICAgICAgICAgICAgICAgIGVuY29kZXJTdHJlYW0ucmVhZGFibGUucGlwZVRvKHN0cmVhbS53cml0YWJsZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5fd3JpdGVyID0gZW5jb2RlclN0cmVhbS53cml0YWJsZS5nZXRXcml0ZXIoKTtcbiAgICAgICAgICAgICAgICBjb25zdCByZWFkID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZWFkZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yZWFkKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKCh7IGRvbmUsIHZhbHVlIH0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkb25lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vblBhY2tldCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWFkKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHJlYWQoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBwYWNrZXQgPSB7IHR5cGU6IFwib3BlblwiIH07XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucXVlcnkuc2lkKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhY2tldC5kYXRhID0gYHtcInNpZFwiOlwiJHt0aGlzLnF1ZXJ5LnNpZH1cIn1gO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLl93cml0ZXIud3JpdGUocGFja2V0KS50aGVuKCgpID0+IHRoaXMub25PcGVuKCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICB3cml0ZShwYWNrZXRzKSB7XG4gICAgICAgIHRoaXMud3JpdGFibGUgPSBmYWxzZTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYWNrZXRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBwYWNrZXQgPSBwYWNrZXRzW2ldO1xuICAgICAgICAgICAgY29uc3QgbGFzdFBhY2tldCA9IGkgPT09IHBhY2tldHMubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgIHRoaXMuX3dyaXRlci53cml0ZShwYWNrZXQpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChsYXN0UGFja2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIG5leHRUaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMud3JpdGFibGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJkcmFpblwiKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgdGhpcy5zZXRUaW1lb3V0Rm4pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGRvQ2xvc2UoKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgKF9hID0gdGhpcy5fdHJhbnNwb3J0KSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuY2xvc2UoKTtcbiAgICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/webtransport.js\n\n}')},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/util.js":
/*!***************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/util.js ***!
  \***************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   byteLength: () => (/* binding */ byteLength),\n/* harmony export */   installTimerFunctions: () => (/* binding */ installTimerFunctions),\n/* harmony export */   pick: () => (/* binding */ pick),\n/* harmony export */   randomString: () => (/* binding */ randomString)\n/* harmony export */ });\n/* harmony import */ var _globals_node_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./globals.node.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/globals.js");\n\nfunction pick(obj, ...attr) {\n    return attr.reduce((acc, k) => {\n        if (obj.hasOwnProperty(k)) {\n            acc[k] = obj[k];\n        }\n        return acc;\n    }, {});\n}\n// Keep a reference to the real timeout functions so they can be used when overridden\nconst NATIVE_SET_TIMEOUT = _globals_node_js__WEBPACK_IMPORTED_MODULE_0__.globalThisShim.setTimeout;\nconst NATIVE_CLEAR_TIMEOUT = _globals_node_js__WEBPACK_IMPORTED_MODULE_0__.globalThisShim.clearTimeout;\nfunction installTimerFunctions(obj, opts) {\n    if (opts.useNativeTimers) {\n        obj.setTimeoutFn = NATIVE_SET_TIMEOUT.bind(_globals_node_js__WEBPACK_IMPORTED_MODULE_0__.globalThisShim);\n        obj.clearTimeoutFn = NATIVE_CLEAR_TIMEOUT.bind(_globals_node_js__WEBPACK_IMPORTED_MODULE_0__.globalThisShim);\n    }\n    else {\n        obj.setTimeoutFn = _globals_node_js__WEBPACK_IMPORTED_MODULE_0__.globalThisShim.setTimeout.bind(_globals_node_js__WEBPACK_IMPORTED_MODULE_0__.globalThisShim);\n        obj.clearTimeoutFn = _globals_node_js__WEBPACK_IMPORTED_MODULE_0__.globalThisShim.clearTimeout.bind(_globals_node_js__WEBPACK_IMPORTED_MODULE_0__.globalThisShim);\n    }\n}\n// base64 encoded buffers are about 33% bigger (https://en.wikipedia.org/wiki/Base64)\nconst BASE64_OVERHEAD = 1.33;\n// we could also have used `new Blob([obj]).size`, but it isn\'t supported in IE9\nfunction byteLength(obj) {\n    if (typeof obj === "string") {\n        return utf8Length(obj);\n    }\n    // arraybuffer or blob\n    return Math.ceil((obj.byteLength || obj.size) * BASE64_OVERHEAD);\n}\nfunction utf8Length(str) {\n    let c = 0, length = 0;\n    for (let i = 0, l = str.length; i < l; i++) {\n        c = str.charCodeAt(i);\n        if (c < 0x80) {\n            length += 1;\n        }\n        else if (c < 0x800) {\n            length += 2;\n        }\n        else if (c < 0xd800 || c >= 0xe000) {\n            length += 3;\n        }\n        else {\n            i++;\n            length += 4;\n        }\n    }\n    return length;\n}\n/**\n * Generates a random 8-characters string.\n */\nfunction randomString() {\n    return (Date.now().toString(36).substring(3) +\n        Math.random().toString(36).substring(2, 5));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdXRpbC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFpRTtBQUMxRDtBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLLElBQUk7QUFDVDtBQUNBO0FBQ0EsMkJBQTJCLDREQUFVO0FBQ3JDLDZCQUE2Qiw0REFBVTtBQUNoQztBQUNQO0FBQ0EsbURBQW1ELDREQUFVO0FBQzdELHVEQUF1RCw0REFBVTtBQUNqRTtBQUNBO0FBQ0EsMkJBQTJCLDREQUFVLGlCQUFpQiw0REFBVTtBQUNoRSw2QkFBNkIsNERBQVUsbUJBQW1CLDREQUFVO0FBQ3BFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsT0FBTztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdXRpbC5qcz81MWI4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdsb2JhbFRoaXNTaGltIGFzIGdsb2JhbFRoaXMgfSBmcm9tIFwiLi9nbG9iYWxzLm5vZGUuanNcIjtcbmV4cG9ydCBmdW5jdGlvbiBwaWNrKG9iaiwgLi4uYXR0cikge1xuICAgIHJldHVybiBhdHRyLnJlZHVjZSgoYWNjLCBrKSA9PiB7XG4gICAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoaykpIHtcbiAgICAgICAgICAgIGFjY1trXSA9IG9ialtrXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYWNjO1xuICAgIH0sIHt9KTtcbn1cbi8vIEtlZXAgYSByZWZlcmVuY2UgdG8gdGhlIHJlYWwgdGltZW91dCBmdW5jdGlvbnMgc28gdGhleSBjYW4gYmUgdXNlZCB3aGVuIG92ZXJyaWRkZW5cbmNvbnN0IE5BVElWRV9TRVRfVElNRU9VVCA9IGdsb2JhbFRoaXMuc2V0VGltZW91dDtcbmNvbnN0IE5BVElWRV9DTEVBUl9USU1FT1VUID0gZ2xvYmFsVGhpcy5jbGVhclRpbWVvdXQ7XG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbFRpbWVyRnVuY3Rpb25zKG9iaiwgb3B0cykge1xuICAgIGlmIChvcHRzLnVzZU5hdGl2ZVRpbWVycykge1xuICAgICAgICBvYmouc2V0VGltZW91dEZuID0gTkFUSVZFX1NFVF9USU1FT1VULmJpbmQoZ2xvYmFsVGhpcyk7XG4gICAgICAgIG9iai5jbGVhclRpbWVvdXRGbiA9IE5BVElWRV9DTEVBUl9USU1FT1VULmJpbmQoZ2xvYmFsVGhpcyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBvYmouc2V0VGltZW91dEZuID0gZ2xvYmFsVGhpcy5zZXRUaW1lb3V0LmJpbmQoZ2xvYmFsVGhpcyk7XG4gICAgICAgIG9iai5jbGVhclRpbWVvdXRGbiA9IGdsb2JhbFRoaXMuY2xlYXJUaW1lb3V0LmJpbmQoZ2xvYmFsVGhpcyk7XG4gICAgfVxufVxuLy8gYmFzZTY0IGVuY29kZWQgYnVmZmVycyBhcmUgYWJvdXQgMzMlIGJpZ2dlciAoaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQmFzZTY0KVxuY29uc3QgQkFTRTY0X09WRVJIRUFEID0gMS4zMztcbi8vIHdlIGNvdWxkIGFsc28gaGF2ZSB1c2VkIGBuZXcgQmxvYihbb2JqXSkuc2l6ZWAsIGJ1dCBpdCBpc24ndCBzdXBwb3J0ZWQgaW4gSUU5XG5leHBvcnQgZnVuY3Rpb24gYnl0ZUxlbmd0aChvYmopIHtcbiAgICBpZiAodHlwZW9mIG9iaiA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICByZXR1cm4gdXRmOExlbmd0aChvYmopO1xuICAgIH1cbiAgICAvLyBhcnJheWJ1ZmZlciBvciBibG9iXG4gICAgcmV0dXJuIE1hdGguY2VpbCgob2JqLmJ5dGVMZW5ndGggfHwgb2JqLnNpemUpICogQkFTRTY0X09WRVJIRUFEKTtcbn1cbmZ1bmN0aW9uIHV0ZjhMZW5ndGgoc3RyKSB7XG4gICAgbGV0IGMgPSAwLCBsZW5ndGggPSAwO1xuICAgIGZvciAobGV0IGkgPSAwLCBsID0gc3RyLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICBjID0gc3RyLmNoYXJDb2RlQXQoaSk7XG4gICAgICAgIGlmIChjIDwgMHg4MCkge1xuICAgICAgICAgICAgbGVuZ3RoICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoYyA8IDB4ODAwKSB7XG4gICAgICAgICAgICBsZW5ndGggKz0gMjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjIDwgMHhkODAwIHx8IGMgPj0gMHhlMDAwKSB7XG4gICAgICAgICAgICBsZW5ndGggKz0gMztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgIGxlbmd0aCArPSA0O1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBsZW5ndGg7XG59XG4vKipcbiAqIEdlbmVyYXRlcyBhIHJhbmRvbSA4LWNoYXJhY3RlcnMgc3RyaW5nLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcmFuZG9tU3RyaW5nKCkge1xuICAgIHJldHVybiAoRGF0ZS5ub3coKS50b1N0cmluZygzNikuc3Vic3RyaW5nKDMpICtcbiAgICAgICAgTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyaW5nKDIsIDUpKTtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/util.js\n\n}')},"./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/commons.js":
/*!******************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/commons.js ***!
  \******************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ERROR_PACKET: () => (/* binding */ ERROR_PACKET),\n/* harmony export */   PACKET_TYPES: () => (/* binding */ PACKET_TYPES),\n/* harmony export */   PACKET_TYPES_REVERSE: () => (/* binding */ PACKET_TYPES_REVERSE)\n/* harmony export */ });\nconst PACKET_TYPES = Object.create(null); // no Map = no polyfill\nPACKET_TYPES["open"] = "0";\nPACKET_TYPES["close"] = "1";\nPACKET_TYPES["ping"] = "2";\nPACKET_TYPES["pong"] = "3";\nPACKET_TYPES["message"] = "4";\nPACKET_TYPES["upgrade"] = "5";\nPACKET_TYPES["noop"] = "6";\nconst PACKET_TYPES_REVERSE = Object.create(null);\nObject.keys(PACKET_TYPES).forEach((key) => {\n    PACKET_TYPES_REVERSE[PACKET_TYPES[key]] = key;\n});\nconst ERROR_PACKET = { type: "error", data: "parser error" };\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLXBhcnNlckA1LjIuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLXBhcnNlci9idWlsZC9lc20vY29tbW9ucy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSwwQ0FBMEM7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsdUJBQXVCO0FBQ3FDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2VuZ2luZS5pby1wYXJzZXJANS4yLjMvbm9kZV9tb2R1bGVzL2VuZ2luZS5pby1wYXJzZXIvYnVpbGQvZXNtL2NvbW1vbnMuanM/YTE0YyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBQQUNLRVRfVFlQRVMgPSBPYmplY3QuY3JlYXRlKG51bGwpOyAvLyBubyBNYXAgPSBubyBwb2x5ZmlsbFxuUEFDS0VUX1RZUEVTW1wib3BlblwiXSA9IFwiMFwiO1xuUEFDS0VUX1RZUEVTW1wiY2xvc2VcIl0gPSBcIjFcIjtcblBBQ0tFVF9UWVBFU1tcInBpbmdcIl0gPSBcIjJcIjtcblBBQ0tFVF9UWVBFU1tcInBvbmdcIl0gPSBcIjNcIjtcblBBQ0tFVF9UWVBFU1tcIm1lc3NhZ2VcIl0gPSBcIjRcIjtcblBBQ0tFVF9UWVBFU1tcInVwZ3JhZGVcIl0gPSBcIjVcIjtcblBBQ0tFVF9UWVBFU1tcIm5vb3BcIl0gPSBcIjZcIjtcbmNvbnN0IFBBQ0tFVF9UWVBFU19SRVZFUlNFID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbk9iamVjdC5rZXlzKFBBQ0tFVF9UWVBFUykuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgUEFDS0VUX1RZUEVTX1JFVkVSU0VbUEFDS0VUX1RZUEVTW2tleV1dID0ga2V5O1xufSk7XG5jb25zdCBFUlJPUl9QQUNLRVQgPSB7IHR5cGU6IFwiZXJyb3JcIiwgZGF0YTogXCJwYXJzZXIgZXJyb3JcIiB9O1xuZXhwb3J0IHsgUEFDS0VUX1RZUEVTLCBQQUNLRVRfVFlQRVNfUkVWRVJTRSwgRVJST1JfUEFDS0VUIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/commons.js\n\n}')},"./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/contrib/base64-arraybuffer.js":
/*!*************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/contrib/base64-arraybuffer.js ***!
  \*************************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   decode: () => (/* binding */ decode),\n/* harmony export */   encode: () => (/* binding */ encode)\n/* harmony export */ });\n// imported from https://github.com/socketio/base64-arraybuffer\nconst chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n// Use a lookup table to find the index.\nconst lookup = typeof Uint8Array === 'undefined' ? [] : new Uint8Array(256);\nfor (let i = 0; i < chars.length; i++) {\n    lookup[chars.charCodeAt(i)] = i;\n}\nconst encode = (arraybuffer) => {\n    let bytes = new Uint8Array(arraybuffer), i, len = bytes.length, base64 = '';\n    for (i = 0; i < len; i += 3) {\n        base64 += chars[bytes[i] >> 2];\n        base64 += chars[((bytes[i] & 3) << 4) | (bytes[i + 1] >> 4)];\n        base64 += chars[((bytes[i + 1] & 15) << 2) | (bytes[i + 2] >> 6)];\n        base64 += chars[bytes[i + 2] & 63];\n    }\n    if (len % 3 === 2) {\n        base64 = base64.substring(0, base64.length - 1) + '=';\n    }\n    else if (len % 3 === 1) {\n        base64 = base64.substring(0, base64.length - 2) + '==';\n    }\n    return base64;\n};\nconst decode = (base64) => {\n    let bufferLength = base64.length * 0.75, len = base64.length, i, p = 0, encoded1, encoded2, encoded3, encoded4;\n    if (base64[base64.length - 1] === '=') {\n        bufferLength--;\n        if (base64[base64.length - 2] === '=') {\n            bufferLength--;\n        }\n    }\n    const arraybuffer = new ArrayBuffer(bufferLength), bytes = new Uint8Array(arraybuffer);\n    for (i = 0; i < len; i += 4) {\n        encoded1 = lookup[base64.charCodeAt(i)];\n        encoded2 = lookup[base64.charCodeAt(i + 1)];\n        encoded3 = lookup[base64.charCodeAt(i + 2)];\n        encoded4 = lookup[base64.charCodeAt(i + 3)];\n        bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);\n        bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);\n        bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);\n    }\n    return arraybuffer;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLXBhcnNlckA1LjIuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLXBhcnNlci9idWlsZC9lc20vY29udHJpYi9iYXNlNjQtYXJyYXlidWZmZXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixrQkFBa0I7QUFDbEM7QUFDQTtBQUNPO0FBQ1A7QUFDQSxnQkFBZ0IsU0FBUztBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixTQUFTO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2VuZ2luZS5pby1wYXJzZXJANS4yLjMvbm9kZV9tb2R1bGVzL2VuZ2luZS5pby1wYXJzZXIvYnVpbGQvZXNtL2NvbnRyaWIvYmFzZTY0LWFycmF5YnVmZmVyLmpzPzBjM2MiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gaW1wb3J0ZWQgZnJvbSBodHRwczovL2dpdGh1Yi5jb20vc29ja2V0aW8vYmFzZTY0LWFycmF5YnVmZmVyXG5jb25zdCBjaGFycyA9ICdBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvJztcbi8vIFVzZSBhIGxvb2t1cCB0YWJsZSB0byBmaW5kIHRoZSBpbmRleC5cbmNvbnN0IGxvb2t1cCA9IHR5cGVvZiBVaW50OEFycmF5ID09PSAndW5kZWZpbmVkJyA/IFtdIDogbmV3IFVpbnQ4QXJyYXkoMjU2KTtcbmZvciAobGV0IGkgPSAwOyBpIDwgY2hhcnMubGVuZ3RoOyBpKyspIHtcbiAgICBsb29rdXBbY2hhcnMuY2hhckNvZGVBdChpKV0gPSBpO1xufVxuZXhwb3J0IGNvbnN0IGVuY29kZSA9IChhcnJheWJ1ZmZlcikgPT4ge1xuICAgIGxldCBieXRlcyA9IG5ldyBVaW50OEFycmF5KGFycmF5YnVmZmVyKSwgaSwgbGVuID0gYnl0ZXMubGVuZ3RoLCBiYXNlNjQgPSAnJztcbiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpICs9IDMpIHtcbiAgICAgICAgYmFzZTY0ICs9IGNoYXJzW2J5dGVzW2ldID4+IDJdO1xuICAgICAgICBiYXNlNjQgKz0gY2hhcnNbKChieXRlc1tpXSAmIDMpIDw8IDQpIHwgKGJ5dGVzW2kgKyAxXSA+PiA0KV07XG4gICAgICAgIGJhc2U2NCArPSBjaGFyc1soKGJ5dGVzW2kgKyAxXSAmIDE1KSA8PCAyKSB8IChieXRlc1tpICsgMl0gPj4gNildO1xuICAgICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaSArIDJdICYgNjNdO1xuICAgIH1cbiAgICBpZiAobGVuICUgMyA9PT0gMikge1xuICAgICAgICBiYXNlNjQgPSBiYXNlNjQuc3Vic3RyaW5nKDAsIGJhc2U2NC5sZW5ndGggLSAxKSArICc9JztcbiAgICB9XG4gICAgZWxzZSBpZiAobGVuICUgMyA9PT0gMSkge1xuICAgICAgICBiYXNlNjQgPSBiYXNlNjQuc3Vic3RyaW5nKDAsIGJhc2U2NC5sZW5ndGggLSAyKSArICc9PSc7XG4gICAgfVxuICAgIHJldHVybiBiYXNlNjQ7XG59O1xuZXhwb3J0IGNvbnN0IGRlY29kZSA9IChiYXNlNjQpID0+IHtcbiAgICBsZXQgYnVmZmVyTGVuZ3RoID0gYmFzZTY0Lmxlbmd0aCAqIDAuNzUsIGxlbiA9IGJhc2U2NC5sZW5ndGgsIGksIHAgPSAwLCBlbmNvZGVkMSwgZW5jb2RlZDIsIGVuY29kZWQzLCBlbmNvZGVkNDtcbiAgICBpZiAoYmFzZTY0W2Jhc2U2NC5sZW5ndGggLSAxXSA9PT0gJz0nKSB7XG4gICAgICAgIGJ1ZmZlckxlbmd0aC0tO1xuICAgICAgICBpZiAoYmFzZTY0W2Jhc2U2NC5sZW5ndGggLSAyXSA9PT0gJz0nKSB7XG4gICAgICAgICAgICBidWZmZXJMZW5ndGgtLTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBhcnJheWJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcihidWZmZXJMZW5ndGgpLCBieXRlcyA9IG5ldyBVaW50OEFycmF5KGFycmF5YnVmZmVyKTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpICs9IDQpIHtcbiAgICAgICAgZW5jb2RlZDEgPSBsb29rdXBbYmFzZTY0LmNoYXJDb2RlQXQoaSldO1xuICAgICAgICBlbmNvZGVkMiA9IGxvb2t1cFtiYXNlNjQuY2hhckNvZGVBdChpICsgMSldO1xuICAgICAgICBlbmNvZGVkMyA9IGxvb2t1cFtiYXNlNjQuY2hhckNvZGVBdChpICsgMildO1xuICAgICAgICBlbmNvZGVkNCA9IGxvb2t1cFtiYXNlNjQuY2hhckNvZGVBdChpICsgMyldO1xuICAgICAgICBieXRlc1twKytdID0gKGVuY29kZWQxIDw8IDIpIHwgKGVuY29kZWQyID4+IDQpO1xuICAgICAgICBieXRlc1twKytdID0gKChlbmNvZGVkMiAmIDE1KSA8PCA0KSB8IChlbmNvZGVkMyA+PiAyKTtcbiAgICAgICAgYnl0ZXNbcCsrXSA9ICgoZW5jb2RlZDMgJiAzKSA8PCA2KSB8IChlbmNvZGVkNCAmIDYzKTtcbiAgICB9XG4gICAgcmV0dXJuIGFycmF5YnVmZmVyO1xufTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/contrib/base64-arraybuffer.js\n\n}")},"./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/decodePacket.browser.js":
/*!*******************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/decodePacket.browser.js ***!
  \*******************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   decodePacket: () => (/* binding */ decodePacket)\n/* harmony export */ });\n/* harmony import */ var _commons_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./commons.js */ "./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/commons.js");\n/* harmony import */ var _contrib_base64_arraybuffer_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./contrib/base64-arraybuffer.js */ "./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/contrib/base64-arraybuffer.js");\n\n\nconst withNativeArrayBuffer = typeof ArrayBuffer === "function";\nconst decodePacket = (encodedPacket, binaryType) => {\n    if (typeof encodedPacket !== "string") {\n        return {\n            type: "message",\n            data: mapBinary(encodedPacket, binaryType),\n        };\n    }\n    const type = encodedPacket.charAt(0);\n    if (type === "b") {\n        return {\n            type: "message",\n            data: decodeBase64Packet(encodedPacket.substring(1), binaryType),\n        };\n    }\n    const packetType = _commons_js__WEBPACK_IMPORTED_MODULE_0__.PACKET_TYPES_REVERSE[type];\n    if (!packetType) {\n        return _commons_js__WEBPACK_IMPORTED_MODULE_0__.ERROR_PACKET;\n    }\n    return encodedPacket.length > 1\n        ? {\n            type: _commons_js__WEBPACK_IMPORTED_MODULE_0__.PACKET_TYPES_REVERSE[type],\n            data: encodedPacket.substring(1),\n        }\n        : {\n            type: _commons_js__WEBPACK_IMPORTED_MODULE_0__.PACKET_TYPES_REVERSE[type],\n        };\n};\nconst decodeBase64Packet = (data, binaryType) => {\n    if (withNativeArrayBuffer) {\n        const decoded = (0,_contrib_base64_arraybuffer_js__WEBPACK_IMPORTED_MODULE_1__.decode)(data);\n        return mapBinary(decoded, binaryType);\n    }\n    else {\n        return { base64: true, data }; // fallback for old browsers\n    }\n};\nconst mapBinary = (data, binaryType) => {\n    switch (binaryType) {\n        case "blob":\n            if (data instanceof Blob) {\n                // from WebSocket + binaryType "blob"\n                return data;\n            }\n            else {\n                // from HTTP long-polling or WebTransport\n                return new Blob([data]);\n            }\n        case "arraybuffer":\n        default:\n            if (data instanceof ArrayBuffer) {\n                // from HTTP long-polling (base64) or WebSocket + binaryType "arraybuffer"\n                return data;\n            }\n            else {\n                // from WebTransport (Uint8Array)\n                return data.buffer;\n            }\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLXBhcnNlckA1LjIuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLXBhcnNlci9idWlsZC9lc20vZGVjb2RlUGFja2V0LmJyb3dzZXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQW1FO0FBQ1Y7QUFDekQ7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLDZEQUFvQjtBQUMzQztBQUNBLGVBQWUscURBQVk7QUFDM0I7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLDZEQUFvQjtBQUN0QztBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsNkRBQW9CO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHNFQUFNO0FBQzlCO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixzQkFBc0I7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLXBhcnNlckA1LjIuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLXBhcnNlci9idWlsZC9lc20vZGVjb2RlUGFja2V0LmJyb3dzZXIuanM/MjY3NCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBFUlJPUl9QQUNLRVQsIFBBQ0tFVF9UWVBFU19SRVZFUlNFLCB9IGZyb20gXCIuL2NvbW1vbnMuanNcIjtcbmltcG9ydCB7IGRlY29kZSB9IGZyb20gXCIuL2NvbnRyaWIvYmFzZTY0LWFycmF5YnVmZmVyLmpzXCI7XG5jb25zdCB3aXRoTmF0aXZlQXJyYXlCdWZmZXIgPSB0eXBlb2YgQXJyYXlCdWZmZXIgPT09IFwiZnVuY3Rpb25cIjtcbmV4cG9ydCBjb25zdCBkZWNvZGVQYWNrZXQgPSAoZW5jb2RlZFBhY2tldCwgYmluYXJ5VHlwZSkgPT4ge1xuICAgIGlmICh0eXBlb2YgZW5jb2RlZFBhY2tldCAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogXCJtZXNzYWdlXCIsXG4gICAgICAgICAgICBkYXRhOiBtYXBCaW5hcnkoZW5jb2RlZFBhY2tldCwgYmluYXJ5VHlwZSksXG4gICAgICAgIH07XG4gICAgfVxuICAgIGNvbnN0IHR5cGUgPSBlbmNvZGVkUGFja2V0LmNoYXJBdCgwKTtcbiAgICBpZiAodHlwZSA9PT0gXCJiXCIpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6IFwibWVzc2FnZVwiLFxuICAgICAgICAgICAgZGF0YTogZGVjb2RlQmFzZTY0UGFja2V0KGVuY29kZWRQYWNrZXQuc3Vic3RyaW5nKDEpLCBiaW5hcnlUeXBlKSxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgY29uc3QgcGFja2V0VHlwZSA9IFBBQ0tFVF9UWVBFU19SRVZFUlNFW3R5cGVdO1xuICAgIGlmICghcGFja2V0VHlwZSkge1xuICAgICAgICByZXR1cm4gRVJST1JfUEFDS0VUO1xuICAgIH1cbiAgICByZXR1cm4gZW5jb2RlZFBhY2tldC5sZW5ndGggPiAxXG4gICAgICAgID8ge1xuICAgICAgICAgICAgdHlwZTogUEFDS0VUX1RZUEVTX1JFVkVSU0VbdHlwZV0sXG4gICAgICAgICAgICBkYXRhOiBlbmNvZGVkUGFja2V0LnN1YnN0cmluZygxKSxcbiAgICAgICAgfVxuICAgICAgICA6IHtcbiAgICAgICAgICAgIHR5cGU6IFBBQ0tFVF9UWVBFU19SRVZFUlNFW3R5cGVdLFxuICAgICAgICB9O1xufTtcbmNvbnN0IGRlY29kZUJhc2U2NFBhY2tldCA9IChkYXRhLCBiaW5hcnlUeXBlKSA9PiB7XG4gICAgaWYgKHdpdGhOYXRpdmVBcnJheUJ1ZmZlcikge1xuICAgICAgICBjb25zdCBkZWNvZGVkID0gZGVjb2RlKGRhdGEpO1xuICAgICAgICByZXR1cm4gbWFwQmluYXJ5KGRlY29kZWQsIGJpbmFyeVR5cGUpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHsgYmFzZTY0OiB0cnVlLCBkYXRhIH07IC8vIGZhbGxiYWNrIGZvciBvbGQgYnJvd3NlcnNcbiAgICB9XG59O1xuY29uc3QgbWFwQmluYXJ5ID0gKGRhdGEsIGJpbmFyeVR5cGUpID0+IHtcbiAgICBzd2l0Y2ggKGJpbmFyeVR5cGUpIHtcbiAgICAgICAgY2FzZSBcImJsb2JcIjpcbiAgICAgICAgICAgIGlmIChkYXRhIGluc3RhbmNlb2YgQmxvYikge1xuICAgICAgICAgICAgICAgIC8vIGZyb20gV2ViU29ja2V0ICsgYmluYXJ5VHlwZSBcImJsb2JcIlxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gZnJvbSBIVFRQIGxvbmctcG9sbGluZyBvciBXZWJUcmFuc3BvcnRcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEJsb2IoW2RhdGFdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgY2FzZSBcImFycmF5YnVmZmVyXCI6XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICBpZiAoZGF0YSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XG4gICAgICAgICAgICAgICAgLy8gZnJvbSBIVFRQIGxvbmctcG9sbGluZyAoYmFzZTY0KSBvciBXZWJTb2NrZXQgKyBiaW5hcnlUeXBlIFwiYXJyYXlidWZmZXJcIlxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gZnJvbSBXZWJUcmFuc3BvcnQgKFVpbnQ4QXJyYXkpXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEuYnVmZmVyO1xuICAgICAgICAgICAgfVxuICAgIH1cbn07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/decodePacket.browser.js\n\n}')},"./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/encodePacket.browser.js":
/*!*******************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/encodePacket.browser.js ***!
  \*******************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   encodePacket: () => (/* binding */ encodePacket),\n/* harmony export */   encodePacketToBinary: () => (/* binding */ encodePacketToBinary)\n/* harmony export */ });\n/* harmony import */ var _commons_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./commons.js */ "./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/commons.js");\n\nconst withNativeBlob = typeof Blob === "function" ||\n    (typeof Blob !== "undefined" &&\n        Object.prototype.toString.call(Blob) === "[object BlobConstructor]");\nconst withNativeArrayBuffer = typeof ArrayBuffer === "function";\n// ArrayBuffer.isView method is not defined in IE10\nconst isView = (obj) => {\n    return typeof ArrayBuffer.isView === "function"\n        ? ArrayBuffer.isView(obj)\n        : obj && obj.buffer instanceof ArrayBuffer;\n};\nconst encodePacket = ({ type, data }, supportsBinary, callback) => {\n    if (withNativeBlob && data instanceof Blob) {\n        if (supportsBinary) {\n            return callback(data);\n        }\n        else {\n            return encodeBlobAsBase64(data, callback);\n        }\n    }\n    else if (withNativeArrayBuffer &&\n        (data instanceof ArrayBuffer || isView(data))) {\n        if (supportsBinary) {\n            return callback(data);\n        }\n        else {\n            return encodeBlobAsBase64(new Blob([data]), callback);\n        }\n    }\n    // plain string\n    return callback(_commons_js__WEBPACK_IMPORTED_MODULE_0__.PACKET_TYPES[type] + (data || ""));\n};\nconst encodeBlobAsBase64 = (data, callback) => {\n    const fileReader = new FileReader();\n    fileReader.onload = function () {\n        const content = fileReader.result.split(",")[1];\n        callback("b" + (content || ""));\n    };\n    return fileReader.readAsDataURL(data);\n};\nfunction toArray(data) {\n    if (data instanceof Uint8Array) {\n        return data;\n    }\n    else if (data instanceof ArrayBuffer) {\n        return new Uint8Array(data);\n    }\n    else {\n        return new Uint8Array(data.buffer, data.byteOffset, data.byteLength);\n    }\n}\nlet TEXT_ENCODER;\nfunction encodePacketToBinary(packet, callback) {\n    if (withNativeBlob && packet.data instanceof Blob) {\n        return packet.data.arrayBuffer().then(toArray).then(callback);\n    }\n    else if (withNativeArrayBuffer &&\n        (packet.data instanceof ArrayBuffer || isView(packet.data))) {\n        return callback(toArray(packet.data));\n    }\n    encodePacket(packet, false, (encoded) => {\n        if (!TEXT_ENCODER) {\n            TEXT_ENCODER = new TextEncoder();\n        }\n        callback(TEXT_ENCODER.encode(encoded));\n    });\n}\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLXBhcnNlckA1LjIuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLXBhcnNlci9idWlsZC9lc20vZW5jb2RlUGFja2V0LmJyb3dzZXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQTRDO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLFlBQVk7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLHFEQUFZO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3dCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2VuZ2luZS5pby1wYXJzZXJANS4yLjMvbm9kZV9tb2R1bGVzL2VuZ2luZS5pby1wYXJzZXIvYnVpbGQvZXNtL2VuY29kZVBhY2tldC5icm93c2VyLmpzP2VkMzciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUEFDS0VUX1RZUEVTIH0gZnJvbSBcIi4vY29tbW9ucy5qc1wiO1xuY29uc3Qgd2l0aE5hdGl2ZUJsb2IgPSB0eXBlb2YgQmxvYiA9PT0gXCJmdW5jdGlvblwiIHx8XG4gICAgKHR5cGVvZiBCbG9iICE9PSBcInVuZGVmaW5lZFwiICYmXG4gICAgICAgIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChCbG9iKSA9PT0gXCJbb2JqZWN0IEJsb2JDb25zdHJ1Y3Rvcl1cIik7XG5jb25zdCB3aXRoTmF0aXZlQXJyYXlCdWZmZXIgPSB0eXBlb2YgQXJyYXlCdWZmZXIgPT09IFwiZnVuY3Rpb25cIjtcbi8vIEFycmF5QnVmZmVyLmlzVmlldyBtZXRob2QgaXMgbm90IGRlZmluZWQgaW4gSUUxMFxuY29uc3QgaXNWaWV3ID0gKG9iaikgPT4ge1xuICAgIHJldHVybiB0eXBlb2YgQXJyYXlCdWZmZXIuaXNWaWV3ID09PSBcImZ1bmN0aW9uXCJcbiAgICAgICAgPyBBcnJheUJ1ZmZlci5pc1ZpZXcob2JqKVxuICAgICAgICA6IG9iaiAmJiBvYmouYnVmZmVyIGluc3RhbmNlb2YgQXJyYXlCdWZmZXI7XG59O1xuY29uc3QgZW5jb2RlUGFja2V0ID0gKHsgdHlwZSwgZGF0YSB9LCBzdXBwb3J0c0JpbmFyeSwgY2FsbGJhY2spID0+IHtcbiAgICBpZiAod2l0aE5hdGl2ZUJsb2IgJiYgZGF0YSBpbnN0YW5jZW9mIEJsb2IpIHtcbiAgICAgICAgaWYgKHN1cHBvcnRzQmluYXJ5KSB7XG4gICAgICAgICAgICByZXR1cm4gY2FsbGJhY2soZGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZW5jb2RlQmxvYkFzQmFzZTY0KGRhdGEsIGNhbGxiYWNrKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmICh3aXRoTmF0aXZlQXJyYXlCdWZmZXIgJiZcbiAgICAgICAgKGRhdGEgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlciB8fCBpc1ZpZXcoZGF0YSkpKSB7XG4gICAgICAgIGlmIChzdXBwb3J0c0JpbmFyeSkge1xuICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKGRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGVuY29kZUJsb2JBc0Jhc2U2NChuZXcgQmxvYihbZGF0YV0pLCBjYWxsYmFjayk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gcGxhaW4gc3RyaW5nXG4gICAgcmV0dXJuIGNhbGxiYWNrKFBBQ0tFVF9UWVBFU1t0eXBlXSArIChkYXRhIHx8IFwiXCIpKTtcbn07XG5jb25zdCBlbmNvZGVCbG9iQXNCYXNlNjQgPSAoZGF0YSwgY2FsbGJhY2spID0+IHtcbiAgICBjb25zdCBmaWxlUmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcbiAgICBmaWxlUmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc3QgY29udGVudCA9IGZpbGVSZWFkZXIucmVzdWx0LnNwbGl0KFwiLFwiKVsxXTtcbiAgICAgICAgY2FsbGJhY2soXCJiXCIgKyAoY29udGVudCB8fCBcIlwiKSk7XG4gICAgfTtcbiAgICByZXR1cm4gZmlsZVJlYWRlci5yZWFkQXNEYXRhVVJMKGRhdGEpO1xufTtcbmZ1bmN0aW9uIHRvQXJyYXkoZGF0YSkge1xuICAgIGlmIChkYXRhIGluc3RhbmNlb2YgVWludDhBcnJheSkge1xuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZGF0YSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XG4gICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheShkYXRhKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheShkYXRhLmJ1ZmZlciwgZGF0YS5ieXRlT2Zmc2V0LCBkYXRhLmJ5dGVMZW5ndGgpO1xuICAgIH1cbn1cbmxldCBURVhUX0VOQ09ERVI7XG5leHBvcnQgZnVuY3Rpb24gZW5jb2RlUGFja2V0VG9CaW5hcnkocGFja2V0LCBjYWxsYmFjaykge1xuICAgIGlmICh3aXRoTmF0aXZlQmxvYiAmJiBwYWNrZXQuZGF0YSBpbnN0YW5jZW9mIEJsb2IpIHtcbiAgICAgICAgcmV0dXJuIHBhY2tldC5kYXRhLmFycmF5QnVmZmVyKCkudGhlbih0b0FycmF5KS50aGVuKGNhbGxiYWNrKTtcbiAgICB9XG4gICAgZWxzZSBpZiAod2l0aE5hdGl2ZUFycmF5QnVmZmVyICYmXG4gICAgICAgIChwYWNrZXQuZGF0YSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyIHx8IGlzVmlldyhwYWNrZXQuZGF0YSkpKSB7XG4gICAgICAgIHJldHVybiBjYWxsYmFjayh0b0FycmF5KHBhY2tldC5kYXRhKSk7XG4gICAgfVxuICAgIGVuY29kZVBhY2tldChwYWNrZXQsIGZhbHNlLCAoZW5jb2RlZCkgPT4ge1xuICAgICAgICBpZiAoIVRFWFRfRU5DT0RFUikge1xuICAgICAgICAgICAgVEVYVF9FTkNPREVSID0gbmV3IFRleHRFbmNvZGVyKCk7XG4gICAgICAgIH1cbiAgICAgICAgY2FsbGJhY2soVEVYVF9FTkNPREVSLmVuY29kZShlbmNvZGVkKSk7XG4gICAgfSk7XG59XG5leHBvcnQgeyBlbmNvZGVQYWNrZXQgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/encodePacket.browser.js\n\n}')},"./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/index.js":
/*!****************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/index.js ***!
  \****************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createPacketDecoderStream: () => (/* binding */ createPacketDecoderStream),\n/* harmony export */   createPacketEncoderStream: () => (/* binding */ createPacketEncoderStream),\n/* harmony export */   decodePacket: () => (/* reexport safe */ _decodePacket_js__WEBPACK_IMPORTED_MODULE_1__.decodePacket),\n/* harmony export */   decodePayload: () => (/* binding */ decodePayload),\n/* harmony export */   encodePacket: () => (/* reexport safe */ _encodePacket_js__WEBPACK_IMPORTED_MODULE_0__.encodePacket),\n/* harmony export */   encodePayload: () => (/* binding */ encodePayload),\n/* harmony export */   protocol: () => (/* binding */ protocol)\n/* harmony export */ });\n/* harmony import */ var _encodePacket_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./encodePacket.js */ "./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/encodePacket.browser.js");\n/* harmony import */ var _decodePacket_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./decodePacket.js */ "./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/decodePacket.browser.js");\n/* harmony import */ var _commons_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./commons.js */ "./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/commons.js");\n\n\n\nconst SEPARATOR = String.fromCharCode(30); // see https://en.wikipedia.org/wiki/Delimiter#ASCII_delimited_text\nconst encodePayload = (packets, callback) => {\n    // some packets may be added to the array while encoding, so the initial length must be saved\n    const length = packets.length;\n    const encodedPackets = new Array(length);\n    let count = 0;\n    packets.forEach((packet, i) => {\n        // force base64 encoding for binary packets\n        (0,_encodePacket_js__WEBPACK_IMPORTED_MODULE_0__.encodePacket)(packet, false, (encodedPacket) => {\n            encodedPackets[i] = encodedPacket;\n            if (++count === length) {\n                callback(encodedPackets.join(SEPARATOR));\n            }\n        });\n    });\n};\nconst decodePayload = (encodedPayload, binaryType) => {\n    const encodedPackets = encodedPayload.split(SEPARATOR);\n    const packets = [];\n    for (let i = 0; i < encodedPackets.length; i++) {\n        const decodedPacket = (0,_decodePacket_js__WEBPACK_IMPORTED_MODULE_1__.decodePacket)(encodedPackets[i], binaryType);\n        packets.push(decodedPacket);\n        if (decodedPacket.type === "error") {\n            break;\n        }\n    }\n    return packets;\n};\nfunction createPacketEncoderStream() {\n    return new TransformStream({\n        transform(packet, controller) {\n            (0,_encodePacket_js__WEBPACK_IMPORTED_MODULE_0__.encodePacketToBinary)(packet, (encodedPacket) => {\n                const payloadLength = encodedPacket.length;\n                let header;\n                // inspired by the WebSocket format: https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API/Writing_WebSocket_servers#decoding_payload_length\n                if (payloadLength < 126) {\n                    header = new Uint8Array(1);\n                    new DataView(header.buffer).setUint8(0, payloadLength);\n                }\n                else if (payloadLength < 65536) {\n                    header = new Uint8Array(3);\n                    const view = new DataView(header.buffer);\n                    view.setUint8(0, 126);\n                    view.setUint16(1, payloadLength);\n                }\n                else {\n                    header = new Uint8Array(9);\n                    const view = new DataView(header.buffer);\n                    view.setUint8(0, 127);\n                    view.setBigUint64(1, BigInt(payloadLength));\n                }\n                // first bit indicates whether the payload is plain text (0) or binary (1)\n                if (packet.data && typeof packet.data !== "string") {\n                    header[0] |= 0x80;\n                }\n                controller.enqueue(header);\n                controller.enqueue(encodedPacket);\n            });\n        },\n    });\n}\nlet TEXT_DECODER;\nfunction totalLength(chunks) {\n    return chunks.reduce((acc, chunk) => acc + chunk.length, 0);\n}\nfunction concatChunks(chunks, size) {\n    if (chunks[0].length === size) {\n        return chunks.shift();\n    }\n    const buffer = new Uint8Array(size);\n    let j = 0;\n    for (let i = 0; i < size; i++) {\n        buffer[i] = chunks[0][j++];\n        if (j === chunks[0].length) {\n            chunks.shift();\n            j = 0;\n        }\n    }\n    if (chunks.length && j < chunks[0].length) {\n        chunks[0] = chunks[0].slice(j);\n    }\n    return buffer;\n}\nfunction createPacketDecoderStream(maxPayload, binaryType) {\n    if (!TEXT_DECODER) {\n        TEXT_DECODER = new TextDecoder();\n    }\n    const chunks = [];\n    let state = 0 /* State.READ_HEADER */;\n    let expectedLength = -1;\n    let isBinary = false;\n    return new TransformStream({\n        transform(chunk, controller) {\n            chunks.push(chunk);\n            while (true) {\n                if (state === 0 /* State.READ_HEADER */) {\n                    if (totalLength(chunks) < 1) {\n                        break;\n                    }\n                    const header = concatChunks(chunks, 1);\n                    isBinary = (header[0] & 0x80) === 0x80;\n                    expectedLength = header[0] & 0x7f;\n                    if (expectedLength < 126) {\n                        state = 3 /* State.READ_PAYLOAD */;\n                    }\n                    else if (expectedLength === 126) {\n                        state = 1 /* State.READ_EXTENDED_LENGTH_16 */;\n                    }\n                    else {\n                        state = 2 /* State.READ_EXTENDED_LENGTH_64 */;\n                    }\n                }\n                else if (state === 1 /* State.READ_EXTENDED_LENGTH_16 */) {\n                    if (totalLength(chunks) < 2) {\n                        break;\n                    }\n                    const headerArray = concatChunks(chunks, 2);\n                    expectedLength = new DataView(headerArray.buffer, headerArray.byteOffset, headerArray.length).getUint16(0);\n                    state = 3 /* State.READ_PAYLOAD */;\n                }\n                else if (state === 2 /* State.READ_EXTENDED_LENGTH_64 */) {\n                    if (totalLength(chunks) < 8) {\n                        break;\n                    }\n                    const headerArray = concatChunks(chunks, 8);\n                    const view = new DataView(headerArray.buffer, headerArray.byteOffset, headerArray.length);\n                    const n = view.getUint32(0);\n                    if (n > Math.pow(2, 53 - 32) - 1) {\n                        // the maximum safe integer in JavaScript is 2^53 - 1\n                        controller.enqueue(_commons_js__WEBPACK_IMPORTED_MODULE_2__.ERROR_PACKET);\n                        break;\n                    }\n                    expectedLength = n * Math.pow(2, 32) + view.getUint32(4);\n                    state = 3 /* State.READ_PAYLOAD */;\n                }\n                else {\n                    if (totalLength(chunks) < expectedLength) {\n                        break;\n                    }\n                    const data = concatChunks(chunks, expectedLength);\n                    controller.enqueue((0,_decodePacket_js__WEBPACK_IMPORTED_MODULE_1__.decodePacket)(isBinary ? data : TEXT_DECODER.decode(data), binaryType));\n                    state = 0 /* State.READ_HEADER */;\n                }\n                if (expectedLength === 0 || expectedLength > maxPayload) {\n                    controller.enqueue(_commons_js__WEBPACK_IMPORTED_MODULE_2__.ERROR_PACKET);\n                    break;\n                }\n            }\n        },\n    });\n}\nconst protocol = 4;\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLXBhcnNlckA1LjIuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLXBhcnNlci9idWlsZC9lc20vaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUF1RTtBQUN0QjtBQUNKO0FBQzdDLDJDQUEyQztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsOERBQVk7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLDJCQUEyQjtBQUMvQyw4QkFBOEIsOERBQVk7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQSxZQUFZLHNFQUFvQjtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1QsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsVUFBVTtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkMscURBQVk7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUMsOERBQVk7QUFDbkQ7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLHFEQUFZO0FBQ25EO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxLQUFLO0FBQ0w7QUFDTztBQUM4RCIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL25vZGVfbW9kdWxlcy8ucG5wbS9lbmdpbmUuaW8tcGFyc2VyQDUuMi4zL25vZGVfbW9kdWxlcy9lbmdpbmUuaW8tcGFyc2VyL2J1aWxkL2VzbS9pbmRleC5qcz83ZTIxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGVuY29kZVBhY2tldCwgZW5jb2RlUGFja2V0VG9CaW5hcnkgfSBmcm9tIFwiLi9lbmNvZGVQYWNrZXQuanNcIjtcbmltcG9ydCB7IGRlY29kZVBhY2tldCB9IGZyb20gXCIuL2RlY29kZVBhY2tldC5qc1wiO1xuaW1wb3J0IHsgRVJST1JfUEFDS0VULCB9IGZyb20gXCIuL2NvbW1vbnMuanNcIjtcbmNvbnN0IFNFUEFSQVRPUiA9IFN0cmluZy5mcm9tQ2hhckNvZGUoMzApOyAvLyBzZWUgaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvRGVsaW1pdGVyI0FTQ0lJX2RlbGltaXRlZF90ZXh0XG5jb25zdCBlbmNvZGVQYXlsb2FkID0gKHBhY2tldHMsIGNhbGxiYWNrKSA9PiB7XG4gICAgLy8gc29tZSBwYWNrZXRzIG1heSBiZSBhZGRlZCB0byB0aGUgYXJyYXkgd2hpbGUgZW5jb2RpbmcsIHNvIHRoZSBpbml0aWFsIGxlbmd0aCBtdXN0IGJlIHNhdmVkXG4gICAgY29uc3QgbGVuZ3RoID0gcGFja2V0cy5sZW5ndGg7XG4gICAgY29uc3QgZW5jb2RlZFBhY2tldHMgPSBuZXcgQXJyYXkobGVuZ3RoKTtcbiAgICBsZXQgY291bnQgPSAwO1xuICAgIHBhY2tldHMuZm9yRWFjaCgocGFja2V0LCBpKSA9PiB7XG4gICAgICAgIC8vIGZvcmNlIGJhc2U2NCBlbmNvZGluZyBmb3IgYmluYXJ5IHBhY2tldHNcbiAgICAgICAgZW5jb2RlUGFja2V0KHBhY2tldCwgZmFsc2UsIChlbmNvZGVkUGFja2V0KSA9PiB7XG4gICAgICAgICAgICBlbmNvZGVkUGFja2V0c1tpXSA9IGVuY29kZWRQYWNrZXQ7XG4gICAgICAgICAgICBpZiAoKytjb3VudCA9PT0gbGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soZW5jb2RlZFBhY2tldHMuam9pbihTRVBBUkFUT1IpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSk7XG59O1xuY29uc3QgZGVjb2RlUGF5bG9hZCA9IChlbmNvZGVkUGF5bG9hZCwgYmluYXJ5VHlwZSkgPT4ge1xuICAgIGNvbnN0IGVuY29kZWRQYWNrZXRzID0gZW5jb2RlZFBheWxvYWQuc3BsaXQoU0VQQVJBVE9SKTtcbiAgICBjb25zdCBwYWNrZXRzID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlbmNvZGVkUGFja2V0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBkZWNvZGVkUGFja2V0ID0gZGVjb2RlUGFja2V0KGVuY29kZWRQYWNrZXRzW2ldLCBiaW5hcnlUeXBlKTtcbiAgICAgICAgcGFja2V0cy5wdXNoKGRlY29kZWRQYWNrZXQpO1xuICAgICAgICBpZiAoZGVjb2RlZFBhY2tldC50eXBlID09PSBcImVycm9yXCIpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBwYWNrZXRzO1xufTtcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVQYWNrZXRFbmNvZGVyU3RyZWFtKCkge1xuICAgIHJldHVybiBuZXcgVHJhbnNmb3JtU3RyZWFtKHtcbiAgICAgICAgdHJhbnNmb3JtKHBhY2tldCwgY29udHJvbGxlcikge1xuICAgICAgICAgICAgZW5jb2RlUGFja2V0VG9CaW5hcnkocGFja2V0LCAoZW5jb2RlZFBhY2tldCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHBheWxvYWRMZW5ndGggPSBlbmNvZGVkUGFja2V0Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICBsZXQgaGVhZGVyO1xuICAgICAgICAgICAgICAgIC8vIGluc3BpcmVkIGJ5IHRoZSBXZWJTb2NrZXQgZm9ybWF0OiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvV2ViU29ja2V0c19BUEkvV3JpdGluZ19XZWJTb2NrZXRfc2VydmVycyNkZWNvZGluZ19wYXlsb2FkX2xlbmd0aFxuICAgICAgICAgICAgICAgIGlmIChwYXlsb2FkTGVuZ3RoIDwgMTI2KSB7XG4gICAgICAgICAgICAgICAgICAgIGhlYWRlciA9IG5ldyBVaW50OEFycmF5KDEpO1xuICAgICAgICAgICAgICAgICAgICBuZXcgRGF0YVZpZXcoaGVhZGVyLmJ1ZmZlcikuc2V0VWludDgoMCwgcGF5bG9hZExlbmd0aCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHBheWxvYWRMZW5ndGggPCA2NTUzNikge1xuICAgICAgICAgICAgICAgICAgICBoZWFkZXIgPSBuZXcgVWludDhBcnJheSgzKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmlldyA9IG5ldyBEYXRhVmlldyhoZWFkZXIuYnVmZmVyKTtcbiAgICAgICAgICAgICAgICAgICAgdmlldy5zZXRVaW50OCgwLCAxMjYpO1xuICAgICAgICAgICAgICAgICAgICB2aWV3LnNldFVpbnQxNigxLCBwYXlsb2FkTGVuZ3RoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGhlYWRlciA9IG5ldyBVaW50OEFycmF5KDkpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2aWV3ID0gbmV3IERhdGFWaWV3KGhlYWRlci5idWZmZXIpO1xuICAgICAgICAgICAgICAgICAgICB2aWV3LnNldFVpbnQ4KDAsIDEyNyk7XG4gICAgICAgICAgICAgICAgICAgIHZpZXcuc2V0QmlnVWludDY0KDEsIEJpZ0ludChwYXlsb2FkTGVuZ3RoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIGZpcnN0IGJpdCBpbmRpY2F0ZXMgd2hldGhlciB0aGUgcGF5bG9hZCBpcyBwbGFpbiB0ZXh0ICgwKSBvciBiaW5hcnkgKDEpXG4gICAgICAgICAgICAgICAgaWYgKHBhY2tldC5kYXRhICYmIHR5cGVvZiBwYWNrZXQuZGF0YSAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgICAgICBoZWFkZXJbMF0gfD0gMHg4MDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKGhlYWRlcik7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKGVuY29kZWRQYWNrZXQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgfSk7XG59XG5sZXQgVEVYVF9ERUNPREVSO1xuZnVuY3Rpb24gdG90YWxMZW5ndGgoY2h1bmtzKSB7XG4gICAgcmV0dXJuIGNodW5rcy5yZWR1Y2UoKGFjYywgY2h1bmspID0+IGFjYyArIGNodW5rLmxlbmd0aCwgMCk7XG59XG5mdW5jdGlvbiBjb25jYXRDaHVua3MoY2h1bmtzLCBzaXplKSB7XG4gICAgaWYgKGNodW5rc1swXS5sZW5ndGggPT09IHNpemUpIHtcbiAgICAgICAgcmV0dXJuIGNodW5rcy5zaGlmdCgpO1xuICAgIH1cbiAgICBjb25zdCBidWZmZXIgPSBuZXcgVWludDhBcnJheShzaXplKTtcbiAgICBsZXQgaiA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaXplOyBpKyspIHtcbiAgICAgICAgYnVmZmVyW2ldID0gY2h1bmtzWzBdW2orK107XG4gICAgICAgIGlmIChqID09PSBjaHVua3NbMF0ubGVuZ3RoKSB7XG4gICAgICAgICAgICBjaHVua3Muc2hpZnQoKTtcbiAgICAgICAgICAgIGogPSAwO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChjaHVua3MubGVuZ3RoICYmIGogPCBjaHVua3NbMF0ubGVuZ3RoKSB7XG4gICAgICAgIGNodW5rc1swXSA9IGNodW5rc1swXS5zbGljZShqKTtcbiAgICB9XG4gICAgcmV0dXJuIGJ1ZmZlcjtcbn1cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVQYWNrZXREZWNvZGVyU3RyZWFtKG1heFBheWxvYWQsIGJpbmFyeVR5cGUpIHtcbiAgICBpZiAoIVRFWFRfREVDT0RFUikge1xuICAgICAgICBURVhUX0RFQ09ERVIgPSBuZXcgVGV4dERlY29kZXIoKTtcbiAgICB9XG4gICAgY29uc3QgY2h1bmtzID0gW107XG4gICAgbGV0IHN0YXRlID0gMCAvKiBTdGF0ZS5SRUFEX0hFQURFUiAqLztcbiAgICBsZXQgZXhwZWN0ZWRMZW5ndGggPSAtMTtcbiAgICBsZXQgaXNCaW5hcnkgPSBmYWxzZTtcbiAgICByZXR1cm4gbmV3IFRyYW5zZm9ybVN0cmVhbSh7XG4gICAgICAgIHRyYW5zZm9ybShjaHVuaywgY29udHJvbGxlcikge1xuICAgICAgICAgICAgY2h1bmtzLnB1c2goY2h1bmspO1xuICAgICAgICAgICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUgPT09IDAgLyogU3RhdGUuUkVBRF9IRUFERVIgKi8pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRvdGFsTGVuZ3RoKGNodW5rcykgPCAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb25zdCBoZWFkZXIgPSBjb25jYXRDaHVua3MoY2h1bmtzLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgaXNCaW5hcnkgPSAoaGVhZGVyWzBdICYgMHg4MCkgPT09IDB4ODA7XG4gICAgICAgICAgICAgICAgICAgIGV4cGVjdGVkTGVuZ3RoID0gaGVhZGVyWzBdICYgMHg3ZjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV4cGVjdGVkTGVuZ3RoIDwgMTI2KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IDMgLyogU3RhdGUuUkVBRF9QQVlMT0FEICovO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGV4cGVjdGVkTGVuZ3RoID09PSAxMjYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlID0gMSAvKiBTdGF0ZS5SRUFEX0VYVEVOREVEX0xFTkdUSF8xNiAqLztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlID0gMiAvKiBTdGF0ZS5SRUFEX0VYVEVOREVEX0xFTkdUSF82NCAqLztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChzdGF0ZSA9PT0gMSAvKiBTdGF0ZS5SRUFEX0VYVEVOREVEX0xFTkdUSF8xNiAqLykge1xuICAgICAgICAgICAgICAgICAgICBpZiAodG90YWxMZW5ndGgoY2h1bmtzKSA8IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRlckFycmF5ID0gY29uY2F0Q2h1bmtzKGNodW5rcywgMik7XG4gICAgICAgICAgICAgICAgICAgIGV4cGVjdGVkTGVuZ3RoID0gbmV3IERhdGFWaWV3KGhlYWRlckFycmF5LmJ1ZmZlciwgaGVhZGVyQXJyYXkuYnl0ZU9mZnNldCwgaGVhZGVyQXJyYXkubGVuZ3RoKS5nZXRVaW50MTYoMCk7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gMyAvKiBTdGF0ZS5SRUFEX1BBWUxPQUQgKi87XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHN0YXRlID09PSAyIC8qIFN0YXRlLlJFQURfRVhURU5ERURfTEVOR1RIXzY0ICovKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0b3RhbExlbmd0aChjaHVua3MpIDwgOCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaGVhZGVyQXJyYXkgPSBjb25jYXRDaHVua3MoY2h1bmtzLCA4KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmlldyA9IG5ldyBEYXRhVmlldyhoZWFkZXJBcnJheS5idWZmZXIsIGhlYWRlckFycmF5LmJ5dGVPZmZzZXQsIGhlYWRlckFycmF5Lmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB2aWV3LmdldFVpbnQzMigwKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG4gPiBNYXRoLnBvdygyLCA1MyAtIDMyKSAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZSBtYXhpbXVtIHNhZmUgaW50ZWdlciBpbiBKYXZhU2NyaXB0IGlzIDJeNTMgLSAxXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoRVJST1JfUEFDS0VUKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGV4cGVjdGVkTGVuZ3RoID0gbiAqIE1hdGgucG93KDIsIDMyKSArIHZpZXcuZ2V0VWludDMyKDQpO1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IDMgLyogU3RhdGUuUkVBRF9QQVlMT0FEICovO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRvdGFsTGVuZ3RoKGNodW5rcykgPCBleHBlY3RlZExlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IGNvbmNhdENodW5rcyhjaHVua3MsIGV4cGVjdGVkTGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKGRlY29kZVBhY2tldChpc0JpbmFyeSA/IGRhdGEgOiBURVhUX0RFQ09ERVIuZGVjb2RlKGRhdGEpLCBiaW5hcnlUeXBlKSk7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gMCAvKiBTdGF0ZS5SRUFEX0hFQURFUiAqLztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGV4cGVjdGVkTGVuZ3RoID09PSAwIHx8IGV4cGVjdGVkTGVuZ3RoID4gbWF4UGF5bG9hZCkge1xuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoRVJST1JfUEFDS0VUKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgIH0pO1xufVxuZXhwb3J0IGNvbnN0IHByb3RvY29sID0gNDtcbmV4cG9ydCB7IGVuY29kZVBhY2tldCwgZW5jb2RlUGF5bG9hZCwgZGVjb2RlUGFja2V0LCBkZWNvZGVQYXlsb2FkLCB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/index.js\n\n}')},"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js":
/*!*********************************************************************************!*\
  !*** ./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js ***!
  \*********************************************************************************/function(module,exports,__webpack_require__){eval('{var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__;/*\n* loglevel - https://github.com/pimterry/loglevel\n*\n* Copyright (c) 2013 Tim Perry\n* Licensed under the MIT license.\n*/\n(function (root, definition) {\n    "use strict";\n    if (true) {\n        !(__WEBPACK_AMD_DEFINE_FACTORY__ = (definition),\n\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === \'function\' ?\n\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.call(exports, __webpack_require__, exports, module)) :\n\t\t__WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n    } else // removed by dead control flow\n{}\n}(this, function () {\n    "use strict";\n\n    // Slightly dubious tricks to cut down minimized file size\n    var noop = function() {};\n    var undefinedType = "undefined";\n    var isIE = (typeof window !== undefinedType) && (typeof window.navigator !== undefinedType) && (\n        /Trident\\/|MSIE /.test(window.navigator.userAgent)\n    );\n\n    var logMethods = [\n        "trace",\n        "debug",\n        "info",\n        "warn",\n        "error"\n    ];\n\n    var _loggersByName = {};\n    var defaultLogger = null;\n\n    // Cross-browser bind equivalent that works at least back to IE6\n    function bindMethod(obj, methodName) {\n        var method = obj[methodName];\n        if (typeof method.bind === \'function\') {\n            return method.bind(obj);\n        } else {\n            try {\n                return Function.prototype.bind.call(method, obj);\n            } catch (e) {\n                // Missing bind shim or IE8 + Modernizr, fallback to wrapping\n                return function() {\n                    return Function.prototype.apply.apply(method, [obj, arguments]);\n                };\n            }\n        }\n    }\n\n    // Trace() doesn\'t print the message in IE, so for that case we need to wrap it\n    function traceForIE() {\n        if (console.log) {\n            if (console.log.apply) {\n                console.log.apply(console, arguments);\n            } else {\n                // In old IE, native console methods themselves don\'t have apply().\n                Function.prototype.apply.apply(console.log, [console, arguments]);\n            }\n        }\n        if (console.trace) console.trace();\n    }\n\n    // Build the best logging method possible for this env\n    // Wherever possible we want to bind, not wrap, to preserve stack traces\n    function realMethod(methodName) {\n        if (methodName === \'debug\') {\n            methodName = \'log\';\n        }\n\n        if (typeof console === undefinedType) {\n            return false; // No method possible, for now - fixed later by enableLoggingWhenConsoleArrives\n        } else if (methodName === \'trace\' && isIE) {\n            return traceForIE;\n        } else if (console[methodName] !== undefined) {\n            return bindMethod(console, methodName);\n        } else if (console.log !== undefined) {\n            return bindMethod(console, \'log\');\n        } else {\n            return noop;\n        }\n    }\n\n    // These private functions always need `this` to be set properly\n\n    function replaceLoggingMethods() {\n        /*jshint validthis:true */\n        var level = this.getLevel();\n\n        // Replace the actual methods.\n        for (var i = 0; i < logMethods.length; i++) {\n            var methodName = logMethods[i];\n            this[methodName] = (i < level) ?\n                noop :\n                this.methodFactory(methodName, level, this.name);\n        }\n\n        // Define log.log as an alias for log.debug\n        this.log = this.debug;\n\n        // Return any important warnings.\n        if (typeof console === undefinedType && level < this.levels.SILENT) {\n            return "No console available for logging";\n        }\n    }\n\n    // In old IE versions, the console isn\'t present until you first open it.\n    // We build realMethod() replacements here that regenerate logging methods\n    function enableLoggingWhenConsoleArrives(methodName) {\n        return function () {\n            if (typeof console !== undefinedType) {\n                replaceLoggingMethods.call(this);\n                this[methodName].apply(this, arguments);\n            }\n        };\n    }\n\n    // By default, we use closely bound real methods wherever possible, and\n    // otherwise we wait for a console to appear, and then try again.\n    function defaultMethodFactory(methodName, _level, _loggerName) {\n        /*jshint validthis:true */\n        return realMethod(methodName) ||\n               enableLoggingWhenConsoleArrives.apply(this, arguments);\n    }\n\n    function Logger(name, factory) {\n      // Private instance variables.\n      var self = this;\n      /**\n       * The level inherited from a parent logger (or a global default). We\n       * cache this here rather than delegating to the parent so that it stays\n       * in sync with the actual logging methods that we have installed (the\n       * parent could change levels but we might not have rebuilt the loggers\n       * in this child yet).\n       * @type {number}\n       */\n      var inheritedLevel;\n      /**\n       * The default level for this logger, if any. If set, this overrides\n       * `inheritedLevel`.\n       * @type {number|null}\n       */\n      var defaultLevel;\n      /**\n       * A user-specific level for this logger. If set, this overrides\n       * `defaultLevel`.\n       * @type {number|null}\n       */\n      var userLevel;\n\n      var storageKey = "loglevel";\n      if (typeof name === "string") {\n        storageKey += ":" + name;\n      } else if (typeof name === "symbol") {\n        storageKey = undefined;\n      }\n\n      function persistLevelIfPossible(levelNum) {\n          var levelName = (logMethods[levelNum] || \'silent\').toUpperCase();\n\n          if (typeof window === undefinedType || !storageKey) return;\n\n          // Use localStorage if available\n          try {\n              window.localStorage[storageKey] = levelName;\n              return;\n          } catch (ignore) {}\n\n          // Use session cookie as fallback\n          try {\n              window.document.cookie =\n                encodeURIComponent(storageKey) + "=" + levelName + ";";\n          } catch (ignore) {}\n      }\n\n      function getPersistedLevel() {\n          var storedLevel;\n\n          if (typeof window === undefinedType || !storageKey) return;\n\n          try {\n              storedLevel = window.localStorage[storageKey];\n          } catch (ignore) {}\n\n          // Fallback to cookies if local storage gives us nothing\n          if (typeof storedLevel === undefinedType) {\n              try {\n                  var cookie = window.document.cookie;\n                  var cookieName = encodeURIComponent(storageKey);\n                  var location = cookie.indexOf(cookieName + "=");\n                  if (location !== -1) {\n                      storedLevel = /^([^;]+)/.exec(\n                          cookie.slice(location + cookieName.length + 1)\n                      )[1];\n                  }\n              } catch (ignore) {}\n          }\n\n          // If the stored level is not valid, treat it as if nothing was stored.\n          if (self.levels[storedLevel] === undefined) {\n              storedLevel = undefined;\n          }\n\n          return storedLevel;\n      }\n\n      function clearPersistedLevel() {\n          if (typeof window === undefinedType || !storageKey) return;\n\n          // Use localStorage if available\n          try {\n              window.localStorage.removeItem(storageKey);\n          } catch (ignore) {}\n\n          // Use session cookie as fallback\n          try {\n              window.document.cookie =\n                encodeURIComponent(storageKey) + "=; expires=Thu, 01 Jan 1970 00:00:00 UTC";\n          } catch (ignore) {}\n      }\n\n      function normalizeLevel(input) {\n          var level = input;\n          if (typeof level === "string" && self.levels[level.toUpperCase()] !== undefined) {\n              level = self.levels[level.toUpperCase()];\n          }\n          if (typeof level === "number" && level >= 0 && level <= self.levels.SILENT) {\n              return level;\n          } else {\n              throw new TypeError("log.setLevel() called with invalid level: " + input);\n          }\n      }\n\n      /*\n       *\n       * Public logger API - see https://github.com/pimterry/loglevel for details\n       *\n       */\n\n      self.name = name;\n\n      self.levels = { "TRACE": 0, "DEBUG": 1, "INFO": 2, "WARN": 3,\n          "ERROR": 4, "SILENT": 5};\n\n      self.methodFactory = factory || defaultMethodFactory;\n\n      self.getLevel = function () {\n          if (userLevel != null) {\n            return userLevel;\n          } else if (defaultLevel != null) {\n            return defaultLevel;\n          } else {\n            return inheritedLevel;\n          }\n      };\n\n      self.setLevel = function (level, persist) {\n          userLevel = normalizeLevel(level);\n          if (persist !== false) {  // defaults to true\n              persistLevelIfPossible(userLevel);\n          }\n\n          // NOTE: in v2, this should call rebuild(), which updates children.\n          return replaceLoggingMethods.call(self);\n      };\n\n      self.setDefaultLevel = function (level) {\n          defaultLevel = normalizeLevel(level);\n          if (!getPersistedLevel()) {\n              self.setLevel(level, false);\n          }\n      };\n\n      self.resetLevel = function () {\n          userLevel = null;\n          clearPersistedLevel();\n          replaceLoggingMethods.call(self);\n      };\n\n      self.enableAll = function(persist) {\n          self.setLevel(self.levels.TRACE, persist);\n      };\n\n      self.disableAll = function(persist) {\n          self.setLevel(self.levels.SILENT, persist);\n      };\n\n      self.rebuild = function () {\n          if (defaultLogger !== self) {\n              inheritedLevel = normalizeLevel(defaultLogger.getLevel());\n          }\n          replaceLoggingMethods.call(self);\n\n          if (defaultLogger === self) {\n              for (var childName in _loggersByName) {\n                _loggersByName[childName].rebuild();\n              }\n          }\n      };\n\n      // Initialize all the internal levels.\n      inheritedLevel = normalizeLevel(\n          defaultLogger ? defaultLogger.getLevel() : "WARN"\n      );\n      var initialLevel = getPersistedLevel();\n      if (initialLevel != null) {\n          userLevel = normalizeLevel(initialLevel);\n      }\n      replaceLoggingMethods.call(self);\n    }\n\n    /*\n     *\n     * Top-level API\n     *\n     */\n\n    defaultLogger = new Logger();\n\n    defaultLogger.getLogger = function getLogger(name) {\n        if ((typeof name !== "symbol" && typeof name !== "string") || name === "") {\n            throw new TypeError("You must supply a name when creating a logger.");\n        }\n\n        var logger = _loggersByName[name];\n        if (!logger) {\n            logger = _loggersByName[name] = new Logger(\n                name,\n                defaultLogger.methodFactory\n            );\n        }\n        return logger;\n    };\n\n    // Grab the current global log variable in case of overwrite\n    var _log = (typeof window !== undefinedType) ? window.log : undefined;\n    defaultLogger.noConflict = function() {\n        if (typeof window !== undefinedType &&\n               window.log === defaultLogger) {\n            window.log = _log;\n        }\n\n        return defaultLogger;\n    };\n\n    defaultLogger.getLoggers = function getLoggers() {\n        return _loggersByName;\n    };\n\n    // ES6 default export, for compatibility\n    defaultLogger[\'default\'] = defaultLogger;\n\n    return defaultLogger;\n}));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vbG9nbGV2ZWxAMS45LjIvbm9kZV9tb2R1bGVzL2xvZ2xldmVsL2xpYi9sb2dsZXZlbC5qcyIsIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxJQUEwQztBQUNsRCxRQUFRLG9DQUFPLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQSxrR0FBQztBQUMxQixNQUFNLEtBQUs7QUFBQSxFQUlOO0FBQ0wsQ0FBQztBQUNEOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSwwQkFBMEI7QUFDMUIsVUFBVTtBQUNWO0FBQ0EsVUFBVTtBQUNWO0FBQ0EsVUFBVTtBQUNWO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTs7QUFFWjtBQUNBO0FBQ0E7QUFDQSxxRUFBcUU7QUFDckUsWUFBWTtBQUNaOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLFlBQVk7O0FBRVo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEM7QUFDMUM7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxZQUFZOztBQUVaO0FBQ0E7QUFDQTtBQUNBLHFEQUFxRDtBQUNyRCxZQUFZO0FBQ1o7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUEsc0JBQXNCO0FBQ3RCOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLG9DQUFvQztBQUNwQztBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2xvZ2xldmVsQDEuOS4yL25vZGVfbW9kdWxlcy9sb2dsZXZlbC9saWIvbG9nbGV2ZWwuanM/ZGQwNyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuKiBsb2dsZXZlbCAtIGh0dHBzOi8vZ2l0aHViLmNvbS9waW10ZXJyeS9sb2dsZXZlbFxuKlxuKiBDb3B5cmlnaHQgKGMpIDIwMTMgVGltIFBlcnJ5XG4qIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbiovXG4oZnVuY3Rpb24gKHJvb3QsIGRlZmluaXRpb24pIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgICAgIGRlZmluZShkZWZpbml0aW9uKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzKSB7XG4gICAgICAgIG1vZHVsZS5leHBvcnRzID0gZGVmaW5pdGlvbigpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJvb3QubG9nID0gZGVmaW5pdGlvbigpO1xuICAgIH1cbn0odGhpcywgZnVuY3Rpb24gKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgLy8gU2xpZ2h0bHkgZHViaW91cyB0cmlja3MgdG8gY3V0IGRvd24gbWluaW1pemVkIGZpbGUgc2l6ZVxuICAgIHZhciBub29wID0gZnVuY3Rpb24oKSB7fTtcbiAgICB2YXIgdW5kZWZpbmVkVHlwZSA9IFwidW5kZWZpbmVkXCI7XG4gICAgdmFyIGlzSUUgPSAodHlwZW9mIHdpbmRvdyAhPT0gdW5kZWZpbmVkVHlwZSkgJiYgKHR5cGVvZiB3aW5kb3cubmF2aWdhdG9yICE9PSB1bmRlZmluZWRUeXBlKSAmJiAoXG4gICAgICAgIC9UcmlkZW50XFwvfE1TSUUgLy50ZXN0KHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50KVxuICAgICk7XG5cbiAgICB2YXIgbG9nTWV0aG9kcyA9IFtcbiAgICAgICAgXCJ0cmFjZVwiLFxuICAgICAgICBcImRlYnVnXCIsXG4gICAgICAgIFwiaW5mb1wiLFxuICAgICAgICBcIndhcm5cIixcbiAgICAgICAgXCJlcnJvclwiXG4gICAgXTtcblxuICAgIHZhciBfbG9nZ2Vyc0J5TmFtZSA9IHt9O1xuICAgIHZhciBkZWZhdWx0TG9nZ2VyID0gbnVsbDtcblxuICAgIC8vIENyb3NzLWJyb3dzZXIgYmluZCBlcXVpdmFsZW50IHRoYXQgd29ya3MgYXQgbGVhc3QgYmFjayB0byBJRTZcbiAgICBmdW5jdGlvbiBiaW5kTWV0aG9kKG9iaiwgbWV0aG9kTmFtZSkge1xuICAgICAgICB2YXIgbWV0aG9kID0gb2JqW21ldGhvZE5hbWVdO1xuICAgICAgICBpZiAodHlwZW9mIG1ldGhvZC5iaW5kID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICByZXR1cm4gbWV0aG9kLmJpbmQob2JqKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kLmNhbGwobWV0aG9kLCBvYmopO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIC8vIE1pc3NpbmcgYmluZCBzaGltIG9yIElFOCArIE1vZGVybml6ciwgZmFsbGJhY2sgdG8gd3JhcHBpbmdcbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBGdW5jdGlvbi5wcm90b3R5cGUuYXBwbHkuYXBwbHkobWV0aG9kLCBbb2JqLCBhcmd1bWVudHNdKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gVHJhY2UoKSBkb2Vzbid0IHByaW50IHRoZSBtZXNzYWdlIGluIElFLCBzbyBmb3IgdGhhdCBjYXNlIHdlIG5lZWQgdG8gd3JhcCBpdFxuICAgIGZ1bmN0aW9uIHRyYWNlRm9ySUUoKSB7XG4gICAgICAgIGlmIChjb25zb2xlLmxvZykge1xuICAgICAgICAgICAgaWYgKGNvbnNvbGUubG9nLmFwcGx5KSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cuYXBwbHkoY29uc29sZSwgYXJndW1lbnRzKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gSW4gb2xkIElFLCBuYXRpdmUgY29uc29sZSBtZXRob2RzIHRoZW1zZWx2ZXMgZG9uJ3QgaGF2ZSBhcHBseSgpLlxuICAgICAgICAgICAgICAgIEZ1bmN0aW9uLnByb3RvdHlwZS5hcHBseS5hcHBseShjb25zb2xlLmxvZywgW2NvbnNvbGUsIGFyZ3VtZW50c10pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChjb25zb2xlLnRyYWNlKSBjb25zb2xlLnRyYWNlKCk7XG4gICAgfVxuXG4gICAgLy8gQnVpbGQgdGhlIGJlc3QgbG9nZ2luZyBtZXRob2QgcG9zc2libGUgZm9yIHRoaXMgZW52XG4gICAgLy8gV2hlcmV2ZXIgcG9zc2libGUgd2Ugd2FudCB0byBiaW5kLCBub3Qgd3JhcCwgdG8gcHJlc2VydmUgc3RhY2sgdHJhY2VzXG4gICAgZnVuY3Rpb24gcmVhbE1ldGhvZChtZXRob2ROYW1lKSB7XG4gICAgICAgIGlmIChtZXRob2ROYW1lID09PSAnZGVidWcnKSB7XG4gICAgICAgICAgICBtZXRob2ROYW1lID0gJ2xvZyc7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodHlwZW9mIGNvbnNvbGUgPT09IHVuZGVmaW5lZFR5cGUpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTsgLy8gTm8gbWV0aG9kIHBvc3NpYmxlLCBmb3Igbm93IC0gZml4ZWQgbGF0ZXIgYnkgZW5hYmxlTG9nZ2luZ1doZW5Db25zb2xlQXJyaXZlc1xuICAgICAgICB9IGVsc2UgaWYgKG1ldGhvZE5hbWUgPT09ICd0cmFjZScgJiYgaXNJRSkge1xuICAgICAgICAgICAgcmV0dXJuIHRyYWNlRm9ySUU7XG4gICAgICAgIH0gZWxzZSBpZiAoY29uc29sZVttZXRob2ROYW1lXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gYmluZE1ldGhvZChjb25zb2xlLCBtZXRob2ROYW1lKTtcbiAgICAgICAgfSBlbHNlIGlmIChjb25zb2xlLmxvZyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gYmluZE1ldGhvZChjb25zb2xlLCAnbG9nJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbm9vcDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIFRoZXNlIHByaXZhdGUgZnVuY3Rpb25zIGFsd2F5cyBuZWVkIGB0aGlzYCB0byBiZSBzZXQgcHJvcGVybHlcblxuICAgIGZ1bmN0aW9uIHJlcGxhY2VMb2dnaW5nTWV0aG9kcygpIHtcbiAgICAgICAgLypqc2hpbnQgdmFsaWR0aGlzOnRydWUgKi9cbiAgICAgICAgdmFyIGxldmVsID0gdGhpcy5nZXRMZXZlbCgpO1xuXG4gICAgICAgIC8vIFJlcGxhY2UgdGhlIGFjdHVhbCBtZXRob2RzLlxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxvZ01ldGhvZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBtZXRob2ROYW1lID0gbG9nTWV0aG9kc1tpXTtcbiAgICAgICAgICAgIHRoaXNbbWV0aG9kTmFtZV0gPSAoaSA8IGxldmVsKSA/XG4gICAgICAgICAgICAgICAgbm9vcCA6XG4gICAgICAgICAgICAgICAgdGhpcy5tZXRob2RGYWN0b3J5KG1ldGhvZE5hbWUsIGxldmVsLCB0aGlzLm5hbWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRGVmaW5lIGxvZy5sb2cgYXMgYW4gYWxpYXMgZm9yIGxvZy5kZWJ1Z1xuICAgICAgICB0aGlzLmxvZyA9IHRoaXMuZGVidWc7XG5cbiAgICAgICAgLy8gUmV0dXJuIGFueSBpbXBvcnRhbnQgd2FybmluZ3MuXG4gICAgICAgIGlmICh0eXBlb2YgY29uc29sZSA9PT0gdW5kZWZpbmVkVHlwZSAmJiBsZXZlbCA8IHRoaXMubGV2ZWxzLlNJTEVOVCkge1xuICAgICAgICAgICAgcmV0dXJuIFwiTm8gY29uc29sZSBhdmFpbGFibGUgZm9yIGxvZ2dpbmdcIjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIEluIG9sZCBJRSB2ZXJzaW9ucywgdGhlIGNvbnNvbGUgaXNuJ3QgcHJlc2VudCB1bnRpbCB5b3UgZmlyc3Qgb3BlbiBpdC5cbiAgICAvLyBXZSBidWlsZCByZWFsTWV0aG9kKCkgcmVwbGFjZW1lbnRzIGhlcmUgdGhhdCByZWdlbmVyYXRlIGxvZ2dpbmcgbWV0aG9kc1xuICAgIGZ1bmN0aW9uIGVuYWJsZUxvZ2dpbmdXaGVuQ29uc29sZUFycml2ZXMobWV0aG9kTmFtZSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBjb25zb2xlICE9PSB1bmRlZmluZWRUeXBlKSB7XG4gICAgICAgICAgICAgICAgcmVwbGFjZUxvZ2dpbmdNZXRob2RzLmNhbGwodGhpcyk7XG4gICAgICAgICAgICAgICAgdGhpc1ttZXRob2ROYW1lXS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8vIEJ5IGRlZmF1bHQsIHdlIHVzZSBjbG9zZWx5IGJvdW5kIHJlYWwgbWV0aG9kcyB3aGVyZXZlciBwb3NzaWJsZSwgYW5kXG4gICAgLy8gb3RoZXJ3aXNlIHdlIHdhaXQgZm9yIGEgY29uc29sZSB0byBhcHBlYXIsIGFuZCB0aGVuIHRyeSBhZ2Fpbi5cbiAgICBmdW5jdGlvbiBkZWZhdWx0TWV0aG9kRmFjdG9yeShtZXRob2ROYW1lLCBfbGV2ZWwsIF9sb2dnZXJOYW1lKSB7XG4gICAgICAgIC8qanNoaW50IHZhbGlkdGhpczp0cnVlICovXG4gICAgICAgIHJldHVybiByZWFsTWV0aG9kKG1ldGhvZE5hbWUpIHx8XG4gICAgICAgICAgICAgICBlbmFibGVMb2dnaW5nV2hlbkNvbnNvbGVBcnJpdmVzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gTG9nZ2VyKG5hbWUsIGZhY3RvcnkpIHtcbiAgICAgIC8vIFByaXZhdGUgaW5zdGFuY2UgdmFyaWFibGVzLlxuICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgLyoqXG4gICAgICAgKiBUaGUgbGV2ZWwgaW5oZXJpdGVkIGZyb20gYSBwYXJlbnQgbG9nZ2VyIChvciBhIGdsb2JhbCBkZWZhdWx0KS4gV2VcbiAgICAgICAqIGNhY2hlIHRoaXMgaGVyZSByYXRoZXIgdGhhbiBkZWxlZ2F0aW5nIHRvIHRoZSBwYXJlbnQgc28gdGhhdCBpdCBzdGF5c1xuICAgICAgICogaW4gc3luYyB3aXRoIHRoZSBhY3R1YWwgbG9nZ2luZyBtZXRob2RzIHRoYXQgd2UgaGF2ZSBpbnN0YWxsZWQgKHRoZVxuICAgICAgICogcGFyZW50IGNvdWxkIGNoYW5nZSBsZXZlbHMgYnV0IHdlIG1pZ2h0IG5vdCBoYXZlIHJlYnVpbHQgdGhlIGxvZ2dlcnNcbiAgICAgICAqIGluIHRoaXMgY2hpbGQgeWV0KS5cbiAgICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICAgKi9cbiAgICAgIHZhciBpbmhlcml0ZWRMZXZlbDtcbiAgICAgIC8qKlxuICAgICAgICogVGhlIGRlZmF1bHQgbGV2ZWwgZm9yIHRoaXMgbG9nZ2VyLCBpZiBhbnkuIElmIHNldCwgdGhpcyBvdmVycmlkZXNcbiAgICAgICAqIGBpbmhlcml0ZWRMZXZlbGAuXG4gICAgICAgKiBAdHlwZSB7bnVtYmVyfG51bGx9XG4gICAgICAgKi9cbiAgICAgIHZhciBkZWZhdWx0TGV2ZWw7XG4gICAgICAvKipcbiAgICAgICAqIEEgdXNlci1zcGVjaWZpYyBsZXZlbCBmb3IgdGhpcyBsb2dnZXIuIElmIHNldCwgdGhpcyBvdmVycmlkZXNcbiAgICAgICAqIGBkZWZhdWx0TGV2ZWxgLlxuICAgICAgICogQHR5cGUge251bWJlcnxudWxsfVxuICAgICAgICovXG4gICAgICB2YXIgdXNlckxldmVsO1xuXG4gICAgICB2YXIgc3RvcmFnZUtleSA9IFwibG9nbGV2ZWxcIjtcbiAgICAgIGlmICh0eXBlb2YgbmFtZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICBzdG9yYWdlS2V5ICs9IFwiOlwiICsgbmFtZTtcbiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIG5hbWUgPT09IFwic3ltYm9sXCIpIHtcbiAgICAgICAgc3RvcmFnZUtleSA9IHVuZGVmaW5lZDtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gcGVyc2lzdExldmVsSWZQb3NzaWJsZShsZXZlbE51bSkge1xuICAgICAgICAgIHZhciBsZXZlbE5hbWUgPSAobG9nTWV0aG9kc1tsZXZlbE51bV0gfHwgJ3NpbGVudCcpLnRvVXBwZXJDYXNlKCk7XG5cbiAgICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gdW5kZWZpbmVkVHlwZSB8fCAhc3RvcmFnZUtleSkgcmV0dXJuO1xuXG4gICAgICAgICAgLy8gVXNlIGxvY2FsU3RvcmFnZSBpZiBhdmFpbGFibGVcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlW3N0b3JhZ2VLZXldID0gbGV2ZWxOYW1lO1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfSBjYXRjaCAoaWdub3JlKSB7fVxuXG4gICAgICAgICAgLy8gVXNlIHNlc3Npb24gY29va2llIGFzIGZhbGxiYWNrXG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgd2luZG93LmRvY3VtZW50LmNvb2tpZSA9XG4gICAgICAgICAgICAgICAgZW5jb2RlVVJJQ29tcG9uZW50KHN0b3JhZ2VLZXkpICsgXCI9XCIgKyBsZXZlbE5hbWUgKyBcIjtcIjtcbiAgICAgICAgICB9IGNhdGNoIChpZ25vcmUpIHt9XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGdldFBlcnNpc3RlZExldmVsKCkge1xuICAgICAgICAgIHZhciBzdG9yZWRMZXZlbDtcblxuICAgICAgICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSB1bmRlZmluZWRUeXBlIHx8ICFzdG9yYWdlS2V5KSByZXR1cm47XG5cbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICBzdG9yZWRMZXZlbCA9IHdpbmRvdy5sb2NhbFN0b3JhZ2Vbc3RvcmFnZUtleV07XG4gICAgICAgICAgfSBjYXRjaCAoaWdub3JlKSB7fVxuXG4gICAgICAgICAgLy8gRmFsbGJhY2sgdG8gY29va2llcyBpZiBsb2NhbCBzdG9yYWdlIGdpdmVzIHVzIG5vdGhpbmdcbiAgICAgICAgICBpZiAodHlwZW9mIHN0b3JlZExldmVsID09PSB1bmRlZmluZWRUeXBlKSB7XG4gICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICB2YXIgY29va2llID0gd2luZG93LmRvY3VtZW50LmNvb2tpZTtcbiAgICAgICAgICAgICAgICAgIHZhciBjb29raWVOYW1lID0gZW5jb2RlVVJJQ29tcG9uZW50KHN0b3JhZ2VLZXkpO1xuICAgICAgICAgICAgICAgICAgdmFyIGxvY2F0aW9uID0gY29va2llLmluZGV4T2YoY29va2llTmFtZSArIFwiPVwiKTtcbiAgICAgICAgICAgICAgICAgIGlmIChsb2NhdGlvbiAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICBzdG9yZWRMZXZlbCA9IC9eKFteO10rKS8uZXhlYyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY29va2llLnNsaWNlKGxvY2F0aW9uICsgY29va2llTmFtZS5sZW5ndGggKyAxKVxuICAgICAgICAgICAgICAgICAgICAgIClbMV07XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0gY2F0Y2ggKGlnbm9yZSkge31cbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBJZiB0aGUgc3RvcmVkIGxldmVsIGlzIG5vdCB2YWxpZCwgdHJlYXQgaXQgYXMgaWYgbm90aGluZyB3YXMgc3RvcmVkLlxuICAgICAgICAgIGlmIChzZWxmLmxldmVsc1tzdG9yZWRMZXZlbF0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICBzdG9yZWRMZXZlbCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4gc3RvcmVkTGV2ZWw7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGNsZWFyUGVyc2lzdGVkTGV2ZWwoKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09IHVuZGVmaW5lZFR5cGUgfHwgIXN0b3JhZ2VLZXkpIHJldHVybjtcblxuICAgICAgICAgIC8vIFVzZSBsb2NhbFN0b3JhZ2UgaWYgYXZhaWxhYmxlXG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKHN0b3JhZ2VLZXkpO1xuICAgICAgICAgIH0gY2F0Y2ggKGlnbm9yZSkge31cblxuICAgICAgICAgIC8vIFVzZSBzZXNzaW9uIGNvb2tpZSBhcyBmYWxsYmFja1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIHdpbmRvdy5kb2N1bWVudC5jb29raWUgPVxuICAgICAgICAgICAgICAgIGVuY29kZVVSSUNvbXBvbmVudChzdG9yYWdlS2V5KSArIFwiPTsgZXhwaXJlcz1UaHUsIDAxIEphbiAxOTcwIDAwOjAwOjAwIFVUQ1wiO1xuICAgICAgICAgIH0gY2F0Y2ggKGlnbm9yZSkge31cbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gbm9ybWFsaXplTGV2ZWwoaW5wdXQpIHtcbiAgICAgICAgICB2YXIgbGV2ZWwgPSBpbnB1dDtcbiAgICAgICAgICBpZiAodHlwZW9mIGxldmVsID09PSBcInN0cmluZ1wiICYmIHNlbGYubGV2ZWxzW2xldmVsLnRvVXBwZXJDYXNlKCldICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgbGV2ZWwgPSBzZWxmLmxldmVsc1tsZXZlbC50b1VwcGVyQ2FzZSgpXTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHR5cGVvZiBsZXZlbCA9PT0gXCJudW1iZXJcIiAmJiBsZXZlbCA+PSAwICYmIGxldmVsIDw9IHNlbGYubGV2ZWxzLlNJTEVOVCkge1xuICAgICAgICAgICAgICByZXR1cm4gbGV2ZWw7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcImxvZy5zZXRMZXZlbCgpIGNhbGxlZCB3aXRoIGludmFsaWQgbGV2ZWw6IFwiICsgaW5wdXQpO1xuICAgICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLypcbiAgICAgICAqXG4gICAgICAgKiBQdWJsaWMgbG9nZ2VyIEFQSSAtIHNlZSBodHRwczovL2dpdGh1Yi5jb20vcGltdGVycnkvbG9nbGV2ZWwgZm9yIGRldGFpbHNcbiAgICAgICAqXG4gICAgICAgKi9cblxuICAgICAgc2VsZi5uYW1lID0gbmFtZTtcblxuICAgICAgc2VsZi5sZXZlbHMgPSB7IFwiVFJBQ0VcIjogMCwgXCJERUJVR1wiOiAxLCBcIklORk9cIjogMiwgXCJXQVJOXCI6IDMsXG4gICAgICAgICAgXCJFUlJPUlwiOiA0LCBcIlNJTEVOVFwiOiA1fTtcblxuICAgICAgc2VsZi5tZXRob2RGYWN0b3J5ID0gZmFjdG9yeSB8fCBkZWZhdWx0TWV0aG9kRmFjdG9yeTtcblxuICAgICAgc2VsZi5nZXRMZXZlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBpZiAodXNlckxldmVsICE9IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybiB1c2VyTGV2ZWw7XG4gICAgICAgICAgfSBlbHNlIGlmIChkZWZhdWx0TGV2ZWwgIT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHRMZXZlbDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGluaGVyaXRlZExldmVsO1xuICAgICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIHNlbGYuc2V0TGV2ZWwgPSBmdW5jdGlvbiAobGV2ZWwsIHBlcnNpc3QpIHtcbiAgICAgICAgICB1c2VyTGV2ZWwgPSBub3JtYWxpemVMZXZlbChsZXZlbCk7XG4gICAgICAgICAgaWYgKHBlcnNpc3QgIT09IGZhbHNlKSB7ICAvLyBkZWZhdWx0cyB0byB0cnVlXG4gICAgICAgICAgICAgIHBlcnNpc3RMZXZlbElmUG9zc2libGUodXNlckxldmVsKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBOT1RFOiBpbiB2MiwgdGhpcyBzaG91bGQgY2FsbCByZWJ1aWxkKCksIHdoaWNoIHVwZGF0ZXMgY2hpbGRyZW4uXG4gICAgICAgICAgcmV0dXJuIHJlcGxhY2VMb2dnaW5nTWV0aG9kcy5jYWxsKHNlbGYpO1xuICAgICAgfTtcblxuICAgICAgc2VsZi5zZXREZWZhdWx0TGV2ZWwgPSBmdW5jdGlvbiAobGV2ZWwpIHtcbiAgICAgICAgICBkZWZhdWx0TGV2ZWwgPSBub3JtYWxpemVMZXZlbChsZXZlbCk7XG4gICAgICAgICAgaWYgKCFnZXRQZXJzaXN0ZWRMZXZlbCgpKSB7XG4gICAgICAgICAgICAgIHNlbGYuc2V0TGV2ZWwobGV2ZWwsIGZhbHNlKTtcbiAgICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBzZWxmLnJlc2V0TGV2ZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdXNlckxldmVsID0gbnVsbDtcbiAgICAgICAgICBjbGVhclBlcnNpc3RlZExldmVsKCk7XG4gICAgICAgICAgcmVwbGFjZUxvZ2dpbmdNZXRob2RzLmNhbGwoc2VsZik7XG4gICAgICB9O1xuXG4gICAgICBzZWxmLmVuYWJsZUFsbCA9IGZ1bmN0aW9uKHBlcnNpc3QpIHtcbiAgICAgICAgICBzZWxmLnNldExldmVsKHNlbGYubGV2ZWxzLlRSQUNFLCBwZXJzaXN0KTtcbiAgICAgIH07XG5cbiAgICAgIHNlbGYuZGlzYWJsZUFsbCA9IGZ1bmN0aW9uKHBlcnNpc3QpIHtcbiAgICAgICAgICBzZWxmLnNldExldmVsKHNlbGYubGV2ZWxzLlNJTEVOVCwgcGVyc2lzdCk7XG4gICAgICB9O1xuXG4gICAgICBzZWxmLnJlYnVpbGQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgaWYgKGRlZmF1bHRMb2dnZXIgIT09IHNlbGYpIHtcbiAgICAgICAgICAgICAgaW5oZXJpdGVkTGV2ZWwgPSBub3JtYWxpemVMZXZlbChkZWZhdWx0TG9nZ2VyLmdldExldmVsKCkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXBsYWNlTG9nZ2luZ01ldGhvZHMuY2FsbChzZWxmKTtcblxuICAgICAgICAgIGlmIChkZWZhdWx0TG9nZ2VyID09PSBzZWxmKSB7XG4gICAgICAgICAgICAgIGZvciAodmFyIGNoaWxkTmFtZSBpbiBfbG9nZ2Vyc0J5TmFtZSkge1xuICAgICAgICAgICAgICAgIF9sb2dnZXJzQnlOYW1lW2NoaWxkTmFtZV0ucmVidWlsZCgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgLy8gSW5pdGlhbGl6ZSBhbGwgdGhlIGludGVybmFsIGxldmVscy5cbiAgICAgIGluaGVyaXRlZExldmVsID0gbm9ybWFsaXplTGV2ZWwoXG4gICAgICAgICAgZGVmYXVsdExvZ2dlciA/IGRlZmF1bHRMb2dnZXIuZ2V0TGV2ZWwoKSA6IFwiV0FSTlwiXG4gICAgICApO1xuICAgICAgdmFyIGluaXRpYWxMZXZlbCA9IGdldFBlcnNpc3RlZExldmVsKCk7XG4gICAgICBpZiAoaW5pdGlhbExldmVsICE9IG51bGwpIHtcbiAgICAgICAgICB1c2VyTGV2ZWwgPSBub3JtYWxpemVMZXZlbChpbml0aWFsTGV2ZWwpO1xuICAgICAgfVxuICAgICAgcmVwbGFjZUxvZ2dpbmdNZXRob2RzLmNhbGwoc2VsZik7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKlxuICAgICAqIFRvcC1sZXZlbCBBUElcbiAgICAgKlxuICAgICAqL1xuXG4gICAgZGVmYXVsdExvZ2dlciA9IG5ldyBMb2dnZXIoKTtcblxuICAgIGRlZmF1bHRMb2dnZXIuZ2V0TG9nZ2VyID0gZnVuY3Rpb24gZ2V0TG9nZ2VyKG5hbWUpIHtcbiAgICAgICAgaWYgKCh0eXBlb2YgbmFtZSAhPT0gXCJzeW1ib2xcIiAmJiB0eXBlb2YgbmFtZSAhPT0gXCJzdHJpbmdcIikgfHwgbmFtZSA9PT0gXCJcIikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIllvdSBtdXN0IHN1cHBseSBhIG5hbWUgd2hlbiBjcmVhdGluZyBhIGxvZ2dlci5cIik7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgbG9nZ2VyID0gX2xvZ2dlcnNCeU5hbWVbbmFtZV07XG4gICAgICAgIGlmICghbG9nZ2VyKSB7XG4gICAgICAgICAgICBsb2dnZXIgPSBfbG9nZ2Vyc0J5TmFtZVtuYW1lXSA9IG5ldyBMb2dnZXIoXG4gICAgICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgICAgICBkZWZhdWx0TG9nZ2VyLm1ldGhvZEZhY3RvcnlcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGxvZ2dlcjtcbiAgICB9O1xuXG4gICAgLy8gR3JhYiB0aGUgY3VycmVudCBnbG9iYWwgbG9nIHZhcmlhYmxlIGluIGNhc2Ugb2Ygb3ZlcndyaXRlXG4gICAgdmFyIF9sb2cgPSAodHlwZW9mIHdpbmRvdyAhPT0gdW5kZWZpbmVkVHlwZSkgPyB3aW5kb3cubG9nIDogdW5kZWZpbmVkO1xuICAgIGRlZmF1bHRMb2dnZXIubm9Db25mbGljdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gdW5kZWZpbmVkVHlwZSAmJlxuICAgICAgICAgICAgICAgd2luZG93LmxvZyA9PT0gZGVmYXVsdExvZ2dlcikge1xuICAgICAgICAgICAgd2luZG93LmxvZyA9IF9sb2c7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZGVmYXVsdExvZ2dlcjtcbiAgICB9O1xuXG4gICAgZGVmYXVsdExvZ2dlci5nZXRMb2dnZXJzID0gZnVuY3Rpb24gZ2V0TG9nZ2VycygpIHtcbiAgICAgICAgcmV0dXJuIF9sb2dnZXJzQnlOYW1lO1xuICAgIH07XG5cbiAgICAvLyBFUzYgZGVmYXVsdCBleHBvcnQsIGZvciBjb21wYXRpYmlsaXR5XG4gICAgZGVmYXVsdExvZ2dlclsnZGVmYXVsdCddID0gZGVmYXVsdExvZ2dlcjtcblxuICAgIHJldHVybiBkZWZhdWx0TG9nZ2VyO1xufSkpO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\n\n}')},"./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/contrib/backo2.js":
/*!*************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/contrib/backo2.js ***!
  \*************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Backoff: () => (/* binding */ Backoff)\n/* harmony export */ });\n/**\n * Initialize backoff timer with `opts`.\n *\n * - `min` initial timeout in milliseconds [100]\n * - `max` max timeout [10000]\n * - `jitter` [0]\n * - `factor` [2]\n *\n * @param {Object} opts\n * @api public\n */\nfunction Backoff(opts) {\n    opts = opts || {};\n    this.ms = opts.min || 100;\n    this.max = opts.max || 10000;\n    this.factor = opts.factor || 2;\n    this.jitter = opts.jitter > 0 && opts.jitter <= 1 ? opts.jitter : 0;\n    this.attempts = 0;\n}\n/**\n * Return the backoff duration.\n *\n * @return {Number}\n * @api public\n */\nBackoff.prototype.duration = function () {\n    var ms = this.ms * Math.pow(this.factor, this.attempts++);\n    if (this.jitter) {\n        var rand = Math.random();\n        var deviation = Math.floor(rand * this.jitter * ms);\n        ms = (Math.floor(rand * 10) & 1) == 0 ? ms - deviation : ms + deviation;\n    }\n    return Math.min(ms, this.max) | 0;\n};\n/**\n * Reset the number of attempts.\n *\n * @api public\n */\nBackoff.prototype.reset = function () {\n    this.attempts = 0;\n};\n/**\n * Set the minimum duration\n *\n * @api public\n */\nBackoff.prototype.setMin = function (min) {\n    this.ms = min;\n};\n/**\n * Set the maximum duration\n *\n * @api public\n */\nBackoff.prototype.setMax = function (max) {\n    this.max = max;\n};\n/**\n * Set the jitter\n *\n * @api public\n */\nBackoff.prototype.setJitter = function (jitter) {\n    this.jitter = jitter;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLWNsaWVudEA0LjguMS9ub2RlX21vZHVsZXMvc29ja2V0LmlvLWNsaWVudC9idWlsZC9lc20vY29udHJpYi9iYWNrbzIuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFFBQVE7QUFDbkI7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLWNsaWVudEA0LjguMS9ub2RlX21vZHVsZXMvc29ja2V0LmlvLWNsaWVudC9idWlsZC9lc20vY29udHJpYi9iYWNrbzIuanM/Zjc0ZiJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEluaXRpYWxpemUgYmFja29mZiB0aW1lciB3aXRoIGBvcHRzYC5cbiAqXG4gKiAtIGBtaW5gIGluaXRpYWwgdGltZW91dCBpbiBtaWxsaXNlY29uZHMgWzEwMF1cbiAqIC0gYG1heGAgbWF4IHRpbWVvdXQgWzEwMDAwXVxuICogLSBgaml0dGVyYCBbMF1cbiAqIC0gYGZhY3RvcmAgWzJdXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IG9wdHNcbiAqIEBhcGkgcHVibGljXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBCYWNrb2ZmKG9wdHMpIHtcbiAgICBvcHRzID0gb3B0cyB8fCB7fTtcbiAgICB0aGlzLm1zID0gb3B0cy5taW4gfHwgMTAwO1xuICAgIHRoaXMubWF4ID0gb3B0cy5tYXggfHwgMTAwMDA7XG4gICAgdGhpcy5mYWN0b3IgPSBvcHRzLmZhY3RvciB8fCAyO1xuICAgIHRoaXMuaml0dGVyID0gb3B0cy5qaXR0ZXIgPiAwICYmIG9wdHMuaml0dGVyIDw9IDEgPyBvcHRzLmppdHRlciA6IDA7XG4gICAgdGhpcy5hdHRlbXB0cyA9IDA7XG59XG4vKipcbiAqIFJldHVybiB0aGUgYmFja29mZiBkdXJhdGlvbi5cbiAqXG4gKiBAcmV0dXJuIHtOdW1iZXJ9XG4gKiBAYXBpIHB1YmxpY1xuICovXG5CYWNrb2ZmLnByb3RvdHlwZS5kdXJhdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgbXMgPSB0aGlzLm1zICogTWF0aC5wb3codGhpcy5mYWN0b3IsIHRoaXMuYXR0ZW1wdHMrKyk7XG4gICAgaWYgKHRoaXMuaml0dGVyKSB7XG4gICAgICAgIHZhciByYW5kID0gTWF0aC5yYW5kb20oKTtcbiAgICAgICAgdmFyIGRldmlhdGlvbiA9IE1hdGguZmxvb3IocmFuZCAqIHRoaXMuaml0dGVyICogbXMpO1xuICAgICAgICBtcyA9IChNYXRoLmZsb29yKHJhbmQgKiAxMCkgJiAxKSA9PSAwID8gbXMgLSBkZXZpYXRpb24gOiBtcyArIGRldmlhdGlvbjtcbiAgICB9XG4gICAgcmV0dXJuIE1hdGgubWluKG1zLCB0aGlzLm1heCkgfCAwO1xufTtcbi8qKlxuICogUmVzZXQgdGhlIG51bWJlciBvZiBhdHRlbXB0cy5cbiAqXG4gKiBAYXBpIHB1YmxpY1xuICovXG5CYWNrb2ZmLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmF0dGVtcHRzID0gMDtcbn07XG4vKipcbiAqIFNldCB0aGUgbWluaW11bSBkdXJhdGlvblxuICpcbiAqIEBhcGkgcHVibGljXG4gKi9cbkJhY2tvZmYucHJvdG90eXBlLnNldE1pbiA9IGZ1bmN0aW9uIChtaW4pIHtcbiAgICB0aGlzLm1zID0gbWluO1xufTtcbi8qKlxuICogU2V0IHRoZSBtYXhpbXVtIGR1cmF0aW9uXG4gKlxuICogQGFwaSBwdWJsaWNcbiAqL1xuQmFja29mZi5wcm90b3R5cGUuc2V0TWF4ID0gZnVuY3Rpb24gKG1heCkge1xuICAgIHRoaXMubWF4ID0gbWF4O1xufTtcbi8qKlxuICogU2V0IHRoZSBqaXR0ZXJcbiAqXG4gKiBAYXBpIHB1YmxpY1xuICovXG5CYWNrb2ZmLnByb3RvdHlwZS5zZXRKaXR0ZXIgPSBmdW5jdGlvbiAoaml0dGVyKSB7XG4gICAgdGhpcy5qaXR0ZXIgPSBqaXR0ZXI7XG59O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/contrib/backo2.js\n\n}")},"./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/index.js":
/*!****************************************************************************************************!*\
  !*** ./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/index.js ***!
  \****************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Fetch: () => (/* reexport safe */ engine_io_client__WEBPACK_IMPORTED_MODULE_4__.Fetch),\n/* harmony export */   Manager: () => (/* reexport safe */ _manager_js__WEBPACK_IMPORTED_MODULE_1__.Manager),\n/* harmony export */   NodeWebSocket: () => (/* reexport safe */ engine_io_client__WEBPACK_IMPORTED_MODULE_4__.NodeWebSocket),\n/* harmony export */   NodeXHR: () => (/* reexport safe */ engine_io_client__WEBPACK_IMPORTED_MODULE_4__.NodeXHR),\n/* harmony export */   Socket: () => (/* reexport safe */ _socket_js__WEBPACK_IMPORTED_MODULE_2__.Socket),\n/* harmony export */   WebSocket: () => (/* reexport safe */ engine_io_client__WEBPACK_IMPORTED_MODULE_4__.WebSocket),\n/* harmony export */   WebTransport: () => (/* reexport safe */ engine_io_client__WEBPACK_IMPORTED_MODULE_4__.WebTransport),\n/* harmony export */   XHR: () => (/* reexport safe */ engine_io_client__WEBPACK_IMPORTED_MODULE_4__.XHR),\n/* harmony export */   connect: () => (/* binding */ lookup),\n/* harmony export */   "default": () => (/* binding */ lookup),\n/* harmony export */   io: () => (/* binding */ lookup),\n/* harmony export */   protocol: () => (/* reexport safe */ socket_io_parser__WEBPACK_IMPORTED_MODULE_3__.protocol)\n/* harmony export */ });\n/* harmony import */ var _url_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./url.js */ "./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/url.js");\n/* harmony import */ var _manager_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./manager.js */ "./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/manager.js");\n/* harmony import */ var _socket_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./socket.js */ "./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/socket.js");\n/* harmony import */ var socket_io_parser__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! socket.io-parser */ "./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/index.js");\n/* harmony import */ var engine_io_client__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! engine.io-client */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/index.js");\n\n\n\n/**\n * Managers cache.\n */\nconst cache = {};\nfunction lookup(uri, opts) {\n    if (typeof uri === "object") {\n        opts = uri;\n        uri = undefined;\n    }\n    opts = opts || {};\n    const parsed = (0,_url_js__WEBPACK_IMPORTED_MODULE_0__.url)(uri, opts.path || "/socket.io");\n    const source = parsed.source;\n    const id = parsed.id;\n    const path = parsed.path;\n    const sameNamespace = cache[id] && path in cache[id]["nsps"];\n    const newConnection = opts.forceNew ||\n        opts["force new connection"] ||\n        false === opts.multiplex ||\n        sameNamespace;\n    let io;\n    if (newConnection) {\n        io = new _manager_js__WEBPACK_IMPORTED_MODULE_1__.Manager(source, opts);\n    }\n    else {\n        if (!cache[id]) {\n            cache[id] = new _manager_js__WEBPACK_IMPORTED_MODULE_1__.Manager(source, opts);\n        }\n        io = cache[id];\n    }\n    if (parsed.query && !opts.query) {\n        opts.query = parsed.queryKey;\n    }\n    return io.socket(parsed.path, opts);\n}\n// so that "lookup" can be used both as a function (e.g. `io(...)`) and as a\n// namespace (e.g. `io.connect(...)`), for backward compatibility\nObject.assign(lookup, {\n    Manager: _manager_js__WEBPACK_IMPORTED_MODULE_1__.Manager,\n    Socket: _socket_js__WEBPACK_IMPORTED_MODULE_2__.Socket,\n    io: lookup,\n    connect: lookup,\n});\n/**\n * Protocol version.\n *\n * @public\n */\n\n/**\n * Expose constructors for standalone build.\n *\n * @public\n */\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLWNsaWVudEA0LjguMS9ub2RlX21vZHVsZXMvc29ja2V0LmlvLWNsaWVudC9idWlsZC9lc20vaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBK0I7QUFDUTtBQUNGO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLDRDQUFHO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLGdEQUFPO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixnREFBTztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYLFVBQVU7QUFDVjtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDNEM7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNnRjtBQUNnQiIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL25vZGVfbW9kdWxlcy8ucG5wbS9zb2NrZXQuaW8tY2xpZW50QDQuOC4xL25vZGVfbW9kdWxlcy9zb2NrZXQuaW8tY2xpZW50L2J1aWxkL2VzbS9pbmRleC5qcz8xNTg4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVybCB9IGZyb20gXCIuL3VybC5qc1wiO1xuaW1wb3J0IHsgTWFuYWdlciB9IGZyb20gXCIuL21hbmFnZXIuanNcIjtcbmltcG9ydCB7IFNvY2tldCB9IGZyb20gXCIuL3NvY2tldC5qc1wiO1xuLyoqXG4gKiBNYW5hZ2VycyBjYWNoZS5cbiAqL1xuY29uc3QgY2FjaGUgPSB7fTtcbmZ1bmN0aW9uIGxvb2t1cCh1cmksIG9wdHMpIHtcbiAgICBpZiAodHlwZW9mIHVyaSA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICBvcHRzID0gdXJpO1xuICAgICAgICB1cmkgPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIG9wdHMgPSBvcHRzIHx8IHt9O1xuICAgIGNvbnN0IHBhcnNlZCA9IHVybCh1cmksIG9wdHMucGF0aCB8fCBcIi9zb2NrZXQuaW9cIik7XG4gICAgY29uc3Qgc291cmNlID0gcGFyc2VkLnNvdXJjZTtcbiAgICBjb25zdCBpZCA9IHBhcnNlZC5pZDtcbiAgICBjb25zdCBwYXRoID0gcGFyc2VkLnBhdGg7XG4gICAgY29uc3Qgc2FtZU5hbWVzcGFjZSA9IGNhY2hlW2lkXSAmJiBwYXRoIGluIGNhY2hlW2lkXVtcIm5zcHNcIl07XG4gICAgY29uc3QgbmV3Q29ubmVjdGlvbiA9IG9wdHMuZm9yY2VOZXcgfHxcbiAgICAgICAgb3B0c1tcImZvcmNlIG5ldyBjb25uZWN0aW9uXCJdIHx8XG4gICAgICAgIGZhbHNlID09PSBvcHRzLm11bHRpcGxleCB8fFxuICAgICAgICBzYW1lTmFtZXNwYWNlO1xuICAgIGxldCBpbztcbiAgICBpZiAobmV3Q29ubmVjdGlvbikge1xuICAgICAgICBpbyA9IG5ldyBNYW5hZ2VyKHNvdXJjZSwgb3B0cyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpZiAoIWNhY2hlW2lkXSkge1xuICAgICAgICAgICAgY2FjaGVbaWRdID0gbmV3IE1hbmFnZXIoc291cmNlLCBvcHRzKTtcbiAgICAgICAgfVxuICAgICAgICBpbyA9IGNhY2hlW2lkXTtcbiAgICB9XG4gICAgaWYgKHBhcnNlZC5xdWVyeSAmJiAhb3B0cy5xdWVyeSkge1xuICAgICAgICBvcHRzLnF1ZXJ5ID0gcGFyc2VkLnF1ZXJ5S2V5O1xuICAgIH1cbiAgICByZXR1cm4gaW8uc29ja2V0KHBhcnNlZC5wYXRoLCBvcHRzKTtcbn1cbi8vIHNvIHRoYXQgXCJsb29rdXBcIiBjYW4gYmUgdXNlZCBib3RoIGFzIGEgZnVuY3Rpb24gKGUuZy4gYGlvKC4uLilgKSBhbmQgYXMgYVxuLy8gbmFtZXNwYWNlIChlLmcuIGBpby5jb25uZWN0KC4uLilgKSwgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHlcbk9iamVjdC5hc3NpZ24obG9va3VwLCB7XG4gICAgTWFuYWdlcixcbiAgICBTb2NrZXQsXG4gICAgaW86IGxvb2t1cCxcbiAgICBjb25uZWN0OiBsb29rdXAsXG59KTtcbi8qKlxuICogUHJvdG9jb2wgdmVyc2lvbi5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCB7IHByb3RvY29sIH0gZnJvbSBcInNvY2tldC5pby1wYXJzZXJcIjtcbi8qKlxuICogRXhwb3NlIGNvbnN0cnVjdG9ycyBmb3Igc3RhbmRhbG9uZSBidWlsZC5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCB7IE1hbmFnZXIsIFNvY2tldCwgbG9va3VwIGFzIGlvLCBsb29rdXAgYXMgY29ubmVjdCwgbG9va3VwIGFzIGRlZmF1bHQsIH07XG5leHBvcnQgeyBGZXRjaCwgTm9kZVhIUiwgWEhSLCBOb2RlV2ViU29ja2V0LCBXZWJTb2NrZXQsIFdlYlRyYW5zcG9ydCwgfSBmcm9tIFwiZW5naW5lLmlvLWNsaWVudFwiO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/index.js\n\n}')},"./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/manager.js":
/*!******************************************************************************************************!*\
  !*** ./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/manager.js ***!
  \******************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Manager: () => (/* binding */ Manager)\n/* harmony export */ });\n/* harmony import */ var engine_io_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! engine.io-client */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/index.js");\n/* harmony import */ var _socket_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./socket.js */ "./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/socket.js");\n/* harmony import */ var socket_io_parser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! socket.io-parser */ "./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/index.js");\n/* harmony import */ var _on_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./on.js */ "./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/on.js");\n/* harmony import */ var _contrib_backo2_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./contrib/backo2.js */ "./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/contrib/backo2.js");\n/* harmony import */ var _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @socket.io/component-emitter */ "./node_modules/.pnpm/@socket.io+component-emitter@3.1.2/node_modules/@socket.io/component-emitter/lib/esm/index.js");\n\n\n\n\n\n\nclass Manager extends _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_5__.Emitter {\n    constructor(uri, opts) {\n        var _a;\n        super();\n        this.nsps = {};\n        this.subs = [];\n        if (uri && "object" === typeof uri) {\n            opts = uri;\n            uri = undefined;\n        }\n        opts = opts || {};\n        opts.path = opts.path || "/socket.io";\n        this.opts = opts;\n        (0,engine_io_client__WEBPACK_IMPORTED_MODULE_0__.installTimerFunctions)(this, opts);\n        this.reconnection(opts.reconnection !== false);\n        this.reconnectionAttempts(opts.reconnectionAttempts || Infinity);\n        this.reconnectionDelay(opts.reconnectionDelay || 1000);\n        this.reconnectionDelayMax(opts.reconnectionDelayMax || 5000);\n        this.randomizationFactor((_a = opts.randomizationFactor) !== null && _a !== void 0 ? _a : 0.5);\n        this.backoff = new _contrib_backo2_js__WEBPACK_IMPORTED_MODULE_4__.Backoff({\n            min: this.reconnectionDelay(),\n            max: this.reconnectionDelayMax(),\n            jitter: this.randomizationFactor(),\n        });\n        this.timeout(null == opts.timeout ? 20000 : opts.timeout);\n        this._readyState = "closed";\n        this.uri = uri;\n        const _parser = opts.parser || socket_io_parser__WEBPACK_IMPORTED_MODULE_2__;\n        this.encoder = new _parser.Encoder();\n        this.decoder = new _parser.Decoder();\n        this._autoConnect = opts.autoConnect !== false;\n        if (this._autoConnect)\n            this.open();\n    }\n    reconnection(v) {\n        if (!arguments.length)\n            return this._reconnection;\n        this._reconnection = !!v;\n        if (!v) {\n            this.skipReconnect = true;\n        }\n        return this;\n    }\n    reconnectionAttempts(v) {\n        if (v === undefined)\n            return this._reconnectionAttempts;\n        this._reconnectionAttempts = v;\n        return this;\n    }\n    reconnectionDelay(v) {\n        var _a;\n        if (v === undefined)\n            return this._reconnectionDelay;\n        this._reconnectionDelay = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setMin(v);\n        return this;\n    }\n    randomizationFactor(v) {\n        var _a;\n        if (v === undefined)\n            return this._randomizationFactor;\n        this._randomizationFactor = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setJitter(v);\n        return this;\n    }\n    reconnectionDelayMax(v) {\n        var _a;\n        if (v === undefined)\n            return this._reconnectionDelayMax;\n        this._reconnectionDelayMax = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setMax(v);\n        return this;\n    }\n    timeout(v) {\n        if (!arguments.length)\n            return this._timeout;\n        this._timeout = v;\n        return this;\n    }\n    /**\n     * Starts trying to reconnect if reconnection is enabled and we have not\n     * started reconnecting yet\n     *\n     * @private\n     */\n    maybeReconnectOnOpen() {\n        // Only try to reconnect if it\'s the first time we\'re connecting\n        if (!this._reconnecting &&\n            this._reconnection &&\n            this.backoff.attempts === 0) {\n            // keeps reconnection from firing twice for the same reconnection loop\n            this.reconnect();\n        }\n    }\n    /**\n     * Sets the current transport `socket`.\n     *\n     * @param {Function} fn - optional, callback\n     * @return self\n     * @public\n     */\n    open(fn) {\n        if (~this._readyState.indexOf("open"))\n            return this;\n        this.engine = new engine_io_client__WEBPACK_IMPORTED_MODULE_0__.Socket(this.uri, this.opts);\n        const socket = this.engine;\n        const self = this;\n        this._readyState = "opening";\n        this.skipReconnect = false;\n        // emit `open`\n        const openSubDestroy = (0,_on_js__WEBPACK_IMPORTED_MODULE_3__.on)(socket, "open", function () {\n            self.onopen();\n            fn && fn();\n        });\n        const onError = (err) => {\n            this.cleanup();\n            this._readyState = "closed";\n            this.emitReserved("error", err);\n            if (fn) {\n                fn(err);\n            }\n            else {\n                // Only do this if there is no fn to handle the error\n                this.maybeReconnectOnOpen();\n            }\n        };\n        // emit `error`\n        const errorSub = (0,_on_js__WEBPACK_IMPORTED_MODULE_3__.on)(socket, "error", onError);\n        if (false !== this._timeout) {\n            const timeout = this._timeout;\n            // set timer\n            const timer = this.setTimeoutFn(() => {\n                openSubDestroy();\n                onError(new Error("timeout"));\n                socket.close();\n            }, timeout);\n            if (this.opts.autoUnref) {\n                timer.unref();\n            }\n            this.subs.push(() => {\n                this.clearTimeoutFn(timer);\n            });\n        }\n        this.subs.push(openSubDestroy);\n        this.subs.push(errorSub);\n        return this;\n    }\n    /**\n     * Alias for open()\n     *\n     * @return self\n     * @public\n     */\n    connect(fn) {\n        return this.open(fn);\n    }\n    /**\n     * Called upon transport open.\n     *\n     * @private\n     */\n    onopen() {\n        // clear old subs\n        this.cleanup();\n        // mark as open\n        this._readyState = "open";\n        this.emitReserved("open");\n        // add new subs\n        const socket = this.engine;\n        this.subs.push((0,_on_js__WEBPACK_IMPORTED_MODULE_3__.on)(socket, "ping", this.onping.bind(this)), (0,_on_js__WEBPACK_IMPORTED_MODULE_3__.on)(socket, "data", this.ondata.bind(this)), (0,_on_js__WEBPACK_IMPORTED_MODULE_3__.on)(socket, "error", this.onerror.bind(this)), (0,_on_js__WEBPACK_IMPORTED_MODULE_3__.on)(socket, "close", this.onclose.bind(this)), \n        // @ts-ignore\n        (0,_on_js__WEBPACK_IMPORTED_MODULE_3__.on)(this.decoder, "decoded", this.ondecoded.bind(this)));\n    }\n    /**\n     * Called upon a ping.\n     *\n     * @private\n     */\n    onping() {\n        this.emitReserved("ping");\n    }\n    /**\n     * Called with data.\n     *\n     * @private\n     */\n    ondata(data) {\n        try {\n            this.decoder.add(data);\n        }\n        catch (e) {\n            this.onclose("parse error", e);\n        }\n    }\n    /**\n     * Called when parser fully decodes a packet.\n     *\n     * @private\n     */\n    ondecoded(packet) {\n        // the nextTick call prevents an exception in a user-provided event listener from triggering a disconnection due to a "parse error"\n        (0,engine_io_client__WEBPACK_IMPORTED_MODULE_0__.nextTick)(() => {\n            this.emitReserved("packet", packet);\n        }, this.setTimeoutFn);\n    }\n    /**\n     * Called upon socket error.\n     *\n     * @private\n     */\n    onerror(err) {\n        this.emitReserved("error", err);\n    }\n    /**\n     * Creates a new socket for the given `nsp`.\n     *\n     * @return {Socket}\n     * @public\n     */\n    socket(nsp, opts) {\n        let socket = this.nsps[nsp];\n        if (!socket) {\n            socket = new _socket_js__WEBPACK_IMPORTED_MODULE_1__.Socket(this, nsp, opts);\n            this.nsps[nsp] = socket;\n        }\n        else if (this._autoConnect && !socket.active) {\n            socket.connect();\n        }\n        return socket;\n    }\n    /**\n     * Called upon a socket close.\n     *\n     * @param socket\n     * @private\n     */\n    _destroy(socket) {\n        const nsps = Object.keys(this.nsps);\n        for (const nsp of nsps) {\n            const socket = this.nsps[nsp];\n            if (socket.active) {\n                return;\n            }\n        }\n        this._close();\n    }\n    /**\n     * Writes a packet.\n     *\n     * @param packet\n     * @private\n     */\n    _packet(packet) {\n        const encodedPackets = this.encoder.encode(packet);\n        for (let i = 0; i < encodedPackets.length; i++) {\n            this.engine.write(encodedPackets[i], packet.options);\n        }\n    }\n    /**\n     * Clean up transport subscriptions and packet buffer.\n     *\n     * @private\n     */\n    cleanup() {\n        this.subs.forEach((subDestroy) => subDestroy());\n        this.subs.length = 0;\n        this.decoder.destroy();\n    }\n    /**\n     * Close the current socket.\n     *\n     * @private\n     */\n    _close() {\n        this.skipReconnect = true;\n        this._reconnecting = false;\n        this.onclose("forced close");\n    }\n    /**\n     * Alias for close()\n     *\n     * @private\n     */\n    disconnect() {\n        return this._close();\n    }\n    /**\n     * Called when:\n     *\n     * - the low-level engine is closed\n     * - the parser encountered a badly formatted packet\n     * - all sockets are disconnected\n     *\n     * @private\n     */\n    onclose(reason, description) {\n        var _a;\n        this.cleanup();\n        (_a = this.engine) === null || _a === void 0 ? void 0 : _a.close();\n        this.backoff.reset();\n        this._readyState = "closed";\n        this.emitReserved("close", reason, description);\n        if (this._reconnection && !this.skipReconnect) {\n            this.reconnect();\n        }\n    }\n    /**\n     * Attempt a reconnection.\n     *\n     * @private\n     */\n    reconnect() {\n        if (this._reconnecting || this.skipReconnect)\n            return this;\n        const self = this;\n        if (this.backoff.attempts >= this._reconnectionAttempts) {\n            this.backoff.reset();\n            this.emitReserved("reconnect_failed");\n            this._reconnecting = false;\n        }\n        else {\n            const delay = this.backoff.duration();\n            this._reconnecting = true;\n            const timer = this.setTimeoutFn(() => {\n                if (self.skipReconnect)\n                    return;\n                this.emitReserved("reconnect_attempt", self.backoff.attempts);\n                // check again for the case socket closed in above events\n                if (self.skipReconnect)\n                    return;\n                self.open((err) => {\n                    if (err) {\n                        self._reconnecting = false;\n                        self.reconnect();\n                        this.emitReserved("reconnect_error", err);\n                    }\n                    else {\n                        self.onreconnect();\n                    }\n                });\n            }, delay);\n            if (this.opts.autoUnref) {\n                timer.unref();\n            }\n            this.subs.push(() => {\n                this.clearTimeoutFn(timer);\n            });\n        }\n    }\n    /**\n     * Called upon successful reconnect.\n     *\n     * @private\n     */\n    onreconnect() {\n        const attempt = this.backoff.attempts;\n        this._reconnecting = false;\n        this.backoff.reset();\n        this.emitReserved("reconnect", attempt);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLWNsaWVudEA0LjguMS9ub2RlX21vZHVsZXMvc29ja2V0LmlvLWNsaWVudC9idWlsZC9lc20vbWFuYWdlci5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQXNGO0FBQ2pEO0FBQ007QUFDZDtBQUNpQjtBQUNVO0FBQ2pELHNCQUFzQixpRUFBTztBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLHVFQUFxQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLHVEQUFPO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUMsNkNBQU07QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxVQUFVO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixvREFBTTtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLDBDQUFFO0FBQ2pDO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsMENBQUU7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsMENBQUUsMENBQTBDLDBDQUFFLDBDQUEwQywwQ0FBRSw0Q0FBNEMsMENBQUU7QUFDL0o7QUFDQSxRQUFRLDBDQUFFO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsMERBQVE7QUFDaEI7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsOENBQU07QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsMkJBQTJCO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL3NvY2tldC5pby1jbGllbnRANC44LjEvbm9kZV9tb2R1bGVzL3NvY2tldC5pby1jbGllbnQvYnVpbGQvZXNtL21hbmFnZXIuanM/MjIyZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBTb2NrZXQgYXMgRW5naW5lLCBpbnN0YWxsVGltZXJGdW5jdGlvbnMsIG5leHRUaWNrLCB9IGZyb20gXCJlbmdpbmUuaW8tY2xpZW50XCI7XG5pbXBvcnQgeyBTb2NrZXQgfSBmcm9tIFwiLi9zb2NrZXQuanNcIjtcbmltcG9ydCAqIGFzIHBhcnNlciBmcm9tIFwic29ja2V0LmlvLXBhcnNlclwiO1xuaW1wb3J0IHsgb24gfSBmcm9tIFwiLi9vbi5qc1wiO1xuaW1wb3J0IHsgQmFja29mZiB9IGZyb20gXCIuL2NvbnRyaWIvYmFja28yLmpzXCI7XG5pbXBvcnQgeyBFbWl0dGVyLCB9IGZyb20gXCJAc29ja2V0LmlvL2NvbXBvbmVudC1lbWl0dGVyXCI7XG5leHBvcnQgY2xhc3MgTWFuYWdlciBleHRlbmRzIEVtaXR0ZXIge1xuICAgIGNvbnN0cnVjdG9yKHVyaSwgb3B0cykge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMubnNwcyA9IHt9O1xuICAgICAgICB0aGlzLnN1YnMgPSBbXTtcbiAgICAgICAgaWYgKHVyaSAmJiBcIm9iamVjdFwiID09PSB0eXBlb2YgdXJpKSB7XG4gICAgICAgICAgICBvcHRzID0gdXJpO1xuICAgICAgICAgICAgdXJpID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIG9wdHMgPSBvcHRzIHx8IHt9O1xuICAgICAgICBvcHRzLnBhdGggPSBvcHRzLnBhdGggfHwgXCIvc29ja2V0LmlvXCI7XG4gICAgICAgIHRoaXMub3B0cyA9IG9wdHM7XG4gICAgICAgIGluc3RhbGxUaW1lckZ1bmN0aW9ucyh0aGlzLCBvcHRzKTtcbiAgICAgICAgdGhpcy5yZWNvbm5lY3Rpb24ob3B0cy5yZWNvbm5lY3Rpb24gIT09IGZhbHNlKTtcbiAgICAgICAgdGhpcy5yZWNvbm5lY3Rpb25BdHRlbXB0cyhvcHRzLnJlY29ubmVjdGlvbkF0dGVtcHRzIHx8IEluZmluaXR5KTtcbiAgICAgICAgdGhpcy5yZWNvbm5lY3Rpb25EZWxheShvcHRzLnJlY29ubmVjdGlvbkRlbGF5IHx8IDEwMDApO1xuICAgICAgICB0aGlzLnJlY29ubmVjdGlvbkRlbGF5TWF4KG9wdHMucmVjb25uZWN0aW9uRGVsYXlNYXggfHwgNTAwMCk7XG4gICAgICAgIHRoaXMucmFuZG9taXphdGlvbkZhY3RvcigoX2EgPSBvcHRzLnJhbmRvbWl6YXRpb25GYWN0b3IpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IDAuNSk7XG4gICAgICAgIHRoaXMuYmFja29mZiA9IG5ldyBCYWNrb2ZmKHtcbiAgICAgICAgICAgIG1pbjogdGhpcy5yZWNvbm5lY3Rpb25EZWxheSgpLFxuICAgICAgICAgICAgbWF4OiB0aGlzLnJlY29ubmVjdGlvbkRlbGF5TWF4KCksXG4gICAgICAgICAgICBqaXR0ZXI6IHRoaXMucmFuZG9taXphdGlvbkZhY3RvcigpLFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy50aW1lb3V0KG51bGwgPT0gb3B0cy50aW1lb3V0ID8gMjAwMDAgOiBvcHRzLnRpbWVvdXQpO1xuICAgICAgICB0aGlzLl9yZWFkeVN0YXRlID0gXCJjbG9zZWRcIjtcbiAgICAgICAgdGhpcy51cmkgPSB1cmk7XG4gICAgICAgIGNvbnN0IF9wYXJzZXIgPSBvcHRzLnBhcnNlciB8fCBwYXJzZXI7XG4gICAgICAgIHRoaXMuZW5jb2RlciA9IG5ldyBfcGFyc2VyLkVuY29kZXIoKTtcbiAgICAgICAgdGhpcy5kZWNvZGVyID0gbmV3IF9wYXJzZXIuRGVjb2RlcigpO1xuICAgICAgICB0aGlzLl9hdXRvQ29ubmVjdCA9IG9wdHMuYXV0b0Nvbm5lY3QgIT09IGZhbHNlO1xuICAgICAgICBpZiAodGhpcy5fYXV0b0Nvbm5lY3QpXG4gICAgICAgICAgICB0aGlzLm9wZW4oKTtcbiAgICB9XG4gICAgcmVjb25uZWN0aW9uKHYpIHtcbiAgICAgICAgaWYgKCFhcmd1bWVudHMubGVuZ3RoKVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlY29ubmVjdGlvbjtcbiAgICAgICAgdGhpcy5fcmVjb25uZWN0aW9uID0gISF2O1xuICAgICAgICBpZiAoIXYpIHtcbiAgICAgICAgICAgIHRoaXMuc2tpcFJlY29ubmVjdCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHJlY29ubmVjdGlvbkF0dGVtcHRzKHYpIHtcbiAgICAgICAgaWYgKHYgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZWNvbm5lY3Rpb25BdHRlbXB0cztcbiAgICAgICAgdGhpcy5fcmVjb25uZWN0aW9uQXR0ZW1wdHMgPSB2O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgcmVjb25uZWN0aW9uRGVsYXkodikge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGlmICh2ID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVjb25uZWN0aW9uRGVsYXk7XG4gICAgICAgIHRoaXMuX3JlY29ubmVjdGlvbkRlbGF5ID0gdjtcbiAgICAgICAgKF9hID0gdGhpcy5iYWNrb2ZmKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Euc2V0TWluKHYpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgcmFuZG9taXphdGlvbkZhY3Rvcih2KSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgaWYgKHYgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9yYW5kb21pemF0aW9uRmFjdG9yO1xuICAgICAgICB0aGlzLl9yYW5kb21pemF0aW9uRmFjdG9yID0gdjtcbiAgICAgICAgKF9hID0gdGhpcy5iYWNrb2ZmKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Euc2V0Sml0dGVyKHYpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgcmVjb25uZWN0aW9uRGVsYXlNYXgodikge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGlmICh2ID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVjb25uZWN0aW9uRGVsYXlNYXg7XG4gICAgICAgIHRoaXMuX3JlY29ubmVjdGlvbkRlbGF5TWF4ID0gdjtcbiAgICAgICAgKF9hID0gdGhpcy5iYWNrb2ZmKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Euc2V0TWF4KHYpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgdGltZW91dCh2KSB7XG4gICAgICAgIGlmICghYXJndW1lbnRzLmxlbmd0aClcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl90aW1lb3V0O1xuICAgICAgICB0aGlzLl90aW1lb3V0ID0gdjtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN0YXJ0cyB0cnlpbmcgdG8gcmVjb25uZWN0IGlmIHJlY29ubmVjdGlvbiBpcyBlbmFibGVkIGFuZCB3ZSBoYXZlIG5vdFxuICAgICAqIHN0YXJ0ZWQgcmVjb25uZWN0aW5nIHlldFxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBtYXliZVJlY29ubmVjdE9uT3BlbigpIHtcbiAgICAgICAgLy8gT25seSB0cnkgdG8gcmVjb25uZWN0IGlmIGl0J3MgdGhlIGZpcnN0IHRpbWUgd2UncmUgY29ubmVjdGluZ1xuICAgICAgICBpZiAoIXRoaXMuX3JlY29ubmVjdGluZyAmJlxuICAgICAgICAgICAgdGhpcy5fcmVjb25uZWN0aW9uICYmXG4gICAgICAgICAgICB0aGlzLmJhY2tvZmYuYXR0ZW1wdHMgPT09IDApIHtcbiAgICAgICAgICAgIC8vIGtlZXBzIHJlY29ubmVjdGlvbiBmcm9tIGZpcmluZyB0d2ljZSBmb3IgdGhlIHNhbWUgcmVjb25uZWN0aW9uIGxvb3BcbiAgICAgICAgICAgIHRoaXMucmVjb25uZWN0KCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgY3VycmVudCB0cmFuc3BvcnQgYHNvY2tldGAuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiAtIG9wdGlvbmFsLCBjYWxsYmFja1xuICAgICAqIEByZXR1cm4gc2VsZlxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICBvcGVuKGZuKSB7XG4gICAgICAgIGlmICh+dGhpcy5fcmVhZHlTdGF0ZS5pbmRleE9mKFwib3BlblwiKSlcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB0aGlzLmVuZ2luZSA9IG5ldyBFbmdpbmUodGhpcy51cmksIHRoaXMub3B0cyk7XG4gICAgICAgIGNvbnN0IHNvY2tldCA9IHRoaXMuZW5naW5lO1xuICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcbiAgICAgICAgdGhpcy5fcmVhZHlTdGF0ZSA9IFwib3BlbmluZ1wiO1xuICAgICAgICB0aGlzLnNraXBSZWNvbm5lY3QgPSBmYWxzZTtcbiAgICAgICAgLy8gZW1pdCBgb3BlbmBcbiAgICAgICAgY29uc3Qgb3BlblN1YkRlc3Ryb3kgPSBvbihzb2NrZXQsIFwib3BlblwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBzZWxmLm9ub3BlbigpO1xuICAgICAgICAgICAgZm4gJiYgZm4oKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IG9uRXJyb3IgPSAoZXJyKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNsZWFudXAoKTtcbiAgICAgICAgICAgIHRoaXMuX3JlYWR5U3RhdGUgPSBcImNsb3NlZFwiO1xuICAgICAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJlcnJvclwiLCBlcnIpO1xuICAgICAgICAgICAgaWYgKGZuKSB7XG4gICAgICAgICAgICAgICAgZm4oZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIE9ubHkgZG8gdGhpcyBpZiB0aGVyZSBpcyBubyBmbiB0byBoYW5kbGUgdGhlIGVycm9yXG4gICAgICAgICAgICAgICAgdGhpcy5tYXliZVJlY29ubmVjdE9uT3BlbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAvLyBlbWl0IGBlcnJvcmBcbiAgICAgICAgY29uc3QgZXJyb3JTdWIgPSBvbihzb2NrZXQsIFwiZXJyb3JcIiwgb25FcnJvcik7XG4gICAgICAgIGlmIChmYWxzZSAhPT0gdGhpcy5fdGltZW91dCkge1xuICAgICAgICAgICAgY29uc3QgdGltZW91dCA9IHRoaXMuX3RpbWVvdXQ7XG4gICAgICAgICAgICAvLyBzZXQgdGltZXJcbiAgICAgICAgICAgIGNvbnN0IHRpbWVyID0gdGhpcy5zZXRUaW1lb3V0Rm4oKCkgPT4ge1xuICAgICAgICAgICAgICAgIG9wZW5TdWJEZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgb25FcnJvcihuZXcgRXJyb3IoXCJ0aW1lb3V0XCIpKTtcbiAgICAgICAgICAgICAgICBzb2NrZXQuY2xvc2UoKTtcbiAgICAgICAgICAgIH0sIHRpbWVvdXQpO1xuICAgICAgICAgICAgaWYgKHRoaXMub3B0cy5hdXRvVW5yZWYpIHtcbiAgICAgICAgICAgICAgICB0aW1lci51bnJlZigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zdWJzLnB1c2goKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJUaW1lb3V0Rm4odGltZXIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zdWJzLnB1c2gob3BlblN1YkRlc3Ryb3kpO1xuICAgICAgICB0aGlzLnN1YnMucHVzaChlcnJvclN1Yik7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBbGlhcyBmb3Igb3BlbigpXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHNlbGZcbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgY29ubmVjdChmbikge1xuICAgICAgICByZXR1cm4gdGhpcy5vcGVuKGZuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHVwb24gdHJhbnNwb3J0IG9wZW4uXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIG9ub3BlbigpIHtcbiAgICAgICAgLy8gY2xlYXIgb2xkIHN1YnNcbiAgICAgICAgdGhpcy5jbGVhbnVwKCk7XG4gICAgICAgIC8vIG1hcmsgYXMgb3BlblxuICAgICAgICB0aGlzLl9yZWFkeVN0YXRlID0gXCJvcGVuXCI7XG4gICAgICAgIHRoaXMuZW1pdFJlc2VydmVkKFwib3BlblwiKTtcbiAgICAgICAgLy8gYWRkIG5ldyBzdWJzXG4gICAgICAgIGNvbnN0IHNvY2tldCA9IHRoaXMuZW5naW5lO1xuICAgICAgICB0aGlzLnN1YnMucHVzaChvbihzb2NrZXQsIFwicGluZ1wiLCB0aGlzLm9ucGluZy5iaW5kKHRoaXMpKSwgb24oc29ja2V0LCBcImRhdGFcIiwgdGhpcy5vbmRhdGEuYmluZCh0aGlzKSksIG9uKHNvY2tldCwgXCJlcnJvclwiLCB0aGlzLm9uZXJyb3IuYmluZCh0aGlzKSksIG9uKHNvY2tldCwgXCJjbG9zZVwiLCB0aGlzLm9uY2xvc2UuYmluZCh0aGlzKSksIFxuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIG9uKHRoaXMuZGVjb2RlciwgXCJkZWNvZGVkXCIsIHRoaXMub25kZWNvZGVkLmJpbmQodGhpcykpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHVwb24gYSBwaW5nLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBvbnBpbmcoKSB7XG4gICAgICAgIHRoaXMuZW1pdFJlc2VydmVkKFwicGluZ1wiKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHdpdGggZGF0YS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgb25kYXRhKGRhdGEpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMuZGVjb2Rlci5hZGQoZGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHRoaXMub25jbG9zZShcInBhcnNlIGVycm9yXCIsIGUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxlZCB3aGVuIHBhcnNlciBmdWxseSBkZWNvZGVzIGEgcGFja2V0LlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBvbmRlY29kZWQocGFja2V0KSB7XG4gICAgICAgIC8vIHRoZSBuZXh0VGljayBjYWxsIHByZXZlbnRzIGFuIGV4Y2VwdGlvbiBpbiBhIHVzZXItcHJvdmlkZWQgZXZlbnQgbGlzdGVuZXIgZnJvbSB0cmlnZ2VyaW5nIGEgZGlzY29ubmVjdGlvbiBkdWUgdG8gYSBcInBhcnNlIGVycm9yXCJcbiAgICAgICAgbmV4dFRpY2soKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJwYWNrZXRcIiwgcGFja2V0KTtcbiAgICAgICAgfSwgdGhpcy5zZXRUaW1lb3V0Rm4pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgdXBvbiBzb2NrZXQgZXJyb3IuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIG9uZXJyb3IoZXJyKSB7XG4gICAgICAgIHRoaXMuZW1pdFJlc2VydmVkKFwiZXJyb3JcIiwgZXJyKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyBzb2NrZXQgZm9yIHRoZSBnaXZlbiBgbnNwYC5cbiAgICAgKlxuICAgICAqIEByZXR1cm4ge1NvY2tldH1cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgc29ja2V0KG5zcCwgb3B0cykge1xuICAgICAgICBsZXQgc29ja2V0ID0gdGhpcy5uc3BzW25zcF07XG4gICAgICAgIGlmICghc29ja2V0KSB7XG4gICAgICAgICAgICBzb2NrZXQgPSBuZXcgU29ja2V0KHRoaXMsIG5zcCwgb3B0cyk7XG4gICAgICAgICAgICB0aGlzLm5zcHNbbnNwXSA9IHNvY2tldDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLl9hdXRvQ29ubmVjdCAmJiAhc29ja2V0LmFjdGl2ZSkge1xuICAgICAgICAgICAgc29ja2V0LmNvbm5lY3QoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc29ja2V0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgdXBvbiBhIHNvY2tldCBjbG9zZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBzb2NrZXRcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9kZXN0cm95KHNvY2tldCkge1xuICAgICAgICBjb25zdCBuc3BzID0gT2JqZWN0LmtleXModGhpcy5uc3BzKTtcbiAgICAgICAgZm9yIChjb25zdCBuc3Agb2YgbnNwcykge1xuICAgICAgICAgICAgY29uc3Qgc29ja2V0ID0gdGhpcy5uc3BzW25zcF07XG4gICAgICAgICAgICBpZiAoc29ja2V0LmFjdGl2ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9jbG9zZSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBXcml0ZXMgYSBwYWNrZXQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFja2V0XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfcGFja2V0KHBhY2tldCkge1xuICAgICAgICBjb25zdCBlbmNvZGVkUGFja2V0cyA9IHRoaXMuZW5jb2Rlci5lbmNvZGUocGFja2V0KTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlbmNvZGVkUGFja2V0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5lbmdpbmUud3JpdGUoZW5jb2RlZFBhY2tldHNbaV0sIHBhY2tldC5vcHRpb25zKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBDbGVhbiB1cCB0cmFuc3BvcnQgc3Vic2NyaXB0aW9ucyBhbmQgcGFja2V0IGJ1ZmZlci5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgY2xlYW51cCgpIHtcbiAgICAgICAgdGhpcy5zdWJzLmZvckVhY2goKHN1YkRlc3Ryb3kpID0+IHN1YkRlc3Ryb3koKSk7XG4gICAgICAgIHRoaXMuc3Vicy5sZW5ndGggPSAwO1xuICAgICAgICB0aGlzLmRlY29kZXIuZGVzdHJveSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDbG9zZSB0aGUgY3VycmVudCBzb2NrZXQuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9jbG9zZSgpIHtcbiAgICAgICAgdGhpcy5za2lwUmVjb25uZWN0ID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fcmVjb25uZWN0aW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMub25jbG9zZShcImZvcmNlZCBjbG9zZVwiKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWxpYXMgZm9yIGNsb3NlKClcbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgZGlzY29ubmVjdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Nsb3NlKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxlZCB3aGVuOlxuICAgICAqXG4gICAgICogLSB0aGUgbG93LWxldmVsIGVuZ2luZSBpcyBjbG9zZWRcbiAgICAgKiAtIHRoZSBwYXJzZXIgZW5jb3VudGVyZWQgYSBiYWRseSBmb3JtYXR0ZWQgcGFja2V0XG4gICAgICogLSBhbGwgc29ja2V0cyBhcmUgZGlzY29ubmVjdGVkXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIG9uY2xvc2UocmVhc29uLCBkZXNjcmlwdGlvbikge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHRoaXMuY2xlYW51cCgpO1xuICAgICAgICAoX2EgPSB0aGlzLmVuZ2luZSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmNsb3NlKCk7XG4gICAgICAgIHRoaXMuYmFja29mZi5yZXNldCgpO1xuICAgICAgICB0aGlzLl9yZWFkeVN0YXRlID0gXCJjbG9zZWRcIjtcbiAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJjbG9zZVwiLCByZWFzb24sIGRlc2NyaXB0aW9uKTtcbiAgICAgICAgaWYgKHRoaXMuX3JlY29ubmVjdGlvbiAmJiAhdGhpcy5za2lwUmVjb25uZWN0KSB7XG4gICAgICAgICAgICB0aGlzLnJlY29ubmVjdCgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEF0dGVtcHQgYSByZWNvbm5lY3Rpb24uXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHJlY29ubmVjdCgpIHtcbiAgICAgICAgaWYgKHRoaXMuX3JlY29ubmVjdGluZyB8fCB0aGlzLnNraXBSZWNvbm5lY3QpXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG4gICAgICAgIGlmICh0aGlzLmJhY2tvZmYuYXR0ZW1wdHMgPj0gdGhpcy5fcmVjb25uZWN0aW9uQXR0ZW1wdHMpIHtcbiAgICAgICAgICAgIHRoaXMuYmFja29mZi5yZXNldCgpO1xuICAgICAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJyZWNvbm5lY3RfZmFpbGVkXCIpO1xuICAgICAgICAgICAgdGhpcy5fcmVjb25uZWN0aW5nID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBkZWxheSA9IHRoaXMuYmFja29mZi5kdXJhdGlvbigpO1xuICAgICAgICAgICAgdGhpcy5fcmVjb25uZWN0aW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIGNvbnN0IHRpbWVyID0gdGhpcy5zZXRUaW1lb3V0Rm4oKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChzZWxmLnNraXBSZWNvbm5lY3QpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcInJlY29ubmVjdF9hdHRlbXB0XCIsIHNlbGYuYmFja29mZi5hdHRlbXB0cyk7XG4gICAgICAgICAgICAgICAgLy8gY2hlY2sgYWdhaW4gZm9yIHRoZSBjYXNlIHNvY2tldCBjbG9zZWQgaW4gYWJvdmUgZXZlbnRzXG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuc2tpcFJlY29ubmVjdClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIHNlbGYub3BlbigoZXJyKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3JlY29ubmVjdGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5yZWNvbm5lY3QoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdFJlc2VydmVkKFwicmVjb25uZWN0X2Vycm9yXCIsIGVycik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm9ucmVjb25uZWN0KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sIGRlbGF5KTtcbiAgICAgICAgICAgIGlmICh0aGlzLm9wdHMuYXV0b1VucmVmKSB7XG4gICAgICAgICAgICAgICAgdGltZXIudW5yZWYoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc3Vicy5wdXNoKCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmNsZWFyVGltZW91dEZuKHRpbWVyKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxlZCB1cG9uIHN1Y2Nlc3NmdWwgcmVjb25uZWN0LlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBvbnJlY29ubmVjdCgpIHtcbiAgICAgICAgY29uc3QgYXR0ZW1wdCA9IHRoaXMuYmFja29mZi5hdHRlbXB0cztcbiAgICAgICAgdGhpcy5fcmVjb25uZWN0aW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMuYmFja29mZi5yZXNldCgpO1xuICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcInJlY29ubmVjdFwiLCBhdHRlbXB0KTtcbiAgICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/manager.js\n\n}')},"./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/on.js":
/*!*************************************************************************************************!*\
  !*** ./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/on.js ***!
  \*************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   on: () => (/* binding */ on)\n/* harmony export */ });\nfunction on(obj, ev, fn) {\n    obj.on(ev, fn);\n    return function subDestroy() {\n        obj.off(ev, fn);\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLWNsaWVudEA0LjguMS9ub2RlX21vZHVsZXMvc29ja2V0LmlvLWNsaWVudC9idWlsZC9lc20vb24uanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL25vZGVfbW9kdWxlcy8ucG5wbS9zb2NrZXQuaW8tY2xpZW50QDQuOC4xL25vZGVfbW9kdWxlcy9zb2NrZXQuaW8tY2xpZW50L2J1aWxkL2VzbS9vbi5qcz8xNTlhIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBmdW5jdGlvbiBvbihvYmosIGV2LCBmbikge1xuICAgIG9iai5vbihldiwgZm4pO1xuICAgIHJldHVybiBmdW5jdGlvbiBzdWJEZXN0cm95KCkge1xuICAgICAgICBvYmoub2ZmKGV2LCBmbik7XG4gICAgfTtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/on.js\n\n}")},"./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/socket.js":
/*!*****************************************************************************************************!*\
  !*** ./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/socket.js ***!
  \*****************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Socket: () => (/* binding */ Socket)\n/* harmony export */ });\n/* harmony import */ var socket_io_parser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! socket.io-parser */ "./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/index.js");\n/* harmony import */ var _on_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./on.js */ "./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/on.js");\n/* harmony import */ var _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @socket.io/component-emitter */ "./node_modules/.pnpm/@socket.io+component-emitter@3.1.2/node_modules/@socket.io/component-emitter/lib/esm/index.js");\n\n\n\n/**\n * Internal events.\n * These events can\'t be emitted by the user.\n */\nconst RESERVED_EVENTS = Object.freeze({\n    connect: 1,\n    connect_error: 1,\n    disconnect: 1,\n    disconnecting: 1,\n    // EventEmitter reserved events: https://nodejs.org/api/events.html#events_event_newlistener\n    newListener: 1,\n    removeListener: 1,\n});\n/**\n * A Socket is the fundamental class for interacting with the server.\n *\n * A Socket belongs to a certain Namespace (by default /) and uses an underlying {@link Manager} to communicate.\n *\n * @example\n * const socket = io();\n *\n * socket.on("connect", () => {\n *   console.log("connected");\n * });\n *\n * // send an event to the server\n * socket.emit("foo", "bar");\n *\n * socket.on("foobar", () => {\n *   // an event was received from the server\n * });\n *\n * // upon disconnection\n * socket.on("disconnect", (reason) => {\n *   console.log(`disconnected due to ${reason}`);\n * });\n */\nclass Socket extends _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_2__.Emitter {\n    /**\n     * `Socket` constructor.\n     */\n    constructor(io, nsp, opts) {\n        super();\n        /**\n         * Whether the socket is currently connected to the server.\n         *\n         * @example\n         * const socket = io();\n         *\n         * socket.on("connect", () => {\n         *   console.log(socket.connected); // true\n         * });\n         *\n         * socket.on("disconnect", () => {\n         *   console.log(socket.connected); // false\n         * });\n         */\n        this.connected = false;\n        /**\n         * Whether the connection state was recovered after a temporary disconnection. In that case, any missed packets will\n         * be transmitted by the server.\n         */\n        this.recovered = false;\n        /**\n         * Buffer for packets received before the CONNECT packet\n         */\n        this.receiveBuffer = [];\n        /**\n         * Buffer for packets that will be sent once the socket is connected\n         */\n        this.sendBuffer = [];\n        /**\n         * The queue of packets to be sent with retry in case of failure.\n         *\n         * Packets are sent one by one, each waiting for the server acknowledgement, in order to guarantee the delivery order.\n         * @private\n         */\n        this._queue = [];\n        /**\n         * A sequence to generate the ID of the {@link QueuedPacket}.\n         * @private\n         */\n        this._queueSeq = 0;\n        this.ids = 0;\n        /**\n         * A map containing acknowledgement handlers.\n         *\n         * The `withError` attribute is used to differentiate handlers that accept an error as first argument:\n         *\n         * - `socket.emit("test", (err, value) => { ... })` with `ackTimeout` option\n         * - `socket.timeout(5000).emit("test", (err, value) => { ... })`\n         * - `const value = await socket.emitWithAck("test")`\n         *\n         * From those that don\'t:\n         *\n         * - `socket.emit("test", (value) => { ... });`\n         *\n         * In the first case, the handlers will be called with an error when:\n         *\n         * - the timeout is reached\n         * - the socket gets disconnected\n         *\n         * In the second case, the handlers will be simply discarded upon disconnection, since the client will never receive\n         * an acknowledgement from the server.\n         *\n         * @private\n         */\n        this.acks = {};\n        this.flags = {};\n        this.io = io;\n        this.nsp = nsp;\n        if (opts && opts.auth) {\n            this.auth = opts.auth;\n        }\n        this._opts = Object.assign({}, opts);\n        if (this.io._autoConnect)\n            this.open();\n    }\n    /**\n     * Whether the socket is currently disconnected\n     *\n     * @example\n     * const socket = io();\n     *\n     * socket.on("connect", () => {\n     *   console.log(socket.disconnected); // false\n     * });\n     *\n     * socket.on("disconnect", () => {\n     *   console.log(socket.disconnected); // true\n     * });\n     */\n    get disconnected() {\n        return !this.connected;\n    }\n    /**\n     * Subscribe to open, close and packet events\n     *\n     * @private\n     */\n    subEvents() {\n        if (this.subs)\n            return;\n        const io = this.io;\n        this.subs = [\n            (0,_on_js__WEBPACK_IMPORTED_MODULE_1__.on)(io, "open", this.onopen.bind(this)),\n            (0,_on_js__WEBPACK_IMPORTED_MODULE_1__.on)(io, "packet", this.onpacket.bind(this)),\n            (0,_on_js__WEBPACK_IMPORTED_MODULE_1__.on)(io, "error", this.onerror.bind(this)),\n            (0,_on_js__WEBPACK_IMPORTED_MODULE_1__.on)(io, "close", this.onclose.bind(this)),\n        ];\n    }\n    /**\n     * Whether the Socket will try to reconnect when its Manager connects or reconnects.\n     *\n     * @example\n     * const socket = io();\n     *\n     * console.log(socket.active); // true\n     *\n     * socket.on("disconnect", (reason) => {\n     *   if (reason === "io server disconnect") {\n     *     // the disconnection was initiated by the server, you need to manually reconnect\n     *     console.log(socket.active); // false\n     *   }\n     *   // else the socket will automatically try to reconnect\n     *   console.log(socket.active); // true\n     * });\n     */\n    get active() {\n        return !!this.subs;\n    }\n    /**\n     * "Opens" the socket.\n     *\n     * @example\n     * const socket = io({\n     *   autoConnect: false\n     * });\n     *\n     * socket.connect();\n     */\n    connect() {\n        if (this.connected)\n            return this;\n        this.subEvents();\n        if (!this.io["_reconnecting"])\n            this.io.open(); // ensure open\n        if ("open" === this.io._readyState)\n            this.onopen();\n        return this;\n    }\n    /**\n     * Alias for {@link connect()}.\n     */\n    open() {\n        return this.connect();\n    }\n    /**\n     * Sends a `message` event.\n     *\n     * This method mimics the WebSocket.send() method.\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/WebSocket/send\n     *\n     * @example\n     * socket.send("hello");\n     *\n     * // this is equivalent to\n     * socket.emit("message", "hello");\n     *\n     * @return self\n     */\n    send(...args) {\n        args.unshift("message");\n        this.emit.apply(this, args);\n        return this;\n    }\n    /**\n     * Override `emit`.\n     * If the event is in `events`, it\'s emitted normally.\n     *\n     * @example\n     * socket.emit("hello", "world");\n     *\n     * // all serializable datastructures are supported (no need to call JSON.stringify)\n     * socket.emit("hello", 1, "2", { 3: ["4"], 5: Uint8Array.from([6]) });\n     *\n     * // with an acknowledgement from the server\n     * socket.emit("hello", "world", (val) => {\n     *   // ...\n     * });\n     *\n     * @return self\n     */\n    emit(ev, ...args) {\n        var _a, _b, _c;\n        if (RESERVED_EVENTS.hasOwnProperty(ev)) {\n            throw new Error(\'"\' + ev.toString() + \'" is a reserved event name\');\n        }\n        args.unshift(ev);\n        if (this._opts.retries && !this.flags.fromQueue && !this.flags.volatile) {\n            this._addToQueue(args);\n            return this;\n        }\n        const packet = {\n            type: socket_io_parser__WEBPACK_IMPORTED_MODULE_0__.PacketType.EVENT,\n            data: args,\n        };\n        packet.options = {};\n        packet.options.compress = this.flags.compress !== false;\n        // event ack callback\n        if ("function" === typeof args[args.length - 1]) {\n            const id = this.ids++;\n            const ack = args.pop();\n            this._registerAckCallback(id, ack);\n            packet.id = id;\n        }\n        const isTransportWritable = (_b = (_a = this.io.engine) === null || _a === void 0 ? void 0 : _a.transport) === null || _b === void 0 ? void 0 : _b.writable;\n        const isConnected = this.connected && !((_c = this.io.engine) === null || _c === void 0 ? void 0 : _c._hasPingExpired());\n        const discardPacket = this.flags.volatile && !isTransportWritable;\n        if (discardPacket) {\n        }\n        else if (isConnected) {\n            this.notifyOutgoingListeners(packet);\n            this.packet(packet);\n        }\n        else {\n            this.sendBuffer.push(packet);\n        }\n        this.flags = {};\n        return this;\n    }\n    /**\n     * @private\n     */\n    _registerAckCallback(id, ack) {\n        var _a;\n        const timeout = (_a = this.flags.timeout) !== null && _a !== void 0 ? _a : this._opts.ackTimeout;\n        if (timeout === undefined) {\n            this.acks[id] = ack;\n            return;\n        }\n        // @ts-ignore\n        const timer = this.io.setTimeoutFn(() => {\n            delete this.acks[id];\n            for (let i = 0; i < this.sendBuffer.length; i++) {\n                if (this.sendBuffer[i].id === id) {\n                    this.sendBuffer.splice(i, 1);\n                }\n            }\n            ack.call(this, new Error("operation has timed out"));\n        }, timeout);\n        const fn = (...args) => {\n            // @ts-ignore\n            this.io.clearTimeoutFn(timer);\n            ack.apply(this, args);\n        };\n        fn.withError = true;\n        this.acks[id] = fn;\n    }\n    /**\n     * Emits an event and waits for an acknowledgement\n     *\n     * @example\n     * // without timeout\n     * const response = await socket.emitWithAck("hello", "world");\n     *\n     * // with a specific timeout\n     * try {\n     *   const response = await socket.timeout(1000).emitWithAck("hello", "world");\n     * } catch (err) {\n     *   // the server did not acknowledge the event in the given delay\n     * }\n     *\n     * @return a Promise that will be fulfilled when the server acknowledges the event\n     */\n    emitWithAck(ev, ...args) {\n        return new Promise((resolve, reject) => {\n            const fn = (arg1, arg2) => {\n                return arg1 ? reject(arg1) : resolve(arg2);\n            };\n            fn.withError = true;\n            args.push(fn);\n            this.emit(ev, ...args);\n        });\n    }\n    /**\n     * Add the packet to the queue.\n     * @param args\n     * @private\n     */\n    _addToQueue(args) {\n        let ack;\n        if (typeof args[args.length - 1] === "function") {\n            ack = args.pop();\n        }\n        const packet = {\n            id: this._queueSeq++,\n            tryCount: 0,\n            pending: false,\n            args,\n            flags: Object.assign({ fromQueue: true }, this.flags),\n        };\n        args.push((err, ...responseArgs) => {\n            if (packet !== this._queue[0]) {\n                // the packet has already been acknowledged\n                return;\n            }\n            const hasError = err !== null;\n            if (hasError) {\n                if (packet.tryCount > this._opts.retries) {\n                    this._queue.shift();\n                    if (ack) {\n                        ack(err);\n                    }\n                }\n            }\n            else {\n                this._queue.shift();\n                if (ack) {\n                    ack(null, ...responseArgs);\n                }\n            }\n            packet.pending = false;\n            return this._drainQueue();\n        });\n        this._queue.push(packet);\n        this._drainQueue();\n    }\n    /**\n     * Send the first packet of the queue, and wait for an acknowledgement from the server.\n     * @param force - whether to resend a packet that has not been acknowledged yet\n     *\n     * @private\n     */\n    _drainQueue(force = false) {\n        if (!this.connected || this._queue.length === 0) {\n            return;\n        }\n        const packet = this._queue[0];\n        if (packet.pending && !force) {\n            return;\n        }\n        packet.pending = true;\n        packet.tryCount++;\n        this.flags = packet.flags;\n        this.emit.apply(this, packet.args);\n    }\n    /**\n     * Sends a packet.\n     *\n     * @param packet\n     * @private\n     */\n    packet(packet) {\n        packet.nsp = this.nsp;\n        this.io._packet(packet);\n    }\n    /**\n     * Called upon engine `open`.\n     *\n     * @private\n     */\n    onopen() {\n        if (typeof this.auth == "function") {\n            this.auth((data) => {\n                this._sendConnectPacket(data);\n            });\n        }\n        else {\n            this._sendConnectPacket(this.auth);\n        }\n    }\n    /**\n     * Sends a CONNECT packet to initiate the Socket.IO session.\n     *\n     * @param data\n     * @private\n     */\n    _sendConnectPacket(data) {\n        this.packet({\n            type: socket_io_parser__WEBPACK_IMPORTED_MODULE_0__.PacketType.CONNECT,\n            data: this._pid\n                ? Object.assign({ pid: this._pid, offset: this._lastOffset }, data)\n                : data,\n        });\n    }\n    /**\n     * Called upon engine or manager `error`.\n     *\n     * @param err\n     * @private\n     */\n    onerror(err) {\n        if (!this.connected) {\n            this.emitReserved("connect_error", err);\n        }\n    }\n    /**\n     * Called upon engine `close`.\n     *\n     * @param reason\n     * @param description\n     * @private\n     */\n    onclose(reason, description) {\n        this.connected = false;\n        delete this.id;\n        this.emitReserved("disconnect", reason, description);\n        this._clearAcks();\n    }\n    /**\n     * Clears the acknowledgement handlers upon disconnection, since the client will never receive an acknowledgement from\n     * the server.\n     *\n     * @private\n     */\n    _clearAcks() {\n        Object.keys(this.acks).forEach((id) => {\n            const isBuffered = this.sendBuffer.some((packet) => String(packet.id) === id);\n            if (!isBuffered) {\n                // note: handlers that do not accept an error as first argument are ignored here\n                const ack = this.acks[id];\n                delete this.acks[id];\n                if (ack.withError) {\n                    ack.call(this, new Error("socket has been disconnected"));\n                }\n            }\n        });\n    }\n    /**\n     * Called with socket packet.\n     *\n     * @param packet\n     * @private\n     */\n    onpacket(packet) {\n        const sameNamespace = packet.nsp === this.nsp;\n        if (!sameNamespace)\n            return;\n        switch (packet.type) {\n            case socket_io_parser__WEBPACK_IMPORTED_MODULE_0__.PacketType.CONNECT:\n                if (packet.data && packet.data.sid) {\n                    this.onconnect(packet.data.sid, packet.data.pid);\n                }\n                else {\n                    this.emitReserved("connect_error", new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));\n                }\n                break;\n            case socket_io_parser__WEBPACK_IMPORTED_MODULE_0__.PacketType.EVENT:\n            case socket_io_parser__WEBPACK_IMPORTED_MODULE_0__.PacketType.BINARY_EVENT:\n                this.onevent(packet);\n                break;\n            case socket_io_parser__WEBPACK_IMPORTED_MODULE_0__.PacketType.ACK:\n            case socket_io_parser__WEBPACK_IMPORTED_MODULE_0__.PacketType.BINARY_ACK:\n                this.onack(packet);\n                break;\n            case socket_io_parser__WEBPACK_IMPORTED_MODULE_0__.PacketType.DISCONNECT:\n                this.ondisconnect();\n                break;\n            case socket_io_parser__WEBPACK_IMPORTED_MODULE_0__.PacketType.CONNECT_ERROR:\n                this.destroy();\n                const err = new Error(packet.data.message);\n                // @ts-ignore\n                err.data = packet.data.data;\n                this.emitReserved("connect_error", err);\n                break;\n        }\n    }\n    /**\n     * Called upon a server event.\n     *\n     * @param packet\n     * @private\n     */\n    onevent(packet) {\n        const args = packet.data || [];\n        if (null != packet.id) {\n            args.push(this.ack(packet.id));\n        }\n        if (this.connected) {\n            this.emitEvent(args);\n        }\n        else {\n            this.receiveBuffer.push(Object.freeze(args));\n        }\n    }\n    emitEvent(args) {\n        if (this._anyListeners && this._anyListeners.length) {\n            const listeners = this._anyListeners.slice();\n            for (const listener of listeners) {\n                listener.apply(this, args);\n            }\n        }\n        super.emit.apply(this, args);\n        if (this._pid && args.length && typeof args[args.length - 1] === "string") {\n            this._lastOffset = args[args.length - 1];\n        }\n    }\n    /**\n     * Produces an ack callback to emit with an event.\n     *\n     * @private\n     */\n    ack(id) {\n        const self = this;\n        let sent = false;\n        return function (...args) {\n            // prevent double callbacks\n            if (sent)\n                return;\n            sent = true;\n            self.packet({\n                type: socket_io_parser__WEBPACK_IMPORTED_MODULE_0__.PacketType.ACK,\n                id: id,\n                data: args,\n            });\n        };\n    }\n    /**\n     * Called upon a server acknowledgement.\n     *\n     * @param packet\n     * @private\n     */\n    onack(packet) {\n        const ack = this.acks[packet.id];\n        if (typeof ack !== "function") {\n            return;\n        }\n        delete this.acks[packet.id];\n        // @ts-ignore FIXME ack is incorrectly inferred as \'never\'\n        if (ack.withError) {\n            packet.data.unshift(null);\n        }\n        // @ts-ignore\n        ack.apply(this, packet.data);\n    }\n    /**\n     * Called upon server connect.\n     *\n     * @private\n     */\n    onconnect(id, pid) {\n        this.id = id;\n        this.recovered = pid && this._pid === pid;\n        this._pid = pid; // defined only if connection state recovery is enabled\n        this.connected = true;\n        this.emitBuffered();\n        this.emitReserved("connect");\n        this._drainQueue(true);\n    }\n    /**\n     * Emit buffered events (received and emitted).\n     *\n     * @private\n     */\n    emitBuffered() {\n        this.receiveBuffer.forEach((args) => this.emitEvent(args));\n        this.receiveBuffer = [];\n        this.sendBuffer.forEach((packet) => {\n            this.notifyOutgoingListeners(packet);\n            this.packet(packet);\n        });\n        this.sendBuffer = [];\n    }\n    /**\n     * Called upon server disconnect.\n     *\n     * @private\n     */\n    ondisconnect() {\n        this.destroy();\n        this.onclose("io server disconnect");\n    }\n    /**\n     * Called upon forced client/server side disconnections,\n     * this method ensures the manager stops tracking us and\n     * that reconnections don\'t get triggered for this.\n     *\n     * @private\n     */\n    destroy() {\n        if (this.subs) {\n            // clean subscriptions to avoid reconnections\n            this.subs.forEach((subDestroy) => subDestroy());\n            this.subs = undefined;\n        }\n        this.io["_destroy"](this);\n    }\n    /**\n     * Disconnects the socket manually. In that case, the socket will not try to reconnect.\n     *\n     * If this is the last active Socket instance of the {@link Manager}, the low-level connection will be closed.\n     *\n     * @example\n     * const socket = io();\n     *\n     * socket.on("disconnect", (reason) => {\n     *   // console.log(reason); prints "io client disconnect"\n     * });\n     *\n     * socket.disconnect();\n     *\n     * @return self\n     */\n    disconnect() {\n        if (this.connected) {\n            this.packet({ type: socket_io_parser__WEBPACK_IMPORTED_MODULE_0__.PacketType.DISCONNECT });\n        }\n        // remove socket from pool\n        this.destroy();\n        if (this.connected) {\n            // fire events\n            this.onclose("io client disconnect");\n        }\n        return this;\n    }\n    /**\n     * Alias for {@link disconnect()}.\n     *\n     * @return self\n     */\n    close() {\n        return this.disconnect();\n    }\n    /**\n     * Sets the compress flag.\n     *\n     * @example\n     * socket.compress(false).emit("hello");\n     *\n     * @param compress - if `true`, compresses the sending data\n     * @return self\n     */\n    compress(compress) {\n        this.flags.compress = compress;\n        return this;\n    }\n    /**\n     * Sets a modifier for a subsequent event emission that the event message will be dropped when this socket is not\n     * ready to send messages.\n     *\n     * @example\n     * socket.volatile.emit("hello"); // the server may or may not receive it\n     *\n     * @returns self\n     */\n    get volatile() {\n        this.flags.volatile = true;\n        return this;\n    }\n    /**\n     * Sets a modifier for a subsequent event emission that the callback will be called with an error when the\n     * given number of milliseconds have elapsed without an acknowledgement from the server:\n     *\n     * @example\n     * socket.timeout(5000).emit("my-event", (err) => {\n     *   if (err) {\n     *     // the server did not acknowledge the event in the given delay\n     *   }\n     * });\n     *\n     * @returns self\n     */\n    timeout(timeout) {\n        this.flags.timeout = timeout;\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback.\n     *\n     * @example\n     * socket.onAny((event, ...args) => {\n     *   console.log(`got ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    onAny(listener) {\n        this._anyListeners = this._anyListeners || [];\n        this._anyListeners.push(listener);\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback. The listener is added to the beginning of the listeners array.\n     *\n     * @example\n     * socket.prependAny((event, ...args) => {\n     *   console.log(`got event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    prependAny(listener) {\n        this._anyListeners = this._anyListeners || [];\n        this._anyListeners.unshift(listener);\n        return this;\n    }\n    /**\n     * Removes the listener that will be fired when any event is emitted.\n     *\n     * @example\n     * const catchAllListener = (event, ...args) => {\n     *   console.log(`got event ${event}`);\n     * }\n     *\n     * socket.onAny(catchAllListener);\n     *\n     * // remove a specific listener\n     * socket.offAny(catchAllListener);\n     *\n     * // or remove all listeners\n     * socket.offAny();\n     *\n     * @param listener\n     */\n    offAny(listener) {\n        if (!this._anyListeners) {\n            return this;\n        }\n        if (listener) {\n            const listeners = this._anyListeners;\n            for (let i = 0; i < listeners.length; i++) {\n                if (listener === listeners[i]) {\n                    listeners.splice(i, 1);\n                    return this;\n                }\n            }\n        }\n        else {\n            this._anyListeners = [];\n        }\n        return this;\n    }\n    /**\n     * Returns an array of listeners that are listening for any event that is specified. This array can be manipulated,\n     * e.g. to remove listeners.\n     */\n    listenersAny() {\n        return this._anyListeners || [];\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback.\n     *\n     * Note: acknowledgements sent to the server are not included.\n     *\n     * @example\n     * socket.onAnyOutgoing((event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    onAnyOutgoing(listener) {\n        this._anyOutgoingListeners = this._anyOutgoingListeners || [];\n        this._anyOutgoingListeners.push(listener);\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback. The listener is added to the beginning of the listeners array.\n     *\n     * Note: acknowledgements sent to the server are not included.\n     *\n     * @example\n     * socket.prependAnyOutgoing((event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    prependAnyOutgoing(listener) {\n        this._anyOutgoingListeners = this._anyOutgoingListeners || [];\n        this._anyOutgoingListeners.unshift(listener);\n        return this;\n    }\n    /**\n     * Removes the listener that will be fired when any event is emitted.\n     *\n     * @example\n     * const catchAllListener = (event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * }\n     *\n     * socket.onAnyOutgoing(catchAllListener);\n     *\n     * // remove a specific listener\n     * socket.offAnyOutgoing(catchAllListener);\n     *\n     * // or remove all listeners\n     * socket.offAnyOutgoing();\n     *\n     * @param [listener] - the catch-all listener (optional)\n     */\n    offAnyOutgoing(listener) {\n        if (!this._anyOutgoingListeners) {\n            return this;\n        }\n        if (listener) {\n            const listeners = this._anyOutgoingListeners;\n            for (let i = 0; i < listeners.length; i++) {\n                if (listener === listeners[i]) {\n                    listeners.splice(i, 1);\n                    return this;\n                }\n            }\n        }\n        else {\n            this._anyOutgoingListeners = [];\n        }\n        return this;\n    }\n    /**\n     * Returns an array of listeners that are listening for any event that is specified. This array can be manipulated,\n     * e.g. to remove listeners.\n     */\n    listenersAnyOutgoing() {\n        return this._anyOutgoingListeners || [];\n    }\n    /**\n     * Notify the listeners for each packet sent\n     *\n     * @param packet\n     *\n     * @private\n     */\n    notifyOutgoingListeners(packet) {\n        if (this._anyOutgoingListeners && this._anyOutgoingListeners.length) {\n            const listeners = this._anyOutgoingListeners.slice();\n            for (const listener of listeners) {\n                listener.apply(this, packet.data);\n            }\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLWNsaWVudEA0LjguMS9ub2RlX21vZHVsZXMvc29ja2V0LmlvLWNsaWVudC9idWlsZC9lc20vc29ja2V0LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBOEM7QUFDakI7QUFDMkI7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLGtGQUFrRixlQUFlO0FBQ2pHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDLE9BQU87QUFDL0MsSUFBSTtBQUNKO0FBQ08scUJBQXFCLGlFQUFPO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QztBQUM1QyxZQUFZO0FBQ1o7QUFDQTtBQUNBLDRDQUE0QztBQUM1QyxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRCxtQkFBbUI7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0RBQW9ELEtBQUs7QUFDekQsa0VBQWtFLEtBQUs7QUFDdkU7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0MsS0FBSyxFQUFFO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQztBQUMzQyxRQUFRO0FBQ1I7QUFDQTtBQUNBLDJDQUEyQztBQUMzQyxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksMENBQUU7QUFDZCxZQUFZLDBDQUFFO0FBQ2QsWUFBWSwwQ0FBRTtBQUNkLFlBQVksMENBQUU7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDO0FBQ3ZDO0FBQ0E7QUFDQSxxQ0FBcUM7QUFDckMsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixnQkFBZ0I7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQyxtQ0FBbUM7QUFDekU7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQix3REFBVTtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsNEJBQTRCO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLGlCQUFpQjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0Isd0RBQVU7QUFDNUI7QUFDQSxrQ0FBa0MsMENBQTBDO0FBQzVFO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsd0RBQVU7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsd0RBQVU7QUFDM0IsaUJBQWlCLHdEQUFVO0FBQzNCO0FBQ0E7QUFDQSxpQkFBaUIsd0RBQVU7QUFDM0IsaUJBQWlCLHdEQUFVO0FBQzNCO0FBQ0E7QUFDQSxpQkFBaUIsd0RBQVU7QUFDM0I7QUFDQTtBQUNBLGlCQUFpQix3REFBVTtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQix3REFBVTtBQUNoQztBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBEQUEwRCxjQUFjO0FBQ3hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakMsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLE1BQU0sd0RBQVUsYUFBYTtBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixtQkFBbUI7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLE1BQU07QUFDbEMsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsTUFBTTtBQUN4QyxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsTUFBTTtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsc0JBQXNCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsTUFBTTtBQUN6QyxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsTUFBTTtBQUN6QyxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsTUFBTTtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsc0JBQXNCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL3NvY2tldC5pby1jbGllbnRANC44LjEvbm9kZV9tb2R1bGVzL3NvY2tldC5pby1jbGllbnQvYnVpbGQvZXNtL3NvY2tldC5qcz8xYmRmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhY2tldFR5cGUgfSBmcm9tIFwic29ja2V0LmlvLXBhcnNlclwiO1xuaW1wb3J0IHsgb24gfSBmcm9tIFwiLi9vbi5qc1wiO1xuaW1wb3J0IHsgRW1pdHRlciwgfSBmcm9tIFwiQHNvY2tldC5pby9jb21wb25lbnQtZW1pdHRlclwiO1xuLyoqXG4gKiBJbnRlcm5hbCBldmVudHMuXG4gKiBUaGVzZSBldmVudHMgY2FuJ3QgYmUgZW1pdHRlZCBieSB0aGUgdXNlci5cbiAqL1xuY29uc3QgUkVTRVJWRURfRVZFTlRTID0gT2JqZWN0LmZyZWV6ZSh7XG4gICAgY29ubmVjdDogMSxcbiAgICBjb25uZWN0X2Vycm9yOiAxLFxuICAgIGRpc2Nvbm5lY3Q6IDEsXG4gICAgZGlzY29ubmVjdGluZzogMSxcbiAgICAvLyBFdmVudEVtaXR0ZXIgcmVzZXJ2ZWQgZXZlbnRzOiBodHRwczovL25vZGVqcy5vcmcvYXBpL2V2ZW50cy5odG1sI2V2ZW50c19ldmVudF9uZXdsaXN0ZW5lclxuICAgIG5ld0xpc3RlbmVyOiAxLFxuICAgIHJlbW92ZUxpc3RlbmVyOiAxLFxufSk7XG4vKipcbiAqIEEgU29ja2V0IGlzIHRoZSBmdW5kYW1lbnRhbCBjbGFzcyBmb3IgaW50ZXJhY3Rpbmcgd2l0aCB0aGUgc2VydmVyLlxuICpcbiAqIEEgU29ja2V0IGJlbG9uZ3MgdG8gYSBjZXJ0YWluIE5hbWVzcGFjZSAoYnkgZGVmYXVsdCAvKSBhbmQgdXNlcyBhbiB1bmRlcmx5aW5nIHtAbGluayBNYW5hZ2VyfSB0byBjb21tdW5pY2F0ZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogY29uc3Qgc29ja2V0ID0gaW8oKTtcbiAqXG4gKiBzb2NrZXQub24oXCJjb25uZWN0XCIsICgpID0+IHtcbiAqICAgY29uc29sZS5sb2coXCJjb25uZWN0ZWRcIik7XG4gKiB9KTtcbiAqXG4gKiAvLyBzZW5kIGFuIGV2ZW50IHRvIHRoZSBzZXJ2ZXJcbiAqIHNvY2tldC5lbWl0KFwiZm9vXCIsIFwiYmFyXCIpO1xuICpcbiAqIHNvY2tldC5vbihcImZvb2JhclwiLCAoKSA9PiB7XG4gKiAgIC8vIGFuIGV2ZW50IHdhcyByZWNlaXZlZCBmcm9tIHRoZSBzZXJ2ZXJcbiAqIH0pO1xuICpcbiAqIC8vIHVwb24gZGlzY29ubmVjdGlvblxuICogc29ja2V0Lm9uKFwiZGlzY29ubmVjdFwiLCAocmVhc29uKSA9PiB7XG4gKiAgIGNvbnNvbGUubG9nKGBkaXNjb25uZWN0ZWQgZHVlIHRvICR7cmVhc29ufWApO1xuICogfSk7XG4gKi9cbmV4cG9ydCBjbGFzcyBTb2NrZXQgZXh0ZW5kcyBFbWl0dGVyIHtcbiAgICAvKipcbiAgICAgKiBgU29ja2V0YCBjb25zdHJ1Y3Rvci5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihpbywgbnNwLCBvcHRzKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBXaGV0aGVyIHRoZSBzb2NrZXQgaXMgY3VycmVudGx5IGNvbm5lY3RlZCB0byB0aGUgc2VydmVyLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAZXhhbXBsZVxuICAgICAgICAgKiBjb25zdCBzb2NrZXQgPSBpbygpO1xuICAgICAgICAgKlxuICAgICAgICAgKiBzb2NrZXQub24oXCJjb25uZWN0XCIsICgpID0+IHtcbiAgICAgICAgICogICBjb25zb2xlLmxvZyhzb2NrZXQuY29ubmVjdGVkKTsgLy8gdHJ1ZVxuICAgICAgICAgKiB9KTtcbiAgICAgICAgICpcbiAgICAgICAgICogc29ja2V0Lm9uKFwiZGlzY29ubmVjdFwiLCAoKSA9PiB7XG4gICAgICAgICAqICAgY29uc29sZS5sb2coc29ja2V0LmNvbm5lY3RlZCk7IC8vIGZhbHNlXG4gICAgICAgICAqIH0pO1xuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5jb25uZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFdoZXRoZXIgdGhlIGNvbm5lY3Rpb24gc3RhdGUgd2FzIHJlY292ZXJlZCBhZnRlciBhIHRlbXBvcmFyeSBkaXNjb25uZWN0aW9uLiBJbiB0aGF0IGNhc2UsIGFueSBtaXNzZWQgcGFja2V0cyB3aWxsXG4gICAgICAgICAqIGJlIHRyYW5zbWl0dGVkIGJ5IHRoZSBzZXJ2ZXIuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnJlY292ZXJlZCA9IGZhbHNlO1xuICAgICAgICAvKipcbiAgICAgICAgICogQnVmZmVyIGZvciBwYWNrZXRzIHJlY2VpdmVkIGJlZm9yZSB0aGUgQ09OTkVDVCBwYWNrZXRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucmVjZWl2ZUJ1ZmZlciA9IFtdO1xuICAgICAgICAvKipcbiAgICAgICAgICogQnVmZmVyIGZvciBwYWNrZXRzIHRoYXQgd2lsbCBiZSBzZW50IG9uY2UgdGhlIHNvY2tldCBpcyBjb25uZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc2VuZEJ1ZmZlciA9IFtdO1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHF1ZXVlIG9mIHBhY2tldHMgdG8gYmUgc2VudCB3aXRoIHJldHJ5IGluIGNhc2Ugb2YgZmFpbHVyZS5cbiAgICAgICAgICpcbiAgICAgICAgICogUGFja2V0cyBhcmUgc2VudCBvbmUgYnkgb25lLCBlYWNoIHdhaXRpbmcgZm9yIHRoZSBzZXJ2ZXIgYWNrbm93bGVkZ2VtZW50LCBpbiBvcmRlciB0byBndWFyYW50ZWUgdGhlIGRlbGl2ZXJ5IG9yZGVyLlxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fcXVldWUgPSBbXTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgc2VxdWVuY2UgdG8gZ2VuZXJhdGUgdGhlIElEIG9mIHRoZSB7QGxpbmsgUXVldWVkUGFja2V0fS5cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3F1ZXVlU2VxID0gMDtcbiAgICAgICAgdGhpcy5pZHMgPSAwO1xuICAgICAgICAvKipcbiAgICAgICAgICogQSBtYXAgY29udGFpbmluZyBhY2tub3dsZWRnZW1lbnQgaGFuZGxlcnMuXG4gICAgICAgICAqXG4gICAgICAgICAqIFRoZSBgd2l0aEVycm9yYCBhdHRyaWJ1dGUgaXMgdXNlZCB0byBkaWZmZXJlbnRpYXRlIGhhbmRsZXJzIHRoYXQgYWNjZXB0IGFuIGVycm9yIGFzIGZpcnN0IGFyZ3VtZW50OlxuICAgICAgICAgKlxuICAgICAgICAgKiAtIGBzb2NrZXQuZW1pdChcInRlc3RcIiwgKGVyciwgdmFsdWUpID0+IHsgLi4uIH0pYCB3aXRoIGBhY2tUaW1lb3V0YCBvcHRpb25cbiAgICAgICAgICogLSBgc29ja2V0LnRpbWVvdXQoNTAwMCkuZW1pdChcInRlc3RcIiwgKGVyciwgdmFsdWUpID0+IHsgLi4uIH0pYFxuICAgICAgICAgKiAtIGBjb25zdCB2YWx1ZSA9IGF3YWl0IHNvY2tldC5lbWl0V2l0aEFjayhcInRlc3RcIilgXG4gICAgICAgICAqXG4gICAgICAgICAqIEZyb20gdGhvc2UgdGhhdCBkb24ndDpcbiAgICAgICAgICpcbiAgICAgICAgICogLSBgc29ja2V0LmVtaXQoXCJ0ZXN0XCIsICh2YWx1ZSkgPT4geyAuLi4gfSk7YFxuICAgICAgICAgKlxuICAgICAgICAgKiBJbiB0aGUgZmlyc3QgY2FzZSwgdGhlIGhhbmRsZXJzIHdpbGwgYmUgY2FsbGVkIHdpdGggYW4gZXJyb3Igd2hlbjpcbiAgICAgICAgICpcbiAgICAgICAgICogLSB0aGUgdGltZW91dCBpcyByZWFjaGVkXG4gICAgICAgICAqIC0gdGhlIHNvY2tldCBnZXRzIGRpc2Nvbm5lY3RlZFxuICAgICAgICAgKlxuICAgICAgICAgKiBJbiB0aGUgc2Vjb25kIGNhc2UsIHRoZSBoYW5kbGVycyB3aWxsIGJlIHNpbXBseSBkaXNjYXJkZWQgdXBvbiBkaXNjb25uZWN0aW9uLCBzaW5jZSB0aGUgY2xpZW50IHdpbGwgbmV2ZXIgcmVjZWl2ZVxuICAgICAgICAgKiBhbiBhY2tub3dsZWRnZW1lbnQgZnJvbSB0aGUgc2VydmVyLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5hY2tzID0ge307XG4gICAgICAgIHRoaXMuZmxhZ3MgPSB7fTtcbiAgICAgICAgdGhpcy5pbyA9IGlvO1xuICAgICAgICB0aGlzLm5zcCA9IG5zcDtcbiAgICAgICAgaWYgKG9wdHMgJiYgb3B0cy5hdXRoKSB7XG4gICAgICAgICAgICB0aGlzLmF1dGggPSBvcHRzLmF1dGg7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fb3B0cyA9IE9iamVjdC5hc3NpZ24oe30sIG9wdHMpO1xuICAgICAgICBpZiAodGhpcy5pby5fYXV0b0Nvbm5lY3QpXG4gICAgICAgICAgICB0aGlzLm9wZW4oKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogV2hldGhlciB0aGUgc29ja2V0IGlzIGN1cnJlbnRseSBkaXNjb25uZWN0ZWRcbiAgICAgKlxuICAgICAqIEBleGFtcGxlXG4gICAgICogY29uc3Qgc29ja2V0ID0gaW8oKTtcbiAgICAgKlxuICAgICAqIHNvY2tldC5vbihcImNvbm5lY3RcIiwgKCkgPT4ge1xuICAgICAqICAgY29uc29sZS5sb2coc29ja2V0LmRpc2Nvbm5lY3RlZCk7IC8vIGZhbHNlXG4gICAgICogfSk7XG4gICAgICpcbiAgICAgKiBzb2NrZXQub24oXCJkaXNjb25uZWN0XCIsICgpID0+IHtcbiAgICAgKiAgIGNvbnNvbGUubG9nKHNvY2tldC5kaXNjb25uZWN0ZWQpOyAvLyB0cnVlXG4gICAgICogfSk7XG4gICAgICovXG4gICAgZ2V0IGRpc2Nvbm5lY3RlZCgpIHtcbiAgICAgICAgcmV0dXJuICF0aGlzLmNvbm5lY3RlZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3Vic2NyaWJlIHRvIG9wZW4sIGNsb3NlIGFuZCBwYWNrZXQgZXZlbnRzXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHN1YkV2ZW50cygpIHtcbiAgICAgICAgaWYgKHRoaXMuc3VicylcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgY29uc3QgaW8gPSB0aGlzLmlvO1xuICAgICAgICB0aGlzLnN1YnMgPSBbXG4gICAgICAgICAgICBvbihpbywgXCJvcGVuXCIsIHRoaXMub25vcGVuLmJpbmQodGhpcykpLFxuICAgICAgICAgICAgb24oaW8sIFwicGFja2V0XCIsIHRoaXMub25wYWNrZXQuYmluZCh0aGlzKSksXG4gICAgICAgICAgICBvbihpbywgXCJlcnJvclwiLCB0aGlzLm9uZXJyb3IuYmluZCh0aGlzKSksXG4gICAgICAgICAgICBvbihpbywgXCJjbG9zZVwiLCB0aGlzLm9uY2xvc2UuYmluZCh0aGlzKSksXG4gICAgICAgIF07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFdoZXRoZXIgdGhlIFNvY2tldCB3aWxsIHRyeSB0byByZWNvbm5lY3Qgd2hlbiBpdHMgTWFuYWdlciBjb25uZWN0cyBvciByZWNvbm5lY3RzLlxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBjb25zdCBzb2NrZXQgPSBpbygpO1xuICAgICAqXG4gICAgICogY29uc29sZS5sb2coc29ja2V0LmFjdGl2ZSk7IC8vIHRydWVcbiAgICAgKlxuICAgICAqIHNvY2tldC5vbihcImRpc2Nvbm5lY3RcIiwgKHJlYXNvbikgPT4ge1xuICAgICAqICAgaWYgKHJlYXNvbiA9PT0gXCJpbyBzZXJ2ZXIgZGlzY29ubmVjdFwiKSB7XG4gICAgICogICAgIC8vIHRoZSBkaXNjb25uZWN0aW9uIHdhcyBpbml0aWF0ZWQgYnkgdGhlIHNlcnZlciwgeW91IG5lZWQgdG8gbWFudWFsbHkgcmVjb25uZWN0XG4gICAgICogICAgIGNvbnNvbGUubG9nKHNvY2tldC5hY3RpdmUpOyAvLyBmYWxzZVxuICAgICAqICAgfVxuICAgICAqICAgLy8gZWxzZSB0aGUgc29ja2V0IHdpbGwgYXV0b21hdGljYWxseSB0cnkgdG8gcmVjb25uZWN0XG4gICAgICogICBjb25zb2xlLmxvZyhzb2NrZXQuYWN0aXZlKTsgLy8gdHJ1ZVxuICAgICAqIH0pO1xuICAgICAqL1xuICAgIGdldCBhY3RpdmUoKSB7XG4gICAgICAgIHJldHVybiAhIXRoaXMuc3VicztcbiAgICB9XG4gICAgLyoqXG4gICAgICogXCJPcGVuc1wiIHRoZSBzb2NrZXQuXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIGNvbnN0IHNvY2tldCA9IGlvKHtcbiAgICAgKiAgIGF1dG9Db25uZWN0OiBmYWxzZVxuICAgICAqIH0pO1xuICAgICAqXG4gICAgICogc29ja2V0LmNvbm5lY3QoKTtcbiAgICAgKi9cbiAgICBjb25uZWN0KCkge1xuICAgICAgICBpZiAodGhpcy5jb25uZWN0ZWQpXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgdGhpcy5zdWJFdmVudHMoKTtcbiAgICAgICAgaWYgKCF0aGlzLmlvW1wiX3JlY29ubmVjdGluZ1wiXSlcbiAgICAgICAgICAgIHRoaXMuaW8ub3BlbigpOyAvLyBlbnN1cmUgb3BlblxuICAgICAgICBpZiAoXCJvcGVuXCIgPT09IHRoaXMuaW8uX3JlYWR5U3RhdGUpXG4gICAgICAgICAgICB0aGlzLm9ub3BlbigpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWxpYXMgZm9yIHtAbGluayBjb25uZWN0KCl9LlxuICAgICAqL1xuICAgIG9wZW4oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbm5lY3QoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VuZHMgYSBgbWVzc2FnZWAgZXZlbnQuXG4gICAgICpcbiAgICAgKiBUaGlzIG1ldGhvZCBtaW1pY3MgdGhlIFdlYlNvY2tldC5zZW5kKCkgbWV0aG9kLlxuICAgICAqXG4gICAgICogQHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvV2ViU29ja2V0L3NlbmRcbiAgICAgKlxuICAgICAqIEBleGFtcGxlXG4gICAgICogc29ja2V0LnNlbmQoXCJoZWxsb1wiKTtcbiAgICAgKlxuICAgICAqIC8vIHRoaXMgaXMgZXF1aXZhbGVudCB0b1xuICAgICAqIHNvY2tldC5lbWl0KFwibWVzc2FnZVwiLCBcImhlbGxvXCIpO1xuICAgICAqXG4gICAgICogQHJldHVybiBzZWxmXG4gICAgICovXG4gICAgc2VuZCguLi5hcmdzKSB7XG4gICAgICAgIGFyZ3MudW5zaGlmdChcIm1lc3NhZ2VcIik7XG4gICAgICAgIHRoaXMuZW1pdC5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE92ZXJyaWRlIGBlbWl0YC5cbiAgICAgKiBJZiB0aGUgZXZlbnQgaXMgaW4gYGV2ZW50c2AsIGl0J3MgZW1pdHRlZCBub3JtYWxseS5cbiAgICAgKlxuICAgICAqIEBleGFtcGxlXG4gICAgICogc29ja2V0LmVtaXQoXCJoZWxsb1wiLCBcIndvcmxkXCIpO1xuICAgICAqXG4gICAgICogLy8gYWxsIHNlcmlhbGl6YWJsZSBkYXRhc3RydWN0dXJlcyBhcmUgc3VwcG9ydGVkIChubyBuZWVkIHRvIGNhbGwgSlNPTi5zdHJpbmdpZnkpXG4gICAgICogc29ja2V0LmVtaXQoXCJoZWxsb1wiLCAxLCBcIjJcIiwgeyAzOiBbXCI0XCJdLCA1OiBVaW50OEFycmF5LmZyb20oWzZdKSB9KTtcbiAgICAgKlxuICAgICAqIC8vIHdpdGggYW4gYWNrbm93bGVkZ2VtZW50IGZyb20gdGhlIHNlcnZlclxuICAgICAqIHNvY2tldC5lbWl0KFwiaGVsbG9cIiwgXCJ3b3JsZFwiLCAodmFsKSA9PiB7XG4gICAgICogICAvLyAuLi5cbiAgICAgKiB9KTtcbiAgICAgKlxuICAgICAqIEByZXR1cm4gc2VsZlxuICAgICAqL1xuICAgIGVtaXQoZXYsIC4uLmFyZ3MpIHtcbiAgICAgICAgdmFyIF9hLCBfYiwgX2M7XG4gICAgICAgIGlmIChSRVNFUlZFRF9FVkVOVFMuaGFzT3duUHJvcGVydHkoZXYpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1wiJyArIGV2LnRvU3RyaW5nKCkgKyAnXCIgaXMgYSByZXNlcnZlZCBldmVudCBuYW1lJyk7XG4gICAgICAgIH1cbiAgICAgICAgYXJncy51bnNoaWZ0KGV2KTtcbiAgICAgICAgaWYgKHRoaXMuX29wdHMucmV0cmllcyAmJiAhdGhpcy5mbGFncy5mcm9tUXVldWUgJiYgIXRoaXMuZmxhZ3Mudm9sYXRpbGUpIHtcbiAgICAgICAgICAgIHRoaXMuX2FkZFRvUXVldWUoYXJncyk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBwYWNrZXQgPSB7XG4gICAgICAgICAgICB0eXBlOiBQYWNrZXRUeXBlLkVWRU5ULFxuICAgICAgICAgICAgZGF0YTogYXJncyxcbiAgICAgICAgfTtcbiAgICAgICAgcGFja2V0Lm9wdGlvbnMgPSB7fTtcbiAgICAgICAgcGFja2V0Lm9wdGlvbnMuY29tcHJlc3MgPSB0aGlzLmZsYWdzLmNvbXByZXNzICE9PSBmYWxzZTtcbiAgICAgICAgLy8gZXZlbnQgYWNrIGNhbGxiYWNrXG4gICAgICAgIGlmIChcImZ1bmN0aW9uXCIgPT09IHR5cGVvZiBhcmdzW2FyZ3MubGVuZ3RoIC0gMV0pIHtcbiAgICAgICAgICAgIGNvbnN0IGlkID0gdGhpcy5pZHMrKztcbiAgICAgICAgICAgIGNvbnN0IGFjayA9IGFyZ3MucG9wKCk7XG4gICAgICAgICAgICB0aGlzLl9yZWdpc3RlckFja0NhbGxiYWNrKGlkLCBhY2spO1xuICAgICAgICAgICAgcGFja2V0LmlkID0gaWQ7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaXNUcmFuc3BvcnRXcml0YWJsZSA9IChfYiA9IChfYSA9IHRoaXMuaW8uZW5naW5lKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EudHJhbnNwb3J0KSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Iud3JpdGFibGU7XG4gICAgICAgIGNvbnN0IGlzQ29ubmVjdGVkID0gdGhpcy5jb25uZWN0ZWQgJiYgISgoX2MgPSB0aGlzLmlvLmVuZ2luZSkgPT09IG51bGwgfHwgX2MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jLl9oYXNQaW5nRXhwaXJlZCgpKTtcbiAgICAgICAgY29uc3QgZGlzY2FyZFBhY2tldCA9IHRoaXMuZmxhZ3Mudm9sYXRpbGUgJiYgIWlzVHJhbnNwb3J0V3JpdGFibGU7XG4gICAgICAgIGlmIChkaXNjYXJkUGFja2V0KSB7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoaXNDb25uZWN0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMubm90aWZ5T3V0Z29pbmdMaXN0ZW5lcnMocGFja2V0KTtcbiAgICAgICAgICAgIHRoaXMucGFja2V0KHBhY2tldCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNlbmRCdWZmZXIucHVzaChwYWNrZXQpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZmxhZ3MgPSB7fTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3JlZ2lzdGVyQWNrQ2FsbGJhY2soaWQsIGFjaykge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGNvbnN0IHRpbWVvdXQgPSAoX2EgPSB0aGlzLmZsYWdzLnRpbWVvdXQpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IHRoaXMuX29wdHMuYWNrVGltZW91dDtcbiAgICAgICAgaWYgKHRpbWVvdXQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5hY2tzW2lkXSA9IGFjaztcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGNvbnN0IHRpbWVyID0gdGhpcy5pby5zZXRUaW1lb3V0Rm4oKCkgPT4ge1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMuYWNrc1tpZF07XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuc2VuZEJ1ZmZlci5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNlbmRCdWZmZXJbaV0uaWQgPT09IGlkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VuZEJ1ZmZlci5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYWNrLmNhbGwodGhpcywgbmV3IEVycm9yKFwib3BlcmF0aW9uIGhhcyB0aW1lZCBvdXRcIikpO1xuICAgICAgICB9LCB0aW1lb3V0KTtcbiAgICAgICAgY29uc3QgZm4gPSAoLi4uYXJncykgPT4ge1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgdGhpcy5pby5jbGVhclRpbWVvdXRGbih0aW1lcik7XG4gICAgICAgICAgICBhY2suYXBwbHkodGhpcywgYXJncyk7XG4gICAgICAgIH07XG4gICAgICAgIGZuLndpdGhFcnJvciA9IHRydWU7XG4gICAgICAgIHRoaXMuYWNrc1tpZF0gPSBmbjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRW1pdHMgYW4gZXZlbnQgYW5kIHdhaXRzIGZvciBhbiBhY2tub3dsZWRnZW1lbnRcbiAgICAgKlxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gd2l0aG91dCB0aW1lb3V0XG4gICAgICogY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBzb2NrZXQuZW1pdFdpdGhBY2soXCJoZWxsb1wiLCBcIndvcmxkXCIpO1xuICAgICAqXG4gICAgICogLy8gd2l0aCBhIHNwZWNpZmljIHRpbWVvdXRcbiAgICAgKiB0cnkge1xuICAgICAqICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBzb2NrZXQudGltZW91dCgxMDAwKS5lbWl0V2l0aEFjayhcImhlbGxvXCIsIFwid29ybGRcIik7XG4gICAgICogfSBjYXRjaCAoZXJyKSB7XG4gICAgICogICAvLyB0aGUgc2VydmVyIGRpZCBub3QgYWNrbm93bGVkZ2UgdGhlIGV2ZW50IGluIHRoZSBnaXZlbiBkZWxheVxuICAgICAqIH1cbiAgICAgKlxuICAgICAqIEByZXR1cm4gYSBQcm9taXNlIHRoYXQgd2lsbCBiZSBmdWxmaWxsZWQgd2hlbiB0aGUgc2VydmVyIGFja25vd2xlZGdlcyB0aGUgZXZlbnRcbiAgICAgKi9cbiAgICBlbWl0V2l0aEFjayhldiwgLi4uYXJncykge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZm4gPSAoYXJnMSwgYXJnMikgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiBhcmcxID8gcmVqZWN0KGFyZzEpIDogcmVzb2x2ZShhcmcyKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBmbi53aXRoRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgYXJncy5wdXNoKGZuKTtcbiAgICAgICAgICAgIHRoaXMuZW1pdChldiwgLi4uYXJncyk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGQgdGhlIHBhY2tldCB0byB0aGUgcXVldWUuXG4gICAgICogQHBhcmFtIGFyZ3NcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9hZGRUb1F1ZXVlKGFyZ3MpIHtcbiAgICAgICAgbGV0IGFjaztcbiAgICAgICAgaWYgKHR5cGVvZiBhcmdzW2FyZ3MubGVuZ3RoIC0gMV0gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgYWNrID0gYXJncy5wb3AoKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBwYWNrZXQgPSB7XG4gICAgICAgICAgICBpZDogdGhpcy5fcXVldWVTZXErKyxcbiAgICAgICAgICAgIHRyeUNvdW50OiAwLFxuICAgICAgICAgICAgcGVuZGluZzogZmFsc2UsXG4gICAgICAgICAgICBhcmdzLFxuICAgICAgICAgICAgZmxhZ3M6IE9iamVjdC5hc3NpZ24oeyBmcm9tUXVldWU6IHRydWUgfSwgdGhpcy5mbGFncyksXG4gICAgICAgIH07XG4gICAgICAgIGFyZ3MucHVzaCgoZXJyLCAuLi5yZXNwb25zZUFyZ3MpID0+IHtcbiAgICAgICAgICAgIGlmIChwYWNrZXQgIT09IHRoaXMuX3F1ZXVlWzBdKSB7XG4gICAgICAgICAgICAgICAgLy8gdGhlIHBhY2tldCBoYXMgYWxyZWFkeSBiZWVuIGFja25vd2xlZGdlZFxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGhhc0Vycm9yID0gZXJyICE9PSBudWxsO1xuICAgICAgICAgICAgaWYgKGhhc0Vycm9yKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBhY2tldC50cnlDb3VudCA+IHRoaXMuX29wdHMucmV0cmllcykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9xdWV1ZS5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYWNrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY2soZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX3F1ZXVlLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgaWYgKGFjaykge1xuICAgICAgICAgICAgICAgICAgICBhY2sobnVsbCwgLi4ucmVzcG9uc2VBcmdzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwYWNrZXQucGVuZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2RyYWluUXVldWUoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX3F1ZXVlLnB1c2gocGFja2V0KTtcbiAgICAgICAgdGhpcy5fZHJhaW5RdWV1ZSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZW5kIHRoZSBmaXJzdCBwYWNrZXQgb2YgdGhlIHF1ZXVlLCBhbmQgd2FpdCBmb3IgYW4gYWNrbm93bGVkZ2VtZW50IGZyb20gdGhlIHNlcnZlci5cbiAgICAgKiBAcGFyYW0gZm9yY2UgLSB3aGV0aGVyIHRvIHJlc2VuZCBhIHBhY2tldCB0aGF0IGhhcyBub3QgYmVlbiBhY2tub3dsZWRnZWQgeWV0XG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9kcmFpblF1ZXVlKGZvcmNlID0gZmFsc2UpIHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbm5lY3RlZCB8fCB0aGlzLl9xdWV1ZS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBwYWNrZXQgPSB0aGlzLl9xdWV1ZVswXTtcbiAgICAgICAgaWYgKHBhY2tldC5wZW5kaW5nICYmICFmb3JjZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHBhY2tldC5wZW5kaW5nID0gdHJ1ZTtcbiAgICAgICAgcGFja2V0LnRyeUNvdW50Kys7XG4gICAgICAgIHRoaXMuZmxhZ3MgPSBwYWNrZXQuZmxhZ3M7XG4gICAgICAgIHRoaXMuZW1pdC5hcHBseSh0aGlzLCBwYWNrZXQuYXJncyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlbmRzIGEgcGFja2V0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhY2tldFxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgcGFja2V0KHBhY2tldCkge1xuICAgICAgICBwYWNrZXQubnNwID0gdGhpcy5uc3A7XG4gICAgICAgIHRoaXMuaW8uX3BhY2tldChwYWNrZXQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgdXBvbiBlbmdpbmUgYG9wZW5gLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBvbm9wZW4oKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5hdXRoID09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgdGhpcy5hdXRoKChkYXRhKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc2VuZENvbm5lY3RQYWNrZXQoZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX3NlbmRDb25uZWN0UGFja2V0KHRoaXMuYXV0aCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VuZHMgYSBDT05ORUNUIHBhY2tldCB0byBpbml0aWF0ZSB0aGUgU29ja2V0LklPIHNlc3Npb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZGF0YVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3NlbmRDb25uZWN0UGFja2V0KGRhdGEpIHtcbiAgICAgICAgdGhpcy5wYWNrZXQoe1xuICAgICAgICAgICAgdHlwZTogUGFja2V0VHlwZS5DT05ORUNULFxuICAgICAgICAgICAgZGF0YTogdGhpcy5fcGlkXG4gICAgICAgICAgICAgICAgPyBPYmplY3QuYXNzaWduKHsgcGlkOiB0aGlzLl9waWQsIG9mZnNldDogdGhpcy5fbGFzdE9mZnNldCB9LCBkYXRhKVxuICAgICAgICAgICAgICAgIDogZGF0YSxcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxlZCB1cG9uIGVuZ2luZSBvciBtYW5hZ2VyIGBlcnJvcmAuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZXJyXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBvbmVycm9yKGVycikge1xuICAgICAgICBpZiAoIXRoaXMuY29ubmVjdGVkKSB7XG4gICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcImNvbm5lY3RfZXJyb3JcIiwgZXJyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgdXBvbiBlbmdpbmUgYGNsb3NlYC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSByZWFzb25cbiAgICAgKiBAcGFyYW0gZGVzY3JpcHRpb25cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIG9uY2xvc2UocmVhc29uLCBkZXNjcmlwdGlvbikge1xuICAgICAgICB0aGlzLmNvbm5lY3RlZCA9IGZhbHNlO1xuICAgICAgICBkZWxldGUgdGhpcy5pZDtcbiAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJkaXNjb25uZWN0XCIsIHJlYXNvbiwgZGVzY3JpcHRpb24pO1xuICAgICAgICB0aGlzLl9jbGVhckFja3MoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2xlYXJzIHRoZSBhY2tub3dsZWRnZW1lbnQgaGFuZGxlcnMgdXBvbiBkaXNjb25uZWN0aW9uLCBzaW5jZSB0aGUgY2xpZW50IHdpbGwgbmV2ZXIgcmVjZWl2ZSBhbiBhY2tub3dsZWRnZW1lbnQgZnJvbVxuICAgICAqIHRoZSBzZXJ2ZXIuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9jbGVhckFja3MoKSB7XG4gICAgICAgIE9iamVjdC5rZXlzKHRoaXMuYWNrcykuZm9yRWFjaCgoaWQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGlzQnVmZmVyZWQgPSB0aGlzLnNlbmRCdWZmZXIuc29tZSgocGFja2V0KSA9PiBTdHJpbmcocGFja2V0LmlkKSA9PT0gaWQpO1xuICAgICAgICAgICAgaWYgKCFpc0J1ZmZlcmVkKSB7XG4gICAgICAgICAgICAgICAgLy8gbm90ZTogaGFuZGxlcnMgdGhhdCBkbyBub3QgYWNjZXB0IGFuIGVycm9yIGFzIGZpcnN0IGFyZ3VtZW50IGFyZSBpZ25vcmVkIGhlcmVcbiAgICAgICAgICAgICAgICBjb25zdCBhY2sgPSB0aGlzLmFja3NbaWRdO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmFja3NbaWRdO1xuICAgICAgICAgICAgICAgIGlmIChhY2sud2l0aEVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjay5jYWxsKHRoaXMsIG5ldyBFcnJvcihcInNvY2tldCBoYXMgYmVlbiBkaXNjb25uZWN0ZWRcIikpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxlZCB3aXRoIHNvY2tldCBwYWNrZXQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFja2V0XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBvbnBhY2tldChwYWNrZXQpIHtcbiAgICAgICAgY29uc3Qgc2FtZU5hbWVzcGFjZSA9IHBhY2tldC5uc3AgPT09IHRoaXMubnNwO1xuICAgICAgICBpZiAoIXNhbWVOYW1lc3BhY2UpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHN3aXRjaCAocGFja2V0LnR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgUGFja2V0VHlwZS5DT05ORUNUOlxuICAgICAgICAgICAgICAgIGlmIChwYWNrZXQuZGF0YSAmJiBwYWNrZXQuZGF0YS5zaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbmNvbm5lY3QocGFja2V0LmRhdGEuc2lkLCBwYWNrZXQuZGF0YS5waWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJjb25uZWN0X2Vycm9yXCIsIG5ldyBFcnJvcihcIkl0IHNlZW1zIHlvdSBhcmUgdHJ5aW5nIHRvIHJlYWNoIGEgU29ja2V0LklPIHNlcnZlciBpbiB2Mi54IHdpdGggYSB2My54IGNsaWVudCwgYnV0IHRoZXkgYXJlIG5vdCBjb21wYXRpYmxlIChtb3JlIGluZm9ybWF0aW9uIGhlcmU6IGh0dHBzOi8vc29ja2V0LmlvL2RvY3MvdjMvbWlncmF0aW5nLWZyb20tMi14LXRvLTMtMC8pXCIpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFBhY2tldFR5cGUuRVZFTlQ6XG4gICAgICAgICAgICBjYXNlIFBhY2tldFR5cGUuQklOQVJZX0VWRU5UOlxuICAgICAgICAgICAgICAgIHRoaXMub25ldmVudChwYWNrZXQpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBQYWNrZXRUeXBlLkFDSzpcbiAgICAgICAgICAgIGNhc2UgUGFja2V0VHlwZS5CSU5BUllfQUNLOlxuICAgICAgICAgICAgICAgIHRoaXMub25hY2socGFja2V0KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgUGFja2V0VHlwZS5ESVNDT05ORUNUOlxuICAgICAgICAgICAgICAgIHRoaXMub25kaXNjb25uZWN0KCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFBhY2tldFR5cGUuQ09OTkVDVF9FUlJPUjpcbiAgICAgICAgICAgICAgICB0aGlzLmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICBjb25zdCBlcnIgPSBuZXcgRXJyb3IocGFja2V0LmRhdGEubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgIGVyci5kYXRhID0gcGFja2V0LmRhdGEuZGF0YTtcbiAgICAgICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcImNvbm5lY3RfZXJyb3JcIiwgZXJyKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgdXBvbiBhIHNlcnZlciBldmVudC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYWNrZXRcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIG9uZXZlbnQocGFja2V0KSB7XG4gICAgICAgIGNvbnN0IGFyZ3MgPSBwYWNrZXQuZGF0YSB8fCBbXTtcbiAgICAgICAgaWYgKG51bGwgIT0gcGFja2V0LmlkKSB7XG4gICAgICAgICAgICBhcmdzLnB1c2godGhpcy5hY2socGFja2V0LmlkKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuY29ubmVjdGVkKSB7XG4gICAgICAgICAgICB0aGlzLmVtaXRFdmVudChhcmdzKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucmVjZWl2ZUJ1ZmZlci5wdXNoKE9iamVjdC5mcmVlemUoYXJncykpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVtaXRFdmVudChhcmdzKSB7XG4gICAgICAgIGlmICh0aGlzLl9hbnlMaXN0ZW5lcnMgJiYgdGhpcy5fYW55TGlzdGVuZXJzLmxlbmd0aCkge1xuICAgICAgICAgICAgY29uc3QgbGlzdGVuZXJzID0gdGhpcy5fYW55TGlzdGVuZXJzLnNsaWNlKCk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGxpc3RlbmVyIG9mIGxpc3RlbmVycykge1xuICAgICAgICAgICAgICAgIGxpc3RlbmVyLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHN1cGVyLmVtaXQuYXBwbHkodGhpcywgYXJncyk7XG4gICAgICAgIGlmICh0aGlzLl9waWQgJiYgYXJncy5sZW5ndGggJiYgdHlwZW9mIGFyZ3NbYXJncy5sZW5ndGggLSAxXSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgdGhpcy5fbGFzdE9mZnNldCA9IGFyZ3NbYXJncy5sZW5ndGggLSAxXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBQcm9kdWNlcyBhbiBhY2sgY2FsbGJhY2sgdG8gZW1pdCB3aXRoIGFuIGV2ZW50LlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBhY2soaWQpIHtcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG4gICAgICAgIGxldCBzZW50ID0gZmFsc2U7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoLi4uYXJncykge1xuICAgICAgICAgICAgLy8gcHJldmVudCBkb3VibGUgY2FsbGJhY2tzXG4gICAgICAgICAgICBpZiAoc2VudClcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICBzZW50ID0gdHJ1ZTtcbiAgICAgICAgICAgIHNlbGYucGFja2V0KHtcbiAgICAgICAgICAgICAgICB0eXBlOiBQYWNrZXRUeXBlLkFDSyxcbiAgICAgICAgICAgICAgICBpZDogaWQsXG4gICAgICAgICAgICAgICAgZGF0YTogYXJncyxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgdXBvbiBhIHNlcnZlciBhY2tub3dsZWRnZW1lbnQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFja2V0XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBvbmFjayhwYWNrZXQpIHtcbiAgICAgICAgY29uc3QgYWNrID0gdGhpcy5hY2tzW3BhY2tldC5pZF07XG4gICAgICAgIGlmICh0eXBlb2YgYWNrICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBkZWxldGUgdGhpcy5hY2tzW3BhY2tldC5pZF07XG4gICAgICAgIC8vIEB0cy1pZ25vcmUgRklYTUUgYWNrIGlzIGluY29ycmVjdGx5IGluZmVycmVkIGFzICduZXZlcidcbiAgICAgICAgaWYgKGFjay53aXRoRXJyb3IpIHtcbiAgICAgICAgICAgIHBhY2tldC5kYXRhLnVuc2hpZnQobnVsbCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICBhY2suYXBwbHkodGhpcywgcGFja2V0LmRhdGEpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgdXBvbiBzZXJ2ZXIgY29ubmVjdC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgb25jb25uZWN0KGlkLCBwaWQpIHtcbiAgICAgICAgdGhpcy5pZCA9IGlkO1xuICAgICAgICB0aGlzLnJlY292ZXJlZCA9IHBpZCAmJiB0aGlzLl9waWQgPT09IHBpZDtcbiAgICAgICAgdGhpcy5fcGlkID0gcGlkOyAvLyBkZWZpbmVkIG9ubHkgaWYgY29ubmVjdGlvbiBzdGF0ZSByZWNvdmVyeSBpcyBlbmFibGVkXG4gICAgICAgIHRoaXMuY29ubmVjdGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5lbWl0QnVmZmVyZWQoKTtcbiAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJjb25uZWN0XCIpO1xuICAgICAgICB0aGlzLl9kcmFpblF1ZXVlKHRydWUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBFbWl0IGJ1ZmZlcmVkIGV2ZW50cyAocmVjZWl2ZWQgYW5kIGVtaXR0ZWQpLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBlbWl0QnVmZmVyZWQoKSB7XG4gICAgICAgIHRoaXMucmVjZWl2ZUJ1ZmZlci5mb3JFYWNoKChhcmdzKSA9PiB0aGlzLmVtaXRFdmVudChhcmdzKSk7XG4gICAgICAgIHRoaXMucmVjZWl2ZUJ1ZmZlciA9IFtdO1xuICAgICAgICB0aGlzLnNlbmRCdWZmZXIuZm9yRWFjaCgocGFja2V0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLm5vdGlmeU91dGdvaW5nTGlzdGVuZXJzKHBhY2tldCk7XG4gICAgICAgICAgICB0aGlzLnBhY2tldChwYWNrZXQpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zZW5kQnVmZmVyID0gW107XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxlZCB1cG9uIHNlcnZlciBkaXNjb25uZWN0LlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBvbmRpc2Nvbm5lY3QoKSB7XG4gICAgICAgIHRoaXMuZGVzdHJveSgpO1xuICAgICAgICB0aGlzLm9uY2xvc2UoXCJpbyBzZXJ2ZXIgZGlzY29ubmVjdFwiKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHVwb24gZm9yY2VkIGNsaWVudC9zZXJ2ZXIgc2lkZSBkaXNjb25uZWN0aW9ucyxcbiAgICAgKiB0aGlzIG1ldGhvZCBlbnN1cmVzIHRoZSBtYW5hZ2VyIHN0b3BzIHRyYWNraW5nIHVzIGFuZFxuICAgICAqIHRoYXQgcmVjb25uZWN0aW9ucyBkb24ndCBnZXQgdHJpZ2dlcmVkIGZvciB0aGlzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBkZXN0cm95KCkge1xuICAgICAgICBpZiAodGhpcy5zdWJzKSB7XG4gICAgICAgICAgICAvLyBjbGVhbiBzdWJzY3JpcHRpb25zIHRvIGF2b2lkIHJlY29ubmVjdGlvbnNcbiAgICAgICAgICAgIHRoaXMuc3Vicy5mb3JFYWNoKChzdWJEZXN0cm95KSA9PiBzdWJEZXN0cm95KCkpO1xuICAgICAgICAgICAgdGhpcy5zdWJzID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaW9bXCJfZGVzdHJveVwiXSh0aGlzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRGlzY29ubmVjdHMgdGhlIHNvY2tldCBtYW51YWxseS4gSW4gdGhhdCBjYXNlLCB0aGUgc29ja2V0IHdpbGwgbm90IHRyeSB0byByZWNvbm5lY3QuXG4gICAgICpcbiAgICAgKiBJZiB0aGlzIGlzIHRoZSBsYXN0IGFjdGl2ZSBTb2NrZXQgaW5zdGFuY2Ugb2YgdGhlIHtAbGluayBNYW5hZ2VyfSwgdGhlIGxvdy1sZXZlbCBjb25uZWN0aW9uIHdpbGwgYmUgY2xvc2VkLlxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBjb25zdCBzb2NrZXQgPSBpbygpO1xuICAgICAqXG4gICAgICogc29ja2V0Lm9uKFwiZGlzY29ubmVjdFwiLCAocmVhc29uKSA9PiB7XG4gICAgICogICAvLyBjb25zb2xlLmxvZyhyZWFzb24pOyBwcmludHMgXCJpbyBjbGllbnQgZGlzY29ubmVjdFwiXG4gICAgICogfSk7XG4gICAgICpcbiAgICAgKiBzb2NrZXQuZGlzY29ubmVjdCgpO1xuICAgICAqXG4gICAgICogQHJldHVybiBzZWxmXG4gICAgICovXG4gICAgZGlzY29ubmVjdCgpIHtcbiAgICAgICAgaWYgKHRoaXMuY29ubmVjdGVkKSB7XG4gICAgICAgICAgICB0aGlzLnBhY2tldCh7IHR5cGU6IFBhY2tldFR5cGUuRElTQ09OTkVDVCB9KTtcbiAgICAgICAgfVxuICAgICAgICAvLyByZW1vdmUgc29ja2V0IGZyb20gcG9vbFxuICAgICAgICB0aGlzLmRlc3Ryb3koKTtcbiAgICAgICAgaWYgKHRoaXMuY29ubmVjdGVkKSB7XG4gICAgICAgICAgICAvLyBmaXJlIGV2ZW50c1xuICAgICAgICAgICAgdGhpcy5vbmNsb3NlKFwiaW8gY2xpZW50IGRpc2Nvbm5lY3RcIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFsaWFzIGZvciB7QGxpbmsgZGlzY29ubmVjdCgpfS5cbiAgICAgKlxuICAgICAqIEByZXR1cm4gc2VsZlxuICAgICAqL1xuICAgIGNsb3NlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kaXNjb25uZWN0KCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIGNvbXByZXNzIGZsYWcuXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIHNvY2tldC5jb21wcmVzcyhmYWxzZSkuZW1pdChcImhlbGxvXCIpO1xuICAgICAqXG4gICAgICogQHBhcmFtIGNvbXByZXNzIC0gaWYgYHRydWVgLCBjb21wcmVzc2VzIHRoZSBzZW5kaW5nIGRhdGFcbiAgICAgKiBAcmV0dXJuIHNlbGZcbiAgICAgKi9cbiAgICBjb21wcmVzcyhjb21wcmVzcykge1xuICAgICAgICB0aGlzLmZsYWdzLmNvbXByZXNzID0gY29tcHJlc3M7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXRzIGEgbW9kaWZpZXIgZm9yIGEgc3Vic2VxdWVudCBldmVudCBlbWlzc2lvbiB0aGF0IHRoZSBldmVudCBtZXNzYWdlIHdpbGwgYmUgZHJvcHBlZCB3aGVuIHRoaXMgc29ja2V0IGlzIG5vdFxuICAgICAqIHJlYWR5IHRvIHNlbmQgbWVzc2FnZXMuXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIHNvY2tldC52b2xhdGlsZS5lbWl0KFwiaGVsbG9cIik7IC8vIHRoZSBzZXJ2ZXIgbWF5IG9yIG1heSBub3QgcmVjZWl2ZSBpdFxuICAgICAqXG4gICAgICogQHJldHVybnMgc2VsZlxuICAgICAqL1xuICAgIGdldCB2b2xhdGlsZSgpIHtcbiAgICAgICAgdGhpcy5mbGFncy52b2xhdGlsZSA9IHRydWU7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXRzIGEgbW9kaWZpZXIgZm9yIGEgc3Vic2VxdWVudCBldmVudCBlbWlzc2lvbiB0aGF0IHRoZSBjYWxsYmFjayB3aWxsIGJlIGNhbGxlZCB3aXRoIGFuIGVycm9yIHdoZW4gdGhlXG4gICAgICogZ2l2ZW4gbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyBoYXZlIGVsYXBzZWQgd2l0aG91dCBhbiBhY2tub3dsZWRnZW1lbnQgZnJvbSB0aGUgc2VydmVyOlxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBzb2NrZXQudGltZW91dCg1MDAwKS5lbWl0KFwibXktZXZlbnRcIiwgKGVycikgPT4ge1xuICAgICAqICAgaWYgKGVycikge1xuICAgICAqICAgICAvLyB0aGUgc2VydmVyIGRpZCBub3QgYWNrbm93bGVkZ2UgdGhlIGV2ZW50IGluIHRoZSBnaXZlbiBkZWxheVxuICAgICAqICAgfVxuICAgICAqIH0pO1xuICAgICAqXG4gICAgICogQHJldHVybnMgc2VsZlxuICAgICAqL1xuICAgIHRpbWVvdXQodGltZW91dCkge1xuICAgICAgICB0aGlzLmZsYWdzLnRpbWVvdXQgPSB0aW1lb3V0O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyBhIGxpc3RlbmVyIHRoYXQgd2lsbCBiZSBmaXJlZCB3aGVuIGFueSBldmVudCBpcyBlbWl0dGVkLiBUaGUgZXZlbnQgbmFtZSBpcyBwYXNzZWQgYXMgdGhlIGZpcnN0IGFyZ3VtZW50IHRvIHRoZVxuICAgICAqIGNhbGxiYWNrLlxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBzb2NrZXQub25BbnkoKGV2ZW50LCAuLi5hcmdzKSA9PiB7XG4gICAgICogICBjb25zb2xlLmxvZyhgZ290ICR7ZXZlbnR9YCk7XG4gICAgICogfSk7XG4gICAgICpcbiAgICAgKiBAcGFyYW0gbGlzdGVuZXJcbiAgICAgKi9cbiAgICBvbkFueShsaXN0ZW5lcikge1xuICAgICAgICB0aGlzLl9hbnlMaXN0ZW5lcnMgPSB0aGlzLl9hbnlMaXN0ZW5lcnMgfHwgW107XG4gICAgICAgIHRoaXMuX2FueUxpc3RlbmVycy5wdXNoKGxpc3RlbmVyKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZHMgYSBsaXN0ZW5lciB0aGF0IHdpbGwgYmUgZmlyZWQgd2hlbiBhbnkgZXZlbnQgaXMgZW1pdHRlZC4gVGhlIGV2ZW50IG5hbWUgaXMgcGFzc2VkIGFzIHRoZSBmaXJzdCBhcmd1bWVudCB0byB0aGVcbiAgICAgKiBjYWxsYmFjay4gVGhlIGxpc3RlbmVyIGlzIGFkZGVkIHRvIHRoZSBiZWdpbm5pbmcgb2YgdGhlIGxpc3RlbmVycyBhcnJheS5cbiAgICAgKlxuICAgICAqIEBleGFtcGxlXG4gICAgICogc29ja2V0LnByZXBlbmRBbnkoKGV2ZW50LCAuLi5hcmdzKSA9PiB7XG4gICAgICogICBjb25zb2xlLmxvZyhgZ290IGV2ZW50ICR7ZXZlbnR9YCk7XG4gICAgICogfSk7XG4gICAgICpcbiAgICAgKiBAcGFyYW0gbGlzdGVuZXJcbiAgICAgKi9cbiAgICBwcmVwZW5kQW55KGxpc3RlbmVyKSB7XG4gICAgICAgIHRoaXMuX2FueUxpc3RlbmVycyA9IHRoaXMuX2FueUxpc3RlbmVycyB8fCBbXTtcbiAgICAgICAgdGhpcy5fYW55TGlzdGVuZXJzLnVuc2hpZnQobGlzdGVuZXIpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyB0aGUgbGlzdGVuZXIgdGhhdCB3aWxsIGJlIGZpcmVkIHdoZW4gYW55IGV2ZW50IGlzIGVtaXR0ZWQuXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIGNvbnN0IGNhdGNoQWxsTGlzdGVuZXIgPSAoZXZlbnQsIC4uLmFyZ3MpID0+IHtcbiAgICAgKiAgIGNvbnNvbGUubG9nKGBnb3QgZXZlbnQgJHtldmVudH1gKTtcbiAgICAgKiB9XG4gICAgICpcbiAgICAgKiBzb2NrZXQub25BbnkoY2F0Y2hBbGxMaXN0ZW5lcik7XG4gICAgICpcbiAgICAgKiAvLyByZW1vdmUgYSBzcGVjaWZpYyBsaXN0ZW5lclxuICAgICAqIHNvY2tldC5vZmZBbnkoY2F0Y2hBbGxMaXN0ZW5lcik7XG4gICAgICpcbiAgICAgKiAvLyBvciByZW1vdmUgYWxsIGxpc3RlbmVyc1xuICAgICAqIHNvY2tldC5vZmZBbnkoKTtcbiAgICAgKlxuICAgICAqIEBwYXJhbSBsaXN0ZW5lclxuICAgICAqL1xuICAgIG9mZkFueShsaXN0ZW5lcikge1xuICAgICAgICBpZiAoIXRoaXMuX2FueUxpc3RlbmVycykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxpc3RlbmVyKSB7XG4gICAgICAgICAgICBjb25zdCBsaXN0ZW5lcnMgPSB0aGlzLl9hbnlMaXN0ZW5lcnM7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3RlbmVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChsaXN0ZW5lciA9PT0gbGlzdGVuZXJzW2ldKSB7XG4gICAgICAgICAgICAgICAgICAgIGxpc3RlbmVycy5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2FueUxpc3RlbmVycyA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGFuIGFycmF5IG9mIGxpc3RlbmVycyB0aGF0IGFyZSBsaXN0ZW5pbmcgZm9yIGFueSBldmVudCB0aGF0IGlzIHNwZWNpZmllZC4gVGhpcyBhcnJheSBjYW4gYmUgbWFuaXB1bGF0ZWQsXG4gICAgICogZS5nLiB0byByZW1vdmUgbGlzdGVuZXJzLlxuICAgICAqL1xuICAgIGxpc3RlbmVyc0FueSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FueUxpc3RlbmVycyB8fCBbXTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyBhIGxpc3RlbmVyIHRoYXQgd2lsbCBiZSBmaXJlZCB3aGVuIGFueSBldmVudCBpcyBlbWl0dGVkLiBUaGUgZXZlbnQgbmFtZSBpcyBwYXNzZWQgYXMgdGhlIGZpcnN0IGFyZ3VtZW50IHRvIHRoZVxuICAgICAqIGNhbGxiYWNrLlxuICAgICAqXG4gICAgICogTm90ZTogYWNrbm93bGVkZ2VtZW50cyBzZW50IHRvIHRoZSBzZXJ2ZXIgYXJlIG5vdCBpbmNsdWRlZC5cbiAgICAgKlxuICAgICAqIEBleGFtcGxlXG4gICAgICogc29ja2V0Lm9uQW55T3V0Z29pbmcoKGV2ZW50LCAuLi5hcmdzKSA9PiB7XG4gICAgICogICBjb25zb2xlLmxvZyhgc2VudCBldmVudCAke2V2ZW50fWApO1xuICAgICAqIH0pO1xuICAgICAqXG4gICAgICogQHBhcmFtIGxpc3RlbmVyXG4gICAgICovXG4gICAgb25BbnlPdXRnb2luZyhsaXN0ZW5lcikge1xuICAgICAgICB0aGlzLl9hbnlPdXRnb2luZ0xpc3RlbmVycyA9IHRoaXMuX2FueU91dGdvaW5nTGlzdGVuZXJzIHx8IFtdO1xuICAgICAgICB0aGlzLl9hbnlPdXRnb2luZ0xpc3RlbmVycy5wdXNoKGxpc3RlbmVyKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZHMgYSBsaXN0ZW5lciB0aGF0IHdpbGwgYmUgZmlyZWQgd2hlbiBhbnkgZXZlbnQgaXMgZW1pdHRlZC4gVGhlIGV2ZW50IG5hbWUgaXMgcGFzc2VkIGFzIHRoZSBmaXJzdCBhcmd1bWVudCB0byB0aGVcbiAgICAgKiBjYWxsYmFjay4gVGhlIGxpc3RlbmVyIGlzIGFkZGVkIHRvIHRoZSBiZWdpbm5pbmcgb2YgdGhlIGxpc3RlbmVycyBhcnJheS5cbiAgICAgKlxuICAgICAqIE5vdGU6IGFja25vd2xlZGdlbWVudHMgc2VudCB0byB0aGUgc2VydmVyIGFyZSBub3QgaW5jbHVkZWQuXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIHNvY2tldC5wcmVwZW5kQW55T3V0Z29pbmcoKGV2ZW50LCAuLi5hcmdzKSA9PiB7XG4gICAgICogICBjb25zb2xlLmxvZyhgc2VudCBldmVudCAke2V2ZW50fWApO1xuICAgICAqIH0pO1xuICAgICAqXG4gICAgICogQHBhcmFtIGxpc3RlbmVyXG4gICAgICovXG4gICAgcHJlcGVuZEFueU91dGdvaW5nKGxpc3RlbmVyKSB7XG4gICAgICAgIHRoaXMuX2FueU91dGdvaW5nTGlzdGVuZXJzID0gdGhpcy5fYW55T3V0Z29pbmdMaXN0ZW5lcnMgfHwgW107XG4gICAgICAgIHRoaXMuX2FueU91dGdvaW5nTGlzdGVuZXJzLnVuc2hpZnQobGlzdGVuZXIpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyB0aGUgbGlzdGVuZXIgdGhhdCB3aWxsIGJlIGZpcmVkIHdoZW4gYW55IGV2ZW50IGlzIGVtaXR0ZWQuXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIGNvbnN0IGNhdGNoQWxsTGlzdGVuZXIgPSAoZXZlbnQsIC4uLmFyZ3MpID0+IHtcbiAgICAgKiAgIGNvbnNvbGUubG9nKGBzZW50IGV2ZW50ICR7ZXZlbnR9YCk7XG4gICAgICogfVxuICAgICAqXG4gICAgICogc29ja2V0Lm9uQW55T3V0Z29pbmcoY2F0Y2hBbGxMaXN0ZW5lcik7XG4gICAgICpcbiAgICAgKiAvLyByZW1vdmUgYSBzcGVjaWZpYyBsaXN0ZW5lclxuICAgICAqIHNvY2tldC5vZmZBbnlPdXRnb2luZyhjYXRjaEFsbExpc3RlbmVyKTtcbiAgICAgKlxuICAgICAqIC8vIG9yIHJlbW92ZSBhbGwgbGlzdGVuZXJzXG4gICAgICogc29ja2V0Lm9mZkFueU91dGdvaW5nKCk7XG4gICAgICpcbiAgICAgKiBAcGFyYW0gW2xpc3RlbmVyXSAtIHRoZSBjYXRjaC1hbGwgbGlzdGVuZXIgKG9wdGlvbmFsKVxuICAgICAqL1xuICAgIG9mZkFueU91dGdvaW5nKGxpc3RlbmVyKSB7XG4gICAgICAgIGlmICghdGhpcy5fYW55T3V0Z29pbmdMaXN0ZW5lcnMpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChsaXN0ZW5lcikge1xuICAgICAgICAgICAgY29uc3QgbGlzdGVuZXJzID0gdGhpcy5fYW55T3V0Z29pbmdMaXN0ZW5lcnM7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3RlbmVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChsaXN0ZW5lciA9PT0gbGlzdGVuZXJzW2ldKSB7XG4gICAgICAgICAgICAgICAgICAgIGxpc3RlbmVycy5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2FueU91dGdvaW5nTGlzdGVuZXJzID0gW107XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYW4gYXJyYXkgb2YgbGlzdGVuZXJzIHRoYXQgYXJlIGxpc3RlbmluZyBmb3IgYW55IGV2ZW50IHRoYXQgaXMgc3BlY2lmaWVkLiBUaGlzIGFycmF5IGNhbiBiZSBtYW5pcHVsYXRlZCxcbiAgICAgKiBlLmcuIHRvIHJlbW92ZSBsaXN0ZW5lcnMuXG4gICAgICovXG4gICAgbGlzdGVuZXJzQW55T3V0Z29pbmcoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hbnlPdXRnb2luZ0xpc3RlbmVycyB8fCBbXTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogTm90aWZ5IHRoZSBsaXN0ZW5lcnMgZm9yIGVhY2ggcGFja2V0IHNlbnRcbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYWNrZXRcbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgbm90aWZ5T3V0Z29pbmdMaXN0ZW5lcnMocGFja2V0KSB7XG4gICAgICAgIGlmICh0aGlzLl9hbnlPdXRnb2luZ0xpc3RlbmVycyAmJiB0aGlzLl9hbnlPdXRnb2luZ0xpc3RlbmVycy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbnN0IGxpc3RlbmVycyA9IHRoaXMuX2FueU91dGdvaW5nTGlzdGVuZXJzLnNsaWNlKCk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGxpc3RlbmVyIG9mIGxpc3RlbmVycykge1xuICAgICAgICAgICAgICAgIGxpc3RlbmVyLmFwcGx5KHRoaXMsIHBhY2tldC5kYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/socket.js\n\n}')},"./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/url.js":
/*!**************************************************************************************************!*\
  !*** ./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/url.js ***!
  \**************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   url: () => (/* binding */ url)\n/* harmony export */ });\n/* harmony import */ var engine_io_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! engine.io-client */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/index.js");\n\n/**\n * URL parser.\n *\n * @param uri - url\n * @param path - the request path of the connection\n * @param loc - An object meant to mimic window.location.\n *        Defaults to window.location.\n * @public\n */\nfunction url(uri, path = "", loc) {\n    let obj = uri;\n    // default to window.location\n    loc = loc || (typeof location !== "undefined" && location);\n    if (null == uri)\n        uri = loc.protocol + "//" + loc.host;\n    // relative path support\n    if (typeof uri === "string") {\n        if ("/" === uri.charAt(0)) {\n            if ("/" === uri.charAt(1)) {\n                uri = loc.protocol + uri;\n            }\n            else {\n                uri = loc.host + uri;\n            }\n        }\n        if (!/^(https?|wss?):\\/\\//.test(uri)) {\n            if ("undefined" !== typeof loc) {\n                uri = loc.protocol + "//" + uri;\n            }\n            else {\n                uri = "https://" + uri;\n            }\n        }\n        // parse\n        obj = (0,engine_io_client__WEBPACK_IMPORTED_MODULE_0__.parse)(uri);\n    }\n    // make sure we treat `localhost:80` and `localhost` equally\n    if (!obj.port) {\n        if (/^(http|ws)$/.test(obj.protocol)) {\n            obj.port = "80";\n        }\n        else if (/^(http|ws)s$/.test(obj.protocol)) {\n            obj.port = "443";\n        }\n    }\n    obj.path = obj.path || "/";\n    const ipv6 = obj.host.indexOf(":") !== -1;\n    const host = ipv6 ? "[" + obj.host + "]" : obj.host;\n    // define unique id\n    obj.id = obj.protocol + "://" + host + ":" + obj.port + path;\n    // define href\n    obj.href =\n        obj.protocol +\n            "://" +\n            host +\n            (loc && loc.port === obj.port ? "" : ":" + obj.port);\n    return obj;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLWNsaWVudEA0LjguMS9ub2RlX21vZHVsZXMvc29ja2V0LmlvLWNsaWVudC9idWlsZC9lc20vdXJsLmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQXlDO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyx1REFBSztBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL3NvY2tldC5pby1jbGllbnRANC44LjEvbm9kZV9tb2R1bGVzL3NvY2tldC5pby1jbGllbnQvYnVpbGQvZXNtL3VybC5qcz85NTU2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHBhcnNlIH0gZnJvbSBcImVuZ2luZS5pby1jbGllbnRcIjtcbi8qKlxuICogVVJMIHBhcnNlci5cbiAqXG4gKiBAcGFyYW0gdXJpIC0gdXJsXG4gKiBAcGFyYW0gcGF0aCAtIHRoZSByZXF1ZXN0IHBhdGggb2YgdGhlIGNvbm5lY3Rpb25cbiAqIEBwYXJhbSBsb2MgLSBBbiBvYmplY3QgbWVhbnQgdG8gbWltaWMgd2luZG93LmxvY2F0aW9uLlxuICogICAgICAgIERlZmF1bHRzIHRvIHdpbmRvdy5sb2NhdGlvbi5cbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVybCh1cmksIHBhdGggPSBcIlwiLCBsb2MpIHtcbiAgICBsZXQgb2JqID0gdXJpO1xuICAgIC8vIGRlZmF1bHQgdG8gd2luZG93LmxvY2F0aW9uXG4gICAgbG9jID0gbG9jIHx8ICh0eXBlb2YgbG9jYXRpb24gIT09IFwidW5kZWZpbmVkXCIgJiYgbG9jYXRpb24pO1xuICAgIGlmIChudWxsID09IHVyaSlcbiAgICAgICAgdXJpID0gbG9jLnByb3RvY29sICsgXCIvL1wiICsgbG9jLmhvc3Q7XG4gICAgLy8gcmVsYXRpdmUgcGF0aCBzdXBwb3J0XG4gICAgaWYgKHR5cGVvZiB1cmkgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgaWYgKFwiL1wiID09PSB1cmkuY2hhckF0KDApKSB7XG4gICAgICAgICAgICBpZiAoXCIvXCIgPT09IHVyaS5jaGFyQXQoMSkpIHtcbiAgICAgICAgICAgICAgICB1cmkgPSBsb2MucHJvdG9jb2wgKyB1cmk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB1cmkgPSBsb2MuaG9zdCArIHVyaTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIS9eKGh0dHBzP3x3c3M/KTpcXC9cXC8vLnRlc3QodXJpKSkge1xuICAgICAgICAgICAgaWYgKFwidW5kZWZpbmVkXCIgIT09IHR5cGVvZiBsb2MpIHtcbiAgICAgICAgICAgICAgICB1cmkgPSBsb2MucHJvdG9jb2wgKyBcIi8vXCIgKyB1cmk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB1cmkgPSBcImh0dHBzOi8vXCIgKyB1cmk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gcGFyc2VcbiAgICAgICAgb2JqID0gcGFyc2UodXJpKTtcbiAgICB9XG4gICAgLy8gbWFrZSBzdXJlIHdlIHRyZWF0IGBsb2NhbGhvc3Q6ODBgIGFuZCBgbG9jYWxob3N0YCBlcXVhbGx5XG4gICAgaWYgKCFvYmoucG9ydCkge1xuICAgICAgICBpZiAoL14oaHR0cHx3cykkLy50ZXN0KG9iai5wcm90b2NvbCkpIHtcbiAgICAgICAgICAgIG9iai5wb3J0ID0gXCI4MFwiO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKC9eKGh0dHB8d3MpcyQvLnRlc3Qob2JqLnByb3RvY29sKSkge1xuICAgICAgICAgICAgb2JqLnBvcnQgPSBcIjQ0M1wiO1xuICAgICAgICB9XG4gICAgfVxuICAgIG9iai5wYXRoID0gb2JqLnBhdGggfHwgXCIvXCI7XG4gICAgY29uc3QgaXB2NiA9IG9iai5ob3N0LmluZGV4T2YoXCI6XCIpICE9PSAtMTtcbiAgICBjb25zdCBob3N0ID0gaXB2NiA/IFwiW1wiICsgb2JqLmhvc3QgKyBcIl1cIiA6IG9iai5ob3N0O1xuICAgIC8vIGRlZmluZSB1bmlxdWUgaWRcbiAgICBvYmouaWQgPSBvYmoucHJvdG9jb2wgKyBcIjovL1wiICsgaG9zdCArIFwiOlwiICsgb2JqLnBvcnQgKyBwYXRoO1xuICAgIC8vIGRlZmluZSBocmVmXG4gICAgb2JqLmhyZWYgPVxuICAgICAgICBvYmoucHJvdG9jb2wgK1xuICAgICAgICAgICAgXCI6Ly9cIiArXG4gICAgICAgICAgICBob3N0ICtcbiAgICAgICAgICAgIChsb2MgJiYgbG9jLnBvcnQgPT09IG9iai5wb3J0ID8gXCJcIiA6IFwiOlwiICsgb2JqLnBvcnQpO1xuICAgIHJldHVybiBvYmo7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/url.js\n\n}')},"./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/binary.js":
/*!*****************************************************************************************************!*\
  !*** ./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/binary.js ***!
  \*****************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   deconstructPacket: () => (/* binding */ deconstructPacket),\n/* harmony export */   reconstructPacket: () => (/* binding */ reconstructPacket)\n/* harmony export */ });\n/* harmony import */ var _is_binary_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./is-binary.js */ "./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/is-binary.js");\n\n/**\n * Replaces every Buffer | ArrayBuffer | Blob | File in packet with a numbered placeholder.\n *\n * @param {Object} packet - socket.io event packet\n * @return {Object} with deconstructed packet and list of buffers\n * @public\n */\nfunction deconstructPacket(packet) {\n    const buffers = [];\n    const packetData = packet.data;\n    const pack = packet;\n    pack.data = _deconstructPacket(packetData, buffers);\n    pack.attachments = buffers.length; // number of binary \'attachments\'\n    return { packet: pack, buffers: buffers };\n}\nfunction _deconstructPacket(data, buffers) {\n    if (!data)\n        return data;\n    if ((0,_is_binary_js__WEBPACK_IMPORTED_MODULE_0__.isBinary)(data)) {\n        const placeholder = { _placeholder: true, num: buffers.length };\n        buffers.push(data);\n        return placeholder;\n    }\n    else if (Array.isArray(data)) {\n        const newData = new Array(data.length);\n        for (let i = 0; i < data.length; i++) {\n            newData[i] = _deconstructPacket(data[i], buffers);\n        }\n        return newData;\n    }\n    else if (typeof data === "object" && !(data instanceof Date)) {\n        const newData = {};\n        for (const key in data) {\n            if (Object.prototype.hasOwnProperty.call(data, key)) {\n                newData[key] = _deconstructPacket(data[key], buffers);\n            }\n        }\n        return newData;\n    }\n    return data;\n}\n/**\n * Reconstructs a binary packet from its placeholder packet and buffers\n *\n * @param {Object} packet - event packet with placeholders\n * @param {Array} buffers - binary buffers to put in placeholder positions\n * @return {Object} reconstructed packet\n * @public\n */\nfunction reconstructPacket(packet, buffers) {\n    packet.data = _reconstructPacket(packet.data, buffers);\n    delete packet.attachments; // no longer useful\n    return packet;\n}\nfunction _reconstructPacket(data, buffers) {\n    if (!data)\n        return data;\n    if (data && data._placeholder === true) {\n        const isIndexValid = typeof data.num === "number" &&\n            data.num >= 0 &&\n            data.num < buffers.length;\n        if (isIndexValid) {\n            return buffers[data.num]; // appropriate buffer (should be natural order anyway)\n        }\n        else {\n            throw new Error("illegal attachments");\n        }\n    }\n    else if (Array.isArray(data)) {\n        for (let i = 0; i < data.length; i++) {\n            data[i] = _reconstructPacket(data[i], buffers);\n        }\n    }\n    else if (typeof data === "object") {\n        for (const key in data) {\n            if (Object.prototype.hasOwnProperty.call(data, key)) {\n                data[key] = _reconstructPacket(data[key], buffers);\n            }\n        }\n    }\n    return data;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLXBhcnNlckA0LjIuNC9ub2RlX21vZHVsZXMvc29ja2V0LmlvLXBhcnNlci9idWlsZC9lc20vYmluYXJ5LmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUEwQztBQUMxQztBQUNBO0FBQ0E7QUFDQSxXQUFXLFFBQVE7QUFDbkIsWUFBWSxRQUFRO0FBQ3BCO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDO0FBQ3ZDLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsdURBQVE7QUFDaEIsOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsaUJBQWlCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsUUFBUTtBQUNuQixXQUFXLE9BQU87QUFDbEIsWUFBWSxRQUFRO0FBQ3BCO0FBQ0E7QUFDTztBQUNQO0FBQ0EsK0JBQStCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixpQkFBaUI7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL3NvY2tldC5pby1wYXJzZXJANC4yLjQvbm9kZV9tb2R1bGVzL3NvY2tldC5pby1wYXJzZXIvYnVpbGQvZXNtL2JpbmFyeS5qcz84ZTUxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGlzQmluYXJ5IH0gZnJvbSBcIi4vaXMtYmluYXJ5LmpzXCI7XG4vKipcbiAqIFJlcGxhY2VzIGV2ZXJ5IEJ1ZmZlciB8IEFycmF5QnVmZmVyIHwgQmxvYiB8IEZpbGUgaW4gcGFja2V0IHdpdGggYSBudW1iZXJlZCBwbGFjZWhvbGRlci5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gcGFja2V0IC0gc29ja2V0LmlvIGV2ZW50IHBhY2tldFxuICogQHJldHVybiB7T2JqZWN0fSB3aXRoIGRlY29uc3RydWN0ZWQgcGFja2V0IGFuZCBsaXN0IG9mIGJ1ZmZlcnNcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRlY29uc3RydWN0UGFja2V0KHBhY2tldCkge1xuICAgIGNvbnN0IGJ1ZmZlcnMgPSBbXTtcbiAgICBjb25zdCBwYWNrZXREYXRhID0gcGFja2V0LmRhdGE7XG4gICAgY29uc3QgcGFjayA9IHBhY2tldDtcbiAgICBwYWNrLmRhdGEgPSBfZGVjb25zdHJ1Y3RQYWNrZXQocGFja2V0RGF0YSwgYnVmZmVycyk7XG4gICAgcGFjay5hdHRhY2htZW50cyA9IGJ1ZmZlcnMubGVuZ3RoOyAvLyBudW1iZXIgb2YgYmluYXJ5ICdhdHRhY2htZW50cydcbiAgICByZXR1cm4geyBwYWNrZXQ6IHBhY2ssIGJ1ZmZlcnM6IGJ1ZmZlcnMgfTtcbn1cbmZ1bmN0aW9uIF9kZWNvbnN0cnVjdFBhY2tldChkYXRhLCBidWZmZXJzKSB7XG4gICAgaWYgKCFkYXRhKVxuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICBpZiAoaXNCaW5hcnkoZGF0YSkpIHtcbiAgICAgICAgY29uc3QgcGxhY2Vob2xkZXIgPSB7IF9wbGFjZWhvbGRlcjogdHJ1ZSwgbnVtOiBidWZmZXJzLmxlbmd0aCB9O1xuICAgICAgICBidWZmZXJzLnB1c2goZGF0YSk7XG4gICAgICAgIHJldHVybiBwbGFjZWhvbGRlcjtcbiAgICB9XG4gICAgZWxzZSBpZiAoQXJyYXkuaXNBcnJheShkYXRhKSkge1xuICAgICAgICBjb25zdCBuZXdEYXRhID0gbmV3IEFycmF5KGRhdGEubGVuZ3RoKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBuZXdEYXRhW2ldID0gX2RlY29uc3RydWN0UGFja2V0KGRhdGFbaV0sIGJ1ZmZlcnMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXdEYXRhO1xuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlb2YgZGF0YSA9PT0gXCJvYmplY3RcIiAmJiAhKGRhdGEgaW5zdGFuY2VvZiBEYXRlKSkge1xuICAgICAgICBjb25zdCBuZXdEYXRhID0ge307XG4gICAgICAgIGZvciAoY29uc3Qga2V5IGluIGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZGF0YSwga2V5KSkge1xuICAgICAgICAgICAgICAgIG5ld0RhdGFba2V5XSA9IF9kZWNvbnN0cnVjdFBhY2tldChkYXRhW2tleV0sIGJ1ZmZlcnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXdEYXRhO1xuICAgIH1cbiAgICByZXR1cm4gZGF0YTtcbn1cbi8qKlxuICogUmVjb25zdHJ1Y3RzIGEgYmluYXJ5IHBhY2tldCBmcm9tIGl0cyBwbGFjZWhvbGRlciBwYWNrZXQgYW5kIGJ1ZmZlcnNcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gcGFja2V0IC0gZXZlbnQgcGFja2V0IHdpdGggcGxhY2Vob2xkZXJzXG4gKiBAcGFyYW0ge0FycmF5fSBidWZmZXJzIC0gYmluYXJ5IGJ1ZmZlcnMgdG8gcHV0IGluIHBsYWNlaG9sZGVyIHBvc2l0aW9uc1xuICogQHJldHVybiB7T2JqZWN0fSByZWNvbnN0cnVjdGVkIHBhY2tldFxuICogQHB1YmxpY1xuICovXG5leHBvcnQgZnVuY3Rpb24gcmVjb25zdHJ1Y3RQYWNrZXQocGFja2V0LCBidWZmZXJzKSB7XG4gICAgcGFja2V0LmRhdGEgPSBfcmVjb25zdHJ1Y3RQYWNrZXQocGFja2V0LmRhdGEsIGJ1ZmZlcnMpO1xuICAgIGRlbGV0ZSBwYWNrZXQuYXR0YWNobWVudHM7IC8vIG5vIGxvbmdlciB1c2VmdWxcbiAgICByZXR1cm4gcGFja2V0O1xufVxuZnVuY3Rpb24gX3JlY29uc3RydWN0UGFja2V0KGRhdGEsIGJ1ZmZlcnMpIHtcbiAgICBpZiAoIWRhdGEpXG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgIGlmIChkYXRhICYmIGRhdGEuX3BsYWNlaG9sZGVyID09PSB0cnVlKSB7XG4gICAgICAgIGNvbnN0IGlzSW5kZXhWYWxpZCA9IHR5cGVvZiBkYXRhLm51bSA9PT0gXCJudW1iZXJcIiAmJlxuICAgICAgICAgICAgZGF0YS5udW0gPj0gMCAmJlxuICAgICAgICAgICAgZGF0YS5udW0gPCBidWZmZXJzLmxlbmd0aDtcbiAgICAgICAgaWYgKGlzSW5kZXhWYWxpZCkge1xuICAgICAgICAgICAgcmV0dXJuIGJ1ZmZlcnNbZGF0YS5udW1dOyAvLyBhcHByb3ByaWF0ZSBidWZmZXIgKHNob3VsZCBiZSBuYXR1cmFsIG9yZGVyIGFueXdheSlcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImlsbGVnYWwgYXR0YWNobWVudHNcIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoQXJyYXkuaXNBcnJheShkYXRhKSkge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGRhdGFbaV0gPSBfcmVjb25zdHJ1Y3RQYWNrZXQoZGF0YVtpXSwgYnVmZmVycyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZW9mIGRhdGEgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gZGF0YSkge1xuICAgICAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChkYXRhLCBrZXkpKSB7XG4gICAgICAgICAgICAgICAgZGF0YVtrZXldID0gX3JlY29uc3RydWN0UGFja2V0KGRhdGFba2V5XSwgYnVmZmVycyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGRhdGE7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/binary.js\n\n}')},"./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/index.js":
/*!****************************************************************************************************!*\
  !*** ./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/index.js ***!
  \****************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Decoder: () => (/* binding */ Decoder),\n/* harmony export */   Encoder: () => (/* binding */ Encoder),\n/* harmony export */   PacketType: () => (/* binding */ PacketType),\n/* harmony export */   protocol: () => (/* binding */ protocol)\n/* harmony export */ });\n/* harmony import */ var _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @socket.io/component-emitter */ "./node_modules/.pnpm/@socket.io+component-emitter@3.1.2/node_modules/@socket.io/component-emitter/lib/esm/index.js");\n/* harmony import */ var _binary_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./binary.js */ "./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/binary.js");\n/* harmony import */ var _is_binary_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./is-binary.js */ "./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/is-binary.js");\n\n\n\n/**\n * These strings must not be used as event names, as they have a special meaning.\n */\nconst RESERVED_EVENTS = [\n    "connect",\n    "connect_error",\n    "disconnect",\n    "disconnecting",\n    "newListener",\n    "removeListener", // used by the Node.js EventEmitter\n];\n/**\n * Protocol version.\n *\n * @public\n */\nconst protocol = 5;\nvar PacketType;\n(function (PacketType) {\n    PacketType[PacketType["CONNECT"] = 0] = "CONNECT";\n    PacketType[PacketType["DISCONNECT"] = 1] = "DISCONNECT";\n    PacketType[PacketType["EVENT"] = 2] = "EVENT";\n    PacketType[PacketType["ACK"] = 3] = "ACK";\n    PacketType[PacketType["CONNECT_ERROR"] = 4] = "CONNECT_ERROR";\n    PacketType[PacketType["BINARY_EVENT"] = 5] = "BINARY_EVENT";\n    PacketType[PacketType["BINARY_ACK"] = 6] = "BINARY_ACK";\n})(PacketType || (PacketType = {}));\n/**\n * A socket.io Encoder instance\n */\nclass Encoder {\n    /**\n     * Encoder constructor\n     *\n     * @param {function} replacer - custom replacer to pass down to JSON.parse\n     */\n    constructor(replacer) {\n        this.replacer = replacer;\n    }\n    /**\n     * Encode a packet as a single string if non-binary, or as a\n     * buffer sequence, depending on packet type.\n     *\n     * @param {Object} obj - packet object\n     */\n    encode(obj) {\n        if (obj.type === PacketType.EVENT || obj.type === PacketType.ACK) {\n            if ((0,_is_binary_js__WEBPACK_IMPORTED_MODULE_2__.hasBinary)(obj)) {\n                return this.encodeAsBinary({\n                    type: obj.type === PacketType.EVENT\n                        ? PacketType.BINARY_EVENT\n                        : PacketType.BINARY_ACK,\n                    nsp: obj.nsp,\n                    data: obj.data,\n                    id: obj.id,\n                });\n            }\n        }\n        return [this.encodeAsString(obj)];\n    }\n    /**\n     * Encode packet as string.\n     */\n    encodeAsString(obj) {\n        // first is type\n        let str = "" + obj.type;\n        // attachments if we have them\n        if (obj.type === PacketType.BINARY_EVENT ||\n            obj.type === PacketType.BINARY_ACK) {\n            str += obj.attachments + "-";\n        }\n        // if we have a namespace other than `/`\n        // we append it followed by a comma `,`\n        if (obj.nsp && "/" !== obj.nsp) {\n            str += obj.nsp + ",";\n        }\n        // immediately followed by the id\n        if (null != obj.id) {\n            str += obj.id;\n        }\n        // json data\n        if (null != obj.data) {\n            str += JSON.stringify(obj.data, this.replacer);\n        }\n        return str;\n    }\n    /**\n     * Encode packet as \'buffer sequence\' by removing blobs, and\n     * deconstructing packet into object with placeholders and\n     * a list of buffers.\n     */\n    encodeAsBinary(obj) {\n        const deconstruction = (0,_binary_js__WEBPACK_IMPORTED_MODULE_1__.deconstructPacket)(obj);\n        const pack = this.encodeAsString(deconstruction.packet);\n        const buffers = deconstruction.buffers;\n        buffers.unshift(pack); // add packet info to beginning of data list\n        return buffers; // write all the buffers\n    }\n}\n// see https://stackoverflow.com/questions/8511281/check-if-a-value-is-an-object-in-javascript\nfunction isObject(value) {\n    return Object.prototype.toString.call(value) === "[object Object]";\n}\n/**\n * A socket.io Decoder instance\n *\n * @return {Object} decoder\n */\nclass Decoder extends _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_0__.Emitter {\n    /**\n     * Decoder constructor\n     *\n     * @param {function} reviver - custom reviver to pass down to JSON.stringify\n     */\n    constructor(reviver) {\n        super();\n        this.reviver = reviver;\n    }\n    /**\n     * Decodes an encoded packet string into packet JSON.\n     *\n     * @param {String} obj - encoded packet\n     */\n    add(obj) {\n        let packet;\n        if (typeof obj === "string") {\n            if (this.reconstructor) {\n                throw new Error("got plaintext data when reconstructing a packet");\n            }\n            packet = this.decodeString(obj);\n            const isBinaryEvent = packet.type === PacketType.BINARY_EVENT;\n            if (isBinaryEvent || packet.type === PacketType.BINARY_ACK) {\n                packet.type = isBinaryEvent ? PacketType.EVENT : PacketType.ACK;\n                // binary packet\'s json\n                this.reconstructor = new BinaryReconstructor(packet);\n                // no attachments, labeled binary but no binary data to follow\n                if (packet.attachments === 0) {\n                    super.emitReserved("decoded", packet);\n                }\n            }\n            else {\n                // non-binary full packet\n                super.emitReserved("decoded", packet);\n            }\n        }\n        else if ((0,_is_binary_js__WEBPACK_IMPORTED_MODULE_2__.isBinary)(obj) || obj.base64) {\n            // raw binary data\n            if (!this.reconstructor) {\n                throw new Error("got binary data when not reconstructing a packet");\n            }\n            else {\n                packet = this.reconstructor.takeBinaryData(obj);\n                if (packet) {\n                    // received final buffer\n                    this.reconstructor = null;\n                    super.emitReserved("decoded", packet);\n                }\n            }\n        }\n        else {\n            throw new Error("Unknown type: " + obj);\n        }\n    }\n    /**\n     * Decode a packet String (JSON data)\n     *\n     * @param {String} str\n     * @return {Object} packet\n     */\n    decodeString(str) {\n        let i = 0;\n        // look up type\n        const p = {\n            type: Number(str.charAt(0)),\n        };\n        if (PacketType[p.type] === undefined) {\n            throw new Error("unknown packet type " + p.type);\n        }\n        // look up attachments if type binary\n        if (p.type === PacketType.BINARY_EVENT ||\n            p.type === PacketType.BINARY_ACK) {\n            const start = i + 1;\n            while (str.charAt(++i) !== "-" && i != str.length) { }\n            const buf = str.substring(start, i);\n            if (buf != Number(buf) || str.charAt(i) !== "-") {\n                throw new Error("Illegal attachments");\n            }\n            p.attachments = Number(buf);\n        }\n        // look up namespace (if any)\n        if ("/" === str.charAt(i + 1)) {\n            const start = i + 1;\n            while (++i) {\n                const c = str.charAt(i);\n                if ("," === c)\n                    break;\n                if (i === str.length)\n                    break;\n            }\n            p.nsp = str.substring(start, i);\n        }\n        else {\n            p.nsp = "/";\n        }\n        // look up id\n        const next = str.charAt(i + 1);\n        if ("" !== next && Number(next) == next) {\n            const start = i + 1;\n            while (++i) {\n                const c = str.charAt(i);\n                if (null == c || Number(c) != c) {\n                    --i;\n                    break;\n                }\n                if (i === str.length)\n                    break;\n            }\n            p.id = Number(str.substring(start, i + 1));\n        }\n        // look up json data\n        if (str.charAt(++i)) {\n            const payload = this.tryParse(str.substr(i));\n            if (Decoder.isPayloadValid(p.type, payload)) {\n                p.data = payload;\n            }\n            else {\n                throw new Error("invalid payload");\n            }\n        }\n        return p;\n    }\n    tryParse(str) {\n        try {\n            return JSON.parse(str, this.reviver);\n        }\n        catch (e) {\n            return false;\n        }\n    }\n    static isPayloadValid(type, payload) {\n        switch (type) {\n            case PacketType.CONNECT:\n                return isObject(payload);\n            case PacketType.DISCONNECT:\n                return payload === undefined;\n            case PacketType.CONNECT_ERROR:\n                return typeof payload === "string" || isObject(payload);\n            case PacketType.EVENT:\n            case PacketType.BINARY_EVENT:\n                return (Array.isArray(payload) &&\n                    (typeof payload[0] === "number" ||\n                        (typeof payload[0] === "string" &&\n                            RESERVED_EVENTS.indexOf(payload[0]) === -1)));\n            case PacketType.ACK:\n            case PacketType.BINARY_ACK:\n                return Array.isArray(payload);\n        }\n    }\n    /**\n     * Deallocates a parser\'s resources\n     */\n    destroy() {\n        if (this.reconstructor) {\n            this.reconstructor.finishedReconstruction();\n            this.reconstructor = null;\n        }\n    }\n}\n/**\n * A manager of a binary event\'s \'buffer sequence\'. Should\n * be constructed whenever a packet of type BINARY_EVENT is\n * decoded.\n *\n * @param {Object} packet\n * @return {BinaryReconstructor} initialized reconstructor\n */\nclass BinaryReconstructor {\n    constructor(packet) {\n        this.packet = packet;\n        this.buffers = [];\n        this.reconPack = packet;\n    }\n    /**\n     * Method to be called when binary data received from connection\n     * after a BINARY_EVENT packet.\n     *\n     * @param {Buffer | ArrayBuffer} binData - the raw binary data received\n     * @return {null | Object} returns null if more binary data is expected or\n     *   a reconstructed packet object if all buffers have been received.\n     */\n    takeBinaryData(binData) {\n        this.buffers.push(binData);\n        if (this.buffers.length === this.reconPack.attachments) {\n            // done with buffer list\n            const packet = (0,_binary_js__WEBPACK_IMPORTED_MODULE_1__.reconstructPacket)(this.reconPack, this.buffers);\n            this.finishedReconstruction();\n            return packet;\n        }\n        return null;\n    }\n    /**\n     * Cleans up binary packet reconstruction variables.\n     */\n    finishedReconstruction() {\n        this.reconPack = null;\n        this.buffers = [];\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLXBhcnNlckA0LjIuNC9ub2RlX21vZHVsZXMvc29ja2V0LmlvLXBhcnNlci9idWlsZC9lc20vaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUF1RDtBQUNZO0FBQ2Q7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNBO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsZ0NBQWdDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsZUFBZSxVQUFVO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkI7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLHdEQUFTO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQiw2REFBaUI7QUFDaEQ7QUFDQTtBQUNBLCtCQUErQjtBQUMvQix3QkFBd0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxRQUFRO0FBQ3BCO0FBQ08sc0JBQXNCLGlFQUFPO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBLGVBQWUsVUFBVTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsdURBQVE7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsUUFBUTtBQUN2QixnQkFBZ0IsUUFBUTtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFFBQVE7QUFDbkIsWUFBWSxxQkFBcUI7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsc0JBQXNCO0FBQ3JDLGdCQUFnQixlQUFlO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQiw2REFBaUI7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLXBhcnNlckA0LjIuNC9ub2RlX21vZHVsZXMvc29ja2V0LmlvLXBhcnNlci9idWlsZC9lc20vaW5kZXguanM/ZWMzZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBFbWl0dGVyIH0gZnJvbSBcIkBzb2NrZXQuaW8vY29tcG9uZW50LWVtaXR0ZXJcIjtcbmltcG9ydCB7IGRlY29uc3RydWN0UGFja2V0LCByZWNvbnN0cnVjdFBhY2tldCB9IGZyb20gXCIuL2JpbmFyeS5qc1wiO1xuaW1wb3J0IHsgaXNCaW5hcnksIGhhc0JpbmFyeSB9IGZyb20gXCIuL2lzLWJpbmFyeS5qc1wiO1xuLyoqXG4gKiBUaGVzZSBzdHJpbmdzIG11c3Qgbm90IGJlIHVzZWQgYXMgZXZlbnQgbmFtZXMsIGFzIHRoZXkgaGF2ZSBhIHNwZWNpYWwgbWVhbmluZy5cbiAqL1xuY29uc3QgUkVTRVJWRURfRVZFTlRTID0gW1xuICAgIFwiY29ubmVjdFwiLFxuICAgIFwiY29ubmVjdF9lcnJvclwiLFxuICAgIFwiZGlzY29ubmVjdFwiLFxuICAgIFwiZGlzY29ubmVjdGluZ1wiLFxuICAgIFwibmV3TGlzdGVuZXJcIixcbiAgICBcInJlbW92ZUxpc3RlbmVyXCIsIC8vIHVzZWQgYnkgdGhlIE5vZGUuanMgRXZlbnRFbWl0dGVyXG5dO1xuLyoqXG4gKiBQcm90b2NvbCB2ZXJzaW9uLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGNvbnN0IHByb3RvY29sID0gNTtcbmV4cG9ydCB2YXIgUGFja2V0VHlwZTtcbihmdW5jdGlvbiAoUGFja2V0VHlwZSkge1xuICAgIFBhY2tldFR5cGVbUGFja2V0VHlwZVtcIkNPTk5FQ1RcIl0gPSAwXSA9IFwiQ09OTkVDVFwiO1xuICAgIFBhY2tldFR5cGVbUGFja2V0VHlwZVtcIkRJU0NPTk5FQ1RcIl0gPSAxXSA9IFwiRElTQ09OTkVDVFwiO1xuICAgIFBhY2tldFR5cGVbUGFja2V0VHlwZVtcIkVWRU5UXCJdID0gMl0gPSBcIkVWRU5UXCI7XG4gICAgUGFja2V0VHlwZVtQYWNrZXRUeXBlW1wiQUNLXCJdID0gM10gPSBcIkFDS1wiO1xuICAgIFBhY2tldFR5cGVbUGFja2V0VHlwZVtcIkNPTk5FQ1RfRVJST1JcIl0gPSA0XSA9IFwiQ09OTkVDVF9FUlJPUlwiO1xuICAgIFBhY2tldFR5cGVbUGFja2V0VHlwZVtcIkJJTkFSWV9FVkVOVFwiXSA9IDVdID0gXCJCSU5BUllfRVZFTlRcIjtcbiAgICBQYWNrZXRUeXBlW1BhY2tldFR5cGVbXCJCSU5BUllfQUNLXCJdID0gNl0gPSBcIkJJTkFSWV9BQ0tcIjtcbn0pKFBhY2tldFR5cGUgfHwgKFBhY2tldFR5cGUgPSB7fSkpO1xuLyoqXG4gKiBBIHNvY2tldC5pbyBFbmNvZGVyIGluc3RhbmNlXG4gKi9cbmV4cG9ydCBjbGFzcyBFbmNvZGVyIHtcbiAgICAvKipcbiAgICAgKiBFbmNvZGVyIGNvbnN0cnVjdG9yXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSByZXBsYWNlciAtIGN1c3RvbSByZXBsYWNlciB0byBwYXNzIGRvd24gdG8gSlNPTi5wYXJzZVxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHJlcGxhY2VyKSB7XG4gICAgICAgIHRoaXMucmVwbGFjZXIgPSByZXBsYWNlcjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRW5jb2RlIGEgcGFja2V0IGFzIGEgc2luZ2xlIHN0cmluZyBpZiBub24tYmluYXJ5LCBvciBhcyBhXG4gICAgICogYnVmZmVyIHNlcXVlbmNlLCBkZXBlbmRpbmcgb24gcGFja2V0IHR5cGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqIC0gcGFja2V0IG9iamVjdFxuICAgICAqL1xuICAgIGVuY29kZShvYmopIHtcbiAgICAgICAgaWYgKG9iai50eXBlID09PSBQYWNrZXRUeXBlLkVWRU5UIHx8IG9iai50eXBlID09PSBQYWNrZXRUeXBlLkFDSykge1xuICAgICAgICAgICAgaWYgKGhhc0JpbmFyeShvYmopKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZW5jb2RlQXNCaW5hcnkoe1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBvYmoudHlwZSA9PT0gUGFja2V0VHlwZS5FVkVOVFxuICAgICAgICAgICAgICAgICAgICAgICAgPyBQYWNrZXRUeXBlLkJJTkFSWV9FVkVOVFxuICAgICAgICAgICAgICAgICAgICAgICAgOiBQYWNrZXRUeXBlLkJJTkFSWV9BQ0ssXG4gICAgICAgICAgICAgICAgICAgIG5zcDogb2JqLm5zcCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogb2JqLmRhdGEsXG4gICAgICAgICAgICAgICAgICAgIGlkOiBvYmouaWQsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFt0aGlzLmVuY29kZUFzU3RyaW5nKG9iaildO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBFbmNvZGUgcGFja2V0IGFzIHN0cmluZy5cbiAgICAgKi9cbiAgICBlbmNvZGVBc1N0cmluZyhvYmopIHtcbiAgICAgICAgLy8gZmlyc3QgaXMgdHlwZVxuICAgICAgICBsZXQgc3RyID0gXCJcIiArIG9iai50eXBlO1xuICAgICAgICAvLyBhdHRhY2htZW50cyBpZiB3ZSBoYXZlIHRoZW1cbiAgICAgICAgaWYgKG9iai50eXBlID09PSBQYWNrZXRUeXBlLkJJTkFSWV9FVkVOVCB8fFxuICAgICAgICAgICAgb2JqLnR5cGUgPT09IFBhY2tldFR5cGUuQklOQVJZX0FDSykge1xuICAgICAgICAgICAgc3RyICs9IG9iai5hdHRhY2htZW50cyArIFwiLVwiO1xuICAgICAgICB9XG4gICAgICAgIC8vIGlmIHdlIGhhdmUgYSBuYW1lc3BhY2Ugb3RoZXIgdGhhbiBgL2BcbiAgICAgICAgLy8gd2UgYXBwZW5kIGl0IGZvbGxvd2VkIGJ5IGEgY29tbWEgYCxgXG4gICAgICAgIGlmIChvYmoubnNwICYmIFwiL1wiICE9PSBvYmoubnNwKSB7XG4gICAgICAgICAgICBzdHIgKz0gb2JqLm5zcCArIFwiLFwiO1xuICAgICAgICB9XG4gICAgICAgIC8vIGltbWVkaWF0ZWx5IGZvbGxvd2VkIGJ5IHRoZSBpZFxuICAgICAgICBpZiAobnVsbCAhPSBvYmouaWQpIHtcbiAgICAgICAgICAgIHN0ciArPSBvYmouaWQ7XG4gICAgICAgIH1cbiAgICAgICAgLy8ganNvbiBkYXRhXG4gICAgICAgIGlmIChudWxsICE9IG9iai5kYXRhKSB7XG4gICAgICAgICAgICBzdHIgKz0gSlNPTi5zdHJpbmdpZnkob2JqLmRhdGEsIHRoaXMucmVwbGFjZXIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdHI7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEVuY29kZSBwYWNrZXQgYXMgJ2J1ZmZlciBzZXF1ZW5jZScgYnkgcmVtb3ZpbmcgYmxvYnMsIGFuZFxuICAgICAqIGRlY29uc3RydWN0aW5nIHBhY2tldCBpbnRvIG9iamVjdCB3aXRoIHBsYWNlaG9sZGVycyBhbmRcbiAgICAgKiBhIGxpc3Qgb2YgYnVmZmVycy5cbiAgICAgKi9cbiAgICBlbmNvZGVBc0JpbmFyeShvYmopIHtcbiAgICAgICAgY29uc3QgZGVjb25zdHJ1Y3Rpb24gPSBkZWNvbnN0cnVjdFBhY2tldChvYmopO1xuICAgICAgICBjb25zdCBwYWNrID0gdGhpcy5lbmNvZGVBc1N0cmluZyhkZWNvbnN0cnVjdGlvbi5wYWNrZXQpO1xuICAgICAgICBjb25zdCBidWZmZXJzID0gZGVjb25zdHJ1Y3Rpb24uYnVmZmVycztcbiAgICAgICAgYnVmZmVycy51bnNoaWZ0KHBhY2spOyAvLyBhZGQgcGFja2V0IGluZm8gdG8gYmVnaW5uaW5nIG9mIGRhdGEgbGlzdFxuICAgICAgICByZXR1cm4gYnVmZmVyczsgLy8gd3JpdGUgYWxsIHRoZSBidWZmZXJzXG4gICAgfVxufVxuLy8gc2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzg1MTEyODEvY2hlY2staWYtYS12YWx1ZS1pcy1hbi1vYmplY3QtaW4tamF2YXNjcmlwdFxuZnVuY3Rpb24gaXNPYmplY3QodmFsdWUpIHtcbiAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHZhbHVlKSA9PT0gXCJbb2JqZWN0IE9iamVjdF1cIjtcbn1cbi8qKlxuICogQSBzb2NrZXQuaW8gRGVjb2RlciBpbnN0YW5jZVxuICpcbiAqIEByZXR1cm4ge09iamVjdH0gZGVjb2RlclxuICovXG5leHBvcnQgY2xhc3MgRGVjb2RlciBleHRlbmRzIEVtaXR0ZXIge1xuICAgIC8qKlxuICAgICAqIERlY29kZXIgY29uc3RydWN0b3JcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IHJldml2ZXIgLSBjdXN0b20gcmV2aXZlciB0byBwYXNzIGRvd24gdG8gSlNPTi5zdHJpbmdpZnlcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihyZXZpdmVyKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMucmV2aXZlciA9IHJldml2ZXI7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERlY29kZXMgYW4gZW5jb2RlZCBwYWNrZXQgc3RyaW5nIGludG8gcGFja2V0IEpTT04uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gb2JqIC0gZW5jb2RlZCBwYWNrZXRcbiAgICAgKi9cbiAgICBhZGQob2JqKSB7XG4gICAgICAgIGxldCBwYWNrZXQ7XG4gICAgICAgIGlmICh0eXBlb2Ygb2JqID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5yZWNvbnN0cnVjdG9yKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiZ290IHBsYWludGV4dCBkYXRhIHdoZW4gcmVjb25zdHJ1Y3RpbmcgYSBwYWNrZXRcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwYWNrZXQgPSB0aGlzLmRlY29kZVN0cmluZyhvYmopO1xuICAgICAgICAgICAgY29uc3QgaXNCaW5hcnlFdmVudCA9IHBhY2tldC50eXBlID09PSBQYWNrZXRUeXBlLkJJTkFSWV9FVkVOVDtcbiAgICAgICAgICAgIGlmIChpc0JpbmFyeUV2ZW50IHx8IHBhY2tldC50eXBlID09PSBQYWNrZXRUeXBlLkJJTkFSWV9BQ0spIHtcbiAgICAgICAgICAgICAgICBwYWNrZXQudHlwZSA9IGlzQmluYXJ5RXZlbnQgPyBQYWNrZXRUeXBlLkVWRU5UIDogUGFja2V0VHlwZS5BQ0s7XG4gICAgICAgICAgICAgICAgLy8gYmluYXJ5IHBhY2tldCdzIGpzb25cbiAgICAgICAgICAgICAgICB0aGlzLnJlY29uc3RydWN0b3IgPSBuZXcgQmluYXJ5UmVjb25zdHJ1Y3RvcihwYWNrZXQpO1xuICAgICAgICAgICAgICAgIC8vIG5vIGF0dGFjaG1lbnRzLCBsYWJlbGVkIGJpbmFyeSBidXQgbm8gYmluYXJ5IGRhdGEgdG8gZm9sbG93XG4gICAgICAgICAgICAgICAgaWYgKHBhY2tldC5hdHRhY2htZW50cyA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBzdXBlci5lbWl0UmVzZXJ2ZWQoXCJkZWNvZGVkXCIsIHBhY2tldCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gbm9uLWJpbmFyeSBmdWxsIHBhY2tldFxuICAgICAgICAgICAgICAgIHN1cGVyLmVtaXRSZXNlcnZlZChcImRlY29kZWRcIiwgcGFja2V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChpc0JpbmFyeShvYmopIHx8IG9iai5iYXNlNjQpIHtcbiAgICAgICAgICAgIC8vIHJhdyBiaW5hcnkgZGF0YVxuICAgICAgICAgICAgaWYgKCF0aGlzLnJlY29uc3RydWN0b3IpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJnb3QgYmluYXJ5IGRhdGEgd2hlbiBub3QgcmVjb25zdHJ1Y3RpbmcgYSBwYWNrZXRcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBwYWNrZXQgPSB0aGlzLnJlY29uc3RydWN0b3IudGFrZUJpbmFyeURhdGEob2JqKTtcbiAgICAgICAgICAgICAgICBpZiAocGFja2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHJlY2VpdmVkIGZpbmFsIGJ1ZmZlclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlY29uc3RydWN0b3IgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICBzdXBlci5lbWl0UmVzZXJ2ZWQoXCJkZWNvZGVkXCIsIHBhY2tldCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVW5rbm93biB0eXBlOiBcIiArIG9iaik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogRGVjb2RlIGEgcGFja2V0IFN0cmluZyAoSlNPTiBkYXRhKVxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHN0clxuICAgICAqIEByZXR1cm4ge09iamVjdH0gcGFja2V0XG4gICAgICovXG4gICAgZGVjb2RlU3RyaW5nKHN0cikge1xuICAgICAgICBsZXQgaSA9IDA7XG4gICAgICAgIC8vIGxvb2sgdXAgdHlwZVxuICAgICAgICBjb25zdCBwID0ge1xuICAgICAgICAgICAgdHlwZTogTnVtYmVyKHN0ci5jaGFyQXQoMCkpLFxuICAgICAgICB9O1xuICAgICAgICBpZiAoUGFja2V0VHlwZVtwLnR5cGVdID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInVua25vd24gcGFja2V0IHR5cGUgXCIgKyBwLnR5cGUpO1xuICAgICAgICB9XG4gICAgICAgIC8vIGxvb2sgdXAgYXR0YWNobWVudHMgaWYgdHlwZSBiaW5hcnlcbiAgICAgICAgaWYgKHAudHlwZSA9PT0gUGFja2V0VHlwZS5CSU5BUllfRVZFTlQgfHxcbiAgICAgICAgICAgIHAudHlwZSA9PT0gUGFja2V0VHlwZS5CSU5BUllfQUNLKSB7XG4gICAgICAgICAgICBjb25zdCBzdGFydCA9IGkgKyAxO1xuICAgICAgICAgICAgd2hpbGUgKHN0ci5jaGFyQXQoKytpKSAhPT0gXCItXCIgJiYgaSAhPSBzdHIubGVuZ3RoKSB7IH1cbiAgICAgICAgICAgIGNvbnN0IGJ1ZiA9IHN0ci5zdWJzdHJpbmcoc3RhcnQsIGkpO1xuICAgICAgICAgICAgaWYgKGJ1ZiAhPSBOdW1iZXIoYnVmKSB8fCBzdHIuY2hhckF0KGkpICE9PSBcIi1cIikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIklsbGVnYWwgYXR0YWNobWVudHNcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwLmF0dGFjaG1lbnRzID0gTnVtYmVyKGJ1Zik7XG4gICAgICAgIH1cbiAgICAgICAgLy8gbG9vayB1cCBuYW1lc3BhY2UgKGlmIGFueSlcbiAgICAgICAgaWYgKFwiL1wiID09PSBzdHIuY2hhckF0KGkgKyAxKSkge1xuICAgICAgICAgICAgY29uc3Qgc3RhcnQgPSBpICsgMTtcbiAgICAgICAgICAgIHdoaWxlICgrK2kpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjID0gc3RyLmNoYXJBdChpKTtcbiAgICAgICAgICAgICAgICBpZiAoXCIsXCIgPT09IGMpXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGlmIChpID09PSBzdHIubGVuZ3RoKVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHAubnNwID0gc3RyLnN1YnN0cmluZyhzdGFydCwgaSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBwLm5zcCA9IFwiL1wiO1xuICAgICAgICB9XG4gICAgICAgIC8vIGxvb2sgdXAgaWRcbiAgICAgICAgY29uc3QgbmV4dCA9IHN0ci5jaGFyQXQoaSArIDEpO1xuICAgICAgICBpZiAoXCJcIiAhPT0gbmV4dCAmJiBOdW1iZXIobmV4dCkgPT0gbmV4dCkge1xuICAgICAgICAgICAgY29uc3Qgc3RhcnQgPSBpICsgMTtcbiAgICAgICAgICAgIHdoaWxlICgrK2kpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjID0gc3RyLmNoYXJBdChpKTtcbiAgICAgICAgICAgICAgICBpZiAobnVsbCA9PSBjIHx8IE51bWJlcihjKSAhPSBjKSB7XG4gICAgICAgICAgICAgICAgICAgIC0taTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChpID09PSBzdHIubGVuZ3RoKVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHAuaWQgPSBOdW1iZXIoc3RyLnN1YnN0cmluZyhzdGFydCwgaSArIDEpKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBsb29rIHVwIGpzb24gZGF0YVxuICAgICAgICBpZiAoc3RyLmNoYXJBdCgrK2kpKSB7XG4gICAgICAgICAgICBjb25zdCBwYXlsb2FkID0gdGhpcy50cnlQYXJzZShzdHIuc3Vic3RyKGkpKTtcbiAgICAgICAgICAgIGlmIChEZWNvZGVyLmlzUGF5bG9hZFZhbGlkKHAudHlwZSwgcGF5bG9hZCkpIHtcbiAgICAgICAgICAgICAgICBwLmRhdGEgPSBwYXlsb2FkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiaW52YWxpZCBwYXlsb2FkXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwO1xuICAgIH1cbiAgICB0cnlQYXJzZShzdHIpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKHN0ciwgdGhpcy5yZXZpdmVyKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBpc1BheWxvYWRWYWxpZCh0eXBlLCBwYXlsb2FkKSB7XG4gICAgICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICAgICAgY2FzZSBQYWNrZXRUeXBlLkNPTk5FQ1Q6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGlzT2JqZWN0KHBheWxvYWQpO1xuICAgICAgICAgICAgY2FzZSBQYWNrZXRUeXBlLkRJU0NPTk5FQ1Q6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBheWxvYWQgPT09IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIGNhc2UgUGFja2V0VHlwZS5DT05ORUNUX0VSUk9SOlxuICAgICAgICAgICAgICAgIHJldHVybiB0eXBlb2YgcGF5bG9hZCA9PT0gXCJzdHJpbmdcIiB8fCBpc09iamVjdChwYXlsb2FkKTtcbiAgICAgICAgICAgIGNhc2UgUGFja2V0VHlwZS5FVkVOVDpcbiAgICAgICAgICAgIGNhc2UgUGFja2V0VHlwZS5CSU5BUllfRVZFTlQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChBcnJheS5pc0FycmF5KHBheWxvYWQpICYmXG4gICAgICAgICAgICAgICAgICAgICh0eXBlb2YgcGF5bG9hZFswXSA9PT0gXCJudW1iZXJcIiB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgKHR5cGVvZiBwYXlsb2FkWzBdID09PSBcInN0cmluZ1wiICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVTRVJWRURfRVZFTlRTLmluZGV4T2YocGF5bG9hZFswXSkgPT09IC0xKSkpO1xuICAgICAgICAgICAgY2FzZSBQYWNrZXRUeXBlLkFDSzpcbiAgICAgICAgICAgIGNhc2UgUGFja2V0VHlwZS5CSU5BUllfQUNLOlxuICAgICAgICAgICAgICAgIHJldHVybiBBcnJheS5pc0FycmF5KHBheWxvYWQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERlYWxsb2NhdGVzIGEgcGFyc2VyJ3MgcmVzb3VyY2VzXG4gICAgICovXG4gICAgZGVzdHJveSgpIHtcbiAgICAgICAgaWYgKHRoaXMucmVjb25zdHJ1Y3Rvcikge1xuICAgICAgICAgICAgdGhpcy5yZWNvbnN0cnVjdG9yLmZpbmlzaGVkUmVjb25zdHJ1Y3Rpb24oKTtcbiAgICAgICAgICAgIHRoaXMucmVjb25zdHJ1Y3RvciA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG59XG4vKipcbiAqIEEgbWFuYWdlciBvZiBhIGJpbmFyeSBldmVudCdzICdidWZmZXIgc2VxdWVuY2UnLiBTaG91bGRcbiAqIGJlIGNvbnN0cnVjdGVkIHdoZW5ldmVyIGEgcGFja2V0IG9mIHR5cGUgQklOQVJZX0VWRU5UIGlzXG4gKiBkZWNvZGVkLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBwYWNrZXRcbiAqIEByZXR1cm4ge0JpbmFyeVJlY29uc3RydWN0b3J9IGluaXRpYWxpemVkIHJlY29uc3RydWN0b3JcbiAqL1xuY2xhc3MgQmluYXJ5UmVjb25zdHJ1Y3RvciB7XG4gICAgY29uc3RydWN0b3IocGFja2V0KSB7XG4gICAgICAgIHRoaXMucGFja2V0ID0gcGFja2V0O1xuICAgICAgICB0aGlzLmJ1ZmZlcnMgPSBbXTtcbiAgICAgICAgdGhpcy5yZWNvblBhY2sgPSBwYWNrZXQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE1ldGhvZCB0byBiZSBjYWxsZWQgd2hlbiBiaW5hcnkgZGF0YSByZWNlaXZlZCBmcm9tIGNvbm5lY3Rpb25cbiAgICAgKiBhZnRlciBhIEJJTkFSWV9FVkVOVCBwYWNrZXQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0J1ZmZlciB8IEFycmF5QnVmZmVyfSBiaW5EYXRhIC0gdGhlIHJhdyBiaW5hcnkgZGF0YSByZWNlaXZlZFxuICAgICAqIEByZXR1cm4ge251bGwgfCBPYmplY3R9IHJldHVybnMgbnVsbCBpZiBtb3JlIGJpbmFyeSBkYXRhIGlzIGV4cGVjdGVkIG9yXG4gICAgICogICBhIHJlY29uc3RydWN0ZWQgcGFja2V0IG9iamVjdCBpZiBhbGwgYnVmZmVycyBoYXZlIGJlZW4gcmVjZWl2ZWQuXG4gICAgICovXG4gICAgdGFrZUJpbmFyeURhdGEoYmluRGF0YSkge1xuICAgICAgICB0aGlzLmJ1ZmZlcnMucHVzaChiaW5EYXRhKTtcbiAgICAgICAgaWYgKHRoaXMuYnVmZmVycy5sZW5ndGggPT09IHRoaXMucmVjb25QYWNrLmF0dGFjaG1lbnRzKSB7XG4gICAgICAgICAgICAvLyBkb25lIHdpdGggYnVmZmVyIGxpc3RcbiAgICAgICAgICAgIGNvbnN0IHBhY2tldCA9IHJlY29uc3RydWN0UGFja2V0KHRoaXMucmVjb25QYWNrLCB0aGlzLmJ1ZmZlcnMpO1xuICAgICAgICAgICAgdGhpcy5maW5pc2hlZFJlY29uc3RydWN0aW9uKCk7XG4gICAgICAgICAgICByZXR1cm4gcGFja2V0O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDbGVhbnMgdXAgYmluYXJ5IHBhY2tldCByZWNvbnN0cnVjdGlvbiB2YXJpYWJsZXMuXG4gICAgICovXG4gICAgZmluaXNoZWRSZWNvbnN0cnVjdGlvbigpIHtcbiAgICAgICAgdGhpcy5yZWNvblBhY2sgPSBudWxsO1xuICAgICAgICB0aGlzLmJ1ZmZlcnMgPSBbXTtcbiAgICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/index.js\n\n}')},"./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/is-binary.js":
/*!********************************************************************************************************!*\
  !*** ./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/is-binary.js ***!
  \********************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   hasBinary: () => (/* binding */ hasBinary),\n/* harmony export */   isBinary: () => (/* binding */ isBinary)\n/* harmony export */ });\nconst withNativeArrayBuffer = typeof ArrayBuffer === "function";\nconst isView = (obj) => {\n    return typeof ArrayBuffer.isView === "function"\n        ? ArrayBuffer.isView(obj)\n        : obj.buffer instanceof ArrayBuffer;\n};\nconst toString = Object.prototype.toString;\nconst withNativeBlob = typeof Blob === "function" ||\n    (typeof Blob !== "undefined" &&\n        toString.call(Blob) === "[object BlobConstructor]");\nconst withNativeFile = typeof File === "function" ||\n    (typeof File !== "undefined" &&\n        toString.call(File) === "[object FileConstructor]");\n/**\n * Returns true if obj is a Buffer, an ArrayBuffer, a Blob or a File.\n *\n * @private\n */\nfunction isBinary(obj) {\n    return ((withNativeArrayBuffer && (obj instanceof ArrayBuffer || isView(obj))) ||\n        (withNativeBlob && obj instanceof Blob) ||\n        (withNativeFile && obj instanceof File));\n}\nfunction hasBinary(obj, toJSON) {\n    if (!obj || typeof obj !== "object") {\n        return false;\n    }\n    if (Array.isArray(obj)) {\n        for (let i = 0, l = obj.length; i < l; i++) {\n            if (hasBinary(obj[i])) {\n                return true;\n            }\n        }\n        return false;\n    }\n    if (isBinary(obj)) {\n        return true;\n    }\n    if (obj.toJSON &&\n        typeof obj.toJSON === "function" &&\n        arguments.length === 1) {\n        return hasBinary(obj.toJSON(), true);\n    }\n    for (const key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key) && hasBinary(obj[key])) {\n            return true;\n        }\n    }\n    return false;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLXBhcnNlckA0LjIuNC9ub2RlX21vZHVsZXMvc29ja2V0LmlvLXBhcnNlci9idWlsZC9lc20vaXMtYmluYXJ5LmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0MsT0FBTztBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLXBhcnNlckA0LjIuNC9ub2RlX21vZHVsZXMvc29ja2V0LmlvLXBhcnNlci9idWlsZC9lc20vaXMtYmluYXJ5LmpzP2ZhNTYiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgd2l0aE5hdGl2ZUFycmF5QnVmZmVyID0gdHlwZW9mIEFycmF5QnVmZmVyID09PSBcImZ1bmN0aW9uXCI7XG5jb25zdCBpc1ZpZXcgPSAob2JqKSA9PiB7XG4gICAgcmV0dXJuIHR5cGVvZiBBcnJheUJ1ZmZlci5pc1ZpZXcgPT09IFwiZnVuY3Rpb25cIlxuICAgICAgICA/IEFycmF5QnVmZmVyLmlzVmlldyhvYmopXG4gICAgICAgIDogb2JqLmJ1ZmZlciBpbnN0YW5jZW9mIEFycmF5QnVmZmVyO1xufTtcbmNvbnN0IHRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztcbmNvbnN0IHdpdGhOYXRpdmVCbG9iID0gdHlwZW9mIEJsb2IgPT09IFwiZnVuY3Rpb25cIiB8fFxuICAgICh0eXBlb2YgQmxvYiAhPT0gXCJ1bmRlZmluZWRcIiAmJlxuICAgICAgICB0b1N0cmluZy5jYWxsKEJsb2IpID09PSBcIltvYmplY3QgQmxvYkNvbnN0cnVjdG9yXVwiKTtcbmNvbnN0IHdpdGhOYXRpdmVGaWxlID0gdHlwZW9mIEZpbGUgPT09IFwiZnVuY3Rpb25cIiB8fFxuICAgICh0eXBlb2YgRmlsZSAhPT0gXCJ1bmRlZmluZWRcIiAmJlxuICAgICAgICB0b1N0cmluZy5jYWxsKEZpbGUpID09PSBcIltvYmplY3QgRmlsZUNvbnN0cnVjdG9yXVwiKTtcbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIG9iaiBpcyBhIEJ1ZmZlciwgYW4gQXJyYXlCdWZmZXIsIGEgQmxvYiBvciBhIEZpbGUuXG4gKlxuICogQHByaXZhdGVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzQmluYXJ5KG9iaikge1xuICAgIHJldHVybiAoKHdpdGhOYXRpdmVBcnJheUJ1ZmZlciAmJiAob2JqIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIgfHwgaXNWaWV3KG9iaikpKSB8fFxuICAgICAgICAod2l0aE5hdGl2ZUJsb2IgJiYgb2JqIGluc3RhbmNlb2YgQmxvYikgfHxcbiAgICAgICAgKHdpdGhOYXRpdmVGaWxlICYmIG9iaiBpbnN0YW5jZW9mIEZpbGUpKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBoYXNCaW5hcnkob2JqLCB0b0pTT04pIHtcbiAgICBpZiAoIW9iaiB8fCB0eXBlb2Ygb2JqICE9PSBcIm9iamVjdFwiKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKEFycmF5LmlzQXJyYXkob2JqKSkge1xuICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IG9iai5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChoYXNCaW5hcnkob2JqW2ldKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKGlzQmluYXJ5KG9iaikpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGlmIChvYmoudG9KU09OICYmXG4gICAgICAgIHR5cGVvZiBvYmoudG9KU09OID09PSBcImZ1bmN0aW9uXCIgJiZcbiAgICAgICAgYXJndW1lbnRzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICByZXR1cm4gaGFzQmluYXJ5KG9iai50b0pTT04oKSwgdHJ1ZSk7XG4gICAgfVxuICAgIGZvciAoY29uc3Qga2V5IGluIG9iaikge1xuICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSAmJiBoYXNCaW5hcnkob2JqW2tleV0pKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/is-binary.js\n\n}')},"./src/compatibility.ts":
/*!******************************!*\
  !*** ./src/compatibility.ts ***!
  \******************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   reloadEditor: () => (/* binding */ reloadEditor),\n/* harmony export */   reloadEditorDebounced: () => (/* binding */ reloadEditorDebounced),\n/* harmony export */   settingsToUpdate: () => (/* binding */ settingsToUpdate)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/scripts/world-info */ \"@sillytavern/scripts/world-info\");\n\n/**\n * Reloads the editor with the specified world info file\n * @param file The file to load in the editor\n * @param loadIfNotSelected Indicates whether to load the file even if it's not currently selected\n */\nfunction reloadEditor(file, load_if_not_selected = false) {\n    const current_index = Number($('#world_editor_select').val());\n    const selected_index = _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_0__.world_names.indexOf(file);\n    if (selected_index !== -1 && (load_if_not_selected || current_index === selected_index)) {\n        $('#world_editor_select').val(selected_index).trigger('change');\n    }\n}\nconst reloadEditorDebounced = _.debounce(reloadEditor, 1000);\nconst settingsToUpdate = {\n    max_context_unlocked: {\n        selector: '#oai_max_context_unlocked',\n        oai_setting: 'max_context_unlocked',\n        type: 'checkbox',\n    },\n    openai_max_context: {\n        selector: '#openai_max_context',\n        oai_setting: 'openai_max_context',\n        type: 'input',\n    },\n    openai_max_tokens: {\n        selector: '#openai_max_tokens',\n        oai_setting: 'openai_max_tokens',\n        type: 'input',\n    },\n    n: {\n        selector: '#n_openai',\n        oai_setting: 'n',\n        type: 'input',\n    },\n    stream_openai: {\n        selector: '#stream_toggle',\n        oai_setting: 'stream_openai',\n        type: 'checkbox',\n    },\n    temperature: {\n        selector: '#temp_openai',\n        oai_setting: 'temp_openai',\n        type: 'input',\n    },\n    frequency_penalty: {\n        selector: '#freq_pen_openai',\n        oai_setting: 'freq_pen_openai',\n        type: 'input',\n    },\n    presence_penalty: {\n        selector: '#pres_pen_openai',\n        oai_setting: 'pres_pen_openai',\n        type: 'input',\n    },\n    top_p: {\n        selector: '#top_p_openai',\n        oai_setting: 'top_p_openai',\n        type: 'input',\n    },\n    repetition_penalty: {\n        selector: '#repetition_penalty_openai',\n        oai_setting: 'repetition_penalty_openai',\n        type: 'input',\n    },\n    min_p: {\n        selector: '#min_p_openai',\n        oai_setting: 'min_p_openai',\n        type: 'input',\n    },\n    top_k: {\n        selector: '#top_k_openai',\n        oai_setting: 'top_k_openai',\n        type: 'input',\n    },\n    top_a: {\n        selector: '#top_a_openai',\n        oai_setting: 'top_a_openai',\n        type: 'input',\n    },\n    seed: {\n        selector: '#seed_openai',\n        oai_setting: 'seed',\n        type: 'input',\n    },\n    squash_system_messages: {\n        selector: '#squash_system_messages',\n        oai_setting: 'squash_system_messages',\n        type: 'checkbox',\n    },\n    reasoning_effort: {\n        selector: '#openai_reasoning_effort',\n        oai_setting: 'reasoning_effort',\n        type: 'input',\n    },\n    show_thoughts: {\n        selector: '#openai_show_thoughts',\n        oai_setting: 'show_thoughts',\n        type: 'checkbox',\n    },\n    request_images: {\n        selector: '#openai_request_images',\n        oai_setting: 'request_images',\n        type: 'checkbox',\n    },\n    function_calling: {\n        selector: '#openai_function_calling',\n        oai_setting: 'function_calling',\n        type: 'checkbox',\n    },\n    enable_web_search: {\n        selector: '#openai_enable_web_search',\n        oai_setting: 'enable_web_search',\n        type: 'checkbox',\n    },\n    image_inlining: {\n        selector: '#openai_image_inlining',\n        oai_setting: 'image_inlining',\n        type: 'checkbox',\n    },\n    inline_image_quality: {\n        selector: '#openai_inline_image_quality',\n        oai_setting: 'inline_image_quality',\n        type: 'input',\n    },\n    video_inlining: {\n        selector: '#openai_video_inlining',\n        oai_setting: 'video_inlining',\n        type: 'checkbox',\n    },\n    names_behavior: {\n        selector: '#names_behavior',\n        oai_setting: 'names_behavior',\n        type: 'input',\n    },\n    wrap_in_quotes: {\n        selector: '#wrap_in_quotes',\n        oai_setting: 'wrap_in_quotes',\n        type: 'checkbox',\n    },\n    prompts: {\n        selector: '#prompts',\n        oai_setting: 'prompts',\n        type: 'none',\n    },\n    prompt_order: {\n        selector: '#prompt_order',\n        oai_setting: 'prompt_order',\n        type: 'none',\n    },\n    extensions: {\n        selector: '#extensions',\n        oai_setting: 'extensions',\n        type: 'none',\n    },\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFFRCxPQUFPLEVBQUU7UUFDUCxRQUFRLEVBQUUsVUFBVTtRQUNwQixXQUFXLEVBQUUsU0FBUztRQUN0QixJQUFJLEVBQUUsTUFBTTtLQUNiO0lBQ0QsWUFBWSxFQUFFO1FBQ1osUUFBUSxFQUFFLGVBQWU7UUFDekIsV0FBVyxFQUFFLGNBQWM7UUFDM0IsSUFBSSxFQUFFLE1BQU07S0FDYjtJQUVELFVBQVUsRUFBRTtRQUNWLFFBQVEsRUFBRSxhQUFhO1FBQ3ZCLFdBQVcsRUFBRSxZQUFZO1FBQ3pCLElBQUksRUFBRSxNQUFNO0tBQ2I7Q0FDTyxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBhdGliaWxpdHkudHM/ODUwYyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB3b3JsZF9uYW1lcyB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3dvcmxkLWluZm8nO1xuXG4vKipcbiAqIFJlbG9hZHMgdGhlIGVkaXRvciB3aXRoIHRoZSBzcGVjaWZpZWQgd29ybGQgaW5mbyBmaWxlXG4gKiBAcGFyYW0gZmlsZSBUaGUgZmlsZSB0byBsb2FkIGluIHRoZSBlZGl0b3JcbiAqIEBwYXJhbSBsb2FkSWZOb3RTZWxlY3RlZCBJbmRpY2F0ZXMgd2hldGhlciB0byBsb2FkIHRoZSBmaWxlIGV2ZW4gaWYgaXQncyBub3QgY3VycmVudGx5IHNlbGVjdGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZWxvYWRFZGl0b3IoZmlsZTogc3RyaW5nLCBsb2FkX2lmX25vdF9zZWxlY3RlZDogYm9vbGVhbiA9IGZhbHNlKSB7XG4gIGNvbnN0IGN1cnJlbnRfaW5kZXggPSBOdW1iZXIoJCgnI3dvcmxkX2VkaXRvcl9zZWxlY3QnKS52YWwoKSk7XG4gIGNvbnN0IHNlbGVjdGVkX2luZGV4ID0gd29ybGRfbmFtZXMuaW5kZXhPZihmaWxlKTtcbiAgaWYgKHNlbGVjdGVkX2luZGV4ICE9PSAtMSAmJiAobG9hZF9pZl9ub3Rfc2VsZWN0ZWQgfHwgY3VycmVudF9pbmRleCA9PT0gc2VsZWN0ZWRfaW5kZXgpKSB7XG4gICAgJCgnI3dvcmxkX2VkaXRvcl9zZWxlY3QnKS52YWwoc2VsZWN0ZWRfaW5kZXgpLnRyaWdnZXIoJ2NoYW5nZScpO1xuICB9XG59XG5cbmV4cG9ydCBjb25zdCByZWxvYWRFZGl0b3JEZWJvdW5jZWQgPSBfLmRlYm91bmNlKHJlbG9hZEVkaXRvciwgMTAwMCk7XG5cbmV4cG9ydCBjb25zdCBzZXR0aW5nc1RvVXBkYXRlID0ge1xuICBtYXhfY29udGV4dF91bmxvY2tlZDoge1xuICAgIHNlbGVjdG9yOiAnI29haV9tYXhfY29udGV4dF91bmxvY2tlZCcsXG4gICAgb2FpX3NldHRpbmc6ICdtYXhfY29udGV4dF91bmxvY2tlZCcsXG4gICAgdHlwZTogJ2NoZWNrYm94JyxcbiAgfSxcbiAgb3BlbmFpX21heF9jb250ZXh0OiB7XG4gICAgc2VsZWN0b3I6ICcjb3BlbmFpX21heF9jb250ZXh0JyxcbiAgICBvYWlfc2V0dGluZzogJ29wZW5haV9tYXhfY29udGV4dCcsXG4gICAgdHlwZTogJ2lucHV0JyxcbiAgfSxcbiAgb3BlbmFpX21heF90b2tlbnM6IHtcbiAgICBzZWxlY3RvcjogJyNvcGVuYWlfbWF4X3Rva2VucycsXG4gICAgb2FpX3NldHRpbmc6ICdvcGVuYWlfbWF4X3Rva2VucycsXG4gICAgdHlwZTogJ2lucHV0JyxcbiAgfSxcbiAgbjoge1xuICAgIHNlbGVjdG9yOiAnI25fb3BlbmFpJyxcbiAgICBvYWlfc2V0dGluZzogJ24nLFxuICAgIHR5cGU6ICdpbnB1dCcsXG4gIH0sXG5cbiAgc3RyZWFtX29wZW5haToge1xuICAgIHNlbGVjdG9yOiAnI3N0cmVhbV90b2dnbGUnLFxuICAgIG9haV9zZXR0aW5nOiAnc3RyZWFtX29wZW5haScsXG4gICAgdHlwZTogJ2NoZWNrYm94JyxcbiAgfSxcblxuICB0ZW1wZXJhdHVyZToge1xuICAgIHNlbGVjdG9yOiAnI3RlbXBfb3BlbmFpJyxcbiAgICBvYWlfc2V0dGluZzogJ3RlbXBfb3BlbmFpJyxcbiAgICB0eXBlOiAnaW5wdXQnLFxuICB9LFxuICBmcmVxdWVuY3lfcGVuYWx0eToge1xuICAgIHNlbGVjdG9yOiAnI2ZyZXFfcGVuX29wZW5haScsXG4gICAgb2FpX3NldHRpbmc6ICdmcmVxX3Blbl9vcGVuYWknLFxuICAgIHR5cGU6ICdpbnB1dCcsXG4gIH0sXG4gIHByZXNlbmNlX3BlbmFsdHk6IHtcbiAgICBzZWxlY3RvcjogJyNwcmVzX3Blbl9vcGVuYWknLFxuICAgIG9haV9zZXR0aW5nOiAncHJlc19wZW5fb3BlbmFpJyxcbiAgICB0eXBlOiAnaW5wdXQnLFxuICB9LFxuICB0b3BfcDoge1xuICAgIHNlbGVjdG9yOiAnI3RvcF9wX29wZW5haScsXG4gICAgb2FpX3NldHRpbmc6ICd0b3BfcF9vcGVuYWknLFxuICAgIHR5cGU6ICdpbnB1dCcsXG4gIH0sXG4gIHJlcGV0aXRpb25fcGVuYWx0eToge1xuICAgIHNlbGVjdG9yOiAnI3JlcGV0aXRpb25fcGVuYWx0eV9vcGVuYWknLFxuICAgIG9haV9zZXR0aW5nOiAncmVwZXRpdGlvbl9wZW5hbHR5X29wZW5haScsXG4gICAgdHlwZTogJ2lucHV0JyxcbiAgfSxcbiAgbWluX3A6IHtcbiAgICBzZWxlY3RvcjogJyNtaW5fcF9vcGVuYWknLFxuICAgIG9haV9zZXR0aW5nOiAnbWluX3Bfb3BlbmFpJyxcbiAgICB0eXBlOiAnaW5wdXQnLFxuICB9LFxuICB0b3Bfazoge1xuICAgIHNlbGVjdG9yOiAnI3RvcF9rX29wZW5haScsXG4gICAgb2FpX3NldHRpbmc6ICd0b3Bfa19vcGVuYWknLFxuICAgIHR5cGU6ICdpbnB1dCcsXG4gIH0sXG4gIHRvcF9hOiB7XG4gICAgc2VsZWN0b3I6ICcjdG9wX2Ffb3BlbmFpJyxcbiAgICBvYWlfc2V0dGluZzogJ3RvcF9hX29wZW5haScsXG4gICAgdHlwZTogJ2lucHV0JyxcbiAgfSxcblxuICBzZWVkOiB7XG4gICAgc2VsZWN0b3I6ICcjc2VlZF9vcGVuYWknLFxuICAgIG9haV9zZXR0aW5nOiAnc2VlZCcsXG4gICAgdHlwZTogJ2lucHV0JyxcbiAgfSxcblxuICBzcXVhc2hfc3lzdGVtX21lc3NhZ2VzOiB7XG4gICAgc2VsZWN0b3I6ICcjc3F1YXNoX3N5c3RlbV9tZXNzYWdlcycsXG4gICAgb2FpX3NldHRpbmc6ICdzcXVhc2hfc3lzdGVtX21lc3NhZ2VzJyxcbiAgICB0eXBlOiAnY2hlY2tib3gnLFxuICB9LFxuXG4gIHJlYXNvbmluZ19lZmZvcnQ6IHtcbiAgICBzZWxlY3RvcjogJyNvcGVuYWlfcmVhc29uaW5nX2VmZm9ydCcsXG4gICAgb2FpX3NldHRpbmc6ICdyZWFzb25pbmdfZWZmb3J0JyxcbiAgICB0eXBlOiAnaW5wdXQnLFxuICB9LFxuICBzaG93X3Rob3VnaHRzOiB7XG4gICAgc2VsZWN0b3I6ICcjb3BlbmFpX3Nob3dfdGhvdWdodHMnLFxuICAgIG9haV9zZXR0aW5nOiAnc2hvd190aG91Z2h0cycsXG4gICAgdHlwZTogJ2NoZWNrYm94JyxcbiAgfSxcbiAgcmVxdWVzdF9pbWFnZXM6IHtcbiAgICBzZWxlY3RvcjogJyNvcGVuYWlfcmVxdWVzdF9pbWFnZXMnLFxuICAgIG9haV9zZXR0aW5nOiAncmVxdWVzdF9pbWFnZXMnLFxuICAgIHR5cGU6ICdjaGVja2JveCcsXG4gIH0sXG4gIGZ1bmN0aW9uX2NhbGxpbmc6IHtcbiAgICBzZWxlY3RvcjogJyNvcGVuYWlfZnVuY3Rpb25fY2FsbGluZycsXG4gICAgb2FpX3NldHRpbmc6ICdmdW5jdGlvbl9jYWxsaW5nJyxcbiAgICB0eXBlOiAnY2hlY2tib3gnLFxuICB9LFxuICBlbmFibGVfd2ViX3NlYXJjaDoge1xuICAgIHNlbGVjdG9yOiAnI29wZW5haV9lbmFibGVfd2ViX3NlYXJjaCcsXG4gICAgb2FpX3NldHRpbmc6ICdlbmFibGVfd2ViX3NlYXJjaCcsXG4gICAgdHlwZTogJ2NoZWNrYm94JyxcbiAgfSxcbiAgaW1hZ2VfaW5saW5pbmc6IHtcbiAgICBzZWxlY3RvcjogJyNvcGVuYWlfaW1hZ2VfaW5saW5pbmcnLFxuICAgIG9haV9zZXR0aW5nOiAnaW1hZ2VfaW5saW5pbmcnLFxuICAgIHR5cGU6ICdjaGVja2JveCcsXG4gIH0sXG4gIGlubGluZV9pbWFnZV9xdWFsaXR5OiB7XG4gICAgc2VsZWN0b3I6ICcjb3BlbmFpX2lubGluZV9pbWFnZV9xdWFsaXR5JyxcbiAgICBvYWlfc2V0dGluZzogJ2lubGluZV9pbWFnZV9xdWFsaXR5JyxcbiAgICB0eXBlOiAnaW5wdXQnLFxuICB9LFxuICB2aWRlb19pbmxpbmluZzoge1xuICAgIHNlbGVjdG9yOiAnI29wZW5haV92aWRlb19pbmxpbmluZycsXG4gICAgb2FpX3NldHRpbmc6ICd2aWRlb19pbmxpbmluZycsXG4gICAgdHlwZTogJ2NoZWNrYm94JyxcbiAgfSxcblxuICBuYW1lc19iZWhhdmlvcjoge1xuICAgIHNlbGVjdG9yOiAnI25hbWVzX2JlaGF2aW9yJyxcbiAgICBvYWlfc2V0dGluZzogJ25hbWVzX2JlaGF2aW9yJyxcbiAgICB0eXBlOiAnaW5wdXQnLFxuICB9LFxuICB3cmFwX2luX3F1b3Rlczoge1xuICAgIHNlbGVjdG9yOiAnI3dyYXBfaW5fcXVvdGVzJyxcbiAgICBvYWlfc2V0dGluZzogJ3dyYXBfaW5fcXVvdGVzJyxcbiAgICB0eXBlOiAnY2hlY2tib3gnLFxuICB9LFxuXG4gIHByb21wdHM6IHtcbiAgICBzZWxlY3RvcjogJyNwcm9tcHRzJyxcbiAgICBvYWlfc2V0dGluZzogJ3Byb21wdHMnLFxuICAgIHR5cGU6ICdub25lJyxcbiAgfSxcbiAgcHJvbXB0X29yZGVyOiB7XG4gICAgc2VsZWN0b3I6ICcjcHJvbXB0X29yZGVyJyxcbiAgICBvYWlfc2V0dGluZzogJ3Byb21wdF9vcmRlcicsXG4gICAgdHlwZTogJ25vbmUnLFxuICB9LFxuXG4gIGV4dGVuc2lvbnM6IHtcbiAgICBzZWxlY3RvcjogJyNleHRlbnNpb25zJyxcbiAgICBvYWlfc2V0dGluZzogJ2V4dGVuc2lvbnMnLFxuICAgIHR5cGU6ICdub25lJyxcbiAgfSxcbn0gYXMgY29uc3Q7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/compatibility.ts\n\n}")},"./src/component/audio/index.ts":
/*!**************************************!*\
  !*** ./src/component/audio/index.ts ***!
  \**************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   defaultAudioSettings: () => (/* binding */ defaultAudioSettings),\n/* harmony export */   getAudioUrl: () => (/* binding */ getAudioUrl),\n/* harmony export */   getAudioUrlWithCacheBusting: () => (/* binding */ getAudioUrlWithCacheBusting),\n/* harmony export */   getNextFileByMode: () => (/* binding */ getNextFileByMode),\n/* harmony export */   initAudioComponents: () => (/* binding */ initAudioComponents),\n/* harmony export */   initAudioEventListeners: () => (/* binding */ initAudioEventListeners),\n/* harmony export */   initializeProgressBar: () => (/* binding */ initializeProgressBar),\n/* harmony export */   list_BGMS: () => (/* binding */ list_BGMS),\n/* harmony export */   list_ambients: () => (/* binding */ list_ambients),\n/* harmony export */   onAudioEnabledClick: () => (/* binding */ onAudioEnabledClick),\n/* harmony export */   playAudio: () => (/* binding */ playAudio),\n/* harmony export */   refreshAudioResources: () => (/* binding */ refreshAudioResources),\n/* harmony export */   toggleAudioControls: () => (/* binding */ toggleAudioControls),\n/* harmony export */   togglePlayPause: () => (/* binding */ togglePlayPause),\n/* harmony export */   updateAudio: () => (/* binding */ updateAudio),\n/* harmony export */   updateAudioSelect: () => (/* binding */ updateAudioSelect)\n/* harmony export */ });\n/* harmony import */ var _util_collapsible__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/util/collapsible */ \"./src/util/collapsible.ts\");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sillytavern/scripts/popup */ \"@sillytavern/scripts/popup\");\n/* harmony import */ var _sillytavern_scripts_RossAscends_mods__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @sillytavern/scripts/RossAscends-mods */ \"@sillytavern/scripts/RossAscends-mods\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_7__);\n\n\n\n\n\n\n\n\nlet isExtensionEnabled;\nlet isAudioEnabled;\nlet list_BGMS = [];\nlet list_ambients = [];\nlet bgmEnded = true;\nlet ambientEnded = true;\nconst templatePath = `${_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.extensionFolderPath}/src/component/audio`;\n// 定义默认音频设置\nconst defaultAudioSettings = {\n    audio_enabled: true,\n    bgm_enabled: true,\n    ambient_enabled: true,\n    bgm_mode: 'repeat',\n    bgm_muted: false,\n    bgm_volume: 50,\n    bgm_selected: null,\n    bgm_current_time: 0,\n    ambient_mode: 'stop',\n    ambient_muted: false,\n    ambient_volume: 50,\n    ambient_selected: null,\n    ambient_current_time: 0,\n    audio_cooldown: 0,\n};\n/**\n * 更新音频\n * @param type 音频类型 \"bgm\" 或 \"ambient\"\n * @param isUserInput 是否由用户操作触发-将导致音频中断\n */\nasync function updateAudio(type = 'bgm', isUserInput = false) {\n    if (!(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.audio_enabled')) {\n        return;\n    }\n    const isTypeEnabled = type === 'bgm' ? (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.bgm_enabled') : (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.ambient_enabled');\n    if (!isTypeEnabled) {\n        return;\n    }\n    const audioEnded = type === 'bgm' ? bgmEnded : ambientEnded;\n    const audioSelector = `#audio_${type}`;\n    if (!isUserInput && $(audioSelector).attr('src') != '' && !audioEnded) {\n        return;\n    }\n    let audio_url = '';\n    const playlist = await getAudioUrl(type);\n    if (isUserInput) {\n        audio_url =\n            type === 'bgm'\n                ? (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.bgm_selected') || playlist[0]\n                : (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.ambient_selected') || playlist[0];\n    }\n    else {\n        const mode = type === 'bgm' ? (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.bgm_mode') : (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.ambient_mode');\n        const selected = type === 'bgm' ? (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.bgm_selected') : (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.ambient_selected');\n        audio_url = getNextFileByMode(mode, playlist, selected);\n    }\n    if (!audio_url) {\n        return;\n    }\n    const audio = $(audioSelector)[0];\n    // 对于ambient类型，处理掉防缓存后缀\n    if (type === 'ambient') {\n        const cleanAudioSrc = audio.src.split('?')[0];\n        const cleanAudioUrl = audio_url.split('?')[0];\n        if (decodeURIComponent(cleanAudioSrc) === decodeURIComponent(cleanAudioUrl) && !audioEnded) {\n            return;\n        }\n    }\n    else if (decodeURIComponent(audio.src) === decodeURIComponent(audio_url) && !audioEnded) {\n        return;\n    }\n    // 设置audioEnded状态\n    if (type === 'bgm') {\n        bgmEnded = false;\n    }\n    else {\n        ambientEnded = false;\n    }\n    if (type === 'bgm') {\n        audio.src = audio_url;\n        audio.load();\n        await new Promise(resolve => {\n            const canPlayHandler = () => {\n                audio.removeEventListener('canplaythrough', canPlayHandler);\n                resolve();\n            };\n            if (audio.readyState >= HTMLMediaElement.HAVE_ENOUGH_DATA) {\n                resolve();\n            }\n            else {\n                audio.addEventListener('canplaythrough', canPlayHandler);\n            }\n        });\n        await playAudio(type);\n    }\n    else {\n        // 对于ambient类型，使用缓存破坏\n        const audioUrlWithCacheBusting = getAudioUrlWithCacheBusting(audio_url);\n        audio.src = audioUrlWithCacheBusting;\n        audio.load();\n        await new Promise(resolve => {\n            const canPlayHandler = () => {\n                audio.removeEventListener('canplaythrough', canPlayHandler);\n                resolve();\n            };\n            if (audio.readyState >= HTMLMediaElement.HAVE_ENOUGH_DATA) {\n                resolve();\n            }\n            else {\n                audio.addEventListener('canplaythrough', canPlayHandler);\n            }\n        });\n        await playAudio(type);\n    }\n    // 更新选中的音频\n    if (type === 'bgm') {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.bgm_selected', audio_url);\n    }\n    else {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.ambient_selected', audio_url);\n    }\n    // 更新选择器\n    const selectElement = $(`#audio_${type}_select`);\n    if (selectElement.val() !== audio_url) {\n        selectElement.val(audio_url);\n    }\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.saveSettingsDebounced)();\n}\n/**\n * 更新音频下拉选择菜单\n * @param type 音频类型 \"bgm\" 或 \"ambient\"\n */\nasync function updateAudioSelect(type = 'bgm') {\n    if (!(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)(`audio.${type}_enabled`)) {\n        return;\n    }\n    const selectElement = $(`#audio_${type}_select`);\n    selectElement.empty();\n    if (type === 'bgm') {\n        list_BGMS = await getAudioUrl('bgm');\n    }\n    else {\n        list_ambients = await getAudioUrl('ambient');\n    }\n    const audioList = type === 'bgm' ? list_BGMS : list_ambients;\n    let selectedSetting = type === 'bgm' ? (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.bgm_selected') : (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.ambient_selected');\n    if (audioList && audioList.length > 0) {\n        // 检查当前选择的音频是否在列表中，如果不在则选择第一个\n        if (!audioList.includes(selectedSetting)) {\n            loglevel__WEBPACK_IMPORTED_MODULE_7___default().warn(`[Audio] 当前选择的音频 ${selectedSetting} 不在列表中，自动选择列表第一个音频`);\n            selectedSetting = audioList[0];\n            if (type === 'bgm') {\n                (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.bgm_selected', selectedSetting);\n            }\n            else {\n                (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.ambient_selected', selectedSetting);\n            }\n            (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.saveSettingsDebounced)();\n        }\n        const audioFiles = Array.isArray(audioList) ? audioList : audioList.split(',').map(file => file.trim());\n        audioFiles.forEach((file) => {\n            const fileLabel = file.replace(/^.*[\\\\\\/]/, '').replace(/\\.[^/.]+$/, '');\n            selectElement.append(new Option(fileLabel, file));\n        });\n        selectElement.val(selectedSetting);\n    }\n    else {\n        loglevel__WEBPACK_IMPORTED_MODULE_7___default().warn(`[Audio] 暂无可用的 ${type.toUpperCase()} 资源`);\n    }\n}\n/**\n * 获取音频URL\n * @param type 音频类型 \"bgm\" 或 \"ambient\"\n * @returns 音频URL数组\n */\nasync function getAudioUrl(type = 'bgm') {\n    const typeKey = type === 'bgm' ? 'bgmurl' : 'ambienturl';\n    //@ts-ignore\n    const chatSpecificUrls = _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata.variables?.[typeKey] || [];\n    return chatSpecificUrls;\n}\n/**\n * 添加缓存参数防止缓存\n * @param originalUrl 原始URL\n */\nfunction getAudioUrlWithCacheBusting(originalUrl) {\n    if (!originalUrl)\n        return '';\n    const cacheBuster = new Date().getTime();\n    const separator = originalUrl.includes('?') ? '&' : '?';\n    return `${originalUrl}${separator}_=${cacheBuster}`;\n}\n/**\n * 根据播放模式获取下一个音频文件\n * @param mode 播放模式\n * @param playlist 播放列表\n * @param currentFile 当前文件\n */\nfunction getNextFileByMode(mode, playlist, currentFile) {\n    if (!playlist || playlist.length === 0) {\n        return '';\n    }\n    switch (mode) {\n        case 'repeat':\n            return playlist[0];\n        case 'single':\n            return currentFile || playlist[0];\n        case 'random': {\n            const filteredPlaylist = playlist.filter(file => file !== currentFile);\n            if (filteredPlaylist.length === 0) {\n                return playlist[0];\n            }\n            const randomIndex = Math.floor(Math.random() * filteredPlaylist.length);\n            return filteredPlaylist[randomIndex];\n        }\n        case 'stop':\n            return '';\n        default:\n            return playlist[0];\n    }\n}\n/**\n * 切换音频控件状态\n * @param type 音频类型 \"bgm\" 或 \"ambient\"\n * @param status 是否启用\n */\nfunction toggleAudioControls(type, status = 'enable') {\n    const isMainEnabled = $('#audio_enabled').prop('checked');\n    const shouldEnable = isMainEnabled && status === 'enable';\n    const controlIds = [\n        `#audio_${type}_play_pause`,\n        `#audio_${type}_mute`,\n        `#audio_${type}_mode`,\n        `#audio_${type}_select`,\n        `#audio_${type}_volume_slider`,\n    ];\n    controlIds.forEach(id => {\n        $(id).prop('disabled', !shouldEnable);\n    });\n}\n/**\n * 点击音频启用按钮时的通用处理函数\n * @param type 音频类型 \"bgm\" 或 \"ambient\"\n */\nasync function onAudioEnabledClick(type = 'bgm') {\n    const enabled = $(`#enable_${type}`).prop('checked');\n    (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)(`audio.${type}_enabled`, enabled);\n    if (enabled) {\n        toggleAudioControls(type, 'enable');\n        await updateAudio(type, false);\n    }\n    else {\n        $(`#audio_${type}`)[0].pause();\n        toggleAudioControls(type, 'disable');\n    }\n}\n/**\n * 初始化音频事件监听\n * @param type 音频类型 \"bgm\" 或 \"ambient\"\n */\nfunction initAudioEventListeners(type) {\n    $(`#audio_${type}`).on('ended', async function () {\n        if (type === 'bgm') {\n            bgmEnded = true;\n        }\n        else {\n            ambientEnded = true;\n        }\n        const mode = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)(`audio.${type}_mode`);\n        if (mode === 'stop') {\n            return;\n        }\n        await updateAudio(type, false);\n    });\n}\n/**\n * 初始化进度条\n * @param type 音频类型 \"bgm\" 或 \"ambient\"\n */\nfunction initializeProgressBar(type) {\n    const $audioElement = $(`#audio_${type}`);\n    const $progressSlider = $(`#audio_${type}_progress_slider`);\n    $audioElement.on('timeupdate', function () {\n        if (!isNaN(this.duration)) {\n            const progressPercent = (this.currentTime / this.duration) * 100;\n            $progressSlider.val(progressPercent);\n        }\n        const cooldownBGM = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.audio_cooldown');\n        const remainingTime = this.duration - this.currentTime;\n        if (cooldownBGM > 0 && remainingTime <= cooldownBGM && !this.isFadingOut) {\n            const initialVolume = this.volume;\n            const fadeStep = initialVolume / (cooldownBGM * 10);\n            this.isFadingOut = true;\n            const fadeOutInterval = setInterval(() => {\n                if (this.volume > 0) {\n                    this.volume = Math.max(0, this.volume - fadeStep);\n                }\n                else {\n                    clearInterval(fadeOutInterval);\n                    this.isFadingOut = false;\n                }\n            }, 100);\n        }\n    });\n    $audioElement.on('play', function () {\n        const cooldownBGM = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.audio_cooldown');\n        const targetVolume = $(`#audio_${type}_volume_slider`).val() / 100;\n        if (cooldownBGM <= 0) {\n            this.volume = targetVolume;\n            return;\n        }\n        this.volume = 0;\n        const fadeStep = targetVolume / (cooldownBGM * 10);\n        const fadeInInterval = setInterval(() => {\n            if (this.volume < targetVolume) {\n                this.volume = Math.min(targetVolume, this.volume + fadeStep);\n            }\n            else {\n                clearInterval(fadeInInterval);\n            }\n        }, 100);\n    });\n    $audioElement.on('loadedmetadata', function () {\n        if (!isNaN(this.duration)) {\n            $progressSlider.attr('max', 100);\n        }\n    });\n    $progressSlider.on('input', function () {\n        const value = $(this).val();\n        if (!isNaN($audioElement[0].duration)) {\n            $audioElement[0].currentTime = (value / 100) * $audioElement[0].duration;\n        }\n    });\n}\n/**\n * 音量滑块滚轮调节事件处理\n * @param e 事件对象\n */\nfunction onVolumeSliderWheelEvent(e) {\n    const slider = $(this);\n    e.preventDefault();\n    e.stopPropagation();\n    const delta = e.deltaY / 20;\n    const sliderVal = Number(slider.val());\n    let newVal = sliderVal - delta;\n    if (newVal < 0) {\n        newVal = 0;\n    }\n    else if (newVal > 100) {\n        newVal = 100;\n    }\n    slider.val(newVal).trigger('input');\n}\n/**\n * 长按音量控制按钮出现音量调节\n * @param volumeControlId 音量控制按钮ID\n * @param iconId 音量控制按钮图标ID\n */\nfunction handleLongPress(volumeControlId, iconId) {\n    const $volumeControl = $(`#${volumeControlId}`);\n    const $icon = $(`#${iconId}`);\n    let pressTimer;\n    if ((0,_sillytavern_scripts_RossAscends_mods__WEBPACK_IMPORTED_MODULE_5__.isMobile)()) {\n        $icon.on('touchstart', function (e) {\n            pressTimer = setTimeout(() => {\n                $volumeControl.css('display', 'block');\n            }, 500);\n        });\n        $icon.on('touchend', function (e) {\n            clearTimeout(pressTimer);\n        });\n        $(document).on('click', function (event) {\n            if (!$icon.is(event.target) &&\n                $icon.has(event.target).length === 0 &&\n                !$volumeControl.is(event.target) &&\n                $volumeControl.has(event.target).length === 0) {\n                $volumeControl.css('display', 'none');\n            }\n        });\n    }\n}\n/**\n * 刷新音频资源\n */\nasync function refreshAudioResources() {\n    updateAudioSelect('bgm');\n    updateAudioSelect('ambient');\n}\n/**\n * 打开音频资源管理弹窗\n * @param typeKey 音频类型 \"bgmurl\" 或 \"ambienturl\"\n */\nasync function openUrlManagerPopup(typeKey) {\n    const urlManager = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__.renderExtensionTemplateAsync)(`${templatePath}`, 'audio_url_manager'));\n    urlManager.prepend(`\n    <style>\n      #saved_audio_url.empty::after {\n        content: \"暂无音频\";\n        color: #999;\n        margin-top: 20px;\n        font-size: 12px;\n      }\n    </style>\n  `);\n    const savedAudioUrl = urlManager.find('#saved_audio_url').empty();\n    const urlTemplate = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__.renderExtensionTemplateAsync)(`${templatePath}`, 'audio_url_template'));\n    if (!_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata.variables) {\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata.variables = {};\n    }\n    let urlValue = _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata.variables[typeKey];\n    if (!urlValue) {\n        urlValue = [];\n        savedAudioUrl.addClass('empty');\n    }\n    else {\n        try {\n            if (urlValue.length === 0) {\n                savedAudioUrl.addClass('empty');\n            }\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_7___default().error(`[Audio] Failed to parse ${typeKey}:`, error);\n            return null;\n        }\n    }\n    const updatedUrls = {};\n    let newUrlOrder = [...urlValue];\n    function renderUrl(container, url) {\n        const urlHtml = urlTemplate.clone();\n        let fileName;\n        if (url.includes('/')) {\n            const parts = url.split('/');\n            fileName = parts[parts.length - 1] || parts[parts.length - 2];\n        }\n        else {\n            fileName = url;\n        }\n        const id = fileName.replace(/\\./g, '-');\n        urlHtml.attr('id', id);\n        urlHtml.find('.audio_url_name').text(fileName);\n        urlHtml.find('.audio_url_name').attr('data-url', url);\n        urlHtml.find('.edit_existing_url').on('click', async function () {\n            const currentUrl = urlHtml.find('.audio_url_name').attr('data-url');\n            if (!currentUrl) {\n                loglevel__WEBPACK_IMPORTED_MODULE_7___default().error('[Audio] No URL found for this element.');\n                return;\n            }\n            const inputUrl = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__.callGenericPopup)('', _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__.POPUP_TYPE.INPUT, currentUrl);\n            if (!inputUrl) {\n                return;\n            }\n            const newFileName = inputUrl.split('/').pop();\n            const newId = newFileName.replace(/\\./g, '-');\n            urlHtml.attr('id', newId);\n            urlHtml.find('.audio_url_name').text(newFileName);\n            urlHtml.find('.audio_url_name').attr('data-url', inputUrl);\n            updatedUrls[currentUrl] = inputUrl;\n        });\n        urlHtml.find('.delete_url').on('click', async function () {\n            const confirmDelete = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__.callGenericPopup)('确认要删除此链接?', _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__.POPUP_TYPE.CONFIRM);\n            if (!confirmDelete) {\n                return;\n            }\n            // 仅从DOM中移除元素\n            urlHtml.remove();\n            // 检查是否需要显示空状态提示\n            if (savedAudioUrl.find('.audio_url_name').length === 0) {\n                savedAudioUrl.addClass('empty');\n            }\n        });\n        container.append(urlHtml);\n    }\n    urlValue.forEach(url => {\n        renderUrl(savedAudioUrl, url);\n    });\n    urlManager.find('#import_button').on('click', async function () {\n        const newUrls = await openUrlImportPopup();\n        if (!newUrls) {\n            loglevel__WEBPACK_IMPORTED_MODULE_7___default().debug(`[Audio] ${typeKey} URL导入已取消`);\n            return;\n        }\n        savedAudioUrl.removeClass('empty');\n        newUrls.forEach(url => {\n            renderUrl(savedAudioUrl, url);\n        });\n    });\n    savedAudioUrl.sortable({\n        delay: (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_6__.getSortableDelay)(),\n        handle: '.drag-handle',\n        stop: function () {\n            newUrlOrder = [];\n            savedAudioUrl.find('.audio_url_name').each(function () {\n                const newUrl = $(this).attr('data-url');\n                if (newUrl) {\n                    newUrlOrder.push(newUrl);\n                }\n            });\n        },\n    });\n    const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__.callGenericPopup)(urlManager, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__.POPUP_TYPE.CONFIRM, '', {\n        okButton: `确认`,\n        cancelButton: `取消`,\n    });\n    if (!result) {\n        return;\n    }\n    else {\n        // 直接读取所有data-url属性，生成新的URL列表\n        const newUrlList = [];\n        savedAudioUrl.find('.audio_url_name').each(function () {\n            const url = $(this).attr('data-url');\n            if (url) {\n                newUrlList.push(url);\n            }\n        });\n        // 检查当前播放的音频是否在新的列表中\n        const currentBgmUrl = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.bgm_selected');\n        const currentAmbientUrl = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.ambient_selected');\n        // 如果当前播放的音频不在新的列表中，停止播放\n        if (typeKey === 'bgmurl' && currentBgmUrl && !newUrlList.includes(currentBgmUrl)) {\n            const bgmAudio = $('#audio_bgm')[0];\n            bgmAudio.pause();\n            bgmEnded = true;\n        }\n        else if (typeKey === 'ambienturl' && currentAmbientUrl && !newUrlList.includes(currentAmbientUrl)) {\n            const ambientAudio = $('#audio_ambient')[0];\n            ambientAudio.pause();\n            ambientEnded = true;\n        }\n        // 更新并保存新的URL列表\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata.variables[typeKey] = newUrlList;\n        (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__.saveMetadataDebounced)();\n        if (typeKey === 'bgmurl') {\n            updateAudioSelect('bgm');\n        }\n        else if (typeKey === 'ambienturl') {\n            updateAudioSelect('ambient');\n        }\n    }\n}\n/**\n * 点击音频总开关时的处理函数\n */\nasync function handleAudioToggle(enable = true, userInput = true) {\n    if (userInput) {\n        isAudioEnabled = enable;\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.audio_enabled', isAudioEnabled);\n    }\n    if (enable) {\n        $('#audio-player-content').removeClass('audio-disabled-mask');\n        if (isExtensionEnabled === undefined) {\n            isExtensionEnabled = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('enabled_extension');\n        }\n        if (!isExtensionEnabled) {\n            return;\n        }\n        toggleAudioControls('bgm', 'enable');\n        toggleAudioControls('ambient', 'enable');\n        const bgmUrl = await getAudioUrl('bgm');\n        const ambientUrl = await getAudioUrl('ambient');\n        if (bgmUrl.length > 0) {\n            const bgmAudioElement = $('#audio_bgm')[0];\n            try {\n                await bgmAudioElement.play();\n            }\n            catch (error) {\n                throw new Error('[Audio] 播放音乐失败：没有提供有效源');\n            }\n        }\n        if (ambientUrl.length > 0) {\n            const ambientAudioElement = $('#audio_ambient')[0];\n            try {\n                await ambientAudioElement.play();\n            }\n            catch (error) {\n                throw new Error('[Audio] 播放音效失败：没有提供有效源');\n            }\n        }\n    }\n    else {\n        $('#audio-player-content').addClass('audio-disabled-mask');\n        $('#audio_bgm')[0].pause();\n        $('#audio_ambient')[0].pause();\n        toggleAudioControls('bgm', 'disable');\n        toggleAudioControls('ambient', 'disable');\n    }\n}\n/**\n * 播放音频\n * @param type 音频类型 \"bgm\" 或 \"ambient\"\n */\nasync function playAudio(type) {\n    if (!(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('enabled_extension') ||\n        !(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.audio_enabled') ||\n        !(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)(`audio.${type}_enabled`)) {\n        return;\n    }\n    const audioElement = $(`#audio_${type}`)[0];\n    const playPauseIcon = $(`#audio_${type}_play_pause_icon`);\n    if (audioElement.error && audioElement.error.code === 4) {\n        loglevel__WEBPACK_IMPORTED_MODULE_7___default().warn(`The ${type} element has no supported sources. Trying to reload selected audio from dropdown...`);\n        const selectedAudio = $(`#audio_${type}_select`).val();\n        if (!selectedAudio) {\n            loglevel__WEBPACK_IMPORTED_MODULE_7___default().error(`No audio selected for ${type}`);\n            return;\n        }\n        audioElement.src = selectedAudio;\n        audioElement.load();\n    }\n    try {\n        await audioElement.play();\n        playPauseIcon.removeClass('fa-play');\n        playPauseIcon.addClass('fa-pause');\n    }\n    catch (error) {\n        loglevel__WEBPACK_IMPORTED_MODULE_7___default().error(`[Audio] 播放 ${type} 音频时出错:`, error);\n    }\n}\n/**\n * 点击各自音频模式按钮时的通用处理函数\n * @param type 音频类型 \"bgm\" 或 \"ambient\"\n */\nasync function onAudioModeClick(type) {\n    const modes = [\n        { mode: 'repeat', icon: 'fa-repeat' },\n        { mode: 'random', icon: 'fa-random' },\n        { mode: 'single', icon: 'fa-redo-alt' },\n        { mode: 'stop', icon: 'fa-cancel' },\n    ];\n    const currentModeIndex = modes.findIndex(m => m.mode === (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)(`audio.${type}_mode`));\n    const nextModeIndex = (currentModeIndex + 1) % modes.length;\n    (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)(`audio.${type}_mode`, modes[nextModeIndex].mode);\n    $(`#audio_${type}_mode_icon`).removeClass('fa-repeat fa-random fa-redo-alt fa-cancel');\n    $(`#audio_${type}_mode_icon`).addClass(modes[nextModeIndex].icon);\n}\n/**\n * 音频选择变化时的通用处理函数\n * @param type 音频类型 \"bgm\" 或 \"ambient\"\n */\nasync function onAudioSelectChange(type) {\n    (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)(`audio.${type}_selected`, $(`#audio_${type}_select`).val());\n    await updateAudio(type, true);\n}\n/**\n * 输入冷却时间的处理函数\n * @param type 音频类型 \"bgm\" 或 \"ambient\"\n */\nasync function onAudioCooldownInput() {\n    (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.audio_cooldown', ~~$(`#audio_cooldown`).val());\n}\n/**\n * 音频音量变化时的通用处理函数\n * @param type 音频类型 \"bgm\" 或 \"ambient\"\n */\nasync function onAudioVolumeChange(type) {\n    (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)(`audio.${type}_volume`, ~~$(`#audio_${type}_volume_slider`).val());\n    $(`#audio_${type}`).prop('volume', (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)(`audio.${type}_volume`) * 0.01);\n    $(`#audio_${type}_volume`).text((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)(`audio.${type}_volume`));\n}\n/**\n * 点击音频静音按钮时的通用处理函数\n * @param type 音频类型 \"bgm\" 或 \"ambient\"\n */\nasync function onAudioMuteClick(type) {\n    (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)(`audio.${type}_muted`, !(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)(`audio.${type}_muted`));\n    $(`#audio_${type}_mute_icon`).toggleClass('fa-volume-high');\n    $(`#audio_${type}_mute_icon`).toggleClass('fa-volume-mute');\n    $(`#audio_${type}`).prop('muted', !$(`#audio_${type}`).prop('muted'));\n    $(`#audio_${type}_mute`).toggleClass('redOverlayGlow');\n}\n/**\n * 切换播放/暂停状态\n * @param type 音频类型 \"bgm\" 或 \"ambient\"\n */\nasync function togglePlayPause(type) {\n    if (!(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.audio_enabled')) {\n        return;\n    }\n    const audioElement = $(`#audio_${type}`)[0];\n    const playPauseIcon = $(`#audio_${type}_play_pause_icon`);\n    if (audioElement.paused) {\n        await playAudio(type);\n    }\n    else {\n        audioElement.pause();\n        playPauseIcon.removeClass('fa-pause');\n        playPauseIcon.addClass('fa-play');\n    }\n}\n/**\n * 打开URL导入弹窗\n * @param type 音频类型\n */\nasync function openUrlImportPopup() {\n    const input = (await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__.callGenericPopup)('输入要导入的网络音频链接（每行一个）', _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__.POPUP_TYPE.INPUT, ''));\n    if (!input) {\n        loglevel__WEBPACK_IMPORTED_MODULE_7___default().debug('[Audio] URL import cancelled');\n        return null;\n    }\n    const urlArray = input\n        .trim()\n        .split('\\n')\n        .map((url) => url.trim())\n        .filter((url) => url !== '');\n    return Array.from(new Set(urlArray));\n}\n// 聊天更改时的事件处理\n_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.eventSource.on(_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.event_types.CHAT_CHANGED, async () => {\n    const $bgmPlayer = $('#audio_bgm')[0];\n    const $ambientPlayer = $('#audio_ambient')[0];\n    if ($bgmPlayer && !$bgmPlayer.paused) {\n        $bgmPlayer.pause();\n    }\n    if ($ambientPlayer && !$ambientPlayer.paused) {\n        $ambientPlayer.pause();\n    }\n    await refreshAudioResources();\n    loglevel__WEBPACK_IMPORTED_MODULE_7___default().info('[Audio] 聊天已更改，音频资源刷新完成');\n});\n/** 初始化样式\n * @param type 音频类型 \"bgm\" 或 \"ambient\"\n */\nfunction initAudioStyles(type) {\n    // 隐藏默认播放器样式\n    $(`#audio_${type}`).hide();\n    if ((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)(`audio.${type}_muted`)) {\n        $(`#audio_${type}_mute_icon`).removeClass('fa-volume-high');\n        $(`#audio_${type}_mute_icon`).addClass('fa-volume-mute');\n        $(`#audio_${type}_mute`).addClass('redOverlayGlow');\n        $(`#audio_${type}`).prop('muted', true);\n    }\n    else {\n        $(`#audio_${type}_mute_icon`).addClass('fa-volume-high');\n        $(`#audio_${type}_mute_icon`).removeClass('fa-volume-mute');\n        $(`#audio_${type}_mute`).removeClass('redOverlayGlow');\n        $(`#audio_${type}`).prop('muted', false);\n    }\n    $(`#enable_${type}`).prop('checked', (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)(`audio.${type}_enabled`));\n    const audioElement = $(`#audio_${type}`)[0];\n    const playPauseIcon = $(`#audio_${type}_play_pause_icon`);\n    if (audioElement && audioElement.paused) {\n        playPauseIcon.removeClass('fa-pause');\n        playPauseIcon.addClass('fa-play');\n    }\n    else if (audioElement && !audioElement.paused) {\n        playPauseIcon.removeClass('fa-play');\n        playPauseIcon.addClass('fa-pause');\n    }\n    updateAudioSelect(type);\n    initializeProgressBar(type);\n}\n/**\n * 初始化所有音频相关组件和事件监听器\n */\nasync function initAudioComponents() {\n    // 加载音频播放器样式\n    await (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_6__.loadFileToDocument)(`/scripts/extensions/${_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.extensionFolderPath}/src/component/audio/style.css`, 'css');\n    isAudioEnabled = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.audio_enabled');\n    handleAudioToggle(isAudioEnabled, false);\n    $('#audio-enable-toggle')\n        .prop('checked', isAudioEnabled)\n        .on('click', (event) => handleAudioToggle(event.target.checked, true));\n    // 初始化折叠控件\n    _util_collapsible__WEBPACK_IMPORTED_MODULE_0__.Collapsible.initAll('#audio-player-header', {\n        headerSelector: '#audio-player-header',\n        contentSelector: '#audio-player-content',\n        initiallyExpanded: true,\n        animationDuration: {\n            expand: 280,\n            collapse: 250,\n        },\n    });\n    // 初始化音乐和音效样式\n    initAudioStyles('bgm');\n    initAudioStyles('ambient');\n    const audioTypes = ['bgm', 'ambient'];\n    const bindTypeEvents = (type, events) => {\n        events.forEach(({ selector, event, handler }) => {\n            $(`#${selector}`).on(event, () => handler(type));\n        });\n    };\n    audioTypes.forEach(type => {\n        $(`#enable_${type}`).on('click', () => onAudioEnabledClick(type));\n        bindTypeEvents(type, [\n            {\n                selector: `enable_${type}`,\n                event: 'click',\n                handler: onAudioEnabledClick,\n            },\n            {\n                selector: `audio_${type}_mode`,\n                event: 'click',\n                handler: onAudioModeClick,\n            },\n            {\n                selector: `audio_${type}_mute`,\n                event: 'click',\n                handler: onAudioMuteClick,\n            },\n            {\n                selector: `audio_${type}_volume_slider`,\n                event: 'input',\n                handler: onAudioVolumeChange,\n            },\n            {\n                selector: `audio_${type}_select`,\n                event: 'change',\n                handler: onAudioSelectChange,\n            },\n            {\n                selector: `audio_${type}_play_pause`,\n                event: 'click',\n                handler: togglePlayPause,\n            },\n        ]);\n        $('#audio_cooldown').on('input', onAudioCooldownInput).val((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.audio_cooldown'));\n        // 监听音频结束事件\n        initAudioEventListeners('bgm');\n        initAudioEventListeners('ambient');\n        const volumeSlider = $(`#audio_${type}_volume_slider`).get(0);\n        if (volumeSlider) {\n            volumeSlider.addEventListener('wheel', onVolumeSliderWheelEvent, {\n                passive: false,\n            });\n        }\n    });\n    $('#audio_refresh_assets').on('click', async () => {\n        await refreshAudioResources();\n    });\n    handleLongPress('bgm-volume-control', 'audio_bgm_mute_icon');\n    handleLongPress('ambient-volume-control', 'audio_ambient_mute_icon');\n    const urlManagerMap = {\n        bgm: 'bgmurl',\n        ambient: 'ambienturl',\n    };\n    audioTypes.forEach(type => {\n        $(`#${type}_manager_button`).on('click', async () => {\n            await openUrlManagerPopup(urlManagerMap[type]);\n            await refreshAudioResources();\n        });\n    });\n    const bgmAudio = $('#audio_bgm')[0];\n    const ambientAudio = $('#audio_ambient')[0];\n    const togglePlayPauseIcon = (audioElement, iconSelector) => {\n        const icon = $(iconSelector);\n        audioElement.addEventListener('play', () => icon.removeClass('fa-play').addClass('fa-pause'));\n        audioElement.addEventListener('pause', () => icon.removeClass('fa-pause').addClass('fa-play'));\n    };\n    togglePlayPauseIcon(bgmAudio, '#audio_bgm_play_pause_icon');\n    togglePlayPauseIcon(ambientAudio, '#audio_ambient_play_pause_icon');\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QztJQUVGLFVBQVUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUU7UUFDeEIsQ0FBQyxDQUFDLElBQUksSUFBSSxpQkFBaUIsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDbEQsTUFBTSxtQkFBbUIsQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUE0QixDQUFDLENBQUM7WUFDMUUsTUFBTSxxQkFBcUIsRUFBRSxDQUFDO1FBQ2hDLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxNQUFNLFFBQVEsR0FBRyxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFxQixDQUFDO0lBQ3hELE1BQU0sWUFBWSxHQUFHLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLENBQUMsQ0FBcUIsQ0FBQztJQUVoRSxNQUFNLG1CQUFtQixHQUFHLENBQUMsWUFBOEIsRUFBRSxZQUFvQixFQUFFLEVBQUU7UUFDbkYsTUFBTSxJQUFJLEdBQUcsQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDO1FBQzdCLFlBQVksQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLEVBQUUsR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUMsQ0FBQyxRQUFRLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQztRQUM5RixZQUFZLENBQUMsZ0JBQWdCLENBQUMsT0FBTyxFQUFFLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsVUFBVSxDQUFDLENBQUMsUUFBUSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUM7SUFDakcsQ0FBQyxDQUFDO0lBRUYsbUJBQW1CLENBQUMsUUFBUSxFQUFFLDRCQUE0QixDQUFDLENBQUM7SUFDNUQsbUJBQW1CLENBQUMsWUFBWSxFQUFFLGdDQUFnQyxDQUFDLENBQUM7QUFDdEUsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9jb21wb25lbnQvYXVkaW8vaW5kZXgudHM/NTVjMiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb2xsYXBzaWJsZSB9IGZyb20gJ0AvdXRpbC9jb2xsYXBzaWJsZSc7XG5pbXBvcnQgeyBleHRlbnNpb25Gb2xkZXJQYXRoLCBnZXRTZXR0aW5nVmFsdWUsIHNhdmVTZXR0aW5nVmFsdWUgfSBmcm9tICdAL3V0aWwvZXh0ZW5zaW9uX3ZhcmlhYmxlcyc7XG5cbmltcG9ydCB7IGNoYXRfbWV0YWRhdGEsIGV2ZW50U291cmNlLCBldmVudF90eXBlcywgc2F2ZVNldHRpbmdzRGVib3VuY2VkIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5pbXBvcnQgeyByZW5kZXJFeHRlbnNpb25UZW1wbGF0ZUFzeW5jLCBzYXZlTWV0YWRhdGFEZWJvdW5jZWQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9leHRlbnNpb25zJztcbmltcG9ydCB7IFBPUFVQX1RZUEUsIGNhbGxHZW5lcmljUG9wdXAgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9wb3B1cCc7XG5pbXBvcnQgeyBpc01vYmlsZSB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL1Jvc3NBc2NlbmRzLW1vZHMnO1xuaW1wb3J0IHsgZ2V0U29ydGFibGVEZWxheSwgbG9hZEZpbGVUb0RvY3VtZW50IH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvdXRpbHMnO1xuXG5pbXBvcnQgbG9nIGZyb20gJ2xvZ2xldmVsJztcblxubGV0IGlzRXh0ZW5zaW9uRW5hYmxlZDogYm9vbGVhbjtcbmxldCBpc0F1ZGlvRW5hYmxlZDogYm9vbGVhbjtcbmV4cG9ydCBsZXQgbGlzdF9CR01TOiBzdHJpbmdbXSA9IFtdO1xuZXhwb3J0IGxldCBsaXN0X2FtYmllbnRzOiBzdHJpbmdbXSA9IFtdO1xubGV0IGJnbUVuZGVkID0gdHJ1ZTtcbmxldCBhbWJpZW50RW5kZWQgPSB0cnVlO1xuXG5jb25zdCB0ZW1wbGF0ZVBhdGggPSBgJHtleHRlbnNpb25Gb2xkZXJQYXRofS9zcmMvY29tcG9uZW50L2F1ZGlvYDtcbi8vIOWumuS5iem7mOiupOmfs+mikeiuvue9rlxuZXhwb3J0IGNvbnN0IGRlZmF1bHRBdWRpb1NldHRpbmdzID0ge1xuICBhdWRpb19lbmFibGVkOiB0cnVlLFxuICBiZ21fZW5hYmxlZDogdHJ1ZSxcbiAgYW1iaWVudF9lbmFibGVkOiB0cnVlLFxuICBiZ21fbW9kZTogJ3JlcGVhdCcsXG4gIGJnbV9tdXRlZDogZmFsc2UsXG4gIGJnbV92b2x1bWU6IDUwLFxuICBiZ21fc2VsZWN0ZWQ6IG51bGwsXG4gIGJnbV9jdXJyZW50X3RpbWU6IDAsXG4gIGFtYmllbnRfbW9kZTogJ3N0b3AnLFxuICBhbWJpZW50X211dGVkOiBmYWxzZSxcbiAgYW1iaWVudF92b2x1bWU6IDUwLFxuICBhbWJpZW50X3NlbGVjdGVkOiBudWxsLFxuICBhbWJpZW50X2N1cnJlbnRfdGltZTogMCxcbiAgYXVkaW9fY29vbGRvd246IDAsXG59O1xuXG4vKipcbiAqIOabtOaWsOmfs+mikVxuICogQHBhcmFtIHR5cGUg6Z+z6aKR57G75Z6LIFwiYmdtXCIg5oiWIFwiYW1iaWVudFwiXG4gKiBAcGFyYW0gaXNVc2VySW5wdXQg5piv5ZCm55Sx55So5oi35pON5L2c6Kem5Y+RLeWwhuWvvOiHtOmfs+mikeS4reaWrVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlQXVkaW8odHlwZSA9ICdiZ20nLCBpc1VzZXJJbnB1dCA9IGZhbHNlKSB7XG4gIGlmICghZ2V0U2V0dGluZ1ZhbHVlKCdhdWRpby5hdWRpb19lbmFibGVkJykpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCBpc1R5cGVFbmFibGVkID1cbiAgICB0eXBlID09PSAnYmdtJyA/IGdldFNldHRpbmdWYWx1ZSgnYXVkaW8uYmdtX2VuYWJsZWQnKSA6IGdldFNldHRpbmdWYWx1ZSgnYXVkaW8uYW1iaWVudF9lbmFibGVkJyk7XG5cbiAgaWYgKCFpc1R5cGVFbmFibGVkKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IGF1ZGlvRW5kZWQgPSB0eXBlID09PSAnYmdtJyA/IGJnbUVuZGVkIDogYW1iaWVudEVuZGVkO1xuICBjb25zdCBhdWRpb1NlbGVjdG9yID0gYCNhdWRpb18ke3R5cGV9YDtcblxuICBpZiAoIWlzVXNlcklucHV0ICYmICQoYXVkaW9TZWxlY3RvcikuYXR0cignc3JjJykgIT0gJycgJiYgIWF1ZGlvRW5kZWQpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBsZXQgYXVkaW9fdXJsID0gJyc7XG4gIGNvbnN0IHBsYXlsaXN0ID0gYXdhaXQgZ2V0QXVkaW9VcmwodHlwZSBhcyAnYmdtJyB8ICdhbWJpZW50Jyk7XG5cbiAgaWYgKGlzVXNlcklucHV0KSB7XG4gICAgYXVkaW9fdXJsID1cbiAgICAgIHR5cGUgPT09ICdiZ20nXG4gICAgICAgID8gZ2V0U2V0dGluZ1ZhbHVlKCdhdWRpby5iZ21fc2VsZWN0ZWQnKSB8fCBwbGF5bGlzdFswXVxuICAgICAgICA6IGdldFNldHRpbmdWYWx1ZSgnYXVkaW8uYW1iaWVudF9zZWxlY3RlZCcpIHx8IHBsYXlsaXN0WzBdO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IG1vZGUgPSB0eXBlID09PSAnYmdtJyA/IGdldFNldHRpbmdWYWx1ZSgnYXVkaW8uYmdtX21vZGUnKSA6IGdldFNldHRpbmdWYWx1ZSgnYXVkaW8uYW1iaWVudF9tb2RlJyk7XG5cbiAgICBjb25zdCBzZWxlY3RlZCA9IHR5cGUgPT09ICdiZ20nID8gZ2V0U2V0dGluZ1ZhbHVlKCdhdWRpby5iZ21fc2VsZWN0ZWQnKSA6IGdldFNldHRpbmdWYWx1ZSgnYXVkaW8uYW1iaWVudF9zZWxlY3RlZCcpO1xuXG4gICAgYXVkaW9fdXJsID0gZ2V0TmV4dEZpbGVCeU1vZGUobW9kZSwgcGxheWxpc3QsIHNlbGVjdGVkKTtcbiAgfVxuXG4gIGlmICghYXVkaW9fdXJsKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgYXVkaW8gPSAkKGF1ZGlvU2VsZWN0b3IpWzBdIGFzIEhUTUxBdWRpb0VsZW1lbnQ7XG5cbiAgLy8g5a+55LqOYW1iaWVudOexu+Wei++8jOWkhOeQhuaOiemYsue8k+WtmOWQjue8gFxuICBpZiAodHlwZSA9PT0gJ2FtYmllbnQnKSB7XG4gICAgY29uc3QgY2xlYW5BdWRpb1NyYyA9IGF1ZGlvLnNyYy5zcGxpdCgnPycpWzBdO1xuICAgIGNvbnN0IGNsZWFuQXVkaW9VcmwgPSBhdWRpb191cmwuc3BsaXQoJz8nKVswXTtcbiAgICBpZiAoZGVjb2RlVVJJQ29tcG9uZW50KGNsZWFuQXVkaW9TcmMpID09PSBkZWNvZGVVUklDb21wb25lbnQoY2xlYW5BdWRpb1VybCkgJiYgIWF1ZGlvRW5kZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH0gZWxzZSBpZiAoZGVjb2RlVVJJQ29tcG9uZW50KGF1ZGlvLnNyYykgPT09IGRlY29kZVVSSUNvbXBvbmVudChhdWRpb191cmwpICYmICFhdWRpb0VuZGVkKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8g6K6+572uYXVkaW9FbmRlZOeKtuaAgVxuICBpZiAodHlwZSA9PT0gJ2JnbScpIHtcbiAgICBiZ21FbmRlZCA9IGZhbHNlO1xuICB9IGVsc2Uge1xuICAgIGFtYmllbnRFbmRlZCA9IGZhbHNlO1xuICB9XG5cbiAgaWYgKHR5cGUgPT09ICdiZ20nKSB7XG4gICAgYXVkaW8uc3JjID0gYXVkaW9fdXJsO1xuICAgIGF1ZGlvLmxvYWQoKTtcblxuICAgIGF3YWl0IG5ldyBQcm9taXNlPHZvaWQ+KHJlc29sdmUgPT4ge1xuICAgICAgY29uc3QgY2FuUGxheUhhbmRsZXIgPSAoKSA9PiB7XG4gICAgICAgIGF1ZGlvLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NhbnBsYXl0aHJvdWdoJywgY2FuUGxheUhhbmRsZXIpO1xuICAgICAgICByZXNvbHZlKCk7XG4gICAgICB9O1xuXG4gICAgICBpZiAoYXVkaW8ucmVhZHlTdGF0ZSA+PSBIVE1MTWVkaWFFbGVtZW50LkhBVkVfRU5PVUdIX0RBVEEpIHtcbiAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXVkaW8uYWRkRXZlbnRMaXN0ZW5lcignY2FucGxheXRocm91Z2gnLCBjYW5QbGF5SGFuZGxlcik7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBhd2FpdCBwbGF5QXVkaW8odHlwZSk7XG4gIH0gZWxzZSB7XG4gICAgLy8g5a+55LqOYW1iaWVudOexu+Wei++8jOS9v+eUqOe8k+WtmOegtOWdj1xuICAgIGNvbnN0IGF1ZGlvVXJsV2l0aENhY2hlQnVzdGluZyA9IGdldEF1ZGlvVXJsV2l0aENhY2hlQnVzdGluZyhhdWRpb191cmwpO1xuICAgIGF1ZGlvLnNyYyA9IGF1ZGlvVXJsV2l0aENhY2hlQnVzdGluZztcbiAgICBhdWRpby5sb2FkKCk7XG5cbiAgICBhd2FpdCBuZXcgUHJvbWlzZTx2b2lkPihyZXNvbHZlID0+IHtcbiAgICAgIGNvbnN0IGNhblBsYXlIYW5kbGVyID0gKCkgPT4ge1xuICAgICAgICBhdWRpby5yZW1vdmVFdmVudExpc3RlbmVyKCdjYW5wbGF5dGhyb3VnaCcsIGNhblBsYXlIYW5kbGVyKTtcbiAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgfTtcblxuICAgICAgaWYgKGF1ZGlvLnJlYWR5U3RhdGUgPj0gSFRNTE1lZGlhRWxlbWVudC5IQVZFX0VOT1VHSF9EQVRBKSB7XG4gICAgICAgIHJlc29sdmUoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGF1ZGlvLmFkZEV2ZW50TGlzdGVuZXIoJ2NhbnBsYXl0aHJvdWdoJywgY2FuUGxheUhhbmRsZXIpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgYXdhaXQgcGxheUF1ZGlvKHR5cGUgYXMgJ2JnbScgfCAnYW1iaWVudCcpO1xuICB9XG5cbiAgLy8g5pu05paw6YCJ5Lit55qE6Z+z6aKRXG4gIGlmICh0eXBlID09PSAnYmdtJykge1xuICAgIHNhdmVTZXR0aW5nVmFsdWUoJ2F1ZGlvLmJnbV9zZWxlY3RlZCcsIGF1ZGlvX3VybCk7XG4gIH0gZWxzZSB7XG4gICAgc2F2ZVNldHRpbmdWYWx1ZSgnYXVkaW8uYW1iaWVudF9zZWxlY3RlZCcsIGF1ZGlvX3VybCk7XG4gIH1cblxuICAvLyDmm7TmlrDpgInmi6nlmahcbiAgY29uc3Qgc2VsZWN0RWxlbWVudCA9ICQoYCNhdWRpb18ke3R5cGV9X3NlbGVjdGApO1xuICBpZiAoc2VsZWN0RWxlbWVudC52YWwoKSAhPT0gYXVkaW9fdXJsKSB7XG4gICAgc2VsZWN0RWxlbWVudC52YWwoYXVkaW9fdXJsKTtcbiAgfVxuXG4gIHNhdmVTZXR0aW5nc0RlYm91bmNlZCgpO1xufVxuXG4vKipcbiAqIOabtOaWsOmfs+mikeS4i+aLiemAieaLqeiPnOWNlVxuICogQHBhcmFtIHR5cGUg6Z+z6aKR57G75Z6LIFwiYmdtXCIg5oiWIFwiYW1iaWVudFwiXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVBdWRpb1NlbGVjdCh0eXBlID0gJ2JnbScpIHtcbiAgaWYgKCFnZXRTZXR0aW5nVmFsdWUoYGF1ZGlvLiR7dHlwZX1fZW5hYmxlZGApKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3Qgc2VsZWN0RWxlbWVudCA9ICQoYCNhdWRpb18ke3R5cGV9X3NlbGVjdGApO1xuICBzZWxlY3RFbGVtZW50LmVtcHR5KCk7XG5cbiAgaWYgKHR5cGUgPT09ICdiZ20nKSB7XG4gICAgbGlzdF9CR01TID0gYXdhaXQgZ2V0QXVkaW9VcmwoJ2JnbScpO1xuICB9IGVsc2Uge1xuICAgIGxpc3RfYW1iaWVudHMgPSBhd2FpdCBnZXRBdWRpb1VybCgnYW1iaWVudCcpO1xuICB9XG5cbiAgY29uc3QgYXVkaW9MaXN0ID0gdHlwZSA9PT0gJ2JnbScgPyBsaXN0X0JHTVMgOiBsaXN0X2FtYmllbnRzO1xuICBsZXQgc2VsZWN0ZWRTZXR0aW5nID1cbiAgICB0eXBlID09PSAnYmdtJyA/IGdldFNldHRpbmdWYWx1ZSgnYXVkaW8uYmdtX3NlbGVjdGVkJykgOiBnZXRTZXR0aW5nVmFsdWUoJ2F1ZGlvLmFtYmllbnRfc2VsZWN0ZWQnKTtcblxuICBpZiAoYXVkaW9MaXN0ICYmIGF1ZGlvTGlzdC5sZW5ndGggPiAwKSB7XG4gICAgLy8g5qOA5p+l5b2T5YmN6YCJ5oup55qE6Z+z6aKR5piv5ZCm5Zyo5YiX6KGo5Lit77yM5aaC5p6c5LiN5Zyo5YiZ6YCJ5oup56ys5LiA5LiqXG4gICAgaWYgKCFhdWRpb0xpc3QuaW5jbHVkZXMoc2VsZWN0ZWRTZXR0aW5nKSkge1xuICAgICAgbG9nLndhcm4oYFtBdWRpb10g5b2T5YmN6YCJ5oup55qE6Z+z6aKRICR7c2VsZWN0ZWRTZXR0aW5nfSDkuI3lnKjliJfooajkuK3vvIzoh6rliqjpgInmi6nliJfooajnrKzkuIDkuKrpn7PpopFgKTtcbiAgICAgIHNlbGVjdGVkU2V0dGluZyA9IGF1ZGlvTGlzdFswXTtcbiAgICAgIGlmICh0eXBlID09PSAnYmdtJykge1xuICAgICAgICBzYXZlU2V0dGluZ1ZhbHVlKCdhdWRpby5iZ21fc2VsZWN0ZWQnLCBzZWxlY3RlZFNldHRpbmcpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2F2ZVNldHRpbmdWYWx1ZSgnYXVkaW8uYW1iaWVudF9zZWxlY3RlZCcsIHNlbGVjdGVkU2V0dGluZyk7XG4gICAgICB9XG4gICAgICBzYXZlU2V0dGluZ3NEZWJvdW5jZWQoKTtcbiAgICB9XG5cbiAgICBjb25zdCBhdWRpb0ZpbGVzID0gQXJyYXkuaXNBcnJheShhdWRpb0xpc3QpID8gYXVkaW9MaXN0IDogYXVkaW9MaXN0LnNwbGl0KCcsJykubWFwKGZpbGUgPT4gZmlsZS50cmltKCkpO1xuICAgIGF1ZGlvRmlsZXMuZm9yRWFjaCgoZmlsZTogc3RyaW5nKSA9PiB7XG4gICAgICBjb25zdCBmaWxlTGFiZWwgPSBmaWxlLnJlcGxhY2UoL14uKltcXFxcXFwvXS8sICcnKS5yZXBsYWNlKC9cXC5bXi8uXSskLywgJycpO1xuICAgICAgc2VsZWN0RWxlbWVudC5hcHBlbmQobmV3IE9wdGlvbihmaWxlTGFiZWwsIGZpbGUpKTtcbiAgICB9KTtcblxuICAgIHNlbGVjdEVsZW1lbnQudmFsKHNlbGVjdGVkU2V0dGluZyk7XG4gIH0gZWxzZSB7XG4gICAgbG9nLndhcm4oYFtBdWRpb10g5pqC5peg5Y+v55So55qEICR7dHlwZS50b1VwcGVyQ2FzZSgpfSDotYTmupBgKTtcbiAgfVxufVxuXG4vKipcbiAqIOiOt+WPlumfs+mikVVSTFxuICogQHBhcmFtIHR5cGUg6Z+z6aKR57G75Z6LIFwiYmdtXCIg5oiWIFwiYW1iaWVudFwiXG4gKiBAcmV0dXJucyDpn7PpopFVUkzmlbDnu4RcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEF1ZGlvVXJsKHR5cGUgPSAnYmdtJykge1xuICBjb25zdCB0eXBlS2V5ID0gdHlwZSA9PT0gJ2JnbScgPyAnYmdtdXJsJyA6ICdhbWJpZW50dXJsJztcbiAgLy9AdHMtaWdub3JlXG4gIGNvbnN0IGNoYXRTcGVjaWZpY1VybHMgPSBjaGF0X21ldGFkYXRhLnZhcmlhYmxlcz8uW3R5cGVLZXldIHx8IFtdO1xuICByZXR1cm4gY2hhdFNwZWNpZmljVXJscztcbn1cblxuLyoqXG4gKiDmt7vliqDnvJPlrZjlj4LmlbDpmLLmraLnvJPlrZhcbiAqIEBwYXJhbSBvcmlnaW5hbFVybCDljp/lp4tVUkxcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEF1ZGlvVXJsV2l0aENhY2hlQnVzdGluZyhvcmlnaW5hbFVybDogc3RyaW5nKSB7XG4gIGlmICghb3JpZ2luYWxVcmwpIHJldHVybiAnJztcbiAgY29uc3QgY2FjaGVCdXN0ZXIgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcbiAgY29uc3Qgc2VwYXJhdG9yID0gb3JpZ2luYWxVcmwuaW5jbHVkZXMoJz8nKSA/ICcmJyA6ICc/JztcbiAgcmV0dXJuIGAke29yaWdpbmFsVXJsfSR7c2VwYXJhdG9yfV89JHtjYWNoZUJ1c3Rlcn1gO1xufVxuXG4vKipcbiAqIOagueaNruaSreaUvuaooeW8j+iOt+WPluS4i+S4gOS4qumfs+mikeaWh+S7tlxuICogQHBhcmFtIG1vZGUg5pKt5pS+5qih5byPXG4gKiBAcGFyYW0gcGxheWxpc3Qg5pKt5pS+5YiX6KGoXG4gKiBAcGFyYW0gY3VycmVudEZpbGUg5b2T5YmN5paH5Lu2XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXROZXh0RmlsZUJ5TW9kZShtb2RlOiBzdHJpbmcsIHBsYXlsaXN0OiBzdHJpbmdbXSwgY3VycmVudEZpbGU6IHN0cmluZykge1xuICBpZiAoIXBsYXlsaXN0IHx8IHBsYXlsaXN0Lmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiAnJztcbiAgfVxuXG4gIHN3aXRjaCAobW9kZSkge1xuICAgIGNhc2UgJ3JlcGVhdCc6XG4gICAgICByZXR1cm4gcGxheWxpc3RbMF07XG4gICAgY2FzZSAnc2luZ2xlJzpcbiAgICAgIHJldHVybiBjdXJyZW50RmlsZSB8fCBwbGF5bGlzdFswXTtcbiAgICBjYXNlICdyYW5kb20nOiB7XG4gICAgICBjb25zdCBmaWx0ZXJlZFBsYXlsaXN0ID0gcGxheWxpc3QuZmlsdGVyKGZpbGUgPT4gZmlsZSAhPT0gY3VycmVudEZpbGUpO1xuICAgICAgaWYgKGZpbHRlcmVkUGxheWxpc3QubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybiBwbGF5bGlzdFswXTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHJhbmRvbUluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogZmlsdGVyZWRQbGF5bGlzdC5sZW5ndGgpO1xuICAgICAgcmV0dXJuIGZpbHRlcmVkUGxheWxpc3RbcmFuZG9tSW5kZXhdO1xuICAgIH1cbiAgICBjYXNlICdzdG9wJzpcbiAgICAgIHJldHVybiAnJztcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIHBsYXlsaXN0WzBdO1xuICB9XG59XG5cbi8qKlxuICog5YiH5o2i6Z+z6aKR5o6n5Lu254q25oCBXG4gKiBAcGFyYW0gdHlwZSDpn7PpopHnsbvlnosgXCJiZ21cIiDmiJYgXCJhbWJpZW50XCJcbiAqIEBwYXJhbSBzdGF0dXMg5piv5ZCm5ZCv55SoXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0b2dnbGVBdWRpb0NvbnRyb2xzKHR5cGU6ICdiZ20nIHwgJ2FtYmllbnQnLCBzdGF0dXMgPSAnZW5hYmxlJykge1xuICBjb25zdCBpc01haW5FbmFibGVkID0gJCgnI2F1ZGlvX2VuYWJsZWQnKS5wcm9wKCdjaGVja2VkJyk7XG5cbiAgY29uc3Qgc2hvdWxkRW5hYmxlID0gaXNNYWluRW5hYmxlZCAmJiBzdGF0dXMgPT09ICdlbmFibGUnO1xuXG4gIGNvbnN0IGNvbnRyb2xJZHMgPSBbXG4gICAgYCNhdWRpb18ke3R5cGV9X3BsYXlfcGF1c2VgLFxuICAgIGAjYXVkaW9fJHt0eXBlfV9tdXRlYCxcbiAgICBgI2F1ZGlvXyR7dHlwZX1fbW9kZWAsXG4gICAgYCNhdWRpb18ke3R5cGV9X3NlbGVjdGAsXG4gICAgYCNhdWRpb18ke3R5cGV9X3ZvbHVtZV9zbGlkZXJgLFxuICBdO1xuXG4gIGNvbnRyb2xJZHMuZm9yRWFjaChpZCA9PiB7XG4gICAgJChpZCkucHJvcCgnZGlzYWJsZWQnLCAhc2hvdWxkRW5hYmxlKTtcbiAgfSk7XG59XG5cbi8qKlxuICog54K55Ye76Z+z6aKR5ZCv55So5oyJ6ZKu5pe255qE6YCa55So5aSE55CG5Ye95pWwXG4gKiBAcGFyYW0gdHlwZSDpn7PpopHnsbvlnosgXCJiZ21cIiDmiJYgXCJhbWJpZW50XCJcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG9uQXVkaW9FbmFibGVkQ2xpY2sodHlwZSA9ICdiZ20nKSB7XG4gIGNvbnN0IGVuYWJsZWQgPSAkKGAjZW5hYmxlXyR7dHlwZX1gKS5wcm9wKCdjaGVja2VkJyk7XG4gIHNhdmVTZXR0aW5nVmFsdWUoYGF1ZGlvLiR7dHlwZX1fZW5hYmxlZGAsIGVuYWJsZWQpO1xuXG4gIGlmIChlbmFibGVkKSB7XG4gICAgdG9nZ2xlQXVkaW9Db250cm9scyh0eXBlIGFzICdiZ20nIHwgJ2FtYmllbnQnLCAnZW5hYmxlJyk7XG4gICAgYXdhaXQgdXBkYXRlQXVkaW8odHlwZSwgZmFsc2UpO1xuICB9IGVsc2Uge1xuICAgICgkKGAjYXVkaW9fJHt0eXBlfWApWzBdIGFzIEhUTUxBdWRpb0VsZW1lbnQpLnBhdXNlKCk7XG4gICAgdG9nZ2xlQXVkaW9Db250cm9scyh0eXBlIGFzICdiZ20nIHwgJ2FtYmllbnQnLCAnZGlzYWJsZScpO1xuICB9XG59XG5cbi8qKlxuICog5Yid5aeL5YyW6Z+z6aKR5LqL5Lu255uR5ZCsXG4gKiBAcGFyYW0gdHlwZSDpn7PpopHnsbvlnosgXCJiZ21cIiDmiJYgXCJhbWJpZW50XCJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluaXRBdWRpb0V2ZW50TGlzdGVuZXJzKHR5cGU6ICdiZ20nIHwgJ2FtYmllbnQnKSB7XG4gICgkKGAjYXVkaW9fJHt0eXBlfWApIGFzIEhUTUxBdWRpb0VsZW1lbnQpLm9uKCdlbmRlZCcsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICBpZiAodHlwZSA9PT0gJ2JnbScpIHtcbiAgICAgIGJnbUVuZGVkID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgYW1iaWVudEVuZGVkID0gdHJ1ZTtcbiAgICB9XG4gICAgY29uc3QgbW9kZSA9IGdldFNldHRpbmdWYWx1ZShgYXVkaW8uJHt0eXBlfV9tb2RlYCk7XG5cbiAgICBpZiAobW9kZSA9PT0gJ3N0b3AnKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgYXdhaXQgdXBkYXRlQXVkaW8odHlwZSwgZmFsc2UpO1xuICB9KTtcbn1cblxuLyoqXG4gKiDliJ3lp4vljJbov5vluqbmnaFcbiAqIEBwYXJhbSB0eXBlIOmfs+mikeexu+WeiyBcImJnbVwiIOaIliBcImFtYmllbnRcIlxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5pdGlhbGl6ZVByb2dyZXNzQmFyKHR5cGU6ICdiZ20nIHwgJ2FtYmllbnQnKSB7XG4gIGNvbnN0ICRhdWRpb0VsZW1lbnQgPSAkKGAjYXVkaW9fJHt0eXBlfWApO1xuICBjb25zdCAkcHJvZ3Jlc3NTbGlkZXIgPSAkKGAjYXVkaW9fJHt0eXBlfV9wcm9ncmVzc19zbGlkZXJgKTtcblxuICAkYXVkaW9FbGVtZW50Lm9uKCd0aW1ldXBkYXRlJywgZnVuY3Rpb24gKCkge1xuICAgIGlmICghaXNOYU4odGhpcy5kdXJhdGlvbikpIHtcbiAgICAgIGNvbnN0IHByb2dyZXNzUGVyY2VudCA9ICh0aGlzLmN1cnJlbnRUaW1lIC8gdGhpcy5kdXJhdGlvbikgKiAxMDA7XG4gICAgICAkcHJvZ3Jlc3NTbGlkZXIudmFsKHByb2dyZXNzUGVyY2VudCk7XG4gICAgfVxuICAgIGNvbnN0IGNvb2xkb3duQkdNID0gZ2V0U2V0dGluZ1ZhbHVlKCdhdWRpby5hdWRpb19jb29sZG93bicpO1xuICAgIGNvbnN0IHJlbWFpbmluZ1RpbWUgPSB0aGlzLmR1cmF0aW9uIC0gdGhpcy5jdXJyZW50VGltZTtcblxuICAgIGlmIChjb29sZG93bkJHTSA+IDAgJiYgcmVtYWluaW5nVGltZSA8PSBjb29sZG93bkJHTSAmJiAhdGhpcy5pc0ZhZGluZ091dCkge1xuICAgICAgY29uc3QgaW5pdGlhbFZvbHVtZSA9IHRoaXMudm9sdW1lO1xuICAgICAgY29uc3QgZmFkZVN0ZXAgPSBpbml0aWFsVm9sdW1lIC8gKGNvb2xkb3duQkdNICogMTApO1xuICAgICAgdGhpcy5pc0ZhZGluZ091dCA9IHRydWU7XG5cbiAgICAgIGNvbnN0IGZhZGVPdXRJbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMudm9sdW1lID4gMCkge1xuICAgICAgICAgIHRoaXMudm9sdW1lID0gTWF0aC5tYXgoMCwgdGhpcy52b2x1bWUgLSBmYWRlU3RlcCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY2xlYXJJbnRlcnZhbChmYWRlT3V0SW50ZXJ2YWwpO1xuICAgICAgICAgIHRoaXMuaXNGYWRpbmdPdXQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfSwgMTAwKTtcbiAgICB9XG4gIH0pO1xuXG4gICRhdWRpb0VsZW1lbnQub24oJ3BsYXknLCBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgY29vbGRvd25CR00gPSBnZXRTZXR0aW5nVmFsdWUoJ2F1ZGlvLmF1ZGlvX2Nvb2xkb3duJyk7XG4gICAgY29uc3QgdGFyZ2V0Vm9sdW1lID0gJChgI2F1ZGlvXyR7dHlwZX1fdm9sdW1lX3NsaWRlcmApLnZhbCgpIC8gMTAwO1xuXG4gICAgaWYgKGNvb2xkb3duQkdNIDw9IDApIHtcbiAgICAgIHRoaXMudm9sdW1lID0gdGFyZ2V0Vm9sdW1lO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMudm9sdW1lID0gMDtcbiAgICBjb25zdCBmYWRlU3RlcCA9IHRhcmdldFZvbHVtZSAvIChjb29sZG93bkJHTSAqIDEwKTtcbiAgICBjb25zdCBmYWRlSW5JbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgIGlmICh0aGlzLnZvbHVtZSA8IHRhcmdldFZvbHVtZSkge1xuICAgICAgICB0aGlzLnZvbHVtZSA9IE1hdGgubWluKHRhcmdldFZvbHVtZSwgdGhpcy52b2x1bWUgKyBmYWRlU3RlcCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjbGVhckludGVydmFsKGZhZGVJbkludGVydmFsKTtcbiAgICAgIH1cbiAgICB9LCAxMDApO1xuICB9KTtcblxuICAkYXVkaW9FbGVtZW50Lm9uKCdsb2FkZWRtZXRhZGF0YScsIGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIWlzTmFOKHRoaXMuZHVyYXRpb24pKSB7XG4gICAgICAkcHJvZ3Jlc3NTbGlkZXIuYXR0cignbWF4JywgMTAwKTtcbiAgICB9XG4gIH0pO1xuXG4gICRwcm9ncmVzc1NsaWRlci5vbignaW5wdXQnLCBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgdmFsdWUgPSAkKHRoaXMpLnZhbCgpO1xuICAgIGlmICghaXNOYU4oJGF1ZGlvRWxlbWVudFswXS5kdXJhdGlvbikpIHtcbiAgICAgICRhdWRpb0VsZW1lbnRbMF0uY3VycmVudFRpbWUgPSAodmFsdWUgLyAxMDApICogJGF1ZGlvRWxlbWVudFswXS5kdXJhdGlvbjtcbiAgICB9XG4gIH0pO1xufVxuXG4vKipcbiAqIOmfs+mHj+a7keWdl+a7mui9ruiwg+iKguS6i+S7tuWkhOeQhlxuICogQHBhcmFtIGUg5LqL5Lu25a+56LGhXG4gKi9cbmZ1bmN0aW9uIG9uVm9sdW1lU2xpZGVyV2hlZWxFdmVudCh0aGlzOiBhbnksIGU6IFdoZWVsRXZlbnQpIHtcbiAgY29uc3Qgc2xpZGVyID0gJCh0aGlzKTtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gIGNvbnN0IGRlbHRhID0gZS5kZWx0YVkgLyAyMDtcbiAgY29uc3Qgc2xpZGVyVmFsID0gTnVtYmVyKHNsaWRlci52YWwoKSk7XG5cbiAgbGV0IG5ld1ZhbCA9IHNsaWRlclZhbCAtIGRlbHRhO1xuICBpZiAobmV3VmFsIDwgMCkge1xuICAgIG5ld1ZhbCA9IDA7XG4gIH0gZWxzZSBpZiAobmV3VmFsID4gMTAwKSB7XG4gICAgbmV3VmFsID0gMTAwO1xuICB9XG5cbiAgc2xpZGVyLnZhbChuZXdWYWwpLnRyaWdnZXIoJ2lucHV0Jyk7XG59XG5cbi8qKlxuICog6ZW/5oyJ6Z+z6YeP5o6n5Yi25oyJ6ZKu5Ye6546w6Z+z6YeP6LCD6IqCXG4gKiBAcGFyYW0gdm9sdW1lQ29udHJvbElkIOmfs+mHj+aOp+WItuaMiemSrklEXG4gKiBAcGFyYW0gaWNvbklkIOmfs+mHj+aOp+WItuaMiemSruWbvuagh0lEXG4gKi9cbmZ1bmN0aW9uIGhhbmRsZUxvbmdQcmVzcyh2b2x1bWVDb250cm9sSWQ6IHN0cmluZywgaWNvbklkOiBzdHJpbmcpIHtcbiAgY29uc3QgJHZvbHVtZUNvbnRyb2wgPSAkKGAjJHt2b2x1bWVDb250cm9sSWR9YCk7XG4gIGNvbnN0ICRpY29uID0gJChgIyR7aWNvbklkfWApO1xuICBsZXQgcHJlc3NUaW1lcjogbnVtYmVyIHwgdW5kZWZpbmVkO1xuXG4gIGlmIChpc01vYmlsZSgpKSB7XG4gICAgJGljb24ub24oJ3RvdWNoc3RhcnQnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgcHJlc3NUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAkdm9sdW1lQ29udHJvbC5jc3MoJ2Rpc3BsYXknLCAnYmxvY2snKTtcbiAgICAgIH0sIDUwMCk7XG4gICAgfSk7XG5cbiAgICAkaWNvbi5vbigndG91Y2hlbmQnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgY2xlYXJUaW1lb3V0KHByZXNzVGltZXIpO1xuICAgIH0pO1xuXG4gICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICBpZiAoXG4gICAgICAgICEkaWNvbi5pcyhldmVudC50YXJnZXQpICYmXG4gICAgICAgICRpY29uLmhhcyhldmVudC50YXJnZXQpLmxlbmd0aCA9PT0gMCAmJlxuICAgICAgICAhJHZvbHVtZUNvbnRyb2wuaXMoZXZlbnQudGFyZ2V0KSAmJlxuICAgICAgICAkdm9sdW1lQ29udHJvbC5oYXMoZXZlbnQudGFyZ2V0KS5sZW5ndGggPT09IDBcbiAgICAgICkge1xuICAgICAgICAkdm9sdW1lQ29udHJvbC5jc3MoJ2Rpc3BsYXknLCAnbm9uZScpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG5cbi8qKlxuICog5Yi35paw6Z+z6aKR6LWE5rqQXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZWZyZXNoQXVkaW9SZXNvdXJjZXMoKSB7XG4gIHVwZGF0ZUF1ZGlvU2VsZWN0KCdiZ20nKTtcbiAgdXBkYXRlQXVkaW9TZWxlY3QoJ2FtYmllbnQnKTtcbn1cblxuLyoqXG4gKiDmiZPlvIDpn7PpopHotYTmupDnrqHnkIblvLnnqpdcbiAqIEBwYXJhbSB0eXBlS2V5IOmfs+mikeexu+WeiyBcImJnbXVybFwiIOaIliBcImFtYmllbnR1cmxcIlxuICovXG5cbmFzeW5jIGZ1bmN0aW9uIG9wZW5VcmxNYW5hZ2VyUG9wdXAodHlwZUtleTogJ2JnbXVybCcgfCAnYW1iaWVudHVybCcpIHtcbiAgY29uc3QgdXJsTWFuYWdlciA9ICQoYXdhaXQgcmVuZGVyRXh0ZW5zaW9uVGVtcGxhdGVBc3luYyhgJHt0ZW1wbGF0ZVBhdGh9YCwgJ2F1ZGlvX3VybF9tYW5hZ2VyJykpO1xuICB1cmxNYW5hZ2VyLnByZXBlbmQoYFxuICAgIDxzdHlsZT5cbiAgICAgICNzYXZlZF9hdWRpb191cmwuZW1wdHk6OmFmdGVyIHtcbiAgICAgICAgY29udGVudDogXCLmmoLml6Dpn7PpopFcIjtcbiAgICAgICAgY29sb3I6ICM5OTk7XG4gICAgICAgIG1hcmdpbi10b3A6IDIwcHg7XG4gICAgICAgIGZvbnQtc2l6ZTogMTJweDtcbiAgICAgIH1cbiAgICA8L3N0eWxlPlxuICBgKTtcbiAgY29uc3Qgc2F2ZWRBdWRpb1VybCA9IHVybE1hbmFnZXIuZmluZCgnI3NhdmVkX2F1ZGlvX3VybCcpLmVtcHR5KCk7XG4gIGNvbnN0IHVybFRlbXBsYXRlID0gJChhd2FpdCByZW5kZXJFeHRlbnNpb25UZW1wbGF0ZUFzeW5jKGAke3RlbXBsYXRlUGF0aH1gLCAnYXVkaW9fdXJsX3RlbXBsYXRlJykpO1xuXG4gIGlmICghY2hhdF9tZXRhZGF0YS52YXJpYWJsZXMpIHtcbiAgICBjaGF0X21ldGFkYXRhLnZhcmlhYmxlcyA9IHt9O1xuICB9XG5cbiAgbGV0IHVybFZhbHVlOiBzdHJpbmdbXSA9IGNoYXRfbWV0YWRhdGEudmFyaWFibGVzW3R5cGVLZXldO1xuICBpZiAoIXVybFZhbHVlKSB7XG4gICAgdXJsVmFsdWUgPSBbXTtcblxuICAgIHNhdmVkQXVkaW9VcmwuYWRkQ2xhc3MoJ2VtcHR5Jyk7XG4gIH0gZWxzZSB7XG4gICAgdHJ5IHtcbiAgICAgIGlmICh1cmxWYWx1ZS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgc2F2ZWRBdWRpb1VybC5hZGRDbGFzcygnZW1wdHknKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nLmVycm9yKGBbQXVkaW9dIEZhaWxlZCB0byBwYXJzZSAke3R5cGVLZXl9OmAsIGVycm9yKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IHVwZGF0ZWRVcmxzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge307XG4gIGxldCBuZXdVcmxPcmRlciA9IFsuLi51cmxWYWx1ZV07XG4gIGZ1bmN0aW9uIHJlbmRlclVybChjb250YWluZXI6IEpRdWVyeTxIVE1MRWxlbWVudD4sIHVybDogc3RyaW5nKSB7XG4gICAgY29uc3QgdXJsSHRtbCA9IHVybFRlbXBsYXRlLmNsb25lKCk7XG4gICAgbGV0IGZpbGVOYW1lO1xuICAgIGlmICh1cmwuaW5jbHVkZXMoJy8nKSkge1xuICAgICAgY29uc3QgcGFydHMgPSB1cmwuc3BsaXQoJy8nKTtcbiAgICAgIGZpbGVOYW1lID0gcGFydHNbcGFydHMubGVuZ3RoIC0gMV0gfHwgcGFydHNbcGFydHMubGVuZ3RoIC0gMl07XG4gICAgfSBlbHNlIHtcbiAgICAgIGZpbGVOYW1lID0gdXJsO1xuICAgIH1cblxuICAgIGNvbnN0IGlkID0gZmlsZU5hbWUucmVwbGFjZSgvXFwuL2csICctJyk7XG5cbiAgICB1cmxIdG1sLmF0dHIoJ2lkJywgaWQpO1xuICAgIHVybEh0bWwuZmluZCgnLmF1ZGlvX3VybF9uYW1lJykudGV4dChmaWxlTmFtZSk7XG5cbiAgICB1cmxIdG1sLmZpbmQoJy5hdWRpb191cmxfbmFtZScpLmF0dHIoJ2RhdGEtdXJsJywgdXJsKTtcblxuICAgIHVybEh0bWwuZmluZCgnLmVkaXRfZXhpc3RpbmdfdXJsJykub24oJ2NsaWNrJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgY3VycmVudFVybCA9IHVybEh0bWwuZmluZCgnLmF1ZGlvX3VybF9uYW1lJykuYXR0cignZGF0YS11cmwnKTtcblxuICAgICAgaWYgKCFjdXJyZW50VXJsKSB7XG4gICAgICAgIGxvZy5lcnJvcignW0F1ZGlvXSBObyBVUkwgZm91bmQgZm9yIHRoaXMgZWxlbWVudC4nKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBpbnB1dFVybCA9IGF3YWl0IGNhbGxHZW5lcmljUG9wdXAoJycsIFBPUFVQX1RZUEUuSU5QVVQsIGN1cnJlbnRVcmwpO1xuXG4gICAgICBpZiAoIWlucHV0VXJsKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgbmV3RmlsZU5hbWUgPSBpbnB1dFVybC5zcGxpdCgnLycpLnBvcCgpO1xuXG4gICAgICBjb25zdCBuZXdJZCA9IG5ld0ZpbGVOYW1lLnJlcGxhY2UoL1xcLi9nLCAnLScpO1xuXG4gICAgICB1cmxIdG1sLmF0dHIoJ2lkJywgbmV3SWQpO1xuICAgICAgdXJsSHRtbC5maW5kKCcuYXVkaW9fdXJsX25hbWUnKS50ZXh0KG5ld0ZpbGVOYW1lKTtcbiAgICAgIHVybEh0bWwuZmluZCgnLmF1ZGlvX3VybF9uYW1lJykuYXR0cignZGF0YS11cmwnLCBpbnB1dFVybCk7XG5cbiAgICAgIHVwZGF0ZWRVcmxzW2N1cnJlbnRVcmxdID0gaW5wdXRVcmw7XG4gICAgfSk7XG5cbiAgICB1cmxIdG1sLmZpbmQoJy5kZWxldGVfdXJsJykub24oJ2NsaWNrJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgY29uZmlybURlbGV0ZSA9IGF3YWl0IGNhbGxHZW5lcmljUG9wdXAoJ+ehruiupOimgeWIoOmZpOatpOmTvuaOpT8nLCBQT1BVUF9UWVBFLkNPTkZJUk0pO1xuXG4gICAgICBpZiAoIWNvbmZpcm1EZWxldGUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyDku4Xku45ET03kuK3np7vpmaTlhYPntKBcbiAgICAgIHVybEh0bWwucmVtb3ZlKCk7XG5cbiAgICAgIC8vIOajgOafpeaYr+WQpumcgOimgeaYvuekuuepuueKtuaAgeaPkOekulxuICAgICAgaWYgKHNhdmVkQXVkaW9VcmwuZmluZCgnLmF1ZGlvX3VybF9uYW1lJykubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHNhdmVkQXVkaW9VcmwuYWRkQ2xhc3MoJ2VtcHR5Jyk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBjb250YWluZXIuYXBwZW5kKHVybEh0bWwpO1xuICB9XG5cbiAgdXJsVmFsdWUuZm9yRWFjaCh1cmwgPT4ge1xuICAgIHJlbmRlclVybChzYXZlZEF1ZGlvVXJsLCB1cmwpO1xuICB9KTtcbiAgdXJsTWFuYWdlci5maW5kKCcjaW1wb3J0X2J1dHRvbicpLm9uKCdjbGljaycsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBuZXdVcmxzID0gYXdhaXQgb3BlblVybEltcG9ydFBvcHVwKCk7XG5cbiAgICBpZiAoIW5ld1VybHMpIHtcbiAgICAgIGxvZy5kZWJ1ZyhgW0F1ZGlvXSAke3R5cGVLZXl9IFVSTOWvvOWFpeW3suWPlua2iGApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHNhdmVkQXVkaW9VcmwucmVtb3ZlQ2xhc3MoJ2VtcHR5Jyk7XG5cbiAgICBuZXdVcmxzLmZvckVhY2godXJsID0+IHtcbiAgICAgIHJlbmRlclVybChzYXZlZEF1ZGlvVXJsLCB1cmwpO1xuICAgIH0pO1xuICB9KTtcbiAgKHNhdmVkQXVkaW9VcmwgYXMgYW55KS5zb3J0YWJsZSh7XG4gICAgZGVsYXk6IGdldFNvcnRhYmxlRGVsYXkoKSxcbiAgICBoYW5kbGU6ICcuZHJhZy1oYW5kbGUnLFxuICAgIHN0b3A6IGZ1bmN0aW9uICgpIHtcbiAgICAgIG5ld1VybE9yZGVyID0gW107XG4gICAgICBzYXZlZEF1ZGlvVXJsLmZpbmQoJy5hdWRpb191cmxfbmFtZScpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICBjb25zdCBuZXdVcmwgPSAkKHRoaXMpLmF0dHIoJ2RhdGEtdXJsJyk7XG4gICAgICAgIGlmIChuZXdVcmwpIHtcbiAgICAgICAgICBuZXdVcmxPcmRlci5wdXNoKG5ld1VybCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0sXG4gIH0pO1xuICBjb25zdCByZXN1bHQgPSBhd2FpdCBjYWxsR2VuZXJpY1BvcHVwKHVybE1hbmFnZXIsIFBPUFVQX1RZUEUuQ09ORklSTSwgJycsIHtcbiAgICBva0J1dHRvbjogYOehruiupGAsXG4gICAgY2FuY2VsQnV0dG9uOiBg5Y+W5raIYCxcbiAgfSk7XG5cbiAgaWYgKCFyZXN1bHQpIHtcbiAgICByZXR1cm47XG4gIH0gZWxzZSB7XG4gICAgLy8g55u05o6l6K+75Y+W5omA5pyJZGF0YS11cmzlsZ7mgKfvvIznlJ/miJDmlrDnmoRVUkzliJfooahcbiAgICBjb25zdCBuZXdVcmxMaXN0OiBzdHJpbmdbXSA9IFtdO1xuICAgIHNhdmVkQXVkaW9VcmwuZmluZCgnLmF1ZGlvX3VybF9uYW1lJykuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCB1cmwgPSAkKHRoaXMpLmF0dHIoJ2RhdGEtdXJsJyk7XG4gICAgICBpZiAodXJsKSB7XG4gICAgICAgIG5ld1VybExpc3QucHVzaCh1cmwpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8g5qOA5p+l5b2T5YmN5pKt5pS+55qE6Z+z6aKR5piv5ZCm5Zyo5paw55qE5YiX6KGo5LitXG4gICAgY29uc3QgY3VycmVudEJnbVVybCA9IGdldFNldHRpbmdWYWx1ZSgnYXVkaW8uYmdtX3NlbGVjdGVkJyk7XG4gICAgY29uc3QgY3VycmVudEFtYmllbnRVcmwgPSBnZXRTZXR0aW5nVmFsdWUoJ2F1ZGlvLmFtYmllbnRfc2VsZWN0ZWQnKTtcblxuICAgIC8vIOWmguaenOW9k+WJjeaSreaUvueahOmfs+mikeS4jeWcqOaWsOeahOWIl+ihqOS4re+8jOWBnOatouaSreaUvlxuICAgIGlmICh0eXBlS2V5ID09PSAnYmdtdXJsJyAmJiBjdXJyZW50QmdtVXJsICYmICFuZXdVcmxMaXN0LmluY2x1ZGVzKGN1cnJlbnRCZ21VcmwpKSB7XG4gICAgICBjb25zdCBiZ21BdWRpbyA9ICQoJyNhdWRpb19iZ20nKVswXSBhcyBIVE1MQXVkaW9FbGVtZW50O1xuICAgICAgYmdtQXVkaW8ucGF1c2UoKTtcbiAgICAgIGJnbUVuZGVkID0gdHJ1ZTtcbiAgICB9IGVsc2UgaWYgKHR5cGVLZXkgPT09ICdhbWJpZW50dXJsJyAmJiBjdXJyZW50QW1iaWVudFVybCAmJiAhbmV3VXJsTGlzdC5pbmNsdWRlcyhjdXJyZW50QW1iaWVudFVybCkpIHtcbiAgICAgIGNvbnN0IGFtYmllbnRBdWRpbyA9ICQoJyNhdWRpb19hbWJpZW50JylbMF0gYXMgSFRNTEF1ZGlvRWxlbWVudDtcbiAgICAgIGFtYmllbnRBdWRpby5wYXVzZSgpO1xuICAgICAgYW1iaWVudEVuZGVkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICAvLyDmm7TmlrDlubbkv53lrZjmlrDnmoRVUkzliJfooahcbiAgICBjaGF0X21ldGFkYXRhLnZhcmlhYmxlc1t0eXBlS2V5XSA9IG5ld1VybExpc3Q7XG4gICAgc2F2ZU1ldGFkYXRhRGVib3VuY2VkKCk7XG4gICAgaWYgKHR5cGVLZXkgPT09ICdiZ211cmwnKSB7XG4gICAgICB1cGRhdGVBdWRpb1NlbGVjdCgnYmdtJyk7XG4gICAgfSBlbHNlIGlmICh0eXBlS2V5ID09PSAnYW1iaWVudHVybCcpIHtcbiAgICAgIHVwZGF0ZUF1ZGlvU2VsZWN0KCdhbWJpZW50Jyk7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICog54K55Ye76Z+z6aKR5oC75byA5YWz5pe255qE5aSE55CG5Ye95pWwXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUF1ZGlvVG9nZ2xlKGVuYWJsZTogYm9vbGVhbiA9IHRydWUsIHVzZXJJbnB1dDogYm9vbGVhbiA9IHRydWUpIHtcbiAgaWYgKHVzZXJJbnB1dCkge1xuICAgIGlzQXVkaW9FbmFibGVkID0gZW5hYmxlO1xuICAgIHNhdmVTZXR0aW5nVmFsdWUoJ2F1ZGlvLmF1ZGlvX2VuYWJsZWQnLCBpc0F1ZGlvRW5hYmxlZCk7XG4gIH1cblxuICBpZiAoZW5hYmxlKSB7XG4gICAgJCgnI2F1ZGlvLXBsYXllci1jb250ZW50JykucmVtb3ZlQ2xhc3MoJ2F1ZGlvLWRpc2FibGVkLW1hc2snKTtcbiAgICBpZiAoaXNFeHRlbnNpb25FbmFibGVkID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGlzRXh0ZW5zaW9uRW5hYmxlZCA9IGdldFNldHRpbmdWYWx1ZSgnZW5hYmxlZF9leHRlbnNpb24nKTtcbiAgICB9XG4gICAgaWYgKCFpc0V4dGVuc2lvbkVuYWJsZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdG9nZ2xlQXVkaW9Db250cm9scygnYmdtJywgJ2VuYWJsZScpO1xuICAgIHRvZ2dsZUF1ZGlvQ29udHJvbHMoJ2FtYmllbnQnLCAnZW5hYmxlJyk7XG4gICAgY29uc3QgYmdtVXJsID0gYXdhaXQgZ2V0QXVkaW9VcmwoJ2JnbScpO1xuICAgIGNvbnN0IGFtYmllbnRVcmwgPSBhd2FpdCBnZXRBdWRpb1VybCgnYW1iaWVudCcpO1xuICAgIGlmIChiZ21VcmwubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3QgYmdtQXVkaW9FbGVtZW50ID0gJCgnI2F1ZGlvX2JnbScpWzBdIGFzIEhUTUxBdWRpb0VsZW1lbnQ7XG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCBiZ21BdWRpb0VsZW1lbnQucGxheSgpO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdbQXVkaW9dIOaSreaUvumfs+S5kOWksei0pe+8muayoeacieaPkOS+m+acieaViOa6kCcpO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoYW1iaWVudFVybC5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCBhbWJpZW50QXVkaW9FbGVtZW50ID0gJCgnI2F1ZGlvX2FtYmllbnQnKVswXSBhcyBIVE1MQXVkaW9FbGVtZW50O1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgYW1iaWVudEF1ZGlvRWxlbWVudC5wbGF5KCk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1tBdWRpb10g5pKt5pS+6Z+z5pWI5aSx6LSl77ya5rKh5pyJ5o+Q5L6b5pyJ5pWI5rqQJyk7XG4gICAgICB9XG4gICAgfVxuICB9IGVsc2Uge1xuICAgICQoJyNhdWRpby1wbGF5ZXItY29udGVudCcpLmFkZENsYXNzKCdhdWRpby1kaXNhYmxlZC1tYXNrJyk7XG4gICAgKCQoJyNhdWRpb19iZ20nKVswXSBhcyBIVE1MQXVkaW9FbGVtZW50KS5wYXVzZSgpO1xuICAgICgkKCcjYXVkaW9fYW1iaWVudCcpWzBdIGFzIEhUTUxBdWRpb0VsZW1lbnQpLnBhdXNlKCk7XG4gICAgdG9nZ2xlQXVkaW9Db250cm9scygnYmdtJywgJ2Rpc2FibGUnKTtcbiAgICB0b2dnbGVBdWRpb0NvbnRyb2xzKCdhbWJpZW50JywgJ2Rpc2FibGUnKTtcbiAgfVxufVxuXG4vKipcbiAqIOaSreaUvumfs+mikVxuICogQHBhcmFtIHR5cGUg6Z+z6aKR57G75Z6LIFwiYmdtXCIg5oiWIFwiYW1iaWVudFwiXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwbGF5QXVkaW8odHlwZTogJ2JnbScgfCAnYW1iaWVudCcpIHtcbiAgaWYgKFxuICAgICFnZXRTZXR0aW5nVmFsdWUoJ2VuYWJsZWRfZXh0ZW5zaW9uJykgfHxcbiAgICAhZ2V0U2V0dGluZ1ZhbHVlKCdhdWRpby5hdWRpb19lbmFibGVkJykgfHxcbiAgICAhZ2V0U2V0dGluZ1ZhbHVlKGBhdWRpby4ke3R5cGV9X2VuYWJsZWRgKVxuICApIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCBhdWRpb0VsZW1lbnQgPSAkKGAjYXVkaW9fJHt0eXBlfWApWzBdIGFzIEhUTUxBdWRpb0VsZW1lbnQ7XG4gIGNvbnN0IHBsYXlQYXVzZUljb24gPSAkKGAjYXVkaW9fJHt0eXBlfV9wbGF5X3BhdXNlX2ljb25gKTtcblxuICBpZiAoYXVkaW9FbGVtZW50LmVycm9yICYmIGF1ZGlvRWxlbWVudC5lcnJvci5jb2RlID09PSA0KSB7XG4gICAgbG9nLndhcm4oYFRoZSAke3R5cGV9IGVsZW1lbnQgaGFzIG5vIHN1cHBvcnRlZCBzb3VyY2VzLiBUcnlpbmcgdG8gcmVsb2FkIHNlbGVjdGVkIGF1ZGlvIGZyb20gZHJvcGRvd24uLi5gKTtcblxuICAgIGNvbnN0IHNlbGVjdGVkQXVkaW8gPSAkKGAjYXVkaW9fJHt0eXBlfV9zZWxlY3RgKS52YWwoKSBhcyBzdHJpbmc7XG4gICAgaWYgKCFzZWxlY3RlZEF1ZGlvKSB7XG4gICAgICBsb2cuZXJyb3IoYE5vIGF1ZGlvIHNlbGVjdGVkIGZvciAke3R5cGV9YCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgYXVkaW9FbGVtZW50LnNyYyA9IHNlbGVjdGVkQXVkaW87XG4gICAgYXVkaW9FbGVtZW50LmxvYWQoKTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgYXdhaXQgYXVkaW9FbGVtZW50LnBsYXkoKTtcbiAgICBwbGF5UGF1c2VJY29uLnJlbW92ZUNsYXNzKCdmYS1wbGF5Jyk7XG4gICAgcGxheVBhdXNlSWNvbi5hZGRDbGFzcygnZmEtcGF1c2UnKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBsb2cuZXJyb3IoYFtBdWRpb10g5pKt5pS+ICR7dHlwZX0g6Z+z6aKR5pe25Ye66ZSZOmAsIGVycm9yKTtcbiAgfVxufVxuXG4vKipcbiAqIOeCueWHu+WQhOiHqumfs+mikeaooeW8j+aMiemSruaXtueahOmAmueUqOWkhOeQhuWHveaVsFxuICogQHBhcmFtIHR5cGUg6Z+z6aKR57G75Z6LIFwiYmdtXCIg5oiWIFwiYW1iaWVudFwiXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIG9uQXVkaW9Nb2RlQ2xpY2sodHlwZTogJ2JnbScgfCAnYW1iaWVudCcpIHtcbiAgY29uc3QgbW9kZXMgPSBbXG4gICAgeyBtb2RlOiAncmVwZWF0JywgaWNvbjogJ2ZhLXJlcGVhdCcgfSxcbiAgICB7IG1vZGU6ICdyYW5kb20nLCBpY29uOiAnZmEtcmFuZG9tJyB9LFxuICAgIHsgbW9kZTogJ3NpbmdsZScsIGljb246ICdmYS1yZWRvLWFsdCcgfSxcbiAgICB7IG1vZGU6ICdzdG9wJywgaWNvbjogJ2ZhLWNhbmNlbCcgfSxcbiAgXTtcblxuICBjb25zdCBjdXJyZW50TW9kZUluZGV4ID0gbW9kZXMuZmluZEluZGV4KG0gPT4gbS5tb2RlID09PSBnZXRTZXR0aW5nVmFsdWUoYGF1ZGlvLiR7dHlwZX1fbW9kZWApKTtcblxuICBjb25zdCBuZXh0TW9kZUluZGV4ID0gKGN1cnJlbnRNb2RlSW5kZXggKyAxKSAlIG1vZGVzLmxlbmd0aDtcblxuICBzYXZlU2V0dGluZ1ZhbHVlKGBhdWRpby4ke3R5cGV9X21vZGVgLCBtb2Rlc1tuZXh0TW9kZUluZGV4XS5tb2RlKTtcblxuICAkKGAjYXVkaW9fJHt0eXBlfV9tb2RlX2ljb25gKS5yZW1vdmVDbGFzcygnZmEtcmVwZWF0IGZhLXJhbmRvbSBmYS1yZWRvLWFsdCBmYS1jYW5jZWwnKTtcblxuICAkKGAjYXVkaW9fJHt0eXBlfV9tb2RlX2ljb25gKS5hZGRDbGFzcyhtb2Rlc1tuZXh0TW9kZUluZGV4XS5pY29uKTtcbn1cblxuLyoqXG4gKiDpn7PpopHpgInmi6nlj5jljJbml7bnmoTpgJrnlKjlpITnkIblh73mlbBcbiAqIEBwYXJhbSB0eXBlIOmfs+mikeexu+WeiyBcImJnbVwiIOaIliBcImFtYmllbnRcIlxuICovXG5hc3luYyBmdW5jdGlvbiBvbkF1ZGlvU2VsZWN0Q2hhbmdlKHR5cGU6ICdiZ20nIHwgJ2FtYmllbnQnKSB7XG4gIHNhdmVTZXR0aW5nVmFsdWUoYGF1ZGlvLiR7dHlwZX1fc2VsZWN0ZWRgLCAkKGAjYXVkaW9fJHt0eXBlfV9zZWxlY3RgKS52YWwoKSk7XG4gIGF3YWl0IHVwZGF0ZUF1ZGlvKHR5cGUsIHRydWUpO1xufVxuXG4vKipcbiAqIOi+k+WFpeWGt+WNtOaXtumXtOeahOWkhOeQhuWHveaVsFxuICogQHBhcmFtIHR5cGUg6Z+z6aKR57G75Z6LIFwiYmdtXCIg5oiWIFwiYW1iaWVudFwiXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIG9uQXVkaW9Db29sZG93bklucHV0KCkge1xuICBzYXZlU2V0dGluZ1ZhbHVlKCdhdWRpby5hdWRpb19jb29sZG93bicsIH5+KCQoYCNhdWRpb19jb29sZG93bmApLnZhbCgpIGFzIHN0cmluZykpO1xufVxuXG4vKipcbiAqIOmfs+mikemfs+mHj+WPmOWMluaXtueahOmAmueUqOWkhOeQhuWHveaVsFxuICogQHBhcmFtIHR5cGUg6Z+z6aKR57G75Z6LIFwiYmdtXCIg5oiWIFwiYW1iaWVudFwiXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIG9uQXVkaW9Wb2x1bWVDaGFuZ2UodHlwZTogJ2JnbScgfCAnYW1iaWVudCcpIHtcbiAgc2F2ZVNldHRpbmdWYWx1ZShgYXVkaW8uJHt0eXBlfV92b2x1bWVgLCB+figkKGAjYXVkaW9fJHt0eXBlfV92b2x1bWVfc2xpZGVyYCkudmFsKCkgYXMgc3RyaW5nKSk7XG4gICQoYCNhdWRpb18ke3R5cGV9YCkucHJvcCgndm9sdW1lJywgZ2V0U2V0dGluZ1ZhbHVlKGBhdWRpby4ke3R5cGV9X3ZvbHVtZWApICogMC4wMSk7XG4gICQoYCNhdWRpb18ke3R5cGV9X3ZvbHVtZWApLnRleHQoZ2V0U2V0dGluZ1ZhbHVlKGBhdWRpby4ke3R5cGV9X3ZvbHVtZWApKTtcbn1cblxuLyoqXG4gKiDngrnlh7vpn7PpopHpnZnpn7PmjInpkq7ml7bnmoTpgJrnlKjlpITnkIblh73mlbBcbiAqIEBwYXJhbSB0eXBlIOmfs+mikeexu+WeiyBcImJnbVwiIOaIliBcImFtYmllbnRcIlxuICovXG5hc3luYyBmdW5jdGlvbiBvbkF1ZGlvTXV0ZUNsaWNrKHR5cGU6ICdiZ20nIHwgJ2FtYmllbnQnKSB7XG4gIHNhdmVTZXR0aW5nVmFsdWUoYGF1ZGlvLiR7dHlwZX1fbXV0ZWRgLCAhZ2V0U2V0dGluZ1ZhbHVlKGBhdWRpby4ke3R5cGV9X211dGVkYCkpO1xuICAkKGAjYXVkaW9fJHt0eXBlfV9tdXRlX2ljb25gKS50b2dnbGVDbGFzcygnZmEtdm9sdW1lLWhpZ2gnKTtcbiAgJChgI2F1ZGlvXyR7dHlwZX1fbXV0ZV9pY29uYCkudG9nZ2xlQ2xhc3MoJ2ZhLXZvbHVtZS1tdXRlJyk7XG4gICQoYCNhdWRpb18ke3R5cGV9YCkucHJvcCgnbXV0ZWQnLCAhJChgI2F1ZGlvXyR7dHlwZX1gKS5wcm9wKCdtdXRlZCcpKTtcbiAgJChgI2F1ZGlvXyR7dHlwZX1fbXV0ZWApLnRvZ2dsZUNsYXNzKCdyZWRPdmVybGF5R2xvdycpO1xufVxuXG4vKipcbiAqIOWIh+aNouaSreaUvi/mmoLlgZznirbmgIFcbiAqIEBwYXJhbSB0eXBlIOmfs+mikeexu+WeiyBcImJnbVwiIOaIliBcImFtYmllbnRcIlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdG9nZ2xlUGxheVBhdXNlKHR5cGU6ICdiZ20nIHwgJ2FtYmllbnQnKSB7XG4gIGlmICghZ2V0U2V0dGluZ1ZhbHVlKCdhdWRpby5hdWRpb19lbmFibGVkJykpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCBhdWRpb0VsZW1lbnQgPSAkKGAjYXVkaW9fJHt0eXBlfWApWzBdIGFzIEhUTUxBdWRpb0VsZW1lbnQ7XG4gIGNvbnN0IHBsYXlQYXVzZUljb24gPSAkKGAjYXVkaW9fJHt0eXBlfV9wbGF5X3BhdXNlX2ljb25gKTtcblxuICBpZiAoYXVkaW9FbGVtZW50LnBhdXNlZCkge1xuICAgIGF3YWl0IHBsYXlBdWRpbyh0eXBlKTtcbiAgfSBlbHNlIHtcbiAgICBhdWRpb0VsZW1lbnQucGF1c2UoKTtcbiAgICBwbGF5UGF1c2VJY29uLnJlbW92ZUNsYXNzKCdmYS1wYXVzZScpO1xuICAgIHBsYXlQYXVzZUljb24uYWRkQ2xhc3MoJ2ZhLXBsYXknKTtcbiAgfVxufVxuXG4vKipcbiAqIOaJk+W8gFVSTOWvvOWFpeW8ueeql1xuICogQHBhcmFtIHR5cGUg6Z+z6aKR57G75Z6LXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIG9wZW5VcmxJbXBvcnRQb3B1cCgpOiBQcm9taXNlPHN0cmluZ1tdIHwgbnVsbD4ge1xuICBjb25zdCBpbnB1dCA9IChhd2FpdCBjYWxsR2VuZXJpY1BvcHVwKCfovpPlhaXopoHlr7zlhaXnmoTnvZHnu5zpn7PpopHpk77mjqXvvIjmr4/ooYzkuIDkuKrvvIknLCBQT1BVUF9UWVBFLklOUFVULCAnJykpIGFzIHN0cmluZyB8IG51bGw7XG5cbiAgaWYgKCFpbnB1dCkge1xuICAgIGxvZy5kZWJ1ZygnW0F1ZGlvXSBVUkwgaW1wb3J0IGNhbmNlbGxlZCcpO1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgY29uc3QgdXJsQXJyYXkgPSBpbnB1dFxuICAgIC50cmltKClcbiAgICAuc3BsaXQoJ1xcbicpXG4gICAgLm1hcCgodXJsOiBzdHJpbmcpID0+IHVybC50cmltKCkpXG4gICAgLmZpbHRlcigodXJsOiBzdHJpbmcpID0+IHVybCAhPT0gJycpO1xuXG4gIHJldHVybiBBcnJheS5mcm9tKG5ldyBTZXQodXJsQXJyYXkpKTtcbn1cblxuLy8g6IGK5aSp5pu05pS55pe255qE5LqL5Lu25aSE55CGXG5ldmVudFNvdXJjZS5vbihldmVudF90eXBlcy5DSEFUX0NIQU5HRUQsIGFzeW5jICgpID0+IHtcbiAgY29uc3QgJGJnbVBsYXllciA9ICQoJyNhdWRpb19iZ20nKVswXSBhcyBIVE1MQXVkaW9FbGVtZW50O1xuICBjb25zdCAkYW1iaWVudFBsYXllciA9ICQoJyNhdWRpb19hbWJpZW50JylbMF0gYXMgSFRNTEF1ZGlvRWxlbWVudDtcblxuICBpZiAoJGJnbVBsYXllciAmJiAhJGJnbVBsYXllci5wYXVzZWQpIHtcbiAgICAkYmdtUGxheWVyLnBhdXNlKCk7XG4gIH1cblxuICBpZiAoJGFtYmllbnRQbGF5ZXIgJiYgISRhbWJpZW50UGxheWVyLnBhdXNlZCkge1xuICAgICRhbWJpZW50UGxheWVyLnBhdXNlKCk7XG4gIH1cbiAgYXdhaXQgcmVmcmVzaEF1ZGlvUmVzb3VyY2VzKCk7XG4gIGxvZy5pbmZvKCdbQXVkaW9dIOiBiuWkqeW3suabtOaUue+8jOmfs+mikei1hOa6kOWIt+aWsOWujOaIkCcpO1xufSk7XG5cbi8qKiDliJ3lp4vljJbmoLflvI9cbiAqIEBwYXJhbSB0eXBlIOmfs+mikeexu+WeiyBcImJnbVwiIOaIliBcImFtYmllbnRcIlxuICovXG5mdW5jdGlvbiBpbml0QXVkaW9TdHlsZXModHlwZTogJ2JnbScgfCAnYW1iaWVudCcpIHtcbiAgLy8g6ZqQ6JeP6buY6K6k5pKt5pS+5Zmo5qC35byPXG4gICQoYCNhdWRpb18ke3R5cGV9YCkuaGlkZSgpO1xuXG4gIGlmIChnZXRTZXR0aW5nVmFsdWUoYGF1ZGlvLiR7dHlwZX1fbXV0ZWRgKSkge1xuICAgICQoYCNhdWRpb18ke3R5cGV9X211dGVfaWNvbmApLnJlbW92ZUNsYXNzKCdmYS12b2x1bWUtaGlnaCcpO1xuICAgICQoYCNhdWRpb18ke3R5cGV9X211dGVfaWNvbmApLmFkZENsYXNzKCdmYS12b2x1bWUtbXV0ZScpO1xuICAgICQoYCNhdWRpb18ke3R5cGV9X211dGVgKS5hZGRDbGFzcygncmVkT3ZlcmxheUdsb3cnKTtcbiAgICAkKGAjYXVkaW9fJHt0eXBlfWApLnByb3AoJ211dGVkJywgdHJ1ZSk7XG4gIH0gZWxzZSB7XG4gICAgJChgI2F1ZGlvXyR7dHlwZX1fbXV0ZV9pY29uYCkuYWRkQ2xhc3MoJ2ZhLXZvbHVtZS1oaWdoJyk7XG4gICAgJChgI2F1ZGlvXyR7dHlwZX1fbXV0ZV9pY29uYCkucmVtb3ZlQ2xhc3MoJ2ZhLXZvbHVtZS1tdXRlJyk7XG4gICAgJChgI2F1ZGlvXyR7dHlwZX1fbXV0ZWApLnJlbW92ZUNsYXNzKCdyZWRPdmVybGF5R2xvdycpO1xuICAgICQoYCNhdWRpb18ke3R5cGV9YCkucHJvcCgnbXV0ZWQnLCBmYWxzZSk7XG4gIH1cblxuICAkKGAjZW5hYmxlXyR7dHlwZX1gKS5wcm9wKCdjaGVja2VkJywgZ2V0U2V0dGluZ1ZhbHVlKGBhdWRpby4ke3R5cGV9X2VuYWJsZWRgKSk7XG5cbiAgY29uc3QgYXVkaW9FbGVtZW50ID0gJChgI2F1ZGlvXyR7dHlwZX1gKVswXSBhcyBIVE1MQXVkaW9FbGVtZW50O1xuICBjb25zdCBwbGF5UGF1c2VJY29uID0gJChgI2F1ZGlvXyR7dHlwZX1fcGxheV9wYXVzZV9pY29uYCk7XG5cbiAgaWYgKGF1ZGlvRWxlbWVudCAmJiBhdWRpb0VsZW1lbnQucGF1c2VkKSB7XG4gICAgcGxheVBhdXNlSWNvbi5yZW1vdmVDbGFzcygnZmEtcGF1c2UnKTtcbiAgICBwbGF5UGF1c2VJY29uLmFkZENsYXNzKCdmYS1wbGF5Jyk7XG4gIH0gZWxzZSBpZiAoYXVkaW9FbGVtZW50ICYmICFhdWRpb0VsZW1lbnQucGF1c2VkKSB7XG4gICAgcGxheVBhdXNlSWNvbi5yZW1vdmVDbGFzcygnZmEtcGxheScpO1xuICAgIHBsYXlQYXVzZUljb24uYWRkQ2xhc3MoJ2ZhLXBhdXNlJyk7XG4gIH1cbiAgdXBkYXRlQXVkaW9TZWxlY3QodHlwZSk7XG4gIGluaXRpYWxpemVQcm9ncmVzc0Jhcih0eXBlKTtcbn1cblxuLyoqXG4gKiDliJ3lp4vljJbmiYDmnInpn7PpopHnm7jlhbPnu4Tku7blkozkuovku7bnm5HlkKzlmahcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGluaXRBdWRpb0NvbXBvbmVudHMoKSB7XG4gIC8vIOWKoOi9vemfs+mikeaSreaUvuWZqOagt+W8j1xuICBhd2FpdCBsb2FkRmlsZVRvRG9jdW1lbnQoYC9zY3JpcHRzL2V4dGVuc2lvbnMvJHtleHRlbnNpb25Gb2xkZXJQYXRofS9zcmMvY29tcG9uZW50L2F1ZGlvL3N0eWxlLmNzc2AsICdjc3MnKTtcblxuICBpc0F1ZGlvRW5hYmxlZCA9IGdldFNldHRpbmdWYWx1ZSgnYXVkaW8uYXVkaW9fZW5hYmxlZCcpO1xuICBoYW5kbGVBdWRpb1RvZ2dsZShpc0F1ZGlvRW5hYmxlZCwgZmFsc2UpO1xuICAkKCcjYXVkaW8tZW5hYmxlLXRvZ2dsZScpXG4gICAgLnByb3AoJ2NoZWNrZWQnLCBpc0F1ZGlvRW5hYmxlZClcbiAgICAub24oJ2NsaWNrJywgKGV2ZW50OiBKUXVlcnkuQ2xpY2tFdmVudCkgPT4gaGFuZGxlQXVkaW9Ub2dnbGUoZXZlbnQudGFyZ2V0LmNoZWNrZWQsIHRydWUpKTtcblxuICAvLyDliJ3lp4vljJbmipjlj6Dmjqfku7ZcbiAgQ29sbGFwc2libGUuaW5pdEFsbCgnI2F1ZGlvLXBsYXllci1oZWFkZXInLCB7XG4gICAgaGVhZGVyU2VsZWN0b3I6ICcjYXVkaW8tcGxheWVyLWhlYWRlcicsXG4gICAgY29udGVudFNlbGVjdG9yOiAnI2F1ZGlvLXBsYXllci1jb250ZW50JyxcbiAgICBpbml0aWFsbHlFeHBhbmRlZDogdHJ1ZSxcbiAgICBhbmltYXRpb25EdXJhdGlvbjoge1xuICAgICAgZXhwYW5kOiAyODAsXG4gICAgICBjb2xsYXBzZTogMjUwLFxuICAgIH0sXG4gIH0pO1xuXG4gIC8vIOWIneWni+WMlumfs+S5kOWSjOmfs+aViOagt+W8j1xuICBpbml0QXVkaW9TdHlsZXMoJ2JnbScpO1xuICBpbml0QXVkaW9TdHlsZXMoJ2FtYmllbnQnKTtcblxuICBjb25zdCBhdWRpb1R5cGVzID0gWydiZ20nLCAnYW1iaWVudCddIGFzIGNvbnN0O1xuXG4gIGNvbnN0IGJpbmRUeXBlRXZlbnRzID0gKFxuICAgIHR5cGU6ICdiZ20nIHwgJ2FtYmllbnQnLFxuICAgIGV2ZW50czogQXJyYXk8e1xuICAgICAgc2VsZWN0b3I6IHN0cmluZztcbiAgICAgIGV2ZW50OiBzdHJpbmc7XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tc2hhZG93XG4gICAgICBoYW5kbGVyOiAodHlwZTogJ2JnbScgfCAnYW1iaWVudCcpID0+IHZvaWQ7XG4gICAgfT4sXG4gICkgPT4ge1xuICAgIGV2ZW50cy5mb3JFYWNoKCh7IHNlbGVjdG9yLCBldmVudCwgaGFuZGxlciB9KSA9PiB7XG4gICAgICAkKGAjJHtzZWxlY3Rvcn1gKS5vbihldmVudCwgKCkgPT4gaGFuZGxlcih0eXBlKSk7XG4gICAgfSk7XG4gIH07XG5cbiAgYXVkaW9UeXBlcy5mb3JFYWNoKHR5cGUgPT4ge1xuICAgICQoYCNlbmFibGVfJHt0eXBlfWApLm9uKCdjbGljaycsICgpID0+IG9uQXVkaW9FbmFibGVkQ2xpY2sodHlwZSkpO1xuXG4gICAgYmluZFR5cGVFdmVudHModHlwZSwgW1xuICAgICAge1xuICAgICAgICBzZWxlY3RvcjogYGVuYWJsZV8ke3R5cGV9YCxcbiAgICAgICAgZXZlbnQ6ICdjbGljaycsXG4gICAgICAgIGhhbmRsZXI6IG9uQXVkaW9FbmFibGVkQ2xpY2ssXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBzZWxlY3RvcjogYGF1ZGlvXyR7dHlwZX1fbW9kZWAsXG4gICAgICAgIGV2ZW50OiAnY2xpY2snLFxuICAgICAgICBoYW5kbGVyOiBvbkF1ZGlvTW9kZUNsaWNrLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgc2VsZWN0b3I6IGBhdWRpb18ke3R5cGV9X211dGVgLFxuICAgICAgICBldmVudDogJ2NsaWNrJyxcbiAgICAgICAgaGFuZGxlcjogb25BdWRpb011dGVDbGljayxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIHNlbGVjdG9yOiBgYXVkaW9fJHt0eXBlfV92b2x1bWVfc2xpZGVyYCxcbiAgICAgICAgZXZlbnQ6ICdpbnB1dCcsXG4gICAgICAgIGhhbmRsZXI6IG9uQXVkaW9Wb2x1bWVDaGFuZ2UsXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBzZWxlY3RvcjogYGF1ZGlvXyR7dHlwZX1fc2VsZWN0YCxcbiAgICAgICAgZXZlbnQ6ICdjaGFuZ2UnLFxuICAgICAgICBoYW5kbGVyOiBvbkF1ZGlvU2VsZWN0Q2hhbmdlLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgc2VsZWN0b3I6IGBhdWRpb18ke3R5cGV9X3BsYXlfcGF1c2VgLFxuICAgICAgICBldmVudDogJ2NsaWNrJyxcbiAgICAgICAgaGFuZGxlcjogdG9nZ2xlUGxheVBhdXNlLFxuICAgICAgfSxcbiAgICBdKTtcblxuICAgICQoJyNhdWRpb19jb29sZG93bicpLm9uKCdpbnB1dCcsIG9uQXVkaW9Db29sZG93bklucHV0KS52YWwoZ2V0U2V0dGluZ1ZhbHVlKCdhdWRpby5hdWRpb19jb29sZG93bicpKTtcblxuICAgIC8vIOebkeWQrOmfs+mikee7k+adn+S6i+S7tlxuICAgIGluaXRBdWRpb0V2ZW50TGlzdGVuZXJzKCdiZ20nKTtcbiAgICBpbml0QXVkaW9FdmVudExpc3RlbmVycygnYW1iaWVudCcpO1xuXG4gICAgY29uc3Qgdm9sdW1lU2xpZGVyID0gJChgI2F1ZGlvXyR7dHlwZX1fdm9sdW1lX3NsaWRlcmApLmdldCgwKTtcbiAgICBpZiAodm9sdW1lU2xpZGVyKSB7XG4gICAgICB2b2x1bWVTbGlkZXIuYWRkRXZlbnRMaXN0ZW5lcignd2hlZWwnLCBvblZvbHVtZVNsaWRlcldoZWVsRXZlbnQsIHtcbiAgICAgICAgcGFzc2l2ZTogZmFsc2UsXG4gICAgICB9KTtcbiAgICB9XG4gIH0pO1xuXG4gICQoJyNhdWRpb19yZWZyZXNoX2Fzc2V0cycpLm9uKCdjbGljaycsIGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCByZWZyZXNoQXVkaW9SZXNvdXJjZXMoKTtcbiAgfSk7XG5cbiAgaGFuZGxlTG9uZ1ByZXNzKCdiZ20tdm9sdW1lLWNvbnRyb2wnLCAnYXVkaW9fYmdtX211dGVfaWNvbicpO1xuICBoYW5kbGVMb25nUHJlc3MoJ2FtYmllbnQtdm9sdW1lLWNvbnRyb2wnLCAnYXVkaW9fYW1iaWVudF9tdXRlX2ljb24nKTtcblxuICBjb25zdCB1cmxNYW5hZ2VyTWFwID0ge1xuICAgIGJnbTogJ2JnbXVybCcsXG4gICAgYW1iaWVudDogJ2FtYmllbnR1cmwnLFxuICB9O1xuXG4gIGF1ZGlvVHlwZXMuZm9yRWFjaCh0eXBlID0+IHtcbiAgICAkKGAjJHt0eXBlfV9tYW5hZ2VyX2J1dHRvbmApLm9uKCdjbGljaycsIGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IG9wZW5VcmxNYW5hZ2VyUG9wdXAodXJsTWFuYWdlck1hcFt0eXBlXSBhcyAnYmdtdXJsJyB8ICdhbWJpZW50dXJsJyk7XG4gICAgICBhd2FpdCByZWZyZXNoQXVkaW9SZXNvdXJjZXMoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgY29uc3QgYmdtQXVkaW8gPSAkKCcjYXVkaW9fYmdtJylbMF0gYXMgSFRNTEF1ZGlvRWxlbWVudDtcbiAgY29uc3QgYW1iaWVudEF1ZGlvID0gJCgnI2F1ZGlvX2FtYmllbnQnKVswXSBhcyBIVE1MQXVkaW9FbGVtZW50O1xuXG4gIGNvbnN0IHRvZ2dsZVBsYXlQYXVzZUljb24gPSAoYXVkaW9FbGVtZW50OiBIVE1MQXVkaW9FbGVtZW50LCBpY29uU2VsZWN0b3I6IHN0cmluZykgPT4ge1xuICAgIGNvbnN0IGljb24gPSAkKGljb25TZWxlY3Rvcik7XG4gICAgYXVkaW9FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3BsYXknLCAoKSA9PiBpY29uLnJlbW92ZUNsYXNzKCdmYS1wbGF5JykuYWRkQ2xhc3MoJ2ZhLXBhdXNlJykpO1xuICAgIGF1ZGlvRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdwYXVzZScsICgpID0+IGljb24ucmVtb3ZlQ2xhc3MoJ2ZhLXBhdXNlJykuYWRkQ2xhc3MoJ2ZhLXBsYXknKSk7XG4gIH07XG5cbiAgdG9nZ2xlUGxheVBhdXNlSWNvbihiZ21BdWRpbywgJyNhdWRpb19iZ21fcGxheV9wYXVzZV9pY29uJyk7XG4gIHRvZ2dsZVBsYXlQYXVzZUljb24oYW1iaWVudEF1ZGlvLCAnI2F1ZGlvX2FtYmllbnRfcGxheV9wYXVzZV9pY29uJyk7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/component/audio/index.ts\n\n}")},"./src/component/index.ts":
/*!********************************!*\
  !*** ./src/component/index.ts ***!
  \********************************/(module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   initExtensionMainPanel: () => (/* binding */ initExtensionMainPanel)\n/* harmony export */ });\n/* harmony import */ var _component_macro__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/macro */ \"./src/component/macro.ts\");\n/* harmony import */ var _component_macrolike__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/component/macrolike */ \"./src/component/macrolike.ts\");\n/* harmony import */ var _component_message_iframe_render_hide_style__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/component/message_iframe/render_hide_style */ \"./src/component/message_iframe/render_hide_style.ts\");\n/* harmony import */ var _component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/component/message_iframe/render_message */ \"./src/component/message_iframe/render_message.ts\");\n/* harmony import */ var _component_message_iframe_index__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/component/message_iframe/index */ \"./src/component/message_iframe/index.ts\");\n/* harmony import */ var _component_message_iframe_render_optimize__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/component/message_iframe/render_optimize */ \"./src/component/message_iframe/render_optimize.ts\");\n/* harmony import */ var _component_script_iframe__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/component/script_iframe */ \"./src/component/script_iframe.ts\");\n/* harmony import */ var _component_script_repository_index__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @/component/script_repository/index */ \"./src/component/script_repository/index.ts\");\n/* harmony import */ var _component_toastr__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @/component/toastr */ \"./src/component/toastr.ts\");\n/* harmony import */ var _iframe_client_index__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @/iframe_client/index */ \"./src/iframe_client/index.ts\");\n/* harmony import */ var _script_url__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @/script_url */ \"./src/script_url.ts\");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _component_prompt_view__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @/component/prompt_view */ \"./src/component/prompt_view/index.ts\");\n/* harmony import */ var _component_variable_manager__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @/component/variable_manager */ \"./src/component/variable_manager/index.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_component_script_repository_index__WEBPACK_IMPORTED_MODULE_7__, _component_variable_manager__WEBPACK_IMPORTED_MODULE_14__]);\n([_component_script_repository_index__WEBPACK_IMPORTED_MODULE_7__, _component_variable_manager__WEBPACK_IMPORTED_MODULE_14__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst handleChatLoaded = async () => {\n    await (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_3__.renderAllIframes)();\n    (0,_component_message_iframe_render_hide_style__WEBPACK_IMPORTED_MODULE_2__.addCodeToggleButtonsToAllMessages)();\n};\nconst handleChatChanged = async () => {\n    (0,_component_macrolike__WEBPACK_IMPORTED_MODULE_1__.renderAllMacros)();\n};\nconst handlePartialRender = (mesId) => {\n    const mesIdNumber = parseInt(mesId, 10);\n    (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_3__.renderPartialIframes)(mesIdNumber);\n};\nconst handleMessageDeleted = (mesId) => {\n    const mesIdNumber = parseInt(mesId, 10);\n    (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_3__.renderMessageAfterDelete)(mesIdNumber);\n    if ((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_11__.getSettingValue)('render.render_hide_style')) {\n        (0,_component_message_iframe_render_hide_style__WEBPACK_IMPORTED_MODULE_2__.addCodeToggleButtonsToAllMessages)();\n    }\n};\n/**\n * 初始化扩展主设置界面\n */\nfunction initExtensionMainPanel() {\n    const isEnabled = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_11__.getSettingValue)('enabled_extension');\n    if (isEnabled) {\n        handleExtensionToggle(false, true);\n    }\n    $('#extension-enable-toggle')\n        .prop('checked', isEnabled)\n        .on('change', function (event) {\n        handleExtensionToggle(true, $(event.currentTarget).prop('checked'));\n    });\n}\n/**\n * 添加所有快捷入口\n */\nfunction addAllShortcut() {\n    (0,_component_message_iframe_index__WEBPACK_IMPORTED_MODULE_4__.addRenderQuickButton)();\n    (0,_component_prompt_view__WEBPACK_IMPORTED_MODULE_13__.addPromptViewQuickButton)();\n    (0,_component_variable_manager__WEBPACK_IMPORTED_MODULE_14__.addVariableManagerQuickButton)();\n}\n/**\n * 移除所有添加的快捷入口\n */\nfunction removeAllShortcut() {\n    $('#extensionsMenu').find('.tavern-helper-shortcut-item').remove();\n}\n/**\n * 扩展总开关切换\n * @param userAction 是否为用户触发\n * @param enable 是否启用\n */\nasync function handleExtensionToggle(userAction = true, enable = true) {\n    if (userAction) {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_11__.saveSettingValue)('enabled_extension', enable);\n    }\n    if (enable) {\n        // 指示器样式\n        $('#extension-status-icon').css('color', 'green').next().text('扩展已启用');\n        _script_url__WEBPACK_IMPORTED_MODULE_10__.script_url.set('iframe_client', _iframe_client_index__WEBPACK_IMPORTED_MODULE_9__.iframe_client);\n        _script_url__WEBPACK_IMPORTED_MODULE_10__.script_url.set('viewport_adjust_script', _component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_3__.viewport_adjust_script);\n        _script_url__WEBPACK_IMPORTED_MODULE_10__.script_url.set('tampermonkey_script', _component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_3__.tampermonkey_script);\n        (0,_component_macro__WEBPACK_IMPORTED_MODULE_0__.registerAllMacros)();\n        (0,_component_toastr__WEBPACK_IMPORTED_MODULE_8__.initializeToastr)();\n        (0,_component_macrolike__WEBPACK_IMPORTED_MODULE_1__.initializeMacroOnExtension)();\n        (0,_component_script_iframe__WEBPACK_IMPORTED_MODULE_6__.initializeCharacterLevelOnExtension)();\n        (0,_component_script_repository_index__WEBPACK_IMPORTED_MODULE_7__.buildScriptRepositoryOnExtension)();\n        addAllShortcut();\n        // 重新注入前端卡优化的样式和设置\n        if (userAction && (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_11__.getSettingValue)('render.rendering_optimize')) {\n            (0,_component_message_iframe_render_optimize__WEBPACK_IMPORTED_MODULE_5__.addRenderingOptimizeSettings)();\n        }\n        if (userAction && (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_11__.getSettingValue)('render.render_hide_style')) {\n            (0,_component_message_iframe_render_hide_style__WEBPACK_IMPORTED_MODULE_2__.addRenderingHideStyleSettings)();\n        }\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_12__.eventSource.on(_sillytavern_script__WEBPACK_IMPORTED_MODULE_12__.event_types.CHAT_CHANGED, handleChatChanged);\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_12__.eventSource.on('chatLoaded', handleChatLoaded);\n        _component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_3__.partialRenderEvents.forEach(eventType => {\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_12__.eventSource.on(eventType, handlePartialRender);\n        });\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_12__.eventSource.on(_sillytavern_script__WEBPACK_IMPORTED_MODULE_12__.event_types.MESSAGE_DELETED, handleMessageDeleted);\n        if (userAction && _sillytavern_script__WEBPACK_IMPORTED_MODULE_12__.this_chid !== undefined) {\n            await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_12__.reloadCurrentChat)();\n        }\n    }\n    else {\n        // 指示器样式\n        $('#extension-status-icon').css('color', 'red').next().text('扩展已禁用');\n        _script_url__WEBPACK_IMPORTED_MODULE_10__.script_url.delete('iframe_client');\n        _script_url__WEBPACK_IMPORTED_MODULE_10__.script_url.delete('viewport_adjust_script');\n        _script_url__WEBPACK_IMPORTED_MODULE_10__.script_url.delete('tampermonkey_script');\n        (0,_component_macro__WEBPACK_IMPORTED_MODULE_0__.unregisterAllMacros)();\n        (0,_component_macrolike__WEBPACK_IMPORTED_MODULE_1__.destroyMacroOnExtension)();\n        (0,_component_script_iframe__WEBPACK_IMPORTED_MODULE_6__.destroyCharacterLevelOnExtension)();\n        (0,_component_script_repository_index__WEBPACK_IMPORTED_MODULE_7__.destroyScriptRepositoryOnExtension)();\n        removeAllShortcut();\n        if ((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_11__.getSettingValue)('render.rendering_optimize')) {\n            (0,_component_message_iframe_render_optimize__WEBPACK_IMPORTED_MODULE_5__.removeRenderingOptimizeSettings)();\n        }\n        if ((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_11__.getSettingValue)('render.render_hide_style')) {\n            (0,_component_message_iframe_render_hide_style__WEBPACK_IMPORTED_MODULE_2__.removeRenderingHideStyleSettings)();\n        }\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_12__.eventSource.removeListener(_sillytavern_script__WEBPACK_IMPORTED_MODULE_12__.event_types.CHAT_CHANGED, handleChatChanged);\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_12__.eventSource.removeListener('chatLoaded', handleChatLoaded);\n        _component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_3__.partialRenderEvents.forEach(eventType => {\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_12__.eventSource.removeListener(eventType, handlePartialRender);\n        });\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_12__.eventSource.removeListener(_sillytavern_script__WEBPACK_IMPORTED_MODULE_12__.event_types.MESSAGE_DELETED, handleMessageDeleted);\n        if (userAction && _sillytavern_script__WEBPACK_IMPORTED_MODULE_12__.this_chid !== undefined) {\n            await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_12__.reloadCurrentChat)();\n        }\n    }\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_12__.saveSettingsDebounced)();\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0FBQztRQUM1QyxvREFBVSxDQUFDLE1BQU0sQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO1FBRXpDLHFFQUFtQixFQUFFLENBQUM7UUFDdEIsNkVBQXVCLEVBQUUsQ0FBQztRQUMxQiwwRkFBZ0MsRUFBRSxDQUFDO1FBQ25DLHNHQUFrQyxFQUFFLENBQUM7UUFFckMsaUJBQWlCLEVBQUUsQ0FBQztRQUVwQixJQUFJLDJFQUFlLENBQUMsMkJBQTJCLENBQUMsRUFBRSxDQUFDO1lBQ2pELDBHQUErQixFQUFFLENBQUM7UUFDcEMsQ0FBQztRQUVELElBQUksMkVBQWUsQ0FBQywwQkFBMEIsQ0FBQyxFQUFFLENBQUM7WUFDaEQsNkdBQWdDLEVBQUUsQ0FBQztRQUNyQyxDQUFDO1FBRUQsNkRBQVcsQ0FBQyxjQUFjLENBQUMsNkRBQVcsQ0FBQyxZQUFZLEVBQUUsaUJBQWlCLENBQUMsQ0FBQztRQUN4RSw2REFBVyxDQUFDLGNBQWMsQ0FBQyxZQUFZLEVBQUUsZ0JBQWdCLENBQUMsQ0FBQztRQUMzRCx5RkFBbUIsQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLEVBQUU7WUFDdEMsNkRBQVcsQ0FBQyxjQUFjLENBQUMsU0FBUyxFQUFFLG1CQUFtQixDQUFDLENBQUM7UUFDN0QsQ0FBQyxDQUFDLENBQUM7UUFDSCw2REFBVyxDQUFDLGNBQWMsQ0FBQyw2REFBVyxDQUFDLGVBQWUsRUFBRSxvQkFBb0IsQ0FBQyxDQUFDO1FBQzlFLElBQUksVUFBVSxJQUFJLDJEQUFTLEtBQUssU0FBUyxFQUFFLENBQUM7WUFDMUMsTUFBTSx1RUFBaUIsRUFBRSxDQUFDO1FBQzVCLENBQUM7SUFDSCxDQUFDO0lBQ0QsMkVBQXFCLEVBQUUsQ0FBQztBQUMxQixDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBvbmVudC9pbmRleC50cz85Njc0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHJlZ2lzdGVyQWxsTWFjcm9zLCB1bnJlZ2lzdGVyQWxsTWFjcm9zIH0gZnJvbSAnQC9jb21wb25lbnQvbWFjcm8nO1xuaW1wb3J0IHsgZGVzdHJveU1hY3JvT25FeHRlbnNpb24sIGluaXRpYWxpemVNYWNyb09uRXh0ZW5zaW9uLCByZW5kZXJBbGxNYWNyb3MgfSBmcm9tICdAL2NvbXBvbmVudC9tYWNyb2xpa2UnO1xuaW1wb3J0IHtcbiAgYWRkQ29kZVRvZ2dsZUJ1dHRvbnNUb0FsbE1lc3NhZ2VzLFxuICBhZGRSZW5kZXJpbmdIaWRlU3R5bGVTZXR0aW5ncyxcbiAgcmVtb3ZlUmVuZGVyaW5nSGlkZVN0eWxlU2V0dGluZ3MsXG59IGZyb20gJ0AvY29tcG9uZW50L21lc3NhZ2VfaWZyYW1lL3JlbmRlcl9oaWRlX3N0eWxlJztcbmltcG9ydCB7XG4gIHBhcnRpYWxSZW5kZXJFdmVudHMsXG4gIHJlbmRlckFsbElmcmFtZXMsXG4gIHJlbmRlck1lc3NhZ2VBZnRlckRlbGV0ZSxcbiAgcmVuZGVyUGFydGlhbElmcmFtZXMsXG4gIHRhbXBlcm1vbmtleV9zY3JpcHQsXG4gIHZpZXdwb3J0X2FkanVzdF9zY3JpcHQsXG59IGZyb20gJ0AvY29tcG9uZW50L21lc3NhZ2VfaWZyYW1lL3JlbmRlcl9tZXNzYWdlJztcbmltcG9ydCB7IGFkZFJlbmRlclF1aWNrQnV0dG9uIH0gZnJvbSAnQC9jb21wb25lbnQvbWVzc2FnZV9pZnJhbWUvaW5kZXgnO1xuaW1wb3J0IHtcbiAgYWRkUmVuZGVyaW5nT3B0aW1pemVTZXR0aW5ncyxcbiAgcmVtb3ZlUmVuZGVyaW5nT3B0aW1pemVTZXR0aW5ncyxcbn0gZnJvbSAnQC9jb21wb25lbnQvbWVzc2FnZV9pZnJhbWUvcmVuZGVyX29wdGltaXplJztcbmltcG9ydCB7IGRlc3Ryb3lDaGFyYWN0ZXJMZXZlbE9uRXh0ZW5zaW9uLCBpbml0aWFsaXplQ2hhcmFjdGVyTGV2ZWxPbkV4dGVuc2lvbiB9IGZyb20gJ0AvY29tcG9uZW50L3NjcmlwdF9pZnJhbWUnO1xuaW1wb3J0IHtcbiAgYnVpbGRTY3JpcHRSZXBvc2l0b3J5T25FeHRlbnNpb24sXG4gIGRlc3Ryb3lTY3JpcHRSZXBvc2l0b3J5T25FeHRlbnNpb24sXG59IGZyb20gJ0AvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L2luZGV4JztcbmltcG9ydCB7IGluaXRpYWxpemVUb2FzdHIgfSBmcm9tICdAL2NvbXBvbmVudC90b2FzdHInO1xuaW1wb3J0IHsgaWZyYW1lX2NsaWVudCB9IGZyb20gJ0AvaWZyYW1lX2NsaWVudC9pbmRleCc7XG5pbXBvcnQgeyBzY3JpcHRfdXJsIH0gZnJvbSAnQC9zY3JpcHRfdXJsJztcbmltcG9ydCB7IGdldFNldHRpbmdWYWx1ZSwgc2F2ZVNldHRpbmdWYWx1ZSB9IGZyb20gJ0AvdXRpbC9leHRlbnNpb25fdmFyaWFibGVzJztcbmltcG9ydCB7IGV2ZW50U291cmNlLCBldmVudF90eXBlcywgcmVsb2FkQ3VycmVudENoYXQsIHNhdmVTZXR0aW5nc0RlYm91bmNlZCwgdGhpc19jaGlkIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5pbXBvcnQgeyBhZGRQcm9tcHRWaWV3UXVpY2tCdXR0b24gfSBmcm9tICdAL2NvbXBvbmVudC9wcm9tcHRfdmlldyc7XG5pbXBvcnQgeyBhZGRWYXJpYWJsZU1hbmFnZXJRdWlja0J1dHRvbiB9IGZyb20gJ0AvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXInO1xuXG5jb25zdCBoYW5kbGVDaGF0TG9hZGVkID0gYXN5bmMgKCkgPT4ge1xuICBhd2FpdCByZW5kZXJBbGxJZnJhbWVzKCk7XG4gIGFkZENvZGVUb2dnbGVCdXR0b25zVG9BbGxNZXNzYWdlcygpO1xufTtcblxuY29uc3QgaGFuZGxlQ2hhdENoYW5nZWQgPSBhc3luYyAoKSA9PiB7XG4gIHJlbmRlckFsbE1hY3JvcygpO1xufTtcblxuY29uc3QgaGFuZGxlUGFydGlhbFJlbmRlciA9IChtZXNJZDogc3RyaW5nKSA9PiB7XG4gIGNvbnN0IG1lc0lkTnVtYmVyID0gcGFyc2VJbnQobWVzSWQsIDEwKTtcbiAgcmVuZGVyUGFydGlhbElmcmFtZXMobWVzSWROdW1iZXIpO1xufTtcblxuY29uc3QgaGFuZGxlTWVzc2FnZURlbGV0ZWQgPSAobWVzSWQ6IHN0cmluZykgPT4ge1xuICBjb25zdCBtZXNJZE51bWJlciA9IHBhcnNlSW50KG1lc0lkLCAxMCk7XG4gIHJlbmRlck1lc3NhZ2VBZnRlckRlbGV0ZShtZXNJZE51bWJlcik7XG4gIGlmIChnZXRTZXR0aW5nVmFsdWUoJ3JlbmRlci5yZW5kZXJfaGlkZV9zdHlsZScpKSB7XG4gICAgYWRkQ29kZVRvZ2dsZUJ1dHRvbnNUb0FsbE1lc3NhZ2VzKCk7XG4gIH1cbn07XG5cbi8qKlxuICog5Yid5aeL5YyW5omp5bGV5Li76K6+572u55WM6Z2iXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbml0RXh0ZW5zaW9uTWFpblBhbmVsKCkge1xuICBjb25zdCBpc0VuYWJsZWQgPSBnZXRTZXR0aW5nVmFsdWUoJ2VuYWJsZWRfZXh0ZW5zaW9uJyk7XG4gIGlmIChpc0VuYWJsZWQpIHtcbiAgICBoYW5kbGVFeHRlbnNpb25Ub2dnbGUoZmFsc2UsIHRydWUpO1xuICB9XG4gICQoJyNleHRlbnNpb24tZW5hYmxlLXRvZ2dsZScpXG4gICAgLnByb3AoJ2NoZWNrZWQnLCBpc0VuYWJsZWQpXG4gICAgLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbiAoZXZlbnQ6IEpRdWVyeS5DaGFuZ2VFdmVudCkge1xuICAgICAgaGFuZGxlRXh0ZW5zaW9uVG9nZ2xlKHRydWUsICQoZXZlbnQuY3VycmVudFRhcmdldCkucHJvcCgnY2hlY2tlZCcpKTtcbiAgICB9KTtcbn1cblxuLyoqXG4gKiDmt7vliqDmiYDmnInlv6vmjbflhaXlj6NcbiAqL1xuZnVuY3Rpb24gYWRkQWxsU2hvcnRjdXQoKSB7XG4gIGFkZFJlbmRlclF1aWNrQnV0dG9uKCk7XG4gIGFkZFByb21wdFZpZXdRdWlja0J1dHRvbigpO1xuICBhZGRWYXJpYWJsZU1hbmFnZXJRdWlja0J1dHRvbigpO1xufVxuXG4vKipcbiAqIOenu+mZpOaJgOaciea3u+WKoOeahOW/q+aNt+WFpeWPo1xuICovXG5mdW5jdGlvbiByZW1vdmVBbGxTaG9ydGN1dCgpIHtcbiAgJCgnI2V4dGVuc2lvbnNNZW51JykuZmluZCgnLnRhdmVybi1oZWxwZXItc2hvcnRjdXQtaXRlbScpLnJlbW92ZSgpO1xufVxuXG4vKipcbiAqIOaJqeWxleaAu+W8gOWFs+WIh+aNolxuICogQHBhcmFtIHVzZXJBY3Rpb24g5piv5ZCm5Li655So5oi36Kem5Y+RXG4gKiBAcGFyYW0gZW5hYmxlIOaYr+WQpuWQr+eUqFxuICovXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVFeHRlbnNpb25Ub2dnbGUodXNlckFjdGlvbjogYm9vbGVhbiA9IHRydWUsIGVuYWJsZTogYm9vbGVhbiA9IHRydWUpIHtcbiAgaWYgKHVzZXJBY3Rpb24pIHtcbiAgICBzYXZlU2V0dGluZ1ZhbHVlKCdlbmFibGVkX2V4dGVuc2lvbicsIGVuYWJsZSk7XG4gIH1cbiAgaWYgKGVuYWJsZSkge1xuICAgIC8vIOaMh+ekuuWZqOagt+W8j1xuICAgICQoJyNleHRlbnNpb24tc3RhdHVzLWljb24nKS5jc3MoJ2NvbG9yJywgJ2dyZWVuJykubmV4dCgpLnRleHQoJ+aJqeWxleW3suWQr+eUqCcpO1xuXG4gICAgc2NyaXB0X3VybC5zZXQoJ2lmcmFtZV9jbGllbnQnLCBpZnJhbWVfY2xpZW50KTtcbiAgICBzY3JpcHRfdXJsLnNldCgndmlld3BvcnRfYWRqdXN0X3NjcmlwdCcsIHZpZXdwb3J0X2FkanVzdF9zY3JpcHQpO1xuICAgIHNjcmlwdF91cmwuc2V0KCd0YW1wZXJtb25rZXlfc2NyaXB0JywgdGFtcGVybW9ua2V5X3NjcmlwdCk7XG5cbiAgICByZWdpc3RlckFsbE1hY3JvcygpO1xuICAgIGluaXRpYWxpemVUb2FzdHIoKTtcbiAgICBpbml0aWFsaXplTWFjcm9PbkV4dGVuc2lvbigpO1xuICAgIGluaXRpYWxpemVDaGFyYWN0ZXJMZXZlbE9uRXh0ZW5zaW9uKCk7XG4gICAgYnVpbGRTY3JpcHRSZXBvc2l0b3J5T25FeHRlbnNpb24oKTtcblxuICAgIGFkZEFsbFNob3J0Y3V0KCk7XG5cbiAgICAvLyDph43mlrDms6jlhaXliY3nq6/ljaHkvJjljJbnmoTmoLflvI/lkozorr7nva5cbiAgICBpZiAodXNlckFjdGlvbiAmJiBnZXRTZXR0aW5nVmFsdWUoJ3JlbmRlci5yZW5kZXJpbmdfb3B0aW1pemUnKSkge1xuICAgICAgYWRkUmVuZGVyaW5nT3B0aW1pemVTZXR0aW5ncygpO1xuICAgIH1cbiAgICBpZiAodXNlckFjdGlvbiAmJiBnZXRTZXR0aW5nVmFsdWUoJ3JlbmRlci5yZW5kZXJfaGlkZV9zdHlsZScpKSB7XG4gICAgICBhZGRSZW5kZXJpbmdIaWRlU3R5bGVTZXR0aW5ncygpO1xuICAgIH1cblxuICAgIGV2ZW50U291cmNlLm9uKGV2ZW50X3R5cGVzLkNIQVRfQ0hBTkdFRCwgaGFuZGxlQ2hhdENoYW5nZWQpO1xuICAgIGV2ZW50U291cmNlLm9uKCdjaGF0TG9hZGVkJywgaGFuZGxlQ2hhdExvYWRlZCk7XG5cbiAgICBwYXJ0aWFsUmVuZGVyRXZlbnRzLmZvckVhY2goZXZlbnRUeXBlID0+IHtcbiAgICAgIGV2ZW50U291cmNlLm9uKGV2ZW50VHlwZSwgaGFuZGxlUGFydGlhbFJlbmRlcik7XG4gICAgfSk7XG5cbiAgICBldmVudFNvdXJjZS5vbihldmVudF90eXBlcy5NRVNTQUdFX0RFTEVURUQsIGhhbmRsZU1lc3NhZ2VEZWxldGVkKTtcbiAgICBpZiAodXNlckFjdGlvbiAmJiB0aGlzX2NoaWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgYXdhaXQgcmVsb2FkQ3VycmVudENoYXQoKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgLy8g5oyH56S65Zmo5qC35byPXG4gICAgJCgnI2V4dGVuc2lvbi1zdGF0dXMtaWNvbicpLmNzcygnY29sb3InLCAncmVkJykubmV4dCgpLnRleHQoJ+aJqeWxleW3suemgeeUqCcpO1xuXG4gICAgc2NyaXB0X3VybC5kZWxldGUoJ2lmcmFtZV9jbGllbnQnKTtcbiAgICBzY3JpcHRfdXJsLmRlbGV0ZSgndmlld3BvcnRfYWRqdXN0X3NjcmlwdCcpO1xuICAgIHNjcmlwdF91cmwuZGVsZXRlKCd0YW1wZXJtb25rZXlfc2NyaXB0Jyk7XG5cbiAgICB1bnJlZ2lzdGVyQWxsTWFjcm9zKCk7XG4gICAgZGVzdHJveU1hY3JvT25FeHRlbnNpb24oKTtcbiAgICBkZXN0cm95Q2hhcmFjdGVyTGV2ZWxPbkV4dGVuc2lvbigpO1xuICAgIGRlc3Ryb3lTY3JpcHRSZXBvc2l0b3J5T25FeHRlbnNpb24oKTtcblxuICAgIHJlbW92ZUFsbFNob3J0Y3V0KCk7XG5cbiAgICBpZiAoZ2V0U2V0dGluZ1ZhbHVlKCdyZW5kZXIucmVuZGVyaW5nX29wdGltaXplJykpIHtcbiAgICAgIHJlbW92ZVJlbmRlcmluZ09wdGltaXplU2V0dGluZ3MoKTtcbiAgICB9XG5cbiAgICBpZiAoZ2V0U2V0dGluZ1ZhbHVlKCdyZW5kZXIucmVuZGVyX2hpZGVfc3R5bGUnKSkge1xuICAgICAgcmVtb3ZlUmVuZGVyaW5nSGlkZVN0eWxlU2V0dGluZ3MoKTtcbiAgICB9XG5cbiAgICBldmVudFNvdXJjZS5yZW1vdmVMaXN0ZW5lcihldmVudF90eXBlcy5DSEFUX0NIQU5HRUQsIGhhbmRsZUNoYXRDaGFuZ2VkKTtcbiAgICBldmVudFNvdXJjZS5yZW1vdmVMaXN0ZW5lcignY2hhdExvYWRlZCcsIGhhbmRsZUNoYXRMb2FkZWQpO1xuICAgIHBhcnRpYWxSZW5kZXJFdmVudHMuZm9yRWFjaChldmVudFR5cGUgPT4ge1xuICAgICAgZXZlbnRTb3VyY2UucmVtb3ZlTGlzdGVuZXIoZXZlbnRUeXBlLCBoYW5kbGVQYXJ0aWFsUmVuZGVyKTtcbiAgICB9KTtcbiAgICBldmVudFNvdXJjZS5yZW1vdmVMaXN0ZW5lcihldmVudF90eXBlcy5NRVNTQUdFX0RFTEVURUQsIGhhbmRsZU1lc3NhZ2VEZWxldGVkKTtcbiAgICBpZiAodXNlckFjdGlvbiAmJiB0aGlzX2NoaWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgYXdhaXQgcmVsb2FkQ3VycmVudENoYXQoKTtcbiAgICB9XG4gIH1cbiAgc2F2ZVNldHRpbmdzRGVib3VuY2VkKCk7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/component/index.ts\n\n}")},"./src/component/listener/index.ts":
/*!*****************************************!*\
  !*** ./src/component/listener/index.ts ***!
  \*****************************************/(module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   initListener: () => (/* binding */ initListener)\n/* harmony export */ });\n/* harmony import */ var _component_script_repository_index__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/script_repository/index */ \"./src/component/script_repository/index.ts\");\n/* harmony import */ var _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/component/script_repository/script_controller */ \"./src/component/script_repository/script_controller.ts\");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var socket_io_client__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! socket.io-client */ \"./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/index.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_component_script_repository_index__WEBPACK_IMPORTED_MODULE_0__]);\n_component_script_repository_index__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\n\n\nconst templatePath = `${_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.extensionFolderPath}/src/component/listener`;\nconst default_settings = {\n    enabled: false,\n    url: 'http://localhost:6621',\n    duration: 1000,\n    enable_echo: true,\n};\nlet socket;\nlet refresh_iframe_debounced;\nfunction reset_refresh_duration() {\n    refresh_iframe_debounced = _.debounce(refresh_iframe, (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getSettingValue)('listener.duration'));\n}\nasync function refresh_iframe() {\n    loglevel__WEBPACK_IMPORTED_MODULE_5___default().info(`[Listener] 已将 iframe 刷新为最新版本`);\n    // @ts-expect-error\n    const character = _sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.this_chid];\n    if (character) {\n        await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.saveChatConditional)();\n    }\n    const scriptManager = _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_1__.ScriptManager.getInstance();\n    const globalScripts = scriptManager.getGlobalScripts();\n    await scriptManager.stopScriptsByType(globalScripts, _component_script_repository_index__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL);\n    await scriptManager.runScriptsByType(globalScripts, _component_script_repository_index__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL);\n    await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.reloadCurrentChat)();\n}\nfunction toggle_status(should_enable) {\n    if (should_enable) {\n        $('#online_status_indicator').addClass('success');\n    }\n    else {\n        $('#online_status_indicator').removeClass('success');\n    }\n}\nfunction connect_socket(url) {\n    if (socket) {\n        toggle_status(false);\n        socket.close();\n    }\n    if (!(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getSettingValue)('listener.enabled') || !(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getSettingValue)('listener.url')) {\n        return;\n    }\n    socket = (0,socket_io_client__WEBPACK_IMPORTED_MODULE_6__.io)(url, {\n        transports: ['websocket'],\n    });\n    socket.on('connect_error', (error) => {\n        toggle_status(false);\n        if ((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getSettingValue)('listener.enable_echo')) {\n            toastr.error(`连接酒馆助手实时监听功能出错, 尝试重连...\\n${error.name}: ${error.message}`);\n        }\n        loglevel__WEBPACK_IMPORTED_MODULE_5___default().error(`${error.name}: ${error.message}${error.stack ?? ''}`);\n    });\n    socket.on('connect', () => {\n        toggle_status(true);\n        loglevel__WEBPACK_IMPORTED_MODULE_5___default().info('[Listener] 成功连接至服务器');\n    });\n    socket.on('iframe_updated', () => {\n        refresh_iframe_debounced();\n    });\n    socket.on('disconnect', (reason, details) => {\n        if ((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getSettingValue)('listener.enable_echo')) {\n            toastr.warning(`酒馆助手实时监听器断开连接: ${reason}`);\n        }\n        toggle_status(false);\n        loglevel__WEBPACK_IMPORTED_MODULE_5___default().info(`[Listener] 与服务器断开连接: ${reason}\\n${details}`);\n    });\n}\n/**\n * 初始化实时监听\n */\nasync function initListener() {\n    const $listener_container = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_4__.renderExtensionTemplateAsync)(`${templatePath}`, 'index'));\n    $listener_container\n        .find('#iframe_update_listener_enabled')\n        .prop('checked', await (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getOrSaveSettingValue)('listener.enabled', default_settings.enabled))\n        .on('click', async function () {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.saveSettingValue)('listener.enabled', $(this).prop('checked'));\n        connect_socket((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getSettingValue)('listener.url'));\n    });\n    $listener_container\n        .find('#iframe_update_listener_enable_echo')\n        .prop('checked', await (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getOrSaveSettingValue)('listener.enable_echo', default_settings.enable_echo))\n        .on('click', function () {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.saveSettingValue)('listener.enable_echo', $(this).prop('checked'));\n    });\n    $listener_container\n        .find('#iframe_update_listener_url')\n        .val(await (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getOrSaveSettingValue)('listener.url', default_settings.url))\n        .on('input', async function () {\n        const url = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.saveSettingValue)('listener.url', String($(this).val()));\n        connect_socket(url);\n    });\n    $listener_container\n        .find('#iframe_update_listener_duration')\n        .val(await (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getOrSaveSettingValue)('listener.duration', default_settings.duration))\n        .on('input', async function () {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.saveSettingValue)('listener.duration', Number($(this).val()));\n        reset_refresh_duration();\n    });\n    $('#extension-listener').append($listener_container);\n    reset_refresh_duration();\n    connect_socket((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getSettingValue)('listener.url'));\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LGNBQWMsQ0FBQywwRUFBZSxDQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUM7QUFDbEQsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9jb21wb25lbnQvbGlzdGVuZXIvaW5kZXgudHM/Y2Y1NCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBTY3JpcHRUeXBlIH0gZnJvbSAnQC9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvaW5kZXgnO1xuaW1wb3J0IHsgU2NyaXB0TWFuYWdlciB9IGZyb20gJ0AvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3NjcmlwdF9jb250cm9sbGVyJztcbmltcG9ydCB7XG4gIGV4dGVuc2lvbkZvbGRlclBhdGgsXG4gIGdldE9yU2F2ZVNldHRpbmdWYWx1ZSxcbiAgZ2V0U2V0dGluZ1ZhbHVlLFxuICBzYXZlU2V0dGluZ1ZhbHVlLFxufSBmcm9tICdAL3V0aWwvZXh0ZW5zaW9uX3ZhcmlhYmxlcyc7XG5cbmltcG9ydCB7IGNoYXJhY3RlcnMsIHJlbG9hZEN1cnJlbnRDaGF0LCBzYXZlQ2hhdENvbmRpdGlvbmFsLCB0aGlzX2NoaWQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0JztcbmltcG9ydCB7IHJlbmRlckV4dGVuc2lvblRlbXBsYXRlQXN5bmMgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9leHRlbnNpb25zJztcblxuaW1wb3J0IGxvZyBmcm9tICdsb2dsZXZlbCc7XG5pbXBvcnQgeyBpbyB9IGZyb20gJ3NvY2tldC5pby1jbGllbnQnO1xuXG5jb25zdCB0ZW1wbGF0ZVBhdGggPSBgJHtleHRlbnNpb25Gb2xkZXJQYXRofS9zcmMvY29tcG9uZW50L2xpc3RlbmVyYDtcbmNvbnN0IGRlZmF1bHRfc2V0dGluZ3MgPSB7XG4gIGVuYWJsZWQ6IGZhbHNlLFxuICB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjY2MjEnLFxuICBkdXJhdGlvbjogMTAwMCxcbiAgZW5hYmxlX2VjaG86IHRydWUsXG59IGFzIGNvbnN0O1xuXG5sZXQgc29ja2V0OiBSZXR1cm5UeXBlPHR5cGVvZiBpbz47XG5cbmxldCByZWZyZXNoX2lmcmFtZV9kZWJvdW5jZWQ6IF8uRGVib3VuY2VkRnVuYzwoKSA9PiBQcm9taXNlPHZvaWQ+PjtcbmZ1bmN0aW9uIHJlc2V0X3JlZnJlc2hfZHVyYXRpb24oKSB7XG4gIHJlZnJlc2hfaWZyYW1lX2RlYm91bmNlZCA9IF8uZGVib3VuY2UocmVmcmVzaF9pZnJhbWUsIGdldFNldHRpbmdWYWx1ZSgnbGlzdGVuZXIuZHVyYXRpb24nKSk7XG59XG5hc3luYyBmdW5jdGlvbiByZWZyZXNoX2lmcmFtZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgbG9nLmluZm8oYFtMaXN0ZW5lcl0g5bey5bCGIGlmcmFtZSDliLfmlrDkuLrmnIDmlrDniYjmnKxgKTtcblxuICAvLyBAdHMtZXhwZWN0LWVycm9yXG4gIGNvbnN0IGNoYXJhY3RlciA9IGNoYXJhY3RlcnNbdGhpc19jaGlkXTtcbiAgaWYgKGNoYXJhY3Rlcikge1xuICAgIGF3YWl0IHNhdmVDaGF0Q29uZGl0aW9uYWwoKTtcbiAgfVxuXG4gIGNvbnN0IHNjcmlwdE1hbmFnZXIgPSBTY3JpcHRNYW5hZ2VyLmdldEluc3RhbmNlKCk7XG4gIGNvbnN0IGdsb2JhbFNjcmlwdHMgPSBzY3JpcHRNYW5hZ2VyLmdldEdsb2JhbFNjcmlwdHMoKTtcblxuICBhd2FpdCBzY3JpcHRNYW5hZ2VyLnN0b3BTY3JpcHRzQnlUeXBlKGdsb2JhbFNjcmlwdHMsIFNjcmlwdFR5cGUuR0xPQkFMKTtcbiAgYXdhaXQgc2NyaXB0TWFuYWdlci5ydW5TY3JpcHRzQnlUeXBlKGdsb2JhbFNjcmlwdHMsIFNjcmlwdFR5cGUuR0xPQkFMKTtcbiAgYXdhaXQgcmVsb2FkQ3VycmVudENoYXQoKTtcbn1cblxuZnVuY3Rpb24gdG9nZ2xlX3N0YXR1cyhzaG91bGRfZW5hYmxlOiBib29sZWFuKSB7XG4gIGlmIChzaG91bGRfZW5hYmxlKSB7XG4gICAgJCgnI29ubGluZV9zdGF0dXNfaW5kaWNhdG9yJykuYWRkQ2xhc3MoJ3N1Y2Nlc3MnKTtcbiAgfSBlbHNlIHtcbiAgICAkKCcjb25saW5lX3N0YXR1c19pbmRpY2F0b3InKS5yZW1vdmVDbGFzcygnc3VjY2VzcycpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGNvbm5lY3Rfc29ja2V0KHVybDogc3RyaW5nKTogdm9pZCB7XG4gIGlmIChzb2NrZXQpIHtcbiAgICB0b2dnbGVfc3RhdHVzKGZhbHNlKTtcbiAgICBzb2NrZXQuY2xvc2UoKTtcbiAgfVxuICBpZiAoIWdldFNldHRpbmdWYWx1ZSgnbGlzdGVuZXIuZW5hYmxlZCcpIHx8ICFnZXRTZXR0aW5nVmFsdWUoJ2xpc3RlbmVyLnVybCcpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgc29ja2V0ID0gaW8odXJsLCB7XG4gICAgdHJhbnNwb3J0czogWyd3ZWJzb2NrZXQnXSxcbiAgfSk7XG5cbiAgc29ja2V0Lm9uKCdjb25uZWN0X2Vycm9yJywgKGVycm9yOiBFcnJvcikgPT4ge1xuICAgIHRvZ2dsZV9zdGF0dXMoZmFsc2UpO1xuICAgIGlmIChnZXRTZXR0aW5nVmFsdWUoJ2xpc3RlbmVyLmVuYWJsZV9lY2hvJykpIHtcbiAgICAgIHRvYXN0ci5lcnJvcihg6L+e5o6l6YWS6aaG5Yqp5omL5a6e5pe255uR5ZCs5Yqf6IO95Ye66ZSZLCDlsJ3or5Xph43ov54uLi5cXG4ke2Vycm9yLm5hbWV9OiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgfVxuICAgIGxvZy5lcnJvcihgJHtlcnJvci5uYW1lfTogJHtlcnJvci5tZXNzYWdlfSR7ZXJyb3Iuc3RhY2sgPz8gJyd9YCk7XG4gIH0pO1xuXG4gIHNvY2tldC5vbignY29ubmVjdCcsICgpID0+IHtcbiAgICB0b2dnbGVfc3RhdHVzKHRydWUpO1xuICAgIGxvZy5pbmZvKCdbTGlzdGVuZXJdIOaIkOWKn+i/nuaOpeiHs+acjeWKoeWZqCcpO1xuICB9KTtcblxuICBzb2NrZXQub24oJ2lmcmFtZV91cGRhdGVkJywgKCkgPT4ge1xuICAgIHJlZnJlc2hfaWZyYW1lX2RlYm91bmNlZCgpO1xuICB9KTtcblxuICBzb2NrZXQub24oJ2Rpc2Nvbm5lY3QnLCAocmVhc29uLCBkZXRhaWxzKSA9PiB7XG4gICAgaWYgKGdldFNldHRpbmdWYWx1ZSgnbGlzdGVuZXIuZW5hYmxlX2VjaG8nKSkge1xuICAgICAgdG9hc3RyLndhcm5pbmcoYOmFkummhuWKqeaJi+WunuaXtuebkeWQrOWZqOaWreW8gOi/nuaOpTogJHtyZWFzb259YCk7XG4gICAgfVxuICAgIHRvZ2dsZV9zdGF0dXMoZmFsc2UpO1xuICAgIGxvZy5pbmZvKGBbTGlzdGVuZXJdIOS4juacjeWKoeWZqOaWreW8gOi/nuaOpTogJHtyZWFzb259XFxuJHtkZXRhaWxzfWApO1xuICB9KTtcbn1cblxuLyoqXG4gKiDliJ3lp4vljJblrp7ml7bnm5HlkKxcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGluaXRMaXN0ZW5lcigpIHtcbiAgY29uc3QgJGxpc3RlbmVyX2NvbnRhaW5lciA9ICQoYXdhaXQgcmVuZGVyRXh0ZW5zaW9uVGVtcGxhdGVBc3luYyhgJHt0ZW1wbGF0ZVBhdGh9YCwgJ2luZGV4JykpO1xuXG4gICRsaXN0ZW5lcl9jb250YWluZXJcbiAgICAuZmluZCgnI2lmcmFtZV91cGRhdGVfbGlzdGVuZXJfZW5hYmxlZCcpXG4gICAgLnByb3AoJ2NoZWNrZWQnLCBhd2FpdCBnZXRPclNhdmVTZXR0aW5nVmFsdWUoJ2xpc3RlbmVyLmVuYWJsZWQnLCBkZWZhdWx0X3NldHRpbmdzLmVuYWJsZWQpKVxuICAgIC5vbignY2xpY2snLCBhc3luYyBmdW5jdGlvbiAodGhpczogSFRNTElucHV0RWxlbWVudCkge1xuICAgICAgc2F2ZVNldHRpbmdWYWx1ZSgnbGlzdGVuZXIuZW5hYmxlZCcsICQodGhpcykucHJvcCgnY2hlY2tlZCcpKTtcbiAgICAgIGNvbm5lY3Rfc29ja2V0KGdldFNldHRpbmdWYWx1ZSgnbGlzdGVuZXIudXJsJykpO1xuICAgIH0pO1xuXG4gICRsaXN0ZW5lcl9jb250YWluZXJcbiAgICAuZmluZCgnI2lmcmFtZV91cGRhdGVfbGlzdGVuZXJfZW5hYmxlX2VjaG8nKVxuICAgIC5wcm9wKCdjaGVja2VkJywgYXdhaXQgZ2V0T3JTYXZlU2V0dGluZ1ZhbHVlKCdsaXN0ZW5lci5lbmFibGVfZWNobycsIGRlZmF1bHRfc2V0dGluZ3MuZW5hYmxlX2VjaG8pKVxuICAgIC5vbignY2xpY2snLCBmdW5jdGlvbiAodGhpczogSFRNTElucHV0RWxlbWVudCkge1xuICAgICAgc2F2ZVNldHRpbmdWYWx1ZSgnbGlzdGVuZXIuZW5hYmxlX2VjaG8nLCAkKHRoaXMpLnByb3AoJ2NoZWNrZWQnKSk7XG4gICAgfSk7XG5cbiAgJGxpc3RlbmVyX2NvbnRhaW5lclxuICAgIC5maW5kKCcjaWZyYW1lX3VwZGF0ZV9saXN0ZW5lcl91cmwnKVxuICAgIC52YWwoYXdhaXQgZ2V0T3JTYXZlU2V0dGluZ1ZhbHVlKCdsaXN0ZW5lci51cmwnLCBkZWZhdWx0X3NldHRpbmdzLnVybCkpXG4gICAgLm9uKCdpbnB1dCcsIGFzeW5jIGZ1bmN0aW9uICh0aGlzOiBIVE1MSW5wdXRFbGVtZW50KSB7XG4gICAgICBjb25zdCB1cmwgPSBzYXZlU2V0dGluZ1ZhbHVlKCdsaXN0ZW5lci51cmwnLCBTdHJpbmcoJCh0aGlzKS52YWwoKSkpO1xuICAgICAgY29ubmVjdF9zb2NrZXQodXJsKTtcbiAgICB9KTtcblxuICAkbGlzdGVuZXJfY29udGFpbmVyXG4gICAgLmZpbmQoJyNpZnJhbWVfdXBkYXRlX2xpc3RlbmVyX2R1cmF0aW9uJylcbiAgICAudmFsKGF3YWl0IGdldE9yU2F2ZVNldHRpbmdWYWx1ZSgnbGlzdGVuZXIuZHVyYXRpb24nLCBkZWZhdWx0X3NldHRpbmdzLmR1cmF0aW9uKSlcbiAgICAub24oJ2lucHV0JywgYXN5bmMgZnVuY3Rpb24gKHRoaXM6IEhUTUxJbnB1dEVsZW1lbnQpIHtcbiAgICAgIHNhdmVTZXR0aW5nVmFsdWUoJ2xpc3RlbmVyLmR1cmF0aW9uJywgTnVtYmVyKCQodGhpcykudmFsKCkpKTtcbiAgICAgIHJlc2V0X3JlZnJlc2hfZHVyYXRpb24oKTtcbiAgICB9KTtcblxuICAkKCcjZXh0ZW5zaW9uLWxpc3RlbmVyJykuYXBwZW5kKCRsaXN0ZW5lcl9jb250YWluZXIpO1xuXG4gIHJlc2V0X3JlZnJlc2hfZHVyYXRpb24oKTtcbiAgY29ubmVjdF9zb2NrZXQoZ2V0U2V0dGluZ1ZhbHVlKCdsaXN0ZW5lci51cmwnKSk7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/component/listener/index.ts\n\n}")},"./src/component/macro.ts":
/*!********************************!*\
  !*** ./src/component/macro.ts ***!
  \********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   registerAllMacros: () => (/* binding */ registerAllMacros),\n/* harmony export */   registerMacro: () => (/* binding */ registerMacro),\n/* harmony export */   unregisterAllMacros: () => (/* binding */ unregisterAllMacros),\n/* harmony export */   unregisterMacro: () => (/* binding */ unregisterMacro)\n/* harmony export */ });\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/util/extension_variables */ "./src/util/extension_variables.ts");\n/* harmony import */ var _sillytavern_scripts_macros__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/macros */ "@sillytavern/scripts/macros");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! loglevel */ "./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\nconst predefinedMacros = new Map([\n    [\'userAvatarPath\', _util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.getUserAvatarPath],\n    [\'charAvatarPath\', _util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.getCharAvatarPath],\n]);\n/**\n * 注册一个宏\n * @param {string} key - 宏的名称\n * @param {MacroFunction|string} value - 字符串或返回字符串的函数\n */\nfunction registerMacro(key, value) {\n    _sillytavern_scripts_macros__WEBPACK_IMPORTED_MODULE_1__.MacrosParser.registerMacro(key, value);\n    loglevel__WEBPACK_IMPORTED_MODULE_2___default().info(`[Macro] 宏 "${key}" 注册成功`);\n}\n/**\n * 注册所有预定义的宏\n */\nfunction registerAllMacros() {\n    for (const [key, value] of predefinedMacros.entries()) {\n        _sillytavern_scripts_macros__WEBPACK_IMPORTED_MODULE_1__.MacrosParser.registerMacro(key, value);\n        loglevel__WEBPACK_IMPORTED_MODULE_2___default().info(`[Macro] 宏 "${key}" 注册成功`);\n    }\n}\n/**\n * 注销指定的宏\n * @param {string} key - 要注销的宏名称\n */\nfunction unregisterMacro(key) {\n    _sillytavern_scripts_macros__WEBPACK_IMPORTED_MODULE_1__.MacrosParser.unregisterMacro(key);\n    loglevel__WEBPACK_IMPORTED_MODULE_2___default().info(`[Macro] 宏 "${key}" 注销成功`);\n}\n/**\n * 注销所有预定义的宏\n */\nfunction unregisterAllMacros() {\n    for (const key of predefinedMacros.keys()) {\n        _sillytavern_scripts_macros__WEBPACK_IMPORTED_MODULE_1__.MacrosParser.unregisterMacro(key);\n        loglevel__WEBPACK_IMPORTED_MODULE_2___default().info(`[Macro] 宏 "${key}" 注销成功`);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L21hY3JvLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQWtGO0FBRVI7QUFFL0M7QUFFM0IsTUFBTSxnQkFBZ0IsR0FBRyxJQUFJLEdBQUcsQ0FBaUM7SUFDL0QsQ0FBQyxnQkFBZ0IsRUFBRSx3RUFBaUIsQ0FBQztJQUNyQyxDQUFDLGdCQUFnQixFQUFFLHdFQUFpQixDQUFDO0NBQ3RDLENBQUMsQ0FBQztBQUVIOzs7O0dBSUc7QUFDSSxTQUFTLGFBQWEsQ0FBQyxHQUFXLEVBQUUsS0FBNkI7SUFDdEUscUVBQVksQ0FBQyxhQUFhLENBQUMsR0FBRyxFQUFFLEtBQUssQ0FBQyxDQUFDO0lBQ3ZDLG9EQUFRLENBQUMsY0FBYyxHQUFHLFFBQVEsQ0FBQyxDQUFDO0FBQ3RDLENBQUM7QUFFRDs7R0FFRztBQUNJLFNBQVMsaUJBQWlCO0lBQy9CLEtBQUssTUFBTSxDQUFDLEdBQUcsRUFBRSxLQUFLLENBQUMsSUFBSSxnQkFBZ0IsQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUFDO1FBQ3RELHFFQUFZLENBQUMsYUFBYSxDQUFDLEdBQUcsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUN2QyxvREFBUSxDQUFDLGNBQWMsR0FBRyxRQUFRLENBQUMsQ0FBQztJQUN0QyxDQUFDO0FBQ0gsQ0FBQztBQUVEOzs7R0FHRztBQUNJLFNBQVMsZUFBZSxDQUFDLEdBQVc7SUFDekMscUVBQVksQ0FBQyxlQUFlLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDbEMsb0RBQVEsQ0FBQyxjQUFjLEdBQUcsUUFBUSxDQUFDLENBQUM7QUFDdEMsQ0FBQztBQUVEOztHQUVHO0FBQ0ksU0FBUyxtQkFBbUI7SUFDakMsS0FBSyxNQUFNLEdBQUcsSUFBSSxnQkFBZ0IsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDO1FBQzFDLHFFQUFZLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ2xDLG9EQUFRLENBQUMsY0FBYyxHQUFHLFFBQVEsQ0FBQyxDQUFDO0lBQ3RDLENBQUM7QUFDSCxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBvbmVudC9tYWNyby50cz8yNTAyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldENoYXJBdmF0YXJQYXRoLCBnZXRVc2VyQXZhdGFyUGF0aCB9IGZyb20gJ0AvdXRpbC9leHRlbnNpb25fdmFyaWFibGVzJztcblxuaW1wb3J0IHsgTWFjcm9GdW5jdGlvbiwgTWFjcm9zUGFyc2VyIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvbWFjcm9zJztcblxuaW1wb3J0IGxvZyBmcm9tICdsb2dsZXZlbCc7XG5cbmNvbnN0IHByZWRlZmluZWRNYWNyb3MgPSBuZXcgTWFwPHN0cmluZywgc3RyaW5nIHwgTWFjcm9GdW5jdGlvbj4oW1xuICBbJ3VzZXJBdmF0YXJQYXRoJywgZ2V0VXNlckF2YXRhclBhdGhdLFxuICBbJ2NoYXJBdmF0YXJQYXRoJywgZ2V0Q2hhckF2YXRhclBhdGhdLFxuXSk7XG5cbi8qKlxuICog5rOo5YaM5LiA5Liq5a6PXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5IC0g5a6P55qE5ZCN56ewXG4gKiBAcGFyYW0ge01hY3JvRnVuY3Rpb258c3RyaW5nfSB2YWx1ZSAtIOWtl+espuS4suaIlui/lOWbnuWtl+espuS4sueahOWHveaVsFxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVnaXN0ZXJNYWNybyhrZXk6IHN0cmluZywgdmFsdWU6IHN0cmluZyB8IE1hY3JvRnVuY3Rpb24pIHtcbiAgTWFjcm9zUGFyc2VyLnJlZ2lzdGVyTWFjcm8oa2V5LCB2YWx1ZSk7XG4gIGxvZy5pbmZvKGBbTWFjcm9dIOWujyBcIiR7a2V5fVwiIOazqOWGjOaIkOWKn2ApO1xufVxuXG4vKipcbiAqIOazqOWGjOaJgOaciemihOWumuS5ieeahOWuj1xuICovXG5leHBvcnQgZnVuY3Rpb24gcmVnaXN0ZXJBbGxNYWNyb3MoKSB7XG4gIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIHByZWRlZmluZWRNYWNyb3MuZW50cmllcygpKSB7XG4gICAgTWFjcm9zUGFyc2VyLnJlZ2lzdGVyTWFjcm8oa2V5LCB2YWx1ZSk7XG4gICAgbG9nLmluZm8oYFtNYWNyb10g5a6PIFwiJHtrZXl9XCIg5rOo5YaM5oiQ5YqfYCk7XG4gIH1cbn1cblxuLyoqXG4gKiDms6jplIDmjIflrprnmoTlro9cbiAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgLSDopoHms6jplIDnmoTlro/lkI3np7BcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVucmVnaXN0ZXJNYWNybyhrZXk6IHN0cmluZykge1xuICBNYWNyb3NQYXJzZXIudW5yZWdpc3Rlck1hY3JvKGtleSk7XG4gIGxvZy5pbmZvKGBbTWFjcm9dIOWujyBcIiR7a2V5fVwiIOazqOmUgOaIkOWKn2ApO1xufVxuXG4vKipcbiAqIOazqOmUgOaJgOaciemihOWumuS5ieeahOWuj1xuICovXG5leHBvcnQgZnVuY3Rpb24gdW5yZWdpc3RlckFsbE1hY3JvcygpIHtcbiAgZm9yIChjb25zdCBrZXkgb2YgcHJlZGVmaW5lZE1hY3Jvcy5rZXlzKCkpIHtcbiAgICBNYWNyb3NQYXJzZXIudW5yZWdpc3Rlck1hY3JvKGtleSk7XG4gICAgbG9nLmluZm8oYFtNYWNyb10g5a6PIFwiJHtrZXl9XCIg5rOo6ZSA5oiQ5YqfYCk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/component/macro.ts\n\n}')},"./src/component/macrolike.ts":
/*!************************************!*\
  !*** ./src/component/macrolike.ts ***!
  \************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   destroyMacroOnExtension: () => (/* binding */ destroyMacroOnExtension),\n/* harmony export */   initializeMacroOnExtension: () => (/* binding */ initializeMacroOnExtension),\n/* harmony export */   macros: () => (/* binding */ macros),\n/* harmony export */   registerMacroLike: () => (/* binding */ registerMacroLike),\n/* harmony export */   renderAllMacros: () => (/* binding */ renderAllMacros)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n\n\nconst macros = [\n    {\n        regex: /\\{\\{get_global_variable::(.*?)\\}\\}/gi,\n        replace: (_context, _substring, path) => {\n            const variables = _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__.extension_settings.variables.global;\n            const value = _.get(variables, path, null);\n            return typeof value === 'string' ? value : JSON.stringify(value);\n        },\n    },\n    {\n        regex: /\\{\\{get_chat_variable::(.*?)\\}\\}/gi,\n        replace: (_context, _substring, path) => {\n            const variables = _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat_metadata.variables;\n            const value = _.get(variables, path, null);\n            return typeof value === 'string' ? value : JSON.stringify(value);\n        },\n    },\n    {\n        regex: /\\{\\{get_message_variable::(.*?)\\}\\}/gi,\n        replace: (context, _substring, path) => {\n            const variables = (context.message_id !== undefined ? _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.slice(0, context.message_id + 1) : _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat)\n                .map(chat_message => _.get(chat_message, ['variables', chat_message.swipe_id ?? 0]))\n                .findLast(data => data !== undefined) ?? {};\n            const value = _.get(variables, path, null);\n            return typeof value === 'string' ? value : JSON.stringify(value);\n        },\n    },\n];\nfunction registerMacroLike(regex, replace) {\n    macros.push({ regex, replace });\n}\nfunction demacroOnPrompt(event_data) {\n    if (event_data.dryRun) {\n        return;\n    }\n    for (const message of event_data.chat) {\n        for (const macro of macros) {\n            message.content = message.content.replace(macro.regex, (substring, ...args) => macro.replace({ role: message.role }, substring, ...args));\n        }\n    }\n}\nfunction demacroOnRender(message_id) {\n    const $mes = $(`div.mes[mesid=\"${message_id}\"]`);\n    const $mes_text = $mes.find('.mes_text');\n    if ($mes_text.length === 0 || !macros.some(macro => macro.regex.test($mes_text.text()))) {\n        return;\n    }\n    const replace_html = (html) => {\n        for (const macro of macros) {\n            html = html.replace(macro.regex, (substring, ...args) => macro.replace({ message_id: Number(message_id), role: $mes.attr('is_user') === 'true' ? 'user' : 'assistant' }, substring, ...args));\n        }\n        return html;\n    };\n    $mes_text.html((_index, html) => replace_html(html));\n    $mes_text\n        .find('code')\n        .filter((_index, node) => macros.some(macro => macro.regex.test($(node).text())))\n        .text((_index, text) => replace_html(text));\n}\nfunction renderAllMacros() {\n    $('div.mes').each((_index, node) => {\n        demacroOnRender($(node).attr('mesid'));\n    });\n}\nfunction initializeMacroOnExtension() {\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.on(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.CHAT_COMPLETION_PROMPT_READY, demacroOnPrompt);\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.on(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.CHARACTER_MESSAGE_RENDERED, demacroOnRender);\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.on(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.USER_MESSAGE_RENDERED, demacroOnRender);\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.on(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.MESSAGE_UPDATED, demacroOnRender);\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.on(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.MESSAGE_SWIPED, demacroOnRender);\n}\nfunction destroyMacroOnExtension() {\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.removeListener(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.CHAT_COMPLETION_PROMPT_READY, demacroOnPrompt);\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.removeListener(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.CHARACTER_MESSAGE_RENDERED, demacroOnRender);\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.removeListener(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.USER_MESSAGE_RENDERED, demacroOnRender);\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.removeListener(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.MESSAGE_UPDATED, demacroOnRender);\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.removeListener(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.MESSAGE_SWIPED, demacroOnRender);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dUI7SUFDckMsNERBQVcsQ0FBQyxjQUFjLENBQUMsNERBQVcsQ0FBQyw0QkFBNEIsRUFBRSxlQUFlLENBQUMsQ0FBQztJQUN0Riw0REFBVyxDQUFDLGNBQWMsQ0FBQyw0REFBVyxDQUFDLDBCQUEwQixFQUFFLGVBQWUsQ0FBQyxDQUFDO0lBQ3BGLDREQUFXLENBQUMsY0FBYyxDQUFDLDREQUFXLENBQUMscUJBQXFCLEVBQUUsZUFBZSxDQUFDLENBQUM7SUFDL0UsNERBQVcsQ0FBQyxjQUFjLENBQUMsNERBQVcsQ0FBQyxlQUFlLEVBQUUsZUFBZSxDQUFDLENBQUM7SUFDekUsNERBQVcsQ0FBQyxjQUFjLENBQUMsNERBQVcsQ0FBQyxjQUFjLEVBQUUsZUFBZSxDQUFDLENBQUM7QUFDMUUsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9jb21wb25lbnQvbWFjcm9saWtlLnRzP2M4MDMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY2hhdCwgY2hhdF9tZXRhZGF0YSwgZXZlbnRfdHlwZXMsIGV2ZW50U291cmNlIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5pbXBvcnQgeyBleHRlbnNpb25fc2V0dGluZ3MgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9leHRlbnNpb25zJztcblxuaW50ZXJmYWNlIE1hY3JvTGlrZSB7XG4gIHJlZ2V4OiBSZWdFeHA7XG4gIHJlcGxhY2U6IChjb250ZXh0OiBDb250ZXh0LCBzdWJzdHJpbmc6IHN0cmluZywgLi4uYXJnczogYW55W10pID0+IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIENvbnRleHQge1xuICBtZXNzYWdlX2lkPzogbnVtYmVyO1xuICByb2xlPzogJ3VzZXInIHwgJ2Fzc2lzdGFudCcgfCAnc3lzdGVtJztcbn1cblxuZXhwb3J0IGNvbnN0IG1hY3JvczogTWFjcm9MaWtlW10gPSBbXG4gIHtcbiAgICByZWdleDogL1xce1xce2dldF9nbG9iYWxfdmFyaWFibGU6OiguKj8pXFx9XFx9L2dpLFxuICAgIHJlcGxhY2U6IChfY29udGV4dDogQ29udGV4dCwgX3N1YnN0cmluZzogc3RyaW5nLCBwYXRoOiBzdHJpbmcpID0+IHtcbiAgICAgIGNvbnN0IHZhcmlhYmxlcyA9IGV4dGVuc2lvbl9zZXR0aW5ncy52YXJpYWJsZXMuZ2xvYmFsO1xuICAgICAgY29uc3QgdmFsdWUgPSBfLmdldCh2YXJpYWJsZXMsIHBhdGgsIG51bGwpO1xuICAgICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgPyB2YWx1ZSA6IEpTT04uc3RyaW5naWZ5KHZhbHVlKTtcbiAgICB9LFxuICB9LFxuICB7XG4gICAgcmVnZXg6IC9cXHtcXHtnZXRfY2hhdF92YXJpYWJsZTo6KC4qPylcXH1cXH0vZ2ksXG4gICAgcmVwbGFjZTogKF9jb250ZXh0OiBDb250ZXh0LCBfc3Vic3RyaW5nOiBzdHJpbmcsIHBhdGg6IHN0cmluZykgPT4ge1xuICAgICAgY29uc3QgdmFyaWFibGVzID0gKGNoYXRfbWV0YWRhdGEgYXMgeyB2YXJpYWJsZXM6IE9iamVjdCB9KS52YXJpYWJsZXM7XG4gICAgICBjb25zdCB2YWx1ZSA9IF8uZ2V0KHZhcmlhYmxlcywgcGF0aCwgbnVsbCk7XG4gICAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyA/IHZhbHVlIDogSlNPTi5zdHJpbmdpZnkodmFsdWUpO1xuICAgIH0sXG4gIH0sXG4gIHtcbiAgICByZWdleDogL1xce1xce2dldF9tZXNzYWdlX3ZhcmlhYmxlOjooLio/KVxcfVxcfS9naSxcbiAgICByZXBsYWNlOiAoY29udGV4dDogQ29udGV4dCwgX3N1YnN0cmluZzogc3RyaW5nLCBwYXRoOiBzdHJpbmcpID0+IHtcbiAgICAgIGNvbnN0IHZhcmlhYmxlcyA9XG4gICAgICAgIChjb250ZXh0Lm1lc3NhZ2VfaWQgIT09IHVuZGVmaW5lZCA/IGNoYXQuc2xpY2UoMCwgY29udGV4dC5tZXNzYWdlX2lkICsgMSkgOiBjaGF0KVxuICAgICAgICAgIC5tYXAoY2hhdF9tZXNzYWdlID0+IF8uZ2V0KGNoYXRfbWVzc2FnZSwgWyd2YXJpYWJsZXMnLCBjaGF0X21lc3NhZ2Uuc3dpcGVfaWQgPz8gMF0pKVxuICAgICAgICAgIC5maW5kTGFzdChkYXRhID0+IGRhdGEgIT09IHVuZGVmaW5lZCkgPz8ge307XG4gICAgICBjb25zdCB2YWx1ZSA9IF8uZ2V0KHZhcmlhYmxlcywgcGF0aCwgbnVsbCk7XG4gICAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyA/IHZhbHVlIDogSlNPTi5zdHJpbmdpZnkodmFsdWUpO1xuICAgIH0sXG4gIH0sXG5dO1xuXG5leHBvcnQgZnVuY3Rpb24gcmVnaXN0ZXJNYWNyb0xpa2UoXG4gIHJlZ2V4OiBSZWdFeHAsXG4gIHJlcGxhY2U6IChjb250ZXh0OiBDb250ZXh0LCBzdWJzdHJpbmc6IHN0cmluZywgLi4uYXJnczogYW55W10pID0+IHN0cmluZyxcbikge1xuICBtYWNyb3MucHVzaCh7IHJlZ2V4LCByZXBsYWNlIH0pO1xufVxuXG5mdW5jdGlvbiBkZW1hY3JvT25Qcm9tcHQoZXZlbnRfZGF0YTogUGFyYW1ldGVyczxMaXN0ZW5lclR5cGVbJ2NoYXRfY29tcGxldGlvbl9wcm9tcHRfcmVhZHknXT5bMF0pIHtcbiAgaWYgKGV2ZW50X2RhdGEuZHJ5UnVuKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgZm9yIChjb25zdCBtZXNzYWdlIG9mIGV2ZW50X2RhdGEuY2hhdCkge1xuICAgIGZvciAoY29uc3QgbWFjcm8gb2YgbWFjcm9zKSB7XG4gICAgICBtZXNzYWdlLmNvbnRlbnQgPSBtZXNzYWdlLmNvbnRlbnQucmVwbGFjZShtYWNyby5yZWdleCwgKHN1YnN0cmluZzogc3RyaW5nLCAuLi5hcmdzOiBhbnlbXSkgPT5cbiAgICAgICAgbWFjcm8ucmVwbGFjZSh7IHJvbGU6IG1lc3NhZ2Uucm9sZSBhcyAndXNlcicgfCAnYXNzaXN0YW50JyB8ICdzeXN0ZW0nIH0sIHN1YnN0cmluZywgLi4uYXJncyksXG4gICAgICApO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBkZW1hY3JvT25SZW5kZXIobWVzc2FnZV9pZDogc3RyaW5nKSB7XG4gIGNvbnN0ICRtZXMgPSAkKGBkaXYubWVzW21lc2lkPVwiJHttZXNzYWdlX2lkfVwiXWApO1xuICBjb25zdCAkbWVzX3RleHQgPSAkbWVzLmZpbmQoJy5tZXNfdGV4dCcpO1xuICBpZiAoJG1lc190ZXh0Lmxlbmd0aCA9PT0gMCB8fCAhbWFjcm9zLnNvbWUobWFjcm8gPT4gbWFjcm8ucmVnZXgudGVzdCgkbWVzX3RleHQudGV4dCgpKSkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCByZXBsYWNlX2h0bWwgPSAoaHRtbDogc3RyaW5nKSA9PiB7XG4gICAgZm9yIChjb25zdCBtYWNybyBvZiBtYWNyb3MpIHtcbiAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UobWFjcm8ucmVnZXgsIChzdWJzdHJpbmc6IHN0cmluZywgLi4uYXJnczogYW55W10pID0+XG4gICAgICAgIG1hY3JvLnJlcGxhY2UoXG4gICAgICAgICAgeyBtZXNzYWdlX2lkOiBOdW1iZXIobWVzc2FnZV9pZCksIHJvbGU6ICRtZXMuYXR0cignaXNfdXNlcicpID09PSAndHJ1ZScgPyAndXNlcicgOiAnYXNzaXN0YW50JyB9LFxuICAgICAgICAgIHN1YnN0cmluZyxcbiAgICAgICAgICAuLi5hcmdzLFxuICAgICAgICApLFxuICAgICAgKTtcbiAgICB9XG4gICAgcmV0dXJuIGh0bWw7XG4gIH07XG5cbiAgJG1lc190ZXh0Lmh0bWwoKF9pbmRleCwgaHRtbCkgPT4gcmVwbGFjZV9odG1sKGh0bWwpKTtcbiAgJG1lc190ZXh0XG4gICAgLmZpbmQoJ2NvZGUnKVxuICAgIC5maWx0ZXIoKF9pbmRleCwgbm9kZSkgPT4gbWFjcm9zLnNvbWUobWFjcm8gPT4gbWFjcm8ucmVnZXgudGVzdCgkKG5vZGUpLnRleHQoKSkpKVxuICAgIC50ZXh0KChfaW5kZXgsIHRleHQpID0+IHJlcGxhY2VfaHRtbCh0ZXh0KSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZW5kZXJBbGxNYWNyb3MoKSB7XG4gICQoJ2Rpdi5tZXMnKS5lYWNoKChfaW5kZXgsIG5vZGUpID0+IHtcbiAgICBkZW1hY3JvT25SZW5kZXIoJChub2RlKS5hdHRyKCdtZXNpZCcpISk7XG4gIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaW5pdGlhbGl6ZU1hY3JvT25FeHRlbnNpb24oKSB7XG4gIGV2ZW50U291cmNlLm9uKGV2ZW50X3R5cGVzLkNIQVRfQ09NUExFVElPTl9QUk9NUFRfUkVBRFksIGRlbWFjcm9PblByb21wdCk7XG4gIGV2ZW50U291cmNlLm9uKGV2ZW50X3R5cGVzLkNIQVJBQ1RFUl9NRVNTQUdFX1JFTkRFUkVELCBkZW1hY3JvT25SZW5kZXIpO1xuICBldmVudFNvdXJjZS5vbihldmVudF90eXBlcy5VU0VSX01FU1NBR0VfUkVOREVSRUQsIGRlbWFjcm9PblJlbmRlcik7XG4gIGV2ZW50U291cmNlLm9uKGV2ZW50X3R5cGVzLk1FU1NBR0VfVVBEQVRFRCwgZGVtYWNyb09uUmVuZGVyKTtcbiAgZXZlbnRTb3VyY2Uub24oZXZlbnRfdHlwZXMuTUVTU0FHRV9TV0lQRUQsIGRlbWFjcm9PblJlbmRlcik7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZXN0cm95TWFjcm9PbkV4dGVuc2lvbigpIHtcbiAgZXZlbnRTb3VyY2UucmVtb3ZlTGlzdGVuZXIoZXZlbnRfdHlwZXMuQ0hBVF9DT01QTEVUSU9OX1BST01QVF9SRUFEWSwgZGVtYWNyb09uUHJvbXB0KTtcbiAgZXZlbnRTb3VyY2UucmVtb3ZlTGlzdGVuZXIoZXZlbnRfdHlwZXMuQ0hBUkFDVEVSX01FU1NBR0VfUkVOREVSRUQsIGRlbWFjcm9PblJlbmRlcik7XG4gIGV2ZW50U291cmNlLnJlbW92ZUxpc3RlbmVyKGV2ZW50X3R5cGVzLlVTRVJfTUVTU0FHRV9SRU5ERVJFRCwgZGVtYWNyb09uUmVuZGVyKTtcbiAgZXZlbnRTb3VyY2UucmVtb3ZlTGlzdGVuZXIoZXZlbnRfdHlwZXMuTUVTU0FHRV9VUERBVEVELCBkZW1hY3JvT25SZW5kZXIpO1xuICBldmVudFNvdXJjZS5yZW1vdmVMaXN0ZW5lcihldmVudF90eXBlcy5NRVNTQUdFX1NXSVBFRCwgZGVtYWNyb09uUmVuZGVyKTtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/component/macrolike.ts\n\n}")},"./src/component/message_iframe/index.ts":
/*!***********************************************!*\
  !*** ./src/component/message_iframe/index.ts ***!
  \***********************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addRenderQuickButton: () => (/* binding */ addRenderQuickButton),\n/* harmony export */   defaultIframeSettings: () => (/* binding */ defaultIframeSettings),\n/* harmony export */   handleRenderEnableToggle: () => (/* binding */ handleRenderEnableToggle),\n/* harmony export */   handleRenderingHideStyleToggle: () => (/* binding */ handleRenderingHideStyleToggle),\n/* harmony export */   handleRenderingOptimizationToggle: () => (/* binding */ handleRenderingOptimizationToggle),\n/* harmony export */   initIframePanel: () => (/* binding */ initIframePanel),\n/* harmony export */   injectLoadingStyles: () => (/* binding */ injectLoadingStyles),\n/* harmony export */   onDepthInput: () => (/* binding */ onDepthInput)\n/* harmony export */ });\n/* harmony import */ var _component_message_iframe_render_hide_style__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/message_iframe/render_hide_style */ \"./src/component/message_iframe/render_hide_style.ts\");\n/* harmony import */ var _component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/component/message_iframe/render_message */ \"./src/component/message_iframe/render_message.ts\");\n/* harmony import */ var _component_message_iframe_render_optimize__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/component/message_iframe/render_optimize */ \"./src/component/message_iframe/render_optimize.ts\");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n\n\n\n\n\nconst defaultIframeSettings = {\n    render_enabled: true,\n    tampermonkey_compatibility: false,\n    render_depth: 0,\n    render_optimize: false,\n    render_hide_style: false,\n};\n/**\n * 注入加载样式\n */\nfunction injectLoadingStyles() {\n    if ($('#iframe-loading-styles').length)\n        return;\n    const styleSheet = $('<style>', {\n        id: 'iframe-loading-styles',\n        text: `\n        .iframe-loading-overlay{\n          position:absolute;\n          top:0;\n          left:0;\n          right:0;\n          bottom:0;\n          background:rgba(0,0,0,.7);\n          display:flex;\n          justify-content:center;\n          align-items:center;\n          z-index:1000;\n          transition:opacity .3s ease\n        }\n        .iframe-loading-content{\n          color:#fff;\n          display:flex;\n          align-items:center;\n          gap:10px;\n          font-size:16px\n        }\n        .iframe-loading-content i{\n          font-size:20px\n        }\n        .loading-text {\n          transition: opacity 0.3s ease;\n        }`,\n    });\n    $('head').append(styleSheet);\n}\n/**\n * 同步前端渲染相关UI（按钮和文本）\n * @param enable 是否启用渲染\n */\nfunction syncRenderToggleUI(enable) {\n    $('#render-enable-toggle').prop('checked', enable);\n    $('#tavern-helper-render-text').text(enable ? '关闭前端渲染' : '开启前端渲染');\n}\n/**\n * 添加前端渲染快速按钮\n */\nfunction addRenderQuickButton() {\n    const buttonHtml = $(`\n  <div id=\"tavern-helper-render-container\" class=\"list-group-item flex-container flexGap5 interactable tavern-helper-shortcut-item\">\n      <div class=\"fa-solid fa-puzzle-piece extensionsMenuExtensionButton\" /></div>\n      <span id=\"tavern-helper-render-text\">${(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_3__.getSettingValue)('render.render_enabled') ? '关闭前端渲染' : '开启前端渲染'}</span>\n  </div>`);\n    buttonHtml.css('display', 'flex');\n    if ($('#tavern-helper-render-container').length === 0) {\n        $('#extensionsMenu').append(buttonHtml);\n    }\n    $('#tavern-helper-render-container').off('click').on('click', async function () {\n        const isRenderEnabled = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_3__.getSettingValue)('render.render_enabled') ?? defaultIframeSettings.render_enabled;\n        await handleRenderEnableToggle(!isRenderEnabled, true);\n    });\n}\n/**\n * 初始化iframe控制面板\n */\nasync function initIframePanel() {\n    // 处理重型前端卡渲染优化\n    const isRenderingOptimizeEnabled = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_3__.getSettingValue)('render.render_optimize') ?? defaultIframeSettings.render_optimize;\n    if (isRenderingOptimizeEnabled) {\n        await handleRenderingOptimizationToggle(true, false);\n    }\n    $('#render-optimize-toggle')\n        .prop('checked', isRenderingOptimizeEnabled)\n        .on('click', (event) => handleRenderingOptimizationToggle(event.target.checked, true));\n    // 处理处理深度设置\n    const renderDepth = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_3__.getSettingValue)('render.render_depth') ?? defaultIframeSettings.render_depth;\n    $('#render-depth')\n        .val(renderDepth)\n        .on('blur', function (event) {\n        onDepthInput(event.target.value);\n    });\n    // 处理油猴兼容性设置\n    const isTampermonkeyEnabled = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_3__.getSettingValue)('render.tampermonkey_compatibility') ?? defaultIframeSettings.tampermonkey_compatibility;\n    if (isTampermonkeyEnabled) {\n        (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_1__.handleTampermonkeyCompatibilityChange)(true, false);\n    }\n    $('#tampermonkey-compatibility-toggle')\n        .prop('checked', isTampermonkeyEnabled)\n        .on('click', (event) => (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_1__.handleTampermonkeyCompatibilityChange)(event.target.checked, true));\n    // 首先处理前端渲染设置 - 这个必须先执行，因为它可能会调用reloadCurrentChat\n    const isRenderEnabled = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_3__.getSettingValue)('render.render_enabled') ?? defaultIframeSettings.render_enabled;\n    await handleRenderEnableToggle(isRenderEnabled, false);\n    $('#render-enable-toggle')\n        .prop('checked', isRenderEnabled)\n        .on('click', (event) => handleRenderEnableToggle(event.target.checked, true));\n    // 处理代码块折叠设置 - 这个放在渲染设置之后，确保不被reloadCurrentChat清除\n    const isRenderingHideStyleEnabled = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_3__.getSettingValue)('render.render_hide_style');\n    if (isRenderingHideStyleEnabled) {\n        await handleRenderingHideStyleToggle(true, false);\n    }\n    $('#render-hide-style-toggle')\n        .prop('checked', isRenderingHideStyleEnabled)\n        .on('click', (event) => handleRenderingHideStyleToggle(event.target.checked, true));\n    $(window).on('resize', function () {\n        if ($('iframe[data-needs-vh=\"true\"]').length) {\n            (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_1__.updateIframeViewportHeight)();\n        }\n    });\n    injectLoadingStyles();\n    (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_1__.setupIframeRemovalListener)();\n}\n/**\n * 处理深度输入改变时\n */\nasync function onDepthInput(value) {\n    const processDepth = parseInt(value, 10);\n    if (processDepth < 0) {\n        toastr.warning('处理深度不能为负数');\n        $('#render-depth').val((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_3__.getSettingValue)('render.render_depth'));\n        return;\n    }\n    (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_3__.saveSettingValue)('render.render_depth', processDepth);\n    await (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_1__.clearAndRenderAllIframes)();\n}\n/**\n * 处理渲染器启用设置改变\n * @param enable 是否启用渲染器\n * @param userInput 是否由用户手动触发\n */\nasync function handleRenderEnableToggle(enable, userInput = true) {\n    syncRenderToggleUI(enable);\n    if (userInput) {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_3__.saveSettingValue)('render.render_enabled', enable);\n    }\n    if (enable) {\n        $('#render-settings-content .extension-content-item').slice(3).css('opacity', 1);\n        await (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_1__.renderAllIframes)();\n    }\n    else {\n        $('#render-settings-content .extension-content-item').slice(3).css('opacity', 0.5);\n        await (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_1__.clearAllIframes)();\n        if (userInput && _sillytavern_script__WEBPACK_IMPORTED_MODULE_4__.this_chid !== undefined) {\n            await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_4__.reloadCurrentChat)();\n        }\n    }\n}\n/**\n * 处理代码块折叠设置改变\n * @param enable 是否启用代码块折叠\n * @param userInput 是否由用户手动触发\n */\nasync function handleRenderingHideStyleToggle(enable, userInput = true) {\n    if (userInput) {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_3__.saveSettingValue)('render.render_hide_style', enable);\n    }\n    if (enable) {\n        (0,_component_message_iframe_render_hide_style__WEBPACK_IMPORTED_MODULE_0__.addRenderingHideStyleSettings)();\n        if (userInput) {\n            await (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_1__.clearAndRenderAllIframes)();\n        }\n    }\n    else {\n        (0,_component_message_iframe_render_hide_style__WEBPACK_IMPORTED_MODULE_0__.removeRenderingHideStyleSettings)();\n        if (userInput) {\n            await (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_1__.clearAndRenderAllIframes)();\n        }\n    }\n}\n/**\n * 处理重型前端卡渲染优化\n * @param enable 是否启用重型前端卡渲染优化\n * @param userInput 是否由用户手动触发\n */\nasync function handleRenderingOptimizationToggle(enable, userInput = true) {\n    if (userInput) {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_3__.saveSettingValue)('render.render_optimize', enable);\n    }\n    if (enable) {\n        (0,_component_message_iframe_render_optimize__WEBPACK_IMPORTED_MODULE_2__.addRenderingOptimizeSettings)();\n        if (userInput) {\n            await (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_1__.clearAndRenderAllIframes)();\n        }\n    }\n    else {\n        (0,_component_message_iframe_render_optimize__WEBPACK_IMPORTED_MODULE_2__.removeRenderingOptimizeSettings)();\n        if (userInput) {\n            await (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_1__.clearAndRenderAllIframes)();\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L21lc3NhZ2VfaWZyYW1lL2luZGV4LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFHc0Q7QUFRSDtBQUlDO0FBQzJCO0FBRVo7QUFFNUQsTUFBTSxxQkFBcUIsR0FBRztJQUNuQyxjQUFjLEVBQUUsSUFBSTtJQUNwQiwwQkFBMEIsRUFBRSxLQUFLO0lBQ2pDLFlBQVksRUFBRSxDQUFDO0lBQ2YsZUFBZSxFQUFFLEtBQUs7SUFDdEIsaUJBQWlCLEVBQUUsS0FBSztDQUN6QixDQUFDO0FBRUY7O0dBRUc7QUFDSSxTQUFTLG1CQUFtQjtJQUNqQyxJQUFJLENBQUMsQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDLE1BQU07UUFBRSxPQUFPO0lBRS9DLE1BQU0sVUFBVSxHQUFHLENBQUMsQ0FBQyxTQUFTLEVBQUU7UUFDOUIsRUFBRSxFQUFFLHVCQUF1QjtRQUMzQixJQUFJLEVBQUU7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O1VBMEJBO0tBQ1AsQ0FBQyxDQUFDO0lBRUgsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQztBQUMvQixDQUFDO0FBRUQ7OztHQUdHO0FBQ0gsU0FBUyxrQkFBa0IsQ0FBQyxNQUFlO0lBQ3pDLENBQUMsQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDbkQsQ0FBQyxDQUFDLDRCQUE0QixDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQztBQUNyRSxDQUFDO0FBRUQ7O0dBRUc7QUFDSSxTQUFTLG9CQUFvQjtJQUNsQyxNQUFNLFVBQVUsR0FBRyxDQUFDLENBQUM7Ozs2Q0FJZiwwRUFBZSxDQUFDLHVCQUF1QixDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsUUFDeEQ7U0FDRyxDQUFDLENBQUM7SUFDVCxV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QUksU0FBUyxFQUFFLENBQUM7UUFDZCwyRUFBZ0IsQ0FBQyx3QkFBd0IsRUFBRSxNQUFNLENBQUMsQ0FBQztJQUNyRCxDQUFDO0lBRUQsSUFBSSxNQUFNLEVBQUUsQ0FBQztRQUNYLHVHQUE0QixFQUFFLENBQUM7UUFDL0IsSUFBSSxTQUFTLEVBQUUsQ0FBQztZQUNkLE1BQU0sa0dBQXdCLEVBQUUsQ0FBQztRQUNuQyxDQUFDO0lBQ0gsQ0FBQztTQUFNLENBQUM7UUFDTiwwR0FBK0IsRUFBRSxDQUFDO1FBQ2xDLElBQUksU0FBUyxFQUFFLENBQUM7WUFDZCxNQUFNLGtHQUF3QixFQUFFLENBQUM7UUFDbkMsQ0FBQztJQUNILENBQUM7QUFDSCxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBvbmVudC9tZXNzYWdlX2lmcmFtZS9pbmRleC50cz9iMzRmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIGFkZFJlbmRlcmluZ0hpZGVTdHlsZVNldHRpbmdzLFxuICByZW1vdmVSZW5kZXJpbmdIaWRlU3R5bGVTZXR0aW5ncyxcbn0gZnJvbSAnQC9jb21wb25lbnQvbWVzc2FnZV9pZnJhbWUvcmVuZGVyX2hpZGVfc3R5bGUnO1xuaW1wb3J0IHtcbiAgY2xlYXJBbGxJZnJhbWVzLFxuICBjbGVhckFuZFJlbmRlckFsbElmcmFtZXMsXG4gIGhhbmRsZVRhbXBlcm1vbmtleUNvbXBhdGliaWxpdHlDaGFuZ2UsXG4gIHJlbmRlckFsbElmcmFtZXMsXG4gIHNldHVwSWZyYW1lUmVtb3ZhbExpc3RlbmVyLFxuICB1cGRhdGVJZnJhbWVWaWV3cG9ydEhlaWdodCxcbn0gZnJvbSAnQC9jb21wb25lbnQvbWVzc2FnZV9pZnJhbWUvcmVuZGVyX21lc3NhZ2UnO1xuaW1wb3J0IHtcbiAgYWRkUmVuZGVyaW5nT3B0aW1pemVTZXR0aW5ncyxcbiAgcmVtb3ZlUmVuZGVyaW5nT3B0aW1pemVTZXR0aW5ncyxcbn0gZnJvbSAnQC9jb21wb25lbnQvbWVzc2FnZV9pZnJhbWUvcmVuZGVyX29wdGltaXplJztcbmltcG9ydCB7IGdldFNldHRpbmdWYWx1ZSwgc2F2ZVNldHRpbmdWYWx1ZSB9IGZyb20gJ0AvdXRpbC9leHRlbnNpb25fdmFyaWFibGVzJztcblxuaW1wb3J0IHsgcmVsb2FkQ3VycmVudENoYXQsIHRoaXNfY2hpZCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHQnO1xuXG5leHBvcnQgY29uc3QgZGVmYXVsdElmcmFtZVNldHRpbmdzID0ge1xuICByZW5kZXJfZW5hYmxlZDogdHJ1ZSxcbiAgdGFtcGVybW9ua2V5X2NvbXBhdGliaWxpdHk6IGZhbHNlLFxuICByZW5kZXJfZGVwdGg6IDAsXG4gIHJlbmRlcl9vcHRpbWl6ZTogZmFsc2UsXG4gIHJlbmRlcl9oaWRlX3N0eWxlOiBmYWxzZSxcbn07XG5cbi8qKlxuICog5rOo5YWl5Yqg6L295qC35byPXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbmplY3RMb2FkaW5nU3R5bGVzKCkge1xuICBpZiAoJCgnI2lmcmFtZS1sb2FkaW5nLXN0eWxlcycpLmxlbmd0aCkgcmV0dXJuO1xuXG4gIGNvbnN0IHN0eWxlU2hlZXQgPSAkKCc8c3R5bGU+Jywge1xuICAgIGlkOiAnaWZyYW1lLWxvYWRpbmctc3R5bGVzJyxcbiAgICB0ZXh0OiBgXG4gICAgICAgIC5pZnJhbWUtbG9hZGluZy1vdmVybGF5e1xuICAgICAgICAgIHBvc2l0aW9uOmFic29sdXRlO1xuICAgICAgICAgIHRvcDowO1xuICAgICAgICAgIGxlZnQ6MDtcbiAgICAgICAgICByaWdodDowO1xuICAgICAgICAgIGJvdHRvbTowO1xuICAgICAgICAgIGJhY2tncm91bmQ6cmdiYSgwLDAsMCwuNyk7XG4gICAgICAgICAgZGlzcGxheTpmbGV4O1xuICAgICAgICAgIGp1c3RpZnktY29udGVudDpjZW50ZXI7XG4gICAgICAgICAgYWxpZ24taXRlbXM6Y2VudGVyO1xuICAgICAgICAgIHotaW5kZXg6MTAwMDtcbiAgICAgICAgICB0cmFuc2l0aW9uOm9wYWNpdHkgLjNzIGVhc2VcbiAgICAgICAgfVxuICAgICAgICAuaWZyYW1lLWxvYWRpbmctY29udGVudHtcbiAgICAgICAgICBjb2xvcjojZmZmO1xuICAgICAgICAgIGRpc3BsYXk6ZmxleDtcbiAgICAgICAgICBhbGlnbi1pdGVtczpjZW50ZXI7XG4gICAgICAgICAgZ2FwOjEwcHg7XG4gICAgICAgICAgZm9udC1zaXplOjE2cHhcbiAgICAgICAgfVxuICAgICAgICAuaWZyYW1lLWxvYWRpbmctY29udGVudCBpe1xuICAgICAgICAgIGZvbnQtc2l6ZToyMHB4XG4gICAgICAgIH1cbiAgICAgICAgLmxvYWRpbmctdGV4dCB7XG4gICAgICAgICAgdHJhbnNpdGlvbjogb3BhY2l0eSAwLjNzIGVhc2U7XG4gICAgICAgIH1gLFxuICB9KTtcblxuICAkKCdoZWFkJykuYXBwZW5kKHN0eWxlU2hlZXQpO1xufVxuXG4vKipcbiAqIOWQjOatpeWJjeerr+a4suafk+ebuOWFs1VJ77yI5oyJ6ZKu5ZKM5paH5pys77yJXG4gKiBAcGFyYW0gZW5hYmxlIOaYr+WQpuWQr+eUqOa4suafk1xuICovXG5mdW5jdGlvbiBzeW5jUmVuZGVyVG9nZ2xlVUkoZW5hYmxlOiBib29sZWFuKSB7XG4gICQoJyNyZW5kZXItZW5hYmxlLXRvZ2dsZScpLnByb3AoJ2NoZWNrZWQnLCBlbmFibGUpO1xuICAkKCcjdGF2ZXJuLWhlbHBlci1yZW5kZXItdGV4dCcpLnRleHQoZW5hYmxlID8gJ+WFs+mXreWJjeerr+a4suafkycgOiAn5byA5ZCv5YmN56uv5riy5p+TJyk7XG59XG5cbi8qKlxuICog5re75Yqg5YmN56uv5riy5p+T5b+r6YCf5oyJ6ZKuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhZGRSZW5kZXJRdWlja0J1dHRvbigpIHtcbiAgY29uc3QgYnV0dG9uSHRtbCA9ICQoYFxuICA8ZGl2IGlkPVwidGF2ZXJuLWhlbHBlci1yZW5kZXItY29udGFpbmVyXCIgY2xhc3M9XCJsaXN0LWdyb3VwLWl0ZW0gZmxleC1jb250YWluZXIgZmxleEdhcDUgaW50ZXJhY3RhYmxlIHRhdmVybi1oZWxwZXItc2hvcnRjdXQtaXRlbVwiPlxuICAgICAgPGRpdiBjbGFzcz1cImZhLXNvbGlkIGZhLXB1enpsZS1waWVjZSBleHRlbnNpb25zTWVudUV4dGVuc2lvbkJ1dHRvblwiIC8+PC9kaXY+XG4gICAgICA8c3BhbiBpZD1cInRhdmVybi1oZWxwZXItcmVuZGVyLXRleHRcIj4ke1xuICAgICAgICBnZXRTZXR0aW5nVmFsdWUoJ3JlbmRlci5yZW5kZXJfZW5hYmxlZCcpID8gJ+WFs+mXreWJjeerr+a4suafkycgOiAn5byA5ZCv5YmN56uv5riy5p+TJ1xuICAgICAgfTwvc3Bhbj5cbiAgPC9kaXY+YCk7XG4gIGJ1dHRvbkh0bWwuY3NzKCdkaXNwbGF5JywgJ2ZsZXgnKTtcbiAgaWYgKCQoJyN0YXZlcm4taGVscGVyLXJlbmRlci1jb250YWluZXInKS5sZW5ndGggPT09IDApIHtcbiAgICAkKCcjZXh0ZW5zaW9uc01lbnUnKS5hcHBlbmQoYnV0dG9uSHRtbCk7XG4gIH1cbiAgJCgnI3RhdmVybi1oZWxwZXItcmVuZGVyLWNvbnRhaW5lcicpLm9mZignY2xpY2snKS5vbignY2xpY2snLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgaXNSZW5kZXJFbmFibGVkID0gZ2V0U2V0dGluZ1ZhbHVlKCdyZW5kZXIucmVuZGVyX2VuYWJsZWQnKSA/PyBkZWZhdWx0SWZyYW1lU2V0dGluZ3MucmVuZGVyX2VuYWJsZWQ7XG4gICAgYXdhaXQgaGFuZGxlUmVuZGVyRW5hYmxlVG9nZ2xlKCFpc1JlbmRlckVuYWJsZWQsIHRydWUpO1xuICB9KTtcbn1cblxuLyoqXG4gKiDliJ3lp4vljJZpZnJhbWXmjqfliLbpnaLmnb9cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGluaXRJZnJhbWVQYW5lbCgpIHtcbiAgLy8g5aSE55CG6YeN5Z6L5YmN56uv5Y2h5riy5p+T5LyY5YyWXG4gIGNvbnN0IGlzUmVuZGVyaW5nT3B0aW1pemVFbmFibGVkID0gZ2V0U2V0dGluZ1ZhbHVlKCdyZW5kZXIucmVuZGVyX29wdGltaXplJykgPz8gZGVmYXVsdElmcmFtZVNldHRpbmdzLnJlbmRlcl9vcHRpbWl6ZTtcbiAgaWYgKGlzUmVuZGVyaW5nT3B0aW1pemVFbmFibGVkKSB7XG4gICAgYXdhaXQgaGFuZGxlUmVuZGVyaW5nT3B0aW1pemF0aW9uVG9nZ2xlKHRydWUsIGZhbHNlKTtcbiAgfVxuICAkKCcjcmVuZGVyLW9wdGltaXplLXRvZ2dsZScpXG4gICAgLnByb3AoJ2NoZWNrZWQnLCBpc1JlbmRlcmluZ09wdGltaXplRW5hYmxlZClcbiAgICAub24oJ2NsaWNrJywgKGV2ZW50OiBKUXVlcnkuQ2xpY2tFdmVudCkgPT4gaGFuZGxlUmVuZGVyaW5nT3B0aW1pemF0aW9uVG9nZ2xlKGV2ZW50LnRhcmdldC5jaGVja2VkLCB0cnVlKSk7XG4gIC8vIOWkhOeQhuWkhOeQhua3seW6puiuvue9rlxuICBjb25zdCByZW5kZXJEZXB0aCA9IGdldFNldHRpbmdWYWx1ZSgncmVuZGVyLnJlbmRlcl9kZXB0aCcpID8/IGRlZmF1bHRJZnJhbWVTZXR0aW5ncy5yZW5kZXJfZGVwdGg7XG4gICQoJyNyZW5kZXItZGVwdGgnKVxuICAgIC52YWwocmVuZGVyRGVwdGgpXG4gICAgLm9uKCdibHVyJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICBvbkRlcHRoSW5wdXQoKGV2ZW50LnRhcmdldCBhcyBIVE1MSW5wdXRFbGVtZW50KS52YWx1ZSk7XG4gICAgfSk7XG5cbiAgLy8g5aSE55CG5rK554y05YW85a655oCn6K6+572uXG4gIGNvbnN0IGlzVGFtcGVybW9ua2V5RW5hYmxlZCA9XG4gICAgZ2V0U2V0dGluZ1ZhbHVlKCdyZW5kZXIudGFtcGVybW9ua2V5X2NvbXBhdGliaWxpdHknKSA/PyBkZWZhdWx0SWZyYW1lU2V0dGluZ3MudGFtcGVybW9ua2V5X2NvbXBhdGliaWxpdHk7XG4gIGlmIChpc1RhbXBlcm1vbmtleUVuYWJsZWQpIHtcbiAgICBoYW5kbGVUYW1wZXJtb25rZXlDb21wYXRpYmlsaXR5Q2hhbmdlKHRydWUsIGZhbHNlKTtcbiAgfVxuICAkKCcjdGFtcGVybW9ua2V5LWNvbXBhdGliaWxpdHktdG9nZ2xlJylcbiAgICAucHJvcCgnY2hlY2tlZCcsIGlzVGFtcGVybW9ua2V5RW5hYmxlZClcbiAgICAub24oJ2NsaWNrJywgKGV2ZW50OiBKUXVlcnkuQ2xpY2tFdmVudCkgPT4gaGFuZGxlVGFtcGVybW9ua2V5Q29tcGF0aWJpbGl0eUNoYW5nZShldmVudC50YXJnZXQuY2hlY2tlZCwgdHJ1ZSkpO1xuXG4gIC8vIOmmluWFiOWkhOeQhuWJjeerr+a4suafk+iuvue9riAtIOi/meS4quW/hemhu+WFiOaJp+ihjO+8jOWboOS4uuWug+WPr+iDveS8muiwg+eUqHJlbG9hZEN1cnJlbnRDaGF0XG4gIGNvbnN0IGlzUmVuZGVyRW5hYmxlZCA9IGdldFNldHRpbmdWYWx1ZSgncmVuZGVyLnJlbmRlcl9lbmFibGVkJykgPz8gZGVmYXVsdElmcmFtZVNldHRpbmdzLnJlbmRlcl9lbmFibGVkO1xuICBhd2FpdCBoYW5kbGVSZW5kZXJFbmFibGVUb2dnbGUoaXNSZW5kZXJFbmFibGVkLCBmYWxzZSk7XG4gICQoJyNyZW5kZXItZW5hYmxlLXRvZ2dsZScpXG4gICAgLnByb3AoJ2NoZWNrZWQnLCBpc1JlbmRlckVuYWJsZWQpXG4gICAgLm9uKCdjbGljaycsIChldmVudDogSlF1ZXJ5LkNsaWNrRXZlbnQpID0+IGhhbmRsZVJlbmRlckVuYWJsZVRvZ2dsZShldmVudC50YXJnZXQuY2hlY2tlZCwgdHJ1ZSkpO1xuXG4gIC8vIOWkhOeQhuS7o+eggeWdl+aKmOWPoOiuvue9riAtIOi/meS4quaUvuWcqOa4suafk+iuvue9ruS5i+WQju+8jOehruS/neS4jeiiq3JlbG9hZEN1cnJlbnRDaGF05riF6ZmkXG4gIGNvbnN0IGlzUmVuZGVyaW5nSGlkZVN0eWxlRW5hYmxlZCA9IGdldFNldHRpbmdWYWx1ZSgncmVuZGVyLnJlbmRlcl9oaWRlX3N0eWxlJyk7XG4gIGlmIChpc1JlbmRlcmluZ0hpZGVTdHlsZUVuYWJsZWQpIHtcbiAgICBhd2FpdCBoYW5kbGVSZW5kZXJpbmdIaWRlU3R5bGVUb2dnbGUodHJ1ZSwgZmFsc2UpO1xuICB9XG4gICQoJyNyZW5kZXItaGlkZS1zdHlsZS10b2dnbGUnKVxuICAgIC5wcm9wKCdjaGVja2VkJywgaXNSZW5kZXJpbmdIaWRlU3R5bGVFbmFibGVkKVxuICAgIC5vbignY2xpY2snLCAoZXZlbnQ6IEpRdWVyeS5DbGlja0V2ZW50KSA9PiBoYW5kbGVSZW5kZXJpbmdIaWRlU3R5bGVUb2dnbGUoZXZlbnQudGFyZ2V0LmNoZWNrZWQsIHRydWUpKTtcblxuICAkKHdpbmRvdykub24oJ3Jlc2l6ZScsIGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoJCgnaWZyYW1lW2RhdGEtbmVlZHMtdmg9XCJ0cnVlXCJdJykubGVuZ3RoKSB7XG4gICAgICB1cGRhdGVJZnJhbWVWaWV3cG9ydEhlaWdodCgpO1xuICAgIH1cbiAgfSk7XG5cbiAgaW5qZWN0TG9hZGluZ1N0eWxlcygpO1xuICBzZXR1cElmcmFtZVJlbW92YWxMaXN0ZW5lcigpO1xufVxuXG4vKipcbiAqIOWkhOeQhua3seW6pui+k+WFpeaUueWPmOaXtlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gb25EZXB0aElucHV0KHZhbHVlOiBzdHJpbmcpIHtcbiAgY29uc3QgcHJvY2Vzc0RlcHRoID0gcGFyc2VJbnQodmFsdWUsIDEwKTtcblxuICBpZiAocHJvY2Vzc0RlcHRoIDwgMCkge1xuICAgIHRvYXN0ci53YXJuaW5nKCflpITnkIbmt7HluqbkuI3og73kuLrotJ/mlbAnKTtcbiAgICAkKCcjcmVuZGVyLWRlcHRoJykudmFsKGdldFNldHRpbmdWYWx1ZSgncmVuZGVyLnJlbmRlcl9kZXB0aCcpKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBzYXZlU2V0dGluZ1ZhbHVlKCdyZW5kZXIucmVuZGVyX2RlcHRoJywgcHJvY2Vzc0RlcHRoKTtcblxuICBhd2FpdCBjbGVhckFuZFJlbmRlckFsbElmcmFtZXMoKTtcbn1cblxuLyoqXG4gKiDlpITnkIbmuLLmn5PlmajlkK/nlKjorr7nva7mlLnlj5hcbiAqIEBwYXJhbSBlbmFibGUg5piv5ZCm5ZCv55So5riy5p+T5ZmoXG4gKiBAcGFyYW0gdXNlcklucHV0IOaYr+WQpueUseeUqOaIt+aJi+WKqOinpuWPkVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlUmVuZGVyRW5hYmxlVG9nZ2xlKGVuYWJsZTogYm9vbGVhbiwgdXNlcklucHV0OiBib29sZWFuID0gdHJ1ZSkge1xuICBzeW5jUmVuZGVyVG9nZ2xlVUkoZW5hYmxlKTtcblxuICBpZiAodXNlcklucHV0KSB7XG4gICAgc2F2ZVNldHRpbmdWYWx1ZSgncmVuZGVyLnJlbmRlcl9lbmFibGVkJywgZW5hYmxlKTtcbiAgfVxuICBpZiAoZW5hYmxlKSB7XG4gICAgJCgnI3JlbmRlci1zZXR0aW5ncy1jb250ZW50IC5leHRlbnNpb24tY29udGVudC1pdGVtJykuc2xpY2UoMykuY3NzKCdvcGFjaXR5JywgMSk7XG4gICAgYXdhaXQgcmVuZGVyQWxsSWZyYW1lcygpO1xuICB9IGVsc2Uge1xuICAgICQoJyNyZW5kZXItc2V0dGluZ3MtY29udGVudCAuZXh0ZW5zaW9uLWNvbnRlbnQtaXRlbScpLnNsaWNlKDMpLmNzcygnb3BhY2l0eScsIDAuNSk7XG4gICAgYXdhaXQgY2xlYXJBbGxJZnJhbWVzKCk7XG4gICAgaWYgKHVzZXJJbnB1dCAmJiB0aGlzX2NoaWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgYXdhaXQgcmVsb2FkQ3VycmVudENoYXQoKTtcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiDlpITnkIbku6PnoIHlnZfmipjlj6Dorr7nva7mlLnlj5hcbiAqIEBwYXJhbSBlbmFibGUg5piv5ZCm5ZCv55So5Luj56CB5Z2X5oqY5Y+gXG4gKiBAcGFyYW0gdXNlcklucHV0IOaYr+WQpueUseeUqOaIt+aJi+WKqOinpuWPkVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlUmVuZGVyaW5nSGlkZVN0eWxlVG9nZ2xlKGVuYWJsZTogYm9vbGVhbiwgdXNlcklucHV0OiBib29sZWFuID0gdHJ1ZSkge1xuICBpZiAodXNlcklucHV0KSB7XG4gICAgc2F2ZVNldHRpbmdWYWx1ZSgncmVuZGVyLnJlbmRlcl9oaWRlX3N0eWxlJywgZW5hYmxlKTtcbiAgfVxuXG4gIGlmIChlbmFibGUpIHtcbiAgICBhZGRSZW5kZXJpbmdIaWRlU3R5bGVTZXR0aW5ncygpO1xuICAgIGlmICh1c2VySW5wdXQpIHtcbiAgICAgIGF3YWl0IGNsZWFyQW5kUmVuZGVyQWxsSWZyYW1lcygpO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICByZW1vdmVSZW5kZXJpbmdIaWRlU3R5bGVTZXR0aW5ncygpO1xuICAgIGlmICh1c2VySW5wdXQpIHtcbiAgICAgIGF3YWl0IGNsZWFyQW5kUmVuZGVyQWxsSWZyYW1lcygpO1xuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIOWkhOeQhumHjeWei+WJjeerr+WNoea4suafk+S8mOWMllxuICogQHBhcmFtIGVuYWJsZSDmmK/lkKblkK/nlKjph43lnovliY3nq6/ljaHmuLLmn5PkvJjljJZcbiAqIEBwYXJhbSB1c2VySW5wdXQg5piv5ZCm55Sx55So5oi35omL5Yqo6Kem5Y+RXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYW5kbGVSZW5kZXJpbmdPcHRpbWl6YXRpb25Ub2dnbGUoZW5hYmxlOiBib29sZWFuLCB1c2VySW5wdXQ6IGJvb2xlYW4gPSB0cnVlKSB7XG4gIGlmICh1c2VySW5wdXQpIHtcbiAgICBzYXZlU2V0dGluZ1ZhbHVlKCdyZW5kZXIucmVuZGVyX29wdGltaXplJywgZW5hYmxlKTtcbiAgfVxuXG4gIGlmIChlbmFibGUpIHtcbiAgICBhZGRSZW5kZXJpbmdPcHRpbWl6ZVNldHRpbmdzKCk7XG4gICAgaWYgKHVzZXJJbnB1dCkge1xuICAgICAgYXdhaXQgY2xlYXJBbmRSZW5kZXJBbGxJZnJhbWVzKCk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJlbW92ZVJlbmRlcmluZ09wdGltaXplU2V0dGluZ3MoKTtcbiAgICBpZiAodXNlcklucHV0KSB7XG4gICAgICBhd2FpdCBjbGVhckFuZFJlbmRlckFsbElmcmFtZXMoKTtcbiAgICB9XG4gIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/component/message_iframe/index.ts\n\n}")},"./src/component/message_iframe/render_hide_style.ts":
/*!***********************************************************!*\
  !*** ./src/component/message_iframe/render_hide_style.ts ***!
  \***********************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addCodeToggleButtonsToAllMessages: () => (/* binding */ addCodeToggleButtonsToAllMessages),\n/* harmony export */   addRenderingHideStyleSettings: () => (/* binding */ addRenderingHideStyleSettings),\n/* harmony export */   addToggleButtonToCodeBlock: () => (/* binding */ addToggleButtonToCodeBlock),\n/* harmony export */   injectCodeBlockHideStyles: () => (/* binding */ injectCodeBlockHideStyles),\n/* harmony export */   removeAllCodeToggleButtons: () => (/* binding */ removeAllCodeToggleButtons),\n/* harmony export */   removeCodeToggleButtonsByMesId: () => (/* binding */ removeCodeToggleButtonsByMesId),\n/* harmony export */   removeRenderingHideStyleSettings: () => (/* binding */ removeRenderingHideStyleSettings)\n/* harmony export */ });\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n\n/**\n * 注入代码块隐藏样式\n */\nfunction injectCodeBlockHideStyles() {\n    const styleId = 'hidden-code-block-styles';\n    let style = document.getElementById(styleId);\n    if (!style) {\n        style = document.createElement('style');\n        style.setAttribute('type', 'text/css');\n        style.setAttribute('id', styleId);\n        document.head.appendChild(style);\n    }\n    style.innerHTML = `\n      pre {\n        display: none;\n      }\n      .code-toggle-button {\n        display: inline-block;\n        margin: 5px 0;\n        padding: 5px 10px;\n        background-color: rgba(0, 0, 0, 0.1);\n        border-radius: 4px;\n        cursor: pointer;\n        font-size: 0.9em;\n        user-select: none;\n        transition: background-color 0.3s;\n      }\n      .code-toggle-button:hover {\n        background-color: rgba(0, 0, 0, 0.2);\n      }\n      .popup:has(#qr--modalEditor) .popup-content > #qr--modalEditor > #qr--main > .qr--modal-messageContainer > #qr--modal-messageHolder > #qr--modal-message {\n        color: var(--SmartThemeEmColor) !important;\n      }\n    `;\n}\n/**\n * 移除代码块隐藏样式\n */\nfunction removeCodeBlockHideStyles() {\n    const styleId = 'hidden-code-block-styles';\n    const style = document.getElementById(styleId);\n    if (style) {\n        style.remove();\n    }\n}\n/**\n * 为单个代码块添加折叠按钮\n * @param $pre 代码块元素\n */\nfunction addToggleButtonToCodeBlock($pre) {\n    if (!(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.getSettingValue)('render.render_hide_style')) {\n        return;\n    }\n    if ($pre.prev('.code-toggle-button').length > 0) {\n        return;\n    }\n    const $toggleButton = $('<div class=\"code-toggle-button\" title=\"关闭[酒馆助手-渲染器-渲染优化]以取消此折叠功能\">显示代码块</div>');\n    $toggleButton.on('click', function () {\n        const isVisible = $pre.is(':visible');\n        if (isVisible) {\n            $pre.hide();\n            $(this).text('显示代码块');\n        }\n        else {\n            $pre.show();\n            $(this).text('隐藏代码块');\n        }\n    });\n    $pre.before($toggleButton);\n}\n/**\n * 为消息添加折叠控件\n * @param $mesText 消息文本元素\n */\nfunction addToggleButtonsToMessage($mesText) {\n    if ($mesText.find('.code-toggle-button').length > 0 || $mesText.find('pre').length === 0) {\n        return;\n    }\n    $mesText.find('pre').each(function (_index, element) {\n        const $pre = $(element);\n        const $code = $pre.find('code');\n        if ($code.length) {\n            addToggleButtonToCodeBlock($pre);\n        }\n    });\n}\n/**\n * 给所有消息添加折叠控件\n */\nfunction addCodeToggleButtonsToAllMessages() {\n    if (!(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.getSettingValue)('render.render_hide_style') || (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.getSettingValue)('render.render_enabled')) {\n        return;\n    }\n    const $chat = $('#chat');\n    if (!$chat.length) {\n        return;\n    }\n    $chat.find('.mes .mes_block .mes_text, .mes .mes_block .mes_reasoning_details').each(function (_index, element) {\n        const $mesText = $(element);\n        addToggleButtonsToMessage($mesText);\n    });\n}\n/**\n * 根据mesId移除折叠控件\n * @param mesId 消息ID\n */\nfunction removeCodeToggleButtonsByMesId(mesId) {\n    const $messageElement = $(`div[mesid=\"${mesId}\"] .mes_text .code-toggle-button`);\n    $messageElement.each(function () {\n        $(this).off('click').remove();\n    });\n}\n/**\n * 移除所有折叠控件\n */\nfunction removeAllCodeToggleButtons() {\n    $('.code-toggle-button').each(function () {\n        $(this).off('click').remove();\n    });\n    // 去掉所有pre的display:none\n    $('pre').css('display', 'block');\n}\n/**\n * 添加代码块折叠设置\n */\nfunction addRenderingHideStyleSettings() {\n    injectCodeBlockHideStyles();\n    addCodeToggleButtonsToAllMessages();\n}\n/**\n * 移除代码块折叠设置\n */\nfunction removeRenderingHideStyleSettings() {\n    removeCodeBlockHideStyles();\n    removeAllCodeToggleButtons();\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L21lc3NhZ2VfaWZyYW1lL3JlbmRlcl9oaWRlX3N0eWxlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQTZEO0FBRTdEOztHQUVHO0FBQ0ksU0FBUyx5QkFBeUI7SUFDdkMsTUFBTSxPQUFPLEdBQUcsMEJBQTBCLENBQUM7SUFDM0MsSUFBSSxLQUFLLEdBQUcsUUFBUSxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUM3QyxJQUFJLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDWCxLQUFLLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUN4QyxLQUFLLENBQUMsWUFBWSxDQUFDLE1BQU0sRUFBRSxVQUFVLENBQUMsQ0FBQztRQUN2QyxLQUFLLENBQUMsWUFBWSxDQUFDLElBQUksRUFBRSxPQUFPLENBQUMsQ0FBQztRQUNsQyxRQUFRLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUNuQyxDQUFDO0lBQ0QsS0FBSyxDQUFDLFNBQVMsR0FBRzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0tBcUJmLENBQUM7QUFDTixDQUFDO0FBRUQ7O0dBRUc7QUFDSCxTQUFTLHlCQUF5QjtJQUNoQyxNQUFNLE9BQU8sR0FBRywwQkFBMEIsQ0FBQztJQUMzQyxNQUFNLEtBQUssR0FBRyxRQUFRLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQy9DLElBQUksS0FBSyxFQUFFLENBQUM7UUFDVixLQUFLLENBQUMsTUFBTSxFQUFFLENBQUM7SUFDakIsQ0FBQztBQUNILENBQUM7QUFFRDs7O0dBR0c7QUFDSSxTQUFTLDBCQUEwQixDQUFDLElBQXlCO0lBQ2xFLElBQUksQ0FBQywwRUFBZSxDQUFDLDBCQUEwQixDQUFDLEVBQUUsQ0FBQztRQUNqRCxPQUFPO0lBQ1QsQ0FBQztJQUVELElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDLE1BQU0sR0FBRyxDQUFDLEVB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RUFBRSxPQUFPLENBQUMsQ0FBQztBQUNuQyxDQUFDO0FBRUQ7O0dBRUc7QUFDSSxTQUFTLDZCQUE2QjtJQUMzQyx5QkFBeUIsRUFBRSxDQUFDO0lBQzVCLGlDQUFpQyxFQUFFLENBQUM7QUFDdEMsQ0FBQztBQUVEOztHQUVHO0FBQ0ksU0FBUyxnQ0FBZ0M7SUFDOUMseUJBQXlCLEVBQUUsQ0FBQztJQUM1QiwwQkFBMEIsRUFBRSxDQUFDO0FBQy9CLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvY29tcG9uZW50L21lc3NhZ2VfaWZyYW1lL3JlbmRlcl9oaWRlX3N0eWxlLnRzPzMwMTIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ2V0U2V0dGluZ1ZhbHVlIH0gZnJvbSAnQC91dGlsL2V4dGVuc2lvbl92YXJpYWJsZXMnO1xuXG4vKipcbiAqIOazqOWFpeS7o+eggeWdl+makOiXj+agt+W8j1xuICovXG5leHBvcnQgZnVuY3Rpb24gaW5qZWN0Q29kZUJsb2NrSGlkZVN0eWxlcygpIHtcbiAgY29uc3Qgc3R5bGVJZCA9ICdoaWRkZW4tY29kZS1ibG9jay1zdHlsZXMnO1xuICBsZXQgc3R5bGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChzdHlsZUlkKTtcbiAgaWYgKCFzdHlsZSkge1xuICAgIHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTtcbiAgICBzdHlsZS5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAndGV4dC9jc3MnKTtcbiAgICBzdHlsZS5zZXRBdHRyaWJ1dGUoJ2lkJywgc3R5bGVJZCk7XG4gICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzdHlsZSk7XG4gIH1cbiAgc3R5bGUuaW5uZXJIVE1MID0gYFxuICAgICAgcHJlIHtcbiAgICAgICAgZGlzcGxheTogbm9uZTtcbiAgICAgIH1cbiAgICAgIC5jb2RlLXRvZ2dsZS1idXR0b24ge1xuICAgICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gICAgICAgIG1hcmdpbjogNXB4IDA7XG4gICAgICAgIHBhZGRpbmc6IDVweCAxMHB4O1xuICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDAsIDAsIDAsIDAuMSk7XG4gICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgICBmb250LXNpemU6IDAuOWVtO1xuICAgICAgICB1c2VyLXNlbGVjdDogbm9uZTtcbiAgICAgICAgdHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjNzO1xuICAgICAgfVxuICAgICAgLmNvZGUtdG9nZ2xlLWJ1dHRvbjpob3ZlciB7XG4gICAgICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMCwgMCwgMC4yKTtcbiAgICAgIH1cbiAgICAgIC5wb3B1cDpoYXMoI3FyLS1tb2RhbEVkaXRvcikgLnBvcHVwLWNvbnRlbnQgPiAjcXItLW1vZGFsRWRpdG9yID4gI3FyLS1tYWluID4gLnFyLS1tb2RhbC1tZXNzYWdlQ29udGFpbmVyID4gI3FyLS1tb2RhbC1tZXNzYWdlSG9sZGVyID4gI3FyLS1tb2RhbC1tZXNzYWdlIHtcbiAgICAgICAgY29sb3I6IHZhcigtLVNtYXJ0VGhlbWVFbUNvbG9yKSAhaW1wb3J0YW50O1xuICAgICAgfVxuICAgIGA7XG59XG5cbi8qKlxuICog56e76Zmk5Luj56CB5Z2X6ZqQ6JeP5qC35byPXG4gKi9cbmZ1bmN0aW9uIHJlbW92ZUNvZGVCbG9ja0hpZGVTdHlsZXMoKSB7XG4gIGNvbnN0IHN0eWxlSWQgPSAnaGlkZGVuLWNvZGUtYmxvY2stc3R5bGVzJztcbiAgY29uc3Qgc3R5bGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChzdHlsZUlkKTtcbiAgaWYgKHN0eWxlKSB7XG4gICAgc3R5bGUucmVtb3ZlKCk7XG4gIH1cbn1cblxuLyoqXG4gKiDkuLrljZXkuKrku6PnoIHlnZfmt7vliqDmipjlj6DmjInpkq5cbiAqIEBwYXJhbSAkcHJlIOS7o+eggeWdl+WFg+e0oFxuICovXG5leHBvcnQgZnVuY3Rpb24gYWRkVG9nZ2xlQnV0dG9uVG9Db2RlQmxvY2soJHByZTogSlF1ZXJ5PEhUTUxFbGVtZW50Pikge1xuICBpZiAoIWdldFNldHRpbmdWYWx1ZSgncmVuZGVyLnJlbmRlcl9oaWRlX3N0eWxlJykpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoJHByZS5wcmV2KCcuY29kZS10b2dnbGUtYnV0dG9uJykubGVuZ3RoID4gMCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0ICR0b2dnbGVCdXR0b24gPSAkKFxuICAgICc8ZGl2IGNsYXNzPVwiY29kZS10b2dnbGUtYnV0dG9uXCIgdGl0bGU9XCLlhbPpl61b6YWS6aaG5Yqp5omLLea4suafk+WZqC3muLLmn5PkvJjljJZd5Lul5Y+W5raI5q2k5oqY5Y+g5Yqf6IO9XCI+5pi+56S65Luj56CB5Z2XPC9kaXY+JyxcbiAgKTtcblxuICAkdG9nZ2xlQnV0dG9uLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBpc1Zpc2libGUgPSAkcHJlLmlzKCc6dmlzaWJsZScpO1xuXG4gICAgaWYgKGlzVmlzaWJsZSkge1xuICAgICAgJHByZS5oaWRlKCk7XG4gICAgICAkKHRoaXMpLnRleHQoJ+aYvuekuuS7o+eggeWdlycpO1xuICAgIH0gZWxzZSB7XG4gICAgICAkcHJlLnNob3coKTtcbiAgICAgICQodGhpcykudGV4dCgn6ZqQ6JeP5Luj56CB5Z2XJyk7XG4gICAgfVxuICB9KTtcblxuICAkcHJlLmJlZm9yZSgkdG9nZ2xlQnV0dG9uKTtcbn1cblxuLyoqXG4gKiDkuLrmtojmga/mt7vliqDmipjlj6Dmjqfku7ZcbiAqIEBwYXJhbSAkbWVzVGV4dCDmtojmga/mlofmnKzlhYPntKBcbiAqL1xuZnVuY3Rpb24gYWRkVG9nZ2xlQnV0dG9uc1RvTWVzc2FnZSgkbWVzVGV4dDogSlF1ZXJ5PEhUTUxFbGVtZW50Pikge1xuICBpZiAoJG1lc1RleHQuZmluZCgnLmNvZGUtdG9nZ2xlLWJ1dHRvbicpLmxlbmd0aCA+IDAgfHwgJG1lc1RleHQuZmluZCgncHJlJykubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgJG1lc1RleHQuZmluZCgncHJlJykuZWFjaChmdW5jdGlvbiAoX2luZGV4LCBlbGVtZW50KSB7XG4gICAgY29uc3QgJHByZSA9ICQoZWxlbWVudCk7XG4gICAgY29uc3QgJGNvZGUgPSAkcHJlLmZpbmQoJ2NvZGUnKTtcbiAgICBpZiAoJGNvZGUubGVuZ3RoKSB7XG4gICAgICBhZGRUb2dnbGVCdXR0b25Ub0NvZGVCbG9jaygkcHJlKTtcbiAgICB9XG4gIH0pO1xufVxuXG4vKipcbiAqIOe7meaJgOaciea2iOaBr+a3u+WKoOaKmOWPoOaOp+S7tlxuICovXG5leHBvcnQgZnVuY3Rpb24gYWRkQ29kZVRvZ2dsZUJ1dHRvbnNUb0FsbE1lc3NhZ2VzKCkge1xuICBpZiAoIWdldFNldHRpbmdWYWx1ZSgncmVuZGVyLnJlbmRlcl9oaWRlX3N0eWxlJykgfHwgZ2V0U2V0dGluZ1ZhbHVlKCdyZW5kZXIucmVuZGVyX2VuYWJsZWQnKSkge1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCAkY2hhdCA9ICQoJyNjaGF0Jyk7XG4gIGlmICghJGNoYXQubGVuZ3RoKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgJGNoYXQuZmluZCgnLm1lcyAubWVzX2Jsb2NrIC5tZXNfdGV4dCwgLm1lcyAubWVzX2Jsb2NrIC5tZXNfcmVhc29uaW5nX2RldGFpbHMnKS5lYWNoKGZ1bmN0aW9uIChfaW5kZXgsIGVsZW1lbnQpIHtcbiAgICBjb25zdCAkbWVzVGV4dCA9ICQoZWxlbWVudCk7XG4gICAgYWRkVG9nZ2xlQnV0dG9uc1RvTWVzc2FnZSgkbWVzVGV4dCk7XG4gIH0pO1xufVxuXG4vKipcbiAqIOagueaNrm1lc0lk56e76Zmk5oqY5Y+g5o6n5Lu2XG4gKiBAcGFyYW0gbWVzSWQg5raI5oGvSURcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUNvZGVUb2dnbGVCdXR0b25zQnlNZXNJZChtZXNJZDogbnVtYmVyKSB7XG4gIGNvbnN0ICRtZXNzYWdlRWxlbWVudCA9ICQoYGRpdlttZXNpZD1cIiR7bWVzSWR9XCJdIC5tZXNfdGV4dCAuY29kZS10b2dnbGUtYnV0dG9uYCk7XG4gICRtZXNzYWdlRWxlbWVudC5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAkKHRoaXMpLm9mZignY2xpY2snKS5yZW1vdmUoKTtcbiAgfSk7XG59XG5cbi8qKlxuICog56e76Zmk5omA5pyJ5oqY5Y+g5o6n5Lu2XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVBbGxDb2RlVG9nZ2xlQnV0dG9ucygpIHtcbiAgJCgnLmNvZGUtdG9nZ2xlLWJ1dHRvbicpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICQodGhpcykub2ZmKCdjbGljaycpLnJlbW92ZSgpO1xuICB9KTtcbiAgLy8g5Y675o6J5omA5pyJcHJl55qEZGlzcGxheTpub25lXG4gICQoJ3ByZScpLmNzcygnZGlzcGxheScsICdibG9jaycpO1xufVxuXG4vKipcbiAqIOa3u+WKoOS7o+eggeWdl+aKmOWPoOiuvue9rlxuICovXG5leHBvcnQgZnVuY3Rpb24gYWRkUmVuZGVyaW5nSGlkZVN0eWxlU2V0dGluZ3MoKSB7XG4gIGluamVjdENvZGVCbG9ja0hpZGVTdHlsZXMoKTtcbiAgYWRkQ29kZVRvZ2dsZUJ1dHRvbnNUb0FsbE1lc3NhZ2VzKCk7XG59XG5cbi8qKlxuICog56e76Zmk5Luj56CB5Z2X5oqY5Y+g6K6+572uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVSZW5kZXJpbmdIaWRlU3R5bGVTZXR0aW5ncygpIHtcbiAgcmVtb3ZlQ29kZUJsb2NrSGlkZVN0eWxlcygpO1xuICByZW1vdmVBbGxDb2RlVG9nZ2xlQnV0dG9ucygpO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/component/message_iframe/render_hide_style.ts\n\n}")},"./src/component/message_iframe/render_message.ts":
/*!********************************************************!*\
  !*** ./src/component/message_iframe/render_message.ts ***!
  \********************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   clearAllIframes: () => (/* binding */ clearAllIframes),\n/* harmony export */   clearAndRenderAllIframes: () => (/* binding */ clearAndRenderAllIframes),\n/* harmony export */   destroyIframe: () => (/* binding */ destroyIframe),\n/* harmony export */   handlePartialRender: () => (/* binding */ handlePartialRender),\n/* harmony export */   handleRenderToggle: () => (/* binding */ handleRenderToggle),\n/* harmony export */   handleTampermonkeyCompatibilityChange: () => (/* binding */ handleTampermonkeyCompatibilityChange),\n/* harmony export */   partialRenderEvents: () => (/* binding */ partialRenderEvents),\n/* harmony export */   renderAllIframes: () => (/* binding */ renderAllIframes),\n/* harmony export */   renderMessageAfterDelete: () => (/* binding */ renderMessageAfterDelete),\n/* harmony export */   renderPartialIframes: () => (/* binding */ renderPartialIframes),\n/* harmony export */   setupIframeRemovalListener: () => (/* binding */ setupIframeRemovalListener),\n/* harmony export */   tampermonkey_script: () => (/* binding */ tampermonkey_script),\n/* harmony export */   updateIframeViewportHeight: () => (/* binding */ updateIframeViewportHeight),\n/* harmony export */   viewport_adjust_script: () => (/* binding */ viewport_adjust_script)\n/* harmony export */ });\n/* harmony import */ var _component_message_iframe_render_hide_style__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/message_iframe/render_hide_style */ \"./src/component/message_iframe/render_hide_style.ts\");\n/* harmony import */ var _component_message_iframe_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/component/message_iframe/utils */ \"./src/component/message_iframe/utils.ts\");\n/* harmony import */ var _script_url__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/script_url */ \"./src/script_url.ts\");\n/* harmony import */ var _third_party_html__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/third_party.html */ \"./src/third_party.html\");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n\n\n\n\n\n\n\nlet tampermonkeyMessageListener = null;\nconst RENDER_MODES = {\n    FULL: 'FULL',\n    PARTIAL: 'PARTIAL',\n};\n/**\n * 渲染消息到iframe\n * @param mode 渲染模式\n * @param specificMesId 指定消息ID\n */\nasync function renderMessagesInIframes(mode = RENDER_MODES.FULL, specificMesId = null) {\n    if (!(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_4__.getSettingValue)('enabled_extension') || !(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_4__.getSettingValue)('render.render_enabled')) {\n        return;\n    }\n    const context = (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_6__.getContext)();\n    const totalMessages = context.chat.length;\n    const processDepth = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_4__.getSettingValue)('render.render_depth') ?? 0;\n    const depthLimit = processDepth > 0 ? processDepth : totalMessages;\n    const depthLimitedMessageIds = [...Array(totalMessages).keys()].slice(-depthLimit);\n    let messagesToRenderIds = [];\n    const messagesToCancelIds = [...Array(totalMessages).keys()].filter(id => !depthLimitedMessageIds.includes(id));\n    if (mode === RENDER_MODES.FULL) {\n        messagesToRenderIds = depthLimitedMessageIds;\n    }\n    else if (mode === RENDER_MODES.PARTIAL && specificMesId !== null) {\n        if (depthLimitedMessageIds.includes(specificMesId)) {\n            messagesToRenderIds = [specificMesId];\n        }\n        else {\n            return;\n        }\n    }\n    for (const messageId of messagesToCancelIds) {\n        const message = context.chat[messageId];\n        const $iframes = $(`[id^=\"message-iframe-${messageId}-\"]`);\n        if ($iframes.length > 0) {\n            $iframes.each(function () {\n                destroyIframe(this);\n            });\n            (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_5__.updateMessageBlock)(messageId, message);\n        }\n        if ((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_4__.getSettingValue)('render.render_hide_style')) {\n            const $mesTexts = $(`.mes[mesid=\"${messageId}\"] .mes_block .mes_reasoning_details, .mes[mesid=\"${messageId}\"] .mes_block .mes_text`);\n            $mesTexts.each(function () {\n                const $codeBlock = $(this).find('pre');\n                if ($codeBlock.length) {\n                    (0,_component_message_iframe_render_hide_style__WEBPACK_IMPORTED_MODULE_0__.addToggleButtonToCodeBlock)($codeBlock);\n                }\n            });\n        }\n    }\n    for (const messageId of messagesToRenderIds) {\n        const $messageElement = $(`.mes[mesid=\"${messageId}\"]`);\n        if (!$messageElement.length) {\n            log.debug(`未找到 mesid: ${messageId} 对应的消息元素。`);\n            continue;\n        }\n        const $codeElements = $messageElement.find('pre');\n        if (!$codeElements.length) {\n            continue;\n        }\n        let iframeCounter = 1;\n        $codeElements.each(function () {\n            let extractedText = (0,_component_message_iframe_utils__WEBPACK_IMPORTED_MODULE_1__.extractTextFromCode)(this);\n            if (extractedText.includes('<body') && extractedText.includes('</body>')) {\n                const disableLoading = /\x3c!--\\s*disable-default-loading\\s*--\x3e/.test(extractedText);\n                const hasMinVh = /min-height:\\s*[^;]*vh/.test(extractedText);\n                const hasJsVhUsage = /\\d+vh/.test(extractedText);\n                if (hasMinVh || hasJsVhUsage) {\n                    extractedText = processAllVhUnits(extractedText);\n                }\n                const needsVhHandling = hasMinVh || hasJsVhUsage;\n                let $wrapper = $('<div>').css({\n                    position: 'relative',\n                    width: '100%',\n                });\n                const $iframe = $('<iframe>')\n                    .attr({\n                    id: `message-iframe-${messageId}-${iframeCounter}`,\n                    loading: 'lazy',\n                })\n                    .css({\n                    margin: '5px auto',\n                    border: 'none',\n                    width: '100%',\n                });\n                iframeCounter++;\n                if (needsVhHandling) {\n                    $iframe.attr('data-needs-vh', 'true');\n                }\n                let loadingTimeout = null;\n                if (!disableLoading) {\n                    const $loadingOverlay = $('<div>').addClass('iframe-loading-overlay').html(`\n                <div class=\"iframe-loading-content\">\n                  <i class=\"fa-solid fa-spinner fa-spin\"></i>\n                  <span class=\"loading-text\">Loading...</span>\n                </div>`);\n                    loadingTimeout = setTimeout(() => {\n                        const $loadingText = $loadingOverlay.find('.loading-text');\n                        if ($loadingText.length) {\n                            $loadingText.text('如加载时间过长，请检查网络');\n                        }\n                    }, 10000);\n                    $wrapper.append($loadingOverlay);\n                }\n                $wrapper.append($iframe);\n                const srcdocContent = `\n            <html>\n            <head>\n              <style>\n              ${needsVhHandling ? `:root{--viewport-height:${window.innerHeight}px;}` : ``}\n              html,body{margin:0;padding:0;overflow:hidden!important;max-width:100%!important;box-sizing:border-box}\n              .user_avatar,.user-avatar{background-image:url('${(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_4__.getUserAvatarPath)()}')}\n              .char_avatar,.char-avatar{background-image:url('${(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_4__.getCharAvatarPath)()}')}\n              </style>\n              ${_third_party_html__WEBPACK_IMPORTED_MODULE_3__[\"default\"]}\n              <script src=\"${_script_url__WEBPACK_IMPORTED_MODULE_2__.script_url.get('iframe_client')}\"><\/script>\n            </head>\n            <body>\n              ${extractedText}\n              ${needsVhHandling ? `<script src=\"${_script_url__WEBPACK_IMPORTED_MODULE_2__.script_url.get('viewport_adjust_script')}\"><\/script>` : ``}\n\n              ${(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_4__.getSettingValue)('render.tampermonkey_compatibility')\n                    ? `<script src=\"${_script_url__WEBPACK_IMPORTED_MODULE_2__.script_url.get('tampermonkey_script')}\"><\/script>`\n                    : ``}\n            </body>\n            </html>\n          `;\n                $iframe.attr('srcdoc', srcdocContent);\n                $iframe.on('load', function () {\n                    observeIframeContent(this);\n                    $wrapper = $(this).parent();\n                    if ($wrapper.length) {\n                        const $loadingOverlay = $wrapper.find('.iframe-loading-overlay');\n                        if ($loadingOverlay.length) {\n                            $loadingOverlay.css('opacity', '0');\n                            setTimeout(() => $loadingOverlay.remove(), 300);\n                        }\n                    }\n                    if ($(this).attr('data-needs-vh') === 'true') {\n                        this.contentWindow?.postMessage({\n                            request: 'updateViewportHeight',\n                            newHeight: window.innerHeight,\n                        }, '*');\n                    }\n                    _sillytavern_script__WEBPACK_IMPORTED_MODULE_5__.eventSource.emitAndWait('message_iframe_render_ended', this.id);\n                    if ((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_4__.getSettingValue)('render.render_hide_style')) {\n                        (0,_component_message_iframe_render_hide_style__WEBPACK_IMPORTED_MODULE_0__.removeCodeToggleButtonsByMesId)(messageId);\n                    }\n                    if (loadingTimeout) {\n                        clearTimeout(loadingTimeout);\n                    }\n                });\n                _sillytavern_script__WEBPACK_IMPORTED_MODULE_5__.eventSource.emitAndWait('message_iframe_render_started', $iframe.attr('id'));\n                $(this).replaceWith($wrapper);\n            }\n            else {\n                (0,_component_message_iframe_render_hide_style__WEBPACK_IMPORTED_MODULE_0__.addToggleButtonToCodeBlock)($(this));\n            }\n        });\n    }\n}\n/**\n * 使用了min-height:vh时，自动调整iframe高度\n */\nconst viewport_adjust_script = `\n$(window).on(\"message\", function (event) {\n    if (event.originalEvent.data.request === \"updateViewportHeight\") {\n        const newHeight = event.originalEvent.data.newHeight;\n        $(\"html\").css(\"--viewport-height\", newHeight + \"px\");\n    }\n});\n`;\n/**\n * 油猴脚本\n */\nconst tampermonkey_script = `\nclass AudioManager {\n  constructor() {\n    this.currentlyPlaying = null;\n  }\n  handlePlay(audio) {\n    if (this.currentlyPlaying && this.currentlyPlaying !== audio) {\n      this.currentlyPlaying.pause();\n    }\n    window.parent.postMessage({\n      type: 'audioPlay',\n      iframeId: window.frameElement.id\n    }, '*');\n\n    this.currentlyPlaying = audio;\n  }\n  stopAll() {\n    if (this.currentlyPlaying) {\n      this.currentlyPlaying.pause();\n      this.currentlyPlaying = null;\n    }\n  }\n}\nconst audioManager = new AudioManager();\n$('.qr-button').on('click', function() {\n  const buttonName = $(this).text().trim();\n  window.parent.postMessage({ type: 'buttonClick', name: buttonName }, '*');\n});\n$('.st-text').each(function() {\n  $(this).on('input', function() {\n    window.parent.postMessage({ type: 'textInput', text: $(this).val() }, '*');\n  });\n  $(this).on('change', function() {\n    window.parent.postMessage({ type: 'textInput', text: $(this).val() }, '*');\n  });\n  const textarea = this;\n  const observer = new MutationObserver((mutations) => {\n    mutations.forEach((mutation) => {\n      if (mutation.type === 'attributes' && mutation.attributeName === 'value') {\n        window.parent.postMessage({ type: 'textInput', text: $(textarea).val() }, '*');\n      }\n    });\n  });\n  observer.observe(textarea, { attributes: true });\n});\n$('.st-send-button').on('click', function() {\n  window.parent.postMessage({ type: 'sendClick' }, '*');\n});\n$('.st-audio').on('play', function() {\n  audioManager.handlePlay(this);\n});\n$(window).on('message', function(event) {\n  if (event.originalEvent.data.type === 'stopAudio' &&\n    event.originalEvent.data.iframeId !== window.frameElement.id) {\n    audioManager.stopAll();\n  }\n});\n`;\n/**\n * 转换代码块中所有vh单位（包括JavaScript动态设置）\n * @param htmlContent 代码块内容\n * @returns 转换后的代码块内容\n */\nfunction processAllVhUnits(htmlContent) {\n    const viewportHeight = window.innerHeight;\n    let processedContent = htmlContent.replace(/((?:document\\.body\\.style\\.minHeight|\\.style\\.minHeight|setProperty\\s*\\(\\s*['\"]min-height['\"])\\s*[=,]\\s*['\"`])([^'\"`]*?)(['\"`])/g, (match, prefix, value, suffix) => {\n        if (value.includes('vh')) {\n            const convertedValue = value.replace(/(\\d+(?:\\.\\d+)?)vh/g, (num) => {\n                const numValue = parseFloat(num);\n                if (numValue === 100) {\n                    return `var(--viewport-height, ${viewportHeight}px)`;\n                }\n                else {\n                    return `calc(var(--viewport-height, ${viewportHeight}px) * ${numValue / 100})`;\n                }\n            });\n            return prefix + convertedValue + suffix;\n        }\n        return match;\n    });\n    processedContent = processedContent.replace(/min-height:\\s*([^;]*vh[^;]*);/g, expression => {\n        const processedExpression = expression.replace(/(\\d+(?:\\.\\d+)?)vh/g, num => {\n            const numValue = parseFloat(num);\n            if (numValue === 100) {\n                return `var(--viewport-height, ${viewportHeight}px)`;\n            }\n            else {\n                return `calc(var(--viewport-height, ${viewportHeight}px) * ${numValue / 100})`;\n            }\n        });\n        return `${processedExpression};`;\n    });\n    processedContent = processedContent.replace(/style\\s*=\\s*[\"']([^\"']*min-height:\\s*[^\"']*vh[^\"']*?)[\"']/gi, (match, styleContent) => {\n        const processedStyleContent = styleContent.replace(/min-height:\\s*([^;]*vh[^;]*)/g, (expression) => {\n            const processedExpression = expression.replace(/(\\d+(?:\\.\\d+)?)vh/g, num => {\n                const numValue = parseFloat(num);\n                if (numValue === 100) {\n                    return `var(--viewport-height, ${viewportHeight}px)`;\n                }\n                else {\n                    return `calc(var(--viewport-height, ${viewportHeight}px) * ${numValue / 100})`;\n                }\n            });\n            return processedExpression;\n        });\n        return match.replace(styleContent, processedStyleContent);\n    });\n    return processedContent;\n}\n/**\n * 使用了min-height:vh时，更新iframe的viewport高度\n */\nfunction updateIframeViewportHeight() {\n    $(window).on('resize', function () {\n        if ($('iframe[data-needs-vh=\"true\"]').length) {\n            const viewportHeight = window.innerHeight;\n            $('iframe[data-needs-vh=\"true\"]').each(function () {\n                const iframe = this;\n                if (iframe.contentWindow) {\n                    iframe.contentWindow.postMessage({\n                        request: 'updateViewportHeight',\n                        newHeight: viewportHeight,\n                    }, '*');\n                }\n            });\n        }\n    });\n}\n/**\n * 获取或创建共享的ResizeObserver实例\n */\nfunction getSharedResizeObserver() {\n    if (!window._sharedResizeObserver) {\n        window._observedElements = new Map();\n        window._sharedResizeObserver = new ResizeObserver(entries => {\n            for (const entry of entries) {\n                const element = entry.target;\n                const data = window._observedElements?.get(element);\n                if (data) {\n                    const { iframe } = data;\n                    adjustIframeHeight(iframe);\n                }\n            }\n        });\n    }\n    return window._sharedResizeObserver;\n}\n/**\n * 调整iframe高度\n * @param iframe iframe元素\n */\nfunction adjustIframeHeight(iframe) {\n    const $iframe = $(iframe);\n    if (!$iframe.length || !$iframe[0].contentWindow || !$iframe[0].contentWindow.document.body) {\n        return;\n    }\n    const doc = $iframe[0].contentWindow.document;\n    const bodyHeight = doc.body.offsetHeight;\n    const htmlHeight = doc.documentElement.offsetHeight;\n    const newHeight = Math.max(bodyHeight, htmlHeight);\n    const currentHeight = parseFloat($iframe.css('height')) || 0;\n    if (Math.abs(currentHeight - newHeight) > 5) {\n        $iframe.css('height', newHeight + 'px');\n        if ($iframe.attr('data-needs-vh') === 'true' && iframe.contentWindow) {\n            iframe.contentWindow.postMessage({\n                request: 'updateViewportHeight',\n                newHeight: window.innerHeight,\n            }, '*');\n        }\n    }\n}\n/**\n * 观察iframe内容用于自动调整高度\n * @param iframe iframe元素\n */\nfunction observeIframeContent(iframe) {\n    const $iframe = $(iframe);\n    if (!$iframe.length || !$iframe[0].contentWindow || !$iframe[0].contentWindow.document.body) {\n        return;\n    }\n    try {\n        const docBody = $iframe[0].contentWindow.document.body;\n        const resizeObserver = getSharedResizeObserver();\n        if (window._observedElements) {\n            for (const [element, data] of window._observedElements.entries()) {\n                if (data.iframe === iframe) {\n                    resizeObserver.unobserve(element);\n                    window._observedElements.delete(element);\n                    break;\n                }\n            }\n        }\n        window._observedElements?.set(docBody, { iframe });\n        resizeObserver.observe(docBody);\n        adjustIframeHeight(iframe);\n    }\n    catch (error) {\n        log.error('[Render] 设置 iframe 内容观察时出错:', error);\n    }\n}\n/**\n * 处理油猴脚本兼容模式传来的消息\n * @param event 消息事件\n */\nfunction handleTampermonkeyMessages(event) {\n    if (event.data.type === 'buttonClick') {\n        const buttonName = event.data.name;\n        $('.qr--button.menu_button').each(function () {\n            if ($(this).find('.qr--button-label').text().trim() === buttonName) {\n                $(this).trigger('click');\n            }\n        });\n    }\n    else if (event.data.type === 'textInput') {\n        const $sendTextarea = jQuery('#send_textarea');\n        if ($sendTextarea.length) {\n            $sendTextarea.val(event.data.text).trigger('input').trigger('change');\n        }\n    }\n    else if (event.data.type === 'sendClick') {\n        const $sendButton = jQuery('#send_but');\n        if ($sendButton.length) {\n            $sendButton.trigger('click');\n        }\n    }\n}\n/**\n * 油猴兼容模式-创建全局音频管理器\n */\nfunction createGlobalAudioManager() {\n    let currentPlayingIframeId = null;\n    window.addEventListener('message', function (event) {\n        if (event.data.type === 'audioPlay') {\n            const newIframeId = event.data.iframeId;\n            if (currentPlayingIframeId && currentPlayingIframeId !== newIframeId) {\n                $('iframe').each(function () {\n                    const iframe = this;\n                    if (iframe.contentWindow) {\n                        iframe.contentWindow.postMessage({\n                            type: 'stopAudio',\n                            iframeId: newIframeId,\n                        }, '*');\n                    }\n                });\n            }\n            currentPlayingIframeId = newIframeId;\n        }\n    });\n}\n/**\n * 处理油猴兼容性设置改变\n */\nasync function handleTampermonkeyCompatibilityChange(enable, userInput = true) {\n    if (userInput) {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_4__.saveSettingValue)('render.tampermonkey_compatibility', enable);\n    }\n    if (!(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_4__.getSettingValue)('enabled_extension')) {\n        return;\n    }\n    if (enable) {\n        if (!tampermonkeyMessageListener) {\n            tampermonkeyMessageListener = handleTampermonkeyMessages;\n            window.addEventListener('message', tampermonkeyMessageListener);\n            createGlobalAudioManager();\n        }\n    }\n    else if (tampermonkeyMessageListener) {\n        window.removeEventListener('message', tampermonkeyMessageListener);\n        tampermonkeyMessageListener = null;\n    }\n    await clearAndRenderAllIframes();\n}\nconst partialRenderEvents = [\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_5__.event_types.CHARACTER_MESSAGE_RENDERED,\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_5__.event_types.USER_MESSAGE_RENDERED,\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_5__.event_types.MESSAGE_UPDATED,\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_5__.event_types.MESSAGE_SWIPED,\n];\nasync function handleRenderToggle(userInput = true, enable = true) {\n    if (enable) {\n        renderMessagesInIframes(RENDER_MODES.FULL);\n    }\n    if (userInput) {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_4__.saveSettingValue)('render.render_enabled', enable);\n    }\n}\n/**\n * 清理后，重新渲染所有iframe\n */\nasync function clearAndRenderAllIframes() {\n    await clearAllIframes();\n    if (_sillytavern_script__WEBPACK_IMPORTED_MODULE_5__.this_chid !== undefined) {\n        await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_5__.reloadCurrentChat)();\n        await renderAllIframes();\n    }\n}\n/**\n * 渲染所有iframe\n */\nasync function renderAllIframes() {\n    await renderMessagesInIframes(RENDER_MODES.FULL);\n    log.info('[Render] 渲染所有iframe');\n}\n/**\n * 渲染部分iframe\n * @param mesId 消息ID\n */\nasync function renderPartialIframes(mesId) {\n    const processDepth = parseInt($('#render-depth').val(), 10);\n    const context = (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_6__.getContext)();\n    const totalMessages = context.chat.length;\n    if (processDepth > 0) {\n        const depthOffset = totalMessages - processDepth;\n        if (mesId < depthOffset) {\n            return;\n        }\n    }\n    await renderMessagesInIframes(RENDER_MODES.PARTIAL, mesId);\n    log.info('[Render] 渲染' + mesId + '号消息的iframe');\n}\n/**\n * 销毁iframe\n * @param iframe iframe元素\n */\nfunction destroyIframe(iframe) {\n    const $iframe = $(iframe);\n    if (!$iframe.length) {\n        return;\n    }\n    // 如果有ResizeObserver实例和已观察元素的记录\n    if (window._sharedResizeObserver && window._observedElements) {\n        for (const [element, data] of window._observedElements.entries()) {\n            if (data.iframe === iframe) {\n                window._sharedResizeObserver.unobserve(element);\n                window._observedElements.delete(element);\n                break;\n            }\n        }\n    }\n    $iframe.trigger('unload').remove();\n    if (window._observedElements?.size === 0 && window._sharedResizeObserver) {\n        window._sharedResizeObserver.disconnect();\n        window._sharedResizeObserver = undefined;\n        log.info('[Render] 所有iframe已移除，停止观察');\n    }\n}\n/**\n * 清理所有iframe\n * @returns {Promise<void>}\n */\nasync function clearAllIframes() {\n    const $iframes = $('iframe[id^=\"message-iframe\"]');\n    $iframes.each(function () {\n        destroyIframe(this);\n    });\n}\n/**\n * 设置iframe移除监听器\n * @returns {MutationObserver} 观察器实例\n */\nfunction setupIframeRemovalListener() {\n    const observer = new MutationObserver(mutations => {\n        mutations.forEach(mutation => {\n            if (mutation.removedNodes.length) {\n                mutation.removedNodes.forEach(node => {\n                    if (node instanceof HTMLIFrameElement) {\n                        destroyIframe(node);\n                    }\n                    else if (node instanceof HTMLElement) {\n                        const iframes = node.querySelectorAll('iframe');\n                        if (iframes.length) {\n                            iframes.forEach(iframe => {\n                                destroyIframe(iframe);\n                            });\n                        }\n                    }\n                });\n            }\n        });\n    });\n    observer.observe(document.body, { childList: true, subtree: true });\n    return observer;\n}\n/**\n * 删除消息后重新渲染\n * @param mesId 消息ID\n */\nfunction renderMessageAfterDelete(mesId) {\n    const context = (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_6__.getContext)();\n    const processDepth = parseInt($('#render-depth').val(), 10);\n    const totalMessages = context.chat.length;\n    const maxRemainId = mesId - 1;\n    const getMessage = (id) => {\n        const message = context.chat[id] ?? {};\n        return message;\n    };\n    const getIframe = (id) => {\n        const $iframe = $('[id^=\"message-iframe-' + id + '-\"]');\n        return $iframe.length > 0 ? $iframe.get(0) : null;\n    };\n    const checkCodeBlock = (message) => {\n        return /```[\\s\\S]*?```/.test(message.mes);\n    };\n    // 考虑到高楼层的情况，深度为0时，只渲染最后一个消息\n    if (processDepth === 0) {\n        const message = getMessage(maxRemainId);\n        const hasCodeBlock = checkCodeBlock(message);\n        const iframe = getIframe(maxRemainId);\n        if (!hasCodeBlock && !iframe) {\n            return;\n        }\n        destroyIframe(iframe);\n        (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_5__.updateMessageBlock)(maxRemainId, message);\n        renderPartialIframes(maxRemainId);\n    }\n    else {\n        let startRenderIndex = totalMessages - processDepth;\n        if (startRenderIndex < 0) {\n            startRenderIndex = 0;\n        }\n        for (let i = startRenderIndex; i <= maxRemainId; i++) {\n            const message = getMessage(i);\n            const hasCodeBlock = checkCodeBlock(message);\n            const iframe = getIframe(i);\n            if (!hasCodeBlock && !iframe) {\n                continue;\n            }\n            destroyIframe(iframe);\n            (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_5__.updateMessageBlock)(i, message);\n            renderPartialIframes(i);\n        }\n    }\n}\nconst handlePartialRender = (mesId) => {\n    log.info('[Render] 触发局部渲染，消息ID:', mesId);\n    const processDepth = parseInt($('#render-depth').val(), 10);\n    const context = (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_6__.getContext)();\n    const totalMessages = context.chat.length;\n    if (processDepth > 0) {\n        const depthOffset = totalMessages - processDepth;\n        if (mesId < depthOffset) {\n            return;\n        }\n    }\n    setTimeout(() => {\n        renderMessagesInIframes(RENDER_MODES.PARTIAL, mesId);\n    }, 100);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L21lc3NhZ2VfaWZyYW1lL3JlbmRlcl9tZXNzYWdlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUdzRDtBQUNpQjtBQUM3QjtBQUNHO0FBQ3dFO0FBRUo7QUFDcEQ7QUFFN0QsSUFBSSwyQkFBMkIsR0FBMkMsSUFBSSxDQUFDO0FBRS9FLE1BQU0sWUFBWSxHQUFHO0lBQ25CLElBQUksRUFBRSxNQUFNO0lBQ1osT0FBTyxFQUFFLFNBQVM7Q0FDbkIsQ0FBQztBQUVGOzs7O0dBSUc7QUFDSCxLQUFLLFVBQVUsdUJBQXVCLENBQUMsSUFBSSxHQUFHLFlBQVksQ0FBQyxJQUFJLEVBQUUsZ0JBQStCLElBQUk7SUFDbEcsSUFBSSxDQUFDLDBFQUFlLENBQUMsbUJBQW1CLENBQUMsSUFBSSxDQUFDLDBFQUFlLENBQUMsdUJBQXVCLENBQUMsRUFBRSxDQUFDO1FBQ3ZGLE9BQU87SUFDVCxDQUFDO0lBQ0QsTUFBTSxPQUFPLEdBQUcsMkVBQVUsRUFBRSxDQUFDO0lBQzdCLE1BQU0sYUFBYSxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDO0lBQzFDLE1BQU0sWUFBWSxHQUFHLDBFQUFlLENBQUMscUJBQXFCLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDakUsTUFBTSxVQUFVLEdBQUcsWUFBWSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxhQUFhLENBQUM7SUFDbkUsTUFBTSxzQkFBc0IsR0FBRyxDQUFDLEdBQUcsS0FBSyxDQUFDLGFBQWEsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUM7SUFFbkYsSUFBSSxtQkFBbUIsR0FBYSxFQUFFLENBQUM7SUFDdkMsTUFBTSxtQkFBbUIsR0FBYSxDQUFDLEdBQUcsS0FBSyxDQUFDLGFBQWEsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsTUFBTSxDQUMzRSxFQUFF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QVksR0FBRyxjQUFjLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDN0MsTUFBTSxNQUFNLEdBQUcsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBRTVCLElBQUksQ0FBQyxZQUFZLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztnQkFDN0IsU0FBUztZQUNYLENBQUM7WUFDRCxhQUFhLENBQUMsTUFBMkIsQ0FBQyxDQUFDO1lBQzNDLHVFQUFrQixDQUFDLENBQUMsRUFBRSxPQUFPLENBQUMsQ0FBQztZQUMvQixvQkFBb0IsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUMxQixDQUFDO0lBQ0gsQ0FBQztBQUNILENBQUM7QUFFTSxNQUFNLG1CQUFtQixHQUFHLENBQUMsS0FBYSxFQUFFLEVBQUU7SUFDbkQsR0FBRyxDQUFDLElBQUksQ0FBQyx1QkFBdUIsRUFBRSxLQUFLLENBQUMsQ0FBQztJQUN6QyxNQUFNLFlBQVksR0FBRyxRQUFRLENBQUMsQ0FBQyxDQUFDLGVBQWUsQ0FBQyxDQUFDLEdBQUcsRUFBWSxFQUFFLEVBQUUsQ0FBQyxDQUFDO0lBQ3RFLE1BQU0sT0FBTyxHQUFHLDJFQUFVLEVBQUUsQ0FBQztJQUM3QixNQUFNLGFBQWEsR0FBRyxPQUFPLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQztJQUUxQyxJQUFJLFlBQVksR0FBRyxDQUFDLEVBQUUsQ0FBQztRQUNyQixNQUFNLFdBQVcsR0FBRyxhQUFhLEdBQUcsWUFBWSxDQUFDO1FBRWpELElBQUksS0FBSyxHQUFHLFdBQVcsRUFBRSxDQUFDO1lBQ3hCLE9BQU87UUFDVCxDQUFDO0lBQ0gsQ0FBQztJQUVELFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDZCx1QkFBdUIsQ0FBQyxZQUFZLENBQUMsT0FBTyxFQUFFLEtBQUssQ0FBQyxDQUFDO0lBQ3ZELENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQztBQUNWLENBQUMsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9jb21wb25lbnQvbWVzc2FnZV9pZnJhbWUvcmVuZGVyX21lc3NhZ2UudHM/MGMxOCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBhZGRUb2dnbGVCdXR0b25Ub0NvZGVCbG9jayxcbiAgcmVtb3ZlQ29kZVRvZ2dsZUJ1dHRvbnNCeU1lc0lkLFxufSBmcm9tICdAL2NvbXBvbmVudC9tZXNzYWdlX2lmcmFtZS9yZW5kZXJfaGlkZV9zdHlsZSc7XG5pbXBvcnQgeyBleHRyYWN0VGV4dEZyb21Db2RlIH0gZnJvbSAnQC9jb21wb25lbnQvbWVzc2FnZV9pZnJhbWUvdXRpbHMnO1xuaW1wb3J0IHsgc2NyaXB0X3VybCB9IGZyb20gJ0Avc2NyaXB0X3VybCc7XG5pbXBvcnQgdGhpcmRfcGFydHkgZnJvbSAnQC90aGlyZF9wYXJ0eS5odG1sJztcbmltcG9ydCB7IGdldENoYXJBdmF0YXJQYXRoLCBnZXRTZXR0aW5nVmFsdWUsIGdldFVzZXJBdmF0YXJQYXRoLCBzYXZlU2V0dGluZ1ZhbHVlIH0gZnJvbSAnQC91dGlsL2V4dGVuc2lvbl92YXJpYWJsZXMnO1xuXG5pbXBvcnQgeyBldmVudFNvdXJjZSwgZXZlbnRfdHlwZXMsIHJlbG9hZEN1cnJlbnRDaGF0LCB0aGlzX2NoaWQsIHVwZGF0ZU1lc3NhZ2VCbG9jayB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHQnO1xuaW1wb3J0IHsgZ2V0Q29udGV4dCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL2V4dGVuc2lvbnMnO1xuXG5sZXQgdGFtcGVybW9ua2V5TWVzc2FnZUxpc3RlbmVyOiAoKGV2ZW50OiBNZXNzYWdlRXZlbnQpID0+IHZvaWQpIHwgbnVsbCA9IG51bGw7XG5cbmNvbnN0IFJFTkRFUl9NT0RFUyA9IHtcbiAgRlVMTDogJ0ZVTEwnLFxuICBQQVJUSUFMOiAnUEFSVElBTCcsXG59O1xuXG4vKipcbiAqIOa4suafk+a2iOaBr+WIsGlmcmFtZVxuICogQHBhcmFtIG1vZGUg5riy5p+T5qih5byPXG4gKiBAcGFyYW0gc3BlY2lmaWNNZXNJZCDmjIflrprmtojmga9JRFxuICovXG5hc3luYyBmdW5jdGlvbiByZW5kZXJNZXNzYWdlc0luSWZyYW1lcyhtb2RlID0gUkVOREVSX01PREVTLkZVTEwsIHNwZWNpZmljTWVzSWQ6IG51bWJlciB8IG51bGwgPSBudWxsKSB7XG4gIGlmICghZ2V0U2V0dGluZ1ZhbHVlKCdlbmFibGVkX2V4dGVuc2lvbicpIHx8ICFnZXRTZXR0aW5nVmFsdWUoJ3JlbmRlci5yZW5kZXJfZW5hYmxlZCcpKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IGNvbnRleHQgPSBnZXRDb250ZXh0KCk7XG4gIGNvbnN0IHRvdGFsTWVzc2FnZXMgPSBjb250ZXh0LmNoYXQubGVuZ3RoO1xuICBjb25zdCBwcm9jZXNzRGVwdGggPSBnZXRTZXR0aW5nVmFsdWUoJ3JlbmRlci5yZW5kZXJfZGVwdGgnKSA/PyAwO1xuICBjb25zdCBkZXB0aExpbWl0ID0gcHJvY2Vzc0RlcHRoID4gMCA/IHByb2Nlc3NEZXB0aCA6IHRvdGFsTWVzc2FnZXM7XG4gIGNvbnN0IGRlcHRoTGltaXRlZE1lc3NhZ2VJZHMgPSBbLi4uQXJyYXkodG90YWxNZXNzYWdlcykua2V5cygpXS5zbGljZSgtZGVwdGhMaW1pdCk7XG5cbiAgbGV0IG1lc3NhZ2VzVG9SZW5kZXJJZHM6IG51bWJlcltdID0gW107XG4gIGNvbnN0IG1lc3NhZ2VzVG9DYW5jZWxJZHM6IG51bWJlcltdID0gWy4uLkFycmF5KHRvdGFsTWVzc2FnZXMpLmtleXMoKV0uZmlsdGVyKFxuICAgIGlkID0+ICFkZXB0aExpbWl0ZWRNZXNzYWdlSWRzLmluY2x1ZGVzKGlkKSxcbiAgKTtcblxuICBpZiAobW9kZSA9PT0gUkVOREVSX01PREVTLkZVTEwpIHtcbiAgICBtZXNzYWdlc1RvUmVuZGVySWRzID0gZGVwdGhMaW1pdGVkTWVzc2FnZUlkcztcbiAgfSBlbHNlIGlmIChtb2RlID09PSBSRU5ERVJfTU9ERVMuUEFSVElBTCAmJiBzcGVjaWZpY01lc0lkICE9PSBudWxsKSB7XG4gICAgaWYgKGRlcHRoTGltaXRlZE1lc3NhZ2VJZHMuaW5jbHVkZXMoc3BlY2lmaWNNZXNJZCkpIHtcbiAgICAgIG1lc3NhZ2VzVG9SZW5kZXJJZHMgPSBbc3BlY2lmaWNNZXNJZF07XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH1cblxuICBmb3IgKGNvbnN0IG1lc3NhZ2VJZCBvZiBtZXNzYWdlc1RvQ2FuY2VsSWRzKSB7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNvbnRleHQuY2hhdFttZXNzYWdlSWRdO1xuICAgIGNvbnN0ICRpZnJhbWVzID0gJChgW2lkXj1cIm1lc3NhZ2UtaWZyYW1lLSR7bWVzc2FnZUlkfS1cIl1gKSBhcyBKUXVlcnk8SFRNTElGcmFtZUVsZW1lbnQ+O1xuICAgIGlmICgkaWZyYW1lcy5sZW5ndGggPiAwKSB7XG4gICAgICAkaWZyYW1lcy5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZGVzdHJveUlmcmFtZSh0aGlzKTtcbiAgICAgIH0pO1xuICAgICAgdXBkYXRlTWVzc2FnZUJsb2NrKG1lc3NhZ2VJZCwgbWVzc2FnZSk7XG4gICAgfVxuICAgIGlmIChnZXRTZXR0aW5nVmFsdWUoJ3JlbmRlci5yZW5kZXJfaGlkZV9zdHlsZScpKSB7XG4gICAgICBjb25zdCAkbWVzVGV4dHMgPSAkKFxuICAgICAgICBgLm1lc1ttZXNpZD1cIiR7bWVzc2FnZUlkfVwiXSAubWVzX2Jsb2NrIC5tZXNfcmVhc29uaW5nX2RldGFpbHMsIC5tZXNbbWVzaWQ9XCIke21lc3NhZ2VJZH1cIl0gLm1lc19ibG9jayAubWVzX3RleHRgLFxuICAgICAgKTtcbiAgICAgICRtZXNUZXh0cy5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc3QgJGNvZGVCbG9jayA9ICQodGhpcykuZmluZCgncHJlJyk7XG4gICAgICAgIGlmICgkY29kZUJsb2NrLmxlbmd0aCkge1xuICAgICAgICAgIGFkZFRvZ2dsZUJ1dHRvblRvQ29kZUJsb2NrKCRjb2RlQmxvY2spO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBmb3IgKGNvbnN0IG1lc3NhZ2VJZCBvZiBtZXNzYWdlc1RvUmVuZGVySWRzKSB7XG4gICAgY29uc3QgJG1lc3NhZ2VFbGVtZW50ID0gJChgLm1lc1ttZXNpZD1cIiR7bWVzc2FnZUlkfVwiXWApO1xuICAgIGlmICghJG1lc3NhZ2VFbGVtZW50Lmxlbmd0aCkge1xuICAgICAgbG9nLmRlYnVnKGDmnKrmib7liLAgbWVzaWQ6ICR7bWVzc2FnZUlkfSDlr7nlupTnmoTmtojmga/lhYPntKDjgIJgKTtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIGNvbnN0ICRjb2RlRWxlbWVudHMgPSAkbWVzc2FnZUVsZW1lbnQuZmluZCgncHJlJyk7XG4gICAgaWYgKCEkY29kZUVsZW1lbnRzLmxlbmd0aCkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgbGV0IGlmcmFtZUNvdW50ZXIgPSAxO1xuXG4gICAgJGNvZGVFbGVtZW50cy5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBleHRyYWN0ZWRUZXh0ID0gZXh0cmFjdFRleHRGcm9tQ29kZSh0aGlzKTtcbiAgICAgIGlmIChleHRyYWN0ZWRUZXh0LmluY2x1ZGVzKCc8Ym9keScpICYmIGV4dHJhY3RlZFRleHQuaW5jbHVkZXMoJzwvYm9keT4nKSkge1xuICAgICAgICBjb25zdCBkaXNhYmxlTG9hZGluZyA9IC88IS0tXFxzKmRpc2FibGUtZGVmYXVsdC1sb2FkaW5nXFxzKi0tPi8udGVzdChleHRyYWN0ZWRUZXh0KTtcbiAgICAgICAgY29uc3QgaGFzTWluVmggPSAvbWluLWhlaWdodDpcXHMqW147XSp2aC8udGVzdChleHRyYWN0ZWRUZXh0KTtcbiAgICAgICAgY29uc3QgaGFzSnNWaFVzYWdlID0gL1xcZCt2aC8udGVzdChleHRyYWN0ZWRUZXh0KTtcblxuICAgICAgICBpZiAoaGFzTWluVmggfHwgaGFzSnNWaFVzYWdlKSB7XG4gICAgICAgICAgZXh0cmFjdGVkVGV4dCA9IHByb2Nlc3NBbGxWaFVuaXRzKGV4dHJhY3RlZFRleHQpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG5lZWRzVmhIYW5kbGluZyA9IGhhc01pblZoIHx8IGhhc0pzVmhVc2FnZTtcblxuICAgICAgICBsZXQgJHdyYXBwZXIgPSAkKCc8ZGl2PicpLmNzcyh7XG4gICAgICAgICAgcG9zaXRpb246ICdyZWxhdGl2ZScsXG4gICAgICAgICAgd2lkdGg6ICcxMDAlJyxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgJGlmcmFtZSA9ICQoJzxpZnJhbWU+JylcbiAgICAgICAgICAuYXR0cih7XG4gICAgICAgICAgICBpZDogYG1lc3NhZ2UtaWZyYW1lLSR7bWVzc2FnZUlkfS0ke2lmcmFtZUNvdW50ZXJ9YCxcbiAgICAgICAgICAgIGxvYWRpbmc6ICdsYXp5JyxcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5jc3Moe1xuICAgICAgICAgICAgbWFyZ2luOiAnNXB4IGF1dG8nLFxuICAgICAgICAgICAgYm9yZGVyOiAnbm9uZScsXG4gICAgICAgICAgICB3aWR0aDogJzEwMCUnLFxuICAgICAgICAgIH0pIGFzIEpRdWVyeTxIVE1MSUZyYW1lRWxlbWVudD47XG5cbiAgICAgICAgaWZyYW1lQ291bnRlcisrO1xuXG4gICAgICAgIGlmIChuZWVkc1ZoSGFuZGxpbmcpIHtcbiAgICAgICAgICAkaWZyYW1lLmF0dHIoJ2RhdGEtbmVlZHMtdmgnLCAndHJ1ZScpO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGxvYWRpbmdUaW1lb3V0OiBOb2RlSlMuVGltZW91dCB8IG51bGwgPSBudWxsO1xuICAgICAgICBpZiAoIWRpc2FibGVMb2FkaW5nKSB7XG4gICAgICAgICAgY29uc3QgJGxvYWRpbmdPdmVybGF5ID0gJCgnPGRpdj4nKS5hZGRDbGFzcygnaWZyYW1lLWxvYWRpbmctb3ZlcmxheScpLmh0bWwoYFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJpZnJhbWUtbG9hZGluZy1jb250ZW50XCI+XG4gICAgICAgICAgICAgICAgICA8aSBjbGFzcz1cImZhLXNvbGlkIGZhLXNwaW5uZXIgZmEtc3BpblwiPjwvaT5cbiAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwibG9hZGluZy10ZXh0XCI+TG9hZGluZy4uLjwvc3Bhbj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5gKTtcblxuICAgICAgICAgIGxvYWRpbmdUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCAkbG9hZGluZ1RleHQgPSAkbG9hZGluZ092ZXJsYXkuZmluZCgnLmxvYWRpbmctdGV4dCcpO1xuICAgICAgICAgICAgaWYgKCRsb2FkaW5nVGV4dC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgJGxvYWRpbmdUZXh0LnRleHQoJ+WmguWKoOi9veaXtumXtOi/h+mVv++8jOivt+ajgOafpee9kee7nCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sIDEwMDAwKTtcblxuICAgICAgICAgICR3cmFwcGVyLmFwcGVuZCgkbG9hZGluZ092ZXJsYXkpO1xuICAgICAgICB9XG5cbiAgICAgICAgJHdyYXBwZXIuYXBwZW5kKCRpZnJhbWUpO1xuXG4gICAgICAgIGNvbnN0IHNyY2RvY0NvbnRlbnQgPSBgXG4gICAgICAgICAgICA8aHRtbD5cbiAgICAgICAgICAgIDxoZWFkPlxuICAgICAgICAgICAgICA8c3R5bGU+XG4gICAgICAgICAgICAgICR7bmVlZHNWaEhhbmRsaW5nID8gYDpyb290ey0tdmlld3BvcnQtaGVpZ2h0OiR7d2luZG93LmlubmVySGVpZ2h0fXB4O31gIDogYGB9XG4gICAgICAgICAgICAgIGh0bWwsYm9keXttYXJnaW46MDtwYWRkaW5nOjA7b3ZlcmZsb3c6aGlkZGVuIWltcG9ydGFudDttYXgtd2lkdGg6MTAwJSFpbXBvcnRhbnQ7Ym94LXNpemluZzpib3JkZXItYm94fVxuICAgICAgICAgICAgICAudXNlcl9hdmF0YXIsLnVzZXItYXZhdGFye2JhY2tncm91bmQtaW1hZ2U6dXJsKCcke2dldFVzZXJBdmF0YXJQYXRoKCl9Jyl9XG4gICAgICAgICAgICAgIC5jaGFyX2F2YXRhciwuY2hhci1hdmF0YXJ7YmFja2dyb3VuZC1pbWFnZTp1cmwoJyR7Z2V0Q2hhckF2YXRhclBhdGgoKX0nKX1cbiAgICAgICAgICAgICAgPC9zdHlsZT5cbiAgICAgICAgICAgICAgJHt0aGlyZF9wYXJ0eX1cbiAgICAgICAgICAgICAgPHNjcmlwdCBzcmM9XCIke3NjcmlwdF91cmwuZ2V0KCdpZnJhbWVfY2xpZW50Jyl9XCI+PC9zY3JpcHQ+XG4gICAgICAgICAgICA8L2hlYWQ+XG4gICAgICAgICAgICA8Ym9keT5cbiAgICAgICAgICAgICAgJHtleHRyYWN0ZWRUZXh0fVxuICAgICAgICAgICAgICAke25lZWRzVmhIYW5kbGluZyA/IGA8c2NyaXB0IHNyYz1cIiR7c2NyaXB0X3VybC5nZXQoJ3ZpZXdwb3J0X2FkanVzdF9zY3JpcHQnKX1cIj48L3NjcmlwdD5gIDogYGB9XG5cbiAgICAgICAgICAgICAgJHtcbiAgICAgICAgICAgICAgICBnZXRTZXR0aW5nVmFsdWUoJ3JlbmRlci50YW1wZXJtb25rZXlfY29tcGF0aWJpbGl0eScpXG4gICAgICAgICAgICAgICAgICA/IGA8c2NyaXB0IHNyYz1cIiR7c2NyaXB0X3VybC5nZXQoJ3RhbXBlcm1vbmtleV9zY3JpcHQnKX1cIj48L3NjcmlwdD5gXG4gICAgICAgICAgICAgICAgICA6IGBgXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIDwvYm9keT5cbiAgICAgICAgICAgIDwvaHRtbD5cbiAgICAgICAgICBgO1xuXG4gICAgICAgICRpZnJhbWUuYXR0cignc3JjZG9jJywgc3JjZG9jQ29udGVudCk7XG5cbiAgICAgICAgJGlmcmFtZS5vbignbG9hZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBvYnNlcnZlSWZyYW1lQ29udGVudCh0aGlzKTtcblxuICAgICAgICAgICR3cmFwcGVyID0gJCh0aGlzKS5wYXJlbnQoKTtcbiAgICAgICAgICBpZiAoJHdyYXBwZXIubGVuZ3RoKSB7XG4gICAgICAgICAgICBjb25zdCAkbG9hZGluZ092ZXJsYXkgPSAkd3JhcHBlci5maW5kKCcuaWZyYW1lLWxvYWRpbmctb3ZlcmxheScpO1xuICAgICAgICAgICAgaWYgKCRsb2FkaW5nT3ZlcmxheS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgJGxvYWRpbmdPdmVybGF5LmNzcygnb3BhY2l0eScsICcwJyk7XG4gICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gJGxvYWRpbmdPdmVybGF5LnJlbW92ZSgpLCAzMDApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICgkKHRoaXMpLmF0dHIoJ2RhdGEtbmVlZHMtdmgnKSA9PT0gJ3RydWUnKSB7XG4gICAgICAgICAgICB0aGlzLmNvbnRlbnRXaW5kb3c/LnBvc3RNZXNzYWdlKFxuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmVxdWVzdDogJ3VwZGF0ZVZpZXdwb3J0SGVpZ2h0JyxcbiAgICAgICAgICAgICAgICBuZXdIZWlnaHQ6IHdpbmRvdy5pbm5lckhlaWdodCxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgJyonLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBldmVudFNvdXJjZS5lbWl0QW5kV2FpdCgnbWVzc2FnZV9pZnJhbWVfcmVuZGVyX2VuZGVkJywgdGhpcy5pZCk7XG5cbiAgICAgICAgICBpZiAoZ2V0U2V0dGluZ1ZhbHVlKCdyZW5kZXIucmVuZGVyX2hpZGVfc3R5bGUnKSkge1xuICAgICAgICAgICAgcmVtb3ZlQ29kZVRvZ2dsZUJ1dHRvbnNCeU1lc0lkKG1lc3NhZ2VJZCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGxvYWRpbmdUaW1lb3V0KSB7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQobG9hZGluZ1RpbWVvdXQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgZXZlbnRTb3VyY2UuZW1pdEFuZFdhaXQoJ21lc3NhZ2VfaWZyYW1lX3JlbmRlcl9zdGFydGVkJywgJGlmcmFtZS5hdHRyKCdpZCcpKTtcbiAgICAgICAgJCh0aGlzKS5yZXBsYWNlV2l0aCgkd3JhcHBlcik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhZGRUb2dnbGVCdXR0b25Ub0NvZGVCbG9jaygkKHRoaXMpKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuXG4vKipcbiAqIOS9v+eUqOS6hm1pbi1oZWlnaHQ6dmjml7bvvIzoh6rliqjosIPmlbRpZnJhbWXpq5jluqZcbiAqL1xuZXhwb3J0IGNvbnN0IHZpZXdwb3J0X2FkanVzdF9zY3JpcHQgPSBgXG4kKHdpbmRvdykub24oXCJtZXNzYWdlXCIsIGZ1bmN0aW9uIChldmVudCkge1xuICAgIGlmIChldmVudC5vcmlnaW5hbEV2ZW50LmRhdGEucmVxdWVzdCA9PT0gXCJ1cGRhdGVWaWV3cG9ydEhlaWdodFwiKSB7XG4gICAgICAgIGNvbnN0IG5ld0hlaWdodCA9IGV2ZW50Lm9yaWdpbmFsRXZlbnQuZGF0YS5uZXdIZWlnaHQ7XG4gICAgICAgICQoXCJodG1sXCIpLmNzcyhcIi0tdmlld3BvcnQtaGVpZ2h0XCIsIG5ld0hlaWdodCArIFwicHhcIik7XG4gICAgfVxufSk7XG5gO1xuXG4vKipcbiAqIOayueeMtOiEmuacrFxuICovXG5leHBvcnQgY29uc3QgdGFtcGVybW9ua2V5X3NjcmlwdCA9IGBcbmNsYXNzIEF1ZGlvTWFuYWdlciB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuY3VycmVudGx5UGxheWluZyA9IG51bGw7XG4gIH1cbiAgaGFuZGxlUGxheShhdWRpbykge1xuICAgIGlmICh0aGlzLmN1cnJlbnRseVBsYXlpbmcgJiYgdGhpcy5jdXJyZW50bHlQbGF5aW5nICE9PSBhdWRpbykge1xuICAgICAgdGhpcy5jdXJyZW50bHlQbGF5aW5nLnBhdXNlKCk7XG4gICAgfVxuICAgIHdpbmRvdy5wYXJlbnQucG9zdE1lc3NhZ2Uoe1xuICAgICAgdHlwZTogJ2F1ZGlvUGxheScsXG4gICAgICBpZnJhbWVJZDogd2luZG93LmZyYW1lRWxlbWVudC5pZFxuICAgIH0sICcqJyk7XG5cbiAgICB0aGlzLmN1cnJlbnRseVBsYXlpbmcgPSBhdWRpbztcbiAgfVxuICBzdG9wQWxsKCkge1xuICAgIGlmICh0aGlzLmN1cnJlbnRseVBsYXlpbmcpIHtcbiAgICAgIHRoaXMuY3VycmVudGx5UGxheWluZy5wYXVzZSgpO1xuICAgICAgdGhpcy5jdXJyZW50bHlQbGF5aW5nID0gbnVsbDtcbiAgICB9XG4gIH1cbn1cbmNvbnN0IGF1ZGlvTWFuYWdlciA9IG5ldyBBdWRpb01hbmFnZXIoKTtcbiQoJy5xci1idXR0b24nKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgY29uc3QgYnV0dG9uTmFtZSA9ICQodGhpcykudGV4dCgpLnRyaW0oKTtcbiAgd2luZG93LnBhcmVudC5wb3N0TWVzc2FnZSh7IHR5cGU6ICdidXR0b25DbGljaycsIG5hbWU6IGJ1dHRvbk5hbWUgfSwgJyonKTtcbn0pO1xuJCgnLnN0LXRleHQnKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAkKHRoaXMpLm9uKCdpbnB1dCcsIGZ1bmN0aW9uKCkge1xuICAgIHdpbmRvdy5wYXJlbnQucG9zdE1lc3NhZ2UoeyB0eXBlOiAndGV4dElucHV0JywgdGV4dDogJCh0aGlzKS52YWwoKSB9LCAnKicpO1xuICB9KTtcbiAgJCh0aGlzKS5vbignY2hhbmdlJywgZnVuY3Rpb24oKSB7XG4gICAgd2luZG93LnBhcmVudC5wb3N0TWVzc2FnZSh7IHR5cGU6ICd0ZXh0SW5wdXQnLCB0ZXh0OiAkKHRoaXMpLnZhbCgpIH0sICcqJyk7XG4gIH0pO1xuICBjb25zdCB0ZXh0YXJlYSA9IHRoaXM7XG4gIGNvbnN0IG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKG11dGF0aW9ucykgPT4ge1xuICAgIG11dGF0aW9ucy5mb3JFYWNoKChtdXRhdGlvbikgPT4ge1xuICAgICAgaWYgKG11dGF0aW9uLnR5cGUgPT09ICdhdHRyaWJ1dGVzJyAmJiBtdXRhdGlvbi5hdHRyaWJ1dGVOYW1lID09PSAndmFsdWUnKSB7XG4gICAgICAgIHdpbmRvdy5wYXJlbnQucG9zdE1lc3NhZ2UoeyB0eXBlOiAndGV4dElucHV0JywgdGV4dDogJCh0ZXh0YXJlYSkudmFsKCkgfSwgJyonKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG4gIG9ic2VydmVyLm9ic2VydmUodGV4dGFyZWEsIHsgYXR0cmlidXRlczogdHJ1ZSB9KTtcbn0pO1xuJCgnLnN0LXNlbmQtYnV0dG9uJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gIHdpbmRvdy5wYXJlbnQucG9zdE1lc3NhZ2UoeyB0eXBlOiAnc2VuZENsaWNrJyB9LCAnKicpO1xufSk7XG4kKCcuc3QtYXVkaW8nKS5vbigncGxheScsIGZ1bmN0aW9uKCkge1xuICBhdWRpb01hbmFnZXIuaGFuZGxlUGxheSh0aGlzKTtcbn0pO1xuJCh3aW5kb3cpLm9uKCdtZXNzYWdlJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgaWYgKGV2ZW50Lm9yaWdpbmFsRXZlbnQuZGF0YS50eXBlID09PSAnc3RvcEF1ZGlvJyAmJlxuICAgIGV2ZW50Lm9yaWdpbmFsRXZlbnQuZGF0YS5pZnJhbWVJZCAhPT0gd2luZG93LmZyYW1lRWxlbWVudC5pZCkge1xuICAgIGF1ZGlvTWFuYWdlci5zdG9wQWxsKCk7XG4gIH1cbn0pO1xuYDtcblxuLyoqXG4gKiDovazmjaLku6PnoIHlnZfkuK3miYDmnIl2aOWNleS9je+8iOWMheaLrEphdmFTY3JpcHTliqjmgIHorr7nva7vvIlcbiAqIEBwYXJhbSBodG1sQ29udGVudCDku6PnoIHlnZflhoXlrrlcbiAqIEByZXR1cm5zIOi9rOaNouWQjueahOS7o+eggeWdl+WGheWuuVxuICovXG5mdW5jdGlvbiBwcm9jZXNzQWxsVmhVbml0cyhodG1sQ29udGVudDogc3RyaW5nKSB7XG4gIGNvbnN0IHZpZXdwb3J0SGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0O1xuXG4gIGxldCBwcm9jZXNzZWRDb250ZW50ID0gaHRtbENvbnRlbnQucmVwbGFjZShcbiAgICAvKCg/OmRvY3VtZW50XFwuYm9keVxcLnN0eWxlXFwubWluSGVpZ2h0fFxcLnN0eWxlXFwubWluSGVpZ2h0fHNldFByb3BlcnR5XFxzKlxcKFxccypbJ1wiXW1pbi1oZWlnaHRbJ1wiXSlcXHMqWz0sXVxccypbJ1wiYF0pKFteJ1wiYF0qPykoWydcImBdKS9nLFxuICAgIChtYXRjaCwgcHJlZml4LCB2YWx1ZSwgc3VmZml4KSA9PiB7XG4gICAgICBpZiAodmFsdWUuaW5jbHVkZXMoJ3ZoJykpIHtcbiAgICAgICAgY29uc3QgY29udmVydGVkVmFsdWUgPSB2YWx1ZS5yZXBsYWNlKC8oXFxkKyg/OlxcLlxcZCspPyl2aC9nLCAobnVtOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICBjb25zdCBudW1WYWx1ZSA9IHBhcnNlRmxvYXQobnVtKTtcbiAgICAgICAgICBpZiAobnVtVmFsdWUgPT09IDEwMCkge1xuICAgICAgICAgICAgcmV0dXJuIGB2YXIoLS12aWV3cG9ydC1oZWlnaHQsICR7dmlld3BvcnRIZWlnaHR9cHgpYDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGBjYWxjKHZhcigtLXZpZXdwb3J0LWhlaWdodCwgJHt2aWV3cG9ydEhlaWdodH1weCkgKiAke251bVZhbHVlIC8gMTAwfSlgO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBwcmVmaXggKyBjb252ZXJ0ZWRWYWx1ZSArIHN1ZmZpeDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBtYXRjaDtcbiAgICB9LFxuICApO1xuXG4gIHByb2Nlc3NlZENvbnRlbnQgPSBwcm9jZXNzZWRDb250ZW50LnJlcGxhY2UoL21pbi1oZWlnaHQ6XFxzKihbXjtdKnZoW147XSopOy9nLCBleHByZXNzaW9uID0+IHtcbiAgICBjb25zdCBwcm9jZXNzZWRFeHByZXNzaW9uID0gZXhwcmVzc2lvbi5yZXBsYWNlKC8oXFxkKyg/OlxcLlxcZCspPyl2aC9nLCBudW0gPT4ge1xuICAgICAgY29uc3QgbnVtVmFsdWUgPSBwYXJzZUZsb2F0KG51bSk7XG4gICAgICBpZiAobnVtVmFsdWUgPT09IDEwMCkge1xuICAgICAgICByZXR1cm4gYHZhcigtLXZpZXdwb3J0LWhlaWdodCwgJHt2aWV3cG9ydEhlaWdodH1weClgO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGBjYWxjKHZhcigtLXZpZXdwb3J0LWhlaWdodCwgJHt2aWV3cG9ydEhlaWdodH1weCkgKiAke251bVZhbHVlIC8gMTAwfSlgO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBgJHtwcm9jZXNzZWRFeHByZXNzaW9ufTtgO1xuICB9KTtcblxuICBwcm9jZXNzZWRDb250ZW50ID0gcHJvY2Vzc2VkQ29udGVudC5yZXBsYWNlKFxuICAgIC9zdHlsZVxccyo9XFxzKltcIiddKFteXCInXSptaW4taGVpZ2h0OlxccypbXlwiJ10qdmhbXlwiJ10qPylbXCInXS9naSxcbiAgICAobWF0Y2gsIHN0eWxlQ29udGVudCkgPT4ge1xuICAgICAgY29uc3QgcHJvY2Vzc2VkU3R5bGVDb250ZW50ID0gc3R5bGVDb250ZW50LnJlcGxhY2UoL21pbi1oZWlnaHQ6XFxzKihbXjtdKnZoW147XSopL2csIChleHByZXNzaW9uOiBzdHJpbmcpID0+IHtcbiAgICAgICAgY29uc3QgcHJvY2Vzc2VkRXhwcmVzc2lvbiA9IGV4cHJlc3Npb24ucmVwbGFjZSgvKFxcZCsoPzpcXC5cXGQrKT8pdmgvZywgbnVtID0+IHtcbiAgICAgICAgICBjb25zdCBudW1WYWx1ZSA9IHBhcnNlRmxvYXQobnVtKTtcbiAgICAgICAgICBpZiAobnVtVmFsdWUgPT09IDEwMCkge1xuICAgICAgICAgICAgcmV0dXJuIGB2YXIoLS12aWV3cG9ydC1oZWlnaHQsICR7dmlld3BvcnRIZWlnaHR9cHgpYDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGBjYWxjKHZhcigtLXZpZXdwb3J0LWhlaWdodCwgJHt2aWV3cG9ydEhlaWdodH1weCkgKiAke251bVZhbHVlIC8gMTAwfSlgO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBwcm9jZXNzZWRFeHByZXNzaW9uO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gbWF0Y2gucmVwbGFjZShzdHlsZUNvbnRlbnQsIHByb2Nlc3NlZFN0eWxlQ29udGVudCk7XG4gICAgfSxcbiAgKTtcblxuICByZXR1cm4gcHJvY2Vzc2VkQ29udGVudDtcbn1cblxuLyoqXG4gKiDkvb/nlKjkuoZtaW4taGVpZ2h0OnZo5pe277yM5pu05pawaWZyYW1l55qEdmlld3BvcnTpq5jluqZcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZUlmcmFtZVZpZXdwb3J0SGVpZ2h0KCkge1xuICAkKHdpbmRvdykub24oJ3Jlc2l6ZScsIGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoJCgnaWZyYW1lW2RhdGEtbmVlZHMtdmg9XCJ0cnVlXCJdJykubGVuZ3RoKSB7XG4gICAgICBjb25zdCB2aWV3cG9ydEhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodDtcbiAgICAgICQoJ2lmcmFtZVtkYXRhLW5lZWRzLXZoPVwidHJ1ZVwiXScpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICBjb25zdCBpZnJhbWUgPSB0aGlzIGFzIEhUTUxJRnJhbWVFbGVtZW50O1xuICAgICAgICBpZiAoaWZyYW1lLmNvbnRlbnRXaW5kb3cpIHtcbiAgICAgICAgICBpZnJhbWUuY29udGVudFdpbmRvdy5wb3N0TWVzc2FnZShcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgcmVxdWVzdDogJ3VwZGF0ZVZpZXdwb3J0SGVpZ2h0JyxcbiAgICAgICAgICAgICAgbmV3SGVpZ2h0OiB2aWV3cG9ydEhlaWdodCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAnKicsXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9KTtcbn1cblxuLyoqXG4gKiDojrflj5bmiJbliJvlu7rlhbHkuqvnmoRSZXNpemVPYnNlcnZlcuWunuS+i1xuICovXG5mdW5jdGlvbiBnZXRTaGFyZWRSZXNpemVPYnNlcnZlcigpOiBSZXNpemVPYnNlcnZlciB7XG4gIGlmICghd2luZG93Ll9zaGFyZWRSZXNpemVPYnNlcnZlcikge1xuICAgIHdpbmRvdy5fb2JzZXJ2ZWRFbGVtZW50cyA9IG5ldyBNYXAoKTtcblxuICAgIHdpbmRvdy5fc2hhcmVkUmVzaXplT2JzZXJ2ZXIgPSBuZXcgUmVzaXplT2JzZXJ2ZXIoZW50cmllcyA9PiB7XG4gICAgICBmb3IgKGNvbnN0IGVudHJ5IG9mIGVudHJpZXMpIHtcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IGVudHJ5LnRhcmdldDtcblxuICAgICAgICBjb25zdCBkYXRhID0gd2luZG93Ll9vYnNlcnZlZEVsZW1lbnRzPy5nZXQoZWxlbWVudCBhcyBIVE1MRWxlbWVudCk7XG4gICAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgICAgY29uc3QgeyBpZnJhbWUgfSA9IGRhdGE7XG4gICAgICAgICAgYWRqdXN0SWZyYW1lSGVpZ2h0KGlmcmFtZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiB3aW5kb3cuX3NoYXJlZFJlc2l6ZU9ic2VydmVyO1xufVxuXG4vKipcbiAqIOiwg+aVtGlmcmFtZemrmOW6plxuICogQHBhcmFtIGlmcmFtZSBpZnJhbWXlhYPntKBcbiAqL1xuZnVuY3Rpb24gYWRqdXN0SWZyYW1lSGVpZ2h0KGlmcmFtZTogSFRNTElGcmFtZUVsZW1lbnQpIHtcbiAgY29uc3QgJGlmcmFtZSA9ICQoaWZyYW1lKTtcbiAgaWYgKCEkaWZyYW1lLmxlbmd0aCB8fCAhJGlmcmFtZVswXS5jb250ZW50V2luZG93IHx8ICEkaWZyYW1lWzBdLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQuYm9keSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IGRvYyA9ICRpZnJhbWVbMF0uY29udGVudFdpbmRvdy5kb2N1bWVudDtcblxuICBjb25zdCBib2R5SGVpZ2h0ID0gZG9jLmJvZHkub2Zmc2V0SGVpZ2h0O1xuICBjb25zdCBodG1sSGVpZ2h0ID0gZG9jLmRvY3VtZW50RWxlbWVudC5vZmZzZXRIZWlnaHQ7XG5cbiAgY29uc3QgbmV3SGVpZ2h0ID0gTWF0aC5tYXgoYm9keUhlaWdodCwgaHRtbEhlaWdodCk7XG4gIGNvbnN0IGN1cnJlbnRIZWlnaHQgPSBwYXJzZUZsb2F0KCRpZnJhbWUuY3NzKCdoZWlnaHQnKSkgfHwgMDtcblxuICBpZiAoTWF0aC5hYnMoY3VycmVudEhlaWdodCAtIG5ld0hlaWdodCkgPiA1KSB7XG4gICAgJGlmcmFtZS5jc3MoJ2hlaWdodCcsIG5ld0hlaWdodCArICdweCcpO1xuXG4gICAgaWYgKCRpZnJhbWUuYXR0cignZGF0YS1uZWVkcy12aCcpID09PSAndHJ1ZScgJiYgaWZyYW1lLmNvbnRlbnRXaW5kb3cpIHtcbiAgICAgIGlmcmFtZS5jb250ZW50V2luZG93LnBvc3RNZXNzYWdlKFxuICAgICAgICB7XG4gICAgICAgICAgcmVxdWVzdDogJ3VwZGF0ZVZpZXdwb3J0SGVpZ2h0JyxcbiAgICAgICAgICBuZXdIZWlnaHQ6IHdpbmRvdy5pbm5lckhlaWdodCxcbiAgICAgICAgfSxcbiAgICAgICAgJyonLFxuICAgICAgKTtcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiDop4Llr59pZnJhbWXlhoXlrrnnlKjkuo7oh6rliqjosIPmlbTpq5jluqZcbiAqIEBwYXJhbSBpZnJhbWUgaWZyYW1l5YWD57SgXG4gKi9cbmZ1bmN0aW9uIG9ic2VydmVJZnJhbWVDb250ZW50KGlmcmFtZTogSFRNTElGcmFtZUVsZW1lbnQpIHtcbiAgY29uc3QgJGlmcmFtZSA9ICQoaWZyYW1lKTtcbiAgaWYgKCEkaWZyYW1lLmxlbmd0aCB8fCAhJGlmcmFtZVswXS5jb250ZW50V2luZG93IHx8ICEkaWZyYW1lWzBdLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQuYm9keSkge1xuICAgIHJldHVybjtcbiAgfVxuICB0cnkge1xuICAgIGNvbnN0IGRvY0JvZHkgPSAkaWZyYW1lWzBdLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQuYm9keTtcblxuICAgIGNvbnN0IHJlc2l6ZU9ic2VydmVyID0gZ2V0U2hhcmVkUmVzaXplT2JzZXJ2ZXIoKTtcblxuICAgIGlmICh3aW5kb3cuX29ic2VydmVkRWxlbWVudHMpIHtcbiAgICAgIGZvciAoY29uc3QgW2VsZW1lbnQsIGRhdGFdIG9mIHdpbmRvdy5fb2JzZXJ2ZWRFbGVtZW50cy5lbnRyaWVzKCkpIHtcbiAgICAgICAgaWYgKGRhdGEuaWZyYW1lID09PSBpZnJhbWUpIHtcbiAgICAgICAgICByZXNpemVPYnNlcnZlci51bm9ic2VydmUoZWxlbWVudCk7XG4gICAgICAgICAgd2luZG93Ll9vYnNlcnZlZEVsZW1lbnRzLmRlbGV0ZShlbGVtZW50KTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHdpbmRvdy5fb2JzZXJ2ZWRFbGVtZW50cz8uc2V0KGRvY0JvZHksIHsgaWZyYW1lIH0pO1xuICAgIHJlc2l6ZU9ic2VydmVyLm9ic2VydmUoZG9jQm9keSk7XG5cbiAgICBhZGp1c3RJZnJhbWVIZWlnaHQoaWZyYW1lKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBsb2cuZXJyb3IoJ1tSZW5kZXJdIOiuvue9riBpZnJhbWUg5YaF5a656KeC5a+f5pe25Ye66ZSZOicsIGVycm9yKTtcbiAgfVxufVxuXG4vKipcbiAqIOWkhOeQhuayueeMtOiEmuacrOWFvOWuueaooeW8j+S8oOadpeeahOa2iOaBr1xuICogQHBhcmFtIGV2ZW50IOa2iOaBr+S6i+S7tlxuICovXG5mdW5jdGlvbiBoYW5kbGVUYW1wZXJtb25rZXlNZXNzYWdlcyhldmVudDogTWVzc2FnZUV2ZW50KTogdm9pZCB7XG4gIGlmIChldmVudC5kYXRhLnR5cGUgPT09ICdidXR0b25DbGljaycpIHtcbiAgICBjb25zdCBidXR0b25OYW1lID0gZXZlbnQuZGF0YS5uYW1lO1xuICAgICQoJy5xci0tYnV0dG9uLm1lbnVfYnV0dG9uJykuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoJCh0aGlzKS5maW5kKCcucXItLWJ1dHRvbi1sYWJlbCcpLnRleHQoKS50cmltKCkgPT09IGJ1dHRvbk5hbWUpIHtcbiAgICAgICAgJCh0aGlzKS50cmlnZ2VyKCdjbGljaycpO1xuICAgICAgfVxuICAgIH0pO1xuICB9IGVsc2UgaWYgKGV2ZW50LmRhdGEudHlwZSA9PT0gJ3RleHRJbnB1dCcpIHtcbiAgICBjb25zdCAkc2VuZFRleHRhcmVhID0galF1ZXJ5KCcjc2VuZF90ZXh0YXJlYScpO1xuICAgIGlmICgkc2VuZFRleHRhcmVhLmxlbmd0aCkge1xuICAgICAgJHNlbmRUZXh0YXJlYS52YWwoZXZlbnQuZGF0YS50ZXh0KS50cmlnZ2VyKCdpbnB1dCcpLnRyaWdnZXIoJ2NoYW5nZScpO1xuICAgIH1cbiAgfSBlbHNlIGlmIChldmVudC5kYXRhLnR5cGUgPT09ICdzZW5kQ2xpY2snKSB7XG4gICAgY29uc3QgJHNlbmRCdXR0b24gPSBqUXVlcnkoJyNzZW5kX2J1dCcpO1xuICAgIGlmICgkc2VuZEJ1dHRvbi5sZW5ndGgpIHtcbiAgICAgICRzZW5kQnV0dG9uLnRyaWdnZXIoJ2NsaWNrJyk7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICog5rK554y05YW85a655qih5byPLeWIm+W7uuWFqOWxgOmfs+mikeeuoeeQhuWZqFxuICovXG5mdW5jdGlvbiBjcmVhdGVHbG9iYWxBdWRpb01hbmFnZXIoKSB7XG4gIGxldCBjdXJyZW50UGxheWluZ0lmcmFtZUlkOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcblxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZ1bmN0aW9uIChldmVudCkge1xuICAgIGlmIChldmVudC5kYXRhLnR5cGUgPT09ICdhdWRpb1BsYXknKSB7XG4gICAgICBjb25zdCBuZXdJZnJhbWVJZCA9IGV2ZW50LmRhdGEuaWZyYW1lSWQ7XG5cbiAgICAgIGlmIChjdXJyZW50UGxheWluZ0lmcmFtZUlkICYmIGN1cnJlbnRQbGF5aW5nSWZyYW1lSWQgIT09IG5ld0lmcmFtZUlkKSB7XG4gICAgICAgICQoJ2lmcmFtZScpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGNvbnN0IGlmcmFtZSA9IHRoaXMgYXMgSFRNTElGcmFtZUVsZW1lbnQ7XG4gICAgICAgICAgaWYgKGlmcmFtZS5jb250ZW50V2luZG93KSB7XG4gICAgICAgICAgICBpZnJhbWUuY29udGVudFdpbmRvdy5wb3N0TWVzc2FnZShcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdzdG9wQXVkaW8nLFxuICAgICAgICAgICAgICAgIGlmcmFtZUlkOiBuZXdJZnJhbWVJZCxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgJyonLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBjdXJyZW50UGxheWluZ0lmcmFtZUlkID0gbmV3SWZyYW1lSWQ7XG4gICAgfVxuICB9KTtcbn1cblxuLyoqXG4gKiDlpITnkIbmsrnnjLTlhbzlrrnmgKforr7nva7mlLnlj5hcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZVRhbXBlcm1vbmtleUNvbXBhdGliaWxpdHlDaGFuZ2UoZW5hYmxlOiBib29sZWFuLCB1c2VySW5wdXQ6IGJvb2xlYW4gPSB0cnVlKSB7XG4gIGlmICh1c2VySW5wdXQpIHtcbiAgICBzYXZlU2V0dGluZ1ZhbHVlKCdyZW5kZXIudGFtcGVybW9ua2V5X2NvbXBhdGliaWxpdHknLCBlbmFibGUpO1xuICB9XG5cbiAgaWYgKCFnZXRTZXR0aW5nVmFsdWUoJ2VuYWJsZWRfZXh0ZW5zaW9uJykpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoZW5hYmxlKSB7XG4gICAgaWYgKCF0YW1wZXJtb25rZXlNZXNzYWdlTGlzdGVuZXIpIHtcbiAgICAgIHRhbXBlcm1vbmtleU1lc3NhZ2VMaXN0ZW5lciA9IGhhbmRsZVRhbXBlcm1vbmtleU1lc3NhZ2VzO1xuICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCB0YW1wZXJtb25rZXlNZXNzYWdlTGlzdGVuZXIpO1xuICAgICAgY3JlYXRlR2xvYmFsQXVkaW9NYW5hZ2VyKCk7XG4gICAgfVxuICB9IGVsc2UgaWYgKHRhbXBlcm1vbmtleU1lc3NhZ2VMaXN0ZW5lcikge1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdGFtcGVybW9ua2V5TWVzc2FnZUxpc3RlbmVyKTtcbiAgICB0YW1wZXJtb25rZXlNZXNzYWdlTGlzdGVuZXIgPSBudWxsO1xuICB9XG5cbiAgYXdhaXQgY2xlYXJBbmRSZW5kZXJBbGxJZnJhbWVzKCk7XG59XG5cbi8vIOaJqeWxlVdpbmRvd+aOpeWPo+WumuS5iVxuZGVjbGFyZSBnbG9iYWwge1xuICBpbnRlcmZhY2UgV2luZG93IHtcbiAgICBfc2hhcmVkUmVzaXplT2JzZXJ2ZXI/OiBSZXNpemVPYnNlcnZlcjtcbiAgICBfb2JzZXJ2ZWRFbGVtZW50cz86IE1hcDxIVE1MRWxlbWVudCwgeyBpZnJhbWU6IEhUTUxJRnJhbWVFbGVtZW50IH0+O1xuICAgIGdjPzogKCkgPT4gdm9pZDtcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgcGFydGlhbFJlbmRlckV2ZW50cyA9IFtcbiAgZXZlbnRfdHlwZXMuQ0hBUkFDVEVSX01FU1NBR0VfUkVOREVSRUQsXG4gIGV2ZW50X3R5cGVzLlVTRVJfTUVTU0FHRV9SRU5ERVJFRCxcbiAgZXZlbnRfdHlwZXMuTUVTU0FHRV9VUERBVEVELFxuICBldmVudF90eXBlcy5NRVNTQUdFX1NXSVBFRCxcbl07XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYW5kbGVSZW5kZXJUb2dnbGUodXNlcklucHV0OiBib29sZWFuID0gdHJ1ZSwgZW5hYmxlOiBib29sZWFuID0gdHJ1ZSkge1xuICBpZiAoZW5hYmxlKSB7XG4gICAgcmVuZGVyTWVzc2FnZXNJbklmcmFtZXMoUkVOREVSX01PREVTLkZVTEwpO1xuICB9XG4gIGlmICh1c2VySW5wdXQpIHtcbiAgICBzYXZlU2V0dGluZ1ZhbHVlKCdyZW5kZXIucmVuZGVyX2VuYWJsZWQnLCBlbmFibGUpO1xuICB9XG59XG5cbi8qKlxuICog5riF55CG5ZCO77yM6YeN5paw5riy5p+T5omA5pyJaWZyYW1lXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjbGVhckFuZFJlbmRlckFsbElmcmFtZXMoKSB7XG4gIGF3YWl0IGNsZWFyQWxsSWZyYW1lcygpO1xuICBpZiAodGhpc19jaGlkICE9PSB1bmRlZmluZWQpIHtcbiAgICBhd2FpdCByZWxvYWRDdXJyZW50Q2hhdCgpO1xuICAgIGF3YWl0IHJlbmRlckFsbElmcmFtZXMoKTtcbiAgfVxufVxuXG4vKipcbiAqIOa4suafk+aJgOaciWlmcmFtZVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVuZGVyQWxsSWZyYW1lcygpIHtcbiAgYXdhaXQgcmVuZGVyTWVzc2FnZXNJbklmcmFtZXMoUkVOREVSX01PREVTLkZVTEwpO1xuICBsb2cuaW5mbygnW1JlbmRlcl0g5riy5p+T5omA5pyJaWZyYW1lJyk7XG59XG5cbi8qKlxuICog5riy5p+T6YOo5YiGaWZyYW1lXG4gKiBAcGFyYW0gbWVzSWQg5raI5oGvSURcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbmRlclBhcnRpYWxJZnJhbWVzKG1lc0lkOiBudW1iZXIpIHtcbiAgY29uc3QgcHJvY2Vzc0RlcHRoID0gcGFyc2VJbnQoJCgnI3JlbmRlci1kZXB0aCcpLnZhbCgpIGFzIHN0cmluZywgMTApO1xuICBjb25zdCBjb250ZXh0ID0gZ2V0Q29udGV4dCgpO1xuICBjb25zdCB0b3RhbE1lc3NhZ2VzID0gY29udGV4dC5jaGF0Lmxlbmd0aDtcblxuICBpZiAocHJvY2Vzc0RlcHRoID4gMCkge1xuICAgIGNvbnN0IGRlcHRoT2Zmc2V0ID0gdG90YWxNZXNzYWdlcyAtIHByb2Nlc3NEZXB0aDtcblxuICAgIGlmIChtZXNJZCA8IGRlcHRoT2Zmc2V0KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9XG5cbiAgYXdhaXQgcmVuZGVyTWVzc2FnZXNJbklmcmFtZXMoUkVOREVSX01PREVTLlBBUlRJQUwsIG1lc0lkKTtcblxuICBsb2cuaW5mbygnW1JlbmRlcl0g5riy5p+TJyArIG1lc0lkICsgJ+WPt+a2iOaBr+eahGlmcmFtZScpO1xufVxuXG4vKipcbiAqIOmUgOavgWlmcmFtZVxuICogQHBhcmFtIGlmcmFtZSBpZnJhbWXlhYPntKBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRlc3Ryb3lJZnJhbWUoaWZyYW1lOiBIVE1MSUZyYW1lRWxlbWVudCk6IHZvaWQge1xuICBjb25zdCAkaWZyYW1lID0gJChpZnJhbWUpO1xuICBpZiAoISRpZnJhbWUubGVuZ3RoKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8g5aaC5p6c5pyJUmVzaXplT2JzZXJ2ZXLlrp7kvovlkozlt7Lop4Llr5/lhYPntKDnmoTorrDlvZVcbiAgaWYgKHdpbmRvdy5fc2hhcmVkUmVzaXplT2JzZXJ2ZXIgJiYgd2luZG93Ll9vYnNlcnZlZEVsZW1lbnRzKSB7XG4gICAgZm9yIChjb25zdCBbZWxlbWVudCwgZGF0YV0gb2Ygd2luZG93Ll9vYnNlcnZlZEVsZW1lbnRzLmVudHJpZXMoKSkge1xuICAgICAgaWYgKGRhdGEuaWZyYW1lID09PSBpZnJhbWUpIHtcbiAgICAgICAgd2luZG93Ll9zaGFyZWRSZXNpemVPYnNlcnZlci51bm9ic2VydmUoZWxlbWVudCk7XG4gICAgICAgIHdpbmRvdy5fb2JzZXJ2ZWRFbGVtZW50cy5kZWxldGUoZWxlbWVudCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gICRpZnJhbWUudHJpZ2dlcigndW5sb2FkJykucmVtb3ZlKCk7XG5cbiAgaWYgKHdpbmRvdy5fb2JzZXJ2ZWRFbGVtZW50cz8uc2l6ZSA9PT0gMCAmJiB3aW5kb3cuX3NoYXJlZFJlc2l6ZU9ic2VydmVyKSB7XG4gICAgd2luZG93Ll9zaGFyZWRSZXNpemVPYnNlcnZlci5kaXNjb25uZWN0KCk7XG4gICAgd2luZG93Ll9zaGFyZWRSZXNpemVPYnNlcnZlciA9IHVuZGVmaW5lZDtcbiAgICBsb2cuaW5mbygnW1JlbmRlcl0g5omA5pyJaWZyYW1l5bey56e76Zmk77yM5YGc5q2i6KeC5a+fJyk7XG4gIH1cbn1cblxuLyoqXG4gKiDmuIXnkIbmiYDmnIlpZnJhbWVcbiAqIEByZXR1cm5zIHtQcm9taXNlPHZvaWQ+fVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2xlYXJBbGxJZnJhbWVzKCk6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCAkaWZyYW1lcyA9ICQoJ2lmcmFtZVtpZF49XCJtZXNzYWdlLWlmcmFtZVwiXScpIGFzIEpRdWVyeTxIVE1MSUZyYW1lRWxlbWVudD47XG4gICRpZnJhbWVzLmVhY2goZnVuY3Rpb24gKCkge1xuICAgIGRlc3Ryb3lJZnJhbWUodGhpcyk7XG4gIH0pO1xufVxuXG4vKipcbiAqIOiuvue9rmlmcmFtZeenu+mZpOebkeWQrOWZqFxuICogQHJldHVybnMge011dGF0aW9uT2JzZXJ2ZXJ9IOinguWvn+WZqOWunuS+i1xuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0dXBJZnJhbWVSZW1vdmFsTGlzdGVuZXIoKTogTXV0YXRpb25PYnNlcnZlciB7XG4gIGNvbnN0IG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIobXV0YXRpb25zID0+IHtcbiAgICBtdXRhdGlvbnMuZm9yRWFjaChtdXRhdGlvbiA9PiB7XG4gICAgICBpZiAobXV0YXRpb24ucmVtb3ZlZE5vZGVzLmxlbmd0aCkge1xuICAgICAgICBtdXRhdGlvbi5yZW1vdmVkTm9kZXMuZm9yRWFjaChub2RlID0+IHtcbiAgICAgICAgICBpZiAobm9kZSBpbnN0YW5jZW9mIEhUTUxJRnJhbWVFbGVtZW50KSB7XG4gICAgICAgICAgICBkZXN0cm95SWZyYW1lKG5vZGUpO1xuICAgICAgICAgIH0gZWxzZSBpZiAobm9kZSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XG4gICAgICAgICAgICBjb25zdCBpZnJhbWVzID0gbm9kZS5xdWVyeVNlbGVjdG9yQWxsKCdpZnJhbWUnKTtcbiAgICAgICAgICAgIGlmIChpZnJhbWVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICBpZnJhbWVzLmZvckVhY2goaWZyYW1lID0+IHtcbiAgICAgICAgICAgICAgICBkZXN0cm95SWZyYW1lKGlmcmFtZSk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuXG4gIG9ic2VydmVyLm9ic2VydmUoZG9jdW1lbnQuYm9keSwgeyBjaGlsZExpc3Q6IHRydWUsIHN1YnRyZWU6IHRydWUgfSk7XG4gIHJldHVybiBvYnNlcnZlcjtcbn1cblxuLyoqXG4gKiDliKDpmaTmtojmga/lkI7ph43mlrDmuLLmn5NcbiAqIEBwYXJhbSBtZXNJZCDmtojmga9JRFxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVuZGVyTWVzc2FnZUFmdGVyRGVsZXRlKG1lc0lkOiBudW1iZXIpIHtcbiAgY29uc3QgY29udGV4dCA9IGdldENvbnRleHQoKTtcbiAgY29uc3QgcHJvY2Vzc0RlcHRoID0gcGFyc2VJbnQoJCgnI3JlbmRlci1kZXB0aCcpLnZhbCgpIGFzIHN0cmluZywgMTApO1xuICBjb25zdCB0b3RhbE1lc3NhZ2VzID0gY29udGV4dC5jaGF0Lmxlbmd0aDtcbiAgY29uc3QgbWF4UmVtYWluSWQgPSBtZXNJZCAtIDE7XG5cbiAgY29uc3QgZ2V0TWVzc2FnZSA9IChpZDogbnVtYmVyKSA9PiB7XG4gICAgY29uc3QgbWVzc2FnZSA9IGNvbnRleHQuY2hhdFtpZF0gPz8ge307XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH07XG5cbiAgY29uc3QgZ2V0SWZyYW1lID0gKGlkOiBudW1iZXIpID0+IHtcbiAgICBjb25zdCAkaWZyYW1lID0gJCgnW2lkXj1cIm1lc3NhZ2UtaWZyYW1lLScgKyBpZCArICctXCJdJyk7XG4gICAgcmV0dXJuICRpZnJhbWUubGVuZ3RoID4gMCA/ICgkaWZyYW1lLmdldCgwKSBhcyBIVE1MSUZyYW1lRWxlbWVudCkgOiBudWxsO1xuICB9O1xuXG4gIGNvbnN0IGNoZWNrQ29kZUJsb2NrID0gKG1lc3NhZ2U6IGFueSkgPT4ge1xuICAgIHJldHVybiAvYGBgW1xcc1xcU10qP2BgYC8udGVzdChtZXNzYWdlLm1lcyk7XG4gIH07XG4gIC8vIOiAg+iZkeWIsOmrmOalvOWxgueahOaDheWGte+8jOa3seW6puS4ujDml7bvvIzlj6rmuLLmn5PmnIDlkI7kuIDkuKrmtojmga9cbiAgaWYgKHByb2Nlc3NEZXB0aCA9PT0gMCkge1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBnZXRNZXNzYWdlKG1heFJlbWFpbklkKTtcbiAgICBjb25zdCBoYXNDb2RlQmxvY2sgPSBjaGVja0NvZGVCbG9jayhtZXNzYWdlKTtcbiAgICBjb25zdCBpZnJhbWUgPSBnZXRJZnJhbWUobWF4UmVtYWluSWQpO1xuXG4gICAgaWYgKCFoYXNDb2RlQmxvY2sgJiYgIWlmcmFtZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBkZXN0cm95SWZyYW1lKGlmcmFtZSBhcyBIVE1MSUZyYW1lRWxlbWVudCk7XG4gICAgdXBkYXRlTWVzc2FnZUJsb2NrKG1heFJlbWFpbklkLCBtZXNzYWdlKTtcbiAgICByZW5kZXJQYXJ0aWFsSWZyYW1lcyhtYXhSZW1haW5JZCk7XG4gIH0gZWxzZSB7XG4gICAgbGV0IHN0YXJ0UmVuZGVySW5kZXggPSB0b3RhbE1lc3NhZ2VzIC0gcHJvY2Vzc0RlcHRoO1xuICAgIGlmIChzdGFydFJlbmRlckluZGV4IDwgMCkge1xuICAgICAgc3RhcnRSZW5kZXJJbmRleCA9IDA7XG4gICAgfVxuXG4gICAgZm9yIChsZXQgaSA9IHN0YXJ0UmVuZGVySW5kZXg7IGkgPD0gbWF4UmVtYWluSWQ7IGkrKykge1xuICAgICAgY29uc3QgbWVzc2FnZSA9IGdldE1lc3NhZ2UoaSk7XG4gICAgICBjb25zdCBoYXNDb2RlQmxvY2sgPSBjaGVja0NvZGVCbG9jayhtZXNzYWdlKTtcbiAgICAgIGNvbnN0IGlmcmFtZSA9IGdldElmcmFtZShpKTtcblxuICAgICAgaWYgKCFoYXNDb2RlQmxvY2sgJiYgIWlmcmFtZSkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIGRlc3Ryb3lJZnJhbWUoaWZyYW1lIGFzIEhUTUxJRnJhbWVFbGVtZW50KTtcbiAgICAgIHVwZGF0ZU1lc3NhZ2VCbG9jayhpLCBtZXNzYWdlKTtcbiAgICAgIHJlbmRlclBhcnRpYWxJZnJhbWVzKGkpO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgY29uc3QgaGFuZGxlUGFydGlhbFJlbmRlciA9IChtZXNJZDogbnVtYmVyKSA9PiB7XG4gIGxvZy5pbmZvKCdbUmVuZGVyXSDop6blj5HlsYDpg6jmuLLmn5PvvIzmtojmga9JRDonLCBtZXNJZCk7XG4gIGNvbnN0IHByb2Nlc3NEZXB0aCA9IHBhcnNlSW50KCQoJyNyZW5kZXItZGVwdGgnKS52YWwoKSBhcyBzdHJpbmcsIDEwKTtcbiAgY29uc3QgY29udGV4dCA9IGdldENvbnRleHQoKTtcbiAgY29uc3QgdG90YWxNZXNzYWdlcyA9IGNvbnRleHQuY2hhdC5sZW5ndGg7XG5cbiAgaWYgKHByb2Nlc3NEZXB0aCA+IDApIHtcbiAgICBjb25zdCBkZXB0aE9mZnNldCA9IHRvdGFsTWVzc2FnZXMgLSBwcm9jZXNzRGVwdGg7XG5cbiAgICBpZiAobWVzSWQgPCBkZXB0aE9mZnNldCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgfVxuXG4gIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgIHJlbmRlck1lc3NhZ2VzSW5JZnJhbWVzKFJFTkRFUl9NT0RFUy5QQVJUSUFMLCBtZXNJZCk7XG4gIH0sIDEwMCk7XG59O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/component/message_iframe/render_message.ts\n\n}")},"./src/component/message_iframe/render_optimize.ts":
/*!*********************************************************!*\
  !*** ./src/component/message_iframe/render_optimize.ts ***!
  \*********************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addRenderingOptimizeSettings: () => (/* binding */ addRenderingOptimizeSettings),\n/* harmony export */   removeRenderingOptimizeSettings: () => (/* binding */ removeRenderingOptimizeSettings)\n/* harmony export */ });\n// 保存原始高亮方法\nconst originalHighlightElement = hljs.highlightElement;\n/**\n * 添加前端卡渲染优化设置\n */\nfunction addRenderingOptimizeSettings() {\n    hljs.highlightElement = function () {\n        return;\n    };\n}\n/**\n * 移除前端卡渲染优化设置\n */\nfunction removeRenderingOptimizeSettings() {\n    hljs.highlightElement = originalHighlightElement;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L21lc3NhZ2VfaWZyYW1lL3JlbmRlcl9vcHRpbWl6ZS50cyIsIm1hcHBpbmdzIjoiOzs7OztBQUFBLFdBQVc7QUFDWCxNQUFNLHdCQUF3QixHQUFHLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQztBQUV2RDs7R0FFRztBQUNJLFNBQVMsNEJBQTRCO0lBQzFDLElBQUksQ0FBQyxnQkFBZ0IsR0FBRztRQUN0QixPQUFPO0lBQ1QsQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQUVEOztHQUVHO0FBQ0ksU0FBUywrQkFBK0I7SUFDN0MsSUFBSSxDQUFDLGdCQUFnQixHQUFHLHdCQUF3QixDQUFDO0FBQ25ELENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvY29tcG9uZW50L21lc3NhZ2VfaWZyYW1lL3JlbmRlcl9vcHRpbWl6ZS50cz9jMjExIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIOS/neWtmOWOn+Wni+mrmOS6ruaWueazlVxuY29uc3Qgb3JpZ2luYWxIaWdobGlnaHRFbGVtZW50ID0gaGxqcy5oaWdobGlnaHRFbGVtZW50O1xuXG4vKipcbiAqIOa3u+WKoOWJjeerr+WNoea4suafk+S8mOWMluiuvue9rlxuICovXG5leHBvcnQgZnVuY3Rpb24gYWRkUmVuZGVyaW5nT3B0aW1pemVTZXR0aW5ncygpIHtcbiAgaGxqcy5oaWdobGlnaHRFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybjtcbiAgfTtcbn1cblxuLyoqXG4gKiDnp7vpmaTliY3nq6/ljaHmuLLmn5PkvJjljJborr7nva5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZVJlbmRlcmluZ09wdGltaXplU2V0dGluZ3MoKSB7XG4gIGhsanMuaGlnaGxpZ2h0RWxlbWVudCA9IG9yaWdpbmFsSGlnaGxpZ2h0RWxlbWVudDtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/component/message_iframe/render_optimize.ts\n\n}")},"./src/component/message_iframe/utils.ts":
/*!***********************************************!*\
  !*** ./src/component/message_iframe/utils.ts ***!
  \***********************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   extractTextFromCode: () => (/* binding */ extractTextFromCode)\n/* harmony export */ });\n/**\n * 提取代码块中的文本\n * @param codeElement 代码块元素\n * @returns 提取的文本\n */\nfunction extractTextFromCode(codeElement) {\n    let textContent = '';\n    $(codeElement)\n        .contents()\n        .each(function () {\n        if (this.nodeType === Node.TEXT_NODE) {\n            textContent += this.textContent;\n        }\n        else if (this.nodeType === Node.ELEMENT_NODE) {\n            textContent += extractTextFromCode(this);\n        }\n    });\n    return textContent;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L21lc3NhZ2VfaWZyYW1lL3V0aWxzLnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTs7OztHQUlHO0FBQ0ksU0FBUyxtQkFBbUIsQ0FBQyxXQUF3QjtJQUMxRCxJQUFJLFdBQVcsR0FBRyxFQUFFLENBQUM7SUFFckIsQ0FBQyxDQUFDLFdBQVcsQ0FBQztTQUNYLFFBQVEsRUFBRTtTQUNWLElBQUksQ0FBQztRQUNKLElBQUksSUFBSSxDQUFDLFFBQVEsS0FBSyxJQUFJLENBQUMsU0FBUyxFQUFFLENBQUM7WUFDckMsV0FBVyxJQUFJLElBQUksQ0FBQyxXQUFXLENBQUM7UUFDbEMsQ0FBQzthQUFNLElBQUksSUFBSSxDQUFDLFFBQVEsS0FBSyxJQUFJLENBQUMsWUFBWSxFQUFFLENBQUM7WUFDL0MsV0FBVyxJQUFJLG1CQUFtQixDQUFDLElBQW1CLENBQUMsQ0FBQztRQUMxRCxDQUFDO0lBQ0gsQ0FBQyxDQUFDLENBQUM7SUFFTCxPQUFPLFdBQVcsQ0FBQztBQUNyQixDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBvbmVudC9tZXNzYWdlX2lmcmFtZS91dGlscy50cz81NTQ1Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICog5o+Q5Y+W5Luj56CB5Z2X5Lit55qE5paH5pysXG4gKiBAcGFyYW0gY29kZUVsZW1lbnQg5Luj56CB5Z2X5YWD57SgXG4gKiBAcmV0dXJucyDmj5Dlj5bnmoTmlofmnKxcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGV4dHJhY3RUZXh0RnJvbUNvZGUoY29kZUVsZW1lbnQ6IEhUTUxFbGVtZW50KSB7XG4gIGxldCB0ZXh0Q29udGVudCA9ICcnO1xuXG4gICQoY29kZUVsZW1lbnQpXG4gICAgLmNvbnRlbnRzKClcbiAgICAuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAodGhpcy5ub2RlVHlwZSA9PT0gTm9kZS5URVhUX05PREUpIHtcbiAgICAgICAgdGV4dENvbnRlbnQgKz0gdGhpcy50ZXh0Q29udGVudDtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5ub2RlVHlwZSA9PT0gTm9kZS5FTEVNRU5UX05PREUpIHtcbiAgICAgICAgdGV4dENvbnRlbnQgKz0gZXh0cmFjdFRleHRGcm9tQ29kZSh0aGlzIGFzIEhUTUxFbGVtZW50KTtcbiAgICAgIH1cbiAgICB9KTtcblxuICByZXR1cm4gdGV4dENvbnRlbnQ7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/component/message_iframe/utils.ts\n\n}")},"./src/component/prompt_view/index.ts":
/*!********************************************!*\
  !*** ./src/component/prompt_view/index.ts ***!
  \********************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addPromptViewQuickButton: () => (/* binding */ addPromptViewQuickButton),\n/* harmony export */   initPromptView: () => (/* binding */ initPromptView)\n/* harmony export */ });\n/* harmony import */ var _component_prompt_view_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/prompt_view/service */ \"./src/component/prompt_view/service.ts\");\n/* harmony import */ var _component_prompt_view_view__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/component/prompt_view/view */ \"./src/component/prompt_view/view.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n\n\n\n/**\n * 添加变量管理快速按钮\n */\nfunction addPromptViewQuickButton() {\n    const buttonHtml = $(`\n  <div id=\"tavern-helper-prompt-view-container\" class=\"list-group-item flex-container flexGap5 interactable tavern-helper-shortcut-item\">\n      <div class=\"fa-solid fa-magnifying-glass extensionsMenuExtensionButton\" /></div>\n      <span id=\"tavern-helper-variable-text\">提示词查看器</span>\n  </div>`);\n    buttonHtml.css('display', 'flex');\n    if ($('#tavern-helper-prompt-view-container').length === 0) {\n        $('#extensionsMenu').append(buttonHtml);\n    }\n    $('#tavern-helper-prompt-view-container')\n        .off('click')\n        .on('click', async function () {\n        await (0,_component_prompt_view_view__WEBPACK_IMPORTED_MODULE_1__.openPromptViewDialog)();\n    });\n}\n/**\n * 初始化提示词查看器\n */\nasync function initPromptView() {\n    const $button = $('#open-prompt-view');\n    if ($button.length) {\n        $button.off('click').on('click', async () => {\n            await (0,_component_prompt_view_view__WEBPACK_IMPORTED_MODULE_1__.openPromptViewDialog)();\n        });\n    }\n}\n/**\n * 页面卸载时清理所有事件监听器\n */\n$(window).on('unload', () => {\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.eventSource.removeListener(_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.event_types.CHAT_COMPLETION_PROMPT_READY, _component_prompt_view_service__WEBPACK_IMPORTED_MODULE_0__.onChatCompletionPromptReady);\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3Byb21wdF92aWV3L2luZGV4LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQThFO0FBQ1Y7QUFDTDtBQUUvRDs7R0FFRztBQUNJLFNBQVMsd0JBQXdCO0lBQ3RDLE1BQU0sVUFBVSxHQUFHLENBQUMsQ0FBQzs7OztTQUlkLENBQUMsQ0FBQztJQUNULFVBQVUsQ0FBQyxHQUFHLENBQUMsU0FBUyxFQUFFLE1BQU0sQ0FBQyxDQUFDO0lBQ2xDLElBQUksQ0FBQyxDQUFDLHNDQUFzQyxDQUFDLENBQUMsTUFBTSxLQUFLLENBQUMsRUFBRSxDQUFDO1FBQzNELENBQUMsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUMxQyxDQUFDO0lBQ0QsQ0FBQyxDQUFDLHNDQUFzQyxDQUFDO1NBQ3RDLEdBQUcsQ0FBQyxPQUFPLENBQUM7U0FDWixFQUFFLENBQUMsT0FBTyxFQUFFLEtBQUs7UUFDaEIsTUFBTSxpRkFBb0IsRUFBRSxDQUFDO0lBQy9CLENBQUMsQ0FBQyxDQUFDO0FBQ1AsQ0FBQztBQUVEOztHQUVHO0FBQ0ksS0FBSyxVQUFVLGNBQWM7SUFDbEMsTUFBTSxPQUFPLEdBQUcsQ0FBQyxDQUFDLG1CQUFtQixDQUFDLENBQUM7SUFDdkMsSUFBSSxPQUFPLENBQUMsTUFBTSxFQUFFLENBQUM7UUFDbkIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQyxFQUFFLENBQUMsT0FBTyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzFDLE1BQU0saUZBQW9CLEVBQUUsQ0FBQztRQUMvQixDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7QUFDSCxDQUFDO0FBRUQ7O0dBRUc7QUFDSCxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxDQUFDLFFBQVEsRUFBRSxHQUFHLEVBQUU7SUFDMUIsNERBQVcsQ0FBQyxjQUFjLENBQUMsNERBQVcsQ0FBQyw0QkFBNEIsRUFBRSx1RkFBMkIsQ0FBQyxDQUFDO0FBQ3BHLENBQUMsQ0FBQyxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBvbmVudC9wcm9tcHRfdmlldy9pbmRleC50cz9jYTNkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IG9uQ2hhdENvbXBsZXRpb25Qcm9tcHRSZWFkeSB9IGZyb20gJ0AvY29tcG9uZW50L3Byb21wdF92aWV3L3NlcnZpY2UnO1xuaW1wb3J0IHsgb3BlblByb21wdFZpZXdEaWFsb2cgfSBmcm9tICdAL2NvbXBvbmVudC9wcm9tcHRfdmlldy92aWV3JztcbmltcG9ydCB7IGV2ZW50U291cmNlLCBldmVudF90eXBlcyB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHQnO1xuXG4vKipcbiAqIOa3u+WKoOWPmOmHj+euoeeQhuW/q+mAn+aMiemSrlxuICovXG5leHBvcnQgZnVuY3Rpb24gYWRkUHJvbXB0Vmlld1F1aWNrQnV0dG9uKCkge1xuICBjb25zdCBidXR0b25IdG1sID0gJChgXG4gIDxkaXYgaWQ9XCJ0YXZlcm4taGVscGVyLXByb21wdC12aWV3LWNvbnRhaW5lclwiIGNsYXNzPVwibGlzdC1ncm91cC1pdGVtIGZsZXgtY29udGFpbmVyIGZsZXhHYXA1IGludGVyYWN0YWJsZSB0YXZlcm4taGVscGVyLXNob3J0Y3V0LWl0ZW1cIj5cbiAgICAgIDxkaXYgY2xhc3M9XCJmYS1zb2xpZCBmYS1tYWduaWZ5aW5nLWdsYXNzIGV4dGVuc2lvbnNNZW51RXh0ZW5zaW9uQnV0dG9uXCIgLz48L2Rpdj5cbiAgICAgIDxzcGFuIGlkPVwidGF2ZXJuLWhlbHBlci12YXJpYWJsZS10ZXh0XCI+5o+Q56S66K+N5p+l55yL5ZmoPC9zcGFuPlxuICA8L2Rpdj5gKTtcbiAgYnV0dG9uSHRtbC5jc3MoJ2Rpc3BsYXknLCAnZmxleCcpO1xuICBpZiAoJCgnI3RhdmVybi1oZWxwZXItcHJvbXB0LXZpZXctY29udGFpbmVyJykubGVuZ3RoID09PSAwKSB7XG4gICAgJCgnI2V4dGVuc2lvbnNNZW51JykuYXBwZW5kKGJ1dHRvbkh0bWwpO1xuICB9XG4gICQoJyN0YXZlcm4taGVscGVyLXByb21wdC12aWV3LWNvbnRhaW5lcicpXG4gICAgLm9mZignY2xpY2snKVxuICAgIC5vbignY2xpY2snLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBhd2FpdCBvcGVuUHJvbXB0Vmlld0RpYWxvZygpO1xuICAgIH0pO1xufVxuXG4vKipcbiAqIOWIneWni+WMluaPkOekuuivjeafpeeci+WZqFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaW5pdFByb21wdFZpZXcoKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0ICRidXR0b24gPSAkKCcjb3Blbi1wcm9tcHQtdmlldycpO1xuICBpZiAoJGJ1dHRvbi5sZW5ndGgpIHtcbiAgICAkYnV0dG9uLm9mZignY2xpY2snKS5vbignY2xpY2snLCBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBvcGVuUHJvbXB0Vmlld0RpYWxvZygpO1xuICAgIH0pO1xuICB9XG59XG5cbi8qKlxuICog6aG16Z2i5Y246L295pe25riF55CG5omA5pyJ5LqL5Lu255uR5ZCs5ZmoXG4gKi9cbiQod2luZG93KS5vbigndW5sb2FkJywgKCkgPT4ge1xuICBldmVudFNvdXJjZS5yZW1vdmVMaXN0ZW5lcihldmVudF90eXBlcy5DSEFUX0NPTVBMRVRJT05fUFJPTVBUX1JFQURZLCBvbkNoYXRDb21wbGV0aW9uUHJvbXB0UmVhZHkpO1xufSk7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/component/prompt_view/index.ts\n\n}")},"./src/component/prompt_view/service.ts":
/*!**********************************************!*\
  !*** ./src/component/prompt_view/service.ts ***!
  \**********************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   onChatCompletionPromptReady: () => (/* binding */ onChatCompletionPromptReady),\n/* harmony export */   refreshPromptView: () => (/* binding */ refreshPromptView),\n/* harmony export */   setPromptViewUpdater: () => (/* binding */ setPromptViewUpdater)\n/* harmony export */ });\n/* harmony import */ var _component_prompt_view_view__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/prompt_view/view */ \"./src/component/prompt_view/view.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/scripts/openai */ \"@sillytavern/scripts/openai\");\n/* harmony import */ var _sillytavern_scripts_tokenizers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sillytavern/scripts/tokenizers */ \"@sillytavern/scripts/tokenizers\");\n\n\n\n\n\nlet promptViewUpdater = null;\nlet isRefreshPromptViewCall = false;\n/**\n * 设置提示词查看器更新函数\n * @param updater 更新函数\n */\nfunction setPromptViewUpdater(updater) {\n    promptViewUpdater = updater;\n}\n/**\n * 检查当前API是否为 Chat Completion 类型\n * @returns {boolean} 如果 mainApi 在 chat_completion_sources 的值中则返回 true\n */\nfunction isChatCompletion() {\n    const mainApi = (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.getContext)().mainApi;\n    return typeof mainApi === 'string' && Object.values(_sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__.chat_completion_sources).includes(mainApi);\n}\n/**\n * 更新提示词查看器\n * @param data 聊天数据\n */\nfunction onChatCompletionPromptReady(data) {\n    if (data.dryRun) {\n        return;\n    }\n    if (!isChatCompletion()) {\n        toastr.error('当前 API 不是聊天补全类型, 无法使用提示词查看器功能', '不支持的 API 类型');\n        return;\n    }\n    if (isRefreshPromptViewCall) {\n        (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.stopGeneration)();\n        isRefreshPromptViewCall = false;\n    }\n    setTimeout(async () => {\n        if (!promptViewUpdater) {\n            return;\n        }\n        const prompts = await Promise.all(data.chat.map(async ({ role, content }) => {\n            return {\n                role,\n                content: content,\n                token: await (0,_sillytavern_scripts_tokenizers__WEBPACK_IMPORTED_MODULE_4__.getTokenCountAsync)(content),\n            };\n        }));\n        const totalTokens = await (0,_sillytavern_scripts_tokenizers__WEBPACK_IMPORTED_MODULE_4__.getTokenCountAsync)(prompts.map(prompt => prompt.content).join('\\n'));\n        await promptViewUpdater(prompts, totalTokens);\n        isPostProcessing();\n    });\n}\n/**\n * 触发一次生成请求以手动刷新 UI, 将会在 onChatCompletionPromptReady 时拦截生成以停止生成\n */\nfunction refreshPromptView() {\n    // 如果不是聊天补全，直接返回\n    if (!isChatCompletion()) {\n        toastr.error('当前 API 不是聊天补全类型, 无法使用提示词查看器功能', '不支持的 API 类型');\n        return;\n    }\n    // 检查API连接状态，如果未连接则直接更新UI显示连接错误\n    if (_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.online_status === 'no_connection') {\n        if (promptViewUpdater) {\n            promptViewUpdater([], 0);\n        }\n        return;\n    }\n    isRefreshPromptViewCall = true;\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.Generate)('normal');\n}\n/*\n * 检查是否经过了系统消息压缩或者后处理\n * 检查两个条件，如果都符合则插入两个警告条幅\n */\nfunction isPostProcessing() {\n    const $header = $('.prompt-view-header');\n    if ($header.find('.prompt-view-process-warning').length > 0) {\n        $header.find('.prompt-view-process-warning').remove();\n    }\n    const hasSquashMessages = _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__.oai_settings.squash_system_messages === true;\n    const hasCustomPostProcessing = _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__.oai_settings.custom_prompt_post_processing != '';\n    if (hasSquashMessages) {\n        (0,_component_prompt_view_view__WEBPACK_IMPORTED_MODULE_0__.insertMessageMergeWarning)($header, 'squash');\n    }\n    if (hasCustomPostProcessing) {\n        (0,_component_prompt_view_view__WEBPACK_IMPORTED_MODULE_0__.insertMessageMergeWarning)($header, 'post-processing');\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxNQUFNLEdBQUcsQ0FBQyxFQUFFLENBQUM7UUFDNUQsT0FBTyxDQUFDLElBQUksQ0FBQyw4QkFBOEIsQ0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDO0lBQ3hELENBQUM7SUFFRCxNQUFNLGlCQUFpQixHQUFHLHFFQUFZLENBQUMsc0JBQXNCLEtBQUssSUFBSSxDQUFDO0lBRXZFLE1BQU0sdUJBQXVCLEdBQUcscUVBQVksQ0FBQyw2QkFBNkIsSUFBSSxFQUFFLENBQUM7SUFFakYsSUFBSSxpQkFBaUIsRUFBRSxDQUFDO1FBQ3RCLHNGQUF5QixDQUFDLE9BQU8sRUFBRSxRQUFRLENBQUMsQ0FBQztJQUMvQyxDQUFDO0lBRUQsSUFBSSx1QkFBdUIsRUFBRSxDQUFDO1FBQzVCLHNGQUF5QixDQUFDLE9BQU8sRUFBRSxpQkFBaUIsQ0FBQyxDQUFDO0lBQ3hELENBQUM7QUFDSCxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBvbmVudC9wcm9tcHRfdmlldy9zZXJ2aWNlLnRzPzQ2OTEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaW5zZXJ0TWVzc2FnZU1lcmdlV2FybmluZyB9IGZyb20gJ0AvY29tcG9uZW50L3Byb21wdF92aWV3L3ZpZXcnO1xuaW1wb3J0IHsgR2VuZXJhdGUsIG9ubGluZV9zdGF0dXMsIHN0b3BHZW5lcmF0aW9uIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5pbXBvcnQgeyBnZXRDb250ZXh0IH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvZXh0ZW5zaW9ucyc7XG5pbXBvcnQgeyBjaGF0X2NvbXBsZXRpb25fc291cmNlcywgb2FpX3NldHRpbmdzIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvb3BlbmFpJztcbmltcG9ydCB7IGdldFRva2VuQ291bnRBc3luYyB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3Rva2VuaXplcnMnO1xuXG5pbnRlcmZhY2UgUHJvbXB0RGF0YSB7XG4gIHJvbGU6IHN0cmluZztcbiAgY29udGVudDogc3RyaW5nO1xuICB0b2tlbjogbnVtYmVyO1xufVxuXG5sZXQgcHJvbXB0Vmlld1VwZGF0ZXI6ICgocHJvbXB0czogUHJvbXB0RGF0YVtdLCB0b3RhbFRva2VuczogbnVtYmVyKSA9PiB2b2lkIHwgUHJvbWlzZTx2b2lkPikgfCBudWxsID0gbnVsbDtcblxubGV0IGlzUmVmcmVzaFByb21wdFZpZXdDYWxsID0gZmFsc2U7XG5cbi8qKlxuICog6K6+572u5o+Q56S66K+N5p+l55yL5Zmo5pu05paw5Ye95pWwXG4gKiBAcGFyYW0gdXBkYXRlciDmm7TmlrDlh73mlbBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldFByb21wdFZpZXdVcGRhdGVyKFxuICB1cGRhdGVyOiAoKHByb21wdHM6IFByb21wdERhdGFbXSwgdG90YWxUb2tlbnM6IG51bWJlcikgPT4gdm9pZCB8IFByb21pc2U8dm9pZD4pIHwgbnVsbCxcbik6IHZvaWQge1xuICBwcm9tcHRWaWV3VXBkYXRlciA9IHVwZGF0ZXI7XG59XG5cbi8qKlxuICog5qOA5p+l5b2T5YmNQVBJ5piv5ZCm5Li6IENoYXQgQ29tcGxldGlvbiDnsbvlnotcbiAqIEByZXR1cm5zIHtib29sZWFufSDlpoLmnpwgbWFpbkFwaSDlnKggY2hhdF9jb21wbGV0aW9uX3NvdXJjZXMg55qE5YC85Lit5YiZ6L+U5ZueIHRydWVcbiAqL1xuZnVuY3Rpb24gaXNDaGF0Q29tcGxldGlvbigpIHtcbiAgY29uc3QgbWFpbkFwaSA9IGdldENvbnRleHQoKS5tYWluQXBpO1xuICByZXR1cm4gdHlwZW9mIG1haW5BcGkgPT09ICdzdHJpbmcnICYmIE9iamVjdC52YWx1ZXMoY2hhdF9jb21wbGV0aW9uX3NvdXJjZXMpLmluY2x1ZGVzKG1haW5BcGkpO1xufVxuXG4vKipcbiAqIOabtOaWsOaPkOekuuivjeafpeeci+WZqFxuICogQHBhcmFtIGRhdGEg6IGK5aSp5pWw5o2uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBvbkNoYXRDb21wbGV0aW9uUHJvbXB0UmVhZHkoZGF0YTogUGFyYW1ldGVyczxMaXN0ZW5lclR5cGVbJ2NoYXRfY29tcGxldGlvbl9wcm9tcHRfcmVhZHknXT5bMF0pIHtcbiAgaWYgKGRhdGEuZHJ5UnVuKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKCFpc0NoYXRDb21wbGV0aW9uKCkpIHtcbiAgICB0b2FzdHIuZXJyb3IoJ+W9k+WJjSBBUEkg5LiN5piv6IGK5aSp6KGl5YWo57G75Z6LLCDml6Dms5Xkvb/nlKjmj5DnpLror43mn6XnnIvlmajlip/og70nLCAn5LiN5pSv5oyB55qEIEFQSSDnsbvlnosnKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoaXNSZWZyZXNoUHJvbXB0Vmlld0NhbGwpIHtcbiAgICBzdG9wR2VuZXJhdGlvbigpO1xuICAgIGlzUmVmcmVzaFByb21wdFZpZXdDYWxsID0gZmFsc2U7XG4gIH1cblxuICBzZXRUaW1lb3V0KGFzeW5jICgpID0+IHtcbiAgICBpZiAoIXByb21wdFZpZXdVcGRhdGVyKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgcHJvbXB0cyA9IGF3YWl0IFByb21pc2UuYWxsKFxuICAgICAgZGF0YS5jaGF0Lm1hcChhc3luYyAoeyByb2xlLCBjb250ZW50IH0pID0+IHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICByb2xlLFxuICAgICAgICAgIGNvbnRlbnQ6IGNvbnRlbnQsXG4gICAgICAgICAgdG9rZW46IGF3YWl0IGdldFRva2VuQ291bnRBc3luYyhjb250ZW50KSxcbiAgICAgICAgfTtcbiAgICAgIH0pLFxuICAgICk7XG4gICAgY29uc3QgdG90YWxUb2tlbnMgPSBhd2FpdCBnZXRUb2tlbkNvdW50QXN5bmMocHJvbXB0cy5tYXAocHJvbXB0ID0+IHByb21wdC5jb250ZW50KS5qb2luKCdcXG4nKSk7XG4gICAgYXdhaXQgcHJvbXB0Vmlld1VwZGF0ZXIocHJvbXB0cywgdG90YWxUb2tlbnMpO1xuICAgIGlzUG9zdFByb2Nlc3NpbmcoKTtcbiAgfSk7XG59XG5cbi8qKlxuICog6Kem5Y+R5LiA5qyh55Sf5oiQ6K+35rGC5Lul5omL5Yqo5Yi35pawIFVJLCDlsIbkvJrlnKggb25DaGF0Q29tcGxldGlvblByb21wdFJlYWR5IOaXtuaLpuaIqueUn+aIkOS7peWBnOatoueUn+aIkFxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVmcmVzaFByb21wdFZpZXcoKSB7XG4gIC8vIOWmguaenOS4jeaYr+iBiuWkqeihpeWFqO+8jOebtOaOpei/lOWbnlxuICBpZiAoIWlzQ2hhdENvbXBsZXRpb24oKSkge1xuICAgIHRvYXN0ci5lcnJvcign5b2T5YmNIEFQSSDkuI3mmK/ogYrlpKnooaXlhajnsbvlnossIOaXoOazleS9v+eUqOaPkOekuuivjeafpeeci+WZqOWKn+iDvScsICfkuI3mlK/mjIHnmoQgQVBJIOexu+WeiycpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vIOajgOafpUFQSei/nuaOpeeKtuaAge+8jOWmguaenOacqui/nuaOpeWImeebtOaOpeabtOaWsFVJ5pi+56S66L+e5o6l6ZSZ6K+vXG4gIGlmIChvbmxpbmVfc3RhdHVzID09PSAnbm9fY29ubmVjdGlvbicpIHtcbiAgICBpZiAocHJvbXB0Vmlld1VwZGF0ZXIpIHtcbiAgICAgIHByb21wdFZpZXdVcGRhdGVyKFtdLCAwKTtcbiAgICB9XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaXNSZWZyZXNoUHJvbXB0Vmlld0NhbGwgPSB0cnVlO1xuICBHZW5lcmF0ZSgnbm9ybWFsJyk7XG59XG5cbi8qXG4gKiDmo4Dmn6XmmK/lkKbnu4/ov4fkuobns7vnu5/mtojmga/ljovnvKnmiJbogIXlkI7lpITnkIZcbiAqIOajgOafpeS4pOS4quadoeS7tu+8jOWmguaenOmDveespuWQiOWImeaPkuWFpeS4pOS4quitpuWRiuadoeW5hVxuICovXG5mdW5jdGlvbiBpc1Bvc3RQcm9jZXNzaW5nKCkge1xuICBjb25zdCAkaGVhZGVyID0gJCgnLnByb21wdC12aWV3LWhlYWRlcicpO1xuICBpZiAoJGhlYWRlci5maW5kKCcucHJvbXB0LXZpZXctcHJvY2Vzcy13YXJuaW5nJykubGVuZ3RoID4gMCkge1xuICAgICRoZWFkZXIuZmluZCgnLnByb21wdC12aWV3LXByb2Nlc3Mtd2FybmluZycpLnJlbW92ZSgpO1xuICB9XG5cbiAgY29uc3QgaGFzU3F1YXNoTWVzc2FnZXMgPSBvYWlfc2V0dGluZ3Muc3F1YXNoX3N5c3RlbV9tZXNzYWdlcyA9PT0gdHJ1ZTtcblxuICBjb25zdCBoYXNDdXN0b21Qb3N0UHJvY2Vzc2luZyA9IG9haV9zZXR0aW5ncy5jdXN0b21fcHJvbXB0X3Bvc3RfcHJvY2Vzc2luZyAhPSAnJztcblxuICBpZiAoaGFzU3F1YXNoTWVzc2FnZXMpIHtcbiAgICBpbnNlcnRNZXNzYWdlTWVyZ2VXYXJuaW5nKCRoZWFkZXIsICdzcXVhc2gnKTtcbiAgfVxuXG4gIGlmIChoYXNDdXN0b21Qb3N0UHJvY2Vzc2luZykge1xuICAgIGluc2VydE1lc3NhZ2VNZXJnZVdhcm5pbmcoJGhlYWRlciwgJ3Bvc3QtcHJvY2Vzc2luZycpO1xuICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/component/prompt_view/service.ts\n\n}")},"./src/component/prompt_view/view.ts":
/*!*******************************************!*\
  !*** ./src/component/prompt_view/view.ts ***!
  \*******************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   insertMessageMergeWarning: () => (/* binding */ insertMessageMergeWarning),\n/* harmony export */   openPromptViewDialog: () => (/* binding */ openPromptViewDialog),\n/* harmony export */   templatePath: () => (/* binding */ templatePath)\n/* harmony export */ });\n/* harmony import */ var _component_prompt_view_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/prompt_view/service */ \"./src/component/prompt_view/service.ts\");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _util_floating_dialog__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/util/floating_dialog */ \"./src/util/floating_dialog.ts\");\n/* harmony import */ var _util_load_file_to_document__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/util/load_file_to_document */ \"./src/util/load_file_to_document.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_6__);\n\n\n\n\n\n\n\nconst templatePath = `${_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.extensionFolderPath}/src/component/prompt_view/public`;\n// 全局原始内容映射，避免在DOM上重复存储\nlet originalContentMap = new Map();\nlet currentPromptData = [];\n/**\n * 获取元素的原始内容\n * @param contentElement 内容元素\n * @returns 原始内容文本\n */\nfunction getOriginalContent(contentElement) {\n    const index = parseInt(contentElement.attr('data-prompt-index') || '-1');\n    if (index >= 0 && originalContentMap.has(index)) {\n        return originalContentMap.get(index) || '';\n    }\n    // 如果找不到映射，使用当前文本\n    return contentElement.text();\n}\n/**\n * 打开提示词查看器浮窗\n */\nasync function openPromptViewDialog() {\n    await (0,_util_load_file_to_document__WEBPACK_IMPORTED_MODULE_3__.loadFileToHead)(`/scripts/extensions/${templatePath}/style.css`, 'css', 'prompt-view-style');\n    const dialog = _util_floating_dialog__WEBPACK_IMPORTED_MODULE_2__.FloatingDialog.create({\n        id: 'prompt-view-dialog',\n        title: '提示词发送情况',\n        width: '50vw',\n        height: '70vh',\n        mobileWidth: '80vw',\n        mobileHeight: '70vh',\n        minWidth: '15vw',\n        minHeight: '30vh',\n        mobileMinWidth: '70vw',\n        mobileMinHeight: '30vh',\n        resizable: true,\n        draggable: true,\n        collapsible: true,\n        onClose: () => {\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_4__.eventSource.removeListener(_sillytavern_script__WEBPACK_IMPORTED_MODULE_4__.event_types.CHAT_COMPLETION_PROMPT_READY, _component_prompt_view_service__WEBPACK_IMPORTED_MODULE_0__.onChatCompletionPromptReady);\n            (0,_component_prompt_view_service__WEBPACK_IMPORTED_MODULE_0__.setPromptViewUpdater)(null);\n            $(`style#prompt-view-style`).remove();\n            originalContentMap.clear();\n            currentPromptData = [];\n        },\n    });\n    if (!dialog) {\n        return;\n    }\n    const content = dialog.render();\n    const contentTemplate = await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_5__.renderExtensionTemplateAsync)(`${templatePath}`, 'prompt_view_content');\n    const $contentHtml = $(contentTemplate);\n    content.append($contentHtml);\n    function bindFreshHandler(scope) {\n        scope.find('#prompt-view-status-fresh').on('click', function () {\n            const $icon = $(this);\n            $icon.addClass('rotating');\n            setTimeout(() => {\n                $icon.removeClass('rotating');\n            }, 2000);\n            (0,_component_prompt_view_service__WEBPACK_IMPORTED_MODULE_0__.refreshPromptView)();\n        });\n    }\n    bindFreshHandler($contentHtml);\n    /**\n     * 应用角色筛选逻辑\n     * @param enabledRoles 启用的角色集合\n     */\n    function applyRoleFilters(enabledRoles) {\n        const $items = $('.prompt-view-item');\n        $items.each(function () {\n            const $item = $(this);\n            const roleElement = $item.find('.prompt-item-role');\n            if (roleElement.length === 0) {\n                loglevel__WEBPACK_IMPORTED_MODULE_6___default().warn('发现缺少role信息的消息项，跳过处理:', $item[0]);\n                return;\n            }\n            const itemRole = roleElement.text().trim();\n            const roleMatches = enabledRoles.has(itemRole);\n            $item.attr('data-role-visible', roleMatches ? 'true' : 'false');\n        });\n    }\n    /**\n     * 一次性完成完整搜索，返回所有匹配信息\n     * @param text 要搜索的文本\n     * @param searchValue 搜索值\n     * @param isRegex 是否使用正则表达式\n     * @returns 包含匹配状态和详细位置信息的结果\n     */\n    function performCompleteSearch(text, searchValue, isRegex) {\n        try {\n            if (isRegex) {\n                const regex = new RegExp(searchValue, 'gi');\n                const positions = [...text.matchAll(regex)];\n                return {\n                    matches: positions.length > 0,\n                    positions: positions,\n                };\n            }\n            else {\n                const lowerText = text.toLowerCase();\n                const lowerSearch = searchValue.toLowerCase();\n                const indices = [];\n                let index = lowerText.indexOf(lowerSearch);\n                while (index !== -1) {\n                    indices.push({\n                        start: index,\n                        end: index + searchValue.length,\n                        text: text.substring(index, index + searchValue.length),\n                    });\n                    index = lowerText.indexOf(lowerSearch, index + 1);\n                }\n                return {\n                    matches: indices.length > 0,\n                    indices: indices,\n                };\n            }\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_6___default().warn('搜索处理错误:', error);\n            return { matches: false };\n        }\n    }\n    /**\n     * 优化后的搜索筛选逻辑\n     * @param searchValue 搜索值\n     * @param isRegex 是否使用正则表达式\n     * @param useCompactMode 是否使用仅显示匹配部分前后3行\n     */\n    function applySearchWithCompactMode(searchValue, isRegex = false, useCompactMode = false) {\n        const $items = $('.prompt-view-item');\n        $items.each(function () {\n            const $item = $(this);\n            const contentElement = $item.find('.prompt-view-item-content');\n            restoreToOriginalState(contentElement);\n            if (!searchValue) {\n                $item.attr('data-search-visible', 'true');\n                return;\n            }\n            const itemContent = getOriginalContent(contentElement).trim();\n            const searchResult = performCompleteSearch(itemContent, searchValue, isRegex);\n            if (searchResult.matches) {\n                if (useCompactMode) {\n                    const contextResults = findWithContextFromMatches(itemContent, searchResult);\n                    if (contextResults.length > 0) {\n                        applyContextViewOptimized(contentElement, contextResults, searchValue, 3);\n                    }\n                    else {\n                        highlightSearchResultsFromMatches(contentElement, searchResult);\n                    }\n                }\n                else {\n                    highlightSearchResultsFromMatches(contentElement, searchResult);\n                }\n            }\n            $item.attr('data-search-visible', searchResult.matches ? 'true' : 'false');\n        });\n    }\n    /**\n     * 恢复到原始状态\n     * @param contentElement 内容元素\n     */\n    function restoreToOriginalState(contentElement) {\n        contentElement.removeClass('context-view-mode search-highlighted');\n        const originalContent = getOriginalContent(contentElement);\n        if (originalContent) {\n            contentElement.html($('<div>').text(originalContent).html());\n        }\n        contentElement.off('click.contextExpand click.contextCollapse');\n    }\n    /**\n     * 基于已有匹配结果进行高亮，避免重复搜索\n     * @param contentElement 内容元素\n     * @param searchResult 搜索结果\n     */\n    function highlightSearchResultsFromMatches(contentElement, searchResult) {\n        if (!searchResult.matches)\n            return;\n        contentElement.addClass('search-highlighted');\n        let content = contentElement.html();\n        const originalText = getOriginalContent(contentElement);\n        try {\n            if (searchResult.positions) {\n                const sortedPositions = [...searchResult.positions].sort((a, b) => (b.index || 0) - (a.index || 0));\n                sortedPositions.forEach(match => {\n                    if (match.index !== undefined) {\n                        const matchText = originalText.substring(match.index, match.index + match[0].length);\n                        const escapedMatch = $('<div>').text(matchText).html();\n                        const regex = new RegExp(escapeRegExp(escapedMatch), 'g');\n                        let matchCount = 0;\n                        content = content.replace(regex, matched => {\n                            matchCount++;\n                            return `<span class=\"search-highlight\">${matched}</span>`;\n                        });\n                    }\n                });\n            }\n            else if (searchResult.indices) {\n                const sortedIndices = [...searchResult.indices].sort((a, b) => b.start - a.start);\n                sortedIndices.forEach(match => {\n                    const matchText = originalText.substring(match.start, match.end);\n                    const escapedMatch = $('<div>').text(matchText).html();\n                    const index = content.indexOf(escapedMatch);\n                    if (index !== -1) {\n                        content =\n                            content.substring(0, index) +\n                                `<span class=\"search-highlight\">${escapedMatch}</span>` +\n                                content.substring(index + escapedMatch.length);\n                    }\n                });\n            }\n            contentElement.html(content);\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_6___default().warn('高亮关键词时发生错误', error);\n        }\n    }\n    /**\n     * 转义正则表达式特殊字符\n     */\n    function escapeRegExp(string) {\n        return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n    }\n    /**\n     * 生成上下文视图\n     * @param text 原始文本\n     * @param contextResults 上下文搜索结果\n     * @param keyword 关键词\n     * @param contextLines 前后显示的行数\n     * @returns 格式化后的上下文视图HTML\n     */\n    function generateContextView(text, contextResults, keyword, contextLines = 3) {\n        if (!keyword || contextResults.length === 0)\n            return text;\n        const lines = text.split(/\\r?\\n/);\n        const totalLines = lines.length;\n        const matchedLines = new Set();\n        const highlightMap = new Map();\n        contextResults.forEach(result => {\n            result.matches.forEach(match => {\n                matchedLines.add(match.line_number);\n                if (!highlightMap.has(match.line_number)) {\n                    highlightMap.set(match.line_number, []);\n                }\n                highlightMap.get(match.line_number).push({\n                    start: match.start_column || 0,\n                    end: match.end_column || 0,\n                });\n            });\n        });\n        const matchRegions = [];\n        const sortedMatchedLines = Array.from(matchedLines).sort((a, b) => a - b);\n        let currentRegion = null;\n        sortedMatchedLines.forEach(lineNum => {\n            const regionStart = Math.max(0, lineNum - contextLines);\n            const regionEnd = Math.min(totalLines - 1, lineNum + contextLines);\n            if (currentRegion && regionStart <= currentRegion.end + 1) {\n                currentRegion.end = regionEnd;\n                currentRegion.matchedLines.push(lineNum);\n            }\n            else {\n                if (currentRegion) {\n                    matchRegions.push(currentRegion);\n                }\n                currentRegion = {\n                    start: regionStart,\n                    end: regionEnd,\n                    matchedLines: [lineNum],\n                };\n            }\n        });\n        if (currentRegion !== null) {\n            const region = currentRegion;\n            matchRegions.push(region);\n        }\n        const visibleLines = new Set();\n        matchRegions.forEach(region => {\n            for (let i = region.start; i <= region.end; i++) {\n                visibleLines.add(i);\n            }\n        });\n        const sortedVisibleLines = Array.from(visibleLines).sort((a, b) => a - b);\n        const contextViewLines = [];\n        let lastLine = -1;\n        // 检查是否需要在开头添加展开按钮（如果第一个可见行不是文档的第一行）\n        const firstVisibleLine = sortedVisibleLines[0];\n        if (firstVisibleLine > 0) {\n            const initialLinesCount = firstVisibleLine;\n            const expandId = `expand-0-${firstVisibleLine - 1}`;\n            const startExpandButton = `<div class=\"context-expand-button\" data-start-line=\"0\" data-end-line=\"${firstVisibleLine - 1}\" data-expand-id=\"${expandId}\">\n        <span class=\"expand-text\">展开前面 ${initialLinesCount} 行内容</span>\n        <i class=\"fa-solid fa-chevron-down expand-icon\"></i>\n      </div>`;\n            contextViewLines.push(startExpandButton);\n        }\n        sortedVisibleLines.forEach(lineNum => {\n            if (lastLine !== -1 && lineNum > lastLine + 1) {\n                const hiddenLinesCount = lineNum - lastLine - 1;\n                const expandId = `expand-${lastLine + 1}-${lineNum - 1}`;\n                const expandButton = `<div class=\"context-expand-button\" data-start-line=\"${lastLine + 1}\" data-end-line=\"${lineNum - 1}\" data-expand-id=\"${expandId}\">\n          <span class=\"expand-text\">展开 ${hiddenLinesCount} 行隐藏内容</span>\n          <i class=\"fa-solid fa-chevron-down expand-icon\"></i>\n        </div>`;\n                contextViewLines.push(expandButton);\n            }\n            let line = lines[lineNum];\n            // 跳过空行\n            if (line.trim() === '') {\n                lastLine = lineNum;\n                return;\n            }\n            const isMatchedLine = matchedLines.has(lineNum);\n            if (isMatchedLine && highlightMap.has(lineNum)) {\n                const positions = highlightMap.get(lineNum);\n                positions.sort((a, b) => b.start - a.start);\n                positions.forEach(pos => {\n                    const before = line.substring(0, pos.start);\n                    const match = line.substring(pos.start, pos.end);\n                    const after = line.substring(pos.end);\n                    line = before + '<span class=\"search-highlight\">' + match + '</span>' + after;\n                });\n            }\n            if (isMatchedLine) {\n                contextViewLines.push(`<div class=\"context-line-matched\">${line}</div>`);\n            }\n            else {\n                contextViewLines.push(line);\n            }\n            lastLine = lineNum;\n        });\n        // 检查是否需要在末尾添加展开按钮（如果最后的可见行不是文档的最后一行）\n        const lastVisibleLine = sortedVisibleLines[sortedVisibleLines.length - 1];\n        if (lastVisibleLine < totalLines - 1) {\n            const remainingLinesCount = totalLines - 1 - lastVisibleLine;\n            const expandId = `expand-${lastVisibleLine + 1}-${totalLines - 1}`;\n            const endExpandButton = `<div class=\"context-expand-button\" data-start-line=\"${lastVisibleLine + 1}\" data-end-line=\"${totalLines - 1}\" data-expand-id=\"${expandId}\">\n        <span class=\"expand-text\">展开剩余 ${remainingLinesCount} 行内容</span>\n        <i class=\"fa-solid fa-chevron-down expand-icon\"></i>\n      </div>`;\n            contextViewLines.push(endExpandButton);\n        }\n        return contextViewLines.join('\\n');\n    }\n    /**\n     * 精简上下文视图的生成\n     * @param contentElement 内容元素\n     * @param contextResults 上下文搜索结果\n     * @param keyword 关键词\n     * @param contextLines 前后显示的行数\n     */\n    function applyContextViewOptimized(contentElement, contextResults, keyword, contextLines = 3) {\n        if (!keyword || contextResults.length === 0)\n            return;\n        contentElement.addClass('context-view-mode');\n        const originalText = getOriginalContent(contentElement);\n        const contextViewHtml = generateContextView(originalText, contextResults, keyword, contextLines);\n        contentElement.html(contextViewHtml);\n        bindContextViewEvents(contentElement, originalText);\n    }\n    /**\n     * 绑定上下文视图的交互事件\n     * @param contentElement 内容元素\n     * @param originalText 原始文本\n     */\n    function bindContextViewEvents(contentElement, originalText) {\n        contentElement.off('click.contextExpand click.contextCollapse');\n        contentElement.on('click.contextExpand', '.context-expand-button', function (e) {\n            e.stopPropagation();\n            const $button = $(this);\n            const startLine = parseInt($button.attr('data-start-line') || '0');\n            const endLine = parseInt($button.attr('data-end-line') || '0');\n            if (startLine <= endLine) {\n                const lines = originalText.split(/\\r?\\n/);\n                const expandedLines = [];\n                for (let i = startLine; i <= endLine; i++) {\n                    if (i >= 0 && i < lines.length) {\n                        const line = lines[i];\n                        if (line.trim() === '') {\n                            continue;\n                        }\n                        expandedLines.push(line);\n                    }\n                }\n                const expandId = $button.attr('data-expand-id') || `expand-${startLine}-${endLine}`;\n                const collapseButton = `<div class=\"context-collapse-button\" data-start-line=\"${startLine}\" data-end-line=\"${endLine}\" data-expand-id=\"${expandId}\">\n          <span class=\"collapse-text\">收起内容</span>\n          <i class=\"fa-solid fa-chevron-up collapse-icon\"></i>\n        </div>`;\n                const $expandedContainer = $('<div class=\"context-expanded-container\">');\n                expandedLines.forEach(lineText => {\n                    $expandedContainer.append(document.createTextNode(lineText + '\\n'));\n                });\n                $expandedContainer.append($(collapseButton));\n                $button.replaceWith($expandedContainer);\n            }\n        });\n        contentElement.on('click.contextCollapse', '.context-collapse-button', function (e) {\n            e.stopPropagation();\n            const $collapseBtn = $(this);\n            const startLine = parseInt($collapseBtn.attr('data-start-line') || '0');\n            const endLine = parseInt($collapseBtn.attr('data-end-line') || '0');\n            const $expandedContainer = $collapseBtn.closest('.context-expanded-container');\n            const expandId = $collapseBtn.attr('data-expand-id') || `expand-${startLine}-${endLine}`;\n            const hiddenLinesCount = endLine - startLine + 1;\n            const newExpandButton = `<div class=\"context-expand-button\" data-start-line=\"${startLine}\" data-end-line=\"${endLine}\" data-expand-id=\"${expandId}\">\n        <span class=\"expand-text\">展开 ${hiddenLinesCount} 行隐藏内容</span>\n        <i class=\"fa-solid fa-chevron-down expand-icon\"></i>\n      </div>`;\n            $expandedContainer.replaceWith($(newExpandButton));\n        });\n    }\n    /**\n     * 更新显示统计\n     * @param scope 作用域元素\n     */\n    function updateDisplayStats(scope) {\n        let visibleCount = 0;\n        let totalCount = 0;\n        let visibleTokens = 0;\n        const $items = scope.find('.prompt-view-item');\n        $items.each(function () {\n            const $item = $(this);\n            totalCount++;\n            const roleVisible = $item.attr('data-role-visible') === 'true';\n            const searchVisible = $item.attr('data-search-visible') === 'true';\n            const isVisible = roleVisible && searchVisible;\n            if (isVisible) {\n                $item.show();\n                visibleCount++;\n                const tokenElement = $item.find('.prompt-item-token');\n                const tokenValue = parseInt(tokenElement.text().trim()) || 0;\n                visibleTokens += tokenValue;\n            }\n            else {\n                $item.hide();\n            }\n        });\n        scope.find('.prompt-count').text(`显示 ${visibleCount} / ${totalCount} 条消息`);\n        scope.find('.prompt-total-tokens').text(`总Token数: ${visibleTokens}`);\n    }\n    /**\n     * 应用筛选和搜索逻辑\n     */\n    function applyFiltersAndSearch() {\n        const searchValue = $('#prompt-search').val()?.trim() || '';\n        const enabledRoles = new Set();\n        $('.prompt-filter-checkbox:checked').each(function () {\n            const role = $(this).attr('data-role');\n            if (role) {\n                enabledRoles.add(role);\n            }\n        });\n        const isRegex = searchValue.startsWith('/') && searchValue.endsWith('/') && searchValue.length > 2;\n        const actualSearchValue = isRegex ? searchValue.slice(1, -1) : searchValue;\n        const useCompactMode = $('#prompt-search-compact-mode').is(':checked');\n        applyRoleFilters(enabledRoles);\n        applySearchWithCompactMode(actualSearchValue, isRegex, useCompactMode);\n        updateDisplayStats($contentHtml);\n    }\n    function bindFilterHandler(scope) {\n        scope.find('#prompt-filter-icon').on('click', function () {\n            const $filterOptions = scope.find('#prompt-filter-options');\n            $filterOptions.slideToggle(300);\n        });\n        scope.find('.prompt-filter-checkbox').on('change', function () {\n            applyFiltersAndSearch();\n        });\n        scope.find('#prompt-search-compact-mode').on('change', function () {\n            applyFiltersAndSearch();\n        });\n    }\n    // 绑定搜索框输入事件\n    function bindSearchHandler(scope) {\n        let searchTimeout = null;\n        scope.find('#prompt-search').on('input', function () {\n            if (searchTimeout) {\n                clearTimeout(searchTimeout);\n            }\n            searchTimeout = setTimeout(() => {\n                applyFiltersAndSearch();\n                searchTimeout = null;\n            }, 500);\n        });\n    }\n    bindFilterHandler($contentHtml);\n    bindSearchHandler($contentHtml);\n    function bindToggleHandlers(scope) {\n        scope.find('.prompt-view-item-header').on('click', function () {\n            const $this = $(this);\n            const $parent = $this.closest('.prompt-view-item');\n            const $cnt = $parent.find('.prompt-view-item-content');\n            const $divider = $parent.find('.divider');\n            const $icon = $this.find('.prompt-view-item-header-icon');\n            $cnt.slideToggle(300);\n            $divider.slideToggle(300);\n            $icon.toggleClass('fa-circle-chevron-down fa-circle-chevron-up');\n        });\n    }\n    const $empty = $contentHtml.find('.prompt-empty');\n    (0,_component_prompt_view_service__WEBPACK_IMPORTED_MODULE_0__.setPromptViewUpdater)(async (prompts, totalTokens) => {\n        const $list = $contentHtml.find('.prompt-list');\n        $contentHtml.find('.prompt-total-tokens').text(`总Token数: ${totalTokens}`);\n        $contentHtml.find('.prompt-count').text(`共 ${prompts.length} 条消息`);\n        if (prompts.length === 0) {\n            $list.empty();\n            if (_sillytavern_script__WEBPACK_IMPORTED_MODULE_4__.online_status === 'no_connection') {\n                $empty.text('未连接到API，请检查网络连接').show();\n            }\n            else {\n                $empty.text('暂无提示词数据').show();\n            }\n            originalContentMap.clear();\n            currentPromptData = [];\n            return;\n        }\n        $empty.hide();\n        const itemTemplate = await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_5__.renderExtensionTemplateAsync)(`${templatePath}`, 'prompt_view_item');\n        $list.empty();\n        currentPromptData = prompts;\n        originalContentMap.clear();\n        prompts.forEach((item, index) => {\n            const $itemElement = $(itemTemplate);\n            $itemElement.find('.prompt-item-role').text(item.role);\n            $itemElement.find('.prompt-item-token').text(item.token.toString());\n            const $contentDiv = $itemElement.find('.prompt-view-item-content');\n            $contentDiv.attr('data-prompt-index', index.toString());\n            originalContentMap.set(index, item.content);\n            $contentDiv.html($('<div>').text(item.content).html());\n            $itemElement.attr('data-role-visible', 'true');\n            $itemElement.attr('data-search-visible', 'true');\n            $list.append($itemElement);\n        });\n        bindToggleHandlers($list);\n        applyFiltersAndSearch();\n    });\n    // 触发并拦截一次生成以填充 UI\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_4__.eventSource.makeLast(_sillytavern_script__WEBPACK_IMPORTED_MODULE_4__.event_types.CHAT_COMPLETION_PROMPT_READY, _component_prompt_view_service__WEBPACK_IMPORTED_MODULE_0__.onChatCompletionPromptReady);\n    (0,_component_prompt_view_service__WEBPACK_IMPORTED_MODULE_0__.refreshPromptView)();\n}\n/**\n * 基于已有搜索结果查找上下文\n * @param text 需要查找的文本\n * @param searchResult 已有的搜索结果\n * @param lines_per_chunk 每行包含的行数\n * @returns 包含关键词的行号、列号和内容\n */\nfunction findWithContextFromMatches(text, searchResult, lines_per_chunk = 5) {\n    if (!searchResult.matches)\n        return [];\n    const lines = text.split(/\\r?\\n/);\n    const matchPositions = [];\n    let currentPosition = 0;\n    for (let lineIndex = 0; lineIndex < lines.length; lineIndex++) {\n        const line = lines[lineIndex];\n        const lineStart = currentPosition;\n        const lineEnd = currentPosition + line.length;\n        if (searchResult.positions) {\n            searchResult.positions.forEach(match => {\n                if (match.index !== undefined && match.index >= lineStart && match.index < lineEnd) {\n                    matchPositions.push({\n                        line_number: lineIndex,\n                        start_column: match.index - lineStart,\n                        end_column: match.index - lineStart + match[0].length,\n                    });\n                }\n            });\n        }\n        else if (searchResult.indices) {\n            searchResult.indices.forEach(match => {\n                if (match.start >= lineStart && match.start < lineEnd) {\n                    matchPositions.push({\n                        line_number: lineIndex,\n                        start_column: match.start - lineStart,\n                        end_column: match.end - lineStart,\n                    });\n                }\n            });\n        }\n        currentPosition = lineEnd + 1; // +1 for the newline character\n    }\n    const lineGroups = new Map();\n    matchPositions.forEach(match => {\n        const chunkIndex = Math.floor(match.line_number / lines_per_chunk);\n        if (!lineGroups.has(chunkIndex)) {\n            lineGroups.set(chunkIndex, []);\n        }\n        lineGroups.get(chunkIndex).push(match);\n    });\n    return Array.from(lineGroups.entries()).map(([chunkIndex, matches]) => {\n        const startLine = chunkIndex * lines_per_chunk;\n        const endLine = Math.min(startLine + lines_per_chunk, lines.length);\n        const chunkLines = lines.slice(startLine, endLine);\n        return {\n            context: {\n                start_line: startLine,\n                content: chunkLines,\n            },\n            matches: matches,\n        };\n    });\n}\n/**\n * 在顶部插入系统消息压缩/后处理的警告\n */\nfunction insertMessageMergeWarning(scope, type) {\n    const $warning = $('<div class=\"prompt-view-process-warning\">');\n    if (type === 'squash') {\n        $warning.text('⚠️ 本次提示词发送经过了预设中的“系统消息压缩”合并处理');\n    }\n    else if (type === 'post-processing') {\n        $warning.text('⚠️ 本次提示词发送经过了API中的“提示词后处理”合并处理');\n    }\n    scope.prepend($warning);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0wsQ0FBQztBQUVEOztHQUVHO0FBQ0ksU0FBUyx5QkFBeUIsQ0FBQyxLQUEwQixFQUFFLElBQWtDO0lBQ3RHLE1BQU0sUUFBUSxHQUFHLENBQUMsQ0FBQywyQ0FBMkMsQ0FBQyxDQUFDO0lBQ2hFLElBQUksSUFBSSxLQUFLLFFBQVEsRUFBRSxDQUFDO1FBQ3RCLFFBQVEsQ0FBQyxJQUFJLENBQUMsK0JBQStCLENBQUMsQ0FBQztJQUNqRCxDQUFDO1NBQU0sSUFBSSxJQUFJLEtBQUssaUJBQWlCLEVBQUUsQ0FBQztRQUN0QyxRQUFRLENBQUMsSUFBSSxDQUFDLGdDQUFnQyxDQUFDLENBQUM7SUFDbEQsQ0FBQztJQUNELEtBQUssQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUM7QUFDMUIsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9jb21wb25lbnQvcHJvbXB0X3ZpZXcvdmlldy50cz83MTBlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IG9uQ2hhdENvbXBsZXRpb25Qcm9tcHRSZWFkeSwgcmVmcmVzaFByb21wdFZpZXcsIHNldFByb21wdFZpZXdVcGRhdGVyIH0gZnJvbSAnQC9jb21wb25lbnQvcHJvbXB0X3ZpZXcvc2VydmljZSc7XG5pbXBvcnQgeyBleHRlbnNpb25Gb2xkZXJQYXRoIH0gZnJvbSAnQC91dGlsL2V4dGVuc2lvbl92YXJpYWJsZXMnO1xuaW1wb3J0IHsgRmxvYXRpbmdEaWFsb2cgfSBmcm9tICdAL3V0aWwvZmxvYXRpbmdfZGlhbG9nJztcbmltcG9ydCB7IGxvYWRGaWxlVG9IZWFkIH0gZnJvbSAnQC91dGlsL2xvYWRfZmlsZV90b19kb2N1bWVudCc7XG5cbmltcG9ydCB7IGV2ZW50X3R5cGVzLCBldmVudFNvdXJjZSwgb25saW5lX3N0YXR1cyB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHQnO1xuXG5pbXBvcnQgeyByZW5kZXJFeHRlbnNpb25UZW1wbGF0ZUFzeW5jIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvZXh0ZW5zaW9ucyc7XG5pbXBvcnQgbG9nIGZyb20gJ2xvZ2xldmVsJztcblxuZXhwb3J0IGNvbnN0IHRlbXBsYXRlUGF0aCA9IGAke2V4dGVuc2lvbkZvbGRlclBhdGh9L3NyYy9jb21wb25lbnQvcHJvbXB0X3ZpZXcvcHVibGljYDtcblxuaW50ZXJmYWNlIFByb21wdERhdGEge1xuICByb2xlOiBzdHJpbmc7XG4gIGNvbnRlbnQ6IHN0cmluZztcbiAgdG9rZW46IG51bWJlcjtcbn1cblxuaW50ZXJmYWNlIEZpbmRXaXRoQ29udGV4dFJlc3VsdCB7XG4gIGNvbnRleHQ6IHtcbiAgICBzdGFydF9saW5lOiBudW1iZXI7XG4gICAgY29udGVudDogc3RyaW5nW107XG4gIH07XG4gIG1hdGNoZXM6IEFycmF5PHsgbGluZV9udW1iZXI6IG51bWJlcjsgc3RhcnRfY29sdW1uOiBudW1iZXI7IGVuZF9jb2x1bW46IG51bWJlciB9Pjtcbn1cblxuaW50ZXJmYWNlIFNlYXJjaFJlc3VsdCB7XG4gIG1hdGNoZXM6IGJvb2xlYW47XG4gIHBvc2l0aW9ucz86IFJlZ0V4cE1hdGNoQXJyYXlbXTsgLy8g5q2j5YiZ5Yy56YWN57uT5p6cXG4gIGluZGljZXM/OiBBcnJheTx7IHN0YXJ0OiBudW1iZXI7IGVuZDogbnVtYmVyOyB0ZXh0OiBzdHJpbmcgfT47IC8vIOaZrumAmuaQnOe0oueahOS9jee9ruS/oeaBr1xufVxuXG4vLyDlhajlsYDljp/lp4vlhoXlrrnmmKDlsITvvIzpgb/lhY3lnKhET03kuIrph43lpI3lrZjlgqhcbmxldCBvcmlnaW5hbENvbnRlbnRNYXAgPSBuZXcgTWFwPG51bWJlciwgc3RyaW5nPigpO1xubGV0IGN1cnJlbnRQcm9tcHREYXRhOiBQcm9tcHREYXRhW10gPSBbXTtcblxuLyoqXG4gKiDojrflj5blhYPntKDnmoTljp/lp4vlhoXlrrlcbiAqIEBwYXJhbSBjb250ZW50RWxlbWVudCDlhoXlrrnlhYPntKBcbiAqIEByZXR1cm5zIOWOn+Wni+WGheWuueaWh+acrFxuICovXG5mdW5jdGlvbiBnZXRPcmlnaW5hbENvbnRlbnQoY29udGVudEVsZW1lbnQ6IEpRdWVyeTxIVE1MRWxlbWVudD4pOiBzdHJpbmcge1xuICBjb25zdCBpbmRleCA9IHBhcnNlSW50KGNvbnRlbnRFbGVtZW50LmF0dHIoJ2RhdGEtcHJvbXB0LWluZGV4JykgfHwgJy0xJyk7XG4gIGlmIChpbmRleCA+PSAwICYmIG9yaWdpbmFsQ29udGVudE1hcC5oYXMoaW5kZXgpKSB7XG4gICAgcmV0dXJuIG9yaWdpbmFsQ29udGVudE1hcC5nZXQoaW5kZXgpIHx8ICcnO1xuICB9XG4gIC8vIOWmguaenOaJvuS4jeWIsOaYoOWwhO+8jOS9v+eUqOW9k+WJjeaWh+acrFxuICByZXR1cm4gY29udGVudEVsZW1lbnQudGV4dCgpO1xufVxuXG4vKipcbiAqIOaJk+W8gOaPkOekuuivjeafpeeci+WZqOa1rueql1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gb3BlblByb21wdFZpZXdEaWFsb2coKTogUHJvbWlzZTx2b2lkPiB7XG4gIGF3YWl0IGxvYWRGaWxlVG9IZWFkKGAvc2NyaXB0cy9leHRlbnNpb25zLyR7dGVtcGxhdGVQYXRofS9zdHlsZS5jc3NgLCAnY3NzJywgJ3Byb21wdC12aWV3LXN0eWxlJyk7XG5cbiAgY29uc3QgZGlhbG9nID0gRmxvYXRpbmdEaWFsb2cuY3JlYXRlKHtcbiAgICBpZDogJ3Byb21wdC12aWV3LWRpYWxvZycsXG4gICAgdGl0bGU6ICfmj5DnpLror43lj5HpgIHmg4XlhrUnLFxuICAgIHdpZHRoOiAnNTB2dycsXG4gICAgaGVpZ2h0OiAnNzB2aCcsXG4gICAgbW9iaWxlV2lkdGg6ICc4MHZ3JyxcbiAgICBtb2JpbGVIZWlnaHQ6ICc3MHZoJyxcbiAgICBtaW5XaWR0aDogJzE1dncnLFxuICAgIG1pbkhlaWdodDogJzMwdmgnLFxuICAgIG1vYmlsZU1pbldpZHRoOiAnNzB2dycsXG4gICAgbW9iaWxlTWluSGVpZ2h0OiAnMzB2aCcsXG4gICAgcmVzaXphYmxlOiB0cnVlLFxuICAgIGRyYWdnYWJsZTogdHJ1ZSxcbiAgICBjb2xsYXBzaWJsZTogdHJ1ZSxcbiAgICBvbkNsb3NlOiAoKSA9PiB7XG4gICAgICBldmVudFNvdXJjZS5yZW1vdmVMaXN0ZW5lcihldmVudF90eXBlcy5DSEFUX0NPTVBMRVRJT05fUFJPTVBUX1JFQURZLCBvbkNoYXRDb21wbGV0aW9uUHJvbXB0UmVhZHkpO1xuICAgICAgc2V0UHJvbXB0Vmlld1VwZGF0ZXIobnVsbCk7XG4gICAgICAkKGBzdHlsZSNwcm9tcHQtdmlldy1zdHlsZWApLnJlbW92ZSgpO1xuICAgICAgb3JpZ2luYWxDb250ZW50TWFwLmNsZWFyKCk7XG4gICAgICBjdXJyZW50UHJvbXB0RGF0YSA9IFtdO1xuICAgIH0sXG4gIH0pO1xuXG4gIGlmICghZGlhbG9nKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgY29udGVudCA9IGRpYWxvZy5yZW5kZXIoKTtcblxuICBjb25zdCBjb250ZW50VGVtcGxhdGUgPSBhd2FpdCByZW5kZXJFeHRlbnNpb25UZW1wbGF0ZUFzeW5jKGAke3RlbXBsYXRlUGF0aH1gLCAncHJvbXB0X3ZpZXdfY29udGVudCcpO1xuICBjb25zdCAkY29udGVudEh0bWwgPSAkKGNvbnRlbnRUZW1wbGF0ZSk7XG5cbiAgY29udGVudC5hcHBlbmQoJGNvbnRlbnRIdG1sKTtcblxuICBmdW5jdGlvbiBiaW5kRnJlc2hIYW5kbGVyKHNjb3BlOiBKUXVlcnk8SFRNTEVsZW1lbnQ+KSB7XG4gICAgc2NvcGUuZmluZCgnI3Byb21wdC12aWV3LXN0YXR1cy1mcmVzaCcpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGNvbnN0ICRpY29uID0gJCh0aGlzKTtcblxuICAgICAgJGljb24uYWRkQ2xhc3MoJ3JvdGF0aW5nJyk7XG5cbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAkaWNvbi5yZW1vdmVDbGFzcygncm90YXRpbmcnKTtcbiAgICAgIH0sIDIwMDApO1xuXG4gICAgICByZWZyZXNoUHJvbXB0VmlldygpO1xuICAgIH0pO1xuICB9XG5cbiAgYmluZEZyZXNoSGFuZGxlcigkY29udGVudEh0bWwpO1xuXG4gIC8qKlxuICAgKiDlupTnlKjop5LoibLnrZvpgInpgLvovpFcbiAgICogQHBhcmFtIGVuYWJsZWRSb2xlcyDlkK/nlKjnmoTop5LoibLpm4blkIhcbiAgICovXG4gIGZ1bmN0aW9uIGFwcGx5Um9sZUZpbHRlcnMoZW5hYmxlZFJvbGVzOiBTZXQ8c3RyaW5nPikge1xuICAgIGNvbnN0ICRpdGVtcyA9ICQoJy5wcm9tcHQtdmlldy1pdGVtJyk7XG5cbiAgICAkaXRlbXMuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCAkaXRlbSA9ICQodGhpcyk7XG5cbiAgICAgIGNvbnN0IHJvbGVFbGVtZW50ID0gJGl0ZW0uZmluZCgnLnByb21wdC1pdGVtLXJvbGUnKTtcbiAgICAgIGlmIChyb2xlRWxlbWVudC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgbG9nLndhcm4oJ+WPkeeOsOe8uuWwkXJvbGXkv6Hmga/nmoTmtojmga/pobnvvIzot7Pov4flpITnkIY6JywgJGl0ZW1bMF0pO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGl0ZW1Sb2xlID0gcm9sZUVsZW1lbnQudGV4dCgpLnRyaW0oKTtcbiAgICAgIGNvbnN0IHJvbGVNYXRjaGVzID0gZW5hYmxlZFJvbGVzLmhhcyhpdGVtUm9sZSk7XG5cbiAgICAgICRpdGVtLmF0dHIoJ2RhdGEtcm9sZS12aXNpYmxlJywgcm9sZU1hdGNoZXMgPyAndHJ1ZScgOiAnZmFsc2UnKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDkuIDmrKHmgKflrozmiJDlrozmlbTmkJzntKLvvIzov5Tlm57miYDmnInljLnphY3kv6Hmga9cbiAgICogQHBhcmFtIHRleHQg6KaB5pCc57Si55qE5paH5pysXG4gICAqIEBwYXJhbSBzZWFyY2hWYWx1ZSDmkJzntKLlgLxcbiAgICogQHBhcmFtIGlzUmVnZXgg5piv5ZCm5L2/55So5q2j5YiZ6KGo6L6+5byPXG4gICAqIEByZXR1cm5zIOWMheWQq+WMuemFjeeKtuaAgeWSjOivpue7huS9jee9ruS/oeaBr+eahOe7k+aenFxuICAgKi9cbiAgZnVuY3Rpb24gcGVyZm9ybUNvbXBsZXRlU2VhcmNoKHRleHQ6IHN0cmluZywgc2VhcmNoVmFsdWU6IHN0cmluZywgaXNSZWdleDogYm9vbGVhbik6IFNlYXJjaFJlc3VsdCB7XG4gICAgdHJ5IHtcbiAgICAgIGlmIChpc1JlZ2V4KSB7XG4gICAgICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChzZWFyY2hWYWx1ZSwgJ2dpJyk7XG4gICAgICAgIGNvbnN0IHBvc2l0aW9ucyA9IFsuLi50ZXh0Lm1hdGNoQWxsKHJlZ2V4KV07XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgbWF0Y2hlczogcG9zaXRpb25zLmxlbmd0aCA+IDAsXG4gICAgICAgICAgcG9zaXRpb25zOiBwb3NpdGlvbnMsXG4gICAgICAgIH07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBsb3dlclRleHQgPSB0ZXh0LnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIGNvbnN0IGxvd2VyU2VhcmNoID0gc2VhcmNoVmFsdWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgY29uc3QgaW5kaWNlczogQXJyYXk8eyBzdGFydDogbnVtYmVyOyBlbmQ6IG51bWJlcjsgdGV4dDogc3RyaW5nIH0+ID0gW107XG4gICAgICAgIGxldCBpbmRleCA9IGxvd2VyVGV4dC5pbmRleE9mKGxvd2VyU2VhcmNoKTtcblxuICAgICAgICB3aGlsZSAoaW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgaW5kaWNlcy5wdXNoKHtcbiAgICAgICAgICAgIHN0YXJ0OiBpbmRleCxcbiAgICAgICAgICAgIGVuZDogaW5kZXggKyBzZWFyY2hWYWx1ZS5sZW5ndGgsXG4gICAgICAgICAgICB0ZXh0OiB0ZXh0LnN1YnN0cmluZyhpbmRleCwgaW5kZXggKyBzZWFyY2hWYWx1ZS5sZW5ndGgpLFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGluZGV4ID0gbG93ZXJUZXh0LmluZGV4T2YobG93ZXJTZWFyY2gsIGluZGV4ICsgMSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIG1hdGNoZXM6IGluZGljZXMubGVuZ3RoID4gMCxcbiAgICAgICAgICBpbmRpY2VzOiBpbmRpY2VzLFxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2cud2Fybign5pCc57Si5aSE55CG6ZSZ6K+vOicsIGVycm9yKTtcbiAgICAgIHJldHVybiB7IG1hdGNoZXM6IGZhbHNlIH07XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOS8mOWMluWQjueahOaQnOe0ouetm+mAiemAu+i+kVxuICAgKiBAcGFyYW0gc2VhcmNoVmFsdWUg5pCc57Si5YC8XG4gICAqIEBwYXJhbSBpc1JlZ2V4IOaYr+WQpuS9v+eUqOato+WImeihqOi+vuW8j1xuICAgKiBAcGFyYW0gdXNlQ29tcGFjdE1vZGUg5piv5ZCm5L2/55So5LuF5pi+56S65Yy56YWN6YOo5YiG5YmN5ZCOM+ihjFxuICAgKi9cbiAgZnVuY3Rpb24gYXBwbHlTZWFyY2hXaXRoQ29tcGFjdE1vZGUoc2VhcmNoVmFsdWU6IHN0cmluZywgaXNSZWdleDogYm9vbGVhbiA9IGZhbHNlLCB1c2VDb21wYWN0TW9kZTogYm9vbGVhbiA9IGZhbHNlKSB7XG4gICAgY29uc3QgJGl0ZW1zID0gJCgnLnByb21wdC12aWV3LWl0ZW0nKTtcblxuICAgICRpdGVtcy5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIGNvbnN0ICRpdGVtID0gJCh0aGlzKTtcbiAgICAgIGNvbnN0IGNvbnRlbnRFbGVtZW50ID0gJGl0ZW0uZmluZCgnLnByb21wdC12aWV3LWl0ZW0tY29udGVudCcpO1xuXG4gICAgICByZXN0b3JlVG9PcmlnaW5hbFN0YXRlKGNvbnRlbnRFbGVtZW50KTtcblxuICAgICAgaWYgKCFzZWFyY2hWYWx1ZSkge1xuICAgICAgICAkaXRlbS5hdHRyKCdkYXRhLXNlYXJjaC12aXNpYmxlJywgJ3RydWUnKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBpdGVtQ29udGVudCA9IGdldE9yaWdpbmFsQ29udGVudChjb250ZW50RWxlbWVudCkudHJpbSgpO1xuXG4gICAgICBjb25zdCBzZWFyY2hSZXN1bHQgPSBwZXJmb3JtQ29tcGxldGVTZWFyY2goaXRlbUNvbnRlbnQsIHNlYXJjaFZhbHVlLCBpc1JlZ2V4KTtcblxuICAgICAgaWYgKHNlYXJjaFJlc3VsdC5tYXRjaGVzKSB7XG4gICAgICAgIGlmICh1c2VDb21wYWN0TW9kZSkge1xuICAgICAgICAgIGNvbnN0IGNvbnRleHRSZXN1bHRzID0gZmluZFdpdGhDb250ZXh0RnJvbU1hdGNoZXMoaXRlbUNvbnRlbnQsIHNlYXJjaFJlc3VsdCk7XG4gICAgICAgICAgaWYgKGNvbnRleHRSZXN1bHRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGFwcGx5Q29udGV4dFZpZXdPcHRpbWl6ZWQoY29udGVudEVsZW1lbnQsIGNvbnRleHRSZXN1bHRzLCBzZWFyY2hWYWx1ZSwgMyk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGhpZ2hsaWdodFNlYXJjaFJlc3VsdHNGcm9tTWF0Y2hlcyhjb250ZW50RWxlbWVudCwgc2VhcmNoUmVzdWx0KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaGlnaGxpZ2h0U2VhcmNoUmVzdWx0c0Zyb21NYXRjaGVzKGNvbnRlbnRFbGVtZW50LCBzZWFyY2hSZXN1bHQpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgICRpdGVtLmF0dHIoJ2RhdGEtc2VhcmNoLXZpc2libGUnLCBzZWFyY2hSZXN1bHQubWF0Y2hlcyA/ICd0cnVlJyA6ICdmYWxzZScpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOaBouWkjeWIsOWOn+Wni+eKtuaAgVxuICAgKiBAcGFyYW0gY29udGVudEVsZW1lbnQg5YaF5a655YWD57SgXG4gICAqL1xuICBmdW5jdGlvbiByZXN0b3JlVG9PcmlnaW5hbFN0YXRlKGNvbnRlbnRFbGVtZW50OiBKUXVlcnk8SFRNTEVsZW1lbnQ+KSB7XG4gICAgY29udGVudEVsZW1lbnQucmVtb3ZlQ2xhc3MoJ2NvbnRleHQtdmlldy1tb2RlIHNlYXJjaC1oaWdobGlnaHRlZCcpO1xuXG4gICAgY29uc3Qgb3JpZ2luYWxDb250ZW50ID0gZ2V0T3JpZ2luYWxDb250ZW50KGNvbnRlbnRFbGVtZW50KTtcbiAgICBpZiAob3JpZ2luYWxDb250ZW50KSB7XG4gICAgICBjb250ZW50RWxlbWVudC5odG1sKCQoJzxkaXY+JykudGV4dChvcmlnaW5hbENvbnRlbnQpLmh0bWwoKSk7XG4gICAgfVxuXG4gICAgY29udGVudEVsZW1lbnQub2ZmKCdjbGljay5jb250ZXh0RXhwYW5kIGNsaWNrLmNvbnRleHRDb2xsYXBzZScpO1xuICB9XG5cbiAgLyoqXG4gICAqIOWfuuS6juW3suacieWMuemFjee7k+aenOi/m+ihjOmrmOS6ru+8jOmBv+WFjemHjeWkjeaQnOe0olxuICAgKiBAcGFyYW0gY29udGVudEVsZW1lbnQg5YaF5a655YWD57SgXG4gICAqIEBwYXJhbSBzZWFyY2hSZXN1bHQg5pCc57Si57uT5p6cXG4gICAqL1xuICBmdW5jdGlvbiBoaWdobGlnaHRTZWFyY2hSZXN1bHRzRnJvbU1hdGNoZXMoY29udGVudEVsZW1lbnQ6IEpRdWVyeTxIVE1MRWxlbWVudD4sIHNlYXJjaFJlc3VsdDogU2VhcmNoUmVzdWx0KSB7XG4gICAgaWYgKCFzZWFyY2hSZXN1bHQubWF0Y2hlcykgcmV0dXJuO1xuXG4gICAgY29udGVudEVsZW1lbnQuYWRkQ2xhc3MoJ3NlYXJjaC1oaWdobGlnaHRlZCcpO1xuXG4gICAgbGV0IGNvbnRlbnQgPSBjb250ZW50RWxlbWVudC5odG1sKCk7XG4gICAgY29uc3Qgb3JpZ2luYWxUZXh0ID0gZ2V0T3JpZ2luYWxDb250ZW50KGNvbnRlbnRFbGVtZW50KTtcblxuICAgIHRyeSB7XG4gICAgICBpZiAoc2VhcmNoUmVzdWx0LnBvc2l0aW9ucykge1xuICAgICAgICBjb25zdCBzb3J0ZWRQb3NpdGlvbnMgPSBbLi4uc2VhcmNoUmVzdWx0LnBvc2l0aW9uc10uc29ydCgoYSwgYikgPT4gKGIuaW5kZXggfHwgMCkgLSAoYS5pbmRleCB8fCAwKSk7XG4gICAgICAgIHNvcnRlZFBvc2l0aW9ucy5mb3JFYWNoKG1hdGNoID0+IHtcbiAgICAgICAgICBpZiAobWF0Y2guaW5kZXggIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY29uc3QgbWF0Y2hUZXh0ID0gb3JpZ2luYWxUZXh0LnN1YnN0cmluZyhtYXRjaC5pbmRleCwgbWF0Y2guaW5kZXggKyBtYXRjaFswXS5sZW5ndGgpO1xuICAgICAgICAgICAgY29uc3QgZXNjYXBlZE1hdGNoID0gJCgnPGRpdj4nKS50ZXh0KG1hdGNoVGV4dCkuaHRtbCgpO1xuICAgICAgICAgICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGVzY2FwZVJlZ0V4cChlc2NhcGVkTWF0Y2gpLCAnZycpO1xuICAgICAgICAgICAgbGV0IG1hdGNoQ291bnQgPSAwO1xuICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZShyZWdleCwgbWF0Y2hlZCA9PiB7XG4gICAgICAgICAgICAgIG1hdGNoQ291bnQrKztcbiAgICAgICAgICAgICAgcmV0dXJuIGA8c3BhbiBjbGFzcz1cInNlYXJjaC1oaWdobGlnaHRcIj4ke21hdGNoZWR9PC9zcGFuPmA7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIGlmIChzZWFyY2hSZXN1bHQuaW5kaWNlcykge1xuICAgICAgICBjb25zdCBzb3J0ZWRJbmRpY2VzID0gWy4uLnNlYXJjaFJlc3VsdC5pbmRpY2VzXS5zb3J0KChhLCBiKSA9PiBiLnN0YXJ0IC0gYS5zdGFydCk7XG4gICAgICAgIHNvcnRlZEluZGljZXMuZm9yRWFjaChtYXRjaCA9PiB7XG4gICAgICAgICAgY29uc3QgbWF0Y2hUZXh0ID0gb3JpZ2luYWxUZXh0LnN1YnN0cmluZyhtYXRjaC5zdGFydCwgbWF0Y2guZW5kKTtcbiAgICAgICAgICBjb25zdCBlc2NhcGVkTWF0Y2ggPSAkKCc8ZGl2PicpLnRleHQobWF0Y2hUZXh0KS5odG1sKCk7XG4gICAgICAgICAgY29uc3QgaW5kZXggPSBjb250ZW50LmluZGV4T2YoZXNjYXBlZE1hdGNoKTtcbiAgICAgICAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICBjb250ZW50ID1cbiAgICAgICAgICAgICAgY29udGVudC5zdWJzdHJpbmcoMCwgaW5kZXgpICtcbiAgICAgICAgICAgICAgYDxzcGFuIGNsYXNzPVwic2VhcmNoLWhpZ2hsaWdodFwiPiR7ZXNjYXBlZE1hdGNofTwvc3Bhbj5gICtcbiAgICAgICAgICAgICAgY29udGVudC5zdWJzdHJpbmcoaW5kZXggKyBlc2NhcGVkTWF0Y2gubGVuZ3RoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBjb250ZW50RWxlbWVudC5odG1sKGNvbnRlbnQpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2cud2Fybign6auY5Lqu5YWz6ZSu6K+N5pe25Y+R55Sf6ZSZ6K+vJywgZXJyb3IpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDovazkuYnmraPliJnooajovr7lvI/nibnmrorlrZfnrKZcbiAgICovXG4gIGZ1bmN0aW9uIGVzY2FwZVJlZ0V4cChzdHJpbmc6IHN0cmluZykge1xuICAgIHJldHVybiBzdHJpbmcucmVwbGFjZSgvWy4qKz9eJHt9KCl8W1xcXVxcXFxdL2csICdcXFxcJCYnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDnlJ/miJDkuIrkuIvmlofop4blm75cbiAgICogQHBhcmFtIHRleHQg5Y6f5aeL5paH5pysXG4gICAqIEBwYXJhbSBjb250ZXh0UmVzdWx0cyDkuIrkuIvmlofmkJzntKLnu5PmnpxcbiAgICogQHBhcmFtIGtleXdvcmQg5YWz6ZSu6K+NXG4gICAqIEBwYXJhbSBjb250ZXh0TGluZXMg5YmN5ZCO5pi+56S655qE6KGM5pWwXG4gICAqIEByZXR1cm5zIOagvOW8j+WMluWQjueahOS4iuS4i+aWh+inhuWbvkhUTUxcbiAgICovXG4gIGZ1bmN0aW9uIGdlbmVyYXRlQ29udGV4dFZpZXcoXG4gICAgdGV4dDogc3RyaW5nLFxuICAgIGNvbnRleHRSZXN1bHRzOiBGaW5kV2l0aENvbnRleHRSZXN1bHRbXSxcbiAgICBrZXl3b3JkOiBzdHJpbmcsXG4gICAgY29udGV4dExpbmVzOiBudW1iZXIgPSAzLFxuICApOiBzdHJpbmcge1xuICAgIGlmICgha2V5d29yZCB8fCBjb250ZXh0UmVzdWx0cy5sZW5ndGggPT09IDApIHJldHVybiB0ZXh0O1xuXG4gICAgY29uc3QgbGluZXMgPSB0ZXh0LnNwbGl0KC9cXHI/XFxuLyk7XG4gICAgY29uc3QgdG90YWxMaW5lcyA9IGxpbmVzLmxlbmd0aDtcblxuICAgIGNvbnN0IG1hdGNoZWRMaW5lcyA9IG5ldyBTZXQ8bnVtYmVyPigpO1xuICAgIGNvbnN0IGhpZ2hsaWdodE1hcCA9IG5ldyBNYXA8bnVtYmVyLCBBcnJheTx7IHN0YXJ0OiBudW1iZXI7IGVuZDogbnVtYmVyIH0+PigpO1xuXG4gICAgY29udGV4dFJlc3VsdHMuZm9yRWFjaChyZXN1bHQgPT4ge1xuICAgICAgcmVzdWx0Lm1hdGNoZXMuZm9yRWFjaChtYXRjaCA9PiB7XG4gICAgICAgIG1hdGNoZWRMaW5lcy5hZGQobWF0Y2gubGluZV9udW1iZXIpO1xuXG4gICAgICAgIGlmICghaGlnaGxpZ2h0TWFwLmhhcyhtYXRjaC5saW5lX251bWJlcikpIHtcbiAgICAgICAgICBoaWdobGlnaHRNYXAuc2V0KG1hdGNoLmxpbmVfbnVtYmVyLCBbXSk7XG4gICAgICAgIH1cbiAgICAgICAgaGlnaGxpZ2h0TWFwLmdldChtYXRjaC5saW5lX251bWJlcikhLnB1c2goe1xuICAgICAgICAgIHN0YXJ0OiBtYXRjaC5zdGFydF9jb2x1bW4gfHwgMCxcbiAgICAgICAgICBlbmQ6IG1hdGNoLmVuZF9jb2x1bW4gfHwgMCxcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGNvbnN0IG1hdGNoUmVnaW9uczogQXJyYXk8eyBzdGFydDogbnVtYmVyOyBlbmQ6IG51bWJlcjsgbWF0Y2hlZExpbmVzOiBudW1iZXJbXSB9PiA9IFtdO1xuICAgIGNvbnN0IHNvcnRlZE1hdGNoZWRMaW5lcyA9IEFycmF5LmZyb20obWF0Y2hlZExpbmVzKS5zb3J0KChhLCBiKSA9PiBhIC0gYik7XG5cbiAgICB0eXBlIE1hdGNoUmVnaW9uID0geyBzdGFydDogbnVtYmVyOyBlbmQ6IG51bWJlcjsgbWF0Y2hlZExpbmVzOiBudW1iZXJbXSB9O1xuICAgIGxldCBjdXJyZW50UmVnaW9uOiBNYXRjaFJlZ2lvbiB8IG51bGwgPSBudWxsO1xuXG4gICAgc29ydGVkTWF0Y2hlZExpbmVzLmZvckVhY2gobGluZU51bSA9PiB7XG4gICAgICBjb25zdCByZWdpb25TdGFydCA9IE1hdGgubWF4KDAsIGxpbmVOdW0gLSBjb250ZXh0TGluZXMpO1xuICAgICAgY29uc3QgcmVnaW9uRW5kID0gTWF0aC5taW4odG90YWxMaW5lcyAtIDEsIGxpbmVOdW0gKyBjb250ZXh0TGluZXMpO1xuXG4gICAgICBpZiAoY3VycmVudFJlZ2lvbiAmJiByZWdpb25TdGFydCA8PSBjdXJyZW50UmVnaW9uLmVuZCArIDEpIHtcbiAgICAgICAgY3VycmVudFJlZ2lvbi5lbmQgPSByZWdpb25FbmQ7XG4gICAgICAgIGN1cnJlbnRSZWdpb24ubWF0Y2hlZExpbmVzLnB1c2gobGluZU51bSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoY3VycmVudFJlZ2lvbikge1xuICAgICAgICAgIG1hdGNoUmVnaW9ucy5wdXNoKGN1cnJlbnRSZWdpb24pO1xuICAgICAgICB9XG4gICAgICAgIGN1cnJlbnRSZWdpb24gPSB7XG4gICAgICAgICAgc3RhcnQ6IHJlZ2lvblN0YXJ0LFxuICAgICAgICAgIGVuZDogcmVnaW9uRW5kLFxuICAgICAgICAgIG1hdGNoZWRMaW5lczogW2xpbmVOdW1dLFxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaWYgKGN1cnJlbnRSZWdpb24gIT09IG51bGwpIHtcbiAgICAgIGNvbnN0IHJlZ2lvbiA9IGN1cnJlbnRSZWdpb24gYXMgTWF0Y2hSZWdpb247XG4gICAgICBtYXRjaFJlZ2lvbnMucHVzaChyZWdpb24pO1xuICAgIH1cblxuICAgIGNvbnN0IHZpc2libGVMaW5lcyA9IG5ldyBTZXQ8bnVtYmVyPigpO1xuICAgIG1hdGNoUmVnaW9ucy5mb3JFYWNoKHJlZ2lvbiA9PiB7XG4gICAgICBmb3IgKGxldCBpID0gcmVnaW9uLnN0YXJ0OyBpIDw9IHJlZ2lvbi5lbmQ7IGkrKykge1xuICAgICAgICB2aXNpYmxlTGluZXMuYWRkKGkpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgY29uc3Qgc29ydGVkVmlzaWJsZUxpbmVzID0gQXJyYXkuZnJvbSh2aXNpYmxlTGluZXMpLnNvcnQoKGEsIGIpID0+IGEgLSBiKTtcblxuICAgIGNvbnN0IGNvbnRleHRWaWV3TGluZXM6IHN0cmluZ1tdID0gW107XG4gICAgbGV0IGxhc3RMaW5lID0gLTE7XG5cbiAgICAvLyDmo4Dmn6XmmK/lkKbpnIDopoHlnKjlvIDlpLTmt7vliqDlsZXlvIDmjInpkq7vvIjlpoLmnpznrKzkuIDkuKrlj6/op4HooYzkuI3mmK/mlofmoaPnmoTnrKzkuIDooYzvvIlcbiAgICBjb25zdCBmaXJzdFZpc2libGVMaW5lID0gc29ydGVkVmlzaWJsZUxpbmVzWzBdO1xuICAgIGlmIChmaXJzdFZpc2libGVMaW5lID4gMCkge1xuICAgICAgY29uc3QgaW5pdGlhbExpbmVzQ291bnQgPSBmaXJzdFZpc2libGVMaW5lO1xuICAgICAgY29uc3QgZXhwYW5kSWQgPSBgZXhwYW5kLTAtJHtmaXJzdFZpc2libGVMaW5lIC0gMX1gO1xuICAgICAgY29uc3Qgc3RhcnRFeHBhbmRCdXR0b24gPSBgPGRpdiBjbGFzcz1cImNvbnRleHQtZXhwYW5kLWJ1dHRvblwiIGRhdGEtc3RhcnQtbGluZT1cIjBcIiBkYXRhLWVuZC1saW5lPVwiJHtcbiAgICAgICAgZmlyc3RWaXNpYmxlTGluZSAtIDFcbiAgICAgIH1cIiBkYXRhLWV4cGFuZC1pZD1cIiR7ZXhwYW5kSWR9XCI+XG4gICAgICAgIDxzcGFuIGNsYXNzPVwiZXhwYW5kLXRleHRcIj7lsZXlvIDliY3pnaIgJHtpbml0aWFsTGluZXNDb3VudH0g6KGM5YaF5a65PC9zcGFuPlxuICAgICAgICA8aSBjbGFzcz1cImZhLXNvbGlkIGZhLWNoZXZyb24tZG93biBleHBhbmQtaWNvblwiPjwvaT5cbiAgICAgIDwvZGl2PmA7XG4gICAgICBjb250ZXh0Vmlld0xpbmVzLnB1c2goc3RhcnRFeHBhbmRCdXR0b24pO1xuICAgIH1cblxuICAgIHNvcnRlZFZpc2libGVMaW5lcy5mb3JFYWNoKGxpbmVOdW0gPT4ge1xuICAgICAgaWYgKGxhc3RMaW5lICE9PSAtMSAmJiBsaW5lTnVtID4gbGFzdExpbmUgKyAxKSB7XG4gICAgICAgIGNvbnN0IGhpZGRlbkxpbmVzQ291bnQgPSBsaW5lTnVtIC0gbGFzdExpbmUgLSAxO1xuICAgICAgICBjb25zdCBleHBhbmRJZCA9IGBleHBhbmQtJHtsYXN0TGluZSArIDF9LSR7bGluZU51bSAtIDF9YDtcblxuICAgICAgICBjb25zdCBleHBhbmRCdXR0b24gPSBgPGRpdiBjbGFzcz1cImNvbnRleHQtZXhwYW5kLWJ1dHRvblwiIGRhdGEtc3RhcnQtbGluZT1cIiR7bGFzdExpbmUgKyAxfVwiIGRhdGEtZW5kLWxpbmU9XCIke1xuICAgICAgICAgIGxpbmVOdW0gLSAxXG4gICAgICAgIH1cIiBkYXRhLWV4cGFuZC1pZD1cIiR7ZXhwYW5kSWR9XCI+XG4gICAgICAgICAgPHNwYW4gY2xhc3M9XCJleHBhbmQtdGV4dFwiPuWxleW8gCAke2hpZGRlbkxpbmVzQ291bnR9IOihjOmakOiXj+WGheWuuTwvc3Bhbj5cbiAgICAgICAgICA8aSBjbGFzcz1cImZhLXNvbGlkIGZhLWNoZXZyb24tZG93biBleHBhbmQtaWNvblwiPjwvaT5cbiAgICAgICAgPC9kaXY+YDtcbiAgICAgICAgY29udGV4dFZpZXdMaW5lcy5wdXNoKGV4cGFuZEJ1dHRvbik7XG4gICAgICB9XG5cbiAgICAgIGxldCBsaW5lID0gbGluZXNbbGluZU51bV07XG5cbiAgICAgIC8vIOi3s+i/h+epuuihjFxuICAgICAgaWYgKGxpbmUudHJpbSgpID09PSAnJykge1xuICAgICAgICBsYXN0TGluZSA9IGxpbmVOdW07XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgaXNNYXRjaGVkTGluZSA9IG1hdGNoZWRMaW5lcy5oYXMobGluZU51bSk7XG5cbiAgICAgIGlmIChpc01hdGNoZWRMaW5lICYmIGhpZ2hsaWdodE1hcC5oYXMobGluZU51bSkpIHtcbiAgICAgICAgY29uc3QgcG9zaXRpb25zID0gaGlnaGxpZ2h0TWFwLmdldChsaW5lTnVtKSE7XG4gICAgICAgIHBvc2l0aW9ucy5zb3J0KChhLCBiKSA9PiBiLnN0YXJ0IC0gYS5zdGFydCk7XG5cbiAgICAgICAgcG9zaXRpb25zLmZvckVhY2gocG9zID0+IHtcbiAgICAgICAgICBjb25zdCBiZWZvcmUgPSBsaW5lLnN1YnN0cmluZygwLCBwb3Muc3RhcnQpO1xuICAgICAgICAgIGNvbnN0IG1hdGNoID0gbGluZS5zdWJzdHJpbmcocG9zLnN0YXJ0LCBwb3MuZW5kKTtcbiAgICAgICAgICBjb25zdCBhZnRlciA9IGxpbmUuc3Vic3RyaW5nKHBvcy5lbmQpO1xuICAgICAgICAgIGxpbmUgPSBiZWZvcmUgKyAnPHNwYW4gY2xhc3M9XCJzZWFyY2gtaGlnaGxpZ2h0XCI+JyArIG1hdGNoICsgJzwvc3Bhbj4nICsgYWZ0ZXI7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBpZiAoaXNNYXRjaGVkTGluZSkge1xuICAgICAgICBjb250ZXh0Vmlld0xpbmVzLnB1c2goYDxkaXYgY2xhc3M9XCJjb250ZXh0LWxpbmUtbWF0Y2hlZFwiPiR7bGluZX08L2Rpdj5gKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnRleHRWaWV3TGluZXMucHVzaChsaW5lKTtcbiAgICAgIH1cblxuICAgICAgbGFzdExpbmUgPSBsaW5lTnVtO1xuICAgIH0pO1xuXG4gICAgLy8g5qOA5p+l5piv5ZCm6ZyA6KaB5Zyo5pyr5bC+5re75Yqg5bGV5byA5oyJ6ZKu77yI5aaC5p6c5pyA5ZCO55qE5Y+v6KeB6KGM5LiN5piv5paH5qGj55qE5pyA5ZCO5LiA6KGM77yJXG4gICAgY29uc3QgbGFzdFZpc2libGVMaW5lID0gc29ydGVkVmlzaWJsZUxpbmVzW3NvcnRlZFZpc2libGVMaW5lcy5sZW5ndGggLSAxXTtcbiAgICBpZiAobGFzdFZpc2libGVMaW5lIDwgdG90YWxMaW5lcyAtIDEpIHtcbiAgICAgIGNvbnN0IHJlbWFpbmluZ0xpbmVzQ291bnQgPSB0b3RhbExpbmVzIC0gMSAtIGxhc3RWaXNpYmxlTGluZTtcbiAgICAgIGNvbnN0IGV4cGFuZElkID0gYGV4cGFuZC0ke2xhc3RWaXNpYmxlTGluZSArIDF9LSR7dG90YWxMaW5lcyAtIDF9YDtcbiAgICAgIGNvbnN0IGVuZEV4cGFuZEJ1dHRvbiA9IGA8ZGl2IGNsYXNzPVwiY29udGV4dC1leHBhbmQtYnV0dG9uXCIgZGF0YS1zdGFydC1saW5lPVwiJHtcbiAgICAgICAgbGFzdFZpc2libGVMaW5lICsgMVxuICAgICAgfVwiIGRhdGEtZW5kLWxpbmU9XCIke3RvdGFsTGluZXMgLSAxfVwiIGRhdGEtZXhwYW5kLWlkPVwiJHtleHBhbmRJZH1cIj5cbiAgICAgICAgPHNwYW4gY2xhc3M9XCJleHBhbmQtdGV4dFwiPuWxleW8gOWJqeS9mSAke3JlbWFpbmluZ0xpbmVzQ291bnR9IOihjOWGheWuuTwvc3Bhbj5cbiAgICAgICAgPGkgY2xhc3M9XCJmYS1zb2xpZCBmYS1jaGV2cm9uLWRvd24gZXhwYW5kLWljb25cIj48L2k+XG4gICAgICA8L2Rpdj5gO1xuICAgICAgY29udGV4dFZpZXdMaW5lcy5wdXNoKGVuZEV4cGFuZEJ1dHRvbik7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNvbnRleHRWaWV3TGluZXMuam9pbignXFxuJyk7XG4gIH1cblxuICAvKipcbiAgICog57K+566A5LiK5LiL5paH6KeG5Zu+55qE55Sf5oiQXG4gICAqIEBwYXJhbSBjb250ZW50RWxlbWVudCDlhoXlrrnlhYPntKBcbiAgICogQHBhcmFtIGNvbnRleHRSZXN1bHRzIOS4iuS4i+aWh+aQnOe0oue7k+aenFxuICAgKiBAcGFyYW0ga2V5d29yZCDlhbPplK7or41cbiAgICogQHBhcmFtIGNvbnRleHRMaW5lcyDliY3lkI7mmL7npLrnmoTooYzmlbBcbiAgICovXG4gIGZ1bmN0aW9uIGFwcGx5Q29udGV4dFZpZXdPcHRpbWl6ZWQoXG4gICAgY29udGVudEVsZW1lbnQ6IEpRdWVyeTxIVE1MRWxlbWVudD4sXG4gICAgY29udGV4dFJlc3VsdHM6IEZpbmRXaXRoQ29udGV4dFJlc3VsdFtdLFxuICAgIGtleXdvcmQ6IHN0cmluZyxcbiAgICBjb250ZXh0TGluZXM6IG51bWJlciA9IDMsXG4gICkge1xuICAgIGlmICgha2V5d29yZCB8fCBjb250ZXh0UmVzdWx0cy5sZW5ndGggPT09IDApIHJldHVybjtcblxuICAgIGNvbnRlbnRFbGVtZW50LmFkZENsYXNzKCdjb250ZXh0LXZpZXctbW9kZScpO1xuXG4gICAgY29uc3Qgb3JpZ2luYWxUZXh0ID0gZ2V0T3JpZ2luYWxDb250ZW50KGNvbnRlbnRFbGVtZW50KTtcbiAgICBjb25zdCBjb250ZXh0Vmlld0h0bWwgPSBnZW5lcmF0ZUNvbnRleHRWaWV3KG9yaWdpbmFsVGV4dCwgY29udGV4dFJlc3VsdHMsIGtleXdvcmQsIGNvbnRleHRMaW5lcyk7XG5cbiAgICBjb250ZW50RWxlbWVudC5odG1sKGNvbnRleHRWaWV3SHRtbCk7XG5cbiAgICBiaW5kQ29udGV4dFZpZXdFdmVudHMoY29udGVudEVsZW1lbnQsIG9yaWdpbmFsVGV4dCk7XG4gIH1cblxuICAvKipcbiAgICog57uR5a6a5LiK5LiL5paH6KeG5Zu+55qE5Lqk5LqS5LqL5Lu2XG4gICAqIEBwYXJhbSBjb250ZW50RWxlbWVudCDlhoXlrrnlhYPntKBcbiAgICogQHBhcmFtIG9yaWdpbmFsVGV4dCDljp/lp4vmlofmnKxcbiAgICovXG4gIGZ1bmN0aW9uIGJpbmRDb250ZXh0Vmlld0V2ZW50cyhjb250ZW50RWxlbWVudDogSlF1ZXJ5PEhUTUxFbGVtZW50Piwgb3JpZ2luYWxUZXh0OiBzdHJpbmcpIHtcbiAgICBjb250ZW50RWxlbWVudC5vZmYoJ2NsaWNrLmNvbnRleHRFeHBhbmQgY2xpY2suY29udGV4dENvbGxhcHNlJyk7XG5cbiAgICBjb250ZW50RWxlbWVudC5vbignY2xpY2suY29udGV4dEV4cGFuZCcsICcuY29udGV4dC1leHBhbmQtYnV0dG9uJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICBjb25zdCAkYnV0dG9uID0gJCh0aGlzKTtcbiAgICAgIGNvbnN0IHN0YXJ0TGluZSA9IHBhcnNlSW50KCRidXR0b24uYXR0cignZGF0YS1zdGFydC1saW5lJykgfHwgJzAnKTtcbiAgICAgIGNvbnN0IGVuZExpbmUgPSBwYXJzZUludCgkYnV0dG9uLmF0dHIoJ2RhdGEtZW5kLWxpbmUnKSB8fCAnMCcpO1xuXG4gICAgICBpZiAoc3RhcnRMaW5lIDw9IGVuZExpbmUpIHtcbiAgICAgICAgY29uc3QgbGluZXMgPSBvcmlnaW5hbFRleHQuc3BsaXQoL1xccj9cXG4vKTtcbiAgICAgICAgY29uc3QgZXhwYW5kZWRMaW5lczogc3RyaW5nW10gPSBbXTtcblxuICAgICAgICBmb3IgKGxldCBpID0gc3RhcnRMaW5lOyBpIDw9IGVuZExpbmU7IGkrKykge1xuICAgICAgICAgIGlmIChpID49IDAgJiYgaSA8IGxpbmVzLmxlbmd0aCkge1xuICAgICAgICAgICAgY29uc3QgbGluZSA9IGxpbmVzW2ldO1xuICAgICAgICAgICAgaWYgKGxpbmUudHJpbSgpID09PSAnJykge1xuICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGV4cGFuZGVkTGluZXMucHVzaChsaW5lKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBleHBhbmRJZCA9ICRidXR0b24uYXR0cignZGF0YS1leHBhbmQtaWQnKSB8fCBgZXhwYW5kLSR7c3RhcnRMaW5lfS0ke2VuZExpbmV9YDtcbiAgICAgICAgY29uc3QgY29sbGFwc2VCdXR0b24gPSBgPGRpdiBjbGFzcz1cImNvbnRleHQtY29sbGFwc2UtYnV0dG9uXCIgZGF0YS1zdGFydC1saW5lPVwiJHtzdGFydExpbmV9XCIgZGF0YS1lbmQtbGluZT1cIiR7ZW5kTGluZX1cIiBkYXRhLWV4cGFuZC1pZD1cIiR7ZXhwYW5kSWR9XCI+XG4gICAgICAgICAgPHNwYW4gY2xhc3M9XCJjb2xsYXBzZS10ZXh0XCI+5pS26LW35YaF5a65PC9zcGFuPlxuICAgICAgICAgIDxpIGNsYXNzPVwiZmEtc29saWQgZmEtY2hldnJvbi11cCBjb2xsYXBzZS1pY29uXCI+PC9pPlxuICAgICAgICA8L2Rpdj5gO1xuXG4gICAgICAgIGNvbnN0ICRleHBhbmRlZENvbnRhaW5lciA9ICQoJzxkaXYgY2xhc3M9XCJjb250ZXh0LWV4cGFuZGVkLWNvbnRhaW5lclwiPicpO1xuXG4gICAgICAgIGV4cGFuZGVkTGluZXMuZm9yRWFjaChsaW5lVGV4dCA9PiB7XG4gICAgICAgICAgJGV4cGFuZGVkQ29udGFpbmVyLmFwcGVuZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShsaW5lVGV4dCArICdcXG4nKSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgICRleHBhbmRlZENvbnRhaW5lci5hcHBlbmQoJChjb2xsYXBzZUJ1dHRvbikpO1xuICAgICAgICAkYnV0dG9uLnJlcGxhY2VXaXRoKCRleHBhbmRlZENvbnRhaW5lcik7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBjb250ZW50RWxlbWVudC5vbignY2xpY2suY29udGV4dENvbGxhcHNlJywgJy5jb250ZXh0LWNvbGxhcHNlLWJ1dHRvbicsIGZ1bmN0aW9uIChlKSB7XG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgY29uc3QgJGNvbGxhcHNlQnRuID0gJCh0aGlzKTtcbiAgICAgIGNvbnN0IHN0YXJ0TGluZSA9IHBhcnNlSW50KCRjb2xsYXBzZUJ0bi5hdHRyKCdkYXRhLXN0YXJ0LWxpbmUnKSB8fCAnMCcpO1xuICAgICAgY29uc3QgZW5kTGluZSA9IHBhcnNlSW50KCRjb2xsYXBzZUJ0bi5hdHRyKCdkYXRhLWVuZC1saW5lJykgfHwgJzAnKTtcblxuICAgICAgY29uc3QgJGV4cGFuZGVkQ29udGFpbmVyID0gJGNvbGxhcHNlQnRuLmNsb3Nlc3QoJy5jb250ZXh0LWV4cGFuZGVkLWNvbnRhaW5lcicpO1xuXG4gICAgICBjb25zdCBleHBhbmRJZCA9ICRjb2xsYXBzZUJ0bi5hdHRyKCdkYXRhLWV4cGFuZC1pZCcpIHx8IGBleHBhbmQtJHtzdGFydExpbmV9LSR7ZW5kTGluZX1gO1xuICAgICAgY29uc3QgaGlkZGVuTGluZXNDb3VudCA9IGVuZExpbmUgLSBzdGFydExpbmUgKyAxO1xuICAgICAgY29uc3QgbmV3RXhwYW5kQnV0dG9uID0gYDxkaXYgY2xhc3M9XCJjb250ZXh0LWV4cGFuZC1idXR0b25cIiBkYXRhLXN0YXJ0LWxpbmU9XCIke3N0YXJ0TGluZX1cIiBkYXRhLWVuZC1saW5lPVwiJHtlbmRMaW5lfVwiIGRhdGEtZXhwYW5kLWlkPVwiJHtleHBhbmRJZH1cIj5cbiAgICAgICAgPHNwYW4gY2xhc3M9XCJleHBhbmQtdGV4dFwiPuWxleW8gCAke2hpZGRlbkxpbmVzQ291bnR9IOihjOmakOiXj+WGheWuuTwvc3Bhbj5cbiAgICAgICAgPGkgY2xhc3M9XCJmYS1zb2xpZCBmYS1jaGV2cm9uLWRvd24gZXhwYW5kLWljb25cIj48L2k+XG4gICAgICA8L2Rpdj5gO1xuXG4gICAgICAkZXhwYW5kZWRDb250YWluZXIucmVwbGFjZVdpdGgoJChuZXdFeHBhbmRCdXR0b24pKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmm7TmlrDmmL7npLrnu5/orqFcbiAgICogQHBhcmFtIHNjb3BlIOS9nOeUqOWfn+WFg+e0oFxuICAgKi9cbiAgZnVuY3Rpb24gdXBkYXRlRGlzcGxheVN0YXRzKHNjb3BlOiBKUXVlcnk8SFRNTEVsZW1lbnQ+KSB7XG4gICAgbGV0IHZpc2libGVDb3VudCA9IDA7XG4gICAgbGV0IHRvdGFsQ291bnQgPSAwO1xuICAgIGxldCB2aXNpYmxlVG9rZW5zID0gMDtcblxuICAgIGNvbnN0ICRpdGVtcyA9IHNjb3BlLmZpbmQoJy5wcm9tcHQtdmlldy1pdGVtJyk7XG5cbiAgICAkaXRlbXMuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCAkaXRlbSA9ICQodGhpcyk7XG4gICAgICB0b3RhbENvdW50Kys7XG5cbiAgICAgIGNvbnN0IHJvbGVWaXNpYmxlID0gJGl0ZW0uYXR0cignZGF0YS1yb2xlLXZpc2libGUnKSA9PT0gJ3RydWUnO1xuICAgICAgY29uc3Qgc2VhcmNoVmlzaWJsZSA9ICRpdGVtLmF0dHIoJ2RhdGEtc2VhcmNoLXZpc2libGUnKSA9PT0gJ3RydWUnO1xuICAgICAgY29uc3QgaXNWaXNpYmxlID0gcm9sZVZpc2libGUgJiYgc2VhcmNoVmlzaWJsZTtcblxuICAgICAgaWYgKGlzVmlzaWJsZSkge1xuICAgICAgICAkaXRlbS5zaG93KCk7XG4gICAgICAgIHZpc2libGVDb3VudCsrO1xuXG4gICAgICAgIGNvbnN0IHRva2VuRWxlbWVudCA9ICRpdGVtLmZpbmQoJy5wcm9tcHQtaXRlbS10b2tlbicpO1xuICAgICAgICBjb25zdCB0b2tlblZhbHVlID0gcGFyc2VJbnQodG9rZW5FbGVtZW50LnRleHQoKS50cmltKCkpIHx8IDA7XG4gICAgICAgIHZpc2libGVUb2tlbnMgKz0gdG9rZW5WYWx1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICRpdGVtLmhpZGUoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHNjb3BlLmZpbmQoJy5wcm9tcHQtY291bnQnKS50ZXh0KGDmmL7npLogJHt2aXNpYmxlQ291bnR9IC8gJHt0b3RhbENvdW50fSDmnaHmtojmga9gKTtcbiAgICBzY29wZS5maW5kKCcucHJvbXB0LXRvdGFsLXRva2VucycpLnRleHQoYOaAu1Rva2Vu5pWwOiAke3Zpc2libGVUb2tlbnN9YCk7XG4gIH1cblxuICAvKipcbiAgICog5bqU55So562b6YCJ5ZKM5pCc57Si6YC76L6RXG4gICAqL1xuICBmdW5jdGlvbiBhcHBseUZpbHRlcnNBbmRTZWFyY2goKSB7XG4gICAgY29uc3Qgc2VhcmNoVmFsdWUgPSAoJCgnI3Byb21wdC1zZWFyY2gnKS52YWwoKSBhcyBzdHJpbmcpPy50cmltKCkgfHwgJyc7XG5cbiAgICBjb25zdCBlbmFibGVkUm9sZXMgPSBuZXcgU2V0PHN0cmluZz4oKTtcbiAgICAkKCcucHJvbXB0LWZpbHRlci1jaGVja2JveDpjaGVja2VkJykuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCByb2xlID0gJCh0aGlzKS5hdHRyKCdkYXRhLXJvbGUnKTtcbiAgICAgIGlmIChyb2xlKSB7XG4gICAgICAgIGVuYWJsZWRSb2xlcy5hZGQocm9sZSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBjb25zdCBpc1JlZ2V4ID0gc2VhcmNoVmFsdWUuc3RhcnRzV2l0aCgnLycpICYmIHNlYXJjaFZhbHVlLmVuZHNXaXRoKCcvJykgJiYgc2VhcmNoVmFsdWUubGVuZ3RoID4gMjtcbiAgICBjb25zdCBhY3R1YWxTZWFyY2hWYWx1ZSA9IGlzUmVnZXggPyBzZWFyY2hWYWx1ZS5zbGljZSgxLCAtMSkgOiBzZWFyY2hWYWx1ZTtcblxuICAgIGNvbnN0IHVzZUNvbXBhY3RNb2RlID0gJCgnI3Byb21wdC1zZWFyY2gtY29tcGFjdC1tb2RlJykuaXMoJzpjaGVja2VkJyk7XG5cbiAgICBhcHBseVJvbGVGaWx0ZXJzKGVuYWJsZWRSb2xlcyk7XG5cbiAgICBhcHBseVNlYXJjaFdpdGhDb21wYWN0TW9kZShhY3R1YWxTZWFyY2hWYWx1ZSwgaXNSZWdleCwgdXNlQ29tcGFjdE1vZGUpO1xuXG4gICAgdXBkYXRlRGlzcGxheVN0YXRzKCRjb250ZW50SHRtbCk7XG4gIH1cblxuICBmdW5jdGlvbiBiaW5kRmlsdGVySGFuZGxlcihzY29wZTogSlF1ZXJ5PEhUTUxFbGVtZW50Pikge1xuICAgIHNjb3BlLmZpbmQoJyNwcm9tcHQtZmlsdGVyLWljb24nKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCAkZmlsdGVyT3B0aW9ucyA9IHNjb3BlLmZpbmQoJyNwcm9tcHQtZmlsdGVyLW9wdGlvbnMnKTtcbiAgICAgICRmaWx0ZXJPcHRpb25zLnNsaWRlVG9nZ2xlKDMwMCk7XG4gICAgfSk7XG5cbiAgICBzY29wZS5maW5kKCcucHJvbXB0LWZpbHRlci1jaGVja2JveCcpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBhcHBseUZpbHRlcnNBbmRTZWFyY2goKTtcbiAgICB9KTtcblxuICAgIHNjb3BlLmZpbmQoJyNwcm9tcHQtc2VhcmNoLWNvbXBhY3QtbW9kZScpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBhcHBseUZpbHRlcnNBbmRTZWFyY2goKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8vIOe7keWumuaQnOe0ouahhui+k+WFpeS6i+S7tlxuICBmdW5jdGlvbiBiaW5kU2VhcmNoSGFuZGxlcihzY29wZTogSlF1ZXJ5PEhUTUxFbGVtZW50Pikge1xuICAgIGxldCBzZWFyY2hUaW1lb3V0OiBOb2RlSlMuVGltZW91dCB8IG51bGwgPSBudWxsO1xuXG4gICAgc2NvcGUuZmluZCgnI3Byb21wdC1zZWFyY2gnKS5vbignaW5wdXQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoc2VhcmNoVGltZW91dCkge1xuICAgICAgICBjbGVhclRpbWVvdXQoc2VhcmNoVGltZW91dCk7XG4gICAgICB9XG5cbiAgICAgIHNlYXJjaFRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgYXBwbHlGaWx0ZXJzQW5kU2VhcmNoKCk7XG4gICAgICAgIHNlYXJjaFRpbWVvdXQgPSBudWxsO1xuICAgICAgfSwgNTAwKTtcbiAgICB9KTtcbiAgfVxuXG4gIGJpbmRGaWx0ZXJIYW5kbGVyKCRjb250ZW50SHRtbCk7XG4gIGJpbmRTZWFyY2hIYW5kbGVyKCRjb250ZW50SHRtbCk7XG5cbiAgZnVuY3Rpb24gYmluZFRvZ2dsZUhhbmRsZXJzKHNjb3BlOiBKUXVlcnk8SFRNTEVsZW1lbnQ+KSB7XG4gICAgc2NvcGUuZmluZCgnLnByb21wdC12aWV3LWl0ZW0taGVhZGVyJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgJHRoaXMgPSAkKHRoaXMpO1xuICAgICAgY29uc3QgJHBhcmVudCA9ICR0aGlzLmNsb3Nlc3QoJy5wcm9tcHQtdmlldy1pdGVtJyk7XG4gICAgICBjb25zdCAkY250ID0gJHBhcmVudC5maW5kKCcucHJvbXB0LXZpZXctaXRlbS1jb250ZW50Jyk7XG4gICAgICBjb25zdCAkZGl2aWRlciA9ICRwYXJlbnQuZmluZCgnLmRpdmlkZXInKTtcbiAgICAgIGNvbnN0ICRpY29uID0gJHRoaXMuZmluZCgnLnByb21wdC12aWV3LWl0ZW0taGVhZGVyLWljb24nKTtcblxuICAgICAgJGNudC5zbGlkZVRvZ2dsZSgzMDApO1xuICAgICAgJGRpdmlkZXIuc2xpZGVUb2dnbGUoMzAwKTtcbiAgICAgICRpY29uLnRvZ2dsZUNsYXNzKCdmYS1jaXJjbGUtY2hldnJvbi1kb3duIGZhLWNpcmNsZS1jaGV2cm9uLXVwJyk7XG4gICAgfSk7XG4gIH1cblxuICBjb25zdCAkZW1wdHkgPSAkY29udGVudEh0bWwuZmluZCgnLnByb21wdC1lbXB0eScpO1xuXG4gIHNldFByb21wdFZpZXdVcGRhdGVyKGFzeW5jIChwcm9tcHRzOiBQcm9tcHREYXRhW10sIHRvdGFsVG9rZW5zOiBudW1iZXIpID0+IHtcbiAgICBjb25zdCAkbGlzdCA9ICRjb250ZW50SHRtbC5maW5kKCcucHJvbXB0LWxpc3QnKTtcblxuICAgICRjb250ZW50SHRtbC5maW5kKCcucHJvbXB0LXRvdGFsLXRva2VucycpLnRleHQoYOaAu1Rva2Vu5pWwOiAke3RvdGFsVG9rZW5zfWApO1xuICAgICRjb250ZW50SHRtbC5maW5kKCcucHJvbXB0LWNvdW50JykudGV4dChg5YWxICR7cHJvbXB0cy5sZW5ndGh9IOadoea2iOaBr2ApO1xuXG4gICAgaWYgKHByb21wdHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAkbGlzdC5lbXB0eSgpO1xuICAgICAgaWYgKG9ubGluZV9zdGF0dXMgPT09ICdub19jb25uZWN0aW9uJykge1xuICAgICAgICAkZW1wdHkudGV4dCgn5pyq6L+e5o6l5YiwQVBJ77yM6K+35qOA5p+l572R57uc6L+e5o6lJykuc2hvdygpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgJGVtcHR5LnRleHQoJ+aaguaXoOaPkOekuuivjeaVsOaNricpLnNob3coKTtcbiAgICAgIH1cbiAgICAgIG9yaWdpbmFsQ29udGVudE1hcC5jbGVhcigpO1xuICAgICAgY3VycmVudFByb21wdERhdGEgPSBbXTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAkZW1wdHkuaGlkZSgpO1xuICAgIGNvbnN0IGl0ZW1UZW1wbGF0ZSA9IGF3YWl0IHJlbmRlckV4dGVuc2lvblRlbXBsYXRlQXN5bmMoYCR7dGVtcGxhdGVQYXRofWAsICdwcm9tcHRfdmlld19pdGVtJyk7XG5cbiAgICAkbGlzdC5lbXB0eSgpO1xuXG4gICAgY3VycmVudFByb21wdERhdGEgPSBwcm9tcHRzO1xuICAgIG9yaWdpbmFsQ29udGVudE1hcC5jbGVhcigpO1xuXG4gICAgcHJvbXB0cy5mb3JFYWNoKChpdGVtLCBpbmRleCkgPT4ge1xuICAgICAgY29uc3QgJGl0ZW1FbGVtZW50ID0gJChpdGVtVGVtcGxhdGUpO1xuXG4gICAgICAkaXRlbUVsZW1lbnQuZmluZCgnLnByb21wdC1pdGVtLXJvbGUnKS50ZXh0KGl0ZW0ucm9sZSk7XG4gICAgICAkaXRlbUVsZW1lbnQuZmluZCgnLnByb21wdC1pdGVtLXRva2VuJykudGV4dChpdGVtLnRva2VuLnRvU3RyaW5nKCkpO1xuXG4gICAgICBjb25zdCAkY29udGVudERpdiA9ICRpdGVtRWxlbWVudC5maW5kKCcucHJvbXB0LXZpZXctaXRlbS1jb250ZW50Jyk7XG4gICAgICAkY29udGVudERpdi5hdHRyKCdkYXRhLXByb21wdC1pbmRleCcsIGluZGV4LnRvU3RyaW5nKCkpO1xuICAgICAgb3JpZ2luYWxDb250ZW50TWFwLnNldChpbmRleCwgaXRlbS5jb250ZW50KTtcbiAgICAgICRjb250ZW50RGl2Lmh0bWwoJCgnPGRpdj4nKS50ZXh0KGl0ZW0uY29udGVudCkuaHRtbCgpKTtcblxuICAgICAgJGl0ZW1FbGVtZW50LmF0dHIoJ2RhdGEtcm9sZS12aXNpYmxlJywgJ3RydWUnKTtcbiAgICAgICRpdGVtRWxlbWVudC5hdHRyKCdkYXRhLXNlYXJjaC12aXNpYmxlJywgJ3RydWUnKTtcblxuICAgICAgJGxpc3QuYXBwZW5kKCRpdGVtRWxlbWVudCk7XG4gICAgfSk7XG4gICAgYmluZFRvZ2dsZUhhbmRsZXJzKCRsaXN0KTtcblxuICAgIGFwcGx5RmlsdGVyc0FuZFNlYXJjaCgpO1xuICB9KTtcblxuICAvLyDop6blj5Hlubbmi6bmiKrkuIDmrKHnlJ/miJDku6XloavlhYUgVUlcbiAgZXZlbnRTb3VyY2UubWFrZUxhc3QoZXZlbnRfdHlwZXMuQ0hBVF9DT01QTEVUSU9OX1BST01QVF9SRUFEWSwgb25DaGF0Q29tcGxldGlvblByb21wdFJlYWR5KTtcbiAgcmVmcmVzaFByb21wdFZpZXcoKTtcbn1cblxuLyoqXG4gKiDln7rkuo7lt7LmnInmkJzntKLnu5Pmnpzmn6Xmib7kuIrkuIvmlodcbiAqIEBwYXJhbSB0ZXh0IOmcgOimgeafpeaJvueahOaWh+acrFxuICogQHBhcmFtIHNlYXJjaFJlc3VsdCDlt7LmnInnmoTmkJzntKLnu5PmnpxcbiAqIEBwYXJhbSBsaW5lc19wZXJfY2h1bmsg5q+P6KGM5YyF5ZCr55qE6KGM5pWwXG4gKiBAcmV0dXJucyDljIXlkKvlhbPplK7or43nmoTooYzlj7fjgIHliJflj7flkozlhoXlrrlcbiAqL1xuZnVuY3Rpb24gZmluZFdpdGhDb250ZXh0RnJvbU1hdGNoZXMoXG4gIHRleHQ6IHN0cmluZyxcbiAgc2VhcmNoUmVzdWx0OiBTZWFyY2hSZXN1bHQsXG4gIGxpbmVzX3Blcl9jaHVuazogbnVtYmVyID0gNSxcbik6IEZpbmRXaXRoQ29udGV4dFJlc3VsdFtdIHtcbiAgaWYgKCFzZWFyY2hSZXN1bHQubWF0Y2hlcykgcmV0dXJuIFtdO1xuXG4gIGNvbnN0IGxpbmVzID0gdGV4dC5zcGxpdCgvXFxyP1xcbi8pO1xuICBjb25zdCBtYXRjaFBvc2l0aW9uczogQXJyYXk8eyBsaW5lX251bWJlcjogbnVtYmVyOyBzdGFydF9jb2x1bW46IG51bWJlcjsgZW5kX2NvbHVtbjogbnVtYmVyIH0+ID0gW107XG5cbiAgbGV0IGN1cnJlbnRQb3NpdGlvbiA9IDA7XG4gIGZvciAobGV0IGxpbmVJbmRleCA9IDA7IGxpbmVJbmRleCA8IGxpbmVzLmxlbmd0aDsgbGluZUluZGV4KyspIHtcbiAgICBjb25zdCBsaW5lID0gbGluZXNbbGluZUluZGV4XTtcbiAgICBjb25zdCBsaW5lU3RhcnQgPSBjdXJyZW50UG9zaXRpb247XG4gICAgY29uc3QgbGluZUVuZCA9IGN1cnJlbnRQb3NpdGlvbiArIGxpbmUubGVuZ3RoO1xuXG4gICAgaWYgKHNlYXJjaFJlc3VsdC5wb3NpdGlvbnMpIHtcbiAgICAgIHNlYXJjaFJlc3VsdC5wb3NpdGlvbnMuZm9yRWFjaChtYXRjaCA9PiB7XG4gICAgICAgIGlmIChtYXRjaC5pbmRleCAhPT0gdW5kZWZpbmVkICYmIG1hdGNoLmluZGV4ID49IGxpbmVTdGFydCAmJiBtYXRjaC5pbmRleCA8IGxpbmVFbmQpIHtcbiAgICAgICAgICBtYXRjaFBvc2l0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgIGxpbmVfbnVtYmVyOiBsaW5lSW5kZXgsXG4gICAgICAgICAgICBzdGFydF9jb2x1bW46IG1hdGNoLmluZGV4IC0gbGluZVN0YXJ0LFxuICAgICAgICAgICAgZW5kX2NvbHVtbjogbWF0Y2guaW5kZXggLSBsaW5lU3RhcnQgKyBtYXRjaFswXS5sZW5ndGgsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0gZWxzZSBpZiAoc2VhcmNoUmVzdWx0LmluZGljZXMpIHtcbiAgICAgIHNlYXJjaFJlc3VsdC5pbmRpY2VzLmZvckVhY2gobWF0Y2ggPT4ge1xuICAgICAgICBpZiAobWF0Y2guc3RhcnQgPj0gbGluZVN0YXJ0ICYmIG1hdGNoLnN0YXJ0IDwgbGluZUVuZCkge1xuICAgICAgICAgIG1hdGNoUG9zaXRpb25zLnB1c2goe1xuICAgICAgICAgICAgbGluZV9udW1iZXI6IGxpbmVJbmRleCxcbiAgICAgICAgICAgIHN0YXJ0X2NvbHVtbjogbWF0Y2guc3RhcnQgLSBsaW5lU3RhcnQsXG4gICAgICAgICAgICBlbmRfY29sdW1uOiBtYXRjaC5lbmQgLSBsaW5lU3RhcnQsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGN1cnJlbnRQb3NpdGlvbiA9IGxpbmVFbmQgKyAxOyAvLyArMSBmb3IgdGhlIG5ld2xpbmUgY2hhcmFjdGVyXG4gIH1cblxuICBjb25zdCBsaW5lR3JvdXBzID0gbmV3IE1hcDxudW1iZXIsIEFycmF5PHsgbGluZV9udW1iZXI6IG51bWJlcjsgc3RhcnRfY29sdW1uOiBudW1iZXI7IGVuZF9jb2x1bW46IG51bWJlciB9Pj4oKTtcbiAgbWF0Y2hQb3NpdGlvbnMuZm9yRWFjaChtYXRjaCA9PiB7XG4gICAgY29uc3QgY2h1bmtJbmRleCA9IE1hdGguZmxvb3IobWF0Y2gubGluZV9udW1iZXIgLyBsaW5lc19wZXJfY2h1bmspO1xuICAgIGlmICghbGluZUdyb3Vwcy5oYXMoY2h1bmtJbmRleCkpIHtcbiAgICAgIGxpbmVHcm91cHMuc2V0KGNodW5rSW5kZXgsIFtdKTtcbiAgICB9XG4gICAgbGluZUdyb3Vwcy5nZXQoY2h1bmtJbmRleCkhLnB1c2gobWF0Y2gpO1xuICB9KTtcblxuICByZXR1cm4gQXJyYXkuZnJvbShsaW5lR3JvdXBzLmVudHJpZXMoKSkubWFwKChbY2h1bmtJbmRleCwgbWF0Y2hlc10pID0+IHtcbiAgICBjb25zdCBzdGFydExpbmUgPSBjaHVua0luZGV4ICogbGluZXNfcGVyX2NodW5rO1xuICAgIGNvbnN0IGVuZExpbmUgPSBNYXRoLm1pbihzdGFydExpbmUgKyBsaW5lc19wZXJfY2h1bmssIGxpbmVzLmxlbmd0aCk7XG4gICAgY29uc3QgY2h1bmtMaW5lcyA9IGxpbmVzLnNsaWNlKHN0YXJ0TGluZSwgZW5kTGluZSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgY29udGV4dDoge1xuICAgICAgICBzdGFydF9saW5lOiBzdGFydExpbmUsXG4gICAgICAgIGNvbnRlbnQ6IGNodW5rTGluZXMsXG4gICAgICB9LFxuICAgICAgbWF0Y2hlczogbWF0Y2hlcyxcbiAgICB9O1xuICB9KTtcbn1cblxuLyoqXG4gKiDlnKjpobbpg6jmj5LlhaXns7vnu5/mtojmga/ljovnvKkv5ZCO5aSE55CG55qE6K2m5ZGKXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbnNlcnRNZXNzYWdlTWVyZ2VXYXJuaW5nKHNjb3BlOiBKUXVlcnk8SFRNTEVsZW1lbnQ+LCB0eXBlOiAnc3F1YXNoJyB8ICdwb3N0LXByb2Nlc3NpbmcnKSB7XG4gIGNvbnN0ICR3YXJuaW5nID0gJCgnPGRpdiBjbGFzcz1cInByb21wdC12aWV3LXByb2Nlc3Mtd2FybmluZ1wiPicpO1xuICBpZiAodHlwZSA9PT0gJ3NxdWFzaCcpIHtcbiAgICAkd2FybmluZy50ZXh0KCfimqDvuI8g5pys5qyh5o+Q56S66K+N5Y+R6YCB57uP6L+H5LqG6aKE6K6+5Lit55qE4oCc57O757uf5raI5oGv5Y6L57yp4oCd5ZCI5bm25aSE55CGJyk7XG4gIH0gZWxzZSBpZiAodHlwZSA9PT0gJ3Bvc3QtcHJvY2Vzc2luZycpIHtcbiAgICAkd2FybmluZy50ZXh0KCfimqDvuI8g5pys5qyh5o+Q56S66K+N5Y+R6YCB57uP6L+H5LqGQVBJ5Lit55qE4oCc5o+Q56S66K+N5ZCO5aSE55CG4oCd5ZCI5bm25aSE55CGJyk7XG4gIH1cbiAgc2NvcGUucHJlcGVuZCgkd2FybmluZyk7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/component/prompt_view/view.ts\n\n}")},"./src/component/reference/index.ts":
/*!******************************************!*\
  !*** ./src/component/reference/index.ts ***!
  \******************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   initReference: () => (/* binding */ initReference)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/scripts/slash-commands/SlashCommandParser */ \"@sillytavern/scripts/slash-commands/SlashCommandParser\");\n\nfunction formatSlashCommands() {\n    const cmdList = Object.keys(_sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_0__.SlashCommandParser.commands)\n        .filter(key => _sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_0__.SlashCommandParser.commands[key].name === key) // exclude aliases\n        .sort((a, b) => a.toLowerCase().localeCompare(b.toLowerCase()))\n        .map(key => _sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_0__.SlashCommandParser.commands[key]);\n    const transform_unnamed_arg = (arg) => {\n        return {\n            is_required: arg.isRequired,\n            default_value: arg.defaultValue ?? undefined,\n            accepts_multiple: arg.acceptsMultiple,\n            enum_list: arg.enumList.length > 0 ? arg.enumList.map(e => e.value) : undefined,\n            type_list: arg.typeList.length > 0 ? arg.typeList : undefined,\n        };\n    };\n    const transform_named_arg = (arg) => {\n        return {\n            name: arg.name,\n            ...transform_unnamed_arg(arg),\n        };\n    };\n    const transform_help_string = (help_string) => {\n        const content = $('<span>').html(help_string);\n        return content\n            .text()\n            .split('\\n')\n            .map(line => line.trim())\n            .filter(line => line !== '')\n            .join(' ');\n    };\n    return cmdList\n        .map(cmd => ({\n        name: cmd.name,\n        named_args: cmd.namedArgumentList.map(transform_named_arg) ?? [],\n        unnamed_args: cmd.unnamedArgumentList.map(transform_unnamed_arg) ?? [],\n        return_type: cmd.returns ?? 'void',\n        help_string: transform_help_string(cmd.helpString) ?? 'NO DETAILS',\n    }))\n        .map(cmd => `/${cmd.name}${cmd.named_args.length > 0 ? ` ` : ``}${cmd.named_args\n        .map(arg => `[${arg.accepts_multiple ? `...` : ``}${arg.name}=${arg.enum_list ? arg.enum_list.join('|') : arg.type_list ? arg.type_list.join('|') : ''}]${arg.is_required ? `` : `?`}${arg.default_value ? `=${arg.default_value}` : ``}`)\n        .join(' ')}${cmd.unnamed_args.length > 0 ? ` ` : ``}${cmd.unnamed_args\n        .map(arg => `(${arg.accepts_multiple ? `...` : ``}${arg.enum_list ? arg.enum_list.join('|') : arg.type_list ? arg.type_list.join('|') : ''})${arg.is_required ? `` : `?`}${arg.default_value ? `=${arg.default_value}` : ``}`)\n        .join(' ')} // ${cmd.help_string}`)\n        .join('\\n');\n}\nasync function initReference() {\n    $('#download_slash_commands').on('click', function () {\n        const url = URL.createObjectURL(new Blob([formatSlashCommands()], { type: 'text/plain' }));\n        $(this).attr('href', url);\n        $(this).attr('download', 'slash_command.txt');\n        setTimeout(() => URL.revokeObjectURL(url), 0);\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0FBQyxDQUFDLENBQUMsQ0FBQyxFQUN0RixJQUFJLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLEdBQUcsQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLElBQUksR0FBRyxDQUFDLGFBQWEsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FDdEY7U0FDQSxJQUFJLENBQUMsR0FBRyxDQUFDLE9BQU8sR0FBRyxDQUFDLFdBQVcsRUFBRSxDQUN2QztTQUNBLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUNoQixDQUFDO0FBRU0sS0FBSyxVQUFVLGFBQWE7SUFDakMsQ0FBQyxDQUFDLDBCQUEwQixDQUFDLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRTtRQUN4QyxNQUFNLEdBQUcsR0FBRyxHQUFHLENBQUMsZUFBZSxDQUFDLElBQUksSUFBSSxDQUFDLENBQUMsbUJBQW1CLEVBQUUsQ0FBQyxFQUFFLEVBQUUsSUFBSSxFQUFFLFlBQVksRUFBRSxDQUFDLENBQUMsQ0FBQztRQUMzRixDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxHQUFHLENBQUMsQ0FBQztRQUMxQixDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsRUFBRSxtQkFBbUIsQ0FBQyxDQUFDO1FBQzlDLFVBQVUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxHQUFHLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQ2hELENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9jb21wb25lbnQvcmVmZXJlbmNlL2luZGV4LnRzPzQ2ZTEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgU2xhc2hDb21tYW5kQXJndW1lbnQsXG4gIFNsYXNoQ29tbWFuZE5hbWVkQXJndW1lbnQsXG59IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3NsYXNoLWNvbW1hbmRzL1NsYXNoQ29tbWFuZEFyZ3VtZW50JztcbmltcG9ydCB7IFNsYXNoQ29tbWFuZFBhcnNlciB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3NsYXNoLWNvbW1hbmRzL1NsYXNoQ29tbWFuZFBhcnNlcic7XG5cbmZ1bmN0aW9uIGZvcm1hdFNsYXNoQ29tbWFuZHMoKTogc3RyaW5nIHtcbiAgY29uc3QgY21kTGlzdCA9IE9iamVjdC5rZXlzKFNsYXNoQ29tbWFuZFBhcnNlci5jb21tYW5kcylcbiAgICAuZmlsdGVyKGtleSA9PiBTbGFzaENvbW1hbmRQYXJzZXIuY29tbWFuZHNba2V5XS5uYW1lID09PSBrZXkpIC8vIGV4Y2x1ZGUgYWxpYXNlc1xuICAgIC5zb3J0KChhLCBiKSA9PiBhLnRvTG93ZXJDYXNlKCkubG9jYWxlQ29tcGFyZShiLnRvTG93ZXJDYXNlKCkpKVxuICAgIC5tYXAoa2V5ID0+IFNsYXNoQ29tbWFuZFBhcnNlci5jb21tYW5kc1trZXldKTtcblxuICBjb25zdCB0cmFuc2Zvcm1fdW5uYW1lZF9hcmcgPSAoYXJnOiBTbGFzaENvbW1hbmRBcmd1bWVudCkgPT4ge1xuICAgIHJldHVybiB7XG4gICAgICBpc19yZXF1aXJlZDogYXJnLmlzUmVxdWlyZWQsXG4gICAgICBkZWZhdWx0X3ZhbHVlOiBhcmcuZGVmYXVsdFZhbHVlID8/IHVuZGVmaW5lZCxcbiAgICAgIGFjY2VwdHNfbXVsdGlwbGU6IGFyZy5hY2NlcHRzTXVsdGlwbGUsXG4gICAgICBlbnVtX2xpc3Q6IGFyZy5lbnVtTGlzdC5sZW5ndGggPiAwID8gYXJnLmVudW1MaXN0Lm1hcChlID0+IGUudmFsdWUpIDogdW5kZWZpbmVkLFxuICAgICAgdHlwZV9saXN0OiBhcmcudHlwZUxpc3QubGVuZ3RoID4gMCA/IGFyZy50eXBlTGlzdCA6IHVuZGVmaW5lZCxcbiAgICB9O1xuICB9O1xuXG4gIGNvbnN0IHRyYW5zZm9ybV9uYW1lZF9hcmcgPSAoYXJnOiBTbGFzaENvbW1hbmROYW1lZEFyZ3VtZW50KSA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IGFyZy5uYW1lLFxuICAgICAgLi4udHJhbnNmb3JtX3VubmFtZWRfYXJnKGFyZyksXG4gICAgfTtcbiAgfTtcblxuICBjb25zdCB0cmFuc2Zvcm1faGVscF9zdHJpbmcgPSAoaGVscF9zdHJpbmc6IHN0cmluZykgPT4ge1xuICAgIGNvbnN0IGNvbnRlbnQgPSAkKCc8c3Bhbj4nKS5odG1sKGhlbHBfc3RyaW5nKTtcbiAgICByZXR1cm4gY29udGVudFxuICAgICAgLnRleHQoKVxuICAgICAgLnNwbGl0KCdcXG4nKVxuICAgICAgLm1hcChsaW5lID0+IGxpbmUudHJpbSgpKVxuICAgICAgLmZpbHRlcihsaW5lID0+IGxpbmUgIT09ICcnKVxuICAgICAgLmpvaW4oJyAnKTtcbiAgfTtcblxuICByZXR1cm4gY21kTGlzdFxuICAgIC5tYXAoY21kID0+ICh7XG4gICAgICBuYW1lOiBjbWQubmFtZSxcbiAgICAgIG5hbWVkX2FyZ3M6IGNtZC5uYW1lZEFyZ3VtZW50TGlzdC5tYXAodHJhbnNmb3JtX25hbWVkX2FyZykgPz8gW10sXG4gICAgICB1bm5hbWVkX2FyZ3M6IGNtZC51bm5hbWVkQXJndW1lbnRMaXN0Lm1hcCh0cmFuc2Zvcm1fdW5uYW1lZF9hcmcpID8/IFtdLFxuICAgICAgcmV0dXJuX3R5cGU6IGNtZC5yZXR1cm5zID8/ICd2b2lkJyxcbiAgICAgIGhlbHBfc3RyaW5nOiB0cmFuc2Zvcm1faGVscF9zdHJpbmcoY21kLmhlbHBTdHJpbmcpID8/ICdOTyBERVRBSUxTJyxcbiAgICB9KSlcbiAgICAubWFwKFxuICAgICAgY21kID0+XG4gICAgICAgIGAvJHtjbWQubmFtZX0ke2NtZC5uYW1lZF9hcmdzLmxlbmd0aCA+IDAgPyBgIGAgOiBgYH0ke2NtZC5uYW1lZF9hcmdzXG4gICAgICAgICAgLm1hcChcbiAgICAgICAgICAgIGFyZyA9PlxuICAgICAgICAgICAgICBgWyR7YXJnLmFjY2VwdHNfbXVsdGlwbGUgPyBgLi4uYCA6IGBgfSR7YXJnLm5hbWV9PSR7XG4gICAgICAgICAgICAgICAgYXJnLmVudW1fbGlzdCA/IGFyZy5lbnVtX2xpc3Quam9pbignfCcpIDogYXJnLnR5cGVfbGlzdCA/IGFyZy50eXBlX2xpc3Quam9pbignfCcpIDogJydcbiAgICAgICAgICAgICAgfV0ke2FyZy5pc19yZXF1aXJlZCA/IGBgIDogYD9gfSR7YXJnLmRlZmF1bHRfdmFsdWUgPyBgPSR7YXJnLmRlZmF1bHRfdmFsdWV9YCA6IGBgfWAsXG4gICAgICAgICAgKVxuICAgICAgICAgIC5qb2luKCcgJyl9JHtjbWQudW5uYW1lZF9hcmdzLmxlbmd0aCA+IDAgPyBgIGAgOiBgYH0ke2NtZC51bm5hbWVkX2FyZ3NcbiAgICAgICAgICAubWFwKFxuICAgICAgICAgICAgYXJnID0+XG4gICAgICAgICAgICAgIGAoJHthcmcuYWNjZXB0c19tdWx0aXBsZSA/IGAuLi5gIDogYGB9JHtcbiAgICAgICAgICAgICAgICBhcmcuZW51bV9saXN0ID8gYXJnLmVudW1fbGlzdC5qb2luKCd8JykgOiBhcmcudHlwZV9saXN0ID8gYXJnLnR5cGVfbGlzdC5qb2luKCd8JykgOiAnJ1xuICAgICAgICAgICAgICB9KSR7YXJnLmlzX3JlcXVpcmVkID8gYGAgOiBgP2B9JHthcmcuZGVmYXVsdF92YWx1ZSA/IGA9JHthcmcuZGVmYXVsdF92YWx1ZX1gIDogYGB9YCxcbiAgICAgICAgICApXG4gICAgICAgICAgLmpvaW4oJyAnKX0gLy8gJHtjbWQuaGVscF9zdHJpbmd9YCxcbiAgICApXG4gICAgLmpvaW4oJ1xcbicpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaW5pdFJlZmVyZW5jZSgpIHtcbiAgJCgnI2Rvd25sb2FkX3NsYXNoX2NvbW1hbmRzJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IHVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwobmV3IEJsb2IoW2Zvcm1hdFNsYXNoQ29tbWFuZHMoKV0sIHsgdHlwZTogJ3RleHQvcGxhaW4nIH0pKTtcbiAgICAkKHRoaXMpLmF0dHIoJ2hyZWYnLCB1cmwpO1xuICAgICQodGhpcykuYXR0cignZG93bmxvYWQnLCAnc2xhc2hfY29tbWFuZC50eHQnKTtcbiAgICBzZXRUaW1lb3V0KCgpID0+IFVSTC5yZXZva2VPYmplY3RVUkwodXJsKSwgMCk7XG4gIH0pO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/component/reference/index.ts\n\n}")},"./src/component/script_iframe.ts":
/*!****************************************!*\
  !*** ./src/component/script_iframe.ts ***!
  \****************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   destroyCharacterLevelOnExtension: () => (/* binding */ destroyCharacterLevelOnExtension),\n/* harmony export */   initializeCharacterLevelOnExtension: () => (/* binding */ initializeCharacterLevelOnExtension)\n/* harmony export */ });\n/* harmony import */ var _function_tavern_regex__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/function/tavern_regex */ \"./src/function/tavern_regex.ts\");\n/* harmony import */ var _script_url__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/script_url */ \"./src/script_url.ts\");\n/* harmony import */ var _third_party_html__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/third_party.html */ \"./src/third_party.html\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_4__);\n\n\n\n\n\nfunction loadScripts() {\n    const prefix = '脚本-';\n    const filterScriptFromRegex = (script) => script.scriptName.replace(/^【.*】/, '').startsWith(prefix);\n    const isEnabled = (script) => !script.disabled;\n    const toName = (script) => script.scriptName.replace(/^【.*】/, '').replace(prefix, '');\n    const scripts = [];\n    const enabled_global_regexes = (0,_function_tavern_regex__WEBPACK_IMPORTED_MODULE_0__.getGlobalRegexes)().filter(filterScriptFromRegex).filter(isEnabled);\n    scripts.push(...enabled_global_regexes);\n    const enabled_character_regexes = (0,_function_tavern_regex__WEBPACK_IMPORTED_MODULE_0__.getCharacterRegexes)()\n        .filter(filterScriptFromRegex)\n        .filter(isEnabled)\n        .filter(script => ((0,_function_tavern_regex__WEBPACK_IMPORTED_MODULE_0__.isCharacterTavernRegexEnabled)() ? true : script.runOnEdit));\n    scripts.push(...enabled_character_regexes);\n    const to_script = (script) => ({ name: toName(script), code: script.replaceString });\n    return scripts.map(to_script);\n}\nconst script_map = new Map();\nfunction makeScriptIframe(script) {\n    const iframe = document.createElement('iframe');\n    iframe.style.display = 'none';\n    iframe.id = `script-iframe-${script.name}`;\n    const srcdocContent = `\n    <html>\n    <head>\n      ${_third_party_html__WEBPACK_IMPORTED_MODULE_2__[\"default\"]}\n      <script src=\"${_script_url__WEBPACK_IMPORTED_MODULE_1__.script_url.get('iframe_client')}\"><\/script>\n    </head>\n    <body>\n      ${script.code}\n    </body>\n    </html>\n  `;\n    iframe.srcdoc = srcdocContent;\n    const load_promise = new Promise(resolve => {\n        iframe.onload = () => {\n            loglevel__WEBPACK_IMPORTED_MODULE_4___default().info(`[(deprecated)Script](${iframe.id}) 加载完毕`);\n            resolve();\n        };\n    });\n    document.body.appendChild(iframe);\n    return { iframe, load_promise };\n}\nfunction destroy() {\n    if (script_map.size !== 0) {\n        loglevel__WEBPACK_IMPORTED_MODULE_4___default().info(`[(deprecated)Script] 清理全局脚本...`);\n        script_map.forEach((iframe, _) => {\n            iframe.remove();\n        });\n        script_map.clear();\n        loglevel__WEBPACK_IMPORTED_MODULE_4___default().info(`[(deprecated)Script] 全局脚本清理完成!`);\n    }\n}\nasync function initialize() {\n    try {\n        destroy();\n        const scripts = loadScripts();\n        loglevel__WEBPACK_IMPORTED_MODULE_4___default().info(`[(deprecated)Script] 加载全局脚本: ${JSON.stringify(scripts.map(script => script.name))}`);\n        const load_promises = [];\n        scripts.forEach(script => {\n            const { iframe, load_promise } = makeScriptIframe(script);\n            script_map.set(script.name, iframe);\n            load_promises.push(load_promise);\n        });\n        await Promise.allSettled(load_promises);\n    }\n    catch (error) {\n        loglevel__WEBPACK_IMPORTED_MODULE_4___default().error('[(deprecated)Script] 全局脚本加载失败:', error);\n        throw error;\n    }\n}\nconst load_events = [_sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.event_types.CHAT_CHANGED];\nfunction initializeCharacterLevelOnExtension() {\n    initialize();\n    load_events.forEach(eventType => {\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.eventSource.makeFirst(eventType, initialize);\n    });\n}\nfunction destroyCharacterLevelOnExtension() {\n    load_events.forEach(eventType => {\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.eventSource.removeListener(eventType, initialize);\n    });\n    destroy();\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O0FBQ0gsQ0FBQztBQUVELE1BQU0sV0FBVyxHQUFHLENBQUMsNERBQVcsQ0FBQyxZQUFZLENBQVUsQ0FBQztBQUVqRCxTQUFTLG1DQUFtQztJQUNqRCxVQUFVLEVBQUUsQ0FBQztJQUNiLFdBQVcsQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLEVBQUU7UUFDOUIsNERBQVcsQ0FBQyxTQUFTLENBQUMsU0FBUyxFQUFFLFVBQVUsQ0FBQyxDQUFDO0lBQy9DLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQztBQUVNLFNBQVMsZ0NBQWdDO0lBQzlDLFdBQVcsQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLEVBQUU7UUFDOUIsNERBQVcsQ0FBQyxjQUFjLENBQUMsU0FBUyxFQUFFLFVBQVUsQ0FBQyxDQUFDO0lBQ3BELENBQUMsQ0FBQyxDQUFDO0lBQ0gsT0FBTyxFQUFFLENBQUM7QUFDWixDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBvbmVudC9zY3JpcHRfaWZyYW1lLnRzPzc0NzIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ2V0Q2hhcmFjdGVyUmVnZXhlcywgZ2V0R2xvYmFsUmVnZXhlcywgaXNDaGFyYWN0ZXJUYXZlcm5SZWdleEVuYWJsZWQgfSBmcm9tICdAL2Z1bmN0aW9uL3RhdmVybl9yZWdleCc7XG5pbXBvcnQgeyBzY3JpcHRfdXJsIH0gZnJvbSAnQC9zY3JpcHRfdXJsJztcbmltcG9ydCB0aGlyZF9wYXJ0eSBmcm9tICdAL3RoaXJkX3BhcnR5Lmh0bWwnO1xuXG5pbXBvcnQgeyBldmVudF90eXBlcywgZXZlbnRTb3VyY2UgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0JztcbmltcG9ydCB7IFJlZ2V4U2NyaXB0RGF0YSB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL2NoYXItZGF0YSc7XG5cbmltcG9ydCBsb2cgZnJvbSAnbG9nbGV2ZWwnO1xuXG5pbnRlcmZhY2UgU2NyaXB0IHtcbiAgbmFtZTogc3RyaW5nO1xuICBjb2RlOiBzdHJpbmc7XG59XG5cbmZ1bmN0aW9uIGxvYWRTY3JpcHRzKCk6IFNjcmlwdFtdIHtcbiAgY29uc3QgcHJlZml4ID0gJ+iEmuacrC0nO1xuICBjb25zdCBmaWx0ZXJTY3JpcHRGcm9tUmVnZXggPSAoc2NyaXB0OiBSZWdleFNjcmlwdERhdGEpID0+XG4gICAgc2NyaXB0LnNjcmlwdE5hbWUucmVwbGFjZSgvXuOAkC4q44CRLywgJycpLnN0YXJ0c1dpdGgocHJlZml4KTtcbiAgY29uc3QgaXNFbmFibGVkID0gKHNjcmlwdDogUmVnZXhTY3JpcHREYXRhKSA9PiAhc2NyaXB0LmRpc2FibGVkO1xuICBjb25zdCB0b05hbWUgPSAoc2NyaXB0OiBSZWdleFNjcmlwdERhdGEpID0+IHNjcmlwdC5zY3JpcHROYW1lLnJlcGxhY2UoL17jgJAuKuOAkS8sICcnKS5yZXBsYWNlKHByZWZpeCwgJycpO1xuXG4gIGNvbnN0IHNjcmlwdHM6IFJlZ2V4U2NyaXB0RGF0YVtdID0gW107XG5cbiAgY29uc3QgZW5hYmxlZF9nbG9iYWxfcmVnZXhlcyA9IGdldEdsb2JhbFJlZ2V4ZXMoKS5maWx0ZXIoZmlsdGVyU2NyaXB0RnJvbVJlZ2V4KS5maWx0ZXIoaXNFbmFibGVkKTtcbiAgc2NyaXB0cy5wdXNoKC4uLmVuYWJsZWRfZ2xvYmFsX3JlZ2V4ZXMpO1xuXG4gIGNvbnN0IGVuYWJsZWRfY2hhcmFjdGVyX3JlZ2V4ZXMgPSBnZXRDaGFyYWN0ZXJSZWdleGVzKClcbiAgICAuZmlsdGVyKGZpbHRlclNjcmlwdEZyb21SZWdleClcbiAgICAuZmlsdGVyKGlzRW5hYmxlZClcbiAgICAuZmlsdGVyKHNjcmlwdCA9PiAoaXNDaGFyYWN0ZXJUYXZlcm5SZWdleEVuYWJsZWQoKSA/IHRydWUgOiBzY3JpcHQucnVuT25FZGl0KSk7XG4gIHNjcmlwdHMucHVzaCguLi5lbmFibGVkX2NoYXJhY3Rlcl9yZWdleGVzKTtcblxuICBjb25zdCB0b19zY3JpcHQgPSAoc2NyaXB0OiBSZWdleFNjcmlwdERhdGEpID0+ICh7IG5hbWU6IHRvTmFtZShzY3JpcHQpLCBjb2RlOiBzY3JpcHQucmVwbGFjZVN0cmluZyB9KTtcbiAgcmV0dXJuIHNjcmlwdHMubWFwKHRvX3NjcmlwdCk7XG59XG5cbmNvbnN0IHNjcmlwdF9tYXA6IE1hcDxzdHJpbmcsIEhUTUxJRnJhbWVFbGVtZW50PiA9IG5ldyBNYXAoKTtcblxuZnVuY3Rpb24gbWFrZVNjcmlwdElmcmFtZShzY3JpcHQ6IFNjcmlwdCk6IHsgaWZyYW1lOiBIVE1MSUZyYW1lRWxlbWVudDsgbG9hZF9wcm9taXNlOiBQcm9taXNlPHZvaWQ+IH0ge1xuICBjb25zdCBpZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpZnJhbWUnKTtcbiAgaWZyYW1lLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gIGlmcmFtZS5pZCA9IGBzY3JpcHQtaWZyYW1lLSR7c2NyaXB0Lm5hbWV9YDtcblxuICBjb25zdCBzcmNkb2NDb250ZW50ID0gYFxuICAgIDxodG1sPlxuICAgIDxoZWFkPlxuICAgICAgJHt0aGlyZF9wYXJ0eX1cbiAgICAgIDxzY3JpcHQgc3JjPVwiJHtzY3JpcHRfdXJsLmdldCgnaWZyYW1lX2NsaWVudCcpfVwiPjwvc2NyaXB0PlxuICAgIDwvaGVhZD5cbiAgICA8Ym9keT5cbiAgICAgICR7c2NyaXB0LmNvZGV9XG4gICAgPC9ib2R5PlxuICAgIDwvaHRtbD5cbiAgYDtcblxuICBpZnJhbWUuc3JjZG9jID0gc3JjZG9jQ29udGVudDtcblxuICBjb25zdCBsb2FkX3Byb21pc2UgPSBuZXcgUHJvbWlzZTx2b2lkPihyZXNvbHZlID0+IHtcbiAgICBpZnJhbWUub25sb2FkID0gKCkgPT4ge1xuICAgICAgbG9nLmluZm8oYFsoZGVwcmVjYXRlZClTY3JpcHRdKCR7aWZyYW1lLmlkfSkg5Yqg6L295a6M5q+VYCk7XG4gICAgICByZXNvbHZlKCk7XG4gICAgfTtcbiAgfSk7XG5cbiAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChpZnJhbWUpO1xuXG4gIHJldHVybiB7IGlmcmFtZSwgbG9hZF9wcm9taXNlIH07XG59XG5cbmZ1bmN0aW9uIGRlc3Ryb3koKTogdm9pZCB7XG4gIGlmIChzY3JpcHRfbWFwLnNpemUgIT09IDApIHtcbiAgICBsb2cuaW5mbyhgWyhkZXByZWNhdGVkKVNjcmlwdF0g5riF55CG5YWo5bGA6ISa5pysLi4uYCk7XG4gICAgc2NyaXB0X21hcC5mb3JFYWNoKChpZnJhbWUsIF8pID0+IHtcbiAgICAgIGlmcmFtZS5yZW1vdmUoKTtcbiAgICB9KTtcbiAgICBzY3JpcHRfbWFwLmNsZWFyKCk7XG4gICAgbG9nLmluZm8oYFsoZGVwcmVjYXRlZClTY3JpcHRdIOWFqOWxgOiEmuacrOa4heeQhuWujOaIkCFgKTtcbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBpbml0aWFsaXplKCk6IFByb21pc2U8dm9pZD4ge1xuICB0cnkge1xuICAgIGRlc3Ryb3koKTtcblxuICAgIGNvbnN0IHNjcmlwdHMgPSBsb2FkU2NyaXB0cygpO1xuICAgIGxvZy5pbmZvKGBbKGRlcHJlY2F0ZWQpU2NyaXB0XSDliqDovb3lhajlsYDohJrmnKw6ICR7SlNPTi5zdHJpbmdpZnkoc2NyaXB0cy5tYXAoc2NyaXB0ID0+IHNjcmlwdC5uYW1lKSl9YCk7XG5cbiAgICBjb25zdCBsb2FkX3Byb21pc2VzOiBQcm9taXNlPHZvaWQ+W10gPSBbXTtcblxuICAgIHNjcmlwdHMuZm9yRWFjaChzY3JpcHQgPT4ge1xuICAgICAgY29uc3QgeyBpZnJhbWUsIGxvYWRfcHJvbWlzZSB9ID0gbWFrZVNjcmlwdElmcmFtZShzY3JpcHQpO1xuICAgICAgc2NyaXB0X21hcC5zZXQoc2NyaXB0Lm5hbWUsIGlmcmFtZSk7XG4gICAgICBsb2FkX3Byb21pc2VzLnB1c2gobG9hZF9wcm9taXNlKTtcbiAgICB9KTtcblxuICAgIGF3YWl0IFByb21pc2UuYWxsU2V0dGxlZChsb2FkX3Byb21pc2VzKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBsb2cuZXJyb3IoJ1soZGVwcmVjYXRlZClTY3JpcHRdIOWFqOWxgOiEmuacrOWKoOi9veWksei0pTonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxuY29uc3QgbG9hZF9ldmVudHMgPSBbZXZlbnRfdHlwZXMuQ0hBVF9DSEFOR0VEXSBhcyBjb25zdDtcblxuZXhwb3J0IGZ1bmN0aW9uIGluaXRpYWxpemVDaGFyYWN0ZXJMZXZlbE9uRXh0ZW5zaW9uKCkge1xuICBpbml0aWFsaXplKCk7XG4gIGxvYWRfZXZlbnRzLmZvckVhY2goZXZlbnRUeXBlID0+IHtcbiAgICBldmVudFNvdXJjZS5tYWtlRmlyc3QoZXZlbnRUeXBlLCBpbml0aWFsaXplKTtcbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZXN0cm95Q2hhcmFjdGVyTGV2ZWxPbkV4dGVuc2lvbigpIHtcbiAgbG9hZF9ldmVudHMuZm9yRWFjaChldmVudFR5cGUgPT4ge1xuICAgIGV2ZW50U291cmNlLnJlbW92ZUxpc3RlbmVyKGV2ZW50VHlwZSwgaW5pdGlhbGl6ZSk7XG4gIH0pO1xuICBkZXN0cm95KCk7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/component/script_iframe.ts\n\n}")},"./src/component/script_repository/builtin_scripts.ts":
/*!************************************************************!*\
  !*** ./src/component/script_repository/builtin_scripts.ts ***!
  \************************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DEFAULT_SCRIPT_CONFIGS: () => (/* binding */ DEFAULT_SCRIPT_CONFIGS),\n/* harmony export */   createDefaultScript: () => (/* binding */ createDefaultScript),\n/* harmony export */   createDefaultScripts: () => (/* binding */ createDefaultScripts),\n/* harmony export */   createScript: () => (/* binding */ createScript)\n/* harmony export */ });\n/* harmony import */ var _util_is_url__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/util/is_url */ \"./src/util/is_url.ts\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_1__);\n\n\n/**\n * 默认脚本配置\n * 包含每个默认脚本的基本信息\n */\nconst DEFAULT_SCRIPT_CONFIGS = {\n    标签化: {\n        name: '标签化: 随世界书、预设或链接配置自动开关正则、提示词条目',\n        content: 'https://testingcf.jsdelivr.net/gh/StageDog/tavern_resource/dist/酒馆助手/标签化/index.js',\n        info: 'https://testingcf.jsdelivr.net/gh/StageDog/tavern_resource/src/酒馆助手/标签化/README.md',\n    },\n    预设防误触: {\n        name: '预设防误触',\n        content: 'https://testingcf.jsdelivr.net/gh/StageDog/tavern_resource/dist/酒馆助手/预设防误触/index.js',\n        info: 'https://testingcf.jsdelivr.net/gh/StageDog/tavern_resource/src/酒馆助手/预设防误触/README.md',\n    },\n    世界书强制自定义排序: {\n        name: '世界书强制自定义排序',\n        content: 'https://testingcf.jsdelivr.net/gh/StageDog/tavern_resource/dist/酒馆助手/世界书强制自定义排序/index.js',\n        info: 'https://testingcf.jsdelivr.net/gh/StageDog/tavern_resource/src/酒馆助手/世界书强制自定义排序/README.md',\n    },\n    世界书强制用推荐的全局设置: {\n        name: '世界书强制用推荐的全局设置',\n        content: 'https://testingcf.jsdelivr.net/gh/StageDog/tavern_resource/dist/酒馆助手/世界书强制用推荐的全局设置/index.js',\n        info: 'https://testingcf.jsdelivr.net/gh/StageDog/tavern_resource/src/酒馆助手/世界书强制用推荐的全局设置/README.md',\n    },\n    预设条目更多按钮: {\n        name: '预设条目更多按钮: 一键新增预设条目',\n        content: 'https://fastly.jsdelivr.net/gh/StageDog/tavern_resource/dist/酒馆助手/预设条目更多按钮/index.js',\n        info: 'https://testingcf.jsdelivr.net/gh/StageDog/tavern_resource/src/酒馆助手/预设条目更多按钮/README.md',\n    },\n    自动开启角色卡局部正则: {\n        name: '自动开启角色卡局部正则',\n        content: 'https://testingcf.jsdelivr.net/gh/StageDog/tavern_resource/dist/酒馆助手/自动开启角色卡局部正则/index.js',\n        info: 'https://testingcf.jsdelivr.net/gh/StageDog/tavern_resource/src/酒馆助手/自动开启角色卡局部正则/README.md',\n    },\n};\nfunction loadScriptContent(content) {\n    return (0,_util_is_url__WEBPACK_IMPORTED_MODULE_0__.isUrl)(content) ? `import '${content}'` : content;\n}\nasync function loadScriptInfo(info) {\n    return (0,_util_is_url__WEBPACK_IMPORTED_MODULE_0__.isUrl)(info) ? (await fetch(info)).text() : info;\n}\n/**\n * 创建单个默认脚本\n * @param script_id 脚本ID\n * @returns 脚本对象\n */\nasync function createDefaultScript(script_id) {\n    const config = DEFAULT_SCRIPT_CONFIGS[script_id];\n    if (!config) {\n        loglevel__WEBPACK_IMPORTED_MODULE_1___default().error(`[ScriptManager] 未找到脚本配置: ${script_id}`);\n        return null;\n    }\n    try {\n        return {\n            id: script_id,\n            name: config.name,\n            content: loadScriptContent(config.content),\n            info: await loadScriptInfo(config.info),\n            enabled: false,\n            buttons: [],\n            data: {},\n        };\n    }\n    catch (error) {\n        loglevel__WEBPACK_IMPORTED_MODULE_1___default().error(`[ScriptManager] 创建默认脚本失败: ${script_id}:`, error);\n        return null;\n    }\n}\n/**\n * 创建指定类型的默认脚本\n * @param type 脚本类型\n * @returns 脚本对象\n */\nasync function createScript(type) {\n    return (await createDefaultScript(type)) || {};\n}\n/**\n * 创建所有默认脚本\n * @returns 默认脚本数组\n */\nasync function createDefaultScripts() {\n    toastr.info('正在加载默认脚本...');\n    const result = await Promise.all(Object.keys(DEFAULT_SCRIPT_CONFIGS).map(script_id => createDefaultScript(script_id)));\n    if (result.some(item => item === null)) {\n        toastr.error('创建默认脚本失败');\n    }\n    else {\n        toastr.success('创建默认脚本成功');\n    }\n    return result;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L2J1aWx0aW5fc2NyaXB0cy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQXNDO0FBRVg7QUFXM0I7OztHQUdHO0FBQ0ksTUFBTSxzQkFBc0IsR0FBaUM7SUFDbEUsR0FBRyxFQUFFO1FBQ0gsSUFBSSxFQUFFLCtCQUErQjtRQUNyQyxPQUFPLEVBQUUsbUZBQW1GO1FBQzVGLElBQUksRUFBRSxtRkFBbUY7S0FDMUY7SUFDRCxLQUFLLEVBQUU7UUFDTCxJQUFJLEVBQUUsT0FBTztRQUNiLE9BQU8sRUFBRSxxRkFBcUY7UUFDOUYsSUFBSSxFQUFFLHFGQUFxRjtLQUM1RjtJQUNELFVBQVUsRUFBRTtRQUNWLElBQUksRUFBRSxZQUFZO1FBQ2xCLE9BQU8sRUFBRSwwRkFBMEY7UUFDbkcsSUFBSSxFQUFFLDBGQUEwRjtLQUNqRztJQUNELGFBQWEsRUFBRTtRQUNiLElBQUksRUFBRSxlQUFlO1FBQ3JCLE9BQU8sRUFDTCw2RkFBNkY7UUFDL0YsSUFBSSxFQUFFLDZGQUE2RjtLQUNwRztJQUNELFFBQVEsRUFBRTtRQUNSLElBQUksRUFBRSxvQkFBb0I7UUFDMUIsT0FBTyxFQUFFLHFGQUFxRjtRQUM5RixJQUFJLEVBQUUsd0ZBQXdGO0tBQy9GO0lBQ0QsV0FBVyxFQUFFO1FBQ1gsSUFBSSxFQUFFLGFBQWE7UUFDbkIsT0FBTyxFQUFFLDJGQUEyRjtRQUNwRyxJQUFJLEVBQUUsMkZBQTJGO0tBQ2xHO0NBQ0YsQ0FBQztBQUVGLFNBQVMsaUJBQWlCLENBQUMsT0FBZTtJQUN4QyxPQUFPLG1EQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLFdBQVcsT0FBTyxHQUFHLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQztBQUMxRCxDQUFDO0FBRUQsS0FBSyxVQUFVLGNBQWMsQ0FBQyxJQUFZO0lBQ3hDLE9BQU8sbURBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUM7QUFDekQsQ0FBQztBQUVEOzs7O0dBSUc7QUFDSSxLQUFLLFVBQVUsbUJBQW1CLENBQUMsU0FBaUI7SUFDekQsTUFBTSxNQUFNLEdBQUcsc0JBQXNCLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDakQsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDO1FBQ1oscURBQVMsQ0FBQyw0QkFBNEIsU0FBUyxFQUFFLENBQUMsQ0FBQztRQUNuRCxPQUFPLElBQUksQ0FBQztJQUNkLENBQUM7SUFFRCxJQUFJLENBQUM7UUFDSCxPQUFPO1lBQ0wsRUFBRSxFQUFFLFNBQVM7WUFDYixJQUFJLEVBQUUsTUFBTSxDQUFDLElBQUk7WUFDakIsT0FBTyxFQUFFLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUM7WUFDMUMsSUFBSSxFQUFFLE1BQU0sY0FBYyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUM7WUFDdkMsT0FBTyxFQUFFLEtBQUs7WUFDZCxPQUFPLEVBQUUsRUFBRTtZQUNYLElBQUksRUFBRSxFQUFFO1NBQ1QsQ0FBQztJQUNKLENBQUM7SUFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO1FBQ2YscURBQVMsQ0FBQyw2QkFBNkIsU0FBUyxHQUFHLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDNUQsT0FBTyxJQUFJLENBQUM7SUFDZCxDQUFDO0FBQ0gsQ0FBQztBQUVEOzs7O0dBSUc7QUFDSSxLQUFLLFVBQVUsWUFBWSxDQUFDLElBQXlDO0lBQzFFLE9BQU8sQ0FBQyxNQUFNLG1CQUFtQixDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDO0FBQ2pELENBQUM7QUFFRDs7O0dBR0c7QUFDSSxLQUFLLFVBQVUsb0JBQW9CO0lBQ3hDLE1BQU0sQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUM7SUFDM0IsTUFBTSxNQUFNLEdBQUcsTUFBTSxPQUFPLENBQUMsR0FBRyxDQUM5QixNQUFNLENBQUMsSUFBSSxDQUFDLHNCQUFzQixDQUFDLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxFQUFFLENBQUMsbUJBQW1CLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FDckYsQ0FBQztJQUNGLElBQUksTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksS0FBSyxJQUFJLENBQUMsRUFBRSxDQUFDO1FBQ3ZDLE1BQU0sQ0FBQyxLQUFLLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDM0IsQ0FBQztTQUFNLENBQUM7UUFDTixNQUFNLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBQzdCLENBQUM7SUFDRCxPQUFPLE1BQU0sQ0FBQztBQUNoQixDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBvbmVudC9zY3JpcHRfcmVwb3NpdG9yeS9idWlsdGluX3NjcmlwdHMudHM/ZWQyZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBpc1VybCB9IGZyb20gJ0AvdXRpbC9pc191cmwnO1xuXG5pbXBvcnQgbG9nIGZyb20gJ2xvZ2xldmVsJztcblxuLyoqXG4gKiDpu5jorqTohJrmnKzphY3nva7nsbvlnotcbiAqL1xudHlwZSBTY3JpcHRDb25maWcgPSB7XG4gIG5hbWU6IHN0cmluZztcbiAgY29udGVudDogc3RyaW5nO1xuICBpbmZvOiBzdHJpbmc7XG59O1xuXG4vKipcbiAqIOm7mOiupOiEmuacrOmFjee9rlxuICog5YyF5ZCr5q+P5Liq6buY6K6k6ISa5pys55qE5Z+65pys5L+h5oGvXG4gKi9cbmV4cG9ydCBjb25zdCBERUZBVUxUX1NDUklQVF9DT05GSUdTOiBSZWNvcmQ8c3RyaW5nLCBTY3JpcHRDb25maWc+ID0ge1xuICDmoIfnrb7ljJY6IHtcbiAgICBuYW1lOiAn5qCH562+5YyWOiDpmo/kuJbnlYzkuabjgIHpooTorr7miJbpk77mjqXphY3nva7oh6rliqjlvIDlhbPmraPliJnjgIHmj5DnpLror43mnaHnm64nLFxuICAgIGNvbnRlbnQ6ICdodHRwczovL3Rlc3RpbmdjZi5qc2RlbGl2ci5uZXQvZ2gvU3RhZ2VEb2cvdGF2ZXJuX3Jlc291cmNlL2Rpc3Qv6YWS6aaG5Yqp5omLL+agh+etvuWMli9pbmRleC5qcycsXG4gICAgaW5mbzogJ2h0dHBzOi8vdGVzdGluZ2NmLmpzZGVsaXZyLm5ldC9naC9TdGFnZURvZy90YXZlcm5fcmVzb3VyY2Uvc3JjL+mFkummhuWKqeaJiy/moIfnrb7ljJYvUkVBRE1FLm1kJyxcbiAgfSxcbiAg6aKE6K6+6Ziy6K+v6KemOiB7XG4gICAgbmFtZTogJ+mihOiuvumYsuivr+inpicsXG4gICAgY29udGVudDogJ2h0dHBzOi8vdGVzdGluZ2NmLmpzZGVsaXZyLm5ldC9naC9TdGFnZURvZy90YXZlcm5fcmVzb3VyY2UvZGlzdC/phZLppobliqnmiYsv6aKE6K6+6Ziy6K+v6KemL2luZGV4LmpzJyxcbiAgICBpbmZvOiAnaHR0cHM6Ly90ZXN0aW5nY2YuanNkZWxpdnIubmV0L2doL1N0YWdlRG9nL3RhdmVybl9yZXNvdXJjZS9zcmMv6YWS6aaG5Yqp5omLL+mihOiuvumYsuivr+inpi9SRUFETUUubWQnLFxuICB9LFxuICDkuJbnlYzkuablvLrliLboh6rlrprkuYnmjpLluo86IHtcbiAgICBuYW1lOiAn5LiW55WM5Lmm5by65Yi26Ieq5a6a5LmJ5o6S5bqPJyxcbiAgICBjb250ZW50OiAnaHR0cHM6Ly90ZXN0aW5nY2YuanNkZWxpdnIubmV0L2doL1N0YWdlRG9nL3RhdmVybl9yZXNvdXJjZS9kaXN0L+mFkummhuWKqeaJiy/kuJbnlYzkuablvLrliLboh6rlrprkuYnmjpLluo8vaW5kZXguanMnLFxuICAgIGluZm86ICdodHRwczovL3Rlc3RpbmdjZi5qc2RlbGl2ci5uZXQvZ2gvU3RhZ2VEb2cvdGF2ZXJuX3Jlc291cmNlL3NyYy/phZLppobliqnmiYsv5LiW55WM5Lmm5by65Yi26Ieq5a6a5LmJ5o6S5bqPL1JFQURNRS5tZCcsXG4gIH0sXG4gIOS4lueVjOS5puW8uuWItueUqOaOqOiNkOeahOWFqOWxgOiuvue9rjoge1xuICAgIG5hbWU6ICfkuJbnlYzkuablvLrliLbnlKjmjqjojZDnmoTlhajlsYDorr7nva4nLFxuICAgIGNvbnRlbnQ6XG4gICAgICAnaHR0cHM6Ly90ZXN0aW5nY2YuanNkZWxpdnIubmV0L2doL1N0YWdlRG9nL3RhdmVybl9yZXNvdXJjZS9kaXN0L+mFkummhuWKqeaJiy/kuJbnlYzkuablvLrliLbnlKjmjqjojZDnmoTlhajlsYDorr7nva4vaW5kZXguanMnLFxuICAgIGluZm86ICdodHRwczovL3Rlc3RpbmdjZi5qc2RlbGl2ci5uZXQvZ2gvU3RhZ2VEb2cvdGF2ZXJuX3Jlc291cmNlL3NyYy/phZLppobliqnmiYsv5LiW55WM5Lmm5by65Yi255So5o6o6I2Q55qE5YWo5bGA6K6+572uL1JFQURNRS5tZCcsXG4gIH0sXG4gIOmihOiuvuadoeebruabtOWkmuaMiemSrjoge1xuICAgIG5hbWU6ICfpooTorr7mnaHnm67mm7TlpJrmjInpkq46IOS4gOmUruaWsOWinumihOiuvuadoeebricsXG4gICAgY29udGVudDogJ2h0dHBzOi8vZmFzdGx5LmpzZGVsaXZyLm5ldC9naC9TdGFnZURvZy90YXZlcm5fcmVzb3VyY2UvZGlzdC/phZLppobliqnmiYsv6aKE6K6+5p2h55uu5pu05aSa5oyJ6ZKuL2luZGV4LmpzJyxcbiAgICBpbmZvOiAnaHR0cHM6Ly90ZXN0aW5nY2YuanNkZWxpdnIubmV0L2doL1N0YWdlRG9nL3RhdmVybl9yZXNvdXJjZS9zcmMv6YWS6aaG5Yqp5omLL+mihOiuvuadoeebruabtOWkmuaMiemSri9SRUFETUUubWQnLFxuICB9LFxuICDoh6rliqjlvIDlkK/op5LoibLljaHlsYDpg6jmraPliJk6IHtcbiAgICBuYW1lOiAn6Ieq5Yqo5byA5ZCv6KeS6Imy5Y2h5bGA6YOo5q2j5YiZJyxcbiAgICBjb250ZW50OiAnaHR0cHM6Ly90ZXN0aW5nY2YuanNkZWxpdnIubmV0L2doL1N0YWdlRG9nL3RhdmVybl9yZXNvdXJjZS9kaXN0L+mFkummhuWKqeaJiy/oh6rliqjlvIDlkK/op5LoibLljaHlsYDpg6jmraPliJkvaW5kZXguanMnLFxuICAgIGluZm86ICdodHRwczovL3Rlc3RpbmdjZi5qc2RlbGl2ci5uZXQvZ2gvU3RhZ2VEb2cvdGF2ZXJuX3Jlc291cmNlL3NyYy/phZLppobliqnmiYsv6Ieq5Yqo5byA5ZCv6KeS6Imy5Y2h5bGA6YOo5q2j5YiZL1JFQURNRS5tZCcsXG4gIH0sXG59O1xuXG5mdW5jdGlvbiBsb2FkU2NyaXB0Q29udGVudChjb250ZW50OiBzdHJpbmcpOiBzdHJpbmcge1xuICByZXR1cm4gaXNVcmwoY29udGVudCkgPyBgaW1wb3J0ICcke2NvbnRlbnR9J2AgOiBjb250ZW50O1xufVxuXG5hc3luYyBmdW5jdGlvbiBsb2FkU2NyaXB0SW5mbyhpbmZvOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICByZXR1cm4gaXNVcmwoaW5mbykgPyAoYXdhaXQgZmV0Y2goaW5mbykpLnRleHQoKSA6IGluZm87XG59XG5cbi8qKlxuICog5Yib5bu65Y2V5Liq6buY6K6k6ISa5pysXG4gKiBAcGFyYW0gc2NyaXB0X2lkIOiEmuacrElEXG4gKiBAcmV0dXJucyDohJrmnKzlr7nosaFcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZURlZmF1bHRTY3JpcHQoc2NyaXB0X2lkOiBzdHJpbmcpOiBQcm9taXNlPGFueT4ge1xuICBjb25zdCBjb25maWcgPSBERUZBVUxUX1NDUklQVF9DT05GSUdTW3NjcmlwdF9pZF07XG4gIGlmICghY29uZmlnKSB7XG4gICAgbG9nLmVycm9yKGBbU2NyaXB0TWFuYWdlcl0g5pyq5om+5Yiw6ISa5pys6YWN572uOiAke3NjcmlwdF9pZH1gKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHRyeSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGlkOiBzY3JpcHRfaWQsXG4gICAgICBuYW1lOiBjb25maWcubmFtZSxcbiAgICAgIGNvbnRlbnQ6IGxvYWRTY3JpcHRDb250ZW50KGNvbmZpZy5jb250ZW50KSxcbiAgICAgIGluZm86IGF3YWl0IGxvYWRTY3JpcHRJbmZvKGNvbmZpZy5pbmZvKSxcbiAgICAgIGVuYWJsZWQ6IGZhbHNlLFxuICAgICAgYnV0dG9uczogW10sXG4gICAgICBkYXRhOiB7fSxcbiAgICB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGxvZy5lcnJvcihgW1NjcmlwdE1hbmFnZXJdIOWIm+W7uum7mOiupOiEmuacrOWksei0pTogJHtzY3JpcHRfaWR9OmAsIGVycm9yKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG4vKipcbiAqIOWIm+W7uuaMh+Wumuexu+Wei+eahOm7mOiupOiEmuacrFxuICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gKiBAcmV0dXJucyDohJrmnKzlr7nosaFcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVNjcmlwdCh0eXBlOiBrZXlvZiB0eXBlb2YgREVGQVVMVF9TQ1JJUFRfQ09ORklHUyk6IFByb21pc2U8YW55PiB7XG4gIHJldHVybiAoYXdhaXQgY3JlYXRlRGVmYXVsdFNjcmlwdCh0eXBlKSkgfHwge307XG59XG5cbi8qKlxuICog5Yib5bu65omA5pyJ6buY6K6k6ISa5pysXG4gKiBAcmV0dXJucyDpu5jorqTohJrmnKzmlbDnu4RcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZURlZmF1bHRTY3JpcHRzKCk6IFByb21pc2U8YW55W10+IHtcbiAgdG9hc3RyLmluZm8oJ+ato+WcqOWKoOi9vem7mOiupOiEmuacrC4uLicpO1xuICBjb25zdCByZXN1bHQgPSBhd2FpdCBQcm9taXNlLmFsbChcbiAgICBPYmplY3Qua2V5cyhERUZBVUxUX1NDUklQVF9DT05GSUdTKS5tYXAoc2NyaXB0X2lkID0+IGNyZWF0ZURlZmF1bHRTY3JpcHQoc2NyaXB0X2lkKSksXG4gICk7XG4gIGlmIChyZXN1bHQuc29tZShpdGVtID0+IGl0ZW0gPT09IG51bGwpKSB7XG4gICAgdG9hc3RyLmVycm9yKCfliJvlu7rpu5jorqTohJrmnKzlpLHotKUnKTtcbiAgfSBlbHNlIHtcbiAgICB0b2FzdHIuc3VjY2Vzcygn5Yib5bu66buY6K6k6ISa5pys5oiQ5YqfJyk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/component/script_repository/builtin_scripts.ts\n\n}")},"./src/component/script_repository/button.ts":
/*!***************************************************!*\
  !*** ./src/component/script_repository/button.ts ***!
  \***************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Button: () => (/* binding */ Button),\n/* harmony export */   ButtonFactory: () => (/* binding */ ButtonFactory),\n/* harmony export */   ButtonManager: () => (/* binding */ ButtonManager),\n/* harmony export */   ScriptButton: () => (/* binding */ ScriptButton),\n/* harmony export */   checkQrEnabledStatusAndAddButton: () => (/* binding */ checkQrEnabledStatusAndAddButton),\n/* harmony export */   initScriptButton: () => (/* binding */ initScriptButton)\n/* harmony export */ });\n/* harmony import */ var _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/script_repository/script_controller */ \"./src/component/script_repository/script_controller.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\nlet isQrEnabled = false;\nlet isCombined = false;\nclass Button {\n    id;\n    name;\n    visible;\n    scriptId;\n    constructor(name, scriptId, visible = true) {\n        this.id = `${scriptId}_${name}`;\n        this.name = name;\n        this.scriptId = scriptId;\n        this.visible = visible;\n    }\n    remove() {\n        $(`#${this.id}`).remove();\n    }\n}\nclass ScriptButton extends Button {\n    constructor(name, scriptId, visible = true) {\n        super(name, scriptId, visible);\n    }\n    render() {\n        return `<div class=\"qr--button menu_button interactable\" id=\"${this.id}\">${this.name}</div>`;\n    }\n    bindEvents() {\n        $(`#${this.id}`).on('click', () => {\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.eventSource.emit(this.id);\n            loglevel__WEBPACK_IMPORTED_MODULE_2___default().info(`[ScriptManager] 点击按钮：${this.id}`);\n        });\n    }\n}\nclass ButtonFactory {\n    static createButton(type, name, scriptId, visible = true) {\n        switch (type) {\n            case 'script':\n            default:\n                return new ScriptButton(name, scriptId, visible);\n        }\n    }\n}\nclass ButtonManager {\n    buttons = [];\n    isUpdating = false;\n    /**\n     * 将按钮从旧容器迁移到新容器\n     * @param oldContainerId 旧容器ID\n     * @param newContainerId 新容器ID\n     */\n    migrateButtonsToNewContainer(oldContainerId, newContainerId) {\n        const $oldButtons = $(`#${oldContainerId} .qr--button`);\n        const $newContainer = $(`#${newContainerId}`);\n        if ($oldButtons.length && $newContainer.length) {\n            $oldButtons.detach().appendTo($newContainer);\n            this.buttons.forEach(button => {\n                button.bindEvents();\n            });\n        }\n    }\n    /**\n     * 获取脚本容器ID\n     * @param scriptId 脚本ID\n     * @returns 脚本容器ID\n     */\n    getScriptContainerId(scriptId) {\n        return `script_container_${scriptId}`;\n    }\n    /**\n     * 从脚本数据创建按钮\n     * @param globalScripts 全局脚本\n     * @param characterScripts 角色脚本\n     * @param isGlobalEnabled 全局脚本是否启用\n     * @param isCharacterEnabled 角色脚本是否启用\n     */\n    createButtonsFromScripts(globalScripts, characterScripts, isGlobalEnabled, isCharacterEnabled) {\n        if (this.isUpdating) {\n            return;\n        }\n        this.isUpdating = true;\n        try {\n            this.clearButtons();\n            const hasGlobalVisibleButtons = isGlobalEnabled &&\n                globalScripts.some(script => script.enabled &&\n                    script.buttons &&\n                    script.buttons.length > 0 &&\n                    script.buttons.some(button => button.visible));\n            const hasCharacterVisibleButtons = isCharacterEnabled &&\n                characterScripts.some(script => script.enabled &&\n                    script.buttons &&\n                    script.buttons.length > 0 &&\n                    script.buttons.some(button => button.visible));\n            if (!hasGlobalVisibleButtons && !hasCharacterVisibleButtons) {\n                return;\n            }\n            if (isGlobalEnabled && hasGlobalVisibleButtons) {\n                this.addScriptButtons(globalScripts);\n            }\n            if (isCharacterEnabled && hasCharacterVisibleButtons) {\n                this.addScriptButtons(characterScripts);\n            }\n        }\n        finally {\n            setTimeout(() => {\n                this.isUpdating = false;\n            }, 100);\n        }\n    }\n    /**\n     * 添加脚本按钮\n     * @param scripts 脚本列表\n     */\n    addScriptButtons(scripts) {\n        scripts.forEach(script => {\n            if (script.enabled && script.buttons && script.buttons.length > 0) {\n                const visibleButtons = script.buttons\n                    .filter(buttonData => buttonData.visible)\n                    .map(buttonData => ButtonFactory.createButton('script', buttonData.name, script.id, buttonData.visible));\n                if (visibleButtons.length > 0) {\n                    this.addButtonsGroup(visibleButtons, script.id);\n                }\n            }\n        });\n    }\n    /**\n     * 添加按钮组\n     * @param buttons 按钮列表\n     * @param scriptId 脚本ID\n     */\n    addButtonsGroup(buttons, scriptId) {\n        if (buttons.length === 0)\n            return;\n        const containerId = this.getScriptContainerId(scriptId);\n        $(`#${containerId}`).remove();\n        let containerHtml = `<div id=\"${containerId}\" class=\"qr--buttons th--button\">`;\n        buttons.forEach(button => {\n            this.buttons = this.buttons.filter(btn => btn.id !== button.id);\n            this.buttons.push(button);\n            containerHtml += button.render();\n        });\n        containerHtml += '</div>';\n        const $sendForm = $('#send_form');\n        const $qrBar = $sendForm.find('#qr--bar');\n        if ($qrBar.length === 0) {\n            loglevel__WEBPACK_IMPORTED_MODULE_2___default().warn('[ScriptManager] qr--bar容器不存在，无法添加按钮');\n            return;\n        }\n        if (isCombined) {\n            const $combinedContainer = $qrBar.find('.qr--buttons.qr--color').first();\n            if ($combinedContainer.length > 0) {\n                $combinedContainer.append(containerHtml);\n                loglevel__WEBPACK_IMPORTED_MODULE_2___default().info(`[ScriptManager] 按钮添加到combined容器: ${scriptId}`);\n            }\n            else {\n                $qrBar.append(containerHtml);\n                loglevel__WEBPACK_IMPORTED_MODULE_2___default().info(`[ScriptManager] 按钮添加到qr--bar（无combined容器）: ${scriptId}`);\n            }\n        }\n        else {\n            $qrBar.append(containerHtml);\n            loglevel__WEBPACK_IMPORTED_MODULE_2___default().info(`[ScriptManager] 按钮添加到qr--bar: ${scriptId}`);\n        }\n        buttons.forEach(button => button.bindEvents());\n    }\n    /**\n     * 为指定脚本添加所有按钮\n     * @param script 脚本\n     */\n    addButtonsForScript(script) {\n        if (!script.buttons || script.buttons.length === 0)\n            return;\n        const visibleButtons = script.buttons\n            .filter(buttonData => buttonData.visible)\n            .map(buttonData => ButtonFactory.createButton('script', buttonData.name, script.id, buttonData.visible));\n        if (visibleButtons.length > 0) {\n            this.addButtonsGroup(visibleButtons, script.id);\n        }\n    }\n    /**\n     * 移除指定脚本的按钮\n     * @param scriptId 脚本ID\n     */\n    removeButtonsByScriptId(scriptId) {\n        const containerId = this.getScriptContainerId(scriptId);\n        $(`#${containerId}`).remove();\n    }\n    /**\n     * 清理所有按钮\n     */\n    clearButtons() {\n        this.buttons.forEach(button => button.remove());\n        this.buttons = [];\n    }\n    /**\n     * 清理资源并重置状态\n     */\n    cleanup() {\n        this.clearButtons();\n        this.isUpdating = false;\n    }\n}\nconst buttonManager = new ButtonManager();\n/**\n * 设置按钮时需要执行的行为\n */\nfunction _setButtonLogic() {\n    const scriptManager = _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_0__.ScriptManager.getInstance();\n    const globalScripts = scriptManager.getGlobalScripts();\n    const characterScripts = scriptManager.getCharacterScripts();\n    const isGlobalEnabled = scriptManager.isGlobalScriptEnabled;\n    const isCharacterEnabled = scriptManager.isCharacterScriptEnabled;\n    buttonManager.createButtonsFromScripts(globalScripts, characterScripts, isGlobalEnabled, isCharacterEnabled);\n}\n/**\n * 根据qr--isEnabled状态处理容器\n */\nfunction checkQrEnabledStatus() {\n    const qrEnabledElement = $('#qr--isEnabled');\n    isQrEnabled = qrEnabledElement.length > 0 ? qrEnabledElement.prop('checked') : false;\n    const sendForm = $('#send_form');\n    if (sendForm.length === 0) {\n        return;\n    }\n    const qrBarLength = $('#send_form #qr--bar').length;\n    if (qrBarLength === 0) {\n        if (!sendForm.find('#qr--bar').length) {\n            sendForm.append('<div class=\"flex-container flexGap5\" id=\"qr--bar\"></div>');\n            loglevel__WEBPACK_IMPORTED_MODULE_2___default().info('[ScriptManager] 创建qr--bar容器（qr未启用或不存在）');\n        }\n    }\n}\n/**\n * 检查qr--isCombined状态\n */\nfunction checkQrCombinedStatus() {\n    const qrCombinedElement = $('#qr--isCombined');\n    isCombined = qrCombinedElement.length > 0 ? qrCombinedElement.prop('checked') : false;\n    if (!isQrEnabled) {\n        const $qrBar = $('#send_form #qr--bar').first();\n        if ($qrBar.length > 0 && isCombined) {\n            const isThButtonExist = $qrBar.find('.qr--buttons.qr--color').length > 0;\n            if (!isThButtonExist) {\n                if (!$qrBar.find('.qr--buttons.qr--color').length) {\n                    $qrBar.append('<div class=\"qr--buttons qr--color\"></div>');\n                    loglevel__WEBPACK_IMPORTED_MODULE_2___default().info('[ScriptManager] 创建combined按钮容器');\n                }\n            }\n        }\n    }\n}\n/**\n * 检查qr--isEnabled和qr--isCombined状态并添加按钮\n */\nfunction checkQrEnabledStatusAndAddButton() {\n    checkQrEnabledStatus();\n    checkQrCombinedStatus();\n    _setButtonLogic();\n}\n/**\n * 初始化脚本按钮，包括确认qr容器和绑定change事件\n */\nfunction initScriptButton() {\n    checkQrEnabledStatus();\n    checkQrCombinedStatus();\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L2J1dHRvbi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBQWdGO0FBRTlCO0FBRXZCO0FBRTNCLElBQUksV0FBVyxHQUFHLEtBQUssQ0FBQztBQUN4QixJQUFJLFVBQVUsR0FBRyxLQUFLLENBQUM7QUFDaEIsTUFBZSxNQUFNO0lBQzFCLEVBQUUsQ0FBUztJQUNYLElBQUksQ0FBUztJQUNiLE9BQU8sQ0FBVTtJQUNqQixRQUFRLENBQVM7SUFFakIsWUFBWSxJQUFZLEVBQUUsUUFBZ0IsRUFBRSxVQUFtQixJQUFJO1FBQ2pFLElBQUksQ0FBQyxFQUFFLEdBQUcsR0FBRyxRQUFRLElBQUksSUFBSSxFQUFFLENBQUM7UUFDaEMsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7UUFDakIsSUFBSSxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUM7UUFDekIsSUFBSSxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUM7SUFDekIsQ0FBQztJQU1ELE1BQU07UUFDSixDQUFDLENBQUMsSUFBSSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQztJQUM1QixDQUFDO0NBQ0Y7QUFFTSxNQUFNLFlBQWEsU0FBUSxNQUFNO0lBQ3RDLFlBQVksSUFBWSxFQUFFLFFBQWdCLEVBQUUsVUFBbUIsSUFBSTtRQUNqRSxLQUFLLENBQUMsSUFBSSxFQUFFLFFBQVEsRUFBRSxPQUFPLENBQUMsQ0FBQztJQUNqQyxDQUFDO0lBRUQsTUFBTTtRQUNKLE9BQU8sd0RBQXdELElBQUksQ0FBQyxFQUFFLEtBQUssSUFBSSxDQUFDLElBQUksUUFBUSxDQUFDO0lBQy9GLENBQUM7SUFFRCxVQUFVO1FBQ1IsQ0FBQyxDQUFDLElBQUksSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxHQUFHLEVBQUU7WUFDaEMsNERBQVcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVB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O1FBQ0gsQ0FBQztJQUNILENBQUM7QUFDSCxDQUFDO0FBRUQ7O0dBRUc7QUFDSSxTQUFTLGdDQUFnQztJQUM5QyxvQkFBb0IsRUFBRSxDQUFDO0lBQ3ZCLHFCQUFxQixFQUFFLENBQUM7SUFDeEIsZUFBZSxFQUFFLENBQUM7QUFDcEIsQ0FBQztBQUVEOztHQUVHO0FBQ0ksU0FBUyxnQkFBZ0I7SUFDOUIsb0JBQW9CLEVBQUUsQ0FBQztJQUN2QixxQkFBcUIsRUFBRSxDQUFDO0FBQzFCLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L2J1dHRvbi50cz9lMjJiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFNjcmlwdE1hbmFnZXIgfSBmcm9tICdAL2NvbXBvbmVudC9zY3JpcHRfcmVwb3NpdG9yeS9zY3JpcHRfY29udHJvbGxlcic7XG5pbXBvcnQgeyBTY3JpcHQgfSBmcm9tICdAL2NvbXBvbmVudC9zY3JpcHRfcmVwb3NpdG9yeS90eXBlcyc7XG5pbXBvcnQgeyBldmVudFNvdXJjZSB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHQnO1xuXG5pbXBvcnQgbG9nIGZyb20gJ2xvZ2xldmVsJztcblxubGV0IGlzUXJFbmFibGVkID0gZmFsc2U7XG5sZXQgaXNDb21iaW5lZCA9IGZhbHNlO1xuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEJ1dHRvbiB7XG4gIGlkOiBzdHJpbmc7XG4gIG5hbWU6IHN0cmluZztcbiAgdmlzaWJsZTogYm9vbGVhbjtcbiAgc2NyaXB0SWQ6IHN0cmluZztcblxuICBjb25zdHJ1Y3RvcihuYW1lOiBzdHJpbmcsIHNjcmlwdElkOiBzdHJpbmcsIHZpc2libGU6IGJvb2xlYW4gPSB0cnVlKSB7XG4gICAgdGhpcy5pZCA9IGAke3NjcmlwdElkfV8ke25hbWV9YDtcbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgIHRoaXMuc2NyaXB0SWQgPSBzY3JpcHRJZDtcbiAgICB0aGlzLnZpc2libGUgPSB2aXNpYmxlO1xuICB9XG5cbiAgYWJzdHJhY3QgcmVuZGVyKCk6IHN0cmluZztcblxuICBhYnN0cmFjdCBiaW5kRXZlbnRzKCk6IHZvaWQ7XG5cbiAgcmVtb3ZlKCk6IHZvaWQge1xuICAgICQoYCMke3RoaXMuaWR9YCkucmVtb3ZlKCk7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFNjcmlwdEJ1dHRvbiBleHRlbmRzIEJ1dHRvbiB7XG4gIGNvbnN0cnVjdG9yKG5hbWU6IHN0cmluZywgc2NyaXB0SWQ6IHN0cmluZywgdmlzaWJsZTogYm9vbGVhbiA9IHRydWUpIHtcbiAgICBzdXBlcihuYW1lLCBzY3JpcHRJZCwgdmlzaWJsZSk7XG4gIH1cblxuICByZW5kZXIoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYDxkaXYgY2xhc3M9XCJxci0tYnV0dG9uIG1lbnVfYnV0dG9uIGludGVyYWN0YWJsZVwiIGlkPVwiJHt0aGlzLmlkfVwiPiR7dGhpcy5uYW1lfTwvZGl2PmA7XG4gIH1cblxuICBiaW5kRXZlbnRzKCk6IHZvaWQge1xuICAgICQoYCMke3RoaXMuaWR9YCkub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgZXZlbnRTb3VyY2UuZW1pdCh0aGlzLmlkKTtcbiAgICAgIGxvZy5pbmZvKGBbU2NyaXB0TWFuYWdlcl0g54K55Ye75oyJ6ZKu77yaJHt0aGlzLmlkfWApO1xuICAgIH0pO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBCdXR0b25GYWN0b3J5IHtcbiAgc3RhdGljIGNyZWF0ZUJ1dHRvbih0eXBlOiBzdHJpbmcsIG5hbWU6IHN0cmluZywgc2NyaXB0SWQ6IHN0cmluZywgdmlzaWJsZTogYm9vbGVhbiA9IHRydWUpOiBCdXR0b24ge1xuICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgY2FzZSAnc2NyaXB0JzpcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBuZXcgU2NyaXB0QnV0dG9uKG5hbWUsIHNjcmlwdElkLCB2aXNpYmxlKTtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIEJ1dHRvbk1hbmFnZXIge1xuICBwcml2YXRlIGJ1dHRvbnM6IEJ1dHRvbltdID0gW107XG4gIHByaXZhdGUgaXNVcGRhdGluZzogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIC8qKlxuICAgKiDlsIbmjInpkq7ku47ml6flrrnlmajov4Hnp7vliLDmlrDlrrnlmahcbiAgICogQHBhcmFtIG9sZENvbnRhaW5lcklkIOaXp+WuueWZqElEXG4gICAqIEBwYXJhbSBuZXdDb250YWluZXJJZCDmlrDlrrnlmahJRFxuICAgKi9cbiAgbWlncmF0ZUJ1dHRvbnNUb05ld0NvbnRhaW5lcihvbGRDb250YWluZXJJZDogc3RyaW5nLCBuZXdDb250YWluZXJJZDogc3RyaW5nKTogdm9pZCB7XG4gICAgY29uc3QgJG9sZEJ1dHRvbnMgPSAkKGAjJHtvbGRDb250YWluZXJJZH0gLnFyLS1idXR0b25gKTtcbiAgICBjb25zdCAkbmV3Q29udGFpbmVyID0gJChgIyR7bmV3Q29udGFpbmVySWR9YCk7XG5cbiAgICBpZiAoJG9sZEJ1dHRvbnMubGVuZ3RoICYmICRuZXdDb250YWluZXIubGVuZ3RoKSB7XG4gICAgICAkb2xkQnV0dG9ucy5kZXRhY2goKS5hcHBlbmRUbygkbmV3Q29udGFpbmVyKTtcblxuICAgICAgdGhpcy5idXR0b25zLmZvckVhY2goYnV0dG9uID0+IHtcbiAgICAgICAgYnV0dG9uLmJpbmRFdmVudHMoKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5bohJrmnKzlrrnlmahJRFxuICAgKiBAcGFyYW0gc2NyaXB0SWQg6ISa5pysSURcbiAgICogQHJldHVybnMg6ISa5pys5a655ZmoSURcbiAgICovXG4gIHByaXZhdGUgZ2V0U2NyaXB0Q29udGFpbmVySWQoc2NyaXB0SWQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGBzY3JpcHRfY29udGFpbmVyXyR7c2NyaXB0SWR9YDtcbiAgfVxuXG4gIC8qKlxuICAgKiDku47ohJrmnKzmlbDmja7liJvlu7rmjInpkq5cbiAgICogQHBhcmFtIGdsb2JhbFNjcmlwdHMg5YWo5bGA6ISa5pysXG4gICAqIEBwYXJhbSBjaGFyYWN0ZXJTY3JpcHRzIOinkuiJsuiEmuacrFxuICAgKiBAcGFyYW0gaXNHbG9iYWxFbmFibGVkIOWFqOWxgOiEmuacrOaYr+WQpuWQr+eUqFxuICAgKiBAcGFyYW0gaXNDaGFyYWN0ZXJFbmFibGVkIOinkuiJsuiEmuacrOaYr+WQpuWQr+eUqFxuICAgKi9cbiAgY3JlYXRlQnV0dG9uc0Zyb21TY3JpcHRzKFxuICAgIGdsb2JhbFNjcmlwdHM6IFNjcmlwdFtdLFxuICAgIGNoYXJhY3RlclNjcmlwdHM6IFNjcmlwdFtdLFxuICAgIGlzR2xvYmFsRW5hYmxlZDogYm9vbGVhbixcbiAgICBpc0NoYXJhY3RlckVuYWJsZWQ6IGJvb2xlYW4sXG4gICk6IHZvaWQge1xuICAgIGlmICh0aGlzLmlzVXBkYXRpbmcpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLmlzVXBkYXRpbmcgPSB0cnVlO1xuXG4gICAgdHJ5IHtcbiAgICAgIHRoaXMuY2xlYXJCdXR0b25zKCk7XG5cbiAgICAgIGNvbnN0IGhhc0dsb2JhbFZpc2libGVCdXR0b25zID1cbiAgICAgICAgaXNHbG9iYWxFbmFibGVkICYmXG4gICAgICAgIGdsb2JhbFNjcmlwdHMuc29tZShcbiAgICAgICAgICBzY3JpcHQgPT5cbiAgICAgICAgICAgIHNjcmlwdC5lbmFibGVkICYmXG4gICAgICAgICAgICBzY3JpcHQuYnV0dG9ucyAmJlxuICAgICAgICAgICAgc2NyaXB0LmJ1dHRvbnMubGVuZ3RoID4gMCAmJlxuICAgICAgICAgICAgc2NyaXB0LmJ1dHRvbnMuc29tZShidXR0b24gPT4gYnV0dG9uLnZpc2libGUpLFxuICAgICAgICApO1xuXG4gICAgICBjb25zdCBoYXNDaGFyYWN0ZXJWaXNpYmxlQnV0dG9ucyA9XG4gICAgICAgIGlzQ2hhcmFjdGVyRW5hYmxlZCAmJlxuICAgICAgICBjaGFyYWN0ZXJTY3JpcHRzLnNvbWUoXG4gICAgICAgICAgc2NyaXB0ID0+XG4gICAgICAgICAgICBzY3JpcHQuZW5hYmxlZCAmJlxuICAgICAgICAgICAgc2NyaXB0LmJ1dHRvbnMgJiZcbiAgICAgICAgICAgIHNjcmlwdC5idXR0b25zLmxlbmd0aCA+IDAgJiZcbiAgICAgICAgICAgIHNjcmlwdC5idXR0b25zLnNvbWUoYnV0dG9uID0+IGJ1dHRvbi52aXNpYmxlKSxcbiAgICAgICAgKTtcblxuICAgICAgaWYgKCFoYXNHbG9iYWxWaXNpYmxlQnV0dG9ucyAmJiAhaGFzQ2hhcmFjdGVyVmlzaWJsZUJ1dHRvbnMpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAoaXNHbG9iYWxFbmFibGVkICYmIGhhc0dsb2JhbFZpc2libGVCdXR0b25zKSB7XG4gICAgICAgIHRoaXMuYWRkU2NyaXB0QnV0dG9ucyhnbG9iYWxTY3JpcHRzKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGlzQ2hhcmFjdGVyRW5hYmxlZCAmJiBoYXNDaGFyYWN0ZXJWaXNpYmxlQnV0dG9ucykge1xuICAgICAgICB0aGlzLmFkZFNjcmlwdEJ1dHRvbnMoY2hhcmFjdGVyU2NyaXB0cyk7XG4gICAgICB9XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICB0aGlzLmlzVXBkYXRpbmcgPSBmYWxzZTtcbiAgICAgIH0sIDEwMCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOa3u+WKoOiEmuacrOaMiemSrlxuICAgKiBAcGFyYW0gc2NyaXB0cyDohJrmnKzliJfooahcbiAgICovXG4gIHByaXZhdGUgYWRkU2NyaXB0QnV0dG9ucyhzY3JpcHRzOiBTY3JpcHRbXSk6IHZvaWQge1xuICAgIHNjcmlwdHMuZm9yRWFjaChzY3JpcHQgPT4ge1xuICAgICAgaWYgKHNjcmlwdC5lbmFibGVkICYmIHNjcmlwdC5idXR0b25zICYmIHNjcmlwdC5idXR0b25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc3QgdmlzaWJsZUJ1dHRvbnMgPSBzY3JpcHQuYnV0dG9uc1xuICAgICAgICAgIC5maWx0ZXIoYnV0dG9uRGF0YSA9PiBidXR0b25EYXRhLnZpc2libGUpXG4gICAgICAgICAgLm1hcChidXR0b25EYXRhID0+IEJ1dHRvbkZhY3RvcnkuY3JlYXRlQnV0dG9uKCdzY3JpcHQnLCBidXR0b25EYXRhLm5hbWUsIHNjcmlwdC5pZCwgYnV0dG9uRGF0YS52aXNpYmxlKSk7XG5cbiAgICAgICAgaWYgKHZpc2libGVCdXR0b25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICB0aGlzLmFkZEJ1dHRvbnNHcm91cCh2aXNpYmxlQnV0dG9ucywgc2NyaXB0LmlkKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOa3u+WKoOaMiemSrue7hFxuICAgKiBAcGFyYW0gYnV0dG9ucyDmjInpkq7liJfooahcbiAgICogQHBhcmFtIHNjcmlwdElkIOiEmuacrElEXG4gICAqL1xuICBwcml2YXRlIGFkZEJ1dHRvbnNHcm91cChidXR0b25zOiBCdXR0b25bXSwgc2NyaXB0SWQ6IHN0cmluZyk6IHZvaWQge1xuICAgIGlmIChidXR0b25zLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuXG4gICAgY29uc3QgY29udGFpbmVySWQgPSB0aGlzLmdldFNjcmlwdENvbnRhaW5lcklkKHNjcmlwdElkKTtcblxuICAgICQoYCMke2NvbnRhaW5lcklkfWApLnJlbW92ZSgpO1xuXG4gICAgbGV0IGNvbnRhaW5lckh0bWwgPSBgPGRpdiBpZD1cIiR7Y29udGFpbmVySWR9XCIgY2xhc3M9XCJxci0tYnV0dG9ucyB0aC0tYnV0dG9uXCI+YDtcblxuICAgIGJ1dHRvbnMuZm9yRWFjaChidXR0b24gPT4ge1xuICAgICAgdGhpcy5idXR0b25zID0gdGhpcy5idXR0b25zLmZpbHRlcihidG4gPT4gYnRuLmlkICE9PSBidXR0b24uaWQpO1xuICAgICAgdGhpcy5idXR0b25zLnB1c2goYnV0dG9uKTtcbiAgICAgIGNvbnRhaW5lckh0bWwgKz0gYnV0dG9uLnJlbmRlcigpO1xuICAgIH0pO1xuXG4gICAgY29udGFpbmVySHRtbCArPSAnPC9kaXY+JztcblxuICAgIGNvbnN0ICRzZW5kRm9ybSA9ICQoJyNzZW5kX2Zvcm0nKTtcbiAgICBjb25zdCAkcXJCYXIgPSAkc2VuZEZvcm0uZmluZCgnI3FyLS1iYXInKTtcblxuICAgIGlmICgkcXJCYXIubGVuZ3RoID09PSAwKSB7XG4gICAgICBsb2cud2FybignW1NjcmlwdE1hbmFnZXJdIHFyLS1iYXLlrrnlmajkuI3lrZjlnKjvvIzml6Dms5Xmt7vliqDmjInpkq4nKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoaXNDb21iaW5lZCkge1xuICAgICAgY29uc3QgJGNvbWJpbmVkQ29udGFpbmVyID0gJHFyQmFyLmZpbmQoJy5xci0tYnV0dG9ucy5xci0tY29sb3InKS5maXJzdCgpO1xuICAgICAgaWYgKCRjb21iaW5lZENvbnRhaW5lci5sZW5ndGggPiAwKSB7XG4gICAgICAgICRjb21iaW5lZENvbnRhaW5lci5hcHBlbmQoY29udGFpbmVySHRtbCk7XG4gICAgICAgIGxvZy5pbmZvKGBbU2NyaXB0TWFuYWdlcl0g5oyJ6ZKu5re75Yqg5YiwY29tYmluZWTlrrnlmag6ICR7c2NyaXB0SWR9YCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkcXJCYXIuYXBwZW5kKGNvbnRhaW5lckh0bWwpO1xuICAgICAgICBsb2cuaW5mbyhgW1NjcmlwdE1hbmFnZXJdIOaMiemSrua3u+WKoOWIsHFyLS1iYXLvvIjml6Bjb21iaW5lZOWuueWZqO+8iTogJHtzY3JpcHRJZH1gKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgJHFyQmFyLmFwcGVuZChjb250YWluZXJIdG1sKTtcbiAgICAgIGxvZy5pbmZvKGBbU2NyaXB0TWFuYWdlcl0g5oyJ6ZKu5re75Yqg5YiwcXItLWJhcjogJHtzY3JpcHRJZH1gKTtcbiAgICB9XG5cbiAgICBidXR0b25zLmZvckVhY2goYnV0dG9uID0+IGJ1dHRvbi5iaW5kRXZlbnRzKCkpO1xuICB9XG5cbiAgLyoqXG4gICAqIOS4uuaMh+WumuiEmuacrOa3u+WKoOaJgOacieaMiemSrlxuICAgKiBAcGFyYW0gc2NyaXB0IOiEmuacrFxuICAgKi9cbiAgYWRkQnV0dG9uc0ZvclNjcmlwdChzY3JpcHQ6IFNjcmlwdCk6IHZvaWQge1xuICAgIGlmICghc2NyaXB0LmJ1dHRvbnMgfHwgc2NyaXB0LmJ1dHRvbnMubGVuZ3RoID09PSAwKSByZXR1cm47XG5cbiAgICBjb25zdCB2aXNpYmxlQnV0dG9ucyA9IHNjcmlwdC5idXR0b25zXG4gICAgICAuZmlsdGVyKGJ1dHRvbkRhdGEgPT4gYnV0dG9uRGF0YS52aXNpYmxlKVxuICAgICAgLm1hcChidXR0b25EYXRhID0+IEJ1dHRvbkZhY3RvcnkuY3JlYXRlQnV0dG9uKCdzY3JpcHQnLCBidXR0b25EYXRhLm5hbWUsIHNjcmlwdC5pZCwgYnV0dG9uRGF0YS52aXNpYmxlKSk7XG5cbiAgICBpZiAodmlzaWJsZUJ1dHRvbnMubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy5hZGRCdXR0b25zR3JvdXAodmlzaWJsZUJ1dHRvbnMsIHNjcmlwdC5pZCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOenu+mZpOaMh+WumuiEmuacrOeahOaMiemSrlxuICAgKiBAcGFyYW0gc2NyaXB0SWQg6ISa5pysSURcbiAgICovXG4gIHJlbW92ZUJ1dHRvbnNCeVNjcmlwdElkKHNjcmlwdElkOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBjb25zdCBjb250YWluZXJJZCA9IHRoaXMuZ2V0U2NyaXB0Q29udGFpbmVySWQoc2NyaXB0SWQpO1xuICAgICQoYCMke2NvbnRhaW5lcklkfWApLnJlbW92ZSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIOa4heeQhuaJgOacieaMiemSrlxuICAgKi9cbiAgY2xlYXJCdXR0b25zKCk6IHZvaWQge1xuICAgIHRoaXMuYnV0dG9ucy5mb3JFYWNoKGJ1dHRvbiA9PiBidXR0b24ucmVtb3ZlKCkpO1xuICAgIHRoaXMuYnV0dG9ucyA9IFtdO1xuICB9XG5cbiAgLyoqXG4gICAqIOa4heeQhui1hOa6kOW5tumHjee9rueKtuaAgVxuICAgKi9cbiAgY2xlYW51cCgpOiB2b2lkIHtcbiAgICB0aGlzLmNsZWFyQnV0dG9ucygpO1xuICAgIHRoaXMuaXNVcGRhdGluZyA9IGZhbHNlO1xuICB9XG59XG5cbmNvbnN0IGJ1dHRvbk1hbmFnZXIgPSBuZXcgQnV0dG9uTWFuYWdlcigpO1xuXG4vKipcbiAqIOiuvue9ruaMiemSruaXtumcgOimgeaJp+ihjOeahOihjOS4ulxuICovXG5mdW5jdGlvbiBfc2V0QnV0dG9uTG9naWMoKSB7XG4gIGNvbnN0IHNjcmlwdE1hbmFnZXIgPSBTY3JpcHRNYW5hZ2VyLmdldEluc3RhbmNlKCk7XG5cbiAgY29uc3QgZ2xvYmFsU2NyaXB0cyA9IHNjcmlwdE1hbmFnZXIuZ2V0R2xvYmFsU2NyaXB0cygpO1xuICBjb25zdCBjaGFyYWN0ZXJTY3JpcHRzID0gc2NyaXB0TWFuYWdlci5nZXRDaGFyYWN0ZXJTY3JpcHRzKCk7XG4gIGNvbnN0IGlzR2xvYmFsRW5hYmxlZCA9IHNjcmlwdE1hbmFnZXIuaXNHbG9iYWxTY3JpcHRFbmFibGVkO1xuICBjb25zdCBpc0NoYXJhY3RlckVuYWJsZWQgPSBzY3JpcHRNYW5hZ2VyLmlzQ2hhcmFjdGVyU2NyaXB0RW5hYmxlZDtcblxuICBidXR0b25NYW5hZ2VyLmNyZWF0ZUJ1dHRvbnNGcm9tU2NyaXB0cyhnbG9iYWxTY3JpcHRzLCBjaGFyYWN0ZXJTY3JpcHRzLCBpc0dsb2JhbEVuYWJsZWQsIGlzQ2hhcmFjdGVyRW5hYmxlZCk7XG59XG5cbi8qKlxuICog5qC55o2ucXItLWlzRW5hYmxlZOeKtuaAgeWkhOeQhuWuueWZqFxuICovXG5mdW5jdGlvbiBjaGVja1FyRW5hYmxlZFN0YXR1cygpIHtcbiAgY29uc3QgcXJFbmFibGVkRWxlbWVudCA9ICQoJyNxci0taXNFbmFibGVkJyk7XG4gIGlzUXJFbmFibGVkID0gcXJFbmFibGVkRWxlbWVudC5sZW5ndGggPiAwID8gcXJFbmFibGVkRWxlbWVudC5wcm9wKCdjaGVja2VkJykgOiBmYWxzZTtcblxuICBjb25zdCBzZW5kRm9ybSA9ICQoJyNzZW5kX2Zvcm0nKTtcbiAgaWYgKHNlbmRGb3JtLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IHFyQmFyTGVuZ3RoID0gJCgnI3NlbmRfZm9ybSAjcXItLWJhcicpLmxlbmd0aDtcblxuICBpZiAocXJCYXJMZW5ndGggPT09IDApIHtcbiAgICBpZiAoIXNlbmRGb3JtLmZpbmQoJyNxci0tYmFyJykubGVuZ3RoKSB7XG4gICAgICBzZW5kRm9ybS5hcHBlbmQoJzxkaXYgY2xhc3M9XCJmbGV4LWNvbnRhaW5lciBmbGV4R2FwNVwiIGlkPVwicXItLWJhclwiPjwvZGl2PicpO1xuICAgICAgbG9nLmluZm8oJ1tTY3JpcHRNYW5hZ2VyXSDliJvlu7pxci0tYmFy5a655Zmo77yIcXLmnKrlkK/nlKjmiJbkuI3lrZjlnKjvvIknKTtcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiDmo4Dmn6Vxci0taXNDb21iaW5lZOeKtuaAgVxuICovXG5mdW5jdGlvbiBjaGVja1FyQ29tYmluZWRTdGF0dXMoKSB7XG4gIGNvbnN0IHFyQ29tYmluZWRFbGVtZW50ID0gJCgnI3FyLS1pc0NvbWJpbmVkJyk7XG4gIGlzQ29tYmluZWQgPSBxckNvbWJpbmVkRWxlbWVudC5sZW5ndGggPiAwID8gcXJDb21iaW5lZEVsZW1lbnQucHJvcCgnY2hlY2tlZCcpIDogZmFsc2U7XG5cbiAgaWYgKCFpc1FyRW5hYmxlZCkge1xuICAgIGNvbnN0ICRxckJhciA9ICQoJyNzZW5kX2Zvcm0gI3FyLS1iYXInKS5maXJzdCgpO1xuICAgIGlmICgkcXJCYXIubGVuZ3RoID4gMCAmJiBpc0NvbWJpbmVkKSB7XG4gICAgICBjb25zdCBpc1RoQnV0dG9uRXhpc3QgPSAkcXJCYXIuZmluZCgnLnFyLS1idXR0b25zLnFyLS1jb2xvcicpLmxlbmd0aCA+IDA7XG4gICAgICBpZiAoIWlzVGhCdXR0b25FeGlzdCkge1xuICAgICAgICBpZiAoISRxckJhci5maW5kKCcucXItLWJ1dHRvbnMucXItLWNvbG9yJykubGVuZ3RoKSB7XG4gICAgICAgICAgJHFyQmFyLmFwcGVuZCgnPGRpdiBjbGFzcz1cInFyLS1idXR0b25zIHFyLS1jb2xvclwiPjwvZGl2PicpO1xuICAgICAgICAgIGxvZy5pbmZvKCdbU2NyaXB0TWFuYWdlcl0g5Yib5bu6Y29tYmluZWTmjInpkq7lrrnlmagnKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIOajgOafpXFyLS1pc0VuYWJsZWTlkoxxci0taXNDb21iaW5lZOeKtuaAgeW5tua3u+WKoOaMiemSrlxuICovXG5leHBvcnQgZnVuY3Rpb24gY2hlY2tRckVuYWJsZWRTdGF0dXNBbmRBZGRCdXR0b24oKSB7XG4gIGNoZWNrUXJFbmFibGVkU3RhdHVzKCk7XG4gIGNoZWNrUXJDb21iaW5lZFN0YXR1cygpO1xuICBfc2V0QnV0dG9uTG9naWMoKTtcbn1cblxuLyoqXG4gKiDliJ3lp4vljJbohJrmnKzmjInpkq7vvIzljIXmi6znoa7orqRxcuWuueWZqOWSjOe7keWummNoYW5nZeS6i+S7tlxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5pdFNjcmlwdEJ1dHRvbigpIHtcbiAgY2hlY2tRckVuYWJsZWRTdGF0dXMoKTtcbiAgY2hlY2tRckNvbWJpbmVkU3RhdHVzKCk7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/component/script_repository/button.ts\n\n}")},"./src/component/script_repository/data.ts":
/*!*************************************************!*\
  !*** ./src/component/script_repository/data.ts ***!
  \*************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ScriptData: () => (/* binding */ ScriptData),\n/* harmony export */   purgeEmbeddedScripts: () => (/* binding */ purgeEmbeddedScripts)\n/* harmony export */ });\n/* harmony import */ var _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/script_repository/types */ \"./src/component/script_repository/types.ts\");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_5__);\n\n\n\n\n\n\n/**\n * 脚本数据管理类\n */\nclass ScriptData {\n    static instance;\n    globalScripts = [];\n    characterScripts = [];\n    _isGlobalScriptEnabled = false;\n    _isCharacterScriptEnabled = false;\n    constructor() {\n        this.loadScripts();\n    }\n    get isGlobalScriptEnabled() {\n        return this._isGlobalScriptEnabled;\n    }\n    get isCharacterScriptEnabled() {\n        return this._isCharacterScriptEnabled;\n    }\n    static getInstance() {\n        if (!ScriptData.instance) {\n            ScriptData.instance = new ScriptData();\n        }\n        return ScriptData.instance;\n    }\n    static destroyInstance() {\n        if (ScriptData.instance) {\n            ScriptData.instance = undefined;\n        }\n    }\n    /**\n     * 检查当前角色是否启用了脚本库\n     * @returns 角色脚本库是否启用\n     */\n    checkCharacterScriptEnabled() {\n        const charactersWithScripts = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('script.characters_with_scripts') || [];\n        //@ts-ignore\n        const avatar = _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.characters?.[_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid]?.avatar;\n        return charactersWithScripts?.includes(avatar) || false;\n    }\n    /**\n     * 加载脚本库原始数据，支持新旧数据结构兼容\n     */\n    loadScripts() {\n        const rawGlobalRepository = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('script.scriptsRepository') || [];\n        this.globalScripts = this.migrateAndExtractScripts(rawGlobalRepository, _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL);\n        //@ts-ignore\n        const rawCharacterRepository = _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid]?.data?.extensions?.TavernHelper_scripts || [];\n        this.characterScripts = this.migrateAndExtractScripts(rawCharacterRepository, _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.CHARACTER);\n        this._isGlobalScriptEnabled = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('script.global_script_enabled') ?? false;\n        this._isCharacterScriptEnabled = this.checkCharacterScriptEnabled();\n    }\n    /**\n     * 检查并迁移数据结构，确保向后兼容\n     * @param repository 原始仓库数据\n     * @param type 脚本类型\n     * @returns 提取的脚本数组\n     */\n    migrateAndExtractScripts(repository, type) {\n        if (!Array.isArray(repository)) {\n            return [];\n        }\n        let needsMigration = false;\n        const migratedRepository = [];\n        for (const item of repository) {\n            if ((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.isScript)(item)) {\n                needsMigration = true;\n                migratedRepository.push({\n                    type: 'script',\n                    value: new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.Script(item),\n                });\n            }\n            else if ((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.isScriptRepositoryItem)(item)) {\n                if (item.type === 'script') {\n                    migratedRepository.push({\n                        type: 'script',\n                        value: new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.Script(item.value),\n                    });\n                }\n                else if (item.type === 'folder') {\n                    migratedRepository.push({\n                        type: 'folder',\n                        id: item.id,\n                        name: item.name,\n                        icon: item.icon || 'fa-folder',\n                        color: item.color || document.documentElement.style.getPropertyValue('--SmartThemeBodyColor'),\n                        value: Array.isArray(item.value) ? item.value.map((s) => new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.Script(s)) : [],\n                    });\n                }\n            }\n            else {\n                loglevel__WEBPACK_IMPORTED_MODULE_5___default().warn('[ScriptManager] 无法解析的脚本数据:', item);\n            }\n        }\n        if (needsMigration) {\n            this.saveMigratedRepository(migratedRepository, type);\n        }\n        return (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.extractScriptsFromRepository)(migratedRepository);\n    }\n    /**\n     * 保存迁移后的仓库数据\n     * @param repository 迁移后的仓库数据\n     * @param type 脚本类型\n     */\n    async saveMigratedRepository(repository, type) {\n        try {\n            if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL) {\n                (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('script.scriptsRepository', repository);\n            }\n            else {\n                if (!_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid) {\n                    loglevel__WEBPACK_IMPORTED_MODULE_5___default().warn('[ScriptManager] 无法保存角色脚本迁移数据：当前角色为空');\n                    return;\n                }\n                //@ts-ignore\n                await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__.writeExtensionField)(_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid, 'TavernHelper_scripts', repository);\n            }\n            loglevel__WEBPACK_IMPORTED_MODULE_5___default().info(`[ScriptManager] 成功迁移${type}脚本数据结构`);\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_5___default().error(`[ScriptManager] 迁移${type}脚本数据失败:`, error);\n        }\n    }\n    /**\n     * 获取全局脚本列表\n     */\n    getGlobalScripts() {\n        return this.globalScripts;\n    }\n    /**\n     * 获取角色脚本列表\n     */\n    getCharacterScripts() {\n        //@ts-ignore\n        const rawCharacterRepository = _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid]?.data?.extensions?.TavernHelper_scripts || [];\n        this.characterScripts = this.migrateAndExtractScripts(rawCharacterRepository, _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.CHARACTER);\n        return this.characterScripts;\n    }\n    /**\n     * 根据ID获取脚本\n     * @param id 脚本ID\n     * @returns 脚本对象，如果不存在则返回undefined\n     */\n    getScriptById(id) {\n        let script = this.globalScripts.find((s) => s.id === id);\n        if (script) {\n            return script;\n        }\n        script = this.characterScripts.find((s) => s.id === id);\n        if (script) {\n            return script;\n        }\n        return undefined;\n    }\n    /**\n     * 保存单个脚本到设置中，不存在则添加到末尾，存在则覆盖\n     * @param script 脚本\n     * @param type 脚本类型\n     */\n    async saveScript(script, type) {\n        if (!script.name || script.name.trim() === '') {\n            throw new Error('[ScriptManager] 保存失败，脚本名称为空');\n        }\n        const rawRepository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL\n            ? (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('script.scriptsRepository') || []\n            : //@ts-ignore\n                _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid]?.data?.extensions?.TavernHelper_scripts || [];\n        const repository = this.ensureRepositoryStructure(rawRepository);\n        let foundIndex = -1;\n        let foundInFolder = false;\n        let folderIndex = -1;\n        for (let i = 0; i < repository.length; i++) {\n            const item = repository[i];\n            if (item.type === 'script' && item.value.id === script.id) {\n                foundIndex = i;\n                break;\n            }\n            else if (item.type === 'folder') {\n                const scripts = item.value;\n                const scriptIndex = scripts.findIndex(s => s.id === script.id);\n                if (scriptIndex !== -1) {\n                    foundInFolder = true;\n                    folderIndex = i;\n                    foundIndex = scriptIndex;\n                    break;\n                }\n            }\n        }\n        if (foundInFolder && folderIndex >= 0) {\n            const folder = repository[folderIndex];\n            folder.value[foundIndex] = script;\n        }\n        else if (foundIndex >= 0) {\n            repository[foundIndex].value = script;\n        }\n        else {\n            repository.push({\n                type: 'script',\n                value: script,\n            });\n        }\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL) {\n            await this.saveGlobalRepositoryItems(repository);\n        }\n        else {\n            await this.saveCharacterRepositoryItems(repository);\n        }\n        this.loadScripts();\n    }\n    /**\n     * 确保仓库使用新的数据结构\n     * @param rawRepository 原始仓库数据\n     * @returns 规范化的仓库数据\n     */\n    ensureRepositoryStructure(rawRepository) {\n        const repository = [];\n        for (const item of rawRepository) {\n            if ((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.isScript)(item)) {\n                repository.push({\n                    type: 'script',\n                    value: new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.Script(item),\n                });\n            }\n            else if ((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.isScriptRepositoryItem)(item)) {\n                if (item.type === 'script') {\n                    repository.push({\n                        type: 'script',\n                        value: new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.Script(item.value),\n                    });\n                }\n                else if (item.type === 'folder') {\n                    if (!item.icon) {\n                        item.icon = 'fa-folder';\n                    }\n                    if (!item.color) {\n                        item.color = document.documentElement.style.getPropertyValue('--SmartThemeBodyColor');\n                    }\n                    repository.push({\n                        ...item,\n                        value: Array.isArray(item.value) ? item.value.map((s) => new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.Script(s)) : [],\n                    });\n                }\n            }\n            else {\n                try {\n                    repository.push({\n                        type: 'script',\n                        value: new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.Script(item),\n                    });\n                }\n                catch (error) {\n                    loglevel__WEBPACK_IMPORTED_MODULE_5___default().warn('[ScriptManager] 无法解析的脚本数据:', item, error);\n                }\n            }\n        }\n        return repository;\n    }\n    /**\n     * 保存全局脚本数组到扩展设置\n     * @param array 脚本数组\n     */\n    async saveGlobalScripts(array) {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('script.scriptsRepository', array);\n        this.globalScripts = array;\n    }\n    /**\n     * 保存脚本数组到角色卡数据\n     * @param array 脚本数组\n     */\n    async saveCharacterScripts(array) {\n        if (!_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid) {\n            throw new Error('[ScriptManager] 保存失败，当前角色为空');\n        }\n        //@ts-ignore\n        await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__.writeExtensionField)(_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid, 'TavernHelper_scripts', array);\n        this.characterScripts = array;\n    }\n    /**\n     * 保存全局脚本仓库项数组到扩展设置\n     * @param repository 仓库项数组\n     */\n    async saveGlobalRepositoryItems(repository) {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('script.scriptsRepository', repository);\n        this.globalScripts = (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.extractScriptsFromRepository)(repository);\n    }\n    /**\n     * 保存脚本仓库项数组到角色卡数据\n     * @param repository 仓库项数组\n     */\n    async saveCharacterRepositoryItems(repository) {\n        if (!_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid) {\n            throw new Error('[ScriptManager] 保存失败，当前角色为空');\n        }\n        //@ts-ignore\n        await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__.writeExtensionField)(_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid, 'TavernHelper_scripts', repository);\n        this.characterScripts = (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.extractScriptsFromRepository)(repository);\n    }\n    /**\n     * 从脚本库中删除脚本\n     * @param id 脚本ID\n     * @param type 脚本类型\n     */\n    async deleteScript(id, type) {\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL ? this.getGlobalRepositoryItems() : this.getCharacterRepositoryItems();\n        let scriptFound = false;\n        for (let i = 0; i < repository.length; i++) {\n            const item = repository[i];\n            if (item.type === 'script' && item.value.id === id) {\n                repository.splice(i, 1);\n                scriptFound = true;\n                break;\n            }\n            else if (item.type === 'folder') {\n                const scripts = item.value;\n                const foundIndex = scripts.findIndex(s => s.id === id);\n                if (foundIndex !== -1) {\n                    scripts.splice(foundIndex, 1);\n                    scriptFound = true;\n                    break;\n                }\n            }\n        }\n        if (!scriptFound) {\n            throw new Error('[ScriptManager] 删除脚本失败，脚本不存在');\n        }\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL) {\n            await this.saveGlobalRepositoryItems(repository);\n        }\n        else {\n            await this.saveCharacterRepositoryItems(repository);\n        }\n    }\n    /**\n     * 更新脚本启用状态\n     * @param type 脚本类型\n     * @param enable 是否启用\n     */\n    async updateScriptTypeEnableState(type, enable) {\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL) {\n            (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('script.global_script_enabled', enable);\n            this._isGlobalScriptEnabled = enable;\n        }\n        else {\n            const charactersWithScripts = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('script.characters_with_scripts') || [];\n            //@ts-ignore\n            const avatar = _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.characters?.[_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid]?.avatar;\n            if (enable) {\n                if (avatar && !charactersWithScripts.includes(avatar)) {\n                    charactersWithScripts.push(avatar);\n                }\n            }\n            else {\n                const index = charactersWithScripts.indexOf(avatar);\n                if (index !== -1) {\n                    charactersWithScripts.splice(index, 1);\n                }\n            }\n            (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('script.characters_with_scripts', charactersWithScripts);\n            this._isCharacterScriptEnabled = enable;\n        }\n    }\n    /**\n     * 获取脚本的类型\n     * @param script 脚本对象\n     * @returns 脚本类型\n     */\n    getScriptType(script) {\n        return this.globalScripts.some(s => s.id === script.id) ? _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL : _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.CHARACTER;\n    }\n    /**\n     * 刷新角色脚本启用状态\n     */\n    refreshCharacterScriptEnabledState() {\n        this._isCharacterScriptEnabled = this.checkCharacterScriptEnabled();\n    }\n    /**\n     * 获取全局脚本仓库项\n     */\n    getGlobalRepositoryItems() {\n        const rawRepository = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('script.scriptsRepository') || [];\n        return this.ensureRepositoryStructure(rawRepository);\n    }\n    /**\n     * 获取角色脚本仓库项\n     */\n    getCharacterRepositoryItems() {\n        //@ts-ignore\n        const rawRepository = _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid]?.data?.extensions?.TavernHelper_scripts || [];\n        return this.ensureRepositoryStructure(rawRepository);\n    }\n    /**\n     * 创建文件夹\n     * @param name 文件夹名称\n     * @param type 脚本类型\n     * @param icon 文件夹图标（可选）\n     * @param color 文件夹颜色（可选）\n     * @returns 新创建的文件夹ID\n     */\n    async createFolder(name, type, icon, color) {\n        if (!name || name.trim() === '') {\n            throw new Error('[ScriptManager] 文件夹名称不能为空');\n        }\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL ? this.getGlobalRepositoryItems() : this.getCharacterRepositoryItems();\n        const existingFolder = repository.find(item => item.type === 'folder' && item.name === name.trim());\n        if (existingFolder) {\n            throw new Error('[ScriptManager] 文件夹名称已存在');\n        }\n        const folderId = (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_4__.uuidv4)();\n        const newFolder = {\n            type: 'folder',\n            id: folderId,\n            name: name.trim(),\n            icon: icon || 'fa-folder',\n            color: color || document.documentElement.style.getPropertyValue('--SmartThemeBodyColor'),\n            value: [],\n        };\n        repository.unshift(newFolder);\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL) {\n            await this.saveGlobalRepositoryItems(repository);\n        }\n        else {\n            await this.saveCharacterRepositoryItems(repository);\n        }\n        return folderId;\n    }\n    /**\n     * 编辑文件夹\n     * @param folderId 文件夹ID\n     * @param newName 新名称\n     * @param type 脚本类型\n     * @param newIcon 新图标\n     * @param newColor 新颜色\n     */\n    async editFolder(folderId, newName, type, newIcon, newColor) {\n        if (!newName || newName.trim() === '') {\n            throw new Error('[ScriptManager] 文件夹名称不能为空');\n        }\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL ? this.getGlobalRepositoryItems() : this.getCharacterRepositoryItems();\n        const folderIndex = repository.findIndex(item => item.type === 'folder' && item.id === folderId);\n        if (folderIndex === -1) {\n            throw new Error('[ScriptManager] 文件夹不存在');\n        }\n        const existingFolder = repository.find(item => item.type === 'folder' && item.name === newName.trim() && item.id !== folderId);\n        if (existingFolder) {\n            throw new Error('[ScriptManager] 文件夹名称已存在');\n        }\n        repository[folderIndex].name = newName.trim();\n        if (newIcon !== undefined) {\n            repository[folderIndex].icon = newIcon;\n        }\n        if (newColor !== undefined) {\n            repository[folderIndex].color = newColor;\n        }\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL) {\n            await this.saveGlobalRepositoryItems(repository);\n        }\n        else {\n            await this.saveCharacterRepositoryItems(repository);\n        }\n    }\n    /**\n     * 删除文件夹（同时删除内部的所有脚本）\n     * @param folderId 文件夹ID\n     * @param type 脚本类型\n     */\n    async deleteFolder(folderId, type) {\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL ? this.getGlobalRepositoryItems() : this.getCharacterRepositoryItems();\n        const folderIndex = repository.findIndex(item => item.type === 'folder' && item.id === folderId);\n        if (folderIndex === -1) {\n            throw new Error('[ScriptManager] 文件夹不存在');\n        }\n        repository.splice(folderIndex, 1);\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL) {\n            await this.saveGlobalRepositoryItems(repository);\n        }\n        else {\n            await this.saveCharacterRepositoryItems(repository);\n        }\n    }\n    /**\n     * 将项目（脚本或文件夹）移动到其他类型的仓库\n     * @param item 要移动的项目信息\n     * @param sourceType 源类型\n     */\n    async moveItemToOtherType(item, sourceType) {\n        const targetType = (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.getOppositeScriptType)(sourceType);\n        const sourceRepository = sourceType === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL ? this.getGlobalRepositoryItems() : this.getCharacterRepositoryItems();\n        let itemFound = false;\n        let foundItem = null;\n        if (item.type === 'script') {\n            for (let i = 0; i < sourceRepository.length; i++) {\n                const repoItem = sourceRepository[i];\n                if (repoItem.type === 'script' && repoItem.value.id === item.id) {\n                    foundItem = repoItem;\n                    sourceRepository.splice(i, 1);\n                    itemFound = true;\n                    break;\n                }\n                else if (repoItem.type === 'folder') {\n                    const scripts = repoItem.value;\n                    const foundIndex = scripts.findIndex(s => s.id === item.id);\n                    if (foundIndex !== -1) {\n                        foundItem = { type: 'script', value: scripts[foundIndex] };\n                        scripts.splice(foundIndex, 1);\n                        itemFound = true;\n                        break;\n                    }\n                }\n            }\n            if (!itemFound) {\n                throw new Error('[ScriptManager] 移动脚本失败，脚本不存在');\n            }\n        }\n        else if (item.type === 'folder') {\n            const folderIndex = sourceRepository.findIndex(repoItem => repoItem.type === 'folder' && repoItem.id === item.id);\n            if (folderIndex === -1) {\n                throw new Error('[ScriptManager] 文件夹不存在');\n            }\n            foundItem = sourceRepository[folderIndex];\n            sourceRepository.splice(folderIndex, 1);\n            itemFound = true;\n        }\n        if (!itemFound || !foundItem) {\n            throw new Error('[ScriptManager] 移动失败，项目不存在');\n        }\n        const targetRepository = targetType === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL ? this.getGlobalRepositoryItems() : this.getCharacterRepositoryItems();\n        if (foundItem.type === 'folder') {\n            const existingFolder = targetRepository.find(repoItem => repoItem.type === 'folder' && repoItem.name === foundItem.name);\n            if (existingFolder) {\n                toastr.error('目标位置已存在同名文件夹');\n                throw new Error('[ScriptManager] 目标位置已存在同名文件夹');\n            }\n            targetRepository.unshift(foundItem);\n        }\n        else {\n            targetRepository.push(foundItem);\n        }\n        if (sourceType === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL) {\n            await this.saveGlobalRepositoryItems(sourceRepository);\n            await this.saveCharacterRepositoryItems(targetRepository);\n        }\n        else {\n            await this.saveCharacterRepositoryItems(sourceRepository);\n            await this.saveGlobalRepositoryItems(targetRepository);\n        }\n    }\n    /**\n     * 将脚本移动到文件夹\n     * @param scriptId 脚本ID\n     * @param targetFolderId 目标文件夹ID，如果为null则移动到根级别\n     * @param type 脚本类型\n     */\n    async moveScriptToFolder(scriptId, targetFolderId, type) {\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL ? this.getGlobalRepositoryItems() : this.getCharacterRepositoryItems();\n        let script = null;\n        for (let i = 0; i < repository.length; i++) {\n            const item = repository[i];\n            if (item.type === 'script' && item.value.id === scriptId) {\n                script = item.value;\n                repository.splice(i, 1);\n                break;\n            }\n            else if (item.type === 'folder') {\n                const scripts = item.value;\n                const foundIndex = scripts.findIndex(s => s.id === scriptId);\n                if (foundIndex !== -1) {\n                    script = scripts[foundIndex];\n                    scripts.splice(foundIndex, 1);\n                    break;\n                }\n            }\n        }\n        if (!script) {\n            throw new Error('[ScriptManager] 脚本不存在');\n        }\n        if (targetFolderId === null) {\n            repository.push({\n                type: 'script',\n                value: script,\n            });\n        }\n        else {\n            const targetFolder = repository.find(item => item.type === 'folder' && item.id === targetFolderId);\n            if (!targetFolder) {\n                throw new Error('[ScriptManager] 目标文件夹不存在');\n            }\n            const folderScripts = targetFolder.value;\n            const existingScript = folderScripts.find(s => s.name === script.name);\n            if (existingScript) {\n                throw new Error('[ScriptManager] 文件夹中已存在同名脚本');\n            }\n            folderScripts.push(script);\n        }\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL) {\n            await this.saveGlobalRepositoryItems(repository);\n        }\n        else {\n            await this.saveCharacterRepositoryItems(repository);\n        }\n    }\n    /**\n     * 获取文件夹中的脚本列表\n     * @param folderId 文件夹ID\n     * @param type 脚本类型\n     */\n    getFolderScripts(folderId, type) {\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL ? this.getGlobalRepositoryItems() : this.getCharacterRepositoryItems();\n        const folder = repository.find(item => item.type === 'folder' && item.id === folderId);\n        if (!folder) {\n            return [];\n        }\n        return folder.value;\n    }\n    /**\n     * 获取根级别的脚本列表\n     * @param type 脚本类型\n     */\n    getRootScripts(type) {\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL ? this.getGlobalRepositoryItems() : this.getCharacterRepositoryItems();\n        return repository.filter(item => item.type === 'script').map(item => item.value);\n    }\n    /**\n     * 获取所有文件夹列表\n     * @param type 脚本类型\n     */\n    getFolders(type) {\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL ? this.getGlobalRepositoryItems() : this.getCharacterRepositoryItems();\n        return repository.filter(item => item.type === 'folder');\n    }\n    /**\n     * 批量切换文件夹内所有脚本的启用状态\n     * @param folderId 文件夹ID\n     * @param type 脚本类型\n     * @param enable 是否启用\n     */\n    async toggleFolderScripts(folderId, type, enable) {\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL ? this.getGlobalRepositoryItems() : this.getCharacterRepositoryItems();\n        const folder = repository.find(item => item.type === 'folder' && item.id === folderId);\n        if (!folder) {\n            throw new Error('[ScriptManager] 文件夹不存在');\n        }\n        const scripts = folder.value;\n        let hasChanges = false;\n        for (const script of scripts) {\n            if (script.enabled !== enable) {\n                script.enabled = enable;\n                hasChanges = true;\n            }\n        }\n        if (hasChanges) {\n            if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL) {\n                await this.saveGlobalRepositoryItems(repository);\n            }\n            else {\n                await this.saveCharacterRepositoryItems(repository);\n            }\n        }\n    }\n    /**\n     * 获取文件夹内脚本的整体启用状态\n     * @param folderId 文件夹ID\n     * @param type 脚本类型\n     * @returns 'all' - 全部启用, 'none' - 全部禁用\n     */\n    getFolderScriptsState(folderId, type) {\n        const scripts = this.getFolderScripts(folderId, type);\n        if (scripts.length === 0) {\n            return 'none';\n        }\n        const enabledCount = scripts.filter(script => script.enabled).length;\n        if (enabledCount === 0) {\n            return 'none';\n        }\n        else {\n            return 'all';\n        }\n    }\n}\n/**\n * 从脚本允许列表中删除角色\n * @param param0\n */\nasync function purgeEmbeddedScripts({ character }) {\n    const avatar = character?.character?.avatar;\n    const charactersWithScripts = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('script.characters_with_scripts') || [];\n    if (avatar) {\n        localStorage.removeItem(`AlertScript_${avatar}`);\n        if (charactersWithScripts?.includes(avatar)) {\n            const index = charactersWithScripts.indexOf(avatar);\n            if (index !== -1) {\n                charactersWithScripts.splice(index, 1);\n                (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('script.characters_with_scripts', charactersWithScripts);\n            }\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L2RhdGEudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBUTZDO0FBQ2tDO0FBQ25CO0FBQ1U7QUFDbEI7QUFFekI7QUFFM0I7O0dBRUc7QUFDSSxNQUFNLFVBQVU7SUFDYixNQUFNLENBQUMsUUFBUSxDQUFhO0lBQzVCLGFBQWEsR0FBYSxFQUFFLENBQUM7SUFDN0IsZ0JBQWdCLEdBQWEsRUFBRSxDQUFDO0lBQ2hDLHNCQUFzQixHQUFZLEtBQUssQ0FBQztJQUN4Qyx5QkFBeUIsR0FBWSxLQUFLLENBQUM7SUFFbkQ7UUFDRSxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7SUFDckIsQ0FBQztJQUVELElBQVcscUJBQXFCO1FBQzlCLE9BQU8sSUFBSSxDQUFDLHNCQUFzQixDQUFDO0lBQ3JDLENBQUM7SUFFRCxJQUFXLHdCQUF3QjtRQUNqQyxPQUFPLElBQUksQ0FBQyx5QkFBeUIsQ0FBQztJQUN4QyxDQUFDO0lBRU0sTUFBTSxDQUFDLFdBQVc7UUFDdkIsSUFBSSxDQUFDLFVBQVUsQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUN6QixVQUFVLENBQUMsUUFBUSxHQUFHLElBQUksVUFBVSxFQUFFLENBQUM7UUFDekMsQ0FBQztRQUNELE9BQU8sVUFBVSxDQUFDLFFBQVEsQ0FBQztJQUM3QixDQUFDO0lBRU0sTUFBTSxDQUFDLGVBQWU7UUFDM0IsSUFBSSxVQUFVLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDeEIsVUFBVSxDQUFDLFFBQVEsR0FBRyxTQUFrQyxDQUFDO1FBQzNELENBQUM7SUFDSCxDQUFDO0lBRUQ7OztPQUdHO0lBQ0ksMkJBQTJCO1FBQ2hDLE1BQU0scUJBQXFCLEdBQUcsMEVBQWUsQ0FBQyxnQ0FBZ0MsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUN0RixZQUFZO1FBQ1osTUFBTSxNQUFNLEdBQUcsMkRBQVUsRUFBRSxDQUFDLDBEQUFTLENBQUMsRUFBRSxNQUFNLENBQUM7UUFDL0MsT0FBTyxxQkFB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LElBQUksT0FBTyxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUUsQ0FBQztZQUN6QixPQUFPLE1BQU0sQ0FBQztRQUNoQixDQUFDO1FBRUQsTUFBTSxZQUFZLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxNQUFNLENBQUM7UUFFckUsSUFBSSxZQUFZLEtBQUssQ0FBQyxFQUFFLENBQUM7WUFDdkIsT0FBTyxNQUFNLENBQUM7UUFDaEIsQ0FBQzthQUFNLENBQUM7WUFDTixPQUFPLEtBQUssQ0FBQztRQUNmLENBQUM7SUFDSCxDQUFDO0NBQ0Y7QUFFRDs7O0dBR0c7QUFDSSxLQUFLLFVBQVUsb0JBQW9CLENBQUMsRUFBRSxTQUFTLEVBQXNCO0lBQzFFLE1BQU0sTUFBTSxHQUFHLFNBQVMsRUFBRSxTQUFTLEVBQUUsTUFBTSxDQUFDO0lBQzVDLE1BQU0scUJBQXFCLEdBQUcsMEVBQWUsQ0FBQyxnQ0FBZ0MsQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUN0RixJQUFJLE1BQU0sRUFBRSxDQUFDO1FBQ1gsWUFBWSxDQUFDLFVBQVUsQ0FBQyxlQUFlLE1BQU0sRUFBRSxDQUFDLENBQUM7UUFDakQsSUFBSSxxQkFBcUIsRUFBRSxRQUFRLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQztZQUM1QyxNQUFNLEtBQUssR0FBRyxxQkFBcUIsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDcEQsSUFBSSxLQUFLLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQztnQkFDakIscUJBQXFCLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQztnQkFDdkMsMkVBQWdCLENBQUMsZ0NBQWdDLEVBQUUscUJBQXFCLENBQUMsQ0FBQztZQUM1RSxDQUFDO1FBQ0gsQ0FBQztJQUNILENBQUM7QUFDSCxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBvbmVudC9zY3JpcHRfcmVwb3NpdG9yeS9kYXRhLnRzPzM2OTgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgZXh0cmFjdFNjcmlwdHNGcm9tUmVwb3NpdG9yeSxcbiAgZ2V0T3Bwb3NpdGVTY3JpcHRUeXBlLFxuICBpc1NjcmlwdCxcbiAgaXNTY3JpcHRSZXBvc2l0b3J5SXRlbSxcbiAgU2NyaXB0LFxuICBTY3JpcHRSZXBvc2l0b3J5SXRlbSxcbiAgU2NyaXB0VHlwZSxcbn0gZnJvbSAnQC9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvdHlwZXMnO1xuaW1wb3J0IHsgZ2V0U2V0dGluZ1ZhbHVlLCBzYXZlU2V0dGluZ1ZhbHVlIH0gZnJvbSAnQC91dGlsL2V4dGVuc2lvbl92YXJpYWJsZXMnO1xuaW1wb3J0IHsgY2hhcmFjdGVycywgdGhpc19jaGlkIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5pbXBvcnQgeyB3cml0ZUV4dGVuc2lvbkZpZWxkIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvZXh0ZW5zaW9ucyc7XG5pbXBvcnQgeyB1dWlkdjQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy91dGlscyc7XG5cbmltcG9ydCBsb2cgZnJvbSAnbG9nbGV2ZWwnO1xuXG4vKipcbiAqIOiEmuacrOaVsOaNrueuoeeQhuexu1xuICovXG5leHBvcnQgY2xhc3MgU2NyaXB0RGF0YSB7XG4gIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBTY3JpcHREYXRhO1xuICBwcml2YXRlIGdsb2JhbFNjcmlwdHM6IFNjcmlwdFtdID0gW107XG4gIHByaXZhdGUgY2hhcmFjdGVyU2NyaXB0czogU2NyaXB0W10gPSBbXTtcbiAgcHJpdmF0ZSBfaXNHbG9iYWxTY3JpcHRFbmFibGVkOiBib29sZWFuID0gZmFsc2U7XG4gIHByaXZhdGUgX2lzQ2hhcmFjdGVyU2NyaXB0RW5hYmxlZDogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIHByaXZhdGUgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5sb2FkU2NyaXB0cygpO1xuICB9XG5cbiAgcHVibGljIGdldCBpc0dsb2JhbFNjcmlwdEVuYWJsZWQoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuX2lzR2xvYmFsU2NyaXB0RW5hYmxlZDtcbiAgfVxuXG4gIHB1YmxpYyBnZXQgaXNDaGFyYWN0ZXJTY3JpcHRFbmFibGVkKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLl9pc0NoYXJhY3RlclNjcmlwdEVuYWJsZWQ7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIGdldEluc3RhbmNlKCk6IFNjcmlwdERhdGEge1xuICAgIGlmICghU2NyaXB0RGF0YS5pbnN0YW5jZSkge1xuICAgICAgU2NyaXB0RGF0YS5pbnN0YW5jZSA9IG5ldyBTY3JpcHREYXRhKCk7XG4gICAgfVxuICAgIHJldHVybiBTY3JpcHREYXRhLmluc3RhbmNlO1xuICB9XG5cbiAgcHVibGljIHN0YXRpYyBkZXN0cm95SW5zdGFuY2UoKTogdm9pZCB7XG4gICAgaWYgKFNjcmlwdERhdGEuaW5zdGFuY2UpIHtcbiAgICAgIFNjcmlwdERhdGEuaW5zdGFuY2UgPSB1bmRlZmluZWQgYXMgdW5rbm93biBhcyBTY3JpcHREYXRhO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmo4Dmn6XlvZPliY3op5LoibLmmK/lkKblkK/nlKjkuobohJrmnKzlupNcbiAgICogQHJldHVybnMg6KeS6Imy6ISa5pys5bqT5piv5ZCm5ZCv55SoXG4gICAqL1xuICBwdWJsaWMgY2hlY2tDaGFyYWN0ZXJTY3JpcHRFbmFibGVkKCk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGNoYXJhY3RlcnNXaXRoU2NyaXB0cyA9IGdldFNldHRpbmdWYWx1ZSgnc2NyaXB0LmNoYXJhY3RlcnNfd2l0aF9zY3JpcHRzJykgfHwgW107XG4gICAgLy9AdHMtaWdub3JlXG4gICAgY29uc3QgYXZhdGFyID0gY2hhcmFjdGVycz8uW3RoaXNfY2hpZF0/LmF2YXRhcjtcbiAgICByZXR1cm4gY2hhcmFjdGVyc1dpdGhTY3JpcHRzPy5pbmNsdWRlcyhhdmF0YXIpIHx8IGZhbHNlO1xuICB9XG5cbiAgLyoqXG4gICAqIOWKoOi9veiEmuacrOW6k+WOn+Wni+aVsOaNru+8jOaUr+aMgeaWsOaXp+aVsOaNrue7k+aehOWFvOWuuVxuICAgKi9cbiAgbG9hZFNjcmlwdHMoKSB7XG4gICAgY29uc3QgcmF3R2xvYmFsUmVwb3NpdG9yeSA9IGdldFNldHRpbmdWYWx1ZSgnc2NyaXB0LnNjcmlwdHNSZXBvc2l0b3J5JykgfHwgW107XG4gICAgdGhpcy5nbG9iYWxTY3JpcHRzID0gdGhpcy5taWdyYXRlQW5kRXh0cmFjdFNjcmlwdHMocmF3R2xvYmFsUmVwb3NpdG9yeSwgU2NyaXB0VHlwZS5HTE9CQUwpO1xuICAgIC8vQHRzLWlnbm9yZVxuICAgIGNvbnN0IHJhd0NoYXJhY3RlclJlcG9zaXRvcnkgPSBjaGFyYWN0ZXJzW3RoaXNfY2hpZF0/LmRhdGE/LmV4dGVuc2lvbnM/LlRhdmVybkhlbHBlcl9zY3JpcHRzIHx8IFtdO1xuICAgIHRoaXMuY2hhcmFjdGVyU2NyaXB0cyA9IHRoaXMubWlncmF0ZUFuZEV4dHJhY3RTY3JpcHRzKHJhd0NoYXJhY3RlclJlcG9zaXRvcnksIFNjcmlwdFR5cGUuQ0hBUkFDVEVSKTtcblxuICAgIHRoaXMuX2lzR2xvYmFsU2NyaXB0RW5hYmxlZCA9IGdldFNldHRpbmdWYWx1ZSgnc2NyaXB0Lmdsb2JhbF9zY3JpcHRfZW5hYmxlZCcpID8/IGZhbHNlO1xuICAgIHRoaXMuX2lzQ2hhcmFjdGVyU2NyaXB0RW5hYmxlZCA9IHRoaXMuY2hlY2tDaGFyYWN0ZXJTY3JpcHRFbmFibGVkKCk7XG4gIH1cblxuICAvKipcbiAgICog5qOA5p+l5bm26L+B56e75pWw5o2u57uT5p6E77yM56Gu5L+d5ZCR5ZCO5YW85a65XG4gICAqIEBwYXJhbSByZXBvc2l0b3J5IOWOn+Wni+S7k+W6k+aVsOaNrlxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICogQHJldHVybnMg5o+Q5Y+W55qE6ISa5pys5pWw57uEXG4gICAqL1xuICBwcml2YXRlIG1pZ3JhdGVBbmRFeHRyYWN0U2NyaXB0cyhyZXBvc2l0b3J5OiBhbnlbXSwgdHlwZTogU2NyaXB0VHlwZSk6IFNjcmlwdFtdIHtcbiAgICBpZiAoIUFycmF5LmlzQXJyYXkocmVwb3NpdG9yeSkpIHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICBsZXQgbmVlZHNNaWdyYXRpb24gPSBmYWxzZTtcbiAgICBjb25zdCBtaWdyYXRlZFJlcG9zaXRvcnk6IFNjcmlwdFJlcG9zaXRvcnlJdGVtW10gPSBbXTtcblxuICAgIGZvciAoY29uc3QgaXRlbSBvZiByZXBvc2l0b3J5KSB7XG4gICAgICBpZiAoaXNTY3JpcHQoaXRlbSkpIHtcbiAgICAgICAgbmVlZHNNaWdyYXRpb24gPSB0cnVlO1xuICAgICAgICBtaWdyYXRlZFJlcG9zaXRvcnkucHVzaCh7XG4gICAgICAgICAgdHlwZTogJ3NjcmlwdCcsXG4gICAgICAgICAgdmFsdWU6IG5ldyBTY3JpcHQoaXRlbSksXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIGlmIChpc1NjcmlwdFJlcG9zaXRvcnlJdGVtKGl0ZW0pKSB7XG4gICAgICAgIGlmIChpdGVtLnR5cGUgPT09ICdzY3JpcHQnKSB7XG4gICAgICAgICAgbWlncmF0ZWRSZXBvc2l0b3J5LnB1c2goe1xuICAgICAgICAgICAgdHlwZTogJ3NjcmlwdCcsXG4gICAgICAgICAgICB2YWx1ZTogbmV3IFNjcmlwdChpdGVtLnZhbHVlIGFzIFBhcnRpYWw8U2NyaXB0PiksXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAoaXRlbS50eXBlID09PSAnZm9sZGVyJykge1xuICAgICAgICAgIG1pZ3JhdGVkUmVwb3NpdG9yeS5wdXNoKHtcbiAgICAgICAgICAgIHR5cGU6ICdmb2xkZXInLFxuICAgICAgICAgICAgaWQ6IGl0ZW0uaWQsXG4gICAgICAgICAgICBuYW1lOiBpdGVtLm5hbWUsXG4gICAgICAgICAgICBpY29uOiBpdGVtLmljb24gfHwgJ2ZhLWZvbGRlcicsXG4gICAgICAgICAgICBjb2xvcjogaXRlbS5jb2xvciB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnLS1TbWFydFRoZW1lQm9keUNvbG9yJyksXG4gICAgICAgICAgICB2YWx1ZTogQXJyYXkuaXNBcnJheShpdGVtLnZhbHVlKSA/IGl0ZW0udmFsdWUubWFwKChzOiBhbnkpID0+IG5ldyBTY3JpcHQocykpIDogW10sXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxvZy53YXJuKCdbU2NyaXB0TWFuYWdlcl0g5peg5rOV6Kej5p6Q55qE6ISa5pys5pWw5o2uOicsIGl0ZW0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChuZWVkc01pZ3JhdGlvbikge1xuICAgICAgdGhpcy5zYXZlTWlncmF0ZWRSZXBvc2l0b3J5KG1pZ3JhdGVkUmVwb3NpdG9yeSwgdHlwZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGV4dHJhY3RTY3JpcHRzRnJvbVJlcG9zaXRvcnkobWlncmF0ZWRSZXBvc2l0b3J5KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDkv53lrZjov4Hnp7vlkI7nmoTku5PlupPmlbDmja5cbiAgICogQHBhcmFtIHJlcG9zaXRvcnkg6L+B56e75ZCO55qE5LuT5bqT5pWw5o2uXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBzYXZlTWlncmF0ZWRSZXBvc2l0b3J5KHJlcG9zaXRvcnk6IFNjcmlwdFJlcG9zaXRvcnlJdGVtW10sIHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgaWYgKHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMKSB7XG4gICAgICAgIHNhdmVTZXR0aW5nVmFsdWUoJ3NjcmlwdC5zY3JpcHRzUmVwb3NpdG9yeScsIHJlcG9zaXRvcnkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKCF0aGlzX2NoaWQpIHtcbiAgICAgICAgICBsb2cud2FybignW1NjcmlwdE1hbmFnZXJdIOaXoOazleS/neWtmOinkuiJsuiEmuacrOi/geenu+aVsOaNru+8muW9k+WJjeinkuiJsuS4uuepuicpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgYXdhaXQgd3JpdGVFeHRlbnNpb25GaWVsZCh0aGlzX2NoaWQsICdUYXZlcm5IZWxwZXJfc2NyaXB0cycsIHJlcG9zaXRvcnkpO1xuICAgICAgfVxuICAgICAgbG9nLmluZm8oYFtTY3JpcHRNYW5hZ2VyXSDmiJDlip/ov4Hnp7ske3R5cGV96ISa5pys5pWw5o2u57uT5p6EYCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZy5lcnJvcihgW1NjcmlwdE1hbmFnZXJdIOi/geenuyR7dHlwZX3ohJrmnKzmlbDmja7lpLHotKU6YCwgZXJyb3IpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5blhajlsYDohJrmnKzliJfooahcbiAgICovXG4gIGdldEdsb2JhbFNjcmlwdHMoKTogU2NyaXB0W10ge1xuICAgIHJldHVybiB0aGlzLmdsb2JhbFNjcmlwdHM7XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W6KeS6Imy6ISa5pys5YiX6KGoXG4gICAqL1xuICBnZXRDaGFyYWN0ZXJTY3JpcHRzKCk6IFNjcmlwdFtdIHtcbiAgICAvL0B0cy1pZ25vcmVcbiAgICBjb25zdCByYXdDaGFyYWN0ZXJSZXBvc2l0b3J5ID0gY2hhcmFjdGVyc1t0aGlzX2NoaWRdPy5kYXRhPy5leHRlbnNpb25zPy5UYXZlcm5IZWxwZXJfc2NyaXB0cyB8fCBbXTtcbiAgICB0aGlzLmNoYXJhY3RlclNjcmlwdHMgPSB0aGlzLm1pZ3JhdGVBbmRFeHRyYWN0U2NyaXB0cyhyYXdDaGFyYWN0ZXJSZXBvc2l0b3J5LCBTY3JpcHRUeXBlLkNIQVJBQ1RFUik7XG4gICAgcmV0dXJuIHRoaXMuY2hhcmFjdGVyU2NyaXB0cztcbiAgfVxuXG4gIC8qKlxuICAgKiDmoLnmja5JROiOt+WPluiEmuacrFxuICAgKiBAcGFyYW0gaWQg6ISa5pysSURcbiAgICogQHJldHVybnMg6ISa5pys5a+56LGh77yM5aaC5p6c5LiN5a2Y5Zyo5YiZ6L+U5ZuedW5kZWZpbmVkXG4gICAqL1xuICBnZXRTY3JpcHRCeUlkKGlkOiBzdHJpbmcpOiBTY3JpcHQgfCB1bmRlZmluZWQge1xuICAgIGxldCBzY3JpcHQgPSB0aGlzLmdsb2JhbFNjcmlwdHMuZmluZCgoczogU2NyaXB0KSA9PiBzLmlkID09PSBpZCk7XG4gICAgaWYgKHNjcmlwdCkge1xuICAgICAgcmV0dXJuIHNjcmlwdDtcbiAgICB9XG5cbiAgICBzY3JpcHQgPSB0aGlzLmNoYXJhY3RlclNjcmlwdHMuZmluZCgoczogU2NyaXB0KSA9PiBzLmlkID09PSBpZCk7XG4gICAgaWYgKHNjcmlwdCkge1xuICAgICAgcmV0dXJuIHNjcmlwdDtcbiAgICB9XG5cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgLyoqXG4gICAqIOS/neWtmOWNleS4quiEmuacrOWIsOiuvue9ruS4re+8jOS4jeWtmOWcqOWImea3u+WKoOWIsOacq+Wwvu+8jOWtmOWcqOWImeimhuebllxuICAgKiBAcGFyYW0gc2NyaXB0IOiEmuacrFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIGFzeW5jIHNhdmVTY3JpcHQoc2NyaXB0OiBTY3JpcHQsIHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAoIXNjcmlwdC5uYW1lIHx8IHNjcmlwdC5uYW1lLnRyaW0oKSA9PT0gJycpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignW1NjcmlwdE1hbmFnZXJdIOS/neWtmOWksei0pe+8jOiEmuacrOWQjeensOS4uuepuicpO1xuICAgIH1cblxuICAgIGNvbnN0IHJhd1JlcG9zaXRvcnkgPVxuICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUxcbiAgICAgICAgPyBnZXRTZXR0aW5nVmFsdWUoJ3NjcmlwdC5zY3JpcHRzUmVwb3NpdG9yeScpIHx8IFtdXG4gICAgICAgIDogLy9AdHMtaWdub3JlXG4gICAgICAgICAgY2hhcmFjdGVyc1t0aGlzX2NoaWRdPy5kYXRhPy5leHRlbnNpb25zPy5UYXZlcm5IZWxwZXJfc2NyaXB0cyB8fCBbXTtcblxuICAgIGNvbnN0IHJlcG9zaXRvcnkgPSB0aGlzLmVuc3VyZVJlcG9zaXRvcnlTdHJ1Y3R1cmUocmF3UmVwb3NpdG9yeSk7XG5cbiAgICBsZXQgZm91bmRJbmRleCA9IC0xO1xuICAgIGxldCBmb3VuZEluRm9sZGVyID0gZmFsc2U7XG4gICAgbGV0IGZvbGRlckluZGV4ID0gLTE7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlcG9zaXRvcnkubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGl0ZW0gPSByZXBvc2l0b3J5W2ldO1xuICAgICAgaWYgKGl0ZW0udHlwZSA9PT0gJ3NjcmlwdCcgJiYgKGl0ZW0udmFsdWUgYXMgU2NyaXB0KS5pZCA9PT0gc2NyaXB0LmlkKSB7XG4gICAgICAgIGZvdW5kSW5kZXggPSBpO1xuICAgICAgICBicmVhaztcbiAgICAgIH0gZWxzZSBpZiAoaXRlbS50eXBlID09PSAnZm9sZGVyJykge1xuICAgICAgICBjb25zdCBzY3JpcHRzID0gaXRlbS52YWx1ZSBhcyBTY3JpcHRbXTtcbiAgICAgICAgY29uc3Qgc2NyaXB0SW5kZXggPSBzY3JpcHRzLmZpbmRJbmRleChzID0+IHMuaWQgPT09IHNjcmlwdC5pZCk7XG4gICAgICAgIGlmIChzY3JpcHRJbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICBmb3VuZEluRm9sZGVyID0gdHJ1ZTtcbiAgICAgICAgICBmb2xkZXJJbmRleCA9IGk7XG4gICAgICAgICAgZm91bmRJbmRleCA9IHNjcmlwdEluZGV4O1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGZvdW5kSW5Gb2xkZXIgJiYgZm9sZGVySW5kZXggPj0gMCkge1xuICAgICAgY29uc3QgZm9sZGVyID0gcmVwb3NpdG9yeVtmb2xkZXJJbmRleF07XG4gICAgICAoZm9sZGVyLnZhbHVlIGFzIFNjcmlwdFtdKVtmb3VuZEluZGV4XSA9IHNjcmlwdDtcbiAgICB9IGVsc2UgaWYgKGZvdW5kSW5kZXggPj0gMCkge1xuICAgICAgKHJlcG9zaXRvcnlbZm91bmRJbmRleF0udmFsdWUgYXMgU2NyaXB0KSA9IHNjcmlwdDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVwb3NpdG9yeS5wdXNoKHtcbiAgICAgICAgdHlwZTogJ3NjcmlwdCcsXG4gICAgICAgIHZhbHVlOiBzY3JpcHQsXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAodHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwpIHtcbiAgICAgIGF3YWl0IHRoaXMuc2F2ZUdsb2JhbFJlcG9zaXRvcnlJdGVtcyhyZXBvc2l0b3J5KTtcbiAgICB9IGVsc2Uge1xuICAgICAgYXdhaXQgdGhpcy5zYXZlQ2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKHJlcG9zaXRvcnkpO1xuICAgIH1cblxuICAgIHRoaXMubG9hZFNjcmlwdHMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDnoa7kv53ku5PlupPkvb/nlKjmlrDnmoTmlbDmja7nu5PmnoRcbiAgICogQHBhcmFtIHJhd1JlcG9zaXRvcnkg5Y6f5aeL5LuT5bqT5pWw5o2uXG4gICAqIEByZXR1cm5zIOinhOiMg+WMlueahOS7k+W6k+aVsOaNrlxuICAgKi9cbiAgcHJpdmF0ZSBlbnN1cmVSZXBvc2l0b3J5U3RydWN0dXJlKHJhd1JlcG9zaXRvcnk6IGFueVtdKTogU2NyaXB0UmVwb3NpdG9yeUl0ZW1bXSB7XG4gICAgY29uc3QgcmVwb3NpdG9yeTogU2NyaXB0UmVwb3NpdG9yeUl0ZW1bXSA9IFtdO1xuXG4gICAgZm9yIChjb25zdCBpdGVtIG9mIHJhd1JlcG9zaXRvcnkpIHtcbiAgICAgIGlmIChpc1NjcmlwdChpdGVtKSkge1xuICAgICAgICByZXBvc2l0b3J5LnB1c2goe1xuICAgICAgICAgIHR5cGU6ICdzY3JpcHQnLFxuICAgICAgICAgIHZhbHVlOiBuZXcgU2NyaXB0KGl0ZW0pLFxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSBpZiAoaXNTY3JpcHRSZXBvc2l0b3J5SXRlbShpdGVtKSkge1xuICAgICAgICBpZiAoaXRlbS50eXBlID09PSAnc2NyaXB0Jykge1xuICAgICAgICAgIHJlcG9zaXRvcnkucHVzaCh7XG4gICAgICAgICAgICB0eXBlOiAnc2NyaXB0JyxcbiAgICAgICAgICAgIHZhbHVlOiBuZXcgU2NyaXB0KGl0ZW0udmFsdWUgYXMgUGFydGlhbDxTY3JpcHQ+KSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIGlmIChpdGVtLnR5cGUgPT09ICdmb2xkZXInKSB7XG4gICAgICAgICAgaWYgKCFpdGVtLmljb24pIHtcbiAgICAgICAgICAgIGl0ZW0uaWNvbiA9ICdmYS1mb2xkZXInO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoIWl0ZW0uY29sb3IpIHtcbiAgICAgICAgICAgIGl0ZW0uY29sb3IgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnLS1TbWFydFRoZW1lQm9keUNvbG9yJyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJlcG9zaXRvcnkucHVzaCh7XG4gICAgICAgICAgICAuLi5pdGVtLFxuICAgICAgICAgICAgdmFsdWU6IEFycmF5LmlzQXJyYXkoaXRlbS52YWx1ZSkgPyBpdGVtLnZhbHVlLm1hcCgoczogYW55KSA9PiBuZXcgU2NyaXB0KHMpKSA6IFtdLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIHJlcG9zaXRvcnkucHVzaCh7XG4gICAgICAgICAgICB0eXBlOiAnc2NyaXB0JyxcbiAgICAgICAgICAgIHZhbHVlOiBuZXcgU2NyaXB0KGl0ZW0pLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGxvZy53YXJuKCdbU2NyaXB0TWFuYWdlcl0g5peg5rOV6Kej5p6Q55qE6ISa5pys5pWw5o2uOicsIGl0ZW0sIGVycm9yKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiByZXBvc2l0b3J5O1xuICB9XG5cbiAgLyoqXG4gICAqIOS/neWtmOWFqOWxgOiEmuacrOaVsOe7hOWIsOaJqeWxleiuvue9rlxuICAgKiBAcGFyYW0gYXJyYXkg6ISa5pys5pWw57uEXG4gICAqL1xuICBhc3luYyBzYXZlR2xvYmFsU2NyaXB0cyhhcnJheTogU2NyaXB0W10pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBzYXZlU2V0dGluZ1ZhbHVlKCdzY3JpcHQuc2NyaXB0c1JlcG9zaXRvcnknLCBhcnJheSk7XG4gICAgdGhpcy5nbG9iYWxTY3JpcHRzID0gYXJyYXk7XG4gIH1cblxuICAvKipcbiAgICog5L+d5a2Y6ISa5pys5pWw57uE5Yiw6KeS6Imy5Y2h5pWw5o2uXG4gICAqIEBwYXJhbSBhcnJheSDohJrmnKzmlbDnu4RcbiAgICovXG4gIGFzeW5jIHNhdmVDaGFyYWN0ZXJTY3JpcHRzKGFycmF5OiBTY3JpcHRbXSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICghdGhpc19jaGlkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDkv53lrZjlpLHotKXvvIzlvZPliY3op5LoibLkuLrnqbonKTtcbiAgICB9XG5cbiAgICAvL0B0cy1pZ25vcmVcbiAgICBhd2FpdCB3cml0ZUV4dGVuc2lvbkZpZWxkKHRoaXNfY2hpZCwgJ1RhdmVybkhlbHBlcl9zY3JpcHRzJywgYXJyYXkpO1xuXG4gICAgdGhpcy5jaGFyYWN0ZXJTY3JpcHRzID0gYXJyYXk7XG4gIH1cblxuICAvKipcbiAgICog5L+d5a2Y5YWo5bGA6ISa5pys5LuT5bqT6aG55pWw57uE5Yiw5omp5bGV6K6+572uXG4gICAqIEBwYXJhbSByZXBvc2l0b3J5IOS7k+W6k+mhueaVsOe7hFxuICAgKi9cbiAgYXN5bmMgc2F2ZUdsb2JhbFJlcG9zaXRvcnlJdGVtcyhyZXBvc2l0b3J5OiBTY3JpcHRSZXBvc2l0b3J5SXRlbVtdKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgc2F2ZVNldHRpbmdWYWx1ZSgnc2NyaXB0LnNjcmlwdHNSZXBvc2l0b3J5JywgcmVwb3NpdG9yeSk7XG4gICAgdGhpcy5nbG9iYWxTY3JpcHRzID0gZXh0cmFjdFNjcmlwdHNGcm9tUmVwb3NpdG9yeShyZXBvc2l0b3J5KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDkv53lrZjohJrmnKzku5PlupPpobnmlbDnu4TliLDop5LoibLljaHmlbDmja5cbiAgICogQHBhcmFtIHJlcG9zaXRvcnkg5LuT5bqT6aG55pWw57uEXG4gICAqL1xuICBhc3luYyBzYXZlQ2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKHJlcG9zaXRvcnk6IFNjcmlwdFJlcG9zaXRvcnlJdGVtW10pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAoIXRoaXNfY2hpZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdbU2NyaXB0TWFuYWdlcl0g5L+d5a2Y5aSx6LSl77yM5b2T5YmN6KeS6Imy5Li656m6Jyk7XG4gICAgfVxuICAgIC8vQHRzLWlnbm9yZVxuICAgIGF3YWl0IHdyaXRlRXh0ZW5zaW9uRmllbGQodGhpc19jaGlkLCAnVGF2ZXJuSGVscGVyX3NjcmlwdHMnLCByZXBvc2l0b3J5KTtcblxuICAgIHRoaXMuY2hhcmFjdGVyU2NyaXB0cyA9IGV4dHJhY3RTY3JpcHRzRnJvbVJlcG9zaXRvcnkocmVwb3NpdG9yeSk7XG4gIH1cblxuICAvKipcbiAgICog5LuO6ISa5pys5bqT5Lit5Yig6Zmk6ISa5pysXG4gICAqIEBwYXJhbSBpZCDohJrmnKxJRFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIGFzeW5jIGRlbGV0ZVNjcmlwdChpZDogc3RyaW5nLCB0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgcmVwb3NpdG9yeSA9XG4gICAgICB0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCA/IHRoaXMuZ2V0R2xvYmFsUmVwb3NpdG9yeUl0ZW1zKCkgOiB0aGlzLmdldENoYXJhY3RlclJlcG9zaXRvcnlJdGVtcygpO1xuXG4gICAgbGV0IHNjcmlwdEZvdW5kID0gZmFsc2U7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlcG9zaXRvcnkubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGl0ZW0gPSByZXBvc2l0b3J5W2ldO1xuICAgICAgaWYgKGl0ZW0udHlwZSA9PT0gJ3NjcmlwdCcgJiYgKGl0ZW0udmFsdWUgYXMgU2NyaXB0KS5pZCA9PT0gaWQpIHtcbiAgICAgICAgcmVwb3NpdG9yeS5zcGxpY2UoaSwgMSk7XG4gICAgICAgIHNjcmlwdEZvdW5kID0gdHJ1ZTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9IGVsc2UgaWYgKGl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicpIHtcbiAgICAgICAgY29uc3Qgc2NyaXB0cyA9IGl0ZW0udmFsdWUgYXMgU2NyaXB0W107XG4gICAgICAgIGNvbnN0IGZvdW5kSW5kZXggPSBzY3JpcHRzLmZpbmRJbmRleChzID0+IHMuaWQgPT09IGlkKTtcbiAgICAgICAgaWYgKGZvdW5kSW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgc2NyaXB0cy5zcGxpY2UoZm91bmRJbmRleCwgMSk7XG4gICAgICAgICAgc2NyaXB0Rm91bmQgPSB0cnVlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCFzY3JpcHRGb3VuZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdbU2NyaXB0TWFuYWdlcl0g5Yig6Zmk6ISa5pys5aSx6LSl77yM6ISa5pys5LiN5a2Y5ZyoJyk7XG4gICAgfVxuXG4gICAgaWYgKHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMKSB7XG4gICAgICBhd2FpdCB0aGlzLnNhdmVHbG9iYWxSZXBvc2l0b3J5SXRlbXMocmVwb3NpdG9yeSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGF3YWl0IHRoaXMuc2F2ZUNoYXJhY3RlclJlcG9zaXRvcnlJdGVtcyhyZXBvc2l0b3J5KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5pu05paw6ISa5pys5ZCv55So54q25oCBXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKiBAcGFyYW0gZW5hYmxlIOaYr+WQpuWQr+eUqFxuICAgKi9cbiAgYXN5bmMgdXBkYXRlU2NyaXB0VHlwZUVuYWJsZVN0YXRlKHR5cGU6IFNjcmlwdFR5cGUsIGVuYWJsZTogYm9vbGVhbik6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICh0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCkge1xuICAgICAgc2F2ZVNldHRpbmdWYWx1ZSgnc2NyaXB0Lmdsb2JhbF9zY3JpcHRfZW5hYmxlZCcsIGVuYWJsZSk7XG4gICAgICB0aGlzLl9pc0dsb2JhbFNjcmlwdEVuYWJsZWQgPSBlbmFibGU7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGNoYXJhY3RlcnNXaXRoU2NyaXB0cyA9IGdldFNldHRpbmdWYWx1ZSgnc2NyaXB0LmNoYXJhY3RlcnNfd2l0aF9zY3JpcHRzJykgfHwgW107XG4gICAgICAvL0B0cy1pZ25vcmVcbiAgICAgIGNvbnN0IGF2YXRhciA9IGNoYXJhY3RlcnM/Llt0aGlzX2NoaWRdPy5hdmF0YXI7XG5cbiAgICAgIGlmIChlbmFibGUpIHtcbiAgICAgICAgaWYgKGF2YXRhciAmJiAhY2hhcmFjdGVyc1dpdGhTY3JpcHRzLmluY2x1ZGVzKGF2YXRhcikpIHtcbiAgICAgICAgICBjaGFyYWN0ZXJzV2l0aFNjcmlwdHMucHVzaChhdmF0YXIpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBpbmRleCA9IGNoYXJhY3RlcnNXaXRoU2NyaXB0cy5pbmRleE9mKGF2YXRhcik7XG4gICAgICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICBjaGFyYWN0ZXJzV2l0aFNjcmlwdHMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBzYXZlU2V0dGluZ1ZhbHVlKCdzY3JpcHQuY2hhcmFjdGVyc193aXRoX3NjcmlwdHMnLCBjaGFyYWN0ZXJzV2l0aFNjcmlwdHMpO1xuICAgICAgdGhpcy5faXNDaGFyYWN0ZXJTY3JpcHRFbmFibGVkID0gZW5hYmxlO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5bohJrmnKznmoTnsbvlnotcbiAgICogQHBhcmFtIHNjcmlwdCDohJrmnKzlr7nosaFcbiAgICogQHJldHVybnMg6ISa5pys57G75Z6LXG4gICAqL1xuICBwdWJsaWMgZ2V0U2NyaXB0VHlwZShzY3JpcHQ6IFNjcmlwdCk6IFNjcmlwdFR5cGUge1xuICAgIHJldHVybiB0aGlzLmdsb2JhbFNjcmlwdHMuc29tZShzID0+IHMuaWQgPT09IHNjcmlwdC5pZCkgPyBTY3JpcHRUeXBlLkdMT0JBTCA6IFNjcmlwdFR5cGUuQ0hBUkFDVEVSO1xuICB9XG5cbiAgLyoqXG4gICAqIOWIt+aWsOinkuiJsuiEmuacrOWQr+eUqOeKtuaAgVxuICAgKi9cbiAgcmVmcmVzaENoYXJhY3RlclNjcmlwdEVuYWJsZWRTdGF0ZSgpOiB2b2lkIHtcbiAgICB0aGlzLl9pc0NoYXJhY3RlclNjcmlwdEVuYWJsZWQgPSB0aGlzLmNoZWNrQ2hhcmFjdGVyU2NyaXB0RW5hYmxlZCgpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluWFqOWxgOiEmuacrOS7k+W6k+mhuVxuICAgKi9cbiAgZ2V0R2xvYmFsUmVwb3NpdG9yeUl0ZW1zKCk6IFNjcmlwdFJlcG9zaXRvcnlJdGVtW10ge1xuICAgIGNvbnN0IHJhd1JlcG9zaXRvcnkgPSBnZXRTZXR0aW5nVmFsdWUoJ3NjcmlwdC5zY3JpcHRzUmVwb3NpdG9yeScpIHx8IFtdO1xuICAgIHJldHVybiB0aGlzLmVuc3VyZVJlcG9zaXRvcnlTdHJ1Y3R1cmUocmF3UmVwb3NpdG9yeSk7XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W6KeS6Imy6ISa5pys5LuT5bqT6aG5XG4gICAqL1xuICBnZXRDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMoKTogU2NyaXB0UmVwb3NpdG9yeUl0ZW1bXSB7XG4gICAgLy9AdHMtaWdub3JlXG4gICAgY29uc3QgcmF3UmVwb3NpdG9yeSA9IGNoYXJhY3RlcnNbdGhpc19jaGlkXT8uZGF0YT8uZXh0ZW5zaW9ucz8uVGF2ZXJuSGVscGVyX3NjcmlwdHMgfHwgW107XG4gICAgcmV0dXJuIHRoaXMuZW5zdXJlUmVwb3NpdG9yeVN0cnVjdHVyZShyYXdSZXBvc2l0b3J5KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDliJvlu7rmlofku7blpLlcbiAgICogQHBhcmFtIG5hbWUg5paH5Lu25aS55ZCN56ewXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKiBAcGFyYW0gaWNvbiDmlofku7blpLnlm77moIfvvIjlj6/pgInvvIlcbiAgICogQHBhcmFtIGNvbG9yIOaWh+S7tuWkueminOiJsu+8iOWPr+mAie+8iVxuICAgKiBAcmV0dXJucyDmlrDliJvlu7rnmoTmlofku7blpLlJRFxuICAgKi9cbiAgYXN5bmMgY3JlYXRlRm9sZGVyKG5hbWU6IHN0cmluZywgdHlwZTogU2NyaXB0VHlwZSwgaWNvbj86IHN0cmluZywgY29sb3I/OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGlmICghbmFtZSB8fCBuYW1lLnRyaW0oKSA9PT0gJycpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignW1NjcmlwdE1hbmFnZXJdIOaWh+S7tuWkueWQjeensOS4jeiDveS4uuepuicpO1xuICAgIH1cblxuICAgIGNvbnN0IHJlcG9zaXRvcnkgPVxuICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyB0aGlzLmdldEdsb2JhbFJlcG9zaXRvcnlJdGVtcygpIDogdGhpcy5nZXRDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMoKTtcblxuICAgIGNvbnN0IGV4aXN0aW5nRm9sZGVyID0gcmVwb3NpdG9yeS5maW5kKGl0ZW0gPT4gaXRlbS50eXBlID09PSAnZm9sZGVyJyAmJiBpdGVtLm5hbWUgPT09IG5hbWUudHJpbSgpKTtcbiAgICBpZiAoZXhpc3RpbmdGb2xkZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignW1NjcmlwdE1hbmFnZXJdIOaWh+S7tuWkueWQjeensOW3suWtmOWcqCcpO1xuICAgIH1cblxuICAgIGNvbnN0IGZvbGRlcklkID0gdXVpZHY0KCk7XG4gICAgY29uc3QgbmV3Rm9sZGVyOiBTY3JpcHRSZXBvc2l0b3J5SXRlbSA9IHtcbiAgICAgIHR5cGU6ICdmb2xkZXInLFxuICAgICAgaWQ6IGZvbGRlcklkLFxuICAgICAgbmFtZTogbmFtZS50cmltKCksXG4gICAgICBpY29uOiBpY29uIHx8ICdmYS1mb2xkZXInLFxuICAgICAgY29sb3I6IGNvbG9yIHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCctLVNtYXJ0VGhlbWVCb2R5Q29sb3InKSxcbiAgICAgIHZhbHVlOiBbXSxcbiAgICB9O1xuXG4gICAgcmVwb3NpdG9yeS51bnNoaWZ0KG5ld0ZvbGRlcik7XG5cbiAgICBpZiAodHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwpIHtcbiAgICAgIGF3YWl0IHRoaXMuc2F2ZUdsb2JhbFJlcG9zaXRvcnlJdGVtcyhyZXBvc2l0b3J5KTtcbiAgICB9IGVsc2Uge1xuICAgICAgYXdhaXQgdGhpcy5zYXZlQ2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKHJlcG9zaXRvcnkpO1xuICAgIH1cblxuICAgIHJldHVybiBmb2xkZXJJZDtcbiAgfVxuXG4gIC8qKlxuICAgKiDnvJbovpHmlofku7blpLlcbiAgICogQHBhcmFtIGZvbGRlcklkIOaWh+S7tuWkuUlEXG4gICAqIEBwYXJhbSBuZXdOYW1lIOaWsOWQjeensFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICogQHBhcmFtIG5ld0ljb24g5paw5Zu+5qCHXG4gICAqIEBwYXJhbSBuZXdDb2xvciDmlrDpopzoibJcbiAgICovXG4gIGFzeW5jIGVkaXRGb2xkZXIoXG4gICAgZm9sZGVySWQ6IHN0cmluZyxcbiAgICBuZXdOYW1lOiBzdHJpbmcsXG4gICAgdHlwZTogU2NyaXB0VHlwZSxcbiAgICBuZXdJY29uPzogc3RyaW5nLFxuICAgIG5ld0NvbG9yPzogc3RyaW5nLFxuICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAoIW5ld05hbWUgfHwgbmV3TmFtZS50cmltKCkgPT09ICcnKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDmlofku7blpLnlkI3np7DkuI3og73kuLrnqbonKTtcbiAgICB9XG5cbiAgICBjb25zdCByZXBvc2l0b3J5ID1cbiAgICAgIHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMID8gdGhpcy5nZXRHbG9iYWxSZXBvc2l0b3J5SXRlbXMoKSA6IHRoaXMuZ2V0Q2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKCk7XG5cbiAgICBjb25zdCBmb2xkZXJJbmRleCA9IHJlcG9zaXRvcnkuZmluZEluZGV4KGl0ZW0gPT4gaXRlbS50eXBlID09PSAnZm9sZGVyJyAmJiBpdGVtLmlkID09PSBmb2xkZXJJZCk7XG4gICAgaWYgKGZvbGRlckluZGV4ID09PSAtMSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdbU2NyaXB0TWFuYWdlcl0g5paH5Lu25aS55LiN5a2Y5ZyoJyk7XG4gICAgfVxuXG4gICAgY29uc3QgZXhpc3RpbmdGb2xkZXIgPSByZXBvc2l0b3J5LmZpbmQoXG4gICAgICBpdGVtID0+IGl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicgJiYgaXRlbS5uYW1lID09PSBuZXdOYW1lLnRyaW0oKSAmJiBpdGVtLmlkICE9PSBmb2xkZXJJZCxcbiAgICApO1xuICAgIGlmIChleGlzdGluZ0ZvbGRlcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdbU2NyaXB0TWFuYWdlcl0g5paH5Lu25aS55ZCN56ew5bey5a2Y5ZyoJyk7XG4gICAgfVxuXG4gICAgcmVwb3NpdG9yeVtmb2xkZXJJbmRleF0ubmFtZSA9IG5ld05hbWUudHJpbSgpO1xuICAgIGlmIChuZXdJY29uICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHJlcG9zaXRvcnlbZm9sZGVySW5kZXhdLmljb24gPSBuZXdJY29uO1xuICAgIH1cbiAgICBpZiAobmV3Q29sb3IgIT09IHVuZGVmaW5lZCkge1xuICAgICAgcmVwb3NpdG9yeVtmb2xkZXJJbmRleF0uY29sb3IgPSBuZXdDb2xvcjtcbiAgICB9XG5cbiAgICBpZiAodHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwpIHtcbiAgICAgIGF3YWl0IHRoaXMuc2F2ZUdsb2JhbFJlcG9zaXRvcnlJdGVtcyhyZXBvc2l0b3J5KTtcbiAgICB9IGVsc2Uge1xuICAgICAgYXdhaXQgdGhpcy5zYXZlQ2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKHJlcG9zaXRvcnkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDliKDpmaTmlofku7blpLnvvIjlkIzml7bliKDpmaTlhoXpg6jnmoTmiYDmnInohJrmnKzvvIlcbiAgICogQHBhcmFtIGZvbGRlcklkIOaWh+S7tuWkuUlEXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgYXN5bmMgZGVsZXRlRm9sZGVyKGZvbGRlcklkOiBzdHJpbmcsIHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCByZXBvc2l0b3J5ID1cbiAgICAgIHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMID8gdGhpcy5nZXRHbG9iYWxSZXBvc2l0b3J5SXRlbXMoKSA6IHRoaXMuZ2V0Q2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKCk7XG5cbiAgICBjb25zdCBmb2xkZXJJbmRleCA9IHJlcG9zaXRvcnkuZmluZEluZGV4KGl0ZW0gPT4gaXRlbS50eXBlID09PSAnZm9sZGVyJyAmJiBpdGVtLmlkID09PSBmb2xkZXJJZCk7XG4gICAgaWYgKGZvbGRlckluZGV4ID09PSAtMSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdbU2NyaXB0TWFuYWdlcl0g5paH5Lu25aS55LiN5a2Y5ZyoJyk7XG4gICAgfVxuXG4gICAgcmVwb3NpdG9yeS5zcGxpY2UoZm9sZGVySW5kZXgsIDEpO1xuXG4gICAgaWYgKHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMKSB7XG4gICAgICBhd2FpdCB0aGlzLnNhdmVHbG9iYWxSZXBvc2l0b3J5SXRlbXMocmVwb3NpdG9yeSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGF3YWl0IHRoaXMuc2F2ZUNoYXJhY3RlclJlcG9zaXRvcnlJdGVtcyhyZXBvc2l0b3J5KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5bCG6aG555uu77yI6ISa5pys5oiW5paH5Lu25aS577yJ56e75Yqo5Yiw5YW25LuW57G75Z6L55qE5LuT5bqTXG4gICAqIEBwYXJhbSBpdGVtIOimgeenu+WKqOeahOmhueebruS/oeaBr1xuICAgKiBAcGFyYW0gc291cmNlVHlwZSDmupDnsbvlnotcbiAgICovXG4gIGFzeW5jIG1vdmVJdGVtVG9PdGhlclR5cGUoXG4gICAgaXRlbTogeyB0eXBlOiAnc2NyaXB0JzsgaWQ6IHN0cmluZzsgdmFsdWU6IFNjcmlwdCB9IHwgeyB0eXBlOiAnZm9sZGVyJzsgaWQ6IHN0cmluZyB9LFxuICAgIHNvdXJjZVR5cGU6IFNjcmlwdFR5cGUsXG4gICk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHRhcmdldFR5cGUgPSBnZXRPcHBvc2l0ZVNjcmlwdFR5cGUoc291cmNlVHlwZSk7XG5cbiAgICBjb25zdCBzb3VyY2VSZXBvc2l0b3J5ID1cbiAgICAgIHNvdXJjZVR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMID8gdGhpcy5nZXRHbG9iYWxSZXBvc2l0b3J5SXRlbXMoKSA6IHRoaXMuZ2V0Q2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKCk7XG5cbiAgICBsZXQgaXRlbUZvdW5kID0gZmFsc2U7XG4gICAgbGV0IGZvdW5kSXRlbTogU2NyaXB0UmVwb3NpdG9yeUl0ZW0gfCBudWxsID0gbnVsbDtcblxuICAgIGlmIChpdGVtLnR5cGUgPT09ICdzY3JpcHQnKSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNvdXJjZVJlcG9zaXRvcnkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgcmVwb0l0ZW0gPSBzb3VyY2VSZXBvc2l0b3J5W2ldO1xuICAgICAgICBpZiAocmVwb0l0ZW0udHlwZSA9PT0gJ3NjcmlwdCcgJiYgKHJlcG9JdGVtLnZhbHVlIGFzIFNjcmlwdCkuaWQgPT09IGl0ZW0uaWQpIHtcbiAgICAgICAgICBmb3VuZEl0ZW0gPSByZXBvSXRlbTtcbiAgICAgICAgICBzb3VyY2VSZXBvc2l0b3J5LnNwbGljZShpLCAxKTtcbiAgICAgICAgICBpdGVtRm91bmQgPSB0cnVlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9IGVsc2UgaWYgKHJlcG9JdGVtLnR5cGUgPT09ICdmb2xkZXInKSB7XG4gICAgICAgICAgY29uc3Qgc2NyaXB0cyA9IHJlcG9JdGVtLnZhbHVlIGFzIFNjcmlwdFtdO1xuICAgICAgICAgIGNvbnN0IGZvdW5kSW5kZXggPSBzY3JpcHRzLmZpbmRJbmRleChzID0+IHMuaWQgPT09IGl0ZW0uaWQpO1xuICAgICAgICAgIGlmIChmb3VuZEluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgZm91bmRJdGVtID0geyB0eXBlOiAnc2NyaXB0JywgdmFsdWU6IHNjcmlwdHNbZm91bmRJbmRleF0gfTtcbiAgICAgICAgICAgIHNjcmlwdHMuc3BsaWNlKGZvdW5kSW5kZXgsIDEpO1xuICAgICAgICAgICAgaXRlbUZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoIWl0ZW1Gb3VuZCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDnp7vliqjohJrmnKzlpLHotKXvvIzohJrmnKzkuI3lrZjlnKgnKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicpIHtcbiAgICAgIGNvbnN0IGZvbGRlckluZGV4ID0gc291cmNlUmVwb3NpdG9yeS5maW5kSW5kZXgocmVwb0l0ZW0gPT4gcmVwb0l0ZW0udHlwZSA9PT0gJ2ZvbGRlcicgJiYgcmVwb0l0ZW0uaWQgPT09IGl0ZW0uaWQpO1xuICAgICAgaWYgKGZvbGRlckluZGV4ID09PSAtMSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDmlofku7blpLnkuI3lrZjlnKgnKTtcbiAgICAgIH1cblxuICAgICAgZm91bmRJdGVtID0gc291cmNlUmVwb3NpdG9yeVtmb2xkZXJJbmRleF07XG4gICAgICBzb3VyY2VSZXBvc2l0b3J5LnNwbGljZShmb2xkZXJJbmRleCwgMSk7XG4gICAgICBpdGVtRm91bmQgPSB0cnVlO1xuICAgIH1cblxuICAgIGlmICghaXRlbUZvdW5kIHx8ICFmb3VuZEl0ZW0pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignW1NjcmlwdE1hbmFnZXJdIOenu+WKqOWksei0pe+8jOmhueebruS4jeWtmOWcqCcpO1xuICAgIH1cblxuICAgIGNvbnN0IHRhcmdldFJlcG9zaXRvcnkgPVxuICAgICAgdGFyZ2V0VHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyB0aGlzLmdldEdsb2JhbFJlcG9zaXRvcnlJdGVtcygpIDogdGhpcy5nZXRDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMoKTtcblxuICAgIGlmIChmb3VuZEl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicpIHtcbiAgICAgIGNvbnN0IGV4aXN0aW5nRm9sZGVyID0gdGFyZ2V0UmVwb3NpdG9yeS5maW5kKFxuICAgICAgICByZXBvSXRlbSA9PiByZXBvSXRlbS50eXBlID09PSAnZm9sZGVyJyAmJiByZXBvSXRlbS5uYW1lID09PSBmb3VuZEl0ZW0hLm5hbWUsXG4gICAgICApO1xuICAgICAgaWYgKGV4aXN0aW5nRm9sZGVyKSB7XG4gICAgICAgIHRvYXN0ci5lcnJvcign55uu5qCH5L2N572u5bey5a2Y5Zyo5ZCM5ZCN5paH5Lu25aS5Jyk7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignW1NjcmlwdE1hbmFnZXJdIOebruagh+S9jee9ruW3suWtmOWcqOWQjOWQjeaWh+S7tuWkuScpO1xuICAgICAgfVxuICAgICAgdGFyZ2V0UmVwb3NpdG9yeS51bnNoaWZ0KGZvdW5kSXRlbSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRhcmdldFJlcG9zaXRvcnkucHVzaChmb3VuZEl0ZW0pO1xuICAgIH1cblxuICAgIGlmIChzb3VyY2VUeXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCkge1xuICAgICAgYXdhaXQgdGhpcy5zYXZlR2xvYmFsUmVwb3NpdG9yeUl0ZW1zKHNvdXJjZVJlcG9zaXRvcnkpO1xuICAgICAgYXdhaXQgdGhpcy5zYXZlQ2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKHRhcmdldFJlcG9zaXRvcnkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBhd2FpdCB0aGlzLnNhdmVDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMoc291cmNlUmVwb3NpdG9yeSk7XG4gICAgICBhd2FpdCB0aGlzLnNhdmVHbG9iYWxSZXBvc2l0b3J5SXRlbXModGFyZ2V0UmVwb3NpdG9yeSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWwhuiEmuacrOenu+WKqOWIsOaWh+S7tuWkuVxuICAgKiBAcGFyYW0gc2NyaXB0SWQg6ISa5pysSURcbiAgICogQHBhcmFtIHRhcmdldEZvbGRlcklkIOebruagh+aWh+S7tuWkuUlE77yM5aaC5p6c5Li6bnVsbOWImeenu+WKqOWIsOaguee6p+WIq1xuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIGFzeW5jIG1vdmVTY3JpcHRUb0ZvbGRlcihzY3JpcHRJZDogc3RyaW5nLCB0YXJnZXRGb2xkZXJJZDogc3RyaW5nIHwgbnVsbCwgdHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHJlcG9zaXRvcnkgPVxuICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyB0aGlzLmdldEdsb2JhbFJlcG9zaXRvcnlJdGVtcygpIDogdGhpcy5nZXRDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMoKTtcblxuICAgIGxldCBzY3JpcHQ6IFNjcmlwdCB8IG51bGwgPSBudWxsO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXBvc2l0b3J5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBpdGVtID0gcmVwb3NpdG9yeVtpXTtcbiAgICAgIGlmIChpdGVtLnR5cGUgPT09ICdzY3JpcHQnICYmIChpdGVtLnZhbHVlIGFzIFNjcmlwdCkuaWQgPT09IHNjcmlwdElkKSB7XG4gICAgICAgIHNjcmlwdCA9IGl0ZW0udmFsdWUgYXMgU2NyaXB0O1xuICAgICAgICByZXBvc2l0b3J5LnNwbGljZShpLCAxKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9IGVsc2UgaWYgKGl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicpIHtcbiAgICAgICAgY29uc3Qgc2NyaXB0cyA9IGl0ZW0udmFsdWUgYXMgU2NyaXB0W107XG4gICAgICAgIGNvbnN0IGZvdW5kSW5kZXggPSBzY3JpcHRzLmZpbmRJbmRleChzID0+IHMuaWQgPT09IHNjcmlwdElkKTtcbiAgICAgICAgaWYgKGZvdW5kSW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgc2NyaXB0ID0gc2NyaXB0c1tmb3VuZEluZGV4XTtcbiAgICAgICAgICBzY3JpcHRzLnNwbGljZShmb3VuZEluZGV4LCAxKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmICghc2NyaXB0KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDohJrmnKzkuI3lrZjlnKgnKTtcbiAgICB9XG5cbiAgICBpZiAodGFyZ2V0Rm9sZGVySWQgPT09IG51bGwpIHtcbiAgICAgIHJlcG9zaXRvcnkucHVzaCh7XG4gICAgICAgIHR5cGU6ICdzY3JpcHQnLFxuICAgICAgICB2YWx1ZTogc2NyaXB0LFxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IHRhcmdldEZvbGRlciA9IHJlcG9zaXRvcnkuZmluZChpdGVtID0+IGl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicgJiYgaXRlbS5pZCA9PT0gdGFyZ2V0Rm9sZGVySWQpO1xuICAgICAgaWYgKCF0YXJnZXRGb2xkZXIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdbU2NyaXB0TWFuYWdlcl0g55uu5qCH5paH5Lu25aS55LiN5a2Y5ZyoJyk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGZvbGRlclNjcmlwdHMgPSB0YXJnZXRGb2xkZXIudmFsdWUgYXMgU2NyaXB0W107XG4gICAgICBjb25zdCBleGlzdGluZ1NjcmlwdCA9IGZvbGRlclNjcmlwdHMuZmluZChzID0+IHMubmFtZSA9PT0gc2NyaXB0Lm5hbWUpO1xuICAgICAgaWYgKGV4aXN0aW5nU2NyaXB0KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignW1NjcmlwdE1hbmFnZXJdIOaWh+S7tuWkueS4reW3suWtmOWcqOWQjOWQjeiEmuacrCcpO1xuICAgICAgfVxuXG4gICAgICBmb2xkZXJTY3JpcHRzLnB1c2goc2NyaXB0KTtcbiAgICB9XG5cbiAgICBpZiAodHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwpIHtcbiAgICAgIGF3YWl0IHRoaXMuc2F2ZUdsb2JhbFJlcG9zaXRvcnlJdGVtcyhyZXBvc2l0b3J5KTtcbiAgICB9IGVsc2Uge1xuICAgICAgYXdhaXQgdGhpcy5zYXZlQ2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKHJlcG9zaXRvcnkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5bmlofku7blpLnkuK3nmoTohJrmnKzliJfooahcbiAgICogQHBhcmFtIGZvbGRlcklkIOaWh+S7tuWkuUlEXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgZ2V0Rm9sZGVyU2NyaXB0cyhmb2xkZXJJZDogc3RyaW5nLCB0eXBlOiBTY3JpcHRUeXBlKTogU2NyaXB0W10ge1xuICAgIGNvbnN0IHJlcG9zaXRvcnkgPVxuICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyB0aGlzLmdldEdsb2JhbFJlcG9zaXRvcnlJdGVtcygpIDogdGhpcy5nZXRDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMoKTtcblxuICAgIGNvbnN0IGZvbGRlciA9IHJlcG9zaXRvcnkuZmluZChpdGVtID0+IGl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicgJiYgaXRlbS5pZCA9PT0gZm9sZGVySWQpO1xuXG4gICAgaWYgKCFmb2xkZXIpIHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICByZXR1cm4gZm9sZGVyLnZhbHVlIGFzIFNjcmlwdFtdO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluaguee6p+WIq+eahOiEmuacrOWIl+ihqFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIGdldFJvb3RTY3JpcHRzKHR5cGU6IFNjcmlwdFR5cGUpOiBTY3JpcHRbXSB7XG4gICAgY29uc3QgcmVwb3NpdG9yeSA9XG4gICAgICB0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCA/IHRoaXMuZ2V0R2xvYmFsUmVwb3NpdG9yeUl0ZW1zKCkgOiB0aGlzLmdldENoYXJhY3RlclJlcG9zaXRvcnlJdGVtcygpO1xuXG4gICAgcmV0dXJuIHJlcG9zaXRvcnkuZmlsdGVyKGl0ZW0gPT4gaXRlbS50eXBlID09PSAnc2NyaXB0JykubWFwKGl0ZW0gPT4gaXRlbS52YWx1ZSBhcyBTY3JpcHQpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluaJgOacieaWh+S7tuWkueWIl+ihqFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIGdldEZvbGRlcnModHlwZTogU2NyaXB0VHlwZSk6IFNjcmlwdFJlcG9zaXRvcnlJdGVtW10ge1xuICAgIGNvbnN0IHJlcG9zaXRvcnkgPVxuICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyB0aGlzLmdldEdsb2JhbFJlcG9zaXRvcnlJdGVtcygpIDogdGhpcy5nZXRDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMoKTtcblxuICAgIHJldHVybiByZXBvc2l0b3J5LmZpbHRlcihpdGVtID0+IGl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicpO1xuICB9XG5cbiAgLyoqXG4gICAqIOaJuemHj+WIh+aNouaWh+S7tuWkueWGheaJgOacieiEmuacrOeahOWQr+eUqOeKtuaAgVxuICAgKiBAcGFyYW0gZm9sZGVySWQg5paH5Lu25aS5SURcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqIEBwYXJhbSBlbmFibGUg5piv5ZCm5ZCv55SoXG4gICAqL1xuICBhc3luYyB0b2dnbGVGb2xkZXJTY3JpcHRzKGZvbGRlcklkOiBzdHJpbmcsIHR5cGU6IFNjcmlwdFR5cGUsIGVuYWJsZTogYm9vbGVhbik6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHJlcG9zaXRvcnkgPVxuICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyB0aGlzLmdldEdsb2JhbFJlcG9zaXRvcnlJdGVtcygpIDogdGhpcy5nZXRDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMoKTtcblxuICAgIGNvbnN0IGZvbGRlciA9IHJlcG9zaXRvcnkuZmluZChpdGVtID0+IGl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicgJiYgaXRlbS5pZCA9PT0gZm9sZGVySWQpO1xuICAgIGlmICghZm9sZGVyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDmlofku7blpLnkuI3lrZjlnKgnKTtcbiAgICB9XG5cbiAgICBjb25zdCBzY3JpcHRzID0gZm9sZGVyLnZhbHVlIGFzIFNjcmlwdFtdO1xuICAgIGxldCBoYXNDaGFuZ2VzID0gZmFsc2U7XG5cbiAgICBmb3IgKGNvbnN0IHNjcmlwdCBvZiBzY3JpcHRzKSB7XG4gICAgICBpZiAoc2NyaXB0LmVuYWJsZWQgIT09IGVuYWJsZSkge1xuICAgICAgICBzY3JpcHQuZW5hYmxlZCA9IGVuYWJsZTtcbiAgICAgICAgaGFzQ2hhbmdlcyA9IHRydWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGhhc0NoYW5nZXMpIHtcbiAgICAgIGlmICh0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCkge1xuICAgICAgICBhd2FpdCB0aGlzLnNhdmVHbG9iYWxSZXBvc2l0b3J5SXRlbXMocmVwb3NpdG9yeSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhd2FpdCB0aGlzLnNhdmVDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMocmVwb3NpdG9yeSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluaWh+S7tuWkueWGheiEmuacrOeahOaVtOS9k+WQr+eUqOeKtuaAgVxuICAgKiBAcGFyYW0gZm9sZGVySWQg5paH5Lu25aS5SURcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqIEByZXR1cm5zICdhbGwnIC0g5YWo6YOo5ZCv55SoLCAnbm9uZScgLSDlhajpg6jnpoHnlKhcbiAgICovXG4gIGdldEZvbGRlclNjcmlwdHNTdGF0ZShmb2xkZXJJZDogc3RyaW5nLCB0eXBlOiBTY3JpcHRUeXBlKTogJ2FsbCcgfCAnbm9uZScge1xuICAgIGNvbnN0IHNjcmlwdHMgPSB0aGlzLmdldEZvbGRlclNjcmlwdHMoZm9sZGVySWQsIHR5cGUpO1xuXG4gICAgaWYgKHNjcmlwdHMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gJ25vbmUnO1xuICAgIH1cblxuICAgIGNvbnN0IGVuYWJsZWRDb3VudCA9IHNjcmlwdHMuZmlsdGVyKHNjcmlwdCA9PiBzY3JpcHQuZW5hYmxlZCkubGVuZ3RoO1xuXG4gICAgaWYgKGVuYWJsZWRDb3VudCA9PT0gMCkge1xuICAgICAgcmV0dXJuICdub25lJztcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuICdhbGwnO1xuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIOS7juiEmuacrOWFgeiuuOWIl+ihqOS4reWIoOmZpOinkuiJslxuICogQHBhcmFtIHBhcmFtMFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcHVyZ2VFbWJlZGRlZFNjcmlwdHMoeyBjaGFyYWN0ZXIgfTogeyBjaGFyYWN0ZXI6IGFueSB9KTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IGF2YXRhciA9IGNoYXJhY3Rlcj8uY2hhcmFjdGVyPy5hdmF0YXI7XG4gIGNvbnN0IGNoYXJhY3RlcnNXaXRoU2NyaXB0cyA9IGdldFNldHRpbmdWYWx1ZSgnc2NyaXB0LmNoYXJhY3RlcnNfd2l0aF9zY3JpcHRzJykgfHwgW107XG4gIGlmIChhdmF0YXIpIHtcbiAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShgQWxlcnRTY3JpcHRfJHthdmF0YXJ9YCk7XG4gICAgaWYgKGNoYXJhY3RlcnNXaXRoU2NyaXB0cz8uaW5jbHVkZXMoYXZhdGFyKSkge1xuICAgICAgY29uc3QgaW5kZXggPSBjaGFyYWN0ZXJzV2l0aFNjcmlwdHMuaW5kZXhPZihhdmF0YXIpO1xuICAgICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgICBjaGFyYWN0ZXJzV2l0aFNjcmlwdHMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgc2F2ZVNldHRpbmdWYWx1ZSgnc2NyaXB0LmNoYXJhY3RlcnNfd2l0aF9zY3JpcHRzJywgY2hhcmFjdGVyc1dpdGhTY3JpcHRzKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/component/script_repository/data.ts\n\n}")},"./src/component/script_repository/events.ts":
/*!***************************************************!*\
  !*** ./src/component/script_repository/events.ts ***!
  \***************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   EventBus: () => (/* binding */ EventBus),\n/* harmony export */   ScriptRepositoryEventType: () => (/* binding */ ScriptRepositoryEventType),\n/* harmony export */   scriptEvents: () => (/* binding */ scriptEvents)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ "@sillytavern/script");\n/**\n * 脚本仓库事件类型\n */\nvar ScriptRepositoryEventType;\n(function (ScriptRepositoryEventType) {\n    ScriptRepositoryEventType["SCRIPT_TOGGLE"] = "script_toggle";\n    ScriptRepositoryEventType["SCRIPT_RUN"] = "script_run";\n    ScriptRepositoryEventType["SCRIPT_STOP"] = "script_stop";\n    ScriptRepositoryEventType["SCRIPT_CREATE"] = "script_create";\n    ScriptRepositoryEventType["SCRIPT_UPDATE"] = "script_update";\n    ScriptRepositoryEventType["SCRIPT_DELETE"] = "script_delete";\n    ScriptRepositoryEventType["SCRIPT_MOVE"] = "script_move";\n    ScriptRepositoryEventType["SCRIPT_EDIT"] = "script_edit";\n    ScriptRepositoryEventType["FOLDER_CREATE"] = "folder_create";\n    ScriptRepositoryEventType["FOLDER_EDIT"] = "folder_edit";\n    ScriptRepositoryEventType["FOLDER_DELETE"] = "folder_delete";\n    ScriptRepositoryEventType["FOLDER_MOVE"] = "folder_move";\n    ScriptRepositoryEventType["FOLDER_SCRIPTS_TOGGLE"] = "folder_scripts_toggle";\n    ScriptRepositoryEventType["TYPE_TOGGLE"] = "type_toggle";\n    ScriptRepositoryEventType["BUTTON_ADD"] = "button_add";\n    ScriptRepositoryEventType["BUTTON_REMOVE"] = "button_remove";\n    ScriptRepositoryEventType["SCRIPT_IMPORT"] = "script_import";\n    ScriptRepositoryEventType["SCRIPT_EXPORT"] = "script_export";\n    //VARIABLE_EDIT = \'variable_edit\',\n    ScriptRepositoryEventType["ORDER_CHANGED"] = "order_changed";\n    ScriptRepositoryEventType["UI_REFRESH"] = "ui_refresh";\n    ScriptRepositoryEventType["UI_LOADED"] = "ui_loaded";\n})(ScriptRepositoryEventType || (ScriptRepositoryEventType = {}));\n\n/**\n * 事件总线类，用于组件间通信\n */\nclass EventBus {\n    static instance;\n    EVENT_NAMESPACE = \'script_repository_\';\n    activeListeners = new Map();\n    constructor() { }\n    /**\n     * 获取事件总线实例\n     */\n    static getInstance() {\n        if (!EventBus.instance) {\n            EventBus.instance = new EventBus();\n        }\n        return EventBus.instance;\n    }\n    /**\n     * 获取带命名空间的事件名称\n     * @param eventType 事件类型\n     * @returns 带命名空间的事件名称\n     */\n    getNamespacedEvent(eventType) {\n        return `${this.EVENT_NAMESPACE}${eventType}`;\n    }\n    /**\n     * 添加事件监听器\n     * @param eventType 事件类型\n     * @param listener 监听器函数\n     */\n    on(eventType, listener) {\n        if (!this.activeListeners.has(eventType)) {\n            this.activeListeners.set(eventType, new Set());\n        }\n        this.activeListeners.get(eventType)?.add(listener);\n        const namespacedEvent = this.getNamespacedEvent(eventType);\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.on(namespacedEvent, listener);\n    }\n    /**\n     * 移除事件监听器\n     * @param eventType 事件类型\n     * @param listener 监听器函数\n     */\n    off(eventType, listener) {\n        const namespacedEvent = this.getNamespacedEvent(eventType);\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.removeListener(namespacedEvent, listener);\n        const listeners = this.activeListeners.get(eventType);\n        if (listeners) {\n            listeners.delete(listener);\n            if (listeners.size === 0) {\n                this.activeListeners.delete(eventType);\n            }\n        }\n    }\n    /**\n     * 触发事件\n     * @param eventType 事件类型\n     * @param data 事件数据\n     */\n    emit(eventType, data) {\n        const namespacedEvent = this.getNamespacedEvent(eventType);\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.emit(namespacedEvent, data);\n    }\n    /**\n     * 清空所有事件监听器\n     */\n    clear() {\n        this.activeListeners.forEach((listeners, eventType) => {\n            const namespacedEvent = this.getNamespacedEvent(eventType);\n            listeners.forEach(listener => {\n                _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.removeListener(namespacedEvent, listener);\n            });\n        });\n        this.activeListeners.clear();\n    }\n    /**\n     * 销毁事件总线实例\n     */\n    static destroyInstance() {\n        if (EventBus.instance) {\n            EventBus.instance.clear();\n            EventBus.instance = undefined;\n        }\n    }\n}\nconst scriptEvents = EventBus.getInstance();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L2V2ZW50cy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0dBRUc7QUFDSCxJQUFZLHlCQThCWDtBQTlCRCxXQUFZLHlCQUF5QjtJQUNuQyw0REFBK0I7SUFDL0Isc0RBQXlCO0lBQ3pCLHdEQUEyQjtJQUMzQiw0REFBK0I7SUFDL0IsNERBQStCO0lBQy9CLDREQUErQjtJQUMvQix3REFBMkI7SUFDM0Isd0RBQTJCO0lBRTNCLDREQUErQjtJQUMvQix3REFBMkI7SUFDM0IsNERBQStCO0lBQy9CLHdEQUEyQjtJQUMzQiw0RUFBK0M7SUFFL0Msd0RBQTJCO0lBRTNCLHNEQUF5QjtJQUN6Qiw0REFBK0I7SUFFL0IsNERBQStCO0lBQy9CLDREQUErQjtJQUUvQixrQ0FBa0M7SUFFbEMsNERBQStCO0lBRS9CLHNEQUF5QjtJQUN6QixvREFBdUI7QUFDekIsQ0FBQyxFQTlCVyx5QkFBeUIsS0FBekIseUJBQXlCLFFBOEJwQztBQU9pRDtBQUVsRDs7R0FFRztBQUNJLE1BQU0sUUFBUTtJQUNYLE1BQU0sQ0FBQyxRQUFRLENBQVc7SUFDakIsZUFBZSxHQUFHLG9CQUFvQixDQUFDO0lBQ2hELGVBQWUsR0FBdUQsSUFBSSxHQUFHLEVBQUUsQ0FBQztJQUV4RixnQkFBdUIsQ0FBQztJQUV4Qjs7T0FFRztJQUNJLE1BQU0sQ0FBQyxXQUFXO1FBQ3ZCLElBQUksQ0FBQyxRQUFRLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDdkIsUUFBUSxDQUFDLFFBQVEsR0FBRyxJQUFJLFFBQVEsRUFBRSxDQUFDO1FBQ3JDLENBQUM7UUFDRCxPQUFPLFFBQVEsQ0FBQyxRQUFRLENBQUM7SUFDM0IsQ0FBQztJQUVEOzs7O09BSUc7SUFDSyxrQkFBa0IsQ0FBQyxTQUFvQztRQUM3RCxPQUFPLEdBQUcsSUFBSSxDQUFDLGVBQWUsR0FBRyxTQUFTLEVBQUUsQ0FBQztJQUMvQyxDQUFDO0lBRUQ7Ozs7T0FJRztJQUNJLEVBQUUsQ0FBQyxTQUFvQyxFQUFFLFFBQXVCO1FBQ3JFLElBQUksQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsRUFBRSxDQUFDO1lBQ3pDLElBQUksQ0FBQyxlQUFlLENBQUMsR0FBRyxDQUFDLFNBQVMsRUFBRSxJQUFJLEdBQUcsRUFBRSxDQUFDLENBQUM7UUFDakQsQ0FBQztRQUNELElBQUksQ0FBQyxlQUFlLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUVuRCxNQUFNLGVBQWUsR0FBRyxJQUFJLENBQUMsa0JBQWtCLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDM0QsNERBQVcsQ0FBQyxFQUFFLENBQUMsZUFBZSxFQUFFLFFBQVEsQ0FBQyxDQUFDO0lBQzVDLENBQUM7SUFFRDs7OztPQUlHO0lBQ0ksR0FBRyxDQUFDLFNBQW9DLEVBQUUsUUFBdUI7UUFDdEUsTUFBTSxlQUFlLEdBQUcsSUFBSSxDQUFDLGtCQUFrQixDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQzNELDREQUFXLENBQUMsY0FBYyxDQUFDLGVBQWUsRUFBRSxRQUFRLENBQUMsQ0FBQztRQUV0RCxNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUN0RCxJQUFJLFNBQVMsRUFBRSxDQUFDO1lBQ2QsU0FBUyxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUMzQixJQUFJLFNBQVMsQ0FBQyxJQUFJLEtBQUssQ0FBQyxFQUFFLENBQUM7Z0JBQ3pCLElBQUksQ0FBQyxlQUFlLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQ3pDLENBQUM7UUFDSCxDQUFDO0lBQ0gsQ0FBQztJQUVEOzs7O09BSUc7SUFDSSxJQUFJLENBQUMsU0FBb0MsRUFBRSxJQUFVO1FBQzFELE1BQU0sZUFBZSxHQUFHLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUMzRCw0REFBVyxDQUFDLElBQUksQ0FBQyxlQUFlLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDMUMsQ0FBQztJQUVEOztPQUVHO0lBQ0ksS0FBSztRQUNWLElBQUksQ0FBQyxlQUFlLENBQUMsT0FBTyxDQUFDLENBQUMsU0FBUyxFQUFFLFNBQVMsRUFBRSxFQUFFO1lBQ3BELE1BQU0sZUFBZSxHQUFHLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUMzRCxTQUFTLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxFQUFFO2dCQUMzQiw0REFBVyxDQUFDLGNBQWMsQ0FBQyxlQUFlLEVBQUUsUUFBUSxDQUFDLENBQUM7WUFDeEQsQ0FBQyxDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztRQUNILElBQUksQ0FBQyxlQUFlLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDL0IsQ0FBQztJQUVEOztPQUVHO0lBQ0ksTUFBTSxDQUFDLGVBQWU7UUFDM0IsSUFBSSxRQUFRLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDdEIsUUFBUSxDQUFDLFFBQVEsQ0FBQyxLQUFLLEVBQUUsQ0FBQztZQUMxQixRQUFRLENBQUMsUUFBUSxHQUFHLFNBQWdDLENBQUM7UUFDdkQsQ0FBQztJQUNILENBQUM7Q0FDRjtBQUVNLE1BQU0sWUFBWSxHQUFHLFFBQVEsQ0FBQyxXQUFXLEVBQUUsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvZXZlbnRzLnRzP2I3ZjIiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiDohJrmnKzku5PlupPkuovku7bnsbvlnotcbiAqL1xuZXhwb3J0IGVudW0gU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZSB7XG4gIFNDUklQVF9UT0dHTEUgPSAnc2NyaXB0X3RvZ2dsZScsXG4gIFNDUklQVF9SVU4gPSAnc2NyaXB0X3J1bicsXG4gIFNDUklQVF9TVE9QID0gJ3NjcmlwdF9zdG9wJyxcbiAgU0NSSVBUX0NSRUFURSA9ICdzY3JpcHRfY3JlYXRlJyxcbiAgU0NSSVBUX1VQREFURSA9ICdzY3JpcHRfdXBkYXRlJyxcbiAgU0NSSVBUX0RFTEVURSA9ICdzY3JpcHRfZGVsZXRlJyxcbiAgU0NSSVBUX01PVkUgPSAnc2NyaXB0X21vdmUnLFxuICBTQ1JJUFRfRURJVCA9ICdzY3JpcHRfZWRpdCcsXG5cbiAgRk9MREVSX0NSRUFURSA9ICdmb2xkZXJfY3JlYXRlJyxcbiAgRk9MREVSX0VESVQgPSAnZm9sZGVyX2VkaXQnLFxuICBGT0xERVJfREVMRVRFID0gJ2ZvbGRlcl9kZWxldGUnLFxuICBGT0xERVJfTU9WRSA9ICdmb2xkZXJfbW92ZScsXG4gIEZPTERFUl9TQ1JJUFRTX1RPR0dMRSA9ICdmb2xkZXJfc2NyaXB0c190b2dnbGUnLFxuXG4gIFRZUEVfVE9HR0xFID0gJ3R5cGVfdG9nZ2xlJyxcblxuICBCVVRUT05fQUREID0gJ2J1dHRvbl9hZGQnLFxuICBCVVRUT05fUkVNT1ZFID0gJ2J1dHRvbl9yZW1vdmUnLFxuXG4gIFNDUklQVF9JTVBPUlQgPSAnc2NyaXB0X2ltcG9ydCcsXG4gIFNDUklQVF9FWFBPUlQgPSAnc2NyaXB0X2V4cG9ydCcsXG5cbiAgLy9WQVJJQUJMRV9FRElUID0gJ3ZhcmlhYmxlX2VkaXQnLFxuXG4gIE9SREVSX0NIQU5HRUQgPSAnb3JkZXJfY2hhbmdlZCcsXG5cbiAgVUlfUkVGUkVTSCA9ICd1aV9yZWZyZXNoJyxcbiAgVUlfTE9BREVEID0gJ3VpX2xvYWRlZCcsXG59XG5cbi8qKlxuICog5LqL5Lu255uR5ZCs5Zmo57G75Z6LXG4gKi9cbmV4cG9ydCB0eXBlIEV2ZW50TGlzdGVuZXIgPSAoZGF0YTogYW55KSA9PiB2b2lkO1xuXG5pbXBvcnQgeyBldmVudFNvdXJjZSB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHQnO1xuXG4vKipcbiAqIOS6i+S7tuaAu+e6v+exu++8jOeUqOS6jue7hOS7tumXtOmAmuS/oVxuICovXG5leHBvcnQgY2xhc3MgRXZlbnRCdXMge1xuICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogRXZlbnRCdXM7XG4gIHByaXZhdGUgcmVhZG9ubHkgRVZFTlRfTkFNRVNQQUNFID0gJ3NjcmlwdF9yZXBvc2l0b3J5Xyc7XG4gIHByaXZhdGUgYWN0aXZlTGlzdGVuZXJzOiBNYXA8U2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZSwgU2V0PEV2ZW50TGlzdGVuZXI+PiA9IG5ldyBNYXAoKTtcblxuICBwcml2YXRlIGNvbnN0cnVjdG9yKCkge31cblxuICAvKipcbiAgICog6I635Y+W5LqL5Lu25oC757q/5a6e5L6LXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGdldEluc3RhbmNlKCk6IEV2ZW50QnVzIHtcbiAgICBpZiAoIUV2ZW50QnVzLmluc3RhbmNlKSB7XG4gICAgICBFdmVudEJ1cy5pbnN0YW5jZSA9IG5ldyBFdmVudEJ1cygpO1xuICAgIH1cbiAgICByZXR1cm4gRXZlbnRCdXMuaW5zdGFuY2U7XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5bim5ZG95ZCN56m66Ze055qE5LqL5Lu25ZCN56ewXG4gICAqIEBwYXJhbSBldmVudFR5cGUg5LqL5Lu257G75Z6LXG4gICAqIEByZXR1cm5zIOW4puWRveWQjeepuumXtOeahOS6i+S7tuWQjeensFxuICAgKi9cbiAgcHJpdmF0ZSBnZXROYW1lc3BhY2VkRXZlbnQoZXZlbnRUeXBlOiBTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYCR7dGhpcy5FVkVOVF9OQU1FU1BBQ0V9JHtldmVudFR5cGV9YDtcbiAgfVxuXG4gIC8qKlxuICAgKiDmt7vliqDkuovku7bnm5HlkKzlmahcbiAgICogQHBhcmFtIGV2ZW50VHlwZSDkuovku7bnsbvlnotcbiAgICogQHBhcmFtIGxpc3RlbmVyIOebkeWQrOWZqOWHveaVsFxuICAgKi9cbiAgcHVibGljIG9uKGV2ZW50VHlwZTogU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZSwgbGlzdGVuZXI6IEV2ZW50TGlzdGVuZXIpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuYWN0aXZlTGlzdGVuZXJzLmhhcyhldmVudFR5cGUpKSB7XG4gICAgICB0aGlzLmFjdGl2ZUxpc3RlbmVycy5zZXQoZXZlbnRUeXBlLCBuZXcgU2V0KCkpO1xuICAgIH1cbiAgICB0aGlzLmFjdGl2ZUxpc3RlbmVycy5nZXQoZXZlbnRUeXBlKT8uYWRkKGxpc3RlbmVyKTtcblxuICAgIGNvbnN0IG5hbWVzcGFjZWRFdmVudCA9IHRoaXMuZ2V0TmFtZXNwYWNlZEV2ZW50KGV2ZW50VHlwZSk7XG4gICAgZXZlbnRTb3VyY2Uub24obmFtZXNwYWNlZEV2ZW50LCBsaXN0ZW5lcik7XG4gIH1cblxuICAvKipcbiAgICog56e76Zmk5LqL5Lu255uR5ZCs5ZmoXG4gICAqIEBwYXJhbSBldmVudFR5cGUg5LqL5Lu257G75Z6LXG4gICAqIEBwYXJhbSBsaXN0ZW5lciDnm5HlkKzlmajlh73mlbBcbiAgICovXG4gIHB1YmxpYyBvZmYoZXZlbnRUeXBlOiBTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLCBsaXN0ZW5lcjogRXZlbnRMaXN0ZW5lcik6IHZvaWQge1xuICAgIGNvbnN0IG5hbWVzcGFjZWRFdmVudCA9IHRoaXMuZ2V0TmFtZXNwYWNlZEV2ZW50KGV2ZW50VHlwZSk7XG4gICAgZXZlbnRTb3VyY2UucmVtb3ZlTGlzdGVuZXIobmFtZXNwYWNlZEV2ZW50LCBsaXN0ZW5lcik7XG5cbiAgICBjb25zdCBsaXN0ZW5lcnMgPSB0aGlzLmFjdGl2ZUxpc3RlbmVycy5nZXQoZXZlbnRUeXBlKTtcbiAgICBpZiAobGlzdGVuZXJzKSB7XG4gICAgICBsaXN0ZW5lcnMuZGVsZXRlKGxpc3RlbmVyKTtcbiAgICAgIGlmIChsaXN0ZW5lcnMuc2l6ZSA9PT0gMCkge1xuICAgICAgICB0aGlzLmFjdGl2ZUxpc3RlbmVycy5kZWxldGUoZXZlbnRUeXBlKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog6Kem5Y+R5LqL5Lu2XG4gICAqIEBwYXJhbSBldmVudFR5cGUg5LqL5Lu257G75Z6LXG4gICAqIEBwYXJhbSBkYXRhIOS6i+S7tuaVsOaNrlxuICAgKi9cbiAgcHVibGljIGVtaXQoZXZlbnRUeXBlOiBTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLCBkYXRhPzogYW55KTogdm9pZCB7XG4gICAgY29uc3QgbmFtZXNwYWNlZEV2ZW50ID0gdGhpcy5nZXROYW1lc3BhY2VkRXZlbnQoZXZlbnRUeXBlKTtcbiAgICBldmVudFNvdXJjZS5lbWl0KG5hbWVzcGFjZWRFdmVudCwgZGF0YSk7XG4gIH1cblxuICAvKipcbiAgICog5riF56m65omA5pyJ5LqL5Lu255uR5ZCs5ZmoXG4gICAqL1xuICBwdWJsaWMgY2xlYXIoKTogdm9pZCB7XG4gICAgdGhpcy5hY3RpdmVMaXN0ZW5lcnMuZm9yRWFjaCgobGlzdGVuZXJzLCBldmVudFR5cGUpID0+IHtcbiAgICAgIGNvbnN0IG5hbWVzcGFjZWRFdmVudCA9IHRoaXMuZ2V0TmFtZXNwYWNlZEV2ZW50KGV2ZW50VHlwZSk7XG4gICAgICBsaXN0ZW5lcnMuZm9yRWFjaChsaXN0ZW5lciA9PiB7XG4gICAgICAgIGV2ZW50U291cmNlLnJlbW92ZUxpc3RlbmVyKG5hbWVzcGFjZWRFdmVudCwgbGlzdGVuZXIpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gICAgdGhpcy5hY3RpdmVMaXN0ZW5lcnMuY2xlYXIoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDplIDmr4Hkuovku7bmgLvnur/lrp7kvotcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgZGVzdHJveUluc3RhbmNlKCk6IHZvaWQge1xuICAgIGlmIChFdmVudEJ1cy5pbnN0YW5jZSkge1xuICAgICAgRXZlbnRCdXMuaW5zdGFuY2UuY2xlYXIoKTtcbiAgICAgIEV2ZW50QnVzLmluc3RhbmNlID0gdW5kZWZpbmVkIGFzIHVua25vd24gYXMgRXZlbnRCdXM7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBjb25zdCBzY3JpcHRFdmVudHMgPSBFdmVudEJ1cy5nZXRJbnN0YW5jZSgpO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/component/script_repository/events.ts\n\n}')},"./src/component/script_repository/index.ts":
/*!**************************************************!*\
  !*** ./src/component/script_repository/index.ts ***!
  \**************************************************/(module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ScriptRepositoryApp: () => (/* binding */ ScriptRepositoryApp),\n/* harmony export */   ScriptType: () => (/* reexport safe */ _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType),\n/* harmony export */   buildScriptRepository: () => (/* binding */ buildScriptRepository),\n/* harmony export */   buildScriptRepositoryOnExtension: () => (/* binding */ buildScriptRepositoryOnExtension),\n/* harmony export */   destroyScriptRepositoryOnExtension: () => (/* binding */ destroyScriptRepositoryOnExtension),\n/* harmony export */   removeScriptRepository: () => (/* binding */ removeScriptRepository)\n/* harmony export */ });\n/* harmony import */ var _component_script_repository_button__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/script_repository/button */ \"./src/component/script_repository/button.ts\");\n/* harmony import */ var _component_script_repository_data__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/component/script_repository/data */ \"./src/component/script_repository/data.ts\");\n/* harmony import */ var _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/component/script_repository/events */ \"./src/component/script_repository/events.ts\");\n/* harmony import */ var _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/component/script_repository/script_controller */ \"./src/component/script_repository/script_controller.ts\");\n/* harmony import */ var _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/component/script_repository/types */ \"./src/component/script_repository/types.ts\");\n/* harmony import */ var _component_script_repository_ui_controller__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/component/script_repository/ui_controller */ \"./src/component/script_repository/ui_controller.ts\");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @sillytavern/scripts/popup */ \"@sillytavern/scripts/popup\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_10__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_component_script_repository_ui_controller__WEBPACK_IMPORTED_MODULE_5__]);\n_component_script_repository_ui_controller__WEBPACK_IMPORTED_MODULE_5__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\n\n\n\n\n\n\nconst load_events = [_sillytavern_script__WEBPACK_IMPORTED_MODULE_7__.event_types.CHAT_CHANGED];\nconst delete_events = [_sillytavern_script__WEBPACK_IMPORTED_MODULE_7__.event_types.CHARACTER_DELETED];\n/**\n * 脚本仓库应用 - 使用事件驱动架构\n * 负责整合ScriptManager和UIManager，提供统一的接口\n */\nclass ScriptRepositoryApp {\n    static instance;\n    scriptManager;\n    uiManager;\n    initialized = false;\n    sendFormObserver = null;\n    isUpdatingButtons = false;\n    constructor() {\n        this.scriptManager = _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_3__.ScriptManager.getInstance();\n        this.uiManager = _component_script_repository_ui_controller__WEBPACK_IMPORTED_MODULE_5__.UIController.getInstance();\n        this.registerEvents();\n        this.setupSendFormObserver();\n    }\n    /**\n     * 获取应用实例\n     */\n    static getInstance() {\n        if (!ScriptRepositoryApp.instance) {\n            ScriptRepositoryApp.instance = new ScriptRepositoryApp();\n        }\n        return ScriptRepositoryApp.instance;\n    }\n    /**\n     * 销毁应用实例\n     */\n    static destroyInstance() {\n        if (ScriptRepositoryApp.instance) {\n            ScriptRepositoryApp.instance.cleanup();\n            ScriptRepositoryApp.instance = undefined;\n            _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_3__.ScriptManager.destroyInstance();\n            _component_script_repository_ui_controller__WEBPACK_IMPORTED_MODULE_5__.UIController.destroyInstance();\n            _component_script_repository_data__WEBPACK_IMPORTED_MODULE_1__.ScriptData.destroyInstance();\n        }\n    }\n    /**\n     * 设置send_form的MutationObserver\n     */\n    setupSendFormObserver() {\n        this.sendFormObserver = new MutationObserver(mutations => {\n            if (this.isUpdatingButtons) {\n                return;\n            }\n            let shouldUpdateButtons = false;\n            mutations.forEach(mutation => {\n                if (mutation.type === 'childList') {\n                    mutation.addedNodes.forEach(node => {\n                        if (node.nodeType === Node.ELEMENT_NODE) {\n                            const element = node;\n                            if (element.id === 'qr--bar' && element.children.length > 0) {\n                                shouldUpdateButtons = true;\n                            }\n                            if (element.classList?.contains('qr--button') || element.classList?.contains('qr--buttons')) {\n                                shouldUpdateButtons = true;\n                            }\n                        }\n                    });\n                    mutation.removedNodes.forEach(node => {\n                        if (node.nodeType === Node.ELEMENT_NODE) {\n                            const element = node;\n                            if (element.classList?.contains('qr--buttons') || element.id === 'qr--bar') {\n                                shouldUpdateButtons = true;\n                            }\n                        }\n                    });\n                }\n                if (mutation.type === 'attributes' && mutation.target instanceof Element) {\n                    const element = mutation.target;\n                    if (element.id === 'qr--isEnabled' || element.id === 'qr--isCombined') {\n                        shouldUpdateButtons = true;\n                    }\n                }\n            });\n            if (shouldUpdateButtons) {\n                if (this.sendFormObserver?.debounceTimer) {\n                    clearTimeout(this.sendFormObserver.debounceTimer);\n                }\n                this.sendFormObserver.debounceTimer = setTimeout(() => {\n                    this.handleSendFormChange();\n                }, 500);\n            }\n        });\n        this.startObservingSendForm();\n    }\n    /**\n     * 开始观察send_form\n     */\n    startObservingSendForm() {\n        const sendForm = document.getElementById('send_form');\n        if (sendForm && this.sendFormObserver) {\n            this.sendFormObserver.observe(sendForm, {\n                childList: true,\n                subtree: true,\n                attributes: true,\n                attributeFilter: ['checked', 'disabled'],\n            });\n        }\n        else if (!sendForm) {\n            setTimeout(() => {\n                this.startObservingSendForm();\n            }, 1000);\n        }\n    }\n    /**\n     * 处理send_form变化\n     */\n    handleSendFormChange() {\n        if (!this.initialized || this.isUpdatingButtons) {\n            return;\n        }\n        try {\n            this.isUpdatingButtons = true;\n            (0,_component_script_repository_button__WEBPACK_IMPORTED_MODULE_0__.checkQrEnabledStatusAndAddButton)();\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_10___default().error('[ScriptManager] 处理send_form变化时出错:', error);\n        }\n        finally {\n            setTimeout(() => {\n                this.isUpdatingButtons = false;\n            }, 100);\n        }\n    }\n    /**\n     * 初始化应用\n     */\n    async initialize() {\n        if (this.initialized) {\n            return;\n        }\n        try {\n            await (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_9__.loadFileToDocument)(`/scripts/extensions/${_util_extension_variables__WEBPACK_IMPORTED_MODULE_6__.extensionFolderPath}/src/component/script_repository/public/style.css`, 'css');\n            await this.uiManager.initialize();\n            this.initialized = true;\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_10___default().error('[ScriptManager] 初始化失败:', error);\n            this.initialized = false;\n        }\n    }\n    /**\n     * 注册事件监听\n     */\n    registerEvents() {\n        load_events.forEach(eventType => {\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_7__.eventSource.makeFirst(eventType, this.refreshCharacterRepository.bind(this));\n        });\n        delete_events.forEach(eventType => {\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_7__.eventSource.makeFirst(eventType, (character) => (0,_component_script_repository_data__WEBPACK_IMPORTED_MODULE_1__.purgeEmbeddedScripts)({ character }));\n        });\n    }\n    /**\n     * 刷新角色脚本库\n     */\n    async refreshCharacterRepository() {\n        if (!this.initialized) {\n            return;\n        }\n        const previousCharacterScripts = [];\n        $(`#character-script-list`)\n            .find('.script-item')\n            .each((_index, element) => {\n            const $element = $(element);\n            const scriptId = $element.attr('id');\n            if (scriptId) {\n                const script = this.scriptManager.getScriptById(scriptId);\n                if (script) {\n                    previousCharacterScripts.push(script);\n                }\n            }\n        });\n        this.scriptManager.stopScriptsByType(previousCharacterScripts, _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.CHARACTER);\n        const scriptData = _component_script_repository_data__WEBPACK_IMPORTED_MODULE_1__.ScriptData.getInstance();\n        const globalScripts = this.scriptManager.getGlobalScripts();\n        const characterScripts = this.scriptManager.getCharacterScripts();\n        this.scriptManager.refreshCharacterScriptEnabledState();\n        loglevel__WEBPACK_IMPORTED_MODULE_10___default().info('[ScriptManager] 刷新角色脚本库');\n        if (_sillytavern_script__WEBPACK_IMPORTED_MODULE_7__.this_chid && characterScripts.length > 0) {\n            await this.uiManager.checkEmbeddedScripts(_sillytavern_script__WEBPACK_IMPORTED_MODULE_7__.this_chid);\n        }\n        const conflictScripts = characterScripts.filter(charScript => globalScripts.some(globalScript => globalScript.id === charScript.id));\n        if (conflictScripts.length > 0) {\n            loglevel__WEBPACK_IMPORTED_MODULE_10___default().info(`[ScriptManager] 发现${conflictScripts.length}个脚本ID冲突`);\n            for (const charScript of conflictScripts) {\n                const globalScript = globalScripts.find(gs => gs.id === charScript.id);\n                const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)(`全局脚本中已存在 \"${globalScript.name}\" 脚本，是否关闭冲突脚本？`, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.TEXT, '', {\n                    okButton: '关闭全局',\n                    cancelButton: '关闭局部',\n                });\n                charScript.id = (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_9__.uuidv4)();\n                if (result) {\n                    if (globalScript.enabled) {\n                        await this.scriptManager.stopScript(globalScript, _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL);\n                        globalScript.enabled = false;\n                        loglevel__WEBPACK_IMPORTED_MODULE_10___default().info(`[ScriptManager] 关闭全局脚本: ${globalScript.name}`);\n                        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, {\n                            action: 'script_toggle',\n                            script: globalScript,\n                            type: _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL,\n                            enable: false,\n                        });\n                        scriptData.saveGlobalScripts(globalScripts);\n                    }\n                }\n                else if (charScript.enabled) {\n                    charScript.enabled = false;\n                    await scriptData.saveCharacterScripts(characterScripts);\n                    loglevel__WEBPACK_IMPORTED_MODULE_10___default().info(`[ScriptManager] 关闭局部脚本: ${charScript.name}`);\n                }\n            }\n        }\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, { action: 'refresh_charact_scripts' });\n        // 按钮相关的调用，由MutationObserver处理\n        await this.scriptManager.runScriptsByType(characterScripts, _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.CHARACTER);\n    }\n    /**\n     * 清理资源\n     */\n    async cleanup() {\n        try {\n            if (this.sendFormObserver) {\n                this.sendFormObserver.disconnect();\n                if (this.sendFormObserver.debounceTimer) {\n                    clearTimeout(this.sendFormObserver.debounceTimer);\n                }\n                this.sendFormObserver = null;\n            }\n            this.isUpdatingButtons = false;\n            load_events.forEach(eventType => {\n                _sillytavern_script__WEBPACK_IMPORTED_MODULE_7__.eventSource.removeListener(eventType, this.refreshCharacterRepository.bind(this));\n            });\n            await this.scriptManager.cleanup();\n            this.uiManager.cleanup();\n            this.initialized = false;\n            loglevel__WEBPACK_IMPORTED_MODULE_10___default().info('[ScriptManager] 清理完成');\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_10___default().error('[ScriptManager] 清理失败:', error);\n        }\n    }\n}\n/**\n * 构建脚本库应用\n */\nasync function buildScriptRepository() {\n    const app = ScriptRepositoryApp.getInstance();\n    await app.initialize();\n}\n/**\n * 移除脚本库应用\n */\nasync function removeScriptRepository() {\n    ScriptRepositoryApp.destroyInstance();\n}\n/**\n * 扩展开启时构建脚本库\n */\nasync function buildScriptRepositoryOnExtension() {\n    await buildScriptRepository();\n}\n/**\n * 扩展关闭时销毁脚本库\n */\nfunction destroyScriptRepositoryOnExtension() {\n    removeScriptRepository();\n}\n\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L2luZGV4LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUF3RjtBQUNGO0FBQ1M7QUFDZjtBQUNQO0FBQ0U7QUFDVjtBQUVTO0FBQ0E7QUFDRjtBQUU3QztBQUUzQixNQUFNLFdBQVcsR0FBRyxDQUFDLDREQUFXLENBQUMsWUFBWSxDQUFVLENBQUM7QUFDeEQsTUFBTSxhQUFhLEdBQUcsQ0FBQyw0REFBVyxDQUFDLGlCQUFpQixDQUFVLENBQUM7QUFNL0Q7OztHQUdHO0FBQ0ksTUFBTSxtQkFBbUI7SUFDdEIsTUFBTSxDQUFDLFFBQVEsQ0FBc0I7SUFDckMsYUFBYSxDQUFnQjtJQUM3QixTQUFTLENBQWU7SUFDeEIsV0FBVyxHQUFZLEtBQUssQ0FBQztJQUM3QixnQkFBZ0IsR0FBb0MsSUFBSSxDQUFDO0lBQ3pELGlCQUFpQixHQUFZLEtBQUssQ0FBQztJQUUzQztRQUNFLElBQUksQ0FBQyxhQUFhLEdBQUcseUZBQWEsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUNqRCxJQUFJLENBQUMsU0FBUyxHQUFHLG9GQUFZLENBQUMsV0FBVyxFQUFFLENBQUM7UUFFNUMsSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDO1FBQ3RCLElBQUksQ0FBQyxxQkFBcUIsRUFBRSxDQUFDO0lBQy9CLENBQUM7SUFFRDs7T0FFRztJQUNJLE1BQU0sQ0FBQyxXQUFXO1FBQ3ZCLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUNsQyxtQkFBbUIsQ0FBQyxRQUFRLEdBQUcsSUFBSSxtQkFBbUIsRUFBRSxDQUFDO1FBQzNELENBQUM7UUFDRCxPQUFPLG1CQUFtQixDQUFDLFFBQVEsQ0FBQztJQUN0QyxDQUFDO0lBRUQ7O09BRUc7SUFDSSxNQUFNLENBQUMsZUFBZTtRQUMzQixJQUFJLG1CQUFtQixDQUFDLFFBQVEsRUFBRSxDQUFDO1lBQ2pDLG1CQUFtQixDQUFDLFFBQVEsQ0FBQyxPQUFP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QUMsQ0FBQyxDQUFDO1lBRUgsTUFBTSxJQUFJLENBQUMsYUFBYSxDQUFDLE9BQU8sRUFBRSxDQUFDO1lBQ25DLElBQUksQ0FBQyxTQUFTLENBQUMsT0FBTyxFQUFFLENBQUM7WUFFekIsSUFBSSxDQUFDLFdBQVcsR0FBRyxLQUFLLENBQUM7WUFDekIscURBQVEsQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDO1FBQ25DLENBQUM7UUFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO1lBQ2Ysc0RBQVMsQ0FBQyx1QkFBdUIsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUM1QyxDQUFDO0lBQ0gsQ0FBQztDQUNGO0FBRUQ7O0dBRUc7QUFDSSxLQUFLLFVBQVUscUJBQXFCO0lBQ3pDLE1BQU0sR0FBRyxHQUFHLG1CQUFtQixDQUFDLFdBQVcsRUFBRSxDQUFDO0lBQzlDLE1BQU0sR0FBRyxDQUFDLFVBQVUsRUFBRSxDQUFDO0FBQ3pCLENBQUM7QUFFRDs7R0FFRztBQUNJLEtBQUssVUFBVSxzQkFBc0I7SUFDMUMsbUJBQW1CLENBQUMsZUFBZSxFQUFFLENBQUM7QUFDeEMsQ0FBQztBQUVEOztHQUVHO0FBQ0ksS0FBSyxVQUFVLGdDQUFnQztJQUNwRCxNQUFNLHFCQUFxQixFQUFFLENBQUM7QUFDaEMsQ0FBQztBQUVEOztHQUVHO0FBQ0ksU0FBUyxrQ0FBa0M7SUFDaEQsc0JBQXNCLEVBQUUsQ0FBQztBQUMzQixDQUFDO0FBRXFCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBvbmVudC9zY3JpcHRfcmVwb3NpdG9yeS9pbmRleC50cz8wMWEzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNoZWNrUXJFbmFibGVkU3RhdHVzQW5kQWRkQnV0dG9uIH0gZnJvbSAnQC9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvYnV0dG9uJztcbmltcG9ydCB7IHB1cmdlRW1iZWRkZWRTY3JpcHRzLCBTY3JpcHREYXRhIH0gZnJvbSAnQC9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvZGF0YSc7XG5pbXBvcnQgeyBzY3JpcHRFdmVudHMsIFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUgfSBmcm9tICdAL2NvbXBvbmVudC9zY3JpcHRfcmVwb3NpdG9yeS9ldmVudHMnO1xuaW1wb3J0IHsgU2NyaXB0TWFuYWdlciB9IGZyb20gJ0AvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3NjcmlwdF9jb250cm9sbGVyJztcbmltcG9ydCB7IFNjcmlwdCwgU2NyaXB0VHlwZSB9IGZyb20gJ0AvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3R5cGVzJztcbmltcG9ydCB7IFVJQ29udHJvbGxlciB9IGZyb20gJ0AvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3VpX2NvbnRyb2xsZXInO1xuaW1wb3J0IHsgZXh0ZW5zaW9uRm9sZGVyUGF0aCB9IGZyb20gJ0AvdXRpbC9leHRlbnNpb25fdmFyaWFibGVzJztcblxuaW1wb3J0IHsgZXZlbnRfdHlwZXMsIGV2ZW50U291cmNlLCB0aGlzX2NoaWQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0JztcbmltcG9ydCB7IGNhbGxHZW5lcmljUG9wdXAsIFBPUFVQX1RZUEUgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9wb3B1cCc7XG5pbXBvcnQgeyBsb2FkRmlsZVRvRG9jdW1lbnQsIHV1aWR2NCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3V0aWxzJztcblxuaW1wb3J0IGxvZyBmcm9tICdsb2dsZXZlbCc7XG5cbmNvbnN0IGxvYWRfZXZlbnRzID0gW2V2ZW50X3R5cGVzLkNIQVRfQ0hBTkdFRF0gYXMgY29uc3Q7XG5jb25zdCBkZWxldGVfZXZlbnRzID0gW2V2ZW50X3R5cGVzLkNIQVJBQ1RFUl9ERUxFVEVEXSBhcyBjb25zdDtcblxuaW50ZXJmYWNlIEV4dGVuZGVkTXV0YXRpb25PYnNlcnZlciBleHRlbmRzIE11dGF0aW9uT2JzZXJ2ZXIge1xuICBkZWJvdW5jZVRpbWVyPzogTm9kZUpTLlRpbWVvdXQ7XG59XG5cbi8qKlxuICog6ISa5pys5LuT5bqT5bqU55SoIC0g5L2/55So5LqL5Lu26amx5Yqo5p625p6EXG4gKiDotJ/otKPmlbTlkIhTY3JpcHRNYW5hZ2Vy5ZKMVUlNYW5hZ2Vy77yM5o+Q5L6b57uf5LiA55qE5o6l5Y+jXG4gKi9cbmV4cG9ydCBjbGFzcyBTY3JpcHRSZXBvc2l0b3J5QXBwIHtcbiAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2U6IFNjcmlwdFJlcG9zaXRvcnlBcHA7XG4gIHByaXZhdGUgc2NyaXB0TWFuYWdlcjogU2NyaXB0TWFuYWdlcjtcbiAgcHJpdmF0ZSB1aU1hbmFnZXI6IFVJQ29udHJvbGxlcjtcbiAgcHJpdmF0ZSBpbml0aWFsaXplZDogYm9vbGVhbiA9IGZhbHNlO1xuICBwcml2YXRlIHNlbmRGb3JtT2JzZXJ2ZXI6IEV4dGVuZGVkTXV0YXRpb25PYnNlcnZlciB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIGlzVXBkYXRpbmdCdXR0b25zOiBib29sZWFuID0gZmFsc2U7XG5cbiAgcHJpdmF0ZSBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLnNjcmlwdE1hbmFnZXIgPSBTY3JpcHRNYW5hZ2VyLmdldEluc3RhbmNlKCk7XG4gICAgdGhpcy51aU1hbmFnZXIgPSBVSUNvbnRyb2xsZXIuZ2V0SW5zdGFuY2UoKTtcblxuICAgIHRoaXMucmVnaXN0ZXJFdmVudHMoKTtcbiAgICB0aGlzLnNldHVwU2VuZEZvcm1PYnNlcnZlcigpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluW6lOeUqOWunuS+i1xuICAgKi9cbiAgcHVibGljIHN0YXRpYyBnZXRJbnN0YW5jZSgpOiBTY3JpcHRSZXBvc2l0b3J5QXBwIHtcbiAgICBpZiAoIVNjcmlwdFJlcG9zaXRvcnlBcHAuaW5zdGFuY2UpIHtcbiAgICAgIFNjcmlwdFJlcG9zaXRvcnlBcHAuaW5zdGFuY2UgPSBuZXcgU2NyaXB0UmVwb3NpdG9yeUFwcCgpO1xuICAgIH1cbiAgICByZXR1cm4gU2NyaXB0UmVwb3NpdG9yeUFwcC5pbnN0YW5jZTtcbiAgfVxuXG4gIC8qKlxuICAgKiDplIDmr4HlupTnlKjlrp7kvotcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgZGVzdHJveUluc3RhbmNlKCk6IHZvaWQge1xuICAgIGlmIChTY3JpcHRSZXBvc2l0b3J5QXBwLmluc3RhbmNlKSB7XG4gICAgICBTY3JpcHRSZXBvc2l0b3J5QXBwLmluc3RhbmNlLmNsZWFudXAoKTtcbiAgICAgIFNjcmlwdFJlcG9zaXRvcnlBcHAuaW5zdGFuY2UgPSB1bmRlZmluZWQgYXMgdW5rbm93biBhcyBTY3JpcHRSZXBvc2l0b3J5QXBwO1xuICAgICAgU2NyaXB0TWFuYWdlci5kZXN0cm95SW5zdGFuY2UoKTtcbiAgICAgIFVJQ29udHJvbGxlci5kZXN0cm95SW5zdGFuY2UoKTtcbiAgICAgIFNjcmlwdERhdGEuZGVzdHJveUluc3RhbmNlKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOiuvue9rnNlbmRfZm9ybeeahE11dGF0aW9uT2JzZXJ2ZXJcbiAgICovXG4gIHByaXZhdGUgc2V0dXBTZW5kRm9ybU9ic2VydmVyKCk6IHZvaWQge1xuICAgIHRoaXMuc2VuZEZvcm1PYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKG11dGF0aW9ucyA9PiB7XG4gICAgICBpZiAodGhpcy5pc1VwZGF0aW5nQnV0dG9ucykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGxldCBzaG91bGRVcGRhdGVCdXR0b25zID0gZmFsc2U7XG5cbiAgICAgIG11dGF0aW9ucy5mb3JFYWNoKG11dGF0aW9uID0+IHtcbiAgICAgICAgaWYgKG11dGF0aW9uLnR5cGUgPT09ICdjaGlsZExpc3QnKSB7XG4gICAgICAgICAgbXV0YXRpb24uYWRkZWROb2Rlcy5mb3JFYWNoKG5vZGUgPT4ge1xuICAgICAgICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT09IE5vZGUuRUxFTUVOVF9OT0RFKSB7XG4gICAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSBub2RlIGFzIEVsZW1lbnQ7XG4gICAgICAgICAgICAgIGlmIChlbGVtZW50LmlkID09PSAncXItLWJhcicgJiYgZWxlbWVudC5jaGlsZHJlbi5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgc2hvdWxkVXBkYXRlQnV0dG9ucyA9IHRydWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgaWYgKGVsZW1lbnQuY2xhc3NMaXN0Py5jb250YWlucygncXItLWJ1dHRvbicpIHx8IGVsZW1lbnQuY2xhc3NMaXN0Py5jb250YWlucygncXItLWJ1dHRvbnMnKSkge1xuICAgICAgICAgICAgICAgIHNob3VsZFVwZGF0ZUJ1dHRvbnMgPSB0cnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBtdXRhdGlvbi5yZW1vdmVkTm9kZXMuZm9yRWFjaChub2RlID0+IHtcbiAgICAgICAgICAgIGlmIChub2RlLm5vZGVUeXBlID09PSBOb2RlLkVMRU1FTlRfTk9ERSkge1xuICAgICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gbm9kZSBhcyBFbGVtZW50O1xuICAgICAgICAgICAgICBpZiAoZWxlbWVudC5jbGFzc0xpc3Q/LmNvbnRhaW5zKCdxci0tYnV0dG9ucycpIHx8IGVsZW1lbnQuaWQgPT09ICdxci0tYmFyJykge1xuICAgICAgICAgICAgICAgIHNob3VsZFVwZGF0ZUJ1dHRvbnMgPSB0cnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobXV0YXRpb24udHlwZSA9PT0gJ2F0dHJpYnV0ZXMnICYmIG11dGF0aW9uLnRhcmdldCBpbnN0YW5jZW9mIEVsZW1lbnQpIHtcbiAgICAgICAgICBjb25zdCBlbGVtZW50ID0gbXV0YXRpb24udGFyZ2V0IGFzIEVsZW1lbnQ7XG4gICAgICAgICAgaWYgKGVsZW1lbnQuaWQgPT09ICdxci0taXNFbmFibGVkJyB8fCBlbGVtZW50LmlkID09PSAncXItLWlzQ29tYmluZWQnKSB7XG4gICAgICAgICAgICBzaG91bGRVcGRhdGVCdXR0b25zID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBpZiAoc2hvdWxkVXBkYXRlQnV0dG9ucykge1xuICAgICAgICBpZiAodGhpcy5zZW5kRm9ybU9ic2VydmVyPy5kZWJvdW5jZVRpbWVyKSB7XG4gICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuc2VuZEZvcm1PYnNlcnZlci5kZWJvdW5jZVRpbWVyKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNlbmRGb3JtT2JzZXJ2ZXIhLmRlYm91bmNlVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICB0aGlzLmhhbmRsZVNlbmRGb3JtQ2hhbmdlKCk7XG4gICAgICAgIH0sIDUwMCk7XG4gICAgICB9XG4gICAgfSkgYXMgRXh0ZW5kZWRNdXRhdGlvbk9ic2VydmVyO1xuXG4gICAgdGhpcy5zdGFydE9ic2VydmluZ1NlbmRGb3JtKCk7XG4gIH1cblxuICAvKipcbiAgICog5byA5aeL6KeC5a+fc2VuZF9mb3JtXG4gICAqL1xuICBwcml2YXRlIHN0YXJ0T2JzZXJ2aW5nU2VuZEZvcm0oKTogdm9pZCB7XG4gICAgY29uc3Qgc2VuZEZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VuZF9mb3JtJyk7XG4gICAgaWYgKHNlbmRGb3JtICYmIHRoaXMuc2VuZEZvcm1PYnNlcnZlcikge1xuICAgICAgdGhpcy5zZW5kRm9ybU9ic2VydmVyLm9ic2VydmUoc2VuZEZvcm0sIHtcbiAgICAgICAgY2hpbGRMaXN0OiB0cnVlLFxuICAgICAgICBzdWJ0cmVlOiB0cnVlLFxuICAgICAgICBhdHRyaWJ1dGVzOiB0cnVlLFxuICAgICAgICBhdHRyaWJ1dGVGaWx0ZXI6IFsnY2hlY2tlZCcsICdkaXNhYmxlZCddLFxuICAgICAgfSk7XG4gICAgfSBlbHNlIGlmICghc2VuZEZvcm0pIHtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICB0aGlzLnN0YXJ0T2JzZXJ2aW5nU2VuZEZvcm0oKTtcbiAgICAgIH0sIDEwMDApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDlpITnkIZzZW5kX2Zvcm3lj5jljJZcbiAgICovXG4gIHByaXZhdGUgaGFuZGxlU2VuZEZvcm1DaGFuZ2UoKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmluaXRpYWxpemVkIHx8IHRoaXMuaXNVcGRhdGluZ0J1dHRvbnMpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgdGhpcy5pc1VwZGF0aW5nQnV0dG9ucyA9IHRydWU7XG4gICAgICBjaGVja1FyRW5hYmxlZFN0YXR1c0FuZEFkZEJ1dHRvbigpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2cuZXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDlpITnkIZzZW5kX2Zvcm3lj5jljJbml7blh7rplJk6JywgZXJyb3IpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgdGhpcy5pc1VwZGF0aW5nQnV0dG9ucyA9IGZhbHNlO1xuICAgICAgfSwgMTAwKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5Yid5aeL5YyW5bqU55SoXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgaW5pdGlhbGl6ZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAodGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBhd2FpdCBsb2FkRmlsZVRvRG9jdW1lbnQoXG4gICAgICAgIGAvc2NyaXB0cy9leHRlbnNpb25zLyR7ZXh0ZW5zaW9uRm9sZGVyUGF0aH0vc3JjL2NvbXBvbmVudC9zY3JpcHRfcmVwb3NpdG9yeS9wdWJsaWMvc3R5bGUuY3NzYCxcbiAgICAgICAgJ2NzcycsXG4gICAgICApO1xuICAgICAgYXdhaXQgdGhpcy51aU1hbmFnZXIuaW5pdGlhbGl6ZSgpO1xuICAgICAgdGhpcy5pbml0aWFsaXplZCA9IHRydWU7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZy5lcnJvcignW1NjcmlwdE1hbmFnZXJdIOWIneWni+WMluWksei0pTonLCBlcnJvcik7XG4gICAgICB0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOazqOWGjOS6i+S7tuebkeWQrFxuICAgKi9cbiAgcHJpdmF0ZSByZWdpc3RlckV2ZW50cygpOiB2b2lkIHtcbiAgICBsb2FkX2V2ZW50cy5mb3JFYWNoKGV2ZW50VHlwZSA9PiB7XG4gICAgICBldmVudFNvdXJjZS5tYWtlRmlyc3QoZXZlbnRUeXBlLCB0aGlzLnJlZnJlc2hDaGFyYWN0ZXJSZXBvc2l0b3J5LmJpbmQodGhpcykpO1xuICAgIH0pO1xuXG4gICAgZGVsZXRlX2V2ZW50cy5mb3JFYWNoKGV2ZW50VHlwZSA9PiB7XG4gICAgICBldmVudFNvdXJjZS5tYWtlRmlyc3QoZXZlbnRUeXBlLCAoY2hhcmFjdGVyOiBhbnkpID0+IHB1cmdlRW1iZWRkZWRTY3JpcHRzKHsgY2hhcmFjdGVyIH0pKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDliLfmlrDop5LoibLohJrmnKzlupNcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgcmVmcmVzaENoYXJhY3RlclJlcG9zaXRvcnkoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgaWYgKCF0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IHByZXZpb3VzQ2hhcmFjdGVyU2NyaXB0czogU2NyaXB0W10gPSBbXTtcbiAgICAkKGAjY2hhcmFjdGVyLXNjcmlwdC1saXN0YClcbiAgICAgIC5maW5kKCcuc2NyaXB0LWl0ZW0nKVxuICAgICAgLmVhY2goKF9pbmRleCwgZWxlbWVudCkgPT4ge1xuICAgICAgICBjb25zdCAkZWxlbWVudCA9ICQoZWxlbWVudCk7XG4gICAgICAgIGNvbnN0IHNjcmlwdElkID0gJGVsZW1lbnQuYXR0cignaWQnKTtcbiAgICAgICAgaWYgKHNjcmlwdElkKSB7XG4gICAgICAgICAgY29uc3Qgc2NyaXB0ID0gdGhpcy5zY3JpcHRNYW5hZ2VyLmdldFNjcmlwdEJ5SWQoc2NyaXB0SWQpO1xuICAgICAgICAgIGlmIChzY3JpcHQpIHtcbiAgICAgICAgICAgIHByZXZpb3VzQ2hhcmFjdGVyU2NyaXB0cy5wdXNoKHNjcmlwdCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB0aGlzLnNjcmlwdE1hbmFnZXIuc3RvcFNjcmlwdHNCeVR5cGUocHJldmlvdXNDaGFyYWN0ZXJTY3JpcHRzLCBTY3JpcHRUeXBlLkNIQVJBQ1RFUik7XG5cbiAgICBjb25zdCBzY3JpcHREYXRhID0gU2NyaXB0RGF0YS5nZXRJbnN0YW5jZSgpO1xuICAgIGNvbnN0IGdsb2JhbFNjcmlwdHMgPSB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0R2xvYmFsU2NyaXB0cygpO1xuICAgIGNvbnN0IGNoYXJhY3RlclNjcmlwdHMgPSB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0Q2hhcmFjdGVyU2NyaXB0cygpO1xuXG4gICAgdGhpcy5zY3JpcHRNYW5hZ2VyLnJlZnJlc2hDaGFyYWN0ZXJTY3JpcHRFbmFibGVkU3RhdGUoKTtcblxuICAgIGxvZy5pbmZvKCdbU2NyaXB0TWFuYWdlcl0g5Yi35paw6KeS6Imy6ISa5pys5bqTJyk7XG5cbiAgICBpZiAodGhpc19jaGlkICYmIGNoYXJhY3RlclNjcmlwdHMubGVuZ3RoID4gMCkge1xuICAgICAgYXdhaXQgdGhpcy51aU1hbmFnZXIuY2hlY2tFbWJlZGRlZFNjcmlwdHModGhpc19jaGlkKTtcbiAgICB9XG5cbiAgICBjb25zdCBjb25mbGljdFNjcmlwdHMgPSBjaGFyYWN0ZXJTY3JpcHRzLmZpbHRlcihjaGFyU2NyaXB0ID0+XG4gICAgICBnbG9iYWxTY3JpcHRzLnNvbWUoZ2xvYmFsU2NyaXB0ID0+IGdsb2JhbFNjcmlwdC5pZCA9PT0gY2hhclNjcmlwdC5pZCksXG4gICAgKTtcblxuICAgIGlmIChjb25mbGljdFNjcmlwdHMubGVuZ3RoID4gMCkge1xuICAgICAgbG9nLmluZm8oYFtTY3JpcHRNYW5hZ2VyXSDlj5HnjrAke2NvbmZsaWN0U2NyaXB0cy5sZW5ndGh95Liq6ISa5pysSUTlhrLnqoFgKTtcblxuICAgICAgZm9yIChjb25zdCBjaGFyU2NyaXB0IG9mIGNvbmZsaWN0U2NyaXB0cykge1xuICAgICAgICBjb25zdCBnbG9iYWxTY3JpcHQgPSBnbG9iYWxTY3JpcHRzLmZpbmQoZ3MgPT4gZ3MuaWQgPT09IGNoYXJTY3JpcHQuaWQpITtcblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjYWxsR2VuZXJpY1BvcHVwKFxuICAgICAgICAgIGDlhajlsYDohJrmnKzkuK3lt7LlrZjlnKggXCIke2dsb2JhbFNjcmlwdC5uYW1lfVwiIOiEmuacrO+8jOaYr+WQpuWFs+mXreWGsueqgeiEmuacrO+8n2AsXG4gICAgICAgICAgUE9QVVBfVFlQRS5URVhULFxuICAgICAgICAgICcnLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIG9rQnV0dG9uOiAn5YWz6Zet5YWo5bGAJyxcbiAgICAgICAgICAgIGNhbmNlbEJ1dHRvbjogJ+WFs+mXreWxgOmDqCcsXG4gICAgICAgICAgfSxcbiAgICAgICAgKTtcblxuICAgICAgICBjaGFyU2NyaXB0LmlkID0gdXVpZHY0KCk7XG5cbiAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgIGlmIChnbG9iYWxTY3JpcHQuZW5hYmxlZCkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5zY3JpcHRNYW5hZ2VyLnN0b3BTY3JpcHQoZ2xvYmFsU2NyaXB0LCBTY3JpcHRUeXBlLkdMT0JBTCk7XG4gICAgICAgICAgICBnbG9iYWxTY3JpcHQuZW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgbG9nLmluZm8oYFtTY3JpcHRNYW5hZ2VyXSDlhbPpl63lhajlsYDohJrmnKw6ICR7Z2xvYmFsU2NyaXB0Lm5hbWV9YCk7XG4gICAgICAgICAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlVJX1JFRlJFU0gsIHtcbiAgICAgICAgICAgICAgYWN0aW9uOiAnc2NyaXB0X3RvZ2dsZScsXG4gICAgICAgICAgICAgIHNjcmlwdDogZ2xvYmFsU2NyaXB0LFxuICAgICAgICAgICAgICB0eXBlOiBTY3JpcHRUeXBlLkdMT0JBTCxcbiAgICAgICAgICAgICAgZW5hYmxlOiBmYWxzZSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgc2NyaXB0RGF0YS5zYXZlR2xvYmFsU2NyaXB0cyhnbG9iYWxTY3JpcHRzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoY2hhclNjcmlwdC5lbmFibGVkKSB7XG4gICAgICAgICAgY2hhclNjcmlwdC5lbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgYXdhaXQgc2NyaXB0RGF0YS5zYXZlQ2hhcmFjdGVyU2NyaXB0cyhjaGFyYWN0ZXJTY3JpcHRzKTtcbiAgICAgICAgICBsb2cuaW5mbyhgW1NjcmlwdE1hbmFnZXJdIOWFs+mXreWxgOmDqOiEmuacrDogJHtjaGFyU2NyaXB0Lm5hbWV9YCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlVJX1JFRlJFU0gsIHsgYWN0aW9uOiAncmVmcmVzaF9jaGFyYWN0X3NjcmlwdHMnIH0pO1xuXG4gICAgLy8g5oyJ6ZKu55u45YWz55qE6LCD55So77yM55SxTXV0YXRpb25PYnNlcnZlcuWkhOeQhlxuXG4gICAgYXdhaXQgdGhpcy5zY3JpcHRNYW5hZ2VyLnJ1blNjcmlwdHNCeVR5cGUoY2hhcmFjdGVyU2NyaXB0cywgU2NyaXB0VHlwZS5DSEFSQUNURVIpO1xuICB9XG5cbiAgLyoqXG4gICAqIOa4heeQhui1hOa6kFxuICAgKi9cbiAgcHVibGljIGFzeW5jIGNsZWFudXAoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGlmICh0aGlzLnNlbmRGb3JtT2JzZXJ2ZXIpIHtcbiAgICAgICAgdGhpcy5zZW5kRm9ybU9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgaWYgKHRoaXMuc2VuZEZvcm1PYnNlcnZlci5kZWJvdW5jZVRpbWVyKSB7XG4gICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuc2VuZEZvcm1PYnNlcnZlci5kZWJvdW5jZVRpbWVyKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNlbmRGb3JtT2JzZXJ2ZXIgPSBudWxsO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmlzVXBkYXRpbmdCdXR0b25zID0gZmFsc2U7XG5cbiAgICAgIGxvYWRfZXZlbnRzLmZvckVhY2goZXZlbnRUeXBlID0+IHtcbiAgICAgICAgZXZlbnRTb3VyY2UucmVtb3ZlTGlzdGVuZXIoZXZlbnRUeXBlLCB0aGlzLnJlZnJlc2hDaGFyYWN0ZXJSZXBvc2l0b3J5LmJpbmQodGhpcykpO1xuICAgICAgfSk7XG5cbiAgICAgIGF3YWl0IHRoaXMuc2NyaXB0TWFuYWdlci5jbGVhbnVwKCk7XG4gICAgICB0aGlzLnVpTWFuYWdlci5jbGVhbnVwKCk7XG5cbiAgICAgIHRoaXMuaW5pdGlhbGl6ZWQgPSBmYWxzZTtcbiAgICAgIGxvZy5pbmZvKCdbU2NyaXB0TWFuYWdlcl0g5riF55CG5a6M5oiQJyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZy5lcnJvcignW1NjcmlwdE1hbmFnZXJdIOa4heeQhuWksei0pTonLCBlcnJvcik7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICog5p6E5bu66ISa5pys5bqT5bqU55SoXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBidWlsZFNjcmlwdFJlcG9zaXRvcnkoKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IGFwcCA9IFNjcmlwdFJlcG9zaXRvcnlBcHAuZ2V0SW5zdGFuY2UoKTtcbiAgYXdhaXQgYXBwLmluaXRpYWxpemUoKTtcbn1cblxuLyoqXG4gKiDnp7vpmaTohJrmnKzlupPlupTnlKhcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbW92ZVNjcmlwdFJlcG9zaXRvcnkoKTogUHJvbWlzZTx2b2lkPiB7XG4gIFNjcmlwdFJlcG9zaXRvcnlBcHAuZGVzdHJveUluc3RhbmNlKCk7XG59XG5cbi8qKlxuICog5omp5bGV5byA5ZCv5pe25p6E5bu66ISa5pys5bqTXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBidWlsZFNjcmlwdFJlcG9zaXRvcnlPbkV4dGVuc2lvbigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgYXdhaXQgYnVpbGRTY3JpcHRSZXBvc2l0b3J5KCk7XG59XG5cbi8qKlxuICog5omp5bGV5YWz6Zet5pe26ZSA5q+B6ISa5pys5bqTXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkZXN0cm95U2NyaXB0UmVwb3NpdG9yeU9uRXh0ZW5zaW9uKCk6IHZvaWQge1xuICByZW1vdmVTY3JpcHRSZXBvc2l0b3J5KCk7XG59XG5cbmV4cG9ydCB7IFNjcmlwdFR5cGUgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/component/script_repository/index.ts\n\n}")},"./src/component/script_repository/script_controller.ts":
/*!**************************************************************!*\
  !*** ./src/component/script_repository/script_controller.ts ***!
  \**************************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ScriptManager: () => (/* binding */ ScriptManager)\n/* harmony export */ });\n/* harmony import */ var _component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/message_iframe/render_message */ \"./src/component/message_iframe/render_message.ts\");\n/* harmony import */ var _component_script_repository_data__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/component/script_repository/data */ \"./src/component/script_repository/data.ts\");\n/* harmony import */ var _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/component/script_repository/events */ \"./src/component/script_repository/events.ts\");\n/* harmony import */ var _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/component/script_repository/types */ \"./src/component/script_repository/types.ts\");\n/* harmony import */ var _script_url__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/script_url */ \"./src/script_url.ts\");\n/* harmony import */ var _third_party_html__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/third_party.html */ \"./src/third_party.html\");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @sillytavern/scripts/popup */ \"@sillytavern/scripts/popup\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_9__);\n\n\n\n\n\n\n\n\n\n\nclass ScriptExecutor {\n    /**\n     * 创建并运行单个脚本\n     * @param script 脚本\n     * @param type 脚本类型\n     */\n    async runScript(script, type) {\n        const typeName = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? '全局' : '局部';\n        try {\n            const iframeElement = $('iframe').filter((_index, element) => $(element).attr('script-id') === script.id)[0];\n            if (iframeElement) {\n                (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_0__.destroyIframe)(iframeElement);\n            }\n            const htmlContent = this.createScriptHtml(script);\n            const $iframe = $('<iframe>', {\n                style: 'display: none;',\n                id: `tavern-helper-script-${script.name}`,\n                srcdoc: htmlContent,\n                'script-id': script.id,\n            });\n            $iframe.on('load', () => {\n                loglevel__WEBPACK_IMPORTED_MODULE_9___default().info(`[ScriptManager] 启用${typeName}脚本[\"${script.name}\"]`);\n            });\n            $('body').append($iframe);\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_9___default().error(`[ScriptManager] ${typeName}脚本启用失败:[\"${script.name}\"]`, error);\n            toastr.error(`${typeName}脚本启用失败:[\"${script.name}\"]`);\n            throw error;\n        }\n    }\n    /**\n     * 停止单个脚本，并销毁iframe\n     * @param script 脚本\n     * @param type 脚本类型\n     */\n    async stopScript(script, type) {\n        const typeName = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? '全局' : '局部';\n        const iframeElement = $('iframe').filter((_index, element) => $(element).attr('script-id') === script.id)[0];\n        if (iframeElement) {\n            (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_0__.destroyIframe)(iframeElement);\n            loglevel__WEBPACK_IMPORTED_MODULE_9___default().info(`[ScriptManager] 禁用${typeName}脚本[\"${script.name}\"]`);\n        }\n    }\n    /**\n     * 创建运行脚本的HTML内容\n     * @param script 脚本对象\n     * @returns HTML内容\n     */\n    createScriptHtml(script) {\n        return `\n      <html>\n      <head>\n        ${_third_party_html__WEBPACK_IMPORTED_MODULE_5__[\"default\"]}\n        <script>\n          (function ($) {\n            var original$ = $;\n            window.$ = function (selector, context) {\n              if (context === undefined || context === null) {\n                if (window.parent && window.parent.document) {\n                  context = window.parent.document;\n                } else {\n                  log.warn('无法访问 window.parent.document，将使用当前 iframe 的 document 作为上下文。');\n                  context = window.document;\n                }\n              }\n              return original$(selector, context);\n            };\n          })(jQuery);\n        <\/script>\n        <script src=\"${_script_url__WEBPACK_IMPORTED_MODULE_4__.script_url.get('iframe_client')}\"><\/script>\n      </head>\n      <body>\n        <script type=\"module\">\n          ${script.content}\n        <\/script>\n      </body>\n      </html>\n    `;\n    }\n    /**\n     * 清理所有脚本iframe\n     */\n    async clearAllScriptsIframe() {\n        const $iframes = $('iframe[id^=\"tavern-helper-script-\"]');\n        for (const iframe of $iframes) {\n            (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_0__.destroyIframe)(iframe);\n        }\n    }\n}\nclass ScriptManager {\n    static instance;\n    scriptData;\n    executor;\n    constructor() {\n        this.scriptData = _component_script_repository_data__WEBPACK_IMPORTED_MODULE_1__.ScriptData.getInstance();\n        this.executor = new ScriptExecutor();\n        this.registerEventListeners();\n    }\n    /**\n     * 获取脚本管理器实例\n     */\n    static getInstance() {\n        if (!ScriptManager.instance) {\n            ScriptManager.instance = new ScriptManager();\n        }\n        return ScriptManager.instance;\n    }\n    /**\n     * 销毁脚本管理器实例\n     */\n    static destroyInstance() {\n        if (ScriptManager.instance) {\n            ScriptManager.instance = undefined;\n        }\n    }\n    /**\n     * 注册事件监听器\n     */\n    registerEventListeners() {\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.SCRIPT_TOGGLE, async (data) => {\n            const { script, type, enable, userInput = true } = data;\n            await this.toggleScript(script, type, enable, userInput);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.TYPE_TOGGLE, async (data) => {\n            const { type, enable, userInput = true } = data;\n            await this.toggleScriptType(type, enable, userInput);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.SCRIPT_IMPORT, async (data) => {\n            const { file, type } = data;\n            await this.importScript(file, type);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.SCRIPT_DELETE, async (data) => {\n            const { scriptId, type } = data;\n            await this.deleteScript(scriptId, type);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.SCRIPT_CREATE, async (data) => {\n            const { script, type } = data;\n            await this.createScript(script, type);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.SCRIPT_UPDATE, async (data) => {\n            const { script, type } = data;\n            await this.updateScript(script, type);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.SCRIPT_MOVE, async (data) => {\n            const { script, fromType } = data;\n            await this.moveScript(script, fromType);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.FOLDER_MOVE, async (data) => {\n            const { folderId, fromType } = data;\n            await this.moveFolder(folderId, fromType);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.ORDER_CHANGED, async (data) => {\n            const { data: orderData, type } = data;\n            await this.saveOrder(orderData, type);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_LOADED, async () => {\n            if (!(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_6__.getSettingValue)('enabled_extension')) {\n                return;\n            }\n            const globalScripts = this.scriptData.getGlobalScripts();\n            const characterScripts = this.scriptData.getCharacterScripts();\n            if (this.scriptData.isGlobalScriptEnabled) {\n                await this.runScriptsByType(globalScripts, _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL);\n            }\n            else {\n                loglevel__WEBPACK_IMPORTED_MODULE_9___default().info('[ScriptManager] 全局脚本类型未启用，跳过运行全局脚本');\n            }\n            if (this.scriptData.isCharacterScriptEnabled) {\n                await this.runScriptsByType(characterScripts, _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER);\n            }\n            else {\n                loglevel__WEBPACK_IMPORTED_MODULE_9___default().info('[ScriptManager] 角色脚本类型未启用，跳过运行角色脚本');\n            }\n        });\n    }\n    /**\n     * 切换脚本启用状态\n     * @param script 脚本\n     * @param type 脚本类型\n     * @param enable 是否启用\n     * @param userInput 是否由用户输入\n     */\n    async toggleScript(script, type, enable, userInput = true) {\n        if (userInput) {\n            script.enabled = enable;\n            await this.scriptData.saveScript(script, type);\n        }\n        try {\n            if (enable) {\n                if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL && !this.scriptData.isGlobalScriptEnabled) {\n                    loglevel__WEBPACK_IMPORTED_MODULE_9___default().info(`[script_manager] 全局脚本类型未启用，跳过启用脚本[\"${script.name}\"]`);\n                    return;\n                }\n                if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER && !this.scriptData.isCharacterScriptEnabled) {\n                    loglevel__WEBPACK_IMPORTED_MODULE_9___default().info(`[script_manager] 角色脚本类型未启用，跳过启用脚本[\"${script.name}\"]`);\n                    return;\n                }\n                await this.runScript(script, type);\n            }\n            else {\n                await this.stopScript(script, type);\n            }\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, {\n                action: 'script_toggle',\n                script,\n                type,\n                enable,\n            });\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_9___default().error(`[ScriptManager] 切换脚本状态失败: ${script.name}`, error);\n            toastr.error(`切换脚本状态失败: ${script.name}`);\n        }\n    }\n    /**\n     * 切换脚本类型启用状态\n     * @param type 脚本类型\n     * @param enable 是否启用\n     * @param userInput 是否由用户输入\n     */\n    async toggleScriptType(type, enable, userInput = true) {\n        if (userInput) {\n            await this.scriptData.updateScriptTypeEnableState(type, enable);\n        }\n        try {\n            const scripts = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? this.scriptData.getGlobalScripts() : this.scriptData.getCharacterScripts();\n            if (enable) {\n                await this.runScriptsByType(scripts, type);\n            }\n            else {\n                await this.stopScriptsByType(scripts, type);\n            }\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, {\n                action: 'type_toggle',\n                type,\n                enable,\n            });\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_9___default().error(`[ScriptManager] 切换脚本类型状态失败: ${type}`, error);\n            toastr.error(`切换脚本类型状态失败: ${type}`);\n        }\n    }\n    /**\n     * 运行单个脚本\n     * @param script 脚本\n     * @param type 脚本类型\n     */\n    async runScript(script, type) {\n        if (!(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_6__.getSettingValue)('enabled_extension')) {\n            toastr.error('[ScriptManager] 扩展未启用');\n            return;\n        }\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL && !this.scriptData.isGlobalScriptEnabled) {\n            return;\n        }\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER && !this.scriptData.isCharacterScriptEnabled) {\n            return;\n        }\n        await this.executor.runScript(script, type);\n        if (script.buttons && script.buttons.length > 0) {\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.BUTTON_ADD, { script });\n        }\n    }\n    /**\n     * 停止单个脚本\n     * @param script 脚本\n     * @param type 脚本类型\n     */\n    async stopScript(script, type) {\n        await this.executor.stopScript(script, type);\n        if (script.buttons && script.buttons.length > 0) {\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.BUTTON_REMOVE, { scriptId: script.id });\n        }\n    }\n    /**\n     * 运行指定类型的所有脚本\n     * @param scripts 脚本列表\n     * @param type 脚本类型\n     */\n    async runScriptsByType(scripts, type) {\n        if (!(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_6__.getSettingValue)('enabled_extension')) {\n            toastr.error('[ScriptManager] 酒馆助手未启用，无法运行脚本');\n            return;\n        }\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL && !this.scriptData.isGlobalScriptEnabled) {\n            return;\n        }\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER && !this.scriptData.isCharacterScriptEnabled) {\n            return;\n        }\n        const enabledScripts = scripts.filter(script => script.enabled);\n        for (const script of enabledScripts) {\n            await this.executor.runScript(script, type);\n            if (script.buttons && script.buttons.length > 0) {\n                _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.BUTTON_ADD, { script });\n            }\n        }\n    }\n    /**\n     * 停止指定类型的所有脚本\n     * @param scripts 脚本列表\n     * @param type 脚本类型\n     */\n    async stopScriptsByType(scripts, type) {\n        const enabledScripts = scripts.filter(script => script.enabled);\n        for (const script of enabledScripts) {\n            await this.executor.stopScript(script, type);\n            if (script.buttons && script.buttons.length > 0) {\n                _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.BUTTON_REMOVE, { scriptId: script.id });\n            }\n        }\n    }\n    /**\n     * 导入脚本或文件夹\n     * @param file 脚本文件或文件夹导出文件\n     * @param type 导入目标类型\n     */\n    async importScript(file, type) {\n        try {\n            if (file.name.toLowerCase().endsWith('.zip')) {\n                await this.importFromZip(file, type);\n            }\n            else if (file.name.toLowerCase().endsWith('.json')) {\n                const content = await this.readFileAsText(file);\n                const importData = JSON.parse(content);\n                if (Array.isArray(importData)) {\n                    await this.importMultipleItems(importData, type);\n                }\n                else {\n                    await this.importSingleScript(importData, type);\n                }\n            }\n            else {\n                throw new Error('不支持的文件格式，请选择 .json 或 .zip 文件');\n            }\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_9___default().error('[ScriptManager] 导入失败:', error);\n            toastr.error(`导入失败: ${error instanceof Error ? error.message : '无效的文件格式'}`);\n        }\n    }\n    /**\n     * 从ZIP文件导入\n     * @param file ZIP文件\n     * @param type 脚本类型\n     */\n    async importFromZip(file, type) {\n        //@ts-ignore\n        if (!window.JSZip) {\n            loglevel__WEBPACK_IMPORTED_MODULE_9___default().info('import jszip');\n            await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @sillytavern/lib/jszip.min.js */ \"@sillytavern/lib/jszip.min.js\"));\n        }\n        //@ts-ignore\n        const zip = new JSZip();\n        const zipContent = await zip.loadAsync(file);\n        let importedScripts = 0;\n        let importedFolders = 0;\n        const folders = new Set();\n        const rootScripts = [];\n        for (const fileName in zipContent.files) {\n            const file = zipContent.files[fileName];\n            if (!file.dir && fileName.endsWith('.json')) {\n                const pathParts = fileName.split('/');\n                if (pathParts.length === 1) {\n                    rootScripts.push(fileName);\n                }\n                else if (pathParts.length === 2) {\n                    folders.add(pathParts[0]);\n                }\n            }\n        }\n        for (const fileName of rootScripts) {\n            const file = zipContent.files[fileName];\n            const scriptContent = await file.async('string');\n            const scriptData = JSON.parse(scriptContent);\n            if (scriptData.name && 'content' in scriptData) {\n                const script = new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.Script({\n                    ...scriptData,\n                    enabled: false,\n                });\n                await this.handleScriptImport(script, type);\n                importedScripts++;\n            }\n        }\n        for (const folderName of folders) {\n            const folderScriptCount = await this.importFolderFromZipNew(zipContent, folderName, type);\n            importedScripts += folderScriptCount;\n            importedFolders++;\n        }\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, {\n            action: type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? 'refresh_global_scripts' : 'refresh_charact_scripts',\n        });\n        toastr.success(`成功导入 ${importedScripts} 个脚本和 ${importedFolders} 个文件夹`);\n    }\n    /**\n     * 从ZIP中导入文件夹\n     * @param zipContent ZIP内容\n     * @param folderName 文件夹名称\n     * @param type 脚本类型\n     * @returns 导入的脚本数量\n     */\n    async importFolderFromZipNew(zipContent, folderName, type) {\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL\n            ? this.scriptData.getGlobalRepositoryItems()\n            : this.scriptData.getCharacterRepositoryItems();\n        let finalFolderName = folderName;\n        let counter = 1;\n        while (repository.some(item => item.type === 'folder' && item.name === finalFolderName)) {\n            finalFolderName = `${folderName}_${counter}`;\n            counter++;\n        }\n        const folderId = await this.scriptData.createFolder(finalFolderName, type);\n        let folderScriptCount = 0;\n        for (const fileName in zipContent.files) {\n            const file = zipContent.files[fileName];\n            if (!file.dir && fileName.startsWith(`${folderName}/`) && fileName.endsWith('.json')) {\n                const scriptContent = await file.async('string');\n                const scriptData = JSON.parse(scriptContent);\n                if (scriptData.name && 'content' in scriptData) {\n                    const script = new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.Script({\n                        ...scriptData,\n                        enabled: false,\n                    });\n                    await this.handleScriptImport(script, type);\n                    await this.scriptData.moveScriptToFolder(script.id, folderId, type);\n                    folderScriptCount++;\n                }\n            }\n        }\n        return folderScriptCount;\n    }\n    /**\n     * 导入单个脚本\n     * @param scriptData 脚本数据\n     * @param type 脚本类型\n     */\n    async importSingleScript(scriptData, type) {\n        if (!scriptData.name || !('content' in scriptData)) {\n            throw new Error('无效的脚本数据');\n        }\n        const scriptToImport = new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.Script({\n            ...scriptData,\n            enabled: false,\n        });\n        await this.handleScriptImport(scriptToImport, type);\n        toastr.success(`脚本 '${scriptToImport.name}' 导入成功。`);\n    }\n    /**\n     * 导入多个项目（脚本或文件夹）\n     * @param items 项目数组\n     * @param type 脚本类型\n     */\n    async importMultipleItems(items, type) {\n        let importedCount = 0;\n        let folderCount = 0;\n        let scriptCount = 0;\n        for (const item of items) {\n            if (item.type === 'folder') {\n                await this.importFolder(item, type);\n                folderCount++;\n                importedCount++;\n            }\n            else if (item.type === 'script') {\n                const script = new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.Script({\n                    ...item.value,\n                    enabled: false,\n                });\n                await this.handleScriptImport(script, type);\n                scriptCount++;\n                importedCount++;\n            }\n            else if (item.name && 'content' in item) {\n                const script = new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.Script({\n                    ...item,\n                    enabled: false,\n                });\n                await this.handleScriptImport(script, type);\n                scriptCount++;\n                importedCount++;\n            }\n        }\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, {\n            action: type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? 'refresh_global_scripts' : 'refresh_charact_scripts',\n        });\n        toastr.success(`导入成功`);\n    }\n    /**\n     * 导入文件夹\n     * @param folderData 文件夹数据\n     * @param type 脚本类型\n     */\n    async importFolder(folderData, type) {\n        if (!folderData.name || !Array.isArray(folderData.value)) {\n            throw new Error('无效的文件夹数据');\n        }\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL\n            ? this.scriptData.getGlobalRepositoryItems()\n            : this.scriptData.getCharacterRepositoryItems();\n        let folderName = folderData.name;\n        let counter = 1;\n        while (repository.some(item => item.type === 'folder' && item.name === folderName)) {\n            folderName = `${folderData.name}_${counter}`;\n            counter++;\n        }\n        const folderId = await this.scriptData.createFolder(folderName, type);\n        for (const scriptData of folderData.value) {\n            const script = new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.Script({\n                ...scriptData,\n                enabled: false,\n            });\n            await this.handleScriptImport(script, type);\n            await this.scriptData.moveScriptToFolder(script.id, folderId, type);\n        }\n    }\n    /**\n     * 处理脚本导入冲突\n     * @param script 要导入的脚本\n     * @param type 目标类型\n     */\n    async handleScriptImport(script, type) {\n        const globalScripts = this.scriptData.getGlobalScripts();\n        const characterScripts = this.scriptData.getCharacterScripts();\n        const conflictInGlobal = globalScripts.find(s => s.id === script.id);\n        const conflictInCharacter = characterScripts.find(s => s.id === script.id);\n        let existingScript;\n        let conflictType;\n        if (conflictInGlobal) {\n            existingScript = conflictInGlobal;\n            conflictType = _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL;\n        }\n        else if (conflictInCharacter) {\n            existingScript = conflictInCharacter;\n            conflictType = _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER;\n        }\n        if (existingScript && conflictType) {\n            const action = await this.handleScriptIdConflict(script, existingScript, type, 'import');\n            switch (action) {\n                case 'new':\n                    script.id = (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_8__.uuidv4)();\n                    await this.createScript(script, type);\n                    break;\n                case 'override':\n                    await this.deleteScript(existingScript.id, conflictType);\n                    await this.createScript(script, type);\n                    break;\n                case 'cancel':\n                    return;\n            }\n        }\n        else {\n            await this.createScript(script, type);\n        }\n    }\n    /**\n     * 读取文件内容为文本\n     * @param file 文件对象\n     * @returns 文件内容\n     */\n    readFileAsText(file) {\n        return new Promise((resolve, reject) => {\n            const reader = new FileReader();\n            reader.onload = e => resolve(e.target?.result);\n            reader.onerror = e => reject(e);\n            reader.readAsText(file);\n        });\n    }\n    /**\n     * 创建新脚本\n     * @param script 脚本\n     * @param type 脚本类型\n     */\n    async createScript(script, type) {\n        await this.scriptData.saveScript(script, type);\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, {\n            action: 'script_create',\n            script,\n            type,\n        });\n    }\n    /**\n     * 更新现有脚本\n     * @param script 脚本\n     * @param type 脚本类型\n     */\n    async updateScript(script, type) {\n        await this.scriptData.saveScript(script, type);\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, {\n            action: 'script_update',\n            script,\n            type,\n        });\n    }\n    /**\n     * 统一保存排序方法 - 保存仓库项排序\n     * @param repositoryItems 仓库项数组（包含文件夹和脚本的混合结构）\n     * @param type 脚本类型\n     */\n    async saveOrder(repositoryItems, type) {\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL) {\n            await this.scriptData.saveGlobalRepositoryItems(repositoryItems);\n        }\n        else {\n            await this.scriptData.saveCharacterRepositoryItems(repositoryItems);\n        }\n        this.scriptData.loadScripts();\n    }\n    /**\n     * 删除脚本\n     * @param scriptId 脚本ID\n     * @param type 脚本类型\n     */\n    async deleteScript(scriptId, type) {\n        const script = this.scriptData.getScriptById(scriptId);\n        if (!script) {\n            throw new Error('[ScriptManager] 脚本不存在');\n        }\n        await this.stopScript(script, type);\n        await this.scriptData.deleteScript(scriptId, type);\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, {\n            action: 'script_delete',\n            scriptId,\n            type,\n        });\n    }\n    /**\n     * 移动脚本到另一个类型\n     * @param script 脚本\n     * @param fromType 源类型\n     */\n    async moveScript(script, fromType) {\n        await this.stopScript(script, fromType);\n        const targetType = (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getOppositeScriptType)(fromType);\n        const existingScriptInTarget = this.scriptData.getScriptById(script.id);\n        const existingScriptType = existingScriptInTarget ? this.scriptData.getScriptType(existingScriptInTarget) : null;\n        if (existingScriptInTarget && existingScriptType === targetType) {\n            const action = await this.handleScriptIdConflict(script, existingScriptInTarget, targetType, 'move');\n            switch (action) {\n                case 'new':\n                    script.id = (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_8__.uuidv4)();\n                    break;\n                case 'override':\n                    await this.deleteScript(existingScriptInTarget.id, targetType);\n                    break;\n                case 'cancel':\n                    return;\n            }\n        }\n        await this.scriptData.moveItemToOtherType({ type: 'script', id: script.id, value: script }, fromType);\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, {\n            action: 'script_move',\n            script,\n            fromType,\n            targetType,\n        });\n        if (script.enabled &&\n            ((targetType === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL && this.scriptData.isGlobalScriptEnabled) ||\n                (targetType === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER && this.scriptData.isCharacterScriptEnabled))) {\n            await this.runScript(script, targetType);\n        }\n    }\n    /**\n     * 刷新角色脚本数据\n     */\n    refreshCharacterScriptData() {\n        this.scriptData.getCharacterScripts();\n    }\n    /**\n     * 获取全局脚本\n     */\n    getGlobalScripts() {\n        return this.scriptData.getGlobalScripts();\n    }\n    /**\n     * 获取角色脚本\n     */\n    getCharacterScripts() {\n        return this.scriptData.getCharacterScripts();\n    }\n    /**\n     * 刷新角色脚本启用状态\n     */\n    refreshCharacterScriptEnabledState() {\n        this.scriptData.refreshCharacterScriptEnabledState();\n    }\n    /**\n     * 获取全局脚本启用状态\n     */\n    get isGlobalScriptEnabled() {\n        return this.scriptData.isGlobalScriptEnabled;\n    }\n    /**\n     * 获取角色脚本启用状态\n     */\n    get isCharacterScriptEnabled() {\n        return this.scriptData.isCharacterScriptEnabled;\n    }\n    /**\n     * 根据ID获取脚本\n     * @param id 脚本ID\n     */\n    getScriptById(id) {\n        return this.scriptData.getScriptById(id);\n    }\n    /**\n     * 获取全局脚本仓库项（包含文件夹结构）\n     */\n    getGlobalRepositoryItems() {\n        return this.scriptData.getGlobalRepositoryItems();\n    }\n    /**\n     * 获取角色脚本仓库项（包含文件夹结构）\n     */\n    getCharacterRepositoryItems() {\n        return this.scriptData.getCharacterRepositoryItems();\n    }\n    /**\n     * 创建文件夹\n     */\n    async createFolder(name, type, icon, color) {\n        return await this.scriptData.createFolder(name, type, icon, color);\n    }\n    /**\n     * 重命名文件夹\n     */\n    async editFolder(folderId, newName, type, newIcon, newColor) {\n        await this.scriptData.editFolder(folderId, newName, type, newIcon, newColor);\n    }\n    /**\n     * 删除文件夹\n     */\n    async deleteFolder(folderId, type) {\n        await this.scriptData.deleteFolder(folderId, type);\n    }\n    /**\n     * 将脚本移动到文件夹\n     */\n    async moveScriptToFolder(scriptId, targetFolderId, type) {\n        await this.scriptData.moveScriptToFolder(scriptId, targetFolderId, type);\n    }\n    /**\n     * 将文件夹移动到其他类型\n     * @param folderId 文件夹ID\n     * @param fromType 源类型\n     */\n    async moveFolder(folderId, fromType) {\n        const targetType = (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getOppositeScriptType)(fromType);\n        await this.scriptData.moveItemToOtherType({ type: 'folder', id: folderId }, fromType);\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, {\n            action: 'folder_move',\n            folderId,\n            fromType,\n            targetType,\n        });\n    }\n    /**\n     * 获取文件夹中的脚本\n     */\n    getFolderScripts(folderId, type) {\n        return this.scriptData.getFolderScripts(folderId, type);\n    }\n    /**\n     * 获取根级别的脚本\n     */\n    getRootScripts(type) {\n        return this.scriptData.getRootScripts(type);\n    }\n    /**\n     * 获取所有文件夹\n     */\n    getFolders(type) {\n        return this.scriptData.getFolders(type);\n    }\n    /**\n     * 批量切换文件夹内所有脚本的启用状态\n     * @param folderId 文件夹ID\n     * @param type 脚本类型\n     * @param enable 是否启用\n     */\n    async toggleFolderScripts(folderId, type, enable) {\n        try {\n            await this.scriptData.toggleFolderScripts(folderId, type, enable);\n            const scripts = this.scriptData.getFolderScripts(folderId, type);\n            const isTypeEnabled = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? this.scriptData.isGlobalScriptEnabled : this.scriptData.isCharacterScriptEnabled;\n            if (isTypeEnabled) {\n                for (const script of scripts) {\n                    if (enable && script.enabled) {\n                        await this.runScript(script, type);\n                    }\n                    else if (!enable) {\n                        await this.stopScript(script, type);\n                    }\n                }\n            }\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, {\n                action: 'folder_scripts_toggle',\n                folderId,\n                type,\n                enable,\n            });\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_9___default().error(`[ScriptManager] 批量切换文件夹脚本状态失败: ${folderId}`, error);\n            toastr.error(`批量切换文件夹脚本状态失败`);\n        }\n    }\n    /**\n     * 获取文件夹内脚本的整体启用状态\n     * @param folderId 文件夹ID\n     * @param type 脚本类型\n     */\n    getFolderScriptsState(folderId, type) {\n        return this.scriptData.getFolderScriptsState(folderId, type);\n    }\n    /**\n     * 获取指定脚本的按钮数组\n     * @param scriptId 脚本ID\n     * @returns 按钮数组\n     */\n    getScriptButton(scriptId) {\n        const script = this.scriptData.getScriptById(scriptId);\n        if (!script) {\n            loglevel__WEBPACK_IMPORTED_MODULE_9___default().warn(`[ScriptManager] 脚本不存在: ${scriptId}`);\n            return [];\n        }\n        return script.buttons;\n    }\n    /**\n     * 修改后更新脚本按钮（仅重建按钮，不重启脚本）\n     * @param script 脚本对象\n     * @param type 脚本类型\n     */\n    async setScriptButton(script, type) {\n        await this.scriptData.saveScript(script, type);\n        if (script.enabled) {\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.BUTTON_REMOVE, { scriptId: script.id });\n            if (script.buttons && script.buttons.length > 0) {\n                _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.BUTTON_ADD, { script });\n            }\n        }\n    }\n    /**\n     * 获取指定脚本的变量数据\n     * @param scriptId 脚本ID\n     * @returns 脚本的data字段，如果脚本不存在返回空对象\n     */\n    getScriptVariables(scriptId) {\n        const script = this.scriptData.getScriptById(scriptId);\n        if (!script) {\n            loglevel__WEBPACK_IMPORTED_MODULE_9___default().warn(`[ScriptManager] 脚本不存在: ${scriptId}`);\n            return {};\n        }\n        return script.data || {};\n    }\n    /**\n     * 更新指定脚本的变量数据\n     * @param scriptId 脚本ID\n     * @param variables 新的变量数据\n     * @param type 脚本类型\n     * @returns 是否更新成功\n     */\n    async updateScriptVariables(scriptId, variables, type) {\n        const script = this.scriptData.getScriptById(scriptId);\n        if (!script) {\n            loglevel__WEBPACK_IMPORTED_MODULE_9___default().warn(`[ScriptManager] 脚本不存在: ${scriptId}`);\n            return false;\n        }\n        script.data = variables;\n        await this.scriptData.saveScript(script, type);\n        loglevel__WEBPACK_IMPORTED_MODULE_9___default().info(`[ScriptManager] 已更新脚本变量: ${script.name}`);\n        return true;\n    }\n    /**\n     * 获取所有脚本的变量数据（用于调试和管理）\n     * @param type 脚本类型\n     * @returns 所有脚本的变量数据映射\n     */\n    getAllScriptVariables(type) {\n        const scripts = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? this.scriptData.getGlobalScripts() : this.scriptData.getCharacterScripts();\n        const variablesMap = new Map();\n        scripts.forEach(script => {\n            if (script.data && Object.keys(script.data).length > 0) {\n                variablesMap.set(script.id, script.data);\n            }\n        });\n        return variablesMap;\n    }\n    /**\n     * 清理所有资源\n     */\n    async cleanup() {\n        await this.executor.clearAllScriptsIframe();\n    }\n    /**\n     * 处理脚本ID冲突\n     * @param script 要处理的脚本\n     * @param existingScript 已存在的脚本\n     * @param targetType 目标类型\n     * @param operationType 操作类型：'import' - 导入, 'move' - 移动\n     * @returns 处理结果：'new' - 使用新ID, 'override' - 覆盖已有脚本, 'cancel' - 取消操作\n     */\n    async handleScriptIdConflict(script, existingScript, targetType, operationType = 'import') {\n        const existingScriptType = this.scriptData.getScriptType(existingScript);\n        const existingTypeText = existingScriptType === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? '全局脚本' : '角色脚本';\n        const targetTypeText = targetType === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? '全局脚本' : '角色脚本';\n        let message;\n        if (operationType === 'import') {\n            message = `要导入的脚本 '${script.name}' 与${existingTypeText}库中的 '${existingScript.name}' id 相同，是否要继续操作？`;\n        }\n        else {\n            message = `要移动到${targetTypeText}库的脚本 '${script.name}' 与目标库中的 '${existingScript.name}' id 相同，是否要继续操作？`;\n        }\n        const input = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_7__.callGenericPopup)(message, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_7__.POPUP_TYPE.TEXT, '', {\n            okButton: '覆盖原脚本',\n            cancelButton: '取消',\n            customButtons: ['新建脚本'],\n        });\n        let action = 'cancel';\n        switch (input) {\n            case 0:\n                action = 'cancel';\n                break;\n            case 1:\n                action = 'override';\n                break;\n            case 2:\n                action = 'new';\n                break;\n        }\n        return action;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3NjcmlwdF9jb250cm9sbGVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUEwRTtBQUNWO0FBQytCO0FBT2xEO0FBQ0g7QUFDRztBQUNnQjtBQUVhO0FBQ3RCO0FBRXpCO0FBRTNCLE1BQU0sY0FBYztJQUNsQjs7OztPQUlHO0lBQ0gsS0FBSyxDQUFDLFNBQVMsQ0FBQyxNQUFjLEVBQUUsSUFBZ0I7UUFDOUMsTUFBTSxRQUFRLEdBQUcsSUFBSSxLQUFLLDBFQUFVLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztRQUUxRCxJQUFJLENBQUM7WUFDSCxNQUFNLGFBQWEsR0FBRyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsTUFBTSxDQUN0QyxDQUFDLE1BQU0sRUFBRSxPQUFPLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLEtBQUssTUFBTSxDQUFDLEVBQUUsQ0FDaEUsQ0FBQyxDQUFDLENBQWtCLENBQUM7WUFFdEIsSUFBSSxhQUFhLEVBQUUsQ0FBQztnQkFDbEIsdUZBQWEsQ0FBQyxhQUFhLENBQUMsQ0FBQztZQUMvQixDQUFDO1lBRUQsTUFBTSxXQUFXLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBRWxELE1BQU0sT0FBTyxHQUFHLENBQUMsQ0FBQyxVQUFVLEVBQUU7Z0JBQzVCLEtBQUssRUFBRSxnQkFBZ0I7Z0JBQ3ZCLEVBQUUsRUFBRSx3QkFBd0IsTUFBTSxDQUFDLElBQUksRUFBRTtnQkFDekMsTUFBTSxFQUFFLFdBQVc7Z0JBQ25CLFdBQVcsRUFBRSxNQUFNLENBQUMsRUFBRTthQUN2QixDQUFDLENBQUM7WUFFSCxPQUFPLENBQUMsRUFBRSxDQUFDLE1BQU0sRUFBRSxHQUFHLEVBQUU7Z0JBQ3RCLG9EQUFRLENBQUMscUJBQXFCLFFB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O1lBQzlCLE1BQU0sSUFBSSxDQUFDLFlBQVksQ0FBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDeEMsQ0FBQyxDQUFDLENBQUM7UUFFSCw2RUFBWSxDQUFDLEVBQUUsQ0FBQywwRkFBeUIsQ0FBQyxhQUFhLEVBQUUsS0FBSyxFQUFDLElBQUksRUFBQyxFQUFFO1lBQ3BFLE1BQU0sRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLEdBQUcsSUFBSSxDQUFDO1lBQzlCLE1BQU0sSUFBSSxDQUFDLFlBQVksQ0FBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDeEMsQ0FBQyxDQUFDLENBQUM7UUFFSCw2RUFBWSxDQUFDLEVBQUUsQ0FBQywwRkFBeUIsQ0FBQyxXQUFXLEVBQUUsS0FBSyxFQUFDLElBQUksRUFBQyxFQUFFO1lBQ2xFLE1BQU0sRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLEdBQUcsSUFBSSxDQUFDO1lBQ2xDLE1BQU0sSUFBSSxDQUFDLFVBQVUsQ0FBQyxNQUFNLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDMUMsQ0FBQyxDQUFDLENBQUM7UUFFSCw2RUFBWSxDQUFDLEVBQUUsQ0FBQywwRkFBeUIsQ0FBQyxXQUFXLEVBQUUsS0FBSyxFQUFDLElBQUksRUFBQyxFQUFFO1lBQ2xFLE1BQU0sRUFBRSxRQUFRLEVBQUUsUUFBUSxFQUFFLEdBQUcsSUFBSSxDQUFDO1lBQ3BDLE1BQU0sSUFBSSxDQUFDLFVBQVUsQ0FBQyxRQUFRLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDNUMsQ0FBQyxDQUFDLENBQUM7UUFFSCw2RUFBWSxDQUFDLEVBQUUsQ0FBQywwRkFBeUIsQ0FBQyxhQUFhLEVBQUUsS0FBSyxFQUFDLElBQUksRUFBQyxFQUFFO1lBQ3BFLE1BQU0sRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxHQUFHLElBQUksQ0FBQztZQUN2QyxNQUFNLElBQUksQ0FBQyxTQUFTLENBQUMsU0FBUyxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ3hDLENBQUMsQ0FBQyxDQUFDO1FBRUgsNkVB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RyxPQUFPLGNBQWMsU0FBUyxNQUFNLENBQUMsSUFBSSxhQUFhLGNBQWMsQ0FBQyxJQUFJLGtCQUFrQixDQUFDO1FBQ3hHLENBQUM7UUFFRCxNQUFNLEtBQUssR0FBRyxNQUFNLDRFQUFnQixDQUFDLE9BQU8sRUFBRSxrRUFBVSxDQUFDLElBQUksRUFBRSxFQUFFLEVBQUU7WUFDakUsUUFBUSxFQUFFLE9BQU87WUFDakIsWUFBWSxFQUFFLElBQUk7WUFDbEIsYUFBYSxFQUFFLENBQUMsTUFBTSxDQUFDO1NBQ3hCLENBQUMsQ0FBQztRQUVILElBQUksTUFBTSxHQUFrQyxRQUFRLENBQUM7UUFFckQsUUFBUSxLQUFLLEVBQUUsQ0FBQztZQUNkLEtBQUssQ0FBQztnQkFDSixNQUFNLEdBQUcsUUFBUSxDQUFDO2dCQUNsQixNQUFNO1lBQ1IsS0FBSyxDQUFDO2dCQUNKLE1BQU0sR0FBRyxVQUFVLENBQUM7Z0JBQ3BCLE1BQU07WUFDUixLQUFLLENBQUM7Z0JBQ0osTUFBTSxHQUFHLEtBQUssQ0FBQztnQkFDZixNQUFNO1FBQ1YsQ0FBQztRQUVELE9BQU8sTUFBTSxDQUFDO0lBQ2hCLENBQUM7Q0FDRiIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvc2NyaXB0X2NvbnRyb2xsZXIudHM/ZmUwYyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBkZXN0cm95SWZyYW1lIH0gZnJvbSAnQC9jb21wb25lbnQvbWVzc2FnZV9pZnJhbWUvcmVuZGVyX21lc3NhZ2UnO1xuaW1wb3J0IHsgU2NyaXB0RGF0YSB9IGZyb20gJ0AvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L2RhdGEnO1xuaW1wb3J0IHsgc2NyaXB0RXZlbnRzLCBTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlIH0gZnJvbSAnQC9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvZXZlbnRzJztcbmltcG9ydCB7XG4gIGdldE9wcG9zaXRlU2NyaXB0VHlwZSxcbiAgSUZyYW1lRWxlbWVudCxcbiAgU2NyaXB0LFxuICBTY3JpcHRSZXBvc2l0b3J5SXRlbSxcbiAgU2NyaXB0VHlwZSxcbn0gZnJvbSAnQC9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvdHlwZXMnO1xuaW1wb3J0IHsgc2NyaXB0X3VybCB9IGZyb20gJ0Avc2NyaXB0X3VybCc7XG5pbXBvcnQgdGhpcmRfcGFydHkgZnJvbSAnQC90aGlyZF9wYXJ0eS5odG1sJztcbmltcG9ydCB7IGdldFNldHRpbmdWYWx1ZSB9IGZyb20gJ0AvdXRpbC9leHRlbnNpb25fdmFyaWFibGVzJztcblxuaW1wb3J0IHsgY2FsbEdlbmVyaWNQb3B1cCwgUE9QVVBfVFlQRSB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3BvcHVwJztcbmltcG9ydCB7IHV1aWR2NCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3V0aWxzJztcblxuaW1wb3J0IGxvZyBmcm9tICdsb2dsZXZlbCc7XG5cbmNsYXNzIFNjcmlwdEV4ZWN1dG9yIHtcbiAgLyoqXG4gICAqIOWIm+W7uuW5tui/kOihjOWNleS4quiEmuacrFxuICAgKiBAcGFyYW0gc2NyaXB0IOiEmuacrFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIGFzeW5jIHJ1blNjcmlwdChzY3JpcHQ6IFNjcmlwdCwgdHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHR5cGVOYW1lID0gdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyAn5YWo5bGAJyA6ICflsYDpg6gnO1xuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGlmcmFtZUVsZW1lbnQgPSAkKCdpZnJhbWUnKS5maWx0ZXIoXG4gICAgICAgIChfaW5kZXgsIGVsZW1lbnQpID0+ICQoZWxlbWVudCkuYXR0cignc2NyaXB0LWlkJykgPT09IHNjcmlwdC5pZCxcbiAgICAgIClbMF0gYXMgSUZyYW1lRWxlbWVudDtcblxuICAgICAgaWYgKGlmcmFtZUVsZW1lbnQpIHtcbiAgICAgICAgZGVzdHJveUlmcmFtZShpZnJhbWVFbGVtZW50KTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgaHRtbENvbnRlbnQgPSB0aGlzLmNyZWF0ZVNjcmlwdEh0bWwoc2NyaXB0KTtcblxuICAgICAgY29uc3QgJGlmcmFtZSA9ICQoJzxpZnJhbWU+Jywge1xuICAgICAgICBzdHlsZTogJ2Rpc3BsYXk6IG5vbmU7JyxcbiAgICAgICAgaWQ6IGB0YXZlcm4taGVscGVyLXNjcmlwdC0ke3NjcmlwdC5uYW1lfWAsXG4gICAgICAgIHNyY2RvYzogaHRtbENvbnRlbnQsXG4gICAgICAgICdzY3JpcHQtaWQnOiBzY3JpcHQuaWQsXG4gICAgICB9KTtcblxuICAgICAgJGlmcmFtZS5vbignbG9hZCcsICgpID0+IHtcbiAgICAgICAgbG9nLmluZm8oYFtTY3JpcHRNYW5hZ2VyXSDlkK/nlKgke3R5cGVOYW1lfeiEmuacrFtcIiR7c2NyaXB0Lm5hbWV9XCJdYCk7XG4gICAgICB9KTtcblxuICAgICAgJCgnYm9keScpLmFwcGVuZCgkaWZyYW1lKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nLmVycm9yKGBbU2NyaXB0TWFuYWdlcl0gJHt0eXBlTmFtZX3ohJrmnKzlkK/nlKjlpLHotKU6W1wiJHtzY3JpcHQubmFtZX1cIl1gLCBlcnJvcik7XG4gICAgICB0b2FzdHIuZXJyb3IoYCR7dHlwZU5hbWV96ISa5pys5ZCv55So5aSx6LSlOltcIiR7c2NyaXB0Lm5hbWV9XCJdYCk7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5YGc5q2i5Y2V5Liq6ISa5pys77yM5bm26ZSA5q+BaWZyYW1lXG4gICAqIEBwYXJhbSBzY3JpcHQg6ISa5pysXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgYXN5bmMgc3RvcFNjcmlwdChzY3JpcHQ6IFNjcmlwdCwgdHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHR5cGVOYW1lID0gdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyAn5YWo5bGAJyA6ICflsYDpg6gnO1xuXG4gICAgY29uc3QgaWZyYW1lRWxlbWVudCA9ICQoJ2lmcmFtZScpLmZpbHRlcihcbiAgICAgIChfaW5kZXgsIGVsZW1lbnQpID0+ICQoZWxlbWVudCkuYXR0cignc2NyaXB0LWlkJykgPT09IHNjcmlwdC5pZCxcbiAgICApWzBdIGFzIElGcmFtZUVsZW1lbnQ7XG5cbiAgICBpZiAoaWZyYW1lRWxlbWVudCkge1xuICAgICAgZGVzdHJveUlmcmFtZShpZnJhbWVFbGVtZW50KTtcbiAgICAgIGxvZy5pbmZvKGBbU2NyaXB0TWFuYWdlcl0g56aB55SoJHt0eXBlTmFtZX3ohJrmnKxbXCIke3NjcmlwdC5uYW1lfVwiXWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDliJvlu7rov5DooYzohJrmnKznmoRIVE1M5YaF5a65XG4gICAqIEBwYXJhbSBzY3JpcHQg6ISa5pys5a+56LGhXG4gICAqIEByZXR1cm5zIEhUTUzlhoXlrrlcbiAgICovXG4gIHByaXZhdGUgY3JlYXRlU2NyaXB0SHRtbChzY3JpcHQ6IFNjcmlwdCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGBcbiAgICAgIDxodG1sPlxuICAgICAgPGhlYWQ+XG4gICAgICAgICR7dGhpcmRfcGFydHl9XG4gICAgICAgIDxzY3JpcHQ+XG4gICAgICAgICAgKGZ1bmN0aW9uICgkKSB7XG4gICAgICAgICAgICB2YXIgb3JpZ2luYWwkID0gJDtcbiAgICAgICAgICAgIHdpbmRvdy4kID0gZnVuY3Rpb24gKHNlbGVjdG9yLCBjb250ZXh0KSB7XG4gICAgICAgICAgICAgIGlmIChjb250ZXh0ID09PSB1bmRlZmluZWQgfHwgY29udGV4dCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGlmICh3aW5kb3cucGFyZW50ICYmIHdpbmRvdy5wYXJlbnQuZG9jdW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgIGNvbnRleHQgPSB3aW5kb3cucGFyZW50LmRvY3VtZW50O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICBsb2cud2Fybign5peg5rOV6K6/6ZeuIHdpbmRvdy5wYXJlbnQuZG9jdW1lbnTvvIzlsIbkvb/nlKjlvZPliY0gaWZyYW1lIOeahCBkb2N1bWVudCDkvZzkuLrkuIrkuIvmlofjgIInKTtcbiAgICAgICAgICAgICAgICAgIGNvbnRleHQgPSB3aW5kb3cuZG9jdW1lbnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHJldHVybiBvcmlnaW5hbCQoc2VsZWN0b3IsIGNvbnRleHQpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9KShqUXVlcnkpO1xuICAgICAgICA8L3NjcmlwdD5cbiAgICAgICAgPHNjcmlwdCBzcmM9XCIke3NjcmlwdF91cmwuZ2V0KCdpZnJhbWVfY2xpZW50Jyl9XCI+PC9zY3JpcHQ+XG4gICAgICA8L2hlYWQ+XG4gICAgICA8Ym9keT5cbiAgICAgICAgPHNjcmlwdCB0eXBlPVwibW9kdWxlXCI+XG4gICAgICAgICAgJHtzY3JpcHQuY29udGVudH1cbiAgICAgICAgPC9zY3JpcHQ+XG4gICAgICA8L2JvZHk+XG4gICAgICA8L2h0bWw+XG4gICAgYDtcbiAgfVxuXG4gIC8qKlxuICAgKiDmuIXnkIbmiYDmnInohJrmnKxpZnJhbWVcbiAgICovXG4gIGFzeW5jIGNsZWFyQWxsU2NyaXB0c0lmcmFtZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCAkaWZyYW1lcyA9ICQoJ2lmcmFtZVtpZF49XCJ0YXZlcm4taGVscGVyLXNjcmlwdC1cIl0nKTtcbiAgICBmb3IgKGNvbnN0IGlmcmFtZSBvZiAkaWZyYW1lcykge1xuICAgICAgZGVzdHJveUlmcmFtZShpZnJhbWUgYXMgSUZyYW1lRWxlbWVudCk7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBTY3JpcHRNYW5hZ2VyIHtcbiAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2U6IFNjcmlwdE1hbmFnZXI7XG4gIHByaXZhdGUgc2NyaXB0RGF0YTogU2NyaXB0RGF0YTtcbiAgcHJpdmF0ZSBleGVjdXRvcjogU2NyaXB0RXhlY3V0b3I7XG5cbiAgcHJpdmF0ZSBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLnNjcmlwdERhdGEgPSBTY3JpcHREYXRhLmdldEluc3RhbmNlKCk7XG4gICAgdGhpcy5leGVjdXRvciA9IG5ldyBTY3JpcHRFeGVjdXRvcigpO1xuICAgIHRoaXMucmVnaXN0ZXJFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluiEmuacrOeuoeeQhuWZqOWunuS+i1xuICAgKi9cbiAgcHVibGljIHN0YXRpYyBnZXRJbnN0YW5jZSgpOiBTY3JpcHRNYW5hZ2VyIHtcbiAgICBpZiAoIVNjcmlwdE1hbmFnZXIuaW5zdGFuY2UpIHtcbiAgICAgIFNjcmlwdE1hbmFnZXIuaW5zdGFuY2UgPSBuZXcgU2NyaXB0TWFuYWdlcigpO1xuICAgIH1cbiAgICByZXR1cm4gU2NyaXB0TWFuYWdlci5pbnN0YW5jZTtcbiAgfVxuXG4gIC8qKlxuICAgKiDplIDmr4HohJrmnKznrqHnkIblmajlrp7kvotcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgZGVzdHJveUluc3RhbmNlKCk6IHZvaWQge1xuICAgIGlmIChTY3JpcHRNYW5hZ2VyLmluc3RhbmNlKSB7XG4gICAgICBTY3JpcHRNYW5hZ2VyLmluc3RhbmNlID0gdW5kZWZpbmVkIGFzIHVua25vd24gYXMgU2NyaXB0TWFuYWdlcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5rOo5YaM5LqL5Lu255uR5ZCs5ZmoXG4gICAqL1xuICBwcml2YXRlIHJlZ2lzdGVyRXZlbnRMaXN0ZW5lcnMoKTogdm9pZCB7XG4gICAgc2NyaXB0RXZlbnRzLm9uKFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuU0NSSVBUX1RPR0dMRSwgYXN5bmMgZGF0YSA9PiB7XG4gICAgICBjb25zdCB7IHNjcmlwdCwgdHlwZSwgZW5hYmxlLCB1c2VySW5wdXQgPSB0cnVlIH0gPSBkYXRhO1xuICAgICAgYXdhaXQgdGhpcy50b2dnbGVTY3JpcHQoc2NyaXB0LCB0eXBlLCBlbmFibGUsIHVzZXJJbnB1dCk7XG4gICAgfSk7XG5cbiAgICBzY3JpcHRFdmVudHMub24oU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5UWVBFX1RPR0dMRSwgYXN5bmMgZGF0YSA9PiB7XG4gICAgICBjb25zdCB7IHR5cGUsIGVuYWJsZSwgdXNlcklucHV0ID0gdHJ1ZSB9ID0gZGF0YTtcbiAgICAgIGF3YWl0IHRoaXMudG9nZ2xlU2NyaXB0VHlwZSh0eXBlLCBlbmFibGUsIHVzZXJJbnB1dCk7XG4gICAgfSk7XG5cbiAgICBzY3JpcHRFdmVudHMub24oU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5TQ1JJUFRfSU1QT1JULCBhc3luYyBkYXRhID0+IHtcbiAgICAgIGNvbnN0IHsgZmlsZSwgdHlwZSB9ID0gZGF0YTtcbiAgICAgIGF3YWl0IHRoaXMuaW1wb3J0U2NyaXB0KGZpbGUsIHR5cGUpO1xuICAgIH0pO1xuXG4gICAgc2NyaXB0RXZlbnRzLm9uKFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuU0NSSVBUX0RFTEVURSwgYXN5bmMgZGF0YSA9PiB7XG4gICAgICBjb25zdCB7IHNjcmlwdElkLCB0eXBlIH0gPSBkYXRhO1xuICAgICAgYXdhaXQgdGhpcy5kZWxldGVTY3JpcHQoc2NyaXB0SWQsIHR5cGUpO1xuICAgIH0pO1xuXG4gICAgc2NyaXB0RXZlbnRzLm9uKFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuU0NSSVBUX0NSRUFURSwgYXN5bmMgZGF0YSA9PiB7XG4gICAgICBjb25zdCB7IHNjcmlwdCwgdHlwZSB9ID0gZGF0YTtcbiAgICAgIGF3YWl0IHRoaXMuY3JlYXRlU2NyaXB0KHNjcmlwdCwgdHlwZSk7XG4gICAgfSk7XG5cbiAgICBzY3JpcHRFdmVudHMub24oU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5TQ1JJUFRfVVBEQVRFLCBhc3luYyBkYXRhID0+IHtcbiAgICAgIGNvbnN0IHsgc2NyaXB0LCB0eXBlIH0gPSBkYXRhO1xuICAgICAgYXdhaXQgdGhpcy51cGRhdGVTY3JpcHQoc2NyaXB0LCB0eXBlKTtcbiAgICB9KTtcblxuICAgIHNjcmlwdEV2ZW50cy5vbihTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlNDUklQVF9NT1ZFLCBhc3luYyBkYXRhID0+IHtcbiAgICAgIGNvbnN0IHsgc2NyaXB0LCBmcm9tVHlwZSB9ID0gZGF0YTtcbiAgICAgIGF3YWl0IHRoaXMubW92ZVNjcmlwdChzY3JpcHQsIGZyb21UeXBlKTtcbiAgICB9KTtcblxuICAgIHNjcmlwdEV2ZW50cy5vbihTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLkZPTERFUl9NT1ZFLCBhc3luYyBkYXRhID0+IHtcbiAgICAgIGNvbnN0IHsgZm9sZGVySWQsIGZyb21UeXBlIH0gPSBkYXRhO1xuICAgICAgYXdhaXQgdGhpcy5tb3ZlRm9sZGVyKGZvbGRlcklkLCBmcm9tVHlwZSk7XG4gICAgfSk7XG5cbiAgICBzY3JpcHRFdmVudHMub24oU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5PUkRFUl9DSEFOR0VELCBhc3luYyBkYXRhID0+IHtcbiAgICAgIGNvbnN0IHsgZGF0YTogb3JkZXJEYXRhLCB0eXBlIH0gPSBkYXRhO1xuICAgICAgYXdhaXQgdGhpcy5zYXZlT3JkZXIob3JkZXJEYXRhLCB0eXBlKTtcbiAgICB9KTtcblxuICAgIHNjcmlwdEV2ZW50cy5vbihTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlVJX0xPQURFRCwgYXN5bmMgKCkgPT4ge1xuICAgICAgaWYgKCFnZXRTZXR0aW5nVmFsdWUoJ2VuYWJsZWRfZXh0ZW5zaW9uJykpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBnbG9iYWxTY3JpcHRzID0gdGhpcy5zY3JpcHREYXRhLmdldEdsb2JhbFNjcmlwdHMoKTtcbiAgICAgIGNvbnN0IGNoYXJhY3RlclNjcmlwdHMgPSB0aGlzLnNjcmlwdERhdGEuZ2V0Q2hhcmFjdGVyU2NyaXB0cygpO1xuXG4gICAgICBpZiAodGhpcy5zY3JpcHREYXRhLmlzR2xvYmFsU2NyaXB0RW5hYmxlZCkge1xuICAgICAgICBhd2FpdCB0aGlzLnJ1blNjcmlwdHNCeVR5cGUoZ2xvYmFsU2NyaXB0cywgU2NyaXB0VHlwZS5HTE9CQUwpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbG9nLmluZm8oJ1tTY3JpcHRNYW5hZ2VyXSDlhajlsYDohJrmnKznsbvlnovmnKrlkK/nlKjvvIzot7Pov4fov5DooYzlhajlsYDohJrmnKwnKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuc2NyaXB0RGF0YS5pc0NoYXJhY3RlclNjcmlwdEVuYWJsZWQpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5ydW5TY3JpcHRzQnlUeXBlKGNoYXJhY3RlclNjcmlwdHMsIFNjcmlwdFR5cGUuQ0hBUkFDVEVSKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxvZy5pbmZvKCdbU2NyaXB0TWFuYWdlcl0g6KeS6Imy6ISa5pys57G75Z6L5pyq5ZCv55So77yM6Lez6L+H6L+Q6KGM6KeS6Imy6ISa5pysJyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog5YiH5o2i6ISa5pys5ZCv55So54q25oCBXG4gICAqIEBwYXJhbSBzY3JpcHQg6ISa5pysXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKiBAcGFyYW0gZW5hYmxlIOaYr+WQpuWQr+eUqFxuICAgKiBAcGFyYW0gdXNlcklucHV0IOaYr+WQpueUseeUqOaIt+i+k+WFpVxuICAgKi9cbiAgcHVibGljIGFzeW5jIHRvZ2dsZVNjcmlwdChcbiAgICBzY3JpcHQ6IFNjcmlwdCxcbiAgICB0eXBlOiBTY3JpcHRUeXBlLFxuICAgIGVuYWJsZTogYm9vbGVhbixcbiAgICB1c2VySW5wdXQ6IGJvb2xlYW4gPSB0cnVlLFxuICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAodXNlcklucHV0KSB7XG4gICAgICBzY3JpcHQuZW5hYmxlZCA9IGVuYWJsZTtcbiAgICAgIGF3YWl0IHRoaXMuc2NyaXB0RGF0YS5zYXZlU2NyaXB0KHNjcmlwdCwgdHlwZSk7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGlmIChlbmFibGUpIHtcbiAgICAgICAgaWYgKHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMICYmICF0aGlzLnNjcmlwdERhdGEuaXNHbG9iYWxTY3JpcHRFbmFibGVkKSB7XG4gICAgICAgICAgbG9nLmluZm8oYFtzY3JpcHRfbWFuYWdlcl0g5YWo5bGA6ISa5pys57G75Z6L5pyq5ZCv55So77yM6Lez6L+H5ZCv55So6ISa5pysW1wiJHtzY3JpcHQubmFtZX1cIl1gKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGUgPT09IFNjcmlwdFR5cGUuQ0hBUkFDVEVSICYmICF0aGlzLnNjcmlwdERhdGEuaXNDaGFyYWN0ZXJTY3JpcHRFbmFibGVkKSB7XG4gICAgICAgICAgbG9nLmluZm8oYFtzY3JpcHRfbWFuYWdlcl0g6KeS6Imy6ISa5pys57G75Z6L5pyq5ZCv55So77yM6Lez6L+H5ZCv55So6ISa5pysW1wiJHtzY3JpcHQubmFtZX1cIl1gKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBhd2FpdCB0aGlzLnJ1blNjcmlwdChzY3JpcHQsIHR5cGUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXdhaXQgdGhpcy5zdG9wU2NyaXB0KHNjcmlwdCwgdHlwZSk7XG4gICAgICB9XG5cbiAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuVUlfUkVGUkVTSCwge1xuICAgICAgICBhY3Rpb246ICdzY3JpcHRfdG9nZ2xlJyxcbiAgICAgICAgc2NyaXB0LFxuICAgICAgICB0eXBlLFxuICAgICAgICBlbmFibGUsXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nLmVycm9yKGBbU2NyaXB0TWFuYWdlcl0g5YiH5o2i6ISa5pys54q25oCB5aSx6LSlOiAke3NjcmlwdC5uYW1lfWAsIGVycm9yKTtcbiAgICAgIHRvYXN0ci5lcnJvcihg5YiH5o2i6ISa5pys54q25oCB5aSx6LSlOiAke3NjcmlwdC5uYW1lfWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDliIfmjaLohJrmnKznsbvlnovlkK/nlKjnirbmgIFcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqIEBwYXJhbSBlbmFibGUg5piv5ZCm5ZCv55SoXG4gICAqIEBwYXJhbSB1c2VySW5wdXQg5piv5ZCm55Sx55So5oi36L6T5YWlXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgdG9nZ2xlU2NyaXB0VHlwZSh0eXBlOiBTY3JpcHRUeXBlLCBlbmFibGU6IGJvb2xlYW4sIHVzZXJJbnB1dDogYm9vbGVhbiA9IHRydWUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAodXNlcklucHV0KSB7XG4gICAgICBhd2FpdCB0aGlzLnNjcmlwdERhdGEudXBkYXRlU2NyaXB0VHlwZUVuYWJsZVN0YXRlKHR5cGUsIGVuYWJsZSk7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHNjcmlwdHMgPVxuICAgICAgICB0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCA/IHRoaXMuc2NyaXB0RGF0YS5nZXRHbG9iYWxTY3JpcHRzKCkgOiB0aGlzLnNjcmlwdERhdGEuZ2V0Q2hhcmFjdGVyU2NyaXB0cygpO1xuXG4gICAgICBpZiAoZW5hYmxlKSB7XG4gICAgICAgIGF3YWl0IHRoaXMucnVuU2NyaXB0c0J5VHlwZShzY3JpcHRzLCB0eXBlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGF3YWl0IHRoaXMuc3RvcFNjcmlwdHNCeVR5cGUoc2NyaXB0cywgdHlwZSk7XG4gICAgICB9XG5cbiAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuVUlfUkVGUkVTSCwge1xuICAgICAgICBhY3Rpb246ICd0eXBlX3RvZ2dsZScsXG4gICAgICAgIHR5cGUsXG4gICAgICAgIGVuYWJsZSxcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2cuZXJyb3IoYFtTY3JpcHRNYW5hZ2VyXSDliIfmjaLohJrmnKznsbvlnovnirbmgIHlpLHotKU6ICR7dHlwZX1gLCBlcnJvcik7XG4gICAgICB0b2FzdHIuZXJyb3IoYOWIh+aNouiEmuacrOexu+Wei+eKtuaAgeWksei0pTogJHt0eXBlfWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDov5DooYzljZXkuKrohJrmnKxcbiAgICogQHBhcmFtIHNjcmlwdCDohJrmnKxcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgcnVuU2NyaXB0KHNjcmlwdDogU2NyaXB0LCB0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgaWYgKCFnZXRTZXR0aW5nVmFsdWUoJ2VuYWJsZWRfZXh0ZW5zaW9uJykpIHtcbiAgICAgIHRvYXN0ci5lcnJvcignW1NjcmlwdE1hbmFnZXJdIOaJqeWxleacquWQr+eUqCcpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICh0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCAmJiAhdGhpcy5zY3JpcHREYXRhLmlzR2xvYmFsU2NyaXB0RW5hYmxlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAodHlwZSA9PT0gU2NyaXB0VHlwZS5DSEFSQUNURVIgJiYgIXRoaXMuc2NyaXB0RGF0YS5pc0NoYXJhY3RlclNjcmlwdEVuYWJsZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBhd2FpdCB0aGlzLmV4ZWN1dG9yLnJ1blNjcmlwdChzY3JpcHQsIHR5cGUpO1xuXG4gICAgaWYgKHNjcmlwdC5idXR0b25zICYmIHNjcmlwdC5idXR0b25zLmxlbmd0aCA+IDApIHtcbiAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuQlVUVE9OX0FERCwgeyBzY3JpcHQgfSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWBnOatouWNleS4quiEmuacrFxuICAgKiBAcGFyYW0gc2NyaXB0IOiEmuacrFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHB1YmxpYyBhc3luYyBzdG9wU2NyaXB0KHNjcmlwdDogU2NyaXB0LCB0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgYXdhaXQgdGhpcy5leGVjdXRvci5zdG9wU2NyaXB0KHNjcmlwdCwgdHlwZSk7XG5cbiAgICBpZiAoc2NyaXB0LmJ1dHRvbnMgJiYgc2NyaXB0LmJ1dHRvbnMubGVuZ3RoID4gMCkge1xuICAgICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5CVVRUT05fUkVNT1ZFLCB7IHNjcmlwdElkOiBzY3JpcHQuaWQgfSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOi/kOihjOaMh+Wumuexu+Wei+eahOaJgOacieiEmuacrFxuICAgKiBAcGFyYW0gc2NyaXB0cyDohJrmnKzliJfooahcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgcnVuU2NyaXB0c0J5VHlwZShzY3JpcHRzOiBTY3JpcHRbXSwgdHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICghZ2V0U2V0dGluZ1ZhbHVlKCdlbmFibGVkX2V4dGVuc2lvbicpKSB7XG4gICAgICB0b2FzdHIuZXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDphZLppobliqnmiYvmnKrlkK/nlKjvvIzml6Dms5Xov5DooYzohJrmnKwnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAodHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgJiYgIXRoaXMuc2NyaXB0RGF0YS5pc0dsb2JhbFNjcmlwdEVuYWJsZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHR5cGUgPT09IFNjcmlwdFR5cGUuQ0hBUkFDVEVSICYmICF0aGlzLnNjcmlwdERhdGEuaXNDaGFyYWN0ZXJTY3JpcHRFbmFibGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgZW5hYmxlZFNjcmlwdHMgPSBzY3JpcHRzLmZpbHRlcihzY3JpcHQgPT4gc2NyaXB0LmVuYWJsZWQpO1xuXG4gICAgZm9yIChjb25zdCBzY3JpcHQgb2YgZW5hYmxlZFNjcmlwdHMpIHtcbiAgICAgIGF3YWl0IHRoaXMuZXhlY3V0b3IucnVuU2NyaXB0KHNjcmlwdCwgdHlwZSk7XG5cbiAgICAgIGlmIChzY3JpcHQuYnV0dG9ucyAmJiBzY3JpcHQuYnV0dG9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuQlVUVE9OX0FERCwgeyBzY3JpcHQgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWBnOatouaMh+Wumuexu+Wei+eahOaJgOacieiEmuacrFxuICAgKiBAcGFyYW0gc2NyaXB0cyDohJrmnKzliJfooahcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgc3RvcFNjcmlwdHNCeVR5cGUoc2NyaXB0czogU2NyaXB0W10sIHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBlbmFibGVkU2NyaXB0cyA9IHNjcmlwdHMuZmlsdGVyKHNjcmlwdCA9PiBzY3JpcHQuZW5hYmxlZCk7XG5cbiAgICBmb3IgKGNvbnN0IHNjcmlwdCBvZiBlbmFibGVkU2NyaXB0cykge1xuICAgICAgYXdhaXQgdGhpcy5leGVjdXRvci5zdG9wU2NyaXB0KHNjcmlwdCwgdHlwZSk7XG5cbiAgICAgIGlmIChzY3JpcHQuYnV0dG9ucyAmJiBzY3JpcHQuYnV0dG9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuQlVUVE9OX1JFTU9WRSwgeyBzY3JpcHRJZDogc2NyaXB0LmlkIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDlr7zlhaXohJrmnKzmiJbmlofku7blpLlcbiAgICogQHBhcmFtIGZpbGUg6ISa5pys5paH5Lu25oiW5paH5Lu25aS55a+85Ye65paH5Lu2XG4gICAqIEBwYXJhbSB0eXBlIOWvvOWFpeebruagh+exu+Wei1xuICAgKi9cbiAgcHVibGljIGFzeW5jIGltcG9ydFNjcmlwdChmaWxlOiBGaWxlLCB0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGlmIChmaWxlLm5hbWUudG9Mb3dlckNhc2UoKS5lbmRzV2l0aCgnLnppcCcpKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuaW1wb3J0RnJvbVppcChmaWxlLCB0eXBlKTtcbiAgICAgIH0gZWxzZSBpZiAoZmlsZS5uYW1lLnRvTG93ZXJDYXNlKCkuZW5kc1dpdGgoJy5qc29uJykpIHtcbiAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMucmVhZEZpbGVBc1RleHQoZmlsZSk7XG4gICAgICAgIGNvbnN0IGltcG9ydERhdGEgPSBKU09OLnBhcnNlKGNvbnRlbnQpO1xuXG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KGltcG9ydERhdGEpKSB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5pbXBvcnRNdWx0aXBsZUl0ZW1zKGltcG9ydERhdGEsIHR5cGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGF3YWl0IHRoaXMuaW1wb3J0U2luZ2xlU2NyaXB0KGltcG9ydERhdGEsIHR5cGUpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ+S4jeaUr+aMgeeahOaWh+S7tuagvOW8j++8jOivt+mAieaLqSAuanNvbiDmiJYgLnppcCDmlofku7YnKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nLmVycm9yKCdbU2NyaXB0TWFuYWdlcl0g5a+85YWl5aSx6LSlOicsIGVycm9yKTtcbiAgICAgIHRvYXN0ci5lcnJvcihg5a+85YWl5aSx6LSlOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ+aXoOaViOeahOaWh+S7tuagvOW8jyd9YCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOS7jlpJUOaWh+S7tuWvvOWFpVxuICAgKiBAcGFyYW0gZmlsZSBaSVDmlofku7ZcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGltcG9ydEZyb21aaXAoZmlsZTogRmlsZSwgdHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIC8vQHRzLWlnbm9yZVxuICAgIGlmICghd2luZG93LkpTWmlwKSB7XG4gICAgICBsb2cuaW5mbygnaW1wb3J0IGpzemlwJyk7XG4gICAgICBhd2FpdCBpbXBvcnQoJ0BzaWxseXRhdmVybi9saWIvanN6aXAubWluLmpzJyk7XG4gICAgfVxuICAgIC8vQHRzLWlnbm9yZVxuICAgIGNvbnN0IHppcCA9IG5ldyBKU1ppcCgpO1xuICAgIGNvbnN0IHppcENvbnRlbnQgPSBhd2FpdCB6aXAubG9hZEFzeW5jKGZpbGUpO1xuXG4gICAgbGV0IGltcG9ydGVkU2NyaXB0cyA9IDA7XG4gICAgbGV0IGltcG9ydGVkRm9sZGVycyA9IDA7XG5cbiAgICBjb25zdCBmb2xkZXJzID0gbmV3IFNldDxzdHJpbmc+KCk7XG4gICAgY29uc3Qgcm9vdFNjcmlwdHM6IHN0cmluZ1tdID0gW107XG5cbiAgICBmb3IgKGNvbnN0IGZpbGVOYW1lIGluIHppcENvbnRlbnQuZmlsZXMpIHtcbiAgICAgIGNvbnN0IGZpbGUgPSB6aXBDb250ZW50LmZpbGVzW2ZpbGVOYW1lXTtcblxuICAgICAgaWYgKCFmaWxlLmRpciAmJiBmaWxlTmFtZS5lbmRzV2l0aCgnLmpzb24nKSkge1xuICAgICAgICBjb25zdCBwYXRoUGFydHMgPSBmaWxlTmFtZS5zcGxpdCgnLycpO1xuXG4gICAgICAgIGlmIChwYXRoUGFydHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgcm9vdFNjcmlwdHMucHVzaChmaWxlTmFtZSk7XG4gICAgICAgIH0gZWxzZSBpZiAocGF0aFBhcnRzLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgIGZvbGRlcnMuYWRkKHBhdGhQYXJ0c1swXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBmb3IgKGNvbnN0IGZpbGVOYW1lIG9mIHJvb3RTY3JpcHRzKSB7XG4gICAgICBjb25zdCBmaWxlID0gemlwQ29udGVudC5maWxlc1tmaWxlTmFtZV07XG4gICAgICBjb25zdCBzY3JpcHRDb250ZW50ID0gYXdhaXQgZmlsZS5hc3luYygnc3RyaW5nJyk7XG4gICAgICBjb25zdCBzY3JpcHREYXRhID0gSlNPTi5wYXJzZShzY3JpcHRDb250ZW50KTtcblxuICAgICAgaWYgKHNjcmlwdERhdGEubmFtZSAmJiAnY29udGVudCcgaW4gc2NyaXB0RGF0YSkge1xuICAgICAgICBjb25zdCBzY3JpcHQgPSBuZXcgU2NyaXB0KHtcbiAgICAgICAgICAuLi5zY3JpcHREYXRhLFxuICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlLFxuICAgICAgICB9KTtcbiAgICAgICAgYXdhaXQgdGhpcy5oYW5kbGVTY3JpcHRJbXBvcnQoc2NyaXB0LCB0eXBlKTtcbiAgICAgICAgaW1wb3J0ZWRTY3JpcHRzKys7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZm9yIChjb25zdCBmb2xkZXJOYW1lIG9mIGZvbGRlcnMpIHtcbiAgICAgIGNvbnN0IGZvbGRlclNjcmlwdENvdW50ID0gYXdhaXQgdGhpcy5pbXBvcnRGb2xkZXJGcm9tWmlwTmV3KHppcENvbnRlbnQsIGZvbGRlck5hbWUsIHR5cGUpO1xuICAgICAgaW1wb3J0ZWRTY3JpcHRzICs9IGZvbGRlclNjcmlwdENvdW50O1xuICAgICAgaW1wb3J0ZWRGb2xkZXJzKys7XG4gICAgfVxuXG4gICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5VSV9SRUZSRVNILCB7XG4gICAgICBhY3Rpb246IHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMID8gJ3JlZnJlc2hfZ2xvYmFsX3NjcmlwdHMnIDogJ3JlZnJlc2hfY2hhcmFjdF9zY3JpcHRzJyxcbiAgICB9KTtcblxuICAgIHRvYXN0ci5zdWNjZXNzKGDmiJDlip/lr7zlhaUgJHtpbXBvcnRlZFNjcmlwdHN9IOS4quiEmuacrOWSjCAke2ltcG9ydGVkRm9sZGVyc30g5Liq5paH5Lu25aS5YCk7XG4gIH1cblxuICAvKipcbiAgICog5LuOWklQ5Lit5a+85YWl5paH5Lu25aS5XG4gICAqIEBwYXJhbSB6aXBDb250ZW50IFpJUOWGheWuuVxuICAgKiBAcGFyYW0gZm9sZGVyTmFtZSDmlofku7blpLnlkI3np7BcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqIEByZXR1cm5zIOWvvOWFpeeahOiEmuacrOaVsOmHj1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBpbXBvcnRGb2xkZXJGcm9tWmlwTmV3KHppcENvbnRlbnQ6IGFueSwgZm9sZGVyTmFtZTogc3RyaW5nLCB0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICBjb25zdCByZXBvc2l0b3J5ID1cbiAgICAgIHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMXG4gICAgICAgID8gdGhpcy5zY3JpcHREYXRhLmdldEdsb2JhbFJlcG9zaXRvcnlJdGVtcygpXG4gICAgICAgIDogdGhpcy5zY3JpcHREYXRhLmdldENoYXJhY3RlclJlcG9zaXRvcnlJdGVtcygpO1xuXG4gICAgbGV0IGZpbmFsRm9sZGVyTmFtZSA9IGZvbGRlck5hbWU7XG4gICAgbGV0IGNvdW50ZXIgPSAxO1xuICAgIHdoaWxlIChyZXBvc2l0b3J5LnNvbWUoaXRlbSA9PiBpdGVtLnR5cGUgPT09ICdmb2xkZXInICYmIGl0ZW0ubmFtZSA9PT0gZmluYWxGb2xkZXJOYW1lKSkge1xuICAgICAgZmluYWxGb2xkZXJOYW1lID0gYCR7Zm9sZGVyTmFtZX1fJHtjb3VudGVyfWA7XG4gICAgICBjb3VudGVyKys7XG4gICAgfVxuXG4gICAgY29uc3QgZm9sZGVySWQgPSBhd2FpdCB0aGlzLnNjcmlwdERhdGEuY3JlYXRlRm9sZGVyKGZpbmFsRm9sZGVyTmFtZSwgdHlwZSk7XG4gICAgbGV0IGZvbGRlclNjcmlwdENvdW50ID0gMDtcblxuICAgIGZvciAoY29uc3QgZmlsZU5hbWUgaW4gemlwQ29udGVudC5maWxlcykge1xuICAgICAgY29uc3QgZmlsZSA9IHppcENvbnRlbnQuZmlsZXNbZmlsZU5hbWVdO1xuXG4gICAgICBpZiAoIWZpbGUuZGlyICYmIGZpbGVOYW1lLnN0YXJ0c1dpdGgoYCR7Zm9sZGVyTmFtZX0vYCkgJiYgZmlsZU5hbWUuZW5kc1dpdGgoJy5qc29uJykpIHtcbiAgICAgICAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGF3YWl0IGZpbGUuYXN5bmMoJ3N0cmluZycpO1xuICAgICAgICBjb25zdCBzY3JpcHREYXRhID0gSlNPTi5wYXJzZShzY3JpcHRDb250ZW50KTtcblxuICAgICAgICBpZiAoc2NyaXB0RGF0YS5uYW1lICYmICdjb250ZW50JyBpbiBzY3JpcHREYXRhKSB7XG4gICAgICAgICAgY29uc3Qgc2NyaXB0ID0gbmV3IFNjcmlwdCh7XG4gICAgICAgICAgICAuLi5zY3JpcHREYXRhLFxuICAgICAgICAgICAgZW5hYmxlZDogZmFsc2UsXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgYXdhaXQgdGhpcy5oYW5kbGVTY3JpcHRJbXBvcnQoc2NyaXB0LCB0eXBlKTtcbiAgICAgICAgICBhd2FpdCB0aGlzLnNjcmlwdERhdGEubW92ZVNjcmlwdFRvRm9sZGVyKHNjcmlwdC5pZCwgZm9sZGVySWQsIHR5cGUpO1xuICAgICAgICAgIGZvbGRlclNjcmlwdENvdW50Kys7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZm9sZGVyU2NyaXB0Q291bnQ7XG4gIH1cblxuICAvKipcbiAgICog5a+85YWl5Y2V5Liq6ISa5pysXG4gICAqIEBwYXJhbSBzY3JpcHREYXRhIOiEmuacrOaVsOaNrlxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgaW1wb3J0U2luZ2xlU2NyaXB0KHNjcmlwdERhdGE6IGFueSwgdHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICghc2NyaXB0RGF0YS5uYW1lIHx8ICEoJ2NvbnRlbnQnIGluIHNjcmlwdERhdGEpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ+aXoOaViOeahOiEmuacrOaVsOaNricpO1xuICAgIH1cblxuICAgIGNvbnN0IHNjcmlwdFRvSW1wb3J0ID0gbmV3IFNjcmlwdCh7XG4gICAgICAuLi5zY3JpcHREYXRhLFxuICAgICAgZW5hYmxlZDogZmFsc2UsXG4gICAgfSk7XG5cbiAgICBhd2FpdCB0aGlzLmhhbmRsZVNjcmlwdEltcG9ydChzY3JpcHRUb0ltcG9ydCwgdHlwZSk7XG5cbiAgICB0b2FzdHIuc3VjY2Vzcyhg6ISa5pysICcke3NjcmlwdFRvSW1wb3J0Lm5hbWV9JyDlr7zlhaXmiJDlip/jgIJgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlr7zlhaXlpJrkuKrpobnnm67vvIjohJrmnKzmiJbmlofku7blpLnvvIlcbiAgICogQHBhcmFtIGl0ZW1zIOmhueebruaVsOe7hFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgaW1wb3J0TXVsdGlwbGVJdGVtcyhpdGVtczogYW55W10sIHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBsZXQgaW1wb3J0ZWRDb3VudCA9IDA7XG4gICAgbGV0IGZvbGRlckNvdW50ID0gMDtcbiAgICBsZXQgc2NyaXB0Q291bnQgPSAwO1xuXG4gICAgZm9yIChjb25zdCBpdGVtIG9mIGl0ZW1zKSB7XG4gICAgICBpZiAoaXRlbS50eXBlID09PSAnZm9sZGVyJykge1xuICAgICAgICBhd2FpdCB0aGlzLmltcG9ydEZvbGRlcihpdGVtLCB0eXBlKTtcbiAgICAgICAgZm9sZGVyQ291bnQrKztcbiAgICAgICAgaW1wb3J0ZWRDb3VudCsrO1xuICAgICAgfSBlbHNlIGlmIChpdGVtLnR5cGUgPT09ICdzY3JpcHQnKSB7XG4gICAgICAgIGNvbnN0IHNjcmlwdCA9IG5ldyBTY3JpcHQoe1xuICAgICAgICAgIC4uLml0ZW0udmFsdWUsXG4gICAgICAgICAgZW5hYmxlZDogZmFsc2UsXG4gICAgICAgIH0pO1xuICAgICAgICBhd2FpdCB0aGlzLmhhbmRsZVNjcmlwdEltcG9ydChzY3JpcHQsIHR5cGUpO1xuICAgICAgICBzY3JpcHRDb3VudCsrO1xuICAgICAgICBpbXBvcnRlZENvdW50Kys7XG4gICAgICB9IGVsc2UgaWYgKGl0ZW0ubmFtZSAmJiAnY29udGVudCcgaW4gaXRlbSkge1xuICAgICAgICBjb25zdCBzY3JpcHQgPSBuZXcgU2NyaXB0KHtcbiAgICAgICAgICAuLi5pdGVtLFxuICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlLFxuICAgICAgICB9KTtcbiAgICAgICAgYXdhaXQgdGhpcy5oYW5kbGVTY3JpcHRJbXBvcnQoc2NyaXB0LCB0eXBlKTtcbiAgICAgICAgc2NyaXB0Q291bnQrKztcbiAgICAgICAgaW1wb3J0ZWRDb3VudCsrO1xuICAgICAgfVxuICAgIH1cblxuICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuVUlfUkVGUkVTSCwge1xuICAgICAgYWN0aW9uOiB0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCA/ICdyZWZyZXNoX2dsb2JhbF9zY3JpcHRzJyA6ICdyZWZyZXNoX2NoYXJhY3Rfc2NyaXB0cycsXG4gICAgfSk7XG5cbiAgICB0b2FzdHIuc3VjY2Vzcyhg5a+85YWl5oiQ5YqfYCk7XG4gIH1cblxuICAvKipcbiAgICog5a+85YWl5paH5Lu25aS5XG4gICAqIEBwYXJhbSBmb2xkZXJEYXRhIOaWh+S7tuWkueaVsOaNrlxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgaW1wb3J0Rm9sZGVyKGZvbGRlckRhdGE6IGFueSwgdHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICghZm9sZGVyRGF0YS5uYW1lIHx8ICFBcnJheS5pc0FycmF5KGZvbGRlckRhdGEudmFsdWUpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ+aXoOaViOeahOaWh+S7tuWkueaVsOaNricpO1xuICAgIH1cblxuICAgIGNvbnN0IHJlcG9zaXRvcnkgPVxuICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUxcbiAgICAgICAgPyB0aGlzLnNjcmlwdERhdGEuZ2V0R2xvYmFsUmVwb3NpdG9yeUl0ZW1zKClcbiAgICAgICAgOiB0aGlzLnNjcmlwdERhdGEuZ2V0Q2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKCk7XG5cbiAgICBsZXQgZm9sZGVyTmFtZSA9IGZvbGRlckRhdGEubmFtZTtcbiAgICBsZXQgY291bnRlciA9IDE7XG4gICAgd2hpbGUgKHJlcG9zaXRvcnkuc29tZShpdGVtID0+IGl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicgJiYgaXRlbS5uYW1lID09PSBmb2xkZXJOYW1lKSkge1xuICAgICAgZm9sZGVyTmFtZSA9IGAke2ZvbGRlckRhdGEubmFtZX1fJHtjb3VudGVyfWA7XG4gICAgICBjb3VudGVyKys7XG4gICAgfVxuXG4gICAgY29uc3QgZm9sZGVySWQgPSBhd2FpdCB0aGlzLnNjcmlwdERhdGEuY3JlYXRlRm9sZGVyKGZvbGRlck5hbWUsIHR5cGUpO1xuXG4gICAgZm9yIChjb25zdCBzY3JpcHREYXRhIG9mIGZvbGRlckRhdGEudmFsdWUpIHtcbiAgICAgIGNvbnN0IHNjcmlwdCA9IG5ldyBTY3JpcHQoe1xuICAgICAgICAuLi5zY3JpcHREYXRhLFxuICAgICAgICBlbmFibGVkOiBmYWxzZSxcbiAgICAgIH0pO1xuICAgICAgYXdhaXQgdGhpcy5oYW5kbGVTY3JpcHRJbXBvcnQoc2NyaXB0LCB0eXBlKTtcbiAgICAgIGF3YWl0IHRoaXMuc2NyaXB0RGF0YS5tb3ZlU2NyaXB0VG9Gb2xkZXIoc2NyaXB0LmlkLCBmb2xkZXJJZCwgdHlwZSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWkhOeQhuiEmuacrOWvvOWFpeWGsueqgVxuICAgKiBAcGFyYW0gc2NyaXB0IOimgeWvvOWFpeeahOiEmuacrFxuICAgKiBAcGFyYW0gdHlwZSDnm67moIfnsbvlnotcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgaGFuZGxlU2NyaXB0SW1wb3J0KHNjcmlwdDogU2NyaXB0LCB0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgZ2xvYmFsU2NyaXB0cyA9IHRoaXMuc2NyaXB0RGF0YS5nZXRHbG9iYWxTY3JpcHRzKCk7XG4gICAgY29uc3QgY2hhcmFjdGVyU2NyaXB0cyA9IHRoaXMuc2NyaXB0RGF0YS5nZXRDaGFyYWN0ZXJTY3JpcHRzKCk7XG5cbiAgICBjb25zdCBjb25mbGljdEluR2xvYmFsID0gZ2xvYmFsU2NyaXB0cy5maW5kKHMgPT4gcy5pZCA9PT0gc2NyaXB0LmlkKTtcbiAgICBjb25zdCBjb25mbGljdEluQ2hhcmFjdGVyID0gY2hhcmFjdGVyU2NyaXB0cy5maW5kKHMgPT4gcy5pZCA9PT0gc2NyaXB0LmlkKTtcblxuICAgIGxldCBleGlzdGluZ1NjcmlwdDogU2NyaXB0IHwgdW5kZWZpbmVkO1xuICAgIGxldCBjb25mbGljdFR5cGU6IFNjcmlwdFR5cGUgfCB1bmRlZmluZWQ7XG5cbiAgICBpZiAoY29uZmxpY3RJbkdsb2JhbCkge1xuICAgICAgZXhpc3RpbmdTY3JpcHQgPSBjb25mbGljdEluR2xvYmFsO1xuICAgICAgY29uZmxpY3RUeXBlID0gU2NyaXB0VHlwZS5HTE9CQUw7XG4gICAgfSBlbHNlIGlmIChjb25mbGljdEluQ2hhcmFjdGVyKSB7XG4gICAgICBleGlzdGluZ1NjcmlwdCA9IGNvbmZsaWN0SW5DaGFyYWN0ZXI7XG4gICAgICBjb25mbGljdFR5cGUgPSBTY3JpcHRUeXBlLkNIQVJBQ1RFUjtcbiAgICB9XG5cbiAgICBpZiAoZXhpc3RpbmdTY3JpcHQgJiYgY29uZmxpY3RUeXBlKSB7XG4gICAgICBjb25zdCBhY3Rpb24gPSBhd2FpdCB0aGlzLmhhbmRsZVNjcmlwdElkQ29uZmxpY3Qoc2NyaXB0LCBleGlzdGluZ1NjcmlwdCwgdHlwZSwgJ2ltcG9ydCcpO1xuXG4gICAgICBzd2l0Y2ggKGFjdGlvbikge1xuICAgICAgICBjYXNlICduZXcnOlxuICAgICAgICAgIHNjcmlwdC5pZCA9IHV1aWR2NCgpO1xuICAgICAgICAgIGF3YWl0IHRoaXMuY3JlYXRlU2NyaXB0KHNjcmlwdCwgdHlwZSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ292ZXJyaWRlJzpcbiAgICAgICAgICBhd2FpdCB0aGlzLmRlbGV0ZVNjcmlwdChleGlzdGluZ1NjcmlwdC5pZCwgY29uZmxpY3RUeXBlKTtcbiAgICAgICAgICBhd2FpdCB0aGlzLmNyZWF0ZVNjcmlwdChzY3JpcHQsIHR5cGUpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdjYW5jZWwnOlxuICAgICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgYXdhaXQgdGhpcy5jcmVhdGVTY3JpcHQoc2NyaXB0LCB0eXBlKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog6K+75Y+W5paH5Lu25YaF5a655Li65paH5pysXG4gICAqIEBwYXJhbSBmaWxlIOaWh+S7tuWvueixoVxuICAgKiBAcmV0dXJucyDmlofku7blhoXlrrlcbiAgICovXG4gIHByaXZhdGUgcmVhZEZpbGVBc1RleHQoZmlsZTogRmlsZSk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG4gICAgICByZWFkZXIub25sb2FkID0gZSA9PiByZXNvbHZlKGUudGFyZ2V0Py5yZXN1bHQgYXMgc3RyaW5nKTtcbiAgICAgIHJlYWRlci5vbmVycm9yID0gZSA9PiByZWplY3QoZSk7XG4gICAgICByZWFkZXIucmVhZEFzVGV4dChmaWxlKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDliJvlu7rmlrDohJrmnKxcbiAgICogQHBhcmFtIHNjcmlwdCDohJrmnKxcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgY3JlYXRlU2NyaXB0KHNjcmlwdDogU2NyaXB0LCB0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgYXdhaXQgdGhpcy5zY3JpcHREYXRhLnNhdmVTY3JpcHQoc2NyaXB0LCB0eXBlKTtcbiAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlVJX1JFRlJFU0gsIHtcbiAgICAgIGFjdGlvbjogJ3NjcmlwdF9jcmVhdGUnLFxuICAgICAgc2NyaXB0LFxuICAgICAgdHlwZSxcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmm7TmlrDnjrDmnInohJrmnKxcbiAgICogQHBhcmFtIHNjcmlwdCDohJrmnKxcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgdXBkYXRlU2NyaXB0KHNjcmlwdDogU2NyaXB0LCB0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgYXdhaXQgdGhpcy5zY3JpcHREYXRhLnNhdmVTY3JpcHQoc2NyaXB0LCB0eXBlKTtcbiAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlVJX1JFRlJFU0gsIHtcbiAgICAgIGFjdGlvbjogJ3NjcmlwdF91cGRhdGUnLFxuICAgICAgc2NyaXB0LFxuICAgICAgdHlwZSxcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDnu5/kuIDkv53lrZjmjpLluo/mlrnms5UgLSDkv53lrZjku5PlupPpobnmjpLluo9cbiAgICogQHBhcmFtIHJlcG9zaXRvcnlJdGVtcyDku5PlupPpobnmlbDnu4TvvIjljIXlkKvmlofku7blpLnlkozohJrmnKznmoTmt7flkIjnu5PmnoTvvIlcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgc2F2ZU9yZGVyKHJlcG9zaXRvcnlJdGVtczogU2NyaXB0UmVwb3NpdG9yeUl0ZW1bXSwgdHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICh0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCkge1xuICAgICAgYXdhaXQgdGhpcy5zY3JpcHREYXRhLnNhdmVHbG9iYWxSZXBvc2l0b3J5SXRlbXMocmVwb3NpdG9yeUl0ZW1zKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYXdhaXQgdGhpcy5zY3JpcHREYXRhLnNhdmVDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMocmVwb3NpdG9yeUl0ZW1zKTtcbiAgICB9XG5cbiAgICB0aGlzLnNjcmlwdERhdGEubG9hZFNjcmlwdHMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDliKDpmaTohJrmnKxcbiAgICogQHBhcmFtIHNjcmlwdElkIOiEmuacrElEXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHVibGljIGFzeW5jIGRlbGV0ZVNjcmlwdChzY3JpcHRJZDogc3RyaW5nLCB0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3Qgc2NyaXB0ID0gdGhpcy5zY3JpcHREYXRhLmdldFNjcmlwdEJ5SWQoc2NyaXB0SWQpO1xuICAgIGlmICghc2NyaXB0KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDohJrmnKzkuI3lrZjlnKgnKTtcbiAgICB9XG5cbiAgICBhd2FpdCB0aGlzLnN0b3BTY3JpcHQoc2NyaXB0LCB0eXBlKTtcblxuICAgIGF3YWl0IHRoaXMuc2NyaXB0RGF0YS5kZWxldGVTY3JpcHQoc2NyaXB0SWQsIHR5cGUpO1xuXG4gICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5VSV9SRUZSRVNILCB7XG4gICAgICBhY3Rpb246ICdzY3JpcHRfZGVsZXRlJyxcbiAgICAgIHNjcmlwdElkLFxuICAgICAgdHlwZSxcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDnp7vliqjohJrmnKzliLDlj6bkuIDkuKrnsbvlnotcbiAgICogQHBhcmFtIHNjcmlwdCDohJrmnKxcbiAgICogQHBhcmFtIGZyb21UeXBlIOa6kOexu+Wei1xuICAgKi9cbiAgcHVibGljIGFzeW5jIG1vdmVTY3JpcHQoc2NyaXB0OiBTY3JpcHQsIGZyb21UeXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgYXdhaXQgdGhpcy5zdG9wU2NyaXB0KHNjcmlwdCwgZnJvbVR5cGUpO1xuXG4gICAgY29uc3QgdGFyZ2V0VHlwZSA9IGdldE9wcG9zaXRlU2NyaXB0VHlwZShmcm9tVHlwZSk7XG5cbiAgICBjb25zdCBleGlzdGluZ1NjcmlwdEluVGFyZ2V0ID0gdGhpcy5zY3JpcHREYXRhLmdldFNjcmlwdEJ5SWQoc2NyaXB0LmlkKTtcbiAgICBjb25zdCBleGlzdGluZ1NjcmlwdFR5cGUgPSBleGlzdGluZ1NjcmlwdEluVGFyZ2V0ID8gdGhpcy5zY3JpcHREYXRhLmdldFNjcmlwdFR5cGUoZXhpc3RpbmdTY3JpcHRJblRhcmdldCkgOiBudWxsO1xuXG4gICAgaWYgKGV4aXN0aW5nU2NyaXB0SW5UYXJnZXQgJiYgZXhpc3RpbmdTY3JpcHRUeXBlID09PSB0YXJnZXRUeXBlKSB7XG4gICAgICBjb25zdCBhY3Rpb24gPSBhd2FpdCB0aGlzLmhhbmRsZVNjcmlwdElkQ29uZmxpY3Qoc2NyaXB0LCBleGlzdGluZ1NjcmlwdEluVGFyZ2V0LCB0YXJnZXRUeXBlLCAnbW92ZScpO1xuXG4gICAgICBzd2l0Y2ggKGFjdGlvbikge1xuICAgICAgICBjYXNlICduZXcnOlxuICAgICAgICAgIHNjcmlwdC5pZCA9IHV1aWR2NCgpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdvdmVycmlkZSc6XG4gICAgICAgICAgYXdhaXQgdGhpcy5kZWxldGVTY3JpcHQoZXhpc3RpbmdTY3JpcHRJblRhcmdldC5pZCwgdGFyZ2V0VHlwZSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ2NhbmNlbCc6XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cblxuICAgIGF3YWl0IHRoaXMuc2NyaXB0RGF0YS5tb3ZlSXRlbVRvT3RoZXJUeXBlKHsgdHlwZTogJ3NjcmlwdCcsIGlkOiBzY3JpcHQuaWQsIHZhbHVlOiBzY3JpcHQgfSwgZnJvbVR5cGUpO1xuXG4gICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5VSV9SRUZSRVNILCB7XG4gICAgICBhY3Rpb246ICdzY3JpcHRfbW92ZScsXG4gICAgICBzY3JpcHQsXG4gICAgICBmcm9tVHlwZSxcbiAgICAgIHRhcmdldFR5cGUsXG4gICAgfSk7XG5cbiAgICBpZiAoXG4gICAgICBzY3JpcHQuZW5hYmxlZCAmJlxuICAgICAgKCh0YXJnZXRUeXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCAmJiB0aGlzLnNjcmlwdERhdGEuaXNHbG9iYWxTY3JpcHRFbmFibGVkKSB8fFxuICAgICAgICAodGFyZ2V0VHlwZSA9PT0gU2NyaXB0VHlwZS5DSEFSQUNURVIgJiYgdGhpcy5zY3JpcHREYXRhLmlzQ2hhcmFjdGVyU2NyaXB0RW5hYmxlZCkpXG4gICAgKSB7XG4gICAgICBhd2FpdCB0aGlzLnJ1blNjcmlwdChzY3JpcHQsIHRhcmdldFR5cGUpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDliLfmlrDop5LoibLohJrmnKzmlbDmja5cbiAgICovXG4gIHB1YmxpYyByZWZyZXNoQ2hhcmFjdGVyU2NyaXB0RGF0YSgpOiB2b2lkIHtcbiAgICB0aGlzLnNjcmlwdERhdGEuZ2V0Q2hhcmFjdGVyU2NyaXB0cygpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluWFqOWxgOiEmuacrFxuICAgKi9cbiAgcHVibGljIGdldEdsb2JhbFNjcmlwdHMoKTogU2NyaXB0W10ge1xuICAgIHJldHVybiB0aGlzLnNjcmlwdERhdGEuZ2V0R2xvYmFsU2NyaXB0cygpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluinkuiJsuiEmuacrFxuICAgKi9cbiAgcHVibGljIGdldENoYXJhY3RlclNjcmlwdHMoKTogU2NyaXB0W10ge1xuICAgIHJldHVybiB0aGlzLnNjcmlwdERhdGEuZ2V0Q2hhcmFjdGVyU2NyaXB0cygpO1xuICB9XG5cbiAgLyoqXG4gICAqIOWIt+aWsOinkuiJsuiEmuacrOWQr+eUqOeKtuaAgVxuICAgKi9cbiAgcHVibGljIHJlZnJlc2hDaGFyYWN0ZXJTY3JpcHRFbmFibGVkU3RhdGUoKTogdm9pZCB7XG4gICAgdGhpcy5zY3JpcHREYXRhLnJlZnJlc2hDaGFyYWN0ZXJTY3JpcHRFbmFibGVkU3RhdGUoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5blhajlsYDohJrmnKzlkK/nlKjnirbmgIFcbiAgICovXG4gIHB1YmxpYyBnZXQgaXNHbG9iYWxTY3JpcHRFbmFibGVkKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLnNjcmlwdERhdGEuaXNHbG9iYWxTY3JpcHRFbmFibGVkO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluinkuiJsuiEmuacrOWQr+eUqOeKtuaAgVxuICAgKi9cbiAgcHVibGljIGdldCBpc0NoYXJhY3RlclNjcmlwdEVuYWJsZWQoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuc2NyaXB0RGF0YS5pc0NoYXJhY3RlclNjcmlwdEVuYWJsZWQ7XG4gIH1cblxuICAvKipcbiAgICog5qC55o2uSUTojrflj5bohJrmnKxcbiAgICogQHBhcmFtIGlkIOiEmuacrElEXG4gICAqL1xuICBwdWJsaWMgZ2V0U2NyaXB0QnlJZChpZDogc3RyaW5nKTogU2NyaXB0IHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5zY3JpcHREYXRhLmdldFNjcmlwdEJ5SWQoaWQpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluWFqOWxgOiEmuacrOS7k+W6k+mhue+8iOWMheWQq+aWh+S7tuWkuee7k+aehO+8iVxuICAgKi9cbiAgcHVibGljIGdldEdsb2JhbFJlcG9zaXRvcnlJdGVtcygpOiBTY3JpcHRSZXBvc2l0b3J5SXRlbVtdIHtcbiAgICByZXR1cm4gdGhpcy5zY3JpcHREYXRhLmdldEdsb2JhbFJlcG9zaXRvcnlJdGVtcygpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluinkuiJsuiEmuacrOS7k+W6k+mhue+8iOWMheWQq+aWh+S7tuWkuee7k+aehO+8iVxuICAgKi9cbiAgcHVibGljIGdldENoYXJhY3RlclJlcG9zaXRvcnlJdGVtcygpOiBTY3JpcHRSZXBvc2l0b3J5SXRlbVtdIHtcbiAgICByZXR1cm4gdGhpcy5zY3JpcHREYXRhLmdldENoYXJhY3RlclJlcG9zaXRvcnlJdGVtcygpO1xuICB9XG5cbiAgLyoqXG4gICAqIOWIm+W7uuaWh+S7tuWkuVxuICAgKi9cbiAgcHVibGljIGFzeW5jIGNyZWF0ZUZvbGRlcihuYW1lOiBzdHJpbmcsIHR5cGU6IFNjcmlwdFR5cGUsIGljb24/OiBzdHJpbmcsIGNvbG9yPzogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5zY3JpcHREYXRhLmNyZWF0ZUZvbGRlcihuYW1lLCB0eXBlLCBpY29uLCBjb2xvcik7XG4gIH1cblxuICAvKipcbiAgICog6YeN5ZG95ZCN5paH5Lu25aS5XG4gICAqL1xuICBwdWJsaWMgYXN5bmMgZWRpdEZvbGRlcihcbiAgICBmb2xkZXJJZDogc3RyaW5nLFxuICAgIG5ld05hbWU6IHN0cmluZyxcbiAgICB0eXBlOiBTY3JpcHRUeXBlLFxuICAgIG5ld0ljb24/OiBzdHJpbmcsXG4gICAgbmV3Q29sb3I/OiBzdHJpbmcsXG4gICk6IFByb21pc2U8dm9pZD4ge1xuICAgIGF3YWl0IHRoaXMuc2NyaXB0RGF0YS5lZGl0Rm9sZGVyKGZvbGRlcklkLCBuZXdOYW1lLCB0eXBlLCBuZXdJY29uLCBuZXdDb2xvcik7XG4gIH1cblxuICAvKipcbiAgICog5Yig6Zmk5paH5Lu25aS5XG4gICAqL1xuICBwdWJsaWMgYXN5bmMgZGVsZXRlRm9sZGVyKGZvbGRlcklkOiBzdHJpbmcsIHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBhd2FpdCB0aGlzLnNjcmlwdERhdGEuZGVsZXRlRm9sZGVyKGZvbGRlcklkLCB0eXBlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlsIbohJrmnKznp7vliqjliLDmlofku7blpLlcbiAgICovXG4gIHB1YmxpYyBhc3luYyBtb3ZlU2NyaXB0VG9Gb2xkZXIoc2NyaXB0SWQ6IHN0cmluZywgdGFyZ2V0Rm9sZGVySWQ6IHN0cmluZyB8IG51bGwsIHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBhd2FpdCB0aGlzLnNjcmlwdERhdGEubW92ZVNjcmlwdFRvRm9sZGVyKHNjcmlwdElkLCB0YXJnZXRGb2xkZXJJZCwgdHlwZSk7XG4gIH1cblxuICAvKipcbiAgICog5bCG5paH5Lu25aS556e75Yqo5Yiw5YW25LuW57G75Z6LXG4gICAqIEBwYXJhbSBmb2xkZXJJZCDmlofku7blpLlJRFxuICAgKiBAcGFyYW0gZnJvbVR5cGUg5rqQ57G75Z6LXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgbW92ZUZvbGRlcihmb2xkZXJJZDogc3RyaW5nLCBmcm9tVHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHRhcmdldFR5cGUgPSBnZXRPcHBvc2l0ZVNjcmlwdFR5cGUoZnJvbVR5cGUpO1xuXG4gICAgYXdhaXQgdGhpcy5zY3JpcHREYXRhLm1vdmVJdGVtVG9PdGhlclR5cGUoeyB0eXBlOiAnZm9sZGVyJywgaWQ6IGZvbGRlcklkIH0sIGZyb21UeXBlKTtcblxuICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuVUlfUkVGUkVTSCwge1xuICAgICAgYWN0aW9uOiAnZm9sZGVyX21vdmUnLFxuICAgICAgZm9sZGVySWQsXG4gICAgICBmcm9tVHlwZSxcbiAgICAgIHRhcmdldFR5cGUsXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5paH5Lu25aS55Lit55qE6ISa5pysXG4gICAqL1xuICBwdWJsaWMgZ2V0Rm9sZGVyU2NyaXB0cyhmb2xkZXJJZDogc3RyaW5nLCB0eXBlOiBTY3JpcHRUeXBlKTogU2NyaXB0W10ge1xuICAgIHJldHVybiB0aGlzLnNjcmlwdERhdGEuZ2V0Rm9sZGVyU2NyaXB0cyhmb2xkZXJJZCwgdHlwZSk7XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5qC557qn5Yir55qE6ISa5pysXG4gICAqL1xuICBwdWJsaWMgZ2V0Um9vdFNjcmlwdHModHlwZTogU2NyaXB0VHlwZSk6IFNjcmlwdFtdIHtcbiAgICByZXR1cm4gdGhpcy5zY3JpcHREYXRhLmdldFJvb3RTY3JpcHRzKHR5cGUpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluaJgOacieaWh+S7tuWkuVxuICAgKi9cbiAgcHVibGljIGdldEZvbGRlcnModHlwZTogU2NyaXB0VHlwZSk6IFNjcmlwdFJlcG9zaXRvcnlJdGVtW10ge1xuICAgIHJldHVybiB0aGlzLnNjcmlwdERhdGEuZ2V0Rm9sZGVycyh0eXBlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmibnph4/liIfmjaLmlofku7blpLnlhoXmiYDmnInohJrmnKznmoTlkK/nlKjnirbmgIFcbiAgICogQHBhcmFtIGZvbGRlcklkIOaWh+S7tuWkuUlEXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKiBAcGFyYW0gZW5hYmxlIOaYr+WQpuWQr+eUqFxuICAgKi9cbiAgcHVibGljIGFzeW5jIHRvZ2dsZUZvbGRlclNjcmlwdHMoZm9sZGVySWQ6IHN0cmluZywgdHlwZTogU2NyaXB0VHlwZSwgZW5hYmxlOiBib29sZWFuKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHRoaXMuc2NyaXB0RGF0YS50b2dnbGVGb2xkZXJTY3JpcHRzKGZvbGRlcklkLCB0eXBlLCBlbmFibGUpO1xuXG4gICAgICBjb25zdCBzY3JpcHRzID0gdGhpcy5zY3JpcHREYXRhLmdldEZvbGRlclNjcmlwdHMoZm9sZGVySWQsIHR5cGUpO1xuXG4gICAgICBjb25zdCBpc1R5cGVFbmFibGVkID1cbiAgICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyB0aGlzLnNjcmlwdERhdGEuaXNHbG9iYWxTY3JpcHRFbmFibGVkIDogdGhpcy5zY3JpcHREYXRhLmlzQ2hhcmFjdGVyU2NyaXB0RW5hYmxlZDtcblxuICAgICAgaWYgKGlzVHlwZUVuYWJsZWQpIHtcbiAgICAgICAgZm9yIChjb25zdCBzY3JpcHQgb2Ygc2NyaXB0cykge1xuICAgICAgICAgIGlmIChlbmFibGUgJiYgc2NyaXB0LmVuYWJsZWQpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucnVuU2NyaXB0KHNjcmlwdCwgdHlwZSk7XG4gICAgICAgICAgfSBlbHNlIGlmICghZW5hYmxlKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnN0b3BTY3JpcHQoc2NyaXB0LCB0eXBlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5VSV9SRUZSRVNILCB7XG4gICAgICAgIGFjdGlvbjogJ2ZvbGRlcl9zY3JpcHRzX3RvZ2dsZScsXG4gICAgICAgIGZvbGRlcklkLFxuICAgICAgICB0eXBlLFxuICAgICAgICBlbmFibGUsXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nLmVycm9yKGBbU2NyaXB0TWFuYWdlcl0g5om56YeP5YiH5o2i5paH5Lu25aS56ISa5pys54q25oCB5aSx6LSlOiAke2ZvbGRlcklkfWAsIGVycm9yKTtcbiAgICAgIHRvYXN0ci5lcnJvcihg5om56YeP5YiH5o2i5paH5Lu25aS56ISa5pys54q25oCB5aSx6LSlYCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluaWh+S7tuWkueWGheiEmuacrOeahOaVtOS9k+WQr+eUqOeKtuaAgVxuICAgKiBAcGFyYW0gZm9sZGVySWQg5paH5Lu25aS5SURcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwdWJsaWMgZ2V0Rm9sZGVyU2NyaXB0c1N0YXRlKGZvbGRlcklkOiBzdHJpbmcsIHR5cGU6IFNjcmlwdFR5cGUpOiAnYWxsJyB8ICdub25lJyB7XG4gICAgcmV0dXJuIHRoaXMuc2NyaXB0RGF0YS5nZXRGb2xkZXJTY3JpcHRzU3RhdGUoZm9sZGVySWQsIHR5cGUpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluaMh+WumuiEmuacrOeahOaMiemSruaVsOe7hFxuICAgKiBAcGFyYW0gc2NyaXB0SWQg6ISa5pysSURcbiAgICogQHJldHVybnMg5oyJ6ZKu5pWw57uEXG4gICAqL1xuICBwdWJsaWMgZ2V0U2NyaXB0QnV0dG9uKHNjcmlwdElkOiBzdHJpbmcpOiBTY3JpcHRbJ2J1dHRvbnMnXSB7XG4gICAgY29uc3Qgc2NyaXB0ID0gdGhpcy5zY3JpcHREYXRhLmdldFNjcmlwdEJ5SWQoc2NyaXB0SWQpO1xuICAgIGlmICghc2NyaXB0KSB7XG4gICAgICBsb2cud2FybihgW1NjcmlwdE1hbmFnZXJdIOiEmuacrOS4jeWtmOWcqDogJHtzY3JpcHRJZH1gKTtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gICAgcmV0dXJuIHNjcmlwdC5idXR0b25zO1xuICB9XG5cbiAgLyoqXG4gICAqIOS/ruaUueWQjuabtOaWsOiEmuacrOaMiemSru+8iOS7hemHjeW7uuaMiemSru+8jOS4jemHjeWQr+iEmuacrO+8iVxuICAgKiBAcGFyYW0gc2NyaXB0IOiEmuacrOWvueixoVxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHB1YmxpYyBhc3luYyBzZXRTY3JpcHRCdXR0b24oc2NyaXB0OiBTY3JpcHQsIHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBhd2FpdCB0aGlzLnNjcmlwdERhdGEuc2F2ZVNjcmlwdChzY3JpcHQsIHR5cGUpO1xuXG4gICAgaWYgKHNjcmlwdC5lbmFibGVkKSB7XG4gICAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLkJVVFRPTl9SRU1PVkUsIHsgc2NyaXB0SWQ6IHNjcmlwdC5pZCB9KTtcblxuICAgICAgaWYgKHNjcmlwdC5idXR0b25zICYmIHNjcmlwdC5idXR0b25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5CVVRUT05fQURELCB7IHNjcmlwdCB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5oyH5a6a6ISa5pys55qE5Y+Y6YeP5pWw5o2uXG4gICAqIEBwYXJhbSBzY3JpcHRJZCDohJrmnKxJRFxuICAgKiBAcmV0dXJucyDohJrmnKznmoRkYXRh5a2X5q6177yM5aaC5p6c6ISa5pys5LiN5a2Y5Zyo6L+U5Zue56m65a+56LGhXG4gICAqL1xuICBwdWJsaWMgZ2V0U2NyaXB0VmFyaWFibGVzKHNjcmlwdElkOiBzdHJpbmcpOiB7IFtrZXk6IHN0cmluZ106IGFueSB9IHtcbiAgICBjb25zdCBzY3JpcHQgPSB0aGlzLnNjcmlwdERhdGEuZ2V0U2NyaXB0QnlJZChzY3JpcHRJZCk7XG4gICAgaWYgKCFzY3JpcHQpIHtcbiAgICAgIGxvZy53YXJuKGBbU2NyaXB0TWFuYWdlcl0g6ISa5pys5LiN5a2Y5ZyoOiAke3NjcmlwdElkfWApO1xuICAgICAgcmV0dXJuIHt9O1xuICAgIH1cbiAgICByZXR1cm4gc2NyaXB0LmRhdGEgfHwge307XG4gIH1cblxuICAvKipcbiAgICog5pu05paw5oyH5a6a6ISa5pys55qE5Y+Y6YeP5pWw5o2uXG4gICAqIEBwYXJhbSBzY3JpcHRJZCDohJrmnKxJRFxuICAgKiBAcGFyYW0gdmFyaWFibGVzIOaWsOeahOWPmOmHj+aVsOaNrlxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICogQHJldHVybnMg5piv5ZCm5pu05paw5oiQ5YqfXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgdXBkYXRlU2NyaXB0VmFyaWFibGVzKFxuICAgIHNjcmlwdElkOiBzdHJpbmcsXG4gICAgdmFyaWFibGVzOiB7IFtrZXk6IHN0cmluZ106IGFueSB9LFxuICAgIHR5cGU6IFNjcmlwdFR5cGUsXG4gICk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGNvbnN0IHNjcmlwdCA9IHRoaXMuc2NyaXB0RGF0YS5nZXRTY3JpcHRCeUlkKHNjcmlwdElkKTtcbiAgICBpZiAoIXNjcmlwdCkge1xuICAgICAgbG9nLndhcm4oYFtTY3JpcHRNYW5hZ2VyXSDohJrmnKzkuI3lrZjlnKg6ICR7c2NyaXB0SWR9YCk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgc2NyaXB0LmRhdGEgPSB2YXJpYWJsZXM7XG4gICAgYXdhaXQgdGhpcy5zY3JpcHREYXRhLnNhdmVTY3JpcHQoc2NyaXB0LCB0eXBlKTtcblxuICAgIGxvZy5pbmZvKGBbU2NyaXB0TWFuYWdlcl0g5bey5pu05paw6ISa5pys5Y+Y6YePOiAke3NjcmlwdC5uYW1lfWApO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluaJgOacieiEmuacrOeahOWPmOmHj+aVsOaNru+8iOeUqOS6juiwg+ivleWSjOeuoeeQhu+8iVxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICogQHJldHVybnMg5omA5pyJ6ISa5pys55qE5Y+Y6YeP5pWw5o2u5pig5bCEXG4gICAqL1xuICBwdWJsaWMgZ2V0QWxsU2NyaXB0VmFyaWFibGVzKHR5cGU6IFNjcmlwdFR5cGUpOiBNYXA8c3RyaW5nLCB7IFtrZXk6IHN0cmluZ106IGFueSB9PiB7XG4gICAgY29uc3Qgc2NyaXB0cyA9XG4gICAgICB0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCA/IHRoaXMuc2NyaXB0RGF0YS5nZXRHbG9iYWxTY3JpcHRzKCkgOiB0aGlzLnNjcmlwdERhdGEuZ2V0Q2hhcmFjdGVyU2NyaXB0cygpO1xuXG4gICAgY29uc3QgdmFyaWFibGVzTWFwID0gbmV3IE1hcDxzdHJpbmcsIHsgW2tleTogc3RyaW5nXTogYW55IH0+KCk7XG5cbiAgICBzY3JpcHRzLmZvckVhY2goc2NyaXB0ID0+IHtcbiAgICAgIGlmIChzY3JpcHQuZGF0YSAmJiBPYmplY3Qua2V5cyhzY3JpcHQuZGF0YSkubGVuZ3RoID4gMCkge1xuICAgICAgICB2YXJpYWJsZXNNYXAuc2V0KHNjcmlwdC5pZCwgc2NyaXB0LmRhdGEpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHZhcmlhYmxlc01hcDtcbiAgfVxuXG4gIC8qKlxuICAgKiDmuIXnkIbmiYDmnInotYTmupBcbiAgICovXG4gIHB1YmxpYyBhc3luYyBjbGVhbnVwKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGF3YWl0IHRoaXMuZXhlY3V0b3IuY2xlYXJBbGxTY3JpcHRzSWZyYW1lKCk7XG4gIH1cblxuICAvKipcbiAgICog5aSE55CG6ISa5pysSUTlhrLnqoFcbiAgICogQHBhcmFtIHNjcmlwdCDopoHlpITnkIbnmoTohJrmnKxcbiAgICogQHBhcmFtIGV4aXN0aW5nU2NyaXB0IOW3suWtmOWcqOeahOiEmuacrFxuICAgKiBAcGFyYW0gdGFyZ2V0VHlwZSDnm67moIfnsbvlnotcbiAgICogQHBhcmFtIG9wZXJhdGlvblR5cGUg5pON5L2c57G75Z6L77yaJ2ltcG9ydCcgLSDlr7zlhaUsICdtb3ZlJyAtIOenu+WKqFxuICAgKiBAcmV0dXJucyDlpITnkIbnu5PmnpzvvJonbmV3JyAtIOS9v+eUqOaWsElELCAnb3ZlcnJpZGUnIC0g6KaG55uW5bey5pyJ6ISa5pysLCAnY2FuY2VsJyAtIOWPlua2iOaTjeS9nFxuICAgKi9cbiAgcHVibGljIGFzeW5jIGhhbmRsZVNjcmlwdElkQ29uZmxpY3QoXG4gICAgc2NyaXB0OiBTY3JpcHQsXG4gICAgZXhpc3RpbmdTY3JpcHQ6IFNjcmlwdCxcbiAgICB0YXJnZXRUeXBlOiBTY3JpcHRUeXBlLFxuICAgIG9wZXJhdGlvblR5cGU6ICdpbXBvcnQnIHwgJ21vdmUnID0gJ2ltcG9ydCcsXG4gICk6IFByb21pc2U8J25ldycgfCAnb3ZlcnJpZGUnIHwgJ2NhbmNlbCc+IHtcbiAgICBjb25zdCBleGlzdGluZ1NjcmlwdFR5cGUgPSB0aGlzLnNjcmlwdERhdGEuZ2V0U2NyaXB0VHlwZShleGlzdGluZ1NjcmlwdCk7XG4gICAgY29uc3QgZXhpc3RpbmdUeXBlVGV4dCA9IGV4aXN0aW5nU2NyaXB0VHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyAn5YWo5bGA6ISa5pysJyA6ICfop5LoibLohJrmnKwnO1xuICAgIGNvbnN0IHRhcmdldFR5cGVUZXh0ID0gdGFyZ2V0VHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyAn5YWo5bGA6ISa5pysJyA6ICfop5LoibLohJrmnKwnO1xuXG4gICAgbGV0IG1lc3NhZ2U6IHN0cmluZztcbiAgICBpZiAob3BlcmF0aW9uVHlwZSA9PT0gJ2ltcG9ydCcpIHtcbiAgICAgIG1lc3NhZ2UgPSBg6KaB5a+85YWl55qE6ISa5pysICcke3NjcmlwdC5uYW1lfScg5LiOJHtleGlzdGluZ1R5cGVUZXh0feW6k+S4reeahCAnJHtleGlzdGluZ1NjcmlwdC5uYW1lfScgaWQg55u45ZCM77yM5piv5ZCm6KaB57un57ut5pON5L2c77yfYDtcbiAgICB9IGVsc2Uge1xuICAgICAgbWVzc2FnZSA9IGDopoHnp7vliqjliLAke3RhcmdldFR5cGVUZXh0feW6k+eahOiEmuacrCAnJHtzY3JpcHQubmFtZX0nIOS4juebruagh+W6k+S4reeahCAnJHtleGlzdGluZ1NjcmlwdC5uYW1lfScgaWQg55u45ZCM77yM5piv5ZCm6KaB57un57ut5pON5L2c77yfYDtcbiAgICB9XG5cbiAgICBjb25zdCBpbnB1dCA9IGF3YWl0IGNhbGxHZW5lcmljUG9wdXAobWVzc2FnZSwgUE9QVVBfVFlQRS5URVhULCAnJywge1xuICAgICAgb2tCdXR0b246ICfopobnm5bljp/ohJrmnKwnLFxuICAgICAgY2FuY2VsQnV0dG9uOiAn5Y+W5raIJyxcbiAgICAgIGN1c3RvbUJ1dHRvbnM6IFsn5paw5bu66ISa5pysJ10sXG4gICAgfSk7XG5cbiAgICBsZXQgYWN0aW9uOiAnbmV3JyB8ICdvdmVycmlkZScgfCAnY2FuY2VsJyA9ICdjYW5jZWwnO1xuXG4gICAgc3dpdGNoIChpbnB1dCkge1xuICAgICAgY2FzZSAwOlxuICAgICAgICBhY3Rpb24gPSAnY2FuY2VsJztcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDE6XG4gICAgICAgIGFjdGlvbiA9ICdvdmVycmlkZSc7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAyOlxuICAgICAgICBhY3Rpb24gPSAnbmV3JztcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgcmV0dXJuIGFjdGlvbjtcbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/component/script_repository/script_controller.ts\n\n}")},"./src/component/script_repository/types.ts":
/*!**************************************************!*\
  !*** ./src/component/script_repository/types.ts ***!
  \**************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Script: () => (/* binding */ Script),\n/* harmony export */   ScriptType: () => (/* binding */ ScriptType),\n/* harmony export */   defaultScriptSettings: () => (/* binding */ defaultScriptSettings),\n/* harmony export */   extractScriptsFromRepository: () => (/* binding */ extractScriptsFromRepository),\n/* harmony export */   getBatchControlsSelector: () => (/* binding */ getBatchControlsSelector),\n/* harmony export */   getOppositeScriptType: () => (/* binding */ getOppositeScriptType),\n/* harmony export */   getScriptListSelector: () => (/* binding */ getScriptListSelector),\n/* harmony export */   getScriptToggleSelector: () => (/* binding */ getScriptToggleSelector),\n/* harmony export */   isScript: () => (/* binding */ isScript),\n/* harmony export */   isScriptRepositoryItem: () => (/* binding */ isScriptRepositoryItem),\n/* harmony export */   migrateScriptsToRepositoryItems: () => (/* binding */ migrateScriptsToRepositoryItems)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n\nclass Script {\n    id;\n    name;\n    content;\n    info;\n    buttons;\n    data;\n    enabled;\n    constructor(data) {\n        this.id = data?.id && data.id.trim() !== '' ? data.id : (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_0__.uuidv4)();\n        this.name = data?.name || '';\n        this.content = data?.content || '';\n        this.info = data?.info || '';\n        this.enabled = data?.enabled || false;\n        this.buttons = data?.buttons || [];\n        this.data = data?.data || {};\n    }\n}\nvar ScriptType;\n(function (ScriptType) {\n    ScriptType[\"GLOBAL\"] = \"global\";\n    ScriptType[\"CHARACTER\"] = \"character\";\n})(ScriptType || (ScriptType = {}));\nconst defaultScriptSettings = {\n    global_script_enabled: true,\n    scriptsRepository: [],\n    characters_with_scripts: [],\n};\nfunction isScriptRepositoryItem(item) {\n    return item && typeof item === 'object' && 'type' in item && 'value' in item;\n}\nfunction isScript(item) {\n    return item && typeof item === 'object' && 'id' in item && 'name' in item && 'content' in item;\n}\nfunction migrateScriptsToRepositoryItems(scripts) {\n    return scripts.map(script => ({\n        type: 'script',\n        value: script,\n    }));\n}\nfunction extractScriptsFromRepository(repository) {\n    const scripts = [];\n    for (const item of repository) {\n        if (isScript(item)) {\n            scripts.push(item);\n        }\n        else if (isScriptRepositoryItem(item)) {\n            if (item.type === 'script') {\n                scripts.push(item.value);\n            }\n            else if (item.type === 'folder') {\n                const folderScripts = item.value;\n                scripts.push(...folderScripts);\n            }\n        }\n    }\n    return scripts;\n}\n/**\n * 获取相对的脚本类型（全局<->角色）\n * @param type 当前脚本类型\n * @returns 相对的脚本类型\n */\nfunction getOppositeScriptType(type) {\n    return type === ScriptType.GLOBAL ? ScriptType.CHARACTER : ScriptType.GLOBAL;\n}\n/**\n * 获取脚本列表容器的选择器\n * @param type 脚本类型\n * @returns 容器选择器字符串\n */\nfunction getScriptListSelector(type) {\n    return type === ScriptType.GLOBAL ? '#global-script-list' : '#character-script-list';\n}\n/**\n * 获取批量控制器的选择器\n * @param type 脚本类型\n * @returns 批量控制器选择器字符串\n */\nfunction getBatchControlsSelector(type) {\n    return type === ScriptType.GLOBAL ? '#global-batch-controls' : '#character-batch-controls';\n}\n/**\n * 获取脚本类型切换器的选择器\n * @param type 脚本类型\n * @returns 切换器选择器字符串\n */\nfunction getScriptToggleSelector(type) {\n    return type === ScriptType.GLOBAL ? '#global-script-enable-toggle' : '#character-script-enable-toggle';\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3R5cGVzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFvRDtBQUU3QyxNQUFNLE1BQU07SUFDakIsRUFBRSxDQUFTO0lBQ1gsSUFBSSxDQUFTO0lBQ2IsT0FBTyxDQUFTO0lBQ2hCLElBQUksQ0FBUztJQUNiLE9BQU8sQ0FBdUM7SUFDOUMsSUFBSSxDQUFrQztJQUN0QyxPQUFPLENBQVU7SUFFakIsWUFBWSxJQUFzQjtRQUNoQyxJQUFJLENBQUMsRUFBRSxHQUFHLElBQUksRUFBRSxFQUFFLElBQUksSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLGtFQUFNLEVBQUUsQ0FBQztRQUNqRSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksRUFBRSxJQUFJLElBQUksRUFBRSxDQUFDO1FBQzdCLElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxFQUFFLE9BQU8sSUFBSSxFQUFFLENBQUM7UUFDbkMsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLEVBQUUsSUFBSSxJQUFJLEVBQUUsQ0FBQztRQUM3QixJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksRUFBRSxPQUFPLElBQUksS0FBSyxDQUFDO1FBQ3RDLElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxFQUFFLE9BQU8sSUFBSSxFQUFFLENBQUM7UUFDbkMsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLEVBQUUsSUFBSSxJQUFJLEVBQUUsQ0FBQztJQUMvQixDQUFDO0NBQ0Y7QUFZRCxJQUFZLFVBR1g7QUFIRCxXQUFZLFVBQVU7SUFDcEIsK0JBQWlCO0lBQ2pCLHFDQUF1QjtBQUN6QixDQUFDLEVBSFcsVUFBVSxLQUFWLFVBQVUsUUFHckI7QUFFTSxNQUFNLHFCQUFxQixHQUFHO0lBQ25DLHFCQUFxQixFQUFFLElBQUk7SUFDM0IsaUJBQWlCLEVBQUUsRUFBdUM7SUFDMUQsdUJBQXVCLEVBQUUsRUFBYztDQUN4QyxDQUFDO0FBT0ssU0FBUyxzQkFBc0IsQ0FBQyxJQUFTO0lBQzlDLE9BQU8sSUFBSSxJQUFJLE9BQU8sSUFBSSxLQUFLLFFBQVEsSUFBSSxNQUFNLElBQUksSUFBSSxJQUFJLE9BQU8sSUFBSSxJQUFJLENBQUM7QUFDL0UsQ0FBQztBQUVNLFNBQVMsUUFBUSxDQUFDLElBQVM7SUFDaEMsT0FBTyxJQUFJLElBQUksT0FBTyxJQUFJLEtBQUssUUFBUSxJQUFJLElBQUksSUFBSSxJQUFJLElBQUksTUFBTSxJQUFJLElBQUksSUFBSSxTQUFTLElBQUksSUFBSSxDQUFDO0FBQ2pHLENBQUM7QUFFTSxTQUFTLCtCQUErQixDQUFDLE9BQWlCO0lBQy9ELE9BQU8sT0FBTyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDNUIsSUFBSSxFQUFFLFFBQVE7UUFDZCxLQUFLLEVBQUUsTUFBTTtLQUNkLENBQUMsQ0FBQyxDQUFDO0FBQ04sQ0FBQztBQUVNLFNBQVMsNEJBQTRCLENBQUMsVUFBNkM7SUFDeEYsTUFBTSxPQUFPLEdBQWEsRUFBRSxDQUFDO0lBRTdCLEtBQUssTUFBTSxJQUFJLElBQUksVUFBVSxFQUFFLENBQUM7UUFDOUIsSUFBSSxRQUFRLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQztZQUNuQixPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3JCLENBQUM7YUFBTSxJQUFJLHNCQUFzQixDQUFDLElBQUksQ0FBQyxFQUFFLENBQUM7WUFDeEMsSUFBSSxJQUFJLENBQUMsSUFBSSxLQUFLLFFBQVEsRUFBRSxDQUFDO2dCQUMzQixPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFlLENBQUMsQ0FBQztZQUNyQyxDQUFDO2lCQUFNLElBQUksSUFBSSxDQUFDLElBQUksS0FBSyxRQUFRLEVBQUUsQ0FBQztnQkFDbEMsTUFBTSxhQUFhLEdBQUcsSUFBSSxDQUFDLEtBQWlCLENBQUM7Z0JBQzdDLE9BQU8sQ0FBQyxJQUFJLENBQUMsR0FBRyxhQUFhLENBQUMsQ0FBQztZQUNqQyxDQUFDO1FBQ0gsQ0FBQztJQUNILENBQUM7SUFFRCxPQUFPLE9BQU8sQ0FBQztBQUNqQixDQUFDO0FBRUQ7Ozs7R0FJRztBQUNJLFNBQVMscUJBQXFCLENBQUMsSUFBZ0I7SUFDcEQsT0FBTyxJQUFJLEtBQUssVUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQztBQUMvRSxDQUFDO0FBRUQ7Ozs7R0FJRztBQUNJLFNBQVMscUJBQXFCLENBQUMsSUFBZ0I7SUFDcEQsT0FBTyxJQUFJLEtBQUssVUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMscUJBQXFCLENBQUMsQ0FBQyxDQUFDLHdCQUF3QixDQUFDO0FBQ3ZGLENBQUM7QUFFRDs7OztHQUlHO0FBQ0ksU0FBUyx3QkFBd0IsQ0FBQyxJQUFnQjtJQUN2RCxPQUFPLElBQUksS0FBSyxVQUFVLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDLENBQUMsMkJBQTJCLENBQUM7QUFDN0YsQ0FBQztBQUVEOzs7O0dBSUc7QUFDSSxTQUFTLHVCQUF1QixDQUFDLElBQWdCO0lBQ3RELE9BQU8sSUFBSSxLQUFLLFVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLDhCQUE4QixDQUFDLENBQUMsQ0FBQyxpQ0FBaUMsQ0FBQztBQUN6RyxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBvbmVudC9zY3JpcHRfcmVwb3NpdG9yeS90eXBlcy50cz8zOTNiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHV1aWR2NCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3V0aWxzJztcblxuZXhwb3J0IGNsYXNzIFNjcmlwdCB7XG4gIGlkOiBzdHJpbmc7XG4gIG5hbWU6IHN0cmluZztcbiAgY29udGVudDogc3RyaW5nO1xuICBpbmZvOiBzdHJpbmc7XG4gIGJ1dHRvbnM6IHsgbmFtZTogc3RyaW5nOyB2aXNpYmxlOiBib29sZWFuIH1bXTtcbiAgZGF0YTogeyBbdmFyaWFibGVOYW1lOiBzdHJpbmddOiBhbnkgfTtcbiAgZW5hYmxlZDogYm9vbGVhbjtcblxuICBjb25zdHJ1Y3RvcihkYXRhPzogUGFydGlhbDxTY3JpcHQ+KSB7XG4gICAgdGhpcy5pZCA9IGRhdGE/LmlkICYmIGRhdGEuaWQudHJpbSgpICE9PSAnJyA/IGRhdGEuaWQgOiB1dWlkdjQoKTtcbiAgICB0aGlzLm5hbWUgPSBkYXRhPy5uYW1lIHx8ICcnO1xuICAgIHRoaXMuY29udGVudCA9IGRhdGE/LmNvbnRlbnQgfHwgJyc7XG4gICAgdGhpcy5pbmZvID0gZGF0YT8uaW5mbyB8fCAnJztcbiAgICB0aGlzLmVuYWJsZWQgPSBkYXRhPy5lbmFibGVkIHx8IGZhbHNlO1xuICAgIHRoaXMuYnV0dG9ucyA9IGRhdGE/LmJ1dHRvbnMgfHwgW107XG4gICAgdGhpcy5kYXRhID0gZGF0YT8uZGF0YSB8fCB7fTtcbiAgfVxufVxuXG5cbmV4cG9ydCBpbnRlcmZhY2UgU2NyaXB0UmVwb3NpdG9yeUl0ZW0ge1xuICB0eXBlOiAnZm9sZGVyJyB8ICdzY3JpcHQnO1xuICBpZD86IHN0cmluZztcbiAgbmFtZT86IHN0cmluZztcbiAgaWNvbj86IHN0cmluZztcbiAgY29sb3I/OiBzdHJpbmc7XG4gIHZhbHVlOiBTY3JpcHRbXSB8IFNjcmlwdDtcbn1cblxuZXhwb3J0IGVudW0gU2NyaXB0VHlwZSB7XG4gIEdMT0JBTCA9ICdnbG9iYWwnLFxuICBDSEFSQUNURVIgPSAnY2hhcmFjdGVyJyxcbn1cblxuZXhwb3J0IGNvbnN0IGRlZmF1bHRTY3JpcHRTZXR0aW5ncyA9IHtcbiAgZ2xvYmFsX3NjcmlwdF9lbmFibGVkOiB0cnVlLFxuICBzY3JpcHRzUmVwb3NpdG9yeTogW10gYXMgKFNjcmlwdCB8IFNjcmlwdFJlcG9zaXRvcnlJdGVtKVtdLFxuICBjaGFyYWN0ZXJzX3dpdGhfc2NyaXB0czogW10gYXMgc3RyaW5nW10sXG59O1xuXG5leHBvcnQgaW50ZXJmYWNlIElGcmFtZUVsZW1lbnQgZXh0ZW5kcyBIVE1MSUZyYW1lRWxlbWVudCB7XG4gIGNsZWFudXA6ICgpID0+IHZvaWQ7XG4gIFtwcm9wOiBzdHJpbmddOiBhbnk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1NjcmlwdFJlcG9zaXRvcnlJdGVtKGl0ZW06IGFueSk6IGl0ZW0gaXMgU2NyaXB0UmVwb3NpdG9yeUl0ZW0ge1xuICByZXR1cm4gaXRlbSAmJiB0eXBlb2YgaXRlbSA9PT0gJ29iamVjdCcgJiYgJ3R5cGUnIGluIGl0ZW0gJiYgJ3ZhbHVlJyBpbiBpdGVtO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNTY3JpcHQoaXRlbTogYW55KTogaXRlbSBpcyBTY3JpcHQge1xuICByZXR1cm4gaXRlbSAmJiB0eXBlb2YgaXRlbSA9PT0gJ29iamVjdCcgJiYgJ2lkJyBpbiBpdGVtICYmICduYW1lJyBpbiBpdGVtICYmICdjb250ZW50JyBpbiBpdGVtO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbWlncmF0ZVNjcmlwdHNUb1JlcG9zaXRvcnlJdGVtcyhzY3JpcHRzOiBTY3JpcHRbXSk6IFNjcmlwdFJlcG9zaXRvcnlJdGVtW10ge1xuICByZXR1cm4gc2NyaXB0cy5tYXAoc2NyaXB0ID0+ICh7XG4gICAgdHlwZTogJ3NjcmlwdCcsXG4gICAgdmFsdWU6IHNjcmlwdCxcbiAgfSkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZXh0cmFjdFNjcmlwdHNGcm9tUmVwb3NpdG9yeShyZXBvc2l0b3J5OiAoU2NyaXB0IHwgU2NyaXB0UmVwb3NpdG9yeUl0ZW0pW10pOiBTY3JpcHRbXSB7XG4gIGNvbnN0IHNjcmlwdHM6IFNjcmlwdFtdID0gW107XG5cbiAgZm9yIChjb25zdCBpdGVtIG9mIHJlcG9zaXRvcnkpIHtcbiAgICBpZiAoaXNTY3JpcHQoaXRlbSkpIHtcbiAgICAgIHNjcmlwdHMucHVzaChpdGVtKTtcbiAgICB9IGVsc2UgaWYgKGlzU2NyaXB0UmVwb3NpdG9yeUl0ZW0oaXRlbSkpIHtcbiAgICAgIGlmIChpdGVtLnR5cGUgPT09ICdzY3JpcHQnKSB7XG4gICAgICAgIHNjcmlwdHMucHVzaChpdGVtLnZhbHVlIGFzIFNjcmlwdCk7XG4gICAgICB9IGVsc2UgaWYgKGl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicpIHtcbiAgICAgICAgY29uc3QgZm9sZGVyU2NyaXB0cyA9IGl0ZW0udmFsdWUgYXMgU2NyaXB0W107XG4gICAgICAgIHNjcmlwdHMucHVzaCguLi5mb2xkZXJTY3JpcHRzKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gc2NyaXB0cztcbn1cblxuLyoqXG4gKiDojrflj5bnm7jlr7nnmoTohJrmnKznsbvlnovvvIjlhajlsYA8LT7op5LoibLvvIlcbiAqIEBwYXJhbSB0eXBlIOW9k+WJjeiEmuacrOexu+Wei1xuICogQHJldHVybnMg55u45a+555qE6ISa5pys57G75Z6LXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRPcHBvc2l0ZVNjcmlwdFR5cGUodHlwZTogU2NyaXB0VHlwZSk6IFNjcmlwdFR5cGUge1xuICByZXR1cm4gdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyBTY3JpcHRUeXBlLkNIQVJBQ1RFUiA6IFNjcmlwdFR5cGUuR0xPQkFMO1xufVxuXG4vKipcbiAqIOiOt+WPluiEmuacrOWIl+ihqOWuueWZqOeahOmAieaLqeWZqFxuICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gKiBAcmV0dXJucyDlrrnlmajpgInmi6nlmajlrZfnrKbkuLJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFNjcmlwdExpc3RTZWxlY3Rvcih0eXBlOiBTY3JpcHRUeXBlKTogc3RyaW5nIHtcbiAgcmV0dXJuIHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMID8gJyNnbG9iYWwtc2NyaXB0LWxpc3QnIDogJyNjaGFyYWN0ZXItc2NyaXB0LWxpc3QnO1xufVxuXG4vKipcbiAqIOiOt+WPluaJuemHj+aOp+WItuWZqOeahOmAieaLqeWZqFxuICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gKiBAcmV0dXJucyDmibnph4/mjqfliLblmajpgInmi6nlmajlrZfnrKbkuLJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEJhdGNoQ29udHJvbHNTZWxlY3Rvcih0eXBlOiBTY3JpcHRUeXBlKTogc3RyaW5nIHtcbiAgcmV0dXJuIHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMID8gJyNnbG9iYWwtYmF0Y2gtY29udHJvbHMnIDogJyNjaGFyYWN0ZXItYmF0Y2gtY29udHJvbHMnO1xufVxuXG4vKipcbiAqIOiOt+WPluiEmuacrOexu+Wei+WIh+aNouWZqOeahOmAieaLqeWZqFxuICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gKiBAcmV0dXJucyDliIfmjaLlmajpgInmi6nlmajlrZfnrKbkuLJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFNjcmlwdFRvZ2dsZVNlbGVjdG9yKHR5cGU6IFNjcmlwdFR5cGUpOiBzdHJpbmcge1xuICByZXR1cm4gdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyAnI2dsb2JhbC1zY3JpcHQtZW5hYmxlLXRvZ2dsZScgOiAnI2NoYXJhY3Rlci1zY3JpcHQtZW5hYmxlLXRvZ2dsZSc7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/component/script_repository/types.ts\n\n}")},"./src/component/script_repository/ui_controller.ts":
/*!**********************************************************!*\
  !*** ./src/component/script_repository/ui_controller.ts ***!
  \**********************************************************/(module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   UIController: () => (/* binding */ UIController)\n/* harmony export */ });\n/* harmony import */ var _component_script_repository_builtin_scripts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/script_repository/builtin_scripts */ \"./src/component/script_repository/builtin_scripts.ts\");\n/* harmony import */ var _component_script_repository_button__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/component/script_repository/button */ \"./src/component/script_repository/button.ts\");\n/* harmony import */ var _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/component/script_repository/events */ \"./src/component/script_repository/events.ts\");\n/* harmony import */ var _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/component/script_repository/script_controller */ \"./src/component/script_repository/script_controller.ts\");\n/* harmony import */ var _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/component/script_repository/types */ \"./src/component/script_repository/types.ts\");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _util_render_markdown__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/util/render_markdown */ \"./src/util/render_markdown.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @sillytavern/scripts/popup */ \"@sillytavern/scripts/popup\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_11__);\n/* harmony import */ var yaml__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! yaml */ \"yaml\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([yaml__WEBPACK_IMPORTED_MODULE_12__]);\nyaml__WEBPACK_IMPORTED_MODULE_12__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n/* harmony import */ var yaml__WEBPACK_IMPORTED_MODULE_12___default = /*#__PURE__*/__webpack_require__.n(yaml__WEBPACK_IMPORTED_MODULE_12__);\n\n\n\n\n\n\n\n\n\n\n\n\n\nclass UIController {\n    static instance;\n    scriptManager;\n    buttonManager;\n    templatePath;\n    baseTemplate = null;\n    defaultScriptTemplate = null;\n    folderTemplate = null;\n    batchModeGlobal = false;\n    batchModeCharacter = false;\n    constructor() {\n        this.scriptManager = _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_3__.ScriptManager.getInstance();\n        this.buttonManager = new _component_script_repository_button__WEBPACK_IMPORTED_MODULE_1__.ButtonManager();\n        this.templatePath = `${_util_extension_variables__WEBPACK_IMPORTED_MODULE_5__.extensionFolderPath}/src/component/script_repository/public`;\n    }\n    /**\n     * 获取UI控制器实例\n     */\n    static getInstance() {\n        if (!UIController.instance) {\n            UIController.instance = new UIController();\n        }\n        return UIController.instance;\n    }\n    /**\n     * 销毁UI控制器实例\n     */\n    static destroyInstance() {\n        if (UIController.instance) {\n            UIController.instance.cleanup();\n            UIController.instance = undefined;\n        }\n    }\n    /**\n     * 清理资源\n     */\n    cleanup() {\n        this.buttonManager.clearButtons();\n        this.baseTemplate = null;\n        this.defaultScriptTemplate = null;\n        this.folderTemplate = null;\n    }\n    /**\n     * 初始化UI\n     */\n    async initialize() {\n        await this.initializeTemplates();\n        this.setupScriptRepositoryEvents();\n        this.registerEventListeners();\n        await this.renderScriptLists();\n        (0,_component_script_repository_button__WEBPACK_IMPORTED_MODULE_1__.initScriptButton)();\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_LOADED);\n    }\n    /**\n     * 初始化模板\n     */\n    async initializeTemplates() {\n        this.baseTemplate = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_8__.renderExtensionTemplateAsync)(this.templatePath, 'script_item_template', {\n            scriptName: '',\n            id: '',\n            moveTo: '',\n            faIcon: '',\n        }));\n        this.defaultScriptTemplate = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_8__.renderExtensionTemplateAsync)(this.templatePath, 'script_default_repository', {\n            scriptName: '',\n            id: '',\n        }));\n        this.folderTemplate = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_8__.renderExtensionTemplateAsync)(this.templatePath, 'folder_template', {\n            folderId: '',\n            folderName: '',\n            folderIcon: 'fa-folder',\n            folderColor: document.documentElement.style.getPropertyValue('--SmartThemeBodyColor'),\n        }));\n    }\n    /**\n     * 初始化脚本库界面事件\n     */\n    setupScriptRepositoryEvents() {\n        $('#global-script-enable-toggle')\n            .prop('checked', this.scriptManager.isGlobalScriptEnabled)\n            .on('click', (event) => {\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.TYPE_TOGGLE, {\n                type: _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL,\n                enable: event.target.checked,\n                userInput: true,\n            });\n        });\n        $('#character-script-enable-toggle')\n            .prop('checked', this.scriptManager.isCharacterScriptEnabled)\n            .on('click', (event) => {\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.TYPE_TOGGLE, {\n                type: _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.CHARACTER,\n                enable: event.target.checked,\n                userInput: true,\n            });\n        });\n        $('#create-script').on('click', async () => {\n            await this.showCreateScriptDialog();\n        });\n        $('#import-script-file').on('change', async function () {\n            let target = 'global';\n            const template = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_8__.renderExtensionTemplateAsync)(`${_util_extension_variables__WEBPACK_IMPORTED_MODULE_5__.extensionFolderPath}/src/component/script_repository/public`, 'script_target_selector', {\n                title: '导入到:',\n                prefix: 'script-import',\n                globalLabel: '全局脚本',\n                characterLabel: '局部脚本',\n            }));\n            template.find('#script-import-target-global').on('input', () => (target = 'global'));\n            template.find('#script-import-target-character').on('input', () => (target = 'character'));\n            const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.callGenericPopup)(template, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.POPUP_TYPE.CONFIRM, '', {\n                okButton: '确认',\n                cancelButton: '取消',\n            });\n            if (result) {\n                const inputElement = this instanceof HTMLInputElement && this;\n                if (inputElement && inputElement.files) {\n                    for (const file of inputElement.files) {\n                        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.SCRIPT_IMPORT, {\n                            file,\n                            type: target === 'global' ? _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL : _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.CHARACTER,\n                        });\n                    }\n                    inputElement.value = '';\n                }\n            }\n        });\n        $('#import-script').on('click', function () {\n            $('#import-script-file').trigger('click');\n        });\n        $('#create-folder').on('click', () => {\n            this.showCreateFolderDialog();\n        });\n        $('#default-script').on('click', () => {\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, { action: 'load_default_scripts' });\n        });\n        $('#extensions_settings').css('min-width', '0');\n        this.setupSearchEvents();\n        this.setupBatchOperationEvents();\n    }\n    /**\n     * 注册事件监听器\n     */\n    registerEventListeners() {\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, async (data) => {\n            const { action } = data;\n            switch (action) {\n                case 'script_toggle':\n                    await this.refreshScriptState(data.script, data.enable);\n                    this.updateParentFolderToggle(data.script.id, data.type);\n                    break;\n                case 'type_toggle':\n                    await this.refreshTypeState(data.type, data.enable);\n                    break;\n                case 'script_import':\n                    await this.addScriptToContainer(data.script, data.type);\n                    break;\n                case 'script_create':\n                    await this.addScriptToContainer(data.script, data.type);\n                    break;\n                case 'script_update':\n                    this.updateScriptUI(data.script, data.type);\n                    break;\n                case 'script_delete':\n                    this.removeScriptElement(data.scriptId);\n                    break;\n                case 'script_move':\n                    this.handleScriptMoved(data.script, data.fromType, data.targetType);\n                    break;\n                case 'folder_move':\n                    await this.renderScriptLists();\n                    break;\n                case 'folder_scripts_toggle':\n                    this.updateFolderAndScriptsUI(data.folderId, data.type, data.enable);\n                    break;\n                case 'load_default_scripts':\n                    await this.loadDefaultScriptsRepository();\n                    break;\n                case 'refresh_global_scripts':\n                    await this.refreshScriptList(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL);\n                    break;\n                case 'refresh_charact_scripts':\n                    await this.refreshScriptList(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.CHARACTER);\n                    break;\n                default:\n                    loglevel__WEBPACK_IMPORTED_MODULE_11___default().warn(`[ScriptManager] 未处理的UI刷新事件: ${action}`);\n            }\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.BUTTON_ADD, data => {\n            const { script } = data;\n            this.addButton(script);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.BUTTON_REMOVE, data => {\n            const { scriptId } = data;\n            this.buttonManager.removeButtonsByScriptId(scriptId);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.SCRIPT_EDIT, async (data) => {\n            const { type, scriptId } = data;\n            await this.openScriptEditor(type, scriptId);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.FOLDER_CREATE, async (data) => {\n            const { name, type, icon, color } = data;\n            await this.handleFolderCreate(name, type, icon, color);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.FOLDER_EDIT, async (data) => {\n            const { folderId, newName, type, newIcon, newColor } = data;\n            await this.handleFolderEdit(folderId, newName, type, newIcon, newColor);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.FOLDER_DELETE, async (data) => {\n            const { folderId, type } = data;\n            await this.handleFolderDelete(folderId, type);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.FOLDER_SCRIPTS_TOGGLE, async (data) => {\n            const { folderId, type, enable } = data;\n            await this.handleFolderScriptsToggle(folderId, type, enable);\n        });\n    }\n    /**\n     * 添加按钮\n     * @param script 脚本\n     */\n    addButton(script) {\n        if (script.buttons && script.buttons.length > 0) {\n            this.buttonManager.addButtonsForScript(script);\n        }\n    }\n    /**\n     * 渲染脚本列表\n     */\n    async renderScriptLists() {\n        this.clearScriptList(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL);\n        this.clearScriptList(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.CHARACTER);\n        await this.renderRepository(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL);\n        await this.renderRepository(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.CHARACTER);\n    }\n    /**\n     * 渲染指定类型的脚本仓库\n     * @param type 脚本类型\n     */\n    async renderRepository(type) {\n        const repositoryItems = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL\n            ? this.scriptManager.getGlobalRepositoryItems()\n            : this.scriptManager.getCharacterRepositoryItems();\n        if (repositoryItems.length > 0) {\n            for (const item of repositoryItems) {\n                if (item.type === 'folder') {\n                    await this.renderFolder(item, type);\n                }\n                else {\n                    await this.addScriptToContainer(item.value, type);\n                }\n            }\n        }\n        else {\n            this.showEmptyScriptListTip(type);\n        }\n        this.setupDraggable(type);\n    }\n    /**\n     * 清除指定类型的脚本列表\n     * @param type 脚本类型\n     */\n    clearScriptList(type) {\n        $((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.getScriptListSelector)(type)).empty();\n    }\n    /**\n     * 刷新指定类型的脚本列表\n     * @param type 脚本类型\n     */\n    async refreshScriptList(type) {\n        this.clearScriptList(type);\n        await this.renderRepository(type);\n        const isEnabled = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL\n            ? this.scriptManager.isGlobalScriptEnabled\n            : this.scriptManager.isCharacterScriptEnabled;\n        const toggleSelector = (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.getScriptToggleSelector)(type);\n        $(toggleSelector).prop('checked', isEnabled);\n    }\n    /**\n     * 显示空脚本列表提示\n     * @param type 脚本类型\n     */\n    showEmptyScriptListTip(type) {\n        const container = $((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.getScriptListSelector)(type));\n        if (container.find('small').length === 0) {\n            container.append('<small>暂无脚本</small>');\n        }\n    }\n    /**\n     * 刷新脚本状态\n     * @param script 脚本\n     * @param enable 是否启用\n     */\n    async refreshScriptState(script, enable) {\n        const $script = $(`#${script.id}`);\n        if ($script.length > 0) {\n            if (enable) {\n                $script.find('.script-toggle').addClass('enabled');\n                $script.find('.script-toggle i.fa-toggle-off').hide();\n                $script.find('.script-toggle i.fa-toggle-on').show();\n            }\n            else {\n                $script.find('.script-toggle').removeClass('enabled');\n                $script.find('.script-toggle i.fa-toggle-off').show();\n                $script.find('.script-toggle i.fa-toggle-on').hide();\n            }\n        }\n    }\n    /**\n     * 刷新脚本类型状态\n     * @param type 脚本类型\n     * @param enable 是否启用\n     */\n    async refreshTypeState(type, enable) {\n        const $toggle = $((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.getScriptToggleSelector)(type));\n        $toggle.prop('checked', enable);\n    }\n    /**\n     * 更新文件夹及其内部脚本的UI状态\n     * @param folderId 文件夹ID\n     * @param type 脚本类型\n     * @param enable 是否启用\n     */\n    updateFolderAndScriptsUI(folderId, type, enable) {\n        const $folder = $(`#${folderId}`);\n        if ($folder.length > 0) {\n            this.updateFolderToggleState($folder, folderId, type);\n            const $folderContent = $folder.find('.folder-content');\n            $folderContent.find('.script-item').each((_, element) => {\n                const $script = $(element);\n                const $toggle = $script.find('.script-toggle');\n                if (enable) {\n                    $toggle.addClass('enabled');\n                    $toggle.find('i.fa-toggle-off').hide();\n                    $toggle.find('i.fa-toggle-on').show();\n                }\n                else {\n                    $toggle.removeClass('enabled');\n                    $toggle.find('i.fa-toggle-off').show();\n                    $toggle.find('i.fa-toggle-on').hide();\n                }\n            });\n        }\n    }\n    /**\n     * 增量更新脚本UI\n     * @param script 脚本对象\n     * @param type 脚本类型\n     */\n    updateScriptUI(script, type) {\n        const $existingScript = $(`#${CSS.escape(script.id)}`);\n        if ($existingScript.length === 0) {\n            this.addScriptToContainer(script, type);\n            return;\n        }\n        $existingScript.find('.script-item-name').text(script.name);\n        const $toggle = $existingScript.find('.script-toggle');\n        if (script.enabled) {\n            $toggle.addClass('enabled');\n            $toggle.find('i.fa-toggle-off').hide();\n            $toggle.find('i.fa-toggle-on').show();\n        }\n        else {\n            $toggle.removeClass('enabled');\n            $toggle.find('i.fa-toggle-off').show();\n            $toggle.find('i.fa-toggle-on').hide();\n        }\n        const $moveButton = $existingScript.find('.script-storage-location');\n        $moveButton.removeClass('move-to-character move-to-global');\n        $moveButton.addClass(type === 'global' ? 'move-to-character' : 'move-to-global');\n        const $moveIcon = $moveButton.find('i');\n        $moveIcon.removeClass('fa-arrow-down fa-arrow-up');\n        $moveIcon.addClass(type === 'global' ? 'fa-arrow-down' : 'fa-arrow-up');\n        this.rebindScriptEvents($existingScript, script, type);\n    }\n    /**\n     * 重新绑定脚本事件\n     * @param $scriptElement 脚本DOM元素\n     * @param script 脚本对象\n     * @param type 脚本类型\n     */\n    rebindScriptEvents($scriptElement, script, type) {\n        $scriptElement.find('.script-toggle').off('click.scriptToggle');\n        $scriptElement.find('.script-info').off('click.scriptInfo');\n        $scriptElement.find('.edit-script').off('click.scriptEdit');\n        $scriptElement.find('.script-storage-location').off('click.scriptMove');\n        $scriptElement.find('.export-script').off('click.scriptExport');\n        $scriptElement.find('.delete-script').off('click.scriptDelete');\n        const $toggleButton = $scriptElement.find('.script-toggle');\n        $toggleButton.on('click.scriptToggle', function () {\n            const isEnabled = $(this).hasClass('enabled');\n            const newState = !isEnabled;\n            if (newState) {\n                $(this).addClass('enabled');\n                $(this).find('i.fa-toggle-off').hide();\n                $(this).find('i.fa-toggle-on').show();\n            }\n            else {\n                $(this).removeClass('enabled');\n                $(this).find('i.fa-toggle-off').show();\n                $(this).find('i.fa-toggle-on').hide();\n            }\n            script.enabled = newState;\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.SCRIPT_TOGGLE, {\n                script,\n                type,\n                enable: newState,\n                userInput: true,\n            });\n        });\n        $scriptElement.find('.script-info').on('click.scriptInfo', () => {\n            const scriptInfo = script.info || '';\n            const htmlText = (0,_util_render_markdown__WEBPACK_IMPORTED_MODULE_6__.renderMarkdown)(scriptInfo);\n            (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.callGenericPopup)(htmlText, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.POPUP_TYPE.DISPLAY, undefined, { wide: true });\n        });\n        $scriptElement.find('.edit-script').on('click.scriptEdit', e => {\n            e.preventDefault();\n            e.stopPropagation();\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.SCRIPT_EDIT, { type, scriptId: script.id });\n        });\n        $scriptElement.find('.script-storage-location').on('click.scriptMove', () => {\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.SCRIPT_MOVE, { script, fromType: type });\n        });\n        $scriptElement.find('.export-script').on('click.scriptExport', async () => {\n            const fileName = `${script.name.replace(/[\\s.<>:\"/\\\\|?*\\x00-\\x1F\\x7F]/g, '_').toLowerCase()}.json`;\n            const scriptData = await this.checkScriptDataAndGetExportData(script);\n            if (scriptData === null) {\n                return;\n            }\n            const fileData = JSON.stringify(scriptData, null, 2);\n            (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_10__.download)(fileData, fileName, 'application/json');\n        });\n        $scriptElement.find('.delete-script').on('click.scriptDelete', async () => {\n            const confirm = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.callGenericPopup)('确定要删除这个脚本吗？', _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.POPUP_TYPE.CONFIRM);\n            if (!confirm) {\n                return;\n            }\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.SCRIPT_DELETE, { scriptId: script.id, type });\n            $scriptElement.remove();\n        });\n    }\n    /**\n     * 移除脚本元素\n     * @param scriptId 脚本ID\n     */\n    removeScriptElement(scriptId) {\n        $(`#${scriptId}`).remove();\n    }\n    /**\n     * 处理脚本移动\n     * @param script 脚本\n     * @param fromType 源类型\n     * @param targetType 目标类型\n     */\n    handleScriptMoved(script, fromType, targetType) {\n        $(`#${script.id}`).remove();\n        const sourceList = fromType === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL ? $('#global-script-list') : $('#character-script-list');\n        if (sourceList.children().length === 0) {\n            this.showEmptyScriptListTip(fromType);\n        }\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, {\n            action: 'script_import',\n            script,\n            type: targetType,\n        });\n    }\n    /**\n     * 向容器添加脚本元素\n     * @param script 脚本\n     * @param type 脚本类型\n     */\n    async addScriptToContainer(script, type) {\n        const $scriptElement = await this.createScriptElement(script, type);\n        const list = $((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.getScriptListSelector)(type));\n        const $emptyTip = list.find('small');\n        if ($emptyTip.length > 0) {\n            $emptyTip.remove();\n        }\n        list.append($scriptElement);\n    }\n    /**\n     * 设置脚本拖拽排序\n     * @param type 脚本类型\n     */\n    setupDraggable(type) {\n        const list = $((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.getScriptListSelector)(type));\n        list.sortable({\n            delay: (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_10__.getSortableDelay)(),\n            items: '.script-item, .script-folder',\n            handle: '.drag-handle',\n            cursor: 'move',\n            tolerance: 'pointer',\n            placeholder: 'sortable-placeholder',\n            connectWith: '.folder-content',\n            stop: async (_event) => {\n                await this.handleDragStop(type);\n            },\n        });\n        this.setupFolderDropZones(type);\n    }\n    /**\n     * 设置文件夹拖拽功能\n     * @param type 脚本类型\n     */\n    setupFolderDraggable(type) {\n        const list = $((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.getScriptListSelector)(type));\n        list.find('.folder-content').sortable({\n            delay: (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_10__.getSortableDelay)(),\n            items: '.script-item',\n            handle: '.drag-handle',\n            cursor: 'move',\n            tolerance: 'pointer',\n            placeholder: 'sortable-placeholder',\n            connectWith: `${(0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.getScriptListSelector)(type)}, .folder-content`,\n            stop: async (_event) => {\n                await this.handleDragStop(type);\n            },\n        });\n    }\n    /**\n     * 设置文件夹拖拽接收区域\n     * @param type 脚本类型\n     */\n    setupFolderDropZones(type) {\n        const list = $((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.getScriptListSelector)(type));\n        list.find('.script-folder').each((_, folderElement) => {\n            this.setupSingleFolderDropZone($(folderElement), type);\n        });\n    }\n    /**\n     * 为单个文件夹设置拖拽接收区域\n     * @param $folder 文件夹jQuery对象\n     * @param type 脚本类型\n     */\n    setupSingleFolderDropZone($folder, type) {\n        const $folderContent = $folder.find('.folder-content');\n        $folder.off('.dragdrop');\n        $folder.on('dragover dragenter dragleave drop', function (e) {\n            e.preventDefault();\n            e.stopPropagation();\n            return false;\n        });\n        $folder.droppable({\n            accept: '.script-item[data-script-repository=\"true\"]',\n            tolerance: 'pointer',\n            greedy: true,\n            over: (_event, ui) => {\n                if (!ui.draggable.hasClass('script-item') || !ui.draggable.attr('data-script-repository'))\n                    return;\n                const isFromSameFolder = ui.draggable.closest('.script-folder').attr('id') === $folder.attr('id');\n                if (isFromSameFolder)\n                    return;\n                $folder.addClass('folder-drag-target');\n                if (!$folderContent.is(':visible')) {\n                    $folderContent.slideDown(200);\n                    $folder.find('.folder-toggle').addClass('expanded');\n                }\n            },\n            out: (_event, ui) => {\n                if (!ui.draggable.hasClass('script-item') || !ui.draggable.attr('data-script-repository'))\n                    return;\n                const isFromSameFolder = ui.draggable.closest('.script-folder').attr('id') === $folder.attr('id');\n                if (isFromSameFolder)\n                    return;\n                $folder.removeClass('folder-drag-target');\n            },\n            drop: async (event, ui) => {\n                if (event.originalEvent) {\n                    event.originalEvent.preventDefault();\n                    event.originalEvent.stopPropagation();\n                }\n                event.preventDefault();\n                event.stopImmediatePropagation();\n                if (!ui.draggable.hasClass('script-item') || !ui.draggable.attr('data-script-repository'))\n                    return;\n                const scriptId = ui.draggable.attr('id');\n                const folderId = $folder.attr('id');\n                const isFromSameFolder = ui.draggable.closest('.script-folder').attr('id') === folderId;\n                if (isFromSameFolder) {\n                    $folder.removeClass('folder-drag-target');\n                    return false;\n                }\n                if (scriptId && folderId) {\n                    try {\n                        const success = await this.handleScriptDropToFolder(scriptId, folderId, type, ui.draggable);\n                        if (!success) {\n                            $folder.removeClass('folder-drag-target');\n                            setTimeout(async () => {\n                                await this.renderScriptLists();\n                            }, 100);\n                            return false;\n                        }\n                    }\n                    catch (error) {\n                        loglevel__WEBPACK_IMPORTED_MODULE_11___default().error('[ScriptManager] 拖拽脚本到文件夹失败:', error);\n                        toastr.error(`移动脚本失败: ${error instanceof Error ? error.message : String(error)}`);\n                        $folder.removeClass('folder-drag-target');\n                        setTimeout(async () => {\n                            await this.renderScriptLists();\n                        }, 100);\n                        return false;\n                    }\n                }\n                $folder.removeClass('folder-drag-target');\n                return false;\n            },\n        });\n    }\n    /**\n     * 处理脚本拖拽到文件夹的事件\n     * @param scriptId 脚本ID\n     * @param folderId 文件夹ID\n     * @param type 脚本类型\n     * @param $draggedElement 拖拽的元素\n     * @returns 是否成功移动脚本\n     */\n    async handleScriptDropToFolder(scriptId, folderId, type, $draggedElement) {\n        try {\n            const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL\n                ? this.scriptManager.getGlobalRepositoryItems()\n                : this.scriptManager.getCharacterRepositoryItems();\n            const folder = repository.find(item => item.type === 'folder' && item.id === folderId);\n            if (folder) {\n                const scripts = folder.value;\n                const scriptExists = scripts.some(script => script.id === scriptId);\n                if (scriptExists) {\n                    toastr.info('脚本已经在该文件夹中');\n                    return false;\n                }\n            }\n            await this.scriptManager.moveScriptToFolder(scriptId, folderId, type);\n            const $targetFolder = $(`#${folderId}`);\n            const $folderContent = $targetFolder.find('.folder-content');\n            if (!$folderContent.is(':visible')) {\n                $folderContent.show();\n                $targetFolder.find('.folder-toggle').addClass('expanded');\n            }\n            $draggedElement.detach().prependTo($folderContent);\n            return true;\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_11___default().error('[ScriptManager] 移动脚本到文件夹失败:', error);\n            throw error;\n        }\n    }\n    /**\n     * 处理拖拽结束事件\n     * @param ui jQuery UI 拖拽事件对象\n     * @param type 脚本类型\n     */\n    async handleDragStop(type) {\n        try {\n            const repositoryItems = await this.buildRepositoryFromDOM(type);\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.ORDER_CHANGED, {\n                data: repositoryItems,\n                type,\n            });\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_11___default().error('[ScriptManager] handleDragStop: 处理拖拽结束失败:', error);\n        }\n    }\n    /**\n     * 从DOM构建仓库结构\n     * @param type 脚本类型\n     */\n    async buildRepositoryFromDOM(type) {\n        const list = $((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.getScriptListSelector)(type));\n        const repository = [];\n        for (const element of list.children().get()) {\n            const $element = $(element);\n            if ($element.hasClass('script-folder')) {\n                const folderId = $element.attr('id');\n                const folderName = $element.find('.folder-name').text();\n                const folderIcon = $element\n                    .find('.folder-icon i')\n                    .attr('class')\n                    ?.split(' ')\n                    .find(cls => cls.startsWith('fa-')) || 'fa-folder';\n                const folderColor = $element.find('.folder-icon').css('color') ||\n                    document.documentElement.style.getPropertyValue('--SmartThemeBodyColor');\n                const scripts = [];\n                const $folderContent = $element.find('.folder-content');\n                for (const scriptElement of $folderContent.children('.script-item').get()) {\n                    const scriptId = $(scriptElement).attr('id');\n                    const script = this.scriptManager.getScriptById(scriptId);\n                    if (script) {\n                        scripts.push(script);\n                    }\n                }\n                repository.push({\n                    type: 'folder',\n                    id: folderId,\n                    name: folderName,\n                    icon: folderIcon,\n                    color: folderColor,\n                    value: scripts,\n                });\n            }\n            else if ($element.hasClass('script-item')) {\n                const scriptId = $element.attr('id');\n                const script = this.scriptManager.getScriptById(scriptId);\n                if (script) {\n                    repository.push({\n                        type: 'script',\n                        value: script,\n                    });\n                }\n            }\n        }\n        return repository;\n    }\n    /**\n     * 克隆默认脚本模板\n     * @param script 脚本\n     */\n    async cloneDefaultScriptTemplate(script) {\n        if (!this.defaultScriptTemplate) {\n            await this.initializeTemplates();\n        }\n        const scriptHtml = this.defaultScriptTemplate.clone();\n        const tempId = `default_lib_${script.id}`;\n        scriptHtml.attr('id', tempId);\n        scriptHtml.find('.script-item-name').text(script.name);\n        scriptHtml.find('.script-info').on('click', () => {\n            const htmlText = (0,_util_render_markdown__WEBPACK_IMPORTED_MODULE_6__.renderMarkdown)(script.info);\n            (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.callGenericPopup)(htmlText, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.POPUP_TYPE.DISPLAY, undefined, { wide: true });\n        });\n        scriptHtml.find('.add-script').on('click', async () => {\n            let target = _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL;\n            const template = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_8__.renderExtensionTemplateAsync)(this.templatePath, 'script_target_selector', {\n                title: '添加到:',\n                prefix: 'script-add',\n                globalLabel: '全局脚本库',\n                characterLabel: '角色脚本库',\n            }));\n            template.find('#script-add-target-global').on('input', () => (target = _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL));\n            template.find('#script-add-target-character').on('input', () => (target = _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.CHARACTER));\n            const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.callGenericPopup)(template, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.POPUP_TYPE.CONFIRM, '', {\n                okButton: '确认',\n                cancelButton: '取消',\n            });\n            if (!result) {\n                return;\n            }\n            const newScript = new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.Script({ ...script, enabled: false });\n            let action = 'new';\n            const existing_script = this.scriptManager.getScriptById(script.id);\n            if (existing_script) {\n                const input = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.callGenericPopup)(`要导入的脚本 '${script.name}' 与脚本库中的 '${existing_script.name}' id 相同，是否要导入？`, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.POPUP_TYPE.TEXT, '', {\n                    okButton: '覆盖原脚本',\n                    cancelButton: '取消',\n                    customButtons: ['新建脚本'],\n                });\n                switch (input) {\n                    case 0:\n                        action = 'cancel';\n                        break;\n                    case 1:\n                        action = 'override';\n                        break;\n                    case 2:\n                        action = 'new';\n                        break;\n                }\n            }\n            switch (action) {\n                case 'new':\n                    if (existing_script) {\n                        newScript.id = (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_10__.uuidv4)();\n                    }\n                    break;\n                case 'override':\n                    {\n                        if (!existing_script) {\n                            return;\n                        }\n                        $(`#${existing_script.id}`).remove();\n                        if (existing_script.enabled) {\n                            await this.scriptManager.stopScript(existing_script, target);\n                            this.buttonManager.removeButtonsByScriptId(existing_script.id);\n                        }\n                    }\n                    break;\n                case 'cancel':\n                    return;\n            }\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.SCRIPT_CREATE, { script: newScript, type: target });\n            toastr.success(`脚本\"${newScript.name}\"已添加到${target === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL ? '全局' : '角色'}脚本库`);\n        });\n        return scriptHtml;\n    }\n    /**\n     * 创建默认脚本库容器\n     * 避免重复渲染模板\n     */\n    createDefaultScriptContainer() {\n        return $('<div class=\"default-script-repository-container\"></div>');\n    }\n    /**\n     * 加载默认脚本库\n     */\n    async loadDefaultScriptsRepository() {\n        const container = this.createDefaultScriptContainer();\n        const defaultScripts = await (0,_component_script_repository_builtin_scripts__WEBPACK_IMPORTED_MODULE_0__.createDefaultScripts)();\n        for (const script of defaultScripts) {\n            if (!script)\n                continue;\n            const scriptHtml = await this.cloneDefaultScriptTemplate(script);\n            container.append(scriptHtml);\n        }\n        await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.callGenericPopup)(container, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.POPUP_TYPE.DISPLAY, '', { wide: true });\n    }\n    /**\n     * 打开脚本编辑器\n     * @param type 脚本类型\n     * @param scriptId 脚本ID\n     */\n    async openScriptEditor(type, scriptId) {\n        const $editorHtml = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_8__.renderExtensionTemplateAsync)(this.templatePath, 'script_editor'));\n        let script;\n        this.updateVariableListVisibility($editorHtml);\n        if (scriptId) {\n            script = this.scriptManager.getScriptById(scriptId);\n            if (script) {\n                $editorHtml.find('#script-name-input').val(script.name);\n                $editorHtml.find('#script-content-textarea').val(script.content);\n                $editorHtml.find('#script-info-textarea').val(script.info);\n                if (script.data && Object.keys(script.data).length > 0) {\n                    this.loadVariablesToEditor($editorHtml, script.data);\n                }\n                if (script.buttons && script.buttons.length > 0) {\n                    script.buttons.forEach((button, buttonIndex) => {\n                        const $buttonHtml = $(`\n              <div class=\"button-item\" id=\"button-${buttonIndex}\">\n                <span class=\"drag-handle menu-handle\">☰</span>\n                <input type=\"checkbox\" id=\"checkbox-button-${buttonIndex}\" class=\"button-visible\" ${button.visible ? 'checked' : ''}>\n                <input class=\"text_pole button-name\" type=\"text\" id=\"text-button-${buttonIndex}\" value=\"${button.name}\" placeholder=\"按钮名称\">\n                <div class=\"delete-button menu_button interactable\" data-index=\"${buttonIndex}\">\n                  <i class=\"fa-solid fa-trash\"></i>\n                </div>\n              </div>\n            `);\n                        $editorHtml.find('.button-list').append($buttonHtml);\n                    });\n                }\n            }\n        }\n        $editorHtml.find('#add-variable-trigger').on('click', () => {\n            this.addVariableToEditor($editorHtml);\n        });\n        $editorHtml.find('#add-button-trigger').on('click', () => {\n            const buttonIndex = $editorHtml.find('.button-list .button-item').length;\n            const buttonId = `button-${buttonIndex}`;\n            const $buttonContent = $(`<div class=\"button-item\" id=\"${buttonId}\">\n        <span class=\"drag-handle menu-handle\">☰</span>\n        <input type=\"checkbox\" id=\"checkbox-${buttonId}\" class=\"button-visible\" checked>\n        <input class=\"text_pole button-name\" type=\"text\" id=\"text-${buttonId}\" placeholder=\"按钮名称\">\n        <div class=\"delete-button menu_button interactable\" data-index=\"${buttonIndex}\">\n          <i class=\"fa-solid fa-trash\"></i>\n        </div>\n      </div>`);\n            $editorHtml.find('.button-list').append($buttonContent);\n        });\n        $editorHtml.find('#script-button-content .button-list').sortable({\n            handle: '.drag-handle',\n            items: '.button-item',\n        });\n        $editorHtml.on('click', '.delete-button', (e) => {\n            $(e.currentTarget).closest('.button-item').remove();\n        });\n        $editorHtml.on('click', '.delete-variable', (e) => {\n            $(e.currentTarget).closest('.variable-item').remove();\n            this.updateVariableListVisibility($editorHtml);\n        });\n        const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.callGenericPopup)($editorHtml, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.POPUP_TYPE.CONFIRM, '', {\n            wide: true,\n            okButton: '保存',\n            cancelButton: '取消',\n        });\n        if (!result) {\n            return;\n        }\n        const scriptName = String($editorHtml.find('#script-name-input').val());\n        const scriptContent = String($editorHtml.find('#script-content-textarea').val());\n        const scriptInfo = String($editorHtml.find('#script-info-textarea').val());\n        const variableData = this.collectVariablesFromEditor($editorHtml);\n        const buttons = [];\n        $editorHtml.find('.button-list .button-item').each(function () {\n            const buttonName = $(this).find('.button-name').val();\n            const visible = $(this).find('.button-visible').prop('checked');\n            if (buttonName && buttonName.trim() !== '') {\n                buttons.push({ name: buttonName, visible });\n            }\n        });\n        if (!script) {\n            script = new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.Script({\n                id: (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_10__.uuidv4)(),\n                name: scriptName,\n                content: scriptContent,\n                info: scriptInfo,\n                enabled: false,\n                buttons,\n                data: variableData,\n            });\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.SCRIPT_CREATE, { script, type });\n        }\n        else {\n            const wasEnabled = script.enabled;\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.BUTTON_REMOVE, { scriptId: script.id });\n            script.name = scriptName;\n            script.content = scriptContent;\n            script.info = scriptInfo;\n            script.buttons = buttons;\n            script.data = variableData;\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.SCRIPT_UPDATE, { script, type });\n            if (wasEnabled) {\n                try {\n                    await this.scriptManager.stopScript(script, type);\n                    await this.scriptManager.runScript(script, type);\n                }\n                catch (error) {\n                    loglevel__WEBPACK_IMPORTED_MODULE_11___default().error(`[ScriptManager] 重启脚本失败: ${script.name}`, error);\n                    toastr.error(`重启脚本失败: ${script.name}`);\n                }\n            }\n        }\n    }\n    /**\n     * 将变量数据加载到编辑器中\n     * @param $editorHtml 编辑器HTML元素\n     * @param data 变量数据\n     */\n    loadVariablesToEditor($editorHtml, data) {\n        const $variableList = $editorHtml.find('#variable-list');\n        for (const [key, value] of Object.entries(data)) {\n            const $variableItem = this.createVariableItem(key, value);\n            $variableList.append($variableItem);\n        }\n        this.updateVariableListVisibility($editorHtml);\n    }\n    /**\n     * 添加新变量到编辑器\n     * @param $editorHtml 编辑器HTML元素\n     */\n    addVariableToEditor($editorHtml) {\n        const $variableList = $editorHtml.find('#variable-list');\n        const $variableItem = this.createVariableItem('', '');\n        $variableList.append($variableItem);\n        this.updateVariableListVisibility($editorHtml);\n    }\n    /**\n     * 更新变量列表的可见性\n     * @param $editorHtml 编辑器HTML元素\n     */\n    updateVariableListVisibility($editorHtml) {\n        const $variableList = $editorHtml.find('#variable-list');\n        const variableCount = $variableList.find('.variable-item').length;\n        if (variableCount === 0) {\n            $variableList.hide();\n        }\n        else {\n            $variableList.show();\n        }\n    }\n    /**\n     * 创建变量项元素\n     * @param key 变量键\n     * @param value 变量值\n     * @returns JQuery元素\n     */\n    createVariableItem(key, value) {\n        const valueStr = typeof value === 'string' ? value : yaml__WEBPACK_IMPORTED_MODULE_12___default().stringify(value);\n        const $variableItem = $(`\n      <div class=\"variable-item flex-container flexFlowColumn width100p\">\n        <div class=\"flex flexFlowColumn\">\n        <div class=\"flex-container alignitemscenter spaceBetween wide100p\">\n          <div>名称:</div>\n          <div class=\"menu_button interactable delete-variable\" title=\"删除变量\">\n            <i class=\"fa-solid fa-trash\"></i>\n          </div>\n          </div>\n          <input type=\"text\" class=\"text_pole variable-key\" value=\"${this.escapeHtml(key)}\" placeholder=\"变量名\">\n        </div>\n        <div class=\"flex flexFlowColumn\" style=\"align-items: flex-start;\">\n          <div>值:</div>\n          <textarea class=\"text_pole variable-value\" style=\"min-height: 12px;\" rows=\"1\" placeholder=\"请以纯文本或YAML格式输入变量值\">${this.escapeHtml(valueStr)}</textarea>\n        </div>\n      <hr>\n      </div>\n    `);\n        return $variableItem;\n    }\n    /**\n     * 从编辑器收集变量数据\n     * @param $editorHtml 编辑器HTML元素\n     * @returns 变量数据对象\n     */\n    collectVariablesFromEditor($editorHtml) {\n        const variables = {};\n        $editorHtml.find('#variable-list .variable-item').each(function () {\n            const key = $(this).find('.variable-key').val();\n            const valueStr = $(this).find('.variable-value').val();\n            if (key && key.trim() !== '') {\n                let value;\n                try {\n                    value = yaml__WEBPACK_IMPORTED_MODULE_12___default().parse(valueStr);\n                }\n                catch {\n                    value = valueStr;\n                }\n                variables[key.trim()] = value;\n            }\n        });\n        return variables;\n    }\n    /**\n     * HTML转义辅助函数\n     * @param text 要转义的文本\n     * @returns 转义后的文本\n     */\n    escapeHtml(text) {\n        const div = document.createElement('div');\n        div.textContent = text;\n        return div.innerHTML;\n    }\n    /**\n     * 检查角色中的嵌入式脚本\n     * @param characterId 角色id\n     * @param enableableScripts 可启用的脚本列表\n     */\n    async checkEmbeddedScripts(characterId) {\n        const charactersWithScripts = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_5__.getSettingValue)('script.characters_with_scripts') || [];\n        const avatar = _sillytavern_script__WEBPACK_IMPORTED_MODULE_7__.characters[characterId]?.avatar;\n        if (charactersWithScripts.includes(avatar)) {\n            return;\n        }\n        const checkKey = `AlertScript_${avatar}`;\n        if (!localStorage.getItem(checkKey)) {\n            localStorage.setItem(checkKey, 'true');\n            const template = await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_8__.renderExtensionTemplateAsync)(`${_util_extension_variables__WEBPACK_IMPORTED_MODULE_5__.extensionFolderPath}/src/component/script_repository/public`, 'script_allow_popup');\n            const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.callGenericPopup)(template, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.POPUP_TYPE.CONFIRM, '', {\n                okButton: '确认',\n                cancelButton: '取消',\n            });\n            if (result) {\n                if (avatar && !charactersWithScripts.includes(avatar)) {\n                    charactersWithScripts.push(avatar);\n                    (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_5__.saveSettingValue)('script.characters_with_scripts', charactersWithScripts);\n                }\n                $('#character-script-enable-toggle').prop('checked', true);\n                _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.TYPE_TOGGLE, {\n                    type: _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.CHARACTER,\n                    enable: true,\n                    userInput: false,\n                });\n            }\n            else {\n                $('#character-script-enable-toggle').prop('checked', false);\n                _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.TYPE_TOGGLE, {\n                    type: _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.CHARACTER,\n                    enable: false,\n                    userInput: false,\n                });\n            }\n        }\n    }\n    /**\n     * 渲染单个文件夹\n     * @param folderItem 文件夹项\n     * @param type 脚本类型\n     */\n    async renderFolder(folderItem, type) {\n        const container = $((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.getScriptListSelector)(type));\n        if (!this.folderTemplate) {\n            await this.initializeTemplates();\n        }\n        const folderId = folderItem.id;\n        const folderName = folderItem.name;\n        const folderIcon = folderItem.icon || 'fa-folder';\n        const folderColor = folderItem.color || document.documentElement.style.getPropertyValue('--SmartThemeBodyColor');\n        const moveIcon = type === 'global' ? 'fa-arrow-down' : 'fa-arrow-up';\n        const moveClass = type === 'global' ? 'move-to-character' : 'move-to-global';\n        const moveTitle = type === 'global' ? '移动到角色脚本库' : '移动到全局脚本库';\n        const folderHtml = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_8__.renderExtensionTemplateAsync)(this.templatePath, 'folder_template', {\n            folderId,\n            folderName,\n            folderIcon,\n            folderColor,\n            moveIcon,\n            moveClass,\n            moveTitle,\n        }));\n        this.bindFolderEvents(folderHtml, folderId, folderColor, type);\n        const scripts = folderItem.value;\n        const folderContent = folderHtml.find('.folder-content');\n        for (const script of scripts) {\n            const scriptElement = await this.createScriptElement(script, type);\n            folderContent.append(scriptElement);\n        }\n        container.append(folderHtml);\n        this.setupFolderDraggable(type);\n        this.setupSingleFolderDropZone(folderHtml, type);\n    }\n    /**\n     * 绑定文件夹相关事件和设置图标颜色\n     * @param folderHtml 文件夹HTML元素\n     * @param folderId 文件夹ID\n     * @param folderColor 文件夹颜色\n     * @param type 脚本类型\n     */\n    bindFolderEvents(folderHtml, folderId, folderColor, type) {\n        folderHtml.find('.folder-header').on('click', e => {\n            if ($(e.target).closest('.folder-control').length > 0)\n                return;\n            if ($(e.target).closest('.folder-checkbox').length > 0 || $(e.target).hasClass('folder-checkbox'))\n                return;\n            const content = folderHtml.find('.folder-content');\n            const toggle = folderHtml.find('.folder-toggle');\n            if (content.is(':visible')) {\n                content.slideUp();\n                toggle.removeClass('expanded');\n            }\n            else {\n                content.slideDown();\n                toggle.addClass('expanded');\n            }\n        });\n        const $folderToggle = folderHtml.find('.folder-script-toggle');\n        $folderToggle.on('click', e => {\n            e.stopPropagation();\n            const isEnabled = $folderToggle.hasClass('enabled');\n            const newState = !isEnabled;\n            if (newState) {\n                $folderToggle.addClass('enabled');\n                $folderToggle.find('i.fa-toggle-off').hide();\n                $folderToggle.find('i.fa-toggle-on').show();\n            }\n            else {\n                $folderToggle.removeClass('enabled');\n                $folderToggle.find('i.fa-toggle-off').show();\n                $folderToggle.find('i.fa-toggle-on').hide();\n            }\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.FOLDER_SCRIPTS_TOGGLE, {\n                folderId,\n                type,\n                enable: newState,\n            });\n        });\n        folderHtml.find('.folder-edit').on('click', e => {\n            e.stopPropagation();\n            this.showEditFolderDialog(folderId, type);\n        });\n        folderHtml.find('.folder-export').on('click', e => {\n            e.stopPropagation();\n            this.exportFolder(folderId, type);\n        });\n        folderHtml.find('.folder-move').on('click', e => {\n            e.stopPropagation();\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.FOLDER_MOVE, {\n                folderId,\n                fromType: type,\n            });\n        });\n        folderHtml.find('.folder-delete').on('click', e => {\n            e.stopPropagation();\n            this.showDeleteFolderDialog(folderId, type);\n        });\n        folderHtml.find('.folder-icon').css('color', folderColor);\n        this.updateFolderToggleState(folderHtml, folderId, type);\n    }\n    /**\n     * 更新文件夹开关的UI状态\n     * @param folderHtml 文件夹HTML元素\n     * @param folderId 文件夹ID\n     * @param type 脚本类型\n     */\n    updateFolderToggleState(folderHtml, folderId, type) {\n        const state = this.scriptManager.getFolderScriptsState(folderId, type);\n        const $folderToggle = folderHtml.find('.folder-script-toggle');\n        $folderToggle.removeClass('enabled');\n        if (state === 'all') {\n            $folderToggle.addClass('enabled');\n            $folderToggle.find('i.fa-toggle-off').hide();\n            $folderToggle.find('i.fa-toggle-on').show();\n        }\n        else {\n            $folderToggle.find('i.fa-toggle-off').show();\n            $folderToggle.find('i.fa-toggle-on').hide();\n        }\n    }\n    /**\n     * 更新包含指定脚本的文件夹开关状态\n     * @param scriptId 脚本ID\n     * @param type 脚本类型\n     */\n    updateParentFolderToggle(scriptId, type) {\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL\n            ? this.scriptManager.getGlobalRepositoryItems()\n            : this.scriptManager.getCharacterRepositoryItems();\n        for (const item of repository) {\n            if (item.type === 'folder') {\n                const scripts = item.value;\n                const hasScript = scripts.some(script => script.id === scriptId);\n                if (hasScript) {\n                    const $folder = $(`#${item.id}`);\n                    if ($folder.length > 0) {\n                        this.updateFolderToggleState($folder, item.id, type);\n                    }\n                    break;\n                }\n            }\n        }\n    }\n    /**\n     * 创建脚本元素\n     * @param script 脚本\n     * @param type 脚本类型\n     */\n    async createScriptElement(script, type) {\n        if (!this.baseTemplate) {\n            await this.initializeTemplates();\n        }\n        const scriptHtml = this.baseTemplate.clone();\n        scriptHtml.attr('id', script.id);\n        scriptHtml.attr('data-script-repository', 'true');\n        scriptHtml.find('.script-item-name').text(script.name);\n        scriptHtml.find('.script-storage-location').addClass(type === 'global' ? 'move-to-character' : 'move-to-global');\n        scriptHtml.find('.script-storage-location i').addClass(type === 'global' ? 'fa-arrow-down' : 'fa-arrow-up');\n        const $toggleButton = scriptHtml.find('.script-toggle');\n        if (script.enabled) {\n            $toggleButton.addClass('enabled');\n            $toggleButton.find('i.fa-toggle-off').hide();\n            $toggleButton.find('i.fa-toggle-on').show();\n        }\n        else {\n            $toggleButton.removeClass('enabled');\n            $toggleButton.find('i.fa-toggle-off').show();\n            $toggleButton.find('i.fa-toggle-on').hide();\n        }\n        this.bindScriptEvents(scriptHtml, script, type);\n        return scriptHtml;\n    }\n    /**\n     * 检查脚本data并询问用户如何处理\n     * @param script 脚本对象\n     * @returns 处理后的脚本数据（不包含enabled字段），如果用户取消则返回null\n     */\n    async checkScriptDataAndGetExportData(script) {\n        const { enabled, ...scriptData } = script;\n        const hasData = script.data && Object.keys(script.data).length > 0;\n        if (hasData) {\n            try {\n                const choice = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.callGenericPopup)(`脚本 \"${script.name}\" 包含数据，导出时如何处理？如有API-KEY等敏感数据，注意清除`, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.POPUP_TYPE.TEXT, '', {\n                    okButton: '直接导出（包含数据）',\n                    cancelButton: '取消',\n                    customButtons: ['清除数据后导出'],\n                });\n                switch (choice) {\n                    case 0:\n                        return null;\n                    case 1:\n                        return scriptData;\n                    case 2:\n                        return { ...scriptData, data: {} };\n                    default:\n                        return null;\n                }\n            }\n            catch (error) {\n                loglevel__WEBPACK_IMPORTED_MODULE_11___default().error('[ScriptManager] 导出脚本数据选择对话框出错:', error);\n                return scriptData;\n            }\n        }\n        return scriptData;\n    }\n    /**\n     * 绑定脚本相关事件\n     * @param scriptHtml 脚本HTML元素\n     * @param script 脚本对象\n     * @param type 脚本类型\n     */\n    bindScriptEvents(scriptHtml, script, type) {\n        const $toggleButton = scriptHtml.find('.script-toggle');\n        $toggleButton.on('click.scriptToggle', function () {\n            const isEnabled = $(this).hasClass('enabled');\n            const newState = !isEnabled;\n            if (newState) {\n                $(this).addClass('enabled');\n                $(this).find('i.fa-toggle-off').hide();\n                $(this).find('i.fa-toggle-on').show();\n            }\n            else {\n                $(this).removeClass('enabled');\n                $(this).find('i.fa-toggle-off').show();\n                $(this).find('i.fa-toggle-on').hide();\n            }\n            script.enabled = newState;\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.SCRIPT_TOGGLE, {\n                script,\n                type,\n                enable: newState,\n                userInput: true,\n            });\n        });\n        scriptHtml.find('.script-info').on('click.scriptInfo', () => {\n            const scriptInfo = script.info || '';\n            const htmlText = (0,_util_render_markdown__WEBPACK_IMPORTED_MODULE_6__.renderMarkdown)(scriptInfo);\n            (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.callGenericPopup)(htmlText, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.POPUP_TYPE.DISPLAY, undefined, { wide: true });\n        });\n        scriptHtml.find('.edit-script').on('click.scriptEdit', e => {\n            e.preventDefault();\n            e.stopPropagation();\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.SCRIPT_EDIT, { type, scriptId: script.id });\n        });\n        scriptHtml.find('.script-storage-location').on('click.scriptMove', () => {\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.SCRIPT_MOVE, { script, fromType: type });\n        });\n        scriptHtml.find('.export-script').on('click.scriptExport', async () => {\n            const fileName = `${script.name.replace(/[\\s.<>:\"/\\\\|?*\\x00-\\x1F\\x7F]/g, '_').toLowerCase()}.json`;\n            const scriptData = await this.checkScriptDataAndGetExportData(script);\n            if (scriptData === null) {\n                return;\n            }\n            const fileData = JSON.stringify(scriptData, null, 2);\n            (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_10__.download)(fileData, fileName, 'application/json');\n        });\n        scriptHtml.find('.delete-script').on('click.scriptDelete', async () => {\n            const confirm = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.callGenericPopup)('确定要删除这个脚本吗？', _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.POPUP_TYPE.CONFIRM);\n            if (!confirm) {\n                return;\n            }\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.SCRIPT_DELETE, { scriptId: script.id, type });\n            scriptHtml.remove();\n        });\n    }\n    /**\n     * 显示新建脚本对话框\n     */\n    async showCreateScriptDialog() {\n        let target = _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL;\n        const template = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_8__.renderExtensionTemplateAsync)(this.templatePath, 'script_target_selector', {\n            title: '新建脚本到:',\n            prefix: 'script-create',\n            globalLabel: '全局脚本库',\n            characterLabel: '角色脚本库',\n        }));\n        template.find('#script-create-target-global').on('input', () => (target = _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL));\n        template.find('#script-create-target-character').on('input', () => (target = _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.CHARACTER));\n        const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.callGenericPopup)(template, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.POPUP_TYPE.CONFIRM, '', {\n            okButton: '确认',\n            cancelButton: '取消',\n        });\n        if (result) {\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.SCRIPT_EDIT, {\n                type: target,\n            });\n        }\n    }\n    /**\n     * 显示创建文件夹对话框\n     */\n    async showCreateFolderDialog() {\n        const defaultColor = document.documentElement.style.getPropertyValue('--SmartThemeBodyColor');\n        const template = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_8__.renderExtensionTemplateAsync)(this.templatePath, 'folder_create', { defaultColor }, false));\n        let folderColor;\n        template.find('#folder-icon-preview').on('click', async () => {\n            try {\n                const selectedIcon = await (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_10__.showFontAwesomePicker)();\n                if (selectedIcon && selectedIcon.trim() !== '') {\n                    template.find('#folder-icon-preview').removeClass().addClass(`fa ${selectedIcon}`);\n                    template.find('#folder-icon-value').val(selectedIcon);\n                }\n            }\n            catch (error) {\n                loglevel__WEBPACK_IMPORTED_MODULE_11___default().error('[ScriptManager] 图标选择失败:', error);\n            }\n        });\n        template.find('#folder-color-picker').on('change', evt => {\n            // @ts-ignore\n            folderColor = evt.detail?.rgba;\n        });\n        const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.callGenericPopup)(template, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.POPUP_TYPE.CONFIRM, '', {\n            okButton: '创建',\n            cancelButton: '取消',\n        });\n        if (!result) {\n            return;\n        }\n        const folderName = template.find('#folder-name-input').val();\n        const folderIcon = template.find('#folder-icon-value').val();\n        const selectedType = template.find('#folder-target-global').prop('checked')\n            ? _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL\n            : _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.CHARACTER;\n        if (!folderName || folderName.trim() === '') {\n            toastr.error('请输入文件夹名称');\n            return;\n        }\n        try {\n            const existingFolders = selectedType === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL\n                ? this.scriptManager.getGlobalRepositoryItems()\n                : this.scriptManager.getCharacterRepositoryItems();\n            const folderExists = existingFolders.some(item => item.type === 'folder' && item.name === folderName.trim());\n            if (folderExists) {\n                toastr.error(`${selectedType === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL ? '全局' : '角色'}脚本库中已存在名为 \"${folderName.trim()}\" 的文件夹`);\n                return;\n            }\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.FOLDER_CREATE, {\n                name: folderName.trim(),\n                type: selectedType,\n                icon: folderIcon,\n                color: folderColor,\n            });\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_11___default().error('[ScriptManager] 创建文件夹失败:', error);\n            toastr.error(`创建文件夹失败: ${error instanceof Error ? error.message : String(error)}`);\n        }\n    }\n    /**\n     * 显示编辑文件夹对话框\n     * @param folderId 文件夹ID\n     * @param type 脚本类型\n     */\n    async showEditFolderDialog(folderId, type) {\n        const currentName = $(`#${folderId} .folder-name`).text();\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL\n            ? this.scriptManager.getGlobalRepositoryItems()\n            : this.scriptManager.getCharacterRepositoryItems();\n        const folder = repository.find(item => item.type === 'folder' && item.id === folderId);\n        const currentIcon = folder?.icon || 'fa-folder';\n        const currentColorRgba = folder?.color || document.documentElement.style.getPropertyValue('--SmartThemeBodyColor');\n        let newColor;\n        const template = $(`\n      <div class=\"folder-edit-dialog\">\n      <h3>编辑文件夹</h3>\n      <div class=\"flex-container flexFlowColumn wide100p padding10 justifyLeft\">\n        <div>\n          <h4>文件夹名称:</h4>\n          <input type=\"text\" id=\"folder-name-input\" class=\"text_pole\" value=\"${currentName}\" />\n        </div>\n        <div>\n          <h4>文件夹图标:</h4>\n          <div class=\"flex\" style=\"gap: 20px; margin: 5px 0; width: 100%;\">\n            <div class=\"flex alignItemsCenter\">\n            <label>选择颜色</label>\n            <toolcool-color-picker id=\"folder-color-picker\" color=\"${currentColorRgba}\"></toolcool-color-picker>\n            </div>\n            <div class=\"flex-container alignItemsCenter\">\n             <label>选择图标</label>\n              <i id=\"folder-icon-preview\" class=\"fa ${currentIcon} marginRight10\" style=\"cursor: pointer; font-size: 12px; padding: 4px; border: 1px solid #ccc; border-radius: 4px;\" title=\"点击选择图标\"></i>\n              <input type=\"hidden\" id=\"folder-icon-value\" value=\"${currentIcon}\" />\n            </div>\n          </div>\n        </div>\n      </div>\n    `);\n        template.find('#folder-icon-preview').on('click', async () => {\n            try {\n                const selectedIcon = await (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_10__.showFontAwesomePicker)();\n                if (selectedIcon && selectedIcon.trim() !== '') {\n                    template.find('#folder-icon-preview').removeClass().addClass(`fa ${selectedIcon}`);\n                    template.find('#folder-icon-value').val(selectedIcon);\n                }\n            }\n            catch (error) {\n                loglevel__WEBPACK_IMPORTED_MODULE_11___default().error('[ScriptManager] 图标选择失败:', error);\n            }\n        });\n        template.find('#folder-color-picker').on('change', evt => {\n            // @ts-ignore\n            newColor = evt.detail?.rgba;\n        });\n        const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.callGenericPopup)(template, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.POPUP_TYPE.CONFIRM, '', {\n            okButton: '保存',\n            cancelButton: '取消',\n        });\n        if (!result) {\n            return;\n        }\n        const newName = template.find('#folder-name-input').val();\n        const newIcon = template.find('#folder-icon-value').val();\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.FOLDER_EDIT, {\n            folderId,\n            newName: newName?.trim() || currentName,\n            type,\n            newIcon: newIcon,\n            newColor: newColor,\n        });\n    }\n    /**\n     * 导出文件夹为压缩包\n     * @param folderId 文件夹ID\n     * @param type 脚本类型\n     */\n    async exportFolder(folderId, type) {\n        try {\n            const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL\n                ? this.scriptManager.getGlobalRepositoryItems()\n                : this.scriptManager.getCharacterRepositoryItems();\n            const folder = repository.find(item => item.type === 'folder' && item.id === folderId);\n            if (!folder) {\n                toastr.error('未找到指定的文件夹');\n                return;\n            }\n            //@ts-ignore\n            if (!window.JSZip) {\n                await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @sillytavern/lib/jszip.min.js */ \"@sillytavern/lib/jszip.min.js\"));\n            }\n            //@ts-ignore\n            const zip = new JSZip();\n            const folderName = folder.name || 'folder';\n            const sanitizedFolderName = folderName.replace(/[<>:\"/\\\\|?*]/g, '_');\n            if (Array.isArray(folder.value)) {\n                let cancelExport = false;\n                for (const script of folder.value) {\n                    const scriptData = await this.checkScriptDataAndGetExportData(script);\n                    if (scriptData === null) {\n                        cancelExport = true;\n                        break;\n                    }\n                    const scriptFileName = `${script.name.replace(/[<>:\"/\\\\|?*]/g, '_')}.json`;\n                    zip.file(`${sanitizedFolderName}/${scriptFileName}`, JSON.stringify(scriptData, null, 2));\n                }\n                if (cancelExport) {\n                    return;\n                }\n            }\n            const zipBlob = await zip.generateAsync({ type: 'blob' });\n            const timestamp = new Date().toISOString().slice(0, 19).replace(/:/g, '-');\n            const typeName = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL ? 'global' : 'character';\n            const filename = `folder_${sanitizedFolderName}_${typeName}_${timestamp}.zip`;\n            const url = URL.createObjectURL(zipBlob);\n            const a = document.createElement('a');\n            a.href = url;\n            a.download = filename;\n            document.body.appendChild(a);\n            a.click();\n            document.body.removeChild(a);\n            URL.revokeObjectURL(url);\n            toastr.success(`文件夹 \"${folder.name}\" 导出成功`);\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_11___default().error('[ScriptManager] 导出文件夹失败:', error);\n            toastr.error(`导出文件夹失败: ${error instanceof Error ? error.message : String(error)}`);\n        }\n    }\n    /**\n     * 显示删除文件夹确认对话框\n     * @param folderId 文件夹ID\n     * @param type 脚本类型\n     */\n    async showDeleteFolderDialog(folderId, type) {\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL\n            ? this.scriptManager.getGlobalRepositoryItems()\n            : this.scriptManager.getCharacterRepositoryItems();\n        const folder = repository.find(item => item.type === 'folder' && item.id === folderId);\n        const folderName = folder?.name || '未知文件夹';\n        const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.callGenericPopup)(`确定要删除文件夹 \"${folderName}\" 及其中的所有脚本吗？此操作不可撤销。`, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.POPUP_TYPE.CONFIRM, '', { okButton: '删除', cancelButton: '取消' });\n        if (result) {\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.FOLDER_DELETE, {\n                folderId,\n                type,\n            });\n        }\n    }\n    /**\n     * 设置搜索功能事件\n     */\n    setupSearchEvents() {\n        const searchInput = $('#script-search-input');\n        searchInput.on('input', event => {\n            const query = event.target.value.trim();\n            if (query) {\n                this.performSearch(query);\n            }\n            else {\n                this.clearSearch();\n            }\n        });\n        searchInput.on('keypress', event => {\n            if (event.which === 13) {\n                const query = searchInput.val();\n                if (query && query.trim()) {\n                    this.performSearch(query.trim());\n                }\n            }\n        });\n    }\n    /**\n     * 执行搜索\n     * @param query 搜索关键词\n     */\n    performSearch(query) {\n        if (!query) {\n            this.clearSearch();\n            return;\n        }\n        const globalScripts = this.scriptManager.getGlobalScripts();\n        const characterScripts = this.scriptManager.getCharacterScripts();\n        const globalMatches = this.searchScripts(globalScripts, query);\n        const characterMatches = this.searchScripts(characterScripts, query);\n        this.displaySearchResults(globalMatches, characterMatches);\n    }\n    /**\n     * 在脚本数组中搜索匹配的脚本\n     * @param scripts 脚本数组\n     * @param query 搜索关键词\n     * @returns 匹配的脚本数组\n     */\n    searchScripts(scripts, query) {\n        const lowerQuery = query.toLowerCase();\n        return scripts.filter(script => script.name.toLowerCase().includes(lowerQuery));\n    }\n    /**\n     * 显示搜索结果\n     * @param globalMatches 全局脚本匹配结果\n     * @param characterMatches 角色脚本匹配结果\n     */\n    async displaySearchResults(globalMatches, characterMatches) {\n        this.clearScriptList(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL);\n        this.clearScriptList(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.CHARACTER);\n        const globalContainer = $('#global-script-list');\n        if (globalMatches.length > 0) {\n            for (const script of globalMatches) {\n                await this.addScriptToContainer(script, _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL);\n            }\n        }\n        else {\n            globalContainer.append('<small>无匹配的全局脚本</small>');\n        }\n        const characterContainer = $('#character-script-list');\n        if (characterMatches.length > 0) {\n            for (const script of characterMatches) {\n                await this.addScriptToContainer(script, _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.CHARACTER);\n            }\n        }\n        else {\n            characterContainer.append('<small>无匹配的角色脚本</small>');\n        }\n    }\n    /**\n     * 清除搜索结果，恢复正常显示\n     */\n    clearSearch() {\n        this.renderScriptLists();\n    }\n    /**\n     * 设置批量操作事件\n     */\n    setupBatchOperationEvents() {\n        $('#global-batch-manager').on('click', () => {\n            this.toggleBatchMode(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL);\n        });\n        $('#character-batch-manager').on('click', () => {\n            this.toggleBatchMode(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.CHARACTER);\n        });\n        $('#global-batch-delete').on('click', () => {\n            this.performBatchDelete(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL);\n        });\n        $('#global-batch-export').on('click', () => {\n            this.performBatchExport(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL);\n        });\n        $('#global-batch-move').on('click', () => {\n            this.performBatchMove(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL);\n        });\n        $('#global-batch-cancel').on('click', () => {\n            this.exitBatchMode(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL);\n        });\n        $('#character-batch-delete').on('click', () => {\n            this.performBatchDelete(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.CHARACTER);\n        });\n        $('#character-batch-export').on('click', () => {\n            this.performBatchExport(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.CHARACTER);\n        });\n        $('#character-batch-move').on('click', () => {\n            this.performBatchMove(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.CHARACTER);\n        });\n        $('#character-batch-cancel').on('click', () => {\n            this.exitBatchMode(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.CHARACTER);\n        });\n    }\n    /**\n     * 切换批量模式\n     * @param type 脚本类型\n     */\n    toggleBatchMode(type) {\n        const isBatchMode = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL ? this.batchModeGlobal : this.batchModeCharacter;\n        if (isBatchMode) {\n            this.exitBatchMode(type);\n        }\n        else {\n            this.enterBatchMode(type);\n        }\n    }\n    /**\n     * 进入批量模式\n     * @param type 脚本类型\n     */\n    enterBatchMode(type) {\n        const listSelector = (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.getScriptListSelector)(type);\n        const controlsSelector = (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.getBatchControlsSelector)(type);\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL) {\n            this.batchModeGlobal = true;\n        }\n        else {\n            this.batchModeCharacter = true;\n        }\n        $(controlsSelector).show();\n        const $list = $(listSelector);\n        $list.find('.script-item').each((_, element) => {\n            const $element = $(element);\n            $element.addClass('batch-mode');\n            $element.find('.script-checkbox').show();\n            $element.find('.drag-handle').hide();\n            $element.find('.script-item-control').hide();\n            $element\n                .find('.script-checkbox')\n                .off('change.batch')\n                .on('change.batch', () => {\n                this.handleCheckboxChange($element);\n            });\n        });\n        $list.find('.script-folder').each((_, element) => {\n            const $element = $(element);\n            $element.addClass('batch-mode');\n            $element.find('.folder-checkbox').show();\n            $element.find('.drag-handle').hide();\n            $element.find('.folder-control .folder-script-toggle').hide();\n            $element.find('.folder-control .folder-edit').hide();\n            $element.find('.folder-control .folder-export').hide();\n            $element.find('.folder-control .folder-move').hide();\n            $element.find('.folder-control .folder-delete').hide();\n            $element\n                .find('.folder-checkbox')\n                .off('change.batch')\n                .on('change.batch', () => {\n                this.handleCheckboxChange($element);\n            });\n        });\n    }\n    /**\n     * 退出批量模式\n     * @param type 脚本类型\n     */\n    exitBatchMode(type) {\n        const listSelector = (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.getScriptListSelector)(type);\n        const controlsSelector = (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.getBatchControlsSelector)(type);\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL) {\n            this.batchModeGlobal = false;\n        }\n        else {\n            this.batchModeCharacter = false;\n        }\n        $(controlsSelector).hide();\n        const $list = $(listSelector);\n        $list.find('.script-item, .script-folder').each((_, element) => {\n            const $element = $(element);\n            $element.removeClass('batch-mode selected');\n            $element.find('.script-checkbox, .folder-checkbox').hide().prop('checked', false);\n            $element.find('.script-item-control').show();\n            $element.find('.drag-handle').show();\n            $element.find('.script-controls').show();\n            $element.find('.folder-control .folder-script-toggle').show();\n            $element.find('.folder-control .folder-edit').show();\n            $element.find('.folder-control .folder-export').show();\n            $element.find('.folder-control .folder-move').show();\n            $element.find('.folder-control .folder-delete').show();\n            $element.find('.script-checkbox, .folder-checkbox').off('change.batch');\n        });\n    }\n    /**\n     * 复选框状态变化时添加选中状态css\n     * @param $element 元素jQuery对象\n     */\n    handleCheckboxChange($element) {\n        const isChecked = $element.find('.script-checkbox, .folder-checkbox').prop('checked');\n        if (isChecked) {\n            $element.addClass('selected');\n        }\n        else {\n            $element.removeClass('selected');\n        }\n    }\n    /**\n     * 获取选中的项目\n     * @param type 脚本类型\n     * @returns 选中的脚本ID和文件夹ID数组\n     */\n    getSelectedItems(type) {\n        const listSelector = (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.getScriptListSelector)(type);\n        const scriptIds = [];\n        const folderIds = [];\n        $(listSelector)\n            .find('.script-item.selected')\n            .each((_, element) => {\n            const id = $(element).attr('id');\n            if (id)\n                scriptIds.push(id);\n        });\n        $(listSelector)\n            .find('.script-folder.selected')\n            .each((_, element) => {\n            const id = $(element).attr('id');\n            if (id)\n                folderIds.push(id);\n        });\n        return { scriptIds, folderIds };\n    }\n    /**\n     * 执行批量删除\n     * @param type 脚本类型\n     */\n    async performBatchDelete(type) {\n        const { scriptIds, folderIds } = this.getSelectedItems(type);\n        if (scriptIds.length === 0 && folderIds.length === 0) {\n            toastr.warning('请至少选择一个项目进行删除');\n            return;\n        }\n        const totalCount = scriptIds.length + folderIds.length;\n        const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.callGenericPopup)(`确定要删除选中的 ${totalCount} 个项目吗？此操作不可撤销。`, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.POPUP_TYPE.CONFIRM, '', { okButton: '删除', cancelButton: '取消' });\n        if (!result)\n            return;\n        try {\n            for (const scriptId of scriptIds) {\n                await this.scriptManager.deleteScript(scriptId, type);\n            }\n            for (const folderId of folderIds) {\n                await this.handleFolderDelete(folderId, type, true);\n            }\n            toastr.success(`成功删除 ${totalCount} 个项目`);\n            this.exitBatchMode(type);\n            await this.renderScriptLists();\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_11___default().error('[ScriptManager] 批量删除失败:', error);\n            toastr.error(`批量删除失败: ${error instanceof Error ? error.message : String(error)}`);\n        }\n    }\n    /**\n     * 执行批量导出\n     * @param type 脚本类型\n     */\n    async performBatchExport(type) {\n        const { scriptIds, folderIds } = this.getSelectedItems(type);\n        if (scriptIds.length === 0 && folderIds.length === 0) {\n            toastr.warning('请至少选择一个项目进行导出');\n            return;\n        }\n        try {\n            //@ts-ignore\n            if (!window.JSZip) {\n                await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @sillytavern/lib/jszip.min.js */ \"@sillytavern/lib/jszip.min.js\"));\n            }\n            //@ts-ignore\n            const zip = new JSZip();\n            let exportedCount = 0;\n            let cancelExport = false;\n            for (const scriptId of scriptIds) {\n                const script = this.scriptManager.getScriptById(scriptId);\n                if (script) {\n                    const scriptData = await this.checkScriptDataAndGetExportData(script);\n                    if (scriptData === null) {\n                        cancelExport = true;\n                        break;\n                    }\n                    const scriptFileName = `${script.name.replace(/[<>:\"/\\\\|?*]/g, '_')}.json`;\n                    zip.file(scriptFileName, JSON.stringify(scriptData, null, 2));\n                    exportedCount++;\n                }\n            }\n            if (cancelExport) {\n                return;\n            }\n            const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL\n                ? this.scriptManager.getGlobalRepositoryItems()\n                : this.scriptManager.getCharacterRepositoryItems();\n            for (const folderId of folderIds) {\n                const folder = repository.find(item => item.type === 'folder' && item.id === folderId);\n                if (folder) {\n                    const folderName = folder.name || 'folder';\n                    const sanitizedFolderName = folderName.replace(/[<>:\"/\\\\|?*]/g, '_');\n                    if (Array.isArray(folder.value)) {\n                        for (const script of folder.value) {\n                            const scriptData = await this.checkScriptDataAndGetExportData(script);\n                            if (scriptData === null) {\n                                cancelExport = true;\n                                break;\n                            }\n                            const scriptFileName = `${script.name.replace(/[<>:\"/\\\\|?*]/g, '_')}.json`;\n                            zip.file(`${sanitizedFolderName}/${scriptFileName}`, JSON.stringify(scriptData, null, 2));\n                        }\n                        if (cancelExport) {\n                            break;\n                        }\n                    }\n                    exportedCount++;\n                }\n            }\n            if (cancelExport) {\n                return;\n            }\n            if (exportedCount === 0) {\n                toastr.error('没有找到有效的导出数据');\n                return;\n            }\n            const zipBlob = await zip.generateAsync({ type: 'blob' });\n            const timestamp = new Date().toISOString().slice(0, 19).replace(/:/g, '-');\n            const typeName = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL ? 'global' : 'character';\n            const filename = `batch_export_${typeName}_${timestamp}.zip`;\n            const url = URL.createObjectURL(zipBlob);\n            const a = document.createElement('a');\n            a.href = url;\n            a.download = filename;\n            document.body.appendChild(a);\n            a.click();\n            document.body.removeChild(a);\n            URL.revokeObjectURL(url);\n            toastr.success(`成功导出 ${exportedCount} 个项目`);\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_11___default().error('[ScriptManager] 批量导出失败:', error);\n            toastr.error(`批量导出失败: ${error instanceof Error ? error.message : String(error)}`);\n        }\n    }\n    /**\n     * 执行批量移动到文件夹\n     * @param type 脚本类型\n     */\n    async performBatchMove(type) {\n        const { scriptIds, folderIds } = this.getSelectedItems(type);\n        if (folderIds.length > 0) {\n            toastr.error('不能移动文件夹，请只选择脚本进行移动操作');\n            return;\n        }\n        if (scriptIds.length === 0) {\n            toastr.warning('请至少选择一个脚本进行移动');\n            return;\n        }\n        try {\n            const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL\n                ? this.scriptManager.getGlobalRepositoryItems()\n                : this.scriptManager.getCharacterRepositoryItems();\n            const folders = repository.filter(item => item.type === 'folder');\n            if (folders.length === 0) {\n                toastr.error('没有可用的文件夹，请先创建一个文件夹');\n                return;\n            }\n            const folderOptions = folders.map(folder => `<option value=\"${folder.id}\">${folder.name}</option>`).join('');\n            const template = $(`\n        <div>\n          <p>选择要移动到的文件夹：</p>\n          <select id=\"target-folder-select\" class=\"text_pole\" style=\"width: 100%;\">\n            <option value=\"\">根目录</option>\n            ${folderOptions}\n          </select>\n        </div>\n      `);\n            const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.callGenericPopup)(template, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_9__.POPUP_TYPE.CONFIRM, '', {\n                okButton: '移动',\n                cancelButton: '取消',\n            });\n            if (!result)\n                return;\n            const targetFolderId = template.find('#target-folder-select').val() || null;\n            for (const scriptId of scriptIds) {\n                await this.scriptManager.moveScriptToFolder(scriptId, targetFolderId, type);\n            }\n            const targetName = targetFolderId ? folders.find(f => f.id === targetFolderId)?.name || '未知文件夹' : '根目录';\n            toastr.success(`成功将 ${scriptIds.length} 个脚本移动到\"${targetName}\"`);\n            this.exitBatchMode(type);\n            await this.renderScriptLists();\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_11___default().error('[ScriptManager] 批量移动失败:', error);\n            toastr.error(`批量移动失败: ${error instanceof Error ? error.message : String(error)}`);\n        }\n    }\n    /**\n     * 处理文件夹创建事件\n     * @param name 文件夹名称\n     * @param type 脚本类型\n     * @param icon 文件夹图标\n     */\n    async handleFolderCreate(name, type, icon, color) {\n        try {\n            await this.scriptManager.createFolder(name, type, icon, color);\n            await this.renderScriptLists();\n            toastr.success(`文件夹 \"${name}\" 创建成功`);\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_11___default().error('[ScriptManager] 创建文件夹失败:', error);\n            toastr.error(`创建文件夹失败: ${error instanceof Error ? error.message : String(error)}`);\n        }\n    }\n    /**\n     * 处理文件夹编辑事件\n     * @param folderId 文件夹ID\n     * @param newName 新名称\n     * @param type 脚本类型\n     * @param newIcon 新图标\n     * @param newColor 新颜色\n     */\n    async handleFolderEdit(folderId, newName, type, newIcon, newColor) {\n        try {\n            await this.scriptManager.editFolder(folderId, newName, type, newIcon, newColor);\n            if (newName) {\n                $(`#${folderId} .folder-name`).text(newName);\n            }\n            if (newIcon) {\n                $(`#${folderId} .folder-icon`).removeClass().addClass(`fa ${newIcon} folder-icon marginLeft5`);\n            }\n            if (newColor) {\n                $(`#${folderId} .folder-icon`).css('color', newColor);\n                $(`#${folderId} .folder-header`).css('border-left-color', newColor);\n            }\n            toastr.success(`文件夹更新成功`);\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_11___default().error('[ScriptManager] 更新文件夹失败:', error);\n            toastr.error(`更新文件夹失败: ${error instanceof Error ? error.message : String(error)}`);\n        }\n    }\n    /**\n     * 处理文件夹删除事件\n     * @param folderId 文件夹ID\n     * @param type 脚本类型\n     * @param skipUIRefresh 是否跳过UI刷新（用于批量操作）\n     */\n    async handleFolderDelete(folderId, type, skipUIRefresh = false) {\n        try {\n            await this.scriptManager.deleteFolder(folderId, type);\n            if (!skipUIRefresh) {\n                await this.renderScriptLists();\n                toastr.success('文件夹删除成功');\n            }\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_11___default().error('[ScriptManager] 删除文件夹失败:', error);\n            if (!skipUIRefresh) {\n                toastr.error(`删除文件夹失败: ${error instanceof Error ? error.message : String(error)}`);\n            }\n            throw error;\n        }\n    }\n    /**\n     * 处理文件夹脚本批量开关\n     * @param folderId 文件夹ID\n     * @param type 脚本类型\n     * @param enable 是否启用\n     */\n    async handleFolderScriptsToggle(folderId, type, enable) {\n        try {\n            await this.scriptManager.toggleFolderScripts(folderId, type, enable);\n            this.updateFolderAndScriptsUI(folderId, type, enable);\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_11___default().error('[ScriptManager] 批量切换文件夹脚本状态失败:', error);\n            toastr.error(`批量切换脚本状态失败: ${error instanceof Error ? error.message : '未知错误'}`);\n        }\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3VpX2NvbnRyb2xsZXIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFxRjtBQUNFO0FBQ1E7QUFDZjtBQVFuQztBQUN1RDtBQUM1QztBQUVQO0FBQzhCO0FBQ0w7QUFDNkI7QUFFNUU7QUFDSDtBQUVqQixNQUFNLFlBQVk7SUFDZixNQUFNLENBQUMsUUFBUSxDQUFlO0lBRTlCLGFBQWEsQ0FBZ0I7SUFDN0IsYUFBYSxDQUFnQjtJQUU3QixZQUFZLENBQVM7SUFDckIsWUFBWSxHQUErQixJQUFJLENBQUM7SUFDaEQscUJBQXFCLEdBQStCLElBQUksQ0FBQztJQUN6RCxjQUFjLEdBQStCLElBQUksQ0FBQztJQUVsRCxlQUFlLEdBQVksS0FBSyxDQUFDO0lBQ2pDLGtCQUFrQixHQUFZLEtBQUssQ0FBQztJQUU1QztRQUNFLElBQUksQ0FBQyxhQUFhLEdBQUcseUZBQWEsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUNqRCxJQUFJLENBQUMsYUFBYSxHQUFHLElBQUksOEVBQWEsRUFBRSxDQUFDO1FBQ3pDLElBQUksQ0FBQyxZQUFZLEdBQUcsR0FBRywwRUFBbUIseUNBQXlDLENBQUM7SUFDdEYsQ0FBQztJQUVEOztPQUVHO0lBQ0ksTUFBTSxDQUFDLFdBQVc7UUFDdkIsSUFBSSxDQUFDLFlBQVksQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUMzQixZQUFZLENBQUMsUUFBUSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7UUFDN0MsQ0FBQztRQUNELE9BQU8sWUFBWSxDQUFDLFFBQVEsQ0FBQztJQUMvQixDQUFDO0lBRUQ7O09BRUc7SUFDSSxNQUFNLENBQUMsZUFBZTtRQUMzQixJQUFJLFlBQVksQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUMxQixZQUFZLENBQUMsUUFBUSxDQUFDLE9BQU8sRUFBRSxDQUFDO1lBQ2hDLFlBQVksQ0FBQyxRQUFRLEdBQUcsU0FBb0MsQ0FBQztRQUMvRCxDQUFDO0lB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QUF3QixDQUFDLFFBQVEsRUFBRSxJQUFJLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFDeEQsQ0FBQztRQUFDLE9BQU8sS0FBSyxFQUFFLENBQUM7WUFDZixzREFBUyxDQUFDLGdDQUFnQyxFQUFFLEtBQUssQ0FBQyxDQUFDO1lBQ25ELE1BQU0sQ0FBQyxLQUFLLENBQUMsZUFBZSxLQUFLLFlBQVksS0FBSyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDO1FBQ2pGLENBQUM7SUFDSCxDQUFDO0NBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3VpX2NvbnRyb2xsZXIudHM/ODA2YSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVEZWZhdWx0U2NyaXB0cyB9IGZyb20gJ0AvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L2J1aWx0aW5fc2NyaXB0cyc7XG5pbXBvcnQgeyBCdXR0b25NYW5hZ2VyLCBpbml0U2NyaXB0QnV0dG9uIH0gZnJvbSAnQC9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvYnV0dG9uJztcbmltcG9ydCB7IHNjcmlwdEV2ZW50cywgU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZSB9IGZyb20gJ0AvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L2V2ZW50cyc7XG5pbXBvcnQgeyBTY3JpcHRNYW5hZ2VyIH0gZnJvbSAnQC9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvc2NyaXB0X2NvbnRyb2xsZXInO1xuaW1wb3J0IHtcbiAgZ2V0QmF0Y2hDb250cm9sc1NlbGVjdG9yLFxuICBnZXRTY3JpcHRMaXN0U2VsZWN0b3IsXG4gIGdldFNjcmlwdFRvZ2dsZVNlbGVjdG9yLFxuICBTY3JpcHQsXG4gIFNjcmlwdFJlcG9zaXRvcnlJdGVtLFxuICBTY3JpcHRUeXBlLFxufSBmcm9tICdAL2NvbXBvbmVudC9zY3JpcHRfcmVwb3NpdG9yeS90eXBlcyc7XG5pbXBvcnQgeyBleHRlbnNpb25Gb2xkZXJQYXRoLCBnZXRTZXR0aW5nVmFsdWUsIHNhdmVTZXR0aW5nVmFsdWUgfSBmcm9tICdAL3V0aWwvZXh0ZW5zaW9uX3ZhcmlhYmxlcyc7XG5pbXBvcnQgeyByZW5kZXJNYXJrZG93biB9IGZyb20gJ0AvdXRpbC9yZW5kZXJfbWFya2Rvd24nO1xuXG5pbXBvcnQgeyBjaGFyYWN0ZXJzIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5pbXBvcnQgeyByZW5kZXJFeHRlbnNpb25UZW1wbGF0ZUFzeW5jIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvZXh0ZW5zaW9ucyc7XG5pbXBvcnQgeyBjYWxsR2VuZXJpY1BvcHVwLCBQT1BVUF9UWVBFIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvcG9wdXAnO1xuaW1wb3J0IHsgZG93bmxvYWQsIGdldFNvcnRhYmxlRGVsYXksIHNob3dGb250QXdlc29tZVBpY2tlciwgdXVpZHY0IH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvdXRpbHMnO1xuXG5pbXBvcnQgbG9nIGZyb20gJ2xvZ2xldmVsJztcbmltcG9ydCBZQU1MIGZyb20gJ3lhbWwnO1xuXG5leHBvcnQgY2xhc3MgVUlDb250cm9sbGVyIHtcbiAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2U6IFVJQ29udHJvbGxlcjtcblxuICBwcml2YXRlIHNjcmlwdE1hbmFnZXI6IFNjcmlwdE1hbmFnZXI7XG4gIHByaXZhdGUgYnV0dG9uTWFuYWdlcjogQnV0dG9uTWFuYWdlcjtcblxuICBwcml2YXRlIHRlbXBsYXRlUGF0aDogc3RyaW5nO1xuICBwcml2YXRlIGJhc2VUZW1wbGF0ZTogSlF1ZXJ5PEhUTUxFbGVtZW50PiB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIGRlZmF1bHRTY3JpcHRUZW1wbGF0ZTogSlF1ZXJ5PEhUTUxFbGVtZW50PiB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIGZvbGRlclRlbXBsYXRlOiBKUXVlcnk8SFRNTEVsZW1lbnQ+IHwgbnVsbCA9IG51bGw7XG5cbiAgcHJpdmF0ZSBiYXRjaE1vZGVHbG9iYWw6IGJvb2xlYW4gPSBmYWxzZTtcbiAgcHJpdmF0ZSBiYXRjaE1vZGVDaGFyYWN0ZXI6IGJvb2xlYW4gPSBmYWxzZTtcblxuICBwcml2YXRlIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuc2NyaXB0TWFuYWdlciA9IFNjcmlwdE1hbmFnZXIuZ2V0SW5zdGFuY2UoKTtcbiAgICB0aGlzLmJ1dHRvbk1hbmFnZXIgPSBuZXcgQnV0dG9uTWFuYWdlcigpO1xuICAgIHRoaXMudGVtcGxhdGVQYXRoID0gYCR7ZXh0ZW5zaW9uRm9sZGVyUGF0aH0vc3JjL2NvbXBvbmVudC9zY3JpcHRfcmVwb3NpdG9yeS9wdWJsaWNgO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPllVJ5o6n5Yi25Zmo5a6e5L6LXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGdldEluc3RhbmNlKCk6IFVJQ29udHJvbGxlciB7XG4gICAgaWYgKCFVSUNvbnRyb2xsZXIuaW5zdGFuY2UpIHtcbiAgICAgIFVJQ29udHJvbGxlci5pbnN0YW5jZSA9IG5ldyBVSUNvbnRyb2xsZXIoKTtcbiAgICB9XG4gICAgcmV0dXJuIFVJQ29udHJvbGxlci5pbnN0YW5jZTtcbiAgfVxuXG4gIC8qKlxuICAgKiDplIDmr4FVSeaOp+WItuWZqOWunuS+i1xuICAgKi9cbiAgcHVibGljIHN0YXRpYyBkZXN0cm95SW5zdGFuY2UoKTogdm9pZCB7XG4gICAgaWYgKFVJQ29udHJvbGxlci5pbnN0YW5jZSkge1xuICAgICAgVUlDb250cm9sbGVyLmluc3RhbmNlLmNsZWFudXAoKTtcbiAgICAgIFVJQ29udHJvbGxlci5pbnN0YW5jZSA9IHVuZGVmaW5lZCBhcyB1bmtub3duIGFzIFVJQ29udHJvbGxlcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5riF55CG6LWE5rqQXG4gICAqL1xuICBwdWJsaWMgY2xlYW51cCgpOiB2b2lkIHtcbiAgICB0aGlzLmJ1dHRvbk1hbmFnZXIuY2xlYXJCdXR0b25zKCk7XG4gICAgdGhpcy5iYXNlVGVtcGxhdGUgPSBudWxsO1xuICAgIHRoaXMuZGVmYXVsdFNjcmlwdFRlbXBsYXRlID0gbnVsbDtcbiAgICB0aGlzLmZvbGRlclRlbXBsYXRlID0gbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiDliJ3lp4vljJZVSVxuICAgKi9cbiAgcHVibGljIGFzeW5jIGluaXRpYWxpemUoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgYXdhaXQgdGhpcy5pbml0aWFsaXplVGVtcGxhdGVzKCk7XG5cbiAgICB0aGlzLnNldHVwU2NyaXB0UmVwb3NpdG9yeUV2ZW50cygpO1xuXG4gICAgdGhpcy5yZWdpc3RlckV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICBhd2FpdCB0aGlzLnJlbmRlclNjcmlwdExpc3RzKCk7XG5cbiAgICBpbml0U2NyaXB0QnV0dG9uKCk7XG5cbiAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlVJX0xPQURFRCk7XG4gIH1cblxuICAvKipcbiAgICog5Yid5aeL5YyW5qih5p2/XG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGluaXRpYWxpemVUZW1wbGF0ZXMoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdGhpcy5iYXNlVGVtcGxhdGUgPSAkKFxuICAgICAgYXdhaXQgcmVuZGVyRXh0ZW5zaW9uVGVtcGxhdGVBc3luYyh0aGlzLnRlbXBsYXRlUGF0aCwgJ3NjcmlwdF9pdGVtX3RlbXBsYXRlJywge1xuICAgICAgICBzY3JpcHROYW1lOiAnJyxcbiAgICAgICAgaWQ6ICcnLFxuICAgICAgICBtb3ZlVG86ICcnLFxuICAgICAgICBmYUljb246ICcnLFxuICAgICAgfSksXG4gICAgKTtcblxuICAgIHRoaXMuZGVmYXVsdFNjcmlwdFRlbXBsYXRlID0gJChcbiAgICAgIGF3YWl0IHJlbmRlckV4dGVuc2lvblRlbXBsYXRlQXN5bmModGhpcy50ZW1wbGF0ZVBhdGgsICdzY3JpcHRfZGVmYXVsdF9yZXBvc2l0b3J5Jywge1xuICAgICAgICBzY3JpcHROYW1lOiAnJyxcbiAgICAgICAgaWQ6ICcnLFxuICAgICAgfSksXG4gICAgKTtcblxuICAgIHRoaXMuZm9sZGVyVGVtcGxhdGUgPSAkKFxuICAgICAgYXdhaXQgcmVuZGVyRXh0ZW5zaW9uVGVtcGxhdGVBc3luYyh0aGlzLnRlbXBsYXRlUGF0aCwgJ2ZvbGRlcl90ZW1wbGF0ZScsIHtcbiAgICAgICAgZm9sZGVySWQ6ICcnLFxuICAgICAgICBmb2xkZXJOYW1lOiAnJyxcbiAgICAgICAgZm9sZGVySWNvbjogJ2ZhLWZvbGRlcicsXG4gICAgICAgIGZvbGRlckNvbG9yOiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnLS1TbWFydFRoZW1lQm9keUNvbG9yJyksXG4gICAgICB9KSxcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIOWIneWni+WMluiEmuacrOW6k+eVjOmdouS6i+S7tlxuICAgKi9cbiAgcHJpdmF0ZSBzZXR1cFNjcmlwdFJlcG9zaXRvcnlFdmVudHMoKTogdm9pZCB7XG4gICAgJCgnI2dsb2JhbC1zY3JpcHQtZW5hYmxlLXRvZ2dsZScpXG4gICAgICAucHJvcCgnY2hlY2tlZCcsIHRoaXMuc2NyaXB0TWFuYWdlci5pc0dsb2JhbFNjcmlwdEVuYWJsZWQpXG4gICAgICAub24oJ2NsaWNrJywgKGV2ZW50OiBKUXVlcnkuQ2xpY2tFdmVudCkgPT4ge1xuICAgICAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlRZUEVfVE9HR0xFLCB7XG4gICAgICAgICAgdHlwZTogU2NyaXB0VHlwZS5HTE9CQUwsXG4gICAgICAgICAgZW5hYmxlOiBldmVudC50YXJnZXQuY2hlY2tlZCxcbiAgICAgICAgICB1c2VySW5wdXQ6IHRydWUsXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAkKCcjY2hhcmFjdGVyLXNjcmlwdC1lbmFibGUtdG9nZ2xlJylcbiAgICAgIC5wcm9wKCdjaGVja2VkJywgdGhpcy5zY3JpcHRNYW5hZ2VyLmlzQ2hhcmFjdGVyU2NyaXB0RW5hYmxlZClcbiAgICAgIC5vbignY2xpY2snLCAoZXZlbnQ6IEpRdWVyeS5DbGlja0V2ZW50KSA9PiB7XG4gICAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuVFlQRV9UT0dHTEUsIHtcbiAgICAgICAgICB0eXBlOiBTY3JpcHRUeXBlLkNIQVJBQ1RFUixcbiAgICAgICAgICBlbmFibGU6IGV2ZW50LnRhcmdldC5jaGVja2VkLFxuICAgICAgICAgIHVzZXJJbnB1dDogdHJ1ZSxcbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICQoJyNjcmVhdGUtc2NyaXB0Jykub24oJ2NsaWNrJywgYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgdGhpcy5zaG93Q3JlYXRlU2NyaXB0RGlhbG9nKCk7XG4gICAgfSk7XG5cbiAgICAkKCcjaW1wb3J0LXNjcmlwdC1maWxlJykub24oJ2NoYW5nZScsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCB0YXJnZXQgPSAnZ2xvYmFsJztcbiAgICAgIGNvbnN0IHRlbXBsYXRlID0gJChcbiAgICAgICAgYXdhaXQgcmVuZGVyRXh0ZW5zaW9uVGVtcGxhdGVBc3luYyhcbiAgICAgICAgICBgJHtleHRlbnNpb25Gb2xkZXJQYXRofS9zcmMvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3B1YmxpY2AsXG4gICAgICAgICAgJ3NjcmlwdF90YXJnZXRfc2VsZWN0b3InLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHRpdGxlOiAn5a+85YWl5YiwOicsXG4gICAgICAgICAgICBwcmVmaXg6ICdzY3JpcHQtaW1wb3J0JyxcbiAgICAgICAgICAgIGdsb2JhbExhYmVsOiAn5YWo5bGA6ISa5pysJyxcbiAgICAgICAgICAgIGNoYXJhY3RlckxhYmVsOiAn5bGA6YOo6ISa5pysJyxcbiAgICAgICAgICB9LFxuICAgICAgICApLFxuICAgICAgKTtcbiAgICAgIHRlbXBsYXRlLmZpbmQoJyNzY3JpcHQtaW1wb3J0LXRhcmdldC1nbG9iYWwnKS5vbignaW5wdXQnLCAoKSA9PiAodGFyZ2V0ID0gJ2dsb2JhbCcpKTtcbiAgICAgIHRlbXBsYXRlLmZpbmQoJyNzY3JpcHQtaW1wb3J0LXRhcmdldC1jaGFyYWN0ZXInKS5vbignaW5wdXQnLCAoKSA9PiAodGFyZ2V0ID0gJ2NoYXJhY3RlcicpKTtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNhbGxHZW5lcmljUG9wdXAodGVtcGxhdGUsIFBPUFVQX1RZUEUuQ09ORklSTSwgJycsIHtcbiAgICAgICAgb2tCdXR0b246ICfnoa7orqQnLFxuICAgICAgICBjYW5jZWxCdXR0b246ICflj5bmtognLFxuICAgICAgfSk7XG5cbiAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgY29uc3QgaW5wdXRFbGVtZW50ID0gdGhpcyBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQgJiYgdGhpcztcbiAgICAgICAgaWYgKGlucHV0RWxlbWVudCAmJiBpbnB1dEVsZW1lbnQuZmlsZXMpIHtcbiAgICAgICAgICBmb3IgKGNvbnN0IGZpbGUgb2YgaW5wdXRFbGVtZW50LmZpbGVzKSB7XG4gICAgICAgICAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlNDUklQVF9JTVBPUlQsIHtcbiAgICAgICAgICAgICAgZmlsZSxcbiAgICAgICAgICAgICAgdHlwZTogdGFyZ2V0ID09PSAnZ2xvYmFsJyA/IFNjcmlwdFR5cGUuR0xPQkFMIDogU2NyaXB0VHlwZS5DSEFSQUNURVIsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaW5wdXRFbGVtZW50LnZhbHVlID0gJyc7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgICQoJyNpbXBvcnQtc2NyaXB0Jykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgJCgnI2ltcG9ydC1zY3JpcHQtZmlsZScpLnRyaWdnZXIoJ2NsaWNrJyk7XG4gICAgfSk7XG5cbiAgICAkKCcjY3JlYXRlLWZvbGRlcicpLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuc2hvd0NyZWF0ZUZvbGRlckRpYWxvZygpO1xuICAgIH0pO1xuXG4gICAgJCgnI2RlZmF1bHQtc2NyaXB0Jykub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5VSV9SRUZSRVNILCB7IGFjdGlvbjogJ2xvYWRfZGVmYXVsdF9zY3JpcHRzJyB9KTtcbiAgICB9KTtcblxuICAgICQoJyNleHRlbnNpb25zX3NldHRpbmdzJykuY3NzKCdtaW4td2lkdGgnLCAnMCcpO1xuXG4gICAgdGhpcy5zZXR1cFNlYXJjaEV2ZW50cygpO1xuXG4gICAgdGhpcy5zZXR1cEJhdGNoT3BlcmF0aW9uRXZlbnRzKCk7XG4gIH1cblxuICAvKipcbiAgICog5rOo5YaM5LqL5Lu255uR5ZCs5ZmoXG4gICAqL1xuICBwcml2YXRlIHJlZ2lzdGVyRXZlbnRMaXN0ZW5lcnMoKTogdm9pZCB7XG4gICAgc2NyaXB0RXZlbnRzLm9uKFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuVUlfUkVGUkVTSCwgYXN5bmMgZGF0YSA9PiB7XG4gICAgICBjb25zdCB7IGFjdGlvbiB9ID0gZGF0YTtcblxuICAgICAgc3dpdGNoIChhY3Rpb24pIHtcbiAgICAgICAgY2FzZSAnc2NyaXB0X3RvZ2dsZSc6XG4gICAgICAgICAgYXdhaXQgdGhpcy5yZWZyZXNoU2NyaXB0U3RhdGUoZGF0YS5zY3JpcHQsIGRhdGEuZW5hYmxlKTtcbiAgICAgICAgICB0aGlzLnVwZGF0ZVBhcmVudEZvbGRlclRvZ2dsZShkYXRhLnNjcmlwdC5pZCwgZGF0YS50eXBlKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAndHlwZV90b2dnbGUnOlxuICAgICAgICAgIGF3YWl0IHRoaXMucmVmcmVzaFR5cGVTdGF0ZShkYXRhLnR5cGUsIGRhdGEuZW5hYmxlKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnc2NyaXB0X2ltcG9ydCc6XG4gICAgICAgICAgYXdhaXQgdGhpcy5hZGRTY3JpcHRUb0NvbnRhaW5lcihkYXRhLnNjcmlwdCwgZGF0YS50eXBlKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnc2NyaXB0X2NyZWF0ZSc6XG4gICAgICAgICAgYXdhaXQgdGhpcy5hZGRTY3JpcHRUb0NvbnRhaW5lcihkYXRhLnNjcmlwdCwgZGF0YS50eXBlKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnc2NyaXB0X3VwZGF0ZSc6XG4gICAgICAgICAgdGhpcy51cGRhdGVTY3JpcHRVSShkYXRhLnNjcmlwdCwgZGF0YS50eXBlKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnc2NyaXB0X2RlbGV0ZSc6XG4gICAgICAgICAgdGhpcy5yZW1vdmVTY3JpcHRFbGVtZW50KGRhdGEuc2NyaXB0SWQpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdzY3JpcHRfbW92ZSc6XG4gICAgICAgICAgdGhpcy5oYW5kbGVTY3JpcHRNb3ZlZChkYXRhLnNjcmlwdCwgZGF0YS5mcm9tVHlwZSwgZGF0YS50YXJnZXRUeXBlKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnZm9sZGVyX21vdmUnOlxuICAgICAgICAgIGF3YWl0IHRoaXMucmVuZGVyU2NyaXB0TGlzdHMoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnZm9sZGVyX3NjcmlwdHNfdG9nZ2xlJzpcbiAgICAgICAgICB0aGlzLnVwZGF0ZUZvbGRlckFuZFNjcmlwdHNVSShkYXRhLmZvbGRlcklkLCBkYXRhLnR5cGUsIGRhdGEuZW5hYmxlKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnbG9hZF9kZWZhdWx0X3NjcmlwdHMnOlxuICAgICAgICAgIGF3YWl0IHRoaXMubG9hZERlZmF1bHRTY3JpcHRzUmVwb3NpdG9yeSgpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdyZWZyZXNoX2dsb2JhbF9zY3JpcHRzJzpcbiAgICAgICAgICBhd2FpdCB0aGlzLnJlZnJlc2hTY3JpcHRMaXN0KFNjcmlwdFR5cGUuR0xPQkFMKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAncmVmcmVzaF9jaGFyYWN0X3NjcmlwdHMnOlxuICAgICAgICAgIGF3YWl0IHRoaXMucmVmcmVzaFNjcmlwdExpc3QoU2NyaXB0VHlwZS5DSEFSQUNURVIpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIGxvZy53YXJuKGBbU2NyaXB0TWFuYWdlcl0g5pyq5aSE55CG55qEVUnliLfmlrDkuovku7Y6ICR7YWN0aW9ufWApO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgc2NyaXB0RXZlbnRzLm9uKFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuQlVUVE9OX0FERCwgZGF0YSA9PiB7XG4gICAgICBjb25zdCB7IHNjcmlwdCB9ID0gZGF0YTtcbiAgICAgIHRoaXMuYWRkQnV0dG9uKHNjcmlwdCk7XG4gICAgfSk7XG5cbiAgICBzY3JpcHRFdmVudHMub24oU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5CVVRUT05fUkVNT1ZFLCBkYXRhID0+IHtcbiAgICAgIGNvbnN0IHsgc2NyaXB0SWQgfSA9IGRhdGE7XG4gICAgICB0aGlzLmJ1dHRvbk1hbmFnZXIucmVtb3ZlQnV0dG9uc0J5U2NyaXB0SWQoc2NyaXB0SWQpO1xuICAgIH0pO1xuXG4gICAgc2NyaXB0RXZlbnRzLm9uKFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuU0NSSVBUX0VESVQsIGFzeW5jIGRhdGEgPT4ge1xuICAgICAgY29uc3QgeyB0eXBlLCBzY3JpcHRJZCB9ID0gZGF0YTtcbiAgICAgIGF3YWl0IHRoaXMub3BlblNjcmlwdEVkaXRvcih0eXBlLCBzY3JpcHRJZCk7XG4gICAgfSk7XG5cbiAgICBzY3JpcHRFdmVudHMub24oU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5GT0xERVJfQ1JFQVRFLCBhc3luYyBkYXRhID0+IHtcbiAgICAgIGNvbnN0IHsgbmFtZSwgdHlwZSwgaWNvbiwgY29sb3IgfSA9IGRhdGE7XG4gICAgICBhd2FpdCB0aGlzLmhhbmRsZUZvbGRlckNyZWF0ZShuYW1lLCB0eXBlLCBpY29uLCBjb2xvcik7XG4gICAgfSk7XG5cbiAgICBzY3JpcHRFdmVudHMub24oU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5GT0xERVJfRURJVCwgYXN5bmMgZGF0YSA9PiB7XG4gICAgICBjb25zdCB7IGZvbGRlcklkLCBuZXdOYW1lLCB0eXBlLCBuZXdJY29uLCBuZXdDb2xvciB9ID0gZGF0YTtcbiAgICAgIGF3YWl0IHRoaXMuaGFuZGxlRm9sZGVyRWRpdChmb2xkZXJJZCwgbmV3TmFtZSwgdHlwZSwgbmV3SWNvbiwgbmV3Q29sb3IpO1xuICAgIH0pO1xuXG4gICAgc2NyaXB0RXZlbnRzLm9uKFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuRk9MREVSX0RFTEVURSwgYXN5bmMgZGF0YSA9PiB7XG4gICAgICBjb25zdCB7IGZvbGRlcklkLCB0eXBlIH0gPSBkYXRhO1xuICAgICAgYXdhaXQgdGhpcy5oYW5kbGVGb2xkZXJEZWxldGUoZm9sZGVySWQsIHR5cGUpO1xuICAgIH0pO1xuXG4gICAgc2NyaXB0RXZlbnRzLm9uKFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuRk9MREVSX1NDUklQVFNfVE9HR0xFLCBhc3luYyBkYXRhID0+IHtcbiAgICAgIGNvbnN0IHsgZm9sZGVySWQsIHR5cGUsIGVuYWJsZSB9ID0gZGF0YTtcbiAgICAgIGF3YWl0IHRoaXMuaGFuZGxlRm9sZGVyU2NyaXB0c1RvZ2dsZShmb2xkZXJJZCwgdHlwZSwgZW5hYmxlKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmt7vliqDmjInpkq5cbiAgICogQHBhcmFtIHNjcmlwdCDohJrmnKxcbiAgICovXG4gIHByaXZhdGUgYWRkQnV0dG9uKHNjcmlwdDogU2NyaXB0KTogdm9pZCB7XG4gICAgaWYgKHNjcmlwdC5idXR0b25zICYmIHNjcmlwdC5idXR0b25zLmxlbmd0aCA+IDApIHtcbiAgICAgIHRoaXMuYnV0dG9uTWFuYWdlci5hZGRCdXR0b25zRm9yU2NyaXB0KHNjcmlwdCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOa4suafk+iEmuacrOWIl+ihqFxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyByZW5kZXJTY3JpcHRMaXN0cygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0aGlzLmNsZWFyU2NyaXB0TGlzdChTY3JpcHRUeXBlLkdMT0JBTCk7XG4gICAgdGhpcy5jbGVhclNjcmlwdExpc3QoU2NyaXB0VHlwZS5DSEFSQUNURVIpO1xuXG4gICAgYXdhaXQgdGhpcy5yZW5kZXJSZXBvc2l0b3J5KFNjcmlwdFR5cGUuR0xPQkFMKTtcblxuICAgIGF3YWl0IHRoaXMucmVuZGVyUmVwb3NpdG9yeShTY3JpcHRUeXBlLkNIQVJBQ1RFUik7XG4gIH1cblxuICAvKipcbiAgICog5riy5p+T5oyH5a6a57G75Z6L55qE6ISa5pys5LuT5bqTXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyByZW5kZXJSZXBvc2l0b3J5KHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCByZXBvc2l0b3J5SXRlbXMgPVxuICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUxcbiAgICAgICAgPyB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0R2xvYmFsUmVwb3NpdG9yeUl0ZW1zKClcbiAgICAgICAgOiB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0Q2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKCk7XG5cbiAgICBpZiAocmVwb3NpdG9yeUl0ZW1zLmxlbmd0aCA+IDApIHtcbiAgICAgIGZvciAoY29uc3QgaXRlbSBvZiByZXBvc2l0b3J5SXRlbXMpIHtcbiAgICAgICAgaWYgKGl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicpIHtcbiAgICAgICAgICBhd2FpdCB0aGlzLnJlbmRlckZvbGRlcihpdGVtLCB0eXBlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBhd2FpdCB0aGlzLmFkZFNjcmlwdFRvQ29udGFpbmVyKGl0ZW0udmFsdWUgYXMgU2NyaXB0LCB0eXBlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnNob3dFbXB0eVNjcmlwdExpc3RUaXAodHlwZSk7XG4gICAgfVxuXG4gICAgdGhpcy5zZXR1cERyYWdnYWJsZSh0eXBlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmuIXpmaTmjIflrprnsbvlnovnmoTohJrmnKzliJfooahcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwcml2YXRlIGNsZWFyU2NyaXB0TGlzdCh0eXBlOiBTY3JpcHRUeXBlKTogdm9pZCB7XG4gICAgJChnZXRTY3JpcHRMaXN0U2VsZWN0b3IodHlwZSkpLmVtcHR5KCk7XG4gIH1cblxuICAvKipcbiAgICog5Yi35paw5oyH5a6a57G75Z6L55qE6ISa5pys5YiX6KGoXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyByZWZyZXNoU2NyaXB0TGlzdCh0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdGhpcy5jbGVhclNjcmlwdExpc3QodHlwZSk7XG5cbiAgICBhd2FpdCB0aGlzLnJlbmRlclJlcG9zaXRvcnkodHlwZSk7XG5cbiAgICBjb25zdCBpc0VuYWJsZWQgPVxuICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUxcbiAgICAgICAgPyB0aGlzLnNjcmlwdE1hbmFnZXIuaXNHbG9iYWxTY3JpcHRFbmFibGVkXG4gICAgICAgIDogdGhpcy5zY3JpcHRNYW5hZ2VyLmlzQ2hhcmFjdGVyU2NyaXB0RW5hYmxlZDtcbiAgICBjb25zdCB0b2dnbGVTZWxlY3RvciA9IGdldFNjcmlwdFRvZ2dsZVNlbGVjdG9yKHR5cGUpO1xuICAgICQodG9nZ2xlU2VsZWN0b3IpLnByb3AoJ2NoZWNrZWQnLCBpc0VuYWJsZWQpO1xuICB9XG5cbiAgLyoqXG4gICAqIOaYvuekuuepuuiEmuacrOWIl+ihqOaPkOekulxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHByaXZhdGUgc2hvd0VtcHR5U2NyaXB0TGlzdFRpcCh0eXBlOiBTY3JpcHRUeXBlKTogdm9pZCB7XG4gICAgY29uc3QgY29udGFpbmVyID0gJChnZXRTY3JpcHRMaXN0U2VsZWN0b3IodHlwZSkpO1xuICAgIGlmIChjb250YWluZXIuZmluZCgnc21hbGwnKS5sZW5ndGggPT09IDApIHtcbiAgICAgIGNvbnRhaW5lci5hcHBlbmQoJzxzbWFsbD7mmoLml6DohJrmnKw8L3NtYWxsPicpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDliLfmlrDohJrmnKznirbmgIFcbiAgICogQHBhcmFtIHNjcmlwdCDohJrmnKxcbiAgICogQHBhcmFtIGVuYWJsZSDmmK/lkKblkK/nlKhcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgcmVmcmVzaFNjcmlwdFN0YXRlKHNjcmlwdDogU2NyaXB0LCBlbmFibGU6IGJvb2xlYW4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCAkc2NyaXB0ID0gJChgIyR7c2NyaXB0LmlkfWApO1xuICAgIGlmICgkc2NyaXB0Lmxlbmd0aCA+IDApIHtcbiAgICAgIGlmIChlbmFibGUpIHtcbiAgICAgICAgJHNjcmlwdC5maW5kKCcuc2NyaXB0LXRvZ2dsZScpLmFkZENsYXNzKCdlbmFibGVkJyk7XG4gICAgICAgICRzY3JpcHQuZmluZCgnLnNjcmlwdC10b2dnbGUgaS5mYS10b2dnbGUtb2ZmJykuaGlkZSgpO1xuICAgICAgICAkc2NyaXB0LmZpbmQoJy5zY3JpcHQtdG9nZ2xlIGkuZmEtdG9nZ2xlLW9uJykuc2hvdygpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgJHNjcmlwdC5maW5kKCcuc2NyaXB0LXRvZ2dsZScpLnJlbW92ZUNsYXNzKCdlbmFibGVkJyk7XG4gICAgICAgICRzY3JpcHQuZmluZCgnLnNjcmlwdC10b2dnbGUgaS5mYS10b2dnbGUtb2ZmJykuc2hvdygpO1xuICAgICAgICAkc2NyaXB0LmZpbmQoJy5zY3JpcHQtdG9nZ2xlIGkuZmEtdG9nZ2xlLW9uJykuaGlkZSgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDliLfmlrDohJrmnKznsbvlnovnirbmgIFcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqIEBwYXJhbSBlbmFibGUg5piv5ZCm5ZCv55SoXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHJlZnJlc2hUeXBlU3RhdGUodHlwZTogU2NyaXB0VHlwZSwgZW5hYmxlOiBib29sZWFuKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgJHRvZ2dsZSA9ICQoZ2V0U2NyaXB0VG9nZ2xlU2VsZWN0b3IodHlwZSkpO1xuICAgICR0b2dnbGUucHJvcCgnY2hlY2tlZCcsIGVuYWJsZSk7XG4gIH1cblxuICAvKipcbiAgICog5pu05paw5paH5Lu25aS55Y+K5YW25YaF6YOo6ISa5pys55qEVUnnirbmgIFcbiAgICogQHBhcmFtIGZvbGRlcklkIOaWh+S7tuWkuUlEXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKiBAcGFyYW0gZW5hYmxlIOaYr+WQpuWQr+eUqFxuICAgKi9cbiAgcHJpdmF0ZSB1cGRhdGVGb2xkZXJBbmRTY3JpcHRzVUkoZm9sZGVySWQ6IHN0cmluZywgdHlwZTogU2NyaXB0VHlwZSwgZW5hYmxlOiBib29sZWFuKTogdm9pZCB7XG4gICAgY29uc3QgJGZvbGRlciA9ICQoYCMke2ZvbGRlcklkfWApO1xuICAgIGlmICgkZm9sZGVyLmxlbmd0aCA+IDApIHtcbiAgICAgIHRoaXMudXBkYXRlRm9sZGVyVG9nZ2xlU3RhdGUoJGZvbGRlciwgZm9sZGVySWQsIHR5cGUpO1xuXG4gICAgICBjb25zdCAkZm9sZGVyQ29udGVudCA9ICRmb2xkZXIuZmluZCgnLmZvbGRlci1jb250ZW50Jyk7XG4gICAgICAkZm9sZGVyQ29udGVudC5maW5kKCcuc2NyaXB0LWl0ZW0nKS5lYWNoKChfLCBlbGVtZW50KSA9PiB7XG4gICAgICAgIGNvbnN0ICRzY3JpcHQgPSAkKGVsZW1lbnQpO1xuICAgICAgICBjb25zdCAkdG9nZ2xlID0gJHNjcmlwdC5maW5kKCcuc2NyaXB0LXRvZ2dsZScpO1xuXG4gICAgICAgIGlmIChlbmFibGUpIHtcbiAgICAgICAgICAkdG9nZ2xlLmFkZENsYXNzKCdlbmFibGVkJyk7XG4gICAgICAgICAgJHRvZ2dsZS5maW5kKCdpLmZhLXRvZ2dsZS1vZmYnKS5oaWRlKCk7XG4gICAgICAgICAgJHRvZ2dsZS5maW5kKCdpLmZhLXRvZ2dsZS1vbicpLnNob3coKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAkdG9nZ2xlLnJlbW92ZUNsYXNzKCdlbmFibGVkJyk7XG4gICAgICAgICAgJHRvZ2dsZS5maW5kKCdpLmZhLXRvZ2dsZS1vZmYnKS5zaG93KCk7XG4gICAgICAgICAgJHRvZ2dsZS5maW5kKCdpLmZhLXRvZ2dsZS1vbicpLmhpZGUoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWinumHj+abtOaWsOiEmuacrFVJXG4gICAqIEBwYXJhbSBzY3JpcHQg6ISa5pys5a+56LGhXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSB1cGRhdGVTY3JpcHRVSShzY3JpcHQ6IFNjcmlwdCwgdHlwZTogU2NyaXB0VHlwZSk6IHZvaWQge1xuICAgIGNvbnN0ICRleGlzdGluZ1NjcmlwdCA9ICQoYCMke0NTUy5lc2NhcGUoc2NyaXB0LmlkKX1gKTtcblxuICAgIGlmICgkZXhpc3RpbmdTY3JpcHQubGVuZ3RoID09PSAwKSB7XG4gICAgICB0aGlzLmFkZFNjcmlwdFRvQ29udGFpbmVyKHNjcmlwdCwgdHlwZSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgJGV4aXN0aW5nU2NyaXB0LmZpbmQoJy5zY3JpcHQtaXRlbS1uYW1lJykudGV4dChzY3JpcHQubmFtZSk7XG5cbiAgICBjb25zdCAkdG9nZ2xlID0gJGV4aXN0aW5nU2NyaXB0LmZpbmQoJy5zY3JpcHQtdG9nZ2xlJyk7XG4gICAgaWYgKHNjcmlwdC5lbmFibGVkKSB7XG4gICAgICAkdG9nZ2xlLmFkZENsYXNzKCdlbmFibGVkJyk7XG4gICAgICAkdG9nZ2xlLmZpbmQoJ2kuZmEtdG9nZ2xlLW9mZicpLmhpZGUoKTtcbiAgICAgICR0b2dnbGUuZmluZCgnaS5mYS10b2dnbGUtb24nKS5zaG93KCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICR0b2dnbGUucmVtb3ZlQ2xhc3MoJ2VuYWJsZWQnKTtcbiAgICAgICR0b2dnbGUuZmluZCgnaS5mYS10b2dnbGUtb2ZmJykuc2hvdygpO1xuICAgICAgJHRvZ2dsZS5maW5kKCdpLmZhLXRvZ2dsZS1vbicpLmhpZGUoKTtcbiAgICB9XG5cbiAgICBjb25zdCAkbW92ZUJ1dHRvbiA9ICRleGlzdGluZ1NjcmlwdC5maW5kKCcuc2NyaXB0LXN0b3JhZ2UtbG9jYXRpb24nKTtcbiAgICAkbW92ZUJ1dHRvbi5yZW1vdmVDbGFzcygnbW92ZS10by1jaGFyYWN0ZXIgbW92ZS10by1nbG9iYWwnKTtcbiAgICAkbW92ZUJ1dHRvbi5hZGRDbGFzcyh0eXBlID09PSAnZ2xvYmFsJyA/ICdtb3ZlLXRvLWNoYXJhY3RlcicgOiAnbW92ZS10by1nbG9iYWwnKTtcblxuICAgIGNvbnN0ICRtb3ZlSWNvbiA9ICRtb3ZlQnV0dG9uLmZpbmQoJ2knKTtcbiAgICAkbW92ZUljb24ucmVtb3ZlQ2xhc3MoJ2ZhLWFycm93LWRvd24gZmEtYXJyb3ctdXAnKTtcbiAgICAkbW92ZUljb24uYWRkQ2xhc3ModHlwZSA9PT0gJ2dsb2JhbCcgPyAnZmEtYXJyb3ctZG93bicgOiAnZmEtYXJyb3ctdXAnKTtcblxuICAgIHRoaXMucmViaW5kU2NyaXB0RXZlbnRzKCRleGlzdGluZ1NjcmlwdCwgc2NyaXB0LCB0eXBlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDph43mlrDnu5HlrprohJrmnKzkuovku7ZcbiAgICogQHBhcmFtICRzY3JpcHRFbGVtZW50IOiEmuacrERPTeWFg+e0oFxuICAgKiBAcGFyYW0gc2NyaXB0IOiEmuacrOWvueixoVxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHByaXZhdGUgcmViaW5kU2NyaXB0RXZlbnRzKCRzY3JpcHRFbGVtZW50OiBKUXVlcnk8SFRNTEVsZW1lbnQ+LCBzY3JpcHQ6IFNjcmlwdCwgdHlwZTogU2NyaXB0VHlwZSk6IHZvaWQge1xuICAgICRzY3JpcHRFbGVtZW50LmZpbmQoJy5zY3JpcHQtdG9nZ2xlJykub2ZmKCdjbGljay5zY3JpcHRUb2dnbGUnKTtcbiAgICAkc2NyaXB0RWxlbWVudC5maW5kKCcuc2NyaXB0LWluZm8nKS5vZmYoJ2NsaWNrLnNjcmlwdEluZm8nKTtcbiAgICAkc2NyaXB0RWxlbWVudC5maW5kKCcuZWRpdC1zY3JpcHQnKS5vZmYoJ2NsaWNrLnNjcmlwdEVkaXQnKTtcbiAgICAkc2NyaXB0RWxlbWVudC5maW5kKCcuc2NyaXB0LXN0b3JhZ2UtbG9jYXRpb24nKS5vZmYoJ2NsaWNrLnNjcmlwdE1vdmUnKTtcbiAgICAkc2NyaXB0RWxlbWVudC5maW5kKCcuZXhwb3J0LXNjcmlwdCcpLm9mZignY2xpY2suc2NyaXB0RXhwb3J0Jyk7XG4gICAgJHNjcmlwdEVsZW1lbnQuZmluZCgnLmRlbGV0ZS1zY3JpcHQnKS5vZmYoJ2NsaWNrLnNjcmlwdERlbGV0ZScpO1xuXG4gICAgY29uc3QgJHRvZ2dsZUJ1dHRvbiA9ICRzY3JpcHRFbGVtZW50LmZpbmQoJy5zY3JpcHQtdG9nZ2xlJyk7XG4gICAgJHRvZ2dsZUJ1dHRvbi5vbignY2xpY2suc2NyaXB0VG9nZ2xlJywgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgaXNFbmFibGVkID0gJCh0aGlzKS5oYXNDbGFzcygnZW5hYmxlZCcpO1xuICAgICAgY29uc3QgbmV3U3RhdGUgPSAhaXNFbmFibGVkO1xuXG4gICAgICBpZiAobmV3U3RhdGUpIHtcbiAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygnZW5hYmxlZCcpO1xuICAgICAgICAkKHRoaXMpLmZpbmQoJ2kuZmEtdG9nZ2xlLW9mZicpLmhpZGUoKTtcbiAgICAgICAgJCh0aGlzKS5maW5kKCdpLmZhLXRvZ2dsZS1vbicpLnNob3coKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoJ2VuYWJsZWQnKTtcbiAgICAgICAgJCh0aGlzKS5maW5kKCdpLmZhLXRvZ2dsZS1vZmYnKS5zaG93KCk7XG4gICAgICAgICQodGhpcykuZmluZCgnaS5mYS10b2dnbGUtb24nKS5oaWRlKCk7XG4gICAgICB9XG5cbiAgICAgIHNjcmlwdC5lbmFibGVkID0gbmV3U3RhdGU7XG5cbiAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuU0NSSVBUX1RPR0dMRSwge1xuICAgICAgICBzY3JpcHQsXG4gICAgICAgIHR5cGUsXG4gICAgICAgIGVuYWJsZTogbmV3U3RhdGUsXG4gICAgICAgIHVzZXJJbnB1dDogdHJ1ZSxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgJHNjcmlwdEVsZW1lbnQuZmluZCgnLnNjcmlwdC1pbmZvJykub24oJ2NsaWNrLnNjcmlwdEluZm8nLCAoKSA9PiB7XG4gICAgICBjb25zdCBzY3JpcHRJbmZvID0gc2NyaXB0LmluZm8gfHwgJyc7XG4gICAgICBjb25zdCBodG1sVGV4dCA9IHJlbmRlck1hcmtkb3duKHNjcmlwdEluZm8pO1xuICAgICAgY2FsbEdlbmVyaWNQb3B1cChodG1sVGV4dCwgUE9QVVBfVFlQRS5ESVNQTEFZLCB1bmRlZmluZWQsIHsgd2lkZTogdHJ1ZSB9KTtcbiAgICB9KTtcblxuICAgICRzY3JpcHRFbGVtZW50LmZpbmQoJy5lZGl0LXNjcmlwdCcpLm9uKCdjbGljay5zY3JpcHRFZGl0JywgZSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5TQ1JJUFRfRURJVCwgeyB0eXBlLCBzY3JpcHRJZDogc2NyaXB0LmlkIH0pO1xuICAgIH0pO1xuXG4gICAgJHNjcmlwdEVsZW1lbnQuZmluZCgnLnNjcmlwdC1zdG9yYWdlLWxvY2F0aW9uJykub24oJ2NsaWNrLnNjcmlwdE1vdmUnLCAoKSA9PiB7XG4gICAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlNDUklQVF9NT1ZFLCB7IHNjcmlwdCwgZnJvbVR5cGU6IHR5cGUgfSk7XG4gICAgfSk7XG5cbiAgICAkc2NyaXB0RWxlbWVudC5maW5kKCcuZXhwb3J0LXNjcmlwdCcpLm9uKCdjbGljay5zY3JpcHRFeHBvcnQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBmaWxlTmFtZSA9IGAke3NjcmlwdC5uYW1lLnJlcGxhY2UoL1tcXHMuPD46XCIvXFxcXHw/KlxceDAwLVxceDFGXFx4N0ZdL2csICdfJykudG9Mb3dlckNhc2UoKX0uanNvbmA7XG4gICAgICBjb25zdCBzY3JpcHREYXRhID0gYXdhaXQgdGhpcy5jaGVja1NjcmlwdERhdGFBbmRHZXRFeHBvcnREYXRhKHNjcmlwdCk7XG5cbiAgICAgIGlmIChzY3JpcHREYXRhID09PSBudWxsKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZmlsZURhdGEgPSBKU09OLnN0cmluZ2lmeShzY3JpcHREYXRhLCBudWxsLCAyKTtcbiAgICAgIGRvd25sb2FkKGZpbGVEYXRhLCBmaWxlTmFtZSwgJ2FwcGxpY2F0aW9uL2pzb24nKTtcbiAgICB9KTtcblxuICAgICRzY3JpcHRFbGVtZW50LmZpbmQoJy5kZWxldGUtc2NyaXB0Jykub24oJ2NsaWNrLnNjcmlwdERlbGV0ZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbmZpcm0gPSBhd2FpdCBjYWxsR2VuZXJpY1BvcHVwKCfnoa7lrpropoHliKDpmaTov5nkuKrohJrmnKzlkJfvvJ8nLCBQT1BVUF9UWVBFLkNPTkZJUk0pO1xuXG4gICAgICBpZiAoIWNvbmZpcm0pIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlNDUklQVF9ERUxFVEUsIHsgc2NyaXB0SWQ6IHNjcmlwdC5pZCwgdHlwZSB9KTtcbiAgICAgICRzY3JpcHRFbGVtZW50LnJlbW92ZSgpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOenu+mZpOiEmuacrOWFg+e0oFxuICAgKiBAcGFyYW0gc2NyaXB0SWQg6ISa5pysSURcbiAgICovXG4gIHByaXZhdGUgcmVtb3ZlU2NyaXB0RWxlbWVudChzY3JpcHRJZDogc3RyaW5nKTogdm9pZCB7XG4gICAgJChgIyR7c2NyaXB0SWR9YCkucmVtb3ZlKCk7XG4gIH1cblxuICAvKipcbiAgICog5aSE55CG6ISa5pys56e75YqoXG4gICAqIEBwYXJhbSBzY3JpcHQg6ISa5pysXG4gICAqIEBwYXJhbSBmcm9tVHlwZSDmupDnsbvlnotcbiAgICogQHBhcmFtIHRhcmdldFR5cGUg55uu5qCH57G75Z6LXG4gICAqL1xuICBwcml2YXRlIGhhbmRsZVNjcmlwdE1vdmVkKHNjcmlwdDogU2NyaXB0LCBmcm9tVHlwZTogU2NyaXB0VHlwZSwgdGFyZ2V0VHlwZTogU2NyaXB0VHlwZSk6IHZvaWQge1xuICAgICQoYCMke3NjcmlwdC5pZH1gKS5yZW1vdmUoKTtcblxuICAgIGNvbnN0IHNvdXJjZUxpc3QgPSBmcm9tVHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyAkKCcjZ2xvYmFsLXNjcmlwdC1saXN0JykgOiAkKCcjY2hhcmFjdGVyLXNjcmlwdC1saXN0Jyk7XG4gICAgaWYgKHNvdXJjZUxpc3QuY2hpbGRyZW4oKS5sZW5ndGggPT09IDApIHtcbiAgICAgIHRoaXMuc2hvd0VtcHR5U2NyaXB0TGlzdFRpcChmcm9tVHlwZSk7XG4gICAgfVxuXG4gICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5VSV9SRUZSRVNILCB7XG4gICAgICBhY3Rpb246ICdzY3JpcHRfaW1wb3J0JyxcbiAgICAgIHNjcmlwdCxcbiAgICAgIHR5cGU6IHRhcmdldFR5cGUsXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog5ZCR5a655Zmo5re75Yqg6ISa5pys5YWD57SgXG4gICAqIEBwYXJhbSBzY3JpcHQg6ISa5pysXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBhZGRTY3JpcHRUb0NvbnRhaW5lcihzY3JpcHQ6IFNjcmlwdCwgdHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0ICRzY3JpcHRFbGVtZW50ID0gYXdhaXQgdGhpcy5jcmVhdGVTY3JpcHRFbGVtZW50KHNjcmlwdCwgdHlwZSk7XG4gICAgY29uc3QgbGlzdCA9ICQoZ2V0U2NyaXB0TGlzdFNlbGVjdG9yKHR5cGUpKTtcblxuICAgIGNvbnN0ICRlbXB0eVRpcCA9IGxpc3QuZmluZCgnc21hbGwnKTtcbiAgICBpZiAoJGVtcHR5VGlwLmxlbmd0aCA+IDApIHtcbiAgICAgICRlbXB0eVRpcC5yZW1vdmUoKTtcbiAgICB9XG5cbiAgICBsaXN0LmFwcGVuZCgkc2NyaXB0RWxlbWVudCk7XG4gIH1cblxuICAvKipcbiAgICog6K6+572u6ISa5pys5ouW5ou95o6S5bqPXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBzZXR1cERyYWdnYWJsZSh0eXBlOiBTY3JpcHRUeXBlKTogdm9pZCB7XG4gICAgY29uc3QgbGlzdCA9ICQoZ2V0U2NyaXB0TGlzdFNlbGVjdG9yKHR5cGUpKTtcblxuICAgIGxpc3Quc29ydGFibGUoe1xuICAgICAgZGVsYXk6IGdldFNvcnRhYmxlRGVsYXkoKSxcbiAgICAgIGl0ZW1zOiAnLnNjcmlwdC1pdGVtLCAuc2NyaXB0LWZvbGRlcicsXG4gICAgICBoYW5kbGU6ICcuZHJhZy1oYW5kbGUnLFxuICAgICAgY3Vyc29yOiAnbW92ZScsXG4gICAgICB0b2xlcmFuY2U6ICdwb2ludGVyJyxcbiAgICAgIHBsYWNlaG9sZGVyOiAnc29ydGFibGUtcGxhY2Vob2xkZXInLFxuICAgICAgY29ubmVjdFdpdGg6ICcuZm9sZGVyLWNvbnRlbnQnLFxuXG4gICAgICBzdG9wOiBhc3luYyBfZXZlbnQgPT4ge1xuICAgICAgICBhd2FpdCB0aGlzLmhhbmRsZURyYWdTdG9wKHR5cGUpO1xuICAgICAgfSxcbiAgICB9KTtcblxuICAgIHRoaXMuc2V0dXBGb2xkZXJEcm9wWm9uZXModHlwZSk7XG4gIH1cblxuICAvKipcbiAgICog6K6+572u5paH5Lu25aS55ouW5ou95Yqf6IO9XG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBzZXR1cEZvbGRlckRyYWdnYWJsZSh0eXBlOiBTY3JpcHRUeXBlKTogdm9pZCB7XG4gICAgY29uc3QgbGlzdCA9ICQoZ2V0U2NyaXB0TGlzdFNlbGVjdG9yKHR5cGUpKTtcblxuICAgIGxpc3QuZmluZCgnLmZvbGRlci1jb250ZW50Jykuc29ydGFibGUoe1xuICAgICAgZGVsYXk6IGdldFNvcnRhYmxlRGVsYXkoKSxcbiAgICAgIGl0ZW1zOiAnLnNjcmlwdC1pdGVtJyxcbiAgICAgIGhhbmRsZTogJy5kcmFnLWhhbmRsZScsXG4gICAgICBjdXJzb3I6ICdtb3ZlJyxcbiAgICAgIHRvbGVyYW5jZTogJ3BvaW50ZXInLFxuICAgICAgcGxhY2Vob2xkZXI6ICdzb3J0YWJsZS1wbGFjZWhvbGRlcicsXG4gICAgICBjb25uZWN0V2l0aDogYCR7Z2V0U2NyaXB0TGlzdFNlbGVjdG9yKHR5cGUpfSwgLmZvbGRlci1jb250ZW50YCxcbiAgICAgIHN0b3A6IGFzeW5jIF9ldmVudCA9PiB7XG4gICAgICAgIGF3YWl0IHRoaXMuaGFuZGxlRHJhZ1N0b3AodHlwZSk7XG4gICAgICB9LFxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOiuvue9ruaWh+S7tuWkueaLluaLveaOpeaUtuWMuuWfn1xuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHByaXZhdGUgc2V0dXBGb2xkZXJEcm9wWm9uZXModHlwZTogU2NyaXB0VHlwZSk6IHZvaWQge1xuICAgIGNvbnN0IGxpc3QgPSAkKGdldFNjcmlwdExpc3RTZWxlY3Rvcih0eXBlKSk7XG5cbiAgICBsaXN0LmZpbmQoJy5zY3JpcHQtZm9sZGVyJykuZWFjaCgoXywgZm9sZGVyRWxlbWVudCkgPT4ge1xuICAgICAgdGhpcy5zZXR1cFNpbmdsZUZvbGRlckRyb3Bab25lKCQoZm9sZGVyRWxlbWVudCksIHR5cGUpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOS4uuWNleS4quaWh+S7tuWkueiuvue9ruaLluaLveaOpeaUtuWMuuWfn1xuICAgKiBAcGFyYW0gJGZvbGRlciDmlofku7blpLlqUXVlcnnlr7nosaFcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwcml2YXRlIHNldHVwU2luZ2xlRm9sZGVyRHJvcFpvbmUoJGZvbGRlcjogSlF1ZXJ5PEhUTUxFbGVtZW50PiwgdHlwZTogU2NyaXB0VHlwZSk6IHZvaWQge1xuICAgIGNvbnN0ICRmb2xkZXJDb250ZW50ID0gJGZvbGRlci5maW5kKCcuZm9sZGVyLWNvbnRlbnQnKTtcblxuICAgICRmb2xkZXIub2ZmKCcuZHJhZ2Ryb3AnKTtcblxuICAgICRmb2xkZXIub24oJ2RyYWdvdmVyIGRyYWdlbnRlciBkcmFnbGVhdmUgZHJvcCcsIGZ1bmN0aW9uIChlKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pO1xuXG4gICAgJGZvbGRlci5kcm9wcGFibGUoe1xuICAgICAgYWNjZXB0OiAnLnNjcmlwdC1pdGVtW2RhdGEtc2NyaXB0LXJlcG9zaXRvcnk9XCJ0cnVlXCJdJyxcbiAgICAgIHRvbGVyYW5jZTogJ3BvaW50ZXInLFxuICAgICAgZ3JlZWR5OiB0cnVlLFxuICAgICAgb3ZlcjogKF9ldmVudCwgdWkpID0+IHtcbiAgICAgICAgaWYgKCF1aS5kcmFnZ2FibGUuaGFzQ2xhc3MoJ3NjcmlwdC1pdGVtJykgfHwgIXVpLmRyYWdnYWJsZS5hdHRyKCdkYXRhLXNjcmlwdC1yZXBvc2l0b3J5JykpIHJldHVybjtcblxuICAgICAgICBjb25zdCBpc0Zyb21TYW1lRm9sZGVyID0gdWkuZHJhZ2dhYmxlLmNsb3Nlc3QoJy5zY3JpcHQtZm9sZGVyJykuYXR0cignaWQnKSA9PT0gJGZvbGRlci5hdHRyKCdpZCcpO1xuICAgICAgICBpZiAoaXNGcm9tU2FtZUZvbGRlcikgcmV0dXJuO1xuXG4gICAgICAgICRmb2xkZXIuYWRkQ2xhc3MoJ2ZvbGRlci1kcmFnLXRhcmdldCcpO1xuXG4gICAgICAgIGlmICghJGZvbGRlckNvbnRlbnQuaXMoJzp2aXNpYmxlJykpIHtcbiAgICAgICAgICAkZm9sZGVyQ29udGVudC5zbGlkZURvd24oMjAwKTtcbiAgICAgICAgICAkZm9sZGVyLmZpbmQoJy5mb2xkZXItdG9nZ2xlJykuYWRkQ2xhc3MoJ2V4cGFuZGVkJyk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBvdXQ6IChfZXZlbnQsIHVpKSA9PiB7XG4gICAgICAgIGlmICghdWkuZHJhZ2dhYmxlLmhhc0NsYXNzKCdzY3JpcHQtaXRlbScpIHx8ICF1aS5kcmFnZ2FibGUuYXR0cignZGF0YS1zY3JpcHQtcmVwb3NpdG9yeScpKSByZXR1cm47XG5cbiAgICAgICAgY29uc3QgaXNGcm9tU2FtZUZvbGRlciA9IHVpLmRyYWdnYWJsZS5jbG9zZXN0KCcuc2NyaXB0LWZvbGRlcicpLmF0dHIoJ2lkJykgPT09ICRmb2xkZXIuYXR0cignaWQnKTtcbiAgICAgICAgaWYgKGlzRnJvbVNhbWVGb2xkZXIpIHJldHVybjtcblxuICAgICAgICAkZm9sZGVyLnJlbW92ZUNsYXNzKCdmb2xkZXItZHJhZy10YXJnZXQnKTtcbiAgICAgIH0sXG4gICAgICBkcm9wOiBhc3luYyAoZXZlbnQsIHVpKSA9PiB7XG4gICAgICAgIGlmIChldmVudC5vcmlnaW5hbEV2ZW50KSB7XG4gICAgICAgICAgZXZlbnQub3JpZ2luYWxFdmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIGV2ZW50Lm9yaWdpbmFsRXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIH1cbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZXZlbnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG5cbiAgICAgICAgaWYgKCF1aS5kcmFnZ2FibGUuaGFzQ2xhc3MoJ3NjcmlwdC1pdGVtJykgfHwgIXVpLmRyYWdnYWJsZS5hdHRyKCdkYXRhLXNjcmlwdC1yZXBvc2l0b3J5JykpIHJldHVybjtcblxuICAgICAgICBjb25zdCBzY3JpcHRJZCA9IHVpLmRyYWdnYWJsZS5hdHRyKCdpZCcpO1xuICAgICAgICBjb25zdCBmb2xkZXJJZCA9ICRmb2xkZXIuYXR0cignaWQnKTtcblxuICAgICAgICBjb25zdCBpc0Zyb21TYW1lRm9sZGVyID0gdWkuZHJhZ2dhYmxlLmNsb3Nlc3QoJy5zY3JpcHQtZm9sZGVyJykuYXR0cignaWQnKSA9PT0gZm9sZGVySWQ7XG4gICAgICAgIGlmIChpc0Zyb21TYW1lRm9sZGVyKSB7XG4gICAgICAgICAgJGZvbGRlci5yZW1vdmVDbGFzcygnZm9sZGVyLWRyYWctdGFyZ2V0Jyk7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHNjcmlwdElkICYmIGZvbGRlcklkKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHN1Y2Nlc3MgPSBhd2FpdCB0aGlzLmhhbmRsZVNjcmlwdERyb3BUb0ZvbGRlcihzY3JpcHRJZCwgZm9sZGVySWQsIHR5cGUsIHVpLmRyYWdnYWJsZSk7XG5cbiAgICAgICAgICAgIGlmICghc3VjY2Vzcykge1xuICAgICAgICAgICAgICAkZm9sZGVyLnJlbW92ZUNsYXNzKCdmb2xkZXItZHJhZy10YXJnZXQnKTtcbiAgICAgICAgICAgICAgc2V0VGltZW91dChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5yZW5kZXJTY3JpcHRMaXN0cygpO1xuICAgICAgICAgICAgICB9LCAxMDApO1xuICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGxvZy5lcnJvcignW1NjcmlwdE1hbmFnZXJdIOaLluaLveiEmuacrOWIsOaWh+S7tuWkueWksei0pTonLCBlcnJvcik7XG4gICAgICAgICAgICB0b2FzdHIuZXJyb3IoYOenu+WKqOiEmuacrOWksei0pTogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcil9YCk7XG5cbiAgICAgICAgICAgICRmb2xkZXIucmVtb3ZlQ2xhc3MoJ2ZvbGRlci1kcmFnLXRhcmdldCcpO1xuICAgICAgICAgICAgc2V0VGltZW91dChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgIGF3YWl0IHRoaXMucmVuZGVyU2NyaXB0TGlzdHMoKTtcbiAgICAgICAgICAgIH0sIDEwMCk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgJGZvbGRlci5yZW1vdmVDbGFzcygnZm9sZGVyLWRyYWctdGFyZ2V0Jyk7XG5cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfSxcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlpITnkIbohJrmnKzmi5bmi73liLDmlofku7blpLnnmoTkuovku7ZcbiAgICogQHBhcmFtIHNjcmlwdElkIOiEmuacrElEXG4gICAqIEBwYXJhbSBmb2xkZXJJZCDmlofku7blpLlJRFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICogQHBhcmFtICRkcmFnZ2VkRWxlbWVudCDmi5bmi73nmoTlhYPntKBcbiAgICogQHJldHVybnMg5piv5ZCm5oiQ5Yqf56e75Yqo6ISa5pysXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGhhbmRsZVNjcmlwdERyb3BUb0ZvbGRlcihcbiAgICBzY3JpcHRJZDogc3RyaW5nLFxuICAgIGZvbGRlcklkOiBzdHJpbmcsXG4gICAgdHlwZTogU2NyaXB0VHlwZSxcbiAgICAkZHJhZ2dlZEVsZW1lbnQ6IEpRdWVyeTxIVE1MRWxlbWVudD4sXG4gICk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXBvc2l0b3J5ID1cbiAgICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUxcbiAgICAgICAgICA/IHRoaXMuc2NyaXB0TWFuYWdlci5nZXRHbG9iYWxSZXBvc2l0b3J5SXRlbXMoKVxuICAgICAgICAgIDogdGhpcy5zY3JpcHRNYW5hZ2VyLmdldENoYXJhY3RlclJlcG9zaXRvcnlJdGVtcygpO1xuXG4gICAgICBjb25zdCBmb2xkZXIgPSByZXBvc2l0b3J5LmZpbmQoaXRlbSA9PiBpdGVtLnR5cGUgPT09ICdmb2xkZXInICYmIGl0ZW0uaWQgPT09IGZvbGRlcklkKTtcbiAgICAgIGlmIChmb2xkZXIpIHtcbiAgICAgICAgY29uc3Qgc2NyaXB0cyA9IGZvbGRlci52YWx1ZSBhcyBTY3JpcHRbXTtcbiAgICAgICAgY29uc3Qgc2NyaXB0RXhpc3RzID0gc2NyaXB0cy5zb21lKHNjcmlwdCA9PiBzY3JpcHQuaWQgPT09IHNjcmlwdElkKTtcblxuICAgICAgICBpZiAoc2NyaXB0RXhpc3RzKSB7XG4gICAgICAgICAgdG9hc3RyLmluZm8oJ+iEmuacrOW3sue7j+WcqOivpeaWh+S7tuWkueS4rScpO1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBhd2FpdCB0aGlzLnNjcmlwdE1hbmFnZXIubW92ZVNjcmlwdFRvRm9sZGVyKHNjcmlwdElkLCBmb2xkZXJJZCwgdHlwZSk7XG5cbiAgICAgIGNvbnN0ICR0YXJnZXRGb2xkZXIgPSAkKGAjJHtmb2xkZXJJZH1gKTtcbiAgICAgIGNvbnN0ICRmb2xkZXJDb250ZW50ID0gJHRhcmdldEZvbGRlci5maW5kKCcuZm9sZGVyLWNvbnRlbnQnKTtcblxuICAgICAgaWYgKCEkZm9sZGVyQ29udGVudC5pcygnOnZpc2libGUnKSkge1xuICAgICAgICAkZm9sZGVyQ29udGVudC5zaG93KCk7XG4gICAgICAgICR0YXJnZXRGb2xkZXIuZmluZCgnLmZvbGRlci10b2dnbGUnKS5hZGRDbGFzcygnZXhwYW5kZWQnKTtcbiAgICAgIH1cblxuICAgICAgJGRyYWdnZWRFbGVtZW50LmRldGFjaCgpLnByZXBlbmRUbygkZm9sZGVyQ29udGVudCk7XG5cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2cuZXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDnp7vliqjohJrmnKzliLDmlofku7blpLnlpLHotKU6JywgZXJyb3IpO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWkhOeQhuaLluaLvee7k+adn+S6i+S7tlxuICAgKiBAcGFyYW0gdWkgalF1ZXJ5IFVJIOaLluaLveS6i+S7tuWvueixoVxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgaGFuZGxlRHJhZ1N0b3AodHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXBvc2l0b3J5SXRlbXMgPSBhd2FpdCB0aGlzLmJ1aWxkUmVwb3NpdG9yeUZyb21ET00odHlwZSk7XG5cbiAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuT1JERVJfQ0hBTkdFRCwge1xuICAgICAgICBkYXRhOiByZXBvc2l0b3J5SXRlbXMsXG4gICAgICAgIHR5cGUsXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nLmVycm9yKCdbU2NyaXB0TWFuYWdlcl0gaGFuZGxlRHJhZ1N0b3A6IOWkhOeQhuaLluaLvee7k+adn+Wksei0pTonLCBlcnJvcik7XG4gICAgfVxuICB9XG4gIC8qKlxuICAgKiDku45ET03mnoTlu7rku5PlupPnu5PmnoRcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGJ1aWxkUmVwb3NpdG9yeUZyb21ET00odHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8U2NyaXB0UmVwb3NpdG9yeUl0ZW1bXT4ge1xuICAgIGNvbnN0IGxpc3QgPSAkKGdldFNjcmlwdExpc3RTZWxlY3Rvcih0eXBlKSk7XG4gICAgY29uc3QgcmVwb3NpdG9yeTogU2NyaXB0UmVwb3NpdG9yeUl0ZW1bXSA9IFtdO1xuXG4gICAgZm9yIChjb25zdCBlbGVtZW50IG9mIGxpc3QuY2hpbGRyZW4oKS5nZXQoKSkge1xuICAgICAgY29uc3QgJGVsZW1lbnQgPSAkKGVsZW1lbnQpO1xuXG4gICAgICBpZiAoJGVsZW1lbnQuaGFzQ2xhc3MoJ3NjcmlwdC1mb2xkZXInKSkge1xuICAgICAgICBjb25zdCBmb2xkZXJJZCA9ICRlbGVtZW50LmF0dHIoJ2lkJykhO1xuICAgICAgICBjb25zdCBmb2xkZXJOYW1lID0gJGVsZW1lbnQuZmluZCgnLmZvbGRlci1uYW1lJykudGV4dCgpO1xuICAgICAgICBjb25zdCBmb2xkZXJJY29uID1cbiAgICAgICAgICAkZWxlbWVudFxuICAgICAgICAgICAgLmZpbmQoJy5mb2xkZXItaWNvbiBpJylcbiAgICAgICAgICAgIC5hdHRyKCdjbGFzcycpXG4gICAgICAgICAgICA/LnNwbGl0KCcgJylcbiAgICAgICAgICAgIC5maW5kKGNscyA9PiBjbHMuc3RhcnRzV2l0aCgnZmEtJykpIHx8ICdmYS1mb2xkZXInO1xuICAgICAgICBjb25zdCBmb2xkZXJDb2xvciA9XG4gICAgICAgICAgJGVsZW1lbnQuZmluZCgnLmZvbGRlci1pY29uJykuY3NzKCdjb2xvcicpIHx8XG4gICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLmdldFByb3BlcnR5VmFsdWUoJy0tU21hcnRUaGVtZUJvZHlDb2xvcicpO1xuXG4gICAgICAgIGNvbnN0IHNjcmlwdHM6IFNjcmlwdFtdID0gW107XG4gICAgICAgIGNvbnN0ICRmb2xkZXJDb250ZW50ID0gJGVsZW1lbnQuZmluZCgnLmZvbGRlci1jb250ZW50Jyk7XG5cbiAgICAgICAgZm9yIChjb25zdCBzY3JpcHRFbGVtZW50IG9mICRmb2xkZXJDb250ZW50LmNoaWxkcmVuKCcuc2NyaXB0LWl0ZW0nKS5nZXQoKSkge1xuICAgICAgICAgIGNvbnN0IHNjcmlwdElkID0gJChzY3JpcHRFbGVtZW50KS5hdHRyKCdpZCcpITtcbiAgICAgICAgICBjb25zdCBzY3JpcHQgPSB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0U2NyaXB0QnlJZChzY3JpcHRJZCk7XG4gICAgICAgICAgaWYgKHNjcmlwdCkge1xuICAgICAgICAgICAgc2NyaXB0cy5wdXNoKHNjcmlwdCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmVwb3NpdG9yeS5wdXNoKHtcbiAgICAgICAgICB0eXBlOiAnZm9sZGVyJyxcbiAgICAgICAgICBpZDogZm9sZGVySWQsXG4gICAgICAgICAgbmFtZTogZm9sZGVyTmFtZSxcbiAgICAgICAgICBpY29uOiBmb2xkZXJJY29uLFxuICAgICAgICAgIGNvbG9yOiBmb2xkZXJDb2xvcixcbiAgICAgICAgICB2YWx1ZTogc2NyaXB0cyxcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2UgaWYgKCRlbGVtZW50Lmhhc0NsYXNzKCdzY3JpcHQtaXRlbScpKSB7XG4gICAgICAgIGNvbnN0IHNjcmlwdElkID0gJGVsZW1lbnQuYXR0cignaWQnKSE7XG4gICAgICAgIGNvbnN0IHNjcmlwdCA9IHRoaXMuc2NyaXB0TWFuYWdlci5nZXRTY3JpcHRCeUlkKHNjcmlwdElkKTtcbiAgICAgICAgaWYgKHNjcmlwdCkge1xuICAgICAgICAgIHJlcG9zaXRvcnkucHVzaCh7XG4gICAgICAgICAgICB0eXBlOiAnc2NyaXB0JyxcbiAgICAgICAgICAgIHZhbHVlOiBzY3JpcHQsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gcmVwb3NpdG9yeTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlhYvpmobpu5jorqTohJrmnKzmqKHmnb9cbiAgICogQHBhcmFtIHNjcmlwdCDohJrmnKxcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgY2xvbmVEZWZhdWx0U2NyaXB0VGVtcGxhdGUoc2NyaXB0OiBTY3JpcHQpOiBQcm9taXNlPEpRdWVyeTxIVE1MRWxlbWVudD4+IHtcbiAgICBpZiAoIXRoaXMuZGVmYXVsdFNjcmlwdFRlbXBsYXRlKSB7XG4gICAgICBhd2FpdCB0aGlzLmluaXRpYWxpemVUZW1wbGF0ZXMoKTtcbiAgICB9XG5cbiAgICBjb25zdCBzY3JpcHRIdG1sID0gdGhpcy5kZWZhdWx0U2NyaXB0VGVtcGxhdGUhLmNsb25lKCk7XG5cbiAgICBjb25zdCB0ZW1wSWQgPSBgZGVmYXVsdF9saWJfJHtzY3JpcHQuaWR9YDtcbiAgICBzY3JpcHRIdG1sLmF0dHIoJ2lkJywgdGVtcElkKTtcblxuICAgIHNjcmlwdEh0bWwuZmluZCgnLnNjcmlwdC1pdGVtLW5hbWUnKS50ZXh0KHNjcmlwdC5uYW1lKTtcbiAgICBzY3JpcHRIdG1sLmZpbmQoJy5zY3JpcHQtaW5mbycpLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAgIGNvbnN0IGh0bWxUZXh0ID0gcmVuZGVyTWFya2Rvd24oc2NyaXB0LmluZm8pO1xuICAgICAgY2FsbEdlbmVyaWNQb3B1cChodG1sVGV4dCwgUE9QVVBfVFlQRS5ESVNQTEFZLCB1bmRlZmluZWQsIHsgd2lkZTogdHJ1ZSB9KTtcbiAgICB9KTtcblxuICAgIHNjcmlwdEh0bWwuZmluZCgnLmFkZC1zY3JpcHQnKS5vbignY2xpY2snLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgdGFyZ2V0OiBTY3JpcHRUeXBlID0gU2NyaXB0VHlwZS5HTE9CQUw7XG4gICAgICBjb25zdCB0ZW1wbGF0ZSA9ICQoXG4gICAgICAgIGF3YWl0IHJlbmRlckV4dGVuc2lvblRlbXBsYXRlQXN5bmModGhpcy50ZW1wbGF0ZVBhdGgsICdzY3JpcHRfdGFyZ2V0X3NlbGVjdG9yJywge1xuICAgICAgICAgIHRpdGxlOiAn5re75Yqg5YiwOicsXG4gICAgICAgICAgcHJlZml4OiAnc2NyaXB0LWFkZCcsXG4gICAgICAgICAgZ2xvYmFsTGFiZWw6ICflhajlsYDohJrmnKzlupMnLFxuICAgICAgICAgIGNoYXJhY3RlckxhYmVsOiAn6KeS6Imy6ISa5pys5bqTJyxcbiAgICAgICAgfSksXG4gICAgICApO1xuICAgICAgdGVtcGxhdGUuZmluZCgnI3NjcmlwdC1hZGQtdGFyZ2V0LWdsb2JhbCcpLm9uKCdpbnB1dCcsICgpID0+ICh0YXJnZXQgPSBTY3JpcHRUeXBlLkdMT0JBTCkpO1xuICAgICAgdGVtcGxhdGUuZmluZCgnI3NjcmlwdC1hZGQtdGFyZ2V0LWNoYXJhY3RlcicpLm9uKCdpbnB1dCcsICgpID0+ICh0YXJnZXQgPSBTY3JpcHRUeXBlLkNIQVJBQ1RFUikpO1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2FsbEdlbmVyaWNQb3B1cCh0ZW1wbGF0ZSwgUE9QVVBfVFlQRS5DT05GSVJNLCAnJywge1xuICAgICAgICBva0J1dHRvbjogJ+ehruiupCcsXG4gICAgICAgIGNhbmNlbEJ1dHRvbjogJ+WPlua2iCcsXG4gICAgICB9KTtcblxuICAgICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBuZXdTY3JpcHQgPSBuZXcgU2NyaXB0KHsgLi4uc2NyaXB0LCBlbmFibGVkOiBmYWxzZSB9KTtcblxuICAgICAgbGV0IGFjdGlvbjogJ25ldycgfCAnb3ZlcnJpZGUnIHwgJ2NhbmNlbCcgPSAnbmV3JztcblxuICAgICAgY29uc3QgZXhpc3Rpbmdfc2NyaXB0ID0gdGhpcy5zY3JpcHRNYW5hZ2VyLmdldFNjcmlwdEJ5SWQoc2NyaXB0LmlkKTtcbiAgICAgIGlmIChleGlzdGluZ19zY3JpcHQpIHtcbiAgICAgICAgY29uc3QgaW5wdXQgPSBhd2FpdCBjYWxsR2VuZXJpY1BvcHVwKFxuICAgICAgICAgIGDopoHlr7zlhaXnmoTohJrmnKwgJyR7c2NyaXB0Lm5hbWV9JyDkuI7ohJrmnKzlupPkuK3nmoQgJyR7ZXhpc3Rpbmdfc2NyaXB0Lm5hbWV9JyBpZCDnm7jlkIzvvIzmmK/lkKbopoHlr7zlhaXvvJ9gLFxuICAgICAgICAgIFBPUFVQX1RZUEUuVEVYVCxcbiAgICAgICAgICAnJyxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBva0J1dHRvbjogJ+imhuebluWOn+iEmuacrCcsXG4gICAgICAgICAgICBjYW5jZWxCdXR0b246ICflj5bmtognLFxuICAgICAgICAgICAgY3VzdG9tQnV0dG9uczogWyfmlrDlu7rohJrmnKwnXSxcbiAgICAgICAgICB9LFxuICAgICAgICApO1xuXG4gICAgICAgIHN3aXRjaCAoaW5wdXQpIHtcbiAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICBhY3Rpb24gPSAnY2FuY2VsJztcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgIGFjdGlvbiA9ICdvdmVycmlkZSc7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICBhY3Rpb24gPSAnbmV3JztcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHN3aXRjaCAoYWN0aW9uKSB7XG4gICAgICAgIGNhc2UgJ25ldyc6XG4gICAgICAgICAgaWYgKGV4aXN0aW5nX3NjcmlwdCkge1xuICAgICAgICAgICAgbmV3U2NyaXB0LmlkID0gdXVpZHY0KCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdvdmVycmlkZSc6XG4gICAgICAgICAge1xuICAgICAgICAgICAgaWYgKCFleGlzdGluZ19zY3JpcHQpIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkKGAjJHtleGlzdGluZ19zY3JpcHQuaWR9YCkucmVtb3ZlKCk7XG5cbiAgICAgICAgICAgIGlmIChleGlzdGluZ19zY3JpcHQuZW5hYmxlZCkge1xuICAgICAgICAgICAgICBhd2FpdCB0aGlzLnNjcmlwdE1hbmFnZXIuc3RvcFNjcmlwdChleGlzdGluZ19zY3JpcHQsIHRhcmdldCk7XG4gICAgICAgICAgICAgIHRoaXMuYnV0dG9uTWFuYWdlci5yZW1vdmVCdXR0b25zQnlTY3JpcHRJZChleGlzdGluZ19zY3JpcHQuaWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnY2FuY2VsJzpcbiAgICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuU0NSSVBUX0NSRUFURSwgeyBzY3JpcHQ6IG5ld1NjcmlwdCwgdHlwZTogdGFyZ2V0IH0pO1xuXG4gICAgICB0b2FzdHIuc3VjY2Vzcyhg6ISa5pysXCIke25ld1NjcmlwdC5uYW1lfVwi5bey5re75Yqg5YiwJHt0YXJnZXQgPT09IFNjcmlwdFR5cGUuR0xPQkFMID8gJ+WFqOWxgCcgOiAn6KeS6ImyJ33ohJrmnKzlupNgKTtcbiAgICB9KTtcblxuICAgIHJldHVybiBzY3JpcHRIdG1sO1xuICB9XG5cbiAgLyoqXG4gICAqIOWIm+W7uum7mOiupOiEmuacrOW6k+WuueWZqFxuICAgKiDpgb/lhY3ph43lpI3muLLmn5PmqKHmnb9cbiAgICovXG4gIHByaXZhdGUgY3JlYXRlRGVmYXVsdFNjcmlwdENvbnRhaW5lcigpOiBKUXVlcnk8SFRNTEVsZW1lbnQ+IHtcbiAgICByZXR1cm4gJCgnPGRpdiBjbGFzcz1cImRlZmF1bHQtc2NyaXB0LXJlcG9zaXRvcnktY29udGFpbmVyXCI+PC9kaXY+Jyk7XG4gIH1cblxuICAvKipcbiAgICog5Yqg6L296buY6K6k6ISa5pys5bqTXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGxvYWREZWZhdWx0U2NyaXB0c1JlcG9zaXRvcnkoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgY29udGFpbmVyID0gdGhpcy5jcmVhdGVEZWZhdWx0U2NyaXB0Q29udGFpbmVyKCk7XG5cbiAgICBjb25zdCBkZWZhdWx0U2NyaXB0cyA9IGF3YWl0IGNyZWF0ZURlZmF1bHRTY3JpcHRzKCk7XG4gICAgZm9yIChjb25zdCBzY3JpcHQgb2YgZGVmYXVsdFNjcmlwdHMpIHtcbiAgICAgIGlmICghc2NyaXB0KSBjb250aW51ZTtcbiAgICAgIGNvbnN0IHNjcmlwdEh0bWwgPSBhd2FpdCB0aGlzLmNsb25lRGVmYXVsdFNjcmlwdFRlbXBsYXRlKHNjcmlwdCk7XG4gICAgICBjb250YWluZXIuYXBwZW5kKHNjcmlwdEh0bWwpO1xuICAgIH1cblxuICAgIGF3YWl0IGNhbGxHZW5lcmljUG9wdXAoY29udGFpbmVyLCBQT1BVUF9UWVBFLkRJU1BMQVksICcnLCB7IHdpZGU6IHRydWUgfSk7XG4gIH1cblxuICAvKipcbiAgICog5omT5byA6ISa5pys57yW6L6R5ZmoXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKiBAcGFyYW0gc2NyaXB0SWQg6ISa5pysSURcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgb3BlblNjcmlwdEVkaXRvcih0eXBlOiBTY3JpcHRUeXBlLCBzY3JpcHRJZD86IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0ICRlZGl0b3JIdG1sID0gJChhd2FpdCByZW5kZXJFeHRlbnNpb25UZW1wbGF0ZUFzeW5jKHRoaXMudGVtcGxhdGVQYXRoLCAnc2NyaXB0X2VkaXRvcicpKTtcbiAgICBsZXQgc2NyaXB0OiBTY3JpcHQgfCB1bmRlZmluZWQ7XG5cbiAgICB0aGlzLnVwZGF0ZVZhcmlhYmxlTGlzdFZpc2liaWxpdHkoJGVkaXRvckh0bWwpO1xuXG4gICAgaWYgKHNjcmlwdElkKSB7XG4gICAgICBzY3JpcHQgPSB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0U2NyaXB0QnlJZChzY3JpcHRJZCk7XG5cbiAgICAgIGlmIChzY3JpcHQpIHtcbiAgICAgICAgJGVkaXRvckh0bWwuZmluZCgnI3NjcmlwdC1uYW1lLWlucHV0JykudmFsKHNjcmlwdC5uYW1lKTtcbiAgICAgICAgJGVkaXRvckh0bWwuZmluZCgnI3NjcmlwdC1jb250ZW50LXRleHRhcmVhJykudmFsKHNjcmlwdC5jb250ZW50KTtcbiAgICAgICAgJGVkaXRvckh0bWwuZmluZCgnI3NjcmlwdC1pbmZvLXRleHRhcmVhJykudmFsKHNjcmlwdC5pbmZvKTtcblxuICAgICAgICBpZiAoc2NyaXB0LmRhdGEgJiYgT2JqZWN0LmtleXMoc2NyaXB0LmRhdGEpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICB0aGlzLmxvYWRWYXJpYWJsZXNUb0VkaXRvcigkZWRpdG9ySHRtbCwgc2NyaXB0LmRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHNjcmlwdC5idXR0b25zICYmIHNjcmlwdC5idXR0b25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBzY3JpcHQuYnV0dG9ucy5mb3JFYWNoKChidXR0b24sIGJ1dHRvbkluZGV4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCAkYnV0dG9uSHRtbCA9ICQoYFxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiYnV0dG9uLWl0ZW1cIiBpZD1cImJ1dHRvbi0ke2J1dHRvbkluZGV4fVwiPlxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZHJhZy1oYW5kbGUgbWVudS1oYW5kbGVcIj7imLA8L3NwYW4+XG4gICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIGlkPVwiY2hlY2tib3gtYnV0dG9uLSR7YnV0dG9uSW5kZXh9XCIgY2xhc3M9XCJidXR0b24tdmlzaWJsZVwiICR7XG4gICAgICAgICAgICAgIGJ1dHRvbi52aXNpYmxlID8gJ2NoZWNrZWQnIDogJydcbiAgICAgICAgICAgIH0+XG4gICAgICAgICAgICAgICAgPGlucHV0IGNsYXNzPVwidGV4dF9wb2xlIGJ1dHRvbi1uYW1lXCIgdHlwZT1cInRleHRcIiBpZD1cInRleHQtYnV0dG9uLSR7YnV0dG9uSW5kZXh9XCIgdmFsdWU9XCIke1xuICAgICAgICAgICAgICBidXR0b24ubmFtZVxuICAgICAgICAgICAgfVwiIHBsYWNlaG9sZGVyPVwi5oyJ6ZKu5ZCN56ewXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImRlbGV0ZS1idXR0b24gbWVudV9idXR0b24gaW50ZXJhY3RhYmxlXCIgZGF0YS1pbmRleD1cIiR7YnV0dG9uSW5kZXh9XCI+XG4gICAgICAgICAgICAgICAgICA8aSBjbGFzcz1cImZhLXNvbGlkIGZhLXRyYXNoXCI+PC9pPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIGApO1xuXG4gICAgICAgICAgICAkZWRpdG9ySHRtbC5maW5kKCcuYnV0dG9uLWxpc3QnKS5hcHBlbmQoJGJ1dHRvbkh0bWwpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgJGVkaXRvckh0bWwuZmluZCgnI2FkZC12YXJpYWJsZS10cmlnZ2VyJykub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5hZGRWYXJpYWJsZVRvRWRpdG9yKCRlZGl0b3JIdG1sKTtcbiAgICB9KTtcblxuICAgICRlZGl0b3JIdG1sLmZpbmQoJyNhZGQtYnV0dG9uLXRyaWdnZXInKS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICBjb25zdCBidXR0b25JbmRleCA9ICRlZGl0b3JIdG1sLmZpbmQoJy5idXR0b24tbGlzdCAuYnV0dG9uLWl0ZW0nKS5sZW5ndGg7XG4gICAgICBjb25zdCBidXR0b25JZCA9IGBidXR0b24tJHtidXR0b25JbmRleH1gO1xuICAgICAgY29uc3QgJGJ1dHRvbkNvbnRlbnQgPSAkKGA8ZGl2IGNsYXNzPVwiYnV0dG9uLWl0ZW1cIiBpZD1cIiR7YnV0dG9uSWR9XCI+XG4gICAgICAgIDxzcGFuIGNsYXNzPVwiZHJhZy1oYW5kbGUgbWVudS1oYW5kbGVcIj7imLA8L3NwYW4+XG4gICAgICAgIDxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBpZD1cImNoZWNrYm94LSR7YnV0dG9uSWR9XCIgY2xhc3M9XCJidXR0b24tdmlzaWJsZVwiIGNoZWNrZWQ+XG4gICAgICAgIDxpbnB1dCBjbGFzcz1cInRleHRfcG9sZSBidXR0b24tbmFtZVwiIHR5cGU9XCJ0ZXh0XCIgaWQ9XCJ0ZXh0LSR7YnV0dG9uSWR9XCIgcGxhY2Vob2xkZXI9XCLmjInpkq7lkI3np7BcIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImRlbGV0ZS1idXR0b24gbWVudV9idXR0b24gaW50ZXJhY3RhYmxlXCIgZGF0YS1pbmRleD1cIiR7YnV0dG9uSW5kZXh9XCI+XG4gICAgICAgICAgPGkgY2xhc3M9XCJmYS1zb2xpZCBmYS10cmFzaFwiPjwvaT5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5gKTtcbiAgICAgICRlZGl0b3JIdG1sLmZpbmQoJy5idXR0b24tbGlzdCcpLmFwcGVuZCgkYnV0dG9uQ29udGVudCk7XG4gICAgfSk7XG5cbiAgICAkZWRpdG9ySHRtbC5maW5kKCcjc2NyaXB0LWJ1dHRvbi1jb250ZW50IC5idXR0b24tbGlzdCcpLnNvcnRhYmxlKHtcbiAgICAgIGhhbmRsZTogJy5kcmFnLWhhbmRsZScsXG4gICAgICBpdGVtczogJy5idXR0b24taXRlbScsXG4gICAgfSk7XG5cbiAgICAkZWRpdG9ySHRtbC5vbignY2xpY2snLCAnLmRlbGV0ZS1idXR0b24nLCAoZTogSlF1ZXJ5LkNsaWNrRXZlbnQpID0+IHtcbiAgICAgICQoZS5jdXJyZW50VGFyZ2V0KS5jbG9zZXN0KCcuYnV0dG9uLWl0ZW0nKS5yZW1vdmUoKTtcbiAgICB9KTtcblxuICAgICRlZGl0b3JIdG1sLm9uKCdjbGljaycsICcuZGVsZXRlLXZhcmlhYmxlJywgKGU6IEpRdWVyeS5DbGlja0V2ZW50KSA9PiB7XG4gICAgICAkKGUuY3VycmVudFRhcmdldCkuY2xvc2VzdCgnLnZhcmlhYmxlLWl0ZW0nKS5yZW1vdmUoKTtcbiAgICAgIHRoaXMudXBkYXRlVmFyaWFibGVMaXN0VmlzaWJpbGl0eSgkZWRpdG9ySHRtbCk7XG4gICAgfSk7XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjYWxsR2VuZXJpY1BvcHVwKCRlZGl0b3JIdG1sLCBQT1BVUF9UWVBFLkNPTkZJUk0sICcnLCB7XG4gICAgICB3aWRlOiB0cnVlLFxuICAgICAgb2tCdXR0b246ICfkv53lrZgnLFxuICAgICAgY2FuY2VsQnV0dG9uOiAn5Y+W5raIJyxcbiAgICB9KTtcblxuICAgIGlmICghcmVzdWx0KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3Qgc2NyaXB0TmFtZSA9IFN0cmluZygkZWRpdG9ySHRtbC5maW5kKCcjc2NyaXB0LW5hbWUtaW5wdXQnKS52YWwoKSk7XG4gICAgY29uc3Qgc2NyaXB0Q29udGVudCA9IFN0cmluZygkZWRpdG9ySHRtbC5maW5kKCcjc2NyaXB0LWNvbnRlbnQtdGV4dGFyZWEnKS52YWwoKSk7XG4gICAgY29uc3Qgc2NyaXB0SW5mbyA9IFN0cmluZygkZWRpdG9ySHRtbC5maW5kKCcjc2NyaXB0LWluZm8tdGV4dGFyZWEnKS52YWwoKSk7XG5cbiAgICBjb25zdCB2YXJpYWJsZURhdGEgPSB0aGlzLmNvbGxlY3RWYXJpYWJsZXNGcm9tRWRpdG9yKCRlZGl0b3JIdG1sKTtcblxuICAgIGNvbnN0IGJ1dHRvbnM6IHsgbmFtZTogc3RyaW5nOyB2aXNpYmxlOiBib29sZWFuIH1bXSA9IFtdO1xuICAgICRlZGl0b3JIdG1sLmZpbmQoJy5idXR0b24tbGlzdCAuYnV0dG9uLWl0ZW0nKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIGNvbnN0IGJ1dHRvbk5hbWUgPSAkKHRoaXMpLmZpbmQoJy5idXR0b24tbmFtZScpLnZhbCgpIGFzIHN0cmluZztcbiAgICAgIGNvbnN0IHZpc2libGUgPSAkKHRoaXMpLmZpbmQoJy5idXR0b24tdmlzaWJsZScpLnByb3AoJ2NoZWNrZWQnKSBhcyBib29sZWFuO1xuICAgICAgaWYgKGJ1dHRvbk5hbWUgJiYgYnV0dG9uTmFtZS50cmltKCkgIT09ICcnKSB7XG4gICAgICAgIGJ1dHRvbnMucHVzaCh7IG5hbWU6IGJ1dHRvbk5hbWUsIHZpc2libGUgfSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpZiAoIXNjcmlwdCkge1xuICAgICAgc2NyaXB0ID0gbmV3IFNjcmlwdCh7XG4gICAgICAgIGlkOiB1dWlkdjQoKSxcbiAgICAgICAgbmFtZTogc2NyaXB0TmFtZSxcbiAgICAgICAgY29udGVudDogc2NyaXB0Q29udGVudCxcbiAgICAgICAgaW5mbzogc2NyaXB0SW5mbyxcbiAgICAgICAgZW5hYmxlZDogZmFsc2UsXG4gICAgICAgIGJ1dHRvbnMsXG4gICAgICAgIGRhdGE6IHZhcmlhYmxlRGF0YSxcbiAgICAgIH0pO1xuXG4gICAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlNDUklQVF9DUkVBVEUsIHsgc2NyaXB0LCB0eXBlIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCB3YXNFbmFibGVkID0gc2NyaXB0LmVuYWJsZWQ7XG5cbiAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuQlVUVE9OX1JFTU9WRSwgeyBzY3JpcHRJZDogc2NyaXB0LmlkIH0pO1xuXG4gICAgICBzY3JpcHQubmFtZSA9IHNjcmlwdE5hbWU7XG4gICAgICBzY3JpcHQuY29udGVudCA9IHNjcmlwdENvbnRlbnQ7XG4gICAgICBzY3JpcHQuaW5mbyA9IHNjcmlwdEluZm87XG4gICAgICBzY3JpcHQuYnV0dG9ucyA9IGJ1dHRvbnM7XG4gICAgICBzY3JpcHQuZGF0YSA9IHZhcmlhYmxlRGF0YTtcblxuICAgICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5TQ1JJUFRfVVBEQVRFLCB7IHNjcmlwdCwgdHlwZSB9KTtcblxuICAgICAgaWYgKHdhc0VuYWJsZWQpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBhd2FpdCB0aGlzLnNjcmlwdE1hbmFnZXIuc3RvcFNjcmlwdChzY3JpcHQsIHR5cGUpO1xuICAgICAgICAgIGF3YWl0IHRoaXMuc2NyaXB0TWFuYWdlci5ydW5TY3JpcHQoc2NyaXB0LCB0eXBlKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBsb2cuZXJyb3IoYFtTY3JpcHRNYW5hZ2VyXSDph43lkK/ohJrmnKzlpLHotKU6ICR7c2NyaXB0Lm5hbWV9YCwgZXJyb3IpO1xuICAgICAgICAgIHRvYXN0ci5lcnJvcihg6YeN5ZCv6ISa5pys5aSx6LSlOiAke3NjcmlwdC5uYW1lfWApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWwhuWPmOmHj+aVsOaNruWKoOi9veWIsOe8lui+keWZqOS4rVxuICAgKiBAcGFyYW0gJGVkaXRvckh0bWwg57yW6L6R5ZmoSFRNTOWFg+e0oFxuICAgKiBAcGFyYW0gZGF0YSDlj5jph4/mlbDmja5cbiAgICovXG4gIHByaXZhdGUgbG9hZFZhcmlhYmxlc1RvRWRpdG9yKCRlZGl0b3JIdG1sOiBKUXVlcnk8SFRNTEVsZW1lbnQ+LCBkYXRhOiB7IFtrZXk6IHN0cmluZ106IGFueSB9KTogdm9pZCB7XG4gICAgY29uc3QgJHZhcmlhYmxlTGlzdCA9ICRlZGl0b3JIdG1sLmZpbmQoJyN2YXJpYWJsZS1saXN0Jyk7XG5cbiAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhkYXRhKSkge1xuICAgICAgY29uc3QgJHZhcmlhYmxlSXRlbSA9IHRoaXMuY3JlYXRlVmFyaWFibGVJdGVtKGtleSwgdmFsdWUpO1xuICAgICAgJHZhcmlhYmxlTGlzdC5hcHBlbmQoJHZhcmlhYmxlSXRlbSk7XG4gICAgfVxuXG4gICAgdGhpcy51cGRhdGVWYXJpYWJsZUxpc3RWaXNpYmlsaXR5KCRlZGl0b3JIdG1sKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmt7vliqDmlrDlj5jph4/liLDnvJbovpHlmahcbiAgICogQHBhcmFtICRlZGl0b3JIdG1sIOe8lui+keWZqEhUTUzlhYPntKBcbiAgICovXG4gIHByaXZhdGUgYWRkVmFyaWFibGVUb0VkaXRvcigkZWRpdG9ySHRtbDogSlF1ZXJ5PEhUTUxFbGVtZW50Pik6IHZvaWQge1xuICAgIGNvbnN0ICR2YXJpYWJsZUxpc3QgPSAkZWRpdG9ySHRtbC5maW5kKCcjdmFyaWFibGUtbGlzdCcpO1xuICAgIGNvbnN0ICR2YXJpYWJsZUl0ZW0gPSB0aGlzLmNyZWF0ZVZhcmlhYmxlSXRlbSgnJywgJycpO1xuICAgICR2YXJpYWJsZUxpc3QuYXBwZW5kKCR2YXJpYWJsZUl0ZW0pO1xuXG4gICAgdGhpcy51cGRhdGVWYXJpYWJsZUxpc3RWaXNpYmlsaXR5KCRlZGl0b3JIdG1sKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmm7TmlrDlj5jph4/liJfooajnmoTlj6/op4HmgKdcbiAgICogQHBhcmFtICRlZGl0b3JIdG1sIOe8lui+keWZqEhUTUzlhYPntKBcbiAgICovXG4gIHByaXZhdGUgdXBkYXRlVmFyaWFibGVMaXN0VmlzaWJpbGl0eSgkZWRpdG9ySHRtbDogSlF1ZXJ5PEhUTUxFbGVtZW50Pik6IHZvaWQge1xuICAgIGNvbnN0ICR2YXJpYWJsZUxpc3QgPSAkZWRpdG9ySHRtbC5maW5kKCcjdmFyaWFibGUtbGlzdCcpO1xuICAgIGNvbnN0IHZhcmlhYmxlQ291bnQgPSAkdmFyaWFibGVMaXN0LmZpbmQoJy52YXJpYWJsZS1pdGVtJykubGVuZ3RoO1xuXG4gICAgaWYgKHZhcmlhYmxlQ291bnQgPT09IDApIHtcbiAgICAgICR2YXJpYWJsZUxpc3QuaGlkZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICAkdmFyaWFibGVMaXN0LnNob3coKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5Yib5bu65Y+Y6YeP6aG55YWD57SgXG4gICAqIEBwYXJhbSBrZXkg5Y+Y6YeP6ZSuXG4gICAqIEBwYXJhbSB2YWx1ZSDlj5jph4/lgLxcbiAgICogQHJldHVybnMgSlF1ZXJ55YWD57SgXG4gICAqL1xuICBwcml2YXRlIGNyZWF0ZVZhcmlhYmxlSXRlbShrZXk6IHN0cmluZywgdmFsdWU6IGFueSk6IEpRdWVyeTxIVE1MRWxlbWVudD4ge1xuICAgIGNvbnN0IHZhbHVlU3RyID0gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyA/IHZhbHVlIDogWUFNTC5zdHJpbmdpZnkodmFsdWUpO1xuXG4gICAgY29uc3QgJHZhcmlhYmxlSXRlbSA9ICQoYFxuICAgICAgPGRpdiBjbGFzcz1cInZhcmlhYmxlLWl0ZW0gZmxleC1jb250YWluZXIgZmxleEZsb3dDb2x1bW4gd2lkdGgxMDBwXCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJmbGV4IGZsZXhGbG93Q29sdW1uXCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJmbGV4LWNvbnRhaW5lciBhbGlnbml0ZW1zY2VudGVyIHNwYWNlQmV0d2VlbiB3aWRlMTAwcFwiPlxuICAgICAgICAgIDxkaXY+5ZCN56ewOjwvZGl2PlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJtZW51X2J1dHRvbiBpbnRlcmFjdGFibGUgZGVsZXRlLXZhcmlhYmxlXCIgdGl0bGU9XCLliKDpmaTlj5jph49cIj5cbiAgICAgICAgICAgIDxpIGNsYXNzPVwiZmEtc29saWQgZmEtdHJhc2hcIj48L2k+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgY2xhc3M9XCJ0ZXh0X3BvbGUgdmFyaWFibGUta2V5XCIgdmFsdWU9XCIke3RoaXMuZXNjYXBlSHRtbChrZXkpfVwiIHBsYWNlaG9sZGVyPVwi5Y+Y6YeP5ZCNXCI+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzPVwiZmxleCBmbGV4Rmxvd0NvbHVtblwiIHN0eWxlPVwiYWxpZ24taXRlbXM6IGZsZXgtc3RhcnQ7XCI+XG4gICAgICAgICAgPGRpdj7lgLw6PC9kaXY+XG4gICAgICAgICAgPHRleHRhcmVhIGNsYXNzPVwidGV4dF9wb2xlIHZhcmlhYmxlLXZhbHVlXCIgc3R5bGU9XCJtaW4taGVpZ2h0OiAxMnB4O1wiIHJvd3M9XCIxXCIgcGxhY2Vob2xkZXI9XCLor7fku6Xnuq/mlofmnKzmiJZZQU1M5qC85byP6L6T5YWl5Y+Y6YeP5YC8XCI+JHt0aGlzLmVzY2FwZUh0bWwoXG4gICAgICAgICAgICB2YWx1ZVN0cixcbiAgICAgICAgICApfTwvdGV4dGFyZWE+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPGhyPlxuICAgICAgPC9kaXY+XG4gICAgYCk7XG5cbiAgICByZXR1cm4gJHZhcmlhYmxlSXRlbTtcbiAgfVxuXG4gIC8qKlxuICAgKiDku47nvJbovpHlmajmlLbpm4blj5jph4/mlbDmja5cbiAgICogQHBhcmFtICRlZGl0b3JIdG1sIOe8lui+keWZqEhUTUzlhYPntKBcbiAgICogQHJldHVybnMg5Y+Y6YeP5pWw5o2u5a+56LGhXG4gICAqL1xuICBwcml2YXRlIGNvbGxlY3RWYXJpYWJsZXNGcm9tRWRpdG9yKCRlZGl0b3JIdG1sOiBKUXVlcnk8SFRNTEVsZW1lbnQ+KTogeyBba2V5OiBzdHJpbmddOiBhbnkgfSB7XG4gICAgY29uc3QgdmFyaWFibGVzOiB7IFtrZXk6IHN0cmluZ106IGFueSB9ID0ge307XG5cbiAgICAkZWRpdG9ySHRtbC5maW5kKCcjdmFyaWFibGUtbGlzdCAudmFyaWFibGUtaXRlbScpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3Qga2V5ID0gJCh0aGlzKS5maW5kKCcudmFyaWFibGUta2V5JykudmFsKCkgYXMgc3RyaW5nO1xuICAgICAgY29uc3QgdmFsdWVTdHIgPSAkKHRoaXMpLmZpbmQoJy52YXJpYWJsZS12YWx1ZScpLnZhbCgpIGFzIHN0cmluZztcblxuICAgICAgaWYgKGtleSAmJiBrZXkudHJpbSgpICE9PSAnJykge1xuICAgICAgICBsZXQgdmFsdWU6IGFueTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICB2YWx1ZSA9IFlBTUwucGFyc2UodmFsdWVTdHIpO1xuICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICB2YWx1ZSA9IHZhbHVlU3RyO1xuICAgICAgICB9XG4gICAgICAgIHZhcmlhYmxlc1trZXkudHJpbSgpXSA9IHZhbHVlO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHZhcmlhYmxlcztcbiAgfVxuXG4gIC8qKlxuICAgKiBIVE1M6L2s5LmJ6L6F5Yqp5Ye95pWwXG4gICAqIEBwYXJhbSB0ZXh0IOimgei9rOS5ieeahOaWh+acrFxuICAgKiBAcmV0dXJucyDovazkuYnlkI7nmoTmlofmnKxcbiAgICovXG4gIHByaXZhdGUgZXNjYXBlSHRtbCh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGRpdi50ZXh0Q29udGVudCA9IHRleHQ7XG4gICAgcmV0dXJuIGRpdi5pbm5lckhUTUw7XG4gIH1cblxuICAvKipcbiAgICog5qOA5p+l6KeS6Imy5Lit55qE5bWM5YWl5byP6ISa5pysXG4gICAqIEBwYXJhbSBjaGFyYWN0ZXJJZCDop5LoibJpZFxuICAgKiBAcGFyYW0gZW5hYmxlYWJsZVNjcmlwdHMg5Y+v5ZCv55So55qE6ISa5pys5YiX6KGoXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgY2hlY2tFbWJlZGRlZFNjcmlwdHMoY2hhcmFjdGVySWQ6IGFueSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGNoYXJhY3RlcnNXaXRoU2NyaXB0cyA9IGdldFNldHRpbmdWYWx1ZSgnc2NyaXB0LmNoYXJhY3RlcnNfd2l0aF9zY3JpcHRzJykgfHwgW107XG4gICAgY29uc3QgYXZhdGFyID0gY2hhcmFjdGVyc1tjaGFyYWN0ZXJJZF0/LmF2YXRhcjtcbiAgICBpZiAoY2hhcmFjdGVyc1dpdGhTY3JpcHRzLmluY2x1ZGVzKGF2YXRhcikpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgY2hlY2tLZXkgPSBgQWxlcnRTY3JpcHRfJHthdmF0YXJ9YDtcbiAgICBpZiAoIWxvY2FsU3RvcmFnZS5nZXRJdGVtKGNoZWNrS2V5KSkge1xuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oY2hlY2tLZXksICd0cnVlJyk7XG4gICAgICBjb25zdCB0ZW1wbGF0ZSA9IGF3YWl0IHJlbmRlckV4dGVuc2lvblRlbXBsYXRlQXN5bmMoXG4gICAgICAgIGAke2V4dGVuc2lvbkZvbGRlclBhdGh9L3NyYy9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvcHVibGljYCxcbiAgICAgICAgJ3NjcmlwdF9hbGxvd19wb3B1cCcsXG4gICAgICApO1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2FsbEdlbmVyaWNQb3B1cCh0ZW1wbGF0ZSwgUE9QVVBfVFlQRS5DT05GSVJNLCAnJywge1xuICAgICAgICBva0J1dHRvbjogJ+ehruiupCcsXG4gICAgICAgIGNhbmNlbEJ1dHRvbjogJ+WPlua2iCcsXG4gICAgICB9KTtcblxuICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICBpZiAoYXZhdGFyICYmICFjaGFyYWN0ZXJzV2l0aFNjcmlwdHMuaW5jbHVkZXMoYXZhdGFyKSkge1xuICAgICAgICAgIGNoYXJhY3RlcnNXaXRoU2NyaXB0cy5wdXNoKGF2YXRhcik7XG4gICAgICAgICAgc2F2ZVNldHRpbmdWYWx1ZSgnc2NyaXB0LmNoYXJhY3RlcnNfd2l0aF9zY3JpcHRzJywgY2hhcmFjdGVyc1dpdGhTY3JpcHRzKTtcbiAgICAgICAgfVxuXG4gICAgICAgICQoJyNjaGFyYWN0ZXItc2NyaXB0LWVuYWJsZS10b2dnbGUnKS5wcm9wKCdjaGVja2VkJywgdHJ1ZSk7XG5cbiAgICAgICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5UWVBFX1RPR0dMRSwge1xuICAgICAgICAgIHR5cGU6IFNjcmlwdFR5cGUuQ0hBUkFDVEVSLFxuICAgICAgICAgIGVuYWJsZTogdHJ1ZSxcbiAgICAgICAgICB1c2VySW5wdXQ6IGZhbHNlLFxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICQoJyNjaGFyYWN0ZXItc2NyaXB0LWVuYWJsZS10b2dnbGUnKS5wcm9wKCdjaGVja2VkJywgZmFsc2UpO1xuXG4gICAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuVFlQRV9UT0dHTEUsIHtcbiAgICAgICAgICB0eXBlOiBTY3JpcHRUeXBlLkNIQVJBQ1RFUixcbiAgICAgICAgICBlbmFibGU6IGZhbHNlLFxuICAgICAgICAgIHVzZXJJbnB1dDogZmFsc2UsXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmuLLmn5PljZXkuKrmlofku7blpLlcbiAgICogQHBhcmFtIGZvbGRlckl0ZW0g5paH5Lu25aS56aG5XG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyByZW5kZXJGb2xkZXIoZm9sZGVySXRlbTogU2NyaXB0UmVwb3NpdG9yeUl0ZW0sIHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBjb250YWluZXIgPSAkKGdldFNjcmlwdExpc3RTZWxlY3Rvcih0eXBlKSk7XG4gICAgaWYgKCF0aGlzLmZvbGRlclRlbXBsYXRlKSB7XG4gICAgICBhd2FpdCB0aGlzLmluaXRpYWxpemVUZW1wbGF0ZXMoKTtcbiAgICB9XG5cbiAgICBjb25zdCBmb2xkZXJJZCA9IGZvbGRlckl0ZW0uaWQhO1xuICAgIGNvbnN0IGZvbGRlck5hbWUgPSBmb2xkZXJJdGVtLm5hbWUhO1xuICAgIGNvbnN0IGZvbGRlckljb24gPSBmb2xkZXJJdGVtLmljb24gfHwgJ2ZhLWZvbGRlcic7XG4gICAgY29uc3QgZm9sZGVyQ29sb3IgPSBmb2xkZXJJdGVtLmNvbG9yIHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCctLVNtYXJ0VGhlbWVCb2R5Q29sb3InKTtcblxuICAgIGNvbnN0IG1vdmVJY29uID0gdHlwZSA9PT0gJ2dsb2JhbCcgPyAnZmEtYXJyb3ctZG93bicgOiAnZmEtYXJyb3ctdXAnO1xuICAgIGNvbnN0IG1vdmVDbGFzcyA9IHR5cGUgPT09ICdnbG9iYWwnID8gJ21vdmUtdG8tY2hhcmFjdGVyJyA6ICdtb3ZlLXRvLWdsb2JhbCc7XG4gICAgY29uc3QgbW92ZVRpdGxlID0gdHlwZSA9PT0gJ2dsb2JhbCcgPyAn56e75Yqo5Yiw6KeS6Imy6ISa5pys5bqTJyA6ICfnp7vliqjliLDlhajlsYDohJrmnKzlupMnO1xuXG4gICAgY29uc3QgZm9sZGVySHRtbCA9ICQoXG4gICAgICBhd2FpdCByZW5kZXJFeHRlbnNpb25UZW1wbGF0ZUFzeW5jKHRoaXMudGVtcGxhdGVQYXRoLCAnZm9sZGVyX3RlbXBsYXRlJywge1xuICAgICAgICBmb2xkZXJJZCxcbiAgICAgICAgZm9sZGVyTmFtZSxcbiAgICAgICAgZm9sZGVySWNvbixcbiAgICAgICAgZm9sZGVyQ29sb3IsXG4gICAgICAgIG1vdmVJY29uLFxuICAgICAgICBtb3ZlQ2xhc3MsXG4gICAgICAgIG1vdmVUaXRsZSxcbiAgICAgIH0pLFxuICAgICk7XG5cbiAgICB0aGlzLmJpbmRGb2xkZXJFdmVudHMoZm9sZGVySHRtbCwgZm9sZGVySWQsIGZvbGRlckNvbG9yLCB0eXBlKTtcblxuICAgIGNvbnN0IHNjcmlwdHMgPSBmb2xkZXJJdGVtLnZhbHVlIGFzIFNjcmlwdFtdO1xuICAgIGNvbnN0IGZvbGRlckNvbnRlbnQgPSBmb2xkZXJIdG1sLmZpbmQoJy5mb2xkZXItY29udGVudCcpO1xuICAgIGZvciAoY29uc3Qgc2NyaXB0IG9mIHNjcmlwdHMpIHtcbiAgICAgIGNvbnN0IHNjcmlwdEVsZW1lbnQgPSBhd2FpdCB0aGlzLmNyZWF0ZVNjcmlwdEVsZW1lbnQoc2NyaXB0LCB0eXBlKTtcbiAgICAgIGZvbGRlckNvbnRlbnQuYXBwZW5kKHNjcmlwdEVsZW1lbnQpO1xuICAgIH1cblxuICAgIGNvbnRhaW5lci5hcHBlbmQoZm9sZGVySHRtbCk7XG5cbiAgICB0aGlzLnNldHVwRm9sZGVyRHJhZ2dhYmxlKHR5cGUpO1xuXG4gICAgdGhpcy5zZXR1cFNpbmdsZUZvbGRlckRyb3Bab25lKGZvbGRlckh0bWwsIHR5cGUpO1xuICB9XG5cbiAgLyoqXG4gICAqIOe7keWumuaWh+S7tuWkueebuOWFs+S6i+S7tuWSjOiuvue9ruWbvuagh+minOiJslxuICAgKiBAcGFyYW0gZm9sZGVySHRtbCDmlofku7blpLlIVE1M5YWD57SgXG4gICAqIEBwYXJhbSBmb2xkZXJJZCDmlofku7blpLlJRFxuICAgKiBAcGFyYW0gZm9sZGVyQ29sb3Ig5paH5Lu25aS56aKc6ImyXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBiaW5kRm9sZGVyRXZlbnRzKFxuICAgIGZvbGRlckh0bWw6IEpRdWVyeTxIVE1MRWxlbWVudD4sXG4gICAgZm9sZGVySWQ6IHN0cmluZyxcbiAgICBmb2xkZXJDb2xvcjogc3RyaW5nLFxuICAgIHR5cGU6IFNjcmlwdFR5cGUsXG4gICk6IHZvaWQge1xuICAgIGZvbGRlckh0bWwuZmluZCgnLmZvbGRlci1oZWFkZXInKS5vbignY2xpY2snLCBlID0+IHtcbiAgICAgIGlmICgkKGUudGFyZ2V0KS5jbG9zZXN0KCcuZm9sZGVyLWNvbnRyb2wnKS5sZW5ndGggPiAwKSByZXR1cm47XG4gICAgICBpZiAoJChlLnRhcmdldCkuY2xvc2VzdCgnLmZvbGRlci1jaGVja2JveCcpLmxlbmd0aCA+IDAgfHwgJChlLnRhcmdldCkuaGFzQ2xhc3MoJ2ZvbGRlci1jaGVja2JveCcpKSByZXR1cm47XG5cbiAgICAgIGNvbnN0IGNvbnRlbnQgPSBmb2xkZXJIdG1sLmZpbmQoJy5mb2xkZXItY29udGVudCcpO1xuICAgICAgY29uc3QgdG9nZ2xlID0gZm9sZGVySHRtbC5maW5kKCcuZm9sZGVyLXRvZ2dsZScpO1xuXG4gICAgICBpZiAoY29udGVudC5pcygnOnZpc2libGUnKSkge1xuICAgICAgICBjb250ZW50LnNsaWRlVXAoKTtcbiAgICAgICAgdG9nZ2xlLnJlbW92ZUNsYXNzKCdleHBhbmRlZCcpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29udGVudC5zbGlkZURvd24oKTtcbiAgICAgICAgdG9nZ2xlLmFkZENsYXNzKCdleHBhbmRlZCcpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgY29uc3QgJGZvbGRlclRvZ2dsZSA9IGZvbGRlckh0bWwuZmluZCgnLmZvbGRlci1zY3JpcHQtdG9nZ2xlJyk7XG4gICAgJGZvbGRlclRvZ2dsZS5vbignY2xpY2snLCBlID0+IHtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgIGNvbnN0IGlzRW5hYmxlZCA9ICRmb2xkZXJUb2dnbGUuaGFzQ2xhc3MoJ2VuYWJsZWQnKTtcbiAgICAgIGNvbnN0IG5ld1N0YXRlID0gIWlzRW5hYmxlZDtcblxuICAgICAgaWYgKG5ld1N0YXRlKSB7XG4gICAgICAgICRmb2xkZXJUb2dnbGUuYWRkQ2xhc3MoJ2VuYWJsZWQnKTtcbiAgICAgICAgJGZvbGRlclRvZ2dsZS5maW5kKCdpLmZhLXRvZ2dsZS1vZmYnKS5oaWRlKCk7XG4gICAgICAgICRmb2xkZXJUb2dnbGUuZmluZCgnaS5mYS10b2dnbGUtb24nKS5zaG93KCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkZm9sZGVyVG9nZ2xlLnJlbW92ZUNsYXNzKCdlbmFibGVkJyk7XG4gICAgICAgICRmb2xkZXJUb2dnbGUuZmluZCgnaS5mYS10b2dnbGUtb2ZmJykuc2hvdygpO1xuICAgICAgICAkZm9sZGVyVG9nZ2xlLmZpbmQoJ2kuZmEtdG9nZ2xlLW9uJykuaGlkZSgpO1xuICAgICAgfVxuXG4gICAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLkZPTERFUl9TQ1JJUFRTX1RPR0dMRSwge1xuICAgICAgICBmb2xkZXJJZCxcbiAgICAgICAgdHlwZSxcbiAgICAgICAgZW5hYmxlOiBuZXdTdGF0ZSxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZm9sZGVySHRtbC5maW5kKCcuZm9sZGVyLWVkaXQnKS5vbignY2xpY2snLCBlID0+IHtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICB0aGlzLnNob3dFZGl0Rm9sZGVyRGlhbG9nKGZvbGRlcklkLCB0eXBlKTtcbiAgICB9KTtcblxuICAgIGZvbGRlckh0bWwuZmluZCgnLmZvbGRlci1leHBvcnQnKS5vbignY2xpY2snLCBlID0+IHtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICB0aGlzLmV4cG9ydEZvbGRlcihmb2xkZXJJZCwgdHlwZSk7XG4gICAgfSk7XG5cbiAgICBmb2xkZXJIdG1sLmZpbmQoJy5mb2xkZXItbW92ZScpLm9uKCdjbGljaycsIGUgPT4ge1xuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuRk9MREVSX01PVkUsIHtcbiAgICAgICAgZm9sZGVySWQsXG4gICAgICAgIGZyb21UeXBlOiB0eXBlLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBmb2xkZXJIdG1sLmZpbmQoJy5mb2xkZXItZGVsZXRlJykub24oJ2NsaWNrJywgZSA9PiB7XG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgdGhpcy5zaG93RGVsZXRlRm9sZGVyRGlhbG9nKGZvbGRlcklkLCB0eXBlKTtcbiAgICB9KTtcblxuICAgIGZvbGRlckh0bWwuZmluZCgnLmZvbGRlci1pY29uJykuY3NzKCdjb2xvcicsIGZvbGRlckNvbG9yKTtcblxuICAgIHRoaXMudXBkYXRlRm9sZGVyVG9nZ2xlU3RhdGUoZm9sZGVySHRtbCwgZm9sZGVySWQsIHR5cGUpO1xuICB9XG5cbiAgLyoqXG4gICAqIOabtOaWsOaWh+S7tuWkueW8gOWFs+eahFVJ54q25oCBXG4gICAqIEBwYXJhbSBmb2xkZXJIdG1sIOaWh+S7tuWkuUhUTUzlhYPntKBcbiAgICogQHBhcmFtIGZvbGRlcklkIOaWh+S7tuWkuUlEXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSB1cGRhdGVGb2xkZXJUb2dnbGVTdGF0ZShmb2xkZXJIdG1sOiBKUXVlcnk8SFRNTEVsZW1lbnQ+LCBmb2xkZXJJZDogc3RyaW5nLCB0eXBlOiBTY3JpcHRUeXBlKTogdm9pZCB7XG4gICAgY29uc3Qgc3RhdGUgPSB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0Rm9sZGVyU2NyaXB0c1N0YXRlKGZvbGRlcklkLCB0eXBlKTtcbiAgICBjb25zdCAkZm9sZGVyVG9nZ2xlID0gZm9sZGVySHRtbC5maW5kKCcuZm9sZGVyLXNjcmlwdC10b2dnbGUnKTtcblxuICAgICRmb2xkZXJUb2dnbGUucmVtb3ZlQ2xhc3MoJ2VuYWJsZWQnKTtcblxuICAgIGlmIChzdGF0ZSA9PT0gJ2FsbCcpIHtcbiAgICAgICRmb2xkZXJUb2dnbGUuYWRkQ2xhc3MoJ2VuYWJsZWQnKTtcbiAgICAgICRmb2xkZXJUb2dnbGUuZmluZCgnaS5mYS10b2dnbGUtb2ZmJykuaGlkZSgpO1xuICAgICAgJGZvbGRlclRvZ2dsZS5maW5kKCdpLmZhLXRvZ2dsZS1vbicpLnNob3coKTtcbiAgICB9IGVsc2Uge1xuICAgICAgJGZvbGRlclRvZ2dsZS5maW5kKCdpLmZhLXRvZ2dsZS1vZmYnKS5zaG93KCk7XG4gICAgICAkZm9sZGVyVG9nZ2xlLmZpbmQoJ2kuZmEtdG9nZ2xlLW9uJykuaGlkZSgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmm7TmlrDljIXlkKvmjIflrprohJrmnKznmoTmlofku7blpLnlvIDlhbPnirbmgIFcbiAgICogQHBhcmFtIHNjcmlwdElkIOiEmuacrElEXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSB1cGRhdGVQYXJlbnRGb2xkZXJUb2dnbGUoc2NyaXB0SWQ6IHN0cmluZywgdHlwZTogU2NyaXB0VHlwZSk6IHZvaWQge1xuICAgIGNvbnN0IHJlcG9zaXRvcnkgPVxuICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUxcbiAgICAgICAgPyB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0R2xvYmFsUmVwb3NpdG9yeUl0ZW1zKClcbiAgICAgICAgOiB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0Q2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKCk7XG5cbiAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgcmVwb3NpdG9yeSkge1xuICAgICAgaWYgKGl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicpIHtcbiAgICAgICAgY29uc3Qgc2NyaXB0cyA9IGl0ZW0udmFsdWUgYXMgU2NyaXB0W107XG4gICAgICAgIGNvbnN0IGhhc1NjcmlwdCA9IHNjcmlwdHMuc29tZShzY3JpcHQgPT4gc2NyaXB0LmlkID09PSBzY3JpcHRJZCk7XG5cbiAgICAgICAgaWYgKGhhc1NjcmlwdCkge1xuICAgICAgICAgIGNvbnN0ICRmb2xkZXIgPSAkKGAjJHtpdGVtLmlkfWApO1xuICAgICAgICAgIGlmICgkZm9sZGVyLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlRm9sZGVyVG9nZ2xlU3RhdGUoJGZvbGRlciwgaXRlbS5pZCEsIHR5cGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDliJvlu7rohJrmnKzlhYPntKBcbiAgICogQHBhcmFtIHNjcmlwdCDohJrmnKxcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGNyZWF0ZVNjcmlwdEVsZW1lbnQoc2NyaXB0OiBTY3JpcHQsIHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPEpRdWVyeTxIVE1MRWxlbWVudD4+IHtcbiAgICBpZiAoIXRoaXMuYmFzZVRlbXBsYXRlKSB7XG4gICAgICBhd2FpdCB0aGlzLmluaXRpYWxpemVUZW1wbGF0ZXMoKTtcbiAgICB9XG5cbiAgICBjb25zdCBzY3JpcHRIdG1sID0gdGhpcy5iYXNlVGVtcGxhdGUhLmNsb25lKCk7XG5cbiAgICBzY3JpcHRIdG1sLmF0dHIoJ2lkJywgc2NyaXB0LmlkKTtcbiAgICBzY3JpcHRIdG1sLmF0dHIoJ2RhdGEtc2NyaXB0LXJlcG9zaXRvcnknLCAndHJ1ZScpO1xuICAgIHNjcmlwdEh0bWwuZmluZCgnLnNjcmlwdC1pdGVtLW5hbWUnKS50ZXh0KHNjcmlwdC5uYW1lKTtcbiAgICBzY3JpcHRIdG1sLmZpbmQoJy5zY3JpcHQtc3RvcmFnZS1sb2NhdGlvbicpLmFkZENsYXNzKHR5cGUgPT09ICdnbG9iYWwnID8gJ21vdmUtdG8tY2hhcmFjdGVyJyA6ICdtb3ZlLXRvLWdsb2JhbCcpO1xuICAgIHNjcmlwdEh0bWwuZmluZCgnLnNjcmlwdC1zdG9yYWdlLWxvY2F0aW9uIGknKS5hZGRDbGFzcyh0eXBlID09PSAnZ2xvYmFsJyA/ICdmYS1hcnJvdy1kb3duJyA6ICdmYS1hcnJvdy11cCcpO1xuXG4gICAgY29uc3QgJHRvZ2dsZUJ1dHRvbiA9IHNjcmlwdEh0bWwuZmluZCgnLnNjcmlwdC10b2dnbGUnKTtcbiAgICBpZiAoc2NyaXB0LmVuYWJsZWQpIHtcbiAgICAgICR0b2dnbGVCdXR0b24uYWRkQ2xhc3MoJ2VuYWJsZWQnKTtcbiAgICAgICR0b2dnbGVCdXR0b24uZmluZCgnaS5mYS10b2dnbGUtb2ZmJykuaGlkZSgpO1xuICAgICAgJHRvZ2dsZUJ1dHRvbi5maW5kKCdpLmZhLXRvZ2dsZS1vbicpLnNob3coKTtcbiAgICB9IGVsc2Uge1xuICAgICAgJHRvZ2dsZUJ1dHRvbi5yZW1vdmVDbGFzcygnZW5hYmxlZCcpO1xuICAgICAgJHRvZ2dsZUJ1dHRvbi5maW5kKCdpLmZhLXRvZ2dsZS1vZmYnKS5zaG93KCk7XG4gICAgICAkdG9nZ2xlQnV0dG9uLmZpbmQoJ2kuZmEtdG9nZ2xlLW9uJykuaGlkZSgpO1xuICAgIH1cblxuICAgIHRoaXMuYmluZFNjcmlwdEV2ZW50cyhzY3JpcHRIdG1sLCBzY3JpcHQsIHR5cGUpO1xuXG4gICAgcmV0dXJuIHNjcmlwdEh0bWw7XG4gIH1cblxuICAvKipcbiAgICog5qOA5p+l6ISa5pysZGF0YeW5tuivoumXrueUqOaIt+WmguS9leWkhOeQhlxuICAgKiBAcGFyYW0gc2NyaXB0IOiEmuacrOWvueixoVxuICAgKiBAcmV0dXJucyDlpITnkIblkI7nmoTohJrmnKzmlbDmja7vvIjkuI3ljIXlkKtlbmFibGVk5a2X5q6177yJ77yM5aaC5p6c55So5oi35Y+W5raI5YiZ6L+U5ZuebnVsbFxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBjaGVja1NjcmlwdERhdGFBbmRHZXRFeHBvcnREYXRhKHNjcmlwdDogU2NyaXB0KTogUHJvbWlzZTxhbnk+IHtcbiAgICBjb25zdCB7IGVuYWJsZWQsIC4uLnNjcmlwdERhdGEgfSA9IHNjcmlwdDtcblxuICAgIGNvbnN0IGhhc0RhdGEgPSBzY3JpcHQuZGF0YSAmJiBPYmplY3Qua2V5cyhzY3JpcHQuZGF0YSkubGVuZ3RoID4gMDtcblxuICAgIGlmIChoYXNEYXRhKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBjaG9pY2UgPSBhd2FpdCBjYWxsR2VuZXJpY1BvcHVwKFxuICAgICAgICAgIGDohJrmnKwgXCIke3NjcmlwdC5uYW1lfVwiIOWMheWQq+aVsOaNru+8jOWvvOWHuuaXtuWmguS9leWkhOeQhu+8n+WmguaciUFQSS1LRVnnrYnmlY/mhJ/mlbDmja7vvIzms6jmhI/muIXpmaRgLFxuICAgICAgICAgIFBPUFVQX1RZUEUuVEVYVCxcbiAgICAgICAgICAnJyxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBva0J1dHRvbjogJ+ebtOaOpeWvvOWHuu+8iOWMheWQq+aVsOaNru+8iScsXG4gICAgICAgICAgICBjYW5jZWxCdXR0b246ICflj5bmtognLFxuICAgICAgICAgICAgY3VzdG9tQnV0dG9uczogWyfmuIXpmaTmlbDmja7lkI7lr7zlh7onXSxcbiAgICAgICAgICB9LFxuICAgICAgICApO1xuXG4gICAgICAgIHN3aXRjaCAoY2hvaWNlKSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgcmV0dXJuIHNjcmlwdERhdGE7XG4gICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgcmV0dXJuIHsgLi4uc2NyaXB0RGF0YSwgZGF0YToge30gfTtcbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGxvZy5lcnJvcignW1NjcmlwdE1hbmFnZXJdIOWvvOWHuuiEmuacrOaVsOaNrumAieaLqeWvueivneahhuWHuumUmTonLCBlcnJvcik7XG4gICAgICAgIHJldHVybiBzY3JpcHREYXRhO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBzY3JpcHREYXRhO1xuICB9XG5cbiAgLyoqXG4gICAqIOe7keWumuiEmuacrOebuOWFs+S6i+S7tlxuICAgKiBAcGFyYW0gc2NyaXB0SHRtbCDohJrmnKxIVE1M5YWD57SgXG4gICAqIEBwYXJhbSBzY3JpcHQg6ISa5pys5a+56LGhXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBiaW5kU2NyaXB0RXZlbnRzKHNjcmlwdEh0bWw6IEpRdWVyeTxIVE1MRWxlbWVudD4sIHNjcmlwdDogU2NyaXB0LCB0eXBlOiBTY3JpcHRUeXBlKTogdm9pZCB7XG4gICAgY29uc3QgJHRvZ2dsZUJ1dHRvbiA9IHNjcmlwdEh0bWwuZmluZCgnLnNjcmlwdC10b2dnbGUnKTtcbiAgICAkdG9nZ2xlQnV0dG9uLm9uKCdjbGljay5zY3JpcHRUb2dnbGUnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCBpc0VuYWJsZWQgPSAkKHRoaXMpLmhhc0NsYXNzKCdlbmFibGVkJyk7XG4gICAgICBjb25zdCBuZXdTdGF0ZSA9ICFpc0VuYWJsZWQ7XG5cbiAgICAgIGlmIChuZXdTdGF0ZSkge1xuICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCdlbmFibGVkJyk7XG4gICAgICAgICQodGhpcykuZmluZCgnaS5mYS10b2dnbGUtb2ZmJykuaGlkZSgpO1xuICAgICAgICAkKHRoaXMpLmZpbmQoJ2kuZmEtdG9nZ2xlLW9uJykuc2hvdygpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcygnZW5hYmxlZCcpO1xuICAgICAgICAkKHRoaXMpLmZpbmQoJ2kuZmEtdG9nZ2xlLW9mZicpLnNob3coKTtcbiAgICAgICAgJCh0aGlzKS5maW5kKCdpLmZhLXRvZ2dsZS1vbicpLmhpZGUoKTtcbiAgICAgIH1cblxuICAgICAgc2NyaXB0LmVuYWJsZWQgPSBuZXdTdGF0ZTtcblxuICAgICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5TQ1JJUFRfVE9HR0xFLCB7XG4gICAgICAgIHNjcmlwdCxcbiAgICAgICAgdHlwZSxcbiAgICAgICAgZW5hYmxlOiBuZXdTdGF0ZSxcbiAgICAgICAgdXNlcklucHV0OiB0cnVlLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBzY3JpcHRIdG1sLmZpbmQoJy5zY3JpcHQtaW5mbycpLm9uKCdjbGljay5zY3JpcHRJbmZvJywgKCkgPT4ge1xuICAgICAgY29uc3Qgc2NyaXB0SW5mbyA9IHNjcmlwdC5pbmZvIHx8ICcnO1xuICAgICAgY29uc3QgaHRtbFRleHQgPSByZW5kZXJNYXJrZG93bihzY3JpcHRJbmZvKTtcbiAgICAgIGNhbGxHZW5lcmljUG9wdXAoaHRtbFRleHQsIFBPUFVQX1RZUEUuRElTUExBWSwgdW5kZWZpbmVkLCB7IHdpZGU6IHRydWUgfSk7XG4gICAgfSk7XG5cbiAgICBzY3JpcHRIdG1sLmZpbmQoJy5lZGl0LXNjcmlwdCcpLm9uKCdjbGljay5zY3JpcHRFZGl0JywgZSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5TQ1JJUFRfRURJVCwgeyB0eXBlLCBzY3JpcHRJZDogc2NyaXB0LmlkIH0pO1xuICAgIH0pO1xuXG4gICAgc2NyaXB0SHRtbC5maW5kKCcuc2NyaXB0LXN0b3JhZ2UtbG9jYXRpb24nKS5vbignY2xpY2suc2NyaXB0TW92ZScsICgpID0+IHtcbiAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuU0NSSVBUX01PVkUsIHsgc2NyaXB0LCBmcm9tVHlwZTogdHlwZSB9KTtcbiAgICB9KTtcblxuICAgIHNjcmlwdEh0bWwuZmluZCgnLmV4cG9ydC1zY3JpcHQnKS5vbignY2xpY2suc2NyaXB0RXhwb3J0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZmlsZU5hbWUgPSBgJHtzY3JpcHQubmFtZS5yZXBsYWNlKC9bXFxzLjw+OlwiL1xcXFx8PypcXHgwMC1cXHgxRlxceDdGXS9nLCAnXycpLnRvTG93ZXJDYXNlKCl9Lmpzb25gO1xuICAgICAgY29uc3Qgc2NyaXB0RGF0YSA9IGF3YWl0IHRoaXMuY2hlY2tTY3JpcHREYXRhQW5kR2V0RXhwb3J0RGF0YShzY3JpcHQpO1xuXG4gICAgICBpZiAoc2NyaXB0RGF0YSA9PT0gbnVsbCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGZpbGVEYXRhID0gSlNPTi5zdHJpbmdpZnkoc2NyaXB0RGF0YSwgbnVsbCwgMik7XG4gICAgICBkb3dubG9hZChmaWxlRGF0YSwgZmlsZU5hbWUsICdhcHBsaWNhdGlvbi9qc29uJyk7XG4gICAgfSk7XG5cbiAgICBzY3JpcHRIdG1sLmZpbmQoJy5kZWxldGUtc2NyaXB0Jykub24oJ2NsaWNrLnNjcmlwdERlbGV0ZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbmZpcm0gPSBhd2FpdCBjYWxsR2VuZXJpY1BvcHVwKCfnoa7lrpropoHliKDpmaTov5nkuKrohJrmnKzlkJfvvJ8nLCBQT1BVUF9UWVBFLkNPTkZJUk0pO1xuXG4gICAgICBpZiAoIWNvbmZpcm0pIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlNDUklQVF9ERUxFVEUsIHsgc2NyaXB0SWQ6IHNjcmlwdC5pZCwgdHlwZSB9KTtcbiAgICAgIHNjcmlwdEh0bWwucmVtb3ZlKCk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog5pi+56S65paw5bu66ISa5pys5a+56K+d5qGGXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHNob3dDcmVhdGVTY3JpcHREaWFsb2coKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgbGV0IHRhcmdldDogU2NyaXB0VHlwZSA9IFNjcmlwdFR5cGUuR0xPQkFMO1xuICAgIGNvbnN0IHRlbXBsYXRlID0gJChcbiAgICAgIGF3YWl0IHJlbmRlckV4dGVuc2lvblRlbXBsYXRlQXN5bmModGhpcy50ZW1wbGF0ZVBhdGgsICdzY3JpcHRfdGFyZ2V0X3NlbGVjdG9yJywge1xuICAgICAgICB0aXRsZTogJ+aWsOW7uuiEmuacrOWIsDonLFxuICAgICAgICBwcmVmaXg6ICdzY3JpcHQtY3JlYXRlJyxcbiAgICAgICAgZ2xvYmFsTGFiZWw6ICflhajlsYDohJrmnKzlupMnLFxuICAgICAgICBjaGFyYWN0ZXJMYWJlbDogJ+inkuiJsuiEmuacrOW6kycsXG4gICAgICB9KSxcbiAgICApO1xuICAgIHRlbXBsYXRlLmZpbmQoJyNzY3JpcHQtY3JlYXRlLXRhcmdldC1nbG9iYWwnKS5vbignaW5wdXQnLCAoKSA9PiAodGFyZ2V0ID0gU2NyaXB0VHlwZS5HTE9CQUwpKTtcbiAgICB0ZW1wbGF0ZS5maW5kKCcjc2NyaXB0LWNyZWF0ZS10YXJnZXQtY2hhcmFjdGVyJykub24oJ2lucHV0JywgKCkgPT4gKHRhcmdldCA9IFNjcmlwdFR5cGUuQ0hBUkFDVEVSKSk7XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjYWxsR2VuZXJpY1BvcHVwKHRlbXBsYXRlLCBQT1BVUF9UWVBFLkNPTkZJUk0sICcnLCB7XG4gICAgICBva0J1dHRvbjogJ+ehruiupCcsXG4gICAgICBjYW5jZWxCdXR0b246ICflj5bmtognLFxuICAgIH0pO1xuXG4gICAgaWYgKHJlc3VsdCkge1xuICAgICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5TQ1JJUFRfRURJVCwge1xuICAgICAgICB0eXBlOiB0YXJnZXQsXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5pi+56S65Yib5bu65paH5Lu25aS55a+56K+d5qGGXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHNob3dDcmVhdGVGb2xkZXJEaWFsb2coKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgZGVmYXVsdENvbG9yID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLmdldFByb3BlcnR5VmFsdWUoJy0tU21hcnRUaGVtZUJvZHlDb2xvcicpO1xuICAgIGNvbnN0IHRlbXBsYXRlID0gJChhd2FpdCByZW5kZXJFeHRlbnNpb25UZW1wbGF0ZUFzeW5jKHRoaXMudGVtcGxhdGVQYXRoLCAnZm9sZGVyX2NyZWF0ZScsIHsgZGVmYXVsdENvbG9yIH0sIGZhbHNlKSk7XG5cbiAgICBsZXQgZm9sZGVyQ29sb3I7XG5cbiAgICB0ZW1wbGF0ZS5maW5kKCcjZm9sZGVyLWljb24tcHJldmlldycpLm9uKCdjbGljaycsIGFzeW5jICgpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHNlbGVjdGVkSWNvbiA9IGF3YWl0IHNob3dGb250QXdlc29tZVBpY2tlcigpO1xuICAgICAgICBpZiAoc2VsZWN0ZWRJY29uICYmIHNlbGVjdGVkSWNvbi50cmltKCkgIT09ICcnKSB7XG4gICAgICAgICAgdGVtcGxhdGUuZmluZCgnI2ZvbGRlci1pY29uLXByZXZpZXcnKS5yZW1vdmVDbGFzcygpLmFkZENsYXNzKGBmYSAke3NlbGVjdGVkSWNvbn1gKTtcbiAgICAgICAgICB0ZW1wbGF0ZS5maW5kKCcjZm9sZGVyLWljb24tdmFsdWUnKS52YWwoc2VsZWN0ZWRJY29uKTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgbG9nLmVycm9yKCdbU2NyaXB0TWFuYWdlcl0g5Zu+5qCH6YCJ5oup5aSx6LSlOicsIGVycm9yKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHRlbXBsYXRlLmZpbmQoJyNmb2xkZXItY29sb3ItcGlja2VyJykub24oJ2NoYW5nZScsIGV2dCA9PiB7XG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICBmb2xkZXJDb2xvciA9IGV2dC5kZXRhaWw/LnJnYmE7XG4gICAgfSk7XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjYWxsR2VuZXJpY1BvcHVwKHRlbXBsYXRlLCBQT1BVUF9UWVBFLkNPTkZJUk0sICcnLCB7XG4gICAgICBva0J1dHRvbjogJ+WIm+W7uicsXG4gICAgICBjYW5jZWxCdXR0b246ICflj5bmtognLFxuICAgIH0pO1xuXG4gICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBmb2xkZXJOYW1lID0gdGVtcGxhdGUuZmluZCgnI2ZvbGRlci1uYW1lLWlucHV0JykudmFsKCkgYXMgc3RyaW5nO1xuICAgIGNvbnN0IGZvbGRlckljb24gPSB0ZW1wbGF0ZS5maW5kKCcjZm9sZGVyLWljb24tdmFsdWUnKS52YWwoKSBhcyBzdHJpbmc7XG4gICAgY29uc3Qgc2VsZWN0ZWRUeXBlID0gdGVtcGxhdGUuZmluZCgnI2ZvbGRlci10YXJnZXQtZ2xvYmFsJykucHJvcCgnY2hlY2tlZCcpXG4gICAgICA/IFNjcmlwdFR5cGUuR0xPQkFMXG4gICAgICA6IFNjcmlwdFR5cGUuQ0hBUkFDVEVSO1xuXG4gICAgaWYgKCFmb2xkZXJOYW1lIHx8IGZvbGRlck5hbWUudHJpbSgpID09PSAnJykge1xuICAgICAgdG9hc3RyLmVycm9yKCfor7fovpPlhaXmlofku7blpLnlkI3np7AnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgZXhpc3RpbmdGb2xkZXJzID1cbiAgICAgICAgc2VsZWN0ZWRUeXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTFxuICAgICAgICAgID8gdGhpcy5zY3JpcHRNYW5hZ2VyLmdldEdsb2JhbFJlcG9zaXRvcnlJdGVtcygpXG4gICAgICAgICAgOiB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0Q2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKCk7XG5cbiAgICAgIGNvbnN0IGZvbGRlckV4aXN0cyA9IGV4aXN0aW5nRm9sZGVycy5zb21lKGl0ZW0gPT4gaXRlbS50eXBlID09PSAnZm9sZGVyJyAmJiBpdGVtLm5hbWUgPT09IGZvbGRlck5hbWUudHJpbSgpKTtcblxuICAgICAgaWYgKGZvbGRlckV4aXN0cykge1xuICAgICAgICB0b2FzdHIuZXJyb3IoXG4gICAgICAgICAgYCR7c2VsZWN0ZWRUeXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCA/ICflhajlsYAnIDogJ+inkuiJsid96ISa5pys5bqT5Lit5bey5a2Y5Zyo5ZCN5Li6IFwiJHtmb2xkZXJOYW1lLnRyaW0oKX1cIiDnmoTmlofku7blpLlgLFxuICAgICAgICApO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuRk9MREVSX0NSRUFURSwge1xuICAgICAgICBuYW1lOiBmb2xkZXJOYW1lLnRyaW0oKSxcbiAgICAgICAgdHlwZTogc2VsZWN0ZWRUeXBlLFxuICAgICAgICBpY29uOiBmb2xkZXJJY29uLFxuICAgICAgICBjb2xvcjogZm9sZGVyQ29sb3IsXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nLmVycm9yKCdbU2NyaXB0TWFuYWdlcl0g5Yib5bu65paH5Lu25aS55aSx6LSlOicsIGVycm9yKTtcbiAgICAgIHRvYXN0ci5lcnJvcihg5Yib5bu65paH5Lu25aS55aSx6LSlOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKX1gKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5pi+56S657yW6L6R5paH5Lu25aS55a+56K+d5qGGXG4gICAqIEBwYXJhbSBmb2xkZXJJZCDmlofku7blpLlJRFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgc2hvd0VkaXRGb2xkZXJEaWFsb2coZm9sZGVySWQ6IHN0cmluZywgdHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGN1cnJlbnROYW1lID0gJChgIyR7Zm9sZGVySWR9IC5mb2xkZXItbmFtZWApLnRleHQoKTtcblxuICAgIGNvbnN0IHJlcG9zaXRvcnkgPVxuICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUxcbiAgICAgICAgPyB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0R2xvYmFsUmVwb3NpdG9yeUl0ZW1zKClcbiAgICAgICAgOiB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0Q2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKCk7XG4gICAgY29uc3QgZm9sZGVyID0gcmVwb3NpdG9yeS5maW5kKGl0ZW0gPT4gaXRlbS50eXBlID09PSAnZm9sZGVyJyAmJiBpdGVtLmlkID09PSBmb2xkZXJJZCk7XG4gICAgY29uc3QgY3VycmVudEljb24gPSBmb2xkZXI/Lmljb24gfHwgJ2ZhLWZvbGRlcic7XG4gICAgY29uc3QgY3VycmVudENvbG9yUmdiYSA9IGZvbGRlcj8uY29sb3IgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLmdldFByb3BlcnR5VmFsdWUoJy0tU21hcnRUaGVtZUJvZHlDb2xvcicpO1xuICAgIGxldCBuZXdDb2xvcjtcblxuICAgIGNvbnN0IHRlbXBsYXRlID0gJChgXG4gICAgICA8ZGl2IGNsYXNzPVwiZm9sZGVyLWVkaXQtZGlhbG9nXCI+XG4gICAgICA8aDM+57yW6L6R5paH5Lu25aS5PC9oMz5cbiAgICAgIDxkaXYgY2xhc3M9XCJmbGV4LWNvbnRhaW5lciBmbGV4Rmxvd0NvbHVtbiB3aWRlMTAwcCBwYWRkaW5nMTAganVzdGlmeUxlZnRcIj5cbiAgICAgICAgPGRpdj5cbiAgICAgICAgICA8aDQ+5paH5Lu25aS55ZCN56ewOjwvaDQ+XG4gICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgaWQ9XCJmb2xkZXItbmFtZS1pbnB1dFwiIGNsYXNzPVwidGV4dF9wb2xlXCIgdmFsdWU9XCIke2N1cnJlbnROYW1lfVwiIC8+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2PlxuICAgICAgICAgIDxoND7mlofku7blpLnlm77moIc6PC9oND5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiZmxleFwiIHN0eWxlPVwiZ2FwOiAyMHB4OyBtYXJnaW46IDVweCAwOyB3aWR0aDogMTAwJTtcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJmbGV4IGFsaWduSXRlbXNDZW50ZXJcIj5cbiAgICAgICAgICAgIDxsYWJlbD7pgInmi6npopzoibI8L2xhYmVsPlxuICAgICAgICAgICAgPHRvb2xjb29sLWNvbG9yLXBpY2tlciBpZD1cImZvbGRlci1jb2xvci1waWNrZXJcIiBjb2xvcj1cIiR7Y3VycmVudENvbG9yUmdiYX1cIj48L3Rvb2xjb29sLWNvbG9yLXBpY2tlcj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImZsZXgtY29udGFpbmVyIGFsaWduSXRlbXNDZW50ZXJcIj5cbiAgICAgICAgICAgICA8bGFiZWw+6YCJ5oup5Zu+5qCHPC9sYWJlbD5cbiAgICAgICAgICAgICAgPGkgaWQ9XCJmb2xkZXItaWNvbi1wcmV2aWV3XCIgY2xhc3M9XCJmYSAke2N1cnJlbnRJY29ufSBtYXJnaW5SaWdodDEwXCIgc3R5bGU9XCJjdXJzb3I6IHBvaW50ZXI7IGZvbnQtc2l6ZTogMTJweDsgcGFkZGluZzogNHB4OyBib3JkZXI6IDFweCBzb2xpZCAjY2NjOyBib3JkZXItcmFkaXVzOiA0cHg7XCIgdGl0bGU9XCLngrnlh7vpgInmi6nlm77moIdcIj48L2k+XG4gICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwiaGlkZGVuXCIgaWQ9XCJmb2xkZXItaWNvbi12YWx1ZVwiIHZhbHVlPVwiJHtjdXJyZW50SWNvbn1cIiAvPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgYCk7XG5cbiAgICB0ZW1wbGF0ZS5maW5kKCcjZm9sZGVyLWljb24tcHJldmlldycpLm9uKCdjbGljaycsIGFzeW5jICgpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHNlbGVjdGVkSWNvbiA9IGF3YWl0IHNob3dGb250QXdlc29tZVBpY2tlcigpO1xuICAgICAgICBpZiAoc2VsZWN0ZWRJY29uICYmIHNlbGVjdGVkSWNvbi50cmltKCkgIT09ICcnKSB7XG4gICAgICAgICAgdGVtcGxhdGUuZmluZCgnI2ZvbGRlci1pY29uLXByZXZpZXcnKS5yZW1vdmVDbGFzcygpLmFkZENsYXNzKGBmYSAke3NlbGVjdGVkSWNvbn1gKTtcbiAgICAgICAgICB0ZW1wbGF0ZS5maW5kKCcjZm9sZGVyLWljb24tdmFsdWUnKS52YWwoc2VsZWN0ZWRJY29uKTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgbG9nLmVycm9yKCdbU2NyaXB0TWFuYWdlcl0g5Zu+5qCH6YCJ5oup5aSx6LSlOicsIGVycm9yKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICB0ZW1wbGF0ZS5maW5kKCcjZm9sZGVyLWNvbG9yLXBpY2tlcicpLm9uKCdjaGFuZ2UnLCBldnQgPT4ge1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgbmV3Q29sb3IgPSBldnQuZGV0YWlsPy5yZ2JhO1xuICAgIH0pO1xuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2FsbEdlbmVyaWNQb3B1cCh0ZW1wbGF0ZSwgUE9QVVBfVFlQRS5DT05GSVJNLCAnJywge1xuICAgICAgb2tCdXR0b246ICfkv53lrZgnLFxuICAgICAgY2FuY2VsQnV0dG9uOiAn5Y+W5raIJyxcbiAgICB9KTtcblxuICAgIGlmICghcmVzdWx0KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgbmV3TmFtZSA9IHRlbXBsYXRlLmZpbmQoJyNmb2xkZXItbmFtZS1pbnB1dCcpLnZhbCgpIGFzIHN0cmluZztcbiAgICBjb25zdCBuZXdJY29uID0gdGVtcGxhdGUuZmluZCgnI2ZvbGRlci1pY29uLXZhbHVlJykudmFsKCkgYXMgc3RyaW5nO1xuXG4gICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5GT0xERVJfRURJVCwge1xuICAgICAgZm9sZGVySWQsXG4gICAgICBuZXdOYW1lOiBuZXdOYW1lPy50cmltKCkgfHwgY3VycmVudE5hbWUsXG4gICAgICB0eXBlLFxuICAgICAgbmV3SWNvbjogbmV3SWNvbixcbiAgICAgIG5ld0NvbG9yOiBuZXdDb2xvcixcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlr7zlh7rmlofku7blpLnkuLrljovnvKnljIVcbiAgICogQHBhcmFtIGZvbGRlcklkIOaWh+S7tuWkuUlEXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBleHBvcnRGb2xkZXIoZm9sZGVySWQ6IHN0cmluZywgdHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXBvc2l0b3J5ID1cbiAgICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUxcbiAgICAgICAgICA/IHRoaXMuc2NyaXB0TWFuYWdlci5nZXRHbG9iYWxSZXBvc2l0b3J5SXRlbXMoKVxuICAgICAgICAgIDogdGhpcy5zY3JpcHRNYW5hZ2VyLmdldENoYXJhY3RlclJlcG9zaXRvcnlJdGVtcygpO1xuXG4gICAgICBjb25zdCBmb2xkZXIgPSByZXBvc2l0b3J5LmZpbmQoaXRlbSA9PiBpdGVtLnR5cGUgPT09ICdmb2xkZXInICYmIGl0ZW0uaWQgPT09IGZvbGRlcklkKTtcblxuICAgICAgaWYgKCFmb2xkZXIpIHtcbiAgICAgICAgdG9hc3RyLmVycm9yKCfmnKrmib7liLDmjIflrprnmoTmlofku7blpLknKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgLy9AdHMtaWdub3JlXG4gICAgICBpZiAoIXdpbmRvdy5KU1ppcCkge1xuICAgICAgICBhd2FpdCBpbXBvcnQoJ0BzaWxseXRhdmVybi9saWIvanN6aXAubWluLmpzJyk7XG4gICAgICB9XG4gICAgICAvL0B0cy1pZ25vcmVcbiAgICAgIGNvbnN0IHppcCA9IG5ldyBKU1ppcCgpO1xuXG4gICAgICBjb25zdCBmb2xkZXJOYW1lID0gZm9sZGVyLm5hbWUgfHwgJ2ZvbGRlcic7XG4gICAgICBjb25zdCBzYW5pdGl6ZWRGb2xkZXJOYW1lID0gZm9sZGVyTmFtZS5yZXBsYWNlKC9bPD46XCIvXFxcXHw/Kl0vZywgJ18nKTtcblxuICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZm9sZGVyLnZhbHVlKSkge1xuICAgICAgICBsZXQgY2FuY2VsRXhwb3J0ID0gZmFsc2U7XG5cbiAgICAgICAgZm9yIChjb25zdCBzY3JpcHQgb2YgZm9sZGVyLnZhbHVlKSB7XG4gICAgICAgICAgY29uc3Qgc2NyaXB0RGF0YSA9IGF3YWl0IHRoaXMuY2hlY2tTY3JpcHREYXRhQW5kR2V0RXhwb3J0RGF0YShzY3JpcHQpO1xuXG4gICAgICAgICAgaWYgKHNjcmlwdERhdGEgPT09IG51bGwpIHtcbiAgICAgICAgICAgIGNhbmNlbEV4cG9ydCA9IHRydWU7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb25zdCBzY3JpcHRGaWxlTmFtZSA9IGAke3NjcmlwdC5uYW1lLnJlcGxhY2UoL1s8PjpcIi9cXFxcfD8qXS9nLCAnXycpfS5qc29uYDtcbiAgICAgICAgICB6aXAuZmlsZShgJHtzYW5pdGl6ZWRGb2xkZXJOYW1lfS8ke3NjcmlwdEZpbGVOYW1lfWAsIEpTT04uc3RyaW5naWZ5KHNjcmlwdERhdGEsIG51bGwsIDIpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjYW5jZWxFeHBvcnQpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY29uc3QgemlwQmxvYiA9IGF3YWl0IHppcC5nZW5lcmF0ZUFzeW5jKHsgdHlwZTogJ2Jsb2InIH0pO1xuXG4gICAgICBjb25zdCB0aW1lc3RhbXAgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc2xpY2UoMCwgMTkpLnJlcGxhY2UoLzovZywgJy0nKTtcbiAgICAgIGNvbnN0IHR5cGVOYW1lID0gdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyAnZ2xvYmFsJyA6ICdjaGFyYWN0ZXInO1xuICAgICAgY29uc3QgZmlsZW5hbWUgPSBgZm9sZGVyXyR7c2FuaXRpemVkRm9sZGVyTmFtZX1fJHt0eXBlTmFtZX1fJHt0aW1lc3RhbXB9LnppcGA7XG5cbiAgICAgIGNvbnN0IHVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoemlwQmxvYik7XG4gICAgICBjb25zdCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuICAgICAgYS5ocmVmID0gdXJsO1xuICAgICAgYS5kb3dubG9hZCA9IGZpbGVuYW1lO1xuICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhKTtcbiAgICAgIGEuY2xpY2soKTtcbiAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoYSk7XG4gICAgICBVUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7XG5cbiAgICAgIHRvYXN0ci5zdWNjZXNzKGDmlofku7blpLkgXCIke2ZvbGRlci5uYW1lfVwiIOWvvOWHuuaIkOWKn2ApO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2cuZXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDlr7zlh7rmlofku7blpLnlpLHotKU6JywgZXJyb3IpO1xuICAgICAgdG9hc3RyLmVycm9yKGDlr7zlh7rmlofku7blpLnlpLHotKU6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpfWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmmL7npLrliKDpmaTmlofku7blpLnnoa7orqTlr7nor53moYZcbiAgICogQHBhcmFtIGZvbGRlcklkIOaWh+S7tuWkuUlEXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBzaG93RGVsZXRlRm9sZGVyRGlhbG9nKGZvbGRlcklkOiBzdHJpbmcsIHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCByZXBvc2l0b3J5ID1cbiAgICAgIHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMXG4gICAgICAgID8gdGhpcy5zY3JpcHRNYW5hZ2VyLmdldEdsb2JhbFJlcG9zaXRvcnlJdGVtcygpXG4gICAgICAgIDogdGhpcy5zY3JpcHRNYW5hZ2VyLmdldENoYXJhY3RlclJlcG9zaXRvcnlJdGVtcygpO1xuXG4gICAgY29uc3QgZm9sZGVyID0gcmVwb3NpdG9yeS5maW5kKGl0ZW0gPT4gaXRlbS50eXBlID09PSAnZm9sZGVyJyAmJiBpdGVtLmlkID09PSBmb2xkZXJJZCk7XG4gICAgY29uc3QgZm9sZGVyTmFtZSA9IGZvbGRlcj8ubmFtZSB8fCAn5pyq55+l5paH5Lu25aS5JztcblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNhbGxHZW5lcmljUG9wdXAoXG4gICAgICBg56Gu5a6a6KaB5Yig6Zmk5paH5Lu25aS5IFwiJHtmb2xkZXJOYW1lfVwiIOWPiuWFtuS4reeahOaJgOacieiEmuacrOWQl++8n+atpOaTjeS9nOS4jeWPr+aSpOmUgOOAgmAsXG4gICAgICBQT1BVUF9UWVBFLkNPTkZJUk0sXG4gICAgICAnJyxcbiAgICAgIHsgb2tCdXR0b246ICfliKDpmaQnLCBjYW5jZWxCdXR0b246ICflj5bmtognIH0sXG4gICAgKTtcblxuICAgIGlmIChyZXN1bHQpIHtcbiAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuRk9MREVSX0RFTEVURSwge1xuICAgICAgICBmb2xkZXJJZCxcbiAgICAgICAgdHlwZSxcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDorr7nva7mkJzntKLlip/og73kuovku7ZcbiAgICovXG4gIHByaXZhdGUgc2V0dXBTZWFyY2hFdmVudHMoKTogdm9pZCB7XG4gICAgY29uc3Qgc2VhcmNoSW5wdXQgPSAkKCcjc2NyaXB0LXNlYXJjaC1pbnB1dCcpO1xuXG4gICAgc2VhcmNoSW5wdXQub24oJ2lucHV0JywgZXZlbnQgPT4ge1xuICAgICAgY29uc3QgcXVlcnkgPSAoZXZlbnQudGFyZ2V0IGFzIEhUTUxJbnB1dEVsZW1lbnQpLnZhbHVlLnRyaW0oKTtcbiAgICAgIGlmIChxdWVyeSkge1xuICAgICAgICB0aGlzLnBlcmZvcm1TZWFyY2gocXVlcnkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5jbGVhclNlYXJjaCgpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgc2VhcmNoSW5wdXQub24oJ2tleXByZXNzJywgZXZlbnQgPT4ge1xuICAgICAgaWYgKGV2ZW50LndoaWNoID09PSAxMykge1xuICAgICAgICBjb25zdCBxdWVyeSA9IHNlYXJjaElucHV0LnZhbCgpIGFzIHN0cmluZztcbiAgICAgICAgaWYgKHF1ZXJ5ICYmIHF1ZXJ5LnRyaW0oKSkge1xuICAgICAgICAgIHRoaXMucGVyZm9ybVNlYXJjaChxdWVyeS50cmltKCkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog5omn6KGM5pCc57SiXG4gICAqIEBwYXJhbSBxdWVyeSDmkJzntKLlhbPplK7or41cbiAgICovXG4gIHByaXZhdGUgcGVyZm9ybVNlYXJjaChxdWVyeTogc3RyaW5nKTogdm9pZCB7XG4gICAgaWYgKCFxdWVyeSkge1xuICAgICAgdGhpcy5jbGVhclNlYXJjaCgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGdsb2JhbFNjcmlwdHMgPSB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0R2xvYmFsU2NyaXB0cygpO1xuICAgIGNvbnN0IGNoYXJhY3RlclNjcmlwdHMgPSB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0Q2hhcmFjdGVyU2NyaXB0cygpO1xuXG4gICAgY29uc3QgZ2xvYmFsTWF0Y2hlcyA9IHRoaXMuc2VhcmNoU2NyaXB0cyhnbG9iYWxTY3JpcHRzLCBxdWVyeSk7XG4gICAgY29uc3QgY2hhcmFjdGVyTWF0Y2hlcyA9IHRoaXMuc2VhcmNoU2NyaXB0cyhjaGFyYWN0ZXJTY3JpcHRzLCBxdWVyeSk7XG5cbiAgICB0aGlzLmRpc3BsYXlTZWFyY2hSZXN1bHRzKGdsb2JhbE1hdGNoZXMsIGNoYXJhY3Rlck1hdGNoZXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIOWcqOiEmuacrOaVsOe7hOS4reaQnOe0ouWMuemFjeeahOiEmuacrFxuICAgKiBAcGFyYW0gc2NyaXB0cyDohJrmnKzmlbDnu4RcbiAgICogQHBhcmFtIHF1ZXJ5IOaQnOe0ouWFs+mUruivjVxuICAgKiBAcmV0dXJucyDljLnphY3nmoTohJrmnKzmlbDnu4RcbiAgICovXG4gIHByaXZhdGUgc2VhcmNoU2NyaXB0cyhzY3JpcHRzOiBTY3JpcHRbXSwgcXVlcnk6IHN0cmluZyk6IFNjcmlwdFtdIHtcbiAgICBjb25zdCBsb3dlclF1ZXJ5ID0gcXVlcnkudG9Mb3dlckNhc2UoKTtcbiAgICByZXR1cm4gc2NyaXB0cy5maWx0ZXIoc2NyaXB0ID0+IHNjcmlwdC5uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMobG93ZXJRdWVyeSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIOaYvuekuuaQnOe0oue7k+aenFxuICAgKiBAcGFyYW0gZ2xvYmFsTWF0Y2hlcyDlhajlsYDohJrmnKzljLnphY3nu5PmnpxcbiAgICogQHBhcmFtIGNoYXJhY3Rlck1hdGNoZXMg6KeS6Imy6ISa5pys5Yy56YWN57uT5p6cXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGRpc3BsYXlTZWFyY2hSZXN1bHRzKGdsb2JhbE1hdGNoZXM6IFNjcmlwdFtdLCBjaGFyYWN0ZXJNYXRjaGVzOiBTY3JpcHRbXSk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRoaXMuY2xlYXJTY3JpcHRMaXN0KFNjcmlwdFR5cGUuR0xPQkFMKTtcbiAgICB0aGlzLmNsZWFyU2NyaXB0TGlzdChTY3JpcHRUeXBlLkNIQVJBQ1RFUik7XG5cbiAgICBjb25zdCBnbG9iYWxDb250YWluZXIgPSAkKCcjZ2xvYmFsLXNjcmlwdC1saXN0Jyk7XG4gICAgaWYgKGdsb2JhbE1hdGNoZXMubGVuZ3RoID4gMCkge1xuICAgICAgZm9yIChjb25zdCBzY3JpcHQgb2YgZ2xvYmFsTWF0Y2hlcykge1xuICAgICAgICBhd2FpdCB0aGlzLmFkZFNjcmlwdFRvQ29udGFpbmVyKHNjcmlwdCwgU2NyaXB0VHlwZS5HTE9CQUwpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBnbG9iYWxDb250YWluZXIuYXBwZW5kKCc8c21hbGw+5peg5Yy56YWN55qE5YWo5bGA6ISa5pysPC9zbWFsbD4nKTtcbiAgICB9XG5cbiAgICBjb25zdCBjaGFyYWN0ZXJDb250YWluZXIgPSAkKCcjY2hhcmFjdGVyLXNjcmlwdC1saXN0Jyk7XG4gICAgaWYgKGNoYXJhY3Rlck1hdGNoZXMubGVuZ3RoID4gMCkge1xuICAgICAgZm9yIChjb25zdCBzY3JpcHQgb2YgY2hhcmFjdGVyTWF0Y2hlcykge1xuICAgICAgICBhd2FpdCB0aGlzLmFkZFNjcmlwdFRvQ29udGFpbmVyKHNjcmlwdCwgU2NyaXB0VHlwZS5DSEFSQUNURVIpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBjaGFyYWN0ZXJDb250YWluZXIuYXBwZW5kKCc8c21hbGw+5peg5Yy56YWN55qE6KeS6Imy6ISa5pysPC9zbWFsbD4nKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5riF6Zmk5pCc57Si57uT5p6c77yM5oGi5aSN5q2j5bi45pi+56S6XG4gICAqL1xuICBwcml2YXRlIGNsZWFyU2VhcmNoKCk6IHZvaWQge1xuICAgIHRoaXMucmVuZGVyU2NyaXB0TGlzdHMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDorr7nva7mibnph4/mk43kvZzkuovku7ZcbiAgICovXG4gIHByaXZhdGUgc2V0dXBCYXRjaE9wZXJhdGlvbkV2ZW50cygpOiB2b2lkIHtcbiAgICAkKCcjZ2xvYmFsLWJhdGNoLW1hbmFnZXInKS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLnRvZ2dsZUJhdGNoTW9kZShTY3JpcHRUeXBlLkdMT0JBTCk7XG4gICAgfSk7XG5cbiAgICAkKCcjY2hhcmFjdGVyLWJhdGNoLW1hbmFnZXInKS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLnRvZ2dsZUJhdGNoTW9kZShTY3JpcHRUeXBlLkNIQVJBQ1RFUik7XG4gICAgfSk7XG5cbiAgICAkKCcjZ2xvYmFsLWJhdGNoLWRlbGV0ZScpLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMucGVyZm9ybUJhdGNoRGVsZXRlKFNjcmlwdFR5cGUuR0xPQkFMKTtcbiAgICB9KTtcblxuICAgICQoJyNnbG9iYWwtYmF0Y2gtZXhwb3J0Jykub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5wZXJmb3JtQmF0Y2hFeHBvcnQoU2NyaXB0VHlwZS5HTE9CQUwpO1xuICAgIH0pO1xuXG4gICAgJCgnI2dsb2JhbC1iYXRjaC1tb3ZlJykub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5wZXJmb3JtQmF0Y2hNb3ZlKFNjcmlwdFR5cGUuR0xPQkFMKTtcbiAgICB9KTtcblxuICAgICQoJyNnbG9iYWwtYmF0Y2gtY2FuY2VsJykub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5leGl0QmF0Y2hNb2RlKFNjcmlwdFR5cGUuR0xPQkFMKTtcbiAgICB9KTtcblxuICAgICQoJyNjaGFyYWN0ZXItYmF0Y2gtZGVsZXRlJykub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5wZXJmb3JtQmF0Y2hEZWxldGUoU2NyaXB0VHlwZS5DSEFSQUNURVIpO1xuICAgIH0pO1xuXG4gICAgJCgnI2NoYXJhY3Rlci1iYXRjaC1leHBvcnQnKS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLnBlcmZvcm1CYXRjaEV4cG9ydChTY3JpcHRUeXBlLkNIQVJBQ1RFUik7XG4gICAgfSk7XG5cbiAgICAkKCcjY2hhcmFjdGVyLWJhdGNoLW1vdmUnKS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLnBlcmZvcm1CYXRjaE1vdmUoU2NyaXB0VHlwZS5DSEFSQUNURVIpO1xuICAgIH0pO1xuXG4gICAgJCgnI2NoYXJhY3Rlci1iYXRjaC1jYW5jZWwnKS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLmV4aXRCYXRjaE1vZGUoU2NyaXB0VHlwZS5DSEFSQUNURVIpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOWIh+aNouaJuemHj+aooeW8j1xuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHByaXZhdGUgdG9nZ2xlQmF0Y2hNb2RlKHR5cGU6IFNjcmlwdFR5cGUpOiB2b2lkIHtcbiAgICBjb25zdCBpc0JhdGNoTW9kZSA9IHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMID8gdGhpcy5iYXRjaE1vZGVHbG9iYWwgOiB0aGlzLmJhdGNoTW9kZUNoYXJhY3RlcjtcblxuICAgIGlmIChpc0JhdGNoTW9kZSkge1xuICAgICAgdGhpcy5leGl0QmF0Y2hNb2RlKHR5cGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmVudGVyQmF0Y2hNb2RlKHR5cGUpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDov5vlhaXmibnph4/mqKHlvI9cbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwcml2YXRlIGVudGVyQmF0Y2hNb2RlKHR5cGU6IFNjcmlwdFR5cGUpOiB2b2lkIHtcbiAgICBjb25zdCBsaXN0U2VsZWN0b3IgPSBnZXRTY3JpcHRMaXN0U2VsZWN0b3IodHlwZSk7XG4gICAgY29uc3QgY29udHJvbHNTZWxlY3RvciA9IGdldEJhdGNoQ29udHJvbHNTZWxlY3Rvcih0eXBlKTtcblxuICAgIGlmICh0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCkge1xuICAgICAgdGhpcy5iYXRjaE1vZGVHbG9iYWwgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmJhdGNoTW9kZUNoYXJhY3RlciA9IHRydWU7XG4gICAgfVxuXG4gICAgJChjb250cm9sc1NlbGVjdG9yKS5zaG93KCk7XG5cbiAgICBjb25zdCAkbGlzdCA9ICQobGlzdFNlbGVjdG9yKTtcblxuICAgICRsaXN0LmZpbmQoJy5zY3JpcHQtaXRlbScpLmVhY2goKF8sIGVsZW1lbnQpID0+IHtcbiAgICAgIGNvbnN0ICRlbGVtZW50ID0gJChlbGVtZW50KTtcbiAgICAgICRlbGVtZW50LmFkZENsYXNzKCdiYXRjaC1tb2RlJyk7XG4gICAgICAkZWxlbWVudC5maW5kKCcuc2NyaXB0LWNoZWNrYm94Jykuc2hvdygpO1xuICAgICAgJGVsZW1lbnQuZmluZCgnLmRyYWctaGFuZGxlJykuaGlkZSgpO1xuICAgICAgJGVsZW1lbnQuZmluZCgnLnNjcmlwdC1pdGVtLWNvbnRyb2wnKS5oaWRlKCk7XG5cbiAgICAgICRlbGVtZW50XG4gICAgICAgIC5maW5kKCcuc2NyaXB0LWNoZWNrYm94JylcbiAgICAgICAgLm9mZignY2hhbmdlLmJhdGNoJylcbiAgICAgICAgLm9uKCdjaGFuZ2UuYmF0Y2gnLCAoKSA9PiB7XG4gICAgICAgICAgdGhpcy5oYW5kbGVDaGVja2JveENoYW5nZSgkZWxlbWVudCk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgJGxpc3QuZmluZCgnLnNjcmlwdC1mb2xkZXInKS5lYWNoKChfLCBlbGVtZW50KSA9PiB7XG4gICAgICBjb25zdCAkZWxlbWVudCA9ICQoZWxlbWVudCk7XG4gICAgICAkZWxlbWVudC5hZGRDbGFzcygnYmF0Y2gtbW9kZScpO1xuICAgICAgJGVsZW1lbnQuZmluZCgnLmZvbGRlci1jaGVja2JveCcpLnNob3coKTtcbiAgICAgICRlbGVtZW50LmZpbmQoJy5kcmFnLWhhbmRsZScpLmhpZGUoKTtcbiAgICAgICRlbGVtZW50LmZpbmQoJy5mb2xkZXItY29udHJvbCAuZm9sZGVyLXNjcmlwdC10b2dnbGUnKS5oaWRlKCk7XG4gICAgICAkZWxlbWVudC5maW5kKCcuZm9sZGVyLWNvbnRyb2wgLmZvbGRlci1lZGl0JykuaGlkZSgpO1xuICAgICAgJGVsZW1lbnQuZmluZCgnLmZvbGRlci1jb250cm9sIC5mb2xkZXItZXhwb3J0JykuaGlkZSgpO1xuICAgICAgJGVsZW1lbnQuZmluZCgnLmZvbGRlci1jb250cm9sIC5mb2xkZXItbW92ZScpLmhpZGUoKTtcbiAgICAgICRlbGVtZW50LmZpbmQoJy5mb2xkZXItY29udHJvbCAuZm9sZGVyLWRlbGV0ZScpLmhpZGUoKTtcblxuICAgICAgJGVsZW1lbnRcbiAgICAgICAgLmZpbmQoJy5mb2xkZXItY2hlY2tib3gnKVxuICAgICAgICAub2ZmKCdjaGFuZ2UuYmF0Y2gnKVxuICAgICAgICAub24oJ2NoYW5nZS5iYXRjaCcsICgpID0+IHtcbiAgICAgICAgICB0aGlzLmhhbmRsZUNoZWNrYm94Q2hhbmdlKCRlbGVtZW50KTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog6YCA5Ye65om56YeP5qih5byPXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBleGl0QmF0Y2hNb2RlKHR5cGU6IFNjcmlwdFR5cGUpOiB2b2lkIHtcbiAgICBjb25zdCBsaXN0U2VsZWN0b3IgPSBnZXRTY3JpcHRMaXN0U2VsZWN0b3IodHlwZSk7XG4gICAgY29uc3QgY29udHJvbHNTZWxlY3RvciA9IGdldEJhdGNoQ29udHJvbHNTZWxlY3Rvcih0eXBlKTtcblxuICAgIGlmICh0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCkge1xuICAgICAgdGhpcy5iYXRjaE1vZGVHbG9iYWwgPSBmYWxzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5iYXRjaE1vZGVDaGFyYWN0ZXIgPSBmYWxzZTtcbiAgICB9XG5cbiAgICAkKGNvbnRyb2xzU2VsZWN0b3IpLmhpZGUoKTtcblxuICAgIGNvbnN0ICRsaXN0ID0gJChsaXN0U2VsZWN0b3IpO1xuXG4gICAgJGxpc3QuZmluZCgnLnNjcmlwdC1pdGVtLCAuc2NyaXB0LWZvbGRlcicpLmVhY2goKF8sIGVsZW1lbnQpID0+IHtcbiAgICAgIGNvbnN0ICRlbGVtZW50ID0gJChlbGVtZW50KTtcbiAgICAgICRlbGVtZW50LnJlbW92ZUNsYXNzKCdiYXRjaC1tb2RlIHNlbGVjdGVkJyk7XG4gICAgICAkZWxlbWVudC5maW5kKCcuc2NyaXB0LWNoZWNrYm94LCAuZm9sZGVyLWNoZWNrYm94JykuaGlkZSgpLnByb3AoJ2NoZWNrZWQnLCBmYWxzZSk7XG4gICAgICAkZWxlbWVudC5maW5kKCcuc2NyaXB0LWl0ZW0tY29udHJvbCcpLnNob3coKTtcbiAgICAgICRlbGVtZW50LmZpbmQoJy5kcmFnLWhhbmRsZScpLnNob3coKTtcbiAgICAgICRlbGVtZW50LmZpbmQoJy5zY3JpcHQtY29udHJvbHMnKS5zaG93KCk7XG4gICAgICAkZWxlbWVudC5maW5kKCcuZm9sZGVyLWNvbnRyb2wgLmZvbGRlci1zY3JpcHQtdG9nZ2xlJykuc2hvdygpO1xuICAgICAgJGVsZW1lbnQuZmluZCgnLmZvbGRlci1jb250cm9sIC5mb2xkZXItZWRpdCcpLnNob3coKTtcbiAgICAgICRlbGVtZW50LmZpbmQoJy5mb2xkZXItY29udHJvbCAuZm9sZGVyLWV4cG9ydCcpLnNob3coKTtcbiAgICAgICRlbGVtZW50LmZpbmQoJy5mb2xkZXItY29udHJvbCAuZm9sZGVyLW1vdmUnKS5zaG93KCk7XG4gICAgICAkZWxlbWVudC5maW5kKCcuZm9sZGVyLWNvbnRyb2wgLmZvbGRlci1kZWxldGUnKS5zaG93KCk7XG4gICAgICAkZWxlbWVudC5maW5kKCcuc2NyaXB0LWNoZWNrYm94LCAuZm9sZGVyLWNoZWNrYm94Jykub2ZmKCdjaGFuZ2UuYmF0Y2gnKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlpI3pgInmoYbnirbmgIHlj5jljJbml7bmt7vliqDpgInkuK3nirbmgIFjc3NcbiAgICogQHBhcmFtICRlbGVtZW50IOWFg+e0oGpRdWVyeeWvueixoVxuICAgKi9cbiAgcHJpdmF0ZSBoYW5kbGVDaGVja2JveENoYW5nZSgkZWxlbWVudDogSlF1ZXJ5PEhUTUxFbGVtZW50Pik6IHZvaWQge1xuICAgIGNvbnN0IGlzQ2hlY2tlZCA9ICRlbGVtZW50LmZpbmQoJy5zY3JpcHQtY2hlY2tib3gsIC5mb2xkZXItY2hlY2tib3gnKS5wcm9wKCdjaGVja2VkJyk7XG5cbiAgICBpZiAoaXNDaGVja2VkKSB7XG4gICAgICAkZWxlbWVudC5hZGRDbGFzcygnc2VsZWN0ZWQnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgJGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ3NlbGVjdGVkJyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPlumAieS4reeahOmhueebrlxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICogQHJldHVybnMg6YCJ5Lit55qE6ISa5pysSUTlkozmlofku7blpLlJROaVsOe7hFxuICAgKi9cbiAgcHJpdmF0ZSBnZXRTZWxlY3RlZEl0ZW1zKHR5cGU6IFNjcmlwdFR5cGUpOiB7IHNjcmlwdElkczogc3RyaW5nW107IGZvbGRlcklkczogc3RyaW5nW10gfSB7XG4gICAgY29uc3QgbGlzdFNlbGVjdG9yID0gZ2V0U2NyaXB0TGlzdFNlbGVjdG9yKHR5cGUpO1xuICAgIGNvbnN0IHNjcmlwdElkczogc3RyaW5nW10gPSBbXTtcbiAgICBjb25zdCBmb2xkZXJJZHM6IHN0cmluZ1tdID0gW107XG5cbiAgICAkKGxpc3RTZWxlY3RvcilcbiAgICAgIC5maW5kKCcuc2NyaXB0LWl0ZW0uc2VsZWN0ZWQnKVxuICAgICAgLmVhY2goKF8sIGVsZW1lbnQpID0+IHtcbiAgICAgICAgY29uc3QgaWQgPSAkKGVsZW1lbnQpLmF0dHIoJ2lkJyk7XG4gICAgICAgIGlmIChpZCkgc2NyaXB0SWRzLnB1c2goaWQpO1xuICAgICAgfSk7XG5cbiAgICAkKGxpc3RTZWxlY3RvcilcbiAgICAgIC5maW5kKCcuc2NyaXB0LWZvbGRlci5zZWxlY3RlZCcpXG4gICAgICAuZWFjaCgoXywgZWxlbWVudCkgPT4ge1xuICAgICAgICBjb25zdCBpZCA9ICQoZWxlbWVudCkuYXR0cignaWQnKTtcbiAgICAgICAgaWYgKGlkKSBmb2xkZXJJZHMucHVzaChpZCk7XG4gICAgICB9KTtcblxuICAgIHJldHVybiB7IHNjcmlwdElkcywgZm9sZGVySWRzIH07XG4gIH1cblxuICAvKipcbiAgICog5omn6KGM5om56YeP5Yig6ZmkXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBwZXJmb3JtQmF0Y2hEZWxldGUodHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHsgc2NyaXB0SWRzLCBmb2xkZXJJZHMgfSA9IHRoaXMuZ2V0U2VsZWN0ZWRJdGVtcyh0eXBlKTtcblxuICAgIGlmIChzY3JpcHRJZHMubGVuZ3RoID09PSAwICYmIGZvbGRlcklkcy5sZW5ndGggPT09IDApIHtcbiAgICAgIHRvYXN0ci53YXJuaW5nKCfor7foh7PlsJHpgInmi6nkuIDkuKrpobnnm67ov5vooYzliKDpmaQnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCB0b3RhbENvdW50ID0gc2NyaXB0SWRzLmxlbmd0aCArIGZvbGRlcklkcy5sZW5ndGg7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2FsbEdlbmVyaWNQb3B1cChcbiAgICAgIGDnoa7lrpropoHliKDpmaTpgInkuK3nmoQgJHt0b3RhbENvdW50fSDkuKrpobnnm67lkJfvvJ/mraTmk43kvZzkuI3lj6/mkqTplIDjgIJgLFxuICAgICAgUE9QVVBfVFlQRS5DT05GSVJNLFxuICAgICAgJycsXG4gICAgICB7IG9rQnV0dG9uOiAn5Yig6ZmkJywgY2FuY2VsQnV0dG9uOiAn5Y+W5raIJyB9LFxuICAgICk7XG5cbiAgICBpZiAoIXJlc3VsdCkgcmV0dXJuO1xuXG4gICAgdHJ5IHtcbiAgICAgIGZvciAoY29uc3Qgc2NyaXB0SWQgb2Ygc2NyaXB0SWRzKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuc2NyaXB0TWFuYWdlci5kZWxldGVTY3JpcHQoc2NyaXB0SWQsIHR5cGUpO1xuICAgICAgfVxuXG4gICAgICBmb3IgKGNvbnN0IGZvbGRlcklkIG9mIGZvbGRlcklkcykge1xuICAgICAgICBhd2FpdCB0aGlzLmhhbmRsZUZvbGRlckRlbGV0ZShmb2xkZXJJZCwgdHlwZSwgdHJ1ZSk7XG4gICAgICB9XG5cbiAgICAgIHRvYXN0ci5zdWNjZXNzKGDmiJDlip/liKDpmaQgJHt0b3RhbENvdW50fSDkuKrpobnnm65gKTtcblxuICAgICAgdGhpcy5leGl0QmF0Y2hNb2RlKHR5cGUpO1xuICAgICAgYXdhaXQgdGhpcy5yZW5kZXJTY3JpcHRMaXN0cygpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2cuZXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDmibnph4/liKDpmaTlpLHotKU6JywgZXJyb3IpO1xuICAgICAgdG9hc3RyLmVycm9yKGDmibnph4/liKDpmaTlpLHotKU6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpfWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmiafooYzmibnph4/lr7zlh7pcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHBlcmZvcm1CYXRjaEV4cG9ydCh0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgeyBzY3JpcHRJZHMsIGZvbGRlcklkcyB9ID0gdGhpcy5nZXRTZWxlY3RlZEl0ZW1zKHR5cGUpO1xuXG4gICAgaWYgKHNjcmlwdElkcy5sZW5ndGggPT09IDAgJiYgZm9sZGVySWRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdG9hc3RyLndhcm5pbmcoJ+ivt+iHs+WwkemAieaLqeS4gOS4qumhueebrui/m+ihjOWvvOWHuicpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICAvL0B0cy1pZ25vcmVcbiAgICAgIGlmICghd2luZG93LkpTWmlwKSB7XG4gICAgICAgIGF3YWl0IGltcG9ydCgnQHNpbGx5dGF2ZXJuL2xpYi9qc3ppcC5taW4uanMnKTtcbiAgICAgIH1cbiAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgY29uc3QgemlwID0gbmV3IEpTWmlwKCk7XG4gICAgICBsZXQgZXhwb3J0ZWRDb3VudCA9IDA7XG5cbiAgICAgIGxldCBjYW5jZWxFeHBvcnQgPSBmYWxzZTtcblxuICAgICAgZm9yIChjb25zdCBzY3JpcHRJZCBvZiBzY3JpcHRJZHMpIHtcbiAgICAgICAgY29uc3Qgc2NyaXB0ID0gdGhpcy5zY3JpcHRNYW5hZ2VyLmdldFNjcmlwdEJ5SWQoc2NyaXB0SWQpO1xuICAgICAgICBpZiAoc2NyaXB0KSB7XG4gICAgICAgICAgY29uc3Qgc2NyaXB0RGF0YSA9IGF3YWl0IHRoaXMuY2hlY2tTY3JpcHREYXRhQW5kR2V0RXhwb3J0RGF0YShzY3JpcHQpO1xuXG4gICAgICAgICAgaWYgKHNjcmlwdERhdGEgPT09IG51bGwpIHtcbiAgICAgICAgICAgIGNhbmNlbEV4cG9ydCA9IHRydWU7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb25zdCBzY3JpcHRGaWxlTmFtZSA9IGAke3NjcmlwdC5uYW1lLnJlcGxhY2UoL1s8PjpcIi9cXFxcfD8qXS9nLCAnXycpfS5qc29uYDtcbiAgICAgICAgICB6aXAuZmlsZShzY3JpcHRGaWxlTmFtZSwgSlNPTi5zdHJpbmdpZnkoc2NyaXB0RGF0YSwgbnVsbCwgMikpO1xuICAgICAgICAgIGV4cG9ydGVkQ291bnQrKztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoY2FuY2VsRXhwb3J0KSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcmVwb3NpdG9yeSA9XG4gICAgICAgIHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMXG4gICAgICAgICAgPyB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0R2xvYmFsUmVwb3NpdG9yeUl0ZW1zKClcbiAgICAgICAgICA6IHRoaXMuc2NyaXB0TWFuYWdlci5nZXRDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMoKTtcblxuICAgICAgZm9yIChjb25zdCBmb2xkZXJJZCBvZiBmb2xkZXJJZHMpIHtcbiAgICAgICAgY29uc3QgZm9sZGVyID0gcmVwb3NpdG9yeS5maW5kKGl0ZW0gPT4gaXRlbS50eXBlID09PSAnZm9sZGVyJyAmJiBpdGVtLmlkID09PSBmb2xkZXJJZCk7XG4gICAgICAgIGlmIChmb2xkZXIpIHtcbiAgICAgICAgICBjb25zdCBmb2xkZXJOYW1lID0gZm9sZGVyLm5hbWUgfHwgJ2ZvbGRlcic7XG4gICAgICAgICAgY29uc3Qgc2FuaXRpemVkRm9sZGVyTmFtZSA9IGZvbGRlck5hbWUucmVwbGFjZSgvWzw+OlwiL1xcXFx8PypdL2csICdfJyk7XG5cbiAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShmb2xkZXIudmFsdWUpKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHNjcmlwdCBvZiBmb2xkZXIudmFsdWUpIHtcbiAgICAgICAgICAgICAgY29uc3Qgc2NyaXB0RGF0YSA9IGF3YWl0IHRoaXMuY2hlY2tTY3JpcHREYXRhQW5kR2V0RXhwb3J0RGF0YShzY3JpcHQpO1xuXG4gICAgICAgICAgICAgIGlmIChzY3JpcHREYXRhID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY2FuY2VsRXhwb3J0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGNvbnN0IHNjcmlwdEZpbGVOYW1lID0gYCR7c2NyaXB0Lm5hbWUucmVwbGFjZSgvWzw+OlwiL1xcXFx8PypdL2csICdfJyl9Lmpzb25gO1xuICAgICAgICAgICAgICB6aXAuZmlsZShgJHtzYW5pdGl6ZWRGb2xkZXJOYW1lfS8ke3NjcmlwdEZpbGVOYW1lfWAsIEpTT04uc3RyaW5naWZ5KHNjcmlwdERhdGEsIG51bGwsIDIpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGNhbmNlbEV4cG9ydCkge1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgZXhwb3J0ZWRDb3VudCsrO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChjYW5jZWxFeHBvcnQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAoZXhwb3J0ZWRDb3VudCA9PT0gMCkge1xuICAgICAgICB0b2FzdHIuZXJyb3IoJ+ayoeacieaJvuWIsOacieaViOeahOWvvOWHuuaVsOaNricpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHppcEJsb2IgPSBhd2FpdCB6aXAuZ2VuZXJhdGVBc3luYyh7IHR5cGU6ICdibG9iJyB9KTtcblxuICAgICAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNsaWNlKDAsIDE5KS5yZXBsYWNlKC86L2csICctJyk7XG4gICAgICBjb25zdCB0eXBlTmFtZSA9IHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMID8gJ2dsb2JhbCcgOiAnY2hhcmFjdGVyJztcbiAgICAgIGNvbnN0IGZpbGVuYW1lID0gYGJhdGNoX2V4cG9ydF8ke3R5cGVOYW1lfV8ke3RpbWVzdGFtcH0uemlwYDtcblxuICAgICAgY29uc3QgdXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTCh6aXBCbG9iKTtcbiAgICAgIGNvbnN0IGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgICBhLmhyZWYgPSB1cmw7XG4gICAgICBhLmRvd25sb2FkID0gZmlsZW5hbWU7XG4gICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGEpO1xuICAgICAgYS5jbGljaygpO1xuICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChhKTtcbiAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwodXJsKTtcblxuICAgICAgdG9hc3RyLnN1Y2Nlc3MoYOaIkOWKn+WvvOWHuiAke2V4cG9ydGVkQ291bnR9IOS4qumhueebrmApO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2cuZXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDmibnph4/lr7zlh7rlpLHotKU6JywgZXJyb3IpO1xuICAgICAgdG9hc3RyLmVycm9yKGDmibnph4/lr7zlh7rlpLHotKU6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpfWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmiafooYzmibnph4/np7vliqjliLDmlofku7blpLlcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHBlcmZvcm1CYXRjaE1vdmUodHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHsgc2NyaXB0SWRzLCBmb2xkZXJJZHMgfSA9IHRoaXMuZ2V0U2VsZWN0ZWRJdGVtcyh0eXBlKTtcblxuICAgIGlmIChmb2xkZXJJZHMubGVuZ3RoID4gMCkge1xuICAgICAgdG9hc3RyLmVycm9yKCfkuI3og73np7vliqjmlofku7blpLnvvIzor7flj6rpgInmi6nohJrmnKzov5vooYznp7vliqjmk43kvZwnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoc2NyaXB0SWRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdG9hc3RyLndhcm5pbmcoJ+ivt+iHs+WwkemAieaLqeS4gOS4quiEmuacrOi/m+ihjOenu+WKqCcpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXBvc2l0b3J5ID1cbiAgICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUxcbiAgICAgICAgICA/IHRoaXMuc2NyaXB0TWFuYWdlci5nZXRHbG9iYWxSZXBvc2l0b3J5SXRlbXMoKVxuICAgICAgICAgIDogdGhpcy5zY3JpcHRNYW5hZ2VyLmdldENoYXJhY3RlclJlcG9zaXRvcnlJdGVtcygpO1xuXG4gICAgICBjb25zdCBmb2xkZXJzID0gcmVwb3NpdG9yeS5maWx0ZXIoaXRlbSA9PiBpdGVtLnR5cGUgPT09ICdmb2xkZXInKTtcblxuICAgICAgaWYgKGZvbGRlcnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHRvYXN0ci5lcnJvcign5rKh5pyJ5Y+v55So55qE5paH5Lu25aS577yM6K+35YWI5Yib5bu65LiA5Liq5paH5Lu25aS5Jyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZm9sZGVyT3B0aW9ucyA9IGZvbGRlcnMubWFwKGZvbGRlciA9PiBgPG9wdGlvbiB2YWx1ZT1cIiR7Zm9sZGVyLmlkfVwiPiR7Zm9sZGVyLm5hbWV9PC9vcHRpb24+YCkuam9pbignJyk7XG5cbiAgICAgIGNvbnN0IHRlbXBsYXRlID0gJChgXG4gICAgICAgIDxkaXY+XG4gICAgICAgICAgPHA+6YCJ5oup6KaB56e75Yqo5Yiw55qE5paH5Lu25aS577yaPC9wPlxuICAgICAgICAgIDxzZWxlY3QgaWQ9XCJ0YXJnZXQtZm9sZGVyLXNlbGVjdFwiIGNsYXNzPVwidGV4dF9wb2xlXCIgc3R5bGU9XCJ3aWR0aDogMTAwJTtcIj5cbiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCJcIj7moLnnm67lvZU8L29wdGlvbj5cbiAgICAgICAgICAgICR7Zm9sZGVyT3B0aW9uc31cbiAgICAgICAgICA8L3NlbGVjdD5cbiAgICAgICAgPC9kaXY+XG4gICAgICBgKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2FsbEdlbmVyaWNQb3B1cCh0ZW1wbGF0ZSwgUE9QVVBfVFlQRS5DT05GSVJNLCAnJywge1xuICAgICAgICBva0J1dHRvbjogJ+enu+WKqCcsXG4gICAgICAgIGNhbmNlbEJ1dHRvbjogJ+WPlua2iCcsXG4gICAgICB9KTtcblxuICAgICAgaWYgKCFyZXN1bHQpIHJldHVybjtcblxuICAgICAgY29uc3QgdGFyZ2V0Rm9sZGVySWQgPSAodGVtcGxhdGUuZmluZCgnI3RhcmdldC1mb2xkZXItc2VsZWN0JykudmFsKCkgYXMgc3RyaW5nKSB8fCBudWxsO1xuXG4gICAgICBmb3IgKGNvbnN0IHNjcmlwdElkIG9mIHNjcmlwdElkcykge1xuICAgICAgICBhd2FpdCB0aGlzLnNjcmlwdE1hbmFnZXIubW92ZVNjcmlwdFRvRm9sZGVyKHNjcmlwdElkLCB0YXJnZXRGb2xkZXJJZCwgdHlwZSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHRhcmdldE5hbWUgPSB0YXJnZXRGb2xkZXJJZCA/IGZvbGRlcnMuZmluZChmID0+IGYuaWQgPT09IHRhcmdldEZvbGRlcklkKT8ubmFtZSB8fCAn5pyq55+l5paH5Lu25aS5JyA6ICfmoLnnm67lvZUnO1xuXG4gICAgICB0b2FzdHIuc3VjY2Vzcyhg5oiQ5Yqf5bCGICR7c2NyaXB0SWRzLmxlbmd0aH0g5Liq6ISa5pys56e75Yqo5YiwXCIke3RhcmdldE5hbWV9XCJgKTtcblxuICAgICAgdGhpcy5leGl0QmF0Y2hNb2RlKHR5cGUpO1xuICAgICAgYXdhaXQgdGhpcy5yZW5kZXJTY3JpcHRMaXN0cygpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2cuZXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDmibnph4/np7vliqjlpLHotKU6JywgZXJyb3IpO1xuICAgICAgdG9hc3RyLmVycm9yKGDmibnph4/np7vliqjlpLHotKU6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpfWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDlpITnkIbmlofku7blpLnliJvlu7rkuovku7ZcbiAgICogQHBhcmFtIG5hbWUg5paH5Lu25aS55ZCN56ewXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKiBAcGFyYW0gaWNvbiDmlofku7blpLnlm77moIdcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgaGFuZGxlRm9sZGVyQ3JlYXRlKG5hbWU6IHN0cmluZywgdHlwZTogU2NyaXB0VHlwZSwgaWNvbj86IHN0cmluZywgY29sb3I/OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgdGhpcy5zY3JpcHRNYW5hZ2VyLmNyZWF0ZUZvbGRlcihuYW1lLCB0eXBlLCBpY29uLCBjb2xvcik7XG4gICAgICBhd2FpdCB0aGlzLnJlbmRlclNjcmlwdExpc3RzKCk7XG4gICAgICB0b2FzdHIuc3VjY2Vzcyhg5paH5Lu25aS5IFwiJHtuYW1lfVwiIOWIm+W7uuaIkOWKn2ApO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2cuZXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDliJvlu7rmlofku7blpLnlpLHotKU6JywgZXJyb3IpO1xuICAgICAgdG9hc3RyLmVycm9yKGDliJvlu7rmlofku7blpLnlpLHotKU6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpfWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDlpITnkIbmlofku7blpLnnvJbovpHkuovku7ZcbiAgICogQHBhcmFtIGZvbGRlcklkIOaWh+S7tuWkuUlEXG4gICAqIEBwYXJhbSBuZXdOYW1lIOaWsOWQjeensFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICogQHBhcmFtIG5ld0ljb24g5paw5Zu+5qCHXG4gICAqIEBwYXJhbSBuZXdDb2xvciDmlrDpopzoibJcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgaGFuZGxlRm9sZGVyRWRpdChcbiAgICBmb2xkZXJJZDogc3RyaW5nLFxuICAgIG5ld05hbWU6IHN0cmluZyxcbiAgICB0eXBlOiBTY3JpcHRUeXBlLFxuICAgIG5ld0ljb24/OiBzdHJpbmcsXG4gICAgbmV3Q29sb3I/OiBzdHJpbmcsXG4gICk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCB0aGlzLnNjcmlwdE1hbmFnZXIuZWRpdEZvbGRlcihmb2xkZXJJZCwgbmV3TmFtZSwgdHlwZSwgbmV3SWNvbiwgbmV3Q29sb3IpO1xuXG4gICAgICBpZiAobmV3TmFtZSkge1xuICAgICAgICAkKGAjJHtmb2xkZXJJZH0gLmZvbGRlci1uYW1lYCkudGV4dChuZXdOYW1lKTtcbiAgICAgIH1cblxuICAgICAgaWYgKG5ld0ljb24pIHtcbiAgICAgICAgJChgIyR7Zm9sZGVySWR9IC5mb2xkZXItaWNvbmApLnJlbW92ZUNsYXNzKCkuYWRkQ2xhc3MoYGZhICR7bmV3SWNvbn0gZm9sZGVyLWljb24gbWFyZ2luTGVmdDVgKTtcbiAgICAgIH1cblxuICAgICAgaWYgKG5ld0NvbG9yKSB7XG4gICAgICAgICQoYCMke2ZvbGRlcklkfSAuZm9sZGVyLWljb25gKS5jc3MoJ2NvbG9yJywgbmV3Q29sb3IpO1xuICAgICAgICAkKGAjJHtmb2xkZXJJZH0gLmZvbGRlci1oZWFkZXJgKS5jc3MoJ2JvcmRlci1sZWZ0LWNvbG9yJywgbmV3Q29sb3IpO1xuICAgICAgfVxuXG4gICAgICB0b2FzdHIuc3VjY2Vzcyhg5paH5Lu25aS55pu05paw5oiQ5YqfYCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZy5lcnJvcignW1NjcmlwdE1hbmFnZXJdIOabtOaWsOaWh+S7tuWkueWksei0pTonLCBlcnJvcik7XG4gICAgICB0b2FzdHIuZXJyb3IoYOabtOaWsOaWh+S7tuWkueWksei0pTogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcil9YCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWkhOeQhuaWh+S7tuWkueWIoOmZpOS6i+S7tlxuICAgKiBAcGFyYW0gZm9sZGVySWQg5paH5Lu25aS5SURcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqIEBwYXJhbSBza2lwVUlSZWZyZXNoIOaYr+WQpui3s+i/h1VJ5Yi35paw77yI55So5LqO5om56YeP5pON5L2c77yJXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGhhbmRsZUZvbGRlckRlbGV0ZShmb2xkZXJJZDogc3RyaW5nLCB0eXBlOiBTY3JpcHRUeXBlLCBza2lwVUlSZWZyZXNoOiBib29sZWFuID0gZmFsc2UpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgdGhpcy5zY3JpcHRNYW5hZ2VyLmRlbGV0ZUZvbGRlcihmb2xkZXJJZCwgdHlwZSk7XG4gICAgICBpZiAoIXNraXBVSVJlZnJlc2gpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5yZW5kZXJTY3JpcHRMaXN0cygpO1xuICAgICAgICB0b2FzdHIuc3VjY2Vzcygn5paH5Lu25aS55Yig6Zmk5oiQ5YqfJyk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZy5lcnJvcignW1NjcmlwdE1hbmFnZXJdIOWIoOmZpOaWh+S7tuWkueWksei0pTonLCBlcnJvcik7XG4gICAgICBpZiAoIXNraXBVSVJlZnJlc2gpIHtcbiAgICAgICAgdG9hc3RyLmVycm9yKGDliKDpmaTmlofku7blpLnlpLHotKU6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpfWApO1xuICAgICAgfVxuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWkhOeQhuaWh+S7tuWkueiEmuacrOaJuemHj+W8gOWFs1xuICAgKiBAcGFyYW0gZm9sZGVySWQg5paH5Lu25aS5SURcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqIEBwYXJhbSBlbmFibGUg5piv5ZCm5ZCv55SoXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGhhbmRsZUZvbGRlclNjcmlwdHNUb2dnbGUoZm9sZGVySWQ6IHN0cmluZywgdHlwZTogU2NyaXB0VHlwZSwgZW5hYmxlOiBib29sZWFuKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHRoaXMuc2NyaXB0TWFuYWdlci50b2dnbGVGb2xkZXJTY3JpcHRzKGZvbGRlcklkLCB0eXBlLCBlbmFibGUpO1xuICAgICAgdGhpcy51cGRhdGVGb2xkZXJBbmRTY3JpcHRzVUkoZm9sZGVySWQsIHR5cGUsIGVuYWJsZSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZy5lcnJvcignW1NjcmlwdE1hbmFnZXJdIOaJuemHj+WIh+aNouaWh+S7tuWkueiEmuacrOeKtuaAgeWksei0pTonLCBlcnJvcik7XG4gICAgICB0b2FzdHIuZXJyb3IoYOaJuemHj+WIh+aNouiEmuacrOeKtuaAgeWksei0pTogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICfmnKrnn6XplJnor68nfWApO1xuICAgIH1cbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/component/script_repository/ui_controller.ts\n\n}")},"./src/component/toastr.ts":
/*!*********************************!*\
  !*** ./src/component/toastr.ts ***!
  \*********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   initializeToastr: () => (/* binding */ initializeToastr)\n/* harmony export */ });\nfunction initializeToastr() {\n    globalThis.toastr = toastr;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3RvYXN0ci50cyIsIm1hcHBpbmdzIjoiOzs7O0FBSU8sU0FBUyxnQkFBZ0I7SUFDOUIsVUFBVSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7QUFDN0IsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9jb21wb25lbnQvdG9hc3RyLnRzPzg3YzYiXSwic291cmNlc0NvbnRlbnQiOlsiZGVjbGFyZSBuYW1lc3BhY2UgZ2xvYmFsVGhpcyB7XG4gIGxldCB0b2FzdHI6IHR5cGVvZiBpbXBvcnQoJ3RvYXN0cicpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaW5pdGlhbGl6ZVRvYXN0cigpIHtcbiAgZ2xvYmFsVGhpcy50b2FzdHIgPSB0b2FzdHI7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/component/toastr.ts\n\n}")},"./src/component/variable_manager/card.ts":
/*!************************************************!*\
  !*** ./src/component/variable_manager/card.ts ***!
  \************************************************/(module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VariableCardFactory: () => (/* binding */ VariableCardFactory)\n/* harmony export */ });\n/* harmony import */ var _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/variable_manager/util */ \"./src/component/variable_manager/util.ts\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var yaml__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! yaml */ \"yaml\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([yaml__WEBPACK_IMPORTED_MODULE_3__]);\nyaml__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n/* harmony import */ var yaml__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(yaml__WEBPACK_IMPORTED_MODULE_3__);\n\n\n\n\nclass VariableCardFactory {\n    defaultTypeDialogCallback;\n    /**\n     * 构造函数\n     * @param defaultTypeDialogCallback 默认的类型选择对话框回调函数\n     */\n    constructor(defaultTypeDialogCallback) {\n        this.defaultTypeDialogCallback = defaultTypeDialogCallback;\n        this.setupGlobalEventDelegation();\n    }\n    /**\n     * 设置全局事件委托\n     */\n    setupGlobalEventDelegation() {\n        $(document).on('click', '.variable-action-btn.object-save-btn', event => {\n            event.stopPropagation();\n            event.stopImmediatePropagation();\n            const $button = $(event.currentTarget);\n            const $nestedCard = $button.closest('.variable-card');\n            const $parentCard = this.findTopLevelCard($nestedCard);\n            if ($parentCard) {\n                this.saveNestedCardValue($parentCard);\n            }\n        });\n        $(document).on('click', '.variable-action-btn.object-delete-btn', event => {\n            event.stopPropagation();\n            event.stopImmediatePropagation();\n            const $button = $(event.currentTarget);\n            const $nestedCard = $button.closest('.variable-card');\n            const $parentCard = this.findTopLevelCard($nestedCard);\n            if ($parentCard) {\n                this.deleteNestedCardValue($parentCard, $nestedCard);\n            }\n        });\n        $(document).on('click', '.variable-action-btn.add-nested-key-btn', async (event) => {\n            event.stopPropagation();\n            event.stopImmediatePropagation();\n            const $button = $(event.currentTarget);\n            const $card = $button.closest('.variable-card');\n            const dialogCallback = this.defaultTypeDialogCallback;\n            if (dialogCallback) {\n                await dialogCallback((dataType) => {\n                    this.addObjectKey($card, dataType, this.defaultTypeDialogCallback);\n                });\n            }\n            else {\n                loglevel__WEBPACK_IMPORTED_MODULE_2___default().error('添加卡片出错');\n                toastr.error('添加卡片出错');\n            }\n        });\n        $(document).on('click', '.variable-action-btn.add-key-btn', async (event) => {\n            event.stopPropagation();\n            event.stopImmediatePropagation();\n            const $button = $(event.currentTarget);\n            const $card = $button.closest('.variable-card');\n            const dialogCallback = this.defaultTypeDialogCallback;\n            if (dialogCallback) {\n                await dialogCallback((dataType) => {\n                    this.addObjectKey($card, dataType, this.defaultTypeDialogCallback);\n                });\n            }\n            else {\n                loglevel__WEBPACK_IMPORTED_MODULE_2___default().error('未提供类型选择对话框回调函数');\n                toastr.error('未提供类型选择对话框回调函数');\n            }\n        });\n    }\n    /**\n     * 创建变量卡片\n     * @param variable 变量\n     * @param isNested 是否为嵌套卡片\n     * @param showTypeDialogCallback 显示类型选择对话框的回调函数（仅用于对象类型）\n     * @returns 变量卡片jQuery对象\n     */\n    createCard(variable, isNested, showTypeDialogCallback) {\n        let card;\n        const { name, value, dataType, id } = variable;\n        card = $(`\n      <div class=\"variable-card\" data-type=\"${dataType}\" data-variable-id=\"${id}\">\n        <div class=\"variable-card-header\">\n          <div class=\"variable-title-container\">\n            <i></i>\n            <input type=\"text\" class=\"variable-title\" value=\"${name}\" placeholder=\"变量名称\">\n          </div>\n          <div class=\"variable-actions\">\n            <div class=\"variable-action-btn save-btn\" title=\"保存\">\n              <i class=\"fa-regular fa-save\"></i>\n            </div>\n            <div class=\"variable-action-btn delete-btn\" title=\"删除\">\n              <i class=\"fa-regular fa-trash-can\"></i>\n            </div>\n          </div>\n        </div>\n        <div class=\"variable-card-content\">\n        </div>\n      </div>\n    `);\n        if (isNested) {\n            card.removeAttr('data-variable-id');\n            card\n                .find('.variable-action-btn.save-btn')\n                .removeClass('save-btn')\n                .addClass('object-save-btn')\n                .end()\n                .find('.variable-action-btn.delete-btn')\n                .removeClass('delete-btn')\n                .addClass('object-delete-btn');\n        }\n        switch (dataType) {\n            case 'array':\n                card\n                    .find('.variable-title-container i')\n                    .addClass('fa-solid fa-list')\n                    .end()\n                    .find('.variable-card-content')\n                    .append(`<div class=\"list-items-container\"></div><div class=\"add-list-item\"><i class=\"fa-solid fa-plus\"></i> 添加项目</div>`);\n                this.populateArrayItems(card, value);\n                {\n                    const listContainer = card.find('.list-items-container');\n                    listContainer.sortable({\n                        delay: (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_1__.getSortableDelay)(),\n                        handle: '.drag-handle',\n                    });\n                }\n                break;\n            case 'object':\n                card.find('.variable-title-container i').addClass('fa-regular fa-code');\n                this.setupObjectCard(card, variable, isNested, showTypeDialogCallback);\n                break;\n            case 'boolean':\n                card\n                    .find('.variable-title-container i')\n                    .addClass('fa-regular fa-toggle-on')\n                    .end()\n                    .find('.variable-card-content')\n                    .append(`\n              <div class=\"boolean-input-container\">\n                <div class=\"boolean-buttons-container\">\n                  <div class=\"boolean-btn ${value ? 'active' : ''}\" data-value=\"true\">True</div>\n                  <div class=\"boolean-btn ${!value ? 'active' : ''}\" data-value=\"false\">False</div>\n                </div>\n              </div>\n            `)\n                    .find('.boolean-btn')\n                    .on('click', function () {\n                    card.find('.boolean-btn').removeClass('active');\n                    $(this).addClass('active');\n                });\n                break;\n            case 'number':\n                card\n                    .find('.variable-title-container i')\n                    .addClass('fa-solid fa-hashtag')\n                    .end()\n                    .find('.variable-card-content')\n                    .append(`<input type=\"number\" class=\"number-input variable-content-input\" value=\"${value}\" step=\"any\">`);\n                break;\n            case 'string':\n                card\n                    .find('.variable-title-container i')\n                    .addClass('fa-solid fa-font')\n                    .end()\n                    .find('.variable-card-content')\n                    .append(`<textarea class=\"string-input variable-content-input\" placeholder=\"输入字符串值\">${value}</textarea>`);\n                break;\n        }\n        return card;\n    }\n    /**\n     * 从卡片获取变量信息\n     * @param card 变量卡片\n     * @returns 变量信息\n     */\n    getVariableFromCard(card) {\n        const id = card.attr('data-variable-id') || '';\n        const name = card.find('.variable-title').val();\n        const dataType = card.attr('data-type');\n        const value = this.extractValueFromCard(card, dataType);\n        return {\n            id,\n            name,\n            dataType,\n            value,\n        };\n    }\n    /**\n     * 从卡片提取值（统一处理所有类型的卡片值提取）\n     * @param card 卡片\n     * @param dataType 数据类型\n     * @returns 提取的值\n     */\n    extractValueFromCard(card, dataType) {\n        switch (dataType) {\n            case 'string':\n                return card.find('.string-input').val();\n            case 'number': {\n                const numberValue = card.find('.number-input').val();\n                return numberValue ? parseFloat(numberValue) : 0;\n            }\n            case 'boolean':\n                return card.find('.boolean-btn.active').attr('data-value') === 'true';\n            case 'array': {\n                const arrayItems = [];\n                card.find('.list-item').each((_, elem) => {\n                    const $listItem = $(elem);\n                    const itemValue = $listItem.find('.variable-content-input').val();\n                    try {\n                        arrayItems.push(yaml__WEBPACK_IMPORTED_MODULE_3___default().parse(itemValue));\n                    }\n                    catch {\n                        arrayItems.push(itemValue);\n                    }\n                });\n                return arrayItems;\n            }\n            case 'object': {\n                const viewMode = card.attr('data-view-mode') || 'card';\n                if (viewMode === 'card') {\n                    const extracted = this.extractObjectFromNestedCards(card);\n                    return extracted;\n                }\n                const yamlValue = card.find('.yaml-input').val();\n                if (yamlValue && yamlValue.trim()) {\n                    try {\n                        const parsed = yaml__WEBPACK_IMPORTED_MODULE_3___default().parse(yamlValue);\n                        return parsed;\n                    }\n                    catch (e) {\n                        loglevel__WEBPACK_IMPORTED_MODULE_2___default().error('YAML解析错误:', e);\n                        toastr.error('YAML解析错误');\n                        return {};\n                    }\n                }\n                else {\n                    const extracted = this.extractObjectFromNestedCards(card);\n                    return extracted;\n                }\n            }\n            default:\n                return card.find('.variable-content-input').val();\n        }\n    }\n    /**\n     * 从嵌套卡片提取对象值\n     * @param card 对象卡片\n     * @returns 提取的对象值\n     */\n    extractObjectFromNestedCards(card) {\n        const result = {};\n        let $container = card.find('> .variable-card-content > .object-card-view > .nested-cards-container');\n        if ($container.length === 0) {\n            $container = card.find('> .variable-card-content > .nested-object-container > .nested-cards-container');\n        }\n        if ($container.length === 0) {\n            $container = card.find('.nested-cards-container').first();\n        }\n        $container.children('.variable-card').each((_index, element) => {\n            const $nestedCard = $(element);\n            const key = $nestedCard.find('.variable-title').val();\n            const nestedDataType = $nestedCard.attr('data-type');\n            loglevel__WEBPACK_IMPORTED_MODULE_2___default().info('[VariableManager] 处理嵌套卡片:', {\n                index: _index,\n                key: key,\n                dataType: nestedDataType,\n                cardHtml: $nestedCard[0].outerHTML.substring(0, 200) + '...',\n            });\n            if (key) {\n                const nestedValue = this.extractValueFromCard($nestedCard, nestedDataType);\n                result[key] = nestedValue;\n            }\n            else {\n                loglevel__WEBPACK_IMPORTED_MODULE_2___default().warn('[VariableManager] 跳过空键的嵌套卡片:', _index);\n            }\n        });\n        loglevel__WEBPACK_IMPORTED_MODULE_2___default().info('[VariableManager] 最终提取结果:', result);\n        return result;\n    }\n    /**\n     * 渲染对象卡片的卡片视图\n     * @param card 对象卡片jQuery对象\n     * @param variable 对象变量\n     * @param showTypeDialogCallback 显示类型选择对话框的回调函数\n     */\n    renderObjectCardView(card, variable, showTypeDialogCallback) {\n        const $container = card.find('.nested-cards-container');\n        $container.empty();\n        if (!variable.value || typeof variable.value !== 'object') {\n            return;\n        }\n        Object.entries(variable.value).forEach(([key, propertyValue]) => {\n            const dataType = _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_0__.VariableManagerUtil.inferDataType(propertyValue);\n            const propertyVariable = {\n                name: key,\n                dataType: dataType,\n                value: propertyValue,\n                id: '',\n            };\n            const nestedCard = this.createCard(propertyVariable, true, showTypeDialogCallback);\n            $container.append(nestedCard);\n        });\n    }\n    /**\n     * 触发嵌套卡片保存事件\n     * @param parentCard 父级卡片\n     */\n    saveNestedCardValue(parentCard) {\n        this.syncCardViewToYamlInput(parentCard);\n        const topLevelCard = this.findTopLevelCard(parentCard);\n        if (topLevelCard) {\n            topLevelCard.trigger('nested-card:changed');\n        }\n    }\n    /**\n     * 找到顶级对象卡片\n     * @param card 当前卡片\n     * @returns 具有data-variable-id属性的卡片或null\n     */\n    findTopLevelCard(card) {\n        if (card.attr('data-variable-id')) {\n            return card;\n        }\n        const cardWithId = card.closest('[data-variable-id]');\n        return cardWithId.length > 0 ? cardWithId : null;\n    }\n    /**\n     * 删除嵌套卡片\n     * @param parentCard 父级卡片\n     * @param nestedCard 嵌套卡片\n     */\n    deleteNestedCardValue(parentCard, nestedCard) {\n        nestedCard.remove();\n        this.syncCardViewToYamlInput(parentCard);\n        const topLevelCard = this.findTopLevelCard(parentCard);\n        if (topLevelCard) {\n            topLevelCard.trigger('nested-card:changed');\n        }\n    }\n    /**\n     * 为对象卡片添加新的键值对（统一处理顶级和嵌套对象卡片）\n     * @param card 对象卡片（顶级或嵌套）\n     * @param dataType 新键值对的数据类型\n     * @param showTypeDialogCallback 显示类型选择对话框的回调函数\n     */\n    addObjectKey(card, newDataType, showTypeDialogCallback) {\n        const defaultValue = _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_0__.VariableManagerUtil.getDefaultValueForType(newDataType);\n        const existingKeys = new Set();\n        const $targetCard = card.closest('.variable-card');\n        $targetCard\n            .find('.nested-cards-container')\n            .first()\n            .children('.variable-card')\n            .each((_, element) => {\n            const key = $(element).find('.variable-title').val();\n            if (key) {\n                existingKeys.add(key);\n            }\n        });\n        const newKey = _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_0__.VariableManagerUtil.generateUniqueKey(existingKeys);\n        const newVariable = {\n            name: newKey,\n            dataType: newDataType,\n            value: defaultValue,\n            id: '',\n        };\n        const newNestedCard = this.createCard(newVariable, true, showTypeDialogCallback);\n        const $targetCardHeader = $targetCard.find('.variable-card-header').first();\n        const $targetCardContent = $targetCardHeader.siblings('.variable-card-content').first();\n        const $container = $targetCardContent.find('.nested-cards-container').first();\n        $container.prepend(newNestedCard);\n        newNestedCard.find('.variable-title').focus().select();\n        const topLevelCard = this.findTopLevelCard($targetCard);\n        if (topLevelCard && topLevelCard.is($targetCard)) {\n            this.syncCardViewToYamlInput($targetCard);\n        }\n    }\n    /**\n     * 设置对象卡片（统一处理嵌套和非嵌套对象卡片）\n     * @param card 对象卡片\n     * @param variable 变量对象\n     * @param isNested 是否为嵌套卡片\n     * @param showTypeDialogCallback 显示类型选择对话框的回调函数\n     */\n    setupObjectCard(card, variable, isNested, showTypeDialogCallback) {\n        if (isNested) {\n            card.find('.variable-card-content').append(`\n        <div class=\"nested-object-container\">\n          <div class=\"nested-cards-container\"></div>\n        </div>\n      `);\n            card.find('.variable-actions .object-save-btn').before(`\n        <div class=\"variable-action-btn add-nested-key-btn\" title=\"添加键值对\">\n          <i class=\"fa-regular fa-plus\"></i>\n        </div>\n      `);\n        }\n        else {\n            card.find('.variable-card-content').append(`\n        <textarea class=\"yaml-input variable-content-input\" placeholder=\"输入YAML对象\" style=\"display: none;\"></textarea>\n            <div class=\"object-card-view\">\n              <div class=\"nested-cards-container\"></div>\n            </div>\n      `);\n            card.find('.variable-actions .save-btn').before(`\n        <div class=\"variable-action-btn toggle-view-btn\" title=\"切换到YAML视图\">\n          <i class=\"fa-regular fa-list\"></i>\n        </div>\n        <div class=\"variable-action-btn add-key-btn\" title=\"添加键值对\">\n          <i class=\"fa-regular fa-plus\"></i>\n        </div>\n      `);\n            card.find('.variable-actions .delete-btn').after(`\n        <div class=\"variable-action-btn collapse-btn flex\" title=\"折叠\">\n          <i class=\"fa-solid fa-chevron-down\"></i>\n        </div>\n      `);\n            card.find('.variable-card-content').addClass('expanded');\n            card.find('.collapse-btn').addClass('expanded');\n            card.find('.collapse-btn').on('click', () => {\n                const $icon = card.find('.collapse-btn');\n                const $body = card.children('.variable-card-content');\n                $icon.toggleClass('expanded');\n                $body.toggleClass('expanded');\n            });\n            card.find('.yaml-input').val(yaml__WEBPACK_IMPORTED_MODULE_3___default().stringify(variable.value, null, 2)).end().attr('data-view-mode', 'card');\n            card.find('.yaml-input').on('blur change', () => {\n                const currentMode = card.attr('data-view-mode') || 'card';\n                if (currentMode === 'card') {\n                    this.syncYamlInputToCardView(card, showTypeDialogCallback);\n                }\n            });\n            card.find('.toggle-view-btn').on('click', () => {\n                const $card = card;\n                const currentMode = $card.attr('data-view-mode') || 'card';\n                const newMode = currentMode === 'yaml' ? 'card' : 'yaml';\n                $card.attr('data-view-mode', newMode);\n                if (newMode === 'yaml') {\n                    $card\n                        .find('.toggle-view-btn i')\n                        .removeClass('fa-list')\n                        .addClass('fa-eye')\n                        .end()\n                        .attr('title', '切换到卡片视图');\n                    $card.find('.variable-action-btn.add-key-btn').hide();\n                    $card.find('.yaml-input').show().end().find('.object-card-view').hide();\n                    this.syncCardViewToYamlInput($card);\n                }\n                else {\n                    $card\n                        .find('.toggle-view-btn i')\n                        .removeClass('fa-eye')\n                        .addClass('fa-list')\n                        .end()\n                        .attr('title', '切换到YAML视图');\n                    $card.find('.variable-action-btn.add-key-btn').show();\n                    $card.find('.yaml-input').hide().end().find('.object-card-view').show();\n                    this.syncYamlInputToCardView($card, showTypeDialogCallback);\n                }\n            });\n        }\n        try {\n            this.renderObjectCardView(card, variable, showTypeDialogCallback);\n        }\n        catch (e) {\n            loglevel__WEBPACK_IMPORTED_MODULE_2___default().error('渲染初始对象卡片视图错误:', e);\n            toastr.error('渲染对象卡片视图错误');\n        }\n    }\n    /**\n     * 同步卡片视图到YAML输入框\n     * @param card 对象卡片\n     */\n    syncCardViewToYamlInput(card) {\n        const objectValue = this.extractObjectFromNestedCards(card);\n        card.find('.yaml-input').val(yaml__WEBPACK_IMPORTED_MODULE_3___default().stringify(objectValue, null, 2));\n    }\n    /**\n     * 同步YAML输入框到卡片视图\n     * @param card 对象卡片\n     * @param showTypeDialogCallback 显示类型选择对话框的回调函数\n     */\n    syncYamlInputToCardView(card, showTypeDialogCallback) {\n        try {\n            const yamlValue = card.find('.yaml-input').val();\n            if (yamlValue && yamlValue.trim()) {\n                const objectValue = yaml__WEBPACK_IMPORTED_MODULE_3___default().parse(yamlValue);\n                const tempVariable = {\n                    id: card.attr('data-variable-id') || '',\n                    name: card.find('.variable-title').val(),\n                    dataType: 'object',\n                    value: objectValue,\n                };\n                this.renderObjectCardView(card, tempVariable, showTypeDialogCallback);\n            }\n        }\n        catch (parseError) {\n            loglevel__WEBPACK_IMPORTED_MODULE_2___default().error('YAML解析错误:', parseError);\n            toastr.error('YAML格式错误，无法同步到卡片视图');\n        }\n    }\n    /**\n     * 创建数组项（所有项都显示为字符串输入框）\n     * @param card 数组卡片\n     * @param items 数组项\n     */\n    populateArrayItems(card, items) {\n        if (!items || items.length === 0) {\n            return;\n        }\n        const listContainer = card.find('.list-items-container');\n        listContainer.empty();\n        items.forEach(item => {\n            const displayValue = typeof item === 'object' ? yaml__WEBPACK_IMPORTED_MODULE_3___default().stringify(item) : String(item);\n            const listItem = $(`\n        <div class=\"list-item\">\n          <span class=\"drag-handle\">☰</span>\n          <textarea class=\"variable-content-input\">${displayValue}</textarea>\n          <div class=\"list-item-delete\"><i class=\"fa-solid fa-times\"></i></div>\n        </div>\n      `);\n            listContainer.append(listItem);\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvY2FyZC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBQ3dFO0FBRVY7QUFFbkM7QUFDSDtBQUlqQixNQUFNLG1CQUFtQjtJQUN0Qix5QkFBeUIsQ0FBcUU7SUFFdEc7OztPQUdHO0lBQ0gsWUFBWSx5QkFBNkY7UUFDdkcsSUFBSSxDQUFDLHlCQUF5QixHQUFHLHlCQUF5QixDQUFDO1FBQzNELElBQUksQ0FBQywwQkFBMEIsRUFBRSxDQUFDO0lBQ3BDLENBQUM7SUFFRDs7T0FFRztJQUNLLDBCQUEwQjtRQUNoQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxzQ0FBc0MsRUFBRSxLQUFLLENBQUMsRUFBRTtZQUN0RSxLQUFLLENBQUMsZUFBZSxFQUFFLENBQUM7WUFDeEIsS0FBSyxDQUFDLHdCQUF3QixFQUFFLENBQUM7WUFFakMsTUFBTSxPQUFPLEdBQUcsQ0FBQyxDQUFDLEtBQUssQ0FBQyxhQUFhLENBQUMsQ0FBQztZQUN2QyxNQUFNLFdBQVcsR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDLGdCQUFnQixDQUFDLENBQUM7WUFFdEQsTUFBTSxXQUFXLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBRXZELElBQUksV0FBVyxFQUFFLENBQUM7Z0JBQ2hCLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUN4QyxDQUFDO1FBQ0gsQ0FBQyxDQUFDLENBQUM7UUFFSCxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSx3Q0FBd0MsRUFBRSxLQUFLLENBQUMsRUFBRTtZQUN4RSxLQUFLLENBQUMsZUFBZSxFQUFFLENBQUM7WUFDeEIsS0FBSyxDQUFDLHdCQUF3QixFQUFFLENBQUM7WUFFakMsTUFBTSxPQUFPLEdBQUcsQ0FBQyxDQUFDLEtBQUssQ0FBQyxhQUFhLENBQUMsQ0FBQztZQUN2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InNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9jb21wb25lbnQvdmFyaWFibGVfbWFuYWdlci9jYXJkLnRzPzI0NjkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVmFyaWFibGVEYXRhVHlwZSwgVmFyaWFibGVJdGVtIH0gZnJvbSAnQC9jb21wb25lbnQvdmFyaWFibGVfbWFuYWdlci90eXBlcyc7XG5pbXBvcnQgeyBWYXJpYWJsZU1hbmFnZXJVdGlsIH0gZnJvbSAnQC9jb21wb25lbnQvdmFyaWFibGVfbWFuYWdlci91dGlsJztcblxuaW1wb3J0IHsgZ2V0U29ydGFibGVEZWxheSB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3V0aWxzJztcblxuaW1wb3J0IGxvZyBmcm9tICdsb2dsZXZlbCc7XG5pbXBvcnQgWUFNTCBmcm9tICd5YW1sJztcblxuZGVjbGFyZSBjb25zdCB0b2FzdHI6IGFueTtcblxuZXhwb3J0IGNsYXNzIFZhcmlhYmxlQ2FyZEZhY3Rvcnkge1xuICBwcml2YXRlIGRlZmF1bHRUeXBlRGlhbG9nQ2FsbGJhY2s/OiAoY2FsbGJhY2s6IChkYXRhVHlwZTogVmFyaWFibGVEYXRhVHlwZSkgPT4gdm9pZCkgPT4gUHJvbWlzZTx2b2lkPjtcblxuICAvKipcbiAgICog5p6E6YCg5Ye95pWwXG4gICAqIEBwYXJhbSBkZWZhdWx0VHlwZURpYWxvZ0NhbGxiYWNrIOm7mOiupOeahOexu+Wei+mAieaLqeWvueivneahhuWbnuiwg+WHveaVsFxuICAgKi9cbiAgY29uc3RydWN0b3IoZGVmYXVsdFR5cGVEaWFsb2dDYWxsYmFjaz86IChjYWxsYmFjazogKGRhdGFUeXBlOiBWYXJpYWJsZURhdGFUeXBlKSA9PiB2b2lkKSA9PiBQcm9taXNlPHZvaWQ+KSB7XG4gICAgdGhpcy5kZWZhdWx0VHlwZURpYWxvZ0NhbGxiYWNrID0gZGVmYXVsdFR5cGVEaWFsb2dDYWxsYmFjaztcbiAgICB0aGlzLnNldHVwR2xvYmFsRXZlbnREZWxlZ2F0aW9uKCk7XG4gIH1cblxuICAvKipcbiAgICog6K6+572u5YWo5bGA5LqL5Lu25aeU5omYXG4gICAqL1xuICBwcml2YXRlIHNldHVwR2xvYmFsRXZlbnREZWxlZ2F0aW9uKCk6IHZvaWQge1xuICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcudmFyaWFibGUtYWN0aW9uLWJ0bi5vYmplY3Qtc2F2ZS1idG4nLCBldmVudCA9PiB7XG4gICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIGV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuXG4gICAgICBjb25zdCAkYnV0dG9uID0gJChldmVudC5jdXJyZW50VGFyZ2V0KTtcbiAgICAgIGNvbnN0ICRuZXN0ZWRDYXJkID0gJGJ1dHRvbi5jbG9zZXN0KCcudmFyaWFibGUtY2FyZCcpO1xuXG4gICAgICBjb25zdCAkcGFyZW50Q2FyZCA9IHRoaXMuZmluZFRvcExldmVsQ2FyZCgkbmVzdGVkQ2FyZCk7XG5cbiAgICAgIGlmICgkcGFyZW50Q2FyZCkge1xuICAgICAgICB0aGlzLnNhdmVOZXN0ZWRDYXJkVmFsdWUoJHBhcmVudENhcmQpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy52YXJpYWJsZS1hY3Rpb24tYnRuLm9iamVjdC1kZWxldGUtYnRuJywgZXZlbnQgPT4ge1xuICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcblxuICAgICAgY29uc3QgJGJ1dHRvbiA9ICQoZXZlbnQuY3VycmVudFRhcmdldCk7XG4gICAgICBjb25zdCAkbmVzdGVkQ2FyZCA9ICRidXR0b24uY2xvc2VzdCgnLnZhcmlhYmxlLWNhcmQnKTtcblxuICAgICAgY29uc3QgJHBhcmVudENhcmQgPSB0aGlzLmZpbmRUb3BMZXZlbENhcmQoJG5lc3RlZENhcmQpO1xuXG4gICAgICBpZiAoJHBhcmVudENhcmQpIHtcbiAgICAgICAgdGhpcy5kZWxldGVOZXN0ZWRDYXJkVmFsdWUoJHBhcmVudENhcmQsICRuZXN0ZWRDYXJkKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcudmFyaWFibGUtYWN0aW9uLWJ0bi5hZGQtbmVzdGVkLWtleS1idG4nLCBhc3luYyBldmVudCA9PiB7XG4gICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIGV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuXG4gICAgICBjb25zdCAkYnV0dG9uID0gJChldmVudC5jdXJyZW50VGFyZ2V0KTtcbiAgICAgIGNvbnN0ICRjYXJkID0gJGJ1dHRvbi5jbG9zZXN0KCcudmFyaWFibGUtY2FyZCcpO1xuXG4gICAgICBjb25zdCBkaWFsb2dDYWxsYmFjayA9IHRoaXMuZGVmYXVsdFR5cGVEaWFsb2dDYWxsYmFjaztcbiAgICAgIGlmIChkaWFsb2dDYWxsYmFjaykge1xuICAgICAgICBhd2FpdCBkaWFsb2dDYWxsYmFjaygoZGF0YVR5cGU6IFZhcmlhYmxlRGF0YVR5cGUpID0+IHtcbiAgICAgICAgICB0aGlzLmFkZE9iamVjdEtleSgkY2FyZCwgZGF0YVR5cGUsIHRoaXMuZGVmYXVsdFR5cGVEaWFsb2dDYWxsYmFjayk7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbG9nLmVycm9yKCfmt7vliqDljaHniYflh7rplJknKTtcbiAgICAgICAgdG9hc3RyLmVycm9yKCfmt7vliqDljaHniYflh7rplJknKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcudmFyaWFibGUtYWN0aW9uLWJ0bi5hZGQta2V5LWJ0bicsIGFzeW5jIGV2ZW50ID0+IHtcbiAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgZXZlbnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG5cbiAgICAgIGNvbnN0ICRidXR0b24gPSAkKGV2ZW50LmN1cnJlbnRUYXJnZXQpO1xuICAgICAgY29uc3QgJGNhcmQgPSAkYnV0dG9uLmNsb3Nlc3QoJy52YXJpYWJsZS1jYXJkJyk7XG5cbiAgICAgIGNvbnN0IGRpYWxvZ0NhbGxiYWNrID0gdGhpcy5kZWZhdWx0VHlwZURpYWxvZ0NhbGxiYWNrO1xuICAgICAgaWYgKGRpYWxvZ0NhbGxiYWNrKSB7XG4gICAgICAgIGF3YWl0IGRpYWxvZ0NhbGxiYWNrKChkYXRhVHlwZTogVmFyaWFibGVEYXRhVHlwZSkgPT4ge1xuICAgICAgICAgIHRoaXMuYWRkT2JqZWN0S2V5KCRjYXJkLCBkYXRhVHlwZSwgdGhpcy5kZWZhdWx0VHlwZURpYWxvZ0NhbGxiYWNrKTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBsb2cuZXJyb3IoJ+acquaPkOS+m+exu+Wei+mAieaLqeWvueivneahhuWbnuiwg+WHveaVsCcpO1xuICAgICAgICB0b2FzdHIuZXJyb3IoJ+acquaPkOS+m+exu+Wei+mAieaLqeWvueivneahhuWbnuiwg+WHveaVsCcpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOWIm+W7uuWPmOmHj+WNoeeJh1xuICAgKiBAcGFyYW0gdmFyaWFibGUg5Y+Y6YePXG4gICAqIEBwYXJhbSBpc05lc3RlZCDmmK/lkKbkuLrltYzlpZfljaHniYdcbiAgICogQHBhcmFtIHNob3dUeXBlRGlhbG9nQ2FsbGJhY2sg5pi+56S657G75Z6L6YCJ5oup5a+56K+d5qGG55qE5Zue6LCD5Ye95pWw77yI5LuF55So5LqO5a+56LGh57G75Z6L77yJXG4gICAqIEByZXR1cm5zIOWPmOmHj+WNoeeJh2pRdWVyeeWvueixoVxuICAgKi9cbiAgcHVibGljIGNyZWF0ZUNhcmQoXG4gICAgdmFyaWFibGU6IFZhcmlhYmxlSXRlbSxcbiAgICBpc05lc3RlZD86IGJvb2xlYW4sXG4gICAgc2hvd1R5cGVEaWFsb2dDYWxsYmFjaz86IChjYWxsYmFjazogKGRhdGFUeXBlOiBWYXJpYWJsZURhdGFUeXBlKSA9PiB2b2lkKSA9PiBQcm9taXNlPHZvaWQ+LFxuICApOiBKUXVlcnk8SFRNTEVsZW1lbnQ+IHtcbiAgICBsZXQgY2FyZDogSlF1ZXJ5PEhUTUxFbGVtZW50PjtcbiAgICBjb25zdCB7IG5hbWUsIHZhbHVlLCBkYXRhVHlwZSwgaWQgfSA9IHZhcmlhYmxlO1xuICAgIGNhcmQgPSAkKGBcbiAgICAgIDxkaXYgY2xhc3M9XCJ2YXJpYWJsZS1jYXJkXCIgZGF0YS10eXBlPVwiJHtkYXRhVHlwZX1cIiBkYXRhLXZhcmlhYmxlLWlkPVwiJHtpZH1cIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cInZhcmlhYmxlLWNhcmQtaGVhZGVyXCI+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cInZhcmlhYmxlLXRpdGxlLWNvbnRhaW5lclwiPlxuICAgICAgICAgICAgPGk+PC9pPlxuICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgY2xhc3M9XCJ2YXJpYWJsZS10aXRsZVwiIHZhbHVlPVwiJHtuYW1lfVwiIHBsYWNlaG9sZGVyPVwi5Y+Y6YeP5ZCN56ewXCI+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cInZhcmlhYmxlLWFjdGlvbnNcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ2YXJpYWJsZS1hY3Rpb24tYnRuIHNhdmUtYnRuXCIgdGl0bGU9XCLkv53lrZhcIj5cbiAgICAgICAgICAgICAgPGkgY2xhc3M9XCJmYS1yZWd1bGFyIGZhLXNhdmVcIj48L2k+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ2YXJpYWJsZS1hY3Rpb24tYnRuIGRlbGV0ZS1idG5cIiB0aXRsZT1cIuWIoOmZpFwiPlxuICAgICAgICAgICAgICA8aSBjbGFzcz1cImZhLXJlZ3VsYXIgZmEtdHJhc2gtY2FuXCI+PC9pPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzPVwidmFyaWFibGUtY2FyZC1jb250ZW50XCI+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgYCk7XG5cbiAgICBpZiAoaXNOZXN0ZWQpIHtcbiAgICAgIGNhcmQucmVtb3ZlQXR0cignZGF0YS12YXJpYWJsZS1pZCcpO1xuICAgICAgY2FyZFxuICAgICAgICAuZmluZCgnLnZhcmlhYmxlLWFjdGlvbi1idG4uc2F2ZS1idG4nKVxuICAgICAgICAucmVtb3ZlQ2xhc3MoJ3NhdmUtYnRuJylcbiAgICAgICAgLmFkZENsYXNzKCdvYmplY3Qtc2F2ZS1idG4nKVxuICAgICAgICAuZW5kKClcbiAgICAgICAgLmZpbmQoJy52YXJpYWJsZS1hY3Rpb24tYnRuLmRlbGV0ZS1idG4nKVxuICAgICAgICAucmVtb3ZlQ2xhc3MoJ2RlbGV0ZS1idG4nKVxuICAgICAgICAuYWRkQ2xhc3MoJ29iamVjdC1kZWxldGUtYnRuJyk7XG4gICAgfVxuXG4gICAgc3dpdGNoIChkYXRhVHlwZSkge1xuICAgICAgY2FzZSAnYXJyYXknOlxuICAgICAgICBjYXJkXG4gICAgICAgICAgLmZpbmQoJy52YXJpYWJsZS10aXRsZS1jb250YWluZXIgaScpXG4gICAgICAgICAgLmFkZENsYXNzKCdmYS1zb2xpZCBmYS1saXN0JylcbiAgICAgICAgICAuZW5kKClcbiAgICAgICAgICAuZmluZCgnLnZhcmlhYmxlLWNhcmQtY29udGVudCcpXG4gICAgICAgICAgLmFwcGVuZChcbiAgICAgICAgICAgIGA8ZGl2IGNsYXNzPVwibGlzdC1pdGVtcy1jb250YWluZXJcIj48L2Rpdj48ZGl2IGNsYXNzPVwiYWRkLWxpc3QtaXRlbVwiPjxpIGNsYXNzPVwiZmEtc29saWQgZmEtcGx1c1wiPjwvaT4g5re75Yqg6aG555uuPC9kaXY+YCxcbiAgICAgICAgICApO1xuXG4gICAgICAgIHRoaXMucG9wdWxhdGVBcnJheUl0ZW1zKGNhcmQsIHZhbHVlKTtcblxuICAgICAgICB7XG4gICAgICAgICAgY29uc3QgbGlzdENvbnRhaW5lciA9IGNhcmQuZmluZCgnLmxpc3QtaXRlbXMtY29udGFpbmVyJyk7XG4gICAgICAgICAgbGlzdENvbnRhaW5lci5zb3J0YWJsZSh7XG4gICAgICAgICAgICBkZWxheTogZ2V0U29ydGFibGVEZWxheSgpLFxuICAgICAgICAgICAgaGFuZGxlOiAnLmRyYWctaGFuZGxlJyxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ29iamVjdCc6XG4gICAgICAgIGNhcmQuZmluZCgnLnZhcmlhYmxlLXRpdGxlLWNvbnRhaW5lciBpJykuYWRkQ2xhc3MoJ2ZhLXJlZ3VsYXIgZmEtY29kZScpO1xuICAgICAgICB0aGlzLnNldHVwT2JqZWN0Q2FyZChjYXJkLCB2YXJpYWJsZSwgaXNOZXN0ZWQsIHNob3dUeXBlRGlhbG9nQ2FsbGJhY2spO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2Jvb2xlYW4nOlxuICAgICAgICBjYXJkXG4gICAgICAgICAgLmZpbmQoJy52YXJpYWJsZS10aXRsZS1jb250YWluZXIgaScpXG4gICAgICAgICAgLmFkZENsYXNzKCdmYS1yZWd1bGFyIGZhLXRvZ2dsZS1vbicpXG4gICAgICAgICAgLmVuZCgpXG4gICAgICAgICAgLmZpbmQoJy52YXJpYWJsZS1jYXJkLWNvbnRlbnQnKVxuICAgICAgICAgIC5hcHBlbmQoXG4gICAgICAgICAgICBgXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJib29sZWFuLWlucHV0LWNvbnRhaW5lclwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJib29sZWFuLWJ1dHRvbnMtY29udGFpbmVyXCI+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiYm9vbGVhbi1idG4gJHt2YWx1ZSA/ICdhY3RpdmUnIDogJyd9XCIgZGF0YS12YWx1ZT1cInRydWVcIj5UcnVlPC9kaXY+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiYm9vbGVhbi1idG4gJHshdmFsdWUgPyAnYWN0aXZlJyA6ICcnfVwiIGRhdGEtdmFsdWU9XCJmYWxzZVwiPkZhbHNlPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgYCxcbiAgICAgICAgICApXG4gICAgICAgICAgLmZpbmQoJy5ib29sZWFuLWJ0bicpXG4gICAgICAgICAgLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGNhcmQuZmluZCgnLmJvb2xlYW4tYnRuJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnbnVtYmVyJzpcbiAgICAgICAgY2FyZFxuICAgICAgICAgIC5maW5kKCcudmFyaWFibGUtdGl0bGUtY29udGFpbmVyIGknKVxuICAgICAgICAgIC5hZGRDbGFzcygnZmEtc29saWQgZmEtaGFzaHRhZycpXG4gICAgICAgICAgLmVuZCgpXG4gICAgICAgICAgLmZpbmQoJy52YXJpYWJsZS1jYXJkLWNvbnRlbnQnKVxuICAgICAgICAgIC5hcHBlbmQoYDxpbnB1dCB0eXBlPVwibnVtYmVyXCIgY2xhc3M9XCJudW1iZXItaW5wdXQgdmFyaWFibGUtY29udGVudC1pbnB1dFwiIHZhbHVlPVwiJHt2YWx1ZX1cIiBzdGVwPVwiYW55XCI+YCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnc3RyaW5nJzpcbiAgICAgICAgY2FyZFxuICAgICAgICAgIC5maW5kKCcudmFyaWFibGUtdGl0bGUtY29udGFpbmVyIGknKVxuICAgICAgICAgIC5hZGRDbGFzcygnZmEtc29saWQgZmEtZm9udCcpXG4gICAgICAgICAgLmVuZCgpXG4gICAgICAgICAgLmZpbmQoJy52YXJpYWJsZS1jYXJkLWNvbnRlbnQnKVxuICAgICAgICAgIC5hcHBlbmQoXG4gICAgICAgICAgICBgPHRleHRhcmVhIGNsYXNzPVwic3RyaW5nLWlucHV0IHZhcmlhYmxlLWNvbnRlbnQtaW5wdXRcIiBwbGFjZWhvbGRlcj1cIui+k+WFpeWtl+espuS4suWAvFwiPiR7dmFsdWV9PC90ZXh0YXJlYT5gLFxuICAgICAgICAgICk7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgICByZXR1cm4gY2FyZDtcbiAgfVxuXG4gIC8qKlxuICAgKiDku47ljaHniYfojrflj5blj5jph4/kv6Hmga9cbiAgICogQHBhcmFtIGNhcmQg5Y+Y6YeP5Y2h54mHXG4gICAqIEByZXR1cm5zIOWPmOmHj+S/oeaBr1xuICAgKi9cbiAgcHVibGljIGdldFZhcmlhYmxlRnJvbUNhcmQoY2FyZDogSlF1ZXJ5PEhUTUxFbGVtZW50Pik6IFZhcmlhYmxlSXRlbSB8IG51bGwge1xuICAgIGNvbnN0IGlkID0gY2FyZC5hdHRyKCdkYXRhLXZhcmlhYmxlLWlkJykgfHwgJyc7XG4gICAgY29uc3QgbmFtZSA9IGNhcmQuZmluZCgnLnZhcmlhYmxlLXRpdGxlJykudmFsKCkgYXMgc3RyaW5nO1xuICAgIGNvbnN0IGRhdGFUeXBlID0gY2FyZC5hdHRyKCdkYXRhLXR5cGUnKSBhcyBWYXJpYWJsZURhdGFUeXBlO1xuICAgIGNvbnN0IHZhbHVlID0gdGhpcy5leHRyYWN0VmFsdWVGcm9tQ2FyZChjYXJkLCBkYXRhVHlwZSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgaWQsXG4gICAgICBuYW1lLFxuICAgICAgZGF0YVR5cGUsXG4gICAgICB2YWx1ZSxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIOS7juWNoeeJh+aPkOWPluWAvO+8iOe7n+S4gOWkhOeQhuaJgOacieexu+Wei+eahOWNoeeJh+WAvOaPkOWPlu+8iVxuICAgKiBAcGFyYW0gY2FyZCDljaHniYdcbiAgICogQHBhcmFtIGRhdGFUeXBlIOaVsOaNruexu+Wei1xuICAgKiBAcmV0dXJucyDmj5Dlj5bnmoTlgLxcbiAgICovXG4gIHByaXZhdGUgZXh0cmFjdFZhbHVlRnJvbUNhcmQoY2FyZDogSlF1ZXJ5PEhUTUxFbGVtZW50PiwgZGF0YVR5cGU6IFZhcmlhYmxlRGF0YVR5cGUpOiBhbnkge1xuICAgIHN3aXRjaCAoZGF0YVR5cGUpIHtcbiAgICAgIGNhc2UgJ3N0cmluZyc6XG4gICAgICAgIHJldHVybiBjYXJkLmZpbmQoJy5zdHJpbmctaW5wdXQnKS52YWwoKSBhcyBzdHJpbmc7XG4gICAgICBjYXNlICdudW1iZXInOiB7XG4gICAgICAgIGNvbnN0IG51bWJlclZhbHVlID0gY2FyZC5maW5kKCcubnVtYmVyLWlucHV0JykudmFsKCkgYXMgc3RyaW5nO1xuICAgICAgICByZXR1cm4gbnVtYmVyVmFsdWUgPyBwYXJzZUZsb2F0KG51bWJlclZhbHVlKSA6IDA7XG4gICAgICB9XG4gICAgICBjYXNlICdib29sZWFuJzpcbiAgICAgICAgcmV0dXJuIGNhcmQuZmluZCgnLmJvb2xlYW4tYnRuLmFjdGl2ZScpLmF0dHIoJ2RhdGEtdmFsdWUnKSA9PT0gJ3RydWUnO1xuICAgICAgY2FzZSAnYXJyYXknOiB7XG4gICAgICAgIGNvbnN0IGFycmF5SXRlbXM6IGFueVtdID0gW107XG4gICAgICAgIGNhcmQuZmluZCgnLmxpc3QtaXRlbScpLmVhY2goKF8sIGVsZW0pID0+IHtcbiAgICAgICAgICBjb25zdCAkbGlzdEl0ZW0gPSAkKGVsZW0pO1xuXG4gICAgICAgICAgY29uc3QgaXRlbVZhbHVlID0gJGxpc3RJdGVtLmZpbmQoJy52YXJpYWJsZS1jb250ZW50LWlucHV0JykudmFsKCkgYXMgc3RyaW5nO1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhcnJheUl0ZW1zLnB1c2goWUFNTC5wYXJzZShpdGVtVmFsdWUpKTtcbiAgICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgIGFycmF5SXRlbXMucHVzaChpdGVtVmFsdWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBhcnJheUl0ZW1zO1xuICAgICAgfVxuICAgICAgY2FzZSAnb2JqZWN0Jzoge1xuICAgICAgICBjb25zdCB2aWV3TW9kZSA9IGNhcmQuYXR0cignZGF0YS12aWV3LW1vZGUnKSB8fCAnY2FyZCc7XG5cbiAgICAgICAgaWYgKHZpZXdNb2RlID09PSAnY2FyZCcpIHtcbiAgICAgICAgICBjb25zdCBleHRyYWN0ZWQgPSB0aGlzLmV4dHJhY3RPYmplY3RGcm9tTmVzdGVkQ2FyZHMoY2FyZCk7XG4gICAgICAgICAgcmV0dXJuIGV4dHJhY3RlZDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHlhbWxWYWx1ZSA9IGNhcmQuZmluZCgnLnlhbWwtaW5wdXQnKS52YWwoKSBhcyBzdHJpbmc7XG5cbiAgICAgICAgaWYgKHlhbWxWYWx1ZSAmJiB5YW1sVmFsdWUudHJpbSgpKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHBhcnNlZCA9IFlBTUwucGFyc2UoeWFtbFZhbHVlKTtcbiAgICAgICAgICAgIHJldHVybiBwYXJzZWQ7XG4gICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgbG9nLmVycm9yKCdZQU1M6Kej5p6Q6ZSZ6K+vOicsIGUpO1xuICAgICAgICAgICAgdG9hc3RyLmVycm9yKCdZQU1M6Kej5p6Q6ZSZ6K+vJyk7XG4gICAgICAgICAgICByZXR1cm4ge307XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnN0IGV4dHJhY3RlZCA9IHRoaXMuZXh0cmFjdE9iamVjdEZyb21OZXN0ZWRDYXJkcyhjYXJkKTtcbiAgICAgICAgICByZXR1cm4gZXh0cmFjdGVkO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gY2FyZC5maW5kKCcudmFyaWFibGUtY29udGVudC1pbnB1dCcpLnZhbCgpIGFzIHN0cmluZztcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5LuO5bWM5aWX5Y2h54mH5o+Q5Y+W5a+56LGh5YC8XG4gICAqIEBwYXJhbSBjYXJkIOWvueixoeWNoeeJh1xuICAgKiBAcmV0dXJucyDmj5Dlj5bnmoTlr7nosaHlgLxcbiAgICovXG4gIHByaXZhdGUgZXh0cmFjdE9iamVjdEZyb21OZXN0ZWRDYXJkcyhjYXJkOiBKUXVlcnk8SFRNTEVsZW1lbnQ+KTogUmVjb3JkPHN0cmluZywgYW55PiB7XG4gICAgY29uc3QgcmVzdWx0OiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0ge307XG5cbiAgICBsZXQgJGNvbnRhaW5lciA9IGNhcmQuZmluZCgnPiAudmFyaWFibGUtY2FyZC1jb250ZW50ID4gLm9iamVjdC1jYXJkLXZpZXcgPiAubmVzdGVkLWNhcmRzLWNvbnRhaW5lcicpO1xuXG4gICAgaWYgKCRjb250YWluZXIubGVuZ3RoID09PSAwKSB7XG4gICAgICAkY29udGFpbmVyID0gY2FyZC5maW5kKCc+IC52YXJpYWJsZS1jYXJkLWNvbnRlbnQgPiAubmVzdGVkLW9iamVjdC1jb250YWluZXIgPiAubmVzdGVkLWNhcmRzLWNvbnRhaW5lcicpO1xuICAgIH1cblxuICAgIGlmICgkY29udGFpbmVyLmxlbmd0aCA9PT0gMCkge1xuICAgICAgJGNvbnRhaW5lciA9IGNhcmQuZmluZCgnLm5lc3RlZC1jYXJkcy1jb250YWluZXInKS5maXJzdCgpO1xuICAgIH1cblxuICAgICRjb250YWluZXIuY2hpbGRyZW4oJy52YXJpYWJsZS1jYXJkJykuZWFjaCgoX2luZGV4LCBlbGVtZW50KSA9PiB7XG4gICAgICBjb25zdCAkbmVzdGVkQ2FyZCA9ICQoZWxlbWVudCk7XG4gICAgICBjb25zdCBrZXkgPSAkbmVzdGVkQ2FyZC5maW5kKCcudmFyaWFibGUtdGl0bGUnKS52YWwoKSBhcyBzdHJpbmc7XG4gICAgICBjb25zdCBuZXN0ZWREYXRhVHlwZSA9ICRuZXN0ZWRDYXJkLmF0dHIoJ2RhdGEtdHlwZScpIGFzIFZhcmlhYmxlRGF0YVR5cGU7XG5cbiAgICAgIGxvZy5pbmZvKCdbVmFyaWFibGVNYW5hZ2VyXSDlpITnkIbltYzlpZfljaHniYc6Jywge1xuICAgICAgICBpbmRleDogX2luZGV4LFxuICAgICAgICBrZXk6IGtleSxcbiAgICAgICAgZGF0YVR5cGU6IG5lc3RlZERhdGFUeXBlLFxuICAgICAgICBjYXJkSHRtbDogJG5lc3RlZENhcmRbMF0ub3V0ZXJIVE1MLnN1YnN0cmluZygwLCAyMDApICsgJy4uLicsXG4gICAgICB9KTtcblxuICAgICAgaWYgKGtleSkge1xuICAgICAgICBjb25zdCBuZXN0ZWRWYWx1ZSA9IHRoaXMuZXh0cmFjdFZhbHVlRnJvbUNhcmQoJG5lc3RlZENhcmQsIG5lc3RlZERhdGFUeXBlKTtcbiAgICAgICAgcmVzdWx0W2tleV0gPSBuZXN0ZWRWYWx1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxvZy53YXJuKCdbVmFyaWFibGVNYW5hZ2VyXSDot7Pov4fnqbrplK7nmoTltYzlpZfljaHniYc6JywgX2luZGV4KTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGxvZy5pbmZvKCdbVmFyaWFibGVNYW5hZ2VyXSDmnIDnu4jmj5Dlj5bnu5Pmnpw6JywgcmVzdWx0KTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLyoqXG4gICAqIOa4suafk+WvueixoeWNoeeJh+eahOWNoeeJh+inhuWbvlxuICAgKiBAcGFyYW0gY2FyZCDlr7nosaHljaHniYdqUXVlcnnlr7nosaFcbiAgICogQHBhcmFtIHZhcmlhYmxlIOWvueixoeWPmOmHj1xuICAgKiBAcGFyYW0gc2hvd1R5cGVEaWFsb2dDYWxsYmFjayDmmL7npLrnsbvlnovpgInmi6nlr7nor53moYbnmoTlm57osIPlh73mlbBcbiAgICovXG4gIHByaXZhdGUgcmVuZGVyT2JqZWN0Q2FyZFZpZXcoXG4gICAgY2FyZDogSlF1ZXJ5PEhUTUxFbGVtZW50PixcbiAgICB2YXJpYWJsZTogVmFyaWFibGVJdGVtLFxuICAgIHNob3dUeXBlRGlhbG9nQ2FsbGJhY2s/OiAoY2FsbGJhY2s6IChkYXRhVHlwZTogVmFyaWFibGVEYXRhVHlwZSkgPT4gdm9pZCkgPT4gUHJvbWlzZTx2b2lkPixcbiAgKTogdm9pZCB7XG4gICAgY29uc3QgJGNvbnRhaW5lciA9IGNhcmQuZmluZCgnLm5lc3RlZC1jYXJkcy1jb250YWluZXInKTtcbiAgICAkY29udGFpbmVyLmVtcHR5KCk7XG5cbiAgICBpZiAoIXZhcmlhYmxlLnZhbHVlIHx8IHR5cGVvZiB2YXJpYWJsZS52YWx1ZSAhPT0gJ29iamVjdCcpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBPYmplY3QuZW50cmllcyh2YXJpYWJsZS52YWx1ZSkuZm9yRWFjaCgoW2tleSwgcHJvcGVydHlWYWx1ZV0pID0+IHtcbiAgICAgIGNvbnN0IGRhdGFUeXBlOiBWYXJpYWJsZURhdGFUeXBlID0gVmFyaWFibGVNYW5hZ2VyVXRpbC5pbmZlckRhdGFUeXBlKHByb3BlcnR5VmFsdWUpO1xuXG4gICAgICBjb25zdCBwcm9wZXJ0eVZhcmlhYmxlOiBWYXJpYWJsZUl0ZW0gPSB7XG4gICAgICAgIG5hbWU6IGtleSxcbiAgICAgICAgZGF0YVR5cGU6IGRhdGFUeXBlLFxuICAgICAgICB2YWx1ZTogcHJvcGVydHlWYWx1ZSxcbiAgICAgICAgaWQ6ICcnLFxuICAgICAgfTtcblxuICAgICAgY29uc3QgbmVzdGVkQ2FyZCA9IHRoaXMuY3JlYXRlQ2FyZChwcm9wZXJ0eVZhcmlhYmxlLCB0cnVlLCBzaG93VHlwZURpYWxvZ0NhbGxiYWNrKTtcblxuICAgICAgJGNvbnRhaW5lci5hcHBlbmQobmVzdGVkQ2FyZCk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog6Kem5Y+R5bWM5aWX5Y2h54mH5L+d5a2Y5LqL5Lu2XG4gICAqIEBwYXJhbSBwYXJlbnRDYXJkIOeItue6p+WNoeeJh1xuICAgKi9cbiAgcHJpdmF0ZSBzYXZlTmVzdGVkQ2FyZFZhbHVlKHBhcmVudENhcmQ6IEpRdWVyeTxIVE1MRWxlbWVudD4pOiB2b2lkIHtcbiAgICB0aGlzLnN5bmNDYXJkVmlld1RvWWFtbElucHV0KHBhcmVudENhcmQpO1xuXG4gICAgY29uc3QgdG9wTGV2ZWxDYXJkID0gdGhpcy5maW5kVG9wTGV2ZWxDYXJkKHBhcmVudENhcmQpO1xuICAgIGlmICh0b3BMZXZlbENhcmQpIHtcbiAgICAgIHRvcExldmVsQ2FyZC50cmlnZ2VyKCduZXN0ZWQtY2FyZDpjaGFuZ2VkJyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOaJvuWIsOmhtue6p+WvueixoeWNoeeJh1xuICAgKiBAcGFyYW0gY2FyZCDlvZPliY3ljaHniYdcbiAgICogQHJldHVybnMg5YW35pyJZGF0YS12YXJpYWJsZS1pZOWxnuaAp+eahOWNoeeJh+aIlm51bGxcbiAgICovXG4gIHByaXZhdGUgZmluZFRvcExldmVsQ2FyZChjYXJkOiBKUXVlcnk8SFRNTEVsZW1lbnQ+KTogSlF1ZXJ5PEhUTUxFbGVtZW50PiB8IG51bGwge1xuICAgIGlmIChjYXJkLmF0dHIoJ2RhdGEtdmFyaWFibGUtaWQnKSkge1xuICAgICAgcmV0dXJuIGNhcmQ7XG4gICAgfVxuXG4gICAgY29uc3QgY2FyZFdpdGhJZCA9IGNhcmQuY2xvc2VzdCgnW2RhdGEtdmFyaWFibGUtaWRdJyk7XG4gICAgcmV0dXJuIGNhcmRXaXRoSWQubGVuZ3RoID4gMCA/IGNhcmRXaXRoSWQgOiBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIOWIoOmZpOW1jOWll+WNoeeJh1xuICAgKiBAcGFyYW0gcGFyZW50Q2FyZCDniLbnuqfljaHniYdcbiAgICogQHBhcmFtIG5lc3RlZENhcmQg5bWM5aWX5Y2h54mHXG4gICAqL1xuICBwcml2YXRlIGRlbGV0ZU5lc3RlZENhcmRWYWx1ZShwYXJlbnRDYXJkOiBKUXVlcnk8SFRNTEVsZW1lbnQ+LCBuZXN0ZWRDYXJkOiBKUXVlcnk8SFRNTEVsZW1lbnQ+KTogdm9pZCB7XG4gICAgbmVzdGVkQ2FyZC5yZW1vdmUoKTtcblxuICAgIHRoaXMuc3luY0NhcmRWaWV3VG9ZYW1sSW5wdXQocGFyZW50Q2FyZCk7XG5cbiAgICBjb25zdCB0b3BMZXZlbENhcmQgPSB0aGlzLmZpbmRUb3BMZXZlbENhcmQocGFyZW50Q2FyZCk7XG4gICAgaWYgKHRvcExldmVsQ2FyZCkge1xuICAgICAgdG9wTGV2ZWxDYXJkLnRyaWdnZXIoJ25lc3RlZC1jYXJkOmNoYW5nZWQnKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5Li65a+56LGh5Y2h54mH5re75Yqg5paw55qE6ZSu5YC85a+577yI57uf5LiA5aSE55CG6aG257qn5ZKM5bWM5aWX5a+56LGh5Y2h54mH77yJXG4gICAqIEBwYXJhbSBjYXJkIOWvueixoeWNoeeJh++8iOmhtue6p+aIluW1jOWll++8iVxuICAgKiBAcGFyYW0gZGF0YVR5cGUg5paw6ZSu5YC85a+555qE5pWw5o2u57G75Z6LXG4gICAqIEBwYXJhbSBzaG93VHlwZURpYWxvZ0NhbGxiYWNrIOaYvuekuuexu+Wei+mAieaLqeWvueivneahhueahOWbnuiwg+WHveaVsFxuICAgKi9cbiAgcHJpdmF0ZSBhZGRPYmplY3RLZXkoXG4gICAgY2FyZDogSlF1ZXJ5PEhUTUxFbGVtZW50PixcbiAgICBuZXdEYXRhVHlwZTogVmFyaWFibGVEYXRhVHlwZSxcbiAgICBzaG93VHlwZURpYWxvZ0NhbGxiYWNrPzogKGNhbGxiYWNrOiAoZGF0YVR5cGU6IFZhcmlhYmxlRGF0YVR5cGUpID0+IHZvaWQpID0+IFByb21pc2U8dm9pZD4sXG4gICk6IHZvaWQge1xuICAgIGNvbnN0IGRlZmF1bHRWYWx1ZSA9IFZhcmlhYmxlTWFuYWdlclV0aWwuZ2V0RGVmYXVsdFZhbHVlRm9yVHlwZShuZXdEYXRhVHlwZSk7XG4gICAgY29uc3QgZXhpc3RpbmdLZXlzID0gbmV3IFNldDxzdHJpbmc+KCk7XG5cbiAgICBjb25zdCAkdGFyZ2V0Q2FyZCA9IGNhcmQuY2xvc2VzdCgnLnZhcmlhYmxlLWNhcmQnKTtcbiAgICAkdGFyZ2V0Q2FyZFxuICAgICAgLmZpbmQoJy5uZXN0ZWQtY2FyZHMtY29udGFpbmVyJylcbiAgICAgIC5maXJzdCgpXG4gICAgICAuY2hpbGRyZW4oJy52YXJpYWJsZS1jYXJkJylcbiAgICAgIC5lYWNoKChfLCBlbGVtZW50KSA9PiB7XG4gICAgICAgIGNvbnN0IGtleSA9ICQoZWxlbWVudCkuZmluZCgnLnZhcmlhYmxlLXRpdGxlJykudmFsKCkgYXMgc3RyaW5nO1xuICAgICAgICBpZiAoa2V5KSB7XG4gICAgICAgICAgZXhpc3RpbmdLZXlzLmFkZChrZXkpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgIGNvbnN0IG5ld0tleSA9IFZhcmlhYmxlTWFuYWdlclV0aWwuZ2VuZXJhdGVVbmlxdWVLZXkoZXhpc3RpbmdLZXlzKTtcblxuICAgIGNvbnN0IG5ld1ZhcmlhYmxlOiBWYXJpYWJsZUl0ZW0gPSB7XG4gICAgICBuYW1lOiBuZXdLZXksXG4gICAgICBkYXRhVHlwZTogbmV3RGF0YVR5cGUsXG4gICAgICB2YWx1ZTogZGVmYXVsdFZhbHVlLFxuICAgICAgaWQ6ICcnLFxuICAgIH07XG5cbiAgICBjb25zdCBuZXdOZXN0ZWRDYXJkID0gdGhpcy5jcmVhdGVDYXJkKG5ld1ZhcmlhYmxlLCB0cnVlLCBzaG93VHlwZURpYWxvZ0NhbGxiYWNrKTtcblxuICAgIGNvbnN0ICR0YXJnZXRDYXJkSGVhZGVyID0gJHRhcmdldENhcmQuZmluZCgnLnZhcmlhYmxlLWNhcmQtaGVhZGVyJykuZmlyc3QoKTtcbiAgICBjb25zdCAkdGFyZ2V0Q2FyZENvbnRlbnQgPSAkdGFyZ2V0Q2FyZEhlYWRlci5zaWJsaW5ncygnLnZhcmlhYmxlLWNhcmQtY29udGVudCcpLmZpcnN0KCk7XG4gICAgY29uc3QgJGNvbnRhaW5lciA9ICR0YXJnZXRDYXJkQ29udGVudC5maW5kKCcubmVzdGVkLWNhcmRzLWNvbnRhaW5lcicpLmZpcnN0KCk7XG5cbiAgICAkY29udGFpbmVyLnByZXBlbmQobmV3TmVzdGVkQ2FyZCk7XG5cbiAgICBuZXdOZXN0ZWRDYXJkLmZpbmQoJy52YXJpYWJsZS10aXRsZScpLmZvY3VzKCkuc2VsZWN0KCk7XG5cbiAgICBjb25zdCB0b3BMZXZlbENhcmQgPSB0aGlzLmZpbmRUb3BMZXZlbENhcmQoJHRhcmdldENhcmQpO1xuICAgIGlmICh0b3BMZXZlbENhcmQgJiYgdG9wTGV2ZWxDYXJkLmlzKCR0YXJnZXRDYXJkKSkge1xuICAgICAgdGhpcy5zeW5jQ2FyZFZpZXdUb1lhbWxJbnB1dCgkdGFyZ2V0Q2FyZCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOiuvue9ruWvueixoeWNoeeJh++8iOe7n+S4gOWkhOeQhuW1jOWll+WSjOmdnuW1jOWll+WvueixoeWNoeeJh++8iVxuICAgKiBAcGFyYW0gY2FyZCDlr7nosaHljaHniYdcbiAgICogQHBhcmFtIHZhcmlhYmxlIOWPmOmHj+WvueixoVxuICAgKiBAcGFyYW0gaXNOZXN0ZWQg5piv5ZCm5Li65bWM5aWX5Y2h54mHXG4gICAqIEBwYXJhbSBzaG93VHlwZURpYWxvZ0NhbGxiYWNrIOaYvuekuuexu+Wei+mAieaLqeWvueivneahhueahOWbnuiwg+WHveaVsFxuICAgKi9cbiAgcHJpdmF0ZSBzZXR1cE9iamVjdENhcmQoXG4gICAgY2FyZDogSlF1ZXJ5PEhUTUxFbGVtZW50PixcbiAgICB2YXJpYWJsZTogVmFyaWFibGVJdGVtLFxuICAgIGlzTmVzdGVkPzogYm9vbGVhbixcbiAgICBzaG93VHlwZURpYWxvZ0NhbGxiYWNrPzogKGNhbGxiYWNrOiAoZGF0YVR5cGU6IFZhcmlhYmxlRGF0YVR5cGUpID0+IHZvaWQpID0+IFByb21pc2U8dm9pZD4sXG4gICk6IHZvaWQge1xuICAgIGlmIChpc05lc3RlZCkge1xuICAgICAgY2FyZC5maW5kKCcudmFyaWFibGUtY2FyZC1jb250ZW50JykuYXBwZW5kKGBcbiAgICAgICAgPGRpdiBjbGFzcz1cIm5lc3RlZC1vYmplY3QtY29udGFpbmVyXCI+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cIm5lc3RlZC1jYXJkcy1jb250YWluZXJcIj48L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICBgKTtcblxuICAgICAgY2FyZC5maW5kKCcudmFyaWFibGUtYWN0aW9ucyAub2JqZWN0LXNhdmUtYnRuJykuYmVmb3JlKGBcbiAgICAgICAgPGRpdiBjbGFzcz1cInZhcmlhYmxlLWFjdGlvbi1idG4gYWRkLW5lc3RlZC1rZXktYnRuXCIgdGl0bGU9XCLmt7vliqDplK7lgLzlr7lcIj5cbiAgICAgICAgICA8aSBjbGFzcz1cImZhLXJlZ3VsYXIgZmEtcGx1c1wiPjwvaT5cbiAgICAgICAgPC9kaXY+XG4gICAgICBgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY2FyZC5maW5kKCcudmFyaWFibGUtY2FyZC1jb250ZW50JykuYXBwZW5kKGBcbiAgICAgICAgPHRleHRhcmVhIGNsYXNzPVwieWFtbC1pbnB1dCB2YXJpYWJsZS1jb250ZW50LWlucHV0XCIgcGxhY2Vob2xkZXI9XCLovpPlhaVZQU1M5a+56LGhXCIgc3R5bGU9XCJkaXNwbGF5OiBub25lO1wiPjwvdGV4dGFyZWE+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwib2JqZWN0LWNhcmQtdmlld1wiPlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibmVzdGVkLWNhcmRzLWNvbnRhaW5lclwiPjwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICBgKTtcblxuICAgICAgY2FyZC5maW5kKCcudmFyaWFibGUtYWN0aW9ucyAuc2F2ZS1idG4nKS5iZWZvcmUoYFxuICAgICAgICA8ZGl2IGNsYXNzPVwidmFyaWFibGUtYWN0aW9uLWJ0biB0b2dnbGUtdmlldy1idG5cIiB0aXRsZT1cIuWIh+aNouWIsFlBTUzop4blm75cIj5cbiAgICAgICAgICA8aSBjbGFzcz1cImZhLXJlZ3VsYXIgZmEtbGlzdFwiPjwvaT5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJ2YXJpYWJsZS1hY3Rpb24tYnRuIGFkZC1rZXktYnRuXCIgdGl0bGU9XCLmt7vliqDplK7lgLzlr7lcIj5cbiAgICAgICAgICA8aSBjbGFzcz1cImZhLXJlZ3VsYXIgZmEtcGx1c1wiPjwvaT5cbiAgICAgICAgPC9kaXY+XG4gICAgICBgKTtcblxuICAgICAgY2FyZC5maW5kKCcudmFyaWFibGUtYWN0aW9ucyAuZGVsZXRlLWJ0bicpLmFmdGVyKGBcbiAgICAgICAgPGRpdiBjbGFzcz1cInZhcmlhYmxlLWFjdGlvbi1idG4gY29sbGFwc2UtYnRuIGZsZXhcIiB0aXRsZT1cIuaKmOWPoFwiPlxuICAgICAgICAgIDxpIGNsYXNzPVwiZmEtc29saWQgZmEtY2hldnJvbi1kb3duXCI+PC9pPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIGApO1xuXG4gICAgICBjYXJkLmZpbmQoJy52YXJpYWJsZS1jYXJkLWNvbnRlbnQnKS5hZGRDbGFzcygnZXhwYW5kZWQnKTtcbiAgICAgIGNhcmQuZmluZCgnLmNvbGxhcHNlLWJ0bicpLmFkZENsYXNzKCdleHBhbmRlZCcpO1xuXG4gICAgICBjYXJkLmZpbmQoJy5jb2xsYXBzZS1idG4nKS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0ICRpY29uID0gY2FyZC5maW5kKCcuY29sbGFwc2UtYnRuJyk7XG4gICAgICAgIGNvbnN0ICRib2R5ID0gY2FyZC5jaGlsZHJlbignLnZhcmlhYmxlLWNhcmQtY29udGVudCcpO1xuXG4gICAgICAgICRpY29uLnRvZ2dsZUNsYXNzKCdleHBhbmRlZCcpO1xuICAgICAgICAkYm9keS50b2dnbGVDbGFzcygnZXhwYW5kZWQnKTtcbiAgICAgIH0pO1xuXG4gICAgICBjYXJkLmZpbmQoJy55YW1sLWlucHV0JykudmFsKFlBTUwuc3RyaW5naWZ5KHZhcmlhYmxlLnZhbHVlLCBudWxsLCAyKSkuZW5kKCkuYXR0cignZGF0YS12aWV3LW1vZGUnLCAnY2FyZCcpO1xuXG4gICAgICBjYXJkLmZpbmQoJy55YW1sLWlucHV0Jykub24oJ2JsdXIgY2hhbmdlJywgKCkgPT4ge1xuICAgICAgICBjb25zdCBjdXJyZW50TW9kZSA9IGNhcmQuYXR0cignZGF0YS12aWV3LW1vZGUnKSB8fCAnY2FyZCc7XG5cbiAgICAgICAgaWYgKGN1cnJlbnRNb2RlID09PSAnY2FyZCcpIHtcbiAgICAgICAgICB0aGlzLnN5bmNZYW1sSW5wdXRUb0NhcmRWaWV3KGNhcmQsIHNob3dUeXBlRGlhbG9nQ2FsbGJhY2spO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgY2FyZC5maW5kKCcudG9nZ2xlLXZpZXctYnRuJykub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBjb25zdCAkY2FyZCA9IGNhcmQ7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRNb2RlID0gJGNhcmQuYXR0cignZGF0YS12aWV3LW1vZGUnKSB8fCAnY2FyZCc7XG5cbiAgICAgICAgY29uc3QgbmV3TW9kZSA9IGN1cnJlbnRNb2RlID09PSAneWFtbCcgPyAnY2FyZCcgOiAneWFtbCc7XG4gICAgICAgICRjYXJkLmF0dHIoJ2RhdGEtdmlldy1tb2RlJywgbmV3TW9kZSk7XG5cbiAgICAgICAgaWYgKG5ld01vZGUgPT09ICd5YW1sJykge1xuICAgICAgICAgICRjYXJkXG4gICAgICAgICAgICAuZmluZCgnLnRvZ2dsZS12aWV3LWJ0biBpJylcbiAgICAgICAgICAgIC5yZW1vdmVDbGFzcygnZmEtbGlzdCcpXG4gICAgICAgICAgICAuYWRkQ2xhc3MoJ2ZhLWV5ZScpXG4gICAgICAgICAgICAuZW5kKClcbiAgICAgICAgICAgIC5hdHRyKCd0aXRsZScsICfliIfmjaLliLDljaHniYfop4blm74nKTtcbiAgICAgICAgICAkY2FyZC5maW5kKCcudmFyaWFibGUtYWN0aW9uLWJ0bi5hZGQta2V5LWJ0bicpLmhpZGUoKTtcblxuICAgICAgICAgICRjYXJkLmZpbmQoJy55YW1sLWlucHV0Jykuc2hvdygpLmVuZCgpLmZpbmQoJy5vYmplY3QtY2FyZC12aWV3JykuaGlkZSgpO1xuXG4gICAgICAgICAgdGhpcy5zeW5jQ2FyZFZpZXdUb1lhbWxJbnB1dCgkY2FyZCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgJGNhcmRcbiAgICAgICAgICAgIC5maW5kKCcudG9nZ2xlLXZpZXctYnRuIGknKVxuICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCdmYS1leWUnKVxuICAgICAgICAgICAgLmFkZENsYXNzKCdmYS1saXN0JylcbiAgICAgICAgICAgIC5lbmQoKVxuICAgICAgICAgICAgLmF0dHIoJ3RpdGxlJywgJ+WIh+aNouWIsFlBTUzop4blm74nKTtcbiAgICAgICAgICAkY2FyZC5maW5kKCcudmFyaWFibGUtYWN0aW9uLWJ0bi5hZGQta2V5LWJ0bicpLnNob3coKTtcblxuICAgICAgICAgICRjYXJkLmZpbmQoJy55YW1sLWlucHV0JykuaGlkZSgpLmVuZCgpLmZpbmQoJy5vYmplY3QtY2FyZC12aWV3Jykuc2hvdygpO1xuXG4gICAgICAgICAgdGhpcy5zeW5jWWFtbElucHV0VG9DYXJkVmlldygkY2FyZCwgc2hvd1R5cGVEaWFsb2dDYWxsYmFjayk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICB0aGlzLnJlbmRlck9iamVjdENhcmRWaWV3KGNhcmQsIHZhcmlhYmxlLCBzaG93VHlwZURpYWxvZ0NhbGxiYWNrKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBsb2cuZXJyb3IoJ+a4suafk+WIneWni+WvueixoeWNoeeJh+inhuWbvumUmeivrzonLCBlKTtcbiAgICAgIHRvYXN0ci5lcnJvcign5riy5p+T5a+56LGh5Y2h54mH6KeG5Zu+6ZSZ6K+vJyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWQjOatpeWNoeeJh+inhuWbvuWIsFlBTUzovpPlhaXmoYZcbiAgICogQHBhcmFtIGNhcmQg5a+56LGh5Y2h54mHXG4gICAqL1xuICBwcml2YXRlIHN5bmNDYXJkVmlld1RvWWFtbElucHV0KGNhcmQ6IEpRdWVyeTxIVE1MRWxlbWVudD4pOiB2b2lkIHtcbiAgICBjb25zdCBvYmplY3RWYWx1ZSA9IHRoaXMuZXh0cmFjdE9iamVjdEZyb21OZXN0ZWRDYXJkcyhjYXJkKTtcbiAgICBjYXJkLmZpbmQoJy55YW1sLWlucHV0JykudmFsKFlBTUwuc3RyaW5naWZ5KG9iamVjdFZhbHVlLCBudWxsLCAyKSk7XG4gIH1cblxuICAvKipcbiAgICog5ZCM5q2lWUFNTOi+k+WFpeahhuWIsOWNoeeJh+inhuWbvlxuICAgKiBAcGFyYW0gY2FyZCDlr7nosaHljaHniYdcbiAgICogQHBhcmFtIHNob3dUeXBlRGlhbG9nQ2FsbGJhY2sg5pi+56S657G75Z6L6YCJ5oup5a+56K+d5qGG55qE5Zue6LCD5Ye95pWwXG4gICAqL1xuICBwcml2YXRlIHN5bmNZYW1sSW5wdXRUb0NhcmRWaWV3KFxuICAgIGNhcmQ6IEpRdWVyeTxIVE1MRWxlbWVudD4sXG4gICAgc2hvd1R5cGVEaWFsb2dDYWxsYmFjaz86IChjYWxsYmFjazogKGRhdGFUeXBlOiBWYXJpYWJsZURhdGFUeXBlKSA9PiB2b2lkKSA9PiBQcm9taXNlPHZvaWQ+LFxuICApOiB2b2lkIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeWFtbFZhbHVlID0gY2FyZC5maW5kKCcueWFtbC1pbnB1dCcpLnZhbCgpIGFzIHN0cmluZztcbiAgICAgIGlmICh5YW1sVmFsdWUgJiYgeWFtbFZhbHVlLnRyaW0oKSkge1xuICAgICAgICBjb25zdCBvYmplY3RWYWx1ZSA9IFlBTUwucGFyc2UoeWFtbFZhbHVlKTtcbiAgICAgICAgY29uc3QgdGVtcFZhcmlhYmxlOiBWYXJpYWJsZUl0ZW0gPSB7XG4gICAgICAgICAgaWQ6IGNhcmQuYXR0cignZGF0YS12YXJpYWJsZS1pZCcpIHx8ICcnLFxuICAgICAgICAgIG5hbWU6IGNhcmQuZmluZCgnLnZhcmlhYmxlLXRpdGxlJykudmFsKCkgYXMgc3RyaW5nLFxuICAgICAgICAgIGRhdGFUeXBlOiAnb2JqZWN0JyxcbiAgICAgICAgICB2YWx1ZTogb2JqZWN0VmFsdWUsXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMucmVuZGVyT2JqZWN0Q2FyZFZpZXcoY2FyZCwgdGVtcFZhcmlhYmxlLCBzaG93VHlwZURpYWxvZ0NhbGxiYWNrKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChwYXJzZUVycm9yKSB7XG4gICAgICBsb2cuZXJyb3IoJ1lBTUzop6PmnpDplJnor686JywgcGFyc2VFcnJvcik7XG4gICAgICB0b2FzdHIuZXJyb3IoJ1lBTUzmoLzlvI/plJnor6/vvIzml6Dms5XlkIzmraXliLDljaHniYfop4blm74nKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5Yib5bu65pWw57uE6aG577yI5omA5pyJ6aG56YO95pi+56S65Li65a2X56ym5Liy6L6T5YWl5qGG77yJXG4gICAqIEBwYXJhbSBjYXJkIOaVsOe7hOWNoeeJh1xuICAgKiBAcGFyYW0gaXRlbXMg5pWw57uE6aG5XG4gICAqL1xuICBwcml2YXRlIHBvcHVsYXRlQXJyYXlJdGVtcyhjYXJkOiBKUXVlcnk8SFRNTEVsZW1lbnQ+LCBpdGVtczogYW55W10pOiB2b2lkIHtcbiAgICBpZiAoIWl0ZW1zIHx8IGl0ZW1zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGxpc3RDb250YWluZXIgPSBjYXJkLmZpbmQoJy5saXN0LWl0ZW1zLWNvbnRhaW5lcicpO1xuICAgIGxpc3RDb250YWluZXIuZW1wdHkoKTtcblxuICAgIGl0ZW1zLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICBjb25zdCBkaXNwbGF5VmFsdWUgPSB0eXBlb2YgaXRlbSA9PT0gJ29iamVjdCcgPyBZQU1MLnN0cmluZ2lmeShpdGVtKSA6IFN0cmluZyhpdGVtKTtcbiAgICAgIGNvbnN0IGxpc3RJdGVtID0gJChgXG4gICAgICAgIDxkaXYgY2xhc3M9XCJsaXN0LWl0ZW1cIj5cbiAgICAgICAgICA8c3BhbiBjbGFzcz1cImRyYWctaGFuZGxlXCI+4piwPC9zcGFuPlxuICAgICAgICAgIDx0ZXh0YXJlYSBjbGFzcz1cInZhcmlhYmxlLWNvbnRlbnQtaW5wdXRcIj4ke2Rpc3BsYXlWYWx1ZX08L3RleHRhcmVhPlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJsaXN0LWl0ZW0tZGVsZXRlXCI+PGkgY2xhc3M9XCJmYS1zb2xpZCBmYS10aW1lc1wiPjwvaT48L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICBgKTtcbiAgICAgIGxpc3RDb250YWluZXIuYXBwZW5kKGxpc3RJdGVtKTtcbiAgICB9KTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/component/variable_manager/card.ts\n\n}")},"./src/component/variable_manager/controller.ts":
/*!******************************************************!*\
  !*** ./src/component/variable_manager/controller.ts ***!
  \******************************************************/(module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VariableController: () => (/* binding */ VariableController)\n/* harmony export */ });\n/* harmony import */ var _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/variable_manager/util */ \"./src/component/variable_manager/util.ts\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var yaml__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! yaml */ \"yaml\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([yaml__WEBPACK_IMPORTED_MODULE_2__]);\nyaml__WEBPACK_IMPORTED_MODULE_2__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n/* harmony import */ var yaml__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(yaml__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\nclass VariableController {\n    /**\n     * 变量数据模型\n     */\n    model;\n    /**\n     * 变量视图\n     */\n    view;\n    /**\n     * 变量同步服务\n     */\n    syncService;\n    /**\n     * 变量卡片工厂\n     */\n    cardFactory;\n    /**\n     * 构造函数\n     * @param model 数据模型\n     * @param view 视图\n     * @param syncService 同步服务\n     * @param cardFactory 卡片工厂\n     */\n    constructor(model, view, syncService, cardFactory) {\n        this.model = model;\n        this.view = view;\n        this.syncService = syncService;\n        this.cardFactory = cardFactory;\n    }\n    /**\n     * 初始化控制器\n     * @param container UI容器\n     */\n    async init(container) {\n        this.view.initUI();\n        this.bindEvents(container);\n        await this.syncService.initCurrentType();\n        await this.syncService.setCurrentType('global');\n        await this.loadVariables('global');\n    }\n    /**\n     * 绑定UI事件\n     * @param container UI容器\n     */\n    bindEvents(container) {\n        container.find('.tab-item').on('click', this.handleTabChange.bind(this));\n        container.on('click', '.add-list-item', this.handleAddListItem.bind(this));\n        container.on('click', '.list-item-delete', this.handleDeleteListItem.bind(this));\n        container.on('click', '.delete-btn', this.handleDeleteVariableCard.bind(this));\n        container.on('click', '.save-btn', this.handleSaveVariableCard.bind(this));\n        container.on('click', '#add-variable', this.handleAddVariable.bind(this));\n        container.on('click', '#clear-all', this.handleClearAll.bind(this));\n        container.on('click', '#filter-icon', this.handleFilterIconClick.bind(this));\n        container.on('change', '.filter-checkbox', this.handleFilterOptionChange.bind(this));\n        container.on('input', '#variable-search', this.handleVariableSearch.bind(this));\n        container.on('click', '#floor-filter-btn', this.handleFloorRangeFilter.bind(this));\n        container.on('nested-card:changed', '.variable-card', this.handleNestedCardChanged.bind(this));\n    }\n    /**\n     * 加载变量\n     * @param type 变量类型\n     */\n    async loadVariables(type) {\n        const variables = await this.model.loadFromTavern(type);\n        if (variables.length === 0) {\n            return;\n        }\n        if (type === 'message') {\n            this.view.container.find('#floor-filter-container').show();\n            const [minFloor, maxFloor] = this.model.getFloorRange();\n            this.view.updateFloorRangeInputs(minFloor, maxFloor);\n        }\n        else {\n            this.view.container.find('#floor-filter-container').hide();\n        }\n        this.view.refreshVariableCards(type, variables);\n        this.applyFilters();\n    }\n    /**\n     * 处理标签页切换\n     * @param event 点击事件\n     */\n    async handleTabChange(event) {\n        const target = $(event.currentTarget);\n        const tabId = target.attr('id');\n        if (!tabId)\n            return;\n        const type = tabId.replace('-tab', '');\n        const currentType = this.model.getActiveVariableType();\n        if (type === currentType)\n            return;\n        this.view.setActiveTab(type);\n        await this.syncService.setCurrentType(type);\n        await this.loadVariables(type);\n    }\n    /**\n     * 处理添加列表项\n     * @param event 点击事件\n     */\n    handleAddListItem(event) {\n        const button = $(event.currentTarget);\n        const listContainer = button.siblings('.list-items-container');\n        const newItem = $(`\n      <div class=\"list-item\">\n        <span class=\"drag-handle\">☰</span>\n        <textarea class=\"variable-content-input\" placeholder=\"输入变量内容\"></textarea>\n        <button class=\"list-item-delete\"><i class=\"fa-solid fa-times\"></i></button>\n      </div>\n    `);\n        listContainer.append(newItem);\n        newItem.find('textarea').focus();\n    }\n    /**\n     * 处理删除列表项\n     * @param event 点击事件\n     */\n    handleDeleteListItem(event) {\n        const button = $(event.currentTarget);\n        const listItem = button.closest('.list-item');\n        listItem.css({\n            'background-color': 'rgba(255, 0, 0, 0.2)',\n            transition: 'all 0.3s ease',\n        });\n        setTimeout(() => {\n            listItem.css({\n                transform: 'scale(0.9)',\n                opacity: '0.7',\n            });\n            setTimeout(() => {\n                listItem.remove();\n            }, 200);\n        }, 50);\n    }\n    /**\n     * 处理删除变量卡片\n     * @param event 点击事件\n     */\n    async handleDeleteVariableCard(event) {\n        const button = $(event.currentTarget);\n        const card = button.closest('.variable-card');\n        const variable_id = card.attr('data-variable-id') || '';\n        const type = this.model.getActiveVariableType();\n        if (button.hasClass('object-delete-btn')) {\n            return;\n        }\n        this.view.showConfirmDialog(`确定要删除变量吗？此操作无法撤销。`, async (confirmed) => {\n            if (confirmed) {\n                try {\n                    const isRemoved = this.model.removeFromMap(variable_id);\n                    if (isRemoved) {\n                        await this.model.saveAllVariables(type);\n                        this.view.removeVariableCard(variable_id);\n                    }\n                }\n                catch (error) {\n                    loglevel__WEBPACK_IMPORTED_MODULE_1___default().error(`[VariableManager] 删除变量失败:`, error);\n                }\n            }\n        });\n    }\n    /**\n     * 处理添加变量\n     */\n    async handleAddVariable() {\n        const type = this.model.getActiveVariableType();\n        this.view.showAddVariableDialog((dataType, floorId) => {\n            this.view.addNewVariableCard(type, dataType, floorId);\n            this.applyFilters();\n        });\n    }\n    /**\n     * 处理保存变量卡片\n     * @param event 点击事件\n     */\n    async handleSaveVariableCard(event) {\n        const button = $(event.currentTarget);\n        const card = button.closest('.variable-card');\n        const type = this.model.getActiveVariableType();\n        const dataType = _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_0__.VariableManagerUtil.inferDataType(this.cardFactory.getVariableFromCard(card));\n        if (dataType == 'object') {\n            this.syncObjectCardData(card);\n        }\n        let message_id = undefined;\n        if (type === 'message') {\n            const floorIdStr = card.attr('data-floor-id');\n            if (floorIdStr) {\n                message_id = parseInt(floorIdStr);\n            }\n        }\n        let newVariable = {\n            name: this.view.getVariableCardName(card),\n            value: this.cardFactory.getVariableFromCard(card)?.value,\n            dataType: dataType,\n            id: card.attr('data-variable-id') || '',\n            ...(message_id !== undefined && { message_id }),\n        };\n        if (newVariable.name == undefined || newVariable.name.trim() === '') {\n            toastr.error('变量名不能为空');\n            return;\n        }\n        let sameNameVariables;\n        if (type === 'message' && message_id !== undefined) {\n            sameNameVariables = this.model.getVariablesByMessageId(message_id).filter(v => v.name === newVariable.name);\n        }\n        else {\n            sameNameVariables = this.model.getVariablesByName(newVariable.name);\n        }\n        const otherSameNameVariables = sameNameVariables.filter(v => v.id !== newVariable.id);\n        if (otherSameNameVariables.length > 0) {\n            toastr.error('变量名重复');\n            return;\n        }\n        try {\n            if (newVariable.id && this.model.getVariableById(newVariable.id)) {\n                this.model.updateInMap(newVariable.id, newVariable.name, newVariable.value, message_id);\n            }\n            else {\n                const addedVariable = this.model.addToMap(newVariable.name, newVariable.value, message_id);\n                newVariable.id = addedVariable.id;\n                card.attr('data-variable-id', newVariable.id);\n            }\n            if (type === 'message' && message_id !== undefined) {\n                await this.model.saveAllVariables(type, message_id);\n            }\n            else {\n                await this.model.saveAllVariables(type);\n            }\n            this.view.addAnimation(card, 'variable-changed', () => { });\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_1___default().error(`[VariableManager] 保存变量失败:`, error);\n            toastr.error(`保存变量失败: ${error instanceof Error ? error.message : '未知错误'}`);\n        }\n    }\n    /**\n     * 处理清除所有变量\n     */\n    async handleClearAll() {\n        const type = this.model.getActiveVariableType();\n        this.view.showConfirmDialog(`确定要清除所有${this.getVariableTypeName(type)}变量吗？此操作不可撤销。`, async (confirmed) => {\n            if (confirmed) {\n                try {\n                    await this.model.clearAllVariables(type);\n                    const container = this.view.container.find(`#${type}-content .variable-list`);\n                    container.empty();\n                    if (type == 'message') {\n                        const floorContainer = this.view.container.find(`#${type}-content .floor-variables-container`);\n                        floorContainer.empty();\n                    }\n                    toastr.success(`已清除所有${this.getVariableTypeName(type)}变量`);\n                }\n                catch (error) {\n                    loglevel__WEBPACK_IMPORTED_MODULE_1___default().error(`[VariableManager] 清除${type}变量失败:`, error);\n                    toastr.error(`清除${this.getVariableTypeName(type)}变量时出错: ${error.message || '未知错误'}`);\n                }\n            }\n        });\n    }\n    /**\n     * 处理筛选图标点击\n     */\n    handleFilterIconClick() {\n        const $filterOptions = this.view.container.find('.filter-options');\n        $filterOptions.toggle();\n    }\n    /**\n     * 处理筛选选项变更\n     * @param event 变更事件\n     */\n    handleFilterOptionChange(event) {\n        const $checkbox = $(event.currentTarget);\n        const type = $checkbox.data('type');\n        const isChecked = $checkbox.is(':checked');\n        this.model.updateFilterState(type, isChecked);\n        this.applyFilters();\n    }\n    /**\n     * 处理变量搜索\n     * @param event 输入事件\n     */\n    handleVariableSearch(event) {\n        const keyword = $(event.currentTarget).val();\n        this.model.updateSearchKeyword(keyword);\n        this.applyFilters();\n    }\n    /**\n     * 应用筛选\n     */\n    applyFilters() {\n        const filterState = this.model.getFilterState();\n        const searchKeyword = this.model.getSearchKeyword();\n        this.view.applyClientSideFilters(filterState, searchKeyword);\n    }\n    /**\n     * 处理楼层范围筛选\n     */\n    handleFloorRangeFilter() {\n        const $minInput = this.view.container.find('#floor-min');\n        const $maxInput = this.view.container.find('#floor-max');\n        const minVal = $minInput.val();\n        const maxVal = $maxInput.val();\n        const min = minVal.trim() ? parseInt(minVal, 10) : null;\n        const max = maxVal.trim() ? parseInt(maxVal, 10) : null;\n        if ((minVal.trim() && isNaN(min)) || (maxVal.trim() && isNaN(max))) {\n            this.view.showFloorFilterError('请输入有效的数字');\n            return;\n        }\n        if (min !== null && min < 0) {\n            this.view.showFloorFilterError('最小楼层不能小于0');\n            return;\n        }\n        if (max !== null && max < 0) {\n            this.view.showFloorFilterError('最大楼层不能小于0');\n            return;\n        }\n        if (min !== null && max !== null && min > max) {\n            this.view.showFloorFilterError('最小值不能大于最大值');\n            return;\n        }\n        if (min === null && max === null) {\n            this.view.showFloorFilterError('请至少设置最小楼层或最大楼层');\n            return;\n        }\n        this.view.hideFloorFilterError();\n        const effectiveMin = min ?? 0;\n        const effectiveMax = max ?? 9999;\n        this.applyFloorRangeAndReload(effectiveMin, effectiveMax);\n    }\n    /**\n     * 应用楼层范围并重新加载变量\n     * @param min 最小楼层\n     * @param max 最大楼层\n     */\n    async applyFloorRangeAndReload(min, max) {\n        try {\n            this.model.updateFloorRange(min, max);\n            this.view.updateFloorRangeInputs(min, max);\n            await this.loadVariables('message');\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_1___default().error(`[VariableManager] 应用楼层范围并重新加载变量失败:`, error);\n        }\n    }\n    /**\n     * 清理资源\n     */\n    cleanup() {\n        try {\n            this.syncService.cleanup();\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_1___default().error(`[VariableManager] 清理资源失败:`, error);\n        }\n    }\n    /**\n     * 同步对象卡片的视图数据\n     * @param card 变量卡片\n     */\n    syncObjectCardData(card) {\n        const currentMode = card.attr('data-view-mode') || 'card';\n        if (currentMode === 'card') {\n            const objectValue = this.cardFactory.getVariableFromCard(card);\n            card.find('.yaml-input').val(yaml__WEBPACK_IMPORTED_MODULE_2___default().stringify(objectValue?.value, null, 2));\n        }\n    }\n    /**\n     * 处理嵌套卡片变更事件\n     * @param event 事件对象\n     */\n    async handleNestedCardChanged(event) {\n        const card = $(event.currentTarget);\n        const saveBtn = card.find('.variable-action-btn.save-btn');\n        if (saveBtn.length > 0) {\n            saveBtn.trigger('click');\n        }\n    }\n    /**\n     * 获取变量类型的中文名称\n     * @param type 变量类型\n     * @returns 中文名称\n     */\n    getVariableTypeName(type) {\n        switch (type) {\n            case 'global':\n                return '全局';\n            case 'character':\n                return '角色';\n            case 'chat':\n                return '聊天';\n            case 'message':\n                return '消息';\n            default:\n                return type;\n        }\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvY29udHJvbGxlci50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFJd0U7QUFHN0M7QUFDSDtBQUVqQixNQUFNLGtCQUFrQjtJQUM3Qjs7T0FFRztJQUNLLEtBQUssQ0FBZ0I7SUFFN0I7O09BRUc7SUFDSyxJQUFJLENBQWU7SUFFM0I7O09BRUc7SUFDSyxXQUFXLENBQXNCO0lBRXpDOztPQUVHO0lBQ0ssV0FBVyxDQUFzQjtJQUV6Qzs7Ozs7O09BTUc7SUFDSCxZQUNFLEtBQW9CLEVBQ3BCLElBQWtCLEVBQ2xCLFdBQWdDLEVBQ2hDLFdBQWdDO1FBRWhDLElBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO1FBQ25CLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO1FBQ2pCLElBQUksQ0FBQyxXQUFXLEdBQUcsV0FBVyxDQUFDO1FBQy9CLElBQUksQ0FBQyxXQUFXLEdBQUcsV0FBVyxDQUFDO0lBQ2pDLENBQUM7SUFFRDs7O09BR0c7SUFDSSxLQUFLLENBQUMsSUFBSSxDQUFDLFNBQThCO1FBQzlDLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7UUFDbkIsSUFBSSxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUMzQixNQUFNLElBQUksQ0FBQyxXQUFXLENBQUMsZUFBZSxFQUFFLENBQUM7UUFDekMsTUFBTSxJQUFJLENBQUMsV0FBVyxDQUFDLGNBQWMsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUNoRCxNQUFNLElBQUksQ0FBQyxhQUFhLENBQUMsUUFBUSxDQUFDLENBQUM7SUFDckMsQ0FBQztJQUVEOzs7T0FHRztJQUNLLFVBQVUsQ0FBQyxTQUE4QjtRQUMvQyxTQUFTLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztRQUN6RSxTQUFT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OztPQUdHO0lBQ0ssS0FBSyxDQUFDLHVCQUF1QixDQUFDLEtBQTRCO1FBQ2hFLE1BQU0sSUFBSSxHQUFHLENBQUMsQ0FBQyxLQUFLLENBQUMsYUFBYSxDQUFDLENBQUM7UUFFcEMsTUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQywrQkFBK0IsQ0FBQyxDQUFDO1FBQzNELElBQUksT0FBTyxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUUsQ0FBQztZQUN2QixPQUFPLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQzNCLENBQUM7SUFDSCxDQUFDO0lBRUQ7Ozs7T0FJRztJQUNLLG1CQUFtQixDQUFDLElBQWtCO1FBQzVDLFFBQVEsSUFBSSxFQUFFLENBQUM7WUFDYixLQUFLLFFBQVE7Z0JBQ1gsT0FBTyxJQUFJLENBQUM7WUFDZCxLQUFLLFdBQVc7Z0JBQ2QsT0FBTyxJQUFJLENBQUM7WUFDZCxLQUFLLE1BQU07Z0JBQ1QsT0FBTyxJQUFJLENBQUM7WUFDZCxLQUFLLFNBQVM7Z0JBQ1osT0FBTyxJQUFJLENBQUM7WUFDZDtnQkFDRSxPQUFPLElBQUksQ0FBQztRQUNoQixDQUFDO0lBQ0gsQ0FBQztDQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL2NvbnRyb2xsZXIudHM/ZmYxOCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBWYXJpYWJsZUNhcmRGYWN0b3J5IH0gZnJvbSAnQC9jb21wb25lbnQvdmFyaWFibGVfbWFuYWdlci9jYXJkJztcbmltcG9ydCB7IFZhcmlhYmxlTW9kZWwgfSBmcm9tICdAL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL21vZGVsJztcbmltcG9ydCB7IFZhcmlhYmxlU3luY1NlcnZpY2UgfSBmcm9tICdAL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL3N5bmMnO1xuaW1wb3J0IHsgVmFyaWFibGVEYXRhVHlwZSwgVmFyaWFibGVJdGVtLCBWYXJpYWJsZVR5cGUgfSBmcm9tICdAL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL3R5cGVzJztcbmltcG9ydCB7IFZhcmlhYmxlTWFuYWdlclV0aWwgfSBmcm9tICdAL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL3V0aWwnO1xuaW1wb3J0IHsgVmFyaWFibGVWaWV3IH0gZnJvbSAnQC9jb21wb25lbnQvdmFyaWFibGVfbWFuYWdlci92aWV3JztcblxuaW1wb3J0IGxvZyBmcm9tICdsb2dsZXZlbCc7XG5pbXBvcnQgWUFNTCBmcm9tICd5YW1sJztcblxuZXhwb3J0IGNsYXNzIFZhcmlhYmxlQ29udHJvbGxlciB7XG4gIC8qKlxuICAgKiDlj5jph4/mlbDmja7mqKHlnotcbiAgICovXG4gIHByaXZhdGUgbW9kZWw6IFZhcmlhYmxlTW9kZWw7XG5cbiAgLyoqXG4gICAqIOWPmOmHj+inhuWbvlxuICAgKi9cbiAgcHJpdmF0ZSB2aWV3OiBWYXJpYWJsZVZpZXc7XG5cbiAgLyoqXG4gICAqIOWPmOmHj+WQjOatpeacjeWKoVxuICAgKi9cbiAgcHJpdmF0ZSBzeW5jU2VydmljZTogVmFyaWFibGVTeW5jU2VydmljZTtcblxuICAvKipcbiAgICog5Y+Y6YeP5Y2h54mH5bel5Y6CXG4gICAqL1xuICBwcml2YXRlIGNhcmRGYWN0b3J5OiBWYXJpYWJsZUNhcmRGYWN0b3J5O1xuXG4gIC8qKlxuICAgKiDmnoTpgKDlh73mlbBcbiAgICogQHBhcmFtIG1vZGVsIOaVsOaNruaooeWei1xuICAgKiBAcGFyYW0gdmlldyDop4blm75cbiAgICogQHBhcmFtIHN5bmNTZXJ2aWNlIOWQjOatpeacjeWKoVxuICAgKiBAcGFyYW0gY2FyZEZhY3Rvcnkg5Y2h54mH5bel5Y6CXG4gICAqL1xuICBjb25zdHJ1Y3RvcihcbiAgICBtb2RlbDogVmFyaWFibGVNb2RlbCxcbiAgICB2aWV3OiBWYXJpYWJsZVZpZXcsXG4gICAgc3luY1NlcnZpY2U6IFZhcmlhYmxlU3luY1NlcnZpY2UsXG4gICAgY2FyZEZhY3Rvcnk6IFZhcmlhYmxlQ2FyZEZhY3RvcnksXG4gICkge1xuICAgIHRoaXMubW9kZWwgPSBtb2RlbDtcbiAgICB0aGlzLnZpZXcgPSB2aWV3O1xuICAgIHRoaXMuc3luY1NlcnZpY2UgPSBzeW5jU2VydmljZTtcbiAgICB0aGlzLmNhcmRGYWN0b3J5ID0gY2FyZEZhY3Rvcnk7XG4gIH1cblxuICAvKipcbiAgICog5Yid5aeL5YyW5o6n5Yi25ZmoXG4gICAqIEBwYXJhbSBjb250YWluZXIgVUnlrrnlmahcbiAgICovXG4gIHB1YmxpYyBhc3luYyBpbml0KGNvbnRhaW5lcjogSlF1ZXJ5PEhUTUxFbGVtZW50Pik6IFByb21pc2U8dm9pZD4ge1xuICAgIHRoaXMudmlldy5pbml0VUkoKTtcbiAgICB0aGlzLmJpbmRFdmVudHMoY29udGFpbmVyKTtcbiAgICBhd2FpdCB0aGlzLnN5bmNTZXJ2aWNlLmluaXRDdXJyZW50VHlwZSgpO1xuICAgIGF3YWl0IHRoaXMuc3luY1NlcnZpY2Uuc2V0Q3VycmVudFR5cGUoJ2dsb2JhbCcpO1xuICAgIGF3YWl0IHRoaXMubG9hZFZhcmlhYmxlcygnZ2xvYmFsJyk7XG4gIH1cblxuICAvKipcbiAgICog57uR5a6aVUnkuovku7ZcbiAgICogQHBhcmFtIGNvbnRhaW5lciBVSeWuueWZqFxuICAgKi9cbiAgcHJpdmF0ZSBiaW5kRXZlbnRzKGNvbnRhaW5lcjogSlF1ZXJ5PEhUTUxFbGVtZW50Pik6IHZvaWQge1xuICAgIGNvbnRhaW5lci5maW5kKCcudGFiLWl0ZW0nKS5vbignY2xpY2snLCB0aGlzLmhhbmRsZVRhYkNoYW5nZS5iaW5kKHRoaXMpKTtcbiAgICBjb250YWluZXIub24oJ2NsaWNrJywgJy5hZGQtbGlzdC1pdGVtJywgdGhpcy5oYW5kbGVBZGRMaXN0SXRlbS5iaW5kKHRoaXMpKTtcbiAgICBjb250YWluZXIub24oJ2NsaWNrJywgJy5saXN0LWl0ZW0tZGVsZXRlJywgdGhpcy5oYW5kbGVEZWxldGVMaXN0SXRlbS5iaW5kKHRoaXMpKTtcbiAgICBjb250YWluZXIub24oJ2NsaWNrJywgJy5kZWxldGUtYnRuJywgdGhpcy5oYW5kbGVEZWxldGVWYXJpYWJsZUNhcmQuYmluZCh0aGlzKSk7XG4gICAgY29udGFpbmVyLm9uKCdjbGljaycsICcuc2F2ZS1idG4nLCB0aGlzLmhhbmRsZVNhdmVWYXJpYWJsZUNhcmQuYmluZCh0aGlzKSk7XG4gICAgY29udGFpbmVyLm9uKCdjbGljaycsICcjYWRkLXZhcmlhYmxlJywgdGhpcy5oYW5kbGVBZGRWYXJpYWJsZS5iaW5kKHRoaXMpKTtcbiAgICBjb250YWluZXIub24oJ2NsaWNrJywgJyNjbGVhci1hbGwnLCB0aGlzLmhhbmRsZUNsZWFyQWxsLmJpbmQodGhpcykpO1xuICAgIGNvbnRhaW5lci5vbignY2xpY2snLCAnI2ZpbHRlci1pY29uJywgdGhpcy5oYW5kbGVGaWx0ZXJJY29uQ2xpY2suYmluZCh0aGlzKSk7XG4gICAgY29udGFpbmVyLm9uKCdjaGFuZ2UnLCAnLmZpbHRlci1jaGVja2JveCcsIHRoaXMuaGFuZGxlRmlsdGVyT3B0aW9uQ2hhbmdlLmJpbmQodGhpcykpO1xuICAgIGNvbnRhaW5lci5vbignaW5wdXQnLCAnI3ZhcmlhYmxlLXNlYXJjaCcsIHRoaXMuaGFuZGxlVmFyaWFibGVTZWFyY2guYmluZCh0aGlzKSk7XG4gICAgY29udGFpbmVyLm9uKCdjbGljaycsICcjZmxvb3ItZmlsdGVyLWJ0bicsIHRoaXMuaGFuZGxlRmxvb3JSYW5nZUZpbHRlci5iaW5kKHRoaXMpKTtcbiAgICBjb250YWluZXIub24oJ25lc3RlZC1jYXJkOmNoYW5nZWQnLCAnLnZhcmlhYmxlLWNhcmQnLCB0aGlzLmhhbmRsZU5lc3RlZENhcmRDaGFuZ2VkLmJpbmQodGhpcykpO1xuICB9XG5cbiAgLyoqXG4gICAqIOWKoOi9veWPmOmHj1xuICAgKiBAcGFyYW0gdHlwZSDlj5jph4/nsbvlnotcbiAgICovXG4gIHB1YmxpYyBhc3luYyBsb2FkVmFyaWFibGVzKHR5cGU6IFZhcmlhYmxlVHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHZhcmlhYmxlcyA9IGF3YWl0IHRoaXMubW9kZWwubG9hZEZyb21UYXZlcm4odHlwZSk7XG5cbiAgICBpZiAodmFyaWFibGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICh0eXBlID09PSAnbWVzc2FnZScpIHtcbiAgICAgIHRoaXMudmlldy5jb250YWluZXIuZmluZCgnI2Zsb29yLWZpbHRlci1jb250YWluZXInKS5zaG93KCk7XG4gICAgICBjb25zdCBbbWluRmxvb3IsIG1heEZsb29yXSA9IHRoaXMubW9kZWwuZ2V0Rmxvb3JSYW5nZSgpO1xuICAgICAgdGhpcy52aWV3LnVwZGF0ZUZsb29yUmFuZ2VJbnB1dHMobWluRmxvb3IsIG1heEZsb29yKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy52aWV3LmNvbnRhaW5lci5maW5kKCcjZmxvb3ItZmlsdGVyLWNvbnRhaW5lcicpLmhpZGUoKTtcbiAgICB9XG5cbiAgICB0aGlzLnZpZXcucmVmcmVzaFZhcmlhYmxlQ2FyZHModHlwZSwgdmFyaWFibGVzKTtcblxuICAgIHRoaXMuYXBwbHlGaWx0ZXJzKCk7XG4gIH1cblxuICAvKipcbiAgICog5aSE55CG5qCH562+6aG15YiH5o2iXG4gICAqIEBwYXJhbSBldmVudCDngrnlh7vkuovku7ZcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgaGFuZGxlVGFiQ2hhbmdlKGV2ZW50OiBKUXVlcnkuQ2xpY2tFdmVudCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHRhcmdldCA9ICQoZXZlbnQuY3VycmVudFRhcmdldCk7XG4gICAgY29uc3QgdGFiSWQgPSB0YXJnZXQuYXR0cignaWQnKTtcblxuICAgIGlmICghdGFiSWQpIHJldHVybjtcblxuICAgIGNvbnN0IHR5cGUgPSB0YWJJZC5yZXBsYWNlKCctdGFiJywgJycpIGFzIFZhcmlhYmxlVHlwZTtcbiAgICBjb25zdCBjdXJyZW50VHlwZSA9IHRoaXMubW9kZWwuZ2V0QWN0aXZlVmFyaWFibGVUeXBlKCk7XG5cbiAgICBpZiAodHlwZSA9PT0gY3VycmVudFR5cGUpIHJldHVybjtcblxuICAgIHRoaXMudmlldy5zZXRBY3RpdmVUYWIodHlwZSk7XG5cbiAgICBhd2FpdCB0aGlzLnN5bmNTZXJ2aWNlLnNldEN1cnJlbnRUeXBlKHR5cGUpO1xuICAgIGF3YWl0IHRoaXMubG9hZFZhcmlhYmxlcyh0eXBlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlpITnkIbmt7vliqDliJfooajpoblcbiAgICogQHBhcmFtIGV2ZW50IOeCueWHu+S6i+S7tlxuICAgKi9cbiAgcHJpdmF0ZSBoYW5kbGVBZGRMaXN0SXRlbShldmVudDogSlF1ZXJ5LkNsaWNrRXZlbnQpOiB2b2lkIHtcbiAgICBjb25zdCBidXR0b24gPSAkKGV2ZW50LmN1cnJlbnRUYXJnZXQpO1xuICAgIGNvbnN0IGxpc3RDb250YWluZXIgPSBidXR0b24uc2libGluZ3MoJy5saXN0LWl0ZW1zLWNvbnRhaW5lcicpO1xuXG4gICAgY29uc3QgbmV3SXRlbSA9ICQoYFxuICAgICAgPGRpdiBjbGFzcz1cImxpc3QtaXRlbVwiPlxuICAgICAgICA8c3BhbiBjbGFzcz1cImRyYWctaGFuZGxlXCI+4piwPC9zcGFuPlxuICAgICAgICA8dGV4dGFyZWEgY2xhc3M9XCJ2YXJpYWJsZS1jb250ZW50LWlucHV0XCIgcGxhY2Vob2xkZXI9XCLovpPlhaXlj5jph4/lhoXlrrlcIj48L3RleHRhcmVhPlxuICAgICAgICA8YnV0dG9uIGNsYXNzPVwibGlzdC1pdGVtLWRlbGV0ZVwiPjxpIGNsYXNzPVwiZmEtc29saWQgZmEtdGltZXNcIj48L2k+PC9idXR0b24+XG4gICAgICA8L2Rpdj5cbiAgICBgKTtcblxuICAgIGxpc3RDb250YWluZXIuYXBwZW5kKG5ld0l0ZW0pO1xuICAgIG5ld0l0ZW0uZmluZCgndGV4dGFyZWEnKS5mb2N1cygpO1xuICB9XG5cbiAgLyoqXG4gICAqIOWkhOeQhuWIoOmZpOWIl+ihqOmhuVxuICAgKiBAcGFyYW0gZXZlbnQg54K55Ye75LqL5Lu2XG4gICAqL1xuICBwcml2YXRlIGhhbmRsZURlbGV0ZUxpc3RJdGVtKGV2ZW50OiBKUXVlcnkuQ2xpY2tFdmVudCk6IHZvaWQge1xuICAgIGNvbnN0IGJ1dHRvbiA9ICQoZXZlbnQuY3VycmVudFRhcmdldCk7XG4gICAgY29uc3QgbGlzdEl0ZW0gPSBidXR0b24uY2xvc2VzdCgnLmxpc3QtaXRlbScpO1xuXG4gICAgbGlzdEl0ZW0uY3NzKHtcbiAgICAgICdiYWNrZ3JvdW5kLWNvbG9yJzogJ3JnYmEoMjU1LCAwLCAwLCAwLjIpJyxcbiAgICAgIHRyYW5zaXRpb246ICdhbGwgMC4zcyBlYXNlJyxcbiAgICB9KTtcblxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgbGlzdEl0ZW0uY3NzKHtcbiAgICAgICAgdHJhbnNmb3JtOiAnc2NhbGUoMC45KScsXG4gICAgICAgIG9wYWNpdHk6ICcwLjcnLFxuICAgICAgfSk7XG5cbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBsaXN0SXRlbS5yZW1vdmUoKTtcbiAgICAgIH0sIDIwMCk7XG4gICAgfSwgNTApO1xuICB9XG5cbiAgLyoqXG4gICAqIOWkhOeQhuWIoOmZpOWPmOmHj+WNoeeJh1xuICAgKiBAcGFyYW0gZXZlbnQg54K55Ye75LqL5Lu2XG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGhhbmRsZURlbGV0ZVZhcmlhYmxlQ2FyZChldmVudDogSlF1ZXJ5LkNsaWNrRXZlbnQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBidXR0b24gPSAkKGV2ZW50LmN1cnJlbnRUYXJnZXQpO1xuICAgIGNvbnN0IGNhcmQgPSBidXR0b24uY2xvc2VzdCgnLnZhcmlhYmxlLWNhcmQnKTtcbiAgICBjb25zdCB2YXJpYWJsZV9pZCA9IGNhcmQuYXR0cignZGF0YS12YXJpYWJsZS1pZCcpIHx8ICcnO1xuXG4gICAgY29uc3QgdHlwZSA9IHRoaXMubW9kZWwuZ2V0QWN0aXZlVmFyaWFibGVUeXBlKCk7XG5cbiAgICBpZiAoYnV0dG9uLmhhc0NsYXNzKCdvYmplY3QtZGVsZXRlLWJ0bicpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy52aWV3LnNob3dDb25maXJtRGlhbG9nKGDnoa7lrpropoHliKDpmaTlj5jph4/lkJfvvJ/mraTmk43kvZzml6Dms5XmkqTplIDjgIJgLCBhc3luYyBjb25maXJtZWQgPT4ge1xuICAgICAgaWYgKGNvbmZpcm1lZCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IGlzUmVtb3ZlZCA9IHRoaXMubW9kZWwucmVtb3ZlRnJvbU1hcCh2YXJpYWJsZV9pZCk7XG4gICAgICAgICAgaWYgKGlzUmVtb3ZlZCkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5tb2RlbC5zYXZlQWxsVmFyaWFibGVzKHR5cGUpO1xuICAgICAgICAgICAgdGhpcy52aWV3LnJlbW92ZVZhcmlhYmxlQ2FyZCh2YXJpYWJsZV9pZCk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGxvZy5lcnJvcihgW1ZhcmlhYmxlTWFuYWdlcl0g5Yig6Zmk5Y+Y6YeP5aSx6LSlOmAsIGVycm9yKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOWkhOeQhua3u+WKoOWPmOmHj1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBoYW5kbGVBZGRWYXJpYWJsZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCB0eXBlID0gdGhpcy5tb2RlbC5nZXRBY3RpdmVWYXJpYWJsZVR5cGUoKTtcbiAgICB0aGlzLnZpZXcuc2hvd0FkZFZhcmlhYmxlRGlhbG9nKChkYXRhVHlwZSwgZmxvb3JJZCkgPT4ge1xuICAgICAgdGhpcy52aWV3LmFkZE5ld1ZhcmlhYmxlQ2FyZCh0eXBlLCBkYXRhVHlwZSwgZmxvb3JJZCk7XG4gICAgICB0aGlzLmFwcGx5RmlsdGVycygpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOWkhOeQhuS/neWtmOWPmOmHj+WNoeeJh1xuICAgKiBAcGFyYW0gZXZlbnQg54K55Ye75LqL5Lu2XG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGhhbmRsZVNhdmVWYXJpYWJsZUNhcmQoZXZlbnQ6IEpRdWVyeS5DbGlja0V2ZW50KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgYnV0dG9uID0gJChldmVudC5jdXJyZW50VGFyZ2V0KTtcbiAgICBjb25zdCBjYXJkID0gYnV0dG9uLmNsb3Nlc3QoJy52YXJpYWJsZS1jYXJkJyk7XG4gICAgY29uc3QgdHlwZSA9IHRoaXMubW9kZWwuZ2V0QWN0aXZlVmFyaWFibGVUeXBlKCk7XG4gICAgY29uc3QgZGF0YVR5cGUgPSBWYXJpYWJsZU1hbmFnZXJVdGlsLmluZmVyRGF0YVR5cGUodGhpcy5jYXJkRmFjdG9yeS5nZXRWYXJpYWJsZUZyb21DYXJkKGNhcmQpKTtcblxuICAgIGlmIChkYXRhVHlwZSA9PSAnb2JqZWN0Jykge1xuICAgICAgdGhpcy5zeW5jT2JqZWN0Q2FyZERhdGEoY2FyZCk7XG4gICAgfVxuXG4gICAgbGV0IG1lc3NhZ2VfaWQ6IG51bWJlciB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcbiAgICBpZiAodHlwZSA9PT0gJ21lc3NhZ2UnKSB7XG4gICAgICBjb25zdCBmbG9vcklkU3RyID0gY2FyZC5hdHRyKCdkYXRhLWZsb29yLWlkJyk7XG4gICAgICBpZiAoZmxvb3JJZFN0cikge1xuICAgICAgICBtZXNzYWdlX2lkID0gcGFyc2VJbnQoZmxvb3JJZFN0cik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgbGV0IG5ld1ZhcmlhYmxlOiBWYXJpYWJsZUl0ZW0gPSB7XG4gICAgICBuYW1lOiB0aGlzLnZpZXcuZ2V0VmFyaWFibGVDYXJkTmFtZShjYXJkKSxcbiAgICAgIHZhbHVlOiB0aGlzLmNhcmRGYWN0b3J5LmdldFZhcmlhYmxlRnJvbUNhcmQoY2FyZCk/LnZhbHVlLFxuICAgICAgZGF0YVR5cGU6IGRhdGFUeXBlLFxuICAgICAgaWQ6IGNhcmQuYXR0cignZGF0YS12YXJpYWJsZS1pZCcpIHx8ICcnLFxuICAgICAgLi4uKG1lc3NhZ2VfaWQgIT09IHVuZGVmaW5lZCAmJiB7IG1lc3NhZ2VfaWQgfSksXG4gICAgfTtcblxuICAgIGlmIChuZXdWYXJpYWJsZS5uYW1lID09IHVuZGVmaW5lZCB8fCBuZXdWYXJpYWJsZS5uYW1lLnRyaW0oKSA9PT0gJycpIHtcbiAgICAgIHRvYXN0ci5lcnJvcign5Y+Y6YeP5ZCN5LiN6IO95Li656m6Jyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgbGV0IHNhbWVOYW1lVmFyaWFibGVzOiBWYXJpYWJsZUl0ZW1bXTtcbiAgICBpZiAodHlwZSA9PT0gJ21lc3NhZ2UnICYmIG1lc3NhZ2VfaWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgc2FtZU5hbWVWYXJpYWJsZXMgPSB0aGlzLm1vZGVsLmdldFZhcmlhYmxlc0J5TWVzc2FnZUlkKG1lc3NhZ2VfaWQpLmZpbHRlcih2ID0+IHYubmFtZSA9PT0gbmV3VmFyaWFibGUubmFtZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNhbWVOYW1lVmFyaWFibGVzID0gdGhpcy5tb2RlbC5nZXRWYXJpYWJsZXNCeU5hbWUobmV3VmFyaWFibGUubmFtZSk7XG4gICAgfVxuXG4gICAgY29uc3Qgb3RoZXJTYW1lTmFtZVZhcmlhYmxlcyA9IHNhbWVOYW1lVmFyaWFibGVzLmZpbHRlcih2ID0+IHYuaWQgIT09IG5ld1ZhcmlhYmxlLmlkKTtcbiAgICBpZiAob3RoZXJTYW1lTmFtZVZhcmlhYmxlcy5sZW5ndGggPiAwKSB7XG4gICAgICB0b2FzdHIuZXJyb3IoJ+WPmOmHj+WQjemHjeWkjScpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBpZiAobmV3VmFyaWFibGUuaWQgJiYgdGhpcy5tb2RlbC5nZXRWYXJpYWJsZUJ5SWQobmV3VmFyaWFibGUuaWQpKSB7XG4gICAgICAgIHRoaXMubW9kZWwudXBkYXRlSW5NYXAobmV3VmFyaWFibGUuaWQsIG5ld1ZhcmlhYmxlLm5hbWUsIG5ld1ZhcmlhYmxlLnZhbHVlLCBtZXNzYWdlX2lkKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IGFkZGVkVmFyaWFibGUgPSB0aGlzLm1vZGVsLmFkZFRvTWFwKG5ld1ZhcmlhYmxlLm5hbWUsIG5ld1ZhcmlhYmxlLnZhbHVlLCBtZXNzYWdlX2lkKTtcbiAgICAgICAgbmV3VmFyaWFibGUuaWQgPSBhZGRlZFZhcmlhYmxlLmlkO1xuICAgICAgICBjYXJkLmF0dHIoJ2RhdGEtdmFyaWFibGUtaWQnLCBuZXdWYXJpYWJsZS5pZCk7XG4gICAgICB9XG5cbiAgICAgIGlmICh0eXBlID09PSAnbWVzc2FnZScgJiYgbWVzc2FnZV9pZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGF3YWl0IHRoaXMubW9kZWwuc2F2ZUFsbFZhcmlhYmxlcyh0eXBlLCBtZXNzYWdlX2lkKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGF3YWl0IHRoaXMubW9kZWwuc2F2ZUFsbFZhcmlhYmxlcyh0eXBlKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy52aWV3LmFkZEFuaW1hdGlvbihjYXJkLCAndmFyaWFibGUtY2hhbmdlZCcsICgpID0+IHt9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nLmVycm9yKGBbVmFyaWFibGVNYW5hZ2VyXSDkv53lrZjlj5jph4/lpLHotKU6YCwgZXJyb3IpO1xuICAgICAgdG9hc3RyLmVycm9yKGDkv53lrZjlj5jph4/lpLHotKU6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAn5pyq55+l6ZSZ6K+vJ31gKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5aSE55CG5riF6Zmk5omA5pyJ5Y+Y6YePXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGhhbmRsZUNsZWFyQWxsKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHR5cGUgPSB0aGlzLm1vZGVsLmdldEFjdGl2ZVZhcmlhYmxlVHlwZSgpO1xuXG4gICAgdGhpcy52aWV3LnNob3dDb25maXJtRGlhbG9nKFxuICAgICAgYOehruWumuimgea4hemZpOaJgOaciSR7dGhpcy5nZXRWYXJpYWJsZVR5cGVOYW1lKHR5cGUpfeWPmOmHj+WQl++8n+atpOaTjeS9nOS4jeWPr+aSpOmUgOOAgmAsXG4gICAgICBhc3luYyBjb25maXJtZWQgPT4ge1xuICAgICAgICBpZiAoY29uZmlybWVkKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMubW9kZWwuY2xlYXJBbGxWYXJpYWJsZXModHlwZSk7XG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSB0aGlzLnZpZXcuY29udGFpbmVyLmZpbmQoYCMke3R5cGV9LWNvbnRlbnQgLnZhcmlhYmxlLWxpc3RgKTtcbiAgICAgICAgICAgIGNvbnRhaW5lci5lbXB0eSgpO1xuICAgICAgICAgICAgaWYgKHR5cGUgPT0gJ21lc3NhZ2UnKSB7XG4gICAgICAgICAgICAgIGNvbnN0IGZsb29yQ29udGFpbmVyID0gdGhpcy52aWV3LmNvbnRhaW5lci5maW5kKGAjJHt0eXBlfS1jb250ZW50IC5mbG9vci12YXJpYWJsZXMtY29udGFpbmVyYCk7XG4gICAgICAgICAgICAgIGZsb29yQ29udGFpbmVyLmVtcHR5KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0b2FzdHIuc3VjY2Vzcyhg5bey5riF6Zmk5omA5pyJJHt0aGlzLmdldFZhcmlhYmxlVHlwZU5hbWUodHlwZSl95Y+Y6YePYCk7XG4gICAgICAgICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgICAgICAgbG9nLmVycm9yKGBbVmFyaWFibGVNYW5hZ2VyXSDmuIXpmaQke3R5cGV95Y+Y6YeP5aSx6LSlOmAsIGVycm9yKTtcbiAgICAgICAgICAgIHRvYXN0ci5lcnJvcihg5riF6ZmkJHt0aGlzLmdldFZhcmlhYmxlVHlwZU5hbWUodHlwZSl95Y+Y6YeP5pe25Ye66ZSZOiAke2Vycm9yLm1lc3NhZ2UgfHwgJ+acquefpemUmeivryd9YCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICog5aSE55CG562b6YCJ5Zu+5qCH54K55Ye7XG4gICAqL1xuICBwcml2YXRlIGhhbmRsZUZpbHRlckljb25DbGljaygpOiB2b2lkIHtcbiAgICBjb25zdCAkZmlsdGVyT3B0aW9ucyA9IHRoaXMudmlldy5jb250YWluZXIuZmluZCgnLmZpbHRlci1vcHRpb25zJyk7XG4gICAgJGZpbHRlck9wdGlvbnMudG9nZ2xlKCk7XG4gIH1cblxuICAvKipcbiAgICog5aSE55CG562b6YCJ6YCJ6aG55Y+Y5pu0XG4gICAqIEBwYXJhbSBldmVudCDlj5jmm7Tkuovku7ZcbiAgICovXG4gIHByaXZhdGUgaGFuZGxlRmlsdGVyT3B0aW9uQ2hhbmdlKGV2ZW50OiBKUXVlcnkuQ2hhbmdlRXZlbnQpOiB2b2lkIHtcbiAgICBjb25zdCAkY2hlY2tib3ggPSAkKGV2ZW50LmN1cnJlbnRUYXJnZXQpO1xuICAgIGNvbnN0IHR5cGUgPSAkY2hlY2tib3guZGF0YSgndHlwZScpIGFzIFZhcmlhYmxlRGF0YVR5cGU7XG4gICAgY29uc3QgaXNDaGVja2VkID0gJGNoZWNrYm94LmlzKCc6Y2hlY2tlZCcpO1xuXG4gICAgdGhpcy5tb2RlbC51cGRhdGVGaWx0ZXJTdGF0ZSh0eXBlLCBpc0NoZWNrZWQpO1xuICAgIHRoaXMuYXBwbHlGaWx0ZXJzKCk7XG4gIH1cblxuICAvKipcbiAgICog5aSE55CG5Y+Y6YeP5pCc57SiXG4gICAqIEBwYXJhbSBldmVudCDovpPlhaXkuovku7ZcbiAgICovXG4gIHByaXZhdGUgaGFuZGxlVmFyaWFibGVTZWFyY2goZXZlbnQ6IEpRdWVyeS5UcmlnZ2VyZWRFdmVudCk6IHZvaWQge1xuICAgIGNvbnN0IGtleXdvcmQgPSAkKGV2ZW50LmN1cnJlbnRUYXJnZXQpLnZhbCgpIGFzIHN0cmluZztcbiAgICB0aGlzLm1vZGVsLnVwZGF0ZVNlYXJjaEtleXdvcmQoa2V5d29yZCk7XG4gICAgdGhpcy5hcHBseUZpbHRlcnMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlupTnlKjnrZvpgIlcbiAgICovXG4gIHByaXZhdGUgYXBwbHlGaWx0ZXJzKCk6IHZvaWQge1xuICAgIGNvbnN0IGZpbHRlclN0YXRlID0gdGhpcy5tb2RlbC5nZXRGaWx0ZXJTdGF0ZSgpO1xuICAgIGNvbnN0IHNlYXJjaEtleXdvcmQgPSB0aGlzLm1vZGVsLmdldFNlYXJjaEtleXdvcmQoKTtcblxuICAgIHRoaXMudmlldy5hcHBseUNsaWVudFNpZGVGaWx0ZXJzKGZpbHRlclN0YXRlLCBzZWFyY2hLZXl3b3JkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlpITnkIbmpbzlsYLojIPlm7TnrZvpgIlcbiAgICovXG4gIHByaXZhdGUgaGFuZGxlRmxvb3JSYW5nZUZpbHRlcigpOiB2b2lkIHtcbiAgICBjb25zdCAkbWluSW5wdXQgPSB0aGlzLnZpZXcuY29udGFpbmVyLmZpbmQoJyNmbG9vci1taW4nKTtcbiAgICBjb25zdCAkbWF4SW5wdXQgPSB0aGlzLnZpZXcuY29udGFpbmVyLmZpbmQoJyNmbG9vci1tYXgnKTtcblxuICAgIGNvbnN0IG1pblZhbCA9ICRtaW5JbnB1dC52YWwoKSBhcyBzdHJpbmc7XG4gICAgY29uc3QgbWF4VmFsID0gJG1heElucHV0LnZhbCgpIGFzIHN0cmluZztcblxuICAgIGNvbnN0IG1pbiA9IG1pblZhbC50cmltKCkgPyBwYXJzZUludChtaW5WYWwsIDEwKSA6IG51bGw7XG4gICAgY29uc3QgbWF4ID0gbWF4VmFsLnRyaW0oKSA/IHBhcnNlSW50KG1heFZhbCwgMTApIDogbnVsbDtcblxuICAgIGlmICgobWluVmFsLnRyaW0oKSAmJiBpc05hTihtaW4hKSkgfHwgKG1heFZhbC50cmltKCkgJiYgaXNOYU4obWF4ISkpKSB7XG4gICAgICB0aGlzLnZpZXcuc2hvd0Zsb29yRmlsdGVyRXJyb3IoJ+ivt+i+k+WFpeacieaViOeahOaVsOWtlycpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChtaW4gIT09IG51bGwgJiYgbWluIDwgMCkge1xuICAgICAgdGhpcy52aWV3LnNob3dGbG9vckZpbHRlckVycm9yKCfmnIDlsI/mpbzlsYLkuI3og73lsI/kuo4wJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKG1heCAhPT0gbnVsbCAmJiBtYXggPCAwKSB7XG4gICAgICB0aGlzLnZpZXcuc2hvd0Zsb29yRmlsdGVyRXJyb3IoJ+acgOWkp+alvOWxguS4jeiDveWwj+S6jjAnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAobWluICE9PSBudWxsICYmIG1heCAhPT0gbnVsbCAmJiBtaW4gPiBtYXgpIHtcbiAgICAgIHRoaXMudmlldy5zaG93Rmxvb3JGaWx0ZXJFcnJvcign5pyA5bCP5YC85LiN6IO95aSn5LqO5pyA5aSn5YC8Jyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKG1pbiA9PT0gbnVsbCAmJiBtYXggPT09IG51bGwpIHtcbiAgICAgIHRoaXMudmlldy5zaG93Rmxvb3JGaWx0ZXJFcnJvcign6K+36Iez5bCR6K6+572u5pyA5bCP5qW85bGC5oiW5pyA5aSn5qW85bGCJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy52aWV3LmhpZGVGbG9vckZpbHRlckVycm9yKCk7XG5cbiAgICBjb25zdCBlZmZlY3RpdmVNaW4gPSBtaW4gPz8gMDtcbiAgICBjb25zdCBlZmZlY3RpdmVNYXggPSBtYXggPz8gOTk5OTtcblxuICAgIHRoaXMuYXBwbHlGbG9vclJhbmdlQW5kUmVsb2FkKGVmZmVjdGl2ZU1pbiwgZWZmZWN0aXZlTWF4KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlupTnlKjmpbzlsYLojIPlm7Tlubbph43mlrDliqDovb3lj5jph49cbiAgICogQHBhcmFtIG1pbiDmnIDlsI/mpbzlsYJcbiAgICogQHBhcmFtIG1heCDmnIDlpKfmpbzlsYJcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgYXBwbHlGbG9vclJhbmdlQW5kUmVsb2FkKG1pbjogbnVtYmVyLCBtYXg6IG51bWJlcik6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICB0aGlzLm1vZGVsLnVwZGF0ZUZsb29yUmFuZ2UobWluLCBtYXgpO1xuICAgICAgdGhpcy52aWV3LnVwZGF0ZUZsb29yUmFuZ2VJbnB1dHMobWluLCBtYXgpO1xuICAgICAgYXdhaXQgdGhpcy5sb2FkVmFyaWFibGVzKCdtZXNzYWdlJyk7XG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgbG9nLmVycm9yKGBbVmFyaWFibGVNYW5hZ2VyXSDlupTnlKjmpbzlsYLojIPlm7Tlubbph43mlrDliqDovb3lj5jph4/lpLHotKU6YCwgZXJyb3IpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmuIXnkIbotYTmupBcbiAgICovXG4gIHB1YmxpYyBjbGVhbnVwKCk6IHZvaWQge1xuICAgIHRyeSB7XG4gICAgICB0aGlzLnN5bmNTZXJ2aWNlLmNsZWFudXAoKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nLmVycm9yKGBbVmFyaWFibGVNYW5hZ2VyXSDmuIXnkIbotYTmupDlpLHotKU6YCwgZXJyb3IpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDlkIzmraXlr7nosaHljaHniYfnmoTop4blm77mlbDmja5cbiAgICogQHBhcmFtIGNhcmQg5Y+Y6YeP5Y2h54mHXG4gICAqL1xuICBwcml2YXRlIHN5bmNPYmplY3RDYXJkRGF0YShjYXJkOiBKUXVlcnk8SFRNTEVsZW1lbnQ+KTogdm9pZCB7XG4gICAgY29uc3QgY3VycmVudE1vZGUgPSBjYXJkLmF0dHIoJ2RhdGEtdmlldy1tb2RlJykgfHwgJ2NhcmQnO1xuXG4gICAgaWYgKGN1cnJlbnRNb2RlID09PSAnY2FyZCcpIHtcbiAgICAgIGNvbnN0IG9iamVjdFZhbHVlID0gdGhpcy5jYXJkRmFjdG9yeS5nZXRWYXJpYWJsZUZyb21DYXJkKGNhcmQpO1xuICAgICAgY2FyZC5maW5kKCcueWFtbC1pbnB1dCcpLnZhbChZQU1MLnN0cmluZ2lmeShvYmplY3RWYWx1ZT8udmFsdWUsIG51bGwsIDIpKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5aSE55CG5bWM5aWX5Y2h54mH5Y+Y5pu05LqL5Lu2XG4gICAqIEBwYXJhbSBldmVudCDkuovku7blr7nosaFcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgaGFuZGxlTmVzdGVkQ2FyZENoYW5nZWQoZXZlbnQ6IEpRdWVyeS5UcmlnZ2VyZWRFdmVudCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGNhcmQgPSAkKGV2ZW50LmN1cnJlbnRUYXJnZXQpO1xuXG4gICAgY29uc3Qgc2F2ZUJ0biA9IGNhcmQuZmluZCgnLnZhcmlhYmxlLWFjdGlvbi1idG4uc2F2ZS1idG4nKTtcbiAgICBpZiAoc2F2ZUJ0bi5sZW5ndGggPiAwKSB7XG4gICAgICBzYXZlQnRuLnRyaWdnZXIoJ2NsaWNrJyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluWPmOmHj+exu+Wei+eahOS4reaWh+WQjeensFxuICAgKiBAcGFyYW0gdHlwZSDlj5jph4/nsbvlnotcbiAgICogQHJldHVybnMg5Lit5paH5ZCN56ewXG4gICAqL1xuICBwcml2YXRlIGdldFZhcmlhYmxlVHlwZU5hbWUodHlwZTogVmFyaWFibGVUeXBlKTogc3RyaW5nIHtcbiAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgIGNhc2UgJ2dsb2JhbCc6XG4gICAgICAgIHJldHVybiAn5YWo5bGAJztcbiAgICAgIGNhc2UgJ2NoYXJhY3Rlcic6XG4gICAgICAgIHJldHVybiAn6KeS6ImyJztcbiAgICAgIGNhc2UgJ2NoYXQnOlxuICAgICAgICByZXR1cm4gJ+iBiuWkqSc7XG4gICAgICBjYXNlICdtZXNzYWdlJzpcbiAgICAgICAgcmV0dXJuICfmtojmga8nO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIHR5cGU7XG4gICAgfVxuICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/component/variable_manager/controller.ts\n\n}")},"./src/component/variable_manager/index.ts":
/*!*************************************************!*\
  !*** ./src/component/variable_manager/index.ts ***!
  \*************************************************/(module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addVariableManagerQuickButton: () => (/* binding */ addVariableManagerQuickButton),\n/* harmony export */   initVariableManager: () => (/* binding */ initVariableManager),\n/* harmony export */   openVariableManager: () => (/* binding */ openVariableManager)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n/* harmony import */ var _component_variable_manager_controller__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/component/variable_manager/controller */ \"./src/component/variable_manager/controller.ts\");\n/* harmony import */ var _component_variable_manager_model__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/component/variable_manager/model */ \"./src/component/variable_manager/model.ts\");\n/* harmony import */ var _component_variable_manager_sync__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/component/variable_manager/sync */ \"./src/component/variable_manager/sync.ts\");\n/* harmony import */ var _component_variable_manager_view__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/component/variable_manager/view */ \"./src/component/variable_manager/view.ts\");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_7__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_component_variable_manager_controller__WEBPACK_IMPORTED_MODULE_2__, _component_variable_manager_view__WEBPACK_IMPORTED_MODULE_5__]);\n([_component_variable_manager_controller__WEBPACK_IMPORTED_MODULE_2__, _component_variable_manager_view__WEBPACK_IMPORTED_MODULE_5__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n\n\n\n\n\nconst templatePath = `${_util_extension_variables__WEBPACK_IMPORTED_MODULE_6__.extensionFolderPath}/src/component/variable_manager/public`;\nlet variableView = null;\nlet variableController = null;\nlet variableModel = null;\nlet syncService = null;\n/**\n * 初始化变量管理器\n */\nasync function openVariableManager() {\n    await (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_1__.loadFileToDocument)(`/scripts/extensions/${templatePath}/style.css`, 'css');\n    const $variableManagerContainer = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_0__.renderExtensionTemplateAsync)(`${templatePath}`, 'index'));\n    variableModel = new _component_variable_manager_model__WEBPACK_IMPORTED_MODULE_3__.VariableModel();\n    variableView = new _component_variable_manager_view__WEBPACK_IMPORTED_MODULE_5__.VariableView($variableManagerContainer);\n    syncService = new _component_variable_manager_sync__WEBPACK_IMPORTED_MODULE_4__.VariableSyncService(variableView, variableModel);\n    variableController = new _component_variable_manager_controller__WEBPACK_IMPORTED_MODULE_2__.VariableController(variableModel, variableView, syncService, variableView.cardFactory);\n    variableView.setController(variableController);\n    await variableController.init($variableManagerContainer);\n    if (variableView) {\n        variableView.render();\n    }\n    else {\n        loglevel__WEBPACK_IMPORTED_MODULE_7___default().error('[VariableManager] 变量管理器未初始化');\n    }\n}\n/**\n * 添加变量管理快速按钮\n */\nfunction addVariableManagerQuickButton() {\n    const buttonHtml = $(`\n  <div id=\"tavern-helper-variable-container\" class=\"list-group-item flex-container flexGap5 interactable tavern-helper-shortcut-item\">\n      <div class=\"fa-solid fa-square-root-variable extensionsMenuExtensionButton\" /></div>\n      <span id=\"tavern-helper-variable-text\">变量管理器</span>\n  </div>`);\n    buttonHtml.css('display', 'flex');\n    if ($('#tavern-helper-variable-container').length === 0) {\n        $('#extensionsMenu').append(buttonHtml);\n    }\n    $('#tavern-helper-variable-container').off('click').on('click', async function () {\n        await openVariableManager();\n    });\n}\nfunction initVariableManager() {\n    const $button = $('#open-variable-manager');\n    if ($button.length) {\n        $button.on('click', async () => {\n            await openVariableManager();\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvaW5kZXgudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQStFO0FBQ2Y7QUFFYTtBQUNWO0FBQ0s7QUFDUDtBQUNBO0FBRXRDO0FBRTNCLE1BQU0sWUFBWSxHQUFHLEdBQUcsMEVBQW1CLHdDQUF3QyxDQUFDO0FBRXBGLElBQUksWUFBWSxHQUF3QixJQUFJLENBQUM7QUFDN0MsSUFBSSxrQkFBa0IsR0FBOEIsSUFBSSxDQUFDO0FBQ3pELElBQUksYUFBYSxHQUF5QixJQUFJLENBQUM7QUFDL0MsSUFBSSxXQUFXLEdBQStCLElBQUksQ0FBQztBQUVuRDs7R0FFRztBQUNJLEtBQUssVUFBVSxtQkFBbUI7SUFDdkMsTUFBTSw4RUFBa0IsQ0FBQyx1QkFBdUIsWUFBWSxZQUFZLEVBQUUsS0FBSyxDQUFDLENBQUM7SUFFakYsTUFBTSx5QkFBeUIsR0FBRyxDQUFDLENBQUMsTUFBTSw2RkFBNEIsQ0FBQyxHQUFHLFlBQVksRUFBRSxFQUFFLE9BQU8sQ0FBQyxDQUFDLENBQUM7SUFFcEcsYUFBYSxHQUFHLElBQUksNEVBQWEsRUFBRSxDQUFDO0lBQ3BDLFlBQVksR0FBRyxJQUFJLDBFQUFZLENBQUMseUJBQXlCLENBQUMsQ0FBQztJQUUzRCxXQUFXLEdBQUcsSUFBSSxpRkFBbUIsQ0FBQyxZQUFZLEVBQUUsYUFBYSxDQUFDLENBQUM7SUFFbkUsa0JBQWtCLEdBQUcsSUFBSSxzRkFBa0IsQ0FBQyxhQUFhLEVBQUUsWUFBWSxFQUFFLFdBQVcsRUFBRSxZQUFZLENBQUMsV0FBVyxDQUFDLENBQUM7SUFFaEgsWUFBWSxDQUFDLGFBQWEsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO0lBRS9DLE1BQU0sa0JBQWtCLENBQUMsSUFBSSxDQUFDLHlCQUF5QixDQUFDLENBQUM7SUFDekQsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUNqQixZQUFZLENBQUMsTUFBTSxFQUFFLENBQUM7SUFDeEIsQ0FBQztTQUFNLENBQUM7UUFDTixxREFBUyxDQUFDLDZCQUE2QixDQUFDLENBQUM7SUFDM0MsQ0FBQztBQUNILENBQUM7QUFFRDs7R0FFRztBQUNJLFNBQVMsNkJBQTZCO0lBQzNDLE1BQU0sVUFBVSxHQUFHLENBQUMsQ0FBQzs7OztTQUlkLENBQUMsQ0FBQztJQUNULFVBQVUsQ0FBQyxHQUFHLENBQUMsU0FBUyxFQUFFLE1BQU0sQ0FBQyxDQUFDO0lBQ2xDLElBQUksQ0FBQyxDQUFDLG1DQUFtQyxDQUFDLENBQUMsTUFBTSxLQUFLLENBQUMsRUFBRSxDQUFDO1FBQ3hELENBQUMsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUMxQyxDQUFDO0lBQ0QsQ0FBQyxDQUFDLG1DQUFtQyxDQUFDLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUUsS0FBSztRQUNuRSxNQUFNLG1CQUFtQixFQUFFLENBQUM7SUFDOUIsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDO0FBRU0sU0FBUyxtQkFBbUI7SUFDakMsTUFBTSxPQUFPLEdBQUcsQ0FBQyxDQUFDLHdCQUF3QixDQUFDLENBQUM7SUFDNUMsSUFBSSxPQUFPLENBQUMsTUFBTSxFQUFFLENBQUM7UUFDbkIsT0FBTyxDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDN0IsTUFBTSxtQkFBbUIsRUFBRSxDQUFDO1FBQzlCLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztBQUNILENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvaW5kZXgudHM/MzRjZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyByZW5kZXJFeHRlbnNpb25UZW1wbGF0ZUFzeW5jIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvZXh0ZW5zaW9ucyc7XG5pbXBvcnQgeyBsb2FkRmlsZVRvRG9jdW1lbnQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy91dGlscyc7XG5cbmltcG9ydCB7IFZhcmlhYmxlQ29udHJvbGxlciB9IGZyb20gJ0AvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvY29udHJvbGxlcic7XG5pbXBvcnQgeyBWYXJpYWJsZU1vZGVsIH0gZnJvbSAnQC9jb21wb25lbnQvdmFyaWFibGVfbWFuYWdlci9tb2RlbCc7XG5pbXBvcnQgeyBWYXJpYWJsZVN5bmNTZXJ2aWNlIH0gZnJvbSAnQC9jb21wb25lbnQvdmFyaWFibGVfbWFuYWdlci9zeW5jJztcbmltcG9ydCB7IFZhcmlhYmxlVmlldyB9IGZyb20gJ0AvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvdmlldyc7XG5pbXBvcnQgeyBleHRlbnNpb25Gb2xkZXJQYXRoIH0gZnJvbSAnQC91dGlsL2V4dGVuc2lvbl92YXJpYWJsZXMnO1xuXG5pbXBvcnQgbG9nIGZyb20gJ2xvZ2xldmVsJztcblxuY29uc3QgdGVtcGxhdGVQYXRoID0gYCR7ZXh0ZW5zaW9uRm9sZGVyUGF0aH0vc3JjL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL3B1YmxpY2A7XG5cbmxldCB2YXJpYWJsZVZpZXc6IFZhcmlhYmxlVmlldyB8IG51bGwgPSBudWxsO1xubGV0IHZhcmlhYmxlQ29udHJvbGxlcjogVmFyaWFibGVDb250cm9sbGVyIHwgbnVsbCA9IG51bGw7XG5sZXQgdmFyaWFibGVNb2RlbDogVmFyaWFibGVNb2RlbCB8IG51bGwgPSBudWxsO1xubGV0IHN5bmNTZXJ2aWNlOiBWYXJpYWJsZVN5bmNTZXJ2aWNlIHwgbnVsbCA9IG51bGw7XG5cbi8qKlxuICog5Yid5aeL5YyW5Y+Y6YeP566h55CG5ZmoXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBvcGVuVmFyaWFibGVNYW5hZ2VyKCkge1xuICBhd2FpdCBsb2FkRmlsZVRvRG9jdW1lbnQoYC9zY3JpcHRzL2V4dGVuc2lvbnMvJHt0ZW1wbGF0ZVBhdGh9L3N0eWxlLmNzc2AsICdjc3MnKTtcblxuICBjb25zdCAkdmFyaWFibGVNYW5hZ2VyQ29udGFpbmVyID0gJChhd2FpdCByZW5kZXJFeHRlbnNpb25UZW1wbGF0ZUFzeW5jKGAke3RlbXBsYXRlUGF0aH1gLCAnaW5kZXgnKSk7XG5cbiAgdmFyaWFibGVNb2RlbCA9IG5ldyBWYXJpYWJsZU1vZGVsKCk7XG4gIHZhcmlhYmxlVmlldyA9IG5ldyBWYXJpYWJsZVZpZXcoJHZhcmlhYmxlTWFuYWdlckNvbnRhaW5lcik7XG5cbiAgc3luY1NlcnZpY2UgPSBuZXcgVmFyaWFibGVTeW5jU2VydmljZSh2YXJpYWJsZVZpZXcsIHZhcmlhYmxlTW9kZWwpO1xuXG4gIHZhcmlhYmxlQ29udHJvbGxlciA9IG5ldyBWYXJpYWJsZUNvbnRyb2xsZXIodmFyaWFibGVNb2RlbCwgdmFyaWFibGVWaWV3LCBzeW5jU2VydmljZSwgdmFyaWFibGVWaWV3LmNhcmRGYWN0b3J5KTtcblxuICB2YXJpYWJsZVZpZXcuc2V0Q29udHJvbGxlcih2YXJpYWJsZUNvbnRyb2xsZXIpO1xuXG4gIGF3YWl0IHZhcmlhYmxlQ29udHJvbGxlci5pbml0KCR2YXJpYWJsZU1hbmFnZXJDb250YWluZXIpO1xuICBpZiAodmFyaWFibGVWaWV3KSB7XG4gICAgdmFyaWFibGVWaWV3LnJlbmRlcigpO1xuICB9IGVsc2Uge1xuICAgIGxvZy5lcnJvcignW1ZhcmlhYmxlTWFuYWdlcl0g5Y+Y6YeP566h55CG5Zmo5pyq5Yid5aeL5YyWJyk7XG4gIH1cbn1cblxuLyoqXG4gKiDmt7vliqDlj5jph4/nrqHnkIblv6vpgJ/mjInpkq5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFkZFZhcmlhYmxlTWFuYWdlclF1aWNrQnV0dG9uKCkge1xuICBjb25zdCBidXR0b25IdG1sID0gJChgXG4gIDxkaXYgaWQ9XCJ0YXZlcm4taGVscGVyLXZhcmlhYmxlLWNvbnRhaW5lclwiIGNsYXNzPVwibGlzdC1ncm91cC1pdGVtIGZsZXgtY29udGFpbmVyIGZsZXhHYXA1IGludGVyYWN0YWJsZSB0YXZlcm4taGVscGVyLXNob3J0Y3V0LWl0ZW1cIj5cbiAgICAgIDxkaXYgY2xhc3M9XCJmYS1zb2xpZCBmYS1zcXVhcmUtcm9vdC12YXJpYWJsZSBleHRlbnNpb25zTWVudUV4dGVuc2lvbkJ1dHRvblwiIC8+PC9kaXY+XG4gICAgICA8c3BhbiBpZD1cInRhdmVybi1oZWxwZXItdmFyaWFibGUtdGV4dFwiPuWPmOmHj+euoeeQhuWZqDwvc3Bhbj5cbiAgPC9kaXY+YCk7XG4gIGJ1dHRvbkh0bWwuY3NzKCdkaXNwbGF5JywgJ2ZsZXgnKTtcbiAgaWYgKCQoJyN0YXZlcm4taGVscGVyLXZhcmlhYmxlLWNvbnRhaW5lcicpLmxlbmd0aCA9PT0gMCkge1xuICAgICQoJyNleHRlbnNpb25zTWVudScpLmFwcGVuZChidXR0b25IdG1sKTtcbiAgfVxuICAkKCcjdGF2ZXJuLWhlbHBlci12YXJpYWJsZS1jb250YWluZXInKS5vZmYoJ2NsaWNrJykub24oJ2NsaWNrJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgIGF3YWl0IG9wZW5WYXJpYWJsZU1hbmFnZXIoKTtcbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpbml0VmFyaWFibGVNYW5hZ2VyKCkge1xuICBjb25zdCAkYnV0dG9uID0gJCgnI29wZW4tdmFyaWFibGUtbWFuYWdlcicpO1xuICBpZiAoJGJ1dHRvbi5sZW5ndGgpIHtcbiAgICAkYnV0dG9uLm9uKCdjbGljaycsIGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IG9wZW5WYXJpYWJsZU1hbmFnZXIoKTtcbiAgICB9KTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/component/variable_manager/index.ts\n\n}")},"./src/component/variable_manager/model.ts":
/*!*************************************************!*\
  !*** ./src/component/variable_manager/model.ts ***!
  \*************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VariableModel: () => (/* binding */ VariableModel)\n/* harmony export */ });\n/* harmony import */ var _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/variable_manager/util */ \"./src/component/variable_manager/util.ts\");\n/* harmony import */ var _function_variables__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/function/variables */ \"./src/function/variables.ts\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_3__);\n\n\n\n\nclass VariableModel {\n    currentVariables = null;\n    variableIdMap = new Map();\n    activeVariableType = 'global';\n    filterState = {\n        string: true,\n        array: true,\n        boolean: true,\n        number: true,\n        object: true,\n    };\n    searchKeyword = '';\n    floorMinRange = null;\n    floorMaxRange = null;\n    constructor() { }\n    /**\n     * 为变量创建唯一ID并建立映射关系\n     * @param name 变量名称\n     * @param value 变量值\n     * @param message_id 消息ID（可选，仅用于message类型变量）\n     * @returns 生成的唯一ID\n     */\n    createVariableItem(name, value, message_id) {\n        const id = (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_2__.uuidv4)();\n        const variable_item = {\n            name,\n            value,\n            dataType: _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_0__.VariableManagerUtil.inferDataType(value),\n            id,\n            ...(message_id !== undefined && { message_id }),\n        };\n        this.variableIdMap.set(id, variable_item);\n        return variable_item;\n    }\n    // ========== 前端和Map之间的存取 ==========\n    /**\n     * 获取当前map中的所有变量 (前端 ← map)\n     */\n    getCurrentMapVariables() {\n        return this.currentVariables ? [...this.currentVariables] : [];\n    }\n    /**\n     * 向map中添加变量 (前端 → map)\n     */\n    addToMap(name, value, message_id) {\n        const variable = this.createVariableItem(name, value, message_id);\n        if (!this.currentVariables) {\n            this.currentVariables = [];\n        }\n        this.currentVariables.push(variable);\n        return variable;\n    }\n    /**\n     * 从map中移除变量 (前端 → map)\n     */\n    removeFromMap(id) {\n        if (!this.currentVariables)\n            return false;\n        const index = this.currentVariables.findIndex(v => v.id === id);\n        if (index >= 0) {\n            this.currentVariables.splice(index, 1);\n            this.variableIdMap.delete(id);\n            return true;\n        }\n        return false;\n    }\n    /**\n     * 在map中更新变量 (前端 → map)\n     */\n    updateInMap(id, newName, newValue, newMessageId) {\n        if (!this.currentVariables)\n            return false;\n        const variable = this.currentVariables.find(v => v.id === id);\n        if (variable) {\n            variable.name = newName;\n            variable.value = newValue;\n            variable.dataType = _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_0__.VariableManagerUtil.inferDataType(newValue);\n            if (newMessageId !== undefined) {\n                variable.message_id = newMessageId;\n            }\n            this.variableIdMap.set(id, variable);\n            return true;\n        }\n        return false;\n    }\n    /**\n     * 清除所有变量ID映射\n     */\n    clearVariableIdMap() {\n        this.variableIdMap.clear();\n    }\n    /**\n     * 通过ID获取变量信息\n     * @param id 变量ID\n     * @returns 变量信息对象 {name, value} 或 undefined\n     */\n    getVariableById(id) {\n        return this.variableIdMap.get(id);\n    }\n    // ========== 酒馆和Map之间的存取 ==========\n    /**\n     * 将酒馆变量转换为VariableItem数组\n     * @param tavernVariables 从酒馆获取的原始变量数据\n     * @param message_id 消息ID（可选，仅用于message类型变量）\n     * @returns 转换后的VariableItem数组\n     * @description 自动推断每个变量的数据类型并分配唯一ID\n     */\n    convertTavernVariablesToItems(tavernVariables, message_id) {\n        return Object.entries(tavernVariables).map(([name, value]) => {\n            return this.createVariableItem(name, value, message_id);\n        });\n    }\n    /**\n     * 将VariableItem数组转换为TavernVariables对象\n     * @param variables VariableItem数组\n     * @param message_id 可选的message_id筛选条件\n     * @returns TavernVariables对象\n     */\n    convertItemsToTavernVariables(variables, message_id) {\n        const result = {};\n        for (const variable of variables) {\n            // 如果指定了message_id，只转换匹配的变量\n            if (message_id !== undefined) {\n                if (variable.message_id === message_id) {\n                    result[variable.name] = variable.value;\n                }\n            }\n            else {\n                // 如果没有指定message_id，转换所有变量\n                result[variable.name] = variable.value;\n            }\n        }\n        return result;\n    }\n    /**\n     * 加载指定类型的变量\n     * @param type 变量类型(global/character/chat/message)\n     * @returns 加载的变量数据\n     */\n    async loadFromTavern(type) {\n        this.clearVariableIdMap();\n        try {\n            this.activeVariableType = type;\n            if (type === 'message') {\n                this.currentVariables = [];\n                // 获取当前楼层范围\n                const [minFloor, maxFloor] = this.getFloorRange();\n                // 确保至少有一个有效的楼层范围\n                if (minFloor !== null || maxFloor !== null) {\n                    const effectiveMinFloor = minFloor ?? 0;\n                    const effectiveMaxFloor = maxFloor ?? minFloor ?? 0;\n                    // 遍历每个楼层，加载各自的变量\n                    for (let floor = effectiveMinFloor; floor <= effectiveMaxFloor; floor++) {\n                        try {\n                            const floorVars = this.getFloorVariables(floor);\n                            // 为每个楼层的变量添加message_id标识\n                            const floorVariableItems = this.convertTavernVariablesToItems(floorVars, floor);\n                            this.currentVariables.push(...floorVariableItems);\n                        }\n                        catch (error) {\n                            loglevel__WEBPACK_IMPORTED_MODULE_3___default().warn(`[VariableModel] 加载第${floor}层变量失败:`, error);\n                            // 继续加载其他楼层\n                        }\n                    }\n                }\n            }\n            else {\n                const variables = (0,_function_variables__WEBPACK_IMPORTED_MODULE_1__.getVariables)({ type });\n                this.currentVariables = this.convertTavernVariablesToItems(variables);\n            }\n            return this.currentVariables;\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_3___default().error(`[VariableManager] 加载${type}变量失败:`, error);\n            return [];\n        }\n    }\n    /**\n     * 保存所有变量到酒馆\n     * @param type 变量类型(global/character/chat/message)\n     * @param message_id 消息ID(仅用于message类型，可选，如果指定则只保存到该楼层)\n     */\n    async saveAllVariables(type, message_id) {\n        if (!this.currentVariables) {\n            loglevel__WEBPACK_IMPORTED_MODULE_3___default().warn('[VariableModel] 当前没有变量数据，跳过保存');\n            return;\n        }\n        if (type === 'message') {\n            const [minFloor, maxFloor] = this.getFloorRange();\n            if (minFloor === null || maxFloor === null) {\n                loglevel__WEBPACK_IMPORTED_MODULE_3___default().warn('[VariableModel] 保存message变量失败: 未设置有效的楼层范围');\n                return;\n            }\n            // 如果指定了特定的message_id，只保存到该楼层\n            if (message_id !== undefined && message_id >= minFloor && message_id <= maxFloor) {\n                const variablesForFloor = this.currentVariables.filter(v => v.message_id === message_id);\n                const tavernVariables = this.convertItemsToTavernVariables(variablesForFloor, message_id);\n                try {\n                    await (0,_function_variables__WEBPACK_IMPORTED_MODULE_1__.replaceVariables)(tavernVariables, { type: 'message', message_id });\n                    loglevel__WEBPACK_IMPORTED_MODULE_3___default().info(`[VariableManager] 成功保存第${message_id}层变量`);\n                }\n                catch (error) {\n                    loglevel__WEBPACK_IMPORTED_MODULE_3___default().error(`[VariableManager] 保存第${message_id}层变量失败:`, error);\n                }\n            }\n            else {\n                // 对于消息类型，按楼层分组保存变量\n                for (let floor = minFloor; floor <= maxFloor; floor++) {\n                    const variablesForFloor = this.currentVariables.filter(v => v.message_id === floor);\n                    const tavernVariables = this.convertItemsToTavernVariables(variablesForFloor, floor);\n                    try {\n                        await (0,_function_variables__WEBPACK_IMPORTED_MODULE_1__.replaceVariables)(tavernVariables, { type: 'message', message_id: floor });\n                    }\n                    catch (error) {\n                        loglevel__WEBPACK_IMPORTED_MODULE_3___default().error(`[VariableManager] 保存第${floor}层变量失败:`, error);\n                    }\n                }\n            }\n        }\n        else {\n            // 对于其他类型（global/character/chat），构建变量对象\n            const tavernVariables = this.convertItemsToTavernVariables(this.currentVariables);\n            await (0,_function_variables__WEBPACK_IMPORTED_MODULE_1__.replaceVariables)(tavernVariables, { type });\n        }\n        loglevel__WEBPACK_IMPORTED_MODULE_3___default().info(`[VariableManager] 保存变量成功`);\n    }\n    /**\n     * 获取当前活动的变量类型\n     * @returns 变量类型\n     */\n    getActiveVariableType() {\n        return this.activeVariableType;\n    }\n    /**\n     * 更新列表变量的顺序\n     * @param type 变量类型(global/character/chat/message)\n     * @param name 变量名称\n     * @param items 新的列表顺序\n     * @param variable_id 变量ID(可选，如果提供则同时更新ID映射)\n     */\n    async updateListOrder(type, name, items, variable_id) {\n        if (type === this.activeVariableType && this.currentVariables) {\n            const variable = this.currentVariables.find(variable => variable.name === name);\n            if (variable && Array.isArray(variable.value)) {\n                variable.value = items;\n                // 如果提供了变量ID，更新映射\n                if (variable_id) {\n                    const varInfo = this.variableIdMap.get(variable_id);\n                    if (varInfo) {\n                        varInfo.value = items;\n                        // 保持变量的message_id不变\n                        this.variableIdMap.set(variable_id, varInfo);\n                    }\n                }\n                // 使用完全覆盖模式保存\n                await this.saveAllVariables(type, variable.message_id);\n            }\n        }\n    }\n    /**\n     * 清除所有变量\n     * @param type 变量类型(global/character/chat/message)\n     */\n    async clearAllVariables(type) {\n        if (type === this.activeVariableType) {\n            this.currentVariables = [];\n            this.clearVariableIdMap();\n        }\n        // 消息类型变量需要逐层清除\n        if (type === 'message') {\n            const [minFloor, maxFloor] = this.getFloorRange();\n            if (minFloor === null || maxFloor === null) {\n                loglevel__WEBPACK_IMPORTED_MODULE_3___default().warn('[VariableModel] 清除message变量失败: 未设置有效的楼层范围');\n                return;\n            }\n            // 逐层清除变量\n            for (let floor = minFloor; floor <= maxFloor; floor++) {\n                try {\n                    const emptyVariables = {};\n                    await (0,_function_variables__WEBPACK_IMPORTED_MODULE_1__.replaceVariables)(emptyVariables, { type: 'message', message_id: floor });\n                }\n                catch (error) {\n                    loglevel__WEBPACK_IMPORTED_MODULE_3___default().error(`[VariableModel] 清除第${floor}层变量失败:`, error);\n                }\n            }\n        }\n        else {\n            // 其他类型变量直接替换为空对象\n            const emptyVariables = {};\n            await (0,_function_variables__WEBPACK_IMPORTED_MODULE_1__.replaceVariables)(emptyVariables, { type });\n        }\n    }\n    /**\n     * 更新筛选状态\n     * @param type 数据类型\n     * @param checked 是否选中\n     */\n    updateFilterState(type, checked) {\n        this.filterState[type] = checked;\n    }\n    /**\n     * 获取筛选状态\n     * @returns 筛选状态\n     */\n    getFilterState() {\n        return this.filterState;\n    }\n    /**\n     * 更新搜索关键词\n     * @param keyword 关键词\n     */\n    updateSearchKeyword(keyword) {\n        this.searchKeyword = keyword;\n    }\n    /**\n     * 获取搜索关键词\n     * @returns 搜索关键词\n     */\n    getSearchKeyword() {\n        return this.searchKeyword;\n    }\n    /**\n     * 更新楼层范围筛选\n     * @param min 最小楼层\n     * @param max 最大楼层\n     */\n    updateFloorRange(min, max) {\n        // 验证楼层不能小于0\n        if (min !== null) {\n            min = Math.max(0, min);\n        }\n        if (max !== null) {\n            max = Math.max(0, max);\n        }\n        // 如果设置了范围但是最小值大于最大值，则交换它们\n        if (min !== null && max !== null && min > max) {\n            [min, max] = [max, min];\n        }\n        this.floorMinRange = min;\n        this.floorMaxRange = max;\n        // 清除缓存，强制重新加载\n        if (this.activeVariableType === 'message') {\n            this.currentVariables = null;\n        }\n    }\n    /**\n     * 获取当前楼层范围筛选\n     * @returns 当前楼层范围 [min, max]\n     */\n    getFloorRange() {\n        return [this.floorMinRange, this.floorMaxRange];\n    }\n    /**\n     * 获取特定楼层的变量数据\n     * @param messageId 消息ID\n     * @returns 楼层变量数据对象\n     */\n    getFloorVariables(messageId) {\n        try {\n            const variables = (0,_function_variables__WEBPACK_IMPORTED_MODULE_1__.getVariables)({ type: 'message', message_id: messageId });\n            return variables || {};\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_3___default().error(`获取第${messageId}层变量失败:`, error);\n            return {};\n        }\n    }\n    /**\n     * 查找变量对应的 ID\n     * @param name 变量名称\n     * @param message_id 消息ID（可选，用于精确匹配message类型变量）\n     * @returns 找到的变量ID，如果不存在则返回undefined\n     */\n    findVariableId(name, message_id) {\n        for (const id of this.variableIdMap.keys()) {\n            const varInfo = this.variableIdMap.get(id);\n            if (varInfo && varInfo.name === name) {\n                // 如果指定了message_id，需要精确匹配\n                if (message_id !== undefined) {\n                    if (varInfo.message_id === message_id) {\n                        return id;\n                    }\n                }\n                else {\n                    // 如果没有指定message_id，返回第一个匹配的变量\n                    return id;\n                }\n            }\n        }\n        return undefined;\n    }\n    /**\n     * 获取指定楼层的变量列表\n     * @param message_id 消息ID\n     * @returns 属于该楼层的变量列表\n     */\n    getVariablesByMessageId(message_id) {\n        if (!this.currentVariables)\n            return [];\n        return this.currentVariables.filter(variable => variable.message_id === message_id);\n    }\n    /**\n     * 获取所有没有message_id的变量（通常是非message类型的变量）\n     * @returns 没有message_id的变量列表\n     */\n    getVariablesWithoutMessageId() {\n        if (!this.currentVariables)\n            return [];\n        return this.currentVariables.filter(variable => variable.message_id === undefined);\n    }\n    /**\n     * 根据变量名获取所有同名变量\n     * @param name 变量名称\n     * @returns 同名变量列表\n     */\n    getVariablesByName(name) {\n        if (!this.currentVariables)\n            return [];\n        return this.currentVariables.filter(variable => variable.name === name);\n    }\n    /**\n     * 通过变量名查找变量\n     * @param name 变量名称\n     * @param message_id 消息ID（可选，用于精确匹配message类型变量）\n     * @returns 找到的变量，如果不存在则返回undefined\n     */\n    findVariableByName(name, message_id) {\n        if (!this.currentVariables)\n            return undefined;\n        for (const variable of this.currentVariables) {\n            if (variable.name === name) {\n                if (message_id !== undefined) {\n                    if (variable.message_id === message_id) {\n                        return variable;\n                    }\n                }\n                else {\n                    return variable;\n                }\n            }\n        }\n        return undefined;\n    }\n    /**\n     * 同步当前变量列表，根据外部变化进行增量更新\n     * @param added 新增的变量\n     * @param removedIds 要删除的变量ID列表\n     * @param updated 要更新的变量\n     */\n    syncCurrentVariables(added, removedIds, updated) {\n        if (!this.currentVariables) {\n            this.currentVariables = [];\n        }\n        // 处理删除\n        removedIds.forEach(id => {\n            const index = this.currentVariables.findIndex(v => v.id === id);\n            if (index >= 0) {\n                this.currentVariables.splice(index, 1);\n                this.variableIdMap.delete(id);\n            }\n        });\n        // 处理新增\n        added.forEach(variable => {\n            this.currentVariables.push(variable);\n            this.variableIdMap.set(variable.id, variable);\n        });\n        // 处理更新\n        updated.forEach(updatedVariable => {\n            const index = this.currentVariables.findIndex(v => v.id === updatedVariable.id);\n            if (index >= 0) {\n                this.currentVariables[index] = updatedVariable;\n                this.variableIdMap.set(updatedVariable.id, updatedVariable);\n            }\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvbW9kZWwudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQ3dFO0FBQ0Y7QUFDbEI7QUFFekI7QUFFcEIsTUFBTSxhQUFhO0lBQ2hCLGdCQUFnQixHQUEwQixJQUFJLENBQUM7SUFDL0MsYUFBYSxHQUE4QixJQUFJLEdBQUcsRUFBRSxDQUFDO0lBRXJELGtCQUFrQixHQUFpQixRQUFRLENBQUM7SUFFNUMsV0FBVyxHQUFzQztRQUN2RCxNQUFNLEVBQUUsSUFBSTtRQUNaLEtBQUssRUFBRSxJQUFJO1FBQ1gsT0FBTyxFQUFFLElBQUk7UUFDYixNQUFNLEVBQUUsSUFBSTtRQUNaLE1BQU0sRUFBRSxJQUFJO0tBQ2IsQ0FBQztJQUVNLGFBQWEsR0FBVyxFQUFFLENBQUM7SUFFM0IsYUFBYSxHQUFrQixJQUFJLENBQUM7SUFDcEMsYUFBYSxHQUFrQixJQUFJLENBQUM7SUFFNUMsZ0JBQWUsQ0FBQztJQUVoQjs7Ozs7O09BTUc7SUFDSSxrQkFBa0IsQ0FBQyxJQUFZLEVBQUUsS0FBVSxFQUFFLFVBQW1CO1FBQ3JFLE1BQU0sRUFBRSxHQUFHLGtFQUFNLEVBQUUsQ0FBQztRQUNwQixNQUFNLGFBQWEsR0FBaUI7WUFDbEMsSUFBSTtZQUNKLEtBQUs7WUFDTCxRQUFRLEVBQUUsaUZBQW1CLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQztZQUNsRCxFQUFFO1lBQ0YsR0FBRyxDQUFDLFVBQVUsS0FBSyxTQUFTLElBQUksRUFBRSxVQUFVLEVBQUUsQ0FBQztTQUNoRCxDQUFDO1FBQ0YsSUFBSSxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsRUFBRSxFQUFFLGFBQWEsQ0FBQyxDQUFDO1FBQzFDLE9BQU8sYUFBYSxDQUFDO0lBQ3ZCLENBQUM7SUFFRCxvQ0FBb0M7SUFFcEM7O09BRUc7SUFDSSxzQkFBc0I7UUFDM0IsT0FBTyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsZ0JB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Q0FBQyxFQUFFLENBQUM7Z0JBQ2YsSUFBSSxDQUFDLGdCQUFpQixDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUM7Z0JBQ3hDLElBQUksQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1lBQ2hDLENBQUM7UUFDSCxDQUFDLENBQUMsQ0FBQztRQUVILE9BQU87UUFDUCxLQUFLLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxFQUFFO1lBQ3ZCLElBQUksQ0FBQyxnQkFBaUIsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDdEMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLEVBQUUsRUFBRSxRQUFRLENBQUMsQ0FBQztRQUNoRCxDQUFDLENBQUMsQ0FBQztRQUVILE9BQU87UUFDUCxPQUFPLENBQUMsT0FBTyxDQUFDLGVBQWUsQ0FBQyxFQUFFO1lBQ2hDLE1BQU0sS0FBSyxHQUFHLElBQUksQ0FBQyxnQkFBaUIsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxLQUFLLGVBQWUsQ0FBQyxFQUFFLENBQUMsQ0FBQztZQUNqRixJQUFJLEtBQUssSUFBSSxDQUFDLEVBQUUsQ0FBQztnQkFDZixJQUFJLENBQUMsZ0JBQWlCLENBQUMsS0FBSyxDQUFDLEdBQUcsZUFBZSxDQUFDO2dCQUNoRCxJQUFJLENBQUMsYUFBYSxDQUFDLEdBQUcsQ0FBQyxlQUFlLENBQUMsRUFBRSxFQUFFLGVBQWUsQ0FBQyxDQUFDO1lBQzlELENBQUM7UUFDSCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7Q0FDRiIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9jb21wb25lbnQvdmFyaWFibGVfbWFuYWdlci9tb2RlbC50cz9iOTYzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFRhdmVyblZhcmlhYmxlcywgVmFyaWFibGVEYXRhVHlwZSwgVmFyaWFibGVJdGVtLCBWYXJpYWJsZVR5cGUgfSBmcm9tICdAL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL3R5cGVzJztcbmltcG9ydCB7IFZhcmlhYmxlTWFuYWdlclV0aWwgfSBmcm9tICdAL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL3V0aWwnO1xuaW1wb3J0IHsgZ2V0VmFyaWFibGVzLCByZXBsYWNlVmFyaWFibGVzIH0gZnJvbSAnQC9mdW5jdGlvbi92YXJpYWJsZXMnO1xuaW1wb3J0IHsgdXVpZHY0IH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvdXRpbHMnO1xuXG5pbXBvcnQgbG9nIGZyb20gJ2xvZ2xldmVsJztcblxuZXhwb3J0IGNsYXNzIFZhcmlhYmxlTW9kZWwge1xuICBwcml2YXRlIGN1cnJlbnRWYXJpYWJsZXM6IFZhcmlhYmxlSXRlbVtdIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgdmFyaWFibGVJZE1hcDogTWFwPHN0cmluZywgVmFyaWFibGVJdGVtPiA9IG5ldyBNYXAoKTtcblxuICBwcml2YXRlIGFjdGl2ZVZhcmlhYmxlVHlwZTogVmFyaWFibGVUeXBlID0gJ2dsb2JhbCc7XG5cbiAgcHJpdmF0ZSBmaWx0ZXJTdGF0ZTogUmVjb3JkPFZhcmlhYmxlRGF0YVR5cGUsIGJvb2xlYW4+ID0ge1xuICAgIHN0cmluZzogdHJ1ZSxcbiAgICBhcnJheTogdHJ1ZSxcbiAgICBib29sZWFuOiB0cnVlLFxuICAgIG51bWJlcjogdHJ1ZSxcbiAgICBvYmplY3Q6IHRydWUsXG4gIH07XG5cbiAgcHJpdmF0ZSBzZWFyY2hLZXl3b3JkOiBzdHJpbmcgPSAnJztcblxuICBwcml2YXRlIGZsb29yTWluUmFuZ2U6IG51bWJlciB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIGZsb29yTWF4UmFuZ2U6IG51bWJlciB8IG51bGwgPSBudWxsO1xuXG4gIGNvbnN0cnVjdG9yKCkge31cblxuICAvKipcbiAgICog5Li65Y+Y6YeP5Yib5bu65ZSv5LiASUTlubblu7rnq4vmmKDlsITlhbPns7tcbiAgICogQHBhcmFtIG5hbWUg5Y+Y6YeP5ZCN56ewXG4gICAqIEBwYXJhbSB2YWx1ZSDlj5jph4/lgLxcbiAgICogQHBhcmFtIG1lc3NhZ2VfaWQg5raI5oGvSUTvvIjlj6/pgInvvIzku4XnlKjkuo5tZXNzYWdl57G75Z6L5Y+Y6YeP77yJXG4gICAqIEByZXR1cm5zIOeUn+aIkOeahOWUr+S4gElEXG4gICAqL1xuICBwdWJsaWMgY3JlYXRlVmFyaWFibGVJdGVtKG5hbWU6IHN0cmluZywgdmFsdWU6IGFueSwgbWVzc2FnZV9pZD86IG51bWJlcik6IFZhcmlhYmxlSXRlbSB7XG4gICAgY29uc3QgaWQgPSB1dWlkdjQoKTtcbiAgICBjb25zdCB2YXJpYWJsZV9pdGVtOiBWYXJpYWJsZUl0ZW0gPSB7XG4gICAgICBuYW1lLFxuICAgICAgdmFsdWUsXG4gICAgICBkYXRhVHlwZTogVmFyaWFibGVNYW5hZ2VyVXRpbC5pbmZlckRhdGFUeXBlKHZhbHVlKSxcbiAgICAgIGlkLFxuICAgICAgLi4uKG1lc3NhZ2VfaWQgIT09IHVuZGVmaW5lZCAmJiB7IG1lc3NhZ2VfaWQgfSksXG4gICAgfTtcbiAgICB0aGlzLnZhcmlhYmxlSWRNYXAuc2V0KGlkLCB2YXJpYWJsZV9pdGVtKTtcbiAgICByZXR1cm4gdmFyaWFibGVfaXRlbTtcbiAgfVxuXG4gIC8vID09PT09PT09PT0g5YmN56uv5ZKMTWFw5LmL6Ze055qE5a2Y5Y+WID09PT09PT09PT1cblxuICAvKipcbiAgICog6I635Y+W5b2T5YmNbWFw5Lit55qE5omA5pyJ5Y+Y6YePICjliY3nq68g4oaQIG1hcClcbiAgICovXG4gIHB1YmxpYyBnZXRDdXJyZW50TWFwVmFyaWFibGVzKCk6IFZhcmlhYmxlSXRlbVtdIHtcbiAgICByZXR1cm4gdGhpcy5jdXJyZW50VmFyaWFibGVzID8gWy4uLnRoaXMuY3VycmVudFZhcmlhYmxlc10gOiBbXTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlkJFtYXDkuK3mt7vliqDlj5jph48gKOWJjeerryDihpIgbWFwKVxuICAgKi9cbiAgcHVibGljIGFkZFRvTWFwKG5hbWU6IHN0cmluZywgdmFsdWU6IGFueSwgbWVzc2FnZV9pZD86IG51bWJlcik6IFZhcmlhYmxlSXRlbSB7XG4gICAgY29uc3QgdmFyaWFibGUgPSB0aGlzLmNyZWF0ZVZhcmlhYmxlSXRlbShuYW1lLCB2YWx1ZSwgbWVzc2FnZV9pZCk7XG4gICAgaWYgKCF0aGlzLmN1cnJlbnRWYXJpYWJsZXMpIHtcbiAgICAgIHRoaXMuY3VycmVudFZhcmlhYmxlcyA9IFtdO1xuICAgIH1cbiAgICB0aGlzLmN1cnJlbnRWYXJpYWJsZXMucHVzaCh2YXJpYWJsZSk7XG4gICAgcmV0dXJuIHZhcmlhYmxlO1xuICB9XG5cbiAgLyoqXG4gICAqIOS7jm1hcOS4reenu+mZpOWPmOmHjyAo5YmN56uvIOKGkiBtYXApXG4gICAqL1xuICBwdWJsaWMgcmVtb3ZlRnJvbU1hcChpZDogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgaWYgKCF0aGlzLmN1cnJlbnRWYXJpYWJsZXMpIHJldHVybiBmYWxzZTtcbiAgICBjb25zdCBpbmRleCA9IHRoaXMuY3VycmVudFZhcmlhYmxlcy5maW5kSW5kZXgodiA9PiB2LmlkID09PSBpZCk7XG4gICAgaWYgKGluZGV4ID49IDApIHtcbiAgICAgIHRoaXMuY3VycmVudFZhcmlhYmxlcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgdGhpcy52YXJpYWJsZUlkTWFwLmRlbGV0ZShpZCk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgLyoqXG4gICAqIOWcqG1hcOS4reabtOaWsOWPmOmHjyAo5YmN56uvIOKGkiBtYXApXG4gICAqL1xuICBwdWJsaWMgdXBkYXRlSW5NYXAoaWQ6IHN0cmluZywgbmV3TmFtZTogc3RyaW5nLCBuZXdWYWx1ZTogYW55LCBuZXdNZXNzYWdlSWQ/OiBudW1iZXIpOiBib29sZWFuIHtcbiAgICBpZiAoIXRoaXMuY3VycmVudFZhcmlhYmxlcykgcmV0dXJuIGZhbHNlO1xuICAgIGNvbnN0IHZhcmlhYmxlID0gdGhpcy5jdXJyZW50VmFyaWFibGVzLmZpbmQodiA9PiB2LmlkID09PSBpZCk7XG4gICAgaWYgKHZhcmlhYmxlKSB7XG4gICAgICB2YXJpYWJsZS5uYW1lID0gbmV3TmFtZTtcbiAgICAgIHZhcmlhYmxlLnZhbHVlID0gbmV3VmFsdWU7XG4gICAgICB2YXJpYWJsZS5kYXRhVHlwZSA9IFZhcmlhYmxlTWFuYWdlclV0aWwuaW5mZXJEYXRhVHlwZShuZXdWYWx1ZSk7XG4gICAgICBpZiAobmV3TWVzc2FnZUlkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdmFyaWFibGUubWVzc2FnZV9pZCA9IG5ld01lc3NhZ2VJZDtcbiAgICAgIH1cbiAgICAgIHRoaXMudmFyaWFibGVJZE1hcC5zZXQoaWQsIHZhcmlhYmxlKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvKipcbiAgICog5riF6Zmk5omA5pyJ5Y+Y6YePSUTmmKDlsIRcbiAgICovXG4gIHB1YmxpYyBjbGVhclZhcmlhYmxlSWRNYXAoKTogdm9pZCB7XG4gICAgdGhpcy52YXJpYWJsZUlkTWFwLmNsZWFyKCk7XG4gIH1cblxuICAvKipcbiAgICog6YCa6L+HSUTojrflj5blj5jph4/kv6Hmga9cbiAgICogQHBhcmFtIGlkIOWPmOmHj0lEXG4gICAqIEByZXR1cm5zIOWPmOmHj+S/oeaBr+WvueixoSB7bmFtZSwgdmFsdWV9IOaIliB1bmRlZmluZWRcbiAgICovXG4gIHB1YmxpYyBnZXRWYXJpYWJsZUJ5SWQoaWQ6IHN0cmluZyk6IFZhcmlhYmxlSXRlbSB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMudmFyaWFibGVJZE1hcC5nZXQoaWQpO1xuICB9XG5cbiAgLy8gPT09PT09PT09PSDphZLppoblkoxNYXDkuYvpl7TnmoTlrZjlj5YgPT09PT09PT09PVxuXG4gIC8qKlxuICAgKiDlsIbphZLppoblj5jph4/ovazmjaLkuLpWYXJpYWJsZUl0ZW3mlbDnu4RcbiAgICogQHBhcmFtIHRhdmVyblZhcmlhYmxlcyDku47phZLppobojrflj5bnmoTljp/lp4vlj5jph4/mlbDmja5cbiAgICogQHBhcmFtIG1lc3NhZ2VfaWQg5raI5oGvSUTvvIjlj6/pgInvvIzku4XnlKjkuo5tZXNzYWdl57G75Z6L5Y+Y6YeP77yJXG4gICAqIEByZXR1cm5zIOi9rOaNouWQjueahFZhcmlhYmxlSXRlbeaVsOe7hFxuICAgKiBAZGVzY3JpcHRpb24g6Ieq5Yqo5o6o5pat5q+P5Liq5Y+Y6YeP55qE5pWw5o2u57G75Z6L5bm25YiG6YWN5ZSv5LiASURcbiAgICovXG4gIHB1YmxpYyBjb252ZXJ0VGF2ZXJuVmFyaWFibGVzVG9JdGVtcyh0YXZlcm5WYXJpYWJsZXM6IFRhdmVyblZhcmlhYmxlcywgbWVzc2FnZV9pZD86IG51bWJlcik6IFZhcmlhYmxlSXRlbVtdIHtcbiAgICByZXR1cm4gT2JqZWN0LmVudHJpZXModGF2ZXJuVmFyaWFibGVzKS5tYXAoKFtuYW1lLCB2YWx1ZV0pID0+IHtcbiAgICAgIHJldHVybiB0aGlzLmNyZWF0ZVZhcmlhYmxlSXRlbShuYW1lLCB2YWx1ZSwgbWVzc2FnZV9pZCk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog5bCGVmFyaWFibGVJdGVt5pWw57uE6L2s5o2i5Li6VGF2ZXJuVmFyaWFibGVz5a+56LGhXG4gICAqIEBwYXJhbSB2YXJpYWJsZXMgVmFyaWFibGVJdGVt5pWw57uEXG4gICAqIEBwYXJhbSBtZXNzYWdlX2lkIOWPr+mAieeahG1lc3NhZ2VfaWTnrZvpgInmnaHku7ZcbiAgICogQHJldHVybnMgVGF2ZXJuVmFyaWFibGVz5a+56LGhXG4gICAqL1xuICBwdWJsaWMgY29udmVydEl0ZW1zVG9UYXZlcm5WYXJpYWJsZXModmFyaWFibGVzOiBWYXJpYWJsZUl0ZW1bXSwgbWVzc2FnZV9pZD86IG51bWJlcik6IFRhdmVyblZhcmlhYmxlcyB7XG4gICAgY29uc3QgcmVzdWx0OiBUYXZlcm5WYXJpYWJsZXMgPSB7fTtcblxuICAgIGZvciAoY29uc3QgdmFyaWFibGUgb2YgdmFyaWFibGVzKSB7XG4gICAgICAvLyDlpoLmnpzmjIflrprkuoZtZXNzYWdlX2lk77yM5Y+q6L2s5o2i5Yy56YWN55qE5Y+Y6YePXG4gICAgICBpZiAobWVzc2FnZV9pZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGlmICh2YXJpYWJsZS5tZXNzYWdlX2lkID09PSBtZXNzYWdlX2lkKSB7XG4gICAgICAgICAgcmVzdWx0W3ZhcmlhYmxlLm5hbWVdID0gdmFyaWFibGUudmFsdWU7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIOWmguaenOayoeacieaMh+Wumm1lc3NhZ2VfaWTvvIzovazmjaLmiYDmnInlj5jph49cbiAgICAgICAgcmVzdWx0W3ZhcmlhYmxlLm5hbWVdID0gdmFyaWFibGUudmFsdWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8qKlxuICAgKiDliqDovb3mjIflrprnsbvlnovnmoTlj5jph49cbiAgICogQHBhcmFtIHR5cGUg5Y+Y6YeP57G75Z6LKGdsb2JhbC9jaGFyYWN0ZXIvY2hhdC9tZXNzYWdlKVxuICAgKiBAcmV0dXJucyDliqDovb3nmoTlj5jph4/mlbDmja5cbiAgICovXG4gIHB1YmxpYyBhc3luYyBsb2FkRnJvbVRhdmVybih0eXBlOiBWYXJpYWJsZVR5cGUpOiBQcm9taXNlPFZhcmlhYmxlSXRlbVtdPiB7XG4gICAgdGhpcy5jbGVhclZhcmlhYmxlSWRNYXAoKTtcblxuICAgIHRyeSB7XG4gICAgICB0aGlzLmFjdGl2ZVZhcmlhYmxlVHlwZSA9IHR5cGU7XG5cbiAgICAgIGlmICh0eXBlID09PSAnbWVzc2FnZScpIHtcbiAgICAgICAgdGhpcy5jdXJyZW50VmFyaWFibGVzID0gW107XG5cbiAgICAgICAgLy8g6I635Y+W5b2T5YmN5qW85bGC6IyD5Zu0XG4gICAgICAgIGNvbnN0IFttaW5GbG9vciwgbWF4Rmxvb3JdID0gdGhpcy5nZXRGbG9vclJhbmdlKCk7XG5cbiAgICAgICAgLy8g56Gu5L+d6Iez5bCR5pyJ5LiA5Liq5pyJ5pWI55qE5qW85bGC6IyD5Zu0XG4gICAgICAgIGlmIChtaW5GbG9vciAhPT0gbnVsbCB8fCBtYXhGbG9vciAhPT0gbnVsbCkge1xuICAgICAgICAgIGNvbnN0IGVmZmVjdGl2ZU1pbkZsb29yID0gbWluRmxvb3IgPz8gMDtcbiAgICAgICAgICBjb25zdCBlZmZlY3RpdmVNYXhGbG9vciA9IG1heEZsb29yID8/IG1pbkZsb29yID8/IDA7XG5cbiAgICAgICAgICAvLyDpgY3ljobmr4/kuKrmpbzlsYLvvIzliqDovb3lkIToh6rnmoTlj5jph49cbiAgICAgICAgICBmb3IgKGxldCBmbG9vciA9IGVmZmVjdGl2ZU1pbkZsb29yOyBmbG9vciA8PSBlZmZlY3RpdmVNYXhGbG9vcjsgZmxvb3IrKykge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgY29uc3QgZmxvb3JWYXJzID0gdGhpcy5nZXRGbG9vclZhcmlhYmxlcyhmbG9vcik7XG4gICAgICAgICAgICAgIC8vIOS4uuavj+S4qualvOWxgueahOWPmOmHj+a3u+WKoG1lc3NhZ2VfaWTmoIfor4ZcbiAgICAgICAgICAgICAgY29uc3QgZmxvb3JWYXJpYWJsZUl0ZW1zID0gdGhpcy5jb252ZXJ0VGF2ZXJuVmFyaWFibGVzVG9JdGVtcyhmbG9vclZhcnMsIGZsb29yKTtcbiAgICAgICAgICAgICAgdGhpcy5jdXJyZW50VmFyaWFibGVzLnB1c2goLi4uZmxvb3JWYXJpYWJsZUl0ZW1zKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgIGxvZy53YXJuKGBbVmFyaWFibGVNb2RlbF0g5Yqg6L2956ysJHtmbG9vcn3lsYLlj5jph4/lpLHotKU6YCwgZXJyb3IpO1xuICAgICAgICAgICAgICAvLyDnu6fnu63liqDovb3lhbbku5bmpbzlsYJcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IHZhcmlhYmxlcyA9IGdldFZhcmlhYmxlcyh7IHR5cGUgfSkgYXMgVGF2ZXJuVmFyaWFibGVzO1xuICAgICAgICB0aGlzLmN1cnJlbnRWYXJpYWJsZXMgPSB0aGlzLmNvbnZlcnRUYXZlcm5WYXJpYWJsZXNUb0l0ZW1zKHZhcmlhYmxlcyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRWYXJpYWJsZXM7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZy5lcnJvcihgW1ZhcmlhYmxlTWFuYWdlcl0g5Yqg6L29JHt0eXBlfeWPmOmHj+Wksei0pTpgLCBlcnJvcik7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOS/neWtmOaJgOacieWPmOmHj+WIsOmFkummhlxuICAgKiBAcGFyYW0gdHlwZSDlj5jph4/nsbvlnosoZ2xvYmFsL2NoYXJhY3Rlci9jaGF0L21lc3NhZ2UpXG4gICAqIEBwYXJhbSBtZXNzYWdlX2lkIOa2iOaBr0lEKOS7heeUqOS6jm1lc3NhZ2XnsbvlnovvvIzlj6/pgInvvIzlpoLmnpzmjIflrprliJnlj6rkv53lrZjliLDor6XmpbzlsYIpXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgc2F2ZUFsbFZhcmlhYmxlcyh0eXBlOiBWYXJpYWJsZVR5cGUsIG1lc3NhZ2VfaWQ/OiBudW1iZXIpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAoIXRoaXMuY3VycmVudFZhcmlhYmxlcykge1xuICAgICAgbG9nLndhcm4oJ1tWYXJpYWJsZU1vZGVsXSDlvZPliY3msqHmnInlj5jph4/mlbDmja7vvIzot7Pov4fkv53lrZgnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAodHlwZSA9PT0gJ21lc3NhZ2UnKSB7XG4gICAgICBjb25zdCBbbWluRmxvb3IsIG1heEZsb29yXSA9IHRoaXMuZ2V0Rmxvb3JSYW5nZSgpO1xuXG4gICAgICBpZiAobWluRmxvb3IgPT09IG51bGwgfHwgbWF4Rmxvb3IgPT09IG51bGwpIHtcbiAgICAgICAgbG9nLndhcm4oJ1tWYXJpYWJsZU1vZGVsXSDkv53lrZhtZXNzYWdl5Y+Y6YeP5aSx6LSlOiDmnKrorr7nva7mnInmlYjnmoTmpbzlsYLojIPlm7QnKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyDlpoLmnpzmjIflrprkuobnibnlrprnmoRtZXNzYWdlX2lk77yM5Y+q5L+d5a2Y5Yiw6K+l5qW85bGCXG4gICAgICBpZiAobWVzc2FnZV9pZCAhPT0gdW5kZWZpbmVkICYmIG1lc3NhZ2VfaWQgPj0gbWluRmxvb3IgJiYgbWVzc2FnZV9pZCA8PSBtYXhGbG9vcikge1xuICAgICAgICBjb25zdCB2YXJpYWJsZXNGb3JGbG9vciA9IHRoaXMuY3VycmVudFZhcmlhYmxlcy5maWx0ZXIodiA9PiB2Lm1lc3NhZ2VfaWQgPT09IG1lc3NhZ2VfaWQpO1xuICAgICAgICBjb25zdCB0YXZlcm5WYXJpYWJsZXMgPSB0aGlzLmNvbnZlcnRJdGVtc1RvVGF2ZXJuVmFyaWFibGVzKHZhcmlhYmxlc0ZvckZsb29yLCBtZXNzYWdlX2lkKTtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgIGF3YWl0IHJlcGxhY2VWYXJpYWJsZXModGF2ZXJuVmFyaWFibGVzLCB7IHR5cGU6ICdtZXNzYWdlJywgbWVzc2FnZV9pZCB9KTtcbiAgICAgICAgICBsb2cuaW5mbyhgW1ZhcmlhYmxlTWFuYWdlcl0g5oiQ5Yqf5L+d5a2Y56ysJHttZXNzYWdlX2lkfeWxguWPmOmHj2ApO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGxvZy5lcnJvcihgW1ZhcmlhYmxlTWFuYWdlcl0g5L+d5a2Y56ysJHttZXNzYWdlX2lkfeWxguWPmOmHj+Wksei0pTpgLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIOWvueS6jua2iOaBr+exu+Wei++8jOaMiealvOWxguWIhue7hOS/neWtmOWPmOmHj1xuICAgICAgICBmb3IgKGxldCBmbG9vciA9IG1pbkZsb29yOyBmbG9vciA8PSBtYXhGbG9vcjsgZmxvb3IrKykge1xuICAgICAgICAgIGNvbnN0IHZhcmlhYmxlc0ZvckZsb29yID0gdGhpcy5jdXJyZW50VmFyaWFibGVzLmZpbHRlcih2ID0+IHYubWVzc2FnZV9pZCA9PT0gZmxvb3IpO1xuICAgICAgICAgIGNvbnN0IHRhdmVyblZhcmlhYmxlcyA9IHRoaXMuY29udmVydEl0ZW1zVG9UYXZlcm5WYXJpYWJsZXModmFyaWFibGVzRm9yRmxvb3IsIGZsb29yKTtcblxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCByZXBsYWNlVmFyaWFibGVzKHRhdmVyblZhcmlhYmxlcywgeyB0eXBlOiAnbWVzc2FnZScsIG1lc3NhZ2VfaWQ6IGZsb29yIH0pO1xuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBsb2cuZXJyb3IoYFtWYXJpYWJsZU1hbmFnZXJdIOS/neWtmOesrCR7Zmxvb3J95bGC5Y+Y6YeP5aSx6LSlOmAsIGVycm9yKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8g5a+55LqO5YW25LuW57G75Z6L77yIZ2xvYmFsL2NoYXJhY3Rlci9jaGF077yJ77yM5p6E5bu65Y+Y6YeP5a+56LGhXG4gICAgICBjb25zdCB0YXZlcm5WYXJpYWJsZXMgPSB0aGlzLmNvbnZlcnRJdGVtc1RvVGF2ZXJuVmFyaWFibGVzKHRoaXMuY3VycmVudFZhcmlhYmxlcyk7XG4gICAgICBhd2FpdCByZXBsYWNlVmFyaWFibGVzKHRhdmVyblZhcmlhYmxlcywgeyB0eXBlIH0pO1xuICAgIH1cblxuICAgIGxvZy5pbmZvKGBbVmFyaWFibGVNYW5hZ2VyXSDkv53lrZjlj5jph4/miJDlip9gKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5blvZPliY3mtLvliqjnmoTlj5jph4/nsbvlnotcbiAgICogQHJldHVybnMg5Y+Y6YeP57G75Z6LXG4gICAqL1xuICBwdWJsaWMgZ2V0QWN0aXZlVmFyaWFibGVUeXBlKCk6IFZhcmlhYmxlVHlwZSB7XG4gICAgcmV0dXJuIHRoaXMuYWN0aXZlVmFyaWFibGVUeXBlO1xuICB9XG5cbiAgLyoqXG4gICAqIOabtOaWsOWIl+ihqOWPmOmHj+eahOmhuuW6j1xuICAgKiBAcGFyYW0gdHlwZSDlj5jph4/nsbvlnosoZ2xvYmFsL2NoYXJhY3Rlci9jaGF0L21lc3NhZ2UpXG4gICAqIEBwYXJhbSBuYW1lIOWPmOmHj+WQjeensFxuICAgKiBAcGFyYW0gaXRlbXMg5paw55qE5YiX6KGo6aG65bqPXG4gICAqIEBwYXJhbSB2YXJpYWJsZV9pZCDlj5jph49JRCjlj6/pgInvvIzlpoLmnpzmj5DkvpvliJnlkIzml7bmm7TmlrBJROaYoOWwhClcbiAgICovXG4gIHB1YmxpYyBhc3luYyB1cGRhdGVMaXN0T3JkZXIodHlwZTogVmFyaWFibGVUeXBlLCBuYW1lOiBzdHJpbmcsIGl0ZW1zOiBzdHJpbmdbXSwgdmFyaWFibGVfaWQ/OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAodHlwZSA9PT0gdGhpcy5hY3RpdmVWYXJpYWJsZVR5cGUgJiYgdGhpcy5jdXJyZW50VmFyaWFibGVzKSB7XG4gICAgICBjb25zdCB2YXJpYWJsZSA9IHRoaXMuY3VycmVudFZhcmlhYmxlcy5maW5kKHZhcmlhYmxlID0+IHZhcmlhYmxlLm5hbWUgPT09IG5hbWUpO1xuICAgICAgaWYgKHZhcmlhYmxlICYmIEFycmF5LmlzQXJyYXkodmFyaWFibGUudmFsdWUpKSB7XG4gICAgICAgIHZhcmlhYmxlLnZhbHVlID0gaXRlbXM7XG5cbiAgICAgICAgLy8g5aaC5p6c5o+Q5L6b5LqG5Y+Y6YePSUTvvIzmm7TmlrDmmKDlsIRcbiAgICAgICAgaWYgKHZhcmlhYmxlX2lkKSB7XG4gICAgICAgICAgY29uc3QgdmFySW5mbyA9IHRoaXMudmFyaWFibGVJZE1hcC5nZXQodmFyaWFibGVfaWQpO1xuICAgICAgICAgIGlmICh2YXJJbmZvKSB7XG4gICAgICAgICAgICB2YXJJbmZvLnZhbHVlID0gaXRlbXM7XG4gICAgICAgICAgICAvLyDkv53mjIHlj5jph4/nmoRtZXNzYWdlX2lk5LiN5Y+YXG4gICAgICAgICAgICB0aGlzLnZhcmlhYmxlSWRNYXAuc2V0KHZhcmlhYmxlX2lkLCB2YXJJbmZvKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyDkvb/nlKjlrozlhajopobnm5bmqKHlvI/kv53lrZhcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlQWxsVmFyaWFibGVzKHR5cGUsIHZhcmlhYmxlLm1lc3NhZ2VfaWQpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmuIXpmaTmiYDmnInlj5jph49cbiAgICogQHBhcmFtIHR5cGUg5Y+Y6YeP57G75Z6LKGdsb2JhbC9jaGFyYWN0ZXIvY2hhdC9tZXNzYWdlKVxuICAgKi9cbiAgcHVibGljIGFzeW5jIGNsZWFyQWxsVmFyaWFibGVzKHR5cGU6IFZhcmlhYmxlVHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICh0eXBlID09PSB0aGlzLmFjdGl2ZVZhcmlhYmxlVHlwZSkge1xuICAgICAgdGhpcy5jdXJyZW50VmFyaWFibGVzID0gW107XG4gICAgICB0aGlzLmNsZWFyVmFyaWFibGVJZE1hcCgpO1xuICAgIH1cblxuICAgIC8vIOa2iOaBr+exu+Wei+WPmOmHj+mcgOimgemAkOWxgua4hemZpFxuICAgIGlmICh0eXBlID09PSAnbWVzc2FnZScpIHtcbiAgICAgIGNvbnN0IFttaW5GbG9vciwgbWF4Rmxvb3JdID0gdGhpcy5nZXRGbG9vclJhbmdlKCk7XG5cbiAgICAgIGlmIChtaW5GbG9vciA9PT0gbnVsbCB8fCBtYXhGbG9vciA9PT0gbnVsbCkge1xuICAgICAgICBsb2cud2FybignW1ZhcmlhYmxlTW9kZWxdIOa4hemZpG1lc3NhZ2Xlj5jph4/lpLHotKU6IOacquiuvue9ruacieaViOeahOalvOWxguiMg+WbtCcpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIOmAkOWxgua4hemZpOWPmOmHj1xuICAgICAgZm9yIChsZXQgZmxvb3IgPSBtaW5GbG9vcjsgZmxvb3IgPD0gbWF4Rmxvb3I7IGZsb29yKyspIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBlbXB0eVZhcmlhYmxlczogVGF2ZXJuVmFyaWFibGVzID0ge307XG4gICAgICAgICAgYXdhaXQgcmVwbGFjZVZhcmlhYmxlcyhlbXB0eVZhcmlhYmxlcywgeyB0eXBlOiAnbWVzc2FnZScsIG1lc3NhZ2VfaWQ6IGZsb29yIH0pO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGxvZy5lcnJvcihgW1ZhcmlhYmxlTW9kZWxdIOa4hemZpOesrCR7Zmxvb3J95bGC5Y+Y6YeP5aSx6LSlOmAsIGVycm9yKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyDlhbbku5bnsbvlnovlj5jph4/nm7TmjqXmm7/mjaLkuLrnqbrlr7nosaFcbiAgICAgIGNvbnN0IGVtcHR5VmFyaWFibGVzOiBUYXZlcm5WYXJpYWJsZXMgPSB7fTtcbiAgICAgIGF3YWl0IHJlcGxhY2VWYXJpYWJsZXMoZW1wdHlWYXJpYWJsZXMsIHsgdHlwZSB9KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5pu05paw562b6YCJ54q25oCBXG4gICAqIEBwYXJhbSB0eXBlIOaVsOaNruexu+Wei1xuICAgKiBAcGFyYW0gY2hlY2tlZCDmmK/lkKbpgInkuK1cbiAgICovXG4gIHB1YmxpYyB1cGRhdGVGaWx0ZXJTdGF0ZSh0eXBlOiBWYXJpYWJsZURhdGFUeXBlLCBjaGVja2VkOiBib29sZWFuKTogdm9pZCB7XG4gICAgdGhpcy5maWx0ZXJTdGF0ZVt0eXBlXSA9IGNoZWNrZWQ7XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W562b6YCJ54q25oCBXG4gICAqIEByZXR1cm5zIOetm+mAieeKtuaAgVxuICAgKi9cbiAgcHVibGljIGdldEZpbHRlclN0YXRlKCk6IFJlY29yZDxWYXJpYWJsZURhdGFUeXBlLCBib29sZWFuPiB7XG4gICAgcmV0dXJuIHRoaXMuZmlsdGVyU3RhdGU7XG4gIH1cblxuICAvKipcbiAgICog5pu05paw5pCc57Si5YWz6ZSu6K+NXG4gICAqIEBwYXJhbSBrZXl3b3JkIOWFs+mUruivjVxuICAgKi9cbiAgcHVibGljIHVwZGF0ZVNlYXJjaEtleXdvcmQoa2V5d29yZDogc3RyaW5nKTogdm9pZCB7XG4gICAgdGhpcy5zZWFyY2hLZXl3b3JkID0ga2V5d29yZDtcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5bmkJzntKLlhbPplK7or41cbiAgICogQHJldHVybnMg5pCc57Si5YWz6ZSu6K+NXG4gICAqL1xuICBwdWJsaWMgZ2V0U2VhcmNoS2V5d29yZCgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLnNlYXJjaEtleXdvcmQ7XG4gIH1cblxuICAvKipcbiAgICog5pu05paw5qW85bGC6IyD5Zu0562b6YCJXG4gICAqIEBwYXJhbSBtaW4g5pyA5bCP5qW85bGCXG4gICAqIEBwYXJhbSBtYXgg5pyA5aSn5qW85bGCXG4gICAqL1xuICBwdWJsaWMgdXBkYXRlRmxvb3JSYW5nZShtaW46IG51bWJlciB8IG51bGwsIG1heDogbnVtYmVyIHwgbnVsbCk6IHZvaWQge1xuICAgIC8vIOmqjOivgealvOWxguS4jeiDveWwj+S6jjBcbiAgICBpZiAobWluICE9PSBudWxsKSB7XG4gICAgICBtaW4gPSBNYXRoLm1heCgwLCBtaW4pO1xuICAgIH1cbiAgICBpZiAobWF4ICE9PSBudWxsKSB7XG4gICAgICBtYXggPSBNYXRoLm1heCgwLCBtYXgpO1xuICAgIH1cblxuICAgIC8vIOWmguaenOiuvue9ruS6huiMg+WbtOS9huaYr+acgOWwj+WAvOWkp+S6juacgOWkp+WAvO+8jOWImeS6pOaNouWug+S7rFxuICAgIGlmIChtaW4gIT09IG51bGwgJiYgbWF4ICE9PSBudWxsICYmIG1pbiA+IG1heCkge1xuICAgICAgW21pbiwgbWF4XSA9IFttYXgsIG1pbl07XG4gICAgfVxuXG4gICAgdGhpcy5mbG9vck1pblJhbmdlID0gbWluO1xuICAgIHRoaXMuZmxvb3JNYXhSYW5nZSA9IG1heDtcblxuICAgIC8vIOa4hemZpOe8k+WtmO+8jOW8uuWItumHjeaWsOWKoOi9vVxuICAgIGlmICh0aGlzLmFjdGl2ZVZhcmlhYmxlVHlwZSA9PT0gJ21lc3NhZ2UnKSB7XG4gICAgICB0aGlzLmN1cnJlbnRWYXJpYWJsZXMgPSBudWxsO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5blvZPliY3mpbzlsYLojIPlm7TnrZvpgIlcbiAgICogQHJldHVybnMg5b2T5YmN5qW85bGC6IyD5Zu0IFttaW4sIG1heF1cbiAgICovXG4gIHB1YmxpYyBnZXRGbG9vclJhbmdlKCk6IFtudW1iZXIgfCBudWxsLCBudW1iZXIgfCBudWxsXSB7XG4gICAgcmV0dXJuIFt0aGlzLmZsb29yTWluUmFuZ2UsIHRoaXMuZmxvb3JNYXhSYW5nZV07XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W54m55a6a5qW85bGC55qE5Y+Y6YeP5pWw5o2uXG4gICAqIEBwYXJhbSBtZXNzYWdlSWQg5raI5oGvSURcbiAgICogQHJldHVybnMg5qW85bGC5Y+Y6YeP5pWw5o2u5a+56LGhXG4gICAqL1xuICBwdWJsaWMgZ2V0Rmxvb3JWYXJpYWJsZXMobWVzc2FnZUlkOiBudW1iZXIpOiBUYXZlcm5WYXJpYWJsZXMge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB2YXJpYWJsZXMgPSBnZXRWYXJpYWJsZXMoeyB0eXBlOiAnbWVzc2FnZScsIG1lc3NhZ2VfaWQ6IG1lc3NhZ2VJZCB9KSBhcyBUYXZlcm5WYXJpYWJsZXM7XG4gICAgICByZXR1cm4gdmFyaWFibGVzIHx8IHt9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2cuZXJyb3IoYOiOt+WPluesrCR7bWVzc2FnZUlkfeWxguWPmOmHj+Wksei0pTpgLCBlcnJvcik7XG4gICAgICByZXR1cm4ge307XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOafpeaJvuWPmOmHj+WvueW6lOeahCBJRFxuICAgKiBAcGFyYW0gbmFtZSDlj5jph4/lkI3np7BcbiAgICogQHBhcmFtIG1lc3NhZ2VfaWQg5raI5oGvSUTvvIjlj6/pgInvvIznlKjkuo7nsr7noa7ljLnphY1tZXNzYWdl57G75Z6L5Y+Y6YeP77yJXG4gICAqIEByZXR1cm5zIOaJvuWIsOeahOWPmOmHj0lE77yM5aaC5p6c5LiN5a2Y5Zyo5YiZ6L+U5ZuedW5kZWZpbmVkXG4gICAqL1xuICBwdWJsaWMgZmluZFZhcmlhYmxlSWQobmFtZTogc3RyaW5nLCBtZXNzYWdlX2lkPzogbnVtYmVyKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICBmb3IgKGNvbnN0IGlkIG9mIHRoaXMudmFyaWFibGVJZE1hcC5rZXlzKCkpIHtcbiAgICAgIGNvbnN0IHZhckluZm8gPSB0aGlzLnZhcmlhYmxlSWRNYXAuZ2V0KGlkKTtcbiAgICAgIGlmICh2YXJJbmZvICYmIHZhckluZm8ubmFtZSA9PT0gbmFtZSkge1xuICAgICAgICAvLyDlpoLmnpzmjIflrprkuoZtZXNzYWdlX2lk77yM6ZyA6KaB57K+56Gu5Yy56YWNXG4gICAgICAgIGlmIChtZXNzYWdlX2lkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBpZiAodmFySW5mby5tZXNzYWdlX2lkID09PSBtZXNzYWdlX2lkKSB7XG4gICAgICAgICAgICByZXR1cm4gaWQ7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIOWmguaenOayoeacieaMh+Wumm1lc3NhZ2VfaWTvvIzov5Tlm57nrKzkuIDkuKrljLnphY3nmoTlj5jph49cbiAgICAgICAgICByZXR1cm4gaWQ7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5bmjIflrprmpbzlsYLnmoTlj5jph4/liJfooahcbiAgICogQHBhcmFtIG1lc3NhZ2VfaWQg5raI5oGvSURcbiAgICogQHJldHVybnMg5bGe5LqO6K+l5qW85bGC55qE5Y+Y6YeP5YiX6KGoXG4gICAqL1xuICBwdWJsaWMgZ2V0VmFyaWFibGVzQnlNZXNzYWdlSWQobWVzc2FnZV9pZDogbnVtYmVyKTogVmFyaWFibGVJdGVtW10ge1xuICAgIGlmICghdGhpcy5jdXJyZW50VmFyaWFibGVzKSByZXR1cm4gW107XG4gICAgcmV0dXJuIHRoaXMuY3VycmVudFZhcmlhYmxlcy5maWx0ZXIodmFyaWFibGUgPT4gdmFyaWFibGUubWVzc2FnZV9pZCA9PT0gbWVzc2FnZV9pZCk7XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5omA5pyJ5rKh5pyJbWVzc2FnZV9pZOeahOWPmOmHj++8iOmAmuW4uOaYr+mdnm1lc3NhZ2XnsbvlnovnmoTlj5jph4/vvIlcbiAgICogQHJldHVybnMg5rKh5pyJbWVzc2FnZV9pZOeahOWPmOmHj+WIl+ihqFxuICAgKi9cbiAgcHVibGljIGdldFZhcmlhYmxlc1dpdGhvdXRNZXNzYWdlSWQoKTogVmFyaWFibGVJdGVtW10ge1xuICAgIGlmICghdGhpcy5jdXJyZW50VmFyaWFibGVzKSByZXR1cm4gW107XG4gICAgcmV0dXJuIHRoaXMuY3VycmVudFZhcmlhYmxlcy5maWx0ZXIodmFyaWFibGUgPT4gdmFyaWFibGUubWVzc2FnZV9pZCA9PT0gdW5kZWZpbmVkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmoLnmja7lj5jph4/lkI3ojrflj5bmiYDmnInlkIzlkI3lj5jph49cbiAgICogQHBhcmFtIG5hbWUg5Y+Y6YeP5ZCN56ewXG4gICAqIEByZXR1cm5zIOWQjOWQjeWPmOmHj+WIl+ihqFxuICAgKi9cbiAgcHVibGljIGdldFZhcmlhYmxlc0J5TmFtZShuYW1lOiBzdHJpbmcpOiBWYXJpYWJsZUl0ZW1bXSB7XG4gICAgaWYgKCF0aGlzLmN1cnJlbnRWYXJpYWJsZXMpIHJldHVybiBbXTtcbiAgICByZXR1cm4gdGhpcy5jdXJyZW50VmFyaWFibGVzLmZpbHRlcih2YXJpYWJsZSA9PiB2YXJpYWJsZS5uYW1lID09PSBuYW1lKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDpgJrov4flj5jph4/lkI3mn6Xmib7lj5jph49cbiAgICogQHBhcmFtIG5hbWUg5Y+Y6YeP5ZCN56ewXG4gICAqIEBwYXJhbSBtZXNzYWdlX2lkIOa2iOaBr0lE77yI5Y+v6YCJ77yM55So5LqO57K+56Gu5Yy56YWNbWVzc2FnZeexu+Wei+WPmOmHj++8iVxuICAgKiBAcmV0dXJucyDmib7liLDnmoTlj5jph4/vvIzlpoLmnpzkuI3lrZjlnKjliJnov5Tlm551bmRlZmluZWRcbiAgICovXG4gIHB1YmxpYyBmaW5kVmFyaWFibGVCeU5hbWUobmFtZTogc3RyaW5nLCBtZXNzYWdlX2lkPzogbnVtYmVyKTogVmFyaWFibGVJdGVtIHwgdW5kZWZpbmVkIHtcbiAgICBpZiAoIXRoaXMuY3VycmVudFZhcmlhYmxlcykgcmV0dXJuIHVuZGVmaW5lZDtcblxuICAgIGZvciAoY29uc3QgdmFyaWFibGUgb2YgdGhpcy5jdXJyZW50VmFyaWFibGVzKSB7XG4gICAgICBpZiAodmFyaWFibGUubmFtZSA9PT0gbmFtZSkge1xuICAgICAgICBpZiAobWVzc2FnZV9pZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgaWYgKHZhcmlhYmxlLm1lc3NhZ2VfaWQgPT09IG1lc3NhZ2VfaWQpIHtcbiAgICAgICAgICAgIHJldHVybiB2YXJpYWJsZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIHZhcmlhYmxlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICAvKipcbiAgICog5ZCM5q2l5b2T5YmN5Y+Y6YeP5YiX6KGo77yM5qC55o2u5aSW6YOo5Y+Y5YyW6L+b6KGM5aKe6YeP5pu05pawXG4gICAqIEBwYXJhbSBhZGRlZCDmlrDlop7nmoTlj5jph49cbiAgICogQHBhcmFtIHJlbW92ZWRJZHMg6KaB5Yig6Zmk55qE5Y+Y6YePSUTliJfooahcbiAgICogQHBhcmFtIHVwZGF0ZWQg6KaB5pu05paw55qE5Y+Y6YePXG4gICAqL1xuICBwdWJsaWMgc3luY0N1cnJlbnRWYXJpYWJsZXMoYWRkZWQ6IFZhcmlhYmxlSXRlbVtdLCByZW1vdmVkSWRzOiBzdHJpbmdbXSwgdXBkYXRlZDogVmFyaWFibGVJdGVtW10pOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuY3VycmVudFZhcmlhYmxlcykge1xuICAgICAgdGhpcy5jdXJyZW50VmFyaWFibGVzID0gW107XG4gICAgfVxuXG4gICAgLy8g5aSE55CG5Yig6ZmkXG4gICAgcmVtb3ZlZElkcy5mb3JFYWNoKGlkID0+IHtcbiAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5jdXJyZW50VmFyaWFibGVzIS5maW5kSW5kZXgodiA9PiB2LmlkID09PSBpZCk7XG4gICAgICBpZiAoaW5kZXggPj0gMCkge1xuICAgICAgICB0aGlzLmN1cnJlbnRWYXJpYWJsZXMhLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIHRoaXMudmFyaWFibGVJZE1hcC5kZWxldGUoaWQpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8g5aSE55CG5paw5aKeXG4gICAgYWRkZWQuZm9yRWFjaCh2YXJpYWJsZSA9PiB7XG4gICAgICB0aGlzLmN1cnJlbnRWYXJpYWJsZXMhLnB1c2godmFyaWFibGUpO1xuICAgICAgdGhpcy52YXJpYWJsZUlkTWFwLnNldCh2YXJpYWJsZS5pZCwgdmFyaWFibGUpO1xuICAgIH0pO1xuXG4gICAgLy8g5aSE55CG5pu05pawXG4gICAgdXBkYXRlZC5mb3JFYWNoKHVwZGF0ZWRWYXJpYWJsZSA9PiB7XG4gICAgICBjb25zdCBpbmRleCA9IHRoaXMuY3VycmVudFZhcmlhYmxlcyEuZmluZEluZGV4KHYgPT4gdi5pZCA9PT0gdXBkYXRlZFZhcmlhYmxlLmlkKTtcbiAgICAgIGlmIChpbmRleCA+PSAwKSB7XG4gICAgICAgIHRoaXMuY3VycmVudFZhcmlhYmxlcyFbaW5kZXhdID0gdXBkYXRlZFZhcmlhYmxlO1xuICAgICAgICB0aGlzLnZhcmlhYmxlSWRNYXAuc2V0KHVwZGF0ZWRWYXJpYWJsZS5pZCwgdXBkYXRlZFZhcmlhYmxlKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/component/variable_manager/model.ts\n\n}")},"./src/component/variable_manager/sync.ts":
/*!************************************************!*\
  !*** ./src/component/variable_manager/sync.ts ***!
  \************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VariableSyncService: () => (/* binding */ VariableSyncService)\n/* harmony export */ });\n/* harmony import */ var _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/variable_manager/util */ \"./src/component/variable_manager/util.ts\");\n/* harmony import */ var _function_variables__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/function/variables */ \"./src/function/variables.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_3__);\n\n\n\n\nconst VARIABLE_EVENTS = {\n    GLOBAL: 'settings_updated',\n    CHARACTER: 'character_variables_changed',\n    MESSAGE: 'message_variables_changed',\n    CHAT: '',\n};\nconst CHAT_POLLING_INTERVAL = 2000;\nclass VariableSyncService {\n    domUpdater;\n    model;\n    currentType = null;\n    _boundListeners = {\n        global: { bound: false, handler: this._handleVariableUpdate.bind(this, 'global') },\n        character: { bound: false, handler: this._handleVariableUpdate.bind(this, 'character') },\n        chat: { bound: false, handler: this._handleVariableUpdate.bind(this, 'chat') },\n        message: { bound: false, handler: this._handleVariableUpdate.bind(this, 'message') },\n    };\n    _chatPollingInterval = null;\n    /**\n     * @param domUpdater DOM更新器\n     * @param model 变量数据模型\n     */\n    constructor(domUpdater, model) {\n        this.domUpdater = domUpdater;\n        this.model = model;\n    }\n    async cleanup() {\n        this._unbindAllEventListeners();\n        this._stopChatPolling();\n        this.currentType = null;\n    }\n    /**\n     * 初始化当前类型\n     */\n    async initCurrentType() {\n        this.currentType = 'global';\n        this._activateCurrentListeners();\n    }\n    /**\n     * 设置当前变量类型，并相应地初始化监听器或轮询\n     * @param type 变量类型\n     */\n    async setCurrentType(type) {\n        if (this.currentType !== type) {\n            this._deactivateCurrentListeners();\n            this.currentType = type;\n            this._activateCurrentListeners();\n        }\n    }\n    /**\n     * 重新激活当前类型的监听器（用于标签页重新激活等场景）\n     */\n    reactivateListeners() {\n        this._deactivateCurrentListeners();\n        this._activateCurrentListeners();\n    }\n    /**\n     * 停用当前的事件监听器或轮询\n     */\n    deactivateListeners() {\n        this._deactivateCurrentListeners();\n    }\n    /**\n     * 激活当前类型的监听器或轮询\n     * @private\n     */\n    _activateCurrentListeners() {\n        if (this.currentType) {\n            if (this.currentType === 'chat') {\n                this._startChatPolling();\n            }\n            else {\n                this._bindVariableListener(this.currentType);\n            }\n        }\n    }\n    /**\n     * 停用当前的监听器或轮询\n     * @private\n     */\n    _deactivateCurrentListeners() {\n        this._unbindAllEventListeners();\n        this._stopChatPolling();\n    }\n    /**\n     * 统一的变量监听器绑定方法\n     * @param type 变量类型\n     * @private\n     */\n    _bindVariableListener(type) {\n        if (type === 'chat')\n            return;\n        const eventName = VARIABLE_EVENTS[type.toUpperCase()];\n        const listenerStatus = this._boundListeners[type];\n        if (!listenerStatus.bound && eventName) {\n            try {\n                _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.eventSource.on(eventName, listenerStatus.handler);\n                this._boundListeners[type].bound = true;\n                loglevel__WEBPACK_IMPORTED_MODULE_3___default().info(`[VariableManager]：开始同步监听${type}变量`);\n            }\n            catch (error) {\n                loglevel__WEBPACK_IMPORTED_MODULE_3___default().error(`[VariableManager]：绑定${type}变量事件监听器时出错:`, error);\n                this._boundListeners[type].bound = false;\n            }\n        }\n    }\n    /**\n     * 解绑所有事件监听器\n     * @private\n     */\n    _unbindAllEventListeners() {\n        for (const type of Object.keys(this._boundListeners)) {\n            if (type === 'chat')\n                continue;\n            const eventName = VARIABLE_EVENTS[type.toUpperCase()];\n            const listenerStatus = this._boundListeners[type];\n            if (listenerStatus.bound && eventName) {\n                try {\n                    _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.eventSource.removeListener(eventName, listenerStatus.handler);\n                    this._boundListeners[type].bound = false;\n                }\n                catch (error) {\n                    loglevel__WEBPACK_IMPORTED_MODULE_3___default().error(`[VariableManager]：解绑${type}变量事件监听器时出错:`, error);\n                    this._boundListeners[type].bound = false;\n                }\n            }\n        }\n    }\n    /**\n     * 启动聊天变量的轮询\n     * @private\n     */\n    _startChatPolling() {\n        this._stopChatPolling();\n        if (this.currentType === 'chat') {\n            try {\n                this._chatPollingInterval = window.setInterval(async () => {\n                    await this._handleVariableUpdate('chat');\n                }, CHAT_POLLING_INTERVAL);\n            }\n            catch (error) {\n                loglevel__WEBPACK_IMPORTED_MODULE_3___default().error('[VariableManager]：启动聊天变量轮询时出错:', error);\n                this._chatPollingInterval = null;\n            }\n        }\n    }\n    /**\n     * 停止聊天变量的轮询\n     * @private\n     */\n    _stopChatPolling() {\n        if (this._chatPollingInterval !== null) {\n            try {\n                window.clearInterval(this._chatPollingInterval);\n                this._chatPollingInterval = null;\n            }\n            catch (error) {\n                loglevel__WEBPACK_IMPORTED_MODULE_3___default().error('[VariableManager]：停止聊天变量轮询时出错:', error);\n            }\n        }\n    }\n    /**\n     * 统一的变量更新处理方法\n     * 适用于所有变量类型（全局、角色、聊天、消息）\n     * @param type 变量类型\n     * @param data 可选的事件数据\n     * @private\n     */\n    async _handleVariableUpdate(type, data) {\n        if (!this.currentType || this.currentType !== type) {\n            return;\n        }\n        try {\n            let newTavernVariables;\n            let messageId;\n            if ((type === 'character' || type === 'message') && data && data.variables) {\n                newTavernVariables = data.variables;\n                messageId = data.message_id;\n            }\n            else {\n                newTavernVariables = (0,_function_variables__WEBPACK_IMPORTED_MODULE_1__.getVariables)({ type });\n            }\n            const oldVariables = this.model.getCurrentMapVariables();\n            const { added, removed, updated } = this._compareTavernVariables(oldVariables, newTavernVariables, messageId);\n            this._processDiff(added, removed, updated, newTavernVariables, messageId);\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_3___default().error(`[VariableManager]：处理${type}变量更新时出错:`, error);\n        }\n    }\n    /**\n     * 比较当前变量与新的 TavernVariables 对象\n     * @param oldVariables 当前的变量列表\n     * @param newVars 新的变量对象\n     * @param messageId 消息ID\n     * @returns 包含已添加、已删除、已更新变量名的对象\n     * @private\n     */\n    _compareTavernVariables(oldVariables, newVars, messageId) {\n        const oldVarsMap = new Map();\n        oldVariables.forEach(variable => {\n            if (messageId !== undefined) {\n                if (variable.message_id === messageId) {\n                    oldVarsMap.set(variable.name, variable.value);\n                }\n            }\n            else if (variable.message_id === undefined) {\n                oldVarsMap.set(variable.name, variable.value);\n            }\n        });\n        const oldKeys = new Set(oldVarsMap.keys());\n        const newKeys = new Set(Object.keys(newVars));\n        const added = [...newKeys].filter(key => !oldKeys.has(key));\n        const removed = [...oldKeys].filter(key => !newKeys.has(key));\n        const updated = [...newKeys].filter(key => oldKeys.has(key) && !_.isEqual(oldVarsMap.get(key), newVars[key]));\n        return { added, removed, updated };\n    }\n    /**\n     * 处理变量差异，更新 DOM 和模型\n     * @param added 新增的变量名列表\n     * @param removed 删除的变量名列表\n     * @param updated 更新的变量名列表\n     * @param newTavernVariables 新的变量数据\n     * @param messageId 消息ID\n     * @private\n     */\n    _processDiff(added, removed, updated, newTavernVariables, messageId) {\n        const addedVariables = [];\n        const removedIds = [];\n        const updatedVariables = [];\n        added.forEach(name => {\n            const variable = this.model.createVariableItem(name, newTavernVariables[name], messageId);\n            this.domUpdater.addVariableCard(variable);\n            addedVariables.push(variable);\n        });\n        removed.forEach(name => {\n            const variable = this.model.findVariableByName(name, messageId);\n            if (variable) {\n                this.domUpdater.removeVariableCard(variable.id);\n                removedIds.push(variable.id);\n            }\n        });\n        updated.forEach(name => {\n            const variable = this.model.findVariableByName(name, messageId);\n            if (variable) {\n                variable.value = newTavernVariables[name];\n                variable.dataType = _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_0__.VariableManagerUtil.inferDataType(variable.value);\n                this.domUpdater.updateVariableCard(variable);\n                updatedVariables.push(variable);\n            }\n        });\n        this.model.syncCurrentVariables(addedVariables, removedIds, updatedVariables);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvc3luYy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFFd0U7QUFDcEI7QUFFRjtBQUV2QjtBQUUzQixNQUFNLGVBQWUsR0FBMkI7SUFDOUMsTUFBTSxFQUFFLGtCQUFrQjtJQUMxQixTQUFTLEVBQUUsNkJBQTZCO0lBQ3hDLE9BQU8sRUFBRSwyQkFBMkI7SUFDcEMsSUFBSSxFQUFFLEVBQUU7Q0FDVCxDQUFDO0FBRUYsTUFBTSxxQkFBcUIsR0FBRyxJQUFJLENBQUM7QUFhNUIsTUFBTSxtQkFBbUI7SUFDdEIsVUFBVSxDQUFjO0lBQ3hCLEtBQUssQ0FBZ0I7SUFDckIsV0FBVyxHQUF3QixJQUFJLENBQUM7SUFDeEMsZUFBZSxHQUF5QztRQUM5RCxNQUFNLEVBQUUsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRSxJQUFJLENBQUMscUJBQXFCLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxRQUFRLENBQUMsRUFBRTtRQUNsRixTQUFTLEVBQUUsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRSxJQUFJLENBQUMscUJBQXFCLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxXQUFXLENBQUMsRUFBRTtRQUN4RixJQUFJLEVBQUUsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRSxJQUFJLENBQUMscUJBQXFCLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxNQUFNLENBQUMsRUFBRTtRQUM5RSxPQUFPLEVBQUUsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRSxJQUFJLENBQUMscUJBQXFCLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxTQUFTLENBQUMsRUFBRTtLQUNyRixDQUFDO0lBRU0sb0JBQW9CLEdBQWtCLElBQUksQ0FBQztJQUVuRDs7O09BR0c7SUFDSCxZQUFZLFVBQXVCLEVBQUUsS0FBb0I7UUFDdkQsSUFBSSxDQUFDLFVBQVUsR0FBRyxVQUFVLENBQUM7UUFDN0IsSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7SUFDckIsQ0FBQztJQUVNLEtBQUssQ0FBQyxPQUFPO1FBQ2xCLElBQUksQ0FBQyx3QkFBd0IsRUFBRSxDQUFDO1FBQ2hDLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1FBQ3hCLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDO0lBQzFCLENBQUM7SUFFRDs7T0FFRztJQUNJLEtBQUssQ0FBQyxlQUFlO1FBQzFCLElBQUksQ0FBQyxXQUFXLEdBQUcsUUFBUSxDQUFDO1FBQzVCLElBQUksQ0FBQyx5QkFBeUIsRUFBRSxDQUFDO0lBQ25DLENBQUM7SUFFRDs7O09BR0c7SUFDSSxLQUFLLENBQUMsY0FBYyxDQUFDLElBQWtCO1FBQzVDLElBQUksSUFBSSxDQUFDLFdBQVcsS0FBSyxJQUFJLEVBQUUsQ0FBQztZQUM5QixJQUFJLENBQUMsMkJBQTJCLEVBQUUsQ0FBQztZQUNuQyxJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQztZQUN4QixJQUFJLENBQUMseUJBQXlCLEVBQUUsQ0FBQztRQUNuQyxDQUFDO0lBQ0gsQ0FBQztJQUVEOztPQUVHO0lBQ0ksbUJBQW1CO1FBQ3hCLElBQUksQ0FBQywyQkFBMkIsRUFBRSxDQUFDO1FBQ25DLElBQUksQ0FBQyx5QkFBeUIsRUFBRSxDQUFDO0lBQ25DLENBQUM7SUFFRDs7T0FFRztJQUNJLG1CQUFtQjtRQUN4QixJQUFJLENBQUMsMkJBQTJCLEVBQUUsQ0FBQztJQUNyQyxDQUFDO0lBRUQ7OztPQUdHO0lBQ0sseUJBQXlCO1FBQy9CLElBQUksSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQ3JCLElBQUksSUFBSSxDQUFDLFdBQVcsS0FBSyxNQUFNLEVBQUUsQ0FBQztnQkFDaEMsSUFBSSxDQUFDLGlCQUFpQixFQUFFLENBQUM7WUFDM0IsQ0FBQztpQkFBTSxDQUFDO2dCQUNOLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7WUFDL0MsQ0FBQztRQUNILENBQUM7SUFDSCxDQUFDO0lBRUQ7OztPQUdHO0lBQ0ssMkJBQTJCO1FBQ2pDLElBQUksQ0FBQyx3QkFBd0IsRUFBRSxDQUFDO1FBQ2hDLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO0lBQzFCLENBQUM7SUFFRDs7OztPQUlHO0lBQ0sscUJBQXFCLENBQUMsSUFBa0I7UUFDOUMsSUFBSSxJQUFJLEtBQUssTUFBTTtZQUFFLE9BQU87UUFFNUIsTUFBTSxTQUFTLEdBQUcsZUFBZSxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQyxDQUFDO1FBQ3RELE1BQU0sY0FBYyxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLENBQUM7UUFFbEQsSUFBSSxDQUFDLGNBQWMsQ0FBQyxLQUFLLElBQUksU0FBUyxFQUFFLENBQUM7WUFDdkMsSUFBSSxDQUFDO2dCQUNILDREQUFXLENBQUMsRUFBRSxDQUFDLFNBQVMsRUFBRSxjQUFjLENBQUMsT0FBTyxDQUFDLENBQUM7Z0JBQ2xELElBQUksQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQztnQkFDeEMsb0RBQVEsQ0FBQywyQkFBMkIsSUFBSSxJQUFJLENBQUMsQ0FBQztZQUNoRCxDQUFDO1lBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztnQkFDZixxREFBUyxDQUFDLHVCQUF1QixJQUFJLGFBQWEsRUFBRSxLQUFLLENBQUMsQ0FBQztnQkFDM0QsSUFBSSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO1lBQzNDLENBQUM7UUFDSCxDQUFDO0lBQ0gsQ0FBQztJQUVEOzs7T0FHRztJQUNLLHdCQUF3QjtRQUM5QixLQUFLLE1BQU0sSUFBSSxJQUFJLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBbUIsRUFBRSxDQUFDO1lBQ3ZFLElBQUksSUFBSSxLQUFLLE1BQU07Z0JBQUUsU0FBUztZQUU5QixNQUFNLFNBQVMsR0FBRyxlQUFlLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUM7WUFDdEQsTUFBTSxjQUFjLEdBQUcsSUFBSSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUVsRCxJQUFJLGNBQWMsQ0FBQyxLQUFLLElBQUksU0FBUyxFQUFFLENBQUM7Z0JBQ3RDLElBQUksQ0FBQztvQkFDSCw0REFBVyxDQUFDLGNBQWMsQ0FBQyxTQUFTLEVBQUUsY0FBYyxDQUFDLE9BQU8sQ0FBQyxDQUFDO29CQUM5RCxJQUFJLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7Z0JBQzNDLENBQUM7Z0JBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztvQkFDZixxREFBUyxDQUFDLHVCQUF1QixJQUFJLGFBQWEsRUFBRSxLQUFLLENBQUMsQ0FBQztvQkFDM0QsSUFBSSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO2dCQUMzQyxDQUFDO1lBQ0gsQ0FBQztRQUNILENBQUM7SUFDSCxDQUFDO0lBRUQ7OztPQUdHO0lBQ0ssaUJBQWlCO1FBQ3ZCLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1FBRXhCLElBQUksSUFBSSxDQUFDLFdBQVcsS0FBSyxNQUFNLEVBQUUsQ0FBQztZQUNoQyxJQUFJLENBQUM7Z0JBQ0gsSUFBSSxDQUFDLG9CQUFvQixHQUFHLE1BQU0sQ0FBQyxXQUFXLENBQUMsS0FBSyxJQUFJLEVBQUU7b0JBQ3hELE1BQU0sSUFBSSxDQUFDLHFCQUFxQixDQUFDLE1BQU0sQ0FBQyxDQUFDO2dCQUMzQyxDQUFDLEVBQUUscUJBQXFCLENBQUMsQ0FBQztZQUM1QixDQUFDO1lBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztnQkFDZixxREFBUyxDQUFDLGdDQUFnQyxFQUFFLEtBQUssQ0FBQyxDQUFDO2dCQUNuRCxJQUFJLENBQUMsb0JBQW9CLEdBQUcsSUFBSSxDQUFDO1lBQ25DLENBQUM7UUFDSCxDQUFDO0lBQ0gsQ0FBQztJQUVEOzs7T0FHRztJQUNLLGdCQUFnQjtRQUN0QixJQUFJLElBQUksQ0FBQyxvQkFBb0IsS0FBSyxJQUFJLEVBQUUsQ0FBQztZQUN2QyxJQUFJLENBQUM7Z0JBQ0gsTUFBTSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsb0JBQW9CLENBQUMsQ0FBQztnQkFDaEQsSUFBSSxDQUFDLG9CQUFvQixHQUFHLElBQUksQ0FBQztZQUNuQyxDQUFDO1lBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztnQkFDZixxREFBUyxDQUFDLGdDQUFnQyxFQUFFLEtBQUssQ0FBQyxDQUFDO1lBQ3JELENBQUM7UUFDSCxDQUFDO0lBQ0gsQ0FBQztJQUVEOzs7Ozs7T0FNRztJQUNLLEtBQUssQ0FBQyxxQkFBcUIsQ0FBQyxJQUFrQixFQUFFLElBQVU7UUFDaEUsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLElBQUksSUFBSSxDQUFDLFdBQVcsS0FBSyxJQUFJLEVBQUUsQ0FBQztZQUNuRCxPQUFPO1FBQ1QsQ0FBQztRQUVELElBQUksQ0FBQztZQUNILElBQUksa0JBQXVDLENBQUM7WUFDNUMsSUFBSSxTQUE2QixDQUFDO1lBRWxDLElBQUksQ0FBQyxJQUFJLEtBQUssV0FBVyxJQUFJLElBQUksS0FBSyxTQUFTLENBQUMsSUFBSSxJQUFJLElBQUksSUFBSSxDQUFDLFNBQVMsRUFBRSxDQUFDO2dCQUMzRSxrQkFBa0IsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDO2dCQUNwQyxTQUFTLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQztZQUM5QixDQUFDO2lCQUFNLENBQUM7Z0JBQ04sa0JBQWtCLEdBQUcsaUVBQVksQ0FBQyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7WUFDOUMsQ0FBQztZQUVELE1BQU0sWUFBWSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsc0JBQXNCLEVBQUUsQ0FBQztZQUV6RCxNQUFNLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRSxPQUFPLEVBQUUsR0FBRyxJQUFJLENBQUMsdUJBQXVCLENBQUMsWUFBWSxFQUFFLGtCQUFrQixFQUFFLFNBQVMsQ0FBQyxDQUFDO1lBRTlHLElBQUksQ0FBQyxZQUFZLENBQUMsS0FBSyxFQUFFLE9BQU8sRUFBRSxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsU0FBUyxDQUFDLENBQUM7UUFDNUUsQ0FBQztRQUFDLE9BQU8sS0FBSyxFQUFFLENBQUM7WUFDZixxREFBUyxDQUFDLHVCQUF1QixJQUFJLFVBQVUsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUMxRCxDQUFDO0lBQ0gsQ0FBQztJQUVEOzs7Ozs7O09BT0c7SUFDSyx1QkFBdUIsQ0FDN0IsWUFBNEIsRUFDNUIsT0FBNEIsRUFDNUIsU0FBa0I7UUFFbEIsTUFBTSxVQUFVLEdBQUcsSUFBSSxHQUFHLEVBQWUsQ0FBQztRQUUxQyxZQUFZLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxFQUFFO1lBQzlCLElBQUksU0FBUyxLQUFLLFNBQVMsRUFBRSxDQUFDO2dCQUM1QixJQUFJLFFBQVEsQ0FBQyxVQUFVLEtBQUssU0FBUyxFQUFFLENBQUM7b0JBQ3RDLFVBQVUsQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLElBQUksRUFBRSxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUM7Z0JBQ2hELENBQUM7WUFDSCxDQUFDO2lCQUFNLElBQUksUUFBUSxDQUFDLFVBQVUsS0FBSyxTQUFTLEVBQUUsQ0FBQztnQkFDN0MsVUFBVSxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFFLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUNoRCxDQUFDO1FBQ0gsQ0FBQyxDQUFDLENBQUM7UUFFSCxNQUFNLE9BQU8sR0FBRyxJQUFJLEdBQUcsQ0FBQyxVQUFVLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQztRQUMzQyxNQUFNLE9BQU8sR0FBRyxJQUFJLEdBQUcsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7UUFFOUMsTUFBTSxLQUFLLEdBQUcsQ0FBQyxHQUFHLE9BQU8sQ0FBQyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQzVELE1BQU0sT0FBTyxHQUFHLENBQUMsR0FBRyxPQUFPLENBQUMsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUM5RCxNQUFNLE9BQU8sR0FBRyxDQUFDLEdBQUcsT0FBTyxDQUFDLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsRUFBRSxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBRTlHLE9BQU8sRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxDQUFDO0lBQ3JDLENBQUM7SUFFRDs7Ozs7Ozs7T0FRRztJQUNLLFlBQVksQ0FDbEIsS0FBZSxFQUNmLE9BQWlCLEVBQ2pCLE9BQWlCLEVBQ2pCLGtCQUF1QyxFQUN2QyxTQUFrQjtRQUVsQixNQUFNLGNBQWMsR0FBbUIsRUFBRSxDQUFDO1FBQzFDLE1BQU0sVUFBVSxHQUFhLEVBQUUsQ0FBQztRQUNoQyxNQUFNLGdCQUFnQixHQUFtQixFQUFFLENBQUM7UUFFNUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFBRTtZQUNuQixNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLGtCQUFrQixDQUFDLElBQUksRUFBRSxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsRUFBRSxTQUFTLENBQUMsQ0FBQztZQUMxRixJQUFJLENBQUMsVUFBVSxDQUFDLGVBQWUsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUMxQyxjQUFjLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ2hDLENBQUMsQ0FBQyxDQUFDO1FBRUgsT0FBTyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFBRTtZQUNyQixNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLGtCQUFrQixDQUFDLElBQUksRUFBRSxTQUFTLENBQUMsQ0FBQztZQUNoRSxJQUFJLFFBQVEsRUFBRSxDQUFDO2dCQUNiLElBQUksQ0FBQyxVQUFVLENBQUMsa0JBQWtCLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxDQUFDO2dCQUNoRCxVQUFVLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQztZQUMvQixDQUFDO1FBQ0gsQ0FBQyxDQUFDLENBQUM7UUFFSCxPQUFPLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxFQUFFO1lBQ3JCLE1BQU0sUUFBUSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsa0JBQWtCLENBQUMsSUFBSSxFQUFFLFNBQVMsQ0FBQyxDQUFDO1lBQ2hFLElBQUksUUFBUSxFQUFFLENBQUM7Z0JBQ2IsUUFBUSxDQUFDLEtBQUssR0FBRyxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsQ0FBQztnQkFDMUMsUUFBUSxDQUFDLFFBQVEsR0FBRyxpRkFBbUIsQ0FBQyxhQUFhLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDO2dCQUN0RSxJQUFJLENBQUMsVUFBVSxDQUFDLGtCQUFrQixDQUFDLFFBQVEsQ0FBQyxDQUFDO2dCQUM3QyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDbEMsQ0FBQztRQUNILENBQUMsQ0FBQyxDQUFDO1FBRUgsSUFBSSxDQUFDLEtBQUssQ0FBQyxvQkFBb0IsQ0FBQyxjQUFjLEVBQUUsVUFBVSxFQUFFLGdCQUFnQixDQUFDLENBQUM7SUFDaEYsQ0FBQztDQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL3N5bmMudHM/NjdlYyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBWYXJpYWJsZU1vZGVsIH0gZnJvbSAnQC9jb21wb25lbnQvdmFyaWFibGVfbWFuYWdlci9tb2RlbCc7XG5pbXBvcnQgeyBWYXJpYWJsZUl0ZW0sIFZhcmlhYmxlVHlwZSB9IGZyb20gJ0AvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvdHlwZXMnO1xuaW1wb3J0IHsgVmFyaWFibGVNYW5hZ2VyVXRpbCB9IGZyb20gJ0AvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvdXRpbCc7XG5pbXBvcnQgeyBnZXRWYXJpYWJsZXMgfSBmcm9tICdAL2Z1bmN0aW9uL3ZhcmlhYmxlcyc7XG5cbmltcG9ydCB7IGV2ZW50U291cmNlIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5cbmltcG9ydCBsb2cgZnJvbSAnbG9nbGV2ZWwnO1xuXG5jb25zdCBWQVJJQUJMRV9FVkVOVFM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gIEdMT0JBTDogJ3NldHRpbmdzX3VwZGF0ZWQnLFxuICBDSEFSQUNURVI6ICdjaGFyYWN0ZXJfdmFyaWFibGVzX2NoYW5nZWQnLFxuICBNRVNTQUdFOiAnbWVzc2FnZV92YXJpYWJsZXNfY2hhbmdlZCcsXG4gIENIQVQ6ICcnLFxufTtcblxuY29uc3QgQ0hBVF9QT0xMSU5HX0lOVEVSVkFMID0gMjAwMDtcblxuZXhwb3J0IGludGVyZmFjZSBJRG9tVXBkYXRlciB7XG4gIGFkZFZhcmlhYmxlQ2FyZCh2YXJpYWJsZTogVmFyaWFibGVJdGVtKTogdm9pZDtcbiAgcmVtb3ZlVmFyaWFibGVDYXJkKHZhcmlhYmxlX2lkOiBzdHJpbmcpOiB2b2lkO1xuICB1cGRhdGVWYXJpYWJsZUNhcmQodmFyaWFibGU6IFZhcmlhYmxlSXRlbSk6IHZvaWQ7XG59XG5cbmludGVyZmFjZSBMaXN0ZW5lclN0YXR1cyB7XG4gIGJvdW5kOiBib29sZWFuO1xuICBoYW5kbGVyOiAoLi4uYXJnczogYW55W10pID0+IFByb21pc2U8dm9pZD47XG59XG5cbmV4cG9ydCBjbGFzcyBWYXJpYWJsZVN5bmNTZXJ2aWNlIHtcbiAgcHJpdmF0ZSBkb21VcGRhdGVyOiBJRG9tVXBkYXRlcjtcbiAgcHJpdmF0ZSBtb2RlbDogVmFyaWFibGVNb2RlbDtcbiAgcHJpdmF0ZSBjdXJyZW50VHlwZTogVmFyaWFibGVUeXBlIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgX2JvdW5kTGlzdGVuZXJzOiBSZWNvcmQ8VmFyaWFibGVUeXBlLCBMaXN0ZW5lclN0YXR1cz4gPSB7XG4gICAgZ2xvYmFsOiB7IGJvdW5kOiBmYWxzZSwgaGFuZGxlcjogdGhpcy5faGFuZGxlVmFyaWFibGVVcGRhdGUuYmluZCh0aGlzLCAnZ2xvYmFsJykgfSxcbiAgICBjaGFyYWN0ZXI6IHsgYm91bmQ6IGZhbHNlLCBoYW5kbGVyOiB0aGlzLl9oYW5kbGVWYXJpYWJsZVVwZGF0ZS5iaW5kKHRoaXMsICdjaGFyYWN0ZXInKSB9LFxuICAgIGNoYXQ6IHsgYm91bmQ6IGZhbHNlLCBoYW5kbGVyOiB0aGlzLl9oYW5kbGVWYXJpYWJsZVVwZGF0ZS5iaW5kKHRoaXMsICdjaGF0JykgfSxcbiAgICBtZXNzYWdlOiB7IGJvdW5kOiBmYWxzZSwgaGFuZGxlcjogdGhpcy5faGFuZGxlVmFyaWFibGVVcGRhdGUuYmluZCh0aGlzLCAnbWVzc2FnZScpIH0sXG4gIH07XG5cbiAgcHJpdmF0ZSBfY2hhdFBvbGxpbmdJbnRlcnZhbDogbnVtYmVyIHwgbnVsbCA9IG51bGw7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSBkb21VcGRhdGVyIERPTeabtOaWsOWZqFxuICAgKiBAcGFyYW0gbW9kZWwg5Y+Y6YeP5pWw5o2u5qih5Z6LXG4gICAqL1xuICBjb25zdHJ1Y3Rvcihkb21VcGRhdGVyOiBJRG9tVXBkYXRlciwgbW9kZWw6IFZhcmlhYmxlTW9kZWwpIHtcbiAgICB0aGlzLmRvbVVwZGF0ZXIgPSBkb21VcGRhdGVyO1xuICAgIHRoaXMubW9kZWwgPSBtb2RlbDtcbiAgfVxuXG4gIHB1YmxpYyBhc3luYyBjbGVhbnVwKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRoaXMuX3VuYmluZEFsbEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fc3RvcENoYXRQb2xsaW5nKCk7XG4gICAgdGhpcy5jdXJyZW50VHlwZSA9IG51bGw7XG4gIH1cblxuICAvKipcbiAgICog5Yid5aeL5YyW5b2T5YmN57G75Z6LXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgaW5pdEN1cnJlbnRUeXBlKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRoaXMuY3VycmVudFR5cGUgPSAnZ2xvYmFsJztcbiAgICB0aGlzLl9hY3RpdmF0ZUN1cnJlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDorr7nva7lvZPliY3lj5jph4/nsbvlnovvvIzlubbnm7jlupTlnLDliJ3lp4vljJbnm5HlkKzlmajmiJbova7or6JcbiAgICogQHBhcmFtIHR5cGUg5Y+Y6YeP57G75Z6LXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgc2V0Q3VycmVudFR5cGUodHlwZTogVmFyaWFibGVUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgaWYgKHRoaXMuY3VycmVudFR5cGUgIT09IHR5cGUpIHtcbiAgICAgIHRoaXMuX2RlYWN0aXZhdGVDdXJyZW50TGlzdGVuZXJzKCk7XG4gICAgICB0aGlzLmN1cnJlbnRUeXBlID0gdHlwZTtcbiAgICAgIHRoaXMuX2FjdGl2YXRlQ3VycmVudExpc3RlbmVycygpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDph43mlrDmv4DmtLvlvZPliY3nsbvlnovnmoTnm5HlkKzlmajvvIjnlKjkuo7moIfnrb7pobXph43mlrDmv4DmtLvnrYnlnLrmma/vvIlcbiAgICovXG4gIHB1YmxpYyByZWFjdGl2YXRlTGlzdGVuZXJzKCk6IHZvaWQge1xuICAgIHRoaXMuX2RlYWN0aXZhdGVDdXJyZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fYWN0aXZhdGVDdXJyZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICAvKipcbiAgICog5YGc55So5b2T5YmN55qE5LqL5Lu255uR5ZCs5Zmo5oiW6L2u6K+iXG4gICAqL1xuICBwdWJsaWMgZGVhY3RpdmF0ZUxpc3RlbmVycygpOiB2b2lkIHtcbiAgICB0aGlzLl9kZWFjdGl2YXRlQ3VycmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgLyoqXG4gICAqIOa/gOa0u+W9k+WJjeexu+Wei+eahOebkeWQrOWZqOaIlui9ruivolxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcHJpdmF0ZSBfYWN0aXZhdGVDdXJyZW50TGlzdGVuZXJzKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmN1cnJlbnRUeXBlKSB7XG4gICAgICBpZiAodGhpcy5jdXJyZW50VHlwZSA9PT0gJ2NoYXQnKSB7XG4gICAgICAgIHRoaXMuX3N0YXJ0Q2hhdFBvbGxpbmcoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX2JpbmRWYXJpYWJsZUxpc3RlbmVyKHRoaXMuY3VycmVudFR5cGUpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDlgZznlKjlvZPliY3nmoTnm5HlkKzlmajmiJbova7or6JcbiAgICogQHByaXZhdGVcbiAgICovXG4gIHByaXZhdGUgX2RlYWN0aXZhdGVDdXJyZW50TGlzdGVuZXJzKCk6IHZvaWQge1xuICAgIHRoaXMuX3VuYmluZEFsbEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fc3RvcENoYXRQb2xsaW5nKCk7XG4gIH1cblxuICAvKipcbiAgICog57uf5LiA55qE5Y+Y6YeP55uR5ZCs5Zmo57uR5a6a5pa55rOVXG4gICAqIEBwYXJhbSB0eXBlIOWPmOmHj+exu+Wei1xuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcHJpdmF0ZSBfYmluZFZhcmlhYmxlTGlzdGVuZXIodHlwZTogVmFyaWFibGVUeXBlKTogdm9pZCB7XG4gICAgaWYgKHR5cGUgPT09ICdjaGF0JykgcmV0dXJuO1xuXG4gICAgY29uc3QgZXZlbnROYW1lID0gVkFSSUFCTEVfRVZFTlRTW3R5cGUudG9VcHBlckNhc2UoKV07XG4gICAgY29uc3QgbGlzdGVuZXJTdGF0dXMgPSB0aGlzLl9ib3VuZExpc3RlbmVyc1t0eXBlXTtcblxuICAgIGlmICghbGlzdGVuZXJTdGF0dXMuYm91bmQgJiYgZXZlbnROYW1lKSB7XG4gICAgICB0cnkge1xuICAgICAgICBldmVudFNvdXJjZS5vbihldmVudE5hbWUsIGxpc3RlbmVyU3RhdHVzLmhhbmRsZXIpO1xuICAgICAgICB0aGlzLl9ib3VuZExpc3RlbmVyc1t0eXBlXS5ib3VuZCA9IHRydWU7XG4gICAgICAgIGxvZy5pbmZvKGBbVmFyaWFibGVNYW5hZ2VyXe+8muW8gOWni+WQjOatpeebkeWQrCR7dHlwZX3lj5jph49gKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGxvZy5lcnJvcihgW1ZhcmlhYmxlTWFuYWdlcl3vvJrnu5Hlrpoke3R5cGV95Y+Y6YeP5LqL5Lu255uR5ZCs5Zmo5pe25Ye66ZSZOmAsIGVycm9yKTtcbiAgICAgICAgdGhpcy5fYm91bmRMaXN0ZW5lcnNbdHlwZV0uYm91bmQgPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog6Kej57uR5omA5pyJ5LqL5Lu255uR5ZCs5ZmoXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBwcml2YXRlIF91bmJpbmRBbGxFdmVudExpc3RlbmVycygpOiB2b2lkIHtcbiAgICBmb3IgKGNvbnN0IHR5cGUgb2YgT2JqZWN0LmtleXModGhpcy5fYm91bmRMaXN0ZW5lcnMpIGFzIFZhcmlhYmxlVHlwZVtdKSB7XG4gICAgICBpZiAodHlwZSA9PT0gJ2NoYXQnKSBjb250aW51ZTtcblxuICAgICAgY29uc3QgZXZlbnROYW1lID0gVkFSSUFCTEVfRVZFTlRTW3R5cGUudG9VcHBlckNhc2UoKV07XG4gICAgICBjb25zdCBsaXN0ZW5lclN0YXR1cyA9IHRoaXMuX2JvdW5kTGlzdGVuZXJzW3R5cGVdO1xuXG4gICAgICBpZiAobGlzdGVuZXJTdGF0dXMuYm91bmQgJiYgZXZlbnROYW1lKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgZXZlbnRTb3VyY2UucmVtb3ZlTGlzdGVuZXIoZXZlbnROYW1lLCBsaXN0ZW5lclN0YXR1cy5oYW5kbGVyKTtcbiAgICAgICAgICB0aGlzLl9ib3VuZExpc3RlbmVyc1t0eXBlXS5ib3VuZCA9IGZhbHNlO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGxvZy5lcnJvcihgW1ZhcmlhYmxlTWFuYWdlcl3vvJrop6Pnu5Eke3R5cGV95Y+Y6YeP5LqL5Lu255uR5ZCs5Zmo5pe25Ye66ZSZOmAsIGVycm9yKTtcbiAgICAgICAgICB0aGlzLl9ib3VuZExpc3RlbmVyc1t0eXBlXS5ib3VuZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWQr+WKqOiBiuWkqeWPmOmHj+eahOi9ruivolxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcHJpdmF0ZSBfc3RhcnRDaGF0UG9sbGluZygpOiB2b2lkIHtcbiAgICB0aGlzLl9zdG9wQ2hhdFBvbGxpbmcoKTtcblxuICAgIGlmICh0aGlzLmN1cnJlbnRUeXBlID09PSAnY2hhdCcpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHRoaXMuX2NoYXRQb2xsaW5nSW50ZXJ2YWwgPSB3aW5kb3cuc2V0SW50ZXJ2YWwoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgIGF3YWl0IHRoaXMuX2hhbmRsZVZhcmlhYmxlVXBkYXRlKCdjaGF0Jyk7XG4gICAgICAgIH0sIENIQVRfUE9MTElOR19JTlRFUlZBTCk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBsb2cuZXJyb3IoJ1tWYXJpYWJsZU1hbmFnZXJd77ya5ZCv5Yqo6IGK5aSp5Y+Y6YeP6L2u6K+i5pe25Ye66ZSZOicsIGVycm9yKTtcbiAgICAgICAgdGhpcy5fY2hhdFBvbGxpbmdJbnRlcnZhbCA9IG51bGw7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWBnOatouiBiuWkqeWPmOmHj+eahOi9ruivolxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcHJpdmF0ZSBfc3RvcENoYXRQb2xsaW5nKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLl9jaGF0UG9sbGluZ0ludGVydmFsICE9PSBudWxsKSB7XG4gICAgICB0cnkge1xuICAgICAgICB3aW5kb3cuY2xlYXJJbnRlcnZhbCh0aGlzLl9jaGF0UG9sbGluZ0ludGVydmFsKTtcbiAgICAgICAgdGhpcy5fY2hhdFBvbGxpbmdJbnRlcnZhbCA9IG51bGw7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBsb2cuZXJyb3IoJ1tWYXJpYWJsZU1hbmFnZXJd77ya5YGc5q2i6IGK5aSp5Y+Y6YeP6L2u6K+i5pe25Ye66ZSZOicsIGVycm9yKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog57uf5LiA55qE5Y+Y6YeP5pu05paw5aSE55CG5pa55rOVXG4gICAqIOmAgueUqOS6juaJgOacieWPmOmHj+exu+Wei++8iOWFqOWxgOOAgeinkuiJsuOAgeiBiuWkqeOAgea2iOaBr++8iVxuICAgKiBAcGFyYW0gdHlwZSDlj5jph4/nsbvlnotcbiAgICogQHBhcmFtIGRhdGEg5Y+v6YCJ55qE5LqL5Lu25pWw5o2uXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIF9oYW5kbGVWYXJpYWJsZVVwZGF0ZSh0eXBlOiBWYXJpYWJsZVR5cGUsIGRhdGE/OiBhbnkpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAoIXRoaXMuY3VycmVudFR5cGUgfHwgdGhpcy5jdXJyZW50VHlwZSAhPT0gdHlwZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBsZXQgbmV3VGF2ZXJuVmFyaWFibGVzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xuICAgICAgbGV0IG1lc3NhZ2VJZDogbnVtYmVyIHwgdW5kZWZpbmVkO1xuXG4gICAgICBpZiAoKHR5cGUgPT09ICdjaGFyYWN0ZXInIHx8IHR5cGUgPT09ICdtZXNzYWdlJykgJiYgZGF0YSAmJiBkYXRhLnZhcmlhYmxlcykge1xuICAgICAgICBuZXdUYXZlcm5WYXJpYWJsZXMgPSBkYXRhLnZhcmlhYmxlcztcbiAgICAgICAgbWVzc2FnZUlkID0gZGF0YS5tZXNzYWdlX2lkO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbmV3VGF2ZXJuVmFyaWFibGVzID0gZ2V0VmFyaWFibGVzKHsgdHlwZSB9KTtcbiAgICAgIH1cblxuICAgICAgY29uc3Qgb2xkVmFyaWFibGVzID0gdGhpcy5tb2RlbC5nZXRDdXJyZW50TWFwVmFyaWFibGVzKCk7XG5cbiAgICAgIGNvbnN0IHsgYWRkZWQsIHJlbW92ZWQsIHVwZGF0ZWQgfSA9IHRoaXMuX2NvbXBhcmVUYXZlcm5WYXJpYWJsZXMob2xkVmFyaWFibGVzLCBuZXdUYXZlcm5WYXJpYWJsZXMsIG1lc3NhZ2VJZCk7XG5cbiAgICAgIHRoaXMuX3Byb2Nlc3NEaWZmKGFkZGVkLCByZW1vdmVkLCB1cGRhdGVkLCBuZXdUYXZlcm5WYXJpYWJsZXMsIG1lc3NhZ2VJZCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZy5lcnJvcihgW1ZhcmlhYmxlTWFuYWdlcl3vvJrlpITnkIYke3R5cGV95Y+Y6YeP5pu05paw5pe25Ye66ZSZOmAsIGVycm9yKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5q+U6L6D5b2T5YmN5Y+Y6YeP5LiO5paw55qEIFRhdmVyblZhcmlhYmxlcyDlr7nosaFcbiAgICogQHBhcmFtIG9sZFZhcmlhYmxlcyDlvZPliY3nmoTlj5jph4/liJfooahcbiAgICogQHBhcmFtIG5ld1ZhcnMg5paw55qE5Y+Y6YeP5a+56LGhXG4gICAqIEBwYXJhbSBtZXNzYWdlSWQg5raI5oGvSURcbiAgICogQHJldHVybnMg5YyF5ZCr5bey5re75Yqg44CB5bey5Yig6Zmk44CB5bey5pu05paw5Y+Y6YeP5ZCN55qE5a+56LGhXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBwcml2YXRlIF9jb21wYXJlVGF2ZXJuVmFyaWFibGVzKFxuICAgIG9sZFZhcmlhYmxlczogVmFyaWFibGVJdGVtW10sXG4gICAgbmV3VmFyczogUmVjb3JkPHN0cmluZywgYW55PixcbiAgICBtZXNzYWdlSWQ/OiBudW1iZXIsXG4gICk6IHsgYWRkZWQ6IHN0cmluZ1tdOyByZW1vdmVkOiBzdHJpbmdbXTsgdXBkYXRlZDogc3RyaW5nW10gfSB7XG4gICAgY29uc3Qgb2xkVmFyc01hcCA9IG5ldyBNYXA8c3RyaW5nLCBhbnk+KCk7XG5cbiAgICBvbGRWYXJpYWJsZXMuZm9yRWFjaCh2YXJpYWJsZSA9PiB7XG4gICAgICBpZiAobWVzc2FnZUlkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgaWYgKHZhcmlhYmxlLm1lc3NhZ2VfaWQgPT09IG1lc3NhZ2VJZCkge1xuICAgICAgICAgIG9sZFZhcnNNYXAuc2V0KHZhcmlhYmxlLm5hbWUsIHZhcmlhYmxlLnZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmICh2YXJpYWJsZS5tZXNzYWdlX2lkID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgb2xkVmFyc01hcC5zZXQodmFyaWFibGUubmFtZSwgdmFyaWFibGUudmFsdWUpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgY29uc3Qgb2xkS2V5cyA9IG5ldyBTZXQob2xkVmFyc01hcC5rZXlzKCkpO1xuICAgIGNvbnN0IG5ld0tleXMgPSBuZXcgU2V0KE9iamVjdC5rZXlzKG5ld1ZhcnMpKTtcblxuICAgIGNvbnN0IGFkZGVkID0gWy4uLm5ld0tleXNdLmZpbHRlcihrZXkgPT4gIW9sZEtleXMuaGFzKGtleSkpO1xuICAgIGNvbnN0IHJlbW92ZWQgPSBbLi4ub2xkS2V5c10uZmlsdGVyKGtleSA9PiAhbmV3S2V5cy5oYXMoa2V5KSk7XG4gICAgY29uc3QgdXBkYXRlZCA9IFsuLi5uZXdLZXlzXS5maWx0ZXIoa2V5ID0+IG9sZEtleXMuaGFzKGtleSkgJiYgIV8uaXNFcXVhbChvbGRWYXJzTWFwLmdldChrZXkpLCBuZXdWYXJzW2tleV0pKTtcblxuICAgIHJldHVybiB7IGFkZGVkLCByZW1vdmVkLCB1cGRhdGVkIH07XG4gIH1cblxuICAvKipcbiAgICog5aSE55CG5Y+Y6YeP5beu5byC77yM5pu05pawIERPTSDlkozmqKHlnotcbiAgICogQHBhcmFtIGFkZGVkIOaWsOWinueahOWPmOmHj+WQjeWIl+ihqFxuICAgKiBAcGFyYW0gcmVtb3ZlZCDliKDpmaTnmoTlj5jph4/lkI3liJfooahcbiAgICogQHBhcmFtIHVwZGF0ZWQg5pu05paw55qE5Y+Y6YeP5ZCN5YiX6KGoXG4gICAqIEBwYXJhbSBuZXdUYXZlcm5WYXJpYWJsZXMg5paw55qE5Y+Y6YeP5pWw5o2uXG4gICAqIEBwYXJhbSBtZXNzYWdlSWQg5raI5oGvSURcbiAgICogQHByaXZhdGVcbiAgICovXG4gIHByaXZhdGUgX3Byb2Nlc3NEaWZmKFxuICAgIGFkZGVkOiBzdHJpbmdbXSxcbiAgICByZW1vdmVkOiBzdHJpbmdbXSxcbiAgICB1cGRhdGVkOiBzdHJpbmdbXSxcbiAgICBuZXdUYXZlcm5WYXJpYWJsZXM6IFJlY29yZDxzdHJpbmcsIGFueT4sXG4gICAgbWVzc2FnZUlkPzogbnVtYmVyLFxuICApOiB2b2lkIHtcbiAgICBjb25zdCBhZGRlZFZhcmlhYmxlczogVmFyaWFibGVJdGVtW10gPSBbXTtcbiAgICBjb25zdCByZW1vdmVkSWRzOiBzdHJpbmdbXSA9IFtdO1xuICAgIGNvbnN0IHVwZGF0ZWRWYXJpYWJsZXM6IFZhcmlhYmxlSXRlbVtdID0gW107XG5cbiAgICBhZGRlZC5mb3JFYWNoKG5hbWUgPT4ge1xuICAgICAgY29uc3QgdmFyaWFibGUgPSB0aGlzLm1vZGVsLmNyZWF0ZVZhcmlhYmxlSXRlbShuYW1lLCBuZXdUYXZlcm5WYXJpYWJsZXNbbmFtZV0sIG1lc3NhZ2VJZCk7XG4gICAgICB0aGlzLmRvbVVwZGF0ZXIuYWRkVmFyaWFibGVDYXJkKHZhcmlhYmxlKTtcbiAgICAgIGFkZGVkVmFyaWFibGVzLnB1c2godmFyaWFibGUpO1xuICAgIH0pO1xuXG4gICAgcmVtb3ZlZC5mb3JFYWNoKG5hbWUgPT4ge1xuICAgICAgY29uc3QgdmFyaWFibGUgPSB0aGlzLm1vZGVsLmZpbmRWYXJpYWJsZUJ5TmFtZShuYW1lLCBtZXNzYWdlSWQpO1xuICAgICAgaWYgKHZhcmlhYmxlKSB7XG4gICAgICAgIHRoaXMuZG9tVXBkYXRlci5yZW1vdmVWYXJpYWJsZUNhcmQodmFyaWFibGUuaWQpO1xuICAgICAgICByZW1vdmVkSWRzLnB1c2godmFyaWFibGUuaWQpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgdXBkYXRlZC5mb3JFYWNoKG5hbWUgPT4ge1xuICAgICAgY29uc3QgdmFyaWFibGUgPSB0aGlzLm1vZGVsLmZpbmRWYXJpYWJsZUJ5TmFtZShuYW1lLCBtZXNzYWdlSWQpO1xuICAgICAgaWYgKHZhcmlhYmxlKSB7XG4gICAgICAgIHZhcmlhYmxlLnZhbHVlID0gbmV3VGF2ZXJuVmFyaWFibGVzW25hbWVdO1xuICAgICAgICB2YXJpYWJsZS5kYXRhVHlwZSA9IFZhcmlhYmxlTWFuYWdlclV0aWwuaW5mZXJEYXRhVHlwZSh2YXJpYWJsZS52YWx1ZSk7XG4gICAgICAgIHRoaXMuZG9tVXBkYXRlci51cGRhdGVWYXJpYWJsZUNhcmQodmFyaWFibGUpO1xuICAgICAgICB1cGRhdGVkVmFyaWFibGVzLnB1c2godmFyaWFibGUpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgdGhpcy5tb2RlbC5zeW5jQ3VycmVudFZhcmlhYmxlcyhhZGRlZFZhcmlhYmxlcywgcmVtb3ZlZElkcywgdXBkYXRlZFZhcmlhYmxlcyk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/component/variable_manager/sync.ts\n\n}")},"./src/component/variable_manager/util.ts":
/*!************************************************!*\
  !*** ./src/component/variable_manager/util.ts ***!
  \************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VariableManagerUtil: () => (/* binding */ VariableManagerUtil)\n/* harmony export */ });\n/**\n * 变量管理器通用工具类\n */\nclass VariableManagerUtil {\n    /**\n     * 从值推断变量数据类型\n     * @param value 要推断类型的值\n     * @returns 推断出的变量数据类型\n     */\n    static inferDataType(value) {\n        if (Array.isArray(value)) {\n            return 'array';\n        }\n        else if (typeof value === 'boolean') {\n            return 'boolean';\n        }\n        else if (typeof value === 'number') {\n            return 'number';\n        }\n        else if (typeof value === 'object' && value !== null) {\n            return 'object';\n        }\n        return 'string';\n    }\n    /**\n     * 获取数据类型的默认值\n     * @param dataType 数据类型\n     * @returns 默认值\n     */\n    static getDefaultValueForType(dataType) {\n        switch (dataType) {\n            case 'string':\n                return '';\n            case 'number':\n                return 0;\n            case 'boolean':\n                return false;\n            case 'array':\n                return [];\n            case 'object':\n                return {};\n            default:\n                return '';\n        }\n    }\n    /**\n     * 生成唯一的键名\n     * @param existingKeys 已存在的键名集合\n     * @param baseName 基础键名，默认为 'newKey'\n     * @returns 唯一键名\n     */\n    static generateUniqueKey(existingKeys, baseName = 'newKey') {\n        let newKey = baseName;\n        let counter = 1;\n        while (existingKeys.has(newKey)) {\n            newKey = `${baseName}${counter}`;\n            counter++;\n        }\n        return newKey;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvdXRpbC50cyIsIm1hcHBpbmdzIjoiOzs7O0FBRUE7O0dBRUc7QUFDSSxNQUFNLG1CQUFtQjtJQUM5Qjs7OztPQUlHO0lBQ0ksTUFBTSxDQUFDLGFBQWEsQ0FBQyxLQUFVO1FBQ3BDLElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDO1lBQ3pCLE9BQU8sT0FBTyxDQUFDO1FBQ2pCLENBQUM7YUFBTSxJQUFJLE9BQU8sS0FBSyxLQUFLLFNBQVMsRUFBRSxDQUFDO1lBQ3RDLE9BQU8sU0FBUyxDQUFDO1FBQ25CLENBQUM7YUFBTSxJQUFJLE9BQU8sS0FBSyxLQUFLLFFBQVEsRUFBRSxDQUFDO1lBQ3JDLE9BQU8sUUFBUSxDQUFDO1FBQ2xCLENBQUM7YUFBTSxJQUFJLE9BQU8sS0FBSyxLQUFLLFFBQVEsSUFBSSxLQUFLLEtBQUssSUFBSSxFQUFFLENBQUM7WUFDdkQsT0FBTyxRQUFRLENBQUM7UUFDbEIsQ0FBQztRQUNELE9BQU8sUUFBUSxDQUFDO0lBQ2xCLENBQUM7SUFFRDs7OztPQUlHO0lBQ0ksTUFBTSxDQUFDLHNCQUFzQixDQUFDLFFBQTBCO1FBQzdELFFBQVEsUUFBUSxFQUFFLENBQUM7WUFDakIsS0FBSyxRQUFRO2dCQUNYLE9BQU8sRUFBRSxDQUFDO1lBQ1osS0FBSyxRQUFRO2dCQUNYLE9BQU8sQ0FBQyxDQUFDO1lBQ1gsS0FBSyxTQUFTO2dCQUNaLE9BQU8sS0FBSyxDQUFDO1lBQ2YsS0FBSyxPQUFPO2dCQUNWLE9BQU8sRUFBRSxDQUFDO1lBQ1osS0FBSyxRQUFRO2dCQUNYLE9BQU8sRUFBRSxDQUFDO1lBQ1o7Z0JBQ0UsT0FBTyxFQUFFLENBQUM7UUFDZCxDQUFDO0lBQ0gsQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0ksTUFBTSxDQUFDLGlCQUFpQixDQUFDLFlBQXlCLEVBQUUsV0FBbUIsUUFBUTtRQUNwRixJQUFJLE1BQU0sR0FBRyxRQUFRLENBQUM7UUFDdEIsSUFBSSxPQUFPLEdBQUcsQ0FBQyxDQUFDO1FBQ2hCLE9BQU8sWUFBWSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDO1lBQ2hDLE1BQU0sR0FBRyxHQUFHLFFBQVEsR0FBRyxPQUFPLEVBQUUsQ0FBQztZQUNqQyxPQUFPLEVBQUUsQ0FBQztRQUNaLENBQUM7UUFDRCxPQUFPLE1BQU0sQ0FBQztJQUNoQixDQUFDO0NBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvdXRpbC50cz81ZWQ3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFZhcmlhYmxlRGF0YVR5cGUgfSBmcm9tICdAL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL3R5cGVzJztcblxuLyoqXG4gKiDlj5jph4/nrqHnkIblmajpgJrnlKjlt6XlhbfnsbtcbiAqL1xuZXhwb3J0IGNsYXNzIFZhcmlhYmxlTWFuYWdlclV0aWwge1xuICAvKipcbiAgICog5LuO5YC85o6o5pat5Y+Y6YeP5pWw5o2u57G75Z6LXG4gICAqIEBwYXJhbSB2YWx1ZSDopoHmjqjmlq3nsbvlnovnmoTlgLxcbiAgICogQHJldHVybnMg5o6o5pat5Ye655qE5Y+Y6YeP5pWw5o2u57G75Z6LXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGluZmVyRGF0YVR5cGUodmFsdWU6IGFueSk6IFZhcmlhYmxlRGF0YVR5cGUge1xuICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgcmV0dXJuICdhcnJheSc7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICdib29sZWFuJykge1xuICAgICAgcmV0dXJuICdib29sZWFuJztcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHtcbiAgICAgIHJldHVybiAnbnVtYmVyJztcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgIT09IG51bGwpIHtcbiAgICAgIHJldHVybiAnb2JqZWN0JztcbiAgICB9XG4gICAgcmV0dXJuICdzdHJpbmcnO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluaVsOaNruexu+Wei+eahOm7mOiupOWAvFxuICAgKiBAcGFyYW0gZGF0YVR5cGUg5pWw5o2u57G75Z6LXG4gICAqIEByZXR1cm5zIOm7mOiupOWAvFxuICAgKi9cbiAgcHVibGljIHN0YXRpYyBnZXREZWZhdWx0VmFsdWVGb3JUeXBlKGRhdGFUeXBlOiBWYXJpYWJsZURhdGFUeXBlKTogYW55IHtcbiAgICBzd2l0Y2ggKGRhdGFUeXBlKSB7XG4gICAgICBjYXNlICdzdHJpbmcnOlxuICAgICAgICByZXR1cm4gJyc7XG4gICAgICBjYXNlICdudW1iZXInOlxuICAgICAgICByZXR1cm4gMDtcbiAgICAgIGNhc2UgJ2Jvb2xlYW4nOlxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICBjYXNlICdhcnJheSc6XG4gICAgICAgIHJldHVybiBbXTtcbiAgICAgIGNhc2UgJ29iamVjdCc6XG4gICAgICAgIHJldHVybiB7fTtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiAnJztcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog55Sf5oiQ5ZSv5LiA55qE6ZSu5ZCNXG4gICAqIEBwYXJhbSBleGlzdGluZ0tleXMg5bey5a2Y5Zyo55qE6ZSu5ZCN6ZuG5ZCIXG4gICAqIEBwYXJhbSBiYXNlTmFtZSDln7rnoYDplK7lkI3vvIzpu5jorqTkuLogJ25ld0tleSdcbiAgICogQHJldHVybnMg5ZSv5LiA6ZSu5ZCNXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGdlbmVyYXRlVW5pcXVlS2V5KGV4aXN0aW5nS2V5czogU2V0PHN0cmluZz4sIGJhc2VOYW1lOiBzdHJpbmcgPSAnbmV3S2V5Jyk6IHN0cmluZyB7XG4gICAgbGV0IG5ld0tleSA9IGJhc2VOYW1lO1xuICAgIGxldCBjb3VudGVyID0gMTtcbiAgICB3aGlsZSAoZXhpc3RpbmdLZXlzLmhhcyhuZXdLZXkpKSB7XG4gICAgICBuZXdLZXkgPSBgJHtiYXNlTmFtZX0ke2NvdW50ZXJ9YDtcbiAgICAgIGNvdW50ZXIrKztcbiAgICB9XG4gICAgcmV0dXJuIG5ld0tleTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/component/variable_manager/util.ts\n\n}")},"./src/component/variable_manager/view.ts":
/*!************************************************!*\
  !*** ./src/component/variable_manager/view.ts ***!
  \************************************************/(module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VariableView: () => (/* binding */ VariableView)\n/* harmony export */ });\n/* harmony import */ var _component_variable_manager_card__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/variable_manager/card */ \"./src/component/variable_manager/card.ts\");\n/* harmony import */ var _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/component/variable_manager/util */ \"./src/component/variable_manager/util.ts\");\n/* harmony import */ var _function_util__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/function/util */ \"./src/function/util.ts\");\n/* harmony import */ var _util_floating_dialog__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/util/floating_dialog */ \"./src/util/floating_dialog.ts\");\n/* harmony import */ var _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sillytavern/scripts/popup */ \"@sillytavern/scripts/popup\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! lodash */ \"lodash\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_7__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_component_variable_manager_card__WEBPACK_IMPORTED_MODULE_0__]);\n_component_variable_manager_card__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\n\n\n\nclass VariableView {\n    /**\n     * 变量管理器浮窗ID\n     */\n    static DIALOG_ID = 'variable-manager';\n    /**\n     * UI容器\n     */\n    container;\n    /**\n     * 变量卡片\n     */\n    cardFactory;\n    /**\n     * 浮窗实例\n     */\n    dialog = null;\n    /**\n     * 控制器引用\n     */\n    controller = null;\n    /**\n     * @param container 变量管理器容器\n     */\n    constructor(container) {\n        this.container = container;\n        this.cardFactory = new _component_variable_manager_card__WEBPACK_IMPORTED_MODULE_0__.VariableCardFactory(this.showVariableTypeDialog.bind(this));\n    }\n    /**\n     * 设置控制器引用\n     * @param controller 变量控制器\n     */\n    setController(controller) {\n        this.controller = controller;\n    }\n    /**\n     * 初始化UI\n     */\n    initUI() {\n        this.container.find('#global-tab').addClass('active');\n        this.container.find('#global-content').addClass('active');\n        // 初始化时隐藏楼层筛选控件（仅在消息标签页时才显示）\n        this.container.find('#floor-filter-container').hide();\n        this.initSortable();\n        this.initFloorFilter();\n    }\n    /**\n     * 初始化可排序功能\n     */\n    initSortable() {\n        this.container.find('.list-items-container').sortable({\n            delay: (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_5__.getSortableDelay)(),\n            handle: '.drag-handle',\n            stop: function (_event, ui) {\n                const listContainer = $(ui.item).closest('.list-items-container');\n                const items = [];\n                listContainer.find('.variable-content-input').each(function () {\n                    items.push($(this).val());\n                });\n                const processedItems = lodash__WEBPACK_IMPORTED_MODULE_6___default().uniqBy(items, item => item.trim().toLowerCase());\n                if (!lodash__WEBPACK_IMPORTED_MODULE_6___default().isEqual(items, processedItems)) {\n                    listContainer.empty();\n                    processedItems.forEach(item => {\n                        const itemHtml = `\n              <div class=\"list-item\">\n                <span class=\"drag-handle\">☰</span>\n                <textarea class=\"variable-content-input\">${item}</textarea>\n                <button class=\"list-item-delete\"><i class=\"fa-solid fa-times\"></i></button>\n              </div>\n            `;\n                        listContainer.append(itemHtml);\n                    });\n                }\n                listContainer.trigger('sortupdate');\n            },\n        });\n    }\n    /**\n     * 初始化楼层筛选功能\n     */\n    initFloorFilter() {\n        this.container.find('#floor-filter-btn').on('click', () => {\n            const minInput = this.container.find('#floor-min').val();\n            const maxInput = this.container.find('#floor-max').val();\n            // 允许空值，但如果有值就必须是有效数字\n            const minVal = minInput.trim() ? parseInt(minInput, 10) : null;\n            const maxVal = maxInput.trim() ? parseInt(maxInput, 10) : null;\n            // 验证数字有效性\n            if ((minInput.trim() && isNaN(minVal)) || (maxInput.trim() && isNaN(maxVal))) {\n                this.showFloorFilterError('请输入有效的楼层数值');\n                return;\n            }\n            // 验证楼层不能小于0\n            if (minVal !== null && minVal < 0) {\n                this.showFloorFilterError('最小楼层不能小于0');\n                return;\n            }\n            if (maxVal !== null && maxVal < 0) {\n                this.showFloorFilterError('最大楼层不能小于0');\n                return;\n            }\n            // 验证范围逻辑：只有当两个值都存在时才比较大小\n            if (minVal !== null && maxVal !== null && maxVal < minVal) {\n                this.showFloorFilterError('最大楼层不能小于最小楼层');\n                return;\n            }\n            // 至少需要设置一个值\n            if (minVal === null && maxVal === null) {\n                this.showFloorFilterError('请至少设置最小楼层或最大楼层');\n                return;\n            }\n            this.hideFloorFilterError();\n        });\n        this.container.find('#floor-min, #floor-max').on('input', () => {\n            const minInput = this.container.find('#floor-min').val();\n            const maxInput = this.container.find('#floor-max').val();\n            const minVal = minInput.trim() ? parseInt(minInput, 10) : null;\n            const maxVal = maxInput.trim() ? parseInt(maxInput, 10) : null;\n            // 实时验证楼层不能小于0\n            if (minVal !== null && minVal < 0) {\n                this.showFloorFilterError('最小楼层不能小于0');\n                return;\n            }\n            if (maxVal !== null && maxVal < 0) {\n                this.showFloorFilterError('最大楼层不能小于0');\n                return;\n            }\n            // 实时验证范围逻辑\n            if (minVal !== null && maxVal !== null && !isNaN(minVal) && !isNaN(maxVal) && maxVal < minVal) {\n                this.showFloorFilterError('最大楼层不能小于最小楼层');\n            }\n            else {\n                this.hideFloorFilterError();\n            }\n        });\n    }\n    /**\n     * 显示楼层筛选错误信息\n     * @param message 错误信息\n     */\n    showFloorFilterError(message) {\n        const $errorEl = this.container.find('#floor-filter-error');\n        $errorEl.text(message).show();\n    }\n    /**\n     * 隐藏楼层筛选错误信息\n     */\n    hideFloorFilterError() {\n        this.container.find('#floor-filter-error').hide();\n    }\n    /**\n     * 更新楼层筛选输入框的值\n     * @param min 最小楼层值\n     * @param max 最大楼层值\n     */\n    updateFloorRangeInputs(min, max) {\n        this.container.find('#floor-min').val(min !== null ? min.toString() : '');\n        this.container.find('#floor-max').val(max !== null ? max.toString() : '');\n        this.hideFloorFilterError();\n    }\n    /**\n     * 获取当前活动的变量类型\n     * @returns 当前活动的变量类型\n     */\n    getActiveVariableType() {\n        return this.container.find('.tab-item.active').attr('id')?.replace('-tab', '') || 'chat';\n    }\n    /**\n     * 设置活动标签页\n     * @param type 要激活的变量类型\n     */\n    setActiveTab(type) {\n        this.container.find('.tab-item').removeClass('active');\n        this.container.find('.tab-content').removeClass('active');\n        this.container.find(`#${type}-tab`).addClass('active');\n        this.container.find(`#${type}-content`).addClass('active');\n        const $floorFilterContainer = this.container.find('#floor-filter-container');\n        if (type === 'message') {\n            $floorFilterContainer.show();\n            const [minFloor, maxFloor] = this.getFloorRange();\n            // 如果楼层范围为空，设置默认范围\n            if (minFloor === null && maxFloor === null) {\n                const lastMessageId = (0,_function_util__WEBPACK_IMPORTED_MODULE_2__.getLastMessageId)();\n                const newMinFloor = Math.max(0, lastMessageId - 4);\n                const newMaxFloor = lastMessageId;\n                this.controller.model.updateFloorRange(newMinFloor, newMaxFloor);\n                this.updateFloorRangeInputs(newMinFloor, newMaxFloor);\n            }\n        }\n        else {\n            $floorFilterContainer.hide();\n        }\n    }\n    getFloorRange() {\n        const minVal = this.container.find('#floor-min').val();\n        const maxVal = this.container.find('#floor-max').val();\n        let minFloor = minVal && minVal.trim() ? parseInt(minVal, 10) : null;\n        let maxFloor = maxVal && maxVal.trim() ? parseInt(maxVal, 10) : null;\n        // 确保楼层不小于0\n        if (minFloor !== null) {\n            minFloor = Math.max(0, minFloor);\n        }\n        if (maxFloor !== null) {\n            maxFloor = Math.max(0, maxFloor);\n        }\n        return [\n            minFloor !== null && !isNaN(minFloor) ? minFloor : null,\n            maxFloor !== null && !isNaN(maxFloor) ? maxFloor : null,\n        ];\n    }\n    /**\n     * 刷新变量卡片\n     * @param type 变量类型\n     * @param variables 过滤后的变量列表\n     */\n    refreshVariableCards(type, variables) {\n        // 更新标签文本\n        this.container.find('.variable-type-label').text(`${type}变量`);\n        // 获取当前活动的内容容器\n        const activeContent = this.container.find(`#${type}-content`);\n        const $variableList = activeContent.find('.variable-list');\n        const scrollTop = $variableList.scrollTop() || 0;\n        $variableList.empty();\n        if (variables.length === 0) {\n            $variableList.html('<div class=\"empty-state\"><p>暂无变量</p></div>');\n            return;\n        }\n        // 根据变量类型选择不同的渲染方式\n        if (type === 'message') {\n            this.renderMessageVariablesByFloor($variableList, variables);\n            $variableList.scrollTop(scrollTop);\n        }\n        else {\n            for (const variable of variables) {\n                const card = this.cardFactory.createCard(variable);\n                $variableList.append(card);\n            }\n            $variableList.scrollTop(scrollTop);\n        }\n    }\n    /**\n     * 应用筛选\n     * @param filterState 筛选状态\n     * @param searchKeyword 搜索关键字\n     */\n    applyClientSideFilters(filterState, searchKeyword) {\n        const activeType = this.getActiveVariableType();\n        const $variableCards = this.container.find(`#${activeType}-content .variable-card`);\n        let visibleCount = 0;\n        $variableCards.each((_, card) => {\n            const $card = $(card);\n            const cardType = $card.attr('data-type');\n            const cardName = $card.find('.variable-title').val() || '';\n            const typeVisible = filterState[cardType];\n            const keywordVisible = !searchKeyword || cardName.toLowerCase().includes(searchKeyword.toLowerCase());\n            if (typeVisible && keywordVisible) {\n                $card.show();\n                visibleCount++;\n            }\n            else {\n                $card.hide();\n            }\n        });\n        // 更新空状态显示\n        this.updateFilterEmptyState(activeType, visibleCount);\n    }\n    /**\n     * 更新筛选后的空状态显示\n     * @param type 变量类型\n     * @param visibleCount 可见卡片数量\n     */\n    updateFilterEmptyState(type, visibleCount) {\n        const $variableList = this.container.find(`#${type}-content .variable-list`);\n        const $existingEmptyState = $variableList.find('.filter-empty-state');\n        if (visibleCount === 0) {\n            // 检查是否有变量卡片（即使被隐藏）\n            const totalCards = $variableList.find('.variable-card').length;\n            if (totalCards > 0) {\n                if ($existingEmptyState.length === 0) {\n                    $variableList.append('<div class=\"filter-empty-state\"><p>没有符合筛选条件的变量</p></div>');\n                }\n            }\n        }\n        else {\n            $existingEmptyState.remove();\n        }\n    }\n    /**\n     * 按楼层渲染message类型的变量\n     * @param container 容器元素\n     * @param variables 变量列表\n     */\n    renderMessageVariablesByFloor(container, variables) {\n        // 按楼层分组变量\n        const floorGroups = new Map();\n        for (const variable of variables) {\n            if (variable.message_id !== undefined) {\n                if (!floorGroups.has(variable.message_id)) {\n                    floorGroups.set(variable.message_id, []);\n                }\n                floorGroups.get(variable.message_id).push(variable);\n            }\n        }\n        const sortedFloors = Array.from(floorGroups.keys()).sort((a, b) => b - a); // 降序排列，最新楼层在上\n        for (let i = 0; i < sortedFloors.length; i++) {\n            const floor = sortedFloors[i];\n            const floorVariables = floorGroups.get(floor);\n            const isExpanded = i === 0; // 只展开最新一层楼\n            const $panel = this.createFloorPanel(floor, isExpanded);\n            const $panelBody = $panel.find('.floor-panel-body');\n            for (const variable of floorVariables) {\n                const card = this.cardFactory.createCard(variable);\n                card.attr('data-floor-id', floor.toString());\n                $panelBody.append(card);\n            }\n            container.append($panel);\n        }\n    }\n    /**\n     * 创建楼层折叠面板\n     * @param floor 楼层号\n     * @param isExpanded 是否默认展开\n     * @returns 折叠面板jQuery对象\n     */\n    createFloorPanel(floor, isExpanded) {\n        const titleContent = `# ${floor} 楼`;\n        const $panel = $(`\n      <div class=\"floor-panel\" data-floor=\"${floor}\">\n        <div class=\"floor-panel-header flex spaceBetween alignItemsCenter\">\n          <div class=\"floor-panel-title\">${titleContent}</div>\n          <div class=\"floor-panel-icon ${isExpanded ? 'expanded' : ''}\">\n            <i class=\"fa-solid fa-chevron-down\"></i>\n          </div>\n        </div>\n        <div class=\"floor-panel-body ${isExpanded ? 'expanded' : ''}\"></div>\n      </div>\n    `);\n        $panel.find('.floor-panel-header').on('click', function () {\n            const $this = $(this);\n            const $icon = $this.find('.floor-panel-icon');\n            const $body = $this.closest('.floor-panel').find('.floor-panel-body');\n            $icon.toggleClass('expanded');\n            $body.toggleClass('expanded');\n        });\n        return $panel;\n    }\n    /**\n     * 创建新变量卡片\n     * @param type 变量类型\n     * @param dataType 变量数据类型\n     * @param floorId 楼层ID(仅用于message类型)\n     */\n    addNewVariableCard(type, dataType, floorId) {\n        const $content = this.container.find(`#${type}-content`).find('.variable-list');\n        $content.find('.empty-state').remove();\n        const defaultVariable = {\n            name: 'new_variable',\n            value: _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_1__.VariableManagerUtil.getDefaultValueForType(dataType),\n            dataType: dataType,\n            id: (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_5__.uuidv4)(),\n        };\n        const newCard = this.cardFactory.createCard(defaultVariable);\n        newCard.attr('data-type', dataType);\n        if (type === 'message' && floorId !== undefined) {\n            this.addCardToFloorPanel($content, newCard, floorId);\n        }\n        else {\n            $content.prepend(newCard);\n            this.addAnimation(newCard, 'variable-added', () => { });\n        }\n    }\n    /**\n     * 将卡片添加到指定楼层面板\n     * @param content 内容容器\n     * @param card 卡片元素\n     * @param floorId 楼层ID\n     */\n    addCardToFloorPanel(content, card, floorId) {\n        let $floorPanel = content.find(`.floor-panel[data-floor=\"${floorId}\"]`);\n        if ($floorPanel.length === 0) {\n            const $panel = this.createFloorPanel(floorId, true);\n            this.insertFloorPanelInOrder(content, $panel, floorId);\n            $floorPanel = $panel;\n        }\n        const $panelBody = $floorPanel.find('.floor-panel-body');\n        if (!$panelBody.hasClass('expanded')) {\n            $floorPanel.find('.floor-panel-icon').addClass('expanded');\n            $panelBody.addClass('expanded');\n        }\n        card.attr('data-floor-id', floorId.toString());\n        $panelBody.prepend(card);\n        this.addAnimation(card, 'variable-added', () => { });\n    }\n    /**\n     * 按楼层号顺序插入楼层面板\n     * @param content 内容容器\n     * @param panel 要插入的面板\n     * @param floorId 楼层ID\n     */\n    insertFloorPanelInOrder(content, panel, floorId) {\n        let inserted = false;\n        content.find('.floor-panel').each(function () {\n            const existingFloor = parseInt($(this).attr('data-floor') || '0');\n            if (floorId > existingFloor) {\n                $(this).before(panel);\n                inserted = true;\n                return false;\n            }\n            return undefined;\n        });\n        if (!inserted) {\n            content.prepend(panel);\n        }\n    }\n    /**\n     * 获取变量卡片信息\n     * @param card 卡片元素\n     * @returns 卡片中的变量信息\n     */\n    getVariableFromCard(card) {\n        return this.cardFactory.getVariableFromCard(card);\n    }\n    /**\n     * 获取变量卡片名称\n     * @param card 卡片元素\n     * @returns 卡片中的变量名称\n     */\n    getVariableCardName(card) {\n        const variable = this.getVariableFromCard(card);\n        return variable?.name || '';\n    }\n    /**\n     * 显示添加变量选择对话框\n     * @param callback 选择后的回调函数\n     */\n    async showAddVariableDialog(callback) {\n        const currentType = this.getActiveVariableType();\n        if (currentType === 'message') {\n            await this.showFloorInputDialog(async (floorId) => {\n                if (floorId === null)\n                    return;\n                await this.showVariableTypeDialog(dataType => {\n                    callback(dataType, floorId);\n                });\n            });\n            return;\n        }\n        await this.showVariableTypeDialog(dataType => {\n            callback(dataType);\n        });\n    }\n    /**\n     * 显示楼层输入对话框\n     * @param callback 输入完成后的回调函数\n     */\n    async showFloorInputDialog(callback) {\n        const content = $(`\n      <div>\n        <h3>输入楼层号码</h3>\n        <div class=\"floor-input-dialog\">\n          <input type=\"number\" id=\"floor-input\" min=\"0\" placeholder=\"请输入楼层号码\" />\n          <div id=\"floor-input-error\" class=\"floor-filter-error\" style=\"display: none\">请输入有效的楼层号码</div>\n        </div>\n      </div>\n    `);\n        const $inputField = content.find('#floor-input');\n        const $errorMsg = content.find('#floor-input-error');\n        const lastMessageId = (0,_function_util__WEBPACK_IMPORTED_MODULE_2__.getLastMessageId)();\n        if (lastMessageId >= 0) {\n            $inputField.val(lastMessageId);\n        }\n        // 添加输入验证\n        $inputField.on('input', function () {\n            const value = parseInt($(this).val(), 10);\n            if ($(this).val() && (isNaN(value) || value < 0)) {\n                $errorMsg.text('楼层号码不能小于0').show();\n            }\n            else {\n                $errorMsg.hide();\n            }\n        });\n        const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__.callGenericPopup)(content, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__.POPUP_TYPE.CONFIRM, '', {\n            okButton: '确认',\n            cancelButton: '取消',\n        });\n        if (!result) {\n            callback(null);\n            return;\n        }\n        const inputValue = $inputField.val();\n        const floorId = parseInt(inputValue, 10);\n        if (!inputValue.trim() || isNaN(floorId)) {\n            $errorMsg.text('请输入有效的楼层号码').show();\n            setTimeout(() => this.showFloorInputDialog(callback), 100);\n            return;\n        }\n        if (floorId < 0) {\n            $errorMsg.text('楼层号码不能小于0').show();\n            setTimeout(() => this.showFloorInputDialog(callback), 100);\n            return;\n        }\n        callback(floorId);\n    }\n    /**\n     * 显示变量类型选择对话框\n     * @param callback 选择后的回调函数\n     * @param floorId 楼层ID(仅用于message类型)\n     */\n    async showVariableTypeDialog(callback) {\n        const content = $(`\n      <div>\n        <h3>选择变量类型</h3>\n        <div class=\"variable-type-options\">\n          <div data-type=\"string\"><i class=\"fa-regular fa-font\"></i> 字符串</div>\n          <div data-type=\"number\"><i class=\"fa-regular fa-hashtag\"></i> 数字</div>\n          <div data-type=\"boolean\"><i class=\"fa-regular fa-toggle-on\"></i> 布尔值</div>\n          <div data-type=\"array\"><i class=\"fa-regular fa-list\"></i> 数组</div>\n          <div data-type=\"object\"><i class=\"fa-regular fa-code\"></i> 对象</div>\n        </div>\n      </div>\n    `);\n        content.find('.variable-type-options div').on('click', function () {\n            const dataType = $(this).attr('data-type');\n            callback(dataType);\n            $('.popup').find('.popup-button-close').trigger('click');\n        });\n        await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__.callGenericPopup)(content, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__.POPUP_TYPE.DISPLAY);\n    }\n    /**\n     * 显示确认对话框\n     * @param message 确认信息\n     * @param callback 确认后的回调\n     */\n    async showConfirmDialog(message, callback) {\n        const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__.callGenericPopup)(message, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__.POPUP_TYPE.CONFIRM, '', {\n            okButton: '确认',\n            cancelButton: '取消',\n        });\n        callback(!!result);\n    }\n    /**\n     * 渲染变量管理器浮窗\n     */\n    render() {\n        this.unrender();\n        const existingDialog = _util_floating_dialog__WEBPACK_IMPORTED_MODULE_3__.FloatingDialog.getInstance(VariableView.DIALOG_ID);\n        if (existingDialog) {\n            existingDialog.focus();\n            return;\n        }\n        this.dialog = _util_floating_dialog__WEBPACK_IMPORTED_MODULE_3__.FloatingDialog.create({\n            id: VariableView.DIALOG_ID,\n            title: '变量管理器',\n            width: '50vw',\n            height: '70vh',\n            mobileWidth: '80vw',\n            mobileHeight: '70vh',\n            minWidth: '15vw',\n            minHeight: '30vh',\n            mobileMinWidth: '70vw',\n            mobileMinHeight: '30vh',\n            onClose: () => {\n                this.cleanup();\n            },\n        });\n        if (this.dialog) {\n            const content = this.dialog.render();\n            content.append(this.container);\n            this.container.show();\n        }\n    }\n    /**\n     * 关闭并清理变量管理器浮窗\n     */\n    unrender() {\n        if (this.dialog) {\n            this.container.detach();\n            this.dialog.close();\n            this.dialog = null;\n        }\n    }\n    /**\n     * 清理资源\n     */\n    cleanup() {\n        if (this.controller) {\n            this.controller.cleanup();\n        }\n        this.dialog = null;\n    }\n    addVariableCard(variable) {\n        try {\n            const newCard = this.cardFactory.createCard(variable);\n            newCard.attr('data-type', variable.dataType);\n            const activeType = this.getActiveVariableType();\n            const $variableList = this.container.find(`#${activeType}-content .variable-list`);\n            if (activeType === 'message' && variable.message_id !== undefined) {\n                this.addCardToFloorPanel($variableList, newCard, variable.message_id);\n            }\n            else {\n                $variableList.find('.empty-state').remove();\n                $variableList.append(newCard);\n                this.addAnimation(newCard, 'variable-added', () => { });\n            }\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_7___default().error(`[VariableManager] 添加卡片\"${variable.name}\"失败:`, error);\n        }\n    }\n    /**\n     * 移除变量卡片\n     * @param variable_id 变量ID\n     */\n    removeVariableCard(variable_id) {\n        try {\n            if (!variable_id) {\n                loglevel__WEBPACK_IMPORTED_MODULE_7___default().warn(`[VariableManager] 变量ID为空，无法移除卡片`);\n                return;\n            }\n            const $card = this.container.find(`.variable-card[data-variable-id=\"${variable_id}\"]`);\n            if ($card.length === 0) {\n                loglevel__WEBPACK_IMPORTED_MODULE_7___default().warn(`[VariableManager] 未找到ID为\"${variable_id}\"的卡片`);\n                return;\n            }\n            this.addAnimation($card, 'variable-deleted', () => {\n                $card.remove();\n                this.checkAndShowEmptyState();\n            });\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_7___default().error(`[VariableManager] 移除卡片失败:`, error);\n        }\n    }\n    /**\n     * 检查并显示空状态提示\n     */\n    checkAndShowEmptyState() {\n        const activeType = this.getActiveVariableType();\n        const $variableList = this.container.find(`#${activeType}-content .variable-list`);\n        if ($variableList.find('.variable-card').length === 0) {\n            $variableList.html('<div class=\"empty-state\"><p>暂无变量</p></div>');\n        }\n    }\n    /**\n     * 更新变量卡片\n     * @param variable 变量\n     */\n    updateVariableCard(variable) {\n        try {\n            const $card = this.container.find(`.variable-card[data-variable-id=\"${variable.id}\"]`);\n            if ($card.length === 0) {\n                loglevel__WEBPACK_IMPORTED_MODULE_7___default().warn(`[VariableManager] 未找到ID为\"${variable.id}\"的卡片`);\n                return;\n            }\n            // 创建新卡片替换旧卡片，保持一致性\n            const newCard = this.cardFactory.createCard(variable);\n            newCard.attr('data-type', variable.dataType);\n            if (variable.message_id !== undefined) {\n                newCard.attr('data-floor-id', variable.message_id.toString());\n            }\n            $card.replaceWith(newCard);\n            this.addAnimation(newCard, 'variable-changed', () => { });\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_7___default().error(`[VariableManager] 更新卡片失败:`, error);\n        }\n    }\n    /**\n     * 显示键名输入对话框\n     * @param callback 输入完成后的回调函数\n     */\n    async showKeyNameInputDialog(callback) {\n        const content = $(`\n      <div>\n        <h3>输入键名</h3>\n        <div class=\"key-input-dialog\">\n          <input type=\"text\" id=\"key-input\" placeholder=\"请输入键名\" />\n          <div id=\"key-input-error\" class=\"input-error\" style=\"display: none\">请输入有效的键名</div>\n        </div>\n      </div>\n    `);\n        const $inputField = content.find('#key-input');\n        const $errorMsg = content.find('#key-input-error');\n        const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__.callGenericPopup)(content, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__.POPUP_TYPE.CONFIRM, '', {\n            okButton: '确认',\n            cancelButton: '取消',\n        });\n        if (!result) {\n            callback(null);\n            return;\n        }\n        const keyName = $inputField.val();\n        if (!keyName || keyName.trim() === '') {\n            $errorMsg.show();\n            setTimeout(() => this.showKeyNameInputDialog(callback), 10);\n            return;\n        }\n        callback(keyName.trim());\n    }\n    /**\n     * 添加动画效果\n     * @param element 要添加动画效果的元素\n     * @param animationClass CSS动画类名\n     * @param callback 动画结束后的回调\n     */\n    addAnimation(element, animationClass, callback) {\n        const namespace = `animation.${animationClass}`;\n        element.addClass(animationClass);\n        void element[0].offsetHeight;\n        element.off(`animationend.${namespace}`);\n        element.on(`animationend.${namespace}`, function () {\n            $(this).off(`animationend.${namespace}`);\n            $(this).removeClass(animationClass);\n            callback();\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvdmlldy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUF3RTtBQUdBO0FBQ3JCO0FBQ0s7QUFFa0I7QUFDSjtBQUMvQztBQUVJO0FBTXBCLE1BQU0sWUFBWTtJQUV2Qjs7T0FFRztJQUNLLE1BQU0sQ0FBVSxTQUFTLEdBQUcsa0JBQWtCLENBQUM7SUFFdkQ7O09BRUc7SUFDSSxTQUFTLENBQXNCO0lBRXRDOztPQUVHO0lBQ0ksV0FBVyxDQUFzQjtJQUV4Qzs7T0FFRztJQUNLLE1BQU0sR0FBMEIsSUFBSSxDQUFDO0lBRTdDOztPQUVHO0lBQ0ssVUFBVSxHQUF1QixJQUFJLENBQUM7SUFFOUM7O09BRUc7SUFDSCxZQUFZLFNBQThCO1FBQ3hDLElBQUksQ0FBQyxTQUFTLEdBQUcsU0FBUyxDQUFDO1FBQzNCLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxpRkFBbUIsQ0FBQyxJQUFJLENBQUMsc0JBQXNCLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7SUFDckYsQ0FBQztJQUVEOzs7T0FHRztJQUNJLGFBQWEsQ0FBQyxVQUF1QjtRQUMxQyxJQUFJLENBQUMsVUFBVSxHQUFHLFVBQVUsQ0FBQztJQUMvQixDQUFDO0lBRUQ7O09BRUc7SUFDSSxNQUFNO1FBQ1gsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ3RELElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBRTFELDRCQUE0QjtRQUM1QixJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDO1FBRXRELElBQUksQ0FBQyxZQUFZLEVBQUUsQ0FBQztRQUNwQixJQUFJLENBQUMsZUFBZSxFQUFFLENBQUM7SUFDekIsQ0FBQztJQUVEOztPQUVHO0lBQ0ssWUFBWTtRQUNsQixJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDLFFBQVEsQ0FBQztZQUNwRCxLQUFLLEVBQUUsNEVBQWdCLEVBQUU7WUFDekIsTUFBTSxFQUFFLGNBQWM7WUFDdEIsSUFBSSxFQUFFLFVBQVUsTUFBTSxFQUFFLEVBQUU7Z0JBQ3hCLE1BQU0sYUFBYSxHQUFHLENBQUMsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUMsT0FBTyxDQUFDLHVCQUF1QixDQUFDLENBQUM7Z0JBRWxFLE1BQU0sS0FBSyxHQUFhLEVBQUUsQ0FBQztnQkFDM0IsYUFBYSxDQUFDLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyxDQUFDLElBQUksQ0FBQztvQkFDakQsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsR0FBRyxFQUFZLENBQUMsQ0FBQztnQkFDdEMsQ0FBQyxDQUFDLENBQUM7Z0JBRUgsTUFBTSxjQUFjLEdBQUcsb0RBQVEsQ0FBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQztnQkFFMUUsSUFBSSxDQUFDLHFEQUFTLENBQUMsS0FBSyxFQUFFLGNBQWMsQ0FBQyxFQUFFLENBQUM7b0JBQ3RDLGFBQWEsQ0FBQyxLQUFLLEVBQUUsQ0FBQztvQkFDdEIsY0FBYyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFBRTt3QkFDNUIsTUFBTSxRQUFRLEdBQUc7OzsyREFHOEIsSUFBSTs7O2FBR2xELENBQUM7d0JBQ0YsYUFBYSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQztvQkFDakMsQ0FBQyxDQUFDLENBQUM7Z0JBQ0wsQ0FBQztnQkFFRCxhQUFhLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxDQUFDO1lBQ3RDLENBQUM7U0FDRixDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQ7O09BRUc7SUFDSyxlQUFlO1FBQ3JCLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLG1CQUFtQixDQUFDLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxHQUFHLEVBQUU7WUFDeEQsTUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUMsR0FBRyxFQUFZLENBQUM7WUFDbkUsTUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUMsR0FBRyxFQUFZLENBQUM7WUFFbkUscUJBQXFCO1lBQ3JCLE1BQU0sTUFBTSxHQUFHLFFBQVEsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLFFBQVEsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO1lBQy9ELE1BQU0sTUFBTSxHQUFHLFFBQVEsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLFFBQVEsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO1lBRS9ELFVBQVU7WUFDVixJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksRUFBRSxJQUFJLEtBQUssQ0FBQyxNQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksRUFBRSxJQUFJLEtBQUssQ0FBQyxNQUFPLENBQUMsQ0FBQyxFQUFFLENBQUM7Z0JBQy9FLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxZQUFZLENBQUMsQ0FBQztnQkFDeEMsT0FBTztZQUNULENBQUM7WUFFRCxZQUFZO1lBQ1osSUFBSSxNQUFNLEtBQUssSUFBSSxJQUFJLE1BQU0sR0FBRyxDQUFDLEVBQUUsQ0FBQztnQkFDbEMsSUFBSSxDQUFDLG9CQUFvQixDQUFDLFdBQVcsQ0FBQyxDQUFDO2dCQUN2QyxPQUFPO1lBQ1QsQ0FBQztZQUVELElBQUksTUFBTSxLQUFLLElBQUksSUFBSSxNQUFNLEdBQUcsQ0FBQyxFQUFFLENBQUM7Z0JBQ2xDLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxXQUFXLENBQUMsQ0FBQztnQkFDdkMsT0FBTztZQUNULENBQUM7WUFFRCx5QkFBeUI7WUFDekIsSUFBSSxNQUFNLEtBQUssSUFBSSxJQUFJLE1BQU0sS0FBSyxJQUFJLElBQUksTUFBTSxHQUFHLE1BQU0sRUFBRSxDQUFDO2dCQUMxRCxJQUFJLENBQUMsb0JBQW9CLENBQUMsY0FBYyxDQUFDLENBQUM7Z0JBQzFDLE9BQU87WUFDVCxDQUFDO1lBRUQsWUFBWTtZQUNaLElBQUksTUFBTSxLQUFLLElBQUksSUFBSSxNQUFNLEtBQUssSUFBSSxFQUFFLENBQUM7Z0JBQ3ZDLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO2dCQUM1QyxPQUFPO1lBQ1QsQ0FBQztZQUVELElBQUksQ0FBQyxvQkFBb0IsRUFBRSxDQUFDO1FBQzlCLENBQUMsQ0FBQyxDQUFDO1FBRUgsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsd0JBQXdCLENBQUMsQ0FBQyxFQUFFLENBQUMsT0FBTyxFQUFFLEdBQUcsRUFBRTtZQUM3RCxNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQyxHQUFHLEVBQVksQ0FBQztZQUNuRSxNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQyxHQUFHLEVBQVksQ0FBQztZQUVuRSxNQUFNLE1BQU0sR0FBRyxRQUFRLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxRQUFRLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztZQUMvRCxNQUFNLE1BQU0sR0FBRyxRQUFRLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxRQUFRLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztZQUUvRCxjQUFjO1lBQ2QsSUFBSSxNQUFNLEtBQUssSUFBSSxJQUFJLE1BQU0sR0FBRyxDQUFDLEVBQUUsQ0FBQztnQkFDbEMsSUFBSSxDQUFDLG9CQUFvQixDQUFDLFdBQVcsQ0FBQyxDQUFDO2dCQUN2QyxPQUFPO1lBQ1QsQ0FBQztZQUVELElBQUksTUFBTSxLQUFLLElBQUksSUFBSSxNQUFNLEdBQUcsQ0FBQyxFQUFFLENBQUM7Z0JBQ2xDLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxXQUFXLENBQUMsQ0FBQztnQkFDdkMsT0FBTztZQUNULENBQUM7WUFFRCxXQUFXO1lBQ1gsSUFBSSxNQUFNLEtBQUssSUFBSSxJQUFJLE1BQU0sS0FBSyxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLElBQUksTUFBTSxHQUFHLE1BQU0sRUFBRSxDQUFDO2dCQUM5RixJQUFJLENBQUMsb0JBQW9CLENBQUMsY0FBYyxDQUFDLENBQUM7WUFDNUMsQ0FBQztpQkFBTSxDQUFDO2dCQUNOLElBQUksQ0FBQyxvQkFBb0IsRUFBRSxDQUFDO1lBQzlCLENBQUM7UUFDSCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRDs7O09BR0c7SUFDSSxvQkFBb0IsQ0FBQyxPQUFlO1FBQ3pDLE1BQU0sUUFBUSxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLHFCQUFxQixDQUFDLENBQUM7UUFDNUQsUUFBUSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUNoQyxDQUFDO0lBRUQ7O09BRUc7SUFDSSxvQkFBb0I7UUFDekIsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMscUJBQXFCLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUNwRCxDQUFDO0lBRUQ7Ozs7T0FJRztJQUNJLHNCQUFzQixDQUFDLEdBQWtCLEVBQUUsR0FBa0I7UUFDbEUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsS0FBSyxJQUFJLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDMUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsS0FBSyxJQUFJLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDMUUsSUFBSSxDQUFDLG9CQUFvQixFQUFFLENBQUM7SUFDOUIsQ0FBQztJQUVEOzs7T0FHRztJQUNLLHFCQUFxQjtRQUMzQixPQUFRLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLGtCQUFrQixDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFLE9BQU8sQ0FBQyxNQUFNLEVBQUUsRUFBRSxDQUFrQixJQUFJLE1BQU0sQ0FBQztJQUM3RyxDQUFDO0lBRUQ7OztPQUdHO0lBQ0ksWUFBWSxDQUFDLElBQWtCO1FBQ3BDLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUN2RCxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLENBQUM7UUFFMUQsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsSUFBSSxJQUFJLE1BQU0sQ0FBQyxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUN2RCxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxJQUFJLElBQUksVUFBVSxDQUFDLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBRTNELE1BQU0scUJBQXFCLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMseUJBQXlCLENBQUMsQ0FBQztRQUM3RSxJQUFJLElBQUksS0FBSyxTQUFTLEVBQUUsQ0FBQztZQUN2QixxQkFBcUIsQ0FBQyxJQUFJLEVBQUUsQ0FBQztZQUM3QixNQUFNLENBQUMsUUFBUSxFQUFFLFFBQVEsQ0FBQyxHQUFHLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztZQUVsRCxrQkFBa0I7WUFDbEIsSUFBSSxRQUFRLEtBQUssSUFBSSxJQUFJLFFBQVEsS0FBSyxJQUFJLEVBQUUsQ0FBQztnQkFDM0MsTUFBTSxhQUFhLEdBQUcsZ0VBQWdCLEVBQUUsQ0FBQztnQkFDekMsTUFBTSxXQUFXLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsYUFBYSxHQUFHLENBQUMsQ0FBQyxDQUFDO2dCQUNuRCxNQUFNLFdBQVcsR0FBRyxhQUFhLENBQUM7Z0JBQ2pDLElBQUksQ0FBQyxVQUFrQixDQUFDLEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQyxXQUFXLEVBQUUsV0FBVyxDQUFDLENBQUM7Z0JBQzFFLElBQUksQ0FBQyxzQkFBc0IsQ0FBQyxXQUFXLEVBQUUsV0FBVyxDQUFDLENBQUM7WUFDeEQsQ0FBQztRQUNILENBQUM7YUFBTSxDQUFDO1lBQ04scUJBQXFCLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDL0IsQ0FBQztJQUNILENBQUM7SUFFTyxhQUFhO1FBQ25CLE1BQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDLEdBQUcsRUFBWSxDQUFDO1FBQ2pFLE1BQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDLEdBQUcsRUFBWSxDQUFDO1FBRWpFLElBQUksUUFBUSxHQUFHLE1BQU0sSUFBSSxNQUFNLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxNQUFNLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztRQUNyRSxJQUFJLFFBQVEsR0FBRyxNQUFNLElBQUksTUFBTSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsTUFBTSxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUM7UUFFckUsV0FBVztRQUNYLElBQUksUUFBUSxLQUFLLElBQUksRUFBRSxDQUFDO1lBQ3RCLFFBQVEsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxRQUFRLENBQUMsQ0FBQztRQUNuQyxDQUFDO1FBQ0QsSUFBSSxRQUFRLEtBQUssSUFBSSxFQUFFLENBQUM7WUFDdEIsUUFBUSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLFFBQVEsQ0FBQyxDQUFDO1FBQ25DLENBQUM7UUFFRCxPQUFPO1lBQ0wsUUFBUSxLQUFLLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxJQUFJO1lBQ3ZELFFBQVEsS0FBSyxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsSUFBSTtTQUN4RCxDQUFDO0lBQ0osQ0FBQztJQUVEOzs7O09BSUc7SUFDSSxvQkFBb0IsQ0FBQyxJQUFrQixFQUFFLFNBQXlCO1FBQ3ZFLFNBQVM7UUFDVCxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksSUFBSSxDQUFDLENBQUM7UUFFOUQsY0FBYztRQUNkLE1BQU0sYUFBYSxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLElBQUksSUFBSSxVQUFVLENBQUMsQ0FBQztRQUM5RCxNQUFNLGFBQWEsR0FBRyxhQUFhLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLENBQUM7UUFFM0QsTUFBTSxTQUFTLEdBQUcsYUFBYSxDQUFDLFNBQVMsRUFBRSxJQUFJLENBQUMsQ0FBQztRQUVqRCxhQUFhLENBQUMsS0FBSyxFQUFFLENBQUM7UUFFdEIsSUFBSSxTQUFTLENBQUMsTUFBTSxLQUFLLENBQUMsRUFBRSxDQUFDO1lBQzNCLGFBQWEsQ0FBQyxJQUFJLENBQUMsNENBQTRDLENBQUMsQ0FBQztZQUNqRSxPQUFPO1FBQ1QsQ0FBQztRQUVELGtCQUFrQjtRQUNsQixJQUFJLElBQUksS0FBSyxTQUFTLEVBQUUsQ0FBQztZQUN2QixJQUFJLENBQUMsNkJBQTZCLENBQUMsYUFBYSxFQUFFLFNBQVMsQ0FBQyxDQUFDO1lBQzdELGFBQWEsQ0FBQyxTQUFTLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDckMsQ0FBQzthQUFNLENBQUM7WUFDTixLQUFLLE1BQU0sUUFBUSxJQUFJLFNBQVMsRUFBRSxDQUFDO2dCQUNqQyxNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLFVBQVUsQ0FBQyxRQUFRLENBQUMsQ0FBQztnQkFDbkQsYUFBYSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUM3QixDQUFDO1lBQ0QsYUFBYSxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUNyQyxDQUFDO0lBQ0gsQ0FBQztJQUVEOzs7O09BSUc7SUFDSSxzQkFBc0IsQ0FBQyxXQUE4QyxFQUFFLGFBQXFCO1FBQ2pHLE1BQU0sVUFBVSxHQUFHLElBQUksQ0FBQyxxQkFBcUIsRUFBRSxDQUFDO1FBQ2hELE1BQU0sY0FBYyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLElBQUksVUFBVSx5QkFBeUIsQ0FBQyxDQUFDO1FBQ3BGLElBQUksWUFBWSxHQUFHLENBQUMsQ0FBQztRQUVyQixjQUFjLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLElBQUksRUFBRSxFQUFFO1lBQzlCLE1BQU0sS0FBSyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUN0QixNQUFNLFFBQVEsR0FBRyxLQUFLLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBcUIsQ0FBQztZQUM3RCxNQUFNLFFBQVEsR0FBSSxLQUFLLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLENBQUMsR0FBRyxFQUFhLElBQUksRUFBRSxDQUFDO1lBRXZFLE1BQU0sV0FBVyxHQUFHLFdBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUMxQyxNQUFNLGNBQWMsR0FBRyxDQUFDLGFBQWEsSUFBSSxRQUFRLENBQUMsV0FBVyxFQUFFLENBQUMsUUFBUSxDQUFDLGFBQWEsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxDQUFDO1lBRXRHLElBQUksV0FBVyxJQUFJLGNBQWMsRUFBRSxDQUFDO2dCQUNsQyxLQUFLLENBQUMsSUFBSSxFQUFFLENBQUM7Z0JBQ2IsWUFBWSxFQUFFLENBQUM7WUFDakIsQ0FBQztpQkFBTSxDQUFDO2dCQUNOLEtBQUssQ0FBQyxJQUFJLEVBQUUsQ0FBQztZQUNmLENBQUM7UUFDSCxDQUFDLENBQUMsQ0FBQztRQUVILFVBQVU7UUFDVixJQUFJLENBQUMsc0JBQXNCLENBQUMsVUFBVSxFQUFFLFlBQVksQ0FBQyxDQUFDO0lBQ3hELENBQUM7SUFFRDs7OztPQUlHO0lBQ0ssc0JBQXNCLENBQUMsSUFBa0IsRUFBRSxZQUFvQjtRQUNyRSxNQUFNLGFBQWEsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxJQUFJLElBQUkseUJBQXlCLENBQUMsQ0FBQztRQUM3RSxNQUFNLG1CQUFtQixHQUFHLGFBQWEsQ0FBQyxJQUFJLENBQUMscUJBQXFCLENBQUMsQ0FBQztRQUV0RSxJQUFJLFlBQVksS0FBSyxDQUFDLEVBQUUsQ0FBQztZQUN2QixtQkFBbUI7WUFDbkIsTUFBTSxVQUFVLEdBQUcsYUFBYSxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLE1BQU0sQ0FBQztZQUMvRCxJQUFJLFVBQVUsR0FBRyxDQUFDLEVBQUUsQ0FBQztnQkFDbkIsSUFBSSxtQkFBbUIsQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFLENBQUM7b0JBQ3JDLGFBQWEsQ0FBQyxNQUFNLENBQUMsMERBQTBELENBQUMsQ0FBQztnQkFDbkYsQ0FBQztZQUNILENBQUM7UUFDSCxDQUFDO2FBQU0sQ0FBQztZQUNOLG1CQUFtQixDQUFDLE1BQU0sRUFBRSxDQUFDO1FBQy9CLENBQUM7SUFDSCxDQUFDO0lBRUQ7Ozs7T0FJRztJQUNLLDZCQUE2QixDQUFDLFNBQThCLEVBQUUsU0FBeUI7UUFDN0YsVUFBVTtRQUNWLE1BQU0sV0FBVyxHQUFnQyxJQUFJLEdBQUcsRUFBRSxDQUFDO1FBRTNELEtBQUssTUFBTSxRQUFRLElBQUksU0FBUyxFQUFFLENBQUM7WUFDakMsSUFBSSxRQUFRLENBQUMsVUFBVSxLQUFLLFNBQVMsRUFBRSxDQUFDO2dCQUN0QyxJQUFJLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsVUFBVSxDQUFDLEVBQUUsQ0FBQztvQkFDMUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsVUFBVSxFQUFFLEVBQUUsQ0FBQyxDQUFDO2dCQUMzQyxDQUFDO2dCQUNELFdBQVcsQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLFVBQVUsQ0FBRSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUN2RCxDQUFDO1FBQ0gsQ0FBQztRQUVELE1BQU0sWUFBWSxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsY0FBYztRQUV6RixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsWUFBWSxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDO1lBQzdDLE1BQU0sS0FBSyxHQUFHLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUM5QixNQUFNLGNBQWMsR0FBRyxXQUFXLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBRSxDQUFDO1lBQy9DLE1BQU0sVUFBVSxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxXQUFXO1lBRXZDLE1BQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLLEVBQUUsVUFBVSxDQUFDLENBQUM7WUFDeEQsTUFBTSxVQUFVLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO1lBRXBELEtBQUssTUFBTSxRQUFRLElBQUksY0FBYyxFQUFFLENBQUM7Z0JBQ3RDLE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDO2dCQUNuRCxJQUFJLENBQUMsSUFBSSxDQUFDLGVBQWUsRUFBRSxLQUFLLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQztnQkFDN0MsVUFBVSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUMxQixDQUFDO1lBRUQsU0FBUyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUMzQixDQUFDO0lBQ0gsQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0ssZ0JBQWdCLENBQUMsS0FBYSxFQUFFLFVBQW1CO1FBQ3pELE1BQU0sWUFBWSxHQUFHLEtBQUssS0FBSyxJQUFJLENBQUM7UUFFcEMsTUFBTSxNQUFNLEdBQUcsQ0FBQyxDQUFDOzZDQUN3QixLQUFLOzsyQ0FFUCxZQUFZO3lDQUNkLFVBQVUsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxFQUFFOzs7O3VDQUk5QixVQUFVLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsRUFBRTs7S0FFOUQsQ0FBQyxDQUFDO1FBRUgsTUFBTSxDQUFDLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUU7WUFDN0MsTUFBTSxLQUFLLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ3RCLE1BQU0sS0FBSyxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsbUJBQW1CLENBQUMsQ0FBQztZQUM5QyxNQUFNLEtBQUssR0FBRyxLQUFLLENBQUMsT0FBTyxDQUFDLGNBQWMsQ0FBQyxDQUFDLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO1lBRXRFLEtBQUssQ0FBQyxXQUFXLENBQUMsVUFBVSxDQUFDLENBQUM7WUFDOUIsS0FBSyxDQUFDLFdBQVcsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUNoQyxDQUFDLENBQUMsQ0FBQztRQUVILE9BQU8sTUFBTSxDQUFDO0lBQ2hCLENBQUM7SUFFRDs7Ozs7T0FLRztJQUNJLGtCQUFrQixDQUFDLElBQWtCLEVBQUUsUUFBMEIsRUFBRSxPQUFnQjtRQUN4RixNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxJQUFJLElBQUksVUFBVSxDQUFDLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLENBQUM7UUFDaEYsUUFBUSxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUV2QyxNQUFNLGVBQWUsR0FBaUI7WUFDcEMsSUFBSSxFQUFFLGNBQWM7WUFDcEIsS0FBSyxFQUFFLGlGQUFtQixDQUFDLHNCQUFzQixDQUFDLFFBQVEsQ0FBQztZQUMzRCxRQUFRLEVBQUUsUUFBUTtZQUNsQixFQUFFLEVBQUUsa0VBQU0sRUFBRTtTQUNiLENBQUM7UUFFRixNQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLFVBQVUsQ0FBQyxlQUFlLENBQUMsQ0FBQztRQUM3RCxPQUFPLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxRQUFRLENBQUMsQ0FBQztRQUVwQyxJQUFJLElBQUksS0FBSyxTQUFTLElBQUksT0FBTyxLQUFLLFNBQVMsRUFBRSxDQUFDO1lBQ2hELElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxRQUFRLEVBQUUsT0FBTyxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQ3ZELENBQUM7YUFBTSxDQUFDO1lBQ04sUUFBUSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQztZQUMxQixJQUFJLENBQUMsWUFBWSxDQUFDLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxHQUFHLEVBQUUsR0FBRSxDQUFDLENBQUMsQ0FBQztRQUN6RCxDQUFDO0lBQ0gsQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0ssbUJBQW1CLENBQUMsT0FBNEIsRUFBRSxJQUF5QixFQUFFLE9BQWU7UUFDbEcsSUFBSSxXQUFXLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQyw0QkFBNEIsT0FBTyxJQUFJLENBQUMsQ0FBQztRQUV4RSxJQUFJLFdBQVcsQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFLENBQUM7WUFDN0IsTUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsQ0FBQztZQUNwRCxJQUFJLENBQUMsdUJBQXVCLENBQUMsT0FBTyxFQUFFLE1BQU0sRUFBRSxPQUFPLENBQUMsQ0FBQztZQUN2RCxXQUFXLEdBQUcsTUFBTSxDQUFDO1FBQ3ZCLENBQUM7UUFFRCxNQUFNLFVBQVUsR0FBRyxXQUFXLENBQUMsSUFBSSxDQUFDLG1CQUFtQixDQUFDLENBQUM7UUFFekQsSUFBSSxDQUFDLFVBQVUsQ0FBQyxRQUFRLENBQUMsVUFBVSxDQUFDLEVBQUUsQ0FBQztZQUNyQyxXQUFXLENBQUMsSUFBSSxDQUFDLG1CQUFtQixDQUFDLENBQUMsUUFBUSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBQzNELFVBQVUsQ0FBQyxRQUFRLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDbEMsQ0FBQztRQUVELElBQUksQ0FBQyxJQUFJLENBQUMsZUFBZSxFQUFFLE9BQU8sQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDO1FBQy9DLFVBQVUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDekIsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLEVBQUUsZ0JBQWdCLEVBQUUsR0FBRyxFQUFFLEdBQUUsQ0FBQyxDQUFDLENBQUM7SUFDdEQsQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0ssdUJBQXVCLENBQUMsT0FBNEIsRUFBRSxLQUEwQixFQUFFLE9BQWU7UUFDdkcsSUFBSSxRQUFRLEdBQUcsS0FBSyxDQUFDO1FBQ3JCLE9BQU8sQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUMsSUFBSSxDQUFDO1lBQ2hDLE1BQU0sYUFBYSxHQUFHLFFBQVEsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLEdBQUcsQ0FBQyxDQUFDO1lBQ2xFLElBQUksT0FBTyxHQUFHLGFBQWEsRUFBRSxDQUFDO2dCQUM1QixDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO2dCQUN0QixRQUFRLEdBQUcsSUFBSSxDQUFDO2dCQUNoQixPQUFPLEtBQUssQ0FBQztZQUNmLENBQUM7WUFDRCxPQUFPLFNBQVMsQ0FBQztRQUNuQixDQUFDLENBQUMsQ0FBQztRQUVILElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUNkLE9BQU8sQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDekIsQ0FBQztJQUNILENBQUM7SUFFRDs7OztPQUlHO0lBQ0ksbUJBQW1CLENBQUMsSUFBeUI7UUFDbEQsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDLG1CQUFtQixDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3BELENBQUM7SUFFRDs7OztPQUlHO0lBQ0ksbUJBQW1CLENBQUMsSUFBeUI7UUFDbEQsTUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLG1CQUFtQixDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ2hELE9BQU8sUUFBUSxFQUFFLElBQUksSUFBSSxFQUFFLENBQUM7SUFDOUIsQ0FBQztJQUVEOzs7T0FHRztJQUNJLEtBQUssQ0FBQyxxQkFBcUIsQ0FBQyxRQUFnRTtRQUNqRyxNQUFNLFdBQVcsR0FBRyxJQUFJLENBQUMscUJBQXFCLEVBQUUsQ0FBQztRQUVqRCxJQUFJLFdBQVcsS0FBSyxTQUFTLEVBQUUsQ0FBQztZQUM5QixNQUFNLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxLQUFLLEVBQUMsT0FBTyxFQUFDLEVBQUU7Z0JBQzlDLElBQUksT0FBTyxLQUFLLElBQUk7b0JBQUUsT0FBTztnQkFFN0IsTUFBTSxJQUFJLENBQUMsc0JBQXNCLENBQUMsUUFBUSxDQUFDLEVBQUU7b0JBQzNDLFFBQVEsQ0FBQyxRQUFRLEVBQUUsT0FBTyxDQUFDLENBQUM7Z0JBQzlCLENBQUMsQ0FBQyxDQUFDO1lBQ0wsQ0FBQyxDQUFDLENBQUM7WUFDSCxPQUFPO1FBQ1QsQ0FBQztRQUVELE1BQU0sSUFBSSxDQUFDLHNCQUFzQixDQUFDLFFBQVEsQ0FBQyxFQUFFO1lBQzNDLFFBQVEsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUNyQixDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRDs7O09BR0c7SUFDSSxLQUFLLENBQUMsb0JBQW9CLENBQUMsUUFBMEM7UUFDMUUsTUFBTSxPQUFPLEdBQUcsQ0FBQyxDQUFDOzs7Ozs7OztLQVFqQixDQUFDLENBQUM7UUFFSCxNQUFNLFdBQVcsR0FBRyxPQUFPLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxDQUFDO1FBQ2pELE1BQU0sU0FBUyxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsb0JBQW9CLENBQUMsQ0FBQztRQUVyRCxNQUFNLGFBQWEsR0FBRyxnRUFBZ0IsRUFBRSxDQUFDO1FBQ3pDLElBQUksYUFBYSxJQUFJLENBQUMsRUFBRSxDQUFDO1lBQ3ZCLFdBQVcsQ0FBQyxHQUFHLENBQUMsYUFBYSxDQUFDLENBQUM7UUFDakMsQ0FBQztRQUVELFNBQVM7UUFDVCxXQUFXLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRTtZQUN0QixNQUFNLEtBQUssR0FBRyxRQUFRLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsRUFBWSxFQUFFLEVBQUUsQ0FBQyxDQUFDO1lBQ3BELElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxJQUFJLEtBQUssR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDO2dCQUNqRCxTQUFTLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDO1lBQ3JDLENBQUM7aUJBQU0sQ0FBQztnQkFDTixTQUFTLENBQUMsSUFBSSxFQUFFLENBQUM7WUFDbkIsQ0FBQztRQUNILENBQUMsQ0FBQyxDQUFDO1FBRUgsTUFBTSxNQUFNLEdBQUcsTUFBTSw0RUFBZ0IsQ0FBQyxPQUFPLEVBQUUsa0VBQVUsQ0FBQyxPQUFPLEVBQUUsRUFBRSxFQUFFO1lBQ3JFLFFBQVEsRUFBRSxJQUFJO1lBQ2QsWUFBWSxFQUFFLElBQUk7U0FDbkIsQ0FBQyxDQUFDO1FBRUgsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDO1lBQ1osUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ2YsT0FBTztRQUNULENBQUM7UUFFRCxNQUFNLFVBQVUsR0FBRyxXQUFXLENBQUMsR0FBRyxFQUFZLENBQUM7UUFDL0MsTUFBTSxPQUFPLEdBQUcsUUFBUSxDQUFDLFVBQVUsRUFBRSxFQUFFLENBQUMsQ0FBQztRQUV6QyxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksRUFBRSxJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDO1lBQ3pDLFNBQVMsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUM7WUFDcEMsVUFBVSxDQUFDLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxRQUFRLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQztZQUMzRCxPQUFPO1FBQ1QsQ0FBQztRQUVELElBQUksT0FBTyxHQUFHLENBQUMsRUFBRSxDQUFDO1lBQ2hCLFNBQVMsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUM7WUFDbkMsVUFBVSxDQUFDLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxRQUFRLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQztZQUMzRCxPQUFPO1FBQ1QsQ0FBQztRQUVELFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUNwQixDQUFDO0lBRUQ7Ozs7T0FJRztJQUNJLEtBQUssQ0FBQyxzQkFBc0IsQ0FBQyxRQUE4QztRQUNoRixNQUFNLE9BQU8sR0FBRyxDQUFDLENBQUM7Ozs7Ozs7Ozs7O0tBV2pCLENBQUMsQ0FBQztRQUVILE9BQU8sQ0FBQyxJQUFJLENBQUMsNEJBQTRCLENBQUMsQ0FBQyxFQUFFLENBQUMsT0FBTyxFQUFFO1lBQ3JELE1BQU0sUUFBUSxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFxQixDQUFDO1lBQy9ELFFBQVEsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUVuQixDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsSUFBSSxDQUFDLHFCQUFxQixDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQzNELENBQUMsQ0FBQyxDQUFDO1FBRUgsTUFBTSw0RUFBZ0IsQ0FBQyxPQUFPLEVBQUUsa0VBQVUsQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUN0RCxDQUFDO0lBRUQ7Ozs7T0FJRztJQUNJLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQyxPQUFlLEVBQUUsUUFBc0M7UUFDcEYsTUFBTSxNQUFNLEdBQUcsTUFBTSw0RUFBZ0IsQ0FBQyxPQUFPLEVBQUUsa0VBQVUsQ0FBQyxPQUFPLEVBQUUsRUFBRSxFQUFFO1lBQ3JFLFFBQVEsRUFBRSxJQUFJO1lBQ2QsWUFBWSxFQUFFLElBQUk7U0FDbkIsQ0FBQyxDQUFDO1FBRUgsUUFBUSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUNyQixDQUFDO0lBRUQ7O09BRUc7SUFDSSxNQUFNO1FBQ1gsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBRWhCLE1BQU0sY0FBYyxHQUFHLGlFQUFjLENBQUMsV0FBVyxDQUFDLFlBQVksQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUMxRSxJQUFJLGNBQWMsRUFBRSxDQUFDO1lBQ25CLGNBQWMsQ0FBQyxLQUFLLEVBQUUsQ0FBQztZQUN2QixPQUFPO1FBQ1QsQ0FBQztRQUNELElBQUksQ0FBQyxNQUFNLEdBQUcsaUVBQWMsQ0FBQyxNQUFNLENBQUM7WUFDbEMsRUFBRSxFQUFFLFlBQVksQ0FBQyxTQUFTO1lBQzFCLEtBQUssRUFBRSxPQUFPO1lBQ2QsS0FBSyxFQUFFLE1BQU07WUFDYixNQUFNLEVBQUUsTUFBTTtZQUNkLFdBQVcsRUFBRSxNQUFNO1lBQ25CLFlBQVksRUFBRSxNQUFNO1lBQ3BCLFFBQVEsRUFBRSxNQUFNO1lBQ2hCLFNBQVMsRUFBRSxNQUFNO1lBQ2pCLGNBQWMsRUFBRSxNQUFNO1lBQ3RCLGVBQWUsRUFBRSxNQUFNO1lBQ3ZCLE9BQU8sRUFBRSxHQUFHLEVBQUU7Z0JBQ1osSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFDO1lBQ2pCLENBQUM7U0FDRixDQUFDLENBQUM7UUFFSCxJQUFJLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztZQUNoQixNQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sRUFBRSxDQUFDO1lBQ3JDLE9BQU8sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQy9CLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDeEIsQ0FBQztJQUNILENBQUM7SUFFRDs7T0FFRztJQUNJLFFBQVE7UUFDYixJQUFJLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztZQUNoQixJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sRUFBRSxDQUFDO1lBQ3hCLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUM7WUFDcEIsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUM7UUFDckIsQ0FBQztJQUNILENBQUM7SUFFRDs7T0FFRztJQUNLLE9BQU87UUFDYixJQUFJLElBQUksQ0FBQyxVQUFVLEVBQUUsQ0FBQztZQUNwQixJQUFJLENBQUMsVUFBVSxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBQzVCLENBQUM7UUFDRCxJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQztJQUNyQixDQUFDO0lBRU0sZUFBZSxDQUFDLFFBQXNCO1FBQzNDLElBQUksQ0FBQztZQUNILE1BQU0sT0FBTyxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBQ3RELE9BQU8sQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLFFBQVEsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUU3QyxNQUFNLFVBQVUsR0FBRyxJQUFJLENBQUMscUJBQXFCLEVBQUUsQ0FBQztZQUNoRCxNQUFNLGFBQWEsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxJQUFJLFVBQVUseUJBQXlCLENBQUMsQ0FBQztZQUVuRixJQUFJLFVBQVUsS0FBSyxTQUFTLElBQUksUUFBUSxDQUFDLFVBQVUsS0FBSyxTQUFTLEVBQUUsQ0FBQztnQkFDbEUsSUFBSSxDQUFDLG1CQUFtQixDQUFDLGFBQWEsRUFBRSxPQUFPLEVBQUUsUUFBUSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBQ3hFLENBQUM7aUJBQU0sQ0FBQztnQkFDTixhQUFhLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDO2dCQUM1QyxhQUFhLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDO2dCQUM5QixJQUFJLENBQUMsWUFBWSxDQUFDLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxHQUFHLEVBQUUsR0FBRSxDQUFDLENBQUMsQ0FBQztZQUN6RCxDQUFDO1FBQ0gsQ0FBQztRQUFDLE9BQU8sS0FBSyxFQUFFLENBQUM7WUFDZixxREFBUyxDQUFDLDBCQUEwQixRQUFRLENBQUMsSUFBSSxNQUFNLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDbEUsQ0FBQztJQUNILENBQUM7SUFFRDs7O09BR0c7SUFDSSxrQkFBa0IsQ0FBQyxXQUFtQjtRQUMzQyxJQUFJLENBQUM7WUFDSCxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7Z0JBQ2pCLG9EQUFRLENBQUMsaUNBQWlDLENBQUMsQ0FBQztnQkFDNUMsT0FBTztZQUNULENBQUM7WUFFRCxNQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxvQ0FBb0MsV0FBVyxJQUFJLENBQUMsQ0FBQztZQUV2RixJQUFJLEtBQUssQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFLENBQUM7Z0JBQ3ZCLG9EQUFRLENBQUMsNEJBQTRCLFdBQVcsTUFBTSxDQUFDLENBQUM7Z0JBQ3hELE9BQU87WUFDVCxDQUFDO1lBRUQsSUFBSSxDQUFDLFlBQVksQ0FBQyxLQUFLLEVBQUUsa0JBQWtCLEVBQUUsR0FBRyxFQUFFO2dCQUNoRCxLQUFLLENBQUMsTUFBTSxFQUFFLENBQUM7Z0JBQ2YsSUFBSSxDQUFDLHNCQUFzQixFQUFFLENBQUM7WUFDaEMsQ0FBQyxDQUFDLENBQUM7UUFDTCxDQUFDO1FBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztZQUNmLHFEQUFTLENBQUMsMkJBQTJCLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDaEQsQ0FBQztJQUNILENBQUM7SUFFRDs7T0FFRztJQUNLLHNCQUFzQjtRQUM1QixNQUFNLFVBQVUsR0FBRyxJQUFJLENBQUMscUJBQXFCLEVBQUUsQ0FBQztRQUNoRCxNQUFNLGFBQWEsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxJQUFJLFVBQVUseUJBQXlCLENBQUMsQ0FBQztRQUVuRixJQUFJLGFBQWEsQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFLENBQUM7WUFDdEQsYUFBYSxDQUFDLElBQUksQ0FBQyw0Q0FBNEMsQ0FBQyxDQUFDO1FBQ25FLENBQUM7SUFDSCxDQUFDO0lBRUQ7OztPQUdHO0lBQ0ksa0JBQWtCLENBQUMsUUFBc0I7UUFDOUMsSUFBSSxDQUFDO1lBQ0gsTUFBTSxLQUFLLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsb0NBQW9DLFFBQVEsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDO1lBRXZGLElBQUksS0FBSyxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUUsQ0FBQztnQkFDdkIsb0RBQVEsQ0FBQyw0QkFBNEIsUUFBUSxDQUFDLEVBQUUsTUFBTSxDQUFDLENBQUM7Z0JBQ3hELE9BQU87WUFDVCxDQUFDO1lBRUQsbUJBQW1CO1lBQ25CLE1BQU0sT0FBTyxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBQ3RELE9BQU8sQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLFFBQVEsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUU3QyxJQUFJLFFBQVEsQ0FBQyxVQUFVLEtBQUssU0FBUyxFQUFFLENBQUM7Z0JBQ3RDLE9BQU8sQ0FBQyxJQUFJLENBQUMsZUFBZSxFQUFFLFFBQVEsQ0FBQyxVQUFVLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQztZQUNoRSxDQUFDO1lBRUQsS0FBSyxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsQ0FBQztZQUMzQixJQUFJLENBQUMsWUFBWSxDQUFDLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxHQUFHLEVBQUUsR0FBRSxDQUFDLENBQUMsQ0FBQztRQUMzRCxDQUFDO1FBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztZQUNmLHFEQUFTLENBQUMsMkJBQTJCLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDaEQsQ0FBQztJQUNILENBQUM7SUFFRDs7O09BR0c7SUFDSSxLQUFLLENBQUMsc0JBQXNCLENBQUMsUUFBMEM7UUFDNUUsTUFBTSxPQUFPLEdBQUcsQ0FBQyxDQUFDOzs7Ozs7OztLQVFqQixDQUFDLENBQUM7UUFFSCxNQUFNLFdBQVcsR0FBRyxPQUFPLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDO1FBQy9DLE1BQU0sU0FBUyxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsa0JBQWtCLENBQUMsQ0FBQztRQUVuRCxNQUFNLE1BQU0sR0FBRyxNQUFNLDRFQUFnQixDQUFDLE9BQU8sRUFBRSxrRUFBVSxDQUFDLE9BQU8sRUFBRSxFQUFFLEVBQUU7WUFDckUsUUFBUSxFQUFFLElBQUk7WUFDZCxZQUFZLEVBQUUsSUFBSTtTQUNuQixDQUFDLENBQUM7UUFFSCxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7WUFDWixRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDZixPQUFPO1FBQ1QsQ0FBQztRQUVELE1BQU0sT0FBTyxHQUFHLFdBQVcsQ0FBQyxHQUFHLEVBQVksQ0FBQztRQUM1QyxJQUFJLENBQUMsT0FBTyxJQUFJLE9BQU8sQ0FBQyxJQUFJLEVBQUUsS0FBSyxFQUFFLEVBQUUsQ0FBQztZQUN0QyxTQUFTLENBQUMsSUFBSSxFQUFFLENBQUM7WUFDakIsVUFBVSxDQUFDLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQyxzQkFBc0IsQ0FBQyxRQUFRLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztZQUM1RCxPQUFPO1FBQ1QsQ0FBQztRQUVELFFBQVEsQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQztJQUMzQixDQUFDO0lBRUQ7Ozs7O09BS0c7SUFDSSxZQUFZLENBQUMsT0FBNEIsRUFBRSxjQUFzQixFQUFFLFFBQW9CO1FBQzVGLE1BQU0sU0FBUyxHQUFHLGFBQWEsY0FBYyxFQUFFLENBQUM7UUFFaEQsT0FBTyxDQUFDLFFBQVEsQ0FBQyxjQUFjLENBQUMsQ0FBQztRQUVqQyxLQUFLLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxZQUFZLENBQUM7UUFFN0IsT0FBTyxDQUFDLEdBQUcsQ0FBQyxnQkFBZ0IsU0FBUyxFQUFFLENBQUMsQ0FBQztRQUV6QyxPQUFPLENBQUMsRUFBRSxDQUFDLGdCQUFnQixTQUFTLEVBQUUsRUFBRTtZQUN0QyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFDLGdCQUFnQixTQUFTLEVBQUUsQ0FBQyxDQUFDO1lBQ3pDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxXQUFXLENBQUMsY0FBYyxDQUFDLENBQUM7WUFDcEMsUUFBUSxFQUFFLENBQUM7UUFDYixDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvdmlldy50cz81ZGI1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFZhcmlhYmxlQ2FyZEZhY3RvcnkgfSBmcm9tICdAL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL2NhcmQnO1xuaW1wb3J0IHsgSURvbVVwZGF0ZXIgfSBmcm9tICdAL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL3N5bmMnO1xuaW1wb3J0IHsgVmFyaWFibGVEYXRhVHlwZSwgVmFyaWFibGVJdGVtLCBWYXJpYWJsZVR5cGUgfSBmcm9tICdAL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL3R5cGVzJztcbmltcG9ydCB7IFZhcmlhYmxlTWFuYWdlclV0aWwgfSBmcm9tICdAL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL3V0aWwnO1xuaW1wb3J0IHsgZ2V0TGFzdE1lc3NhZ2VJZCB9IGZyb20gJ0AvZnVuY3Rpb24vdXRpbCc7XG5pbXBvcnQgeyBGbG9hdGluZ0RpYWxvZyB9IGZyb20gJ0AvdXRpbC9mbG9hdGluZ19kaWFsb2cnO1xuXG5pbXBvcnQgeyBQT1BVUF9UWVBFLCBjYWxsR2VuZXJpY1BvcHVwIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvcG9wdXAnO1xuaW1wb3J0IHsgZ2V0U29ydGFibGVEZWxheSwgdXVpZHY0IH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvdXRpbHMnO1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJztcblxuaW1wb3J0IGxvZyBmcm9tICdsb2dsZXZlbCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUNvbnRyb2xsZXIge1xuICBjbGVhbnVwKCk6IHZvaWQ7XG59XG5cbmV4cG9ydCBjbGFzcyBWYXJpYWJsZVZpZXcgaW1wbGVtZW50cyBJRG9tVXBkYXRlciB7XG5cbiAgLyoqXG4gICAqIOWPmOmHj+euoeeQhuWZqOa1rueql0lEXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBESUFMT0dfSUQgPSAndmFyaWFibGUtbWFuYWdlcic7XG5cbiAgLyoqXG4gICAqIFVJ5a655ZmoXG4gICAqL1xuICBwdWJsaWMgY29udGFpbmVyOiBKUXVlcnk8SFRNTEVsZW1lbnQ+O1xuXG4gIC8qKlxuICAgKiDlj5jph4/ljaHniYdcbiAgICovXG4gIHB1YmxpYyBjYXJkRmFjdG9yeTogVmFyaWFibGVDYXJkRmFjdG9yeTtcblxuICAvKipcbiAgICog5rWu56qX5a6e5L6LXG4gICAqL1xuICBwcml2YXRlIGRpYWxvZzogRmxvYXRpbmdEaWFsb2cgfCBudWxsID0gbnVsbDtcblxuICAvKipcbiAgICog5o6n5Yi25Zmo5byV55SoXG4gICAqL1xuICBwcml2YXRlIGNvbnRyb2xsZXI6IElDb250cm9sbGVyIHwgbnVsbCA9IG51bGw7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSBjb250YWluZXIg5Y+Y6YeP566h55CG5Zmo5a655ZmoXG4gICAqL1xuICBjb25zdHJ1Y3Rvcihjb250YWluZXI6IEpRdWVyeTxIVE1MRWxlbWVudD4pIHtcbiAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcbiAgICB0aGlzLmNhcmRGYWN0b3J5ID0gbmV3IFZhcmlhYmxlQ2FyZEZhY3RvcnkodGhpcy5zaG93VmFyaWFibGVUeXBlRGlhbG9nLmJpbmQodGhpcykpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiuvue9ruaOp+WItuWZqOW8leeUqFxuICAgKiBAcGFyYW0gY29udHJvbGxlciDlj5jph4/mjqfliLblmahcbiAgICovXG4gIHB1YmxpYyBzZXRDb250cm9sbGVyKGNvbnRyb2xsZXI6IElDb250cm9sbGVyKTogdm9pZCB7XG4gICAgdGhpcy5jb250cm9sbGVyID0gY29udHJvbGxlcjtcbiAgfVxuXG4gIC8qKlxuICAgKiDliJ3lp4vljJZVSVxuICAgKi9cbiAgcHVibGljIGluaXRVSSgpOiB2b2lkIHtcbiAgICB0aGlzLmNvbnRhaW5lci5maW5kKCcjZ2xvYmFsLXRhYicpLmFkZENsYXNzKCdhY3RpdmUnKTtcbiAgICB0aGlzLmNvbnRhaW5lci5maW5kKCcjZ2xvYmFsLWNvbnRlbnQnKS5hZGRDbGFzcygnYWN0aXZlJyk7XG5cbiAgICAvLyDliJ3lp4vljJbml7bpmpDol4/mpbzlsYLnrZvpgInmjqfku7bvvIjku4XlnKjmtojmga/moIfnrb7pobXml7bmiY3mmL7npLrvvIlcbiAgICB0aGlzLmNvbnRhaW5lci5maW5kKCcjZmxvb3ItZmlsdGVyLWNvbnRhaW5lcicpLmhpZGUoKTtcblxuICAgIHRoaXMuaW5pdFNvcnRhYmxlKCk7XG4gICAgdGhpcy5pbml0Rmxvb3JGaWx0ZXIoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDliJ3lp4vljJblj6/mjpLluo/lip/og71cbiAgICovXG4gIHByaXZhdGUgaW5pdFNvcnRhYmxlKCk6IHZvaWQge1xuICAgIHRoaXMuY29udGFpbmVyLmZpbmQoJy5saXN0LWl0ZW1zLWNvbnRhaW5lcicpLnNvcnRhYmxlKHtcbiAgICAgIGRlbGF5OiBnZXRTb3J0YWJsZURlbGF5KCksXG4gICAgICBoYW5kbGU6ICcuZHJhZy1oYW5kbGUnLFxuICAgICAgc3RvcDogZnVuY3Rpb24gKF9ldmVudCwgdWkpIHtcbiAgICAgICAgY29uc3QgbGlzdENvbnRhaW5lciA9ICQodWkuaXRlbSkuY2xvc2VzdCgnLmxpc3QtaXRlbXMtY29udGFpbmVyJyk7XG5cbiAgICAgICAgY29uc3QgaXRlbXM6IHN0cmluZ1tdID0gW107XG4gICAgICAgIGxpc3RDb250YWluZXIuZmluZCgnLnZhcmlhYmxlLWNvbnRlbnQtaW5wdXQnKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBpdGVtcy5wdXNoKCQodGhpcykudmFsKCkgYXMgc3RyaW5nKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgcHJvY2Vzc2VkSXRlbXMgPSBfLnVuaXFCeShpdGVtcywgaXRlbSA9PiBpdGVtLnRyaW0oKS50b0xvd2VyQ2FzZSgpKTtcblxuICAgICAgICBpZiAoIV8uaXNFcXVhbChpdGVtcywgcHJvY2Vzc2VkSXRlbXMpKSB7XG4gICAgICAgICAgbGlzdENvbnRhaW5lci5lbXB0eSgpO1xuICAgICAgICAgIHByb2Nlc3NlZEl0ZW1zLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpdGVtSHRtbCA9IGBcbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImxpc3QtaXRlbVwiPlxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZHJhZy1oYW5kbGVcIj7imLA8L3NwYW4+XG4gICAgICAgICAgICAgICAgPHRleHRhcmVhIGNsYXNzPVwidmFyaWFibGUtY29udGVudC1pbnB1dFwiPiR7aXRlbX08L3RleHRhcmVhPlxuICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJsaXN0LWl0ZW0tZGVsZXRlXCI+PGkgY2xhc3M9XCJmYS1zb2xpZCBmYS10aW1lc1wiPjwvaT48L2J1dHRvbj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICBgO1xuICAgICAgICAgICAgbGlzdENvbnRhaW5lci5hcHBlbmQoaXRlbUh0bWwpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgbGlzdENvbnRhaW5lci50cmlnZ2VyKCdzb3J0dXBkYXRlJyk7XG4gICAgICB9LFxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOWIneWni+WMlualvOWxguetm+mAieWKn+iDvVxuICAgKi9cbiAgcHJpdmF0ZSBpbml0Rmxvb3JGaWx0ZXIoKTogdm9pZCB7XG4gICAgdGhpcy5jb250YWluZXIuZmluZCgnI2Zsb29yLWZpbHRlci1idG4nKS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICBjb25zdCBtaW5JbnB1dCA9IHRoaXMuY29udGFpbmVyLmZpbmQoJyNmbG9vci1taW4nKS52YWwoKSBhcyBzdHJpbmc7XG4gICAgICBjb25zdCBtYXhJbnB1dCA9IHRoaXMuY29udGFpbmVyLmZpbmQoJyNmbG9vci1tYXgnKS52YWwoKSBhcyBzdHJpbmc7XG5cbiAgICAgIC8vIOWFgeiuuOepuuWAvO+8jOS9huWmguaenOacieWAvOWwseW/hemhu+aYr+acieaViOaVsOWtl1xuICAgICAgY29uc3QgbWluVmFsID0gbWluSW5wdXQudHJpbSgpID8gcGFyc2VJbnQobWluSW5wdXQsIDEwKSA6IG51bGw7XG4gICAgICBjb25zdCBtYXhWYWwgPSBtYXhJbnB1dC50cmltKCkgPyBwYXJzZUludChtYXhJbnB1dCwgMTApIDogbnVsbDtcblxuICAgICAgLy8g6aqM6K+B5pWw5a2X5pyJ5pWI5oCnXG4gICAgICBpZiAoKG1pbklucHV0LnRyaW0oKSAmJiBpc05hTihtaW5WYWwhKSkgfHwgKG1heElucHV0LnRyaW0oKSAmJiBpc05hTihtYXhWYWwhKSkpIHtcbiAgICAgICAgdGhpcy5zaG93Rmxvb3JGaWx0ZXJFcnJvcign6K+36L6T5YWl5pyJ5pWI55qE5qW85bGC5pWw5YC8Jyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8g6aqM6K+B5qW85bGC5LiN6IO95bCP5LqOMFxuICAgICAgaWYgKG1pblZhbCAhPT0gbnVsbCAmJiBtaW5WYWwgPCAwKSB7XG4gICAgICAgIHRoaXMuc2hvd0Zsb29yRmlsdGVyRXJyb3IoJ+acgOWwj+alvOWxguS4jeiDveWwj+S6jjAnKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAobWF4VmFsICE9PSBudWxsICYmIG1heFZhbCA8IDApIHtcbiAgICAgICAgdGhpcy5zaG93Rmxvb3JGaWx0ZXJFcnJvcign5pyA5aSn5qW85bGC5LiN6IO95bCP5LqOMCcpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIOmqjOivgeiMg+WbtOmAu+i+ke+8muWPquacieW9k+S4pOS4quWAvOmDveWtmOWcqOaXtuaJjeavlOi+g+Wkp+Wwj1xuICAgICAgaWYgKG1pblZhbCAhPT0gbnVsbCAmJiBtYXhWYWwgIT09IG51bGwgJiYgbWF4VmFsIDwgbWluVmFsKSB7XG4gICAgICAgIHRoaXMuc2hvd0Zsb29yRmlsdGVyRXJyb3IoJ+acgOWkp+alvOWxguS4jeiDveWwj+S6juacgOWwj+alvOWxgicpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIOiHs+WwkemcgOimgeiuvue9ruS4gOS4quWAvFxuICAgICAgaWYgKG1pblZhbCA9PT0gbnVsbCAmJiBtYXhWYWwgPT09IG51bGwpIHtcbiAgICAgICAgdGhpcy5zaG93Rmxvb3JGaWx0ZXJFcnJvcign6K+36Iez5bCR6K6+572u5pyA5bCP5qW85bGC5oiW5pyA5aSn5qW85bGCJyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdGhpcy5oaWRlRmxvb3JGaWx0ZXJFcnJvcigpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5jb250YWluZXIuZmluZCgnI2Zsb29yLW1pbiwgI2Zsb29yLW1heCcpLm9uKCdpbnB1dCcsICgpID0+IHtcbiAgICAgIGNvbnN0IG1pbklucHV0ID0gdGhpcy5jb250YWluZXIuZmluZCgnI2Zsb29yLW1pbicpLnZhbCgpIGFzIHN0cmluZztcbiAgICAgIGNvbnN0IG1heElucHV0ID0gdGhpcy5jb250YWluZXIuZmluZCgnI2Zsb29yLW1heCcpLnZhbCgpIGFzIHN0cmluZztcblxuICAgICAgY29uc3QgbWluVmFsID0gbWluSW5wdXQudHJpbSgpID8gcGFyc2VJbnQobWluSW5wdXQsIDEwKSA6IG51bGw7XG4gICAgICBjb25zdCBtYXhWYWwgPSBtYXhJbnB1dC50cmltKCkgPyBwYXJzZUludChtYXhJbnB1dCwgMTApIDogbnVsbDtcblxuICAgICAgLy8g5a6e5pe26aqM6K+B5qW85bGC5LiN6IO95bCP5LqOMFxuICAgICAgaWYgKG1pblZhbCAhPT0gbnVsbCAmJiBtaW5WYWwgPCAwKSB7XG4gICAgICAgIHRoaXMuc2hvd0Zsb29yRmlsdGVyRXJyb3IoJ+acgOWwj+alvOWxguS4jeiDveWwj+S6jjAnKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAobWF4VmFsICE9PSBudWxsICYmIG1heFZhbCA8IDApIHtcbiAgICAgICAgdGhpcy5zaG93Rmxvb3JGaWx0ZXJFcnJvcign5pyA5aSn5qW85bGC5LiN6IO95bCP5LqOMCcpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIOWunuaXtumqjOivgeiMg+WbtOmAu+i+kVxuICAgICAgaWYgKG1pblZhbCAhPT0gbnVsbCAmJiBtYXhWYWwgIT09IG51bGwgJiYgIWlzTmFOKG1pblZhbCkgJiYgIWlzTmFOKG1heFZhbCkgJiYgbWF4VmFsIDwgbWluVmFsKSB7XG4gICAgICAgIHRoaXMuc2hvd0Zsb29yRmlsdGVyRXJyb3IoJ+acgOWkp+alvOWxguS4jeiDveWwj+S6juacgOWwj+alvOWxgicpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5oaWRlRmxvb3JGaWx0ZXJFcnJvcigpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOaYvuekuualvOWxguetm+mAiemUmeivr+S/oeaBr1xuICAgKiBAcGFyYW0gbWVzc2FnZSDplJnor6/kv6Hmga9cbiAgICovXG4gIHB1YmxpYyBzaG93Rmxvb3JGaWx0ZXJFcnJvcihtZXNzYWdlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBjb25zdCAkZXJyb3JFbCA9IHRoaXMuY29udGFpbmVyLmZpbmQoJyNmbG9vci1maWx0ZXItZXJyb3InKTtcbiAgICAkZXJyb3JFbC50ZXh0KG1lc3NhZ2UpLnNob3coKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDpmpDol4/mpbzlsYLnrZvpgInplJnor6/kv6Hmga9cbiAgICovXG4gIHB1YmxpYyBoaWRlRmxvb3JGaWx0ZXJFcnJvcigpOiB2b2lkIHtcbiAgICB0aGlzLmNvbnRhaW5lci5maW5kKCcjZmxvb3ItZmlsdGVyLWVycm9yJykuaGlkZSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIOabtOaWsOalvOWxguetm+mAiei+k+WFpeahhueahOWAvFxuICAgKiBAcGFyYW0gbWluIOacgOWwj+alvOWxguWAvFxuICAgKiBAcGFyYW0gbWF4IOacgOWkp+alvOWxguWAvFxuICAgKi9cbiAgcHVibGljIHVwZGF0ZUZsb29yUmFuZ2VJbnB1dHMobWluOiBudW1iZXIgfCBudWxsLCBtYXg6IG51bWJlciB8IG51bGwpOiB2b2lkIHtcbiAgICB0aGlzLmNvbnRhaW5lci5maW5kKCcjZmxvb3ItbWluJykudmFsKG1pbiAhPT0gbnVsbCA/IG1pbi50b1N0cmluZygpIDogJycpO1xuICAgIHRoaXMuY29udGFpbmVyLmZpbmQoJyNmbG9vci1tYXgnKS52YWwobWF4ICE9PSBudWxsID8gbWF4LnRvU3RyaW5nKCkgOiAnJyk7XG4gICAgdGhpcy5oaWRlRmxvb3JGaWx0ZXJFcnJvcigpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluW9k+WJjea0u+WKqOeahOWPmOmHj+exu+Wei1xuICAgKiBAcmV0dXJucyDlvZPliY3mtLvliqjnmoTlj5jph4/nsbvlnotcbiAgICovXG4gIHByaXZhdGUgZ2V0QWN0aXZlVmFyaWFibGVUeXBlKCk6IFZhcmlhYmxlVHlwZSB7XG4gICAgcmV0dXJuICh0aGlzLmNvbnRhaW5lci5maW5kKCcudGFiLWl0ZW0uYWN0aXZlJykuYXR0cignaWQnKT8ucmVwbGFjZSgnLXRhYicsICcnKSBhcyBWYXJpYWJsZVR5cGUpIHx8ICdjaGF0JztcbiAgfVxuXG4gIC8qKlxuICAgKiDorr7nva7mtLvliqjmoIfnrb7pobVcbiAgICogQHBhcmFtIHR5cGUg6KaB5r+A5rS755qE5Y+Y6YeP57G75Z6LXG4gICAqL1xuICBwdWJsaWMgc2V0QWN0aXZlVGFiKHR5cGU6IFZhcmlhYmxlVHlwZSk6IHZvaWQge1xuICAgIHRoaXMuY29udGFpbmVyLmZpbmQoJy50YWItaXRlbScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbiAgICB0aGlzLmNvbnRhaW5lci5maW5kKCcudGFiLWNvbnRlbnQnKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG5cbiAgICB0aGlzLmNvbnRhaW5lci5maW5kKGAjJHt0eXBlfS10YWJgKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgdGhpcy5jb250YWluZXIuZmluZChgIyR7dHlwZX0tY29udGVudGApLmFkZENsYXNzKCdhY3RpdmUnKTtcblxuICAgIGNvbnN0ICRmbG9vckZpbHRlckNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyLmZpbmQoJyNmbG9vci1maWx0ZXItY29udGFpbmVyJyk7XG4gICAgaWYgKHR5cGUgPT09ICdtZXNzYWdlJykge1xuICAgICAgJGZsb29yRmlsdGVyQ29udGFpbmVyLnNob3coKTtcbiAgICAgIGNvbnN0IFttaW5GbG9vciwgbWF4Rmxvb3JdID0gdGhpcy5nZXRGbG9vclJhbmdlKCk7XG5cbiAgICAgIC8vIOWmguaenOalvOWxguiMg+WbtOS4uuepuu+8jOiuvue9rum7mOiupOiMg+WbtFxuICAgICAgaWYgKG1pbkZsb29yID09PSBudWxsICYmIG1heEZsb29yID09PSBudWxsKSB7XG4gICAgICAgIGNvbnN0IGxhc3RNZXNzYWdlSWQgPSBnZXRMYXN0TWVzc2FnZUlkKCk7XG4gICAgICAgIGNvbnN0IG5ld01pbkZsb29yID0gTWF0aC5tYXgoMCwgbGFzdE1lc3NhZ2VJZCAtIDQpO1xuICAgICAgICBjb25zdCBuZXdNYXhGbG9vciA9IGxhc3RNZXNzYWdlSWQ7XG4gICAgICAgICh0aGlzLmNvbnRyb2xsZXIgYXMgYW55KS5tb2RlbC51cGRhdGVGbG9vclJhbmdlKG5ld01pbkZsb29yLCBuZXdNYXhGbG9vcik7XG4gICAgICAgIHRoaXMudXBkYXRlRmxvb3JSYW5nZUlucHV0cyhuZXdNaW5GbG9vciwgbmV3TWF4Rmxvb3IpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAkZmxvb3JGaWx0ZXJDb250YWluZXIuaGlkZSgpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ2V0Rmxvb3JSYW5nZSgpOiBbbnVtYmVyIHwgbnVsbCwgbnVtYmVyIHwgbnVsbF0ge1xuICAgIGNvbnN0IG1pblZhbCA9IHRoaXMuY29udGFpbmVyLmZpbmQoJyNmbG9vci1taW4nKS52YWwoKSBhcyBzdHJpbmc7XG4gICAgY29uc3QgbWF4VmFsID0gdGhpcy5jb250YWluZXIuZmluZCgnI2Zsb29yLW1heCcpLnZhbCgpIGFzIHN0cmluZztcblxuICAgIGxldCBtaW5GbG9vciA9IG1pblZhbCAmJiBtaW5WYWwudHJpbSgpID8gcGFyc2VJbnQobWluVmFsLCAxMCkgOiBudWxsO1xuICAgIGxldCBtYXhGbG9vciA9IG1heFZhbCAmJiBtYXhWYWwudHJpbSgpID8gcGFyc2VJbnQobWF4VmFsLCAxMCkgOiBudWxsO1xuXG4gICAgLy8g56Gu5L+d5qW85bGC5LiN5bCP5LqOMFxuICAgIGlmIChtaW5GbG9vciAhPT0gbnVsbCkge1xuICAgICAgbWluRmxvb3IgPSBNYXRoLm1heCgwLCBtaW5GbG9vcik7XG4gICAgfVxuICAgIGlmIChtYXhGbG9vciAhPT0gbnVsbCkge1xuICAgICAgbWF4Rmxvb3IgPSBNYXRoLm1heCgwLCBtYXhGbG9vcik7XG4gICAgfVxuXG4gICAgcmV0dXJuIFtcbiAgICAgIG1pbkZsb29yICE9PSBudWxsICYmICFpc05hTihtaW5GbG9vcikgPyBtaW5GbG9vciA6IG51bGwsXG4gICAgICBtYXhGbG9vciAhPT0gbnVsbCAmJiAhaXNOYU4obWF4Rmxvb3IpID8gbWF4Rmxvb3IgOiBudWxsLFxuICAgIF07XG4gIH1cblxuICAvKipcbiAgICog5Yi35paw5Y+Y6YeP5Y2h54mHXG4gICAqIEBwYXJhbSB0eXBlIOWPmOmHj+exu+Wei1xuICAgKiBAcGFyYW0gdmFyaWFibGVzIOi/h+a7pOWQjueahOWPmOmHj+WIl+ihqFxuICAgKi9cbiAgcHVibGljIHJlZnJlc2hWYXJpYWJsZUNhcmRzKHR5cGU6IFZhcmlhYmxlVHlwZSwgdmFyaWFibGVzOiBWYXJpYWJsZUl0ZW1bXSk6IHZvaWQge1xuICAgIC8vIOabtOaWsOagh+etvuaWh+acrFxuICAgIHRoaXMuY29udGFpbmVyLmZpbmQoJy52YXJpYWJsZS10eXBlLWxhYmVsJykudGV4dChgJHt0eXBlfeWPmOmHj2ApO1xuXG4gICAgLy8g6I635Y+W5b2T5YmN5rS75Yqo55qE5YaF5a655a655ZmoXG4gICAgY29uc3QgYWN0aXZlQ29udGVudCA9IHRoaXMuY29udGFpbmVyLmZpbmQoYCMke3R5cGV9LWNvbnRlbnRgKTtcbiAgICBjb25zdCAkdmFyaWFibGVMaXN0ID0gYWN0aXZlQ29udGVudC5maW5kKCcudmFyaWFibGUtbGlzdCcpO1xuXG4gICAgY29uc3Qgc2Nyb2xsVG9wID0gJHZhcmlhYmxlTGlzdC5zY3JvbGxUb3AoKSB8fCAwO1xuXG4gICAgJHZhcmlhYmxlTGlzdC5lbXB0eSgpO1xuXG4gICAgaWYgKHZhcmlhYmxlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICR2YXJpYWJsZUxpc3QuaHRtbCgnPGRpdiBjbGFzcz1cImVtcHR5LXN0YXRlXCI+PHA+5pqC5peg5Y+Y6YePPC9wPjwvZGl2PicpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIOagueaNruWPmOmHj+exu+Wei+mAieaLqeS4jeWQjOeahOa4suafk+aWueW8j1xuICAgIGlmICh0eXBlID09PSAnbWVzc2FnZScpIHtcbiAgICAgIHRoaXMucmVuZGVyTWVzc2FnZVZhcmlhYmxlc0J5Rmxvb3IoJHZhcmlhYmxlTGlzdCwgdmFyaWFibGVzKTtcbiAgICAgICR2YXJpYWJsZUxpc3Quc2Nyb2xsVG9wKHNjcm9sbFRvcCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGZvciAoY29uc3QgdmFyaWFibGUgb2YgdmFyaWFibGVzKSB7XG4gICAgICAgIGNvbnN0IGNhcmQgPSB0aGlzLmNhcmRGYWN0b3J5LmNyZWF0ZUNhcmQodmFyaWFibGUpO1xuICAgICAgICAkdmFyaWFibGVMaXN0LmFwcGVuZChjYXJkKTtcbiAgICAgIH1cbiAgICAgICR2YXJpYWJsZUxpc3Quc2Nyb2xsVG9wKHNjcm9sbFRvcCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOW6lOeUqOetm+mAiVxuICAgKiBAcGFyYW0gZmlsdGVyU3RhdGUg562b6YCJ54q25oCBXG4gICAqIEBwYXJhbSBzZWFyY2hLZXl3b3JkIOaQnOe0ouWFs+mUruWtl1xuICAgKi9cbiAgcHVibGljIGFwcGx5Q2xpZW50U2lkZUZpbHRlcnMoZmlsdGVyU3RhdGU6IFJlY29yZDxWYXJpYWJsZURhdGFUeXBlLCBib29sZWFuPiwgc2VhcmNoS2V5d29yZDogc3RyaW5nKTogdm9pZCB7XG4gICAgY29uc3QgYWN0aXZlVHlwZSA9IHRoaXMuZ2V0QWN0aXZlVmFyaWFibGVUeXBlKCk7XG4gICAgY29uc3QgJHZhcmlhYmxlQ2FyZHMgPSB0aGlzLmNvbnRhaW5lci5maW5kKGAjJHthY3RpdmVUeXBlfS1jb250ZW50IC52YXJpYWJsZS1jYXJkYCk7XG4gICAgbGV0IHZpc2libGVDb3VudCA9IDA7XG5cbiAgICAkdmFyaWFibGVDYXJkcy5lYWNoKChfLCBjYXJkKSA9PiB7XG4gICAgICBjb25zdCAkY2FyZCA9ICQoY2FyZCk7XG4gICAgICBjb25zdCBjYXJkVHlwZSA9ICRjYXJkLmF0dHIoJ2RhdGEtdHlwZScpIGFzIFZhcmlhYmxlRGF0YVR5cGU7XG4gICAgICBjb25zdCBjYXJkTmFtZSA9ICgkY2FyZC5maW5kKCcudmFyaWFibGUtdGl0bGUnKS52YWwoKSBhcyBzdHJpbmcpIHx8ICcnO1xuXG4gICAgICBjb25zdCB0eXBlVmlzaWJsZSA9IGZpbHRlclN0YXRlW2NhcmRUeXBlXTtcbiAgICAgIGNvbnN0IGtleXdvcmRWaXNpYmxlID0gIXNlYXJjaEtleXdvcmQgfHwgY2FyZE5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzZWFyY2hLZXl3b3JkLnRvTG93ZXJDYXNlKCkpO1xuXG4gICAgICBpZiAodHlwZVZpc2libGUgJiYga2V5d29yZFZpc2libGUpIHtcbiAgICAgICAgJGNhcmQuc2hvdygpO1xuICAgICAgICB2aXNpYmxlQ291bnQrKztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICRjYXJkLmhpZGUoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIOabtOaWsOepuueKtuaAgeaYvuekulxuICAgIHRoaXMudXBkYXRlRmlsdGVyRW1wdHlTdGF0ZShhY3RpdmVUeXBlLCB2aXNpYmxlQ291bnQpO1xuICB9XG5cbiAgLyoqXG4gICAqIOabtOaWsOetm+mAieWQjueahOepuueKtuaAgeaYvuekulxuICAgKiBAcGFyYW0gdHlwZSDlj5jph4/nsbvlnotcbiAgICogQHBhcmFtIHZpc2libGVDb3VudCDlj6/op4HljaHniYfmlbDph49cbiAgICovXG4gIHByaXZhdGUgdXBkYXRlRmlsdGVyRW1wdHlTdGF0ZSh0eXBlOiBWYXJpYWJsZVR5cGUsIHZpc2libGVDb3VudDogbnVtYmVyKTogdm9pZCB7XG4gICAgY29uc3QgJHZhcmlhYmxlTGlzdCA9IHRoaXMuY29udGFpbmVyLmZpbmQoYCMke3R5cGV9LWNvbnRlbnQgLnZhcmlhYmxlLWxpc3RgKTtcbiAgICBjb25zdCAkZXhpc3RpbmdFbXB0eVN0YXRlID0gJHZhcmlhYmxlTGlzdC5maW5kKCcuZmlsdGVyLWVtcHR5LXN0YXRlJyk7XG5cbiAgICBpZiAodmlzaWJsZUNvdW50ID09PSAwKSB7XG4gICAgICAvLyDmo4Dmn6XmmK/lkKbmnInlj5jph4/ljaHniYfvvIjljbPkvb/ooqvpmpDol4/vvIlcbiAgICAgIGNvbnN0IHRvdGFsQ2FyZHMgPSAkdmFyaWFibGVMaXN0LmZpbmQoJy52YXJpYWJsZS1jYXJkJykubGVuZ3RoO1xuICAgICAgaWYgKHRvdGFsQ2FyZHMgPiAwKSB7XG4gICAgICAgIGlmICgkZXhpc3RpbmdFbXB0eVN0YXRlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICR2YXJpYWJsZUxpc3QuYXBwZW5kKCc8ZGl2IGNsYXNzPVwiZmlsdGVyLWVtcHR5LXN0YXRlXCI+PHA+5rKh5pyJ56ym5ZCI562b6YCJ5p2h5Lu255qE5Y+Y6YePPC9wPjwvZGl2PicpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICRleGlzdGluZ0VtcHR5U3RhdGUucmVtb3ZlKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOaMiealvOWxgua4suafk21lc3NhZ2XnsbvlnovnmoTlj5jph49cbiAgICogQHBhcmFtIGNvbnRhaW5lciDlrrnlmajlhYPntKBcbiAgICogQHBhcmFtIHZhcmlhYmxlcyDlj5jph4/liJfooahcbiAgICovXG4gIHByaXZhdGUgcmVuZGVyTWVzc2FnZVZhcmlhYmxlc0J5Rmxvb3IoY29udGFpbmVyOiBKUXVlcnk8SFRNTEVsZW1lbnQ+LCB2YXJpYWJsZXM6IFZhcmlhYmxlSXRlbVtdKTogdm9pZCB7XG4gICAgLy8g5oyJ5qW85bGC5YiG57uE5Y+Y6YePXG4gICAgY29uc3QgZmxvb3JHcm91cHM6IE1hcDxudW1iZXIsIFZhcmlhYmxlSXRlbVtdPiA9IG5ldyBNYXAoKTtcblxuICAgIGZvciAoY29uc3QgdmFyaWFibGUgb2YgdmFyaWFibGVzKSB7XG4gICAgICBpZiAodmFyaWFibGUubWVzc2FnZV9pZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGlmICghZmxvb3JHcm91cHMuaGFzKHZhcmlhYmxlLm1lc3NhZ2VfaWQpKSB7XG4gICAgICAgICAgZmxvb3JHcm91cHMuc2V0KHZhcmlhYmxlLm1lc3NhZ2VfaWQsIFtdKTtcbiAgICAgICAgfVxuICAgICAgICBmbG9vckdyb3Vwcy5nZXQodmFyaWFibGUubWVzc2FnZV9pZCkhLnB1c2godmFyaWFibGUpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IHNvcnRlZEZsb29ycyA9IEFycmF5LmZyb20oZmxvb3JHcm91cHMua2V5cygpKS5zb3J0KChhLCBiKSA9PiBiIC0gYSk7IC8vIOmZjeW6j+aOkuWIl++8jOacgOaWsOalvOWxguWcqOS4ilxuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzb3J0ZWRGbG9vcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGZsb29yID0gc29ydGVkRmxvb3JzW2ldO1xuICAgICAgY29uc3QgZmxvb3JWYXJpYWJsZXMgPSBmbG9vckdyb3Vwcy5nZXQoZmxvb3IpITtcbiAgICAgIGNvbnN0IGlzRXhwYW5kZWQgPSBpID09PSAwOyAvLyDlj6rlsZXlvIDmnIDmlrDkuIDlsYLmpbxcblxuICAgICAgY29uc3QgJHBhbmVsID0gdGhpcy5jcmVhdGVGbG9vclBhbmVsKGZsb29yLCBpc0V4cGFuZGVkKTtcbiAgICAgIGNvbnN0ICRwYW5lbEJvZHkgPSAkcGFuZWwuZmluZCgnLmZsb29yLXBhbmVsLWJvZHknKTtcblxuICAgICAgZm9yIChjb25zdCB2YXJpYWJsZSBvZiBmbG9vclZhcmlhYmxlcykge1xuICAgICAgICBjb25zdCBjYXJkID0gdGhpcy5jYXJkRmFjdG9yeS5jcmVhdGVDYXJkKHZhcmlhYmxlKTtcbiAgICAgICAgY2FyZC5hdHRyKCdkYXRhLWZsb29yLWlkJywgZmxvb3IudG9TdHJpbmcoKSk7XG4gICAgICAgICRwYW5lbEJvZHkuYXBwZW5kKGNhcmQpO1xuICAgICAgfVxuXG4gICAgICBjb250YWluZXIuYXBwZW5kKCRwYW5lbCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWIm+W7uualvOWxguaKmOWPoOmdouadv1xuICAgKiBAcGFyYW0gZmxvb3Ig5qW85bGC5Y+3XG4gICAqIEBwYXJhbSBpc0V4cGFuZGVkIOaYr+WQpum7mOiupOWxleW8gFxuICAgKiBAcmV0dXJucyDmipjlj6DpnaLmnb9qUXVlcnnlr7nosaFcbiAgICovXG4gIHByaXZhdGUgY3JlYXRlRmxvb3JQYW5lbChmbG9vcjogbnVtYmVyLCBpc0V4cGFuZGVkOiBib29sZWFuKTogSlF1ZXJ5PEhUTUxFbGVtZW50PiB7XG4gICAgY29uc3QgdGl0bGVDb250ZW50ID0gYCMgJHtmbG9vcn0g5qW8YDtcblxuICAgIGNvbnN0ICRwYW5lbCA9ICQoYFxuICAgICAgPGRpdiBjbGFzcz1cImZsb29yLXBhbmVsXCIgZGF0YS1mbG9vcj1cIiR7Zmxvb3J9XCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJmbG9vci1wYW5lbC1oZWFkZXIgZmxleCBzcGFjZUJldHdlZW4gYWxpZ25JdGVtc0NlbnRlclwiPlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJmbG9vci1wYW5lbC10aXRsZVwiPiR7dGl0bGVDb250ZW50fTwvZGl2PlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJmbG9vci1wYW5lbC1pY29uICR7aXNFeHBhbmRlZCA/ICdleHBhbmRlZCcgOiAnJ31cIj5cbiAgICAgICAgICAgIDxpIGNsYXNzPVwiZmEtc29saWQgZmEtY2hldnJvbi1kb3duXCI+PC9pPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImZsb29yLXBhbmVsLWJvZHkgJHtpc0V4cGFuZGVkID8gJ2V4cGFuZGVkJyA6ICcnfVwiPjwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgYCk7XG5cbiAgICAkcGFuZWwuZmluZCgnLmZsb29yLXBhbmVsLWhlYWRlcicpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGNvbnN0ICR0aGlzID0gJCh0aGlzKTtcbiAgICAgIGNvbnN0ICRpY29uID0gJHRoaXMuZmluZCgnLmZsb29yLXBhbmVsLWljb24nKTtcbiAgICAgIGNvbnN0ICRib2R5ID0gJHRoaXMuY2xvc2VzdCgnLmZsb29yLXBhbmVsJykuZmluZCgnLmZsb29yLXBhbmVsLWJvZHknKTtcblxuICAgICAgJGljb24udG9nZ2xlQ2xhc3MoJ2V4cGFuZGVkJyk7XG4gICAgICAkYm9keS50b2dnbGVDbGFzcygnZXhwYW5kZWQnKTtcbiAgICB9KTtcblxuICAgIHJldHVybiAkcGFuZWw7XG4gIH1cblxuICAvKipcbiAgICog5Yib5bu65paw5Y+Y6YeP5Y2h54mHXG4gICAqIEBwYXJhbSB0eXBlIOWPmOmHj+exu+Wei1xuICAgKiBAcGFyYW0gZGF0YVR5cGUg5Y+Y6YeP5pWw5o2u57G75Z6LXG4gICAqIEBwYXJhbSBmbG9vcklkIOalvOWxgklEKOS7heeUqOS6jm1lc3NhZ2XnsbvlnospXG4gICAqL1xuICBwdWJsaWMgYWRkTmV3VmFyaWFibGVDYXJkKHR5cGU6IFZhcmlhYmxlVHlwZSwgZGF0YVR5cGU6IFZhcmlhYmxlRGF0YVR5cGUsIGZsb29ySWQ/OiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zdCAkY29udGVudCA9IHRoaXMuY29udGFpbmVyLmZpbmQoYCMke3R5cGV9LWNvbnRlbnRgKS5maW5kKCcudmFyaWFibGUtbGlzdCcpO1xuICAgICRjb250ZW50LmZpbmQoJy5lbXB0eS1zdGF0ZScpLnJlbW92ZSgpO1xuXG4gICAgY29uc3QgZGVmYXVsdFZhcmlhYmxlOiBWYXJpYWJsZUl0ZW0gPSB7XG4gICAgICBuYW1lOiAnbmV3X3ZhcmlhYmxlJyxcbiAgICAgIHZhbHVlOiBWYXJpYWJsZU1hbmFnZXJVdGlsLmdldERlZmF1bHRWYWx1ZUZvclR5cGUoZGF0YVR5cGUpLFxuICAgICAgZGF0YVR5cGU6IGRhdGFUeXBlLFxuICAgICAgaWQ6IHV1aWR2NCgpLFxuICAgIH07XG5cbiAgICBjb25zdCBuZXdDYXJkID0gdGhpcy5jYXJkRmFjdG9yeS5jcmVhdGVDYXJkKGRlZmF1bHRWYXJpYWJsZSk7XG4gICAgbmV3Q2FyZC5hdHRyKCdkYXRhLXR5cGUnLCBkYXRhVHlwZSk7XG5cbiAgICBpZiAodHlwZSA9PT0gJ21lc3NhZ2UnICYmIGZsb29ySWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhpcy5hZGRDYXJkVG9GbG9vclBhbmVsKCRjb250ZW50LCBuZXdDYXJkLCBmbG9vcklkKTtcbiAgICB9IGVsc2Uge1xuICAgICAgJGNvbnRlbnQucHJlcGVuZChuZXdDYXJkKTtcbiAgICAgIHRoaXMuYWRkQW5pbWF0aW9uKG5ld0NhcmQsICd2YXJpYWJsZS1hZGRlZCcsICgpID0+IHt9KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5bCG5Y2h54mH5re75Yqg5Yiw5oyH5a6a5qW85bGC6Z2i5p2/XG4gICAqIEBwYXJhbSBjb250ZW50IOWGheWuueWuueWZqFxuICAgKiBAcGFyYW0gY2FyZCDljaHniYflhYPntKBcbiAgICogQHBhcmFtIGZsb29ySWQg5qW85bGCSURcbiAgICovXG4gIHByaXZhdGUgYWRkQ2FyZFRvRmxvb3JQYW5lbChjb250ZW50OiBKUXVlcnk8SFRNTEVsZW1lbnQ+LCBjYXJkOiBKUXVlcnk8SFRNTEVsZW1lbnQ+LCBmbG9vcklkOiBudW1iZXIpOiB2b2lkIHtcbiAgICBsZXQgJGZsb29yUGFuZWwgPSBjb250ZW50LmZpbmQoYC5mbG9vci1wYW5lbFtkYXRhLWZsb29yPVwiJHtmbG9vcklkfVwiXWApO1xuXG4gICAgaWYgKCRmbG9vclBhbmVsLmxlbmd0aCA9PT0gMCkge1xuICAgICAgY29uc3QgJHBhbmVsID0gdGhpcy5jcmVhdGVGbG9vclBhbmVsKGZsb29ySWQsIHRydWUpO1xuICAgICAgdGhpcy5pbnNlcnRGbG9vclBhbmVsSW5PcmRlcihjb250ZW50LCAkcGFuZWwsIGZsb29ySWQpO1xuICAgICAgJGZsb29yUGFuZWwgPSAkcGFuZWw7XG4gICAgfVxuXG4gICAgY29uc3QgJHBhbmVsQm9keSA9ICRmbG9vclBhbmVsLmZpbmQoJy5mbG9vci1wYW5lbC1ib2R5Jyk7XG5cbiAgICBpZiAoISRwYW5lbEJvZHkuaGFzQ2xhc3MoJ2V4cGFuZGVkJykpIHtcbiAgICAgICRmbG9vclBhbmVsLmZpbmQoJy5mbG9vci1wYW5lbC1pY29uJykuYWRkQ2xhc3MoJ2V4cGFuZGVkJyk7XG4gICAgICAkcGFuZWxCb2R5LmFkZENsYXNzKCdleHBhbmRlZCcpO1xuICAgIH1cblxuICAgIGNhcmQuYXR0cignZGF0YS1mbG9vci1pZCcsIGZsb29ySWQudG9TdHJpbmcoKSk7XG4gICAgJHBhbmVsQm9keS5wcmVwZW5kKGNhcmQpO1xuICAgIHRoaXMuYWRkQW5pbWF0aW9uKGNhcmQsICd2YXJpYWJsZS1hZGRlZCcsICgpID0+IHt9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmjInmpbzlsYLlj7fpobrluo/mj5LlhaXmpbzlsYLpnaLmnb9cbiAgICogQHBhcmFtIGNvbnRlbnQg5YaF5a655a655ZmoXG4gICAqIEBwYXJhbSBwYW5lbCDopoHmj5LlhaXnmoTpnaLmnb9cbiAgICogQHBhcmFtIGZsb29ySWQg5qW85bGCSURcbiAgICovXG4gIHByaXZhdGUgaW5zZXJ0Rmxvb3JQYW5lbEluT3JkZXIoY29udGVudDogSlF1ZXJ5PEhUTUxFbGVtZW50PiwgcGFuZWw6IEpRdWVyeTxIVE1MRWxlbWVudD4sIGZsb29ySWQ6IG51bWJlcik6IHZvaWQge1xuICAgIGxldCBpbnNlcnRlZCA9IGZhbHNlO1xuICAgIGNvbnRlbnQuZmluZCgnLmZsb29yLXBhbmVsJykuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCBleGlzdGluZ0Zsb29yID0gcGFyc2VJbnQoJCh0aGlzKS5hdHRyKCdkYXRhLWZsb29yJykgfHwgJzAnKTtcbiAgICAgIGlmIChmbG9vcklkID4gZXhpc3RpbmdGbG9vcikge1xuICAgICAgICAkKHRoaXMpLmJlZm9yZShwYW5lbCk7XG4gICAgICAgIGluc2VydGVkID0gdHJ1ZTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9KTtcblxuICAgIGlmICghaW5zZXJ0ZWQpIHtcbiAgICAgIGNvbnRlbnQucHJlcGVuZChwYW5lbCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluWPmOmHj+WNoeeJh+S/oeaBr1xuICAgKiBAcGFyYW0gY2FyZCDljaHniYflhYPntKBcbiAgICogQHJldHVybnMg5Y2h54mH5Lit55qE5Y+Y6YeP5L+h5oGvXG4gICAqL1xuICBwdWJsaWMgZ2V0VmFyaWFibGVGcm9tQ2FyZChjYXJkOiBKUXVlcnk8SFRNTEVsZW1lbnQ+KTogVmFyaWFibGVJdGVtIHwgbnVsbCB7XG4gICAgcmV0dXJuIHRoaXMuY2FyZEZhY3RvcnkuZ2V0VmFyaWFibGVGcm9tQ2FyZChjYXJkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5blj5jph4/ljaHniYflkI3np7BcbiAgICogQHBhcmFtIGNhcmQg5Y2h54mH5YWD57SgXG4gICAqIEByZXR1cm5zIOWNoeeJh+S4reeahOWPmOmHj+WQjeensFxuICAgKi9cbiAgcHVibGljIGdldFZhcmlhYmxlQ2FyZE5hbWUoY2FyZDogSlF1ZXJ5PEhUTUxFbGVtZW50Pik6IHN0cmluZyB7XG4gICAgY29uc3QgdmFyaWFibGUgPSB0aGlzLmdldFZhcmlhYmxlRnJvbUNhcmQoY2FyZCk7XG4gICAgcmV0dXJuIHZhcmlhYmxlPy5uYW1lIHx8ICcnO1xuICB9XG5cbiAgLyoqXG4gICAqIOaYvuekuua3u+WKoOWPmOmHj+mAieaLqeWvueivneahhlxuICAgKiBAcGFyYW0gY2FsbGJhY2sg6YCJ5oup5ZCO55qE5Zue6LCD5Ye95pWwXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgc2hvd0FkZFZhcmlhYmxlRGlhbG9nKGNhbGxiYWNrOiAoZGF0YVR5cGU6IFZhcmlhYmxlRGF0YVR5cGUsIGZsb29ySWQ/OiBudW1iZXIpID0+IHZvaWQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBjdXJyZW50VHlwZSA9IHRoaXMuZ2V0QWN0aXZlVmFyaWFibGVUeXBlKCk7XG5cbiAgICBpZiAoY3VycmVudFR5cGUgPT09ICdtZXNzYWdlJykge1xuICAgICAgYXdhaXQgdGhpcy5zaG93Rmxvb3JJbnB1dERpYWxvZyhhc3luYyBmbG9vcklkID0+IHtcbiAgICAgICAgaWYgKGZsb29ySWQgPT09IG51bGwpIHJldHVybjtcblxuICAgICAgICBhd2FpdCB0aGlzLnNob3dWYXJpYWJsZVR5cGVEaWFsb2coZGF0YVR5cGUgPT4ge1xuICAgICAgICAgIGNhbGxiYWNrKGRhdGFUeXBlLCBmbG9vcklkKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBhd2FpdCB0aGlzLnNob3dWYXJpYWJsZVR5cGVEaWFsb2coZGF0YVR5cGUgPT4ge1xuICAgICAgY2FsbGJhY2soZGF0YVR5cGUpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOaYvuekuualvOWxgui+k+WFpeWvueivneahhlxuICAgKiBAcGFyYW0gY2FsbGJhY2sg6L6T5YWl5a6M5oiQ5ZCO55qE5Zue6LCD5Ye95pWwXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgc2hvd0Zsb29ySW5wdXREaWFsb2coY2FsbGJhY2s6IChmbG9vcklkOiBudW1iZXIgfCBudWxsKSA9PiB2b2lkKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgY29udGVudCA9ICQoYFxuICAgICAgPGRpdj5cbiAgICAgICAgPGgzPui+k+WFpealvOWxguWPt+eggTwvaDM+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJmbG9vci1pbnB1dC1kaWFsb2dcIj5cbiAgICAgICAgICA8aW5wdXQgdHlwZT1cIm51bWJlclwiIGlkPVwiZmxvb3ItaW5wdXRcIiBtaW49XCIwXCIgcGxhY2Vob2xkZXI9XCLor7fovpPlhaXmpbzlsYLlj7fnoIFcIiAvPlxuICAgICAgICAgIDxkaXYgaWQ9XCJmbG9vci1pbnB1dC1lcnJvclwiIGNsYXNzPVwiZmxvb3ItZmlsdGVyLWVycm9yXCIgc3R5bGU9XCJkaXNwbGF5OiBub25lXCI+6K+36L6T5YWl5pyJ5pWI55qE5qW85bGC5Y+356CBPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgYCk7XG5cbiAgICBjb25zdCAkaW5wdXRGaWVsZCA9IGNvbnRlbnQuZmluZCgnI2Zsb29yLWlucHV0Jyk7XG4gICAgY29uc3QgJGVycm9yTXNnID0gY29udGVudC5maW5kKCcjZmxvb3ItaW5wdXQtZXJyb3InKTtcblxuICAgIGNvbnN0IGxhc3RNZXNzYWdlSWQgPSBnZXRMYXN0TWVzc2FnZUlkKCk7XG4gICAgaWYgKGxhc3RNZXNzYWdlSWQgPj0gMCkge1xuICAgICAgJGlucHV0RmllbGQudmFsKGxhc3RNZXNzYWdlSWQpO1xuICAgIH1cblxuICAgIC8vIOa3u+WKoOi+k+WFpemqjOivgVxuICAgICRpbnB1dEZpZWxkLm9uKCdpbnB1dCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGNvbnN0IHZhbHVlID0gcGFyc2VJbnQoJCh0aGlzKS52YWwoKSBhcyBzdHJpbmcsIDEwKTtcbiAgICAgIGlmICgkKHRoaXMpLnZhbCgpICYmIChpc05hTih2YWx1ZSkgfHwgdmFsdWUgPCAwKSkge1xuICAgICAgICAkZXJyb3JNc2cudGV4dCgn5qW85bGC5Y+356CB5LiN6IO95bCP5LqOMCcpLnNob3coKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICRlcnJvck1zZy5oaWRlKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjYWxsR2VuZXJpY1BvcHVwKGNvbnRlbnQsIFBPUFVQX1RZUEUuQ09ORklSTSwgJycsIHtcbiAgICAgIG9rQnV0dG9uOiAn56Gu6K6kJyxcbiAgICAgIGNhbmNlbEJ1dHRvbjogJ+WPlua2iCcsXG4gICAgfSk7XG5cbiAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgY2FsbGJhY2sobnVsbCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgaW5wdXRWYWx1ZSA9ICRpbnB1dEZpZWxkLnZhbCgpIGFzIHN0cmluZztcbiAgICBjb25zdCBmbG9vcklkID0gcGFyc2VJbnQoaW5wdXRWYWx1ZSwgMTApO1xuXG4gICAgaWYgKCFpbnB1dFZhbHVlLnRyaW0oKSB8fCBpc05hTihmbG9vcklkKSkge1xuICAgICAgJGVycm9yTXNnLnRleHQoJ+ivt+i+k+WFpeacieaViOeahOalvOWxguWPt+eggScpLnNob3coKTtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4gdGhpcy5zaG93Rmxvb3JJbnB1dERpYWxvZyhjYWxsYmFjayksIDEwMCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGZsb29ySWQgPCAwKSB7XG4gICAgICAkZXJyb3JNc2cudGV4dCgn5qW85bGC5Y+356CB5LiN6IO95bCP5LqOMCcpLnNob3coKTtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4gdGhpcy5zaG93Rmxvb3JJbnB1dERpYWxvZyhjYWxsYmFjayksIDEwMCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY2FsbGJhY2soZmxvb3JJZCk7XG4gIH1cblxuICAvKipcbiAgICog5pi+56S65Y+Y6YeP57G75Z6L6YCJ5oup5a+56K+d5qGGXG4gICAqIEBwYXJhbSBjYWxsYmFjayDpgInmi6nlkI7nmoTlm57osIPlh73mlbBcbiAgICogQHBhcmFtIGZsb29ySWQg5qW85bGCSUQo5LuF55So5LqObWVzc2FnZeexu+WeiylcbiAgICovXG4gIHB1YmxpYyBhc3luYyBzaG93VmFyaWFibGVUeXBlRGlhbG9nKGNhbGxiYWNrOiAoZGF0YVR5cGU6IFZhcmlhYmxlRGF0YVR5cGUpID0+IHZvaWQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBjb250ZW50ID0gJChgXG4gICAgICA8ZGl2PlxuICAgICAgICA8aDM+6YCJ5oup5Y+Y6YeP57G75Z6LPC9oMz5cbiAgICAgICAgPGRpdiBjbGFzcz1cInZhcmlhYmxlLXR5cGUtb3B0aW9uc1wiPlxuICAgICAgICAgIDxkaXYgZGF0YS10eXBlPVwic3RyaW5nXCI+PGkgY2xhc3M9XCJmYS1yZWd1bGFyIGZhLWZvbnRcIj48L2k+IOWtl+espuS4sjwvZGl2PlxuICAgICAgICAgIDxkaXYgZGF0YS10eXBlPVwibnVtYmVyXCI+PGkgY2xhc3M9XCJmYS1yZWd1bGFyIGZhLWhhc2h0YWdcIj48L2k+IOaVsOWtlzwvZGl2PlxuICAgICAgICAgIDxkaXYgZGF0YS10eXBlPVwiYm9vbGVhblwiPjxpIGNsYXNzPVwiZmEtcmVndWxhciBmYS10b2dnbGUtb25cIj48L2k+IOW4g+WwlOWAvDwvZGl2PlxuICAgICAgICAgIDxkaXYgZGF0YS10eXBlPVwiYXJyYXlcIj48aSBjbGFzcz1cImZhLXJlZ3VsYXIgZmEtbGlzdFwiPjwvaT4g5pWw57uEPC9kaXY+XG4gICAgICAgICAgPGRpdiBkYXRhLXR5cGU9XCJvYmplY3RcIj48aSBjbGFzcz1cImZhLXJlZ3VsYXIgZmEtY29kZVwiPjwvaT4g5a+56LGhPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgYCk7XG5cbiAgICBjb250ZW50LmZpbmQoJy52YXJpYWJsZS10eXBlLW9wdGlvbnMgZGl2Jykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgZGF0YVR5cGUgPSAkKHRoaXMpLmF0dHIoJ2RhdGEtdHlwZScpIGFzIFZhcmlhYmxlRGF0YVR5cGU7XG4gICAgICBjYWxsYmFjayhkYXRhVHlwZSk7XG5cbiAgICAgICQoJy5wb3B1cCcpLmZpbmQoJy5wb3B1cC1idXR0b24tY2xvc2UnKS50cmlnZ2VyKCdjbGljaycpO1xuICAgIH0pO1xuXG4gICAgYXdhaXQgY2FsbEdlbmVyaWNQb3B1cChjb250ZW50LCBQT1BVUF9UWVBFLkRJU1BMQVkpO1xuICB9XG5cbiAgLyoqXG4gICAqIOaYvuekuuehruiupOWvueivneahhlxuICAgKiBAcGFyYW0gbWVzc2FnZSDnoa7orqTkv6Hmga9cbiAgICogQHBhcmFtIGNhbGxiYWNrIOehruiupOWQjueahOWbnuiwg1xuICAgKi9cbiAgcHVibGljIGFzeW5jIHNob3dDb25maXJtRGlhbG9nKG1lc3NhZ2U6IHN0cmluZywgY2FsbGJhY2s6IChjb25maXJtZWQ6IGJvb2xlYW4pID0+IHZvaWQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjYWxsR2VuZXJpY1BvcHVwKG1lc3NhZ2UsIFBPUFVQX1RZUEUuQ09ORklSTSwgJycsIHtcbiAgICAgIG9rQnV0dG9uOiAn56Gu6K6kJyxcbiAgICAgIGNhbmNlbEJ1dHRvbjogJ+WPlua2iCcsXG4gICAgfSk7XG5cbiAgICBjYWxsYmFjayghIXJlc3VsdCk7XG4gIH1cblxuICAvKipcbiAgICog5riy5p+T5Y+Y6YeP566h55CG5Zmo5rWu56qXXG4gICAqL1xuICBwdWJsaWMgcmVuZGVyKCk6IHZvaWQge1xuICAgIHRoaXMudW5yZW5kZXIoKTtcblxuICAgIGNvbnN0IGV4aXN0aW5nRGlhbG9nID0gRmxvYXRpbmdEaWFsb2cuZ2V0SW5zdGFuY2UoVmFyaWFibGVWaWV3LkRJQUxPR19JRCk7XG4gICAgaWYgKGV4aXN0aW5nRGlhbG9nKSB7XG4gICAgICBleGlzdGluZ0RpYWxvZy5mb2N1cygpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLmRpYWxvZyA9IEZsb2F0aW5nRGlhbG9nLmNyZWF0ZSh7XG4gICAgICBpZDogVmFyaWFibGVWaWV3LkRJQUxPR19JRCxcbiAgICAgIHRpdGxlOiAn5Y+Y6YeP566h55CG5ZmoJyxcbiAgICAgIHdpZHRoOiAnNTB2dycsXG4gICAgICBoZWlnaHQ6ICc3MHZoJyxcbiAgICAgIG1vYmlsZVdpZHRoOiAnODB2dycsXG4gICAgICBtb2JpbGVIZWlnaHQ6ICc3MHZoJyxcbiAgICAgIG1pbldpZHRoOiAnMTV2dycsXG4gICAgICBtaW5IZWlnaHQ6ICczMHZoJyxcbiAgICAgIG1vYmlsZU1pbldpZHRoOiAnNzB2dycsXG4gICAgICBtb2JpbGVNaW5IZWlnaHQ6ICczMHZoJyxcbiAgICAgIG9uQ2xvc2U6ICgpID0+IHtcbiAgICAgICAgdGhpcy5jbGVhbnVwKCk7XG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgaWYgKHRoaXMuZGlhbG9nKSB7XG4gICAgICBjb25zdCBjb250ZW50ID0gdGhpcy5kaWFsb2cucmVuZGVyKCk7XG4gICAgICBjb250ZW50LmFwcGVuZCh0aGlzLmNvbnRhaW5lcik7XG4gICAgICB0aGlzLmNvbnRhaW5lci5zaG93KCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWFs+mXreW5tua4heeQhuWPmOmHj+euoeeQhuWZqOa1rueql1xuICAgKi9cbiAgcHVibGljIHVucmVuZGVyKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmRpYWxvZykge1xuICAgICAgdGhpcy5jb250YWluZXIuZGV0YWNoKCk7XG4gICAgICB0aGlzLmRpYWxvZy5jbG9zZSgpO1xuICAgICAgdGhpcy5kaWFsb2cgPSBudWxsO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmuIXnkIbotYTmupBcbiAgICovXG4gIHByaXZhdGUgY2xlYW51cCgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5jb250cm9sbGVyKSB7XG4gICAgICB0aGlzLmNvbnRyb2xsZXIuY2xlYW51cCgpO1xuICAgIH1cbiAgICB0aGlzLmRpYWxvZyA9IG51bGw7XG4gIH1cblxuICBwdWJsaWMgYWRkVmFyaWFibGVDYXJkKHZhcmlhYmxlOiBWYXJpYWJsZUl0ZW0pOiB2b2lkIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgbmV3Q2FyZCA9IHRoaXMuY2FyZEZhY3RvcnkuY3JlYXRlQ2FyZCh2YXJpYWJsZSk7XG4gICAgICBuZXdDYXJkLmF0dHIoJ2RhdGEtdHlwZScsIHZhcmlhYmxlLmRhdGFUeXBlKTtcblxuICAgICAgY29uc3QgYWN0aXZlVHlwZSA9IHRoaXMuZ2V0QWN0aXZlVmFyaWFibGVUeXBlKCk7XG4gICAgICBjb25zdCAkdmFyaWFibGVMaXN0ID0gdGhpcy5jb250YWluZXIuZmluZChgIyR7YWN0aXZlVHlwZX0tY29udGVudCAudmFyaWFibGUtbGlzdGApO1xuXG4gICAgICBpZiAoYWN0aXZlVHlwZSA9PT0gJ21lc3NhZ2UnICYmIHZhcmlhYmxlLm1lc3NhZ2VfaWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aGlzLmFkZENhcmRUb0Zsb29yUGFuZWwoJHZhcmlhYmxlTGlzdCwgbmV3Q2FyZCwgdmFyaWFibGUubWVzc2FnZV9pZCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkdmFyaWFibGVMaXN0LmZpbmQoJy5lbXB0eS1zdGF0ZScpLnJlbW92ZSgpO1xuICAgICAgICAkdmFyaWFibGVMaXN0LmFwcGVuZChuZXdDYXJkKTtcbiAgICAgICAgdGhpcy5hZGRBbmltYXRpb24obmV3Q2FyZCwgJ3ZhcmlhYmxlLWFkZGVkJywgKCkgPT4ge30pO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2cuZXJyb3IoYFtWYXJpYWJsZU1hbmFnZXJdIOa3u+WKoOWNoeeJh1wiJHt2YXJpYWJsZS5uYW1lfVwi5aSx6LSlOmAsIGVycm9yKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog56e76Zmk5Y+Y6YeP5Y2h54mHXG4gICAqIEBwYXJhbSB2YXJpYWJsZV9pZCDlj5jph49JRFxuICAgKi9cbiAgcHVibGljIHJlbW92ZVZhcmlhYmxlQ2FyZCh2YXJpYWJsZV9pZDogc3RyaW5nKTogdm9pZCB7XG4gICAgdHJ5IHtcbiAgICAgIGlmICghdmFyaWFibGVfaWQpIHtcbiAgICAgICAgbG9nLndhcm4oYFtWYXJpYWJsZU1hbmFnZXJdIOWPmOmHj0lE5Li656m677yM5peg5rOV56e76Zmk5Y2h54mHYCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgJGNhcmQgPSB0aGlzLmNvbnRhaW5lci5maW5kKGAudmFyaWFibGUtY2FyZFtkYXRhLXZhcmlhYmxlLWlkPVwiJHt2YXJpYWJsZV9pZH1cIl1gKTtcblxuICAgICAgaWYgKCRjYXJkLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBsb2cud2FybihgW1ZhcmlhYmxlTWFuYWdlcl0g5pyq5om+5YiwSUTkuLpcIiR7dmFyaWFibGVfaWR9XCLnmoTljaHniYdgKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmFkZEFuaW1hdGlvbigkY2FyZCwgJ3ZhcmlhYmxlLWRlbGV0ZWQnLCAoKSA9PiB7XG4gICAgICAgICRjYXJkLnJlbW92ZSgpO1xuICAgICAgICB0aGlzLmNoZWNrQW5kU2hvd0VtcHR5U3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2cuZXJyb3IoYFtWYXJpYWJsZU1hbmFnZXJdIOenu+mZpOWNoeeJh+Wksei0pTpgLCBlcnJvcik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOajgOafpeW5tuaYvuekuuepuueKtuaAgeaPkOekulxuICAgKi9cbiAgcHJpdmF0ZSBjaGVja0FuZFNob3dFbXB0eVN0YXRlKCk6IHZvaWQge1xuICAgIGNvbnN0IGFjdGl2ZVR5cGUgPSB0aGlzLmdldEFjdGl2ZVZhcmlhYmxlVHlwZSgpO1xuICAgIGNvbnN0ICR2YXJpYWJsZUxpc3QgPSB0aGlzLmNvbnRhaW5lci5maW5kKGAjJHthY3RpdmVUeXBlfS1jb250ZW50IC52YXJpYWJsZS1saXN0YCk7XG5cbiAgICBpZiAoJHZhcmlhYmxlTGlzdC5maW5kKCcudmFyaWFibGUtY2FyZCcpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgJHZhcmlhYmxlTGlzdC5odG1sKCc8ZGl2IGNsYXNzPVwiZW1wdHktc3RhdGVcIj48cD7mmoLml6Dlj5jph488L3A+PC9kaXY+Jyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOabtOaWsOWPmOmHj+WNoeeJh1xuICAgKiBAcGFyYW0gdmFyaWFibGUg5Y+Y6YePXG4gICAqL1xuICBwdWJsaWMgdXBkYXRlVmFyaWFibGVDYXJkKHZhcmlhYmxlOiBWYXJpYWJsZUl0ZW0pOiB2b2lkIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgJGNhcmQgPSB0aGlzLmNvbnRhaW5lci5maW5kKGAudmFyaWFibGUtY2FyZFtkYXRhLXZhcmlhYmxlLWlkPVwiJHt2YXJpYWJsZS5pZH1cIl1gKTtcblxuICAgICAgaWYgKCRjYXJkLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBsb2cud2FybihgW1ZhcmlhYmxlTWFuYWdlcl0g5pyq5om+5YiwSUTkuLpcIiR7dmFyaWFibGUuaWR9XCLnmoTljaHniYdgKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyDliJvlu7rmlrDljaHniYfmm7/mjaLml6fljaHniYfvvIzkv53mjIHkuIDoh7TmgKdcbiAgICAgIGNvbnN0IG5ld0NhcmQgPSB0aGlzLmNhcmRGYWN0b3J5LmNyZWF0ZUNhcmQodmFyaWFibGUpO1xuICAgICAgbmV3Q2FyZC5hdHRyKCdkYXRhLXR5cGUnLCB2YXJpYWJsZS5kYXRhVHlwZSk7XG5cbiAgICAgIGlmICh2YXJpYWJsZS5tZXNzYWdlX2lkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgbmV3Q2FyZC5hdHRyKCdkYXRhLWZsb29yLWlkJywgdmFyaWFibGUubWVzc2FnZV9pZC50b1N0cmluZygpKTtcbiAgICAgIH1cblxuICAgICAgJGNhcmQucmVwbGFjZVdpdGgobmV3Q2FyZCk7XG4gICAgICB0aGlzLmFkZEFuaW1hdGlvbihuZXdDYXJkLCAndmFyaWFibGUtY2hhbmdlZCcsICgpID0+IHt9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nLmVycm9yKGBbVmFyaWFibGVNYW5hZ2VyXSDmm7TmlrDljaHniYflpLHotKU6YCwgZXJyb3IpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmmL7npLrplK7lkI3ovpPlhaXlr7nor53moYZcbiAgICogQHBhcmFtIGNhbGxiYWNrIOi+k+WFpeWujOaIkOWQjueahOWbnuiwg+WHveaVsFxuICAgKi9cbiAgcHVibGljIGFzeW5jIHNob3dLZXlOYW1lSW5wdXREaWFsb2coY2FsbGJhY2s6IChrZXlOYW1lOiBzdHJpbmcgfCBudWxsKSA9PiB2b2lkKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgY29udGVudCA9ICQoYFxuICAgICAgPGRpdj5cbiAgICAgICAgPGgzPui+k+WFpemUruWQjTwvaDM+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJrZXktaW5wdXQtZGlhbG9nXCI+XG4gICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgaWQ9XCJrZXktaW5wdXRcIiBwbGFjZWhvbGRlcj1cIuivt+i+k+WFpemUruWQjVwiIC8+XG4gICAgICAgICAgPGRpdiBpZD1cImtleS1pbnB1dC1lcnJvclwiIGNsYXNzPVwiaW5wdXQtZXJyb3JcIiBzdHlsZT1cImRpc3BsYXk6IG5vbmVcIj7or7fovpPlhaXmnInmlYjnmoTplK7lkI08L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICBgKTtcblxuICAgIGNvbnN0ICRpbnB1dEZpZWxkID0gY29udGVudC5maW5kKCcja2V5LWlucHV0Jyk7XG4gICAgY29uc3QgJGVycm9yTXNnID0gY29udGVudC5maW5kKCcja2V5LWlucHV0LWVycm9yJyk7XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjYWxsR2VuZXJpY1BvcHVwKGNvbnRlbnQsIFBPUFVQX1RZUEUuQ09ORklSTSwgJycsIHtcbiAgICAgIG9rQnV0dG9uOiAn56Gu6K6kJyxcbiAgICAgIGNhbmNlbEJ1dHRvbjogJ+WPlua2iCcsXG4gICAgfSk7XG5cbiAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgY2FsbGJhY2sobnVsbCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3Qga2V5TmFtZSA9ICRpbnB1dEZpZWxkLnZhbCgpIGFzIHN0cmluZztcbiAgICBpZiAoIWtleU5hbWUgfHwga2V5TmFtZS50cmltKCkgPT09ICcnKSB7XG4gICAgICAkZXJyb3JNc2cuc2hvdygpO1xuICAgICAgc2V0VGltZW91dCgoKSA9PiB0aGlzLnNob3dLZXlOYW1lSW5wdXREaWFsb2coY2FsbGJhY2spLCAxMCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY2FsbGJhY2soa2V5TmFtZS50cmltKCkpO1xuICB9XG5cbiAgLyoqXG4gICAqIOa3u+WKoOWKqOeUu+aViOaenFxuICAgKiBAcGFyYW0gZWxlbWVudCDopoHmt7vliqDliqjnlLvmlYjmnpznmoTlhYPntKBcbiAgICogQHBhcmFtIGFuaW1hdGlvbkNsYXNzIENTU+WKqOeUu+exu+WQjVxuICAgKiBAcGFyYW0gY2FsbGJhY2sg5Yqo55S757uT5p2f5ZCO55qE5Zue6LCDXG4gICAqL1xuICBwdWJsaWMgYWRkQW5pbWF0aW9uKGVsZW1lbnQ6IEpRdWVyeTxIVE1MRWxlbWVudD4sIGFuaW1hdGlvbkNsYXNzOiBzdHJpbmcsIGNhbGxiYWNrOiAoKSA9PiB2b2lkKTogdm9pZCB7XG4gICAgY29uc3QgbmFtZXNwYWNlID0gYGFuaW1hdGlvbi4ke2FuaW1hdGlvbkNsYXNzfWA7XG5cbiAgICBlbGVtZW50LmFkZENsYXNzKGFuaW1hdGlvbkNsYXNzKTtcblxuICAgIHZvaWQgZWxlbWVudFswXS5vZmZzZXRIZWlnaHQ7XG5cbiAgICBlbGVtZW50Lm9mZihgYW5pbWF0aW9uZW5kLiR7bmFtZXNwYWNlfWApO1xuXG4gICAgZWxlbWVudC5vbihgYW5pbWF0aW9uZW5kLiR7bmFtZXNwYWNlfWAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICQodGhpcykub2ZmKGBhbmltYXRpb25lbmQuJHtuYW1lc3BhY2V9YCk7XG4gICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKGFuaW1hdGlvbkNsYXNzKTtcbiAgICAgIGNhbGxiYWNrKCk7XG4gICAgfSk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/component/variable_manager/view.ts\n\n}")},"./src/disable_incompatible_option.ts":
/*!********************************************!*\
  !*** ./src/disable_incompatible_option.ts ***!
  \********************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   disableIncompatibleOption: () => (/* binding */ disableIncompatibleOption)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/power-user */ \"@sillytavern/scripts/power-user\");\n\n\nfunction toggle_if_not_allowed(setting, expected) {\n    if (_.get(_sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_1__.power_user, setting) === expected) {\n        return false;\n    }\n    _.set(_sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_1__.power_user, setting, expected);\n    $(`#${setting}`).prop('checked', expected);\n    return true;\n}\nfunction disableIncompatibleOption() {\n    if (['auto_fix_generated_markdown', 'trim_sentences', 'forbid_external_media', 'encode_tags']\n        .map(setting => toggle_if_not_allowed(setting, false))\n        .some(is_changed => !!is_changed)) {\n        (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveSettingsDebounced)();\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZGlzYWJsZV9pbmNvbXBhdGlibGVfb3B0aW9uLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUE0RDtBQUNDO0FBRTdELFNBQVMscUJBQXFCLENBQUMsT0FBZSxFQUFFLFFBQWlCO0lBQy9ELElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBQyx1RUFBVSxFQUFFLE9BQU8sQ0FBQyxLQUFLLFFBQVEsRUFBRSxDQUFDO1FBQzVDLE9BQU8sS0FBSyxDQUFDO0lBQ2YsQ0FBQztJQUVELENBQUMsQ0FBQyxHQUFHLENBQUMsdUVBQVUsRUFBRSxPQUFPLEVBQUUsUUFBUSxDQUFDLENBQUM7SUFDckMsQ0FBQyxDQUFDLElBQUksT0FBTyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLFFBQVEsQ0FBQyxDQUFDO0lBQzNDLE9BQU8sSUFBSSxDQUFDO0FBQ2QsQ0FBQztBQUVNLFNBQVMseUJBQXlCO0lBQ3ZDLElBQ0UsQ0FBQyw2QkFBNkIsRUFBRSxnQkFBZ0IsRUFBRSx1QkFBdUIsRUFBRSxhQUFhLENBQUM7U0FDdEYsR0FBRyxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUMscUJBQXFCLENBQUMsT0FBTyxFQUFFLEtBQUssQ0FBQyxDQUFDO1NBQ3JELElBQUksQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsRUFDbkMsQ0FBQztRQUNELDBFQUFxQixFQUFFLENBQUM7SUFDMUIsQ0FBQztBQUNILENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvZGlzYWJsZV9pbmNvbXBhdGlibGVfb3B0aW9uLnRzPzRjNTIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc2F2ZVNldHRpbmdzRGVib3VuY2VkIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5pbXBvcnQgeyBwb3dlcl91c2VyIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvcG93ZXItdXNlcic7XG5cbmZ1bmN0aW9uIHRvZ2dsZV9pZl9ub3RfYWxsb3dlZChzZXR0aW5nOiBzdHJpbmcsIGV4cGVjdGVkOiBib29sZWFuKTogYm9vbGVhbiB7XG4gIGlmIChfLmdldChwb3dlcl91c2VyLCBzZXR0aW5nKSA9PT0gZXhwZWN0ZWQpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBfLnNldChwb3dlcl91c2VyLCBzZXR0aW5nLCBleHBlY3RlZCk7XG4gICQoYCMke3NldHRpbmd9YCkucHJvcCgnY2hlY2tlZCcsIGV4cGVjdGVkKTtcbiAgcmV0dXJuIHRydWU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkaXNhYmxlSW5jb21wYXRpYmxlT3B0aW9uKCkge1xuICBpZiAoXG4gICAgWydhdXRvX2ZpeF9nZW5lcmF0ZWRfbWFya2Rvd24nLCAndHJpbV9zZW50ZW5jZXMnLCAnZm9yYmlkX2V4dGVybmFsX21lZGlhJywgJ2VuY29kZV90YWdzJ11cbiAgICAgIC5tYXAoc2V0dGluZyA9PiB0b2dnbGVfaWZfbm90X2FsbG93ZWQoc2V0dGluZywgZmFsc2UpKVxuICAgICAgLnNvbWUoaXNfY2hhbmdlZCA9PiAhIWlzX2NoYW5nZWQpXG4gICkge1xuICAgIHNhdmVTZXR0aW5nc0RlYm91bmNlZCgpO1xuICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/disable_incompatible_option.ts\n\n}")},"./src/function/builtin.ts":
/*!*********************************!*\
  !*** ./src/function/builtin.ts ***!
  \*********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   builtin: () => (/* binding */ builtin)\n/* harmony export */ });\n/* harmony import */ var _compatibility__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/compatibility */ "./src/compatibility.ts");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/script */ "@sillytavern/script");\n/* harmony import */ var _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/scripts/openai */ "@sillytavern/scripts/openai");\n\n\n\nconst builtin = {\n    addOneMessage: _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.addOneMessage,\n    saveSettings: _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.saveSettings,\n    reloadEditor: _compatibility__WEBPACK_IMPORTED_MODULE_0__.reloadEditor,\n    reloadEditorDebounced: _compatibility__WEBPACK_IMPORTED_MODULE_0__.reloadEditorDebounced,\n    promptManager: _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_2__.promptManager,\n    renderPromptManager: _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_2__.promptManager.render,\n    renderPromptManagerDebounced: _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_2__.promptManager.renderDebounced,\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZnVuY3Rpb24vYnVpbHRpbi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQXNFO0FBQ0o7QUFDTjtBQUVyRCxNQUFNLE9BQU8sR0FBRztJQUNyQixhQUFhO0lBQ2IsWUFBWTtJQUNaLFlBQVk7SUFDWixxQkFBcUI7SUFDckIsYUFBYTtJQUNiLG1CQUFtQixFQUFFLHNFQUFhLENBQUMsTUFBTTtJQUN6Qyw0QkFBNEIsRUFBRSxzRUFBYSxDQUFDLGVBQWU7Q0FDNUQsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9mdW5jdGlvbi9idWlsdGluLnRzP2YyNzgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcmVsb2FkRWRpdG9yLCByZWxvYWRFZGl0b3JEZWJvdW5jZWQgfSBmcm9tICdAL2NvbXBhdGliaWxpdHknO1xuaW1wb3J0IHsgYWRkT25lTWVzc2FnZSwgc2F2ZVNldHRpbmdzIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5pbXBvcnQgeyBwcm9tcHRNYW5hZ2VyIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvb3BlbmFpJztcblxuZXhwb3J0IGNvbnN0IGJ1aWx0aW4gPSB7XG4gIGFkZE9uZU1lc3NhZ2UsXG4gIHNhdmVTZXR0aW5ncyxcbiAgcmVsb2FkRWRpdG9yLFxuICByZWxvYWRFZGl0b3JEZWJvdW5jZWQsXG4gIHByb21wdE1hbmFnZXIsXG4gIHJlbmRlclByb21wdE1hbmFnZXI6IHByb21wdE1hbmFnZXIucmVuZGVyLFxuICByZW5kZXJQcm9tcHRNYW5hZ2VyRGVib3VuY2VkOiBwcm9tcHRNYW5hZ2VyLnJlbmRlckRlYm91bmNlZCxcbn07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/function/builtin.ts\n\n}')},"./src/function/character.ts":
/*!***********************************!*\
  !*** ./src/function/character.ts ***!
  \***********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Character: () => (/* binding */ Character),\n/* harmony export */   getCharAvatarPath: () => (/* binding */ getCharAvatarPath),\n/* harmony export */   getCharData: () => (/* binding */ getCharData),\n/* harmony export */   getChatHistoryBrief: () => (/* binding */ getChatHistoryBrief),\n/* harmony export */   getChatHistoryDetail: () => (/* binding */ getChatHistoryDetail)\n/* harmony export */ });\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_2__);\n// TODO: 重新设计这里的接口, set 部分直接访问后端\n\n\n\nclass Character {\n    character_data;\n    constructor(character_data) {\n        this.character_data = character_data;\n    }\n    static find({ name, allow_avatar = true, }) {\n        if (!name || name === 'current') {\n            if (!_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.this_chid) {\n                return null;\n            }\n            return _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.characters[Number(_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.this_chid)];\n        }\n        if (allow_avatar) {\n            const character_by_avatar = _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.characters.find(char => char.avatar === name);\n            if (character_by_avatar) {\n                return character_by_avatar;\n            }\n        }\n        const matching_characters = _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.characters.filter(char => char.name === name || (allow_avatar && char.avatar === name));\n        if (matching_characters.length > 1) {\n            loglevel__WEBPACK_IMPORTED_MODULE_2___default().warn(`找到多个符合条件的角色, 返回导入时间最早的角色: ${name}`);\n        }\n        return matching_characters[0] || null;\n    }\n    static findCharacterIndex(name) {\n        const matchTypes = [\n            (a, b) => a === b,\n            (a, b) => a.startsWith(b),\n            (a, b) => a.includes(b),\n        ];\n        const exactAvatarMatch = _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.characters.findIndex(x => x.avatar === name);\n        if (exactAvatarMatch !== -1) {\n            return exactAvatarMatch;\n        }\n        for (const matchType of matchTypes) {\n            const index = _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.characters.findIndex(x => matchType(x.name.toLowerCase(), name.toLowerCase()));\n            if (index !== -1) {\n                return index;\n            }\n        }\n        return -1;\n    }\n    static async getChatsFromFiles(data, isGroupChat) {\n        const chat_dict = {};\n        const chat_list = Object.values(data)\n            .sort((a, b) => a['file_name'].localeCompare(b['file_name']))\n            .reverse();\n        const chat_promise = chat_list.map(async ({ file_name }) => {\n            // 从文件名中提取角色名称（破折号前的部分）\n            const ch_name = isGroupChat ? '' : file_name.split(' - ')[0];\n            // 使用Character.find方法查找角色，获取头像\n            let characterData = null;\n            let avatar_url = '';\n            if (!isGroupChat && ch_name) {\n                characterData = Character.find({ name: ch_name });\n                if (characterData) {\n                    avatar_url = characterData.avatar;\n                }\n            }\n            const endpoint = isGroupChat ? '/api/chats/group/get' : '/api/chats/get';\n            const requestBody = isGroupChat\n                ? JSON.stringify({ id: file_name })\n                : JSON.stringify({\n                    ch_name: ch_name,\n                    file_name: file_name.replace('.jsonl', ''),\n                    avatar_url: avatar_url,\n                });\n            const chatResponse = await fetch(endpoint, {\n                method: 'POST',\n                headers: (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.getRequestHeaders)(),\n                body: requestBody,\n                cache: 'no-cache',\n            });\n            if (!chatResponse.ok) {\n                return;\n            }\n            const currentChat = await chatResponse.json();\n            if (!isGroupChat) {\n                // remove the first message, which is metadata, only for individual chats\n                currentChat.shift();\n            }\n            chat_dict[file_name] = currentChat;\n        });\n        await Promise.all(chat_promise);\n        return chat_dict;\n    }\n    getCardData() {\n        return this.character_data;\n    }\n    getAvatarId() {\n        return this.character_data.avatar || '';\n    }\n    getRegexScripts() {\n        return this.character_data.data?.extensions?.regex_scripts || [];\n    }\n    getCharacterBook() {\n        return this.character_data.data?.character_book || null;\n    }\n    getWorldName() {\n        return this.character_data.data?.extensions?.world || '';\n    }\n}\nfunction getCharData(name, allowAvatar = true) {\n    try {\n        // backward compatibility\n        name = !name ? 'current' : name;\n        const characterData = Character.find({ name, allow_avatar: allowAvatar });\n        if (!characterData)\n            return null;\n        const character = new Character(characterData);\n        loglevel__WEBPACK_IMPORTED_MODULE_2___default().info(`获取角色卡数据成功, 角色: ${name || '未知'}`);\n        return character.getCardData();\n    }\n    catch (error) {\n        loglevel__WEBPACK_IMPORTED_MODULE_2___default().error(`获取角色卡数据失败, 角色: ${name || '未知'}`, error);\n        return null;\n    }\n}\nfunction getCharAvatarPath(name, allowAvatar = true) {\n    // backward compatibility\n    name = !name ? 'current' : name;\n    const characterData = Character.find({ name, allow_avatar: allowAvatar });\n    if (!characterData) {\n        return null;\n    }\n    const character = new Character(characterData);\n    const avatarId = character.getAvatarId();\n    // 使用getThumbnailUrl获取缩略图URL，然后提取实际文件名\n    const thumbnailPath = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.getThumbnailUrl)('avatar', avatarId);\n    const targetAvatarImg = thumbnailPath.substring(thumbnailPath.lastIndexOf('=') + 1);\n    // 假设charsPath在其他地方定义\n    loglevel__WEBPACK_IMPORTED_MODULE_2___default().info(`获取角色头像路径成功, 角色: ${name || '未知'}`);\n    return _util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.charsPath + targetAvatarImg;\n}\nasync function getChatHistoryBrief(name, allowAvatar = true) {\n    // backward compatibility\n    name = !name ? 'current' : name;\n    const character_data = Character.find({ name, allow_avatar: allowAvatar });\n    if (!character_data) {\n        return null;\n    }\n    const character = new Character(character_data);\n    const index = Character.findCharacterIndex(character.getAvatarId());\n    if (index === -1) {\n        return null;\n    }\n    const chats = await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.getPastCharacterChats)(index);\n    loglevel__WEBPACK_IMPORTED_MODULE_2___default().info(`获取角色聊天历史摘要成功, 角色: ${name || '未知'}`);\n    return chats;\n}\nasync function getChatHistoryDetail(data, isGroupChat = false) {\n    const result = await Character.getChatsFromFiles(data, isGroupChat);\n    loglevel__WEBPACK_IMPORTED_MODULE_2___default().info(`获取聊天文件详情成功`);\n    return result;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUMsQ0FBQztJQUM5QyxPQUFPLEtBQUssQ0FBQztBQUNmLENBQUM7QUFFTSxLQUFLLFVBQVUsb0JBQW9CLENBQ3hDLElBQVcsRUFDWCxjQUF1QixLQUFLO0lBRTVCLE1BQU0sTUFBTSxHQUFHLE1BQU0sU0FBUyxDQUFDLGlCQUFpQixDQUFDLElBQUksRUFBRSxXQUFXLENBQUMsQ0FBQztJQUNwRSxvREFBUSxDQUFDLFlBQVksQ0FBQyxDQUFDO0lBQ3ZCLE9BQU8sTUFBTSxDQUFDO0FBQ2hCLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvZnVuY3Rpb24vY2hhcmFjdGVyLnRzPzM0NjgiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVE9ETzog6YeN5paw6K6+6K6h6L+Z6YeM55qE5o6l5Y+jLCBzZXQg6YOo5YiG55u05o6l6K6/6Zeu5ZCO56uvXG5pbXBvcnQgeyBjaGFyc1BhdGggfSBmcm9tICdAL3V0aWwvZXh0ZW5zaW9uX3ZhcmlhYmxlcyc7XG5cbmltcG9ydCB7IGNoYXJhY3RlcnMsIGdldFBhc3RDaGFyYWN0ZXJDaGF0cywgZ2V0UmVxdWVzdEhlYWRlcnMsIGdldFRodW1ibmFpbFVybCwgdGhpc19jaGlkIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5pbXBvcnQgeyB2MUNoYXJEYXRhIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvY2hhci1kYXRhJztcblxuaW1wb3J0IGxvZyBmcm9tICdsb2dsZXZlbCc7XG5pbXBvcnQgeyBMaXRlcmFsVW5pb24gfSBmcm9tICd0eXBlLWZlc3QnO1xuXG5leHBvcnQgY2xhc3MgQ2hhcmFjdGVyIHtcbiAgcHJpdmF0ZSBjaGFyYWN0ZXJfZGF0YTogdjFDaGFyRGF0YTtcblxuICBjb25zdHJ1Y3RvcihjaGFyYWN0ZXJfZGF0YTogdjFDaGFyRGF0YSkge1xuICAgIHRoaXMuY2hhcmFjdGVyX2RhdGEgPSBjaGFyYWN0ZXJfZGF0YTtcbiAgfVxuXG4gIHN0YXRpYyBmaW5kKHtcbiAgICBuYW1lLFxuICAgIGFsbG93X2F2YXRhciA9IHRydWUsXG4gIH06IHtcbiAgICBuYW1lOiBMaXRlcmFsVW5pb248J2N1cnJlbnQnLCBzdHJpbmc+O1xuICAgIGFsbG93X2F2YXRhcj86IGJvb2xlYW47XG4gIH0pOiB2MUNoYXJEYXRhIHwgbnVsbCB7XG4gICAgaWYgKCFuYW1lIHx8IG5hbWUgPT09ICdjdXJyZW50Jykge1xuICAgICAgaWYgKCF0aGlzX2NoaWQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICByZXR1cm4gY2hhcmFjdGVyc1tOdW1iZXIodGhpc19jaGlkKV07XG4gICAgfVxuXG4gICAgaWYgKGFsbG93X2F2YXRhcikge1xuICAgICAgY29uc3QgY2hhcmFjdGVyX2J5X2F2YXRhciA9IGNoYXJhY3RlcnMuZmluZChjaGFyID0+IGNoYXIuYXZhdGFyID09PSBuYW1lKTtcbiAgICAgIGlmIChjaGFyYWN0ZXJfYnlfYXZhdGFyKSB7XG4gICAgICAgIHJldHVybiBjaGFyYWN0ZXJfYnlfYXZhdGFyO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IG1hdGNoaW5nX2NoYXJhY3RlcnMgPSBjaGFyYWN0ZXJzLmZpbHRlcihjaGFyID0+IGNoYXIubmFtZSA9PT0gbmFtZSB8fCAoYWxsb3dfYXZhdGFyICYmIGNoYXIuYXZhdGFyID09PSBuYW1lKSk7XG4gICAgaWYgKG1hdGNoaW5nX2NoYXJhY3RlcnMubGVuZ3RoID4gMSkge1xuICAgICAgbG9nLndhcm4oYOaJvuWIsOWkmuS4quespuWQiOadoeS7tueahOinkuiJsiwg6L+U5Zue5a+85YWl5pe26Ze05pyA5pep55qE6KeS6ImyOiAke25hbWV9YCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG1hdGNoaW5nX2NoYXJhY3RlcnNbMF0gfHwgbnVsbDtcbiAgfVxuXG4gIHN0YXRpYyBmaW5kQ2hhcmFjdGVySW5kZXgobmFtZTogc3RyaW5nKTogbnVtYmVyIHtcbiAgICBjb25zdCBtYXRjaFR5cGVzID0gW1xuICAgICAgKGE6IHN0cmluZywgYjogc3RyaW5nKSA9PiBhID09PSBiLFxuICAgICAgKGE6IHN0cmluZywgYjogc3RyaW5nKSA9PiBhLnN0YXJ0c1dpdGgoYiksXG4gICAgICAoYTogc3RyaW5nLCBiOiBzdHJpbmcpID0+IGEuaW5jbHVkZXMoYiksXG4gICAgXTtcblxuICAgIGNvbnN0IGV4YWN0QXZhdGFyTWF0Y2ggPSBjaGFyYWN0ZXJzLmZpbmRJbmRleCh4ID0+IHguYXZhdGFyID09PSBuYW1lKTtcblxuICAgIGlmIChleGFjdEF2YXRhck1hdGNoICE9PSAtMSkge1xuICAgICAgcmV0dXJuIGV4YWN0QXZhdGFyTWF0Y2g7XG4gICAgfVxuXG4gICAgZm9yIChjb25zdCBtYXRjaFR5cGUgb2YgbWF0Y2hUeXBlcykge1xuICAgICAgY29uc3QgaW5kZXggPSBjaGFyYWN0ZXJzLmZpbmRJbmRleCh4ID0+IG1hdGNoVHlwZSh4Lm5hbWUudG9Mb3dlckNhc2UoKSwgbmFtZS50b0xvd2VyQ2FzZSgpKSk7XG4gICAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICAgIHJldHVybiBpbmRleDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gLTE7XG4gIH1cblxuICBzdGF0aWMgYXN5bmMgZ2V0Q2hhdHNGcm9tRmlsZXMoZGF0YTogYW55W10sIGlzR3JvdXBDaGF0OiBib29sZWFuKTogUHJvbWlzZTxSZWNvcmQ8c3RyaW5nLCBhbnk+PiB7XG4gICAgY29uc3QgY2hhdF9kaWN0OiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0ge307XG4gICAgY29uc3QgY2hhdF9saXN0ID0gT2JqZWN0LnZhbHVlcyhkYXRhKVxuICAgICAgLnNvcnQoKGEsIGIpID0+IGFbJ2ZpbGVfbmFtZSddLmxvY2FsZUNvbXBhcmUoYlsnZmlsZV9uYW1lJ10pKVxuICAgICAgLnJldmVyc2UoKTtcblxuICAgIGNvbnN0IGNoYXRfcHJvbWlzZSA9IGNoYXRfbGlzdC5tYXAoYXN5bmMgKHsgZmlsZV9uYW1lIH0pID0+IHtcbiAgICAgIC8vIOS7juaWh+S7tuWQjeS4reaPkOWPluinkuiJsuWQjeensO+8iOegtOaKmOWPt+WJjeeahOmDqOWIhu+8iVxuICAgICAgY29uc3QgY2hfbmFtZSA9IGlzR3JvdXBDaGF0ID8gJycgOiBmaWxlX25hbWUuc3BsaXQoJyAtICcpWzBdO1xuXG4gICAgICAvLyDkvb/nlKhDaGFyYWN0ZXIuZmluZOaWueazleafpeaJvuinkuiJsu+8jOiOt+WPluWktOWDj1xuICAgICAgbGV0IGNoYXJhY3RlckRhdGEgPSBudWxsO1xuICAgICAgbGV0IGF2YXRhcl91cmwgPSAnJztcblxuICAgICAgaWYgKCFpc0dyb3VwQ2hhdCAmJiBjaF9uYW1lKSB7XG4gICAgICAgIGNoYXJhY3RlckRhdGEgPSBDaGFyYWN0ZXIuZmluZCh7IG5hbWU6IGNoX25hbWUgfSk7XG4gICAgICAgIGlmIChjaGFyYWN0ZXJEYXRhKSB7XG4gICAgICAgICAgYXZhdGFyX3VybCA9IGNoYXJhY3RlckRhdGEuYXZhdGFyO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGVuZHBvaW50ID0gaXNHcm91cENoYXQgPyAnL2FwaS9jaGF0cy9ncm91cC9nZXQnIDogJy9hcGkvY2hhdHMvZ2V0JztcbiAgICAgIGNvbnN0IHJlcXVlc3RCb2R5ID0gaXNHcm91cENoYXRcbiAgICAgICAgPyBKU09OLnN0cmluZ2lmeSh7IGlkOiBmaWxlX25hbWUgfSlcbiAgICAgICAgOiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBjaF9uYW1lOiBjaF9uYW1lLFxuICAgICAgICAgICAgZmlsZV9uYW1lOiBmaWxlX25hbWUucmVwbGFjZSgnLmpzb25sJywgJycpLFxuICAgICAgICAgICAgYXZhdGFyX3VybDogYXZhdGFyX3VybCxcbiAgICAgICAgICB9KTtcblxuICAgICAgY29uc3QgY2hhdFJlc3BvbnNlID0gYXdhaXQgZmV0Y2goZW5kcG9pbnQsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGhlYWRlcnM6IGdldFJlcXVlc3RIZWFkZXJzKCksXG4gICAgICAgIGJvZHk6IHJlcXVlc3RCb2R5LFxuICAgICAgICBjYWNoZTogJ25vLWNhY2hlJyxcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoIWNoYXRSZXNwb25zZS5vaykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGN1cnJlbnRDaGF0ID0gYXdhaXQgY2hhdFJlc3BvbnNlLmpzb24oKTtcbiAgICAgIGlmICghaXNHcm91cENoYXQpIHtcbiAgICAgICAgLy8gcmVtb3ZlIHRoZSBmaXJzdCBtZXNzYWdlLCB3aGljaCBpcyBtZXRhZGF0YSwgb25seSBmb3IgaW5kaXZpZHVhbCBjaGF0c1xuICAgICAgICBjdXJyZW50Q2hhdC5zaGlmdCgpO1xuICAgICAgfVxuICAgICAgY2hhdF9kaWN0W2ZpbGVfbmFtZV0gPSBjdXJyZW50Q2hhdDtcbiAgICB9KTtcblxuICAgIGF3YWl0IFByb21pc2UuYWxsKGNoYXRfcHJvbWlzZSk7XG5cbiAgICByZXR1cm4gY2hhdF9kaWN0O1xuICB9XG5cbiAgZ2V0Q2FyZERhdGEoKTogdjFDaGFyRGF0YSB7XG4gICAgcmV0dXJuIHRoaXMuY2hhcmFjdGVyX2RhdGE7XG4gIH1cblxuICBnZXRBdmF0YXJJZCgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLmNoYXJhY3Rlcl9kYXRhLmF2YXRhciB8fCAnJztcbiAgfVxuXG4gIGdldFJlZ2V4U2NyaXB0cygpOiBBcnJheTx7XG4gICAgaWQ6IHN0cmluZztcbiAgICBzY3JpcHROYW1lOiBzdHJpbmc7XG4gICAgZmluZFJlZ2V4OiBzdHJpbmc7XG4gICAgcmVwbGFjZVN0cmluZzogc3RyaW5nO1xuICAgIHRyaW1TdHJpbmdzOiBzdHJpbmdbXTtcbiAgICBwbGFjZW1lbnQ6IG51bWJlcltdO1xuICAgIGRpc2FibGVkOiBib29sZWFuO1xuICAgIG1hcmtkb3duT25seTogYm9vbGVhbjtcbiAgICBwcm9tcHRPbmx5OiBib29sZWFuO1xuICAgIHJ1bk9uRWRpdDogYm9vbGVhbjtcbiAgICBzdWJzdGl0dXRlUmVnZXg6IG51bWJlciB8IGJvb2xlYW47XG4gICAgbWluRGVwdGg6IG51bWJlcjtcbiAgICBtYXhEZXB0aDogbnVtYmVyO1xuICB9PiB7XG4gICAgcmV0dXJuIHRoaXMuY2hhcmFjdGVyX2RhdGEuZGF0YT8uZXh0ZW5zaW9ucz8ucmVnZXhfc2NyaXB0cyB8fCBbXTtcbiAgfVxuXG4gIGdldENoYXJhY3RlckJvb2soKToge1xuICAgIG5hbWU6IHN0cmluZztcbiAgICBlbnRyaWVzOiBBcnJheTx7XG4gICAgICBrZXlzOiBzdHJpbmdbXTtcbiAgICAgIHNlY29uZGFyeV9rZXlzPzogc3RyaW5nW107XG4gICAgICBjb21tZW50OiBzdHJpbmc7XG4gICAgICBjb250ZW50OiBzdHJpbmc7XG4gICAgICBjb25zdGFudDogYm9vbGVhbjtcbiAgICAgIHNlbGVjdGl2ZTogYm9vbGVhbjtcbiAgICAgIGluc2VydGlvbl9vcmRlcjogbnVtYmVyO1xuICAgICAgZW5hYmxlZDogYm9vbGVhbjtcbiAgICAgIHBvc2l0aW9uOiBzdHJpbmc7XG4gICAgICBleHRlbnNpb25zOiBhbnk7XG4gICAgICBpZDogbnVtYmVyO1xuICAgIH0+O1xuICB9IHwgbnVsbCB7XG4gICAgcmV0dXJuIHRoaXMuY2hhcmFjdGVyX2RhdGEuZGF0YT8uY2hhcmFjdGVyX2Jvb2sgfHwgbnVsbDtcbiAgfVxuXG4gIGdldFdvcmxkTmFtZSgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLmNoYXJhY3Rlcl9kYXRhLmRhdGE/LmV4dGVuc2lvbnM/LndvcmxkIHx8ICcnO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDaGFyRGF0YShuYW1lOiBMaXRlcmFsVW5pb248J2N1cnJlbnQnLCBzdHJpbmc+LCBhbGxvd0F2YXRhcjogYm9vbGVhbiA9IHRydWUpOiB2MUNoYXJEYXRhIHwgbnVsbCB7XG4gIHRyeSB7XG4gICAgLy8gYmFja3dhcmQgY29tcGF0aWJpbGl0eVxuICAgIG5hbWUgPSAhbmFtZSA/ICdjdXJyZW50JyA6IG5hbWU7XG5cbiAgICBjb25zdCBjaGFyYWN0ZXJEYXRhID0gQ2hhcmFjdGVyLmZpbmQoeyBuYW1lLCBhbGxvd19hdmF0YXI6IGFsbG93QXZhdGFyIH0pO1xuICAgIGlmICghY2hhcmFjdGVyRGF0YSkgcmV0dXJuIG51bGw7XG5cbiAgICBjb25zdCBjaGFyYWN0ZXIgPSBuZXcgQ2hhcmFjdGVyKGNoYXJhY3RlckRhdGEpO1xuICAgIGxvZy5pbmZvKGDojrflj5bop5LoibLljaHmlbDmja7miJDlip8sIOinkuiJsjogJHtuYW1lIHx8ICfmnKrnn6UnfWApO1xuICAgIHJldHVybiBjaGFyYWN0ZXIuZ2V0Q2FyZERhdGEoKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBsb2cuZXJyb3IoYOiOt+WPluinkuiJsuWNoeaVsOaNruWksei0pSwg6KeS6ImyOiAke25hbWUgfHwgJ+acquefpSd9YCwgZXJyb3IpO1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDaGFyQXZhdGFyUGF0aChuYW1lOiBMaXRlcmFsVW5pb248J2N1cnJlbnQnLCBzdHJpbmc+LCBhbGxvd0F2YXRhcjogYm9vbGVhbiA9IHRydWUpOiBzdHJpbmcgfCBudWxsIHtcbiAgLy8gYmFja3dhcmQgY29tcGF0aWJpbGl0eVxuICBuYW1lID0gIW5hbWUgPyAnY3VycmVudCcgOiBuYW1lO1xuXG4gIGNvbnN0IGNoYXJhY3RlckRhdGEgPSBDaGFyYWN0ZXIuZmluZCh7IG5hbWUsIGFsbG93X2F2YXRhcjogYWxsb3dBdmF0YXIgfSk7XG4gIGlmICghY2hhcmFjdGVyRGF0YSkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgY29uc3QgY2hhcmFjdGVyID0gbmV3IENoYXJhY3RlcihjaGFyYWN0ZXJEYXRhKTtcbiAgY29uc3QgYXZhdGFySWQgPSBjaGFyYWN0ZXIuZ2V0QXZhdGFySWQoKTtcblxuICAvLyDkvb/nlKhnZXRUaHVtYm5haWxVcmzojrflj5bnvKnnlaXlm75VUkzvvIznhLblkI7mj5Dlj5blrp7pmYXmlofku7blkI1cbiAgY29uc3QgdGh1bWJuYWlsUGF0aCA9IGdldFRodW1ibmFpbFVybCgnYXZhdGFyJywgYXZhdGFySWQpO1xuICBjb25zdCB0YXJnZXRBdmF0YXJJbWcgPSB0aHVtYm5haWxQYXRoLnN1YnN0cmluZyh0aHVtYm5haWxQYXRoLmxhc3RJbmRleE9mKCc9JykgKyAxKTtcblxuICAvLyDlgYforr5jaGFyc1BhdGjlnKjlhbbku5blnLDmlrnlrprkuYlcbiAgbG9nLmluZm8oYOiOt+WPluinkuiJsuWktOWDj+i3r+W+hOaIkOWKnywg6KeS6ImyOiAke25hbWUgfHwgJ+acquefpSd9YCk7XG4gIHJldHVybiBjaGFyc1BhdGggKyB0YXJnZXRBdmF0YXJJbWc7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDaGF0SGlzdG9yeUJyaWVmKFxuICBuYW1lOiBMaXRlcmFsVW5pb248J2N1cnJlbnQnLCBzdHJpbmc+LFxuICBhbGxvd0F2YXRhcjogYm9vbGVhbiA9IHRydWUsXG4pOiBQcm9taXNlPGFueVtdIHwgbnVsbD4ge1xuICAvLyBiYWNrd2FyZCBjb21wYXRpYmlsaXR5XG4gIG5hbWUgPSAhbmFtZSA/ICdjdXJyZW50JyA6IG5hbWU7XG5cbiAgY29uc3QgY2hhcmFjdGVyX2RhdGEgPSBDaGFyYWN0ZXIuZmluZCh7IG5hbWUsIGFsbG93X2F2YXRhcjogYWxsb3dBdmF0YXIgfSk7XG4gIGlmICghY2hhcmFjdGVyX2RhdGEpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIGNvbnN0IGNoYXJhY3RlciA9IG5ldyBDaGFyYWN0ZXIoY2hhcmFjdGVyX2RhdGEpO1xuICBjb25zdCBpbmRleCA9IENoYXJhY3Rlci5maW5kQ2hhcmFjdGVySW5kZXgoY2hhcmFjdGVyLmdldEF2YXRhcklkKCkpO1xuICBpZiAoaW5kZXggPT09IC0xKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBjb25zdCBjaGF0cyA9IGF3YWl0IGdldFBhc3RDaGFyYWN0ZXJDaGF0cyhpbmRleCk7XG4gIGxvZy5pbmZvKGDojrflj5bop5LoibLogYrlpKnljoblj7LmkZjopoHmiJDlip8sIOinkuiJsjogJHtuYW1lIHx8ICfmnKrnn6UnfWApO1xuICByZXR1cm4gY2hhdHM7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDaGF0SGlzdG9yeURldGFpbChcbiAgZGF0YTogYW55W10sXG4gIGlzR3JvdXBDaGF0OiBib29sZWFuID0gZmFsc2UsXG4pOiBQcm9taXNlPFJlY29yZDxzdHJpbmcsIGFueT4gfCBudWxsPiB7XG4gIGNvbnN0IHJlc3VsdCA9IGF3YWl0IENoYXJhY3Rlci5nZXRDaGF0c0Zyb21GaWxlcyhkYXRhLCBpc0dyb3VwQ2hhdCk7XG4gIGxvZy5pbmZvKGDojrflj5bogYrlpKnmlofku7bor6bmg4XmiJDlip9gKTtcbiAgcmV0dXJuIHJlc3VsdDtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/function/character.ts\n\n}")},"./src/function/chat_message.ts":
/*!**************************************!*\
  !*** ./src/function/chat_message.ts ***!
  \**************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createChatMessages: () => (/* binding */ createChatMessages),\n/* harmony export */   deleteChatMessages: () => (/* binding */ deleteChatMessages),\n/* harmony export */   getChatMessages: () => (/* binding */ getChatMessages),\n/* harmony export */   rotateChatMessages: () => (/* binding */ rotateChatMessages),\n/* harmony export */   setChatMessage: () => (/* binding */ setChatMessage),\n/* harmony export */   setChatMessages: () => (/* binding */ setChatMessages)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_1__);\n\n\nfunction string_to_range(input, min, max) {\n    let start, end;\n    if (input.match(/^(-?\\d+)$/)) {\n        const value = Number(input);\n        start = end = value < 0 ? max + value + 1 : value;\n    }\n    else {\n        const match = input.match(/^(-?\\d+)-(-?\\d+)$/);\n        if (!match) {\n            return null;\n        }\n        [start, end] = _.sortBy([match[1], match[2]].map(value => Number(value)).map(value => (value < 0 ? max + value + 1 : value)));\n    }\n    if (isNaN(start) || isNaN(end) || start > end || start < min || end > max) {\n        return null;\n    }\n    return { start, end };\n}\nfunction getChatMessages(range, { role = 'all', hide_state = 'all', include_swipes = false } = {}) {\n    const range_demacroed = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.substituteParamsExtended)(range.toString());\n    const range_number = string_to_range(range_demacroed, 0, _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.length - 1);\n    if (!range_number) {\n        throw Error(`提供的消息范围 range 无效: ${range}`);\n    }\n    if (!['all', 'system', 'assistant', 'user'].includes(role)) {\n        throw Error(`提供的 role 无效, 请提供 'all', 'system', 'assistant' 或 'user', 你提供的是: ${role}`);\n    }\n    if (!['all', 'hidden', 'unhidden'].includes(hide_state)) {\n        throw Error(`提供的 hide_state 无效, 请提供 'all', 'hidden' 或 'unhidden', 你提供的是: ${hide_state}`);\n    }\n    const { start, end } = range_number;\n    const get_role = (chat_message) => {\n        const is_narrator = chat_message.extra?.type === _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.system_message_types.NARRATOR;\n        if (is_narrator) {\n            if (chat_message.is_user) {\n                return 'unknown';\n            }\n            return 'system';\n        }\n        if (chat_message.is_user) {\n            return 'user';\n        }\n        return 'assistant';\n    };\n    const process_message = (message_id) => {\n        const message = _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat[message_id];\n        if (!message) {\n            loglevel__WEBPACK_IMPORTED_MODULE_1___default().warn(`没找到第 ${message_id} 楼的消息`);\n            return null;\n        }\n        const message_role = get_role(message);\n        if (role !== 'all' && message_role !== role) {\n            loglevel__WEBPACK_IMPORTED_MODULE_1___default().debug(`筛去了第 ${message_id} 楼的消息因为它的身份不是 ${role}`);\n            return null;\n        }\n        if (hide_state !== 'all' && (hide_state === 'hidden') !== message.is_system) {\n            loglevel__WEBPACK_IMPORTED_MODULE_1___default().debug(`筛去了第 ${message_id} 楼的消息因为它${hide_state === 'hidden' ? `` : `没`} 被隐藏`);\n            return null;\n        }\n        const swipe_id = message?.swipe_id ?? 0;\n        const swipes = message?.swipes ?? [message.mes];\n        const swipes_data = message?.variables ?? [{}];\n        const swipes_info = message?.swipes_info ?? [message?.extra ?? {}];\n        const extra = swipes_info[swipe_id];\n        const data = swipes_data[swipe_id];\n        if (include_swipes) {\n            return {\n                message_id: message_id,\n                name: message.name,\n                role: message_role,\n                is_hidden: message.is_system,\n                swipe_id: swipe_id,\n                swipes: swipes,\n                swipes_data: swipes_data,\n                swipes_info: swipes_info,\n            };\n        }\n        return {\n            message_id: message_id,\n            name: message.name,\n            role: message_role,\n            is_hidden: message.is_system,\n            message: message.mes,\n            data: data,\n            extra: extra,\n            // for compatibility\n            swipe_id: swipe_id,\n            swipes: swipes,\n            swipes_data: swipes_data,\n        };\n    };\n    const chat_messages = _.range(start, end + 1)\n        .map(i => process_message(i))\n        .filter(chat_message => chat_message !== null);\n    loglevel__WEBPACK_IMPORTED_MODULE_1___default().info(`获取${start == end ? `第 ${start} ` : ` ${start}-${end} `}楼的消息, 选项: ${JSON.stringify({\n        role,\n        hide_state,\n        include_swipes,\n    })} `);\n    return structuredClone(chat_messages);\n}\nasync function setChatMessages(chat_messages, { refresh = 'affected' } = {}) {\n    const is_chat_message = (chat_message) => {\n        return _.has(chat_message, 'message') || _.has(chat_message, 'data');\n    };\n    const modify = async (chat_message) => {\n        const data = _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat[chat_message.message_id];\n        if (data === undefined) {\n            return;\n        }\n        if (chat_message?.name !== undefined) {\n            _.set(data, 'name', chat_message.name);\n        }\n        if (chat_message?.role !== undefined) {\n            _.set(data, 'is_user', chat_message.role === 'user');\n        }\n        if (chat_message?.is_hidden !== undefined) {\n            _.set(data, 'is_system', chat_message.is_hidden);\n        }\n        if (is_chat_message(chat_message)) {\n            if (chat_message?.message !== undefined) {\n                _.set(data, 'mes', chat_message.message);\n                if (data?.swipes !== undefined) {\n                    _.set(data, ['swipes', data.swipe_id], chat_message.message);\n                }\n            }\n            if (chat_message?.data !== undefined) {\n                if (data?.variables === undefined) {\n                    _.set(data, 'variables', _.times(data.swipes?.length ?? 1, _.constant({})));\n                }\n                _.set(data, ['variables', data.swipe_id ?? 0], chat_message.data);\n                _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.emit('message_variables_changed', {\n                    message_id: chat_message.message_id,\n                    variables: chat_message.data,\n                });\n            }\n            if (chat_message?.extra !== undefined) {\n                if (data?.swipes_info === undefined) {\n                    _.set(data, 'swipes_info', _.times(data.swipes?.length ?? 1, _.constant({})));\n                }\n                _.set(data, 'extra', chat_message?.extra);\n                _.set(data, ['swipes_info', data.swipe_id ?? 0], chat_message?.extra);\n            }\n        }\n        else if (chat_message?.swipe_id !== undefined ||\n            chat_message?.swipes !== undefined ||\n            chat_message?.swipes_data !== undefined ||\n            chat_message?.swipes_info !== undefined) {\n            _.set(chat_message, 'swipe_id', chat_message.swipe_id ?? data.swipe_id ?? 0);\n            _.set(chat_message, 'swipes', chat_message.swipes ?? data.swipes ?? [data.mes]);\n            _.set(chat_message, 'swipes_data', chat_message.swipes_data ?? data.variables ?? [{}]);\n            _.set(chat_message, 'swipes_info', chat_message.swipes_info ?? data.swipes_info ?? [{}]);\n            const max_length = _.max([chat_message.swipes?.length, chat_message.swipes_data?.length, chat_message.swipes_info?.length]) ?? 1;\n            chat_message.swipes.length = max_length;\n            chat_message.swipes_data.length = max_length;\n            chat_message.swipes_info.length = max_length;\n            _.set(data, 'swipes', chat_message.swipes);\n            _.set(data, 'variables', chat_message.swipes_data);\n            _.set(data, 'swipes_info', chat_message.swipes_info);\n            _.set(data, 'swipe_id', chat_message.swipe_id);\n            _.set(data, 'mes', data.swipes[data.swipe_id]);\n            _.set(data, 'extra', data.swipes_info[data.swipe_id]);\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.emit('message_variables_changed', {\n                message_id: chat_message.message_id,\n                variables: chat_message.swipes_data[chat_message.swipe_id],\n            });\n        }\n    };\n    const render = async (message_id) => {\n        const $mes_html = $(`div.mes[mesid = \"${message_id}\"]`);\n        if (!$mes_html) {\n            return;\n        }\n        const chat_message = _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat[message_id];\n        if (chat_message.swipes) {\n            $mes_html.find('.swipes-counter').text(`${chat_message.swipe_id + 1}\\u200b/\\u200b${chat_message.swipes.length}`);\n        }\n        $mes_html\n            .find('.mes_text')\n            .empty()\n            .append((0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.messageFormatting)(chat_message.mes, chat_message.name, chat_message.is_system, chat_message.is_user, message_id));\n        await _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.emit(chat_message.is_user ? _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.USER_MESSAGE_RENDERED : _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.CHARACTER_MESSAGE_RENDERED, message_id);\n    };\n    await Promise.all(chat_messages.map(modify));\n    await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveChatConditional)();\n    if (refresh === 'all') {\n        await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.reloadCurrentChat)();\n    }\n    else if (refresh === 'affected') {\n        await Promise.all(chat_messages.map(message => render(message.message_id)));\n    }\n    loglevel__WEBPACK_IMPORTED_MODULE_1___default().info(`修改第 '${chat_messages.map(message => message.message_id).join(', ')}' 楼的消息, 选项: ${JSON.stringify({\n        refresh,\n    })}`);\n}\nasync function createChatMessages(chat_messages, { insert_at = 'end', refresh = 'affected' } = {}) {\n    if (insert_at !== 'end') {\n        insert_at = insert_at < 0 ? _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.length + insert_at : insert_at;\n        if (insert_at < 0 || insert_at > _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.length) {\n            throw Error(`提供的 insert_at 无效, 请提供一个在 '0' 到 '${_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.length}' 之间的整数, 你提供的是: '${insert_at}'`);\n        }\n    }\n    const convert = async (chat_message) => {\n        const result = {};\n        if (chat_message?.name !== undefined) {\n            _.set(result, 'name', chat_message.name);\n        }\n        else if (chat_message.role === 'user') {\n            _.set(result, 'name', _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name1);\n        }\n        else {\n            _.set(result, 'name', _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name2);\n        }\n        // TODO: avatar\n        _.set(result, 'is_user', chat_message.role === 'user');\n        _.set(result, 'is_system', chat_message.is_hidden ?? false);\n        _.set(result, 'mes', chat_message.message);\n        _.set(result, ['variables', 0], chat_message.data ?? {});\n        return result;\n    };\n    const converted = await Promise.all(chat_messages.map(convert));\n    if (insert_at === 'end') {\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.push(...converted);\n    }\n    else {\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.splice(insert_at, 0, ...converted);\n    }\n    await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveChatConditional)();\n    if (refresh === 'affected' && insert_at === 'end') {\n        converted.forEach(message => (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.addOneMessage)(message));\n    }\n    else {\n        await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.reloadCurrentChat)();\n    }\n    loglevel__WEBPACK_IMPORTED_MODULE_1___default().info(`在${insert_at === 'end' ? '最后' : `第 ${insert_at} 楼前`}创建 ${chat_messages.length} 条消息, 选项: ${JSON.stringify({\n        insert_at,\n        refresh,\n    })}`);\n}\nasync function deleteChatMessages(message_ids, { refresh = 'all' } = {}) {\n    message_ids = message_ids.map(id => (id < 0 ? _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.length + id : id)).filter(id => id >= 0 && id < _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.length);\n    _.pullAt(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat, message_ids);\n    await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveChatConditional)();\n    if (refresh === 'all') {\n        await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.reloadCurrentChat)();\n    }\n    loglevel__WEBPACK_IMPORTED_MODULE_1___default().info(`删除第 '${message_ids.join(', ')}' 楼的消息, 选项: ${JSON.stringify({\n        refresh,\n    })}`);\n}\nasync function rotateChatMessages(begin, middle, end, { refresh = 'all' } = {}) {\n    const right_part = _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.splice(middle, end - middle);\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.splice(begin, 0, ...right_part);\n    await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveChatConditional)();\n    if (refresh === 'all') {\n        await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.reloadCurrentChat)();\n    }\n    loglevel__WEBPACK_IMPORTED_MODULE_1___default().info(`旋转第 '[${begin}, ${middle}) [${middle}, ${end})' 楼的消息, 选项: ${JSON.stringify({\n        refresh,\n    })}`);\n}\n//----------------------------------------------------------------------------------------------------------------------\n/** @deprecated 请使用 `setChatMessages` 代替 */\nasync function setChatMessage(field_values, message_id, { swipe_id = 'current', refresh = 'display_and_render_current', } = {}) {\n    field_values = typeof field_values === 'string' ? { message: field_values } : field_values;\n    if (typeof swipe_id !== 'number' && swipe_id !== 'current') {\n        throw Error(`提供的 swipe_id 无效, 请提供 'current' 或序号, 你提供的是: ${swipe_id} `);\n    }\n    if (!['none', 'display_current', 'display_and_render_current', 'all'].includes(refresh)) {\n        throw Error(`提供的 refresh 无效, 请提供 'none', 'display_current', 'display_and_render_current' 或 'all', 你提供的是: ${refresh} `);\n    }\n    const chat_message = _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.at(message_id);\n    if (!chat_message) {\n        loglevel__WEBPACK_IMPORTED_MODULE_1___default().warn(`未找到第 ${message_id} 楼的消息`);\n        return;\n    }\n    const add_swipes_if_required = () => {\n        if (swipe_id === 'current') {\n            return false;\n        }\n        // swipe_id 对应的消息页存在\n        if (swipe_id == 0 || (chat_message.swipes && swipe_id < chat_message.swipes.length)) {\n            return true;\n        }\n        if (!chat_message.swipes) {\n            chat_message.swipe_id = 0;\n            chat_message.swipes = [chat_message.mes];\n            chat_message.variables = [{}];\n        }\n        for (let i = chat_message.swipes.length; i <= swipe_id; ++i) {\n            chat_message.swipes.push('');\n            chat_message.variables.push({});\n        }\n        return true;\n    };\n    const swipe_id_previous_index = chat_message.swipe_id ?? 0;\n    const swipe_id_to_set_index = swipe_id == 'current' ? swipe_id_previous_index : swipe_id;\n    const swipe_id_to_use_index = refresh != 'none' ? swipe_id_to_set_index : swipe_id_previous_index;\n    const message = field_values.message ??\n        (chat_message.swipes ? chat_message.swipes[swipe_id_to_set_index] : undefined) ??\n        chat_message.mes;\n    const update_chat_message = () => {\n        const message_demacroed = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.substituteParamsExtended)(message);\n        if (field_values.data) {\n            if (!chat_message.variables) {\n                chat_message.variables = [];\n            }\n            chat_message.variables[swipe_id_to_set_index] = field_values.data;\n        }\n        if (chat_message.swipes) {\n            chat_message.swipes[swipe_id_to_set_index] = message_demacroed;\n            chat_message.swipe_id = swipe_id_to_use_index;\n        }\n        if (swipe_id_to_use_index === swipe_id_to_set_index) {\n            chat_message.mes = message_demacroed;\n        }\n    };\n    const update_partial_html = async (should_update_swipe) => {\n        // @ts-ignore\n        const mes_html = $(`div.mes[mesid = \"${message_id}\"]`);\n        if (!mes_html) {\n            return;\n        }\n        if (should_update_swipe) {\n            // FIXME: 只有一条消息时, swipes-counter 不会正常显示; 此外还要考虑 swipes-counter 的 \"Swipe # for All Messages\" 选项\n            mes_html.find('.swipes-counter').text(`${swipe_id_to_use_index + 1}\\u200b/\\u200b${chat_message.swipes.length}`);\n        }\n        if (refresh != 'none') {\n            mes_html\n                .find('.mes_text')\n                .empty()\n                .append((0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.messageFormatting)(message, chat_message.name, chat_message.is_system, chat_message.is_user, message_id));\n            if (refresh === 'display_and_render_current') {\n                await _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.emit(chat_message.is_user ? _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.USER_MESSAGE_RENDERED : _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.CHARACTER_MESSAGE_RENDERED, message_id);\n            }\n        }\n    };\n    const should_update_swipe = add_swipes_if_required();\n    update_chat_message();\n    await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveChatConditional)();\n    if (refresh == 'all') {\n        await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.reloadCurrentChat)();\n    }\n    else {\n        await update_partial_html(should_update_swipe);\n    }\n    loglevel__WEBPACK_IMPORTED_MODULE_1___default().info(`设置第 ${message_id} 楼消息, 选项: ${JSON.stringify({\n        swipe_id,\n        refresh,\n    })}, 设置前使用的消息页: ${swipe_id_previous_index}, 设置的消息页: ${swipe_id_to_set_index}, 现在使用的消息页: ${swipe_id_to_use_index} `);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEVBQUUsWUFBWSxDQUFDLElBQUksRUFBRSxZQUFZLENBQUMsU0FBUyxFQUFFLFlBQVksQ0FBQyxPQUFPLEVBQUUsVUFBVSxDQUFDLENBQ3hHLENBQUM7WUFDSixJQUFJLE9BQU8sS0FBSyw0QkFBNEIsRUFBRSxDQUFDO2dCQUM3QyxNQUFNLDREQUFXLENBQUMsSUFBSSxDQUNwQixZQUFZLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyw0REFBVyxDQUFDLHFCQUFxQixDQUFDLENBQUMsQ0FBQyw0REFBVyxDQUFDLDBCQUEwQixFQUNqRyxVQUFVLENBQ1gsQ0FBQztZQUNKLENBQUM7UUFDSCxDQUFDO0lBQ0gsQ0FBQyxDQUFDO0lBRUYsTUFBTSxtQkFBbUIsR0FBWSxzQkFBc0IsRUFBRSxDQUFDO0lBQzlELG1CQUFtQixFQUFFLENBQUM7SUFDdEIsTUFBTSx3RUFBbUIsRUFBRSxDQUFDO0lBQzVCLElBQUksT0FBTyxJQUFJLEtBQUssRUFBRSxDQUFDO1FBQ3JCLE1BQU0sc0VBQWlCLEVBQUUsQ0FBQztJQUM1QixDQUFDO1NBQU0sQ0FBQztRQUNOLE1BQU0sbUJBQW1CLENBQUMsbUJBQW1CLENBQUMsQ0FBQztJQUNqRCxDQUFDO0lBRUQsb0RBQVEsQ0FDTixPQUFPLFVBQVUsYUFBYSxJQUFJLENBQUMsU0FBUyxDQUFDO1FBQzNDLFFBQVE7UUFDUixPQUFPO0tBQ1IsQ0FBQyxnQkFBZ0IsdUJBQXVCLGFBQWEscUJBQXFCLGVBQWUscUJBQXFCLEdBQUcsQ0FDbkgsQ0FBQztBQUNKLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvZnVuY3Rpb24vY2hhdF9tZXNzYWdlLnRzPzk2NzgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgYWRkT25lTWVzc2FnZSxcbiAgY2hhdCxcbiAgZXZlbnRfdHlwZXMsXG4gIGV2ZW50U291cmNlLFxuICBtZXNzYWdlRm9ybWF0dGluZyxcbiAgbmFtZTEsXG4gIG5hbWUyLFxuICByZWxvYWRDdXJyZW50Q2hhdCxcbiAgc2F2ZUNoYXRDb25kaXRpb25hbCxcbiAgc3Vic3RpdHV0ZVBhcmFtc0V4dGVuZGVkLFxuICBzeXN0ZW1fbWVzc2FnZV90eXBlcyxcbn0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5cbmltcG9ydCBsb2cgZnJvbSAnbG9nbGV2ZWwnO1xuXG50eXBlIENoYXRNZXNzYWdlID0ge1xuICBtZXNzYWdlX2lkOiBudW1iZXI7XG4gIG5hbWU6IHN0cmluZztcbiAgcm9sZTogJ3N5c3RlbScgfCAnYXNzaXN0YW50JyB8ICd1c2VyJztcbiAgaXNfaGlkZGVuOiBib29sZWFuO1xuICBtZXNzYWdlOiBzdHJpbmc7XG4gIGRhdGE6IFJlY29yZDxzdHJpbmcsIGFueT47XG4gIGV4dHJhOiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xufTtcblxudHlwZSBDaGF0TWVzc2FnZVN3aXBlZCA9IHtcbiAgbWVzc2FnZV9pZDogbnVtYmVyO1xuICBuYW1lOiBzdHJpbmc7XG4gIHJvbGU6ICdzeXN0ZW0nIHwgJ2Fzc2lzdGFudCcgfCAndXNlcic7XG4gIGlzX2hpZGRlbjogYm9vbGVhbjtcbiAgc3dpcGVfaWQ6IG51bWJlcjtcbiAgc3dpcGVzOiBzdHJpbmdbXTtcbiAgc3dpcGVzX2RhdGE6IFJlY29yZDxzdHJpbmcsIGFueT5bXTtcbiAgc3dpcGVzX2luZm86IFJlY29yZDxzdHJpbmcsIGFueT5bXTtcbn07XG5cbnR5cGUgR2V0Q2hhdE1lc3NhZ2VzT3B0aW9uID0ge1xuICByb2xlPzogJ2FsbCcgfCAnc3lzdGVtJyB8ICdhc3Npc3RhbnQnIHwgJ3VzZXInO1xuICBoaWRlX3N0YXRlPzogJ2FsbCcgfCAnaGlkZGVuJyB8ICd1bmhpZGRlbic7XG4gIGluY2x1ZGVfc3dpcGVzPzogYm9vbGVhbjtcbn07XG5cbmZ1bmN0aW9uIHN0cmluZ190b19yYW5nZShpbnB1dDogc3RyaW5nLCBtaW46IG51bWJlciwgbWF4OiBudW1iZXIpIHtcbiAgbGV0IHN0YXJ0LCBlbmQ7XG5cbiAgaWYgKGlucHV0Lm1hdGNoKC9eKC0/XFxkKykkLykpIHtcbiAgICBjb25zdCB2YWx1ZSA9IE51bWJlcihpbnB1dCk7XG4gICAgc3RhcnQgPSBlbmQgPSB2YWx1ZSA8IDAgPyBtYXggKyB2YWx1ZSArIDEgOiB2YWx1ZTtcbiAgfSBlbHNlIHtcbiAgICBjb25zdCBtYXRjaCA9IGlucHV0Lm1hdGNoKC9eKC0/XFxkKyktKC0/XFxkKykkLyk7XG4gICAgaWYgKCFtYXRjaCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgW3N0YXJ0LCBlbmRdID0gXy5zb3J0QnkoXG4gICAgICBbbWF0Y2hbMV0sIG1hdGNoWzJdXS5tYXAodmFsdWUgPT4gTnVtYmVyKHZhbHVlKSkubWFwKHZhbHVlID0+ICh2YWx1ZSA8IDAgPyBtYXggKyB2YWx1ZSArIDEgOiB2YWx1ZSkpLFxuICAgICk7XG4gIH1cblxuICBpZiAoaXNOYU4oc3RhcnQpIHx8IGlzTmFOKGVuZCkgfHwgc3RhcnQgPiBlbmQgfHwgc3RhcnQgPCBtaW4gfHwgZW5kID4gbWF4KSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgcmV0dXJuIHsgc3RhcnQsIGVuZCB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q2hhdE1lc3NhZ2VzKFxuICByYW5nZTogc3RyaW5nIHwgbnVtYmVyLFxuICB7IHJvbGUsIGhpZGVfc3RhdGUsIGluY2x1ZGVfc3dpcGVzIH0/OiBPbWl0PEdldENoYXRNZXNzYWdlc09wdGlvbiwgJ2luY2x1ZGVfc3dpcGVzJz4gJiB7IGluY2x1ZGVfc3dpcGVzPzogZmFsc2UgfSxcbik6IENoYXRNZXNzYWdlW107XG5leHBvcnQgZnVuY3Rpb24gZ2V0Q2hhdE1lc3NhZ2VzKFxuICByYW5nZTogc3RyaW5nIHwgbnVtYmVyLFxuICB7IHJvbGUsIGhpZGVfc3RhdGUsIGluY2x1ZGVfc3dpcGVzIH0/OiBPbWl0PEdldENoYXRNZXNzYWdlc09wdGlvbiwgJ2luY2x1ZGVfc3dpcGVzJz4gJiB7IGluY2x1ZGVfc3dpcGVzPzogdHJ1ZSB9LFxuKTogQ2hhdE1lc3NhZ2VTd2lwZWRbXTtcbmV4cG9ydCBmdW5jdGlvbiBnZXRDaGF0TWVzc2FnZXMoXG4gIHJhbmdlOiBzdHJpbmcgfCBudW1iZXIsXG4gIHsgcm9sZSA9ICdhbGwnLCBoaWRlX3N0YXRlID0gJ2FsbCcsIGluY2x1ZGVfc3dpcGVzID0gZmFsc2UgfTogR2V0Q2hhdE1lc3NhZ2VzT3B0aW9uID0ge30sXG4pOiAoQ2hhdE1lc3NhZ2UgfCBDaGF0TWVzc2FnZVN3aXBlZClbXSB7XG4gIGNvbnN0IHJhbmdlX2RlbWFjcm9lZCA9IHN1YnN0aXR1dGVQYXJhbXNFeHRlbmRlZChyYW5nZS50b1N0cmluZygpKTtcbiAgY29uc3QgcmFuZ2VfbnVtYmVyID0gc3RyaW5nX3RvX3JhbmdlKHJhbmdlX2RlbWFjcm9lZCwgMCwgY2hhdC5sZW5ndGggLSAxKTtcbiAgaWYgKCFyYW5nZV9udW1iZXIpIHtcbiAgICB0aHJvdyBFcnJvcihg5o+Q5L6b55qE5raI5oGv6IyD5Zu0IHJhbmdlIOaXoOaViDogJHtyYW5nZX1gKTtcbiAgfVxuICBpZiAoIVsnYWxsJywgJ3N5c3RlbScsICdhc3Npc3RhbnQnLCAndXNlciddLmluY2x1ZGVzKHJvbGUpKSB7XG4gICAgdGhyb3cgRXJyb3IoYOaPkOS+m+eahCByb2xlIOaXoOaViCwg6K+35o+Q5L6bICdhbGwnLCAnc3lzdGVtJywgJ2Fzc2lzdGFudCcg5oiWICd1c2VyJywg5L2g5o+Q5L6b55qE5pivOiAke3JvbGV9YCk7XG4gIH1cbiAgaWYgKCFbJ2FsbCcsICdoaWRkZW4nLCAndW5oaWRkZW4nXS5pbmNsdWRlcyhoaWRlX3N0YXRlKSkge1xuICAgIHRocm93IEVycm9yKGDmj5DkvpvnmoQgaGlkZV9zdGF0ZSDml6DmlYgsIOivt+aPkOS+myAnYWxsJywgJ2hpZGRlbicg5oiWICd1bmhpZGRlbicsIOS9oOaPkOS+m+eahOaYrzogJHtoaWRlX3N0YXRlfWApO1xuICB9XG5cbiAgY29uc3QgeyBzdGFydCwgZW5kIH0gPSByYW5nZV9udW1iZXI7XG5cbiAgY29uc3QgZ2V0X3JvbGUgPSAoY2hhdF9tZXNzYWdlOiBhbnkpID0+IHtcbiAgICBjb25zdCBpc19uYXJyYXRvciA9IGNoYXRfbWVzc2FnZS5leHRyYT8udHlwZSA9PT0gc3lzdGVtX21lc3NhZ2VfdHlwZXMuTkFSUkFUT1I7XG4gICAgaWYgKGlzX25hcnJhdG9yKSB7XG4gICAgICBpZiAoY2hhdF9tZXNzYWdlLmlzX3VzZXIpIHtcbiAgICAgICAgcmV0dXJuICd1bmtub3duJztcbiAgICAgIH1cbiAgICAgIHJldHVybiAnc3lzdGVtJztcbiAgICB9XG4gICAgaWYgKGNoYXRfbWVzc2FnZS5pc191c2VyKSB7XG4gICAgICByZXR1cm4gJ3VzZXInO1xuICAgIH1cbiAgICByZXR1cm4gJ2Fzc2lzdGFudCc7XG4gIH07XG5cbiAgY29uc3QgcHJvY2Vzc19tZXNzYWdlID0gKG1lc3NhZ2VfaWQ6IG51bWJlcik6IChDaGF0TWVzc2FnZSB8IENoYXRNZXNzYWdlU3dpcGVkKSB8IG51bGwgPT4ge1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjaGF0W21lc3NhZ2VfaWRdO1xuICAgIGlmICghbWVzc2FnZSkge1xuICAgICAgbG9nLndhcm4oYOayoeaJvuWIsOesrCAke21lc3NhZ2VfaWR9IOalvOeahOa2iOaBr2ApO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgY29uc3QgbWVzc2FnZV9yb2xlID0gZ2V0X3JvbGUobWVzc2FnZSk7XG4gICAgaWYgKHJvbGUgIT09ICdhbGwnICYmIG1lc3NhZ2Vfcm9sZSAhPT0gcm9sZSkge1xuICAgICAgbG9nLmRlYnVnKGDnrZvljrvkuobnrKwgJHttZXNzYWdlX2lkfSDmpbznmoTmtojmga/lm6DkuLrlroPnmoTouqvku73kuI3mmK8gJHtyb2xlfWApO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgaWYgKGhpZGVfc3RhdGUgIT09ICdhbGwnICYmIChoaWRlX3N0YXRlID09PSAnaGlkZGVuJykgIT09IG1lc3NhZ2UuaXNfc3lzdGVtKSB7XG4gICAgICBsb2cuZGVidWcoYOetm+WOu+S6huesrCAke21lc3NhZ2VfaWR9IOalvOeahOa2iOaBr+WboOS4uuWugyR7aGlkZV9zdGF0ZSA9PT0gJ2hpZGRlbicgPyBgYCA6IGDmsqFgfSDooqvpmpDol49gKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGNvbnN0IHN3aXBlX2lkID0gbWVzc2FnZT8uc3dpcGVfaWQgPz8gMDtcbiAgICBjb25zdCBzd2lwZXMgPSBtZXNzYWdlPy5zd2lwZXMgPz8gW21lc3NhZ2UubWVzXTtcbiAgICBjb25zdCBzd2lwZXNfZGF0YSA9IG1lc3NhZ2U/LnZhcmlhYmxlcyA/PyBbe31dO1xuICAgIGNvbnN0IHN3aXBlc19pbmZvID0gbWVzc2FnZT8uc3dpcGVzX2luZm8gPz8gW21lc3NhZ2U/LmV4dHJhID8/IHt9XTtcbiAgICBjb25zdCBleHRyYSA9IHN3aXBlc19pbmZvW3N3aXBlX2lkXTtcbiAgICBjb25zdCBkYXRhID0gc3dpcGVzX2RhdGFbc3dpcGVfaWRdO1xuXG4gICAgaWYgKGluY2x1ZGVfc3dpcGVzKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBtZXNzYWdlX2lkOiBtZXNzYWdlX2lkLFxuICAgICAgICBuYW1lOiBtZXNzYWdlLm5hbWUsXG4gICAgICAgIHJvbGU6IG1lc3NhZ2Vfcm9sZSBhcyAnc3lzdGVtJyB8ICdhc3Npc3RhbnQnIHwgJ3VzZXInLFxuICAgICAgICBpc19oaWRkZW46IG1lc3NhZ2UuaXNfc3lzdGVtLFxuICAgICAgICBzd2lwZV9pZDogc3dpcGVfaWQsXG4gICAgICAgIHN3aXBlczogc3dpcGVzLFxuICAgICAgICBzd2lwZXNfZGF0YTogc3dpcGVzX2RhdGEsXG4gICAgICAgIHN3aXBlc19pbmZvOiBzd2lwZXNfaW5mbyxcbiAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICBtZXNzYWdlX2lkOiBtZXNzYWdlX2lkLFxuICAgICAgbmFtZTogbWVzc2FnZS5uYW1lLFxuICAgICAgcm9sZTogbWVzc2FnZV9yb2xlIGFzICdzeXN0ZW0nIHwgJ2Fzc2lzdGFudCcgfCAndXNlcicsXG4gICAgICBpc19oaWRkZW46IG1lc3NhZ2UuaXNfc3lzdGVtLFxuICAgICAgbWVzc2FnZTogbWVzc2FnZS5tZXMsXG4gICAgICBkYXRhOiBkYXRhLFxuICAgICAgZXh0cmE6IGV4dHJhLFxuXG4gICAgICAvLyBmb3IgY29tcGF0aWJpbGl0eVxuICAgICAgc3dpcGVfaWQ6IHN3aXBlX2lkLFxuICAgICAgc3dpcGVzOiBzd2lwZXMsXG4gICAgICBzd2lwZXNfZGF0YTogc3dpcGVzX2RhdGEsXG4gICAgfTtcbiAgfTtcblxuICBjb25zdCBjaGF0X21lc3NhZ2VzOiAoQ2hhdE1lc3NhZ2UgfCBDaGF0TWVzc2FnZVN3aXBlZClbXSA9IF8ucmFuZ2Uoc3RhcnQsIGVuZCArIDEpXG4gICAgLm1hcChpID0+IHByb2Nlc3NfbWVzc2FnZShpKSlcbiAgICAuZmlsdGVyKGNoYXRfbWVzc2FnZSA9PiBjaGF0X21lc3NhZ2UgIT09IG51bGwpO1xuXG4gIGxvZy5pbmZvKFxuICAgIGDojrflj5Yke3N0YXJ0ID09IGVuZCA/IGDnrKwgJHtzdGFydH0gYCA6IGAgJHtzdGFydH0tJHtlbmR9IGB95qW855qE5raI5oGvLCDpgInpobk6ICR7SlNPTi5zdHJpbmdpZnkoe1xuICAgICAgcm9sZSxcbiAgICAgIGhpZGVfc3RhdGUsXG4gICAgICBpbmNsdWRlX3N3aXBlcyxcbiAgICB9KX0gYCxcbiAgKTtcbiAgcmV0dXJuIHN0cnVjdHVyZWRDbG9uZShjaGF0X21lc3NhZ2VzKTtcbn1cblxudHlwZSBTZXRDaGF0TWVzc2FnZXNPcHRpb24gPSB7XG4gIHJlZnJlc2g/OiAnbm9uZScgfCAnYWZmZWN0ZWQnIHwgJ2FsbCc7XG59O1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2V0Q2hhdE1lc3NhZ2VzKFxuICBjaGF0X21lc3NhZ2VzOiBBcnJheTx7IG1lc3NhZ2VfaWQ6IG51bWJlciB9ICYgKFBhcnRpYWw8Q2hhdE1lc3NhZ2U+IHwgUGFydGlhbDxDaGF0TWVzc2FnZVN3aXBlZD4pPixcbiAgeyByZWZyZXNoID0gJ2FmZmVjdGVkJyB9OiBTZXRDaGF0TWVzc2FnZXNPcHRpb24gPSB7fSxcbik6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCBpc19jaGF0X21lc3NhZ2UgPSAoXG4gICAgY2hhdF9tZXNzYWdlOiB7IG1lc3NhZ2VfaWQ6IG51bWJlciB9ICYgKFBhcnRpYWw8Q2hhdE1lc3NhZ2U+IHwgUGFydGlhbDxDaGF0TWVzc2FnZVN3aXBlZD4pLFxuICApOiBjaGF0X21lc3NhZ2UgaXMgeyBtZXNzYWdlX2lkOiBudW1iZXIgfSAmIFBhcnRpYWw8Q2hhdE1lc3NhZ2U+ID0+IHtcbiAgICByZXR1cm4gXy5oYXMoY2hhdF9tZXNzYWdlLCAnbWVzc2FnZScpIHx8IF8uaGFzKGNoYXRfbWVzc2FnZSwgJ2RhdGEnKTtcbiAgfTtcblxuICBjb25zdCBtb2RpZnkgPSBhc3luYyAoY2hhdF9tZXNzYWdlOiB7IG1lc3NhZ2VfaWQ6IG51bWJlciB9ICYgKFBhcnRpYWw8Q2hhdE1lc3NhZ2U+IHwgUGFydGlhbDxDaGF0TWVzc2FnZVN3aXBlZD4pKSA9PiB7XG4gICAgY29uc3QgZGF0YSA9IGNoYXRbY2hhdF9tZXNzYWdlLm1lc3NhZ2VfaWRdO1xuICAgIGlmIChkYXRhID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoY2hhdF9tZXNzYWdlPy5uYW1lICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIF8uc2V0KGRhdGEsICduYW1lJywgY2hhdF9tZXNzYWdlLm5hbWUpO1xuICAgIH1cbiAgICBpZiAoY2hhdF9tZXNzYWdlPy5yb2xlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIF8uc2V0KGRhdGEsICdpc191c2VyJywgY2hhdF9tZXNzYWdlLnJvbGUgPT09ICd1c2VyJyk7XG4gICAgfVxuICAgIGlmIChjaGF0X21lc3NhZ2U/LmlzX2hpZGRlbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBfLnNldChkYXRhLCAnaXNfc3lzdGVtJywgY2hhdF9tZXNzYWdlLmlzX2hpZGRlbik7XG4gICAgfVxuXG4gICAgaWYgKGlzX2NoYXRfbWVzc2FnZShjaGF0X21lc3NhZ2UpKSB7XG4gICAgICBpZiAoY2hhdF9tZXNzYWdlPy5tZXNzYWdlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgXy5zZXQoZGF0YSwgJ21lcycsIGNoYXRfbWVzc2FnZS5tZXNzYWdlKTtcbiAgICAgICAgaWYgKGRhdGE/LnN3aXBlcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgXy5zZXQoZGF0YSwgWydzd2lwZXMnLCBkYXRhLnN3aXBlX2lkXSwgY2hhdF9tZXNzYWdlLm1lc3NhZ2UpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoY2hhdF9tZXNzYWdlPy5kYXRhICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgaWYgKGRhdGE/LnZhcmlhYmxlcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgXy5zZXQoZGF0YSwgJ3ZhcmlhYmxlcycsIF8udGltZXMoZGF0YS5zd2lwZXM/Lmxlbmd0aCA/PyAxLCBfLmNvbnN0YW50KHt9KSkpO1xuICAgICAgICB9XG4gICAgICAgIF8uc2V0KGRhdGEsIFsndmFyaWFibGVzJywgZGF0YS5zd2lwZV9pZCA/PyAwXSwgY2hhdF9tZXNzYWdlLmRhdGEpO1xuICAgICAgICBldmVudFNvdXJjZS5lbWl0KCdtZXNzYWdlX3ZhcmlhYmxlc19jaGFuZ2VkJywge1xuICAgICAgICAgIG1lc3NhZ2VfaWQ6IGNoYXRfbWVzc2FnZS5tZXNzYWdlX2lkLFxuICAgICAgICAgIHZhcmlhYmxlczogY2hhdF9tZXNzYWdlLmRhdGEsXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKGNoYXRfbWVzc2FnZT8uZXh0cmEgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBpZiAoZGF0YT8uc3dpcGVzX2luZm8gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIF8uc2V0KGRhdGEsICdzd2lwZXNfaW5mbycsIF8udGltZXMoZGF0YS5zd2lwZXM/Lmxlbmd0aCA/PyAxLCBfLmNvbnN0YW50KHt9KSkpO1xuICAgICAgICB9XG4gICAgICAgIF8uc2V0KGRhdGEsICdleHRyYScsIGNoYXRfbWVzc2FnZT8uZXh0cmEpO1xuICAgICAgICBfLnNldChkYXRhLCBbJ3N3aXBlc19pbmZvJywgZGF0YS5zd2lwZV9pZCA/PyAwXSwgY2hhdF9tZXNzYWdlPy5leHRyYSk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChcbiAgICAgIGNoYXRfbWVzc2FnZT8uc3dpcGVfaWQgIT09IHVuZGVmaW5lZCB8fFxuICAgICAgY2hhdF9tZXNzYWdlPy5zd2lwZXMgIT09IHVuZGVmaW5lZCB8fFxuICAgICAgY2hhdF9tZXNzYWdlPy5zd2lwZXNfZGF0YSAhPT0gdW5kZWZpbmVkIHx8XG4gICAgICBjaGF0X21lc3NhZ2U/LnN3aXBlc19pbmZvICE9PSB1bmRlZmluZWRcbiAgICApIHtcbiAgICAgIF8uc2V0KGNoYXRfbWVzc2FnZSwgJ3N3aXBlX2lkJywgY2hhdF9tZXNzYWdlLnN3aXBlX2lkID8/IGRhdGEuc3dpcGVfaWQgPz8gMCk7XG4gICAgICBfLnNldChjaGF0X21lc3NhZ2UsICdzd2lwZXMnLCBjaGF0X21lc3NhZ2Uuc3dpcGVzID8/IGRhdGEuc3dpcGVzID8/IFtkYXRhLm1lc10pO1xuICAgICAgXy5zZXQoY2hhdF9tZXNzYWdlLCAnc3dpcGVzX2RhdGEnLCBjaGF0X21lc3NhZ2Uuc3dpcGVzX2RhdGEgPz8gZGF0YS52YXJpYWJsZXMgPz8gW3t9XSk7XG4gICAgICBfLnNldChjaGF0X21lc3NhZ2UsICdzd2lwZXNfaW5mbycsIGNoYXRfbWVzc2FnZS5zd2lwZXNfaW5mbyA/PyBkYXRhLnN3aXBlc19pbmZvID8/IFt7fV0pO1xuICAgICAgY29uc3QgbWF4X2xlbmd0aCA9XG4gICAgICAgIF8ubWF4KFtjaGF0X21lc3NhZ2Uuc3dpcGVzPy5sZW5ndGgsIGNoYXRfbWVzc2FnZS5zd2lwZXNfZGF0YT8ubGVuZ3RoLCBjaGF0X21lc3NhZ2Uuc3dpcGVzX2luZm8/Lmxlbmd0aF0pID8/IDE7XG4gICAgICAoY2hhdF9tZXNzYWdlLnN3aXBlcyBhcyBzdHJpbmdbXSkubGVuZ3RoID0gbWF4X2xlbmd0aDtcbiAgICAgIChjaGF0X21lc3NhZ2Uuc3dpcGVzX2RhdGEgYXMgUmVjb3JkPHN0cmluZywgYW55PltdKS5sZW5ndGggPSBtYXhfbGVuZ3RoO1xuICAgICAgKGNoYXRfbWVzc2FnZS5zd2lwZXNfaW5mbyBhcyBSZWNvcmQ8c3RyaW5nLCBhbnk+W10pLmxlbmd0aCA9IG1heF9sZW5ndGg7XG5cbiAgICAgIF8uc2V0KGRhdGEsICdzd2lwZXMnLCBjaGF0X21lc3NhZ2Uuc3dpcGVzKTtcbiAgICAgIF8uc2V0KGRhdGEsICd2YXJpYWJsZXMnLCBjaGF0X21lc3NhZ2Uuc3dpcGVzX2RhdGEpO1xuICAgICAgXy5zZXQoZGF0YSwgJ3N3aXBlc19pbmZvJywgY2hhdF9tZXNzYWdlLnN3aXBlc19pbmZvKTtcbiAgICAgIF8uc2V0KGRhdGEsICdzd2lwZV9pZCcsIGNoYXRfbWVzc2FnZS5zd2lwZV9pZCk7XG4gICAgICBfLnNldChkYXRhLCAnbWVzJywgZGF0YS5zd2lwZXNbZGF0YS5zd2lwZV9pZF0pO1xuICAgICAgXy5zZXQoZGF0YSwgJ2V4dHJhJywgZGF0YS5zd2lwZXNfaW5mb1tkYXRhLnN3aXBlX2lkXSk7XG5cbiAgICAgIGV2ZW50U291cmNlLmVtaXQoJ21lc3NhZ2VfdmFyaWFibGVzX2NoYW5nZWQnLCB7XG4gICAgICAgIG1lc3NhZ2VfaWQ6IGNoYXRfbWVzc2FnZS5tZXNzYWdlX2lkLFxuICAgICAgICB2YXJpYWJsZXM6IChjaGF0X21lc3NhZ2Uuc3dpcGVzX2RhdGEgYXMgUmVjb3JkPHN0cmluZywgYW55PltdKVtjaGF0X21lc3NhZ2Uuc3dpcGVfaWQgYXMgbnVtYmVyXSxcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCByZW5kZXIgPSBhc3luYyAobWVzc2FnZV9pZDogbnVtYmVyKSA9PiB7XG4gICAgY29uc3QgJG1lc19odG1sID0gJChgZGl2Lm1lc1ttZXNpZCA9IFwiJHttZXNzYWdlX2lkfVwiXWApO1xuICAgIGlmICghJG1lc19odG1sKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgY2hhdF9tZXNzYWdlID0gY2hhdFttZXNzYWdlX2lkXTtcbiAgICBpZiAoY2hhdF9tZXNzYWdlLnN3aXBlcykge1xuICAgICAgJG1lc19odG1sLmZpbmQoJy5zd2lwZXMtY291bnRlcicpLnRleHQoYCR7Y2hhdF9tZXNzYWdlLnN3aXBlX2lkICsgMX1cXHUyMDBiL1xcdTIwMGIke2NoYXRfbWVzc2FnZS5zd2lwZXMubGVuZ3RofWApO1xuICAgIH1cbiAgICAkbWVzX2h0bWxcbiAgICAgIC5maW5kKCcubWVzX3RleHQnKVxuICAgICAgLmVtcHR5KClcbiAgICAgIC5hcHBlbmQoXG4gICAgICAgIG1lc3NhZ2VGb3JtYXR0aW5nKFxuICAgICAgICAgIGNoYXRfbWVzc2FnZS5tZXMsXG4gICAgICAgICAgY2hhdF9tZXNzYWdlLm5hbWUsXG4gICAgICAgICAgY2hhdF9tZXNzYWdlLmlzX3N5c3RlbSxcbiAgICAgICAgICBjaGF0X21lc3NhZ2UuaXNfdXNlcixcbiAgICAgICAgICBtZXNzYWdlX2lkLFxuICAgICAgICApLFxuICAgICAgKTtcbiAgICBhd2FpdCBldmVudFNvdXJjZS5lbWl0KFxuICAgICAgY2hhdF9tZXNzYWdlLmlzX3VzZXIgPyBldmVudF90eXBlcy5VU0VSX01FU1NBR0VfUkVOREVSRUQgOiBldmVudF90eXBlcy5DSEFSQUNURVJfTUVTU0FHRV9SRU5ERVJFRCxcbiAgICAgIG1lc3NhZ2VfaWQsXG4gICAgKTtcbiAgfTtcblxuICBhd2FpdCBQcm9taXNlLmFsbChjaGF0X21lc3NhZ2VzLm1hcChtb2RpZnkpKTtcbiAgYXdhaXQgc2F2ZUNoYXRDb25kaXRpb25hbCgpO1xuICBpZiAocmVmcmVzaCA9PT0gJ2FsbCcpIHtcbiAgICBhd2FpdCByZWxvYWRDdXJyZW50Q2hhdCgpO1xuICB9IGVsc2UgaWYgKHJlZnJlc2ggPT09ICdhZmZlY3RlZCcpIHtcbiAgICBhd2FpdCBQcm9taXNlLmFsbChjaGF0X21lc3NhZ2VzLm1hcChtZXNzYWdlID0+IHJlbmRlcihtZXNzYWdlLm1lc3NhZ2VfaWQpKSk7XG4gIH1cbiAgbG9nLmluZm8oXG4gICAgYOS/ruaUueesrCAnJHtjaGF0X21lc3NhZ2VzLm1hcChtZXNzYWdlID0+IG1lc3NhZ2UubWVzc2FnZV9pZCkuam9pbignLCAnKX0nIOalvOeahOa2iOaBrywg6YCJ6aG5OiAke0pTT04uc3RyaW5naWZ5KHtcbiAgICAgIHJlZnJlc2gsXG4gICAgfSl9YCxcbiAgKTtcbn1cblxudHlwZSBDaGF0TWVzc2FnZUNyZWF0aW5nID0ge1xuICBuYW1lPzogc3RyaW5nO1xuICByb2xlOiAnc3lzdGVtJyB8ICdhc3Npc3RhbnQnIHwgJ3VzZXInO1xuICBpc19oaWRkZW4/OiBib29sZWFuO1xuICBtZXNzYWdlOiBzdHJpbmc7XG4gIGRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xufTtcblxudHlwZSBDcmVhdGVDaGF0TWVzc2FnZXNPcHRpb24gPSB7XG4gIGluc2VydF9hdD86IG51bWJlciB8ICdlbmQnO1xuICByZWZyZXNoPzogJ25vbmUnIHwgJ2FmZmVjdGVkJyB8ICdhbGwnO1xufTtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNoYXRNZXNzYWdlcyhcbiAgY2hhdF9tZXNzYWdlczogQ2hhdE1lc3NhZ2VDcmVhdGluZ1tdLFxuICB7IGluc2VydF9hdCA9ICdlbmQnLCByZWZyZXNoID0gJ2FmZmVjdGVkJyB9OiBDcmVhdGVDaGF0TWVzc2FnZXNPcHRpb24gPSB7fSxcbik6IFByb21pc2U8dm9pZD4ge1xuICBpZiAoaW5zZXJ0X2F0ICE9PSAnZW5kJykge1xuICAgIGluc2VydF9hdCA9IGluc2VydF9hdCA8IDAgPyBjaGF0Lmxlbmd0aCArIGluc2VydF9hdCA6IGluc2VydF9hdDtcbiAgICBpZiAoaW5zZXJ0X2F0IDwgMCB8fCBpbnNlcnRfYXQgPiBjaGF0Lmxlbmd0aCkge1xuICAgICAgdGhyb3cgRXJyb3IoYOaPkOS+m+eahCBpbnNlcnRfYXQg5peg5pWILCDor7fmj5DkvpvkuIDkuKrlnKggJzAnIOWIsCAnJHtjaGF0Lmxlbmd0aH0nIOS5i+mXtOeahOaVtOaVsCwg5L2g5o+Q5L6b55qE5pivOiAnJHtpbnNlcnRfYXR9J2ApO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IGNvbnZlcnQgPSBhc3luYyAoY2hhdF9tZXNzYWdlOiBDaGF0TWVzc2FnZUNyZWF0aW5nKSA9PiB7XG4gICAgY29uc3QgcmVzdWx0OiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0ge307XG5cbiAgICBpZiAoY2hhdF9tZXNzYWdlPy5uYW1lICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIF8uc2V0KHJlc3VsdCwgJ25hbWUnLCBjaGF0X21lc3NhZ2UubmFtZSk7XG4gICAgfSBlbHNlIGlmIChjaGF0X21lc3NhZ2Uucm9sZSA9PT0gJ3VzZXInKSB7XG4gICAgICBfLnNldChyZXN1bHQsICduYW1lJywgbmFtZTEpO1xuICAgIH0gZWxzZSB7XG4gICAgICBfLnNldChyZXN1bHQsICduYW1lJywgbmFtZTIpO1xuICAgIH1cblxuICAgIC8vIFRPRE86IGF2YXRhclxuXG4gICAgXy5zZXQocmVzdWx0LCAnaXNfdXNlcicsIGNoYXRfbWVzc2FnZS5yb2xlID09PSAndXNlcicpO1xuICAgIF8uc2V0KHJlc3VsdCwgJ2lzX3N5c3RlbScsIGNoYXRfbWVzc2FnZS5pc19oaWRkZW4gPz8gZmFsc2UpO1xuICAgIF8uc2V0KHJlc3VsdCwgJ21lcycsIGNoYXRfbWVzc2FnZS5tZXNzYWdlKTtcbiAgICBfLnNldChyZXN1bHQsIFsndmFyaWFibGVzJywgMF0sIGNoYXRfbWVzc2FnZS5kYXRhID8/IHt9KTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIGNvbnN0IGNvbnZlcnRlZCA9IGF3YWl0IFByb21pc2UuYWxsKGNoYXRfbWVzc2FnZXMubWFwKGNvbnZlcnQpKTtcbiAgaWYgKGluc2VydF9hdCA9PT0gJ2VuZCcpIHtcbiAgICBjaGF0LnB1c2goLi4uY29udmVydGVkKTtcbiAgfSBlbHNlIHtcbiAgICBjaGF0LnNwbGljZShpbnNlcnRfYXQsIDAsIC4uLmNvbnZlcnRlZCk7XG4gIH1cbiAgYXdhaXQgc2F2ZUNoYXRDb25kaXRpb25hbCgpO1xuICBpZiAocmVmcmVzaCA9PT0gJ2FmZmVjdGVkJyAmJiBpbnNlcnRfYXQgPT09ICdlbmQnKSB7XG4gICAgY29udmVydGVkLmZvckVhY2gobWVzc2FnZSA9PiBhZGRPbmVNZXNzYWdlKG1lc3NhZ2UpKTtcbiAgfSBlbHNlIHtcbiAgICBhd2FpdCByZWxvYWRDdXJyZW50Q2hhdCgpO1xuICB9XG4gIGxvZy5pbmZvKFxuICAgIGDlnKgke2luc2VydF9hdCA9PT0gJ2VuZCcgPyAn5pyA5ZCOJyA6IGDnrKwgJHtpbnNlcnRfYXR9IOalvOWJjWB95Yib5bu6ICR7XG4gICAgICBjaGF0X21lc3NhZ2VzLmxlbmd0aFxuICAgIH0g5p2h5raI5oGvLCDpgInpobk6ICR7SlNPTi5zdHJpbmdpZnkoe1xuICAgICAgaW5zZXJ0X2F0LFxuICAgICAgcmVmcmVzaCxcbiAgICB9KX1gLFxuICApO1xufVxuXG50eXBlIERlbGV0ZUNoYXRNZXNzYWdlc09wdGlvbiA9IHtcbiAgcmVmcmVzaD86ICdub25lJyB8ICdhbGwnO1xufTtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUNoYXRNZXNzYWdlcyhcbiAgbWVzc2FnZV9pZHM6IG51bWJlcltdLFxuICB7IHJlZnJlc2ggPSAnYWxsJyB9OiBEZWxldGVDaGF0TWVzc2FnZXNPcHRpb24gPSB7fSxcbik6IFByb21pc2U8dm9pZD4ge1xuICBtZXNzYWdlX2lkcyA9IG1lc3NhZ2VfaWRzLm1hcChpZCA9PiAoaWQgPCAwID8gY2hhdC5sZW5ndGggKyBpZCA6IGlkKSkuZmlsdGVyKGlkID0+IGlkID49IDAgJiYgaWQgPCBjaGF0Lmxlbmd0aCk7XG5cbiAgXy5wdWxsQXQoY2hhdCwgbWVzc2FnZV9pZHMpO1xuICBhd2FpdCBzYXZlQ2hhdENvbmRpdGlvbmFsKCk7XG4gIGlmIChyZWZyZXNoID09PSAnYWxsJykge1xuICAgIGF3YWl0IHJlbG9hZEN1cnJlbnRDaGF0KCk7XG4gIH1cbiAgbG9nLmluZm8oXG4gICAgYOWIoOmZpOesrCAnJHttZXNzYWdlX2lkcy5qb2luKCcsICcpfScg5qW855qE5raI5oGvLCDpgInpobk6ICR7SlNPTi5zdHJpbmdpZnkoe1xuICAgICAgcmVmcmVzaCxcbiAgICB9KX1gLFxuICApO1xufVxuXG50eXBlIFJvdGF0ZUNoYXRNZXNzYWdlc09wdGlvbiA9IHtcbiAgcmVmcmVzaD86ICdub25lJyB8ICdhbGwnO1xufTtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJvdGF0ZUNoYXRNZXNzYWdlcyhcbiAgYmVnaW46IG51bWJlcixcbiAgbWlkZGxlOiBudW1iZXIsXG4gIGVuZDogbnVtYmVyLFxuICB7IHJlZnJlc2ggPSAnYWxsJyB9OiBSb3RhdGVDaGF0TWVzc2FnZXNPcHRpb24gPSB7fSxcbik6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCByaWdodF9wYXJ0ID0gY2hhdC5zcGxpY2UobWlkZGxlLCBlbmQgLSBtaWRkbGUpO1xuICBjaGF0LnNwbGljZShiZWdpbiwgMCwgLi4ucmlnaHRfcGFydCk7XG4gIGF3YWl0IHNhdmVDaGF0Q29uZGl0aW9uYWwoKTtcbiAgaWYgKHJlZnJlc2ggPT09ICdhbGwnKSB7XG4gICAgYXdhaXQgcmVsb2FkQ3VycmVudENoYXQoKTtcbiAgfVxuICBsb2cuaW5mbyhcbiAgICBg5peL6L2s56ysICdbJHtiZWdpbn0sICR7bWlkZGxlfSkgWyR7bWlkZGxlfSwgJHtlbmR9KScg5qW855qE5raI5oGvLCDpgInpobk6ICR7SlNPTi5zdHJpbmdpZnkoe1xuICAgICAgcmVmcmVzaCxcbiAgICB9KX1gLFxuICApO1xufVxuXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKiBAZGVwcmVjYXRlZCDor7fkvb/nlKggYHNldENoYXRNZXNzYWdlc2Ag5Luj5pu/ICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2V0Q2hhdE1lc3NhZ2UoXG4gIGZpZWxkX3ZhbHVlczogeyBtZXNzYWdlPzogc3RyaW5nOyBkYXRhPzogUmVjb3JkPHN0cmluZywgYW55PiB9LFxuICBtZXNzYWdlX2lkOiBudW1iZXIsXG4gIHtcbiAgICBzd2lwZV9pZCA9ICdjdXJyZW50JyxcbiAgICByZWZyZXNoID0gJ2Rpc3BsYXlfYW5kX3JlbmRlcl9jdXJyZW50JyxcbiAgfToge1xuICAgIHN3aXBlX2lkPzogJ2N1cnJlbnQnIHwgbnVtYmVyO1xuICAgIHJlZnJlc2g/OiAnbm9uZScgfCAnZGlzcGxheV9jdXJyZW50JyB8ICdkaXNwbGF5X2FuZF9yZW5kZXJfY3VycmVudCcgfCAnYWxsJztcbiAgfSA9IHt9LFxuKTogUHJvbWlzZTx2b2lkPiB7XG4gIGZpZWxkX3ZhbHVlcyA9IHR5cGVvZiBmaWVsZF92YWx1ZXMgPT09ICdzdHJpbmcnID8geyBtZXNzYWdlOiBmaWVsZF92YWx1ZXMgfSA6IGZpZWxkX3ZhbHVlcztcbiAgaWYgKHR5cGVvZiBzd2lwZV9pZCAhPT0gJ251bWJlcicgJiYgc3dpcGVfaWQgIT09ICdjdXJyZW50Jykge1xuICAgIHRocm93IEVycm9yKGDmj5DkvpvnmoQgc3dpcGVfaWQg5peg5pWILCDor7fmj5DkvpsgJ2N1cnJlbnQnIOaIluW6j+WPtywg5L2g5o+Q5L6b55qE5pivOiAke3N3aXBlX2lkfSBgKTtcbiAgfVxuICBpZiAoIVsnbm9uZScsICdkaXNwbGF5X2N1cnJlbnQnLCAnZGlzcGxheV9hbmRfcmVuZGVyX2N1cnJlbnQnLCAnYWxsJ10uaW5jbHVkZXMocmVmcmVzaCkpIHtcbiAgICB0aHJvdyBFcnJvcihcbiAgICAgIGDmj5DkvpvnmoQgcmVmcmVzaCDml6DmlYgsIOivt+aPkOS+myAnbm9uZScsICdkaXNwbGF5X2N1cnJlbnQnLCAnZGlzcGxheV9hbmRfcmVuZGVyX2N1cnJlbnQnIOaIliAnYWxsJywg5L2g5o+Q5L6b55qE5pivOiAke3JlZnJlc2h9IGAsXG4gICAgKTtcbiAgfVxuXG4gIGNvbnN0IGNoYXRfbWVzc2FnZSA9IGNoYXQuYXQobWVzc2FnZV9pZCk7XG4gIGlmICghY2hhdF9tZXNzYWdlKSB7XG4gICAgbG9nLndhcm4oYOacquaJvuWIsOesrCAke21lc3NhZ2VfaWR9IOalvOeahOa2iOaBr2ApO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IGFkZF9zd2lwZXNfaWZfcmVxdWlyZWQgPSAoKTogYm9vbGVhbiA9PiB7XG4gICAgaWYgKHN3aXBlX2lkID09PSAnY3VycmVudCcpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBzd2lwZV9pZCDlr7nlupTnmoTmtojmga/pobXlrZjlnKhcbiAgICBpZiAoc3dpcGVfaWQgPT0gMCB8fCAoY2hhdF9tZXNzYWdlLnN3aXBlcyAmJiBzd2lwZV9pZCA8IGNoYXRfbWVzc2FnZS5zd2lwZXMubGVuZ3RoKSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgaWYgKCFjaGF0X21lc3NhZ2Uuc3dpcGVzKSB7XG4gICAgICBjaGF0X21lc3NhZ2Uuc3dpcGVfaWQgPSAwO1xuICAgICAgY2hhdF9tZXNzYWdlLnN3aXBlcyA9IFtjaGF0X21lc3NhZ2UubWVzXTtcbiAgICAgIGNoYXRfbWVzc2FnZS52YXJpYWJsZXMgPSBbe31dO1xuICAgIH1cbiAgICBmb3IgKGxldCBpID0gY2hhdF9tZXNzYWdlLnN3aXBlcy5sZW5ndGg7IGkgPD0gc3dpcGVfaWQ7ICsraSkge1xuICAgICAgY2hhdF9tZXNzYWdlLnN3aXBlcy5wdXNoKCcnKTtcbiAgICAgIGNoYXRfbWVzc2FnZS52YXJpYWJsZXMucHVzaCh7fSk7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9O1xuXG4gIGNvbnN0IHN3aXBlX2lkX3ByZXZpb3VzX2luZGV4OiBudW1iZXIgPSBjaGF0X21lc3NhZ2Uuc3dpcGVfaWQgPz8gMDtcbiAgY29uc3Qgc3dpcGVfaWRfdG9fc2V0X2luZGV4OiBudW1iZXIgPSBzd2lwZV9pZCA9PSAnY3VycmVudCcgPyBzd2lwZV9pZF9wcmV2aW91c19pbmRleCA6IHN3aXBlX2lkO1xuICBjb25zdCBzd2lwZV9pZF90b191c2VfaW5kZXg6IG51bWJlciA9IHJlZnJlc2ggIT0gJ25vbmUnID8gc3dpcGVfaWRfdG9fc2V0X2luZGV4IDogc3dpcGVfaWRfcHJldmlvdXNfaW5kZXg7XG4gIGNvbnN0IG1lc3NhZ2U6IHN0cmluZyA9XG4gICAgZmllbGRfdmFsdWVzLm1lc3NhZ2UgPz9cbiAgICAoY2hhdF9tZXNzYWdlLnN3aXBlcyA/IGNoYXRfbWVzc2FnZS5zd2lwZXNbc3dpcGVfaWRfdG9fc2V0X2luZGV4XSA6IHVuZGVmaW5lZCkgPz9cbiAgICBjaGF0X21lc3NhZ2UubWVzO1xuXG4gIGNvbnN0IHVwZGF0ZV9jaGF0X21lc3NhZ2UgPSAoKSA9PiB7XG4gICAgY29uc3QgbWVzc2FnZV9kZW1hY3JvZWQgPSBzdWJzdGl0dXRlUGFyYW1zRXh0ZW5kZWQobWVzc2FnZSk7XG5cbiAgICBpZiAoZmllbGRfdmFsdWVzLmRhdGEpIHtcbiAgICAgIGlmICghY2hhdF9tZXNzYWdlLnZhcmlhYmxlcykge1xuICAgICAgICBjaGF0X21lc3NhZ2UudmFyaWFibGVzID0gW107XG4gICAgICB9XG4gICAgICBjaGF0X21lc3NhZ2UudmFyaWFibGVzW3N3aXBlX2lkX3RvX3NldF9pbmRleF0gPSBmaWVsZF92YWx1ZXMuZGF0YTtcbiAgICB9XG5cbiAgICBpZiAoY2hhdF9tZXNzYWdlLnN3aXBlcykge1xuICAgICAgY2hhdF9tZXNzYWdlLnN3aXBlc1tzd2lwZV9pZF90b19zZXRfaW5kZXhdID0gbWVzc2FnZV9kZW1hY3JvZWQ7XG4gICAgICBjaGF0X21lc3NhZ2Uuc3dpcGVfaWQgPSBzd2lwZV9pZF90b191c2VfaW5kZXg7XG4gICAgfVxuXG4gICAgaWYgKHN3aXBlX2lkX3RvX3VzZV9pbmRleCA9PT0gc3dpcGVfaWRfdG9fc2V0X2luZGV4KSB7XG4gICAgICBjaGF0X21lc3NhZ2UubWVzID0gbWVzc2FnZV9kZW1hY3JvZWQ7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IHVwZGF0ZV9wYXJ0aWFsX2h0bWwgPSBhc3luYyAoc2hvdWxkX3VwZGF0ZV9zd2lwZTogYm9vbGVhbikgPT4ge1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBjb25zdCBtZXNfaHRtbCA9ICQoYGRpdi5tZXNbbWVzaWQgPSBcIiR7bWVzc2FnZV9pZH1cIl1gKTtcbiAgICBpZiAoIW1lc19odG1sKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKHNob3VsZF91cGRhdGVfc3dpcGUpIHtcbiAgICAgIC8vIEZJWE1FOiDlj6rmnInkuIDmnaHmtojmga/ml7YsIHN3aXBlcy1jb3VudGVyIOS4jeS8muato+W4uOaYvuekujsg5q2k5aSW6L+Y6KaB6ICD6JmRIHN3aXBlcy1jb3VudGVyIOeahCBcIlN3aXBlICMgZm9yIEFsbCBNZXNzYWdlc1wiIOmAiemhuVxuICAgICAgbWVzX2h0bWwuZmluZCgnLnN3aXBlcy1jb3VudGVyJykudGV4dChgJHtzd2lwZV9pZF90b191c2VfaW5kZXggKyAxfVxcdTIwMGIvXFx1MjAwYiR7Y2hhdF9tZXNzYWdlLnN3aXBlcy5sZW5ndGh9YCk7XG4gICAgfVxuICAgIGlmIChyZWZyZXNoICE9ICdub25lJykge1xuICAgICAgbWVzX2h0bWxcbiAgICAgICAgLmZpbmQoJy5tZXNfdGV4dCcpXG4gICAgICAgIC5lbXB0eSgpXG4gICAgICAgIC5hcHBlbmQoXG4gICAgICAgICAgbWVzc2FnZUZvcm1hdHRpbmcobWVzc2FnZSwgY2hhdF9tZXNzYWdlLm5hbWUsIGNoYXRfbWVzc2FnZS5pc19zeXN0ZW0sIGNoYXRfbWVzc2FnZS5pc191c2VyLCBtZXNzYWdlX2lkKSxcbiAgICAgICAgKTtcbiAgICAgIGlmIChyZWZyZXNoID09PSAnZGlzcGxheV9hbmRfcmVuZGVyX2N1cnJlbnQnKSB7XG4gICAgICAgIGF3YWl0IGV2ZW50U291cmNlLmVtaXQoXG4gICAgICAgICAgY2hhdF9tZXNzYWdlLmlzX3VzZXIgPyBldmVudF90eXBlcy5VU0VSX01FU1NBR0VfUkVOREVSRUQgOiBldmVudF90eXBlcy5DSEFSQUNURVJfTUVTU0FHRV9SRU5ERVJFRCxcbiAgICAgICAgICBtZXNzYWdlX2lkLFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBjb25zdCBzaG91bGRfdXBkYXRlX3N3aXBlOiBib29sZWFuID0gYWRkX3N3aXBlc19pZl9yZXF1aXJlZCgpO1xuICB1cGRhdGVfY2hhdF9tZXNzYWdlKCk7XG4gIGF3YWl0IHNhdmVDaGF0Q29uZGl0aW9uYWwoKTtcbiAgaWYgKHJlZnJlc2ggPT0gJ2FsbCcpIHtcbiAgICBhd2FpdCByZWxvYWRDdXJyZW50Q2hhdCgpO1xuICB9IGVsc2Uge1xuICAgIGF3YWl0IHVwZGF0ZV9wYXJ0aWFsX2h0bWwoc2hvdWxkX3VwZGF0ZV9zd2lwZSk7XG4gIH1cblxuICBsb2cuaW5mbyhcbiAgICBg6K6+572u56ysICR7bWVzc2FnZV9pZH0g5qW85raI5oGvLCDpgInpobk6ICR7SlNPTi5zdHJpbmdpZnkoe1xuICAgICAgc3dpcGVfaWQsXG4gICAgICByZWZyZXNoLFxuICAgIH0pfSwg6K6+572u5YmN5L2/55So55qE5raI5oGv6aG1OiAke3N3aXBlX2lkX3ByZXZpb3VzX2luZGV4fSwg6K6+572u55qE5raI5oGv6aG1OiAke3N3aXBlX2lkX3RvX3NldF9pbmRleH0sIOeOsOWcqOS9v+eUqOeahOa2iOaBr+mhtTogJHtzd2lwZV9pZF90b191c2VfaW5kZXh9IGAsXG4gICk7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/function/chat_message.ts\n\n}")},"./src/function/displayed_message.ts":
/*!*******************************************!*\
  !*** ./src/function/displayed_message.ts ***!
  \*******************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   formatAsDisplayedMessage: () => (/* binding */ formatAsDisplayedMessage),\n/* harmony export */   retrieveDisplayedMessage: () => (/* binding */ retrieveDisplayedMessage)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_macros__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/macros */ \"@sillytavern/scripts/macros\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\nfunction formatAsDisplayedMessage(text, { message_id = 'last' } = {}) {\n    if (typeof message_id !== 'number' && !['last', 'last_user', 'last_char'].includes(message_id)) {\n        throw Error(`提供的 message_id 无效, 请提供 'last', 'last_user', 'last_char' 或楼层消息号, 你提供的是: ${message_id}`);\n    }\n    const last_message_id = (0,_sillytavern_scripts_macros__WEBPACK_IMPORTED_MODULE_1__.getLastMessageId)();\n    if (last_message_id === null) {\n        throw Error(`未找到任何消息楼层, 你提供的是: ${message_id}`);\n    }\n    switch (message_id) {\n        case 'last':\n            message_id = last_message_id;\n            break;\n        case 'last_user': {\n            const last_user_message_id = (0,_sillytavern_scripts_macros__WEBPACK_IMPORTED_MODULE_1__.getLastMessageId)({ filter: (m) => m.is_user && !m.is_system });\n            if (last_user_message_id === null) {\n                throw Error(`未找到任何 user 消息楼层, 你提供的是: ${message_id}`);\n            }\n            message_id = last_user_message_id;\n            break;\n        }\n        case 'last_char': {\n            const last_char_message_id = (0,_sillytavern_scripts_macros__WEBPACK_IMPORTED_MODULE_1__.getLastMessageId)({ filter: (m) => !m.is_user && !m.is_system });\n            if (last_char_message_id === null) {\n                throw Error(`未找到任何 char 消息楼层, 你提供的是: ${message_id}`);\n            }\n            message_id = last_char_message_id;\n            break;\n        }\n    }\n    if (message_id < 0 || message_id > last_message_id) {\n        throw Error(`提供的 message_id 不在 [0, ${last_message_id}] 内, 你提供的是: ${message_id} `);\n    }\n    const chat_message = _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat[message_id];\n    const result = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.messageFormatting)(text, chat_message.name, chat_message.is_system, chat_message.is_user, message_id);\n    loglevel__WEBPACK_IMPORTED_MODULE_2___default().info(`将字符串处理为酒馆用于显示的 html 格式, 字符串: '${text}', 选项: '${JSON.stringify({\n        message_id,\n    })}', 结果: '${result}'`);\n    return result;\n}\nfunction retrieveDisplayedMessage(message_id) {\n    return $(`div.mes[mesid = \"${message_id}\"]`, window.parent.document).find(`div.mes_text`);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZnVuY3Rpb24vZGlzcGxheWVkX21lc3NhZ2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQThEO0FBQ0M7QUFFcEM7QUFNcEIsU0FBUyx3QkFBd0IsQ0FDdEMsSUFBWSxFQUNaLEVBQUUsVUFBVSxHQUFHLE1BQU0sS0FBcUMsRUFBRTtJQUU1RCxJQUFJLE9BQU8sVUFBVSxLQUFLLFFBQVEsSUFBSSxDQUFDLENBQUMsTUFBTSxFQUFFLFdBQVcsRUFBRSxXQUFXLENBQUMsQ0FBQyxRQUFRLENBQUMsVUFBVSxDQUFDLEVBQUUsQ0FBQztRQUMvRixNQUFNLEtBQUssQ0FDVCwwRUFBMEUsVUFBVSxFQUFFLENBQ3ZGLENBQUM7SUFDSixDQUFDO0lBRUQsTUFBTSxlQUFlLEdBQUcsNkVBQWdCLEVBQUUsQ0FBQztJQUMzQyxJQUFJLGVBQWUsS0FBSyxJQUFJLEVBQUUsQ0FBQztRQUM3QixNQUFNLEtBQUssQ0FBQyxxQkFBcUIsVUFBVSxFQUFFLENBQUMsQ0FBQztJQUNqRCxDQUFDO0lBRUQsUUFBUSxVQUFVLEVBQUUsQ0FBQztRQUNuQixLQUFLLE1BQU07WUFDVCxVQUFVLEdBQUcsZUFBZSxDQUFDO1lBQzdCLE1BQU07UUFDUixLQUFLLFdBQVcsQ0FBQyxDQUFDLENBQUM7WUFDakIsTUFBTSxvQkFBb0IsR0FBRyw2RUFBZ0IsQ0FBQyxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQU0sRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLE9BQU8sSUFBSSxDQUFDLENBQUMsQ0FBQyxTQUFTLEVBQUUsQ0FBVyxDQUFDO1lBQzNHLElBQUksb0JBQW9CLEtBQUssSUFBSSxFQUFFLENBQUM7Z0JBQ2xDLE1BQU0sS0FBSyxDQUFDLDJCQUEyQixVQUFVLEVBQUUsQ0FBQyxDQUFDO1lBQ3ZELENBQUM7WUFDRCxVQUFVLEdBQUcsb0JBQW9CLENBQUM7WUFDbEMsTUFBTTtRQUNSLENBQUM7UUFDRCxLQUFLLFdBQVcsQ0FBQyxDQUFDLENBQUM7WUFDakIsTUFBTSxvQkFBb0IsR0FBRyw2RUFBZ0IsQ0FBQyxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQU0sRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxJQUFJLENBQUMsQ0FBQyxDQUFDLFNBQVMsRUFBRSxDQUFXLENBQUM7WUFDNUcsSUFBSSxvQkFBb0IsS0FBSyxJQUFJLEVBQUUsQ0FBQztnQkFDbEMsTUFBTSxLQUFLLENBQUMsMkJBQTJCLFVBQVUsRUFBRSxDQUFDLENBQUM7WUFDdkQsQ0FBQztZQUNELFVBQVUsR0FBRyxvQkFBb0IsQ0FBQztZQUNsQyxNQUFNO1FBQ1IsQ0FBQztJQUNILENBQUM7SUFDRCxJQUFJLFVBQVUsR0FBRyxDQUFDLElBQUksVUFBVSxHQUFHLGVBQWUsRUFBRSxDQUFDO1FBQ25ELE1BQU0sS0FBSyxDQUFDLHlCQUF5QixlQUFlLGVBQWUsVUFBVSxHQUFHLENBQUMsQ0FBQztJQUNwRixDQUFDO0lBRUQsTUFBTSxZQUFZLEdBQUcscURBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUN0QyxNQUFNLE1BQU0sR0FBRyxzRUFBaUIsQ0FBQyxJQUFJLEVBQUUsWUFBWSxDQUFDLElBQUksRUFBRSxZQUFZLENBQUMsU0FBUyxFQUFFLFlBQVksQ0FBQyxPQUFPLEVBQUUsVUFBVSxDQUFDLENBQUM7SUFFcEgsb0RBQVEsQ0FDTixpQ0FBaUMsSUFBSSxXQUFXLElBQUksQ0FBQyxTQUFTLENBQUM7UUFDN0QsVUFBVTtLQUNYLENBQUMsV0FBVyxNQUFNLEdBQUcsQ0FDdkIsQ0FBQztJQUNGLE9BQU8sTUFBTSxDQUFDO0FBQ2hCLENBQUM7QUFFTSxTQUFTLHdCQUF3QixDQUFDLFVBQWtCO0lBQ3pELE9BQU8sQ0FBQyxDQUFDLG9CQUFvQixVQUFVLElBQUksRUFBRSxNQUFNLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsQ0FBQztBQUM1RixDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2Z1bmN0aW9uL2Rpc3BsYXllZF9tZXNzYWdlLnRzP2UxOTQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY2hhdCwgbWVzc2FnZUZvcm1hdHRpbmcgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0JztcbmltcG9ydCB7IGdldExhc3RNZXNzYWdlSWQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9tYWNyb3MnO1xuXG5pbXBvcnQgbG9nIGZyb20gJ2xvZ2xldmVsJztcblxudHlwZSBGb3JtYXRBc0Rpc3BsYXllZE1lc3NhZ2VPcHRpb24gPSB7XG4gIG1lc3NhZ2VfaWQ/OiAnbGFzdCcgfCAnbGFzdF91c2VyJyB8ICdsYXN0X2NoYXInIHwgbnVtYmVyO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdEFzRGlzcGxheWVkTWVzc2FnZShcbiAgdGV4dDogc3RyaW5nLFxuICB7IG1lc3NhZ2VfaWQgPSAnbGFzdCcgfTogRm9ybWF0QXNEaXNwbGF5ZWRNZXNzYWdlT3B0aW9uID0ge30sXG4pOiBzdHJpbmcge1xuICBpZiAodHlwZW9mIG1lc3NhZ2VfaWQgIT09ICdudW1iZXInICYmICFbJ2xhc3QnLCAnbGFzdF91c2VyJywgJ2xhc3RfY2hhciddLmluY2x1ZGVzKG1lc3NhZ2VfaWQpKSB7XG4gICAgdGhyb3cgRXJyb3IoXG4gICAgICBg5o+Q5L6b55qEIG1lc3NhZ2VfaWQg5peg5pWILCDor7fmj5DkvpsgJ2xhc3QnLCAnbGFzdF91c2VyJywgJ2xhc3RfY2hhcicg5oiW5qW85bGC5raI5oGv5Y+3LCDkvaDmj5DkvpvnmoTmmK86ICR7bWVzc2FnZV9pZH1gLFxuICAgICk7XG4gIH1cblxuICBjb25zdCBsYXN0X21lc3NhZ2VfaWQgPSBnZXRMYXN0TWVzc2FnZUlkKCk7XG4gIGlmIChsYXN0X21lc3NhZ2VfaWQgPT09IG51bGwpIHtcbiAgICB0aHJvdyBFcnJvcihg5pyq5om+5Yiw5Lu75L2V5raI5oGv5qW85bGCLCDkvaDmj5DkvpvnmoTmmK86ICR7bWVzc2FnZV9pZH1gKTtcbiAgfVxuXG4gIHN3aXRjaCAobWVzc2FnZV9pZCkge1xuICAgIGNhc2UgJ2xhc3QnOlxuICAgICAgbWVzc2FnZV9pZCA9IGxhc3RfbWVzc2FnZV9pZDtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ2xhc3RfdXNlcic6IHtcbiAgICAgIGNvbnN0IGxhc3RfdXNlcl9tZXNzYWdlX2lkID0gZ2V0TGFzdE1lc3NhZ2VJZCh7IGZpbHRlcjogKG06IGFueSkgPT4gbS5pc191c2VyICYmICFtLmlzX3N5c3RlbSB9KSBhcyBudW1iZXI7XG4gICAgICBpZiAobGFzdF91c2VyX21lc3NhZ2VfaWQgPT09IG51bGwpIHtcbiAgICAgICAgdGhyb3cgRXJyb3IoYOacquaJvuWIsOS7u+S9lSB1c2VyIOa2iOaBr+alvOWxgiwg5L2g5o+Q5L6b55qE5pivOiAke21lc3NhZ2VfaWR9YCk7XG4gICAgICB9XG4gICAgICBtZXNzYWdlX2lkID0gbGFzdF91c2VyX21lc3NhZ2VfaWQ7XG4gICAgICBicmVhaztcbiAgICB9XG4gICAgY2FzZSAnbGFzdF9jaGFyJzoge1xuICAgICAgY29uc3QgbGFzdF9jaGFyX21lc3NhZ2VfaWQgPSBnZXRMYXN0TWVzc2FnZUlkKHsgZmlsdGVyOiAobTogYW55KSA9PiAhbS5pc191c2VyICYmICFtLmlzX3N5c3RlbSB9KSBhcyBudW1iZXI7XG4gICAgICBpZiAobGFzdF9jaGFyX21lc3NhZ2VfaWQgPT09IG51bGwpIHtcbiAgICAgICAgdGhyb3cgRXJyb3IoYOacquaJvuWIsOS7u+S9lSBjaGFyIOa2iOaBr+alvOWxgiwg5L2g5o+Q5L6b55qE5pivOiAke21lc3NhZ2VfaWR9YCk7XG4gICAgICB9XG4gICAgICBtZXNzYWdlX2lkID0gbGFzdF9jaGFyX21lc3NhZ2VfaWQ7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cbiAgaWYgKG1lc3NhZ2VfaWQgPCAwIHx8IG1lc3NhZ2VfaWQgPiBsYXN0X21lc3NhZ2VfaWQpIHtcbiAgICB0aHJvdyBFcnJvcihg5o+Q5L6b55qEIG1lc3NhZ2VfaWQg5LiN5ZyoIFswLCAke2xhc3RfbWVzc2FnZV9pZH1dIOWGhSwg5L2g5o+Q5L6b55qE5pivOiAke21lc3NhZ2VfaWR9IGApO1xuICB9XG5cbiAgY29uc3QgY2hhdF9tZXNzYWdlID0gY2hhdFttZXNzYWdlX2lkXTtcbiAgY29uc3QgcmVzdWx0ID0gbWVzc2FnZUZvcm1hdHRpbmcodGV4dCwgY2hhdF9tZXNzYWdlLm5hbWUsIGNoYXRfbWVzc2FnZS5pc19zeXN0ZW0sIGNoYXRfbWVzc2FnZS5pc191c2VyLCBtZXNzYWdlX2lkKTtcblxuICBsb2cuaW5mbyhcbiAgICBg5bCG5a2X56ym5Liy5aSE55CG5Li66YWS6aaG55So5LqO5pi+56S655qEIGh0bWwg5qC85byPLCDlrZfnrKbkuLI6ICcke3RleHR9Jywg6YCJ6aG5OiAnJHtKU09OLnN0cmluZ2lmeSh7XG4gICAgICBtZXNzYWdlX2lkLFxuICAgIH0pfScsIOe7k+aenDogJyR7cmVzdWx0fSdgLFxuICApO1xuICByZXR1cm4gcmVzdWx0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmV0cmlldmVEaXNwbGF5ZWRNZXNzYWdlKG1lc3NhZ2VfaWQ6IG51bWJlcik6IEpRdWVyeTxIVE1MRGl2RWxlbWVudD4ge1xuICByZXR1cm4gJChgZGl2Lm1lc1ttZXNpZCA9IFwiJHttZXNzYWdlX2lkfVwiXWAsIHdpbmRvdy5wYXJlbnQuZG9jdW1lbnQpLmZpbmQoYGRpdi5tZXNfdGV4dGApO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/function/displayed_message.ts\n\n}")},"./src/function/generate/dataProcessor.ts":
/*!************************************************!*\
  !*** ./src/function/generate/dataProcessor.ts ***!
  \************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prepareAndOverrideData: () => (/* binding */ prepareAndOverrideData)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/authors-note */ \"@sillytavern/scripts/authors-note\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var _sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/scripts/extensions/regex/engine */ \"@sillytavern/scripts/extensions/regex/engine\");\n/* harmony import */ var _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sillytavern/scripts/openai */ \"@sillytavern/scripts/openai\");\n/* harmony import */ var _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @sillytavern/scripts/power-user */ \"@sillytavern/scripts/power-user\");\n/* harmony import */ var _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @sillytavern/scripts/world-info */ \"@sillytavern/scripts/world-info\");\n/* harmony import */ var _function_generate_types__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @/function/generate/types */ \"./src/function/generate/types.ts\");\n/* harmony import */ var _function_generate_utils__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @/function/generate/utils */ \"./src/function/generate/utils.ts\");\n\n\n\n\n\n\n\n\n\n/**\n * 准备并覆盖数据的核心函数\n * @param config 配置参数\n * @param processedUserInput 处理后的用户输入\n * @returns 包含角色信息、聊天上下文和世界信息的数据对象\n */\nasync function prepareAndOverrideData(config, processedUserInput) {\n    const getOverrideContent = (identifier) => {\n        if (!config.overrides)\n            return undefined;\n        const value = config.overrides[identifier];\n        if (typeof value === 'boolean')\n            return undefined;\n        return value;\n    };\n    // 1. 处理角色卡高级定义角色备注 - 仅在chat_history未被过滤时执行\n    if (!(0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_8__.isPromptFiltered)('chat_history', config)) {\n        handleCharDepthPrompt();\n    }\n    // 2. 设置作者注释 - 仅在chat_history未被过滤时执行\n    if (!(0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_8__.isPromptFiltered)('chat_history', config) && !(0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_8__.isPromptFiltered)('author_note', config)) {\n        setAuthorNotePrompt(config);\n    }\n    // 3. 处理user角色描述 - 仅在chat_history和persona_description都未被过滤时执行\n    if (!(0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_8__.isPromptFiltered)('chat_history', config) && !(0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_8__.isPromptFiltered)('persona_description', config)) {\n        setPersonaDescriptionExtensionPrompt();\n    }\n    // 4. 获取角色卡基础字段\n    const charDepthPrompt = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.baseChatReplace)(\n    // @ts-ignore\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid]?.data?.extensions?.depth_prompt?.prompt?.trim(), _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name1, _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name2);\n    const creatorNotes = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.baseChatReplace)(\n    // @ts-ignore\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid]?.data?.creator_notes?.trim(), _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name1, _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name2);\n    const { description: rawDescription, personality: rawPersonality, persona: rawPersona, scenario: rawScenario, mesExamples: rawMesExamples, system, jailbreak, } = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.getCharacterCardFields)();\n    // 判断是否被过滤,如果被过滤返回空字符串,否则返回override的值或原始值\n    const description = (0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_8__.isPromptFiltered)('char_description', config)\n        ? ''\n        : getOverrideContent('char_description') ?? rawDescription;\n    const personality = (0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_8__.isPromptFiltered)('char_personality', config)\n        ? ''\n        : getOverrideContent('char_personality') ?? rawPersonality;\n    const persona = (0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_8__.isPromptFiltered)('persona_description', config)\n        ? ''\n        : getOverrideContent('persona_description') ?? rawPersona;\n    const scenario = (0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_8__.isPromptFiltered)('scenario', config) ? '' : getOverrideContent('scenario') ?? rawScenario;\n    const mesExamples = (0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_8__.isPromptFiltered)('dialogue_examples', config)\n        ? ''\n        : getOverrideContent('dialogue_examples') ?? rawMesExamples;\n    let mesExamplesArray = (0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_8__.parseMesExamples)(mesExamples);\n    let oaiMessageExamples = [];\n    oaiMessageExamples = (0,_sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_4__.setOpenAIMessageExamples)(mesExamplesArray);\n    // 5. 获取偏置字符串\n    const { promptBias } = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.getBiasStrings)(processedUserInput, 'quiet');\n    // 6. 处理自定义注入的提示词\n    if (config.inject) {\n        await handleInjectedPrompts(config);\n    }\n    // 7. 处理聊天记录\n    let oaiMessages = [];\n    if (config.overrides?.chat_history) {\n        oaiMessages = [...config.overrides.chat_history].reverse();\n    }\n    else {\n        oaiMessages = (0,_sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_4__.setOpenAIMessages)(await processChatHistory(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat));\n        if (config.max_chat_history !== undefined) {\n            oaiMessages = oaiMessages.slice(0, config.max_chat_history);\n        }\n    }\n    // 添加临时消息用于激活世界书\n    (0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_8__.addTemporaryUserMessage)(processedUserInput);\n    // 8. 处理世界信息\n    const worldInfo = await processWorldInfo(oaiMessages, config, {\n        description: rawDescription,\n        personality: rawPersonality,\n        persona: rawPersona,\n        scenario: rawScenario,\n        charDepthPrompt,\n        creatorNotes,\n    });\n    // 移除临时消息\n    (0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_8__.removeTemporaryUserMessage)();\n    // 9. 处理世界书消息示例\n    mesExamplesArray = !(0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_8__.isPromptFiltered)('dialogue_examples', config)\n        ? await processMessageExamples(mesExamplesArray, worldInfo.worldInfoExamples)\n        : [];\n    return {\n        characterInfo: {\n            description,\n            personality,\n            persona,\n            scenario,\n            system: system,\n            jailbreak: jailbreak,\n        },\n        chatContext: {\n            oaiMessages,\n            oaiMessageExamples,\n            promptBias,\n        },\n        worldInfo,\n    };\n}\n/**\n * 处理角色卡中的深度提示词\n */\nfunction handleCharDepthPrompt() {\n    const depthPromptText = \n    // @ts-ignore\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.baseChatReplace)(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid]?.data?.extensions?.depth_prompt?.prompt?.trim(), _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name1, _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name2) || '';\n    // @ts-ignore\n    const depthPromptDepth = _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid]?.data?.extensions?.depth_prompt?.depth ?? '4';\n    const depthPromptRole = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.getExtensionPromptRoleByName)(\n    // @ts-ignore\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid]?.data?.extensions?.depth_prompt?.role ?? 'system');\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.setExtensionPrompt)('DEPTH_PROMPT', depthPromptText, _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_types.IN_CHAT, depthPromptDepth, \n    // @ts-ignore\n    _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.extension_settings.note.allowWIScan, depthPromptRole);\n}\n/**\n * 处理作者注释\n */\nfunction setAuthorNotePrompt(config) {\n    const authorNoteOverride = config?.overrides?.author_note;\n    // @ts-ignore\n    const prompt = authorNoteOverride ?? $('#extension_floating_prompt').val();\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.setExtensionPrompt)(_sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__.NOTE_MODULE_NAME, prompt, \n    // @ts-ignore\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat_metadata[_sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__.metadata_keys.position], \n    // @ts-ignore\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat_metadata[_sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__.metadata_keys.depth], \n    // @ts-ignore\n    _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.extension_settings.note.allowWIScan, \n    // @ts-ignore\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat_metadata[_sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__.metadata_keys.role]);\n}\n/**\n * 用户角色描述提示词设置为提示词管理器之外的选项的情况\n */\nfunction setPersonaDescriptionExtensionPrompt() {\n    const description = _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_5__.power_user.persona_description;\n    const INJECT_TAG = 'PERSONA_DESCRIPTION';\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.setExtensionPrompt)(INJECT_TAG, '', _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_types.IN_PROMPT, 0);\n    if (!description || _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_5__.power_user.persona_description_position === _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_5__.persona_description_positions.NONE) {\n        return;\n    }\n    //当user信息在作者注释前后 - 仅在作者注释未被过滤时执行\n    const promptPositions = [_sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_5__.persona_description_positions.BOTTOM_AN, _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_5__.persona_description_positions.TOP_AN];\n    if (promptPositions.includes(_sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_5__.power_user.persona_description_position) && _sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__.shouldWIAddPrompt) {\n        // @ts-ignore\n        const originalAN = (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.getContext)().extensionPrompts[_sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__.NOTE_MODULE_NAME].value;\n        const ANWithDesc = _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_5__.power_user.persona_description_position === _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_5__.persona_description_positions.TOP_AN\n            ? `${description}\\n${originalAN}`\n            : `${originalAN}\\n${description}`;\n        (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.setExtensionPrompt)(_sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__.NOTE_MODULE_NAME, ANWithDesc, \n        // @ts-ignore\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat_metadata[_sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__.metadata_keys.position], \n        // @ts-ignore\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat_metadata[_sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__.metadata_keys.depth], \n        // @ts-ignore\n        _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.extension_settings.note.allowWIScan, \n        // @ts-ignore\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat_metadata[_sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__.metadata_keys.role]);\n    }\n    // user信息深度注入不依赖于作者注释的状态，直接应用\n    if (_sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_5__.power_user.persona_description_position === _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_5__.persona_description_positions.AT_DEPTH) {\n        (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.setExtensionPrompt)(INJECT_TAG, description, _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_types.IN_CHAT, _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_5__.power_user.persona_description_depth, true, _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_5__.power_user.persona_description_role);\n    }\n}\n/**\n * 处理注入的提示词\n */\nasync function handleInjectedPrompts(promptConfig) {\n    if (!promptConfig || !Array.isArray(promptConfig.inject))\n        return;\n    const injects = promptConfig.inject;\n    const position_map = {\n        before_prompt: _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_types.BEFORE_PROMPT,\n        in_chat: _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_types.IN_CHAT,\n        after_prompt: _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_types.IN_PROMPT,\n        none: _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_types.NONE,\n    };\n    for (const inject of injects) {\n        const validatedInject = {\n            role: _function_generate_types__WEBPACK_IMPORTED_MODULE_7__.roleTypes[inject.role] ?? _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_roles.SYSTEM,\n            content: inject.content || '',\n            depth: Number(inject.depth) || 0,\n            should_scan: Boolean(inject.should_scan) || true,\n            position: position_map[inject.position] ?? _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_types.IN_CHAT,\n        };\n        // 设置用户自定义注入提示词\n        (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.setExtensionPrompt)(`INJECTION-${inject.depth}-${inject.role}`, validatedInject.content, validatedInject.position, validatedInject.depth, validatedInject.should_scan, validatedInject.role);\n    }\n}\n/**\n * 处理聊天记录\n */\nasync function processChatHistory(chatHistory) {\n    const coreChat = chatHistory.filter(x => !x.is_system);\n    return await Promise.all(coreChat.map(async (chatItem, index) => {\n        const message = chatItem.mes;\n        const regexType = chatItem.is_user ? _sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_3__.regex_placement.USER_INPUT : _sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_3__.regex_placement.AI_OUTPUT;\n        const regexedMessage = (0,_sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_3__.getRegexedString)(message, regexType, {\n            isPrompt: true,\n            depth: coreChat.length - index - 1,\n        });\n        return {\n            ...chatItem,\n            mes: regexedMessage,\n            index,\n        };\n    }));\n}\n/**\n * 处理世界书\n */\nasync function processWorldInfo(oaiMessages, config, characterInfo) {\n    const chatForWI = oaiMessages\n        .filter(x => x.role !== 'system')\n        .map(x => {\n        const name = x.role === 'user' ? _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name1 : _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name2;\n        return _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_6__.world_info_include_names ? `${name}: ${x.content}` : x.content;\n    })\n        .reverse();\n    const this_max_context = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.getMaxContextSize)();\n    const globalScanData = {\n        personaDescription: config.overrides?.persona_description ?? characterInfo.persona,\n        characterDescription: config.overrides?.char_description ?? characterInfo.description,\n        characterPersonality: config.overrides?.char_personality ?? characterInfo.personality,\n        characterDepthPrompt: characterInfo.charDepthPrompt,\n        scenario: config.overrides?.scenario ?? characterInfo.scenario,\n        creatorNotes: characterInfo.creatorNotes,\n    };\n    const { worldInfoString, worldInfoBefore, worldInfoAfter, worldInfoExamples, worldInfoDepth } = \n    // globalScanData只在新的酒馆版本中存在\n    // @ts-ignore\n    await (0,_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_6__.getWorldInfoPrompt)(chatForWI, this_max_context, false, globalScanData);\n    await (0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_8__.clearInjectionPrompts)(['customDepthWI']);\n    if (!(0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_8__.isPromptFiltered)('with_depth_entries', config)) {\n        processWorldInfoDepth(worldInfoDepth);\n    }\n    // 先检查是否被过滤，如果被过滤直接返回null\n    const finalWorldInfoBefore = (0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_8__.isPromptFiltered)('world_info_before', config)\n        ? null\n        : config.overrides?.world_info_before !== undefined\n            ? config.overrides.world_info_before\n            : worldInfoBefore;\n    const finalWorldInfoAfter = (0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_8__.isPromptFiltered)('world_info_after', config)\n        ? null\n        : config.overrides?.world_info_after !== undefined\n            ? config.overrides.world_info_after\n            : worldInfoAfter;\n    return {\n        worldInfoString,\n        worldInfoBefore: finalWorldInfoBefore,\n        worldInfoAfter: finalWorldInfoAfter,\n        worldInfoExamples,\n        worldInfoDepth: !(0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_8__.isPromptFiltered)('with_depth_entries', config) ? worldInfoDepth : null,\n    };\n}\n/**\n * 处理世界信息深度部分\n */\nfunction processWorldInfoDepth(worldInfoDepth) {\n    if (Array.isArray(worldInfoDepth)) {\n        worldInfoDepth.forEach(entry => {\n            const joinedEntries = entry.entries.join('\\n');\n            (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.setExtensionPrompt)(`customDepthWI-${entry.depth}-${entry.role}`, joinedEntries, _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_types.IN_CHAT, entry.depth, false, entry.role);\n        });\n    }\n}\n/**\n * 处理世界书中示例前后\n */\nasync function processMessageExamples(mesExamplesArray, worldInfoExamples) {\n    // 处理世界信息中的示例\n    for (const example of worldInfoExamples) {\n        if (!example.content.length)\n            continue;\n        const formattedExample = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.baseChatReplace)(example.content, _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name1, _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name2);\n        const cleanedExample = (0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_8__.parseMesExamples)(formattedExample);\n        if (example.position === _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_6__.wi_anchor_position.before) {\n            mesExamplesArray.unshift(...cleanedExample);\n        }\n        else {\n            mesExamplesArray.push(...cleanedExample);\n        }\n    }\n    return mesExamplesArray;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZnVuY3Rpb24vZ2VuZXJhdGUvZGF0YVByb2Nlc3Nvci50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBZTZCO0FBQzBFO0FBQ3RCO0FBQ2dCO0FBQ1A7QUFDRTtBQUN1QjtBQUV6QztBQU92QztBQUVuQzs7Ozs7R0FLRztBQUNJLEtBQUssVUFBVSxzQkFBc0IsQ0FDMUMsTUFBZ0UsRUFDaEUsa0JBQTBCO0lBRTFCLE1BQU0sa0JBQWtCLEdBQUcsQ0FBQyxVQUFrQixFQUFxQyxFQUFFO1FBQ25GLElBQUksQ0FBQyxNQUFNLENBQUMsU0FBUztZQUFFLE9BQU8sU0FBUyxDQUFDO1FBQ3hDLE1BQU0sS0FBSyxHQUFHLE1BQU0sQ0FBQyxTQUFTLENBQUMsVUFBeUMsQ0FBQyxDQUFDO1FBQzFFLElBQUksT0FBTyxLQUFLLEtBQUssU0FBUztZQUFFLE9BQU8sU0FBUyxDQUFDO1FBQ2pELE9BQU8sS0FBSyxDQUFDO0lBQ2YsQ0FBQyxDQUFDO0lBRUYsMkNBQTJDO0lBQzNDLElBQUksQ0FBQywwRUFBZ0IsQ0FBQyxjQUFjLEVBQUUsTUFBTSxDQUFDLEVBQUUsQ0FBQztRQUM5QyxxQkFBcUIsRUFBRSxDQUFDO0lBQzFCLENBQUM7SUFFRCxvQ0FBb0M7SUFDcEMsSUFBSSxDQUFDLDBFQUFnQixDQUFDLGNBQWMsRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLDBFQUFnQixDQUFDLGFBQWEsRUFBRSxNQUFNLENBQUMsRUFBRSxDQUFDO1FBQzFGLG1CQUFtQixDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQzlCLENBQUM7SUFFRCw2REFBNkQ7SUFDN0QsSUFBSSxDQUFDLDBFQUFnQixDQUFDLGNBQWMsRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLDBFQUFnQixDQUFDLHFCQUFxQixFQUFFLE1BQU0sQ0FBQyxFQUFFLENBQUM7UUFDbEcsb0NBQW9DLEVBQUUsQ0FBQztJQUN6QyxDQUFDO0lBRUQsZUFBZTtJQUNmLE1BQU0sZUFBZSxHQUFHLG9FQUFlO0lBQ3JDLGFBQWE7SUFD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Q0FDWCxDQUFDO1FBQ0osQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDO0FBQ0gsQ0FBQztBQUVEOztHQUVHO0FBQ0gsS0FBSyxVQUFVLHNCQUFzQixDQUFDLGdCQUEwQixFQUFFLGlCQUF3QjtJQUN4RixhQUFhO0lBQ2IsS0FBSyxNQUFNLE9BQU8sSUFBSSxpQkFBaUIsRUFBRSxDQUFDO1FBQ3hDLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLE1BQU07WUFBRSxTQUFTO1FBRXRDLE1BQU0sZ0JBQWdCLEdBQUcsb0VBQWUsQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLHNEQUFLLEVBQUUsc0RBQUssQ0FBQyxDQUFDO1FBQ3hFLE1BQU0sY0FBYyxHQUFHLDBFQUFnQixDQUFDLGdCQUFnQixDQUFDLENBQUM7UUFFMUQsSUFBSSxPQUFPLENBQUMsUUFBUSxLQUFLLCtFQUFrQixDQUFDLE1BQU0sRUFBRSxDQUFDO1lBQ25ELGdCQUFnQixDQUFDLE9BQU8sQ0FBQyxHQUFHLGNBQWMsQ0FBQyxDQUFDO1FBQzlDLENBQUM7YUFBTSxDQUFDO1lBQ04sZ0JBQWdCLENBQUMsSUFBSSxDQUFDLEdBQUcsY0FBYyxDQUFDLENBQUM7UUFDM0MsQ0FBQztJQUNILENBQUM7SUFFRCxPQUFPLGdCQUFnQixDQUFDO0FBQzFCLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvZnVuY3Rpb24vZ2VuZXJhdGUvZGF0YVByb2Nlc3Nvci50cz81Nzk2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIGJhc2VDaGF0UmVwbGFjZSxcbiAgY2hhcmFjdGVycyxcbiAgY2hhdCxcbiAgY2hhdF9tZXRhZGF0YSxcbiAgZXh0ZW5zaW9uX3Byb21wdF9yb2xlcyxcbiAgZXh0ZW5zaW9uX3Byb21wdF90eXBlcyxcbiAgZ2V0Qmlhc1N0cmluZ3MsXG4gIGdldENoYXJhY3RlckNhcmRGaWVsZHMsXG4gIGdldEV4dGVuc2lvblByb21wdFJvbGVCeU5hbWUsXG4gIGdldE1heENvbnRleHRTaXplLFxuICBuYW1lMSxcbiAgbmFtZTIsXG4gIHNldEV4dGVuc2lvblByb21wdCxcbiAgdGhpc19jaGlkLFxufSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0JztcbmltcG9ydCB7IG1ldGFkYXRhX2tleXMsIE5PVEVfTU9EVUxFX05BTUUsIHNob3VsZFdJQWRkUHJvbXB0IH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvYXV0aG9ycy1ub3RlJztcbmltcG9ydCB7IGV4dGVuc2lvbl9zZXR0aW5ncywgZ2V0Q29udGV4dCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL2V4dGVuc2lvbnMnO1xuaW1wb3J0IHsgZ2V0UmVnZXhlZFN0cmluZywgcmVnZXhfcGxhY2VtZW50IH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvZXh0ZW5zaW9ucy9yZWdleC9lbmdpbmUnO1xuaW1wb3J0IHsgc2V0T3BlbkFJTWVzc2FnZUV4YW1wbGVzLCBzZXRPcGVuQUlNZXNzYWdlcyB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL29wZW5haSc7XG5pbXBvcnQgeyBwZXJzb25hX2Rlc2NyaXB0aW9uX3Bvc2l0aW9ucywgcG93ZXJfdXNlciB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3Bvd2VyLXVzZXInO1xuaW1wb3J0IHsgZ2V0V29ybGRJbmZvUHJvbXB0LCB3aV9hbmNob3JfcG9zaXRpb24sIHdvcmxkX2luZm9faW5jbHVkZV9uYW1lcyB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3dvcmxkLWluZm8nO1xuXG5pbXBvcnQgeyBkZXRhaWwsIFJvbGVQcm9tcHQsIHJvbGVUeXBlcyB9IGZyb20gJ0AvZnVuY3Rpb24vZ2VuZXJhdGUvdHlwZXMnO1xuaW1wb3J0IHtcbiAgYWRkVGVtcG9yYXJ5VXNlck1lc3NhZ2UsXG4gIGNsZWFySW5qZWN0aW9uUHJvbXB0cyxcbiAgaXNQcm9tcHRGaWx0ZXJlZCxcbiAgcGFyc2VNZXNFeGFtcGxlcyxcbiAgcmVtb3ZlVGVtcG9yYXJ5VXNlck1lc3NhZ2UsXG59IGZyb20gJ0AvZnVuY3Rpb24vZ2VuZXJhdGUvdXRpbHMnO1xuXG4vKipcbiAqIOWHhuWkh+W5tuimhuebluaVsOaNrueahOaguOW/g+WHveaVsFxuICogQHBhcmFtIGNvbmZpZyDphY3nva7lj4LmlbBcbiAqIEBwYXJhbSBwcm9jZXNzZWRVc2VySW5wdXQg5aSE55CG5ZCO55qE55So5oi36L6T5YWlXG4gKiBAcmV0dXJucyDljIXlkKvop5LoibLkv6Hmga/jgIHogYrlpKnkuIrkuIvmloflkozkuJbnlYzkv6Hmga/nmoTmlbDmja7lr7nosaFcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHByZXBhcmVBbmRPdmVycmlkZURhdGEoXG4gIGNvbmZpZzogT21pdDxkZXRhaWwuR2VuZXJhdGVQYXJhbXMsICd1c2VyX2lucHV0JyB8ICd1c2VfcHJlc2V0Jz4sXG4gIHByb2Nlc3NlZFVzZXJJbnB1dDogc3RyaW5nLFxuKSB7XG4gIGNvbnN0IGdldE92ZXJyaWRlQ29udGVudCA9IChpZGVudGlmaWVyOiBzdHJpbmcpOiBzdHJpbmcgfCBSb2xlUHJvbXB0W10gfCB1bmRlZmluZWQgPT4ge1xuICAgIGlmICghY29uZmlnLm92ZXJyaWRlcykgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICBjb25zdCB2YWx1ZSA9IGNvbmZpZy5vdmVycmlkZXNbaWRlbnRpZmllciBhcyBrZXlvZiBkZXRhaWwuT3ZlcnJpZGVDb25maWddO1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdib29sZWFuJykgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICByZXR1cm4gdmFsdWU7XG4gIH07XG5cbiAgLy8gMS4g5aSE55CG6KeS6Imy5Y2h6auY57qn5a6a5LmJ6KeS6Imy5aSH5rOoIC0g5LuF5ZyoY2hhdF9oaXN0b3J55pyq6KKr6L+H5ruk5pe25omn6KGMXG4gIGlmICghaXNQcm9tcHRGaWx0ZXJlZCgnY2hhdF9oaXN0b3J5JywgY29uZmlnKSkge1xuICAgIGhhbmRsZUNoYXJEZXB0aFByb21wdCgpO1xuICB9XG5cbiAgLy8gMi4g6K6+572u5L2c6ICF5rOo6YeKIC0g5LuF5ZyoY2hhdF9oaXN0b3J55pyq6KKr6L+H5ruk5pe25omn6KGMXG4gIGlmICghaXNQcm9tcHRGaWx0ZXJlZCgnY2hhdF9oaXN0b3J5JywgY29uZmlnKSAmJiAhaXNQcm9tcHRGaWx0ZXJlZCgnYXV0aG9yX25vdGUnLCBjb25maWcpKSB7XG4gICAgc2V0QXV0aG9yTm90ZVByb21wdChjb25maWcpO1xuICB9XG5cbiAgLy8gMy4g5aSE55CGdXNlcuinkuiJsuaPj+i/sCAtIOS7heWcqGNoYXRfaGlzdG9yeeWSjHBlcnNvbmFfZGVzY3JpcHRpb27pg73mnKrooqvov4fmu6Tml7bmiafooYxcbiAgaWYgKCFpc1Byb21wdEZpbHRlcmVkKCdjaGF0X2hpc3RvcnknLCBjb25maWcpICYmICFpc1Byb21wdEZpbHRlcmVkKCdwZXJzb25hX2Rlc2NyaXB0aW9uJywgY29uZmlnKSkge1xuICAgIHNldFBlcnNvbmFEZXNjcmlwdGlvbkV4dGVuc2lvblByb21wdCgpO1xuICB9XG5cbiAgLy8gNC4g6I635Y+W6KeS6Imy5Y2h5Z+656GA5a2X5q61XG4gIGNvbnN0IGNoYXJEZXB0aFByb21wdCA9IGJhc2VDaGF0UmVwbGFjZShcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgY2hhcmFjdGVyc1t0aGlzX2NoaWRdPy5kYXRhPy5leHRlbnNpb25zPy5kZXB0aF9wcm9tcHQ/LnByb21wdD8udHJpbSgpLFxuICAgIG5hbWUxLFxuICAgIG5hbWUyLFxuICApO1xuICBjb25zdCBjcmVhdG9yTm90ZXMgPSBiYXNlQ2hhdFJlcGxhY2UoXG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGNoYXJhY3RlcnNbdGhpc19jaGlkXT8uZGF0YT8uY3JlYXRvcl9ub3Rlcz8udHJpbSgpLFxuICAgIG5hbWUxLFxuICAgIG5hbWUyLFxuICApO1xuICBjb25zdCB7XG4gICAgZGVzY3JpcHRpb246IHJhd0Rlc2NyaXB0aW9uLFxuICAgIHBlcnNvbmFsaXR5OiByYXdQZXJzb25hbGl0eSxcbiAgICBwZXJzb25hOiByYXdQZXJzb25hLFxuICAgIHNjZW5hcmlvOiByYXdTY2VuYXJpbyxcbiAgICBtZXNFeGFtcGxlczogcmF3TWVzRXhhbXBsZXMsXG4gICAgc3lzdGVtLFxuICAgIGphaWxicmVhayxcbiAgfSA9IGdldENoYXJhY3RlckNhcmRGaWVsZHMoKTtcblxuICAvLyDliKTmlq3mmK/lkKbooqvov4fmu6Qs5aaC5p6c6KKr6L+H5ruk6L+U5Zue56m65a2X56ym5LiyLOWQpuWImei/lOWbnm92ZXJyaWRl55qE5YC85oiW5Y6f5aeL5YC8XG4gIGNvbnN0IGRlc2NyaXB0aW9uID0gaXNQcm9tcHRGaWx0ZXJlZCgnY2hhcl9kZXNjcmlwdGlvbicsIGNvbmZpZylcbiAgICA/ICcnXG4gICAgOiBnZXRPdmVycmlkZUNvbnRlbnQoJ2NoYXJfZGVzY3JpcHRpb24nKSA/PyByYXdEZXNjcmlwdGlvbjtcblxuICBjb25zdCBwZXJzb25hbGl0eSA9IGlzUHJvbXB0RmlsdGVyZWQoJ2NoYXJfcGVyc29uYWxpdHknLCBjb25maWcpXG4gICAgPyAnJ1xuICAgIDogZ2V0T3ZlcnJpZGVDb250ZW50KCdjaGFyX3BlcnNvbmFsaXR5JykgPz8gcmF3UGVyc29uYWxpdHk7XG5cbiAgY29uc3QgcGVyc29uYSA9IGlzUHJvbXB0RmlsdGVyZWQoJ3BlcnNvbmFfZGVzY3JpcHRpb24nLCBjb25maWcpXG4gICAgPyAnJ1xuICAgIDogZ2V0T3ZlcnJpZGVDb250ZW50KCdwZXJzb25hX2Rlc2NyaXB0aW9uJykgPz8gcmF3UGVyc29uYTtcblxuICBjb25zdCBzY2VuYXJpbyA9IGlzUHJvbXB0RmlsdGVyZWQoJ3NjZW5hcmlvJywgY29uZmlnKSA/ICcnIDogZ2V0T3ZlcnJpZGVDb250ZW50KCdzY2VuYXJpbycpID8/IHJhd1NjZW5hcmlvO1xuXG4gIGNvbnN0IG1lc0V4YW1wbGVzID0gaXNQcm9tcHRGaWx0ZXJlZCgnZGlhbG9ndWVfZXhhbXBsZXMnLCBjb25maWcpXG4gICAgPyAnJ1xuICAgIDogKGdldE92ZXJyaWRlQ29udGVudCgnZGlhbG9ndWVfZXhhbXBsZXMnKSBhcyBzdHJpbmcpID8/IHJhd01lc0V4YW1wbGVzO1xuXG4gIGxldCBtZXNFeGFtcGxlc0FycmF5ID0gcGFyc2VNZXNFeGFtcGxlcyhtZXNFeGFtcGxlcyk7XG4gIGxldCBvYWlNZXNzYWdlRXhhbXBsZXMgPSBbXTtcbiAgb2FpTWVzc2FnZUV4YW1wbGVzID0gc2V0T3BlbkFJTWVzc2FnZUV4YW1wbGVzKG1lc0V4YW1wbGVzQXJyYXkpO1xuXG4gIC8vIDUuIOiOt+WPluWBj+e9ruWtl+espuS4slxuICBjb25zdCB7IHByb21wdEJpYXMgfSA9IGdldEJpYXNTdHJpbmdzKHByb2Nlc3NlZFVzZXJJbnB1dCwgJ3F1aWV0Jyk7XG5cbiAgLy8gNi4g5aSE55CG6Ieq5a6a5LmJ5rOo5YWl55qE5o+Q56S66K+NXG4gIGlmIChjb25maWcuaW5qZWN0KSB7XG4gICAgYXdhaXQgaGFuZGxlSW5qZWN0ZWRQcm9tcHRzKGNvbmZpZyk7XG4gIH1cblxuICAvLyA3LiDlpITnkIbogYrlpKnorrDlvZVcbiAgbGV0IG9haU1lc3NhZ2VzID0gW107XG4gIGlmIChjb25maWcub3ZlcnJpZGVzPy5jaGF0X2hpc3RvcnkpIHtcbiAgICBvYWlNZXNzYWdlcyA9IFsuLi5jb25maWcub3ZlcnJpZGVzLmNoYXRfaGlzdG9yeV0ucmV2ZXJzZSgpO1xuICB9IGVsc2Uge1xuICAgIG9haU1lc3NhZ2VzID0gc2V0T3BlbkFJTWVzc2FnZXMoYXdhaXQgcHJvY2Vzc0NoYXRIaXN0b3J5KGNoYXQpKTtcbiAgICBpZiAoY29uZmlnLm1heF9jaGF0X2hpc3RvcnkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgb2FpTWVzc2FnZXMgPSBvYWlNZXNzYWdlcy5zbGljZSgwLCBjb25maWcubWF4X2NoYXRfaGlzdG9yeSk7XG4gICAgfVxuICB9XG5cbiAgLy8g5re75Yqg5Li05pe25raI5oGv55So5LqO5r+A5rS75LiW55WM5LmmXG4gIGFkZFRlbXBvcmFyeVVzZXJNZXNzYWdlKHByb2Nlc3NlZFVzZXJJbnB1dCk7XG4gIC8vIDguIOWkhOeQhuS4lueVjOS/oeaBr1xuICBjb25zdCB3b3JsZEluZm8gPSBhd2FpdCBwcm9jZXNzV29ybGRJbmZvKG9haU1lc3NhZ2VzIGFzIFJvbGVQcm9tcHRbXSwgY29uZmlnLCB7XG4gICAgZGVzY3JpcHRpb246IHJhd0Rlc2NyaXB0aW9uLFxuICAgIHBlcnNvbmFsaXR5OiByYXdQZXJzb25hbGl0eSxcbiAgICBwZXJzb25hOiByYXdQZXJzb25hLFxuICAgIHNjZW5hcmlvOiByYXdTY2VuYXJpbyxcbiAgICBjaGFyRGVwdGhQcm9tcHQsXG4gICAgY3JlYXRvck5vdGVzLFxuICB9KTtcblxuICAvLyDnp7vpmaTkuLTml7bmtojmga9cbiAgcmVtb3ZlVGVtcG9yYXJ5VXNlck1lc3NhZ2UoKTtcblxuICAvLyA5LiDlpITnkIbkuJbnlYzkuabmtojmga/npLrkvotcbiAgbWVzRXhhbXBsZXNBcnJheSA9ICFpc1Byb21wdEZpbHRlcmVkKCdkaWFsb2d1ZV9leGFtcGxlcycsIGNvbmZpZylcbiAgICA/IGF3YWl0IHByb2Nlc3NNZXNzYWdlRXhhbXBsZXMobWVzRXhhbXBsZXNBcnJheSwgd29ybGRJbmZvLndvcmxkSW5mb0V4YW1wbGVzKVxuICAgIDogW107XG5cbiAgcmV0dXJuIHtcbiAgICBjaGFyYWN0ZXJJbmZvOiB7XG4gICAgICBkZXNjcmlwdGlvbixcbiAgICAgIHBlcnNvbmFsaXR5LFxuICAgICAgcGVyc29uYSxcbiAgICAgIHNjZW5hcmlvLFxuICAgICAgc3lzdGVtOiBzeXN0ZW0sXG4gICAgICBqYWlsYnJlYWs6IGphaWxicmVhayxcbiAgICB9LFxuICAgIGNoYXRDb250ZXh0OiB7XG4gICAgICBvYWlNZXNzYWdlcyxcbiAgICAgIG9haU1lc3NhZ2VFeGFtcGxlcyxcbiAgICAgIHByb21wdEJpYXMsXG4gICAgfSxcbiAgICB3b3JsZEluZm8sXG4gIH07XG59XG5cbi8qKlxuICog5aSE55CG6KeS6Imy5Y2h5Lit55qE5rex5bqm5o+Q56S66K+NXG4gKi9cbmZ1bmN0aW9uIGhhbmRsZUNoYXJEZXB0aFByb21wdCgpIHtcbiAgY29uc3QgZGVwdGhQcm9tcHRUZXh0ID1cbiAgICAvLyBAdHMtaWdub3JlXG4gICAgYmFzZUNoYXRSZXBsYWNlKGNoYXJhY3RlcnNbdGhpc19jaGlkXT8uZGF0YT8uZXh0ZW5zaW9ucz8uZGVwdGhfcHJvbXB0Py5wcm9tcHQ/LnRyaW0oKSwgbmFtZTEsIG5hbWUyKSB8fCAnJztcbiAgLy8gQHRzLWlnbm9yZVxuICBjb25zdCBkZXB0aFByb21wdERlcHRoID0gY2hhcmFjdGVyc1t0aGlzX2NoaWRdPy5kYXRhPy5leHRlbnNpb25zPy5kZXB0aF9wcm9tcHQ/LmRlcHRoID8/ICc0JztcbiAgY29uc3QgZGVwdGhQcm9tcHRSb2xlID0gZ2V0RXh0ZW5zaW9uUHJvbXB0Um9sZUJ5TmFtZShcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgY2hhcmFjdGVyc1t0aGlzX2NoaWRdPy5kYXRhPy5leHRlbnNpb25zPy5kZXB0aF9wcm9tcHQ/LnJvbGUgPz8gJ3N5c3RlbScsXG4gICk7XG4gIHNldEV4dGVuc2lvblByb21wdChcbiAgICAnREVQVEhfUFJPTVBUJyxcbiAgICBkZXB0aFByb21wdFRleHQsXG4gICAgZXh0ZW5zaW9uX3Byb21wdF90eXBlcy5JTl9DSEFULFxuICAgIGRlcHRoUHJvbXB0RGVwdGgsXG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGV4dGVuc2lvbl9zZXR0aW5ncy5ub3RlLmFsbG93V0lTY2FuLFxuICAgIGRlcHRoUHJvbXB0Um9sZSxcbiAgKTtcbn1cblxuLyoqXG4gKiDlpITnkIbkvZzogIXms6jph4pcbiAqL1xuZnVuY3Rpb24gc2V0QXV0aG9yTm90ZVByb21wdChjb25maWc6IGRldGFpbC5HZW5lcmF0ZVBhcmFtcykge1xuICBjb25zdCBhdXRob3JOb3RlT3ZlcnJpZGUgPSBjb25maWc/Lm92ZXJyaWRlcz8uYXV0aG9yX25vdGU7XG4gIC8vIEB0cy1pZ25vcmVcbiAgY29uc3QgcHJvbXB0ID0gYXV0aG9yTm90ZU92ZXJyaWRlID8/ICgkKCcjZXh0ZW5zaW9uX2Zsb2F0aW5nX3Byb21wdCcpLnZhbCgpIGFzIHN0cmluZyk7XG5cbiAgc2V0RXh0ZW5zaW9uUHJvbXB0KFxuICAgIE5PVEVfTU9EVUxFX05BTUUsXG4gICAgcHJvbXB0LFxuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBjaGF0X21ldGFkYXRhW21ldGFkYXRhX2tleXMucG9zaXRpb25dLFxuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBjaGF0X21ldGFkYXRhW21ldGFkYXRhX2tleXMuZGVwdGhdLFxuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBleHRlbnNpb25fc2V0dGluZ3Mubm90ZS5hbGxvd1dJU2NhbixcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgY2hhdF9tZXRhZGF0YVttZXRhZGF0YV9rZXlzLnJvbGVdLFxuICApO1xufVxuXG4vKipcbiAqIOeUqOaIt+inkuiJsuaPj+i/sOaPkOekuuivjeiuvue9ruS4uuaPkOekuuivjeeuoeeQhuWZqOS5i+WklueahOmAiemhueeahOaDheWGtVxuICovXG5mdW5jdGlvbiBzZXRQZXJzb25hRGVzY3JpcHRpb25FeHRlbnNpb25Qcm9tcHQoKSB7XG4gIGNvbnN0IGRlc2NyaXB0aW9uID0gcG93ZXJfdXNlci5wZXJzb25hX2Rlc2NyaXB0aW9uO1xuICBjb25zdCBJTkpFQ1RfVEFHID0gJ1BFUlNPTkFfREVTQ1JJUFRJT04nO1xuICBzZXRFeHRlbnNpb25Qcm9tcHQoSU5KRUNUX1RBRywgJycsIGV4dGVuc2lvbl9wcm9tcHRfdHlwZXMuSU5fUFJPTVBULCAwKTtcblxuICBpZiAoIWRlc2NyaXB0aW9uIHx8IHBvd2VyX3VzZXIucGVyc29uYV9kZXNjcmlwdGlvbl9wb3NpdGlvbiA9PT0gcGVyc29uYV9kZXNjcmlwdGlvbl9wb3NpdGlvbnMuTk9ORSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8v5b2TdXNlcuS/oeaBr+WcqOS9nOiAheazqOmHiuWJjeWQjiAtIOS7heWcqOS9nOiAheazqOmHiuacquiiq+i/h+a7pOaXtuaJp+ihjFxuICBjb25zdCBwcm9tcHRQb3NpdGlvbnMgPSBbcGVyc29uYV9kZXNjcmlwdGlvbl9wb3NpdGlvbnMuQk9UVE9NX0FOLCBwZXJzb25hX2Rlc2NyaXB0aW9uX3Bvc2l0aW9ucy5UT1BfQU5dO1xuXG4gIGlmIChwcm9tcHRQb3NpdGlvbnMuaW5jbHVkZXMocG93ZXJfdXNlci5wZXJzb25hX2Rlc2NyaXB0aW9uX3Bvc2l0aW9uKSAmJiBzaG91bGRXSUFkZFByb21wdCkge1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBjb25zdCBvcmlnaW5hbEFOID0gZ2V0Q29udGV4dCgpLmV4dGVuc2lvblByb21wdHNbTk9URV9NT0RVTEVfTkFNRV0udmFsdWU7XG4gICAgY29uc3QgQU5XaXRoRGVzYyA9XG4gICAgICBwb3dlcl91c2VyLnBlcnNvbmFfZGVzY3JpcHRpb25fcG9zaXRpb24gPT09IHBlcnNvbmFfZGVzY3JpcHRpb25fcG9zaXRpb25zLlRPUF9BTlxuICAgICAgICA/IGAke2Rlc2NyaXB0aW9ufVxcbiR7b3JpZ2luYWxBTn1gXG4gICAgICAgIDogYCR7b3JpZ2luYWxBTn1cXG4ke2Rlc2NyaXB0aW9ufWA7XG5cbiAgICBzZXRFeHRlbnNpb25Qcm9tcHQoXG4gICAgICBOT1RFX01PRFVMRV9OQU1FLFxuICAgICAgQU5XaXRoRGVzYyxcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgIGNoYXRfbWV0YWRhdGFbbWV0YWRhdGFfa2V5cy5wb3NpdGlvbl0sXG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICBjaGF0X21ldGFkYXRhW21ldGFkYXRhX2tleXMuZGVwdGhdLFxuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgZXh0ZW5zaW9uX3NldHRpbmdzLm5vdGUuYWxsb3dXSVNjYW4sXG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICBjaGF0X21ldGFkYXRhW21ldGFkYXRhX2tleXMucm9sZV0sXG4gICAgKTtcbiAgfVxuXG4gIC8vIHVzZXLkv6Hmga/mt7Hluqbms6jlhaXkuI3kvp3otZbkuo7kvZzogIXms6jph4rnmoTnirbmgIHvvIznm7TmjqXlupTnlKhcbiAgaWYgKHBvd2VyX3VzZXIucGVyc29uYV9kZXNjcmlwdGlvbl9wb3NpdGlvbiA9PT0gcGVyc29uYV9kZXNjcmlwdGlvbl9wb3NpdGlvbnMuQVRfREVQVEgpIHtcbiAgICBzZXRFeHRlbnNpb25Qcm9tcHQoXG4gICAgICBJTkpFQ1RfVEFHLFxuICAgICAgZGVzY3JpcHRpb24sXG4gICAgICBleHRlbnNpb25fcHJvbXB0X3R5cGVzLklOX0NIQVQsXG4gICAgICBwb3dlcl91c2VyLnBlcnNvbmFfZGVzY3JpcHRpb25fZGVwdGgsXG4gICAgICB0cnVlLFxuICAgICAgcG93ZXJfdXNlci5wZXJzb25hX2Rlc2NyaXB0aW9uX3JvbGUsXG4gICAgKTtcbiAgfVxufVxuXG4vKipcbiAqIOWkhOeQhuazqOWFpeeahOaPkOekuuivjVxuICovXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVJbmplY3RlZFByb21wdHMocHJvbXB0Q29uZmlnOiBPbWl0PGRldGFpbC5HZW5lcmF0ZVBhcmFtcywgJ3VzZXJfaW5wdXQnIHwgJ3VzZV9wcmVzZXQnPikge1xuICBpZiAoIXByb21wdENvbmZpZyB8fCAhQXJyYXkuaXNBcnJheShwcm9tcHRDb25maWcuaW5qZWN0KSkgcmV0dXJuO1xuXG4gIGNvbnN0IGluamVjdHMgPSBwcm9tcHRDb25maWcuaW5qZWN0O1xuXG4gIGNvbnN0IHBvc2l0aW9uX21hcCA9IHtcbiAgICBiZWZvcmVfcHJvbXB0OiBleHRlbnNpb25fcHJvbXB0X3R5cGVzLkJFRk9SRV9QUk9NUFQsXG4gICAgaW5fY2hhdDogZXh0ZW5zaW9uX3Byb21wdF90eXBlcy5JTl9DSEFULFxuICAgIGFmdGVyX3Byb21wdDogZXh0ZW5zaW9uX3Byb21wdF90eXBlcy5JTl9QUk9NUFQsXG4gICAgbm9uZTogZXh0ZW5zaW9uX3Byb21wdF90eXBlcy5OT05FLFxuICB9IGFzIGNvbnN0O1xuXG4gIGZvciAoY29uc3QgaW5qZWN0IG9mIGluamVjdHMpIHtcbiAgICBjb25zdCB2YWxpZGF0ZWRJbmplY3QgPSB7XG4gICAgICByb2xlOiByb2xlVHlwZXNbaW5qZWN0LnJvbGVdID8/IGV4dGVuc2lvbl9wcm9tcHRfcm9sZXMuU1lTVEVNLFxuICAgICAgY29udGVudDogaW5qZWN0LmNvbnRlbnQgfHwgJycsXG4gICAgICBkZXB0aDogTnVtYmVyKGluamVjdC5kZXB0aCkgfHwgMCxcbiAgICAgIHNob3VsZF9zY2FuOiBCb29sZWFuKGluamVjdC5zaG91bGRfc2NhbikgfHwgdHJ1ZSxcbiAgICAgIHBvc2l0aW9uOiBwb3NpdGlvbl9tYXBbaW5qZWN0LnBvc2l0aW9uIGFzIGtleW9mIHR5cGVvZiBwb3NpdGlvbl9tYXBdID8/IGV4dGVuc2lvbl9wcm9tcHRfdHlwZXMuSU5fQ0hBVCxcbiAgICB9O1xuXG4gICAgLy8g6K6+572u55So5oi36Ieq5a6a5LmJ5rOo5YWl5o+Q56S66K+NXG4gICAgc2V0RXh0ZW5zaW9uUHJvbXB0KFxuICAgICAgYElOSkVDVElPTi0ke2luamVjdC5kZXB0aH0tJHtpbmplY3Qucm9sZX1gLFxuICAgICAgdmFsaWRhdGVkSW5qZWN0LmNvbnRlbnQsXG4gICAgICB2YWxpZGF0ZWRJbmplY3QucG9zaXRpb24sXG4gICAgICB2YWxpZGF0ZWRJbmplY3QuZGVwdGgsXG4gICAgICB2YWxpZGF0ZWRJbmplY3Quc2hvdWxkX3NjYW4sXG4gICAgICB2YWxpZGF0ZWRJbmplY3Qucm9sZSxcbiAgICApO1xuICB9XG59XG5cbi8qKlxuICog5aSE55CG6IGK5aSp6K6w5b2VXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHByb2Nlc3NDaGF0SGlzdG9yeShjaGF0SGlzdG9yeTogYW55W10pIHtcbiAgY29uc3QgY29yZUNoYXQgPSBjaGF0SGlzdG9yeS5maWx0ZXIoeCA9PiAheC5pc19zeXN0ZW0pO1xuXG4gIHJldHVybiBhd2FpdCBQcm9taXNlLmFsbChcbiAgICBjb3JlQ2hhdC5tYXAoYXN5bmMgKGNoYXRJdGVtLCBpbmRleCkgPT4ge1xuICAgICAgY29uc3QgbWVzc2FnZSA9IGNoYXRJdGVtLm1lcztcbiAgICAgIGNvbnN0IHJlZ2V4VHlwZSA9IGNoYXRJdGVtLmlzX3VzZXIgPyByZWdleF9wbGFjZW1lbnQuVVNFUl9JTlBVVCA6IHJlZ2V4X3BsYWNlbWVudC5BSV9PVVRQVVQ7XG5cbiAgICAgIGNvbnN0IHJlZ2V4ZWRNZXNzYWdlID0gZ2V0UmVnZXhlZFN0cmluZyhtZXNzYWdlLCByZWdleFR5cGUsIHtcbiAgICAgICAgaXNQcm9tcHQ6IHRydWUsXG4gICAgICAgIGRlcHRoOiBjb3JlQ2hhdC5sZW5ndGggLSBpbmRleCAtIDEsXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uY2hhdEl0ZW0sXG4gICAgICAgIG1lczogcmVnZXhlZE1lc3NhZ2UsXG4gICAgICAgIGluZGV4LFxuICAgICAgfTtcbiAgICB9KSxcbiAgKTtcbn1cblxuLyoqXG4gKiDlpITnkIbkuJbnlYzkuaZcbiAqL1xuYXN5bmMgZnVuY3Rpb24gcHJvY2Vzc1dvcmxkSW5mbyhcbiAgb2FpTWVzc2FnZXM6IFJvbGVQcm9tcHRbXSxcbiAgY29uZmlnOiBPbWl0PGRldGFpbC5HZW5lcmF0ZVBhcmFtcywgJ3VzZXJfaW5wdXQnIHwgJ3VzZV9wcmVzZXQnPixcbiAgY2hhcmFjdGVySW5mbzoge1xuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gICAgcGVyc29uYWxpdHk6IHN0cmluZztcbiAgICBwZXJzb25hOiBzdHJpbmc7XG4gICAgc2NlbmFyaW86IHN0cmluZztcbiAgICBjaGFyRGVwdGhQcm9tcHQ6IHN0cmluZztcbiAgICBjcmVhdG9yTm90ZXM6IHN0cmluZztcbiAgfSxcbikge1xuICBjb25zdCBjaGF0Rm9yV0kgPSBvYWlNZXNzYWdlc1xuICAgIC5maWx0ZXIoeCA9PiB4LnJvbGUgIT09ICdzeXN0ZW0nKVxuICAgIC5tYXAoeCA9PiB7XG4gICAgICBjb25zdCBuYW1lID0geC5yb2xlID09PSAndXNlcicgPyBuYW1lMSA6IG5hbWUyO1xuICAgICAgcmV0dXJuIHdvcmxkX2luZm9faW5jbHVkZV9uYW1lcyA/IGAke25hbWV9OiAke3guY29udGVudH1gIDogeC5jb250ZW50O1xuICAgIH0pXG4gICAgLnJldmVyc2UoKTtcblxuICBjb25zdCB0aGlzX21heF9jb250ZXh0ID0gZ2V0TWF4Q29udGV4dFNpemUoKTtcbiAgY29uc3QgZ2xvYmFsU2NhbkRhdGEgPSB7XG4gICAgcGVyc29uYURlc2NyaXB0aW9uOiBjb25maWcub3ZlcnJpZGVzPy5wZXJzb25hX2Rlc2NyaXB0aW9uID8/IGNoYXJhY3RlckluZm8ucGVyc29uYSxcbiAgICBjaGFyYWN0ZXJEZXNjcmlwdGlvbjogY29uZmlnLm92ZXJyaWRlcz8uY2hhcl9kZXNjcmlwdGlvbiA/PyBjaGFyYWN0ZXJJbmZvLmRlc2NyaXB0aW9uLFxuICAgIGNoYXJhY3RlclBlcnNvbmFsaXR5OiBjb25maWcub3ZlcnJpZGVzPy5jaGFyX3BlcnNvbmFsaXR5ID8/IGNoYXJhY3RlckluZm8ucGVyc29uYWxpdHksXG4gICAgY2hhcmFjdGVyRGVwdGhQcm9tcHQ6IGNoYXJhY3RlckluZm8uY2hhckRlcHRoUHJvbXB0LFxuICAgIHNjZW5hcmlvOiBjb25maWcub3ZlcnJpZGVzPy5zY2VuYXJpbyA/PyBjaGFyYWN0ZXJJbmZvLnNjZW5hcmlvLFxuICAgIGNyZWF0b3JOb3RlczogY2hhcmFjdGVySW5mby5jcmVhdG9yTm90ZXMsXG4gIH07XG4gIGNvbnN0IHsgd29ybGRJbmZvU3RyaW5nLCB3b3JsZEluZm9CZWZvcmUsIHdvcmxkSW5mb0FmdGVyLCB3b3JsZEluZm9FeGFtcGxlcywgd29ybGRJbmZvRGVwdGggfSA9XG4gICAgLy8gZ2xvYmFsU2NhbkRhdGHlj6rlnKjmlrDnmoTphZLppobniYjmnKzkuK3lrZjlnKhcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgYXdhaXQgZ2V0V29ybGRJbmZvUHJvbXB0KGNoYXRGb3JXSSwgdGhpc19tYXhfY29udGV4dCwgZmFsc2UsIGdsb2JhbFNjYW5EYXRhKTtcblxuICBhd2FpdCBjbGVhckluamVjdGlvblByb21wdHMoWydjdXN0b21EZXB0aFdJJ10pO1xuXG4gIGlmICghaXNQcm9tcHRGaWx0ZXJlZCgnd2l0aF9kZXB0aF9lbnRyaWVzJywgY29uZmlnKSkge1xuICAgIHByb2Nlc3NXb3JsZEluZm9EZXB0aCh3b3JsZEluZm9EZXB0aCk7XG4gIH1cblxuICAvLyDlhYjmo4Dmn6XmmK/lkKbooqvov4fmu6TvvIzlpoLmnpzooqvov4fmu6Tnm7TmjqXov5Tlm55udWxsXG4gIGNvbnN0IGZpbmFsV29ybGRJbmZvQmVmb3JlID0gaXNQcm9tcHRGaWx0ZXJlZCgnd29ybGRfaW5mb19iZWZvcmUnLCBjb25maWcpXG4gICAgPyBudWxsXG4gICAgOiBjb25maWcub3ZlcnJpZGVzPy53b3JsZF9pbmZvX2JlZm9yZSAhPT0gdW5kZWZpbmVkXG4gICAgPyBjb25maWcub3ZlcnJpZGVzLndvcmxkX2luZm9fYmVmb3JlXG4gICAgOiB3b3JsZEluZm9CZWZvcmU7XG5cbiAgY29uc3QgZmluYWxXb3JsZEluZm9BZnRlciA9IGlzUHJvbXB0RmlsdGVyZWQoJ3dvcmxkX2luZm9fYWZ0ZXInLCBjb25maWcpXG4gICAgPyBudWxsXG4gICAgOiBjb25maWcub3ZlcnJpZGVzPy53b3JsZF9pbmZvX2FmdGVyICE9PSB1bmRlZmluZWRcbiAgICA/IGNvbmZpZy5vdmVycmlkZXMud29ybGRfaW5mb19hZnRlclxuICAgIDogd29ybGRJbmZvQWZ0ZXI7XG5cbiAgcmV0dXJuIHtcbiAgICB3b3JsZEluZm9TdHJpbmcsXG4gICAgd29ybGRJbmZvQmVmb3JlOiBmaW5hbFdvcmxkSW5mb0JlZm9yZSxcbiAgICB3b3JsZEluZm9BZnRlcjogZmluYWxXb3JsZEluZm9BZnRlcixcbiAgICB3b3JsZEluZm9FeGFtcGxlcyxcbiAgICB3b3JsZEluZm9EZXB0aDogIWlzUHJvbXB0RmlsdGVyZWQoJ3dpdGhfZGVwdGhfZW50cmllcycsIGNvbmZpZykgPyB3b3JsZEluZm9EZXB0aCA6IG51bGwsXG4gIH07XG59XG5cbi8qKlxuICog5aSE55CG5LiW55WM5L+h5oGv5rex5bqm6YOo5YiGXG4gKi9cbmZ1bmN0aW9uIHByb2Nlc3NXb3JsZEluZm9EZXB0aCh3b3JsZEluZm9EZXB0aDogYW55W10pIHtcbiAgaWYgKEFycmF5LmlzQXJyYXkod29ybGRJbmZvRGVwdGgpKSB7XG4gICAgd29ybGRJbmZvRGVwdGguZm9yRWFjaChlbnRyeSA9PiB7XG4gICAgICBjb25zdCBqb2luZWRFbnRyaWVzID0gZW50cnkuZW50cmllcy5qb2luKCdcXG4nKTtcbiAgICAgIHNldEV4dGVuc2lvblByb21wdChcbiAgICAgICAgYGN1c3RvbURlcHRoV0ktJHtlbnRyeS5kZXB0aH0tJHtlbnRyeS5yb2xlfWAsXG4gICAgICAgIGpvaW5lZEVudHJpZXMsXG4gICAgICAgIGV4dGVuc2lvbl9wcm9tcHRfdHlwZXMuSU5fQ0hBVCxcbiAgICAgICAgZW50cnkuZGVwdGgsXG4gICAgICAgIGZhbHNlLFxuICAgICAgICBlbnRyeS5yb2xlLFxuICAgICAgKTtcbiAgICB9KTtcbiAgfVxufVxuXG4vKipcbiAqIOWkhOeQhuS4lueVjOS5puS4reekuuS+i+WJjeWQjlxuICovXG5hc3luYyBmdW5jdGlvbiBwcm9jZXNzTWVzc2FnZUV4YW1wbGVzKG1lc0V4YW1wbGVzQXJyYXk6IHN0cmluZ1tdLCB3b3JsZEluZm9FeGFtcGxlczogYW55W10pOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gIC8vIOWkhOeQhuS4lueVjOS/oeaBr+S4reeahOekuuS+i1xuICBmb3IgKGNvbnN0IGV4YW1wbGUgb2Ygd29ybGRJbmZvRXhhbXBsZXMpIHtcbiAgICBpZiAoIWV4YW1wbGUuY29udGVudC5sZW5ndGgpIGNvbnRpbnVlO1xuXG4gICAgY29uc3QgZm9ybWF0dGVkRXhhbXBsZSA9IGJhc2VDaGF0UmVwbGFjZShleGFtcGxlLmNvbnRlbnQsIG5hbWUxLCBuYW1lMik7XG4gICAgY29uc3QgY2xlYW5lZEV4YW1wbGUgPSBwYXJzZU1lc0V4YW1wbGVzKGZvcm1hdHRlZEV4YW1wbGUpO1xuXG4gICAgaWYgKGV4YW1wbGUucG9zaXRpb24gPT09IHdpX2FuY2hvcl9wb3NpdGlvbi5iZWZvcmUpIHtcbiAgICAgIG1lc0V4YW1wbGVzQXJyYXkudW5zaGlmdCguLi5jbGVhbmVkRXhhbXBsZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG1lc0V4YW1wbGVzQXJyYXkucHVzaCguLi5jbGVhbmVkRXhhbXBsZSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG1lc0V4YW1wbGVzQXJyYXk7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/function/generate/dataProcessor.ts\n\n}")},"./src/function/generate/generate.ts":
/*!*******************************************!*\
  !*** ./src/function/generate/generate.ts ***!
  \*******************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   handlePresetPath: () => (/* binding */ handlePresetPath)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/scripts/openai */ \"@sillytavern/scripts/openai\");\n/* harmony import */ var _function_generate_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/function/generate/utils */ \"./src/function/generate/utils.ts\");\n\n\n\n\nconst dryRun = false;\n/**\n * 使用预设路径处理生成请求\n * @param baseData 基础数据\n * @param processedUserInput 处理后的用户输入\n * @param config 配置参数\n * @returns 生成数据\n */\nasync function handlePresetPath(baseData, processedUserInput, config) {\n    // prepareOpenAIMessages会从设置里读取场景因此临时覆盖\n    let originalScenario = null;\n    try {\n        const scenarioOverride = config?.overrides?.scenario;\n        // @ts-ignore\n        if (scenarioOverride && _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters && _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid]) {\n            // 保存原始场景\n            // @ts-ignore\n            originalScenario = _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid].scenario || null;\n            // @ts-ignore\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid].scenario = scenarioOverride;\n        }\n        // 添加user消息(一次性)\n        const userMessageTemp = {\n            role: 'user',\n            content: processedUserInput,\n            image: config.image,\n        };\n        if (config.image) {\n            if (Array.isArray(config.image)) {\n                delete userMessageTemp.image;\n            }\n            else {\n                userMessageTemp.image = await (0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_3__.convertFileToBase64)(config.image);\n            }\n        }\n        baseData.chatContext.oaiMessages.unshift(userMessageTemp);\n        const messageData = {\n            name2: _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name2,\n            charDescription: baseData.characterInfo.description,\n            charPersonality: baseData.characterInfo.personality,\n            Scenario: baseData.characterInfo.scenario,\n            worldInfoBefore: baseData.worldInfo.worldInfoBefore,\n            worldInfoAfter: baseData.worldInfo.worldInfoAfter,\n            extensionPrompts: (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__.getContext)().extensionPrompts,\n            bias: baseData.chatContext.promptBias,\n            type: 'normal',\n            quietPrompt: '',\n            quietImage: null,\n            cyclePrompt: '',\n            systemPromptOverride: baseData.characterInfo.system,\n            jailbreakPromptOverride: baseData.characterInfo.jailbreak,\n            personaDescription: baseData.characterInfo.persona,\n            messages: baseData.chatContext.oaiMessages,\n            messageExamples: baseData.chatContext.oaiMessageExamples,\n        };\n        const [prompt] = await (0,_sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_2__.prepareOpenAIMessages)(messageData, dryRun);\n        return { prompt };\n    }\n    finally {\n        // 恢复原始场景\n        // @ts-ignore\n        if (originalScenario !== null && _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters && _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid]) {\n            // @ts-ignore\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid].scenario = originalScenario;\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFDLEVBQUUsQ0FBQztZQUNyRSxhQUFhO1lBQ2IsMkRBQVUsQ0FBQywwREFBUyxDQUFDLENBQUMsUUFBUSxHQUFHLGdCQUFnQixDQUFDO1FBQ3BELENBQUM7SUFDSCxDQUFDO0FBQ0gsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9mdW5jdGlvbi9nZW5lcmF0ZS9nZW5lcmF0ZS50cz81N2Y1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNoYXJhY3RlcnMsIG5hbWUyLCB0aGlzX2NoaWQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0JztcbmltcG9ydCB7IGdldENvbnRleHQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9leHRlbnNpb25zJztcbmltcG9ydCB7IHByZXBhcmVPcGVuQUlNZXNzYWdlcyB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL29wZW5haSc7XG5cbmltcG9ydCB7IGRldGFpbCB9IGZyb20gJ0AvZnVuY3Rpb24vZ2VuZXJhdGUvdHlwZXMnO1xuaW1wb3J0IHsgY29udmVydEZpbGVUb0Jhc2U2NCB9IGZyb20gJ0AvZnVuY3Rpb24vZ2VuZXJhdGUvdXRpbHMnO1xuXG5jb25zdCBkcnlSdW4gPSBmYWxzZTtcblxuLyoqXG4gKiDkvb/nlKjpooTorr7ot6/lvoTlpITnkIbnlJ/miJDor7fmsYJcbiAqIEBwYXJhbSBiYXNlRGF0YSDln7rnoYDmlbDmja5cbiAqIEBwYXJhbSBwcm9jZXNzZWRVc2VySW5wdXQg5aSE55CG5ZCO55qE55So5oi36L6T5YWlXG4gKiBAcGFyYW0gY29uZmlnIOmFjee9ruWPguaVsFxuICogQHJldHVybnMg55Sf5oiQ5pWw5o2uXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYW5kbGVQcmVzZXRQYXRoKFxuICBiYXNlRGF0YTogYW55LFxuICBwcm9jZXNzZWRVc2VySW5wdXQ6IHN0cmluZyxcbiAgY29uZmlnOiBPbWl0PGRldGFpbC5HZW5lcmF0ZVBhcmFtcywgJ3VzZXJfaW5wdXQnIHwgJ3VzZV9wcmVzZXQnPixcbikge1xuICAvLyBwcmVwYXJlT3BlbkFJTWVzc2FnZXPkvJrku47orr7nva7ph4zor7vlj5blnLrmma/lm6DmraTkuLTml7bopobnm5ZcbiAgbGV0IG9yaWdpbmFsU2NlbmFyaW8gPSBudWxsO1xuXG4gIHRyeSB7XG4gICAgY29uc3Qgc2NlbmFyaW9PdmVycmlkZSA9IGNvbmZpZz8ub3ZlcnJpZGVzPy5zY2VuYXJpbztcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgaWYgKHNjZW5hcmlvT3ZlcnJpZGUgJiYgY2hhcmFjdGVycyAmJiBjaGFyYWN0ZXJzW3RoaXNfY2hpZF0pIHtcbiAgICAgIC8vIOS/neWtmOWOn+Wni+WcuuaZr1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgb3JpZ2luYWxTY2VuYXJpbyA9IGNoYXJhY3RlcnNbdGhpc19jaGlkXS5zY2VuYXJpbyB8fCBudWxsO1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgY2hhcmFjdGVyc1t0aGlzX2NoaWRdLnNjZW5hcmlvID0gc2NlbmFyaW9PdmVycmlkZTtcbiAgICB9XG4gICAgLy8g5re75YqgdXNlcua2iOaBryjkuIDmrKHmgKcpXG4gICAgY29uc3QgdXNlck1lc3NhZ2VUZW1wID0ge1xuICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgY29udGVudDogcHJvY2Vzc2VkVXNlcklucHV0LFxuICAgICAgaW1hZ2U6IGNvbmZpZy5pbWFnZSxcbiAgICB9O1xuXG4gICAgaWYgKGNvbmZpZy5pbWFnZSkge1xuICAgICAgaWYgKEFycmF5LmlzQXJyYXkoY29uZmlnLmltYWdlKSkge1xuICAgICAgICBkZWxldGUgdXNlck1lc3NhZ2VUZW1wLmltYWdlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdXNlck1lc3NhZ2VUZW1wLmltYWdlID0gYXdhaXQgY29udmVydEZpbGVUb0Jhc2U2NChjb25maWcuaW1hZ2UpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGJhc2VEYXRhLmNoYXRDb250ZXh0Lm9haU1lc3NhZ2VzLnVuc2hpZnQodXNlck1lc3NhZ2VUZW1wKTtcblxuICAgIGNvbnN0IG1lc3NhZ2VEYXRhID0ge1xuICAgICAgbmFtZTIsXG4gICAgICBjaGFyRGVzY3JpcHRpb246IGJhc2VEYXRhLmNoYXJhY3RlckluZm8uZGVzY3JpcHRpb24sXG4gICAgICBjaGFyUGVyc29uYWxpdHk6IGJhc2VEYXRhLmNoYXJhY3RlckluZm8ucGVyc29uYWxpdHksXG4gICAgICBTY2VuYXJpbzogYmFzZURhdGEuY2hhcmFjdGVySW5mby5zY2VuYXJpbyxcbiAgICAgIHdvcmxkSW5mb0JlZm9yZTogYmFzZURhdGEud29ybGRJbmZvLndvcmxkSW5mb0JlZm9yZSxcbiAgICAgIHdvcmxkSW5mb0FmdGVyOiBiYXNlRGF0YS53b3JsZEluZm8ud29ybGRJbmZvQWZ0ZXIsXG4gICAgICBleHRlbnNpb25Qcm9tcHRzOiBnZXRDb250ZXh0KCkuZXh0ZW5zaW9uUHJvbXB0cyxcbiAgICAgIGJpYXM6IGJhc2VEYXRhLmNoYXRDb250ZXh0LnByb21wdEJpYXMsXG4gICAgICB0eXBlOiAnbm9ybWFsJyxcbiAgICAgIHF1aWV0UHJvbXB0OiAnJyxcbiAgICAgIHF1aWV0SW1hZ2U6IG51bGwsXG4gICAgICBjeWNsZVByb21wdDogJycsXG4gICAgICBzeXN0ZW1Qcm9tcHRPdmVycmlkZTogYmFzZURhdGEuY2hhcmFjdGVySW5mby5zeXN0ZW0sXG4gICAgICBqYWlsYnJlYWtQcm9tcHRPdmVycmlkZTogYmFzZURhdGEuY2hhcmFjdGVySW5mby5qYWlsYnJlYWssXG4gICAgICBwZXJzb25hRGVzY3JpcHRpb246IGJhc2VEYXRhLmNoYXJhY3RlckluZm8ucGVyc29uYSxcbiAgICAgIG1lc3NhZ2VzOiBiYXNlRGF0YS5jaGF0Q29udGV4dC5vYWlNZXNzYWdlcyxcbiAgICAgIG1lc3NhZ2VFeGFtcGxlczogYmFzZURhdGEuY2hhdENvbnRleHQub2FpTWVzc2FnZUV4YW1wbGVzLFxuICAgIH07XG5cbiAgICBjb25zdCBbcHJvbXB0XSA9IGF3YWl0IHByZXBhcmVPcGVuQUlNZXNzYWdlcyhtZXNzYWdlRGF0YSBhcyBhbnksIGRyeVJ1bik7XG5cbiAgICByZXR1cm4geyBwcm9tcHQgfTtcbiAgfSBmaW5hbGx5IHtcbiAgICAvLyDmgaLlpI3ljp/lp4vlnLrmma9cbiAgICAvLyBAdHMtaWdub3JlXG4gICAgaWYgKG9yaWdpbmFsU2NlbmFyaW8gIT09IG51bGwgJiYgY2hhcmFjdGVycyAmJiBjaGFyYWN0ZXJzW3RoaXNfY2hpZF0pIHtcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgIGNoYXJhY3RlcnNbdGhpc19jaGlkXS5zY2VuYXJpbyA9IG9yaWdpbmFsU2NlbmFyaW87XG4gICAgfVxuICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/function/generate/generate.ts\n\n}")},"./src/function/generate/generateRaw.ts":
/*!**********************************************!*\
  !*** ./src/function/generate/generateRaw.ts ***!
  \**********************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   handleCustomPath: () => (/* binding */ handleCustomPath)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/authors-note */ \"@sillytavern/scripts/authors-note\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/scripts/openai */ \"@sillytavern/scripts/openai\");\n/* harmony import */ var _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sillytavern/scripts/power-user */ \"@sillytavern/scripts/power-user\");\n/* harmony import */ var _sillytavern_scripts_PromptManager__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @sillytavern/scripts/PromptManager */ \"@sillytavern/scripts/PromptManager\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var _function_generate_types__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @/function/generate/types */ \"./src/function/generate/types.ts\");\n/* harmony import */ var _function_generate_utils__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @/function/generate/utils */ \"./src/function/generate/utils.ts\");\n\n\n\n\n\n\n\n\n\n/**\n * @fileoverview 原始生成路径处理模块 - 不使用预设的生成逻辑\n * 包含所有不使用预设(use_preset=false)时的提示词处理和聊天完成逻辑\n */\n/**\n * 将系统提示词转换为集合格式\n * 处理内置提示词、自定义注入和对话示例，转换为PromptCollection和MessageCollection格式\n * @param baseData 包含角色信息和世界书信息的基础数据\n * @param promptConfig 提示词配置参数，包含order等设置\n * @returns Promise<{systemPrompts: PromptCollection, dialogue_examples: MessageCollection}> 返回系统提示词和对话示例的集合\n */\nasync function convertSystemPromptsToCollection(baseData, promptConfig) {\n    const promptCollection = new _sillytavern_scripts_PromptManager__WEBPACK_IMPORTED_MODULE_5__.PromptCollection();\n    const examplesCollection = new _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__.MessageCollection('dialogue_examples');\n    const orderArray = promptConfig.order || _function_generate_types__WEBPACK_IMPORTED_MODULE_7__.builtin_prompt_default_order;\n    const builtinPromptContents = {\n        world_info_before: baseData.worldInfo.worldInfoBefore,\n        persona_description: _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_4__.power_user.persona_description &&\n            _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_4__.power_user.persona_description_position === _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_4__.persona_description_positions.IN_PROMPT\n            ? baseData.characterInfo.persona\n            : null,\n        char_description: baseData.characterInfo.description,\n        char_personality: baseData.characterInfo.personality,\n        scenario: baseData.characterInfo.scenario,\n        world_info_after: baseData.worldInfo.worldInfoAfter,\n    };\n    for (const [index, item] of orderArray.entries()) {\n        if (typeof item === 'string') {\n            // 处理内置提示词\n            const content = builtinPromptContents[item];\n            if (content) {\n                promptCollection.add(\n                // @ts-ignore\n                new _sillytavern_scripts_PromptManager__WEBPACK_IMPORTED_MODULE_5__.Prompt({\n                    identifier: item,\n                    role: 'system',\n                    content: content,\n                    system_prompt: true,\n                }));\n            }\n        }\n        else if (typeof item === 'object' && item.role && item.content) {\n            // 处理自定义注入\n            const identifier = `custom_prompt_${index}`;\n            promptCollection.add(\n            // @ts-ignore\n            new _sillytavern_scripts_PromptManager__WEBPACK_IMPORTED_MODULE_5__.Prompt({\n                identifier: identifier,\n                role: item.role,\n                content: item.content,\n                system_prompt: item.role === 'system',\n            }));\n        }\n    }\n    if (baseData.chatContext.oaiMessageExamples.length > 0) {\n        // 遍历所有对话示例\n        for (const dialogue of [...baseData.chatContext.oaiMessageExamples]) {\n            const dialogueIndex = baseData.chatContext.oaiMessageExamples.indexOf(dialogue);\n            const chatMessages = [];\n            for (let promptIndex = 0; promptIndex < dialogue.length; promptIndex++) {\n                const prompt = dialogue[promptIndex];\n                const role = 'system';\n                const content = prompt.content || '';\n                const identifier = `dialogue_examples ${dialogueIndex}-${promptIndex}`;\n                const chatMessage = await _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__.Message.createAsync(role, content, identifier);\n                await chatMessage.setName(prompt.name);\n                chatMessages.push(chatMessage);\n            }\n            for (const message of chatMessages) {\n                examplesCollection.add(message);\n            }\n        }\n    }\n    return {\n        systemPrompts: promptCollection,\n        dialogue_examples: examplesCollection,\n    };\n}\n/**\n * 处理聊天记录并注入提示词\n * 根据order配置处理聊天历史和用户输入，并注入各种深度提示词\n * @param baseData 包含聊天上下文的基础数据\n * @param promptConfig 提示词配置参数\n * @param chatCompletion ChatCompletion对象，用于管理token预算和消息集合\n * @param processedUserInput 经过处理的用户输入文本\n * @param processedImageArray 可选的处理后图片数组，用于多图片支持\n * @returns Promise<void> 无返回值，直接修改chatCompletion对象\n */\nasync function processChatHistoryAndInject(baseData, promptConfig, chatCompletion, processedUserInput, processedImageArray) {\n    const orderArray = promptConfig.order || _function_generate_types__WEBPACK_IMPORTED_MODULE_7__.default_order;\n    const chatHistoryIndex = orderArray.findIndex(item => typeof item === 'string' && item.toLowerCase() === 'chat_history');\n    const userInputIndex = orderArray.findIndex(item => typeof item === 'string' && item.toLowerCase() === 'user_input');\n    const hasUserInput = userInputIndex !== -1;\n    const hasChatHistory = chatHistoryIndex !== -1;\n    const isChatHistoryFiltered = (0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_8__.isPromptFiltered)('chat_history', promptConfig);\n    // 创建用户输入消息\n    let userMessage;\n    if (processedImageArray && hasUserInput) {\n        // 如果有处理后的图片数组，直接使用数组格式创建消息\n        userMessage = await _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__.Message.createAsync('user', processedImageArray, 'user_input');\n    }\n    else {\n        // 否则使用原有逻辑\n        userMessage = await _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__.Message.createAsync('user', processedUserInput, 'user_input');\n        if (promptConfig.image && hasUserInput) {\n            if (!Array.isArray(promptConfig.image)) {\n                const img = await (0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_8__.convertFileToBase64)(promptConfig.image);\n                if (img) {\n                    await userMessage.addImage(img);\n                }\n            }\n        }\n    }\n    // 如果聊天记录被过滤或不在order中，只处理用户输入\n    if (isChatHistoryFiltered || !hasChatHistory) {\n        const insertIndex = hasUserInput ? userInputIndex : orderArray.length;\n        chatCompletion.add(new _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__.MessageCollection('user_input', userMessage), insertIndex);\n        return;\n    }\n    // 处理聊天记录\n    const chatCollection = new _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__.MessageCollection('chat_history');\n    // 为新聊天指示预留token\n    const newChat = _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__.oai_settings.new_chat_prompt;\n    const newChatMessage = await _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__.Message.createAsync('system', (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.substituteParams)(newChat), 'newMainChat');\n    chatCompletion.reserveBudget(newChatMessage);\n    // 添加新聊天提示词到集合的最前面\n    chatCollection.add(newChatMessage);\n    // 处理空消息替换\n    const lastChatPrompt = baseData.chatContext.oaiMessages[baseData.chatContext.oaiMessages.length - 1];\n    const emptyMessage = await _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__.Message.createAsync('user', _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__.oai_settings.send_if_empty, 'emptyUserMessageReplacement');\n    if (lastChatPrompt &&\n        lastChatPrompt.role === 'assistant' &&\n        _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__.oai_settings.send_if_empty &&\n        chatCompletion.canAfford(emptyMessage)) {\n        chatCollection.add(emptyMessage);\n    }\n    // 将用户消息添加到消息数组中准备处理注入\n    if (!hasUserInput) {\n        let userPrompt;\n        if (processedImageArray) {\n            // 如果有处理后的图片数组，使用数组格式\n            userPrompt = {\n                role: 'user',\n                content: processedImageArray,\n                identifier: 'user_input',\n            };\n        }\n        else {\n            // 否则使用原有逻辑\n            userPrompt = {\n                role: 'user',\n                content: processedUserInput,\n                identifier: 'user_input',\n                image: promptConfig.image && !Array.isArray(promptConfig.image)\n                    ? await (0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_8__.convertFileToBase64)(promptConfig.image)\n                    : undefined,\n            };\n        }\n        baseData.chatContext.oaiMessages.unshift(userPrompt);\n    }\n    // 处理注入和添加消息\n    const messages = (await populationInjectionPrompts(baseData, baseData.chatContext.oaiMessages, promptConfig.inject, promptConfig)).reverse();\n    const imageInlining = (0,_sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__.isImageInliningSupported)();\n    // 添加聊天记录\n    const chatPool = [...messages];\n    for (const chatPrompt of chatPool) {\n        const prompt = new _sillytavern_scripts_PromptManager__WEBPACK_IMPORTED_MODULE_5__.Prompt(chatPrompt);\n        prompt.identifier = `chat_history-${messages.length - chatPool.indexOf(chatPrompt)}`;\n        prompt.content = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.substituteParams)(prompt.content);\n        const chatMessage = await _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__.Message.fromPromptAsync(prompt);\n        const promptManager = (0,_sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__.setupChatCompletionPromptManager)(_sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__.oai_settings);\n        if (promptManager) {\n            // @ts-ignore\n            if (promptManager.serviceSettings.names_behavior === _function_generate_types__WEBPACK_IMPORTED_MODULE_7__.character_names_behavior.COMPLETION && prompt.name) {\n                const messageName = promptManager.isValidName(prompt.name)\n                    ? prompt.name\n                    : promptManager.sanitizeName(prompt.name);\n                await chatMessage.setName(messageName);\n            }\n        }\n        if (imageInlining && chatPrompt.image) {\n            await chatMessage.addImage(chatPrompt.image);\n        }\n        if (chatCompletion.canAfford(chatMessage)) {\n            chatCollection.add(chatMessage);\n        }\n        else {\n            break;\n        }\n    }\n    // 释放新聊天提示词的预留token\n    chatCompletion.freeBudget(newChatMessage);\n    if (hasUserInput) {\n        // 按各自在order中的位置添加聊天记录和用户输入\n        chatCompletion.add(chatCollection, chatHistoryIndex);\n        chatCompletion.add(new _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__.MessageCollection('user_input', userMessage), userInputIndex);\n    }\n    else {\n        // 聊天记录中已包含用户输入，直接添加到chat_history位置\n        chatCompletion.add(chatCollection, chatHistoryIndex);\n    }\n}\n/**\n * 处理注入提示词\n * 按深度注入各种提示词，包括作者注释、用户描述、世界书深度条目和自定义注入\n * @param baseData 包含世界书信息的基础数据\n * @param messages 原始消息数组\n * @param customInjects 自定义注入提示词数组\n * @param config 配置参数，用于过滤检查\n * @returns Promise<RolePrompt[]> 处理后的消息数组，包含所有注入的提示词\n */\nasync function populationInjectionPrompts(baseData, messages, customInjects = [], config) {\n    const processedMessages = [...messages];\n    let totalInsertedMessages = 0;\n    const injectionPrompts = [];\n    // @ts-ignore\n    const authorsNote = (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.getContext)().extensionPrompts[_sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__.NOTE_MODULE_NAME];\n    if (authorsNote && authorsNote.value) {\n        injectionPrompts.push({\n            role: (0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_8__.getPromptRole)(authorsNote.role),\n            content: authorsNote.value,\n            identifier: 'authorsNote',\n            injection_depth: authorsNote.depth,\n            injected: true,\n        });\n    }\n    if (_sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_4__.power_user.persona_description &&\n        _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_4__.power_user.persona_description_position === _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_4__.persona_description_positions.AT_DEPTH) {\n        injectionPrompts.push({\n            role: 'system',\n            content: _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_4__.power_user.persona_description,\n            identifier: 'persona_description',\n            injection_depth: _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_4__.power_user.persona_description_depth,\n            injected: true,\n        });\n    }\n    if (!(0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_8__.isPromptFiltered)('char_depth_prompt', config)) {\n        const wiDepthPrompt = baseData.worldInfo.worldInfoDepth;\n        if (wiDepthPrompt) {\n            for (const entry of wiDepthPrompt) {\n                const content = await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.getExtensionPromptByName)(`customDepthWI-${entry.depth}-${entry.role}`);\n                injectionPrompts.push({\n                    role: (0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_8__.getPromptRole)(entry.role),\n                    content: content,\n                    injection_depth: entry.depth,\n                    injected: true,\n                });\n                loglevel__WEBPACK_IMPORTED_MODULE_6___default().info('injectionPrompts', injectionPrompts);\n            }\n        }\n    }\n    // 处理自定义注入\n    if (Array.isArray(customInjects)) {\n        for (const inject of customInjects) {\n            injectionPrompts.push({\n                identifier: `INJECTION-${inject.role}-${inject.depth}`,\n                role: inject.role,\n                content: inject.content,\n                injection_depth: inject.depth || 0,\n                injected: true,\n            });\n        }\n    }\n    for (let i = 0; i <= _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.MAX_INJECTION_DEPTH; i++) {\n        const depthPrompts = injectionPrompts.filter(prompt => prompt.injection_depth === i && prompt.content);\n        const roles = ['system', 'user', 'assistant'];\n        const roleMessages = [];\n        const separator = '\\n';\n        for (const role of roles) {\n            // 直接处理当前深度和角色的所有提示词\n            const rolePrompts = depthPrompts\n                .filter(prompt => prompt.role === role)\n                .map(x => x.content.trim())\n                .join(separator);\n            if (rolePrompts) {\n                roleMessages.push({\n                    role: role,\n                    content: rolePrompts,\n                    injected: true,\n                });\n            }\n        }\n        if (roleMessages.length) {\n            const injectIdx = i + totalInsertedMessages;\n            processedMessages.splice(injectIdx, 0, ...roleMessages);\n            totalInsertedMessages += roleMessages.length;\n        }\n    }\n    return processedMessages;\n}\n/**\n * 处理原始生成路径（不使用预设）\n * 构建ChatCompletion对象，按照指定order处理各种提示词，管理token预算\n * @param baseData 包含角色信息、聊天上下文和世界书信息的基础数据\n * @param config 配置参数，包含图片、覆盖设置、注入等选项\n * @param processedUserInput 经过处理的用户输入文本\n * @returns Promise<{prompt: any}> 包含最终prompt的生成数据对象\n */\nasync function handleCustomPath(baseData, config, processedUserInput) {\n    const chatCompletion = new _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__.ChatCompletion();\n    chatCompletion.setTokenBudget(_sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__.oai_settings.openai_max_context, _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__.oai_settings.openai_max_tokens);\n    chatCompletion.reserveBudget(3);\n    const orderArray = config.order || _function_generate_types__WEBPACK_IMPORTED_MODULE_7__.default_order;\n    const positionMap = orderArray.reduce((acc, item, index) => {\n        if (typeof item === 'string') {\n            acc[item.toLowerCase()] = index;\n        }\n        else if (typeof item === 'object') {\n            acc[`custom_prompt_${index}`] = index;\n        }\n        return acc;\n    }, {});\n    //转换为集合\n    const { systemPrompts, dialogue_examples } = await convertSystemPromptsToCollection(baseData, config);\n    const addToChatCompletionInOrder = async (source, index) => {\n        if (typeof source === 'object') {\n            // 处理自定义注入\n            const collection = new _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__.MessageCollection(`custom_prompt_${index}`);\n            const message = await _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__.Message.createAsync(source.role, source.content, `custom_prompt_${index}`);\n            collection.add(message);\n            chatCompletion.add(collection, index);\n        }\n        else if (systemPrompts.has(source)) {\n            // 处理普通提示词\n            const prompt = systemPrompts.get(source);\n            const collection = new _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__.MessageCollection(source);\n            const message = await _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__.Message.fromPromptAsync(prompt);\n            collection.add(message);\n            chatCompletion.add(collection, positionMap[source]);\n        }\n    };\n    // 处理所有类型的提示词\n    for (const [index, item] of orderArray.entries()) {\n        if (typeof item === 'string') {\n            if (!(0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_8__.isPromptFiltered)(item, config)) {\n                await addToChatCompletionInOrder(item, index);\n            }\n        }\n        else if (typeof item === 'object' && item.role && item.content) {\n            await addToChatCompletionInOrder(item, index);\n        }\n    }\n    const dialogue_examplesIndex = orderArray.findIndex(item => typeof item === 'string' && item.toLowerCase() === 'dialogue_examples');\n    if (dialogue_examplesIndex !== -1 && !(0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_8__.isPromptFiltered)('dialogue_examples', config)) {\n        chatCompletion.add(dialogue_examples, dialogue_examplesIndex);\n    }\n    //给user输入预留token\n    const userInputMessage = await _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__.Message.createAsync('user', processedUserInput, 'user_input');\n    chatCompletion.reserveBudget(userInputMessage);\n    await processChatHistoryAndInject(baseData, config, chatCompletion, processedUserInput, config.processedImageArray);\n    chatCompletion.freeBudget(userInputMessage);\n    //根据当前预设决定是否合并连续系统role消息\n    if (_sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__.oai_settings.squash_system_messages) {\n        await chatCompletion.squashSystemMessages();\n    }\n    const prompt = chatCompletion.getChat();\n    return { prompt };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZnVuY3Rpb24vZ2VuZXJhdGUvZ2VuZXJhdGVSYXcudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDakM7QUFDUjtBQVF4QjtBQUN1RDtBQUNkO0FBRW5EO0FBVVE7QUFFOEQ7QUFFakc7OztHQUdHO0FBRUg7Ozs7OztHQU1HO0FBQ0gsS0FBSyxVQUFVLGdDQUFnQyxDQUM3QyxRQUFhLEVBQ2IsWUFBc0U7SUFFdEUsTUFBTSxnQkFBZ0IsR0FBRyxJQUFJLGdGQUFnQixFQUFFLENBQUM7SUFDaEQsTUFBTSxrQkFBa0IsR0FBRyxJQUFJLDBFQUFpQixDQUFDLG1CQUFtQixDQUFDLENBQUM7SUFFdEUsTUFBTSxVQUFVLEdBQUcsWUFBWSxDQUFDLEtBQUssSUFBSSxrRkFBNEIsQ0FBQztJQUV0RSxNQUFNLHFCQUFxQixHQUFHO1FBQzVCLGlCQUFpQixFQUFFLFFBQVEsQ0FBQyxTQUFTLENBQUMsZUFBZTtRQUNyRCxtQkFBbUIsRUFDakIsdUVBQVUsQ0FBQyxtQkFBbUI7WUFDOUIsdUVBQVUsQ0FBQyw0QkFBNEIsS0FBSywwRkFBNkIsQ0FBQyxTQUFTO1lBQ2pGLENBQUMsQ0FBQyxRQUFRLENBQUMsYUFBYSxDQUFDLE9BQU87WUFDaEMsQ0FBQyxDQUFDLElBQUk7UUFDVixnQkFBZ0IsRUFBRSxRQUFRLENBQUMsYUFBYSxDQUFDLFdBQVc7UUFDcEQsZ0JBQWdCLEVBQUUsUUFBUSxDQUFDLGFBQWEsQ0FBQyxXQUFXO1FBQ3BELFFBQVEsRUFBRSxRQUFRLENBQUMsYUFBYSxDQUFDLFFBQVE7UUFDekMsZ0JBQWdCLEVBQUUsUUFBUSxDQUFDLFNBQVMsQ0FBQyxjQUFjO0tBQ3BELENBQUM7SUFFRixLQUFLLE1BQU0sQ0FBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLElBQUksVUFBVSxDQUFDLE9BQU8sRUFBRSxFQUFFLENBQUM7UUFDakQsSUFBSSxPQUFPLElBQUksS0FBSyxRQUFRLEVBQUUsQ0FBQztZQUM3QixVQUFVO1lBQ1YsTUFBTSxPQUFPLEdB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LE1BQU0sY0FBYyxDQUFDLG9CQUFvQixFQUFFLENBQUM7SUFDOUMsQ0FBQztJQUNELE1BQU0sTUFBTSxHQUFHLGNBQWMsQ0FBQyxPQUFPLEVBQUUsQ0FBQztJQUN4QyxPQUFPLEVBQUUsTUFBTSxFQUFFLENBQUM7QUFDcEIsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9mdW5jdGlvbi9nZW5lcmF0ZS9nZW5lcmF0ZVJhdy50cz8wNjM2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE1BWF9JTkpFQ1RJT05fREVQVEgsIGdldEV4dGVuc2lvblByb21wdEJ5TmFtZSwgc3Vic3RpdHV0ZVBhcmFtcyB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHQnO1xuaW1wb3J0IHsgTk9URV9NT0RVTEVfTkFNRSB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL2F1dGhvcnMtbm90ZSc7XG5pbXBvcnQgeyBnZXRDb250ZXh0IH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvZXh0ZW5zaW9ucyc7XG5pbXBvcnQge1xuICBDaGF0Q29tcGxldGlvbixcbiAgTWVzc2FnZSxcbiAgTWVzc2FnZUNvbGxlY3Rpb24sXG4gIGlzSW1hZ2VJbmxpbmluZ1N1cHBvcnRlZCxcbiAgb2FpX3NldHRpbmdzLFxuICBzZXR1cENoYXRDb21wbGV0aW9uUHJvbXB0TWFuYWdlcixcbn0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvb3BlbmFpJztcbmltcG9ydCB7IHBlcnNvbmFfZGVzY3JpcHRpb25fcG9zaXRpb25zLCBwb3dlcl91c2VyIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvcG93ZXItdXNlcic7XG5pbXBvcnQgeyBQcm9tcHQsIFByb21wdENvbGxlY3Rpb24gfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9Qcm9tcHRNYW5hZ2VyJztcblxuaW1wb3J0IGxvZyBmcm9tICdsb2dsZXZlbCc7XG5cbmltcG9ydCB7XG4gIEJhc2VEYXRhLFxuICBJbmplY3Rpb25Qcm9tcHQsXG4gIFJvbGVQcm9tcHQsXG4gIGJ1aWx0aW5fcHJvbXB0X2RlZmF1bHRfb3JkZXIsXG4gIGNoYXJhY3Rlcl9uYW1lc19iZWhhdmlvcixcbiAgZGVmYXVsdF9vcmRlcixcbiAgZGV0YWlsLFxufSBmcm9tICdAL2Z1bmN0aW9uL2dlbmVyYXRlL3R5cGVzJztcblxuaW1wb3J0IHsgY29udmVydEZpbGVUb0Jhc2U2NCwgZ2V0UHJvbXB0Um9sZSwgaXNQcm9tcHRGaWx0ZXJlZCB9IGZyb20gJ0AvZnVuY3Rpb24vZ2VuZXJhdGUvdXRpbHMnO1xuXG4vKipcbiAqIEBmaWxlb3ZlcnZpZXcg5Y6f5aeL55Sf5oiQ6Lev5b6E5aSE55CG5qih5Z2XIC0g5LiN5L2/55So6aKE6K6+55qE55Sf5oiQ6YC76L6RXG4gKiDljIXlkKvmiYDmnInkuI3kvb/nlKjpooTorr4odXNlX3ByZXNldD1mYWxzZSnml7bnmoTmj5DnpLror43lpITnkIblkozogYrlpKnlrozmiJDpgLvovpFcbiAqL1xuXG4vKipcbiAqIOWwhuezu+e7n+aPkOekuuivjei9rOaNouS4uumbhuWQiOagvOW8j1xuICog5aSE55CG5YaF572u5o+Q56S66K+N44CB6Ieq5a6a5LmJ5rOo5YWl5ZKM5a+56K+d56S65L6L77yM6L2s5o2i5Li6UHJvbXB0Q29sbGVjdGlvbuWSjE1lc3NhZ2VDb2xsZWN0aW9u5qC85byPXG4gKiBAcGFyYW0gYmFzZURhdGEg5YyF5ZCr6KeS6Imy5L+h5oGv5ZKM5LiW55WM5Lmm5L+h5oGv55qE5Z+656GA5pWw5o2uXG4gKiBAcGFyYW0gcHJvbXB0Q29uZmlnIOaPkOekuuivjemFjee9ruWPguaVsO+8jOWMheWQq29yZGVy562J6K6+572uXG4gKiBAcmV0dXJucyBQcm9taXNlPHtzeXN0ZW1Qcm9tcHRzOiBQcm9tcHRDb2xsZWN0aW9uLCBkaWFsb2d1ZV9leGFtcGxlczogTWVzc2FnZUNvbGxlY3Rpb259PiDov5Tlm57ns7vnu5/mj5DnpLror43lkozlr7nor53npLrkvovnmoTpm4blkIhcbiAqL1xuYXN5bmMgZnVuY3Rpb24gY29udmVydFN5c3RlbVByb21wdHNUb0NvbGxlY3Rpb24oXG4gIGJhc2VEYXRhOiBhbnksXG4gIHByb21wdENvbmZpZzogT21pdDxkZXRhaWwuR2VuZXJhdGVQYXJhbXMsICd1c2VyX2lucHV0JyB8ICd1c2VfcHJlc2V0Jz4sXG4pIHtcbiAgY29uc3QgcHJvbXB0Q29sbGVjdGlvbiA9IG5ldyBQcm9tcHRDb2xsZWN0aW9uKCk7XG4gIGNvbnN0IGV4YW1wbGVzQ29sbGVjdGlvbiA9IG5ldyBNZXNzYWdlQ29sbGVjdGlvbignZGlhbG9ndWVfZXhhbXBsZXMnKTtcblxuICBjb25zdCBvcmRlckFycmF5ID0gcHJvbXB0Q29uZmlnLm9yZGVyIHx8IGJ1aWx0aW5fcHJvbXB0X2RlZmF1bHRfb3JkZXI7XG5cbiAgY29uc3QgYnVpbHRpblByb21wdENvbnRlbnRzID0ge1xuICAgIHdvcmxkX2luZm9fYmVmb3JlOiBiYXNlRGF0YS53b3JsZEluZm8ud29ybGRJbmZvQmVmb3JlLFxuICAgIHBlcnNvbmFfZGVzY3JpcHRpb246XG4gICAgICBwb3dlcl91c2VyLnBlcnNvbmFfZGVzY3JpcHRpb24gJiZcbiAgICAgIHBvd2VyX3VzZXIucGVyc29uYV9kZXNjcmlwdGlvbl9wb3NpdGlvbiA9PT0gcGVyc29uYV9kZXNjcmlwdGlvbl9wb3NpdGlvbnMuSU5fUFJPTVBUXG4gICAgICAgID8gYmFzZURhdGEuY2hhcmFjdGVySW5mby5wZXJzb25hXG4gICAgICAgIDogbnVsbCxcbiAgICBjaGFyX2Rlc2NyaXB0aW9uOiBiYXNlRGF0YS5jaGFyYWN0ZXJJbmZvLmRlc2NyaXB0aW9uLFxuICAgIGNoYXJfcGVyc29uYWxpdHk6IGJhc2VEYXRhLmNoYXJhY3RlckluZm8ucGVyc29uYWxpdHksXG4gICAgc2NlbmFyaW86IGJhc2VEYXRhLmNoYXJhY3RlckluZm8uc2NlbmFyaW8sXG4gICAgd29ybGRfaW5mb19hZnRlcjogYmFzZURhdGEud29ybGRJbmZvLndvcmxkSW5mb0FmdGVyLFxuICB9O1xuXG4gIGZvciAoY29uc3QgW2luZGV4LCBpdGVtXSBvZiBvcmRlckFycmF5LmVudHJpZXMoKSkge1xuICAgIGlmICh0eXBlb2YgaXRlbSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIC8vIOWkhOeQhuWGhee9ruaPkOekuuivjVxuICAgICAgY29uc3QgY29udGVudCA9IGJ1aWx0aW5Qcm9tcHRDb250ZW50c1tpdGVtIGFzIGtleW9mIHR5cGVvZiBidWlsdGluUHJvbXB0Q29udGVudHNdO1xuICAgICAgaWYgKGNvbnRlbnQpIHtcbiAgICAgICAgcHJvbXB0Q29sbGVjdGlvbi5hZGQoXG4gICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgIG5ldyBQcm9tcHQoe1xuICAgICAgICAgICAgaWRlbnRpZmllcjogaXRlbSxcbiAgICAgICAgICAgIHJvbGU6ICdzeXN0ZW0nLFxuICAgICAgICAgICAgY29udGVudDogY29udGVudCxcbiAgICAgICAgICAgIHN5c3RlbV9wcm9tcHQ6IHRydWUsXG4gICAgICAgICAgfSksXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgaXRlbSA9PT0gJ29iamVjdCcgJiYgaXRlbS5yb2xlICYmIGl0ZW0uY29udGVudCkge1xuICAgICAgLy8g5aSE55CG6Ieq5a6a5LmJ5rOo5YWlXG4gICAgICBjb25zdCBpZGVudGlmaWVyID0gYGN1c3RvbV9wcm9tcHRfJHtpbmRleH1gO1xuICAgICAgcHJvbXB0Q29sbGVjdGlvbi5hZGQoXG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgbmV3IFByb21wdCh7XG4gICAgICAgICAgaWRlbnRpZmllcjogaWRlbnRpZmllcixcbiAgICAgICAgICByb2xlOiBpdGVtLnJvbGUsXG4gICAgICAgICAgY29udGVudDogaXRlbS5jb250ZW50LFxuICAgICAgICAgIHN5c3RlbV9wcm9tcHQ6IGl0ZW0ucm9sZSA9PT0gJ3N5c3RlbScsXG4gICAgICAgIH0pLFxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICBpZiAoYmFzZURhdGEuY2hhdENvbnRleHQub2FpTWVzc2FnZUV4YW1wbGVzLmxlbmd0aCA+IDApIHtcbiAgICAvLyDpgY3ljobmiYDmnInlr7nor53npLrkvotcbiAgICBmb3IgKGNvbnN0IGRpYWxvZ3VlIG9mIFsuLi5iYXNlRGF0YS5jaGF0Q29udGV4dC5vYWlNZXNzYWdlRXhhbXBsZXNdKSB7XG4gICAgICBjb25zdCBkaWFsb2d1ZUluZGV4ID0gYmFzZURhdGEuY2hhdENvbnRleHQub2FpTWVzc2FnZUV4YW1wbGVzLmluZGV4T2YoZGlhbG9ndWUpO1xuICAgICAgY29uc3QgY2hhdE1lc3NhZ2VzID0gW107XG5cbiAgICAgIGZvciAobGV0IHByb21wdEluZGV4ID0gMDsgcHJvbXB0SW5kZXggPCBkaWFsb2d1ZS5sZW5ndGg7IHByb21wdEluZGV4KyspIHtcbiAgICAgICAgY29uc3QgcHJvbXB0ID0gZGlhbG9ndWVbcHJvbXB0SW5kZXhdO1xuICAgICAgICBjb25zdCByb2xlID0gJ3N5c3RlbSc7XG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSBwcm9tcHQuY29udGVudCB8fCAnJztcbiAgICAgICAgY29uc3QgaWRlbnRpZmllciA9IGBkaWFsb2d1ZV9leGFtcGxlcyAke2RpYWxvZ3VlSW5kZXh9LSR7cHJvbXB0SW5kZXh9YDtcblxuICAgICAgICBjb25zdCBjaGF0TWVzc2FnZSA9IGF3YWl0IE1lc3NhZ2UuY3JlYXRlQXN5bmMocm9sZSwgY29udGVudCwgaWRlbnRpZmllcik7XG4gICAgICAgIGF3YWl0IGNoYXRNZXNzYWdlLnNldE5hbWUocHJvbXB0Lm5hbWUpO1xuICAgICAgICBjaGF0TWVzc2FnZXMucHVzaChjaGF0TWVzc2FnZSk7XG4gICAgICB9XG4gICAgICBmb3IgKGNvbnN0IG1lc3NhZ2Ugb2YgY2hhdE1lc3NhZ2VzKSB7XG4gICAgICAgIGV4YW1wbGVzQ29sbGVjdGlvbi5hZGQobWVzc2FnZSk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiB7XG4gICAgc3lzdGVtUHJvbXB0czogcHJvbXB0Q29sbGVjdGlvbixcbiAgICBkaWFsb2d1ZV9leGFtcGxlczogZXhhbXBsZXNDb2xsZWN0aW9uLFxuICB9O1xufVxuXG4vKipcbiAqIOWkhOeQhuiBiuWkqeiusOW9leW5tuazqOWFpeaPkOekuuivjVxuICog5qC55o2ub3JkZXLphY3nva7lpITnkIbogYrlpKnljoblj7LlkoznlKjmiLfovpPlhaXvvIzlubbms6jlhaXlkITnp43mt7Hluqbmj5DnpLror41cbiAqIEBwYXJhbSBiYXNlRGF0YSDljIXlkKvogYrlpKnkuIrkuIvmlofnmoTln7rnoYDmlbDmja5cbiAqIEBwYXJhbSBwcm9tcHRDb25maWcg5o+Q56S66K+N6YWN572u5Y+C5pWwXG4gKiBAcGFyYW0gY2hhdENvbXBsZXRpb24gQ2hhdENvbXBsZXRpb27lr7nosaHvvIznlKjkuo7nrqHnkIZ0b2tlbumihOeul+WSjOa2iOaBr+mbhuWQiFxuICogQHBhcmFtIHByb2Nlc3NlZFVzZXJJbnB1dCDnu4/ov4flpITnkIbnmoTnlKjmiLfovpPlhaXmlofmnKxcbiAqIEBwYXJhbSBwcm9jZXNzZWRJbWFnZUFycmF5IOWPr+mAieeahOWkhOeQhuWQjuWbvueJh+aVsOe7hO+8jOeUqOS6juWkmuWbvueJh+aUr+aMgVxuICogQHJldHVybnMgUHJvbWlzZTx2b2lkPiDml6Dov5Tlm57lgLzvvIznm7TmjqXkv67mlLljaGF0Q29tcGxldGlvbuWvueixoVxuICovXG5hc3luYyBmdW5jdGlvbiBwcm9jZXNzQ2hhdEhpc3RvcnlBbmRJbmplY3QoXG4gIGJhc2VEYXRhOiBhbnksXG4gIHByb21wdENvbmZpZzogT21pdDxkZXRhaWwuR2VuZXJhdGVQYXJhbXMsICd1c2VyX2lucHV0JyB8ICd1c2VfcHJlc2V0Jz4sXG4gIGNoYXRDb21wbGV0aW9uOiBDaGF0Q29tcGxldGlvbixcbiAgcHJvY2Vzc2VkVXNlcklucHV0OiBzdHJpbmcsXG4gIHByb2Nlc3NlZEltYWdlQXJyYXk/OiB7IHR5cGU6IHN0cmluZzsgdGV4dD86IHN0cmluZzsgaW1hZ2VfdXJsPzogeyB1cmw6IHN0cmluZzsgZGV0YWlsOiBzdHJpbmcgfSB9W10gfCBudWxsLFxuKSB7XG4gIGNvbnN0IG9yZGVyQXJyYXkgPSBwcm9tcHRDb25maWcub3JkZXIgfHwgZGVmYXVsdF9vcmRlcjtcbiAgY29uc3QgY2hhdEhpc3RvcnlJbmRleCA9IG9yZGVyQXJyYXkuZmluZEluZGV4KFxuICAgIGl0ZW0gPT4gdHlwZW9mIGl0ZW0gPT09ICdzdHJpbmcnICYmIGl0ZW0udG9Mb3dlckNhc2UoKSA9PT0gJ2NoYXRfaGlzdG9yeScsXG4gICk7XG4gIGNvbnN0IHVzZXJJbnB1dEluZGV4ID0gb3JkZXJBcnJheS5maW5kSW5kZXgoaXRlbSA9PiB0eXBlb2YgaXRlbSA9PT0gJ3N0cmluZycgJiYgaXRlbS50b0xvd2VyQ2FzZSgpID09PSAndXNlcl9pbnB1dCcpO1xuXG4gIGNvbnN0IGhhc1VzZXJJbnB1dCA9IHVzZXJJbnB1dEluZGV4ICE9PSAtMTtcbiAgY29uc3QgaGFzQ2hhdEhpc3RvcnkgPSBjaGF0SGlzdG9yeUluZGV4ICE9PSAtMTtcbiAgY29uc3QgaXNDaGF0SGlzdG9yeUZpbHRlcmVkID0gaXNQcm9tcHRGaWx0ZXJlZCgnY2hhdF9oaXN0b3J5JywgcHJvbXB0Q29uZmlnKTtcblxuICAvLyDliJvlu7rnlKjmiLfovpPlhaXmtojmga9cbiAgbGV0IHVzZXJNZXNzYWdlOiBNZXNzYWdlO1xuXG4gIGlmIChwcm9jZXNzZWRJbWFnZUFycmF5ICYmIGhhc1VzZXJJbnB1dCkge1xuICAgIC8vIOWmguaenOacieWkhOeQhuWQjueahOWbvueJh+aVsOe7hO+8jOebtOaOpeS9v+eUqOaVsOe7hOagvOW8j+WIm+W7uua2iOaBr1xuICAgIHVzZXJNZXNzYWdlID0gYXdhaXQgTWVzc2FnZS5jcmVhdGVBc3luYygndXNlcicsIHByb2Nlc3NlZEltYWdlQXJyYXkgYXMgYW55LCAndXNlcl9pbnB1dCcpO1xuICB9IGVsc2Uge1xuICAgIC8vIOWQpuWImeS9v+eUqOWOn+aciemAu+i+kVxuICAgIHVzZXJNZXNzYWdlID0gYXdhaXQgTWVzc2FnZS5jcmVhdGVBc3luYygndXNlcicsIHByb2Nlc3NlZFVzZXJJbnB1dCwgJ3VzZXJfaW5wdXQnKTtcblxuICAgIGlmIChwcm9tcHRDb25maWcuaW1hZ2UgJiYgaGFzVXNlcklucHV0KSB7XG4gICAgICBpZiAoIUFycmF5LmlzQXJyYXkocHJvbXB0Q29uZmlnLmltYWdlKSkge1xuICAgICAgICBjb25zdCBpbWcgPSBhd2FpdCBjb252ZXJ0RmlsZVRvQmFzZTY0KHByb21wdENvbmZpZy5pbWFnZSk7XG4gICAgICAgIGlmIChpbWcpIHtcbiAgICAgICAgICBhd2FpdCB1c2VyTWVzc2FnZS5hZGRJbWFnZShpbWcpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8g5aaC5p6c6IGK5aSp6K6w5b2V6KKr6L+H5ruk5oiW5LiN5Zyob3JkZXLkuK3vvIzlj6rlpITnkIbnlKjmiLfovpPlhaVcbiAgaWYgKGlzQ2hhdEhpc3RvcnlGaWx0ZXJlZCB8fCAhaGFzQ2hhdEhpc3RvcnkpIHtcbiAgICBjb25zdCBpbnNlcnRJbmRleCA9IGhhc1VzZXJJbnB1dCA/IHVzZXJJbnB1dEluZGV4IDogb3JkZXJBcnJheS5sZW5ndGg7XG4gICAgY2hhdENvbXBsZXRpb24uYWRkKG5ldyBNZXNzYWdlQ29sbGVjdGlvbigndXNlcl9pbnB1dCcsIHVzZXJNZXNzYWdlKSwgaW5zZXJ0SW5kZXgpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vIOWkhOeQhuiBiuWkqeiusOW9lVxuICBjb25zdCBjaGF0Q29sbGVjdGlvbiA9IG5ldyBNZXNzYWdlQ29sbGVjdGlvbignY2hhdF9oaXN0b3J5Jyk7XG5cbiAgLy8g5Li65paw6IGK5aSp5oyH56S66aKE55WZdG9rZW5cbiAgY29uc3QgbmV3Q2hhdCA9IG9haV9zZXR0aW5ncy5uZXdfY2hhdF9wcm9tcHQ7XG4gIGNvbnN0IG5ld0NoYXRNZXNzYWdlID0gYXdhaXQgTWVzc2FnZS5jcmVhdGVBc3luYygnc3lzdGVtJywgc3Vic3RpdHV0ZVBhcmFtcyhuZXdDaGF0KSwgJ25ld01haW5DaGF0Jyk7XG4gIGNoYXRDb21wbGV0aW9uLnJlc2VydmVCdWRnZXQobmV3Q2hhdE1lc3NhZ2UpO1xuXG4gIC8vIOa3u+WKoOaWsOiBiuWkqeaPkOekuuivjeWIsOmbhuWQiOeahOacgOWJjemdolxuICBjaGF0Q29sbGVjdGlvbi5hZGQobmV3Q2hhdE1lc3NhZ2UpO1xuXG4gIC8vIOWkhOeQhuepuua2iOaBr+abv+aNolxuICBjb25zdCBsYXN0Q2hhdFByb21wdCA9IGJhc2VEYXRhLmNoYXRDb250ZXh0Lm9haU1lc3NhZ2VzW2Jhc2VEYXRhLmNoYXRDb250ZXh0Lm9haU1lc3NhZ2VzLmxlbmd0aCAtIDFdO1xuICBjb25zdCBlbXB0eU1lc3NhZ2UgPSBhd2FpdCBNZXNzYWdlLmNyZWF0ZUFzeW5jKCd1c2VyJywgb2FpX3NldHRpbmdzLnNlbmRfaWZfZW1wdHksICdlbXB0eVVzZXJNZXNzYWdlUmVwbGFjZW1lbnQnKTtcblxuICBpZiAoXG4gICAgbGFzdENoYXRQcm9tcHQgJiZcbiAgICBsYXN0Q2hhdFByb21wdC5yb2xlID09PSAnYXNzaXN0YW50JyAmJlxuICAgIG9haV9zZXR0aW5ncy5zZW5kX2lmX2VtcHR5ICYmXG4gICAgY2hhdENvbXBsZXRpb24uY2FuQWZmb3JkKGVtcHR5TWVzc2FnZSlcbiAgKSB7XG4gICAgY2hhdENvbGxlY3Rpb24uYWRkKGVtcHR5TWVzc2FnZSk7XG4gIH1cblxuICAvLyDlsIbnlKjmiLfmtojmga/mt7vliqDliLDmtojmga/mlbDnu4TkuK3lh4blpIflpITnkIbms6jlhaVcbiAgaWYgKCFoYXNVc2VySW5wdXQpIHtcbiAgICBsZXQgdXNlclByb21wdDogYW55O1xuXG4gICAgaWYgKHByb2Nlc3NlZEltYWdlQXJyYXkpIHtcbiAgICAgIC8vIOWmguaenOacieWkhOeQhuWQjueahOWbvueJh+aVsOe7hO+8jOS9v+eUqOaVsOe7hOagvOW8j1xuICAgICAgdXNlclByb21wdCA9IHtcbiAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICBjb250ZW50OiBwcm9jZXNzZWRJbWFnZUFycmF5LFxuICAgICAgICBpZGVudGlmaWVyOiAndXNlcl9pbnB1dCcsXG4gICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyDlkKbliJnkvb/nlKjljp/mnInpgLvovpFcbiAgICAgIHVzZXJQcm9tcHQgPSB7XG4gICAgICAgIHJvbGU6ICd1c2VyJyxcbiAgICAgICAgY29udGVudDogcHJvY2Vzc2VkVXNlcklucHV0LFxuICAgICAgICBpZGVudGlmaWVyOiAndXNlcl9pbnB1dCcsXG4gICAgICAgIGltYWdlOlxuICAgICAgICAgIHByb21wdENvbmZpZy5pbWFnZSAmJiAhQXJyYXkuaXNBcnJheShwcm9tcHRDb25maWcuaW1hZ2UpXG4gICAgICAgICAgICA/IGF3YWl0IGNvbnZlcnRGaWxlVG9CYXNlNjQocHJvbXB0Q29uZmlnLmltYWdlKVxuICAgICAgICAgICAgOiB1bmRlZmluZWQsXG4gICAgICB9O1xuICAgIH1cblxuICAgIGJhc2VEYXRhLmNoYXRDb250ZXh0Lm9haU1lc3NhZ2VzLnVuc2hpZnQodXNlclByb21wdCk7XG4gIH1cblxuICAvLyDlpITnkIbms6jlhaXlkozmt7vliqDmtojmga9cbiAgY29uc3QgbWVzc2FnZXMgPSAoXG4gICAgYXdhaXQgcG9wdWxhdGlvbkluamVjdGlvblByb21wdHMoYmFzZURhdGEsIGJhc2VEYXRhLmNoYXRDb250ZXh0Lm9haU1lc3NhZ2VzLCBwcm9tcHRDb25maWcuaW5qZWN0LCBwcm9tcHRDb25maWcpXG4gICkucmV2ZXJzZSgpO1xuICBjb25zdCBpbWFnZUlubGluaW5nID0gaXNJbWFnZUlubGluaW5nU3VwcG9ydGVkKCk7XG4gIC8vIOa3u+WKoOiBiuWkqeiusOW9lVxuICBjb25zdCBjaGF0UG9vbCA9IFsuLi5tZXNzYWdlc107XG4gIGZvciAoY29uc3QgY2hhdFByb21wdCBvZiBjaGF0UG9vbCkge1xuICAgIGNvbnN0IHByb21wdCA9IG5ldyBQcm9tcHQoY2hhdFByb21wdCBhcyBhbnkpO1xuICAgIHByb21wdC5pZGVudGlmaWVyID0gYGNoYXRfaGlzdG9yeS0ke21lc3NhZ2VzLmxlbmd0aCAtIGNoYXRQb29sLmluZGV4T2YoY2hhdFByb21wdCl9YDtcbiAgICBwcm9tcHQuY29udGVudCA9IHN1YnN0aXR1dGVQYXJhbXMocHJvbXB0LmNvbnRlbnQpO1xuXG4gICAgY29uc3QgY2hhdE1lc3NhZ2UgPSBhd2FpdCBNZXNzYWdlLmZyb21Qcm9tcHRBc3luYyhwcm9tcHQpO1xuICAgIGNvbnN0IHByb21wdE1hbmFnZXIgPSBzZXR1cENoYXRDb21wbGV0aW9uUHJvbXB0TWFuYWdlcihvYWlfc2V0dGluZ3MpO1xuXG4gICAgaWYgKHByb21wdE1hbmFnZXIpIHtcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgIGlmIChwcm9tcHRNYW5hZ2VyLnNlcnZpY2VTZXR0aW5ncy5uYW1lc19iZWhhdmlvciA9PT0gY2hhcmFjdGVyX25hbWVzX2JlaGF2aW9yLkNPTVBMRVRJT04gJiYgcHJvbXB0Lm5hbWUpIHtcbiAgICAgICAgY29uc3QgbWVzc2FnZU5hbWUgPSBwcm9tcHRNYW5hZ2VyLmlzVmFsaWROYW1lKHByb21wdC5uYW1lKVxuICAgICAgICAgID8gcHJvbXB0Lm5hbWVcbiAgICAgICAgICA6IHByb21wdE1hbmFnZXIuc2FuaXRpemVOYW1lKHByb21wdC5uYW1lKTtcbiAgICAgICAgYXdhaXQgY2hhdE1lc3NhZ2Uuc2V0TmFtZShtZXNzYWdlTmFtZSk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChpbWFnZUlubGluaW5nICYmIGNoYXRQcm9tcHQuaW1hZ2UpIHtcbiAgICAgIGF3YWl0IGNoYXRNZXNzYWdlLmFkZEltYWdlKGNoYXRQcm9tcHQuaW1hZ2UgYXMgc3RyaW5nKTtcbiAgICB9XG4gICAgaWYgKGNoYXRDb21wbGV0aW9uLmNhbkFmZm9yZChjaGF0TWVzc2FnZSkpIHtcbiAgICAgIGNoYXRDb2xsZWN0aW9uLmFkZChjaGF0TWVzc2FnZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuXG4gIC8vIOmHiuaUvuaWsOiBiuWkqeaPkOekuuivjeeahOmihOeVmXRva2VuXG4gIGNoYXRDb21wbGV0aW9uLmZyZWVCdWRnZXQobmV3Q2hhdE1lc3NhZ2UpO1xuXG4gIGlmIChoYXNVc2VySW5wdXQpIHtcbiAgICAvLyDmjInlkIToh6rlnKhvcmRlcuS4reeahOS9jee9rua3u+WKoOiBiuWkqeiusOW9leWSjOeUqOaIt+i+k+WFpVxuICAgIGNoYXRDb21wbGV0aW9uLmFkZChjaGF0Q29sbGVjdGlvbiwgY2hhdEhpc3RvcnlJbmRleCk7XG4gICAgY2hhdENvbXBsZXRpb24uYWRkKG5ldyBNZXNzYWdlQ29sbGVjdGlvbigndXNlcl9pbnB1dCcsIHVzZXJNZXNzYWdlKSwgdXNlcklucHV0SW5kZXgpO1xuICB9IGVsc2Uge1xuICAgIC8vIOiBiuWkqeiusOW9leS4reW3suWMheWQq+eUqOaIt+i+k+WFpe+8jOebtOaOpea3u+WKoOWIsGNoYXRfaGlzdG9yeeS9jee9rlxuICAgIGNoYXRDb21wbGV0aW9uLmFkZChjaGF0Q29sbGVjdGlvbiwgY2hhdEhpc3RvcnlJbmRleCk7XG4gIH1cbn1cblxuLyoqXG4gKiDlpITnkIbms6jlhaXmj5DnpLror41cbiAqIOaMiea3seW6puazqOWFpeWQhOenjeaPkOekuuivje+8jOWMheaLrOS9nOiAheazqOmHiuOAgeeUqOaIt+aPj+i/sOOAgeS4lueVjOS5pua3seW6puadoeebruWSjOiHquWumuS5ieazqOWFpVxuICogQHBhcmFtIGJhc2VEYXRhIOWMheWQq+S4lueVjOS5puS/oeaBr+eahOWfuuehgOaVsOaNrlxuICogQHBhcmFtIG1lc3NhZ2VzIOWOn+Wni+a2iOaBr+aVsOe7hFxuICogQHBhcmFtIGN1c3RvbUluamVjdHMg6Ieq5a6a5LmJ5rOo5YWl5o+Q56S66K+N5pWw57uEXG4gKiBAcGFyYW0gY29uZmlnIOmFjee9ruWPguaVsO+8jOeUqOS6jui/h+a7pOajgOafpVxuICogQHJldHVybnMgUHJvbWlzZTxSb2xlUHJvbXB0W10+IOWkhOeQhuWQjueahOa2iOaBr+aVsOe7hO+8jOWMheWQq+aJgOacieazqOWFpeeahOaPkOekuuivjVxuICovXG5hc3luYyBmdW5jdGlvbiBwb3B1bGF0aW9uSW5qZWN0aW9uUHJvbXB0cyhcbiAgYmFzZURhdGE6IEJhc2VEYXRhLFxuICBtZXNzYWdlczogUm9sZVByb21wdFtdLFxuICBjdXN0b21JbmplY3RzOiBJbmplY3Rpb25Qcm9tcHRbXSA9IFtdLFxuICBjb25maWc6IE9taXQ8ZGV0YWlsLkdlbmVyYXRlUGFyYW1zLCAndXNlcl9pbnB1dCcgfCAndXNlX3ByZXNldCc+LFxuKSB7XG4gIGNvbnN0IHByb2Nlc3NlZE1lc3NhZ2VzID0gWy4uLm1lc3NhZ2VzXTtcbiAgbGV0IHRvdGFsSW5zZXJ0ZWRNZXNzYWdlcyA9IDA7XG4gIGNvbnN0IGluamVjdGlvblByb21wdHMgPSBbXTtcbiAgLy8gQHRzLWlnbm9yZVxuXG4gIGNvbnN0IGF1dGhvcnNOb3RlID0gZ2V0Q29udGV4dCgpLmV4dGVuc2lvblByb21wdHNbTk9URV9NT0RVTEVfTkFNRV07XG4gIGlmIChhdXRob3JzTm90ZSAmJiBhdXRob3JzTm90ZS52YWx1ZSkge1xuICAgIGluamVjdGlvblByb21wdHMucHVzaCh7XG4gICAgICByb2xlOiBnZXRQcm9tcHRSb2xlKGF1dGhvcnNOb3RlLnJvbGUpLFxuICAgICAgY29udGVudDogYXV0aG9yc05vdGUudmFsdWUsXG4gICAgICBpZGVudGlmaWVyOiAnYXV0aG9yc05vdGUnLFxuICAgICAgaW5qZWN0aW9uX2RlcHRoOiBhdXRob3JzTm90ZS5kZXB0aCxcbiAgICAgIGluamVjdGVkOiB0cnVlLFxuICAgIH0pO1xuICB9XG5cbiAgaWYgKFxuICAgIHBvd2VyX3VzZXIucGVyc29uYV9kZXNjcmlwdGlvbiAmJlxuICAgIHBvd2VyX3VzZXIucGVyc29uYV9kZXNjcmlwdGlvbl9wb3NpdGlvbiA9PT0gcGVyc29uYV9kZXNjcmlwdGlvbl9wb3NpdGlvbnMuQVRfREVQVEhcbiAgKSB7XG4gICAgaW5qZWN0aW9uUHJvbXB0cy5wdXNoKHtcbiAgICAgIHJvbGU6ICdzeXN0ZW0nLFxuICAgICAgY29udGVudDogcG93ZXJfdXNlci5wZXJzb25hX2Rlc2NyaXB0aW9uLFxuICAgICAgaWRlbnRpZmllcjogJ3BlcnNvbmFfZGVzY3JpcHRpb24nLFxuICAgICAgaW5qZWN0aW9uX2RlcHRoOiBwb3dlcl91c2VyLnBlcnNvbmFfZGVzY3JpcHRpb25fZGVwdGgsXG4gICAgICBpbmplY3RlZDogdHJ1ZSxcbiAgICB9KTtcbiAgfVxuXG4gIGlmICghaXNQcm9tcHRGaWx0ZXJlZCgnY2hhcl9kZXB0aF9wcm9tcHQnLCBjb25maWcpKSB7XG4gICAgY29uc3Qgd2lEZXB0aFByb21wdCA9IGJhc2VEYXRhLndvcmxkSW5mby53b3JsZEluZm9EZXB0aDtcbiAgICBpZiAod2lEZXB0aFByb21wdCkge1xuICAgICAgZm9yIChjb25zdCBlbnRyeSBvZiB3aURlcHRoUHJvbXB0KSB7XG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCBnZXRFeHRlbnNpb25Qcm9tcHRCeU5hbWUoYGN1c3RvbURlcHRoV0ktJHtlbnRyeS5kZXB0aH0tJHtlbnRyeS5yb2xlfWApO1xuICAgICAgICBpbmplY3Rpb25Qcm9tcHRzLnB1c2goe1xuICAgICAgICAgIHJvbGU6IGdldFByb21wdFJvbGUoZW50cnkucm9sZSksXG4gICAgICAgICAgY29udGVudDogY29udGVudCxcbiAgICAgICAgICBpbmplY3Rpb25fZGVwdGg6IGVudHJ5LmRlcHRoLFxuICAgICAgICAgIGluamVjdGVkOiB0cnVlLFxuICAgICAgICB9KTtcbiAgICAgICAgbG9nLmluZm8oJ2luamVjdGlvblByb21wdHMnLCBpbmplY3Rpb25Qcm9tcHRzKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyDlpITnkIboh6rlrprkuYnms6jlhaVcbiAgaWYgKEFycmF5LmlzQXJyYXkoY3VzdG9tSW5qZWN0cykpIHtcbiAgICBmb3IgKGNvbnN0IGluamVjdCBvZiBjdXN0b21JbmplY3RzKSB7XG4gICAgICBpbmplY3Rpb25Qcm9tcHRzLnB1c2goe1xuICAgICAgICBpZGVudGlmaWVyOiBgSU5KRUNUSU9OLSR7aW5qZWN0LnJvbGV9LSR7aW5qZWN0LmRlcHRofWAsXG4gICAgICAgIHJvbGU6IGluamVjdC5yb2xlLFxuICAgICAgICBjb250ZW50OiBpbmplY3QuY29udGVudCxcbiAgICAgICAgaW5qZWN0aW9uX2RlcHRoOiBpbmplY3QuZGVwdGggfHwgMCxcbiAgICAgICAgaW5qZWN0ZWQ6IHRydWUsXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBmb3IgKGxldCBpID0gMDsgaSA8PSBNQVhfSU5KRUNUSU9OX0RFUFRIOyBpKyspIHtcbiAgICBjb25zdCBkZXB0aFByb21wdHMgPSBpbmplY3Rpb25Qcm9tcHRzLmZpbHRlcihwcm9tcHQgPT4gcHJvbXB0LmluamVjdGlvbl9kZXB0aCA9PT0gaSAmJiBwcm9tcHQuY29udGVudCk7XG5cbiAgICBjb25zdCByb2xlcyA9IFsnc3lzdGVtJywgJ3VzZXInLCAnYXNzaXN0YW50J107XG4gICAgY29uc3Qgcm9sZU1lc3NhZ2VzID0gW107XG4gICAgY29uc3Qgc2VwYXJhdG9yID0gJ1xcbic7XG5cbiAgICBmb3IgKGNvbnN0IHJvbGUgb2Ygcm9sZXMpIHtcbiAgICAgIC8vIOebtOaOpeWkhOeQhuW9k+WJjea3seW6puWSjOinkuiJsueahOaJgOacieaPkOekuuivjVxuICAgICAgY29uc3Qgcm9sZVByb21wdHMgPSBkZXB0aFByb21wdHNcbiAgICAgICAgLmZpbHRlcihwcm9tcHQgPT4gcHJvbXB0LnJvbGUgPT09IHJvbGUpXG4gICAgICAgIC5tYXAoeCA9PiB4LmNvbnRlbnQudHJpbSgpKVxuICAgICAgICAuam9pbihzZXBhcmF0b3IpO1xuXG4gICAgICBpZiAocm9sZVByb21wdHMpIHtcbiAgICAgICAgcm9sZU1lc3NhZ2VzLnB1c2goe1xuICAgICAgICAgIHJvbGU6IHJvbGUgYXMgJ3VzZXInIHwgJ3N5c3RlbScgfCAnYXNzaXN0YW50JyxcbiAgICAgICAgICBjb250ZW50OiByb2xlUHJvbXB0cyxcbiAgICAgICAgICBpbmplY3RlZDogdHJ1ZSxcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHJvbGVNZXNzYWdlcy5sZW5ndGgpIHtcbiAgICAgIGNvbnN0IGluamVjdElkeCA9IGkgKyB0b3RhbEluc2VydGVkTWVzc2FnZXM7XG4gICAgICBwcm9jZXNzZWRNZXNzYWdlcy5zcGxpY2UoaW5qZWN0SWR4LCAwLCAuLi5yb2xlTWVzc2FnZXMpO1xuICAgICAgdG90YWxJbnNlcnRlZE1lc3NhZ2VzICs9IHJvbGVNZXNzYWdlcy5sZW5ndGg7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHByb2Nlc3NlZE1lc3NhZ2VzO1xufVxuXG4vKipcbiAqIOWkhOeQhuWOn+Wni+eUn+aIkOi3r+W+hO+8iOS4jeS9v+eUqOmihOiuvu+8iVxuICog5p6E5bu6Q2hhdENvbXBsZXRpb27lr7nosaHvvIzmjInnhafmjIflrppvcmRlcuWkhOeQhuWQhOenjeaPkOekuuivje+8jOeuoeeQhnRva2Vu6aKE566XXG4gKiBAcGFyYW0gYmFzZURhdGEg5YyF5ZCr6KeS6Imy5L+h5oGv44CB6IGK5aSp5LiK5LiL5paH5ZKM5LiW55WM5Lmm5L+h5oGv55qE5Z+656GA5pWw5o2uXG4gKiBAcGFyYW0gY29uZmlnIOmFjee9ruWPguaVsO+8jOWMheWQq+WbvueJh+OAgeimhuebluiuvue9ruOAgeazqOWFpeetiemAiemhuVxuICogQHBhcmFtIHByb2Nlc3NlZFVzZXJJbnB1dCDnu4/ov4flpITnkIbnmoTnlKjmiLfovpPlhaXmlofmnKxcbiAqIEByZXR1cm5zIFByb21pc2U8e3Byb21wdDogYW55fT4g5YyF5ZCr5pyA57uIcHJvbXB055qE55Sf5oiQ5pWw5o2u5a+56LGhXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYW5kbGVDdXN0b21QYXRoKFxuICBiYXNlRGF0YTogYW55LFxuICBjb25maWc6IE9taXQ8ZGV0YWlsLkdlbmVyYXRlUGFyYW1zLCAndXNlcl9pbnB1dCcgfCAndXNlX3ByZXNldCc+ICYge1xuICAgIHByb2Nlc3NlZEltYWdlQXJyYXk/OiB7IHR5cGU6IHN0cmluZzsgdGV4dD86IHN0cmluZzsgaW1hZ2VfdXJsPzogeyB1cmw6IHN0cmluZzsgZGV0YWlsOiBzdHJpbmcgfSB9W10gfCBudWxsO1xuICB9LFxuICBwcm9jZXNzZWRVc2VySW5wdXQ6IHN0cmluZyxcbikge1xuICBjb25zdCBjaGF0Q29tcGxldGlvbiA9IG5ldyBDaGF0Q29tcGxldGlvbigpO1xuICBjaGF0Q29tcGxldGlvbi5zZXRUb2tlbkJ1ZGdldChvYWlfc2V0dGluZ3Mub3BlbmFpX21heF9jb250ZXh0LCBvYWlfc2V0dGluZ3Mub3BlbmFpX21heF90b2tlbnMpO1xuICBjaGF0Q29tcGxldGlvbi5yZXNlcnZlQnVkZ2V0KDMpO1xuICBjb25zdCBvcmRlckFycmF5ID0gY29uZmlnLm9yZGVyIHx8IGRlZmF1bHRfb3JkZXI7XG4gIGNvbnN0IHBvc2l0aW9uTWFwOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+ID0gb3JkZXJBcnJheS5yZWR1Y2UoKGFjYzogUmVjb3JkPHN0cmluZywgbnVtYmVyPiwgaXRlbSwgaW5kZXgpID0+IHtcbiAgICBpZiAodHlwZW9mIGl0ZW0gPT09ICdzdHJpbmcnKSB7XG4gICAgICBhY2NbaXRlbS50b0xvd2VyQ2FzZSgpXSA9IGluZGV4O1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGl0ZW0gPT09ICdvYmplY3QnKSB7XG4gICAgICBhY2NbYGN1c3RvbV9wcm9tcHRfJHtpbmRleH1gXSA9IGluZGV4O1xuICAgIH1cbiAgICByZXR1cm4gYWNjO1xuICB9LCB7fSk7XG5cbiAgLy/ovazmjaLkuLrpm4blkIhcbiAgY29uc3QgeyBzeXN0ZW1Qcm9tcHRzLCBkaWFsb2d1ZV9leGFtcGxlcyB9ID0gYXdhaXQgY29udmVydFN5c3RlbVByb21wdHNUb0NvbGxlY3Rpb24oYmFzZURhdGEsIGNvbmZpZyk7XG4gIGNvbnN0IGFkZFRvQ2hhdENvbXBsZXRpb25Jbk9yZGVyID0gYXN5bmMgKHNvdXJjZTogYW55LCBpbmRleDogbnVtYmVyKSA9PiB7XG4gICAgaWYgKHR5cGVvZiBzb3VyY2UgPT09ICdvYmplY3QnKSB7XG4gICAgICAvLyDlpITnkIboh6rlrprkuYnms6jlhaVcbiAgICAgIGNvbnN0IGNvbGxlY3Rpb24gPSBuZXcgTWVzc2FnZUNvbGxlY3Rpb24oYGN1c3RvbV9wcm9tcHRfJHtpbmRleH1gKTtcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSBhd2FpdCBNZXNzYWdlLmNyZWF0ZUFzeW5jKHNvdXJjZS5yb2xlLCBzb3VyY2UuY29udGVudCwgYGN1c3RvbV9wcm9tcHRfJHtpbmRleH1gKTtcbiAgICAgIGNvbGxlY3Rpb24uYWRkKG1lc3NhZ2UpO1xuICAgICAgY2hhdENvbXBsZXRpb24uYWRkKGNvbGxlY3Rpb24sIGluZGV4KTtcbiAgICB9IGVsc2UgaWYgKHN5c3RlbVByb21wdHMuaGFzKHNvdXJjZSkpIHtcbiAgICAgIC8vIOWkhOeQhuaZrumAmuaPkOekuuivjVxuICAgICAgY29uc3QgcHJvbXB0ID0gc3lzdGVtUHJvbXB0cy5nZXQoc291cmNlKTtcbiAgICAgIGNvbnN0IGNvbGxlY3Rpb24gPSBuZXcgTWVzc2FnZUNvbGxlY3Rpb24oc291cmNlKTtcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSBhd2FpdCBNZXNzYWdlLmZyb21Qcm9tcHRBc3luYyhwcm9tcHQpO1xuICAgICAgY29sbGVjdGlvbi5hZGQobWVzc2FnZSk7XG4gICAgICBjaGF0Q29tcGxldGlvbi5hZGQoY29sbGVjdGlvbiwgcG9zaXRpb25NYXBbc291cmNlXSk7XG4gICAgfVxuICB9O1xuXG4gIC8vIOWkhOeQhuaJgOacieexu+Wei+eahOaPkOekuuivjVxuICBmb3IgKGNvbnN0IFtpbmRleCwgaXRlbV0gb2Ygb3JkZXJBcnJheS5lbnRyaWVzKCkpIHtcbiAgICBpZiAodHlwZW9mIGl0ZW0gPT09ICdzdHJpbmcnKSB7XG4gICAgICBpZiAoIWlzUHJvbXB0RmlsdGVyZWQoaXRlbSwgY29uZmlnKSkge1xuICAgICAgICBhd2FpdCBhZGRUb0NoYXRDb21wbGV0aW9uSW5PcmRlcihpdGVtLCBpbmRleCk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgaXRlbSA9PT0gJ29iamVjdCcgJiYgaXRlbS5yb2xlICYmIGl0ZW0uY29udGVudCkge1xuICAgICAgYXdhaXQgYWRkVG9DaGF0Q29tcGxldGlvbkluT3JkZXIoaXRlbSwgaW5kZXgpO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IGRpYWxvZ3VlX2V4YW1wbGVzSW5kZXggPSBvcmRlckFycmF5LmZpbmRJbmRleChcbiAgICBpdGVtID0+IHR5cGVvZiBpdGVtID09PSAnc3RyaW5nJyAmJiBpdGVtLnRvTG93ZXJDYXNlKCkgPT09ICdkaWFsb2d1ZV9leGFtcGxlcycsXG4gICk7XG5cbiAgaWYgKGRpYWxvZ3VlX2V4YW1wbGVzSW5kZXggIT09IC0xICYmICFpc1Byb21wdEZpbHRlcmVkKCdkaWFsb2d1ZV9leGFtcGxlcycsIGNvbmZpZykpIHtcbiAgICBjaGF0Q29tcGxldGlvbi5hZGQoZGlhbG9ndWVfZXhhbXBsZXMsIGRpYWxvZ3VlX2V4YW1wbGVzSW5kZXgpO1xuICB9XG4gIC8v57uZdXNlcui+k+WFpemihOeVmXRva2VuXG4gIGNvbnN0IHVzZXJJbnB1dE1lc3NhZ2UgPSBhd2FpdCBNZXNzYWdlLmNyZWF0ZUFzeW5jKCd1c2VyJywgcHJvY2Vzc2VkVXNlcklucHV0LCAndXNlcl9pbnB1dCcpO1xuICBjaGF0Q29tcGxldGlvbi5yZXNlcnZlQnVkZ2V0KHVzZXJJbnB1dE1lc3NhZ2UpO1xuXG4gIGF3YWl0IHByb2Nlc3NDaGF0SGlzdG9yeUFuZEluamVjdChiYXNlRGF0YSwgY29uZmlnLCBjaGF0Q29tcGxldGlvbiwgcHJvY2Vzc2VkVXNlcklucHV0LCBjb25maWcucHJvY2Vzc2VkSW1hZ2VBcnJheSk7XG4gIGNoYXRDb21wbGV0aW9uLmZyZWVCdWRnZXQodXNlcklucHV0TWVzc2FnZSk7XG5cbiAgLy/moLnmja7lvZPliY3pooTorr7lhrPlrprmmK/lkKblkIjlubbov57nu63ns7vnu59yb2xl5raI5oGvXG4gIGlmIChvYWlfc2V0dGluZ3Muc3F1YXNoX3N5c3RlbV9tZXNzYWdlcykge1xuICAgIGF3YWl0IGNoYXRDb21wbGV0aW9uLnNxdWFzaFN5c3RlbU1lc3NhZ2VzKCk7XG4gIH1cbiAgY29uc3QgcHJvbXB0ID0gY2hhdENvbXBsZXRpb24uZ2V0Q2hhdCgpO1xuICByZXR1cm4geyBwcm9tcHQgfTtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/function/generate/generateRaw.ts\n\n}")},"./src/function/generate/index.ts":
/*!****************************************!*\
  !*** ./src/function/generate/index.ts ***!
  \****************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   fromGenerateConfig: () => (/* binding */ fromGenerateConfig),\n/* harmony export */   fromGenerateRawConfig: () => (/* binding */ fromGenerateRawConfig),\n/* harmony export */   fromInjectionPrompt: () => (/* binding */ fromInjectionPrompt),\n/* harmony export */   fromOverrides: () => (/* binding */ fromOverrides),\n/* harmony export */   generate: () => (/* binding */ generate),\n/* harmony export */   generateRaw: () => (/* binding */ generateRaw)\n/* harmony export */ });\n/* harmony import */ var _function_generate_dataProcessor__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/function/generate/dataProcessor */ \"./src/function/generate/dataProcessor.ts\");\n/* harmony import */ var _function_generate_generate__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/function/generate/generate */ \"./src/function/generate/generate.ts\");\n/* harmony import */ var _function_generate_generateRaw__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/function/generate/generateRaw */ \"./src/function/generate/generateRaw.ts\");\n/* harmony import */ var _function_generate_inputProcessor__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/function/generate/inputProcessor */ \"./src/function/generate/inputProcessor.ts\");\n/* harmony import */ var _function_generate_responseGenerator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/function/generate/responseGenerator */ \"./src/function/generate/responseGenerator.ts\");\n/* harmony import */ var _function_generate_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/function/generate/utils */ \"./src/function/generate/utils.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_7__);\n\n\n\n\n\n\n\n\nlet abortController = new AbortController();\nlet currentImageProcessingSetup = undefined;\n/**\n * 清理图片处理相关的监听器和Promise\n */\nfunction cleanupImageProcessing() {\n    if (currentImageProcessingSetup) {\n        try {\n            currentImageProcessingSetup.cleanup();\n            currentImageProcessingSetup.rejectImageProcessing(new Error('Generation stopped by user'));\n            loglevel__WEBPACK_IMPORTED_MODULE_7___default().info('[Generate:停止] 已清理图片处理相关逻辑');\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_7___default().warn('[Generate:停止] 清理图片处理时出错:', error);\n        }\n        currentImageProcessingSetup = undefined;\n    }\n}\n/**\n * 从Overrides转换为detail.OverrideConfig\n * @param overrides 覆盖配置\n * @returns detail.OverrideConfig\n */\nfunction fromOverrides(overrides) {\n    return {\n        world_info_before: overrides.world_info_before,\n        persona_description: overrides.persona_description,\n        char_description: overrides.char_description,\n        char_personality: overrides.char_personality,\n        scenario: overrides.scenario,\n        world_info_after: overrides.world_info_after,\n        dialogue_examples: overrides.dialogue_examples,\n        with_depth_entries: overrides.chat_history?.with_depth_entries,\n        author_note: overrides.chat_history?.author_note,\n        chat_history: overrides.chat_history?.prompts,\n    };\n}\n/**\n * 从InjectionPrompt转换为InjectionPrompt\n * @param inject 注入提示词\n * @returns InjectionPrompt\n */\nfunction fromInjectionPrompt(inject) {\n    const position_map = {\n        before_prompt: 'before_prompt',\n        in_chat: 'in_chat',\n        after_prompt: 'after_prompt',\n        none: 'none',\n    };\n    return {\n        role: inject.role,\n        content: inject.content,\n        position: position_map[inject.position],\n        depth: inject.depth,\n        should_scan: inject.should_scan,\n    };\n}\n/**\n * 从GenerateConfig转换为detail.GenerateParams\n * @param config 生成配置\n * @returns detail.GenerateParams\n */\nfunction fromGenerateConfig(config) {\n    return {\n        user_input: config.user_input,\n        use_preset: true,\n        image: config.image,\n        stream: config.should_stream ?? false,\n        overrides: config.overrides !== undefined ? fromOverrides(config.overrides) : undefined,\n        inject: config.injects !== undefined ? config.injects.map(fromInjectionPrompt) : undefined,\n        max_chat_history: typeof config.max_chat_history === 'number' ? config.max_chat_history : undefined,\n    };\n}\n/**\n * 从GenerateRawConfig转换为detail.GenerateParams\n * @param config 原始生成配置\n * @returns detail.GenerateParams\n */\nfunction fromGenerateRawConfig(config) {\n    return {\n        user_input: config.user_input,\n        use_preset: false,\n        image: config.image,\n        stream: config.should_stream ?? false,\n        max_chat_history: typeof config.max_chat_history === 'number' ? config.max_chat_history : undefined,\n        overrides: config.overrides ? fromOverrides(config.overrides) : undefined,\n        inject: config.injects ? config.injects.map(fromInjectionPrompt) : undefined,\n        order: config.ordered_prompts,\n    };\n}\n/**\n * 生成AI响应的核心函数\n * @param config 生成配置参数\n * @param config.user_input 用户输入文本\n * @param config.use_preset 是否使用预设\n * @param config.image 图片参数，可以是单个图片(File|string)或图片数组(File|string)[]\n * @param config.overrides 覆盖配置\n * @param config.max_chat_history 最大聊天历史数量\n * @param config.inject 注入的提示词\n * @param config.order 提示词顺序\n * @param config.stream 是否启用流式传输\n * @returns Promise<string> 生成的响应文本\n */\nasync function iframeGenerate({ user_input = '', use_preset = true, image = undefined, overrides = undefined, max_chat_history = undefined, inject = [], order = undefined, stream = false, } = {}) {\n    abortController = new AbortController();\n    // 1. 处理用户输入和图片（正则，宏，图片数组）\n    const inputResult = await (0,_function_generate_inputProcessor__WEBPACK_IMPORTED_MODULE_3__.processUserInputWithImages)(user_input, use_preset, image);\n    const { processedUserInput, imageProcessingSetup, processedImageArray } = inputResult;\n    currentImageProcessingSetup = imageProcessingSetup;\n    await _sillytavern_script__WEBPACK_IMPORTED_MODULE_6__.eventSource.emit(_sillytavern_script__WEBPACK_IMPORTED_MODULE_6__.event_types.GENERATION_AFTER_COMMANDS, 'quiet', {}, false);\n    // 2. 准备过滤后的基础数据\n    const baseData = await (0,_function_generate_dataProcessor__WEBPACK_IMPORTED_MODULE_0__.prepareAndOverrideData)({\n        overrides,\n        max_chat_history,\n        inject,\n        order,\n    }, processedUserInput);\n    // 3. 根据 use_preset 分流处理\n    const generate_data = use_preset\n        ? await (0,_function_generate_generate__WEBPACK_IMPORTED_MODULE_1__.handlePresetPath)(baseData, processedUserInput, {\n            image,\n            overrides,\n            max_chat_history,\n            inject,\n            order,\n        })\n        : await (0,_function_generate_generateRaw__WEBPACK_IMPORTED_MODULE_2__.handleCustomPath)(baseData, {\n            image,\n            overrides,\n            max_chat_history,\n            inject,\n            order,\n            processedImageArray,\n        }, processedUserInput);\n    await _sillytavern_script__WEBPACK_IMPORTED_MODULE_6__.eventSource.emit(_sillytavern_script__WEBPACK_IMPORTED_MODULE_6__.event_types.GENERATE_AFTER_DATA, generate_data);\n    try {\n        // 4. 根据 stream 参数决定生成方式\n        loglevel__WEBPACK_IMPORTED_MODULE_7___default().info('[Generate:发送提示词]', generate_data);\n        const result = await (0,_function_generate_responseGenerator__WEBPACK_IMPORTED_MODULE_4__.generateResponse)(generate_data, stream, imageProcessingSetup, abortController);\n        currentImageProcessingSetup = undefined;\n        return result;\n    }\n    catch (error) {\n        if (imageProcessingSetup) {\n            imageProcessingSetup.rejectImageProcessing(error);\n        }\n        currentImageProcessingSetup = undefined;\n        throw error;\n    }\n}\nasync function generate(config) {\n    const converted_config = fromGenerateConfig(config);\n    return await iframeGenerate(converted_config);\n}\nasync function generateRaw(config) {\n    const converted_config = fromGenerateRawConfig(config);\n    return await iframeGenerate(converted_config);\n}\n/**\n * 点击停止按钮时的逻辑\n */\n$(document).on('click', '#mes_stop', function () {\n    const wasStopped = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_6__.stopGeneration)();\n    if (wasStopped) {\n        if (abortController) {\n            abortController.abort('Clicked stop button');\n        }\n        cleanupImageProcessing();\n        (0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_5__.unblockGeneration)();\n    }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QztRQUV4QyxPQUFPLE1BQU0sQ0FBQztJQUNoQixDQUFDO0lBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztRQUNmLElBQUksb0JBQW9CLEVBQUUsQ0FBQztZQUN6QixvQkFBb0IsQ0FBQyxxQkFBcUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNwRCxDQUFDO1FBRUQsMkJBQTJCLEdBQUcsU0FBUyxDQUFDO1FBRXhDLE1BQU0sS0FBSyxDQUFDO0lBQ2QsQ0FBQztBQUNILENBQUM7QUFFTSxLQUFLLFVBQVUsUUFBUSxDQUFDLE1BQXNCO0lBQ25ELE1BQU0sZ0JBQWdCLEdBQUcsa0JBQWtCLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDcEQsT0FBTyxNQUFNLGNBQWMsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO0FBQ2hELENBQUM7QUFFTSxLQUFLLFVBQVUsV0FBVyxDQUFDLE1BQXlCO0lBQ3pELE1BQU0sZ0JBQWdCLEdBQUcscUJBQXFCLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDdkQsT0FBTyxNQUFNLGNBQWMsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO0FBQ2hELENBQUM7QUFFRDs7R0FFRztBQUNILENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLENBQUMsT0FBTyxFQUFFLFdBQVcsRUFBRTtJQUNuQyxNQUFNLFVBQVUsR0FBRyxtRUFBYyxFQUFFLENBQUM7SUFDcEMsSUFBSSxVQUFVLEVBQUUsQ0FBQztRQUNmLElBQUksZUFBZSxFQUFFLENBQUM7WUFDcEIsZUFBZSxDQUFDLEtBQUssQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO1FBQy9DLENBQUM7UUFFRCxzQkFBc0IsRUFBRSxDQUFDO1FBRXpCLDJFQUFpQixFQUFFLENBQUM7SUFDdEIsQ0FBQztBQUNILENBQUMsQ0FBQyxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2Z1bmN0aW9uL2dlbmVyYXRlL2luZGV4LnRzPzE2ODQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcHJlcGFyZUFuZE92ZXJyaWRlRGF0YSB9IGZyb20gJ0AvZnVuY3Rpb24vZ2VuZXJhdGUvZGF0YVByb2Nlc3Nvcic7XG5pbXBvcnQgeyBoYW5kbGVQcmVzZXRQYXRoIH0gZnJvbSAnQC9mdW5jdGlvbi9nZW5lcmF0ZS9nZW5lcmF0ZSc7XG5pbXBvcnQgeyBoYW5kbGVDdXN0b21QYXRoIH0gZnJvbSAnQC9mdW5jdGlvbi9nZW5lcmF0ZS9nZW5lcmF0ZVJhdyc7XG5pbXBvcnQgeyBwcm9jZXNzVXNlcklucHV0V2l0aEltYWdlcyB9IGZyb20gJ0AvZnVuY3Rpb24vZ2VuZXJhdGUvaW5wdXRQcm9jZXNzb3InO1xuaW1wb3J0IHsgZ2VuZXJhdGVSZXNwb25zZSB9IGZyb20gJ0AvZnVuY3Rpb24vZ2VuZXJhdGUvcmVzcG9uc2VHZW5lcmF0b3InO1xuaW1wb3J0IHsgZGV0YWlsLCBHZW5lcmF0ZUNvbmZpZywgR2VuZXJhdGVSYXdDb25maWcsIEluamVjdGlvblByb21wdCwgT3ZlcnJpZGVzIH0gZnJvbSAnQC9mdW5jdGlvbi9nZW5lcmF0ZS90eXBlcyc7XG5pbXBvcnQgeyBzZXR1cEltYWdlQXJyYXlQcm9jZXNzaW5nLCB1bmJsb2NrR2VuZXJhdGlvbiB9IGZyb20gJ0AvZnVuY3Rpb24vZ2VuZXJhdGUvdXRpbHMnO1xuXG5pbXBvcnQgeyBldmVudF90eXBlcywgZXZlbnRTb3VyY2UsIHN0b3BHZW5lcmF0aW9uIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5cbmltcG9ydCBsb2cgZnJvbSAnbG9nbGV2ZWwnO1xuXG5kZWNsYXJlIGNvbnN0ICQ6IGFueTtcblxubGV0IGFib3J0Q29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcblxubGV0IGN1cnJlbnRJbWFnZVByb2Nlc3NpbmdTZXR1cDogUmV0dXJuVHlwZTx0eXBlb2Ygc2V0dXBJbWFnZUFycmF5UHJvY2Vzc2luZz4gfCB1bmRlZmluZWQgPSB1bmRlZmluZWQ7XG5cbi8qKlxuICog5riF55CG5Zu+54mH5aSE55CG55u45YWz55qE55uR5ZCs5Zmo5ZKMUHJvbWlzZVxuICovXG5mdW5jdGlvbiBjbGVhbnVwSW1hZ2VQcm9jZXNzaW5nKCk6IHZvaWQge1xuICBpZiAoY3VycmVudEltYWdlUHJvY2Vzc2luZ1NldHVwKSB7XG4gICAgdHJ5IHtcbiAgICAgIGN1cnJlbnRJbWFnZVByb2Nlc3NpbmdTZXR1cC5jbGVhbnVwKCk7XG5cbiAgICAgIGN1cnJlbnRJbWFnZVByb2Nlc3NpbmdTZXR1cC5yZWplY3RJbWFnZVByb2Nlc3NpbmcobmV3IEVycm9yKCdHZW5lcmF0aW9uIHN0b3BwZWQgYnkgdXNlcicpKTtcblxuICAgICAgbG9nLmluZm8oJ1tHZW5lcmF0ZTrlgZzmraJdIOW3sua4heeQhuWbvueJh+WkhOeQhuebuOWFs+mAu+i+kScpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2cud2FybignW0dlbmVyYXRlOuWBnOatol0g5riF55CG5Zu+54mH5aSE55CG5pe25Ye66ZSZOicsIGVycm9yKTtcbiAgICB9XG4gICAgY3VycmVudEltYWdlUHJvY2Vzc2luZ1NldHVwID0gdW5kZWZpbmVkO1xuICB9XG59XG5cbi8qKlxuICog5LuOT3ZlcnJpZGVz6L2s5o2i5Li6ZGV0YWlsLk92ZXJyaWRlQ29uZmlnXG4gKiBAcGFyYW0gb3ZlcnJpZGVzIOimhueblumFjee9rlxuICogQHJldHVybnMgZGV0YWlsLk92ZXJyaWRlQ29uZmlnXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmcm9tT3ZlcnJpZGVzKG92ZXJyaWRlczogT3ZlcnJpZGVzKTogZGV0YWlsLk92ZXJyaWRlQ29uZmlnIHtcbiAgcmV0dXJuIHtcbiAgICB3b3JsZF9pbmZvX2JlZm9yZTogb3ZlcnJpZGVzLndvcmxkX2luZm9fYmVmb3JlLFxuICAgIHBlcnNvbmFfZGVzY3JpcHRpb246IG92ZXJyaWRlcy5wZXJzb25hX2Rlc2NyaXB0aW9uLFxuICAgIGNoYXJfZGVzY3JpcHRpb246IG92ZXJyaWRlcy5jaGFyX2Rlc2NyaXB0aW9uLFxuICAgIGNoYXJfcGVyc29uYWxpdHk6IG92ZXJyaWRlcy5jaGFyX3BlcnNvbmFsaXR5LFxuICAgIHNjZW5hcmlvOiBvdmVycmlkZXMuc2NlbmFyaW8sXG4gICAgd29ybGRfaW5mb19hZnRlcjogb3ZlcnJpZGVzLndvcmxkX2luZm9fYWZ0ZXIsXG4gICAgZGlhbG9ndWVfZXhhbXBsZXM6IG92ZXJyaWRlcy5kaWFsb2d1ZV9leGFtcGxlcyxcblxuICAgIHdpdGhfZGVwdGhfZW50cmllczogb3ZlcnJpZGVzLmNoYXRfaGlzdG9yeT8ud2l0aF9kZXB0aF9lbnRyaWVzLFxuICAgIGF1dGhvcl9ub3RlOiBvdmVycmlkZXMuY2hhdF9oaXN0b3J5Py5hdXRob3Jfbm90ZSxcbiAgICBjaGF0X2hpc3Rvcnk6IG92ZXJyaWRlcy5jaGF0X2hpc3Rvcnk/LnByb21wdHMsXG4gIH07XG59XG5cbi8qKlxuICog5LuOSW5qZWN0aW9uUHJvbXB06L2s5o2i5Li6SW5qZWN0aW9uUHJvbXB0XG4gKiBAcGFyYW0gaW5qZWN0IOazqOWFpeaPkOekuuivjVxuICogQHJldHVybnMgSW5qZWN0aW9uUHJvbXB0XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmcm9tSW5qZWN0aW9uUHJvbXB0KGluamVjdDogSW5qZWN0aW9uUHJvbXB0KTogSW5qZWN0aW9uUHJvbXB0IHtcbiAgY29uc3QgcG9zaXRpb25fbWFwID0ge1xuICAgIGJlZm9yZV9wcm9tcHQ6ICdiZWZvcmVfcHJvbXB0JyxcbiAgICBpbl9jaGF0OiAnaW5fY2hhdCcsXG4gICAgYWZ0ZXJfcHJvbXB0OiAnYWZ0ZXJfcHJvbXB0JyxcbiAgICBub25lOiAnbm9uZScsXG4gIH0gYXMgY29uc3Q7XG4gIHJldHVybiB7XG4gICAgcm9sZTogaW5qZWN0LnJvbGUsXG4gICAgY29udGVudDogaW5qZWN0LmNvbnRlbnQsXG4gICAgcG9zaXRpb246IHBvc2l0aW9uX21hcFtpbmplY3QucG9zaXRpb25dIGFzICdiZWZvcmVfcHJvbXB0JyB8ICdpbl9jaGF0JyB8ICdhZnRlcl9wcm9tcHQnIHwgJ25vbmUnLFxuICAgIGRlcHRoOiBpbmplY3QuZGVwdGgsXG4gICAgc2hvdWxkX3NjYW46IGluamVjdC5zaG91bGRfc2NhbixcbiAgfTtcbn1cblxuLyoqXG4gKiDku45HZW5lcmF0ZUNvbmZpZ+i9rOaNouS4umRldGFpbC5HZW5lcmF0ZVBhcmFtc1xuICogQHBhcmFtIGNvbmZpZyDnlJ/miJDphY3nva5cbiAqIEByZXR1cm5zIGRldGFpbC5HZW5lcmF0ZVBhcmFtc1xuICovXG5leHBvcnQgZnVuY3Rpb24gZnJvbUdlbmVyYXRlQ29uZmlnKGNvbmZpZzogR2VuZXJhdGVDb25maWcpOiBkZXRhaWwuR2VuZXJhdGVQYXJhbXMge1xuICByZXR1cm4ge1xuICAgIHVzZXJfaW5wdXQ6IGNvbmZpZy51c2VyX2lucHV0LFxuICAgIHVzZV9wcmVzZXQ6IHRydWUsXG4gICAgaW1hZ2U6IGNvbmZpZy5pbWFnZSxcbiAgICBzdHJlYW06IGNvbmZpZy5zaG91bGRfc3RyZWFtID8/IGZhbHNlLFxuICAgIG92ZXJyaWRlczogY29uZmlnLm92ZXJyaWRlcyAhPT0gdW5kZWZpbmVkID8gZnJvbU92ZXJyaWRlcyhjb25maWcub3ZlcnJpZGVzKSA6IHVuZGVmaW5lZCxcbiAgICBpbmplY3Q6IGNvbmZpZy5pbmplY3RzICE9PSB1bmRlZmluZWQgPyBjb25maWcuaW5qZWN0cy5tYXAoZnJvbUluamVjdGlvblByb21wdCkgOiB1bmRlZmluZWQsXG4gICAgbWF4X2NoYXRfaGlzdG9yeTogdHlwZW9mIGNvbmZpZy5tYXhfY2hhdF9oaXN0b3J5ID09PSAnbnVtYmVyJyA/IGNvbmZpZy5tYXhfY2hhdF9oaXN0b3J5IDogdW5kZWZpbmVkLFxuICB9O1xufVxuXG4vKipcbiAqIOS7jkdlbmVyYXRlUmF3Q29uZmln6L2s5o2i5Li6ZGV0YWlsLkdlbmVyYXRlUGFyYW1zXG4gKiBAcGFyYW0gY29uZmlnIOWOn+Wni+eUn+aIkOmFjee9rlxuICogQHJldHVybnMgZGV0YWlsLkdlbmVyYXRlUGFyYW1zXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmcm9tR2VuZXJhdGVSYXdDb25maWcoY29uZmlnOiBHZW5lcmF0ZVJhd0NvbmZpZyk6IGRldGFpbC5HZW5lcmF0ZVBhcmFtcyB7XG4gIHJldHVybiB7XG4gICAgdXNlcl9pbnB1dDogY29uZmlnLnVzZXJfaW5wdXQsXG4gICAgdXNlX3ByZXNldDogZmFsc2UsXG4gICAgaW1hZ2U6IGNvbmZpZy5pbWFnZSxcbiAgICBzdHJlYW06IGNvbmZpZy5zaG91bGRfc3RyZWFtID8/IGZhbHNlLFxuICAgIG1heF9jaGF0X2hpc3Rvcnk6IHR5cGVvZiBjb25maWcubWF4X2NoYXRfaGlzdG9yeSA9PT0gJ251bWJlcicgPyBjb25maWcubWF4X2NoYXRfaGlzdG9yeSA6IHVuZGVmaW5lZCxcbiAgICBvdmVycmlkZXM6IGNvbmZpZy5vdmVycmlkZXMgPyBmcm9tT3ZlcnJpZGVzKGNvbmZpZy5vdmVycmlkZXMpIDogdW5kZWZpbmVkLFxuICAgIGluamVjdDogY29uZmlnLmluamVjdHMgPyBjb25maWcuaW5qZWN0cy5tYXAoZnJvbUluamVjdGlvblByb21wdCkgOiB1bmRlZmluZWQsXG4gICAgb3JkZXI6IGNvbmZpZy5vcmRlcmVkX3Byb21wdHMsXG4gIH07XG59XG5cbi8qKlxuICog55Sf5oiQQUnlk43lupTnmoTmoLjlv4Plh73mlbBcbiAqIEBwYXJhbSBjb25maWcg55Sf5oiQ6YWN572u5Y+C5pWwXG4gKiBAcGFyYW0gY29uZmlnLnVzZXJfaW5wdXQg55So5oi36L6T5YWl5paH5pysXG4gKiBAcGFyYW0gY29uZmlnLnVzZV9wcmVzZXQg5piv5ZCm5L2/55So6aKE6K6+XG4gKiBAcGFyYW0gY29uZmlnLmltYWdlIOWbvueJh+WPguaVsO+8jOWPr+S7peaYr+WNleS4quWbvueJhyhGaWxlfHN0cmluZynmiJblm77niYfmlbDnu4QoRmlsZXxzdHJpbmcpW11cbiAqIEBwYXJhbSBjb25maWcub3ZlcnJpZGVzIOimhueblumFjee9rlxuICogQHBhcmFtIGNvbmZpZy5tYXhfY2hhdF9oaXN0b3J5IOacgOWkp+iBiuWkqeWOhuWPsuaVsOmHj1xuICogQHBhcmFtIGNvbmZpZy5pbmplY3Qg5rOo5YWl55qE5o+Q56S66K+NXG4gKiBAcGFyYW0gY29uZmlnLm9yZGVyIOaPkOekuuivjemhuuW6j1xuICogQHBhcmFtIGNvbmZpZy5zdHJlYW0g5piv5ZCm5ZCv55So5rWB5byP5Lyg6L6TXG4gKiBAcmV0dXJucyBQcm9taXNlPHN0cmluZz4g55Sf5oiQ55qE5ZON5bqU5paH5pysXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGlmcmFtZUdlbmVyYXRlKHtcbiAgdXNlcl9pbnB1dCA9ICcnLFxuICB1c2VfcHJlc2V0ID0gdHJ1ZSxcbiAgaW1hZ2UgPSB1bmRlZmluZWQsXG4gIG92ZXJyaWRlcyA9IHVuZGVmaW5lZCxcbiAgbWF4X2NoYXRfaGlzdG9yeSA9IHVuZGVmaW5lZCxcbiAgaW5qZWN0ID0gW10sXG4gIG9yZGVyID0gdW5kZWZpbmVkLFxuICBzdHJlYW0gPSBmYWxzZSxcbn06IGRldGFpbC5HZW5lcmF0ZVBhcmFtcyA9IHt9KTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgYWJvcnRDb250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpO1xuXG4gIC8vIDEuIOWkhOeQhueUqOaIt+i+k+WFpeWSjOWbvueJh++8iOato+WIme+8jOWuj++8jOWbvueJh+aVsOe7hO+8iVxuICBjb25zdCBpbnB1dFJlc3VsdCA9IGF3YWl0IHByb2Nlc3NVc2VySW5wdXRXaXRoSW1hZ2VzKHVzZXJfaW5wdXQsIHVzZV9wcmVzZXQsIGltYWdlKTtcbiAgY29uc3QgeyBwcm9jZXNzZWRVc2VySW5wdXQsIGltYWdlUHJvY2Vzc2luZ1NldHVwLCBwcm9jZXNzZWRJbWFnZUFycmF5IH0gPSBpbnB1dFJlc3VsdDtcblxuICBjdXJyZW50SW1hZ2VQcm9jZXNzaW5nU2V0dXAgPSBpbWFnZVByb2Nlc3NpbmdTZXR1cDtcblxuICBhd2FpdCBldmVudFNvdXJjZS5lbWl0KFxuICAgIGV2ZW50X3R5cGVzLkdFTkVSQVRJT05fQUZURVJfQ09NTUFORFMsXG4gICAgJ3F1aWV0JyxcbiAgICB7fSxcbiAgICBmYWxzZSxcbiAgKTtcblxuICAvLyAyLiDlh4blpIfov4fmu6TlkI7nmoTln7rnoYDmlbDmja5cbiAgY29uc3QgYmFzZURhdGEgPSBhd2FpdCBwcmVwYXJlQW5kT3ZlcnJpZGVEYXRhKFxuICAgIHtcbiAgICAgIG92ZXJyaWRlcyxcbiAgICAgIG1heF9jaGF0X2hpc3RvcnksXG4gICAgICBpbmplY3QsXG4gICAgICBvcmRlcixcbiAgICB9LFxuICAgIHByb2Nlc3NlZFVzZXJJbnB1dCxcbiAgKTtcblxuICAvLyAzLiDmoLnmja4gdXNlX3ByZXNldCDliIbmtYHlpITnkIZcbiAgY29uc3QgZ2VuZXJhdGVfZGF0YSA9IHVzZV9wcmVzZXRcbiAgICA/IGF3YWl0IGhhbmRsZVByZXNldFBhdGgoYmFzZURhdGEsIHByb2Nlc3NlZFVzZXJJbnB1dCwge1xuICAgICAgICBpbWFnZSxcbiAgICAgICAgb3ZlcnJpZGVzLFxuICAgICAgICBtYXhfY2hhdF9oaXN0b3J5LFxuICAgICAgICBpbmplY3QsXG4gICAgICAgIG9yZGVyLFxuICAgICAgfSlcbiAgICA6IGF3YWl0IGhhbmRsZUN1c3RvbVBhdGgoXG4gICAgICAgIGJhc2VEYXRhLFxuICAgICAgICB7XG4gICAgICAgICAgaW1hZ2UsXG4gICAgICAgICAgb3ZlcnJpZGVzLFxuICAgICAgICAgIG1heF9jaGF0X2hpc3RvcnksXG4gICAgICAgICAgaW5qZWN0LFxuICAgICAgICAgIG9yZGVyLFxuICAgICAgICAgIHByb2Nlc3NlZEltYWdlQXJyYXksXG4gICAgICAgIH0sXG4gICAgICAgIHByb2Nlc3NlZFVzZXJJbnB1dCxcbiAgICAgICk7XG5cbiAgYXdhaXQgZXZlbnRTb3VyY2UuZW1pdChldmVudF90eXBlcy5HRU5FUkFURV9BRlRFUl9EQVRBLCBnZW5lcmF0ZV9kYXRhKTtcblxuICB0cnkge1xuICAgIC8vIDQuIOagueaNriBzdHJlYW0g5Y+C5pWw5Yaz5a6a55Sf5oiQ5pa55byPXG4gICAgbG9nLmluZm8oJ1tHZW5lcmF0ZTrlj5HpgIHmj5DnpLror41dJywgZ2VuZXJhdGVfZGF0YSk7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2VuZXJhdGVSZXNwb25zZShnZW5lcmF0ZV9kYXRhLCBzdHJlYW0sIGltYWdlUHJvY2Vzc2luZ1NldHVwLCBhYm9ydENvbnRyb2xsZXIpO1xuXG4gICAgY3VycmVudEltYWdlUHJvY2Vzc2luZ1NldHVwID0gdW5kZWZpbmVkO1xuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBpZiAoaW1hZ2VQcm9jZXNzaW5nU2V0dXApIHtcbiAgICAgIGltYWdlUHJvY2Vzc2luZ1NldHVwLnJlamVjdEltYWdlUHJvY2Vzc2luZyhlcnJvcik7XG4gICAgfVxuXG4gICAgY3VycmVudEltYWdlUHJvY2Vzc2luZ1NldHVwID0gdW5kZWZpbmVkO1xuXG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlKGNvbmZpZzogR2VuZXJhdGVDb25maWcpIHtcbiAgY29uc3QgY29udmVydGVkX2NvbmZpZyA9IGZyb21HZW5lcmF0ZUNvbmZpZyhjb25maWcpO1xuICByZXR1cm4gYXdhaXQgaWZyYW1lR2VuZXJhdGUoY29udmVydGVkX2NvbmZpZyk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZW5lcmF0ZVJhdyhjb25maWc6IEdlbmVyYXRlUmF3Q29uZmlnKSB7XG4gIGNvbnN0IGNvbnZlcnRlZF9jb25maWcgPSBmcm9tR2VuZXJhdGVSYXdDb25maWcoY29uZmlnKTtcbiAgcmV0dXJuIGF3YWl0IGlmcmFtZUdlbmVyYXRlKGNvbnZlcnRlZF9jb25maWcpO1xufVxuXG4vKipcbiAqIOeCueWHu+WBnOatouaMiemSruaXtueahOmAu+i+kVxuICovXG4kKGRvY3VtZW50KS5vbignY2xpY2snLCAnI21lc19zdG9wJywgZnVuY3Rpb24gKCkge1xuICBjb25zdCB3YXNTdG9wcGVkID0gc3RvcEdlbmVyYXRpb24oKTtcbiAgaWYgKHdhc1N0b3BwZWQpIHtcbiAgICBpZiAoYWJvcnRDb250cm9sbGVyKSB7XG4gICAgICBhYm9ydENvbnRyb2xsZXIuYWJvcnQoJ0NsaWNrZWQgc3RvcCBidXR0b24nKTtcbiAgICB9XG5cbiAgICBjbGVhbnVwSW1hZ2VQcm9jZXNzaW5nKCk7XG5cbiAgICB1bmJsb2NrR2VuZXJhdGlvbigpO1xuICB9XG59KTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/function/generate/index.ts\n\n}")},"./src/function/generate/inputProcessor.ts":
/*!*************************************************!*\
  !*** ./src/function/generate/inputProcessor.ts ***!
  \*************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   processInitialUserInput: () => (/* binding */ processInitialUserInput),\n/* harmony export */   processUserInputWithImages: () => (/* binding */ processUserInputWithImages)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _function_generate_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/function/generate/utils */ \"./src/function/generate/utils.ts\");\n\n\n/**\n * 处理用户输入的第一步\n * 包括宏替换、正则处理等预处理操作\n * @param user_input 原始用户输入\n * @returns 处理后的用户输入\n */\nfunction processInitialUserInput(user_input = '') {\n    // 1. 处理宏替换\n    const substitutedInput = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.substituteParams)(user_input);\n    // 2. 处理正则和其他预处理\n    const processedUserInput = (0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_1__.processUserInput)(substitutedInput) || '';\n    return processedUserInput;\n}\n/**\n * 完整的用户输入和图片处理\n * 包括用户输入预处理和图片数组处理逻辑\n * @param user_input 用户输入文本\n * @param use_preset 是否使用预设\n * @param image 图片参数，可以是单个图片(File|string)或图片数组(File|string)[]\n * @returns 处理结果，包含处理后的用户输入和图片处理相关数据\n */\nasync function processUserInputWithImages(user_input = '', use_preset = true, image = undefined) {\n    // 1. 处理用户输入（正则，宏）\n    let processedUserInput = processInitialUserInput(user_input);\n    // 处理可能的图片数组的情况\n    let imageProcessingSetup = undefined;\n    let processedImageArray = undefined;\n    if (Array.isArray(image) && image.length > 0) {\n        if (use_preset) {\n            // 使用预设时，采用事件监听方式处理图片数组\n            imageProcessingSetup = (0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_1__.setupImageArrayProcessing)(processedUserInput, image);\n            processedUserInput = imageProcessingSetup.userInputWithMarker;\n        }\n        else {\n            // 使用原始模式时，直接处理图片数组\n            processedImageArray = await (0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_1__.processImageArrayDirectly)(processedUserInput, image);\n            // 保持原始用户输入不变，图片数组将在后续步骤中直接使用\n        }\n    }\n    return {\n        processedUserInput,\n        imageProcessingSetup,\n        processedImageArray,\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZnVuY3Rpb24vZ2VuZXJhdGUvaW5wdXRQcm9jZXNzb3IudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUF1RDtBQUM0RDtBQVduSDs7Ozs7R0FLRztBQUNJLFNBQVMsdUJBQXVCLENBQUMsVUFBVSxHQUFHLEVBQUU7SUFDckQsV0FBVztJQUNYLE1BQU0sZ0JBQWdCLEdBQUcscUVBQWdCLENBQUMsVUFBVSxDQUFDLENBQUM7SUFFdEQsZ0JBQWdCO0lBQ2hCLE1BQU0sa0JBQWtCLEdBQUcsMEVBQWdCLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxFQUFFLENBQUM7SUFFcEUsT0FBTyxrQkFBa0IsQ0FBQztBQUM1QixDQUFDO0FBRUQ7Ozs7Ozs7R0FPRztBQUNJLEtBQUssVUFBVSwwQkFBMEIsQ0FDOUMsVUFBVSxHQUFHLEVBQUUsRUFDZixVQUFVLEdBQUcsSUFBSSxFQUNqQixRQUF1RCxTQUFTO0lBRWhFLGtCQUFrQjtJQUNsQixJQUFJLGtCQUFrQixHQUFHLHVCQUF1QixDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBRTdELGVBQWU7SUFDZixJQUFJLG9CQUFvQixHQUE2RCxTQUFTLENBQUM7SUFDL0YsSUFBSSxtQkFBbUIsR0FDckIsU0FBUyxDQUFDO0lBRVosSUFBSSxLQUFLLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxJQUFJLEtBQUssQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFLENBQUM7UUFDN0MsSUFBSSxVQUFVLEVBQUUsQ0FBQztZQUNmLHVCQUF1QjtZQUN2QixvQkFBb0IsR0FBRyxtRkFBeUIsQ0FBQyxrQkFBa0IsRUFBRSxLQUFLLENBQUMsQ0FBQztZQUM1RSxrQkFBa0IsR0FBRyxvQkFBb0IsQ0FBQyxtQkFBbUIsQ0FBQztRQUNoRSxDQUFDO2FBQU0sQ0FBQztZQUNOLG1CQUFtQjtZQUNuQixtQkFBbUIsR0FBRyxNQUFNLG1GQUF5QixDQUFDLGtCQUFrQixFQUFFLEtBQUssQ0FBQyxDQUFDO1lBQ2pGLDZCQUE2QjtRQUMvQixDQUFDO0lBQ0gsQ0FBQztJQUVELE9BQU87UUFDTCxrQkFBa0I7UUFDbEIsb0JBQW9CO1FBQ3BCLG1CQUFtQjtLQUNwQixDQUFDO0FBQ0osQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9mdW5jdGlvbi9nZW5lcmF0ZS9pbnB1dFByb2Nlc3Nvci50cz83ZjczIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHN1YnN0aXR1dGVQYXJhbXMgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0JztcbmltcG9ydCB7IHByb2Nlc3NJbWFnZUFycmF5RGlyZWN0bHksIHByb2Nlc3NVc2VySW5wdXQsIHNldHVwSW1hZ2VBcnJheVByb2Nlc3NpbmcgfSBmcm9tICdAL2Z1bmN0aW9uL2dlbmVyYXRlL3V0aWxzJztcblxuLyoqXG4gKiDnlKjmiLfovpPlhaXlpITnkIbnu5PmnpzmjqXlj6NcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBQcm9jZXNzZWRJbnB1dFJlc3VsdCB7XG4gIHByb2Nlc3NlZFVzZXJJbnB1dDogc3RyaW5nO1xuICBpbWFnZVByb2Nlc3NpbmdTZXR1cD86IFJldHVyblR5cGU8dHlwZW9mIHNldHVwSW1hZ2VBcnJheVByb2Nlc3Npbmc+O1xuICBwcm9jZXNzZWRJbWFnZUFycmF5PzogeyB0eXBlOiBzdHJpbmc7IHRleHQ/OiBzdHJpbmc7IGltYWdlX3VybD86IHsgdXJsOiBzdHJpbmc7IGRldGFpbDogc3RyaW5nIH0gfVtdO1xufVxuXG4vKipcbiAqIOWkhOeQhueUqOaIt+i+k+WFpeeahOesrOS4gOatpVxuICog5YyF5ous5a6P5pu/5o2i44CB5q2j5YiZ5aSE55CG562J6aKE5aSE55CG5pON5L2cXG4gKiBAcGFyYW0gdXNlcl9pbnB1dCDljp/lp4vnlKjmiLfovpPlhaVcbiAqIEByZXR1cm5zIOWkhOeQhuWQjueahOeUqOaIt+i+k+WFpVxuICovXG5leHBvcnQgZnVuY3Rpb24gcHJvY2Vzc0luaXRpYWxVc2VySW5wdXQodXNlcl9pbnB1dCA9ICcnKTogc3RyaW5nIHtcbiAgLy8gMS4g5aSE55CG5a6P5pu/5o2iXG4gIGNvbnN0IHN1YnN0aXR1dGVkSW5wdXQgPSBzdWJzdGl0dXRlUGFyYW1zKHVzZXJfaW5wdXQpO1xuXG4gIC8vIDIuIOWkhOeQhuato+WImeWSjOWFtuS7lumihOWkhOeQhlxuICBjb25zdCBwcm9jZXNzZWRVc2VySW5wdXQgPSBwcm9jZXNzVXNlcklucHV0KHN1YnN0aXR1dGVkSW5wdXQpIHx8ICcnO1xuXG4gIHJldHVybiBwcm9jZXNzZWRVc2VySW5wdXQ7XG59XG5cbi8qKlxuICog5a6M5pW055qE55So5oi36L6T5YWl5ZKM5Zu+54mH5aSE55CGXG4gKiDljIXmi6znlKjmiLfovpPlhaXpooTlpITnkIblkozlm77niYfmlbDnu4TlpITnkIbpgLvovpFcbiAqIEBwYXJhbSB1c2VyX2lucHV0IOeUqOaIt+i+k+WFpeaWh+acrFxuICogQHBhcmFtIHVzZV9wcmVzZXQg5piv5ZCm5L2/55So6aKE6K6+XG4gKiBAcGFyYW0gaW1hZ2Ug5Zu+54mH5Y+C5pWw77yM5Y+v5Lul5piv5Y2V5Liq5Zu+54mHKEZpbGV8c3RyaW5nKeaIluWbvueJh+aVsOe7hChGaWxlfHN0cmluZylbXVxuICogQHJldHVybnMg5aSE55CG57uT5p6c77yM5YyF5ZCr5aSE55CG5ZCO55qE55So5oi36L6T5YWl5ZKM5Zu+54mH5aSE55CG55u45YWz5pWw5o2uXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwcm9jZXNzVXNlcklucHV0V2l0aEltYWdlcyhcbiAgdXNlcl9pbnB1dCA9ICcnLFxuICB1c2VfcHJlc2V0ID0gdHJ1ZSxcbiAgaW1hZ2U6IEZpbGUgfCBzdHJpbmcgfCAoRmlsZSB8IHN0cmluZylbXSB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZCxcbik6IFByb21pc2U8UHJvY2Vzc2VkSW5wdXRSZXN1bHQ+IHtcbiAgLy8gMS4g5aSE55CG55So5oi36L6T5YWl77yI5q2j5YiZ77yM5a6P77yJXG4gIGxldCBwcm9jZXNzZWRVc2VySW5wdXQgPSBwcm9jZXNzSW5pdGlhbFVzZXJJbnB1dCh1c2VyX2lucHV0KTtcblxuICAvLyDlpITnkIblj6/og73nmoTlm77niYfmlbDnu4TnmoTmg4XlhrVcbiAgbGV0IGltYWdlUHJvY2Vzc2luZ1NldHVwOiBSZXR1cm5UeXBlPHR5cGVvZiBzZXR1cEltYWdlQXJyYXlQcm9jZXNzaW5nPiB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcbiAgbGV0IHByb2Nlc3NlZEltYWdlQXJyYXk6IHsgdHlwZTogc3RyaW5nOyB0ZXh0Pzogc3RyaW5nOyBpbWFnZV91cmw/OiB7IHVybDogc3RyaW5nOyBkZXRhaWw6IHN0cmluZyB9IH1bXSB8IHVuZGVmaW5lZCA9XG4gICAgdW5kZWZpbmVkO1xuXG4gIGlmIChBcnJheS5pc0FycmF5KGltYWdlKSAmJiBpbWFnZS5sZW5ndGggPiAwKSB7XG4gICAgaWYgKHVzZV9wcmVzZXQpIHtcbiAgICAgIC8vIOS9v+eUqOmihOiuvuaXtu+8jOmHh+eUqOS6i+S7tuebkeWQrOaWueW8j+WkhOeQhuWbvueJh+aVsOe7hFxuICAgICAgaW1hZ2VQcm9jZXNzaW5nU2V0dXAgPSBzZXR1cEltYWdlQXJyYXlQcm9jZXNzaW5nKHByb2Nlc3NlZFVzZXJJbnB1dCwgaW1hZ2UpO1xuICAgICAgcHJvY2Vzc2VkVXNlcklucHV0ID0gaW1hZ2VQcm9jZXNzaW5nU2V0dXAudXNlcklucHV0V2l0aE1hcmtlcjtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8g5L2/55So5Y6f5aeL5qih5byP5pe277yM55u05o6l5aSE55CG5Zu+54mH5pWw57uEXG4gICAgICBwcm9jZXNzZWRJbWFnZUFycmF5ID0gYXdhaXQgcHJvY2Vzc0ltYWdlQXJyYXlEaXJlY3RseShwcm9jZXNzZWRVc2VySW5wdXQsIGltYWdlKTtcbiAgICAgIC8vIOS/neaMgeWOn+Wni+eUqOaIt+i+k+WFpeS4jeWPmO+8jOWbvueJh+aVsOe7hOWwhuWcqOWQjue7reatpemqpOS4reebtOaOpeS9v+eUqFxuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgcHJvY2Vzc2VkVXNlcklucHV0LFxuICAgIGltYWdlUHJvY2Vzc2luZ1NldHVwLFxuICAgIHByb2Nlc3NlZEltYWdlQXJyYXksXG4gIH07XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/function/generate/inputProcessor.ts\n\n}")},"./src/function/generate/responseGenerator.ts":
/*!****************************************************!*\
  !*** ./src/function/generate/responseGenerator.ts ***!
  \****************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   generateResponse: () => (/* binding */ generateResponse)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_i18n__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/i18n */ \"@sillytavern/scripts/i18n\");\n/* harmony import */ var _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/scripts/openai */ \"@sillytavern/scripts/openai\");\n/* harmony import */ var _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/scripts/power-user */ \"@sillytavern/scripts/power-user\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var _function_generate_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/function/generate/utils */ \"./src/function/generate/utils.ts\");\n\n\n\n\n\n\n\nconst type = 'quiet';\n/**\n * 流式处理器类\n * 处理流式生成的响应数据\n */\nclass StreamingProcessor {\n    generator;\n    stoppingStrings;\n    result;\n    isStopped;\n    isFinished;\n    abortController;\n    messageBuffer;\n    constructor() {\n        this.result = '';\n        this.messageBuffer = '';\n        this.isStopped = false;\n        this.isFinished = false;\n        this.generator = this.nullStreamingGeneration;\n        this.abortController = new AbortController();\n    }\n    onProgressStreaming(text, isFinal) {\n        // 计算增量文本\n        const newText = text.slice(this.messageBuffer.length);\n        this.messageBuffer = text;\n        // 兼容旧版本\n        // @ts-ignore\n        let processedText = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.cleanUpMessage)(newText, false, false, !isFinal, this.stoppingStrings);\n        const charsToBalance = ['*', '\"', '```'];\n        for (const char of charsToBalance) {\n            if (!isFinal && (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.isOdd)((0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.countOccurrences)(processedText, char))) {\n                const separator = char.length > 1 ? '\\n' : '';\n                processedText = processedText.trimEnd() + separator + char;\n            }\n        }\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.emit('js_stream_token_received_fully', text);\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.emit('js_stream_token_received_incrementally', processedText);\n        if (isFinal) {\n            // 兼容旧版本\n            // @ts-ignore\n            const fullText = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.cleanUpMessage)(text, false, false, false, this.stoppingStrings);\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.emit('js_generation_ended', fullText);\n        }\n    }\n    onErrorStreaming() {\n        if (this.abortController) {\n            this.abortController.abort();\n        }\n        this.isStopped = true;\n        (0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_6__.unblockGeneration)();\n        (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveChatConditional)();\n    }\n    // eslint-disable-next-line require-yield\n    async *nullStreamingGeneration() {\n        throw Error('Generation function for streaming is not hooked up');\n    }\n    async generate() {\n        try {\n            const sw = new _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_4__.Stopwatch(1000 / _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_3__.power_user.streaming_fps);\n            const timestamps = [];\n            for await (const { text } of this.generator()) {\n                timestamps.push(Date.now());\n                if (this.isStopped) {\n                    this.messageBuffer = '';\n                    return;\n                }\n                this.result = text;\n                await sw.tick(() => this.onProgressStreaming(text, false));\n            }\n            if (!this.isStopped) {\n                this.onProgressStreaming(this.result, true);\n            }\n            else {\n                this.messageBuffer = '';\n            }\n            const seconds = (timestamps[timestamps.length - 1] - timestamps[0]) / 1000;\n            loglevel__WEBPACK_IMPORTED_MODULE_5___default().warn(`Stream stats: ${timestamps.length} tokens, ${seconds.toFixed(2)} seconds, rate: ${Number(timestamps.length / seconds).toFixed(2)} TPS`);\n        }\n        catch (err) {\n            if (!this.isFinished) {\n                this.onErrorStreaming();\n                throw Error(`Generate method error: ${err}`);\n            }\n            this.messageBuffer = '';\n            return this.result;\n        }\n        this.isFinished = true;\n        return this.result;\n    }\n}\n/**\n * 处理非流式响应\n * @param response API响应对象\n * @returns 提取的消息文本\n */\nasync function handleResponse(response) {\n    if (!response) {\n        throw Error(`未得到响应`);\n    }\n    if (response.error) {\n        if (response?.response) {\n            toastr.error(response.response, (0,_sillytavern_scripts_i18n__WEBPACK_IMPORTED_MODULE_1__.t) `API Error`, {\n                preventDuplicates: true,\n            });\n        }\n        throw Error(response?.response);\n    }\n    const message = (0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_6__.extractMessageFromData)(response);\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.emit('js_generation_ended', message);\n    return message;\n}\n/**\n * 生成响应\n * @param generate_data 生成数据\n * @param useStream 是否使用流式传输\n * @param imageProcessingSetup 图片数组处理设置，包含Promise和解析器\n * @param abortController 中止控制器\n * @returns 生成的响应文本\n */\nasync function generateResponse(generate_data, useStream = false, imageProcessingSetup = undefined, abortController) {\n    let result = '';\n    try {\n        (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.deactivateSendButtons)();\n        // 如果有图片处理，等待图片处理完成\n        if (imageProcessingSetup) {\n            try {\n                await imageProcessingSetup.imageProcessingPromise;\n                loglevel__WEBPACK_IMPORTED_MODULE_5___default().debug('[Generate:图片数组处理] 图片处理已完成，继续生成流程');\n            }\n            catch (imageError) {\n                loglevel__WEBPACK_IMPORTED_MODULE_5___default().error('[Generate:图片数组处理] 图片处理失败:', imageError);\n                // 图片处理失败不应该阻止整个生成流程，但需要记录错误\n                throw new Error(`图片处理失败: ${imageError?.message || '未知错误'}`);\n            }\n        }\n        if (useStream) {\n            const originalStreamSetting = _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_2__.oai_settings.stream_openai;\n            if (!originalStreamSetting) {\n                _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_2__.oai_settings.stream_openai = true;\n                (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveSettingsDebounced)();\n            }\n            const streamingProcessor = new StreamingProcessor();\n            // @ts-ignore\n            streamingProcessor.generator = await (0,_sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_2__.sendOpenAIRequest)('normal', generate_data.prompt, abortController.signal);\n            result = (await streamingProcessor.generate());\n            if (originalStreamSetting !== _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_2__.oai_settings.stream_openai) {\n                _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_2__.oai_settings.stream_openai = originalStreamSetting;\n                (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveSettingsDebounced)();\n            }\n        }\n        else {\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.emit('js_generation_started');\n            const response = await (0,_sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_2__.sendOpenAIRequest)(type, generate_data.prompt, abortController.signal);\n            result = await handleResponse(response);\n        }\n    }\n    catch (error) {\n        // 如果有图片处理设置但生成失败，确保拒绝Promise\n        if (imageProcessingSetup) {\n            imageProcessingSetup.rejectImageProcessing(error);\n        }\n        loglevel__WEBPACK_IMPORTED_MODULE_5___default().error(error);\n        throw error;\n    }\n    finally {\n        (0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_6__.unblockGeneration)();\n        await (0,_function_generate_utils__WEBPACK_IMPORTED_MODULE_6__.clearInjectionPrompts)(['INJECTION']);\n    }\n    return result;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZnVuY3Rpb24vZ2VuZXJhdGUvcmVzcG9uc2VHZW5lcmF0b3IudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBUTZCO0FBQ2lCO0FBQ2dDO0FBQ2pCO0FBQ047QUFFNUI7QUFJNkc7QUFFeEksTUFBTSxJQUFJLEdBQUcsT0FBTyxDQUFDO0FBRXJCOzs7R0FHRztBQUNILE1BQU0sa0JBQWtCO0lBQ2YsU0FBUyxDQUFxRDtJQUM5RCxlQUFlLENBQU87SUFDdEIsTUFBTSxDQUFTO0lBQ2YsU0FBUyxDQUFVO0lBQ25CLFVBQVUsQ0FBVTtJQUNwQixlQUFlLENBQWtCO0lBQ2hDLGFBQWEsQ0FBUztJQUU5QjtRQUNFLElBQUksQ0FBQyxNQUFNLEdBQUcsRUFBRSxDQUFDO1FBQ2pCLElBQUksQ0FBQyxhQUFhLEdBQUcsRUFBRSxDQUFDO1FBQ3hCLElBQUksQ0FBQyxTQUFTLEdBQUcsS0FBSyxDQUFDO1FBQ3ZCLElBQUksQ0FBQyxVQUFVLEdBQUcsS0FBSyxDQUFDO1FBQ3hCLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDLHVCQUF1QixDQUFDO1FBQzlDLElBQUksQ0FBQyxlQUFlLEdBQUcsSUFBSSxlQUFlLEVBQUUsQ0FBQztJQUMvQyxDQUFDO0lBRUQsbUJBQW1CLENBQUMsSUFBWSxFQUFFLE9BQWdCO1FBQ2hELFNBQVM7UUFDVCxNQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDdEQsSUFBSSxDQUFDLGFBQWEsR0FBRyxJQUFJLENBQUM7UUFDMUIsUUFBUTtRQUNSLGFBQWE7UUFDYixJQUFJLGFBQWEsR0FBRyxtRUFBYyxDQUFDLE9BQU8sRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQztRQUUxRixNQUFNLGNBQWMsR0FBRyxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFD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QztnQkFDekQscUVBQVksQ0FBQyxhQUFhLEdBQUcscUJBQXFCLENBQUM7Z0JBQ25ELDBFQUFxQixFQUFFLENBQUM7WUFDMUIsQ0FBQztRQUNILENBQUM7YUFBTSxDQUFDO1lBQ04sNERBQVcsQ0FBQyxJQUFJLENBQUMsdUJBQXVCLENBQUMsQ0FBQztZQUMxQyxNQUFNLFFBQVEsR0FBRyxNQUFNLDhFQUFpQixDQUFDLElBQUksRUFBRSxhQUFhLENBQUMsTUFBTSxFQUFFLGVBQWUsQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUM3RixNQUFNLEdBQUcsTUFBTSxjQUFjLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDMUMsQ0FBQztJQUNILENBQUM7SUFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO1FBQ2YsNkJBQTZCO1FBQzdCLElBQUksb0JBQW9CLEVBQUUsQ0FBQztZQUN6QixvQkFBb0IsQ0FBQyxxQkFBcUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNwRCxDQUFDO1FBQ0QscURBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNqQixNQUFNLEtBQUssQ0FBQztJQUNkLENBQUM7WUFBUyxDQUFDO1FBQ1QsMkVBQWlCLEVBQUUsQ0FBQztRQUNwQixNQUFNLCtFQUFxQixDQUFDLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQztJQUM3QyxDQUFDO0lBQ0QsT0FBTyxNQUFNLENBQUM7QUFDaEIsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9mdW5jdGlvbi9nZW5lcmF0ZS9yZXNwb25zZUdlbmVyYXRvci50cz83NzBlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIGNsZWFuVXBNZXNzYWdlLFxuICBjb3VudE9jY3VycmVuY2VzLFxuICBkZWFjdGl2YXRlU2VuZEJ1dHRvbnMsXG4gIGV2ZW50U291cmNlLFxuICBpc09kZCxcbiAgc2F2ZUNoYXRDb25kaXRpb25hbCxcbiAgc2F2ZVNldHRpbmdzRGVib3VuY2VkLFxufSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0JztcbmltcG9ydCB7IHQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9pMThuJztcbmltcG9ydCB7IG9haV9zZXR0aW5ncywgc2VuZE9wZW5BSVJlcXVlc3QgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9vcGVuYWknO1xuaW1wb3J0IHsgcG93ZXJfdXNlciB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3Bvd2VyLXVzZXInO1xuaW1wb3J0IHsgU3RvcHdhdGNoIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvdXRpbHMnO1xuXG5pbXBvcnQgbG9nIGZyb20gJ2xvZ2xldmVsJztcbi8vIEB0cy1pZ25vcmVcbmRlY2xhcmUgY29uc3QgdG9hc3RyOiBhbnk7XG5cbmltcG9ydCB7IGNsZWFySW5qZWN0aW9uUHJvbXB0cywgZXh0cmFjdE1lc3NhZ2VGcm9tRGF0YSwgc2V0dXBJbWFnZUFycmF5UHJvY2Vzc2luZywgdW5ibG9ja0dlbmVyYXRpb24gfSBmcm9tICdAL2Z1bmN0aW9uL2dlbmVyYXRlL3V0aWxzJztcblxuY29uc3QgdHlwZSA9ICdxdWlldCc7XG5cbi8qKlxuICog5rWB5byP5aSE55CG5Zmo57G7XG4gKiDlpITnkIbmtYHlvI/nlJ/miJDnmoTlk43lupTmlbDmja5cbiAqL1xuY2xhc3MgU3RyZWFtaW5nUHJvY2Vzc29yIHtcbiAgcHVibGljIGdlbmVyYXRvcjogKCkgPT4gQXN5bmNHZW5lcmF0b3I8eyB0ZXh0OiBzdHJpbmcgfSwgdm9pZCwgdm9pZD47XG4gIHB1YmxpYyBzdG9wcGluZ1N0cmluZ3M/OiBhbnk7XG4gIHB1YmxpYyByZXN1bHQ6IHN0cmluZztcbiAgcHVibGljIGlzU3RvcHBlZDogYm9vbGVhbjtcbiAgcHVibGljIGlzRmluaXNoZWQ6IGJvb2xlYW47XG4gIHB1YmxpYyBhYm9ydENvbnRyb2xsZXI6IEFib3J0Q29udHJvbGxlcjtcbiAgcHJpdmF0ZSBtZXNzYWdlQnVmZmVyOiBzdHJpbmc7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5yZXN1bHQgPSAnJztcbiAgICB0aGlzLm1lc3NhZ2VCdWZmZXIgPSAnJztcbiAgICB0aGlzLmlzU3RvcHBlZCA9IGZhbHNlO1xuICAgIHRoaXMuaXNGaW5pc2hlZCA9IGZhbHNlO1xuICAgIHRoaXMuZ2VuZXJhdG9yID0gdGhpcy5udWxsU3RyZWFtaW5nR2VuZXJhdGlvbjtcbiAgICB0aGlzLmFib3J0Q29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcbiAgfVxuXG4gIG9uUHJvZ3Jlc3NTdHJlYW1pbmcodGV4dDogc3RyaW5nLCBpc0ZpbmFsOiBib29sZWFuKSB7XG4gICAgLy8g6K6h566X5aKe6YeP5paH5pysXG4gICAgY29uc3QgbmV3VGV4dCA9IHRleHQuc2xpY2UodGhpcy5tZXNzYWdlQnVmZmVyLmxlbmd0aCk7XG4gICAgdGhpcy5tZXNzYWdlQnVmZmVyID0gdGV4dDtcbiAgICAvLyDlhbzlrrnml6fniYjmnKxcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgbGV0IHByb2Nlc3NlZFRleHQgPSBjbGVhblVwTWVzc2FnZShuZXdUZXh0LCBmYWxzZSwgZmFsc2UsICFpc0ZpbmFsLCB0aGlzLnN0b3BwaW5nU3RyaW5ncyk7XG5cbiAgICBjb25zdCBjaGFyc1RvQmFsYW5jZSA9IFsnKicsICdcIicsICdgYGAnXTtcbiAgICBmb3IgKGNvbnN0IGNoYXIgb2YgY2hhcnNUb0JhbGFuY2UpIHtcbiAgICAgIGlmICghaXNGaW5hbCAmJiBpc09kZChjb3VudE9jY3VycmVuY2VzKHByb2Nlc3NlZFRleHQsIGNoYXIpKSkge1xuICAgICAgICBjb25zdCBzZXBhcmF0b3IgPSBjaGFyLmxlbmd0aCA+IDEgPyAnXFxuJyA6ICcnO1xuICAgICAgICBwcm9jZXNzZWRUZXh0ID0gcHJvY2Vzc2VkVGV4dC50cmltRW5kKCkgKyBzZXBhcmF0b3IgKyBjaGFyO1xuICAgICAgfVxuICAgIH1cblxuICAgIGV2ZW50U291cmNlLmVtaXQoJ2pzX3N0cmVhbV90b2tlbl9yZWNlaXZlZF9mdWxseScsIHRleHQpO1xuICAgIGV2ZW50U291cmNlLmVtaXQoJ2pzX3N0cmVhbV90b2tlbl9yZWNlaXZlZF9pbmNyZW1lbnRhbGx5JywgcHJvY2Vzc2VkVGV4dCk7XG5cbiAgICBpZiAoaXNGaW5hbCkge1xuICAgICAgLy8g5YW85a655pen54mI5pysXG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICBjb25zdCBmdWxsVGV4dCA9IGNsZWFuVXBNZXNzYWdlKHRleHQsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIHRoaXMuc3RvcHBpbmdTdHJpbmdzKTtcbiAgICAgIGV2ZW50U291cmNlLmVtaXQoJ2pzX2dlbmVyYXRpb25fZW5kZWQnLCBmdWxsVGV4dCk7XG4gICAgfVxuICB9XG5cbiAgb25FcnJvclN0cmVhbWluZygpIHtcbiAgICBpZiAodGhpcy5hYm9ydENvbnRyb2xsZXIpIHtcbiAgICAgIHRoaXMuYWJvcnRDb250cm9sbGVyLmFib3J0KCk7XG4gICAgfVxuICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICB1bmJsb2NrR2VuZXJhdGlvbigpO1xuICAgIHNhdmVDaGF0Q29uZGl0aW9uYWwoKTtcbiAgfVxuXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZXF1aXJlLXlpZWxkXG4gIGFzeW5jICpudWxsU3RyZWFtaW5nR2VuZXJhdGlvbigpOiBBc3luY0dlbmVyYXRvcjx7IHRleHQ6IHN0cmluZyB9LCB2b2lkLCB2b2lkPiB7XG4gICAgdGhyb3cgRXJyb3IoJ0dlbmVyYXRpb24gZnVuY3Rpb24gZm9yIHN0cmVhbWluZyBpcyBub3QgaG9va2VkIHVwJyk7XG4gIH1cblxuICBhc3luYyBnZW5lcmF0ZSgpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc3cgPSBuZXcgU3RvcHdhdGNoKDEwMDAgLyBwb3dlcl91c2VyLnN0cmVhbWluZ19mcHMpO1xuICAgICAgY29uc3QgdGltZXN0YW1wcyA9IFtdO1xuXG4gICAgICBmb3IgYXdhaXQgKGNvbnN0IHsgdGV4dCB9IG9mIHRoaXMuZ2VuZXJhdG9yKCkpIHtcbiAgICAgICAgdGltZXN0YW1wcy5wdXNoKERhdGUubm93KCkpO1xuICAgICAgICBpZiAodGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgICB0aGlzLm1lc3NhZ2VCdWZmZXIgPSAnJztcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnJlc3VsdCA9IHRleHQ7XG4gICAgICAgIGF3YWl0IHN3LnRpY2soKCkgPT4gdGhpcy5vblByb2dyZXNzU3RyZWFtaW5nKHRleHQsIGZhbHNlKSk7XG4gICAgICB9XG5cbiAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgdGhpcy5vblByb2dyZXNzU3RyZWFtaW5nKHRoaXMucmVzdWx0LCB0cnVlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMubWVzc2FnZUJ1ZmZlciA9ICcnO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBzZWNvbmRzID0gKHRpbWVzdGFtcHNbdGltZXN0YW1wcy5sZW5ndGggLSAxXSAtIHRpbWVzdGFtcHNbMF0pIC8gMTAwMDtcbiAgICAgIGxvZy53YXJuKFxuICAgICAgICBgU3RyZWFtIHN0YXRzOiAke3RpbWVzdGFtcHMubGVuZ3RofSB0b2tlbnMsICR7c2Vjb25kcy50b0ZpeGVkKDIpfSBzZWNvbmRzLCByYXRlOiAke051bWJlcihcbiAgICAgICAgICB0aW1lc3RhbXBzLmxlbmd0aCAvIHNlY29uZHMsXG4gICAgICAgICkudG9GaXhlZCgyKX0gVFBTYCxcbiAgICAgICk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBpZiAoIXRoaXMuaXNGaW5pc2hlZCkge1xuICAgICAgICB0aGlzLm9uRXJyb3JTdHJlYW1pbmcoKTtcbiAgICAgICAgdGhyb3cgRXJyb3IoYEdlbmVyYXRlIG1ldGhvZCBlcnJvcjogJHtlcnJ9YCk7XG4gICAgICB9XG4gICAgICB0aGlzLm1lc3NhZ2VCdWZmZXIgPSAnJztcbiAgICAgIHJldHVybiB0aGlzLnJlc3VsdDtcbiAgICB9XG5cbiAgICB0aGlzLmlzRmluaXNoZWQgPSB0cnVlO1xuICAgIHJldHVybiB0aGlzLnJlc3VsdDtcbiAgfVxufVxuXG4vKipcbiAqIOWkhOeQhumdnua1geW8j+WTjeW6lFxuICogQHBhcmFtIHJlc3BvbnNlIEFQSeWTjeW6lOWvueixoVxuICogQHJldHVybnMg5o+Q5Y+W55qE5raI5oGv5paH5pysXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZVJlc3BvbnNlKHJlc3BvbnNlOiBhbnkpIHtcbiAgaWYgKCFyZXNwb25zZSkge1xuICAgIHRocm93IEVycm9yKGDmnKrlvpfliLDlk43lupRgKTtcbiAgfVxuICBpZiAocmVzcG9uc2UuZXJyb3IpIHtcbiAgICBpZiAocmVzcG9uc2U/LnJlc3BvbnNlKSB7XG4gICAgICB0b2FzdHIuZXJyb3IocmVzcG9uc2UucmVzcG9uc2UsIHRgQVBJIEVycm9yYCwge1xuICAgICAgICBwcmV2ZW50RHVwbGljYXRlczogdHJ1ZSxcbiAgICAgIH0pO1xuICAgIH1cbiAgICB0aHJvdyBFcnJvcihyZXNwb25zZT8ucmVzcG9uc2UpO1xuICB9XG4gIGNvbnN0IG1lc3NhZ2U6IHN0cmluZyA9IGV4dHJhY3RNZXNzYWdlRnJvbURhdGEocmVzcG9uc2UpO1xuICBldmVudFNvdXJjZS5lbWl0KCdqc19nZW5lcmF0aW9uX2VuZGVkJywgbWVzc2FnZSk7XG4gIHJldHVybiBtZXNzYWdlO1xufVxuXG4vKipcbiAqIOeUn+aIkOWTjeW6lFxuICogQHBhcmFtIGdlbmVyYXRlX2RhdGEg55Sf5oiQ5pWw5o2uXG4gKiBAcGFyYW0gdXNlU3RyZWFtIOaYr+WQpuS9v+eUqOa1geW8j+S8oOi+k1xuICogQHBhcmFtIGltYWdlUHJvY2Vzc2luZ1NldHVwIOWbvueJh+aVsOe7hOWkhOeQhuiuvue9ru+8jOWMheWQq1Byb21pc2Xlkozop6PmnpDlmahcbiAqIEBwYXJhbSBhYm9ydENvbnRyb2xsZXIg5Lit5q2i5o6n5Yi25ZmoXG4gKiBAcmV0dXJucyDnlJ/miJDnmoTlk43lupTmlofmnKxcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlUmVzcG9uc2UoXG4gIGdlbmVyYXRlX2RhdGE6IGFueSxcbiAgdXNlU3RyZWFtID0gZmFsc2UsXG4gIGltYWdlUHJvY2Vzc2luZ1NldHVwOiBSZXR1cm5UeXBlPHR5cGVvZiBzZXR1cEltYWdlQXJyYXlQcm9jZXNzaW5nPiB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZCxcbiAgYWJvcnRDb250cm9sbGVyOiBBYm9ydENvbnRyb2xsZXIsXG4pOiBQcm9taXNlPHN0cmluZz4ge1xuICBsZXQgcmVzdWx0ID0gJyc7XG4gIHRyeSB7XG4gICAgZGVhY3RpdmF0ZVNlbmRCdXR0b25zKCk7XG5cbiAgICAvLyDlpoLmnpzmnInlm77niYflpITnkIbvvIznrYnlvoXlm77niYflpITnkIblrozmiJBcbiAgICBpZiAoaW1hZ2VQcm9jZXNzaW5nU2V0dXApIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IGltYWdlUHJvY2Vzc2luZ1NldHVwLmltYWdlUHJvY2Vzc2luZ1Byb21pc2U7XG4gICAgICAgIGxvZy5kZWJ1ZygnW0dlbmVyYXRlOuWbvueJh+aVsOe7hOWkhOeQhl0g5Zu+54mH5aSE55CG5bey5a6M5oiQ77yM57un57ut55Sf5oiQ5rWB56iLJyk7XG4gICAgICB9IGNhdGNoIChpbWFnZUVycm9yOiBhbnkpIHtcbiAgICAgICAgbG9nLmVycm9yKCdbR2VuZXJhdGU65Zu+54mH5pWw57uE5aSE55CGXSDlm77niYflpITnkIblpLHotKU6JywgaW1hZ2VFcnJvcik7XG4gICAgICAgIC8vIOWbvueJh+WkhOeQhuWksei0peS4jeW6lOivpemYu+atouaVtOS4queUn+aIkOa1geeoi++8jOS9humcgOimgeiusOW9lemUmeivr1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYOWbvueJh+WkhOeQhuWksei0pTogJHtpbWFnZUVycm9yPy5tZXNzYWdlIHx8ICfmnKrnn6XplJnor68nfWApO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh1c2VTdHJlYW0pIHtcbiAgICAgIGNvbnN0IG9yaWdpbmFsU3RyZWFtU2V0dGluZyA9IG9haV9zZXR0aW5ncy5zdHJlYW1fb3BlbmFpO1xuICAgICAgaWYgKCFvcmlnaW5hbFN0cmVhbVNldHRpbmcpIHtcbiAgICAgICAgb2FpX3NldHRpbmdzLnN0cmVhbV9vcGVuYWkgPSB0cnVlO1xuICAgICAgICBzYXZlU2V0dGluZ3NEZWJvdW5jZWQoKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHN0cmVhbWluZ1Byb2Nlc3NvciA9IG5ldyBTdHJlYW1pbmdQcm9jZXNzb3IoKTtcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgIHN0cmVhbWluZ1Byb2Nlc3Nvci5nZW5lcmF0b3IgPSBhd2FpdCBzZW5kT3BlbkFJUmVxdWVzdCgnbm9ybWFsJywgZ2VuZXJhdGVfZGF0YS5wcm9tcHQsIGFib3J0Q29udHJvbGxlci5zaWduYWwpO1xuICAgICAgcmVzdWx0ID0gKGF3YWl0IHN0cmVhbWluZ1Byb2Nlc3Nvci5nZW5lcmF0ZSgpKSBhcyBzdHJpbmc7XG4gICAgICBpZiAob3JpZ2luYWxTdHJlYW1TZXR0aW5nICE9PSBvYWlfc2V0dGluZ3Muc3RyZWFtX29wZW5haSkge1xuICAgICAgICBvYWlfc2V0dGluZ3Muc3RyZWFtX29wZW5haSA9IG9yaWdpbmFsU3RyZWFtU2V0dGluZztcbiAgICAgICAgc2F2ZVNldHRpbmdzRGVib3VuY2VkKCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGV2ZW50U291cmNlLmVtaXQoJ2pzX2dlbmVyYXRpb25fc3RhcnRlZCcpO1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBzZW5kT3BlbkFJUmVxdWVzdCh0eXBlLCBnZW5lcmF0ZV9kYXRhLnByb21wdCwgYWJvcnRDb250cm9sbGVyLnNpZ25hbCk7XG4gICAgICByZXN1bHQgPSBhd2FpdCBoYW5kbGVSZXNwb25zZShyZXNwb25zZSk7XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIC8vIOWmguaenOacieWbvueJh+WkhOeQhuiuvue9ruS9hueUn+aIkOWksei0pe+8jOehruS/neaLkue7nVByb21pc2VcbiAgICBpZiAoaW1hZ2VQcm9jZXNzaW5nU2V0dXApIHtcbiAgICAgIGltYWdlUHJvY2Vzc2luZ1NldHVwLnJlamVjdEltYWdlUHJvY2Vzc2luZyhlcnJvcik7XG4gICAgfVxuICAgIGxvZy5lcnJvcihlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH0gZmluYWxseSB7XG4gICAgdW5ibG9ja0dlbmVyYXRpb24oKTtcbiAgICBhd2FpdCBjbGVhckluamVjdGlvblByb21wdHMoWydJTkpFQ1RJT04nXSk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/function/generate/responseGenerator.ts\n\n}")},"./src/function/generate/types.ts":
/*!****************************************!*\
  !*** ./src/function/generate/types.ts ***!
  \****************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   builtin_prompt_default_order: () => (/* binding */ builtin_prompt_default_order),\n/* harmony export */   character_names_behavior: () => (/* binding */ character_names_behavior),\n/* harmony export */   default_order: () => (/* binding */ default_order),\n/* harmony export */   extension_prompt_roles: () => (/* binding */ extension_prompt_roles),\n/* harmony export */   roleTypes: () => (/* binding */ roleTypes)\n/* harmony export */ });\n/**\n * 角色类型（复制自@sillytavern/script以避免依赖）\n */\nconst extension_prompt_roles = {\n    SYSTEM: 0,\n    USER: 1,\n    ASSISTANT: 2,\n};\n/**\n * 默认内置提示词顺序\n */\nconst builtin_prompt_default_order = [\n    'world_info_before',\n    'persona_description',\n    'char_description',\n    'char_personality',\n    'scenario',\n    'world_info_after',\n    'dialogue_examples',\n    'chat_history',\n    'user_input',\n];\n/**\n * 角色类型映射\n */\nconst roleTypes = {\n    system: extension_prompt_roles.SYSTEM,\n    user: extension_prompt_roles.USER,\n    assistant: extension_prompt_roles.ASSISTANT,\n};\n/**\n * 默认提示词顺序\n */\nconst default_order = [\n    'world_info_before',\n    'persona_description',\n    'char_description',\n    'char_personality',\n    'scenario',\n    'world_info_after',\n    'dialogue_examples',\n    'chat_history',\n    'user_input',\n];\n/**\n * 角色名称行为常量\n */\nconst character_names_behavior = {\n    NONE: -1,\n    DEFAULT: 0,\n    COMPLETION: 1,\n    CONTENT: 2,\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZnVuY3Rpb24vZ2VuZXJhdGUvdHlwZXMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQTs7R0FFRztBQUNJLE1BQU0sc0JBQXNCLEdBQUc7SUFDcEMsTUFBTSxFQUFFLENBQUM7SUFDVCxJQUFJLEVBQUUsQ0FBQztJQUNQLFNBQVMsRUFBRSxDQUFDO0NBQ0osQ0FBQztBQTBGWDs7R0FFRztBQUNJLE1BQU0sNEJBQTRCLEdBQW9CO0lBQzNELG1CQUFtQjtJQUNuQixxQkFBcUI7SUFDckIsa0JBQWtCO0lBQ2xCLGtCQUFrQjtJQUNsQixVQUFVO0lBQ1Ysa0JBQWtCO0lBQ2xCLG1CQUFtQjtJQUNuQixjQUFjO0lBQ2QsWUFBWTtDQUNiLENBQUM7QUE2RUY7O0dBRUc7QUFDSSxNQUFNLFNBQVMsR0FHbEI7SUFDRixNQUFNLEVBQUUsc0JBQXNCLENBQUMsTUFBTTtJQUNyQyxJQUFJLEVBQUUsc0JBQXNCLENBQUMsSUFBSTtJQUNqQyxTQUFTLEVBQUUsc0JBQXNCLENBQUMsU0FBUztDQUM1QyxDQUFDO0FBRUY7O0dBRUc7QUFDSSxNQUFNLGFBQWEsR0FBZ0M7SUFDeEQsbUJBQW1CO0lBQ25CLHFCQUFxQjtJQUNyQixrQkFBa0I7SUFDbEIsa0JBQWtCO0lBQ2xCLFVBQVU7SUFDVixrQkFBa0I7SUFDbEIsbUJBQW1CO0lBQ25CLGNBQWM7SUFDZCxZQUFZO0NBQ2IsQ0FBQztBQUVGOztHQUVHO0FBQ0ksTUFBTSx3QkFBd0IsR0FBRztJQUN0QyxJQUFJLEVBQUUsQ0FBQyxDQUFDO0lBQ1IsT0FBTyxFQUFFLENBQUM7SUFDVixVQUFVLEVBQUUsQ0FBQztJQUNiLE9BQU8sRUFBRSxDQUFDO0NBQ1gsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9mdW5jdGlvbi9nZW5lcmF0ZS90eXBlcy50cz9lOTBmIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICog6KeS6Imy57G75Z6L77yI5aSN5Yi26IeqQHNpbGx5dGF2ZXJuL3NjcmlwdOS7pemBv+WFjeS+nei1lu+8iVxuICovXG5leHBvcnQgY29uc3QgZXh0ZW5zaW9uX3Byb21wdF9yb2xlcyA9IHtcbiAgU1lTVEVNOiAwLFxuICBVU0VSOiAxLFxuICBBU1NJU1RBTlQ6IDIsXG59IGFzIGNvbnN0O1xuXG4vKipcbiAqIOeUn+aIkOmFjee9ruaOpeWPo++8iOS9v+eUqOmihOiuvu+8iVxuICovXG5leHBvcnQgdHlwZSBHZW5lcmF0ZUNvbmZpZyA9IHtcbiAgdXNlcl9pbnB1dD86IHN0cmluZztcbiAgaW1hZ2U/OiBGaWxlIHwgc3RyaW5nIHwgKEZpbGUgfCBzdHJpbmcpW107XG4gIHNob3VsZF9zdHJlYW0/OiBib29sZWFuO1xuICBvdmVycmlkZXM/OiBPdmVycmlkZXM7XG4gIGluamVjdHM/OiBJbmplY3Rpb25Qcm9tcHRbXTtcbiAgbWF4X2NoYXRfaGlzdG9yeT86ICdhbGwnIHwgbnVtYmVyO1xufTtcblxuLyoqXG4gKiDljp/lp4vnlJ/miJDphY3nva7mjqXlj6PvvIjkuI3kvb/nlKjpooTorr7vvIlcbiAqL1xuZXhwb3J0IHR5cGUgR2VuZXJhdGVSYXdDb25maWcgPSB7XG4gIHVzZXJfaW5wdXQ/OiBzdHJpbmc7XG4gIGltYWdlPzogRmlsZSB8IHN0cmluZyB8IChGaWxlIHwgc3RyaW5nKVtdO1xuICBzaG91bGRfc3RyZWFtPzogYm9vbGVhbjtcbiAgb3ZlcnJpZGVzPzogT3ZlcnJpZGVzO1xuICBpbmplY3RzPzogSW5qZWN0aW9uUmF3UHJvbXB0W107XG4gIG9yZGVyZWRfcHJvbXB0cz86IChCdWlsdGluUHJvbXB0IHwgUm9sZVByb21wdClbXTtcbiAgbWF4X2NoYXRfaGlzdG9yeT86ICdhbGwnIHwgbnVtYmVyO1xufTtcblxuLyoqXG4gKiDop5LoibLmj5DnpLror43mjqXlj6NcbiAqL1xuZXhwb3J0IHR5cGUgUm9sZVByb21wdCA9IHtcbiAgcm9sZTogJ3N5c3RlbScgfCAnYXNzaXN0YW50JyB8ICd1c2VyJztcbiAgY29udGVudDogc3RyaW5nO1xuICBpbWFnZT86IEZpbGUgfCBzdHJpbmcgfCAoRmlsZSB8IHN0cmluZylbXTtcbn07XG5cbi8qKlxuICog5rOo5YWl5o+Q56S66K+N5o6l5Y+jXG4gKi9cbmV4cG9ydCB0eXBlIEluamVjdGlvblByb21wdCA9IHtcbiAgcm9sZTogJ3N5c3RlbScgfCAnYXNzaXN0YW50JyB8ICd1c2VyJztcbiAgY29udGVudDogc3RyaW5nO1xuICBwb3NpdGlvbjogJ2JlZm9yZV9wcm9tcHQnIHwgJ2luX2NoYXQnIHwgJ2FmdGVyX3Byb21wdCcgfCAnbm9uZSc7XG4gIGRlcHRoOiBudW1iZXI7XG4gIHNob3VsZF9zY2FuOiBib29sZWFuO1xufTtcblxuLyoqXG4gKiDljp/lp4vms6jlhaXmj5DnpLror43mjqXlj6NcbiAqL1xuZXhwb3J0IHR5cGUgSW5qZWN0aW9uUmF3UHJvbXB0ID0ge1xuICByb2xlOiAnc3lzdGVtJyB8ICdhc3Npc3RhbnQnIHwgJ3VzZXInO1xuICBjb250ZW50OiBzdHJpbmc7XG4gIHBvc2l0aW9uOiAnaW5fY2hhdCcgfCAnbm9uZSc7XG4gIGRlcHRoOiBudW1iZXI7XG4gIHNob3VsZF9zY2FuOiBib29sZWFuO1xufTtcblxuLyoqXG4gKiDopobnm5bphY3nva7mjqXlj6NcbiAqL1xuZXhwb3J0IHR5cGUgT3ZlcnJpZGVzID0ge1xuICB3b3JsZF9pbmZvX2JlZm9yZT86IHN0cmluZzsgLy8g5LiW55WM5LmmKOinkuiJsuWumuS5ieWJjSlcbiAgcGVyc29uYV9kZXNjcmlwdGlvbj86IHN0cmluZzsgLy8g55So5oi35o+P6L+wXG4gIGNoYXJfZGVzY3JpcHRpb24/OiBzdHJpbmc7IC8vIOinkuiJsuaPj+i/sFxuICBjaGFyX3BlcnNvbmFsaXR5Pzogc3RyaW5nOyAvLyDop5LoibLmgKfmoLxcbiAgc2NlbmFyaW8/OiBzdHJpbmc7IC8vIOWcuuaZr1xuICB3b3JsZF9pbmZvX2FmdGVyPzogc3RyaW5nOyAvLyDkuJbnlYzkuaYo6KeS6Imy5a6a5LmJ5ZCOKVxuICBkaWFsb2d1ZV9leGFtcGxlcz86IHN0cmluZzsgLy8g5a+56K+d56S65L6LXG4gIGNoYXRfaGlzdG9yeT86IHtcbiAgICB3aXRoX2RlcHRoX2VudHJpZXM/OiBib29sZWFuO1xuICAgIGF1dGhvcl9ub3RlPzogc3RyaW5nO1xuICAgIHByb21wdHM/OiBSb2xlUHJvbXB0W107XG4gIH07XG59O1xuXG4vKipcbiAqIOWGhee9ruaPkOekuuivjeexu+Wei1xuICovXG5leHBvcnQgdHlwZSBCdWlsdGluUHJvbXB0ID1cbiAgfCAnd29ybGRfaW5mb19iZWZvcmUnXG4gIHwgJ3BlcnNvbmFfZGVzY3JpcHRpb24nXG4gIHwgJ2NoYXJfZGVzY3JpcHRpb24nXG4gIHwgJ2NoYXJfcGVyc29uYWxpdHknXG4gIHwgJ3NjZW5hcmlvJ1xuICB8ICd3b3JsZF9pbmZvX2FmdGVyJ1xuICB8ICdkaWFsb2d1ZV9leGFtcGxlcydcbiAgfCAnY2hhdF9oaXN0b3J5J1xuICB8ICd1c2VyX2lucHV0JztcblxuLyoqXG4gKiDpu5jorqTlhoXnva7mj5DnpLror43pobrluo9cbiAqL1xuZXhwb3J0IGNvbnN0IGJ1aWx0aW5fcHJvbXB0X2RlZmF1bHRfb3JkZXI6IEJ1aWx0aW5Qcm9tcHRbXSA9IFtcbiAgJ3dvcmxkX2luZm9fYmVmb3JlJyxcbiAgJ3BlcnNvbmFfZGVzY3JpcHRpb24nLFxuICAnY2hhcl9kZXNjcmlwdGlvbicsXG4gICdjaGFyX3BlcnNvbmFsaXR5JyxcbiAgJ3NjZW5hcmlvJyxcbiAgJ3dvcmxkX2luZm9fYWZ0ZXInLFxuICAnZGlhbG9ndWVfZXhhbXBsZXMnLFxuICAnY2hhdF9oaXN0b3J5JyxcbiAgJ3VzZXJfaW5wdXQnLFxuXTtcblxuLyoqXG4gKiDln7rnoYDmlbDmja7mjqXlj6NcbiAqL1xuZXhwb3J0IHR5cGUgQmFzZURhdGEgPSB7XG4gIGNoYXJhY3RlckluZm86IHtcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgIHBlcnNvbmFsaXR5OiBzdHJpbmc7XG4gICAgcGVyc29uYTogc3RyaW5nO1xuICAgIHNjZW5hcmlvOiBzdHJpbmc7XG4gICAgc3lzdGVtOiBzdHJpbmc7XG4gICAgamFpbGJyZWFrOiBzdHJpbmc7XG4gIH07XG4gIGNoYXRDb250ZXh0OiB7XG4gICAgb2FpTWVzc2FnZXM6IFJvbGVQcm9tcHRbXTtcbiAgICBvYWlNZXNzYWdlRXhhbXBsZXM6IHN0cmluZ1tdO1xuICAgIHByb21wdEJpYXM6IHN0cmluZ1tdO1xuICB9O1xuICB3b3JsZEluZm86IHtcbiAgICB3b3JsZEluZm9BZnRlcjogQXJyYXk8c3RyaW5nPjtcbiAgICB3b3JsZEluZm9CZWZvcmU6IEFycmF5PHN0cmluZz47XG4gICAgd29ybGRJbmZvRGVwdGg6IEFycmF5PHsgZW50cmllczogc3RyaW5nOyBkZXB0aDogbnVtYmVyOyByb2xlOiBudW1iZXIgfT47XG4gICAgd29ybGRJbmZvRXhhbXBsZXM6IEFycmF5PHN0cmluZz47XG4gICAgd29ybGRJbmZvU3RyaW5nOiBBcnJheTxzdHJpbmc+O1xuICB9O1xufTtcblxuLyoqXG4gKiDor6bnu4bphY3nva7lkb3lkI3nqbrpl7RcbiAqL1xuZXhwb3J0IG5hbWVzcGFjZSBkZXRhaWwge1xuICBleHBvcnQgdHlwZSBDdXN0b21Qcm9tcHQgPSB7XG4gICAgcm9sZTogJ3N5c3RlbScgfCAndXNlcicgfCAnYXNzaXN0YW50JztcbiAgICBjb250ZW50OiBzdHJpbmc7XG4gIH07XG5cbiAgLy8g6KaG55uW6YWN572u57G75Z6LXG4gIGV4cG9ydCB0eXBlIE92ZXJyaWRlQ29uZmlnID0ge1xuICAgIHdvcmxkX2luZm9fYmVmb3JlPzogc3RyaW5nOyAvLyDkuJbnlYzkuabvvIjop5LoibLlrprkuYnkuYvliY3nmoTpg6jliIbvvIlcbiAgICBwZXJzb25hX2Rlc2NyaXB0aW9uPzogc3RyaW5nOyAvLyDnlKjmiLfmj4/ov7BcbiAgICBjaGFyX2Rlc2NyaXB0aW9uPzogc3RyaW5nOyAvLyDop5LoibLmj4/ov7BcbiAgICBjaGFyX3BlcnNvbmFsaXR5Pzogc3RyaW5nOyAvLyDop5LoibLpq5jnuqflrprkuYkt5oCn5qC8XG4gICAgc2NlbmFyaW8/OiBzdHJpbmc7IC8vIOWcuuaZr1xuICAgIHdvcmxkX2luZm9fYWZ0ZXI/OiBzdHJpbmc7IC8vIOS4lueVjOS5pu+8iOinkuiJsuWumuS5ieS5i+WQjueahOmDqOWIhu+8iVxuICAgIGRpYWxvZ3VlX2V4YW1wbGVzPzogc3RyaW5nOyAvLyDop5LoibLpq5jnuqflrprkuYkt5a+56K+d56S65L6LXG5cbiAgICB3aXRoX2RlcHRoX2VudHJpZXM/OiBib29sZWFuOyAvLyDkuJbnlYzkuabmt7HluqZcbiAgICBhdXRob3Jfbm90ZT86IHN0cmluZzsgLy8g5L2c6ICF5rOo6YeKXG4gICAgY2hhdF9oaXN0b3J5PzogUm9sZVByb21wdFtdOyAvLyDogYrlpKnljoblj7JcbiAgfTtcblxuICAvLyDlhoXnva7mj5DnpLror43mnaHnm67nsbvlnotcbiAgZXhwb3J0IHR5cGUgQnVpbHRpblByb21wdEVudHJ5ID1cbiAgICB8ICd3b3JsZF9pbmZvX2JlZm9yZScgLy8g5LiW55WM5LmmKOinkuiJsuWumuS5ieWJjSlcbiAgICB8ICdwZXJzb25hX2Rlc2NyaXB0aW9uJyAvLyDnlKjmiLfmj4/ov7BcbiAgICB8ICdjaGFyX2Rlc2NyaXB0aW9uJyAvLyDop5LoibLmj4/ov7BcbiAgICB8ICdjaGFyX3BlcnNvbmFsaXR5JyAvLyDop5LoibLmgKfmoLxcbiAgICB8ICdzY2VuYXJpbycgLy8g5Zy65pmvXG4gICAgfCAnd29ybGRfaW5mb19hZnRlcicgLy8g5LiW55WM5LmmKOinkuiJsuWumuS5ieWQjilcbiAgICB8ICdkaWFsb2d1ZV9leGFtcGxlcycgLy8g5a+56K+d56S65L6LXG4gICAgfCAnY2hhdF9oaXN0b3J5JyAvLyDogYrlpKnljoblj7JcbiAgICB8ICd1c2VyX2lucHV0JzsgLy8g55So5oi36L6T5YWlXG5cbiAgLy8g55Sf5oiQ5Y+C5pWw57G75Z6LXG4gIGV4cG9ydCB0eXBlIEdlbmVyYXRlUGFyYW1zID0ge1xuICAgIHVzZXJfaW5wdXQ/OiBzdHJpbmc7XG4gICAgdXNlX3ByZXNldD86IGJvb2xlYW47XG4gICAgaW1hZ2U/OiBGaWxlIHwgc3RyaW5nIHwgKEZpbGUgfCBzdHJpbmcpW107XG4gICAgc3RyZWFtPzogYm9vbGVhbjtcbiAgICBvdmVycmlkZXM/OiBPdmVycmlkZUNvbmZpZztcbiAgICBtYXhfY2hhdF9oaXN0b3J5PzogbnVtYmVyO1xuICAgIGluamVjdD86IEluamVjdGlvblByb21wdFtdO1xuICAgIG9yZGVyPzogQXJyYXk8QnVpbHRpblByb21wdEVudHJ5IHwgQ3VzdG9tUHJvbXB0PjtcbiAgfTtcbn1cblxuLyoqXG4gKiDop5LoibLnsbvlnovmmKDlsIRcbiAqL1xuZXhwb3J0IGNvbnN0IHJvbGVUeXBlczogUmVjb3JkPFxuICAnc3lzdGVtJyB8ICd1c2VyJyB8ICdhc3Npc3RhbnQnLFxuICAodHlwZW9mIGV4dGVuc2lvbl9wcm9tcHRfcm9sZXMpW2tleW9mIHR5cGVvZiBleHRlbnNpb25fcHJvbXB0X3JvbGVzXVxuPiA9IHtcbiAgc3lzdGVtOiBleHRlbnNpb25fcHJvbXB0X3JvbGVzLlNZU1RFTSxcbiAgdXNlcjogZXh0ZW5zaW9uX3Byb21wdF9yb2xlcy5VU0VSLFxuICBhc3Npc3RhbnQ6IGV4dGVuc2lvbl9wcm9tcHRfcm9sZXMuQVNTSVNUQU5ULFxufTtcblxuLyoqXG4gKiDpu5jorqTmj5DnpLror43pobrluo9cbiAqL1xuZXhwb3J0IGNvbnN0IGRlZmF1bHRfb3JkZXI6IGRldGFpbC5CdWlsdGluUHJvbXB0RW50cnlbXSA9IFtcbiAgJ3dvcmxkX2luZm9fYmVmb3JlJyxcbiAgJ3BlcnNvbmFfZGVzY3JpcHRpb24nLFxuICAnY2hhcl9kZXNjcmlwdGlvbicsXG4gICdjaGFyX3BlcnNvbmFsaXR5JyxcbiAgJ3NjZW5hcmlvJyxcbiAgJ3dvcmxkX2luZm9fYWZ0ZXInLFxuICAnZGlhbG9ndWVfZXhhbXBsZXMnLFxuICAnY2hhdF9oaXN0b3J5JyxcbiAgJ3VzZXJfaW5wdXQnLFxuXTtcblxuLyoqXG4gKiDop5LoibLlkI3np7DooYzkuLrluLjph49cbiAqL1xuZXhwb3J0IGNvbnN0IGNoYXJhY3Rlcl9uYW1lc19iZWhhdmlvciA9IHtcbiAgTk9ORTogLTEsXG4gIERFRkFVTFQ6IDAsXG4gIENPTVBMRVRJT046IDEsXG4gIENPTlRFTlQ6IDIsXG59O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/function/generate/types.ts\n\n}")},"./src/function/generate/utils.ts":
/*!****************************************!*\
  !*** ./src/function/generate/utils.ts ***!
  \****************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addTemporaryUserMessage: () => (/* binding */ addTemporaryUserMessage),\n/* harmony export */   clearInjectionPrompts: () => (/* binding */ clearInjectionPrompts),\n/* harmony export */   convertFileToBase64: () => (/* binding */ convertFileToBase64),\n/* harmony export */   extractMessageFromData: () => (/* binding */ extractMessageFromData),\n/* harmony export */   getPromptRole: () => (/* binding */ getPromptRole),\n/* harmony export */   isPromptFiltered: () => (/* binding */ isPromptFiltered),\n/* harmony export */   parseMesExamples: () => (/* binding */ parseMesExamples),\n/* harmony export */   processImageArrayDirectly: () => (/* binding */ processImageArrayDirectly),\n/* harmony export */   processUserInput: () => (/* binding */ processUserInput),\n/* harmony export */   removeTemporaryUserMessage: () => (/* binding */ removeTemporaryUserMessage),\n/* harmony export */   setupImageArrayProcessing: () => (/* binding */ setupImageArrayProcessing),\n/* harmony export */   unblockGeneration: () => (/* binding */ unblockGeneration)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var _sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/scripts/extensions/regex/engine */ \"@sillytavern/scripts/extensions/regex/engine\");\n/* harmony import */ var _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/scripts/openai */ \"@sillytavern/scripts/openai\");\n/* harmony import */ var _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sillytavern/scripts/power-user */ \"@sillytavern/scripts/power-user\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_6__);\n\n\n\n\n\n\n\n/**\n * 将文件转换为base64\n * @param img 文件或图片url\n * @returns base64字符串\n */\nasync function convertFileToBase64(img) {\n    const isDataUrl = typeof img === 'string' && (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_5__.isDataURL)(img);\n    let processedImg;\n    if (!isDataUrl) {\n        try {\n            if (typeof img === 'string') {\n                const response = await fetch(img, { method: 'GET', cache: 'force-cache' });\n                if (!response.ok)\n                    throw new Error('Failed to fetch image');\n                const blob = await response.blob();\n                processedImg = await (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_5__.getBase64Async)(blob);\n            }\n            else {\n                processedImg = await (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_5__.getBase64Async)(img);\n            }\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_6___default().error('[Generate:图片数组处理] 图片处理失败:', error);\n        }\n    }\n    return processedImg;\n}\n/**\n * 从响应数据中提取消息内容\n * @param data 响应数据\n * @returns 提取的消息字符串\n */\nfunction extractMessageFromData(data) {\n    if (typeof data === 'string') {\n        return data;\n    }\n    return (data?.choices?.[0]?.message?.content ??\n        data?.choices?.[0]?.text ??\n        data?.text ??\n        data?.message?.content?.[0]?.text ??\n        data?.message?.tool_plan ??\n        '');\n}\n/**\n * 处理对话示例格式\n * @param examplesStr 对话示例字符串\n * @returns 处理后的对话示例数组\n */\nfunction parseMesExamples(examplesStr) {\n    if (examplesStr.length === 0 || examplesStr === '<START>') {\n        return [];\n    }\n    if (!examplesStr.startsWith('<START>')) {\n        examplesStr = '<START>\\n' + examplesStr.trim();\n    }\n    const blockHeading = '<START>\\n';\n    const splitExamples = examplesStr\n        .split(/<START>/gi)\n        .slice(1)\n        .map(block => `${blockHeading}${block.trim()}\\n`);\n    return splitExamples;\n}\n/**\n * 用户输入先正则处理\n * @param user_input 用户输入\n * @returns 处理后的用户输入\n */\nfunction processUserInput(user_input) {\n    if (user_input === '') {\n        user_input = _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__.oai_settings.send_if_empty.trim();\n    }\n    return (0,_sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_2__.getRegexedString)(user_input, _sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_2__.regex_placement.USER_INPUT, {\n        isPrompt: true,\n        depth: 0,\n    });\n}\n/**\n * 获取提示词角色类型\n * @param role 角色数字\n * @returns 角色字符串\n */\nfunction getPromptRole(role) {\n    switch (role) {\n        case _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_roles.SYSTEM:\n            return 'system';\n        case _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_roles.USER:\n            return 'user';\n        case _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_roles.ASSISTANT:\n            return 'assistant';\n        default:\n            return 'system';\n    }\n}\n/**\n * 检查提示词是否被过滤\n * @param promptId 提示词ID\n * @param config 配置对象\n * @returns 是否被过滤\n */\nfunction isPromptFiltered(promptId, config) {\n    if (!config.overrides) {\n        return false;\n    }\n    if (promptId === 'with_depth_entries') {\n        return config.overrides.with_depth_entries === false;\n    }\n    // 特殊处理 chat_history\n    if (promptId === 'chat_history') {\n        const prompts = config.overrides.chat_history;\n        return prompts !== undefined && prompts.length === 0;\n    }\n    // 对于普通提示词，只有当它在 overrides 中存在且为空字符串时才被过滤\n    const override = config.overrides[promptId];\n    return override !== undefined && override === '';\n}\n/**\n * 添加临时用户消息\n * @param userContent 用户内容\n */\nfunction addTemporaryUserMessage(userContent) {\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.setExtensionPrompt)('TEMP_USER_MESSAGE', userContent, _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_types.IN_PROMPT, 0, true, 1);\n}\n/**\n * 移除临时用户消息\n */\nfunction removeTemporaryUserMessage() {\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.setExtensionPrompt)('TEMP_USER_MESSAGE', '', _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_types.IN_PROMPT, 0, true, 1);\n}\n/**\n * 解除生成阻塞状态\n */\nfunction unblockGeneration() {\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.activateSendButtons)();\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.showSwipeButtons)();\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.setGenerationProgress)(0);\n    (0,_sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_4__.flushEphemeralStoppingStrings)();\n}\n/**\n * 清理注入提示词\n * @param prefixes 前缀数组\n */\nasync function clearInjectionPrompts(prefixes) {\n    const prompts = (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__.getContext)().extensionPrompts;\n    Object.keys(prompts)\n        .filter(key => prefixes.some(prefix => key.startsWith(prefix)))\n        .forEach(key => delete prompts[key]);\n    await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveChatConditional)();\n}\n/**\n * 直接处理图片数组，转换为prompt格式\n * @param processedUserInput 处理后的用户输入\n * @param image 图片数组参数\n * @returns 包含文本和图片内容的数组格式\n */\nasync function processImageArrayDirectly(processedUserInput, image) {\n    const quality = _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__.oai_settings.inline_image_quality || 'low';\n    const imageContents = await Promise.all(image.map(async (img) => {\n        try {\n            const processedImg = await convertFileToBase64(img);\n            if (!processedImg) {\n                loglevel__WEBPACK_IMPORTED_MODULE_6___default().warn('[Generate:图片数组处理] 图片处理失败，跳过该图片');\n                return null;\n            }\n            return {\n                type: 'image_url',\n                image_url: { url: processedImg, detail: quality },\n            };\n        }\n        catch (imgError) {\n            loglevel__WEBPACK_IMPORTED_MODULE_6___default().error('[Generate:图片数组处理] 单个图片处理失败:', imgError);\n            return null;\n        }\n    }));\n    const validImageContents = imageContents.filter(content => content !== null);\n    const textContent = {\n        type: 'text',\n        text: processedUserInput,\n    };\n    loglevel__WEBPACK_IMPORTED_MODULE_6___default().info('[Generate:图片数组处理] 成功处理', validImageContents.length, '张图片');\n    return [textContent, ...validImageContents];\n}\n/**\n * 设置图片数组处理逻辑（用于事件监听方式）\n * @param processedUserInput 处理后的用户输入\n * @param image 图片数组参数\n * @returns 包含带标识符的用户输入和Promise解析器的对象\n */\nfunction setupImageArrayProcessing(processedUserInput, image) {\n    const imageMarker = `__IMG_ARRAY_MARKER_`;\n    const userInputWithMarker = processedUserInput + imageMarker;\n    let resolveImageProcessing;\n    let rejectImageProcessing;\n    const imageProcessingPromise = new Promise((resolve, reject) => {\n        resolveImageProcessing = resolve;\n        rejectImageProcessing = reject;\n    });\n    let timeoutId = null;\n    let isHandlerRegistered = true;\n    const imageArrayHandler = async (eventData) => {\n        loglevel__WEBPACK_IMPORTED_MODULE_6___default().debug('[Generate:图片数组处理] imageArrayHandler 被调用');\n        try {\n            // 添加超时保护\n            timeoutId = setTimeout(() => {\n                loglevel__WEBPACK_IMPORTED_MODULE_6___default().warn('[Generate:图片数组处理] 图片处理超时');\n                rejectImageProcessing(new Error('图片处理超时'));\n            }, 30000);\n            for (let i = eventData.chat.length - 1; i >= 0; i--) {\n                const message = eventData.chat[i];\n                const contentStr = typeof message.content === 'string' ? message.content : '';\n                if (message.role === 'user' && contentStr.includes(imageMarker)) {\n                    try {\n                        const quality = _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_3__.oai_settings.inline_image_quality || 'low';\n                        const imageContents = await Promise.all(image.map(async (img) => {\n                            try {\n                                const processedImg = await convertFileToBase64(img);\n                                if (!processedImg) {\n                                    loglevel__WEBPACK_IMPORTED_MODULE_6___default().warn('[Generate:图片数组处理] 图片处理失败，跳过该图片');\n                                    return null;\n                                }\n                                return {\n                                    type: 'image_url',\n                                    image_url: { url: processedImg, detail: quality },\n                                };\n                            }\n                            catch (imgError) {\n                                loglevel__WEBPACK_IMPORTED_MODULE_6___default().error('[Generate:图片数组处理] 单个图片处理失败:', imgError);\n                                return null;\n                            }\n                        }));\n                        const validImageContents = imageContents.filter(content => content !== null);\n                        const cleanContent = contentStr.replace(imageMarker, '');\n                        const textContent = {\n                            type: 'text',\n                            text: cleanContent,\n                        };\n                        message.content = [textContent, ...validImageContents];\n                        if (timeoutId) {\n                            clearTimeout(timeoutId);\n                            timeoutId = null;\n                        }\n                        loglevel__WEBPACK_IMPORTED_MODULE_6___default().info('[Generate:图片数组处理] 成功将', validImageContents.length, '张图片插入到用户消息中');\n                        resolveImageProcessing();\n                        return;\n                    }\n                    catch (error) {\n                        if (timeoutId) {\n                            clearTimeout(timeoutId);\n                            timeoutId = null;\n                        }\n                        loglevel__WEBPACK_IMPORTED_MODULE_6___default().error('[Generate:图片数组处理] 处理图片时出错:', error);\n                        rejectImageProcessing(error);\n                        return;\n                    }\n                }\n            }\n            loglevel__WEBPACK_IMPORTED_MODULE_6___default().warn('[Generate:图片数组处理] 未找到包含图片标记的用户消息');\n            resolveImageProcessing();\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_6___default().error('[Generate:图片数组处理] imageArrayHandler 异常:', error);\n            rejectImageProcessing(error);\n        }\n    };\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.once('chat_completion_prompt_ready', imageArrayHandler);\n    const cleanup = () => {\n        if (timeoutId) {\n            clearTimeout(timeoutId);\n            timeoutId = null;\n        }\n        if (isHandlerRegistered) {\n            try {\n                _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.removeListener('chat_completion_prompt_ready', imageArrayHandler);\n                isHandlerRegistered = false;\n                loglevel__WEBPACK_IMPORTED_MODULE_6___default().debug('[Generate:图片数组处理] 已清理事件监听器');\n            }\n            catch (error) {\n                loglevel__WEBPACK_IMPORTED_MODULE_6___default().warn('[Generate:图片数组处理] 清理事件监听器时出错:', error);\n            }\n        }\n    };\n    return {\n        userInputWithMarker,\n        imageProcessingPromise,\n        resolveImageProcessing: resolveImageProcessing,\n        rejectImageProcessing: rejectImageProcessing,\n        cleanup,\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LDhCQUE4QixFQUFFLGlCQUFpQixDQUFDLENBQUM7Z0JBQzlFLG1CQUFtQixHQUFHLEtBQUssQ0FBQztnQkFDNUIscURBQVMsQ0FBQyw0QkFBNEIsQ0FBQyxDQUFDO1lBQzFDLENBQUM7WUFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO2dCQUNmLG9EQUFRLENBQUMsK0JBQStCLEVBQUUsS0FBSyxDQUFDLENBQUM7WUFDbkQsQ0FBQztRQUNILENBQUM7SUFDSCxDQUFDLENBQUM7SUFFRixPQUFPO1FBQ0wsbUJBQW1CO1FBQ25CLHNCQUFzQjtRQUN0QixzQkFBc0IsRUFBRSxzQkFBdUI7UUFDL0MscUJBQXFCLEVBQUUscUJBQXNCO1FBQzdDLE9BQU87S0FDUixDQUFDO0FBQ0osQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9mdW5jdGlvbi9nZW5lcmF0ZS91dGlscy50cz82ZTlkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIGFjdGl2YXRlU2VuZEJ1dHRvbnMsXG4gIGV2ZW50U291cmNlLFxuICBleHRlbnNpb25fcHJvbXB0X3JvbGVzLFxuICBleHRlbnNpb25fcHJvbXB0X3R5cGVzLFxuICBzYXZlQ2hhdENvbmRpdGlvbmFsLFxuICBzZXRFeHRlbnNpb25Qcm9tcHQsXG4gIHNldEdlbmVyYXRpb25Qcm9ncmVzcyxcbiAgc2hvd1N3aXBlQnV0dG9ucyxcbn0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5pbXBvcnQgeyBnZXRDb250ZXh0IH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvZXh0ZW5zaW9ucyc7XG5pbXBvcnQgeyBnZXRSZWdleGVkU3RyaW5nLCByZWdleF9wbGFjZW1lbnQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9leHRlbnNpb25zL3JlZ2V4L2VuZ2luZSc7XG5pbXBvcnQgeyBvYWlfc2V0dGluZ3MgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9vcGVuYWknO1xuaW1wb3J0IHsgZmx1c2hFcGhlbWVyYWxTdG9wcGluZ1N0cmluZ3MgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9wb3dlci11c2VyJztcbmltcG9ydCB7IGdldEJhc2U2NEFzeW5jLCBpc0RhdGFVUkwgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy91dGlscyc7XG5pbXBvcnQgbG9nIGZyb20gJ2xvZ2xldmVsJztcblxuLyoqXG4gKiDlsIbmlofku7bovazmjaLkuLpiYXNlNjRcbiAqIEBwYXJhbSBpbWcg5paH5Lu25oiW5Zu+54mHdXJsXG4gKiBAcmV0dXJucyBiYXNlNjTlrZfnrKbkuLJcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNvbnZlcnRGaWxlVG9CYXNlNjQoaW1nOiBGaWxlIHwgc3RyaW5nKTogUHJvbWlzZTxzdHJpbmcgfCB1bmRlZmluZWQ+IHtcbiAgY29uc3QgaXNEYXRhVXJsID0gdHlwZW9mIGltZyA9PT0gJ3N0cmluZycgJiYgaXNEYXRhVVJMKGltZyk7XG4gIGxldCBwcm9jZXNzZWRJbWc7XG5cbiAgaWYgKCFpc0RhdGFVcmwpIHtcbiAgICB0cnkge1xuICAgICAgaWYgKHR5cGVvZiBpbWcgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goaW1nLCB7IG1ldGhvZDogJ0dFVCcsIGNhY2hlOiAnZm9yY2UtY2FjaGUnIH0pO1xuICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBmZXRjaCBpbWFnZScpO1xuICAgICAgICBjb25zdCBibG9iID0gYXdhaXQgcmVzcG9uc2UuYmxvYigpO1xuICAgICAgICBwcm9jZXNzZWRJbWcgPSBhd2FpdCBnZXRCYXNlNjRBc3luYyhibG9iKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHByb2Nlc3NlZEltZyA9IGF3YWl0IGdldEJhc2U2NEFzeW5jKGltZyk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZy5lcnJvcignW0dlbmVyYXRlOuWbvueJh+aVsOe7hOWkhOeQhl0g5Zu+54mH5aSE55CG5aSx6LSlOicsIGVycm9yKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHByb2Nlc3NlZEltZztcbn1cblxuLyoqXG4gKiDku47lk43lupTmlbDmja7kuK3mj5Dlj5bmtojmga/lhoXlrrlcbiAqIEBwYXJhbSBkYXRhIOWTjeW6lOaVsOaNrlxuICogQHJldHVybnMg5o+Q5Y+W55qE5raI5oGv5a2X56ym5LiyXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBleHRyYWN0TWVzc2FnZUZyb21EYXRhKGRhdGE6IGFueSk6IHN0cmluZyB7XG4gIGlmICh0eXBlb2YgZGF0YSA9PT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gZGF0YTtcbiAgfVxuXG4gIHJldHVybiAoXG4gICAgZGF0YT8uY2hvaWNlcz8uWzBdPy5tZXNzYWdlPy5jb250ZW50ID8/XG4gICAgZGF0YT8uY2hvaWNlcz8uWzBdPy50ZXh0ID8/XG4gICAgZGF0YT8udGV4dCA/P1xuICAgIGRhdGE/Lm1lc3NhZ2U/LmNvbnRlbnQ/LlswXT8udGV4dCA/P1xuICAgIGRhdGE/Lm1lc3NhZ2U/LnRvb2xfcGxhbiA/P1xuICAgICcnXG4gICk7XG59XG5cbi8qKlxuICog5aSE55CG5a+56K+d56S65L6L5qC85byPXG4gKiBAcGFyYW0gZXhhbXBsZXNTdHIg5a+56K+d56S65L6L5a2X56ym5LiyXG4gKiBAcmV0dXJucyDlpITnkIblkI7nmoTlr7nor53npLrkvovmlbDnu4RcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlTWVzRXhhbXBsZXMoZXhhbXBsZXNTdHI6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgaWYgKGV4YW1wbGVzU3RyLmxlbmd0aCA9PT0gMCB8fCBleGFtcGxlc1N0ciA9PT0gJzxTVEFSVD4nKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG5cbiAgaWYgKCFleGFtcGxlc1N0ci5zdGFydHNXaXRoKCc8U1RBUlQ+JykpIHtcbiAgICBleGFtcGxlc1N0ciA9ICc8U1RBUlQ+XFxuJyArIGV4YW1wbGVzU3RyLnRyaW0oKTtcbiAgfVxuICBjb25zdCBibG9ja0hlYWRpbmcgPSAnPFNUQVJUPlxcbic7XG4gIGNvbnN0IHNwbGl0RXhhbXBsZXMgPSBleGFtcGxlc1N0clxuICAgIC5zcGxpdCgvPFNUQVJUPi9naSlcbiAgICAuc2xpY2UoMSlcbiAgICAubWFwKGJsb2NrID0+IGAke2Jsb2NrSGVhZGluZ30ke2Jsb2NrLnRyaW0oKX1cXG5gKTtcblxuICByZXR1cm4gc3BsaXRFeGFtcGxlcztcbn1cblxuLyoqXG4gKiDnlKjmiLfovpPlhaXlhYjmraPliJnlpITnkIZcbiAqIEBwYXJhbSB1c2VyX2lucHV0IOeUqOaIt+i+k+WFpVxuICogQHJldHVybnMg5aSE55CG5ZCO55qE55So5oi36L6T5YWlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwcm9jZXNzVXNlcklucHV0KHVzZXJfaW5wdXQ6IHN0cmluZyk6IHN0cmluZyB7XG4gIGlmICh1c2VyX2lucHV0ID09PSAnJykge1xuICAgIHVzZXJfaW5wdXQgPSBvYWlfc2V0dGluZ3Muc2VuZF9pZl9lbXB0eS50cmltKCk7XG4gIH1cbiAgcmV0dXJuIGdldFJlZ2V4ZWRTdHJpbmcodXNlcl9pbnB1dCwgcmVnZXhfcGxhY2VtZW50LlVTRVJfSU5QVVQsIHtcbiAgICBpc1Byb21wdDogdHJ1ZSxcbiAgICBkZXB0aDogMCxcbiAgfSk7XG59XG5cbi8qKlxuICog6I635Y+W5o+Q56S66K+N6KeS6Imy57G75Z6LXG4gKiBAcGFyYW0gcm9sZSDop5LoibLmlbDlrZdcbiAqIEByZXR1cm5zIOinkuiJsuWtl+espuS4slxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0UHJvbXB0Um9sZShyb2xlOiBudW1iZXIpOiAnc3lzdGVtJyB8ICd1c2VyJyB8ICdhc3Npc3RhbnQnIHtcbiAgc3dpdGNoIChyb2xlKSB7XG4gICAgY2FzZSBleHRlbnNpb25fcHJvbXB0X3JvbGVzLlNZU1RFTTpcbiAgICAgIHJldHVybiAnc3lzdGVtJztcbiAgICBjYXNlIGV4dGVuc2lvbl9wcm9tcHRfcm9sZXMuVVNFUjpcbiAgICAgIHJldHVybiAndXNlcic7XG4gICAgY2FzZSBleHRlbnNpb25fcHJvbXB0X3JvbGVzLkFTU0lTVEFOVDpcbiAgICAgIHJldHVybiAnYXNzaXN0YW50JztcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuICdzeXN0ZW0nO1xuICB9XG59XG5cbi8qKlxuICog5qOA5p+l5o+Q56S66K+N5piv5ZCm6KKr6L+H5rukXG4gKiBAcGFyYW0gcHJvbXB0SWQg5o+Q56S66K+NSURcbiAqIEBwYXJhbSBjb25maWcg6YWN572u5a+56LGhXG4gKiBAcmV0dXJucyDmmK/lkKbooqvov4fmu6RcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzUHJvbXB0RmlsdGVyZWQocHJvbXB0SWQ6IHN0cmluZywgY29uZmlnOiB7IG92ZXJyaWRlcz86IGFueSB9KTogYm9vbGVhbiB7XG4gIGlmICghY29uZmlnLm92ZXJyaWRlcykge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGlmIChwcm9tcHRJZCA9PT0gJ3dpdGhfZGVwdGhfZW50cmllcycpIHtcbiAgICByZXR1cm4gY29uZmlnLm92ZXJyaWRlcy53aXRoX2RlcHRoX2VudHJpZXMgPT09IGZhbHNlO1xuICB9XG5cbiAgLy8g54m55q6K5aSE55CGIGNoYXRfaGlzdG9yeVxuICBpZiAocHJvbXB0SWQgPT09ICdjaGF0X2hpc3RvcnknKSB7XG4gICAgY29uc3QgcHJvbXB0cyA9IGNvbmZpZy5vdmVycmlkZXMuY2hhdF9oaXN0b3J5O1xuICAgIHJldHVybiBwcm9tcHRzICE9PSB1bmRlZmluZWQgJiYgcHJvbXB0cy5sZW5ndGggPT09IDA7XG4gIH1cblxuICAvLyDlr7nkuo7mma7pgJrmj5DnpLror43vvIzlj6rmnInlvZPlroPlnKggb3ZlcnJpZGVzIOS4reWtmOWcqOS4lOS4uuepuuWtl+espuS4suaXtuaJjeiiq+i/h+a7pFxuICBjb25zdCBvdmVycmlkZSA9IGNvbmZpZy5vdmVycmlkZXNbcHJvbXB0SWQgYXMga2V5b2YgYW55XTtcbiAgcmV0dXJuIG92ZXJyaWRlICE9PSB1bmRlZmluZWQgJiYgb3ZlcnJpZGUgPT09ICcnO1xufVxuXG4vKipcbiAqIOa3u+WKoOS4tOaXtueUqOaIt+a2iOaBr1xuICogQHBhcmFtIHVzZXJDb250ZW50IOeUqOaIt+WGheWuuVxuICovXG5leHBvcnQgZnVuY3Rpb24gYWRkVGVtcG9yYXJ5VXNlck1lc3NhZ2UodXNlckNvbnRlbnQ6IHN0cmluZyk6IHZvaWQge1xuICBzZXRFeHRlbnNpb25Qcm9tcHQoJ1RFTVBfVVNFUl9NRVNTQUdFJywgdXNlckNvbnRlbnQsIGV4dGVuc2lvbl9wcm9tcHRfdHlwZXMuSU5fUFJPTVBULCAwLCB0cnVlLCAxKTtcbn1cblxuLyoqXG4gKiDnp7vpmaTkuLTml7bnlKjmiLfmtojmga9cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZVRlbXBvcmFyeVVzZXJNZXNzYWdlKCk6IHZvaWQge1xuICBzZXRFeHRlbnNpb25Qcm9tcHQoJ1RFTVBfVVNFUl9NRVNTQUdFJywgJycsIGV4dGVuc2lvbl9wcm9tcHRfdHlwZXMuSU5fUFJPTVBULCAwLCB0cnVlLCAxKTtcbn1cblxuLyoqXG4gKiDop6PpmaTnlJ/miJDpmLvloZ7nirbmgIFcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVuYmxvY2tHZW5lcmF0aW9uKCk6IHZvaWQge1xuICBhY3RpdmF0ZVNlbmRCdXR0b25zKCk7XG4gIHNob3dTd2lwZUJ1dHRvbnMoKTtcbiAgc2V0R2VuZXJhdGlvblByb2dyZXNzKDApO1xuICBmbHVzaEVwaGVtZXJhbFN0b3BwaW5nU3RyaW5ncygpO1xufVxuXG4vKipcbiAqIOa4heeQhuazqOWFpeaPkOekuuivjVxuICogQHBhcmFtIHByZWZpeGVzIOWJjee8gOaVsOe7hFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2xlYXJJbmplY3Rpb25Qcm9tcHRzKHByZWZpeGVzOiBzdHJpbmdbXSk6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCBwcm9tcHRzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0gZ2V0Q29udGV4dCgpLmV4dGVuc2lvblByb21wdHM7XG4gIE9iamVjdC5rZXlzKHByb21wdHMpXG4gICAgLmZpbHRlcihrZXkgPT4gcHJlZml4ZXMuc29tZShwcmVmaXggPT4ga2V5LnN0YXJ0c1dpdGgocHJlZml4KSkpXG4gICAgLmZvckVhY2goa2V5ID0+IGRlbGV0ZSBwcm9tcHRzW2tleV0pO1xuXG4gIGF3YWl0IHNhdmVDaGF0Q29uZGl0aW9uYWwoKTtcbn1cblxuLyoqXG4gKiDnm7TmjqXlpITnkIblm77niYfmlbDnu4TvvIzovazmjaLkuLpwcm9tcHTmoLzlvI9cbiAqIEBwYXJhbSBwcm9jZXNzZWRVc2VySW5wdXQg5aSE55CG5ZCO55qE55So5oi36L6T5YWlXG4gKiBAcGFyYW0gaW1hZ2Ug5Zu+54mH5pWw57uE5Y+C5pWwXG4gKiBAcmV0dXJucyDljIXlkKvmlofmnKzlkozlm77niYflhoXlrrnnmoTmlbDnu4TmoLzlvI9cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHByb2Nlc3NJbWFnZUFycmF5RGlyZWN0bHkoXG4gIHByb2Nlc3NlZFVzZXJJbnB1dDogc3RyaW5nLFxuICBpbWFnZTogKEZpbGUgfCBzdHJpbmcpW10sXG4pOiBQcm9taXNlPHsgdHlwZTogc3RyaW5nOyB0ZXh0Pzogc3RyaW5nOyBpbWFnZV91cmw/OiB7IHVybDogc3RyaW5nOyBkZXRhaWw6IHN0cmluZyB9IH1bXT4ge1xuICBjb25zdCBxdWFsaXR5ID0gb2FpX3NldHRpbmdzLmlubGluZV9pbWFnZV9xdWFsaXR5IHx8ICdsb3cnO1xuXG4gIGNvbnN0IGltYWdlQ29udGVudHMgPSBhd2FpdCBQcm9taXNlLmFsbChcbiAgICBpbWFnZS5tYXAoYXN5bmMgaW1nID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHByb2Nlc3NlZEltZyA9IGF3YWl0IGNvbnZlcnRGaWxlVG9CYXNlNjQoaW1nKTtcbiAgICAgICAgaWYgKCFwcm9jZXNzZWRJbWcpIHtcbiAgICAgICAgICBsb2cud2FybignW0dlbmVyYXRlOuWbvueJh+aVsOe7hOWkhOeQhl0g5Zu+54mH5aSE55CG5aSx6LSl77yM6Lez6L+H6K+l5Zu+54mHJyk7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0eXBlOiAnaW1hZ2VfdXJsJyxcbiAgICAgICAgICBpbWFnZV91cmw6IHsgdXJsOiBwcm9jZXNzZWRJbWcsIGRldGFpbDogcXVhbGl0eSB9LFxuICAgICAgICB9O1xuICAgICAgfSBjYXRjaCAoaW1nRXJyb3IpIHtcbiAgICAgICAgbG9nLmVycm9yKCdbR2VuZXJhdGU65Zu+54mH5pWw57uE5aSE55CGXSDljZXkuKrlm77niYflpITnkIblpLHotKU6JywgaW1nRXJyb3IpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICB9KSxcbiAgKTtcblxuICBjb25zdCB2YWxpZEltYWdlQ29udGVudHMgPSBpbWFnZUNvbnRlbnRzLmZpbHRlcihjb250ZW50ID0+IGNvbnRlbnQgIT09IG51bGwpO1xuICBjb25zdCB0ZXh0Q29udGVudCA9IHtcbiAgICB0eXBlOiAndGV4dCcsXG4gICAgdGV4dDogcHJvY2Vzc2VkVXNlcklucHV0LFxuICB9O1xuXG4gIGxvZy5pbmZvKCdbR2VuZXJhdGU65Zu+54mH5pWw57uE5aSE55CGXSDmiJDlip/lpITnkIYnLCB2YWxpZEltYWdlQ29udGVudHMubGVuZ3RoLCAn5byg5Zu+54mHJyk7XG4gIHJldHVybiBbdGV4dENvbnRlbnQsIC4uLnZhbGlkSW1hZ2VDb250ZW50c107XG59XG5cbi8qKlxuICog6K6+572u5Zu+54mH5pWw57uE5aSE55CG6YC76L6R77yI55So5LqO5LqL5Lu255uR5ZCs5pa55byP77yJXG4gKiBAcGFyYW0gcHJvY2Vzc2VkVXNlcklucHV0IOWkhOeQhuWQjueahOeUqOaIt+i+k+WFpVxuICogQHBhcmFtIGltYWdlIOWbvueJh+aVsOe7hOWPguaVsFxuICogQHJldHVybnMg5YyF5ZCr5bim5qCH6K+G56ym55qE55So5oi36L6T5YWl5ZKMUHJvbWlzZeino+aekOWZqOeahOWvueixoVxuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0dXBJbWFnZUFycmF5UHJvY2Vzc2luZyhcbiAgcHJvY2Vzc2VkVXNlcklucHV0OiBzdHJpbmcsXG4gIGltYWdlOiAoRmlsZSB8IHN0cmluZylbXSxcbik6IHtcbiAgdXNlcklucHV0V2l0aE1hcmtlcjogc3RyaW5nO1xuICBpbWFnZVByb2Nlc3NpbmdQcm9taXNlOiBQcm9taXNlPHZvaWQ+O1xuICByZXNvbHZlSW1hZ2VQcm9jZXNzaW5nOiAoKSA9PiB2b2lkO1xuICByZWplY3RJbWFnZVByb2Nlc3Npbmc6IChyZWFzb24/OiBhbnkpID0+IHZvaWQ7XG4gIGNsZWFudXA6ICgpID0+IHZvaWQ7XG59IHtcbiAgY29uc3QgaW1hZ2VNYXJrZXIgPSBgX19JTUdfQVJSQVlfTUFSS0VSX2A7XG4gIGNvbnN0IHVzZXJJbnB1dFdpdGhNYXJrZXIgPSBwcm9jZXNzZWRVc2VySW5wdXQgKyBpbWFnZU1hcmtlcjtcblxuICBsZXQgcmVzb2x2ZUltYWdlUHJvY2Vzc2luZzogKCkgPT4gdm9pZDtcbiAgbGV0IHJlamVjdEltYWdlUHJvY2Vzc2luZzogKHJlYXNvbj86IGFueSkgPT4gdm9pZDtcblxuICBjb25zdCBpbWFnZVByb2Nlc3NpbmdQcm9taXNlID0gbmV3IFByb21pc2U8dm9pZD4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIHJlc29sdmVJbWFnZVByb2Nlc3NpbmcgPSByZXNvbHZlO1xuICAgIHJlamVjdEltYWdlUHJvY2Vzc2luZyA9IHJlamVjdDtcbiAgfSk7XG5cbiAgbGV0IHRpbWVvdXRJZDogTm9kZUpTLlRpbWVvdXQgfCBudWxsID0gbnVsbDtcbiAgbGV0IGlzSGFuZGxlclJlZ2lzdGVyZWQgPSB0cnVlO1xuXG4gIGNvbnN0IGltYWdlQXJyYXlIYW5kbGVyID0gYXN5bmMgKGV2ZW50RGF0YTogeyBjaGF0OiB7IHJvbGU6IHN0cmluZzsgY29udGVudDogc3RyaW5nIHwgYW55W10gfVtdIH0pID0+IHtcbiAgICBsb2cuZGVidWcoJ1tHZW5lcmF0ZTrlm77niYfmlbDnu4TlpITnkIZdIGltYWdlQXJyYXlIYW5kbGVyIOiiq+iwg+eUqCcpO1xuXG4gICAgdHJ5IHtcbiAgICAgIC8vIOa3u+WKoOi2heaXtuS/neaKpFxuICAgICAgdGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGxvZy53YXJuKCdbR2VuZXJhdGU65Zu+54mH5pWw57uE5aSE55CGXSDlm77niYflpITnkIbotoXml7YnKTtcbiAgICAgICAgcmVqZWN0SW1hZ2VQcm9jZXNzaW5nKG5ldyBFcnJvcign5Zu+54mH5aSE55CG6LaF5pe2JykpO1xuICAgICAgfSwgMzAwMDApOyBcblxuICAgICAgZm9yIChsZXQgaSA9IGV2ZW50RGF0YS5jaGF0Lmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBldmVudERhdGEuY2hhdFtpXTtcbiAgICAgICAgY29uc3QgY29udGVudFN0ciA9IHR5cGVvZiBtZXNzYWdlLmNvbnRlbnQgPT09ICdzdHJpbmcnID8gbWVzc2FnZS5jb250ZW50IDogJyc7XG5cbiAgICAgICAgaWYgKG1lc3NhZ2Uucm9sZSA9PT0gJ3VzZXInICYmIGNvbnRlbnRTdHIuaW5jbHVkZXMoaW1hZ2VNYXJrZXIpKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHF1YWxpdHkgPSBvYWlfc2V0dGluZ3MuaW5saW5lX2ltYWdlX3F1YWxpdHkgfHwgJ2xvdyc7XG5cbiAgICAgICAgICAgIGNvbnN0IGltYWdlQ29udGVudHMgPSBhd2FpdCBQcm9taXNlLmFsbChcbiAgICAgICAgICAgICAgaW1hZ2UubWFwKGFzeW5jIGltZyA9PiB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgIGNvbnN0IHByb2Nlc3NlZEltZyA9IGF3YWl0IGNvbnZlcnRGaWxlVG9CYXNlNjQoaW1nKTtcbiAgICAgICAgICAgICAgICAgIGlmICghcHJvY2Vzc2VkSW1nKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvZy53YXJuKCdbR2VuZXJhdGU65Zu+54mH5pWw57uE5aSE55CGXSDlm77niYflpITnkIblpLHotKXvvIzot7Pov4for6Xlm77niYcnKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnaW1hZ2VfdXJsJyxcbiAgICAgICAgICAgICAgICAgICAgaW1hZ2VfdXJsOiB7IHVybDogcHJvY2Vzc2VkSW1nLCBkZXRhaWw6IHF1YWxpdHkgfSxcbiAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoaW1nRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgIGxvZy5lcnJvcignW0dlbmVyYXRlOuWbvueJh+aVsOe7hOWkhOeQhl0g5Y2V5Liq5Zu+54mH5aSE55CG5aSx6LSlOicsIGltZ0Vycm9yKTtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBjb25zdCB2YWxpZEltYWdlQ29udGVudHMgPSBpbWFnZUNvbnRlbnRzLmZpbHRlcihjb250ZW50ID0+IGNvbnRlbnQgIT09IG51bGwpO1xuICAgICAgICAgICAgY29uc3QgY2xlYW5Db250ZW50ID0gY29udGVudFN0ci5yZXBsYWNlKGltYWdlTWFya2VyLCAnJyk7XG4gICAgICAgICAgICBjb25zdCB0ZXh0Q29udGVudCA9IHtcbiAgICAgICAgICAgICAgdHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgICB0ZXh0OiBjbGVhbkNvbnRlbnQsXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBtZXNzYWdlLmNvbnRlbnQgPSBbdGV4dENvbnRlbnQsIC4uLnZhbGlkSW1hZ2VDb250ZW50c10gYXMgYW55O1xuXG4gICAgICAgICAgICBpZiAodGltZW91dElkKSB7XG4gICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xuICAgICAgICAgICAgICB0aW1lb3V0SWQgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbG9nLmluZm8oJ1tHZW5lcmF0ZTrlm77niYfmlbDnu4TlpITnkIZdIOaIkOWKn+WwhicsIHZhbGlkSW1hZ2VDb250ZW50cy5sZW5ndGgsICflvKDlm77niYfmj5LlhaXliLDnlKjmiLfmtojmga/kuK0nKTtcbiAgICAgICAgICAgIHJlc29sdmVJbWFnZVByb2Nlc3NpbmcoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgaWYgKHRpbWVvdXRJZCkge1xuICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTtcbiAgICAgICAgICAgICAgdGltZW91dElkID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxvZy5lcnJvcignW0dlbmVyYXRlOuWbvueJh+aVsOe7hOWkhOeQhl0g5aSE55CG5Zu+54mH5pe25Ye66ZSZOicsIGVycm9yKTtcbiAgICAgICAgICAgIHJlamVjdEltYWdlUHJvY2Vzc2luZyhlcnJvcik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGxvZy53YXJuKCdbR2VuZXJhdGU65Zu+54mH5pWw57uE5aSE55CGXSDmnKrmib7liLDljIXlkKvlm77niYfmoIforrDnmoTnlKjmiLfmtojmga8nKTtcbiAgICAgIHJlc29sdmVJbWFnZVByb2Nlc3NpbmcoKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nLmVycm9yKCdbR2VuZXJhdGU65Zu+54mH5pWw57uE5aSE55CGXSBpbWFnZUFycmF5SGFuZGxlciDlvILluLg6JywgZXJyb3IpO1xuICAgICAgcmVqZWN0SW1hZ2VQcm9jZXNzaW5nKGVycm9yKTtcbiAgICB9XG4gIH07XG5cbiAgZXZlbnRTb3VyY2Uub25jZSgnY2hhdF9jb21wbGV0aW9uX3Byb21wdF9yZWFkeScsIGltYWdlQXJyYXlIYW5kbGVyKTtcblxuICBjb25zdCBjbGVhbnVwID0gKCkgPT4ge1xuICAgIGlmICh0aW1lb3V0SWQpIHtcbiAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xuICAgICAgdGltZW91dElkID0gbnVsbDtcbiAgICB9XG4gICAgaWYgKGlzSGFuZGxlclJlZ2lzdGVyZWQpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGV2ZW50U291cmNlLnJlbW92ZUxpc3RlbmVyKCdjaGF0X2NvbXBsZXRpb25fcHJvbXB0X3JlYWR5JywgaW1hZ2VBcnJheUhhbmRsZXIpO1xuICAgICAgICBpc0hhbmRsZXJSZWdpc3RlcmVkID0gZmFsc2U7XG4gICAgICAgIGxvZy5kZWJ1ZygnW0dlbmVyYXRlOuWbvueJh+aVsOe7hOWkhOeQhl0g5bey5riF55CG5LqL5Lu255uR5ZCs5ZmoJyk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBsb2cud2FybignW0dlbmVyYXRlOuWbvueJh+aVsOe7hOWkhOeQhl0g5riF55CG5LqL5Lu255uR5ZCs5Zmo5pe25Ye66ZSZOicsIGVycm9yKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICB1c2VySW5wdXRXaXRoTWFya2VyLFxuICAgIGltYWdlUHJvY2Vzc2luZ1Byb21pc2UsXG4gICAgcmVzb2x2ZUltYWdlUHJvY2Vzc2luZzogcmVzb2x2ZUltYWdlUHJvY2Vzc2luZyEsXG4gICAgcmVqZWN0SW1hZ2VQcm9jZXNzaW5nOiByZWplY3RJbWFnZVByb2Nlc3NpbmchLFxuICAgIGNsZWFudXAsXG4gIH07XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/function/generate/utils.ts\n\n}")},"./src/function/index.ts":
/*!*******************************!*\
  !*** ./src/function/index.ts ***!
  \*******************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   initTavernHelperObject: () => (/* binding */ initTavernHelperObject)\n/* harmony export */ });\n/* harmony import */ var _component_macrolike__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/macrolike */ "./src/component/macrolike.ts");\n/* harmony import */ var _function_builtin__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/function/builtin */ "./src/function/builtin.ts");\n/* harmony import */ var _function_character__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/function/character */ "./src/function/character.ts");\n/* harmony import */ var _function_chat_message__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/function/chat_message */ "./src/function/chat_message.ts");\n/* harmony import */ var _function_displayed_message__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/function/displayed_message */ "./src/function/displayed_message.ts");\n/* harmony import */ var _function_generate__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/function/generate */ "./src/function/generate/index.ts");\n/* harmony import */ var _function_generate_types__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/function/generate/types */ "./src/function/generate/types.ts");\n/* harmony import */ var _function_lorebook__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @/function/lorebook */ "./src/function/lorebook.ts");\n/* harmony import */ var _function_lorebook_entry__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @/function/lorebook_entry */ "./src/function/lorebook_entry.ts");\n/* harmony import */ var _function_preset__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @/function/preset */ "./src/function/preset.ts");\n/* harmony import */ var _function_script_repository__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @/function/script_repository */ "./src/function/script_repository.ts");\n/* harmony import */ var _function_slash__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @/function/slash */ "./src/function/slash.ts");\n/* harmony import */ var _function_tavern_regex__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @/function/tavern_regex */ "./src/function/tavern_regex.ts");\n/* harmony import */ var _function_util__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @/function/util */ "./src/function/util.ts");\n/* harmony import */ var _function_variables__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @/function/variables */ "./src/function/variables.ts");\n/* harmony import */ var _function_version__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @/function/version */ "./src/function/version.ts");\n/* harmony import */ var _function_worldbook__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! @/function/worldbook */ "./src/function/worldbook.ts");\n/* harmony import */ var _slash_command_audio__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! @/slash_command/audio */ "./src/slash_command/audio.ts");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction getTavernHelper() {\n    return {\n        // audio\n        audioEnable: _slash_command_audio__WEBPACK_IMPORTED_MODULE_17__.audioEnable,\n        audioImport: _slash_command_audio__WEBPACK_IMPORTED_MODULE_17__.audioImport,\n        audioMode: _slash_command_audio__WEBPACK_IMPORTED_MODULE_17__.audioMode,\n        audioPlay: _slash_command_audio__WEBPACK_IMPORTED_MODULE_17__.audioPlay,\n        audioSelect: _slash_command_audio__WEBPACK_IMPORTED_MODULE_17__.audioSelect,\n        // builtin\n        builtin: _function_builtin__WEBPACK_IMPORTED_MODULE_1__.builtin,\n        // character\n        Character: _function_character__WEBPACK_IMPORTED_MODULE_2__.Character,\n        getCharData: _function_character__WEBPACK_IMPORTED_MODULE_2__.getCharData,\n        getCharAvatarPath: _function_character__WEBPACK_IMPORTED_MODULE_2__.getCharAvatarPath,\n        getChatHistoryBrief: _function_character__WEBPACK_IMPORTED_MODULE_2__.getChatHistoryBrief,\n        getChatHistoryDetail: _function_character__WEBPACK_IMPORTED_MODULE_2__.getChatHistoryDetail,\n        // chat_message\n        getChatMessages: _function_chat_message__WEBPACK_IMPORTED_MODULE_3__.getChatMessages,\n        setChatMessages: _function_chat_message__WEBPACK_IMPORTED_MODULE_3__.setChatMessages,\n        setChatMessage: _function_chat_message__WEBPACK_IMPORTED_MODULE_3__.setChatMessage,\n        createChatMessages: _function_chat_message__WEBPACK_IMPORTED_MODULE_3__.createChatMessages,\n        deleteChatMessages: _function_chat_message__WEBPACK_IMPORTED_MODULE_3__.deleteChatMessages,\n        rotateChatMessages: _function_chat_message__WEBPACK_IMPORTED_MODULE_3__.rotateChatMessages,\n        // displayed_message\n        formatAsDisplayedMessage: _function_displayed_message__WEBPACK_IMPORTED_MODULE_4__.formatAsDisplayedMessage,\n        retrieveDisplayedMessage: _function_displayed_message__WEBPACK_IMPORTED_MODULE_4__.retrieveDisplayedMessage,\n        // generate\n        builtin_prompt_default_order: _function_generate_types__WEBPACK_IMPORTED_MODULE_6__.builtin_prompt_default_order,\n        generate: _function_generate__WEBPACK_IMPORTED_MODULE_5__.generate,\n        generateRaw: _function_generate__WEBPACK_IMPORTED_MODULE_5__.generateRaw,\n        // lorebook_entry\n        getLorebookEntries: _function_lorebook_entry__WEBPACK_IMPORTED_MODULE_8__.getLorebookEntries,\n        replaceLorebookEntries: _function_lorebook_entry__WEBPACK_IMPORTED_MODULE_8__.replaceLorebookEntries,\n        updateLorebookEntriesWith: _function_lorebook_entry__WEBPACK_IMPORTED_MODULE_8__.updateLorebookEntriesWith,\n        setLorebookEntries: _function_lorebook_entry__WEBPACK_IMPORTED_MODULE_8__.setLorebookEntries,\n        createLorebookEntries: _function_lorebook_entry__WEBPACK_IMPORTED_MODULE_8__.createLorebookEntries,\n        createLorebookEntry: _function_lorebook_entry__WEBPACK_IMPORTED_MODULE_8__.createLorebookEntry,\n        deleteLorebookEntries: _function_lorebook_entry__WEBPACK_IMPORTED_MODULE_8__.deleteLorebookEntries,\n        deleteLorebookEntry: _function_lorebook_entry__WEBPACK_IMPORTED_MODULE_8__.deleteLorebookEntry,\n        // lorebook\n        getLorebookSettings: _function_lorebook__WEBPACK_IMPORTED_MODULE_7__.getLorebookSettings,\n        setLorebookSettings: _function_lorebook__WEBPACK_IMPORTED_MODULE_7__.setLorebookSettings,\n        getCharLorebooks: _function_lorebook__WEBPACK_IMPORTED_MODULE_7__.getCharLorebooks,\n        setCurrentCharLorebooks: _function_lorebook__WEBPACK_IMPORTED_MODULE_7__.setCurrentCharLorebooks,\n        getLorebooks: _function_lorebook__WEBPACK_IMPORTED_MODULE_7__.getLorebooks,\n        deleteLorebook: _function_lorebook__WEBPACK_IMPORTED_MODULE_7__.deleteLorebook,\n        createLorebook: _function_lorebook__WEBPACK_IMPORTED_MODULE_7__.createLorebook,\n        getCurrentCharPrimaryLorebook: _function_lorebook__WEBPACK_IMPORTED_MODULE_7__.getCurrentCharPrimaryLorebook,\n        getChatLorebook: _function_lorebook__WEBPACK_IMPORTED_MODULE_7__.getChatLorebook,\n        setChatLorebook: _function_lorebook__WEBPACK_IMPORTED_MODULE_7__.setChatLorebook,\n        getOrCreateChatLorebook: _function_lorebook__WEBPACK_IMPORTED_MODULE_7__.getOrCreateChatLorebook,\n        // preset\n        isPresetNormalPrompt: _function_preset__WEBPACK_IMPORTED_MODULE_9__.isPresetNormalPrompt,\n        isPresetSystemPrompt: _function_preset__WEBPACK_IMPORTED_MODULE_9__.isPresetSystemPrompt,\n        isPresetPlaceholderPrompt: _function_preset__WEBPACK_IMPORTED_MODULE_9__.isPresetPlaceholderPrompt,\n        default_preset: _function_preset__WEBPACK_IMPORTED_MODULE_9__.default_preset,\n        getPresetNames: _function_preset__WEBPACK_IMPORTED_MODULE_9__.getPresetNames,\n        getLoadedPresetName: _function_preset__WEBPACK_IMPORTED_MODULE_9__.getLoadedPresetName,\n        loadPreset: _function_preset__WEBPACK_IMPORTED_MODULE_9__.loadPreset,\n        createPreset: _function_preset__WEBPACK_IMPORTED_MODULE_9__.createPreset,\n        createOrReplacePreset: _function_preset__WEBPACK_IMPORTED_MODULE_9__.createOrReplacePreset,\n        deletePreset: _function_preset__WEBPACK_IMPORTED_MODULE_9__.deletePreset,\n        renamePreset: _function_preset__WEBPACK_IMPORTED_MODULE_9__.renamePreset,\n        getPreset: _function_preset__WEBPACK_IMPORTED_MODULE_9__.getPreset,\n        replacePreset: _function_preset__WEBPACK_IMPORTED_MODULE_9__.replacePreset,\n        updatePresetWith: _function_preset__WEBPACK_IMPORTED_MODULE_9__.updatePresetWith,\n        setPreset: _function_preset__WEBPACK_IMPORTED_MODULE_9__.setPreset,\n        // macrolike\n        registerMacroLike: _component_macrolike__WEBPACK_IMPORTED_MODULE_0__.registerMacroLike,\n        // slash\n        triggerSlash: _function_slash__WEBPACK_IMPORTED_MODULE_11__.triggerSlash,\n        triggerSlashWithResult: _function_slash__WEBPACK_IMPORTED_MODULE_11__.triggerSlash,\n        // tavern_regex\n        formatAsTavernRegexedString: _function_tavern_regex__WEBPACK_IMPORTED_MODULE_12__.formatAsTavernRegexedString,\n        isCharacterTavernRegexesEnabled: _function_tavern_regex__WEBPACK_IMPORTED_MODULE_12__.isCharacterTavernRegexesEnabled,\n        getTavernRegexes: _function_tavern_regex__WEBPACK_IMPORTED_MODULE_12__.getTavernRegexes,\n        replaceTavernRegexes: _function_tavern_regex__WEBPACK_IMPORTED_MODULE_12__.replaceTavernRegexes,\n        updateTavernRegexesWith: _function_tavern_regex__WEBPACK_IMPORTED_MODULE_12__.updateTavernRegexesWith,\n        // util\n        substitudeMacros: _function_util__WEBPACK_IMPORTED_MODULE_13__.substitudeMacros,\n        getLastMessageId: _function_util__WEBPACK_IMPORTED_MODULE_13__.getLastMessageId,\n        errorCatched: _function_util__WEBPACK_IMPORTED_MODULE_13__.errorCatched,\n        // variables\n        getVariables: _function_variables__WEBPACK_IMPORTED_MODULE_14__.getVariables,\n        replaceVariables: _function_variables__WEBPACK_IMPORTED_MODULE_14__.replaceVariables,\n        updateVariablesWith: _function_variables__WEBPACK_IMPORTED_MODULE_14__.updateVariablesWith,\n        insertOrAssignVariables: _function_variables__WEBPACK_IMPORTED_MODULE_14__.insertOrAssignVariables,\n        deleteVariable: _function_variables__WEBPACK_IMPORTED_MODULE_14__.deleteVariable,\n        insertVariables: _function_variables__WEBPACK_IMPORTED_MODULE_14__.insertVariables,\n        // script_repository\n        getScriptButtons: _function_script_repository__WEBPACK_IMPORTED_MODULE_10__.getScriptButtons,\n        replaceScriptButtons: _function_script_repository__WEBPACK_IMPORTED_MODULE_10__.replaceScriptButtons,\n        appendInexistentScriptButtons: _function_script_repository__WEBPACK_IMPORTED_MODULE_10__.appendInexistentScriptButtons,\n        // version\n        getTavernHelperVersion: _function_version__WEBPACK_IMPORTED_MODULE_15__.getTavernHelperVersion,\n        updateTavernHelper: _function_version__WEBPACK_IMPORTED_MODULE_15__.updateTavernHelper,\n        getFrontendVersion: _function_version__WEBPACK_IMPORTED_MODULE_15__.getTavernHelperVersion,\n        updateFrontendVersion: _function_version__WEBPACK_IMPORTED_MODULE_15__.updateTavernHelper,\n        // worldbook\n        getWorldbookNames: _function_worldbook__WEBPACK_IMPORTED_MODULE_16__.getWorldbookNames,\n        getGlobalWorldbookNames: _function_worldbook__WEBPACK_IMPORTED_MODULE_16__.getGlobalWorldbookNames,\n        rebindGlobalWorldbooks: _function_worldbook__WEBPACK_IMPORTED_MODULE_16__.rebindGlobalWorldbooks,\n        getCharWorldbookNames: _function_worldbook__WEBPACK_IMPORTED_MODULE_16__.getCharWorldbookNames,\n        rebindCharWorldbooks: _function_worldbook__WEBPACK_IMPORTED_MODULE_16__.rebindCharWorldbooks,\n        getChatWorldbookName: _function_worldbook__WEBPACK_IMPORTED_MODULE_16__.getChatWorldbookName,\n        rebindChatWorldbook: _function_worldbook__WEBPACK_IMPORTED_MODULE_16__.rebindChatWorldbook,\n        getOrCreateChatWorldbook: _function_worldbook__WEBPACK_IMPORTED_MODULE_16__.getOrCreateChatWorldbook,\n        createWorldbook: _function_worldbook__WEBPACK_IMPORTED_MODULE_16__.createWorldbook,\n        createOrReplaceWorldbook: _function_worldbook__WEBPACK_IMPORTED_MODULE_16__.createOrReplaceWorldbook,\n        deleteWorldbook: _function_worldbook__WEBPACK_IMPORTED_MODULE_16__.deleteWorldbook,\n        getWorldbook: _function_worldbook__WEBPACK_IMPORTED_MODULE_16__.getWorldbook,\n        replaceWorldbook: _function_worldbook__WEBPACK_IMPORTED_MODULE_16__.replaceWorldbook,\n        updateWorldbookWith: _function_worldbook__WEBPACK_IMPORTED_MODULE_16__.updateWorldbookWith,\n    };\n}\n/**\n * 初始化TavernHelper全局对象\n * 将各种功能函数暴露到全局作用域\n */\nfunction initTavernHelperObject() {\n    globalThis.TavernHelper = getTavernHelper();\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZnVuY3Rpb24vaW5kZXgudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUEwRDtBQUNiO0FBT2Y7QUFRRztBQUNpRTtBQUN0QztBQUNhO0FBYTVDO0FBVU07QUFpQlI7QUFDMEY7QUFDckU7QUFPZjtBQUNrRDtBQVFyRDtBQUNrRDtBQWdCbEQ7QUFDc0U7QUFFcEcsU0FBUyxlQUFlO0lBQ3RCLE9BQU87UUFDTCxRQUFRO1FBQ1IsV0FBVztRQUNYLFdBQVc7UUFDWCxTQUFTO1FBQ1QsU0FBUztRQUNULFdBQVc7UUFFWCxVQUFVO1FBQ1YsT0FBTztRQUVQLFlBQVk7UUFDWixTQUFTO1FBQ1QsV0FBVztRQUNYLGlCQUFpQjtRQUNqQixtQkFBbUI7UUFDbkIsb0JBQW9CO1FBRXBCLGVBQWU7UUFDZixlQUFlO1FBQ2YsZUFBZTtRQUNmLGNBQWM7UUFDZCxrQkFBa0I7UUFDbEIsa0JBQWtCO1FBQ2xCLGtCQUFrQjtRQUVsQixvQkFBb0I7UUFDcEIsd0JBQXdCO1FBQ3hCLHdCQUF3QjtRQUV4QixXQUFXO1FBQ1gsNEJBQTRCO1FBQzVCLFFBQVE7UUFDUixXQUFXO1FBRVgsaUJBQWlCO1FBQ2pCLGtCQUFrQjtRQUNsQixzQkFBc0I7UUFDdEIseUJBQXlCO1FBQ3pCLGtCQUFrQjtRQUNsQixxQkFBcUI7UUFDckIsbUJBQW1CO1FBQ25CLHFCQUFxQjtRQUNyQixtQkFBbUI7UUFFbkIsV0FBVztRQUNYLG1CQUFtQjtRQUNuQixtQkFBbUI7UUFDbkIsZ0JBQWdCO1FBQ2hCLHVCQUF1QjtRQUN2QixZQUFZO1FBQ1osY0FBYztRQUNkLGNBQWM7UUFDZCw2QkFBNkI7UUFDN0IsZUFBZTtRQUNmLGVBQWU7UUFDZix1QkFBdUI7UUFFdkIsU0FBUztRQUNULG9CQUFvQjtRQUNwQixvQkFBb0I7UUFDcEIseUJBQXlCO1FBQ3pCLGNBQWM7UUFDZCxjQUFjO1FBQ2QsbUJBQW1CO1FBQ25CLFVBQVU7UUFDVixZQUFZO1FBQ1oscUJBQXFCO1FBQ3JCLFlBQVk7UUFDWixZQUFZO1FBQ1osU0FBUztRQUNULGFBQWE7UUFDYixnQkFBZ0I7UUFDaEIsU0FBUztRQUVULFlBQVk7UUFDWixpQkFBaUI7UUFFakIsUUFBUTtRQUNSLFlBQVk7UUFDWixzQkFBc0IsRUFBRSwwREFBWTtRQUVwQyxlQUFlO1FBQ2YsMkJBQTJCO1FBQzNCLCtCQUErQjtRQUMvQixnQkFBZ0I7UUFDaEIsb0JBQW9CO1FBQ3BCLHVCQUF1QjtRQUV2QixPQUFPO1FBQ1AsZ0JBQWdCO1FBQ2hCLGdCQUFnQjtRQUNoQixZQUFZO1FBRVosWUFBWTtRQUNaLFlBQVk7UUFDWixnQkFBZ0I7UUFDaEIsbUJBQW1CO1FBQ25CLHVCQUF1QjtRQUN2QixjQUFjO1FBQ2QsZUFBZTtRQUVmLG9CQUFvQjtRQUNwQixnQkFBZ0I7UUFDaEIsb0JBQW9CO1FBQ3BCLDZCQUE2QjtRQUU3QixVQUFVO1FBQ1Ysc0JBQXNCO1FBQ3RCLGtCQUFrQjtRQUNsQixrQkFBa0IsRUFBRSxzRUFBc0I7UUFDMUMscUJBQXFCLEVBQUUsa0VBQWtCO1FBRXpDLFlBQVk7UUFDWixpQkFBaUI7UUFDakIsdUJBQXVCO1FBQ3ZCLHNCQUFzQjtRQUN0QixxQkFBcUI7UUFDckIsb0JBQW9CO1FBQ3BCLG9CQUFvQjtRQUNwQixtQkFBbUI7UUFDbkIsd0JBQXdCO1FBQ3hCLGVBQWU7UUFDZix3QkFBd0I7UUFDeEIsZUFBZTtRQUNmLFlBQVk7UUFDWixnQkFBZ0I7UUFDaEIsbUJBQW1CO0tBQ3BCLENBQUM7QUFDSixDQUFDO0FBTUQ7OztHQUdHO0FBQ0ksU0FBUyxzQkFBc0I7SUFDcEMsVUFBVSxDQUFDLFlBQVksR0FBRyxlQUFlLEVBQUUsQ0FBQztBQUM5QyxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2Z1bmN0aW9uL2luZGV4LnRzPzdlYmYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcmVnaXN0ZXJNYWNyb0xpa2UgfSBmcm9tICdAL2NvbXBvbmVudC9tYWNyb2xpa2UnO1xuaW1wb3J0IHsgYnVpbHRpbiB9IGZyb20gJ0AvZnVuY3Rpb24vYnVpbHRpbic7XG5pbXBvcnQge1xuICBDaGFyYWN0ZXIsXG4gIGdldENoYXJBdmF0YXJQYXRoLFxuICBnZXRDaGFyRGF0YSxcbiAgZ2V0Q2hhdEhpc3RvcnlCcmllZixcbiAgZ2V0Q2hhdEhpc3RvcnlEZXRhaWwsXG59IGZyb20gJ0AvZnVuY3Rpb24vY2hhcmFjdGVyJztcbmltcG9ydCB7XG4gIGNyZWF0ZUNoYXRNZXNzYWdlcyxcbiAgZGVsZXRlQ2hhdE1lc3NhZ2VzLFxuICBnZXRDaGF0TWVzc2FnZXMsXG4gIHJvdGF0ZUNoYXRNZXNzYWdlcyxcbiAgc2V0Q2hhdE1lc3NhZ2UsXG4gIHNldENoYXRNZXNzYWdlcyxcbn0gZnJvbSAnQC9mdW5jdGlvbi9jaGF0X21lc3NhZ2UnO1xuaW1wb3J0IHsgZm9ybWF0QXNEaXNwbGF5ZWRNZXNzYWdlLCByZXRyaWV2ZURpc3BsYXllZE1lc3NhZ2UgfSBmcm9tICdAL2Z1bmN0aW9uL2Rpc3BsYXllZF9tZXNzYWdlJztcbmltcG9ydCB7IGdlbmVyYXRlLCBnZW5lcmF0ZVJhdyB9IGZyb20gJ0AvZnVuY3Rpb24vZ2VuZXJhdGUnO1xuaW1wb3J0IHsgYnVpbHRpbl9wcm9tcHRfZGVmYXVsdF9vcmRlciB9IGZyb20gJ0AvZnVuY3Rpb24vZ2VuZXJhdGUvdHlwZXMnO1xuaW1wb3J0IHtcbiAgY3JlYXRlTG9yZWJvb2ssXG4gIGRlbGV0ZUxvcmVib29rLFxuICBnZXRDaGFyTG9yZWJvb2tzLFxuICBnZXRDaGF0TG9yZWJvb2ssXG4gIGdldEN1cnJlbnRDaGFyUHJpbWFyeUxvcmVib29rLFxuICBnZXRMb3JlYm9va3MsXG4gIGdldExvcmVib29rU2V0dGluZ3MsXG4gIGdldE9yQ3JlYXRlQ2hhdExvcmVib29rLFxuICBzZXRDaGF0TG9yZWJvb2ssXG4gIHNldEN1cnJlbnRDaGFyTG9yZWJvb2tzLFxuICBzZXRMb3JlYm9va1NldHRpbmdzLFxufSBmcm9tICdAL2Z1bmN0aW9uL2xvcmVib29rJztcbmltcG9ydCB7XG4gIGNyZWF0ZUxvcmVib29rRW50cmllcyxcbiAgY3JlYXRlTG9yZWJvb2tFbnRyeSxcbiAgZGVsZXRlTG9yZWJvb2tFbnRyaWVzLFxuICBkZWxldGVMb3JlYm9va0VudHJ5LFxuICBnZXRMb3JlYm9va0VudHJpZXMsXG4gIHJlcGxhY2VMb3JlYm9va0VudHJpZXMsXG4gIHNldExvcmVib29rRW50cmllcyxcbiAgdXBkYXRlTG9yZWJvb2tFbnRyaWVzV2l0aCxcbn0gZnJvbSAnQC9mdW5jdGlvbi9sb3JlYm9va19lbnRyeSc7XG5pbXBvcnQge1xuICBjcmVhdGVPclJlcGxhY2VQcmVzZXQsXG4gIGNyZWF0ZVByZXNldCxcbiAgZGVmYXVsdF9wcmVzZXQsXG4gIGRlbGV0ZVByZXNldCxcbiAgZ2V0TG9hZGVkUHJlc2V0TmFtZSxcbiAgZ2V0UHJlc2V0LFxuICBnZXRQcmVzZXROYW1lcyxcbiAgaXNQcmVzZXROb3JtYWxQcm9tcHQsXG4gIGlzUHJlc2V0UGxhY2Vob2xkZXJQcm9tcHQsXG4gIGlzUHJlc2V0U3lzdGVtUHJvbXB0LFxuICBsb2FkUHJlc2V0LFxuICByZW5hbWVQcmVzZXQsXG4gIHJlcGxhY2VQcmVzZXQsXG4gIHNldFByZXNldCxcbiAgdXBkYXRlUHJlc2V0V2l0aCxcbn0gZnJvbSAnQC9mdW5jdGlvbi9wcmVzZXQnO1xuaW1wb3J0IHsgYXBwZW5kSW5leGlzdGVudFNjcmlwdEJ1dHRvbnMsIGdldFNjcmlwdEJ1dHRvbnMsIHJlcGxhY2VTY3JpcHRCdXR0b25zIH0gZnJvbSAnQC9mdW5jdGlvbi9zY3JpcHRfcmVwb3NpdG9yeSc7XG5pbXBvcnQgeyB0cmlnZ2VyU2xhc2ggfSBmcm9tICdAL2Z1bmN0aW9uL3NsYXNoJztcbmltcG9ydCB7XG4gIGZvcm1hdEFzVGF2ZXJuUmVnZXhlZFN0cmluZyxcbiAgZ2V0VGF2ZXJuUmVnZXhlcyxcbiAgaXNDaGFyYWN0ZXJUYXZlcm5SZWdleGVzRW5hYmxlZCxcbiAgcmVwbGFjZVRhdmVyblJlZ2V4ZXMsXG4gIHVwZGF0ZVRhdmVyblJlZ2V4ZXNXaXRoLFxufSBmcm9tICdAL2Z1bmN0aW9uL3RhdmVybl9yZWdleCc7XG5pbXBvcnQgeyBlcnJvckNhdGNoZWQsIGdldExhc3RNZXNzYWdlSWQsIHN1YnN0aXR1ZGVNYWNyb3MgfSBmcm9tICdAL2Z1bmN0aW9uL3V0aWwnO1xuaW1wb3J0IHtcbiAgZGVsZXRlVmFyaWFibGUsXG4gIGdldFZhcmlhYmxlcyxcbiAgaW5zZXJ0T3JBc3NpZ25WYXJpYWJsZXMsXG4gIGluc2VydFZhcmlhYmxlcyxcbiAgcmVwbGFjZVZhcmlhYmxlcyxcbiAgdXBkYXRlVmFyaWFibGVzV2l0aCxcbn0gZnJvbSAnQC9mdW5jdGlvbi92YXJpYWJsZXMnO1xuaW1wb3J0IHsgZ2V0VGF2ZXJuSGVscGVyVmVyc2lvbiwgdXBkYXRlVGF2ZXJuSGVscGVyIH0gZnJvbSAnQC9mdW5jdGlvbi92ZXJzaW9uJztcbmltcG9ydCB7XG4gIGNyZWF0ZU9yUmVwbGFjZVdvcmxkYm9vayxcbiAgY3JlYXRlV29ybGRib29rLFxuICBkZWxldGVXb3JsZGJvb2ssXG4gIGdldENoYXJXb3JsZGJvb2tOYW1lcyxcbiAgZ2V0Q2hhdFdvcmxkYm9va05hbWUsXG4gIGdldEdsb2JhbFdvcmxkYm9va05hbWVzLFxuICBnZXRPckNyZWF0ZUNoYXRXb3JsZGJvb2ssXG4gIGdldFdvcmxkYm9vayxcbiAgZ2V0V29ybGRib29rTmFtZXMsXG4gIHJlYmluZENoYXJXb3JsZGJvb2tzLFxuICByZWJpbmRDaGF0V29ybGRib29rLFxuICByZWJpbmRHbG9iYWxXb3JsZGJvb2tzLFxuICByZXBsYWNlV29ybGRib29rLFxuICB1cGRhdGVXb3JsZGJvb2tXaXRoLFxufSBmcm9tICdAL2Z1bmN0aW9uL3dvcmxkYm9vayc7XG5pbXBvcnQgeyBhdWRpb0VuYWJsZSwgYXVkaW9JbXBvcnQsIGF1ZGlvTW9kZSwgYXVkaW9QbGF5LCBhdWRpb1NlbGVjdCB9IGZyb20gJ0Avc2xhc2hfY29tbWFuZC9hdWRpbyc7XG5cbmZ1bmN0aW9uIGdldFRhdmVybkhlbHBlcigpIHtcbiAgcmV0dXJuIHtcbiAgICAvLyBhdWRpb1xuICAgIGF1ZGlvRW5hYmxlLFxuICAgIGF1ZGlvSW1wb3J0LFxuICAgIGF1ZGlvTW9kZSxcbiAgICBhdWRpb1BsYXksXG4gICAgYXVkaW9TZWxlY3QsXG5cbiAgICAvLyBidWlsdGluXG4gICAgYnVpbHRpbixcblxuICAgIC8vIGNoYXJhY3RlclxuICAgIENoYXJhY3RlcixcbiAgICBnZXRDaGFyRGF0YSxcbiAgICBnZXRDaGFyQXZhdGFyUGF0aCxcbiAgICBnZXRDaGF0SGlzdG9yeUJyaWVmLFxuICAgIGdldENoYXRIaXN0b3J5RGV0YWlsLFxuXG4gICAgLy8gY2hhdF9tZXNzYWdlXG4gICAgZ2V0Q2hhdE1lc3NhZ2VzLFxuICAgIHNldENoYXRNZXNzYWdlcyxcbiAgICBzZXRDaGF0TWVzc2FnZSxcbiAgICBjcmVhdGVDaGF0TWVzc2FnZXMsXG4gICAgZGVsZXRlQ2hhdE1lc3NhZ2VzLFxuICAgIHJvdGF0ZUNoYXRNZXNzYWdlcyxcblxuICAgIC8vIGRpc3BsYXllZF9tZXNzYWdlXG4gICAgZm9ybWF0QXNEaXNwbGF5ZWRNZXNzYWdlLFxuICAgIHJldHJpZXZlRGlzcGxheWVkTWVzc2FnZSxcblxuICAgIC8vIGdlbmVyYXRlXG4gICAgYnVpbHRpbl9wcm9tcHRfZGVmYXVsdF9vcmRlcixcbiAgICBnZW5lcmF0ZSxcbiAgICBnZW5lcmF0ZVJhdyxcblxuICAgIC8vIGxvcmVib29rX2VudHJ5XG4gICAgZ2V0TG9yZWJvb2tFbnRyaWVzLFxuICAgIHJlcGxhY2VMb3JlYm9va0VudHJpZXMsXG4gICAgdXBkYXRlTG9yZWJvb2tFbnRyaWVzV2l0aCxcbiAgICBzZXRMb3JlYm9va0VudHJpZXMsXG4gICAgY3JlYXRlTG9yZWJvb2tFbnRyaWVzLFxuICAgIGNyZWF0ZUxvcmVib29rRW50cnksXG4gICAgZGVsZXRlTG9yZWJvb2tFbnRyaWVzLFxuICAgIGRlbGV0ZUxvcmVib29rRW50cnksXG5cbiAgICAvLyBsb3JlYm9va1xuICAgIGdldExvcmVib29rU2V0dGluZ3MsXG4gICAgc2V0TG9yZWJvb2tTZXR0aW5ncyxcbiAgICBnZXRDaGFyTG9yZWJvb2tzLFxuICAgIHNldEN1cnJlbnRDaGFyTG9yZWJvb2tzLFxuICAgIGdldExvcmVib29rcyxcbiAgICBkZWxldGVMb3JlYm9vayxcbiAgICBjcmVhdGVMb3JlYm9vayxcbiAgICBnZXRDdXJyZW50Q2hhclByaW1hcnlMb3JlYm9vayxcbiAgICBnZXRDaGF0TG9yZWJvb2ssXG4gICAgc2V0Q2hhdExvcmVib29rLFxuICAgIGdldE9yQ3JlYXRlQ2hhdExvcmVib29rLFxuXG4gICAgLy8gcHJlc2V0XG4gICAgaXNQcmVzZXROb3JtYWxQcm9tcHQsXG4gICAgaXNQcmVzZXRTeXN0ZW1Qcm9tcHQsXG4gICAgaXNQcmVzZXRQbGFjZWhvbGRlclByb21wdCxcbiAgICBkZWZhdWx0X3ByZXNldCxcbiAgICBnZXRQcmVzZXROYW1lcyxcbiAgICBnZXRMb2FkZWRQcmVzZXROYW1lLFxuICAgIGxvYWRQcmVzZXQsXG4gICAgY3JlYXRlUHJlc2V0LFxuICAgIGNyZWF0ZU9yUmVwbGFjZVByZXNldCxcbiAgICBkZWxldGVQcmVzZXQsXG4gICAgcmVuYW1lUHJlc2V0LFxuICAgIGdldFByZXNldCxcbiAgICByZXBsYWNlUHJlc2V0LFxuICAgIHVwZGF0ZVByZXNldFdpdGgsXG4gICAgc2V0UHJlc2V0LFxuXG4gICAgLy8gbWFjcm9saWtlXG4gICAgcmVnaXN0ZXJNYWNyb0xpa2UsXG5cbiAgICAvLyBzbGFzaFxuICAgIHRyaWdnZXJTbGFzaCxcbiAgICB0cmlnZ2VyU2xhc2hXaXRoUmVzdWx0OiB0cmlnZ2VyU2xhc2gsXG5cbiAgICAvLyB0YXZlcm5fcmVnZXhcbiAgICBmb3JtYXRBc1RhdmVyblJlZ2V4ZWRTdHJpbmcsXG4gICAgaXNDaGFyYWN0ZXJUYXZlcm5SZWdleGVzRW5hYmxlZCxcbiAgICBnZXRUYXZlcm5SZWdleGVzLFxuICAgIHJlcGxhY2VUYXZlcm5SZWdleGVzLFxuICAgIHVwZGF0ZVRhdmVyblJlZ2V4ZXNXaXRoLFxuXG4gICAgLy8gdXRpbFxuICAgIHN1YnN0aXR1ZGVNYWNyb3MsXG4gICAgZ2V0TGFzdE1lc3NhZ2VJZCxcbiAgICBlcnJvckNhdGNoZWQsXG5cbiAgICAvLyB2YXJpYWJsZXNcbiAgICBnZXRWYXJpYWJsZXMsXG4gICAgcmVwbGFjZVZhcmlhYmxlcyxcbiAgICB1cGRhdGVWYXJpYWJsZXNXaXRoLFxuICAgIGluc2VydE9yQXNzaWduVmFyaWFibGVzLFxuICAgIGRlbGV0ZVZhcmlhYmxlLFxuICAgIGluc2VydFZhcmlhYmxlcyxcblxuICAgIC8vIHNjcmlwdF9yZXBvc2l0b3J5XG4gICAgZ2V0U2NyaXB0QnV0dG9ucyxcbiAgICByZXBsYWNlU2NyaXB0QnV0dG9ucyxcbiAgICBhcHBlbmRJbmV4aXN0ZW50U2NyaXB0QnV0dG9ucyxcblxuICAgIC8vIHZlcnNpb25cbiAgICBnZXRUYXZlcm5IZWxwZXJWZXJzaW9uLFxuICAgIHVwZGF0ZVRhdmVybkhlbHBlcixcbiAgICBnZXRGcm9udGVuZFZlcnNpb246IGdldFRhdmVybkhlbHBlclZlcnNpb24sXG4gICAgdXBkYXRlRnJvbnRlbmRWZXJzaW9uOiB1cGRhdGVUYXZlcm5IZWxwZXIsXG5cbiAgICAvLyB3b3JsZGJvb2tcbiAgICBnZXRXb3JsZGJvb2tOYW1lcyxcbiAgICBnZXRHbG9iYWxXb3JsZGJvb2tOYW1lcyxcbiAgICByZWJpbmRHbG9iYWxXb3JsZGJvb2tzLFxuICAgIGdldENoYXJXb3JsZGJvb2tOYW1lcyxcbiAgICByZWJpbmRDaGFyV29ybGRib29rcyxcbiAgICBnZXRDaGF0V29ybGRib29rTmFtZSxcbiAgICByZWJpbmRDaGF0V29ybGRib29rLFxuICAgIGdldE9yQ3JlYXRlQ2hhdFdvcmxkYm9vayxcbiAgICBjcmVhdGVXb3JsZGJvb2ssXG4gICAgY3JlYXRlT3JSZXBsYWNlV29ybGRib29rLFxuICAgIGRlbGV0ZVdvcmxkYm9vayxcbiAgICBnZXRXb3JsZGJvb2ssXG4gICAgcmVwbGFjZVdvcmxkYm9vayxcbiAgICB1cGRhdGVXb3JsZGJvb2tXaXRoLFxuICB9O1xufVxuXG5kZWNsYXJlIG5hbWVzcGFjZSBnbG9iYWxUaGlzIHtcbiAgbGV0IFRhdmVybkhlbHBlcjogUmV0dXJuVHlwZTx0eXBlb2YgZ2V0VGF2ZXJuSGVscGVyPjtcbn1cblxuLyoqXG4gKiDliJ3lp4vljJZUYXZlcm5IZWxwZXLlhajlsYDlr7nosaFcbiAqIOWwhuWQhOenjeWKn+iDveWHveaVsOaatOmcsuWIsOWFqOWxgOS9nOeUqOWfn1xuICovXG5leHBvcnQgZnVuY3Rpb24gaW5pdFRhdmVybkhlbHBlck9iamVjdCgpIHtcbiAgZ2xvYmFsVGhpcy5UYXZlcm5IZWxwZXIgPSBnZXRUYXZlcm5IZWxwZXIoKTtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/function/index.ts\n\n}')},"./src/function/lorebook.ts":
/*!**********************************!*\
  !*** ./src/function/lorebook.ts ***!
  \**********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createLorebook: () => (/* binding */ createLorebook),\n/* harmony export */   deleteLorebook: () => (/* binding */ deleteLorebook),\n/* harmony export */   getCharLorebooks: () => (/* binding */ getCharLorebooks),\n/* harmony export */   getChatLorebook: () => (/* binding */ getChatLorebook),\n/* harmony export */   getCurrentCharPrimaryLorebook: () => (/* binding */ getCurrentCharPrimaryLorebook),\n/* harmony export */   getLorebookSettings: () => (/* binding */ getLorebookSettings),\n/* harmony export */   getLorebooks: () => (/* binding */ getLorebooks),\n/* harmony export */   getOrCreateChatLorebook: () => (/* binding */ getOrCreateChatLorebook),\n/* harmony export */   setChatLorebook: () => (/* binding */ setChatLorebook),\n/* harmony export */   setCurrentCharLorebooks: () => (/* binding */ setCurrentCharLorebooks),\n/* harmony export */   setLorebookSettings: () => (/* binding */ setLorebookSettings)\n/* harmony export */ });\n/* harmony import */ var _function_character__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/function/character */ \"./src/function/character.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n/* harmony import */ var _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/scripts/world-info */ \"@sillytavern/scripts/world-info\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_4__);\n\n\n// @ts-ignore\n\n\n\nasync function editCurrentCharacter() {\n    // @ts-ignore\n    $('#rm_info_avatar').html('');\n    // @ts-ignore\n    const form_data = new FormData($('#form_create').get(0));\n    const raw_file = form_data.get('avatar');\n    if (raw_file instanceof File) {\n        const converted_file = await (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_2__.ensureImageFormatSupported)(raw_file);\n        form_data.set('avatar', converted_file);\n    }\n    const headers = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.getRequestHeaders)();\n    // @ts-ignore\n    delete headers['Content-Type'];\n    // TODO: 这里的代码可以用来修改第一条消息!\n    form_data.delete('alternate_greetings');\n    // @ts-ignore\n    const chid = $('.open_alternate_greetings').data('chid');\n    if (chid && Array.isArray(_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.characters[chid]?.data?.alternate_greetings)) {\n        for (const value of _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.characters[chid].data.alternate_greetings) {\n            form_data.append('alternate_greetings', value);\n        }\n    }\n    const response = await fetch('/api/characters/edit', {\n        method: 'POST',\n        headers: headers,\n        body: form_data,\n        cache: 'no-cache',\n    });\n    if (!response.ok) {\n        return false;\n    }\n    await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.getOneCharacter)(form_data.get('avatar_url'));\n    // @ts-ignore\n    $('#add_avatar_button').replaceWith($('#add_avatar_button').val('').clone(true));\n    // @ts-ignore\n    $('#create_button').attr('value', 'Save');\n    return true;\n}\nfunction toLorebookSettings(world_info_settings) {\n    return {\n        selected_global_lorebooks: world_info_settings.world_info.globalSelect,\n        scan_depth: world_info_settings.world_info_depth,\n        context_percentage: world_info_settings.world_info_budget,\n        budget_cap: world_info_settings.world_info_budget_cap,\n        min_activations: world_info_settings.world_info_min_activations,\n        max_depth: world_info_settings.world_info_min_activations_depth_max,\n        max_recursion_steps: world_info_settings.world_info_max_recursion_steps,\n        insertion_strategy: { 0: 'evenly', 1: 'character_first', 2: 'global_first' }[world_info_settings.world_info_character_strategy],\n        include_names: world_info_settings.world_info_include_names,\n        recursive: world_info_settings.world_info_recursive,\n        case_sensitive: world_info_settings.world_info_case_sensitive,\n        match_whole_words: world_info_settings.world_info_match_whole_words,\n        use_group_scoring: world_info_settings.world_info_use_group_scoring,\n        overflow_alert: world_info_settings.world_info_overflow_alert,\n    };\n}\nfunction assignPartialLorebookSettings(settings) {\n    const for_eachs = {\n        selected_global_lorebooks: (value) => {\n            $('#world_info').find('option[value!=\"\"]').remove();\n            _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.world_names.forEach((item, i) => $('#world_info').append(`<option value='${i}'${value.includes(item) ? ' selected' : ''}>${item}</option>`));\n            _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.selected_world_info.length = 0;\n            _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.selected_world_info.push(...value);\n            (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.saveSettings)();\n        },\n        scan_depth: (value) => {\n            $('#world_info_depth').val(value).trigger('input');\n        },\n        context_percentage: (value) => {\n            $('#world_info_budget').val(value).trigger('input');\n        },\n        budget_cap: (value) => {\n            $('#world_info_budget_cap').val(value).trigger('input');\n        },\n        min_activations: (value) => {\n            $('#world_info_min_activations').val(value).trigger('input');\n        },\n        max_depth: (value) => {\n            $('#world_info_min_activations_depth_max').val(value).trigger('input');\n        },\n        max_recursion_steps: (value) => {\n            $('#world_info_max_recursion_steps').val(value).trigger('input');\n        },\n        insertion_strategy: (value) => {\n            const converted_value = { evenly: 0, character_first: 1, global_first: 2 }[value];\n            $(`#world_info_character_strategy option[value='${converted_value}']`).prop('selected', true);\n            $('#world_info_character_strategy').val(converted_value).trigger('change');\n        },\n        include_names: (value) => {\n            $('#world_info_include_names').prop('checked', value).trigger('input');\n        },\n        recursive: (value) => {\n            $('#world_info_recursive').prop('checked', value).trigger('input');\n        },\n        case_sensitive: (value) => {\n            $('#world_info_case_sensitive').prop('checked', value).trigger('input');\n        },\n        match_whole_words: (value) => {\n            $('#world_info_match_whole_words').prop('checked', value).trigger('input');\n        },\n        use_group_scoring: (value) => {\n            $('#world_info_use_group_scoring').prop('checked', value).trigger('change');\n        },\n        overflow_alert: (value) => {\n            $('#world_info_overflow_alert').prop('checked', value).trigger('change');\n        },\n    };\n    Object.entries(settings)\n        .filter(([_, value]) => value !== undefined)\n        .forEach(([field, value]) => {\n        // @ts-ignore\n        for_eachs[field]?.(value);\n    });\n}\nfunction getLorebookSettings() {\n    const lorebook_settings = toLorebookSettings((0,_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.getWorldInfoSettings)());\n    loglevel__WEBPACK_IMPORTED_MODULE_4___default().info(`获取世界书全局设置:\\n${JSON.stringify(lorebook_settings)}`);\n    return structuredClone(lorebook_settings);\n}\nfunction setLorebookSettings(settings) {\n    if (settings.selected_global_lorebooks) {\n        const inexisting_lorebooks = settings.selected_global_lorebooks.filter(lorebook => !_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.world_names.includes(lorebook));\n        if (inexisting_lorebooks.length > 0) {\n            throw Error(`尝试修改要全局启用的世界书, 但未找到以下世界书: ${JSON.stringify(inexisting_lorebooks)}`);\n        }\n    }\n    const original_settings = getLorebookSettings();\n    settings = _.omitBy(settings, (value, key) => value === original_settings[key]);\n    assignPartialLorebookSettings(settings);\n    loglevel__WEBPACK_IMPORTED_MODULE_4___default().info(`修改世界书全局设置:\\n${JSON.stringify(settings)}`);\n}\nfunction getLorebooks() {\n    loglevel__WEBPACK_IMPORTED_MODULE_4___default().info(`获取世界书列表: ${JSON.stringify(_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.world_names)}`);\n    return structuredClone(_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.world_names);\n}\nasync function deleteLorebook(lorebook) {\n    const success = await (0,_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.deleteWorldInfo)(lorebook);\n    loglevel__WEBPACK_IMPORTED_MODULE_4___default().info(`移除世界书 '${lorebook}' ${success ? '成功' : '失败'}`);\n    return success;\n}\nasync function createLorebook(lorebook) {\n    const success = await (0,_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.createNewWorldInfo)(lorebook, { interactive: false });\n    loglevel__WEBPACK_IMPORTED_MODULE_4___default().info(`新建世界书 '${lorebook}' ${success ? '成功' : '失败'}`);\n    return success;\n}\nfunction getCharLorebooks({ name = _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.this_chid]?.avatar ?? null, type = 'all', } = {}) {\n    const character = _function_character__WEBPACK_IMPORTED_MODULE_0__.Character.find({ name: name ?? 'current' });\n    if (!character) {\n        throw Error(`未找到${name === 'current' ? '当前打开' : `名为 '${name}' `}的角色卡`);\n    }\n    const books = { primary: null, additional: [] };\n    if (character.data?.extensions?.world) {\n        books.primary = character.data?.extensions?.world;\n    }\n    // TODO: 提取成函数\n    const filename = character.avatar.replace(/\\.[^/.]+$/, '');\n    const extra_charlore = _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.world_info.charLore?.find(e => e.name === filename);\n    if (extra_charlore && Array.isArray(extra_charlore.extraBooks)) {\n        books.additional = extra_charlore.extraBooks;\n    }\n    loglevel__WEBPACK_IMPORTED_MODULE_4___default().info(`获取角色卡绑定的世界书, 选项: ${JSON.stringify({ name, type })}, 获取结果: ${JSON.stringify(books)}`);\n    return structuredClone(books);\n}\nfunction getCurrentCharPrimaryLorebook() {\n    return getCharLorebooks().primary;\n}\nasync function setCurrentCharLorebooks(lorebooks) {\n    const filename = (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_2__.getCharaFilename)(_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.this_chid);\n    if (!filename) {\n        throw Error(`未打开任何角色卡`);\n    }\n    const inexisting_lorebooks = _(_.concat(lorebooks.primary ? [lorebooks.primary] : [], lorebooks.additional))\n        .reject(_.isNull)\n        .reject(lorebook_name => getLorebooks().some(value => value === lorebook_name))\n        .value();\n    if (inexisting_lorebooks.length > 0) {\n        throw Error(`尝试修改 '${filename}' 绑定的世界书, 但未找到以下世界书: ${inexisting_lorebooks}`);\n    }\n    if (lorebooks.primary !== undefined) {\n        const previous_primary = String($('#character_world').val());\n        $('#character_world').val(lorebooks.primary ? lorebooks.primary : '');\n        $('.character_world_info_selector')\n            .find('option:selected')\n            .val(lorebooks.primary ? _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.world_names.indexOf(lorebooks.primary) : '');\n        if (previous_primary && !lorebooks.primary) {\n            const data = JSON.parse(String($('#character_json_data').val()));\n            if (data?.data?.character_book) {\n                data.data.character_book = undefined;\n            }\n            $('#character_json_data').val(JSON.stringify(data));\n        }\n        if (!(await editCurrentCharacter())) {\n            throw Error(`尝试为 '${filename}' 绑定主要世界书, 但在访问酒馆后端时出错`);\n        }\n        // @ts-expect-error\n        (0,_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.setWorldInfoButtonClass)(undefined, !!lorebooks.primary);\n    }\n    if (lorebooks.additional !== undefined) {\n        const char_lore = _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.world_info.charLore ?? [];\n        const existing_char_index = char_lore.findIndex(entry => entry.name === filename);\n        if (existing_char_index === -1) {\n            char_lore.push({ name: filename, extraBooks: lorebooks.additional });\n        }\n        else if (lorebooks.additional.length === 0) {\n            char_lore.splice(existing_char_index, 1);\n        }\n        else {\n            char_lore[existing_char_index].extraBooks = lorebooks.additional;\n        }\n        Object.assign(_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.world_info, { charLore: char_lore });\n    }\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.saveCharacterDebounced)();\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.saveSettingsDebounced)();\n    loglevel__WEBPACK_IMPORTED_MODULE_4___default().info(`修改角色卡绑定的世界书, 要修改的部分: ${JSON.stringify(lorebooks)}${lorebooks.primary === undefined ? ', 主要世界书保持不变' : ''}${lorebooks.additional === undefined ? ', 附加世界书保持不变' : ''}`);\n}\nfunction getChatLorebook() {\n    const chat_id = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.getCurrentChatId)();\n    if (!chat_id) {\n        throw Error(`未打开任何聊天, 不可获取聊天世界书`);\n    }\n    const existing_lorebook = _.get(_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata, _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.METADATA_KEY, '');\n    if (_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.world_names.includes(existing_lorebook)) {\n        return existing_lorebook;\n    }\n    _.unset(_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata, _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.METADATA_KEY);\n    return null;\n}\nasync function setChatLorebook(lorebook) {\n    if (lorebook === null) {\n        _.unset(_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata, _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.METADATA_KEY);\n        $('.chat_lorebook_button').removeClass('world_set');\n    }\n    else {\n        if (!_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.world_names.includes(lorebook)) {\n            throw new Error(`尝试为角色卡绑定聊天世界书, 但该世界书 '${lorebook}' 不存在`);\n        }\n        _.set(_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata, _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.METADATA_KEY, lorebook);\n        $('.chat_lorebook_button').addClass('world_set');\n    }\n    await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.saveMetadata)();\n}\nasync function getOrCreateChatLorebook(lorebook) {\n    const existing_lorebook = await getChatLorebook();\n    if (existing_lorebook !== null) {\n        return existing_lorebook;\n    }\n    const new_lorebook = (() => {\n        if (lorebook) {\n            if (_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.world_names.includes(lorebook)) {\n                throw new Error(`尝试创建聊天世界书, 但该名称 '${lorebook}' 已存在`);\n            }\n            return lorebook;\n        }\n        return `Chat Book ${(0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.getCurrentChatId)()}`\n            .replace(/[^a-z0-9]/gi, '_')\n            .replace(/_{2,}/g, '_')\n            .substring(0, 64);\n    })();\n    await (0,_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.createNewWorldInfo)(new_lorebook);\n    await setChatLorebook(new_lorebook);\n    return new_lorebook;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUMvQixPQUFPLGlCQUFpQixDQUFDO0lBQzNCLENBQUM7SUFFRCxNQUFNLFlBQVksR0FBRyxDQUFDLEdBQUcsRUFBRTtRQUN6QixJQUFJLFFBQVEsRUFBRSxDQUFDO1lBQ2IsSUFBSSx3RUFBVyxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDO2dCQUNuQyxNQUFNLElBQUksS0FBSyxDQUFDLG9CQUFvQixRQUFRLE9BQU8sQ0FBQyxDQUFDO1lBQ3ZELENBQUM7WUFDRCxPQUFPLFFBQVEsQ0FBQztRQUNsQixDQUFDO1FBRUQsT0FBTyxhQUFhLHFFQUFnQixFQUFFLEVBQUU7YUFDckMsT0FBTyxDQUFDLGFBQWEsRUFBRSxHQUFHLENBQUM7YUFDM0IsT0FBTyxDQUFDLFFBQVEsRUFBRSxHQUFHLENBQUM7YUFDdEIsU0FBUyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUN0QixDQUFDLENBQUMsRUFBRSxDQUFDO0lBQ0wsTUFBTSxtRkFBa0IsQ0FBQyxZQUFZLENBQUMsQ0FBQztJQUV2QyxNQUFNLGVBQWUsQ0FBQyxZQUFZLENBQUMsQ0FBQztJQUNwQyxPQUFPLFlBQVksQ0FBQztBQUN0QixDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2Z1bmN0aW9uL2xvcmVib29rLnRzPzY3ZTAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ2hhcmFjdGVyIH0gZnJvbSAnQC9mdW5jdGlvbi9jaGFyYWN0ZXInO1xuXG5pbXBvcnQge1xuICBjaGFyYWN0ZXJzLFxuICBjaGF0X21ldGFkYXRhLFxuICBnZXRDdXJyZW50Q2hhdElkLFxuICBnZXRPbmVDaGFyYWN0ZXIsXG4gIGdldFJlcXVlc3RIZWFkZXJzLFxuICBzYXZlQ2hhcmFjdGVyRGVib3VuY2VkLFxuICBzYXZlTWV0YWRhdGEsXG4gIHNhdmVTZXR0aW5ncyxcbiAgc2F2ZVNldHRpbmdzRGVib3VuY2VkLFxuICB0aGlzX2NoaWQsXG59IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHQnO1xuLy8gQHRzLWlnbm9yZVxuaW1wb3J0IHsgZW5zdXJlSW1hZ2VGb3JtYXRTdXBwb3J0ZWQsIGdldENoYXJhRmlsZW5hbWUgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy91dGlscyc7XG5pbXBvcnQge1xuICBjcmVhdGVOZXdXb3JsZEluZm8sXG4gIGRlbGV0ZVdvcmxkSW5mbyxcbiAgZ2V0V29ybGRJbmZvU2V0dGluZ3MsXG4gIE1FVEFEQVRBX0tFWSxcbiAgc2VsZWN0ZWRfd29ybGRfaW5mbyxcbiAgc2V0V29ybGRJbmZvQnV0dG9uQ2xhc3MsXG4gIHdvcmxkX2luZm8sXG4gIHdvcmxkX25hbWVzLFxufSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy93b3JsZC1pbmZvJztcblxuaW1wb3J0IGxvZyBmcm9tICdsb2dsZXZlbCc7XG5cbnR5cGUgTG9yZWJvb2tTZXR0aW5ncyA9IHtcbiAgc2VsZWN0ZWRfZ2xvYmFsX2xvcmVib29rczogc3RyaW5nW107XG5cbiAgc2Nhbl9kZXB0aDogbnVtYmVyO1xuICBjb250ZXh0X3BlcmNlbnRhZ2U6IG51bWJlcjtcbiAgYnVkZ2V0X2NhcDogbnVtYmVyOyAvLyAwIOihqOekuuemgeeUqFxuICBtaW5fYWN0aXZhdGlvbnM6IG51bWJlcjtcbiAgbWF4X2RlcHRoOiBudW1iZXI7IC8vIDAg6KGo56S65peg6ZmQ5Yi2XG4gIG1heF9yZWN1cnNpb25fc3RlcHM6IG51bWJlcjtcblxuICBpbnNlcnRpb25fc3RyYXRlZ3k6ICdldmVubHknIHwgJ2NoYXJhY3Rlcl9maXJzdCcgfCAnZ2xvYmFsX2ZpcnN0JztcblxuICBpbmNsdWRlX25hbWVzOiBib29sZWFuO1xuICByZWN1cnNpdmU6IGJvb2xlYW47XG4gIGNhc2Vfc2Vuc2l0aXZlOiBib29sZWFuO1xuICBtYXRjaF93aG9sZV93b3JkczogYm9vbGVhbjtcbiAgdXNlX2dyb3VwX3Njb3Jpbmc6IGJvb2xlYW47XG4gIG92ZXJmbG93X2FsZXJ0OiBib29sZWFuO1xufTtcblxuYXN5bmMgZnVuY3Rpb24gZWRpdEN1cnJlbnRDaGFyYWN0ZXIoKTogUHJvbWlzZTxib29sZWFuPiB7XG4gIC8vIEB0cy1pZ25vcmVcbiAgJCgnI3JtX2luZm9fYXZhdGFyJykuaHRtbCgnJyk7XG4gIC8vIEB0cy1pZ25vcmVcbiAgY29uc3QgZm9ybV9kYXRhID0gbmV3IEZvcm1EYXRhKCgkKCcjZm9ybV9jcmVhdGUnKSBhcyBKUXVlcnk8SFRNTEZvcm1FbGVtZW50PikuZ2V0KDApKTtcblxuICBjb25zdCByYXdfZmlsZSA9IGZvcm1fZGF0YS5nZXQoJ2F2YXRhcicpO1xuICBpZiAocmF3X2ZpbGUgaW5zdGFuY2VvZiBGaWxlKSB7XG4gICAgY29uc3QgY29udmVydGVkX2ZpbGUgPSBhd2FpdCBlbnN1cmVJbWFnZUZvcm1hdFN1cHBvcnRlZChyYXdfZmlsZSk7XG4gICAgZm9ybV9kYXRhLnNldCgnYXZhdGFyJywgY29udmVydGVkX2ZpbGUpO1xuICB9XG5cbiAgY29uc3QgaGVhZGVycyA9IGdldFJlcXVlc3RIZWFkZXJzKCk7XG4gIC8vIEB0cy1pZ25vcmVcbiAgZGVsZXRlIGhlYWRlcnNbJ0NvbnRlbnQtVHlwZSddO1xuXG4gIC8vIFRPRE86IOi/memHjOeahOS7o+eggeWPr+S7peeUqOadpeS/ruaUueesrOS4gOadoea2iOaBryFcbiAgZm9ybV9kYXRhLmRlbGV0ZSgnYWx0ZXJuYXRlX2dyZWV0aW5ncycpO1xuICAvLyBAdHMtaWdub3JlXG4gIGNvbnN0IGNoaWQgPSAkKCcub3Blbl9hbHRlcm5hdGVfZ3JlZXRpbmdzJykuZGF0YSgnY2hpZCcpO1xuICBpZiAoY2hpZCAmJiBBcnJheS5pc0FycmF5KGNoYXJhY3RlcnNbY2hpZF0/LmRhdGE/LmFsdGVybmF0ZV9ncmVldGluZ3MpKSB7XG4gICAgZm9yIChjb25zdCB2YWx1ZSBvZiBjaGFyYWN0ZXJzW2NoaWRdLmRhdGEuYWx0ZXJuYXRlX2dyZWV0aW5ncykge1xuICAgICAgZm9ybV9kYXRhLmFwcGVuZCgnYWx0ZXJuYXRlX2dyZWV0aW5ncycsIHZhbHVlKTtcbiAgICB9XG4gIH1cblxuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCcvYXBpL2NoYXJhY3RlcnMvZWRpdCcsIHtcbiAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICBoZWFkZXJzOiBoZWFkZXJzLFxuICAgIGJvZHk6IGZvcm1fZGF0YSxcbiAgICBjYWNoZTogJ25vLWNhY2hlJyxcbiAgfSk7XG5cbiAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGF3YWl0IGdldE9uZUNoYXJhY3Rlcihmb3JtX2RhdGEuZ2V0KCdhdmF0YXJfdXJsJykpO1xuICAvLyBAdHMtaWdub3JlXG4gICQoJyNhZGRfYXZhdGFyX2J1dHRvbicpLnJlcGxhY2VXaXRoKCQoJyNhZGRfYXZhdGFyX2J1dHRvbicpLnZhbCgnJykuY2xvbmUodHJ1ZSkpO1xuICAvLyBAdHMtaWdub3JlXG4gICQoJyNjcmVhdGVfYnV0dG9uJykuYXR0cigndmFsdWUnLCAnU2F2ZScpO1xuXG4gIHJldHVybiB0cnVlO1xufVxuXG5mdW5jdGlvbiB0b0xvcmVib29rU2V0dGluZ3Mod29ybGRfaW5mb19zZXR0aW5nczogUmV0dXJuVHlwZTx0eXBlb2YgZ2V0V29ybGRJbmZvU2V0dGluZ3M+KTogTG9yZWJvb2tTZXR0aW5ncyB7XG4gIHJldHVybiB7XG4gICAgc2VsZWN0ZWRfZ2xvYmFsX2xvcmVib29rczogKHdvcmxkX2luZm9fc2V0dGluZ3Mud29ybGRfaW5mbyBhcyB7IGdsb2JhbFNlbGVjdDogc3RyaW5nW10gfSkuZ2xvYmFsU2VsZWN0LFxuXG4gICAgc2Nhbl9kZXB0aDogd29ybGRfaW5mb19zZXR0aW5ncy53b3JsZF9pbmZvX2RlcHRoLFxuICAgIGNvbnRleHRfcGVyY2VudGFnZTogd29ybGRfaW5mb19zZXR0aW5ncy53b3JsZF9pbmZvX2J1ZGdldCxcbiAgICBidWRnZXRfY2FwOiB3b3JsZF9pbmZvX3NldHRpbmdzLndvcmxkX2luZm9fYnVkZ2V0X2NhcCxcbiAgICBtaW5fYWN0aXZhdGlvbnM6IHdvcmxkX2luZm9fc2V0dGluZ3Mud29ybGRfaW5mb19taW5fYWN0aXZhdGlvbnMsXG4gICAgbWF4X2RlcHRoOiB3b3JsZF9pbmZvX3NldHRpbmdzLndvcmxkX2luZm9fbWluX2FjdGl2YXRpb25zX2RlcHRoX21heCxcbiAgICBtYXhfcmVjdXJzaW9uX3N0ZXBzOiB3b3JsZF9pbmZvX3NldHRpbmdzLndvcmxkX2luZm9fbWF4X3JlY3Vyc2lvbl9zdGVwcyxcblxuICAgIGluc2VydGlvbl9zdHJhdGVneTogeyAwOiAnZXZlbmx5JywgMTogJ2NoYXJhY3Rlcl9maXJzdCcsIDI6ICdnbG9iYWxfZmlyc3QnIH1bXG4gICAgICB3b3JsZF9pbmZvX3NldHRpbmdzLndvcmxkX2luZm9fY2hhcmFjdGVyX3N0cmF0ZWd5XG4gICAgXSBhcyAnZXZlbmx5JyB8ICdjaGFyYWN0ZXJfZmlyc3QnIHwgJ2dsb2JhbF9maXJzdCcsXG5cbiAgICBpbmNsdWRlX25hbWVzOiB3b3JsZF9pbmZvX3NldHRpbmdzLndvcmxkX2luZm9faW5jbHVkZV9uYW1lcyxcbiAgICByZWN1cnNpdmU6IHdvcmxkX2luZm9fc2V0dGluZ3Mud29ybGRfaW5mb19yZWN1cnNpdmUsXG4gICAgY2FzZV9zZW5zaXRpdmU6IHdvcmxkX2luZm9fc2V0dGluZ3Mud29ybGRfaW5mb19jYXNlX3NlbnNpdGl2ZSxcbiAgICBtYXRjaF93aG9sZV93b3Jkczogd29ybGRfaW5mb19zZXR0aW5ncy53b3JsZF9pbmZvX21hdGNoX3dob2xlX3dvcmRzLFxuICAgIHVzZV9ncm91cF9zY29yaW5nOiB3b3JsZF9pbmZvX3NldHRpbmdzLndvcmxkX2luZm9fdXNlX2dyb3VwX3Njb3JpbmcsXG4gICAgb3ZlcmZsb3dfYWxlcnQ6IHdvcmxkX2luZm9fc2V0dGluZ3Mud29ybGRfaW5mb19vdmVyZmxvd19hbGVydCxcbiAgfTtcbn1cblxuZnVuY3Rpb24gYXNzaWduUGFydGlhbExvcmVib29rU2V0dGluZ3Moc2V0dGluZ3M6IFBhcnRpYWw8TG9yZWJvb2tTZXR0aW5ncz4pOiB2b2lkIHtcbiAgY29uc3QgZm9yX2VhY2hzID0ge1xuICAgIHNlbGVjdGVkX2dsb2JhbF9sb3JlYm9va3M6ICh2YWx1ZTogTG9yZWJvb2tTZXR0aW5nc1snc2VsZWN0ZWRfZ2xvYmFsX2xvcmVib29rcyddKSA9PiB7XG4gICAgICAkKCcjd29ybGRfaW5mbycpLmZpbmQoJ29wdGlvblt2YWx1ZSE9XCJcIl0nKS5yZW1vdmUoKTtcbiAgICAgIHdvcmxkX25hbWVzLmZvckVhY2goKGl0ZW0sIGkpID0+XG4gICAgICAgICQoJyN3b3JsZF9pbmZvJykuYXBwZW5kKGA8b3B0aW9uIHZhbHVlPScke2l9JyR7dmFsdWUuaW5jbHVkZXMoaXRlbSkgPyAnIHNlbGVjdGVkJyA6ICcnfT4ke2l0ZW19PC9vcHRpb24+YCksXG4gICAgICApO1xuXG4gICAgICBzZWxlY3RlZF93b3JsZF9pbmZvLmxlbmd0aCA9IDA7XG4gICAgICBzZWxlY3RlZF93b3JsZF9pbmZvLnB1c2goLi4udmFsdWUpO1xuICAgICAgc2F2ZVNldHRpbmdzKCk7XG4gICAgfSxcblxuICAgIHNjYW5fZGVwdGg6ICh2YWx1ZTogTG9yZWJvb2tTZXR0aW5nc1snc2Nhbl9kZXB0aCddKSA9PiB7XG4gICAgICAkKCcjd29ybGRfaW5mb19kZXB0aCcpLnZhbCh2YWx1ZSkudHJpZ2dlcignaW5wdXQnKTtcbiAgICB9LFxuICAgIGNvbnRleHRfcGVyY2VudGFnZTogKHZhbHVlOiBMb3JlYm9va1NldHRpbmdzWydjb250ZXh0X3BlcmNlbnRhZ2UnXSkgPT4ge1xuICAgICAgJCgnI3dvcmxkX2luZm9fYnVkZ2V0JykudmFsKHZhbHVlKS50cmlnZ2VyKCdpbnB1dCcpO1xuICAgIH0sXG4gICAgYnVkZ2V0X2NhcDogKHZhbHVlOiBMb3JlYm9va1NldHRpbmdzWydidWRnZXRfY2FwJ10pID0+IHtcbiAgICAgICQoJyN3b3JsZF9pbmZvX2J1ZGdldF9jYXAnKS52YWwodmFsdWUpLnRyaWdnZXIoJ2lucHV0Jyk7XG4gICAgfSxcbiAgICBtaW5fYWN0aXZhdGlvbnM6ICh2YWx1ZTogTG9yZWJvb2tTZXR0aW5nc1snbWluX2FjdGl2YXRpb25zJ10pID0+IHtcbiAgICAgICQoJyN3b3JsZF9pbmZvX21pbl9hY3RpdmF0aW9ucycpLnZhbCh2YWx1ZSkudHJpZ2dlcignaW5wdXQnKTtcbiAgICB9LFxuICAgIG1heF9kZXB0aDogKHZhbHVlOiBMb3JlYm9va1NldHRpbmdzWydtYXhfZGVwdGgnXSkgPT4ge1xuICAgICAgJCgnI3dvcmxkX2luZm9fbWluX2FjdGl2YXRpb25zX2RlcHRoX21heCcpLnZhbCh2YWx1ZSkudHJpZ2dlcignaW5wdXQnKTtcbiAgICB9LFxuICAgIG1heF9yZWN1cnNpb25fc3RlcHM6ICh2YWx1ZTogTG9yZWJvb2tTZXR0aW5nc1snbWF4X3JlY3Vyc2lvbl9zdGVwcyddKSA9PiB7XG4gICAgICAkKCcjd29ybGRfaW5mb19tYXhfcmVjdXJzaW9uX3N0ZXBzJykudmFsKHZhbHVlKS50cmlnZ2VyKCdpbnB1dCcpO1xuICAgIH0sXG5cbiAgICBpbnNlcnRpb25fc3RyYXRlZ3k6ICh2YWx1ZTogTG9yZWJvb2tTZXR0aW5nc1snaW5zZXJ0aW9uX3N0cmF0ZWd5J10pID0+IHtcbiAgICAgIGNvbnN0IGNvbnZlcnRlZF92YWx1ZSA9IHsgZXZlbmx5OiAwLCBjaGFyYWN0ZXJfZmlyc3Q6IDEsIGdsb2JhbF9maXJzdDogMiB9W3ZhbHVlXTtcbiAgICAgICQoYCN3b3JsZF9pbmZvX2NoYXJhY3Rlcl9zdHJhdGVneSBvcHRpb25bdmFsdWU9JyR7Y29udmVydGVkX3ZhbHVlfSddYCkucHJvcCgnc2VsZWN0ZWQnLCB0cnVlKTtcbiAgICAgICQoJyN3b3JsZF9pbmZvX2NoYXJhY3Rlcl9zdHJhdGVneScpLnZhbChjb252ZXJ0ZWRfdmFsdWUpLnRyaWdnZXIoJ2NoYW5nZScpO1xuICAgIH0sXG5cbiAgICBpbmNsdWRlX25hbWVzOiAodmFsdWU6IExvcmVib29rU2V0dGluZ3NbJ2luY2x1ZGVfbmFtZXMnXSkgPT4ge1xuICAgICAgJCgnI3dvcmxkX2luZm9faW5jbHVkZV9uYW1lcycpLnByb3AoJ2NoZWNrZWQnLCB2YWx1ZSkudHJpZ2dlcignaW5wdXQnKTtcbiAgICB9LFxuICAgIHJlY3Vyc2l2ZTogKHZhbHVlOiBMb3JlYm9va1NldHRpbmdzWydyZWN1cnNpdmUnXSkgPT4ge1xuICAgICAgJCgnI3dvcmxkX2luZm9fcmVjdXJzaXZlJykucHJvcCgnY2hlY2tlZCcsIHZhbHVlKS50cmlnZ2VyKCdpbnB1dCcpO1xuICAgIH0sXG4gICAgY2FzZV9zZW5zaXRpdmU6ICh2YWx1ZTogTG9yZWJvb2tTZXR0aW5nc1snY2FzZV9zZW5zaXRpdmUnXSkgPT4ge1xuICAgICAgJCgnI3dvcmxkX2luZm9fY2FzZV9zZW5zaXRpdmUnKS5wcm9wKCdjaGVja2VkJywgdmFsdWUpLnRyaWdnZXIoJ2lucHV0Jyk7XG4gICAgfSxcbiAgICBtYXRjaF93aG9sZV93b3JkczogKHZhbHVlOiBMb3JlYm9va1NldHRpbmdzWydtYXRjaF93aG9sZV93b3JkcyddKSA9PiB7XG4gICAgICAkKCcjd29ybGRfaW5mb19tYXRjaF93aG9sZV93b3JkcycpLnByb3AoJ2NoZWNrZWQnLCB2YWx1ZSkudHJpZ2dlcignaW5wdXQnKTtcbiAgICB9LFxuICAgIHVzZV9ncm91cF9zY29yaW5nOiAodmFsdWU6IExvcmVib29rU2V0dGluZ3NbJ3VzZV9ncm91cF9zY29yaW5nJ10pID0+IHtcbiAgICAgICQoJyN3b3JsZF9pbmZvX3VzZV9ncm91cF9zY29yaW5nJykucHJvcCgnY2hlY2tlZCcsIHZhbHVlKS50cmlnZ2VyKCdjaGFuZ2UnKTtcbiAgICB9LFxuICAgIG92ZXJmbG93X2FsZXJ0OiAodmFsdWU6IExvcmVib29rU2V0dGluZ3NbJ292ZXJmbG93X2FsZXJ0J10pID0+IHtcbiAgICAgICQoJyN3b3JsZF9pbmZvX292ZXJmbG93X2FsZXJ0JykucHJvcCgnY2hlY2tlZCcsIHZhbHVlKS50cmlnZ2VyKCdjaGFuZ2UnKTtcbiAgICB9LFxuICB9O1xuXG4gIE9iamVjdC5lbnRyaWVzKHNldHRpbmdzKVxuICAgIC5maWx0ZXIoKFtfLCB2YWx1ZV0pID0+IHZhbHVlICE9PSB1bmRlZmluZWQpXG4gICAgLmZvckVhY2goKFtmaWVsZCwgdmFsdWVdKSA9PiB7XG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICBmb3JfZWFjaHNbZmllbGRdPy4odmFsdWUpO1xuICAgIH0pO1xufVxuXG50eXBlIEdldENoYXJMb3JlYm9va3NPcHRpb24gPSB7XG4gIG5hbWU/OiBzdHJpbmc7XG4gIHR5cGU/OiAnYWxsJyB8ICdwcmltYXJ5JyB8ICdhZGRpdGlvbmFsJztcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRMb3JlYm9va1NldHRpbmdzKCk6IExvcmVib29rU2V0dGluZ3Mge1xuICBjb25zdCBsb3JlYm9va19zZXR0aW5ncyA9IHRvTG9yZWJvb2tTZXR0aW5ncyhnZXRXb3JsZEluZm9TZXR0aW5ncygpKTtcblxuICBsb2cuaW5mbyhg6I635Y+W5LiW55WM5Lmm5YWo5bGA6K6+572uOlxcbiR7SlNPTi5zdHJpbmdpZnkobG9yZWJvb2tfc2V0dGluZ3MpfWApO1xuICByZXR1cm4gc3RydWN0dXJlZENsb25lKGxvcmVib29rX3NldHRpbmdzKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNldExvcmVib29rU2V0dGluZ3Moc2V0dGluZ3M6IFBhcnRpYWw8TG9yZWJvb2tTZXR0aW5ncz4pOiB2b2lkIHtcbiAgaWYgKHNldHRpbmdzLnNlbGVjdGVkX2dsb2JhbF9sb3JlYm9va3MpIHtcbiAgICBjb25zdCBpbmV4aXN0aW5nX2xvcmVib29rcyA9IHNldHRpbmdzLnNlbGVjdGVkX2dsb2JhbF9sb3JlYm9va3MuZmlsdGVyKGxvcmVib29rID0+ICF3b3JsZF9uYW1lcy5pbmNsdWRlcyhsb3JlYm9vaykpO1xuICAgIGlmIChpbmV4aXN0aW5nX2xvcmVib29rcy5sZW5ndGggPiAwKSB7XG4gICAgICB0aHJvdyBFcnJvcihg5bCd6K+V5L+u5pS56KaB5YWo5bGA5ZCv55So55qE5LiW55WM5LmmLCDkvYbmnKrmib7liLDku6XkuIvkuJbnlYzkuaY6ICR7SlNPTi5zdHJpbmdpZnkoaW5leGlzdGluZ19sb3JlYm9va3MpfWApO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IG9yaWdpbmFsX3NldHRpbmdzID0gZ2V0TG9yZWJvb2tTZXR0aW5ncygpO1xuICBzZXR0aW5ncyA9IF8ub21pdEJ5KHNldHRpbmdzLCAodmFsdWUsIGtleSkgPT4gdmFsdWUgPT09IG9yaWdpbmFsX3NldHRpbmdzW2tleSBhcyBrZXlvZiBMb3JlYm9va1NldHRpbmdzXSk7XG4gIGFzc2lnblBhcnRpYWxMb3JlYm9va1NldHRpbmdzKHNldHRpbmdzKTtcblxuICBsb2cuaW5mbyhg5L+u5pS55LiW55WM5Lmm5YWo5bGA6K6+572uOlxcbiR7SlNPTi5zdHJpbmdpZnkoc2V0dGluZ3MpfWApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TG9yZWJvb2tzKCk6IHN0cmluZ1tdIHtcbiAgbG9nLmluZm8oYOiOt+WPluS4lueVjOS5puWIl+ihqDogJHtKU09OLnN0cmluZ2lmeSh3b3JsZF9uYW1lcyl9YCk7XG4gIHJldHVybiBzdHJ1Y3R1cmVkQ2xvbmUod29ybGRfbmFtZXMpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlTG9yZWJvb2sobG9yZWJvb2s6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICBjb25zdCBzdWNjZXNzID0gYXdhaXQgZGVsZXRlV29ybGRJbmZvKGxvcmVib29rKTtcblxuICBsb2cuaW5mbyhg56e76Zmk5LiW55WM5LmmICcke2xvcmVib29rfScgJHtzdWNjZXNzID8gJ+aIkOWKnycgOiAn5aSx6LSlJ31gKTtcbiAgcmV0dXJuIHN1Y2Nlc3M7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVMb3JlYm9vayhsb3JlYm9vazogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gIGNvbnN0IHN1Y2Nlc3MgPSBhd2FpdCBjcmVhdGVOZXdXb3JsZEluZm8obG9yZWJvb2ssIHsgaW50ZXJhY3RpdmU6IGZhbHNlIH0pO1xuXG4gIGxvZy5pbmZvKGDmlrDlu7rkuJbnlYzkuaYgJyR7bG9yZWJvb2t9JyAke3N1Y2Nlc3MgPyAn5oiQ5YqfJyA6ICflpLHotKUnfWApO1xuICByZXR1cm4gc3VjY2Vzcztcbn1cblxudHlwZSBDaGFyTG9yZWJvb2tzID0ge1xuICBwcmltYXJ5OiBzdHJpbmcgfCBudWxsO1xuICBhZGRpdGlvbmFsOiBzdHJpbmdbXTtcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDaGFyTG9yZWJvb2tzKHtcbiAgbmFtZSA9IChjaGFyYWN0ZXJzIGFzIGFueSlbdGhpc19jaGlkIGFzIHN0cmluZ10/LmF2YXRhciA/PyBudWxsLFxuICB0eXBlID0gJ2FsbCcsXG59OiBHZXRDaGFyTG9yZWJvb2tzT3B0aW9uID0ge30pOiBDaGFyTG9yZWJvb2tzIHtcbiAgY29uc3QgY2hhcmFjdGVyID0gQ2hhcmFjdGVyLmZpbmQoeyBuYW1lOiBuYW1lID8/ICdjdXJyZW50JyB9KTtcbiAgaWYgKCFjaGFyYWN0ZXIpIHtcbiAgICB0aHJvdyBFcnJvcihg5pyq5om+5YiwJHtuYW1lID09PSAnY3VycmVudCcgPyAn5b2T5YmN5omT5byAJyA6IGDlkI3kuLogJyR7bmFtZX0nIGB955qE6KeS6Imy5Y2hYCk7XG4gIH1cblxuICBjb25zdCBib29rczogQ2hhckxvcmVib29rcyA9IHsgcHJpbWFyeTogbnVsbCwgYWRkaXRpb25hbDogW10gfTtcblxuICBpZiAoY2hhcmFjdGVyLmRhdGE/LmV4dGVuc2lvbnM/LndvcmxkKSB7XG4gICAgYm9va3MucHJpbWFyeSA9IGNoYXJhY3Rlci5kYXRhPy5leHRlbnNpb25zPy53b3JsZDtcbiAgfVxuXG4gIC8vIFRPRE86IOaPkOWPluaIkOWHveaVsFxuICBjb25zdCBmaWxlbmFtZSA9IGNoYXJhY3Rlci5hdmF0YXIucmVwbGFjZSgvXFwuW14vLl0rJC8sICcnKTtcbiAgY29uc3QgZXh0cmFfY2hhcmxvcmUgPSAod29ybGRfaW5mbyBhcyB7IGNoYXJMb3JlOiB7IG5hbWU6IHN0cmluZzsgZXh0cmFCb29rczogc3RyaW5nW10gfVtdIH0pLmNoYXJMb3JlPy5maW5kKFxuICAgIGUgPT4gZS5uYW1lID09PSBmaWxlbmFtZSxcbiAgKTtcbiAgaWYgKGV4dHJhX2NoYXJsb3JlICYmIEFycmF5LmlzQXJyYXkoZXh0cmFfY2hhcmxvcmUuZXh0cmFCb29rcykpIHtcbiAgICBib29rcy5hZGRpdGlvbmFsID0gZXh0cmFfY2hhcmxvcmUuZXh0cmFCb29rcztcbiAgfVxuXG4gIGxvZy5pbmZvKGDojrflj5bop5LoibLljaHnu5HlrprnmoTkuJbnlYzkuaYsIOmAiemhuTogJHtKU09OLnN0cmluZ2lmeSh7IG5hbWUsIHR5cGUgfSl9LCDojrflj5bnu5Pmnpw6ICR7SlNPTi5zdHJpbmdpZnkoYm9va3MpfWApO1xuICByZXR1cm4gc3RydWN0dXJlZENsb25lKGJvb2tzKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEN1cnJlbnRDaGFyUHJpbWFyeUxvcmVib29rKCk6IHN0cmluZyB8IG51bGwge1xuICByZXR1cm4gZ2V0Q2hhckxvcmVib29rcygpLnByaW1hcnk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZXRDdXJyZW50Q2hhckxvcmVib29rcyhsb3JlYm9va3M6IFBhcnRpYWw8Q2hhckxvcmVib29rcz4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgZmlsZW5hbWUgPSBnZXRDaGFyYUZpbGVuYW1lKHRoaXNfY2hpZCk7XG4gIGlmICghZmlsZW5hbWUpIHtcbiAgICB0aHJvdyBFcnJvcihg5pyq5omT5byA5Lu75L2V6KeS6Imy5Y2hYCk7XG4gIH1cblxuICBjb25zdCBpbmV4aXN0aW5nX2xvcmVib29rcyA9IF8oXy5jb25jYXQobG9yZWJvb2tzLnByaW1hcnkgPyBbbG9yZWJvb2tzLnByaW1hcnldIDogW10sIGxvcmVib29rcy5hZGRpdGlvbmFsKSlcbiAgICAucmVqZWN0KF8uaXNOdWxsKVxuICAgIC5yZWplY3QobG9yZWJvb2tfbmFtZSA9PiBnZXRMb3JlYm9va3MoKS5zb21lKHZhbHVlID0+IHZhbHVlID09PSBsb3JlYm9va19uYW1lKSlcbiAgICAudmFsdWUoKTtcbiAgaWYgKGluZXhpc3RpbmdfbG9yZWJvb2tzLmxlbmd0aCA+IDApIHtcbiAgICB0aHJvdyBFcnJvcihg5bCd6K+V5L+u5pS5ICcke2ZpbGVuYW1lfScg57uR5a6a55qE5LiW55WM5LmmLCDkvYbmnKrmib7liLDku6XkuIvkuJbnlYzkuaY6ICR7aW5leGlzdGluZ19sb3JlYm9va3N9YCk7XG4gIH1cblxuICBpZiAobG9yZWJvb2tzLnByaW1hcnkgIT09IHVuZGVmaW5lZCkge1xuICAgIGNvbnN0IHByZXZpb3VzX3ByaW1hcnkgPSBTdHJpbmcoJCgnI2NoYXJhY3Rlcl93b3JsZCcpLnZhbCgpKTtcbiAgICAkKCcjY2hhcmFjdGVyX3dvcmxkJykudmFsKGxvcmVib29rcy5wcmltYXJ5ID8gbG9yZWJvb2tzLnByaW1hcnkgOiAnJyk7XG5cbiAgICAkKCcuY2hhcmFjdGVyX3dvcmxkX2luZm9fc2VsZWN0b3InKVxuICAgICAgLmZpbmQoJ29wdGlvbjpzZWxlY3RlZCcpXG4gICAgICAudmFsKGxvcmVib29rcy5wcmltYXJ5ID8gd29ybGRfbmFtZXMuaW5kZXhPZihsb3JlYm9va3MucHJpbWFyeSkgOiAnJyk7XG5cbiAgICBpZiAocHJldmlvdXNfcHJpbWFyeSAmJiAhbG9yZWJvb2tzLnByaW1hcnkpIHtcbiAgICAgIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKFN0cmluZygkKCcjY2hhcmFjdGVyX2pzb25fZGF0YScpLnZhbCgpKSk7XG4gICAgICBpZiAoZGF0YT8uZGF0YT8uY2hhcmFjdGVyX2Jvb2spIHtcbiAgICAgICAgZGF0YS5kYXRhLmNoYXJhY3Rlcl9ib29rID0gdW5kZWZpbmVkO1xuICAgICAgfVxuICAgICAgJCgnI2NoYXJhY3Rlcl9qc29uX2RhdGEnKS52YWwoSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xuICAgIH1cblxuICAgIGlmICghKGF3YWl0IGVkaXRDdXJyZW50Q2hhcmFjdGVyKCkpKSB7XG4gICAgICB0aHJvdyBFcnJvcihg5bCd6K+V5Li6ICcke2ZpbGVuYW1lfScg57uR5a6a5Li76KaB5LiW55WM5LmmLCDkvYblnKjorr/pl67phZLppoblkI7nq6/ml7blh7rplJlgKTtcbiAgICB9XG5cbiAgICAvLyBAdHMtZXhwZWN0LWVycm9yXG4gICAgc2V0V29ybGRJbmZvQnV0dG9uQ2xhc3ModW5kZWZpbmVkLCAhIWxvcmVib29rcy5wcmltYXJ5KTtcbiAgfVxuXG4gIGlmIChsb3JlYm9va3MuYWRkaXRpb25hbCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgdHlwZSBDaGFyTG9yZUVudHJ5ID0ge1xuICAgICAgbmFtZTogc3RyaW5nO1xuICAgICAgZXh0cmFCb29rczogc3RyaW5nW107XG4gICAgfTtcbiAgICBjb25zdCBjaGFyX2xvcmUgPSAod29ybGRfaW5mbyBhcyB7IGNoYXJMb3JlOiBDaGFyTG9yZUVudHJ5W10gfSkuY2hhckxvcmUgPz8gW107XG5cbiAgICBjb25zdCBleGlzdGluZ19jaGFyX2luZGV4ID0gY2hhcl9sb3JlLmZpbmRJbmRleChlbnRyeSA9PiBlbnRyeS5uYW1lID09PSBmaWxlbmFtZSk7XG4gICAgaWYgKGV4aXN0aW5nX2NoYXJfaW5kZXggPT09IC0xKSB7XG4gICAgICBjaGFyX2xvcmUucHVzaCh7IG5hbWU6IGZpbGVuYW1lLCBleHRyYUJvb2tzOiBsb3JlYm9va3MuYWRkaXRpb25hbCB9KTtcbiAgICB9IGVsc2UgaWYgKGxvcmVib29rcy5hZGRpdGlvbmFsLmxlbmd0aCA9PT0gMCkge1xuICAgICAgY2hhcl9sb3JlLnNwbGljZShleGlzdGluZ19jaGFyX2luZGV4LCAxKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY2hhcl9sb3JlW2V4aXN0aW5nX2NoYXJfaW5kZXhdLmV4dHJhQm9va3MgPSBsb3JlYm9va3MuYWRkaXRpb25hbDtcbiAgICB9XG5cbiAgICBPYmplY3QuYXNzaWduKHdvcmxkX2luZm8sIHsgY2hhckxvcmU6IGNoYXJfbG9yZSB9KTtcbiAgfVxuXG4gIHNhdmVDaGFyYWN0ZXJEZWJvdW5jZWQoKTtcbiAgc2F2ZVNldHRpbmdzRGVib3VuY2VkKCk7XG5cbiAgbG9nLmluZm8oXG4gICAgYOS/ruaUueinkuiJsuWNoee7keWumueahOS4lueVjOS5piwg6KaB5L+u5pS555qE6YOo5YiGOiAke0pTT04uc3RyaW5naWZ5KGxvcmVib29rcyl9JHtcbiAgICAgIGxvcmVib29rcy5wcmltYXJ5ID09PSB1bmRlZmluZWQgPyAnLCDkuLvopoHkuJbnlYzkuabkv53mjIHkuI3lj5gnIDogJydcbiAgICB9JHtsb3JlYm9va3MuYWRkaXRpb25hbCA9PT0gdW5kZWZpbmVkID8gJywg6ZmE5Yqg5LiW55WM5Lmm5L+d5oyB5LiN5Y+YJyA6ICcnfWAsXG4gICk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDaGF0TG9yZWJvb2soKTogc3RyaW5nIHwgbnVsbCB7XG4gIGNvbnN0IGNoYXRfaWQgPSBnZXRDdXJyZW50Q2hhdElkKCk7XG4gIGlmICghY2hhdF9pZCkge1xuICAgIHRocm93IEVycm9yKGDmnKrmiZPlvIDku7vkvZXogYrlpKksIOS4jeWPr+iOt+WPluiBiuWkqeS4lueVjOS5pmApO1xuICB9XG5cbiAgY29uc3QgZXhpc3RpbmdfbG9yZWJvb2sgPSBfLmdldChjaGF0X21ldGFkYXRhLCBNRVRBREFUQV9LRVksICcnKSBhcyBzdHJpbmc7XG4gIGlmICh3b3JsZF9uYW1lcy5pbmNsdWRlcyhleGlzdGluZ19sb3JlYm9vaykpIHtcbiAgICByZXR1cm4gZXhpc3RpbmdfbG9yZWJvb2s7XG4gIH1cbiAgXy51bnNldChjaGF0X21ldGFkYXRhLCBNRVRBREFUQV9LRVkpO1xuICByZXR1cm4gbnVsbDtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNldENoYXRMb3JlYm9vayhsb3JlYm9vazogc3RyaW5nIHwgbnVsbCk6IFByb21pc2U8dm9pZD4ge1xuICBpZiAobG9yZWJvb2sgPT09IG51bGwpIHtcbiAgICBfLnVuc2V0KGNoYXRfbWV0YWRhdGEsIE1FVEFEQVRBX0tFWSk7XG4gICAgJCgnLmNoYXRfbG9yZWJvb2tfYnV0dG9uJykucmVtb3ZlQ2xhc3MoJ3dvcmxkX3NldCcpO1xuICB9IGVsc2Uge1xuICAgIGlmICghd29ybGRfbmFtZXMuaW5jbHVkZXMobG9yZWJvb2spKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYOWwneivleS4uuinkuiJsuWNoee7keWumuiBiuWkqeS4lueVjOS5piwg5L2G6K+l5LiW55WM5LmmICcke2xvcmVib29rfScg5LiN5a2Y5ZyoYCk7XG4gICAgfVxuXG4gICAgXy5zZXQoY2hhdF9tZXRhZGF0YSwgTUVUQURBVEFfS0VZLCBsb3JlYm9vayk7XG4gICAgJCgnLmNoYXRfbG9yZWJvb2tfYnV0dG9uJykuYWRkQ2xhc3MoJ3dvcmxkX3NldCcpO1xuICB9XG4gIGF3YWl0IHNhdmVNZXRhZGF0YSgpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0T3JDcmVhdGVDaGF0TG9yZWJvb2sobG9yZWJvb2s/OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICBjb25zdCBleGlzdGluZ19sb3JlYm9vayA9IGF3YWl0IGdldENoYXRMb3JlYm9vaygpO1xuICBpZiAoZXhpc3RpbmdfbG9yZWJvb2sgIT09IG51bGwpIHtcbiAgICByZXR1cm4gZXhpc3RpbmdfbG9yZWJvb2s7XG4gIH1cblxuICBjb25zdCBuZXdfbG9yZWJvb2sgPSAoKCkgPT4ge1xuICAgIGlmIChsb3JlYm9vaykge1xuICAgICAgaWYgKHdvcmxkX25hbWVzLmluY2x1ZGVzKGxvcmVib29rKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYOWwneivleWIm+W7uuiBiuWkqeS4lueVjOS5piwg5L2G6K+l5ZCN56ewICcke2xvcmVib29rfScg5bey5a2Y5ZyoYCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gbG9yZWJvb2s7XG4gICAgfVxuXG4gICAgcmV0dXJuIGBDaGF0IEJvb2sgJHtnZXRDdXJyZW50Q2hhdElkKCl9YFxuICAgICAgLnJlcGxhY2UoL1teYS16MC05XS9naSwgJ18nKVxuICAgICAgLnJlcGxhY2UoL197Mix9L2csICdfJylcbiAgICAgIC5zdWJzdHJpbmcoMCwgNjQpO1xuICB9KSgpO1xuICBhd2FpdCBjcmVhdGVOZXdXb3JsZEluZm8obmV3X2xvcmVib29rKTtcblxuICBhd2FpdCBzZXRDaGF0TG9yZWJvb2sobmV3X2xvcmVib29rKTtcbiAgcmV0dXJuIG5ld19sb3JlYm9vaztcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/function/lorebook.ts\n\n}")},"./src/function/lorebook_entry.ts":
/*!****************************************!*\
  !*** ./src/function/lorebook_entry.ts ***!
  \****************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createLorebookEntries: () => (/* binding */ createLorebookEntries),\n/* harmony export */   createLorebookEntry: () => (/* binding */ createLorebookEntry),\n/* harmony export */   deleteLorebookEntries: () => (/* binding */ deleteLorebookEntries),\n/* harmony export */   deleteLorebookEntry: () => (/* binding */ deleteLorebookEntry),\n/* harmony export */   getLorebookEntries: () => (/* binding */ getLorebookEntries),\n/* harmony export */   replaceLorebookEntries: () => (/* binding */ replaceLorebookEntries),\n/* harmony export */   setLorebookEntries: () => (/* binding */ setLorebookEntries),\n/* harmony export */   updateLorebookEntriesWith: () => (/* binding */ updateLorebookEntriesWith)\n/* harmony export */ });\n/* harmony import */ var _compatibility__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/compatibility */ \"./src/compatibility.ts\");\n/* harmony import */ var _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/world-info */ \"@sillytavern/scripts/world-info\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\nconst default_original_lorebook_entry = {\n    key: [],\n    keysecondary: [],\n    comment: '',\n    content: '',\n    constant: false,\n    vectorized: false,\n    selective: true,\n    selectiveLogic: 0,\n    addMemo: true,\n    order: 100,\n    position: 0,\n    disable: false,\n    excludeRecursion: false,\n    preventRecursion: false,\n    matchPersonaDescription: false,\n    matchCharacterDescription: false,\n    matchCharacterPersonality: false,\n    matchCharacterDepthPrompt: false,\n    matchScenario: false,\n    matchCreatorNotes: false,\n    delayUntilRecursion: 0,\n    probability: 100,\n    useProbability: true,\n    depth: 4,\n    group: '',\n    groupOverride: false,\n    groupWeight: 100,\n    scanDepth: null,\n    caseSensitive: null,\n    matchWholeWords: null,\n    useGroupScoring: null,\n    automationId: '',\n    role: 0,\n    sticky: null,\n    cooldown: null,\n    delay: null,\n};\nfunction toLorebookEntry(entry) {\n    return {\n        uid: entry.uid,\n        display_index: entry.displayIndex,\n        comment: entry.comment,\n        enabled: !entry.disable,\n        type: entry.constant ? 'constant' : entry.vectorized ? 'vectorized' : 'selective',\n        // @ts-ignore\n        position: {\n            0: 'before_character_definition',\n            1: 'after_character_definition',\n            5: 'before_example_messages',\n            6: 'after_example_messages',\n            2: 'before_author_note',\n            3: 'after_author_note',\n        }[entry.position] ??\n            (entry.role === 1 ? 'at_depth_as_user' : entry.role === 2 ? 'at_depth_as_assistant' : 'at_depth_as_system'),\n        depth: entry.position === 4 ? entry.depth : null,\n        order: entry.order,\n        probability: entry.probability,\n        key: entry.key,\n        keys: entry.key,\n        logic: {\n            0: 'and_any',\n            1: 'not_all',\n            2: 'not_any',\n            3: 'and_all',\n        }[entry.selectiveLogic],\n        filter: entry.keysecondary,\n        filters: entry.keysecondary,\n        scan_depth: entry.scanDepth ?? 'same_as_global',\n        case_sensitive: entry.caseSensitive ?? 'same_as_global',\n        match_whole_words: entry.matchWholeWords ?? 'same_as_global',\n        use_group_scoring: entry.useGroupScoring ?? 'same_as_global',\n        automation_id: entry.automationId || null,\n        exclude_recursion: entry.excludeRecursion,\n        prevent_recursion: entry.preventRecursion,\n        delay_until_recursion: entry.delayUntilRecursion,\n        content: entry.content,\n        group: entry.group,\n        group_prioritized: entry.groupOverride,\n        group_weight: entry.groupWeight,\n        sticky: entry.sticky || null,\n        cooldown: entry.cooldown || null,\n        delay: entry.delay || null,\n    };\n}\nasync function getLorebookEntries(lorebook, { filter = 'none' } = {}) {\n    if (!_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_1__.world_names.includes(lorebook)) {\n        throw Error(`未能找到世界书 '${lorebook}'`);\n    }\n    const data = (await (0,_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_1__.loadWorldInfo)(lorebook));\n    let entries = _(data.entries).values().map(toLorebookEntry).value();\n    if (filter !== 'none') {\n        entries = entries.filter(entry => Object.entries(filter).every(([field, expected_value]) => {\n            // @ts-ignore\n            const entry_value = entry[field];\n            if (Array.isArray(entry_value)) {\n                return expected_value.every(value => entry_value.includes(value));\n            }\n            if (typeof entry_value === 'string') {\n                return entry_value.includes(expected_value);\n            }\n            return entry_value === expected_value;\n        }));\n    }\n    loglevel__WEBPACK_IMPORTED_MODULE_2___default().info(`获取世界书 '${lorebook}' 中的条目, 选项: ${JSON.stringify({ filter })}`);\n    return structuredClone(entries);\n}\nfunction fromPartialLorebookEntry(entry) {\n    const transformers = {\n        uid: (value) => ({ uid: value }),\n        display_index: (value) => ({ displayIndex: value }),\n        comment: (value) => ({ comment: value }),\n        enabled: (value) => ({ disable: !value }),\n        type: (value) => ({\n            constant: value === 'constant',\n            vectorized: value === 'vectorized',\n        }),\n        position: (value) => ({\n            position: {\n                before_character_definition: 0,\n                after_character_definition: 1,\n                before_example_messages: 5,\n                after_example_messages: 6,\n                before_author_note: 2,\n                after_author_note: 3,\n                at_depth_as_system: 4,\n                at_depth_as_user: 4,\n                at_depth_as_assistant: 4,\n            }[value],\n            role: \n            // @ts-ignore\n            {\n                at_depth_as_system: 0,\n                at_depth_as_user: 1,\n                at_depth_as_assistant: 2,\n            }[value] ?? null,\n        }),\n        depth: (value) => ({ depth: value === null ? 4 : value }),\n        order: (value) => ({ order: value }),\n        probability: (value) => ({ probability: value }),\n        keys: (value) => ({ key: value }),\n        logic: (value) => ({\n            selectiveLogic: {\n                and_any: 0,\n                not_all: 1,\n                not_any: 2,\n                and_all: 3,\n            }[value],\n        }),\n        filters: (value) => ({ keysecondary: value }),\n        scan_depth: (value) => ({ scanDepth: value === 'same_as_global' ? null : value }),\n        case_sensitive: (value) => ({\n            caseSensitive: value === 'same_as_global' ? null : value,\n        }),\n        match_whole_words: (value) => ({\n            matchWholeWords: value === 'same_as_global' ? null : value,\n        }),\n        use_group_scoring: (value) => ({\n            useGroupScoring: value === 'same_as_global' ? null : value,\n        }),\n        automation_id: (value) => ({ automationId: value === null ? '' : value }),\n        exclude_recursion: (value) => ({ excludeRecursion: value }),\n        prevent_recursion: (value) => ({ preventRecursion: value }),\n        delay_until_recursion: (value) => ({ delayUntilRecursion: value }),\n        content: (value) => ({ content: value }),\n        group: (value) => ({ group: value }),\n        group_prioritized: (value) => ({ groupOverride: value }),\n        group_weight: (value) => ({ groupWeight: value }),\n        sticky: (value) => ({ sticky: value === null ? 0 : value }),\n        cooldown: (value) => ({ cooldown: value === null ? 0 : value }),\n        delay: (value) => ({ delay: value === null ? 0 : value }),\n    };\n    return _.merge({}, default_original_lorebook_entry, ...Object.entries(entry)\n        .filter(([_, value]) => value !== undefined)\n        // @ts-ignore\n        .map(([key, value]) => transformers[key]?.(value)));\n}\nconst MAX_UID = 1_000_000;\nfunction handleLorebookEntriesCollision(entries) {\n    const uid_set = new Set();\n    const handle_uid_collision = (index) => {\n        if (index === undefined) {\n            index = _.random(0, MAX_UID - 1);\n        }\n        let i = 1;\n        while (true) {\n            if (!uid_set.has(index)) {\n                uid_set.add(index);\n                return index;\n            }\n            index = (index + i * i) % MAX_UID;\n            ++i;\n        }\n    };\n    let max_display_index = _.max(entries.map(entry => entry.display_index ?? -1)) ?? -1;\n    return entries.map(entry => ({\n        ...entry,\n        uid: handle_uid_collision(entry.uid),\n        display_index: entry.display_index ?? ++max_display_index,\n    }));\n}\nasync function replaceLorebookEntries(lorebook, entries) {\n    if (!_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_1__.world_names.includes(lorebook)) {\n        throw Error(`未能找到世界书 '${lorebook}'`);\n    }\n    const data = {\n        entries: _.merge({}, ...handleLorebookEntriesCollision(entries)\n            .map(fromPartialLorebookEntry)\n            .map(entry => ({ [entry.uid]: entry }))),\n    };\n    await (0,_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_1__.saveWorldInfo)(lorebook, data);\n    (0,_compatibility__WEBPACK_IMPORTED_MODULE_0__.reloadEditorDebounced)(lorebook);\n    loglevel__WEBPACK_IMPORTED_MODULE_2___default().info(`更新世界书 '${lorebook}' 中的条目`);\n}\nasync function updateLorebookEntriesWith(lorebook, updater) {\n    loglevel__WEBPACK_IMPORTED_MODULE_2___default().info(`对世界书 '${lorebook}' 中的条目进行更新`);\n    await replaceLorebookEntries(lorebook, await updater(await getLorebookEntries(lorebook)));\n    return getLorebookEntries(lorebook);\n}\nasync function setLorebookEntries(lorebook, entries) {\n    return await updateLorebookEntriesWith(lorebook, data => {\n        for (const entry_to_set of entries) {\n            const data_entry = data.find(entry => entry.uid === entry_to_set.uid);\n            if (data_entry) {\n                _.merge(data_entry, entry_to_set);\n            }\n        }\n        return data;\n    });\n}\nasync function createLorebookEntries(lorebook, entries) {\n    const new_uids = [];\n    const updated_entries = await updateLorebookEntriesWith(lorebook, data => {\n        const uid_set = new Set(data.map(entry => entry.uid));\n        const get_free_uid = () => {\n            for (let i = 0; i < MAX_UID; ++i) {\n                if (!uid_set.has(i)) {\n                    uid_set.add(i);\n                    new_uids.push(i);\n                    return i;\n                }\n            }\n            throw Error(`无法找到可用的世界书条目 uid`);\n        };\n        entries.forEach(entry => (entry.uid = get_free_uid()));\n        return [...data, ...entries];\n    });\n    return { entries: updated_entries, new_uids: new_uids };\n}\nasync function deleteLorebookEntries(lorebook, uids) {\n    let deleted = false;\n    const updated_entires = await updateLorebookEntriesWith(lorebook, data => {\n        const removed_data = _.remove(data, entry => uids.includes(entry.uid));\n        deleted = removed_data.length > 0;\n        return data;\n    });\n    return { entries: updated_entires, delete_occurred: deleted };\n}\n//----------------------------------------------------------------------------------------------------------------------\n/** @deprecated 请使用 `createLorebookEntries` 代替 */\nasync function createLorebookEntry(lorebook, field_values) {\n    return (await createLorebookEntries(lorebook, [field_values])).new_uids[0];\n}\n/** @deprecated 请使用 `deleteLorebookEntries` 代替 */\nasync function deleteLorebookEntry(lorebook, uid) {\n    return (await deleteLorebookEntries(lorebook, [uid])).delete_occurred;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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YztJQUVkLElBQUksT0FBTyxHQUFZLEtBQUssQ0FBQztJQUM3QixNQUFNLGVBQWUsR0FBRyxNQUFNLHlCQUF5QixDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsRUFBRTtRQUN2RSxNQUFNLFlBQVksR0FBRyxDQUFDLENBQUMsTUFBTSxDQUFDLElBQUksRUFBRSxLQUFLLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDdkUsT0FBTyxHQUFHLFlBQVksQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDO1FBQ2xDLE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQyxDQUFDLENBQUM7SUFDSCxPQUFPLEVBQUUsT0FBTyxFQUFFLGVBQWUsRUFBRSxlQUFlLEVBQUUsT0FBTyxFQUFFLENBQUM7QUFDaEUsQ0FBQztBQUVELHdIQUF3SDtBQUN4SCxpREFBaUQ7QUFDMUMsS0FBSyxVQUFVLG1CQUFtQixDQUFDLFFBQWdCLEVBQUUsWUFBb0M7SUFDOUYsT0FBTyxDQUFDLE1BQU0scUJBQXFCLENBQUMsUUFBUSxFQUFFLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUM3RSxDQUFDO0FBRUQsaURBQWlEO0FBQzFDLEtBQUssVUFBVSxtQkFBbUIsQ0FBQyxRQUFnQixFQUFFLEdBQVc7SUFDckUsT0FBTyxDQUFDLE1BQU0scUJBQXFCLENBQUMsUUFBUSxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLGVBQWUsQ0FBQztBQUN4RSxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2Z1bmN0aW9uL2xvcmVib29rX2VudHJ5LnRzPzJhZjgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcmVsb2FkRWRpdG9yRGVib3VuY2VkIH0gZnJvbSAnQC9jb21wYXRpYmlsaXR5JztcblxuaW1wb3J0IHsgbG9hZFdvcmxkSW5mbywgc2F2ZVdvcmxkSW5mbywgd29ybGRfbmFtZXMgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy93b3JsZC1pbmZvJztcblxuaW1wb3J0IGxvZyBmcm9tICdsb2dsZXZlbCc7XG5cbnR5cGUgTG9yZWJvb2tFbnRyeSA9IHtcbiAgdWlkOiBudW1iZXI7XG4gIGRpc3BsYXlfaW5kZXg6IG51bWJlcjtcblxuICBjb21tZW50OiBzdHJpbmc7XG4gIGVuYWJsZWQ6IGJvb2xlYW47XG4gIHR5cGU6ICdjb25zdGFudCcgfCAnc2VsZWN0aXZlJyB8ICd2ZWN0b3JpemVkJztcbiAgcG9zaXRpb246XG4gICAgfCAnYmVmb3JlX2NoYXJhY3Rlcl9kZWZpbml0aW9uJyAvLyDop5LoibLlrprkuYnkuYvliY1cbiAgICB8ICdhZnRlcl9jaGFyYWN0ZXJfZGVmaW5pdGlvbicgLy8g6KeS6Imy5a6a5LmJ5LmL5ZCOXG4gICAgfCAnYmVmb3JlX2V4YW1wbGVfbWVzc2FnZXMnIC8vIOekuuS+i+a2iOaBr+S5i+WJjVxuICAgIHwgJ2FmdGVyX2V4YW1wbGVfbWVzc2FnZXMnIC8vIOekuuS+i+a2iOaBr+S5i+WQjlxuICAgIHwgJ2JlZm9yZV9hdXRob3Jfbm90ZScgLy8g5L2c6ICF5rOo6YeK5LmL5YmNXG4gICAgfCAnYWZ0ZXJfYXV0aG9yX25vdGUnIC8vIOS9nOiAheazqOmHiuS5i+WQjlxuICAgIHwgJ2F0X2RlcHRoX2FzX3N5c3RlbScgLy8gQETimplcbiAgICB8ICdhdF9kZXB0aF9hc19hc3Npc3RhbnQnIC8vIEBE8J+RpFxuICAgIHwgJ2F0X2RlcHRoX2FzX3VzZXInOyAvLyBARPCfpJZcbiAgZGVwdGg6IG51bWJlciB8IG51bGw7XG4gIG9yZGVyOiBudW1iZXI7XG4gIHByb2JhYmlsaXR5OiBudW1iZXI7XG5cbiAgLyoqIEBkZXByZWNhdGVkIOivt+S9v+eUqCBga2V5c2Ag5Luj5pu/ICovXG4gIGtleTogc3RyaW5nW107XG4gIGtleXM6IHN0cmluZ1tdO1xuICBsb2dpYzogJ2FuZF9hbnknIHwgJ2FuZF9hbGwnIHwgJ25vdF9hbGwnIHwgJ25vdF9hbnknO1xuICAvKiogQGRlcHJlY2F0ZWQg6K+35L2/55SoIGBmaWx0ZXJzYCDku6Pmm78gKi9cbiAgZmlsdGVyOiBzdHJpbmdbXTtcbiAgZmlsdGVyczogc3RyaW5nW107XG5cbiAgc2Nhbl9kZXB0aDogJ3NhbWVfYXNfZ2xvYmFsJyB8IG51bWJlcjtcbiAgY2FzZV9zZW5zaXRpdmU6ICdzYW1lX2FzX2dsb2JhbCcgfCBib29sZWFuO1xuICBtYXRjaF93aG9sZV93b3JkczogJ3NhbWVfYXNfZ2xvYmFsJyB8IGJvb2xlYW47XG4gIHVzZV9ncm91cF9zY29yaW5nOiAnc2FtZV9hc19nbG9iYWwnIHwgYm9vbGVhbjtcbiAgYXV0b21hdGlvbl9pZDogc3RyaW5nIHwgbnVsbDtcblxuICBleGNsdWRlX3JlY3Vyc2lvbjogYm9vbGVhbjtcbiAgcHJldmVudF9yZWN1cnNpb246IGJvb2xlYW47XG4gIGRlbGF5X3VudGlsX3JlY3Vyc2lvbjogYm9vbGVhbiB8IG51bWJlcjtcblxuICBjb250ZW50OiBzdHJpbmc7XG5cbiAgZ3JvdXA6IHN0cmluZztcbiAgZ3JvdXBfcHJpb3JpdGl6ZWQ6IGJvb2xlYW47XG4gIGdyb3VwX3dlaWdodDogbnVtYmVyO1xuICBzdGlja3k6IG51bWJlciB8IG51bGw7XG4gIGNvb2xkb3duOiBudW1iZXIgfCBudWxsO1xuICBkZWxheTogbnVtYmVyIHwgbnVsbDtcbn07XG5cbnR5cGUgX09yaWdpbmFsTG9yZWJvb2tFbnRyeSA9IHtcbiAgdWlkOiBudW1iZXI7XG4gIGtleTogc3RyaW5nW107XG4gIGtleXNlY29uZGFyeTogc3RyaW5nW107XG4gIGNvbW1lbnQ6IHN0cmluZztcbiAgY29udGVudDogc3RyaW5nO1xuICBjb25zdGFudDogYm9vbGVhbjtcbiAgdmVjdG9yaXplZDogYm9vbGVhbjtcbiAgc2VsZWN0aXZlOiBib29sZWFuO1xuICBzZWxlY3RpdmVMb2dpYzogMCB8IDEgfCAyIHwgMzsgLy8gMDogYW5kX2FueSwgMTogbm90X2FsbCwgMjogbm90X2FueSwgMzogYW5kX2FsbFxuICBhZGRNZW1vOiBib29sZWFuO1xuICBvcmRlcjogbnVtYmVyO1xuICBwb3NpdGlvbjogbnVtYmVyO1xuICBkaXNhYmxlOiBib29sZWFuO1xuICBleGNsdWRlUmVjdXJzaW9uOiBib29sZWFuO1xuICBwcmV2ZW50UmVjdXJzaW9uOiBib29sZWFuO1xuICBtYXRjaFBlcnNvbmFEZXNjcmlwdGlvbjogYm9vbGVhbjtcbiAgbWF0Y2hDaGFyYWN0ZXJEZXNjcmlwdGlvbjogYm9vbGVhbjtcbiAgbWF0Y2hDaGFyYWN0ZXJQZXJzb25hbGl0eTogYm9vbGVhbjtcbiAgbWF0Y2hDaGFyYWN0ZXJEZXB0aFByb21wdDogYm9vbGVhbjtcbiAgbWF0Y2hTY2VuYXJpbzogYm9vbGVhbjtcbiAgbWF0Y2hDcmVhdG9yTm90ZXM6IGJvb2xlYW47XG4gIGRlbGF5VW50aWxSZWN1cnNpb246IG51bWJlcjtcbiAgcHJvYmFiaWxpdHk6IG51bWJlcjtcbiAgdXNlUHJvYmFiaWxpdHk6IGJvb2xlYW47XG4gIGRlcHRoOiBudW1iZXI7XG4gIGdyb3VwOiBzdHJpbmc7XG4gIGdyb3VwT3ZlcnJpZGU6IGJvb2xlYW47XG4gIGdyb3VwV2VpZ2h0OiBudW1iZXI7XG4gIHNjYW5EZXB0aDogbnVtYmVyIHwgbnVsbDtcbiAgY2FzZVNlbnNpdGl2ZTogYm9vbGVhbiB8IG51bGw7XG4gIG1hdGNoV2hvbGVXb3JkczogYm9vbGVhbiB8IG51bGw7XG4gIHVzZUdyb3VwU2NvcmluZzogYm9vbGVhbiB8IG51bGw7XG4gIGF1dG9tYXRpb25JZDogc3RyaW5nO1xuICByb2xlOiAwIHwgMSB8IDI7IC8vIDA6IHN5c3RlbSwgMTogdXNlciwgMjogYXNzaXN0YW50XG4gIHN0aWNreTogbnVtYmVyIHwgbnVsbDtcbiAgY29vbGRvd246IG51bWJlciB8IG51bGw7XG4gIGRlbGF5OiBudW1iZXIgfCBudWxsO1xuICBkaXNwbGF5SW5kZXg6IG51bWJlcjtcbn07XG5cbmNvbnN0IGRlZmF1bHRfb3JpZ2luYWxfbG9yZWJvb2tfZW50cnk6IE9taXQ8X09yaWdpbmFsTG9yZWJvb2tFbnRyeSwgJ3VpZCcgfCAnZGlzcGxheUluZGV4Jz4gPSB7XG4gIGtleTogW10sXG4gIGtleXNlY29uZGFyeTogW10sXG4gIGNvbW1lbnQ6ICcnLFxuICBjb250ZW50OiAnJyxcbiAgY29uc3RhbnQ6IGZhbHNlLFxuICB2ZWN0b3JpemVkOiBmYWxzZSxcbiAgc2VsZWN0aXZlOiB0cnVlLFxuICBzZWxlY3RpdmVMb2dpYzogMCxcbiAgYWRkTWVtbzogdHJ1ZSxcbiAgb3JkZXI6IDEwMCxcbiAgcG9zaXRpb246IDAsXG4gIGRpc2FibGU6IGZhbHNlLFxuICBleGNsdWRlUmVjdXJzaW9uOiBmYWxzZSxcbiAgcHJldmVudFJlY3Vyc2lvbjogZmFsc2UsXG4gIG1hdGNoUGVyc29uYURlc2NyaXB0aW9uOiBmYWxzZSxcbiAgbWF0Y2hDaGFyYWN0ZXJEZXNjcmlwdGlvbjogZmFsc2UsXG4gIG1hdGNoQ2hhcmFjdGVyUGVyc29uYWxpdHk6IGZhbHNlLFxuICBtYXRjaENoYXJhY3RlckRlcHRoUHJvbXB0OiBmYWxzZSxcbiAgbWF0Y2hTY2VuYXJpbzogZmFsc2UsXG4gIG1hdGNoQ3JlYXRvck5vdGVzOiBmYWxzZSxcbiAgZGVsYXlVbnRpbFJlY3Vyc2lvbjogMCxcbiAgcHJvYmFiaWxpdHk6IDEwMCxcbiAgdXNlUHJvYmFiaWxpdHk6IHRydWUsXG4gIGRlcHRoOiA0LFxuICBncm91cDogJycsXG4gIGdyb3VwT3ZlcnJpZGU6IGZhbHNlLFxuICBncm91cFdlaWdodDogMTAwLFxuICBzY2FuRGVwdGg6IG51bGwsXG4gIGNhc2VTZW5zaXRpdmU6IG51bGwsXG4gIG1hdGNoV2hvbGVXb3JkczogbnVsbCxcbiAgdXNlR3JvdXBTY29yaW5nOiBudWxsLFxuICBhdXRvbWF0aW9uSWQ6ICcnLFxuICByb2xlOiAwLFxuICBzdGlja3k6IG51bGwsXG4gIGNvb2xkb3duOiBudWxsLFxuICBkZWxheTogbnVsbCxcbn07XG5cbmZ1bmN0aW9uIHRvTG9yZWJvb2tFbnRyeShlbnRyeTogX09yaWdpbmFsTG9yZWJvb2tFbnRyeSk6IExvcmVib29rRW50cnkge1xuICByZXR1cm4ge1xuICAgIHVpZDogZW50cnkudWlkLFxuICAgIGRpc3BsYXlfaW5kZXg6IGVudHJ5LmRpc3BsYXlJbmRleCxcblxuICAgIGNvbW1lbnQ6IGVudHJ5LmNvbW1lbnQsXG4gICAgZW5hYmxlZDogIWVudHJ5LmRpc2FibGUsXG4gICAgdHlwZTogZW50cnkuY29uc3RhbnQgPyAnY29uc3RhbnQnIDogZW50cnkudmVjdG9yaXplZCA/ICd2ZWN0b3JpemVkJyA6ICdzZWxlY3RpdmUnLFxuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBwb3NpdGlvbjpcbiAgICAgIHtcbiAgICAgICAgMDogJ2JlZm9yZV9jaGFyYWN0ZXJfZGVmaW5pdGlvbicsXG4gICAgICAgIDE6ICdhZnRlcl9jaGFyYWN0ZXJfZGVmaW5pdGlvbicsXG4gICAgICAgIDU6ICdiZWZvcmVfZXhhbXBsZV9tZXNzYWdlcycsXG4gICAgICAgIDY6ICdhZnRlcl9leGFtcGxlX21lc3NhZ2VzJyxcbiAgICAgICAgMjogJ2JlZm9yZV9hdXRob3Jfbm90ZScsXG4gICAgICAgIDM6ICdhZnRlcl9hdXRob3Jfbm90ZScsXG4gICAgICB9W2VudHJ5LnBvc2l0aW9uXSA/P1xuICAgICAgKGVudHJ5LnJvbGUgPT09IDEgPyAnYXRfZGVwdGhfYXNfdXNlcicgOiBlbnRyeS5yb2xlID09PSAyID8gJ2F0X2RlcHRoX2FzX2Fzc2lzdGFudCcgOiAnYXRfZGVwdGhfYXNfc3lzdGVtJyksXG4gICAgZGVwdGg6IGVudHJ5LnBvc2l0aW9uID09PSA0ID8gZW50cnkuZGVwdGggOiBudWxsLFxuICAgIG9yZGVyOiBlbnRyeS5vcmRlcixcbiAgICBwcm9iYWJpbGl0eTogZW50cnkucHJvYmFiaWxpdHksXG5cbiAgICBrZXk6IGVudHJ5LmtleSxcbiAgICBrZXlzOiBlbnRyeS5rZXksXG4gICAgbG9naWM6IHtcbiAgICAgIDA6ICdhbmRfYW55JyxcbiAgICAgIDE6ICdub3RfYWxsJyxcbiAgICAgIDI6ICdub3RfYW55JyxcbiAgICAgIDM6ICdhbmRfYWxsJyxcbiAgICB9W2VudHJ5LnNlbGVjdGl2ZUxvZ2ljIGFzIG51bWJlcl0gYXMgJ2FuZF9hbnknIHwgJ2FuZF9hbGwnIHwgJ25vdF9hbnknIHwgJ25vdF9hbGwnLFxuICAgIGZpbHRlcjogZW50cnkua2V5c2Vjb25kYXJ5LFxuICAgIGZpbHRlcnM6IGVudHJ5LmtleXNlY29uZGFyeSxcblxuICAgIHNjYW5fZGVwdGg6IGVudHJ5LnNjYW5EZXB0aCA/PyAnc2FtZV9hc19nbG9iYWwnLFxuICAgIGNhc2Vfc2Vuc2l0aXZlOiBlbnRyeS5jYXNlU2Vuc2l0aXZlID8/ICdzYW1lX2FzX2dsb2JhbCcsXG4gICAgbWF0Y2hfd2hvbGVfd29yZHM6IGVudHJ5Lm1hdGNoV2hvbGVXb3JkcyA/PyAnc2FtZV9hc19nbG9iYWwnLFxuICAgIHVzZV9ncm91cF9zY29yaW5nOiBlbnRyeS51c2VHcm91cFNjb3JpbmcgPz8gJ3NhbWVfYXNfZ2xvYmFsJyxcbiAgICBhdXRvbWF0aW9uX2lkOiBlbnRyeS5hdXRvbWF0aW9uSWQgfHwgbnVsbCxcblxuICAgIGV4Y2x1ZGVfcmVjdXJzaW9uOiBlbnRyeS5leGNsdWRlUmVjdXJzaW9uLFxuICAgIHByZXZlbnRfcmVjdXJzaW9uOiBlbnRyeS5wcmV2ZW50UmVjdXJzaW9uLFxuICAgIGRlbGF5X3VudGlsX3JlY3Vyc2lvbjogZW50cnkuZGVsYXlVbnRpbFJlY3Vyc2lvbixcblxuICAgIGNvbnRlbnQ6IGVudHJ5LmNvbnRlbnQsXG5cbiAgICBncm91cDogZW50cnkuZ3JvdXAsXG4gICAgZ3JvdXBfcHJpb3JpdGl6ZWQ6IGVudHJ5Lmdyb3VwT3ZlcnJpZGUsXG4gICAgZ3JvdXBfd2VpZ2h0OiBlbnRyeS5ncm91cFdlaWdodCxcbiAgICBzdGlja3k6IGVudHJ5LnN0aWNreSB8fCBudWxsLFxuICAgIGNvb2xkb3duOiBlbnRyeS5jb29sZG93biB8fCBudWxsLFxuICAgIGRlbGF5OiBlbnRyeS5kZWxheSB8fCBudWxsLFxuICB9O1xufVxuXG5pbnRlcmZhY2UgR2V0TG9yZWJvb2tFbnRyaWVzT3B0aW9uIHtcbiAgZmlsdGVyPzogJ25vbmUnIHwgUGFydGlhbDxMb3JlYm9va0VudHJ5Pjtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldExvcmVib29rRW50cmllcyhcbiAgbG9yZWJvb2s6IHN0cmluZyxcbiAgeyBmaWx0ZXIgPSAnbm9uZScgfTogR2V0TG9yZWJvb2tFbnRyaWVzT3B0aW9uID0ge30sXG4pOiBQcm9taXNlPExvcmVib29rRW50cnlbXT4ge1xuICBpZiAoIXdvcmxkX25hbWVzLmluY2x1ZGVzKGxvcmVib29rKSkge1xuICAgIHRocm93IEVycm9yKGDmnKrog73mib7liLDkuJbnlYzkuaYgJyR7bG9yZWJvb2t9J2ApO1xuICB9XG5cbiAgY29uc3QgZGF0YSA9IChhd2FpdCBsb2FkV29ybGRJbmZvKGxvcmVib29rKSkgYXMgeyBlbnRyaWVzOiB7IFt1aWQ6IG51bWJlcl06IF9PcmlnaW5hbExvcmVib29rRW50cnkgfSB9O1xuICBsZXQgZW50cmllczogTG9yZWJvb2tFbnRyeVtdID0gXyhkYXRhLmVudHJpZXMpLnZhbHVlcygpLm1hcCh0b0xvcmVib29rRW50cnkpLnZhbHVlKCk7XG4gIGlmIChmaWx0ZXIgIT09ICdub25lJykge1xuICAgIGVudHJpZXMgPSBlbnRyaWVzLmZpbHRlcihlbnRyeSA9PlxuICAgICAgT2JqZWN0LmVudHJpZXMoZmlsdGVyKS5ldmVyeSgoW2ZpZWxkLCBleHBlY3RlZF92YWx1ZV0pID0+IHtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICBjb25zdCBlbnRyeV92YWx1ZSA9IGVudHJ5W2ZpZWxkXTtcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZW50cnlfdmFsdWUpKSB7XG4gICAgICAgICAgcmV0dXJuIChleHBlY3RlZF92YWx1ZSBhcyBzdHJpbmdbXSkuZXZlcnkodmFsdWUgPT4gZW50cnlfdmFsdWUuaW5jbHVkZXModmFsdWUpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGVudHJ5X3ZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgICAgIHJldHVybiBlbnRyeV92YWx1ZS5pbmNsdWRlcyhleHBlY3RlZF92YWx1ZSBhcyBzdHJpbmcpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBlbnRyeV92YWx1ZSA9PT0gZXhwZWN0ZWRfdmFsdWU7XG4gICAgICB9KSxcbiAgICApO1xuICB9XG5cbiAgbG9nLmluZm8oYOiOt+WPluS4lueVjOS5piAnJHtsb3JlYm9va30nIOS4reeahOadoeebriwg6YCJ6aG5OiAke0pTT04uc3RyaW5naWZ5KHsgZmlsdGVyIH0pfWApO1xuICByZXR1cm4gc3RydWN0dXJlZENsb25lKGVudHJpZXMpO1xufVxuXG5mdW5jdGlvbiBmcm9tUGFydGlhbExvcmVib29rRW50cnkoXG4gIGVudHJ5OiBQaWNrPExvcmVib29rRW50cnksICd1aWQnIHwgJ2Rpc3BsYXlfaW5kZXgnPiAmIFBhcnRpYWw8TG9yZWJvb2tFbnRyeT4sXG4pOiBQaWNrPF9PcmlnaW5hbExvcmVib29rRW50cnksICd1aWQnIHwgJ2Rpc3BsYXlJbmRleCc+ICYgUGFydGlhbDxfT3JpZ2luYWxMb3JlYm9va0VudHJ5PiB7XG4gIGNvbnN0IHRyYW5zZm9ybWVycyA9IHtcbiAgICB1aWQ6ICh2YWx1ZTogTG9yZWJvb2tFbnRyeVsndWlkJ10pID0+ICh7IHVpZDogdmFsdWUgfSksXG4gICAgZGlzcGxheV9pbmRleDogKHZhbHVlOiBMb3JlYm9va0VudHJ5WydkaXNwbGF5X2luZGV4J10pID0+ICh7IGRpc3BsYXlJbmRleDogdmFsdWUgfSksXG5cbiAgICBjb21tZW50OiAodmFsdWU6IExvcmVib29rRW50cnlbJ2NvbW1lbnQnXSkgPT4gKHsgY29tbWVudDogdmFsdWUgfSksXG4gICAgZW5hYmxlZDogKHZhbHVlOiBMb3JlYm9va0VudHJ5WydlbmFibGVkJ10pID0+ICh7IGRpc2FibGU6ICF2YWx1ZSB9KSxcbiAgICB0eXBlOiAodmFsdWU6IExvcmVib29rRW50cnlbJ3R5cGUnXSkgPT4gKHtcbiAgICAgIGNvbnN0YW50OiB2YWx1ZSA9PT0gJ2NvbnN0YW50JyxcbiAgICAgIHZlY3Rvcml6ZWQ6IHZhbHVlID09PSAndmVjdG9yaXplZCcsXG4gICAgfSksXG4gICAgcG9zaXRpb246ICh2YWx1ZTogTG9yZWJvb2tFbnRyeVsncG9zaXRpb24nXSkgPT4gKHtcbiAgICAgIHBvc2l0aW9uOiB7XG4gICAgICAgIGJlZm9yZV9jaGFyYWN0ZXJfZGVmaW5pdGlvbjogMCxcbiAgICAgICAgYWZ0ZXJfY2hhcmFjdGVyX2RlZmluaXRpb246IDEsXG4gICAgICAgIGJlZm9yZV9leGFtcGxlX21lc3NhZ2VzOiA1LFxuICAgICAgICBhZnRlcl9leGFtcGxlX21lc3NhZ2VzOiA2LFxuICAgICAgICBiZWZvcmVfYXV0aG9yX25vdGU6IDIsXG4gICAgICAgIGFmdGVyX2F1dGhvcl9ub3RlOiAzLFxuICAgICAgICBhdF9kZXB0aF9hc19zeXN0ZW06IDQsXG4gICAgICAgIGF0X2RlcHRoX2FzX3VzZXI6IDQsXG4gICAgICAgIGF0X2RlcHRoX2FzX2Fzc2lzdGFudDogNCxcbiAgICAgIH1bdmFsdWVdLFxuICAgICAgcm9sZTpcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICB7XG4gICAgICAgICAgYXRfZGVwdGhfYXNfc3lzdGVtOiAwLFxuICAgICAgICAgIGF0X2RlcHRoX2FzX3VzZXI6IDEsXG4gICAgICAgICAgYXRfZGVwdGhfYXNfYXNzaXN0YW50OiAyLFxuICAgICAgICB9W3ZhbHVlXSA/PyBudWxsLFxuICAgIH0pLFxuICAgIGRlcHRoOiAodmFsdWU6IExvcmVib29rRW50cnlbJ2RlcHRoJ10pID0+ICh7IGRlcHRoOiB2YWx1ZSA9PT0gbnVsbCA/IDQgOiB2YWx1ZSB9KSxcbiAgICBvcmRlcjogKHZhbHVlOiBMb3JlYm9va0VudHJ5WydvcmRlciddKSA9PiAoeyBvcmRlcjogdmFsdWUgfSksXG4gICAgcHJvYmFiaWxpdHk6ICh2YWx1ZTogTG9yZWJvb2tFbnRyeVsncHJvYmFiaWxpdHknXSkgPT4gKHsgcHJvYmFiaWxpdHk6IHZhbHVlIH0pLFxuXG4gICAga2V5czogKHZhbHVlOiBMb3JlYm9va0VudHJ5WydrZXlzJ10pID0+ICh7IGtleTogdmFsdWUgfSksXG4gICAgbG9naWM6ICh2YWx1ZTogTG9yZWJvb2tFbnRyeVsnbG9naWMnXSkgPT4gKHtcbiAgICAgIHNlbGVjdGl2ZUxvZ2ljOiB7XG4gICAgICAgIGFuZF9hbnk6IDAsXG4gICAgICAgIG5vdF9hbGw6IDEsXG4gICAgICAgIG5vdF9hbnk6IDIsXG4gICAgICAgIGFuZF9hbGw6IDMsXG4gICAgICB9W3ZhbHVlXSxcbiAgICB9KSxcbiAgICBmaWx0ZXJzOiAodmFsdWU6IExvcmVib29rRW50cnlbJ2ZpbHRlciddKSA9PiAoeyBrZXlzZWNvbmRhcnk6IHZhbHVlIH0pLFxuXG4gICAgc2Nhbl9kZXB0aDogKHZhbHVlOiBMb3JlYm9va0VudHJ5WydzY2FuX2RlcHRoJ10pID0+ICh7IHNjYW5EZXB0aDogdmFsdWUgPT09ICdzYW1lX2FzX2dsb2JhbCcgPyBudWxsIDogdmFsdWUgfSksXG4gICAgY2FzZV9zZW5zaXRpdmU6ICh2YWx1ZTogTG9yZWJvb2tFbnRyeVsnY2FzZV9zZW5zaXRpdmUnXSkgPT4gKHtcbiAgICAgIGNhc2VTZW5zaXRpdmU6IHZhbHVlID09PSAnc2FtZV9hc19nbG9iYWwnID8gbnVsbCA6IHZhbHVlLFxuICAgIH0pLFxuICAgIG1hdGNoX3dob2xlX3dvcmRzOiAodmFsdWU6IExvcmVib29rRW50cnlbJ21hdGNoX3dob2xlX3dvcmRzJ10pID0+ICh7XG4gICAgICBtYXRjaFdob2xlV29yZHM6IHZhbHVlID09PSAnc2FtZV9hc19nbG9iYWwnID8gbnVsbCA6IHZhbHVlLFxuICAgIH0pLFxuICAgIHVzZV9ncm91cF9zY29yaW5nOiAodmFsdWU6IExvcmVib29rRW50cnlbJ3VzZV9ncm91cF9zY29yaW5nJ10pID0+ICh7XG4gICAgICB1c2VHcm91cFNjb3Jpbmc6IHZhbHVlID09PSAnc2FtZV9hc19nbG9iYWwnID8gbnVsbCA6IHZhbHVlLFxuICAgIH0pLFxuICAgIGF1dG9tYXRpb25faWQ6ICh2YWx1ZTogTG9yZWJvb2tFbnRyeVsnYXV0b21hdGlvbl9pZCddKSA9PiAoeyBhdXRvbWF0aW9uSWQ6IHZhbHVlID09PSBudWxsID8gJycgOiB2YWx1ZSB9KSxcblxuICAgIGV4Y2x1ZGVfcmVjdXJzaW9uOiAodmFsdWU6IExvcmVib29rRW50cnlbJ2V4Y2x1ZGVfcmVjdXJzaW9uJ10pID0+ICh7IGV4Y2x1ZGVSZWN1cnNpb246IHZhbHVlIH0pLFxuICAgIHByZXZlbnRfcmVjdXJzaW9uOiAodmFsdWU6IExvcmVib29rRW50cnlbJ3ByZXZlbnRfcmVjdXJzaW9uJ10pID0+ICh7IHByZXZlbnRSZWN1cnNpb246IHZhbHVlIH0pLFxuICAgIGRlbGF5X3VudGlsX3JlY3Vyc2lvbjogKHZhbHVlOiBMb3JlYm9va0VudHJ5WydkZWxheV91bnRpbF9yZWN1cnNpb24nXSkgPT4gKHsgZGVsYXlVbnRpbFJlY3Vyc2lvbjogdmFsdWUgfSksXG5cbiAgICBjb250ZW50OiAodmFsdWU6IExvcmVib29rRW50cnlbJ2NvbnRlbnQnXSkgPT4gKHsgY29udGVudDogdmFsdWUgfSksXG5cbiAgICBncm91cDogKHZhbHVlOiBMb3JlYm9va0VudHJ5Wydncm91cCddKSA9PiAoeyBncm91cDogdmFsdWUgfSksXG4gICAgZ3JvdXBfcHJpb3JpdGl6ZWQ6ICh2YWx1ZTogTG9yZWJvb2tFbnRyeVsnZ3JvdXBfcHJpb3JpdGl6ZWQnXSkgPT4gKHsgZ3JvdXBPdmVycmlkZTogdmFsdWUgfSksXG4gICAgZ3JvdXBfd2VpZ2h0OiAodmFsdWU6IExvcmVib29rRW50cnlbJ2dyb3VwX3dlaWdodCddKSA9PiAoeyBncm91cFdlaWdodDogdmFsdWUgfSksXG4gICAgc3RpY2t5OiAodmFsdWU6IExvcmVib29rRW50cnlbJ3N0aWNreSddKSA9PiAoeyBzdGlja3k6IHZhbHVlID09PSBudWxsID8gMCA6IHZhbHVlIH0pLFxuICAgIGNvb2xkb3duOiAodmFsdWU6IExvcmVib29rRW50cnlbJ2Nvb2xkb3duJ10pID0+ICh7IGNvb2xkb3duOiB2YWx1ZSA9PT0gbnVsbCA/IDAgOiB2YWx1ZSB9KSxcbiAgICBkZWxheTogKHZhbHVlOiBMb3JlYm9va0VudHJ5WydkZWxheSddKSA9PiAoeyBkZWxheTogdmFsdWUgPT09IG51bGwgPyAwIDogdmFsdWUgfSksXG4gIH07XG5cbiAgcmV0dXJuIF8ubWVyZ2UoXG4gICAge30sXG4gICAgZGVmYXVsdF9vcmlnaW5hbF9sb3JlYm9va19lbnRyeSxcbiAgICAuLi5PYmplY3QuZW50cmllcyhlbnRyeSlcbiAgICAgIC5maWx0ZXIoKFtfLCB2YWx1ZV0pID0+IHZhbHVlICE9PSB1bmRlZmluZWQpXG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAubWFwKChba2V5LCB2YWx1ZV0pID0+IHRyYW5zZm9ybWVyc1trZXldPy4odmFsdWUpKSxcbiAgKTtcbn1cblxuY29uc3QgTUFYX1VJRCA9IDFfMDAwXzAwMDtcblxuZnVuY3Rpb24gaGFuZGxlTG9yZWJvb2tFbnRyaWVzQ29sbGlzaW9uKFxuICBlbnRyaWVzOiBQYXJ0aWFsPExvcmVib29rRW50cnk+W10sXG4pOiBBcnJheTxQaWNrPExvcmVib29rRW50cnksICd1aWQnIHwgJ2Rpc3BsYXlfaW5kZXgnPiAmIFBhcnRpYWw8TG9yZWJvb2tFbnRyeT4+IHtcbiAgY29uc3QgdWlkX3NldCA9IG5ldyBTZXQ8bnVtYmVyPigpO1xuICBjb25zdCBoYW5kbGVfdWlkX2NvbGxpc2lvbiA9IChpbmRleDogbnVtYmVyIHwgdW5kZWZpbmVkKSA9PiB7XG4gICAgaWYgKGluZGV4ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGluZGV4ID0gXy5yYW5kb20oMCwgTUFYX1VJRCAtIDEpO1xuICAgIH1cblxuICAgIGxldCBpID0gMTtcbiAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgaWYgKCF1aWRfc2V0LmhhcyhpbmRleCkpIHtcbiAgICAgICAgdWlkX3NldC5hZGQoaW5kZXgpO1xuICAgICAgICByZXR1cm4gaW5kZXg7XG4gICAgICB9XG5cbiAgICAgIGluZGV4ID0gKGluZGV4ICsgaSAqIGkpICUgTUFYX1VJRDtcbiAgICAgICsraTtcbiAgICB9XG4gIH07XG5cbiAgbGV0IG1heF9kaXNwbGF5X2luZGV4ID0gXy5tYXgoZW50cmllcy5tYXAoZW50cnkgPT4gZW50cnkuZGlzcGxheV9pbmRleCA/PyAtMSkpID8/IC0xO1xuICByZXR1cm4gZW50cmllcy5tYXAoZW50cnkgPT4gKHtcbiAgICAuLi5lbnRyeSxcbiAgICB1aWQ6IGhhbmRsZV91aWRfY29sbGlzaW9uKGVudHJ5LnVpZCksXG4gICAgZGlzcGxheV9pbmRleDogZW50cnkuZGlzcGxheV9pbmRleCA/PyArK21heF9kaXNwbGF5X2luZGV4LFxuICB9KSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXBsYWNlTG9yZWJvb2tFbnRyaWVzKGxvcmVib29rOiBzdHJpbmcsIGVudHJpZXM6IFBhcnRpYWw8TG9yZWJvb2tFbnRyeT5bXSk6IFByb21pc2U8dm9pZD4ge1xuICBpZiAoIXdvcmxkX25hbWVzLmluY2x1ZGVzKGxvcmVib29rKSkge1xuICAgIHRocm93IEVycm9yKGDmnKrog73mib7liLDkuJbnlYzkuaYgJyR7bG9yZWJvb2t9J2ApO1xuICB9XG5cbiAgY29uc3QgZGF0YSA9IHtcbiAgICBlbnRyaWVzOiBfLm1lcmdlKFxuICAgICAge30sXG4gICAgICAuLi5oYW5kbGVMb3JlYm9va0VudHJpZXNDb2xsaXNpb24oZW50cmllcylcbiAgICAgICAgLm1hcChmcm9tUGFydGlhbExvcmVib29rRW50cnkpXG4gICAgICAgIC5tYXAoZW50cnkgPT4gKHsgW2VudHJ5LnVpZF06IGVudHJ5IH0pKSxcbiAgICApLFxuICB9O1xuICBhd2FpdCBzYXZlV29ybGRJbmZvKGxvcmVib29rLCBkYXRhKTtcbiAgcmVsb2FkRWRpdG9yRGVib3VuY2VkKGxvcmVib29rKTtcblxuICBsb2cuaW5mbyhg5pu05paw5LiW55WM5LmmICcke2xvcmVib29rfScg5Lit55qE5p2h55uuYCk7XG59XG5cbnR5cGUgTG9yZWJvb2tFbnRyaWVzVXBkYXRlciA9XG4gIHwgKChlbnRyaWVzOiBMb3JlYm9va0VudHJ5W10pID0+IFBhcnRpYWw8TG9yZWJvb2tFbnRyeT5bXSlcbiAgfCAoKGVudHJpZXM6IExvcmVib29rRW50cnlbXSkgPT4gUHJvbWlzZTxQYXJ0aWFsPExvcmVib29rRW50cnk+W10+KTtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUxvcmVib29rRW50cmllc1dpdGgoXG4gIGxvcmVib29rOiBzdHJpbmcsXG4gIHVwZGF0ZXI6IExvcmVib29rRW50cmllc1VwZGF0ZXIsXG4pOiBQcm9taXNlPExvcmVib29rRW50cnlbXT4ge1xuICBsb2cuaW5mbyhg5a+55LiW55WM5LmmICcke2xvcmVib29rfScg5Lit55qE5p2h55uu6L+b6KGM5pu05pawYCk7XG4gIGF3YWl0IHJlcGxhY2VMb3JlYm9va0VudHJpZXMobG9yZWJvb2ssIGF3YWl0IHVwZGF0ZXIoYXdhaXQgZ2V0TG9yZWJvb2tFbnRyaWVzKGxvcmVib29rKSkpO1xuICByZXR1cm4gZ2V0TG9yZWJvb2tFbnRyaWVzKGxvcmVib29rKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNldExvcmVib29rRW50cmllcyhcbiAgbG9yZWJvb2s6IHN0cmluZyxcbiAgZW50cmllczogQXJyYXk8UGljazxMb3JlYm9va0VudHJ5LCAndWlkJz4gJiBQYXJ0aWFsPExvcmVib29rRW50cnk+Pixcbik6IFByb21pc2U8TG9yZWJvb2tFbnRyeVtdPiB7XG4gIHJldHVybiBhd2FpdCB1cGRhdGVMb3JlYm9va0VudHJpZXNXaXRoKGxvcmVib29rLCBkYXRhID0+IHtcbiAgICBmb3IgKGNvbnN0IGVudHJ5X3RvX3NldCBvZiBlbnRyaWVzKSB7XG4gICAgICBjb25zdCBkYXRhX2VudHJ5ID0gZGF0YS5maW5kKGVudHJ5ID0+IGVudHJ5LnVpZCA9PT0gZW50cnlfdG9fc2V0LnVpZCk7XG4gICAgICBpZiAoZGF0YV9lbnRyeSkge1xuICAgICAgICBfLm1lcmdlKGRhdGFfZW50cnksIGVudHJ5X3RvX3NldCk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBkYXRhO1xuICB9KTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUxvcmVib29rRW50cmllcyhcbiAgbG9yZWJvb2s6IHN0cmluZyxcbiAgZW50cmllczogUGFydGlhbDxMb3JlYm9va0VudHJ5PltdLFxuKTogUHJvbWlzZTx7IGVudHJpZXM6IExvcmVib29rRW50cnlbXTsgbmV3X3VpZHM6IG51bWJlcltdIH0+IHtcbiAgY29uc3QgbmV3X3VpZHM6IG51bWJlcltdID0gW107XG4gIGNvbnN0IHVwZGF0ZWRfZW50cmllcyA9IGF3YWl0IHVwZGF0ZUxvcmVib29rRW50cmllc1dpdGgobG9yZWJvb2ssIGRhdGEgPT4ge1xuICAgIGNvbnN0IHVpZF9zZXQgPSBuZXcgU2V0KGRhdGEubWFwKGVudHJ5ID0+IGVudHJ5LnVpZCkpO1xuICAgIGNvbnN0IGdldF9mcmVlX3VpZCA9ICgpID0+IHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgTUFYX1VJRDsgKytpKSB7XG4gICAgICAgIGlmICghdWlkX3NldC5oYXMoaSkpIHtcbiAgICAgICAgICB1aWRfc2V0LmFkZChpKTtcbiAgICAgICAgICBuZXdfdWlkcy5wdXNoKGkpO1xuICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICB0aHJvdyBFcnJvcihg5peg5rOV5om+5Yiw5Y+v55So55qE5LiW55WM5Lmm5p2h55uuIHVpZGApO1xuICAgIH07XG5cbiAgICBlbnRyaWVzLmZvckVhY2goZW50cnkgPT4gKGVudHJ5LnVpZCA9IGdldF9mcmVlX3VpZCgpKSk7XG4gICAgcmV0dXJuIFsuLi5kYXRhLCAuLi5lbnRyaWVzXTtcbiAgfSk7XG4gIHJldHVybiB7IGVudHJpZXM6IHVwZGF0ZWRfZW50cmllcywgbmV3X3VpZHM6IG5ld191aWRzIH07XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVMb3JlYm9va0VudHJpZXMoXG4gIGxvcmVib29rOiBzdHJpbmcsXG4gIHVpZHM6IG51bWJlcltdLFxuKTogUHJvbWlzZTx7IGVudHJpZXM6IExvcmVib29rRW50cnlbXTsgZGVsZXRlX29jY3VycmVkOiBib29sZWFuIH0+IHtcbiAgbGV0IGRlbGV0ZWQ6IGJvb2xlYW4gPSBmYWxzZTtcbiAgY29uc3QgdXBkYXRlZF9lbnRpcmVzID0gYXdhaXQgdXBkYXRlTG9yZWJvb2tFbnRyaWVzV2l0aChsb3JlYm9vaywgZGF0YSA9PiB7XG4gICAgY29uc3QgcmVtb3ZlZF9kYXRhID0gXy5yZW1vdmUoZGF0YSwgZW50cnkgPT4gdWlkcy5pbmNsdWRlcyhlbnRyeS51aWQpKTtcbiAgICBkZWxldGVkID0gcmVtb3ZlZF9kYXRhLmxlbmd0aCA+IDA7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH0pO1xuICByZXR1cm4geyBlbnRyaWVzOiB1cGRhdGVkX2VudGlyZXMsIGRlbGV0ZV9vY2N1cnJlZDogZGVsZXRlZCB9O1xufVxuXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKiBAZGVwcmVjYXRlZCDor7fkvb/nlKggYGNyZWF0ZUxvcmVib29rRW50cmllc2Ag5Luj5pu/ICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlTG9yZWJvb2tFbnRyeShsb3JlYm9vazogc3RyaW5nLCBmaWVsZF92YWx1ZXM6IFBhcnRpYWw8TG9yZWJvb2tFbnRyeT4pOiBQcm9taXNlPG51bWJlcj4ge1xuICByZXR1cm4gKGF3YWl0IGNyZWF0ZUxvcmVib29rRW50cmllcyhsb3JlYm9vaywgW2ZpZWxkX3ZhbHVlc10pKS5uZXdfdWlkc1swXTtcbn1cblxuLyoqIEBkZXByZWNhdGVkIOivt+S9v+eUqCBgZGVsZXRlTG9yZWJvb2tFbnRyaWVzYCDku6Pmm78gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVMb3JlYm9va0VudHJ5KGxvcmVib29rOiBzdHJpbmcsIHVpZDogbnVtYmVyKTogUHJvbWlzZTxib29sZWFuPiB7XG4gIHJldHVybiAoYXdhaXQgZGVsZXRlTG9yZWJvb2tFbnRyaWVzKGxvcmVib29rLCBbdWlkXSkpLmRlbGV0ZV9vY2N1cnJlZDtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/function/lorebook_entry.ts\n\n}")},"./src/function/preset.ts":
/*!********************************!*\
  !*** ./src/function/preset.ts ***!
  \********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createOrReplacePreset: () => (/* binding */ createOrReplacePreset),\n/* harmony export */   createPreset: () => (/* binding */ createPreset),\n/* harmony export */   default_preset: () => (/* binding */ default_preset),\n/* harmony export */   deletePreset: () => (/* binding */ deletePreset),\n/* harmony export */   getLoadedPresetName: () => (/* binding */ getLoadedPresetName),\n/* harmony export */   getPreset: () => (/* binding */ getPreset),\n/* harmony export */   getPresetNames: () => (/* binding */ getPresetNames),\n/* harmony export */   isPresetNormalPrompt: () => (/* binding */ isPresetNormalPrompt),\n/* harmony export */   isPresetPlaceholderPrompt: () => (/* binding */ isPresetPlaceholderPrompt),\n/* harmony export */   isPresetSystemPrompt: () => (/* binding */ isPresetSystemPrompt),\n/* harmony export */   loadPreset: () => (/* binding */ loadPreset),\n/* harmony export */   renamePreset: () => (/* binding */ renamePreset),\n/* harmony export */   replacePreset: () => (/* binding */ replacePreset),\n/* harmony export */   setPreset: () => (/* binding */ setPreset),\n/* harmony export */   updatePresetWith: () => (/* binding */ updatePresetWith)\n/* harmony export */ });\n/* harmony import */ var _compatibility__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/compatibility */ \"./src/compatibility.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/scripts/openai */ \"@sillytavern/scripts/openai\");\n/* harmony import */ var _sillytavern_scripts_preset_manager__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/scripts/preset-manager */ \"@sillytavern/scripts/preset-manager\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n\n\n\n\n\nfunction isPresetNormalPrompt(prompt) {\n    return !isPresetSystemPrompt(prompt) && !isPresetPlaceholderPrompt(prompt);\n}\nfunction isPresetSystemPrompt(prompt) {\n    return ['main', 'nsfw', 'jailbreak', 'enhance_definitions'].includes(prompt.id);\n}\nfunction isPresetPlaceholderPrompt(prompt) {\n    return [\n        'world_info_before',\n        'persona_description',\n        'char_description',\n        'char_personality',\n        'scenario',\n        'world_info_after',\n        'dialogue_examples',\n        'chat_history',\n    ].includes(prompt.id);\n}\nconst default_preset = {\n    settings: {\n        max_context: 2000000,\n        max_completion_tokens: 300,\n        reply_count: 1,\n        should_stream: false,\n        temperature: 1,\n        frequency_penalty: 0,\n        presence_penalty: 0,\n        repetition_penalty: 1,\n        top_p: 1,\n        min_p: 0,\n        top_k: 0,\n        top_a: 0,\n        seed: -1,\n        squash_system_messages: false,\n        reasoning_effort: 'auto',\n        request_thoughts: false,\n        request_images: false,\n        enable_function_calling: false,\n        enable_web_search: false,\n        allow_sending_images: 'disabled',\n        allow_sending_videos: false,\n        character_name_prefix: 'none',\n        wrap_user_messages_in_quotes: false,\n    },\n    prompts: [\n        { id: 'world_info_before', name: 'World Info (before)', enabled: true, position: 'relative', role: 'system' },\n        { id: 'persona_description', name: 'Persona Description', enabled: true, position: 'relative', role: 'system' },\n        { id: 'char_description', name: 'Char Description', enabled: true, position: 'relative', role: 'system' },\n        { id: 'char_personality', name: 'Char Personality', enabled: true, position: 'relative', role: 'system' },\n        { id: 'scenario', name: 'Scenario', enabled: true, position: 'relative', role: 'system' },\n        { id: 'world_info_after', name: 'World Info (after)', enabled: true, position: 'relative', role: 'system' },\n        { id: 'dialogue_examples', name: 'Chat Examples', enabled: true, position: 'relative', role: 'system' },\n        { id: 'chat_history', name: 'Chat History', enabled: true, position: 'relative', role: 'system' },\n    ],\n    prompts_unused: [],\n    extensions: {},\n};\nconst in_use_map = {\n    temp_openai: 'temperature',\n    freq_pen_openai: 'frequency_penalty',\n    pres_pen_openai: 'presence_penalty',\n    top_p_openai: 'top_p',\n    repetition_penalty_openai: 'repetition_penalty',\n    min_p_openai: 'min_p',\n    top_k_openai: 'top_k',\n    top_a_openai: 'top_a',\n};\nconst identifier_to_id_map = {\n    enhanceDefinitions: 'enhance_definitions',\n    worldInfoBefore: 'world_info_before',\n    personaDescription: 'persona_description',\n    charDescription: 'char_description',\n    charPersonality: 'char_personality',\n    scenario: 'scenario',\n    worldInfoAfter: 'world_info_after',\n    dialogueExamples: 'dialogue_examples',\n    chatHistory: 'chat_history',\n};\nfunction toPresetPrompt(prompt, prompt_order) {\n    const is_normal_prompt = prompt.system_prompt === false && prompt.marker === false;\n    const is_system_prompt = prompt.system_prompt === true && prompt.marker === false;\n    const is_placeholder_prompt = prompt.marker === true;\n    let result = _({})\n        .set('id', _.get(identifier_to_id_map, prompt.identifier, prompt.identifier) ?? (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_4__.uuidv4)())\n        .set('name', prompt.name ?? 'unnamed')\n        .set('enabled', prompt_order.find(order => order.identifier === prompt.identifier)?.enabled ?? prompt.enabled ?? true);\n    if (is_normal_prompt || is_placeholder_prompt) {\n        result = result.set('position', {\n            0: 'relative',\n            1: prompt.injection_depth ?? 4,\n        }[prompt.injection_position ?? 0]);\n    }\n    result = result.set('role', prompt.role ?? 'system');\n    if (is_normal_prompt || is_system_prompt) {\n        result = result.set('content', prompt.content ?? '');\n    }\n    if (prompt.extra) {\n        result = result.set('extra', prompt.extra);\n    }\n    return result.value();\n}\nfunction fromPresetPrompt(prompt) {\n    const is_normal_prompt = isPresetNormalPrompt(prompt);\n    const is_system_prompt = isPresetSystemPrompt(prompt);\n    const is_placeholder_prompt = isPresetPlaceholderPrompt(prompt);\n    let result = _({})\n        .set('identifier', _.get({\n        enhance_definitions: 'enhanceDefinitions',\n        world_info_before: 'worldInfoBefore',\n        persona_description: 'personaDescription',\n        char_description: 'charDescription',\n        char_personality: 'charPersonality',\n        scenario: 'scenario',\n        world_info_after: 'worldInfoAfter',\n        dialogue_examples: 'dialogueExamples',\n        chat_history: 'chatHistory',\n    }, prompt.id, prompt.id))\n        .set('name', prompt.name)\n        .set('enabled', prompt.enabled);\n    if ((is_normal_prompt || is_placeholder_prompt) && !['dialogue_examples', 'chat_history'].includes(prompt.id)) {\n        result = result\n            .set('injection_position', prompt.position === 'relative' ? 0 : 1)\n            .set('injection_depth', prompt.position === 'relative' ? 4 : prompt.position);\n    }\n    result = result.set('role', prompt.role);\n    if (is_normal_prompt || is_system_prompt) {\n        result = result.set('content', prompt.content);\n    }\n    result = result.set('system_prompt', is_system_prompt && is_placeholder_prompt).set('marker', is_placeholder_prompt);\n    if (prompt.extra) {\n        result = result.set('extra', prompt.extra);\n    }\n    result = result.set('forbid_overrides', false);\n    return result.value();\n}\nfunction toPreset(preset, { in_use }) {\n    const prompt_order = preset.prompt_order.find(order => order.character_id === 100001)?.order ?? [];\n    const prompts_all = preset.prompts.map(prompt => toPresetPrompt(prompt, prompt_order));\n    const prompt_order_identifiers = prompt_order.map(order => _.get(identifier_to_id_map, order.identifier, order.identifier));\n    const [prompts_used, prompts_unused] = _.partition(prompts_all, prompt => prompt_order_identifiers.includes(prompt.id));\n    const prompts = prompt_order_identifiers.map(identifier => prompts_used.find(prompt => prompt.id === identifier));\n    return {\n        settings: {\n            max_context: preset.openai_max_context,\n            max_completion_tokens: preset.openai_max_tokens,\n            reply_count: preset.n,\n            should_stream: preset.stream_openai,\n            temperature: in_use ? preset.temp_openai : preset.temperature,\n            frequency_penalty: in_use ? preset.freq_pen_openai : preset.frequency_penalty,\n            presence_penalty: in_use ? preset.pres_pen_openai : preset.presence_penalty,\n            top_p: in_use ? preset.top_p_openai : preset.top_p,\n            repetition_penalty: in_use ? preset.repetition_penalty_openai : preset.repetition_penalty,\n            min_p: in_use ? preset.min_p_openai : preset.min_p,\n            top_k: in_use ? preset.top_k_openai : preset.top_k,\n            top_a: in_use ? preset.top_a_openai : preset.top_a,\n            seed: preset.seed,\n            squash_system_messages: preset.squash_system_messages,\n            reasoning_effort: preset.reasoning_effort,\n            request_thoughts: preset.show_thoughts,\n            request_images: preset.request_images,\n            enable_function_calling: preset.function_calling,\n            enable_web_search: preset.enable_web_search,\n            allow_sending_images: preset.image_inlining === false ? 'disabled' : preset.inline_image_quality,\n            allow_sending_videos: preset.video_inlining,\n            character_name_prefix: {\n                [-1]: 'none',\n                [0]: 'default',\n                [2]: 'content',\n                [1]: 'completion',\n            }[preset.names_behavior],\n            wrap_user_messages_in_quotes: preset.wrap_in_quotes,\n        },\n        prompts,\n        prompts_unused,\n        extensions: preset.extensions,\n    };\n}\nfunction fromPreset(preset) {\n    const id_set = new Set();\n    const handle_id_collision = (id, is_normal_prompt) => {\n        if (!id_set.has(id)) {\n            id_set.add(id);\n            return id;\n        }\n        if (!is_normal_prompt) {\n            throw Error(`修改的预设中存在重复的系统/占位提示词 '${id}'`);\n        }\n        const new_id = (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_4__.uuidv4)();\n        id_set.add(new_id);\n        return new_id;\n    };\n    const make_uncollision_prompts = (prompts) => {\n        return prompts.map(prompt => {\n            const new_id = handle_id_collision(prompt.id, isPresetNormalPrompt(prompt));\n            return {\n                ...prompt,\n                id: new_id,\n            };\n        });\n    };\n    preset.prompts = make_uncollision_prompts(preset.prompts);\n    preset.prompts_unused = make_uncollision_prompts(preset.prompts_unused);\n    const prompt_used = preset.prompts.map(prompt => fromPresetPrompt(prompt));\n    const prompt_unused = preset.prompts_unused.map(prompt => fromPresetPrompt(prompt));\n    return {\n        max_context_unlocked: true,\n        openai_max_context: preset.settings.max_context,\n        openai_max_tokens: preset.settings.max_completion_tokens,\n        n: preset.settings.reply_count,\n        stream_openai: preset.settings.should_stream,\n        // vv in use vv\n        temp_openai: preset.settings.temperature,\n        freq_pen_openai: preset.settings.frequency_penalty,\n        pres_pen_openai: preset.settings.presence_penalty,\n        top_p_openai: preset.settings.top_p,\n        repetition_penalty_openai: preset.settings.repetition_penalty,\n        min_p_openai: preset.settings.min_p,\n        top_k_openai: preset.settings.top_k,\n        top_a_openai: preset.settings.top_a,\n        // vv in file vv\n        temperature: preset.settings.temperature,\n        frequency_penalty: preset.settings.frequency_penalty,\n        presence_penalty: preset.settings.presence_penalty,\n        top_p: preset.settings.top_p,\n        repetition_penalty: preset.settings.repetition_penalty,\n        min_p: preset.settings.min_p,\n        top_k: preset.settings.top_k,\n        top_a: preset.settings.top_a,\n        seed: preset.settings.seed,\n        squash_system_messages: preset.settings.squash_system_messages,\n        reasoning_effort: preset.settings.reasoning_effort,\n        show_thoughts: preset.settings.request_thoughts,\n        request_images: preset.settings.request_images,\n        function_calling: preset.settings.enable_function_calling,\n        enable_web_search: preset.settings.enable_web_search,\n        image_inlining: preset.settings.allow_sending_images !== 'disabled',\n        inline_image_quality: preset.settings.allow_sending_images === 'disabled' ? 'auto' : preset.settings.allow_sending_images,\n        video_inlining: preset.settings.allow_sending_videos,\n        names_behavior: {\n            none: -1,\n            default: 0,\n            content: 2,\n            completion: 1,\n        }[preset.settings.character_name_prefix],\n        wrap_in_quotes: preset.settings.wrap_user_messages_in_quotes,\n        prompts: [...prompt_used, ...prompt_unused],\n        prompt_order: [\n            {\n                character_id: 100001,\n                order: prompt_used.map(prompt => ({ identifier: prompt.identifier, enabled: prompt.enabled ?? true })),\n            },\n        ],\n        extensions: preset.extensions,\n    };\n}\nconst preset_manager = (0,_sillytavern_scripts_preset_manager__WEBPACK_IMPORTED_MODULE_3__.getPresetManager)('openai');\nfunction getPresetNames() {\n    return structuredClone(['in_use', ...preset_manager.getAllPresets()]);\n}\nfunction getLoadedPresetName() {\n    return preset_manager.getSelectedPresetName();\n}\nfunction loadPreset(preset_name) {\n    const preset_value = preset_manager.findPreset(preset_name);\n    if (!preset_value) {\n        return false;\n    }\n    preset_manager.selectPreset(preset_value);\n    return true;\n}\nasync function createPreset(preset_name, preset = default_preset) {\n    if (getPresetNames().includes(preset_name)) {\n        return false;\n    }\n    await createOrReplacePreset(preset_name, preset);\n    return true;\n}\nfunction updateOriginalPresetData(data, updates, { in_use, render }) {\n    let lodash_data = _(data);\n    Object.entries(_compatibility__WEBPACK_IMPORTED_MODULE_0__.settingsToUpdate).forEach(([key, { oai_setting }]) => {\n        lodash_data = lodash_data.set(in_use ? oai_setting : _.get(in_use_map, oai_setting, oai_setting), updates[key]);\n    });\n    lodash_data.value();\n    if (!in_use) {\n        return;\n    }\n    const checkboxes = $();\n    const inputs = $();\n    Object.entries(_compatibility__WEBPACK_IMPORTED_MODULE_0__.settingsToUpdate).forEach(([key, { selector, type }]) => {\n        switch (type) {\n            case 'checkbox':\n                $(selector).prop('checked', updates[key]);\n                checkboxes.add(selector);\n                break;\n            case 'input':\n                $(selector).val(updates[key]);\n                inputs.add(selector);\n                break;\n        }\n    });\n    $(checkboxes).trigger('input', { source: 'preset' });\n    $(inputs).trigger('input', { source: 'preset' });\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.saveSettingsDebounced)();\n    if (render === 'debounced') {\n        _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_2__.promptManager.renderDebounced();\n    }\n    else {\n        _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_2__.promptManager.render(false);\n    }\n}\nasync function createOrReplacePreset(preset_name, preset = default_preset, { render = 'debounced' } = {}) {\n    const original_preset = fromPreset(preset);\n    const is_existing = getPresetNames().includes(preset_name);\n    if (!is_existing) {\n        const { presets, preset_names } = preset_manager.getPresetList();\n        presets.push(original_preset);\n        preset_names[preset_name] = presets.length - 1;\n        preset_manager.select.append($('<option></option>', { value: presets.length - 1, text: preset_name, selected: false }));\n    }\n    else {\n        updateOriginalPresetData(preset_name === 'in_use' ? _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_2__.oai_settings : preset_manager.getCompletionPresetByName(preset_name), original_preset, {\n            in_use: preset_name === 'in_use',\n            render,\n        });\n    }\n    if (preset_name !== 'in_use') {\n        await preset_manager.savePreset(preset_name, preset_manager.getCompletionPresetByName(preset_name), {\n            skipUpdate: true,\n        });\n    }\n    return !is_existing;\n}\nasync function deletePreset(preset_name) {\n    return Boolean(await preset_manager.deletePreset(preset_name));\n}\nasync function renamePreset(preset_name, new_name) {\n    if (!getPresetNames().includes(preset_name)) {\n        return false;\n    }\n    await createPreset(new_name, getPreset(preset_name));\n    await deletePreset(preset_name);\n    return true;\n}\nfunction getPreset(preset_name) {\n    const original_preset = preset_name === 'in_use' ? _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_2__.oai_settings : preset_manager.getCompletionPresetByName(preset_name);\n    if (!original_preset) {\n        throw Error(`预设 '${preset_name}' 不存在`);\n    }\n    return structuredClone(toPreset(original_preset, { in_use: preset_name === 'in_use' }));\n}\nasync function replacePreset(preset_name, preset, options = {}) {\n    if (!getPresetNames().includes(preset_name)) {\n        throw Error(`预设 '${preset_name}' 不存在`);\n    }\n    await createOrReplacePreset(preset_name, preset, options);\n}\nasync function updatePresetWith(preset_name, updater, options = {}) {\n    if (!getPresetNames().includes(preset_name)) {\n        throw Error(`预设 '${preset_name}' 不存在`);\n    }\n    const preset = await updater(getPreset(preset_name));\n    await replacePreset(preset_name, preset, options);\n    return preset;\n}\nasync function setPreset(preset_name, preset, options = {}) {\n    return await updatePresetWith(preset_name, old_preset => {\n        return {\n            settings: _.defaultsDeep(preset.settings, old_preset.settings),\n            prompts: preset.prompts ?? old_preset.prompts,\n            prompts_unused: preset.prompts_unused ?? old_preset.prompts_unused,\n            extensions: _.defaultsDeep(preset.extensions, old_preset.extensions),\n        };\n    }, options);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFDLGNBQWMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxXQUFXLENBQUMsRUFBRSxDQUFDO1FBQzVDLE1BQU0sS0FBSyxDQUFDLE9BQU8sV0FBVyxPQUFPLENBQUMsQ0FBQztJQUN6QyxDQUFDO0lBQ0QsTUFBTSxNQUFNLEdBQUcsTUFBTSxPQUFPLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBRSxDQUFDLENBQUM7SUFDdEQsTUFBTSxhQUFhLENBQUMsV0FBVyxFQUFFLE1BQU0sRUFBRSxPQUFPLENBQUMsQ0FBQztJQUNsRCxPQUFPLE1BQU0sQ0FBQztBQUNoQixDQUFDO0FBRU0sS0FBSyxVQUFVLFNBQVMsQ0FDN0IsV0FBMkMsRUFDM0MsTUFBMkIsRUFDM0IsVUFBZ0MsRUFBRTtJQUVsQyxPQUFPLE1BQU0sZ0JBQWdCLENBQzNCLFdBQVcsRUFDWCxVQUFVLENBQUMsRUFBRTtRQUNYLE9BQU87WUFDTCxRQUFRLEVBQUUsQ0FBQyxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUMsUUFBUSxFQUFFLFVBQVUsQ0FBQyxRQUFRLENBQUM7WUFDOUQsT0FBTyxFQUFFLE1BQU0sQ0FBQyxPQUFPLElBQUksVUFBVSxDQUFDLE9BQU87WUFDN0MsY0FBYyxFQUFFLE1BQU0sQ0FBQyxjQUFjLElBQUksVUFBVSxDQUFDLGNBQWM7WUFDbEUsVUFBVSxFQUFFLENBQUMsQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLFVBQVUsRUFBRSxVQUFVLENBQUMsVUFBVSxDQUFDO1NBQ3JFLENBQUM7SUFDSixDQUFDLEVBQ0QsT0FBTyxDQUNSLENBQUM7QUFDSixDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2Z1bmN0aW9uL3ByZXNldC50cz9lNDhhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHNldHRpbmdzVG9VcGRhdGUgfSBmcm9tICdAL2NvbXBhdGliaWxpdHknO1xuaW1wb3J0IHsgc2F2ZVNldHRpbmdzRGVib3VuY2VkIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5pbXBvcnQgeyBvYWlfc2V0dGluZ3MsIHByb21wdE1hbmFnZXIgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9vcGVuYWknO1xuaW1wb3J0IHsgZ2V0UHJlc2V0TWFuYWdlciB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3ByZXNldC1tYW5hZ2VyJztcbmltcG9ydCB7IHV1aWR2NCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3V0aWxzJztcbmltcG9ydCB7IExpdGVyYWxVbmlvbiwgUGFydGlhbERlZXAsIFNldFJlcXVpcmVkIH0gZnJvbSAndHlwZS1mZXN0JztcblxudHlwZSBQcmVzZXQgPSB7XG4gIHNldHRpbmdzOiB7XG4gICAgbWF4X2NvbnRleHQ6IG51bWJlcjtcbiAgICBtYXhfY29tcGxldGlvbl90b2tlbnM6IG51bWJlcjtcbiAgICByZXBseV9jb3VudDogbnVtYmVyO1xuXG4gICAgc2hvdWxkX3N0cmVhbTogYm9vbGVhbjtcblxuICAgIHRlbXBlcmF0dXJlOiBudW1iZXI7XG4gICAgZnJlcXVlbmN5X3BlbmFsdHk6IG51bWJlcjtcbiAgICBwcmVzZW5jZV9wZW5hbHR5OiBudW1iZXI7XG4gICAgcmVwZXRpdGlvbl9wZW5hbHR5OiBudW1iZXI7XG4gICAgdG9wX3A6IG51bWJlcjtcbiAgICBtaW5fcDogbnVtYmVyO1xuICAgIHRvcF9rOiBudW1iZXI7XG4gICAgdG9wX2E6IG51bWJlcjtcblxuICAgIHNlZWQ6IG51bWJlcjtcblxuICAgIHNxdWFzaF9zeXN0ZW1fbWVzc2FnZXM6IGJvb2xlYW47XG5cbiAgICByZWFzb25pbmdfZWZmb3J0OiAnYXV0bycgfCAnbWluJyB8ICdsb3cnIHwgJ21lZGl1bScgfCAnaGlnaCcgfCAnbWF4JztcbiAgICByZXF1ZXN0X3Rob3VnaHRzOiBib29sZWFuO1xuICAgIHJlcXVlc3RfaW1hZ2VzOiBib29sZWFuO1xuICAgIGVuYWJsZV9mdW5jdGlvbl9jYWxsaW5nOiBib29sZWFuO1xuICAgIGVuYWJsZV93ZWJfc2VhcmNoOiBib29sZWFuO1xuXG4gICAgYWxsb3dfc2VuZGluZ19pbWFnZXM6ICdkaXNhYmxlZCcgfCAnYXV0bycgfCAnbG93JyB8ICdoaWdoJztcbiAgICBhbGxvd19zZW5kaW5nX3ZpZGVvczogYm9vbGVhbjtcblxuICAgIGNoYXJhY3Rlcl9uYW1lX3ByZWZpeDogJ25vbmUnIHwgJ2RlZmF1bHQnIHwgJ2NvbnRlbnQnIHwgJ2NvbXBsZXRpb24nO1xuICAgIHdyYXBfdXNlcl9tZXNzYWdlc19pbl9xdW90ZXM6IGJvb2xlYW47XG4gIH07XG5cbiAgcHJvbXB0czogUHJlc2V0UHJvbXB0W107XG4gIHByb21wdHNfdW51c2VkOiBQcmVzZXRQcm9tcHRbXTtcblxuICBleHRlbnNpb25zOiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xufTtcblxudHlwZSBQcmVzZXRQcm9tcHQgPSB7XG4gIGlkOiBMaXRlcmFsVW5pb248XG4gICAgfCAnbWFpbidcbiAgICB8ICduc2Z3J1xuICAgIHwgJ2phaWxicmVhaydcbiAgICB8ICdlbmhhbmNlX2RlZmluaXRpb25zJ1xuICAgIHwgJ3dvcmxkX2luZm9fYmVmb3JlJ1xuICAgIHwgJ3BlcnNvbmFfZGVzY3JpcHRpb24nXG4gICAgfCAnY2hhcl9kZXNjcmlwdGlvbidcbiAgICB8ICdjaGFyX3BlcnNvbmFsaXR5J1xuICAgIHwgJ3NjZW5hcmlvJ1xuICAgIHwgJ3dvcmxkX2luZm9fYWZ0ZXInXG4gICAgfCAnZGlhbG9ndWVfZXhhbXBsZXMnXG4gICAgfCAnY2hhdF9oaXN0b3J5JyxcbiAgICBzdHJpbmdcbiAgPjtcbiAgbmFtZTogc3RyaW5nO1xuICBlbmFibGVkOiBib29sZWFuO1xuXG4gIHBvc2l0aW9uPzogJ3JlbGF0aXZlJyB8IG51bWJlcjtcblxuICByb2xlOiAnc3lzdGVtJyB8ICd1c2VyJyB8ICdhc3Npc3RhbnQnO1xuICBjb250ZW50Pzogc3RyaW5nO1xuXG4gIGV4dHJhPzogUmVjb3JkPHN0cmluZywgYW55Pjtcbn07XG50eXBlIFByZXNldE5vcm1hbFByb21wdCA9IFNldFJlcXVpcmVkPHsgaWQ6IHN0cmluZyB9ICYgT21pdDxQcmVzZXRQcm9tcHQsICdpZCc+LCAncG9zaXRpb24nIHwgJ2NvbnRlbnQnPjtcbnR5cGUgUHJlc2V0U3lzdGVtUHJvbXB0ID0gU2V0UmVxdWlyZWQ8XG4gIHsgaWQ6ICdtYWluJyB8ICduc2Z3JyB8ICdqYWlsYnJlYWsnIHwgJ2VuaGFuY2VfZGVmaW5pdGlvbnMnIH0gJiBPbWl0PFByZXNldFByb21wdCwgJ2lkJz4sXG4gICdjb250ZW50J1xuPjtcbnR5cGUgUHJlc2V0UGxhY2Vob2xkZXJQcm9tcHQgPSBTZXRSZXF1aXJlZDxcbiAge1xuICAgIGlkOlxuICAgICAgfCAnd29ybGRfaW5mb19iZWZvcmUnXG4gICAgICB8ICdwZXJzb25hX2Rlc2NyaXB0aW9uJ1xuICAgICAgfCAnY2hhcl9kZXNjcmlwdGlvbidcbiAgICAgIHwgJ2NoYXJfcGVyc29uYWxpdHknXG4gICAgICB8ICdzY2VuYXJpbydcbiAgICAgIHwgJ3dvcmxkX2luZm9fYWZ0ZXInXG4gICAgICB8ICdkaWFsb2d1ZV9leGFtcGxlcydcbiAgICAgIHwgJ2NoYXRfaGlzdG9yeSc7XG4gIH0gJiBPbWl0PFByZXNldFByb21wdCwgJ2lkJz4sXG4gICdwb3NpdGlvbidcbj47XG5leHBvcnQgZnVuY3Rpb24gaXNQcmVzZXROb3JtYWxQcm9tcHQocHJvbXB0OiBQcmVzZXRQcm9tcHQpOiBwcm9tcHQgaXMgUHJlc2V0Tm9ybWFsUHJvbXB0IHtcbiAgcmV0dXJuICFpc1ByZXNldFN5c3RlbVByb21wdChwcm9tcHQpICYmICFpc1ByZXNldFBsYWNlaG9sZGVyUHJvbXB0KHByb21wdCk7XG59XG5leHBvcnQgZnVuY3Rpb24gaXNQcmVzZXRTeXN0ZW1Qcm9tcHQocHJvbXB0OiBQcmVzZXRQcm9tcHQpOiBwcm9tcHQgaXMgUHJlc2V0U3lzdGVtUHJvbXB0IHtcbiAgcmV0dXJuIFsnbWFpbicsICduc2Z3JywgJ2phaWxicmVhaycsICdlbmhhbmNlX2RlZmluaXRpb25zJ10uaW5jbHVkZXMocHJvbXB0LmlkKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBpc1ByZXNldFBsYWNlaG9sZGVyUHJvbXB0KHByb21wdDogUHJlc2V0UHJvbXB0KTogcHJvbXB0IGlzIFByZXNldFBsYWNlaG9sZGVyUHJvbXB0IHtcbiAgcmV0dXJuIFtcbiAgICAnd29ybGRfaW5mb19iZWZvcmUnLFxuICAgICdwZXJzb25hX2Rlc2NyaXB0aW9uJyxcbiAgICAnY2hhcl9kZXNjcmlwdGlvbicsXG4gICAgJ2NoYXJfcGVyc29uYWxpdHknLFxuICAgICdzY2VuYXJpbycsXG4gICAgJ3dvcmxkX2luZm9fYWZ0ZXInLFxuICAgICdkaWFsb2d1ZV9leGFtcGxlcycsXG4gICAgJ2NoYXRfaGlzdG9yeScsXG4gIF0uaW5jbHVkZXMocHJvbXB0LmlkKTtcbn1cblxuZXhwb3J0IGNvbnN0IGRlZmF1bHRfcHJlc2V0OiBQcmVzZXQgPSB7XG4gIHNldHRpbmdzOiB7XG4gICAgbWF4X2NvbnRleHQ6IDIwMDAwMDAsXG4gICAgbWF4X2NvbXBsZXRpb25fdG9rZW5zOiAzMDAsXG4gICAgcmVwbHlfY291bnQ6IDEsXG5cbiAgICBzaG91bGRfc3RyZWFtOiBmYWxzZSxcblxuICAgIHRlbXBlcmF0dXJlOiAxLFxuICAgIGZyZXF1ZW5jeV9wZW5hbHR5OiAwLFxuICAgIHByZXNlbmNlX3BlbmFsdHk6IDAsXG4gICAgcmVwZXRpdGlvbl9wZW5hbHR5OiAxLFxuICAgIHRvcF9wOiAxLFxuICAgIG1pbl9wOiAwLFxuICAgIHRvcF9rOiAwLFxuICAgIHRvcF9hOiAwLFxuXG4gICAgc2VlZDogLTEsXG5cbiAgICBzcXVhc2hfc3lzdGVtX21lc3NhZ2VzOiBmYWxzZSxcblxuICAgIHJlYXNvbmluZ19lZmZvcnQ6ICdhdXRvJyxcbiAgICByZXF1ZXN0X3Rob3VnaHRzOiBmYWxzZSxcbiAgICByZXF1ZXN0X2ltYWdlczogZmFsc2UsXG4gICAgZW5hYmxlX2Z1bmN0aW9uX2NhbGxpbmc6IGZhbHNlLFxuICAgIGVuYWJsZV93ZWJfc2VhcmNoOiBmYWxzZSxcblxuICAgIGFsbG93X3NlbmRpbmdfaW1hZ2VzOiAnZGlzYWJsZWQnLFxuICAgIGFsbG93X3NlbmRpbmdfdmlkZW9zOiBmYWxzZSxcblxuICAgIGNoYXJhY3Rlcl9uYW1lX3ByZWZpeDogJ25vbmUnLFxuICAgIHdyYXBfdXNlcl9tZXNzYWdlc19pbl9xdW90ZXM6IGZhbHNlLFxuICB9LFxuICBwcm9tcHRzOiBbXG4gICAgeyBpZDogJ3dvcmxkX2luZm9fYmVmb3JlJywgbmFtZTogJ1dvcmxkIEluZm8gKGJlZm9yZSknLCBlbmFibGVkOiB0cnVlLCBwb3NpdGlvbjogJ3JlbGF0aXZlJywgcm9sZTogJ3N5c3RlbScgfSxcbiAgICB7IGlkOiAncGVyc29uYV9kZXNjcmlwdGlvbicsIG5hbWU6ICdQZXJzb25hIERlc2NyaXB0aW9uJywgZW5hYmxlZDogdHJ1ZSwgcG9zaXRpb246ICdyZWxhdGl2ZScsIHJvbGU6ICdzeXN0ZW0nIH0sXG4gICAgeyBpZDogJ2NoYXJfZGVzY3JpcHRpb24nLCBuYW1lOiAnQ2hhciBEZXNjcmlwdGlvbicsIGVuYWJsZWQ6IHRydWUsIHBvc2l0aW9uOiAncmVsYXRpdmUnLCByb2xlOiAnc3lzdGVtJyB9LFxuICAgIHsgaWQ6ICdjaGFyX3BlcnNvbmFsaXR5JywgbmFtZTogJ0NoYXIgUGVyc29uYWxpdHknLCBlbmFibGVkOiB0cnVlLCBwb3NpdGlvbjogJ3JlbGF0aXZlJywgcm9sZTogJ3N5c3RlbScgfSxcbiAgICB7IGlkOiAnc2NlbmFyaW8nLCBuYW1lOiAnU2NlbmFyaW8nLCBlbmFibGVkOiB0cnVlLCBwb3NpdGlvbjogJ3JlbGF0aXZlJywgcm9sZTogJ3N5c3RlbScgfSxcbiAgICB7IGlkOiAnd29ybGRfaW5mb19hZnRlcicsIG5hbWU6ICdXb3JsZCBJbmZvIChhZnRlciknLCBlbmFibGVkOiB0cnVlLCBwb3NpdGlvbjogJ3JlbGF0aXZlJywgcm9sZTogJ3N5c3RlbScgfSxcbiAgICB7IGlkOiAnZGlhbG9ndWVfZXhhbXBsZXMnLCBuYW1lOiAnQ2hhdCBFeGFtcGxlcycsIGVuYWJsZWQ6IHRydWUsIHBvc2l0aW9uOiAncmVsYXRpdmUnLCByb2xlOiAnc3lzdGVtJyB9LFxuICAgIHsgaWQ6ICdjaGF0X2hpc3RvcnknLCBuYW1lOiAnQ2hhdCBIaXN0b3J5JywgZW5hYmxlZDogdHJ1ZSwgcG9zaXRpb246ICdyZWxhdGl2ZScsIHJvbGU6ICdzeXN0ZW0nIH0sXG4gIF0sXG4gIHByb21wdHNfdW51c2VkOiBbXSxcbiAgZXh0ZW5zaW9uczoge30sXG59IGFzIGNvbnN0O1xuXG5jb25zdCBpbl91c2VfbWFwID0ge1xuICB0ZW1wX29wZW5haTogJ3RlbXBlcmF0dXJlJyxcbiAgZnJlcV9wZW5fb3BlbmFpOiAnZnJlcXVlbmN5X3BlbmFsdHknLFxuICBwcmVzX3Blbl9vcGVuYWk6ICdwcmVzZW5jZV9wZW5hbHR5JyxcbiAgdG9wX3Bfb3BlbmFpOiAndG9wX3AnLFxuICByZXBldGl0aW9uX3BlbmFsdHlfb3BlbmFpOiAncmVwZXRpdGlvbl9wZW5hbHR5JyxcbiAgbWluX3Bfb3BlbmFpOiAnbWluX3AnLFxuICB0b3Bfa19vcGVuYWk6ICd0b3BfaycsXG4gIHRvcF9hX29wZW5haTogJ3RvcF9hJyxcbn0gYXMgY29uc3Q7XG50eXBlIF9PcmlnaW5hbFByZXNldCA9IHtcbiAgbWF4X2NvbnRleHRfdW5sb2NrZWQ6IGJvb2xlYW47XG4gIG9wZW5haV9tYXhfY29udGV4dDogbnVtYmVyO1xuICBvcGVuYWlfbWF4X3Rva2VuczogbnVtYmVyO1xuICBuOiBudW1iZXI7XG5cbiAgc3RyZWFtX29wZW5haTogYm9vbGVhbjtcblxuICAvLyB2diBpbiB1c2UgdnZcbiAgdGVtcF9vcGVuYWk6IG51bWJlcjtcbiAgZnJlcV9wZW5fb3BlbmFpOiBudW1iZXI7XG4gIHByZXNfcGVuX29wZW5haTogbnVtYmVyO1xuICB0b3BfcF9vcGVuYWk6IG51bWJlcjtcbiAgcmVwZXRpdGlvbl9wZW5hbHR5X29wZW5haTogbnVtYmVyO1xuICBtaW5fcF9vcGVuYWk6IG51bWJlcjtcbiAgdG9wX2tfb3BlbmFpOiBudW1iZXI7XG4gIHRvcF9hX29wZW5haTogbnVtYmVyO1xuICAvLyB2diBpbiBmaWxlIHZ2XG4gIHRlbXBlcmF0dXJlOiBudW1iZXI7XG4gIGZyZXF1ZW5jeV9wZW5hbHR5OiBudW1iZXI7XG4gIHByZXNlbmNlX3BlbmFsdHk6IG51bWJlcjtcbiAgdG9wX3A6IG51bWJlcjtcbiAgcmVwZXRpdGlvbl9wZW5hbHR5OiBudW1iZXI7XG4gIG1pbl9wOiBudW1iZXI7XG4gIHRvcF9rOiBudW1iZXI7XG4gIHRvcF9hOiBudW1iZXI7XG5cbiAgc2VlZDogbnVtYmVyO1xuXG4gIHNxdWFzaF9zeXN0ZW1fbWVzc2FnZXM6IGJvb2xlYW47XG5cbiAgcmVhc29uaW5nX2VmZm9ydDogJ2F1dG8nIHwgJ21pbicgfCAnbG93JyB8ICdtZWRpdW0nIHwgJ2hpZ2gnIHwgJ21heCc7XG4gIHNob3dfdGhvdWdodHM6IGJvb2xlYW47XG4gIHJlcXVlc3RfaW1hZ2VzOiBib29sZWFuO1xuICBmdW5jdGlvbl9jYWxsaW5nOiBib29sZWFuO1xuICBlbmFibGVfd2ViX3NlYXJjaDogYm9vbGVhbjtcblxuICBpbWFnZV9pbmxpbmluZzogYm9vbGVhbjtcbiAgaW5saW5lX2ltYWdlX3F1YWxpdHk6ICdhdXRvJyB8ICdsb3cnIHwgJ2hpZ2gnO1xuICB2aWRlb19pbmxpbmluZzogYm9vbGVhbjtcblxuICBuYW1lc19iZWhhdmlvcjogLTEgfCAwIHwgMiB8IDE7XG4gIHdyYXBfaW5fcXVvdGVzOiBib29sZWFuO1xuXG4gIHByb21wdHM6IF9PcmlnaW5hbFByb21wdFtdO1xuICBwcm9tcHRfb3JkZXI6IEFycmF5PHtcbiAgICBjaGFyYWN0ZXJfaWQ6IDEwMDAwMTtcbiAgICBvcmRlcjogX09yaWdpbmFsUHJvbXB0T3JkZXJbXTtcbiAgfT47XG5cbiAgZXh0ZW5zaW9uczogUmVjb3JkPHN0cmluZywgYW55Pjtcbn07XG50eXBlIF9PcmlnaW5hbFByb21wdE9yZGVyID0ge1xuICBpZGVudGlmaWVyOiBzdHJpbmc7XG4gIGVuYWJsZWQ6IGJvb2xlYW47XG59O1xudHlwZSBfT3JpZ2luYWxQcm9tcHQgPSBfT3JpZ2luYWxOb3JtYWxQcm9tcHQgfCBfT3JpZ2luYWxTeXN0ZW1Qcm9tcHQgfCBfT3JpZ2luYWxQbGFjZWhvbGRlclByb21wdDtcbnR5cGUgX09yaWdpbmFsTm9ybWFsUHJvbXB0ID0ge1xuICBpZGVudGlmaWVyOiBzdHJpbmc7XG4gIG5hbWU6IHN0cmluZztcbiAgZW5hYmxlZD86IGJvb2xlYW47XG5cbiAgaW5qZWN0aW9uX3Bvc2l0aW9uOiAwIHwgMTtcbiAgaW5qZWN0aW9uX2RlcHRoOiBudW1iZXI7XG5cbiAgcm9sZTogJ3N5c3RlbScgfCAndXNlcicgfCAnYXNzaXN0YW50JztcbiAgY29udGVudDogc3RyaW5nO1xuXG4gIHN5c3RlbV9wcm9tcHQ6IGZhbHNlO1xuICBtYXJrZXI6IGZhbHNlO1xuXG4gIGV4dHJhPzogUmVjb3JkPHN0cmluZywgYW55PjtcblxuICBmb3JiaWRfb3ZlcnJpZGVzOiBmYWxzZTtcbn07XG50eXBlIF9PcmlnaW5hbFN5c3RlbVByb21wdCA9IHtcbiAgaWRlbnRpZmllcjogJ21haW4nIHwgJ25zZncnIHwgJ2phaWxicmVhaycgfCAnZW5oYW5jZURlZmluaXRpb25zJztcbiAgbmFtZTogc3RyaW5nO1xuICBlbmFibGVkPzogYm9vbGVhbjtcblxuICByb2xlOiAnc3lzdGVtJyB8ICd1c2VyJyB8ICdhc3Npc3RhbnQnO1xuICBjb250ZW50OiBzdHJpbmc7XG5cbiAgc3lzdGVtX3Byb21wdDogdHJ1ZTtcbiAgbWFya2VyOiBmYWxzZTtcblxuICBleHRyYT86IFJlY29yZDxzdHJpbmcsIGFueT47XG5cbiAgZm9yYmlkX292ZXJyaWRlczogZmFsc2U7XG59O1xudHlwZSBfT3JpZ2luYWxQbGFjZWhvbGRlclByb21wdCA9IHtcbiAgaWRlbnRpZmllcjpcbiAgICB8ICd3b3JsZEluZm9CZWZvcmUnXG4gICAgfCAncGVyc29uYURlc2NyaXB0aW9uJ1xuICAgIHwgJ2NoYXJEZXNjcmlwdGlvbidcbiAgICB8ICdjaGFyUGVyc29uYWxpdHknXG4gICAgfCAnc2NlbmFyaW8nXG4gICAgfCAnd29ybGRJbmZvQWZ0ZXInXG4gICAgfCAnZGlhbG9ndWVFeGFtcGxlcydcbiAgICB8ICdjaGF0SGlzdG9yeSc7XG4gIG5hbWU6IHN0cmluZztcbiAgZW5hYmxlZD86IGJvb2xlYW47XG5cbiAgaW5qZWN0aW9uX3Bvc2l0aW9uOiAwIHwgMTtcbiAgaW5qZWN0aW9uX2RlcHRoOiBudW1iZXI7XG5cbiAgcm9sZTogJ3N5c3RlbScgfCAndXNlcicgfCAnYXNzaXN0YW50JztcblxuICBzeXN0ZW1fcHJvbXB0OiB0cnVlO1xuICBtYXJrZXI6IHRydWU7XG5cbiAgZXh0cmE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xufTtcbmNvbnN0IGlkZW50aWZpZXJfdG9faWRfbWFwID0ge1xuICBlbmhhbmNlRGVmaW5pdGlvbnM6ICdlbmhhbmNlX2RlZmluaXRpb25zJyxcbiAgd29ybGRJbmZvQmVmb3JlOiAnd29ybGRfaW5mb19iZWZvcmUnLFxuICBwZXJzb25hRGVzY3JpcHRpb246ICdwZXJzb25hX2Rlc2NyaXB0aW9uJyxcbiAgY2hhckRlc2NyaXB0aW9uOiAnY2hhcl9kZXNjcmlwdGlvbicsXG4gIGNoYXJQZXJzb25hbGl0eTogJ2NoYXJfcGVyc29uYWxpdHknLFxuICBzY2VuYXJpbzogJ3NjZW5hcmlvJyxcbiAgd29ybGRJbmZvQWZ0ZXI6ICd3b3JsZF9pbmZvX2FmdGVyJyxcbiAgZGlhbG9ndWVFeGFtcGxlczogJ2RpYWxvZ3VlX2V4YW1wbGVzJyxcbiAgY2hhdEhpc3Rvcnk6ICdjaGF0X2hpc3RvcnknLFxufSBhcyBjb25zdDtcbmZ1bmN0aW9uIHRvUHJlc2V0UHJvbXB0KHByb21wdDogX09yaWdpbmFsUHJvbXB0LCBwcm9tcHRfb3JkZXI6IF9PcmlnaW5hbFByb21wdE9yZGVyW10pOiBQcmVzZXRQcm9tcHQge1xuICBjb25zdCBpc19ub3JtYWxfcHJvbXB0ID0gcHJvbXB0LnN5c3RlbV9wcm9tcHQgPT09IGZhbHNlICYmIHByb21wdC5tYXJrZXIgPT09IGZhbHNlO1xuICBjb25zdCBpc19zeXN0ZW1fcHJvbXB0ID0gcHJvbXB0LnN5c3RlbV9wcm9tcHQgPT09IHRydWUgJiYgcHJvbXB0Lm1hcmtlciA9PT0gZmFsc2U7XG4gIGNvbnN0IGlzX3BsYWNlaG9sZGVyX3Byb21wdCA9IHByb21wdC5tYXJrZXIgPT09IHRydWU7XG5cbiAgbGV0IHJlc3VsdCA9IF8oe30pXG4gICAgLnNldCgnaWQnLCBfLmdldChpZGVudGlmaWVyX3RvX2lkX21hcCwgcHJvbXB0LmlkZW50aWZpZXIsIHByb21wdC5pZGVudGlmaWVyKSA/PyB1dWlkdjQoKSlcbiAgICAuc2V0KCduYW1lJywgcHJvbXB0Lm5hbWUgPz8gJ3VubmFtZWQnKVxuICAgIC5zZXQoXG4gICAgICAnZW5hYmxlZCcsXG4gICAgICBwcm9tcHRfb3JkZXIuZmluZChvcmRlciA9PiBvcmRlci5pZGVudGlmaWVyID09PSBwcm9tcHQuaWRlbnRpZmllcik/LmVuYWJsZWQgPz8gcHJvbXB0LmVuYWJsZWQgPz8gdHJ1ZSxcbiAgICApO1xuXG4gIGlmIChpc19ub3JtYWxfcHJvbXB0IHx8IGlzX3BsYWNlaG9sZGVyX3Byb21wdCkge1xuICAgIHJlc3VsdCA9IHJlc3VsdC5zZXQoXG4gICAgICAncG9zaXRpb24nLFxuICAgICAgKFxuICAgICAgICB7XG4gICAgICAgICAgMDogJ3JlbGF0aXZlJyxcbiAgICAgICAgICAxOiBwcm9tcHQuaW5qZWN0aW9uX2RlcHRoID8/IDQsXG4gICAgICAgIH0gYXMgY29uc3RcbiAgICAgIClbcHJvbXB0LmluamVjdGlvbl9wb3NpdGlvbiA/PyAwXSxcbiAgICApO1xuICB9XG4gIHJlc3VsdCA9IHJlc3VsdC5zZXQoJ3JvbGUnLCBwcm9tcHQucm9sZSA/PyAnc3lzdGVtJyk7XG5cbiAgaWYgKGlzX25vcm1hbF9wcm9tcHQgfHwgaXNfc3lzdGVtX3Byb21wdCkge1xuICAgIHJlc3VsdCA9IHJlc3VsdC5zZXQoJ2NvbnRlbnQnLCBwcm9tcHQuY29udGVudCA/PyAnJyk7XG4gIH1cblxuICBpZiAocHJvbXB0LmV4dHJhKSB7XG4gICAgcmVzdWx0ID0gcmVzdWx0LnNldCgnZXh0cmEnLCBwcm9tcHQuZXh0cmEpO1xuICB9XG5cbiAgcmV0dXJuIHJlc3VsdC52YWx1ZSgpIGFzIFByZXNldFByb21wdDtcbn1cbmZ1bmN0aW9uIGZyb21QcmVzZXRQcm9tcHQocHJvbXB0OiBQcmVzZXRQcm9tcHQpOiBfT3JpZ2luYWxQcm9tcHQge1xuICBjb25zdCBpc19ub3JtYWxfcHJvbXB0ID0gaXNQcmVzZXROb3JtYWxQcm9tcHQocHJvbXB0KTtcbiAgY29uc3QgaXNfc3lzdGVtX3Byb21wdCA9IGlzUHJlc2V0U3lzdGVtUHJvbXB0KHByb21wdCk7XG4gIGNvbnN0IGlzX3BsYWNlaG9sZGVyX3Byb21wdCA9IGlzUHJlc2V0UGxhY2Vob2xkZXJQcm9tcHQocHJvbXB0KTtcblxuICBsZXQgcmVzdWx0ID0gXyh7fSlcbiAgICAuc2V0KFxuICAgICAgJ2lkZW50aWZpZXInLFxuICAgICAgXy5nZXQoXG4gICAgICAgIHtcbiAgICAgICAgICBlbmhhbmNlX2RlZmluaXRpb25zOiAnZW5oYW5jZURlZmluaXRpb25zJyxcbiAgICAgICAgICB3b3JsZF9pbmZvX2JlZm9yZTogJ3dvcmxkSW5mb0JlZm9yZScsXG4gICAgICAgICAgcGVyc29uYV9kZXNjcmlwdGlvbjogJ3BlcnNvbmFEZXNjcmlwdGlvbicsXG4gICAgICAgICAgY2hhcl9kZXNjcmlwdGlvbjogJ2NoYXJEZXNjcmlwdGlvbicsXG4gICAgICAgICAgY2hhcl9wZXJzb25hbGl0eTogJ2NoYXJQZXJzb25hbGl0eScsXG4gICAgICAgICAgc2NlbmFyaW86ICdzY2VuYXJpbycsXG4gICAgICAgICAgd29ybGRfaW5mb19hZnRlcjogJ3dvcmxkSW5mb0FmdGVyJyxcbiAgICAgICAgICBkaWFsb2d1ZV9leGFtcGxlczogJ2RpYWxvZ3VlRXhhbXBsZXMnLFxuICAgICAgICAgIGNoYXRfaGlzdG9yeTogJ2NoYXRIaXN0b3J5JyxcbiAgICAgICAgfSBhcyBjb25zdCxcbiAgICAgICAgcHJvbXB0LmlkLFxuICAgICAgICBwcm9tcHQuaWQsXG4gICAgICApLFxuICAgIClcbiAgICAuc2V0KCduYW1lJywgcHJvbXB0Lm5hbWUpXG4gICAgLnNldCgnZW5hYmxlZCcsIHByb21wdC5lbmFibGVkKTtcblxuICBpZiAoKGlzX25vcm1hbF9wcm9tcHQgfHwgaXNfcGxhY2Vob2xkZXJfcHJvbXB0KSAmJiAhWydkaWFsb2d1ZV9leGFtcGxlcycsICdjaGF0X2hpc3RvcnknXS5pbmNsdWRlcyhwcm9tcHQuaWQpKSB7XG4gICAgcmVzdWx0ID0gcmVzdWx0XG4gICAgICAuc2V0KCdpbmplY3Rpb25fcG9zaXRpb24nLCBwcm9tcHQucG9zaXRpb24gPT09ICdyZWxhdGl2ZScgPyAwIDogMSlcbiAgICAgIC5zZXQoJ2luamVjdGlvbl9kZXB0aCcsIHByb21wdC5wb3NpdGlvbiA9PT0gJ3JlbGF0aXZlJyA/IDQgOiBwcm9tcHQucG9zaXRpb24pO1xuICB9XG5cbiAgcmVzdWx0ID0gcmVzdWx0LnNldCgncm9sZScsIHByb21wdC5yb2xlKTtcbiAgaWYgKGlzX25vcm1hbF9wcm9tcHQgfHwgaXNfc3lzdGVtX3Byb21wdCkge1xuICAgIHJlc3VsdCA9IHJlc3VsdC5zZXQoJ2NvbnRlbnQnLCBwcm9tcHQuY29udGVudCk7XG4gIH1cblxuICByZXN1bHQgPSByZXN1bHQuc2V0KCdzeXN0ZW1fcHJvbXB0JywgaXNfc3lzdGVtX3Byb21wdCAmJiBpc19wbGFjZWhvbGRlcl9wcm9tcHQpLnNldCgnbWFya2VyJywgaXNfcGxhY2Vob2xkZXJfcHJvbXB0KTtcblxuICBpZiAocHJvbXB0LmV4dHJhKSB7XG4gICAgcmVzdWx0ID0gcmVzdWx0LnNldCgnZXh0cmEnLCBwcm9tcHQuZXh0cmEpO1xuICB9XG5cbiAgcmVzdWx0ID0gcmVzdWx0LnNldCgnZm9yYmlkX292ZXJyaWRlcycsIGZhbHNlKTtcblxuICByZXR1cm4gcmVzdWx0LnZhbHVlKCkgYXMgX09yaWdpbmFsUHJvbXB0O1xufVxuXG5mdW5jdGlvbiB0b1ByZXNldChwcmVzZXQ6IF9PcmlnaW5hbFByZXNldCwgeyBpbl91c2UgfTogeyBpbl91c2U6IGJvb2xlYW4gfSk6IFByZXNldCB7XG4gIGNvbnN0IHByb21wdF9vcmRlciA9IHByZXNldC5wcm9tcHRfb3JkZXIuZmluZChvcmRlciA9PiBvcmRlci5jaGFyYWN0ZXJfaWQgPT09IDEwMDAwMSk/Lm9yZGVyID8/IFtdO1xuICBjb25zdCBwcm9tcHRzX2FsbCA9IHByZXNldC5wcm9tcHRzLm1hcChwcm9tcHQgPT4gdG9QcmVzZXRQcm9tcHQocHJvbXB0LCBwcm9tcHRfb3JkZXIpKTtcblxuICBjb25zdCBwcm9tcHRfb3JkZXJfaWRlbnRpZmllcnMgPSBwcm9tcHRfb3JkZXIubWFwKG9yZGVyID0+XG4gICAgXy5nZXQoaWRlbnRpZmllcl90b19pZF9tYXAsIG9yZGVyLmlkZW50aWZpZXIsIG9yZGVyLmlkZW50aWZpZXIpLFxuICApO1xuICBjb25zdCBbcHJvbXB0c191c2VkLCBwcm9tcHRzX3VudXNlZF0gPSBfLnBhcnRpdGlvbihwcm9tcHRzX2FsbCwgcHJvbXB0ID0+XG4gICAgcHJvbXB0X29yZGVyX2lkZW50aWZpZXJzLmluY2x1ZGVzKHByb21wdC5pZCksXG4gICk7XG4gIGNvbnN0IHByb21wdHMgPSBwcm9tcHRfb3JkZXJfaWRlbnRpZmllcnMubWFwKGlkZW50aWZpZXIgPT4gcHJvbXB0c191c2VkLmZpbmQocHJvbXB0ID0+IHByb21wdC5pZCA9PT0gaWRlbnRpZmllcikhKTtcblxuICByZXR1cm4ge1xuICAgIHNldHRpbmdzOiB7XG4gICAgICBtYXhfY29udGV4dDogcHJlc2V0Lm9wZW5haV9tYXhfY29udGV4dCxcbiAgICAgIG1heF9jb21wbGV0aW9uX3Rva2VuczogcHJlc2V0Lm9wZW5haV9tYXhfdG9rZW5zLFxuICAgICAgcmVwbHlfY291bnQ6IHByZXNldC5uLFxuXG4gICAgICBzaG91bGRfc3RyZWFtOiBwcmVzZXQuc3RyZWFtX29wZW5haSxcblxuICAgICAgdGVtcGVyYXR1cmU6IGluX3VzZSA/IHByZXNldC50ZW1wX29wZW5haSA6IHByZXNldC50ZW1wZXJhdHVyZSxcbiAgICAgIGZyZXF1ZW5jeV9wZW5hbHR5OiBpbl91c2UgPyBwcmVzZXQuZnJlcV9wZW5fb3BlbmFpIDogcHJlc2V0LmZyZXF1ZW5jeV9wZW5hbHR5LFxuICAgICAgcHJlc2VuY2VfcGVuYWx0eTogaW5fdXNlID8gcHJlc2V0LnByZXNfcGVuX29wZW5haSA6IHByZXNldC5wcmVzZW5jZV9wZW5hbHR5LFxuICAgICAgdG9wX3A6IGluX3VzZSA/IHByZXNldC50b3BfcF9vcGVuYWkgOiBwcmVzZXQudG9wX3AsXG4gICAgICByZXBldGl0aW9uX3BlbmFsdHk6IGluX3VzZSA/IHByZXNldC5yZXBldGl0aW9uX3BlbmFsdHlfb3BlbmFpIDogcHJlc2V0LnJlcGV0aXRpb25fcGVuYWx0eSxcbiAgICAgIG1pbl9wOiBpbl91c2UgPyBwcmVzZXQubWluX3Bfb3BlbmFpIDogcHJlc2V0Lm1pbl9wLFxuICAgICAgdG9wX2s6IGluX3VzZSA/IHByZXNldC50b3Bfa19vcGVuYWkgOiBwcmVzZXQudG9wX2ssXG4gICAgICB0b3BfYTogaW5fdXNlID8gcHJlc2V0LnRvcF9hX29wZW5haSA6IHByZXNldC50b3BfYSxcblxuICAgICAgc2VlZDogcHJlc2V0LnNlZWQsXG5cbiAgICAgIHNxdWFzaF9zeXN0ZW1fbWVzc2FnZXM6IHByZXNldC5zcXVhc2hfc3lzdGVtX21lc3NhZ2VzLFxuXG4gICAgICByZWFzb25pbmdfZWZmb3J0OiBwcmVzZXQucmVhc29uaW5nX2VmZm9ydCxcbiAgICAgIHJlcXVlc3RfdGhvdWdodHM6IHByZXNldC5zaG93X3Rob3VnaHRzLFxuICAgICAgcmVxdWVzdF9pbWFnZXM6IHByZXNldC5yZXF1ZXN0X2ltYWdlcyxcbiAgICAgIGVuYWJsZV9mdW5jdGlvbl9jYWxsaW5nOiBwcmVzZXQuZnVuY3Rpb25fY2FsbGluZyxcbiAgICAgIGVuYWJsZV93ZWJfc2VhcmNoOiBwcmVzZXQuZW5hYmxlX3dlYl9zZWFyY2gsXG5cbiAgICAgIGFsbG93X3NlbmRpbmdfaW1hZ2VzOiBwcmVzZXQuaW1hZ2VfaW5saW5pbmcgPT09IGZhbHNlID8gJ2Rpc2FibGVkJyA6IHByZXNldC5pbmxpbmVfaW1hZ2VfcXVhbGl0eSxcbiAgICAgIGFsbG93X3NlbmRpbmdfdmlkZW9zOiBwcmVzZXQudmlkZW9faW5saW5pbmcsXG5cbiAgICAgIGNoYXJhY3Rlcl9uYW1lX3ByZWZpeDogKFxuICAgICAgICB7XG4gICAgICAgICAgWy0xXTogJ25vbmUnLFxuICAgICAgICAgIFswXTogJ2RlZmF1bHQnLFxuICAgICAgICAgIFsyXTogJ2NvbnRlbnQnLFxuICAgICAgICAgIFsxXTogJ2NvbXBsZXRpb24nLFxuICAgICAgICB9IGFzIGNvbnN0XG4gICAgICApW3ByZXNldC5uYW1lc19iZWhhdmlvcl0sXG4gICAgICB3cmFwX3VzZXJfbWVzc2FnZXNfaW5fcXVvdGVzOiBwcmVzZXQud3JhcF9pbl9xdW90ZXMsXG4gICAgfSxcblxuICAgIHByb21wdHMsXG4gICAgcHJvbXB0c191bnVzZWQsXG5cbiAgICBleHRlbnNpb25zOiBwcmVzZXQuZXh0ZW5zaW9ucyxcbiAgfTtcbn1cbmZ1bmN0aW9uIGZyb21QcmVzZXQocHJlc2V0OiBQcmVzZXQpOiBfT3JpZ2luYWxQcmVzZXQge1xuICBjb25zdCBpZF9zZXQgPSBuZXcgU2V0PHN0cmluZz4oKTtcbiAgY29uc3QgaGFuZGxlX2lkX2NvbGxpc2lvbiA9IChpZDogc3RyaW5nLCBpc19ub3JtYWxfcHJvbXB0OiBib29sZWFuKTogc3RyaW5nID0+IHtcbiAgICBpZiAoIWlkX3NldC5oYXMoaWQpKSB7XG4gICAgICBpZF9zZXQuYWRkKGlkKTtcbiAgICAgIHJldHVybiBpZDtcbiAgICB9XG4gICAgaWYgKCFpc19ub3JtYWxfcHJvbXB0KSB7XG4gICAgICB0aHJvdyBFcnJvcihg5L+u5pS555qE6aKE6K6+5Lit5a2Y5Zyo6YeN5aSN55qE57O757ufL+WNoOS9jeaPkOekuuivjSAnJHtpZH0nYCk7XG4gICAgfVxuICAgIGNvbnN0IG5ld19pZCA9IHV1aWR2NCgpO1xuICAgIGlkX3NldC5hZGQobmV3X2lkKTtcbiAgICByZXR1cm4gbmV3X2lkO1xuICB9O1xuICBjb25zdCBtYWtlX3VuY29sbGlzaW9uX3Byb21wdHMgPSAocHJvbXB0czogUHJlc2V0UHJvbXB0W10pID0+IHtcbiAgICByZXR1cm4gcHJvbXB0cy5tYXAocHJvbXB0ID0+IHtcbiAgICAgIGNvbnN0IG5ld19pZCA9IGhhbmRsZV9pZF9jb2xsaXNpb24ocHJvbXB0LmlkLCBpc1ByZXNldE5vcm1hbFByb21wdChwcm9tcHQpKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLnByb21wdCxcbiAgICAgICAgaWQ6IG5ld19pZCxcbiAgICAgIH07XG4gICAgfSk7XG4gIH07XG4gIHByZXNldC5wcm9tcHRzID0gbWFrZV91bmNvbGxpc2lvbl9wcm9tcHRzKHByZXNldC5wcm9tcHRzKTtcbiAgcHJlc2V0LnByb21wdHNfdW51c2VkID0gbWFrZV91bmNvbGxpc2lvbl9wcm9tcHRzKHByZXNldC5wcm9tcHRzX3VudXNlZCk7XG5cbiAgY29uc3QgcHJvbXB0X3VzZWQgPSBwcmVzZXQucHJvbXB0cy5tYXAocHJvbXB0ID0+IGZyb21QcmVzZXRQcm9tcHQocHJvbXB0KSk7XG4gIGNvbnN0IHByb21wdF91bnVzZWQgPSBwcmVzZXQucHJvbXB0c191bnVzZWQubWFwKHByb21wdCA9PiBmcm9tUHJlc2V0UHJvbXB0KHByb21wdCkpO1xuXG4gIHJldHVybiB7XG4gICAgbWF4X2NvbnRleHRfdW5sb2NrZWQ6IHRydWUsXG4gICAgb3BlbmFpX21heF9jb250ZXh0OiBwcmVzZXQuc2V0dGluZ3MubWF4X2NvbnRleHQsXG4gICAgb3BlbmFpX21heF90b2tlbnM6IHByZXNldC5zZXR0aW5ncy5tYXhfY29tcGxldGlvbl90b2tlbnMsXG4gICAgbjogcHJlc2V0LnNldHRpbmdzLnJlcGx5X2NvdW50LFxuXG4gICAgc3RyZWFtX29wZW5haTogcHJlc2V0LnNldHRpbmdzLnNob3VsZF9zdHJlYW0sXG5cbiAgICAvLyB2diBpbiB1c2UgdnZcbiAgICB0ZW1wX29wZW5haTogcHJlc2V0LnNldHRpbmdzLnRlbXBlcmF0dXJlLFxuICAgIGZyZXFfcGVuX29wZW5haTogcHJlc2V0LnNldHRpbmdzLmZyZXF1ZW5jeV9wZW5hbHR5LFxuICAgIHByZXNfcGVuX29wZW5haTogcHJlc2V0LnNldHRpbmdzLnByZXNlbmNlX3BlbmFsdHksXG4gICAgdG9wX3Bfb3BlbmFpOiBwcmVzZXQuc2V0dGluZ3MudG9wX3AsXG4gICAgcmVwZXRpdGlvbl9wZW5hbHR5X29wZW5haTogcHJlc2V0LnNldHRpbmdzLnJlcGV0aXRpb25fcGVuYWx0eSxcbiAgICBtaW5fcF9vcGVuYWk6IHByZXNldC5zZXR0aW5ncy5taW5fcCxcbiAgICB0b3Bfa19vcGVuYWk6IHByZXNldC5zZXR0aW5ncy50b3BfayxcbiAgICB0b3BfYV9vcGVuYWk6IHByZXNldC5zZXR0aW5ncy50b3BfYSxcbiAgICAvLyB2diBpbiBmaWxlIHZ2XG4gICAgdGVtcGVyYXR1cmU6IHByZXNldC5zZXR0aW5ncy50ZW1wZXJhdHVyZSxcbiAgICBmcmVxdWVuY3lfcGVuYWx0eTogcHJlc2V0LnNldHRpbmdzLmZyZXF1ZW5jeV9wZW5hbHR5LFxuICAgIHByZXNlbmNlX3BlbmFsdHk6IHByZXNldC5zZXR0aW5ncy5wcmVzZW5jZV9wZW5hbHR5LFxuICAgIHRvcF9wOiBwcmVzZXQuc2V0dGluZ3MudG9wX3AsXG4gICAgcmVwZXRpdGlvbl9wZW5hbHR5OiBwcmVzZXQuc2V0dGluZ3MucmVwZXRpdGlvbl9wZW5hbHR5LFxuICAgIG1pbl9wOiBwcmVzZXQuc2V0dGluZ3MubWluX3AsXG4gICAgdG9wX2s6IHByZXNldC5zZXR0aW5ncy50b3BfayxcbiAgICB0b3BfYTogcHJlc2V0LnNldHRpbmdzLnRvcF9hLFxuXG4gICAgc2VlZDogcHJlc2V0LnNldHRpbmdzLnNlZWQsXG5cbiAgICBzcXVhc2hfc3lzdGVtX21lc3NhZ2VzOiBwcmVzZXQuc2V0dGluZ3Muc3F1YXNoX3N5c3RlbV9tZXNzYWdlcyxcblxuICAgIHJlYXNvbmluZ19lZmZvcnQ6IHByZXNldC5zZXR0aW5ncy5yZWFzb25pbmdfZWZmb3J0LFxuICAgIHNob3dfdGhvdWdodHM6IHByZXNldC5zZXR0aW5ncy5yZXF1ZXN0X3Rob3VnaHRzLFxuICAgIHJlcXVlc3RfaW1hZ2VzOiBwcmVzZXQuc2V0dGluZ3MucmVxdWVzdF9pbWFnZXMsXG4gICAgZnVuY3Rpb25fY2FsbGluZzogcHJlc2V0LnNldHRpbmdzLmVuYWJsZV9mdW5jdGlvbl9jYWxsaW5nLFxuICAgIGVuYWJsZV93ZWJfc2VhcmNoOiBwcmVzZXQuc2V0dGluZ3MuZW5hYmxlX3dlYl9zZWFyY2gsXG5cbiAgICBpbWFnZV9pbmxpbmluZzogcHJlc2V0LnNldHRpbmdzLmFsbG93X3NlbmRpbmdfaW1hZ2VzICE9PSAnZGlzYWJsZWQnLFxuICAgIGlubGluZV9pbWFnZV9xdWFsaXR5OlxuICAgICAgcHJlc2V0LnNldHRpbmdzLmFsbG93X3NlbmRpbmdfaW1hZ2VzID09PSAnZGlzYWJsZWQnID8gJ2F1dG8nIDogcHJlc2V0LnNldHRpbmdzLmFsbG93X3NlbmRpbmdfaW1hZ2VzLFxuICAgIHZpZGVvX2lubGluaW5nOiBwcmVzZXQuc2V0dGluZ3MuYWxsb3dfc2VuZGluZ192aWRlb3MsXG5cbiAgICBuYW1lc19iZWhhdmlvcjogKFxuICAgICAge1xuICAgICAgICBub25lOiAtMSxcbiAgICAgICAgZGVmYXVsdDogMCxcbiAgICAgICAgY29udGVudDogMixcbiAgICAgICAgY29tcGxldGlvbjogMSxcbiAgICAgIH0gYXMgY29uc3RcbiAgICApW3ByZXNldC5zZXR0aW5ncy5jaGFyYWN0ZXJfbmFtZV9wcmVmaXhdLFxuICAgIHdyYXBfaW5fcXVvdGVzOiBwcmVzZXQuc2V0dGluZ3Mud3JhcF91c2VyX21lc3NhZ2VzX2luX3F1b3RlcyxcblxuICAgIHByb21wdHM6IFsuLi5wcm9tcHRfdXNlZCwgLi4ucHJvbXB0X3VudXNlZF0sXG4gICAgcHJvbXB0X29yZGVyOiBbXG4gICAgICB7XG4gICAgICAgIGNoYXJhY3Rlcl9pZDogMTAwMDAxLFxuICAgICAgICBvcmRlcjogcHJvbXB0X3VzZWQubWFwKHByb21wdCA9PiAoeyBpZGVudGlmaWVyOiBwcm9tcHQuaWRlbnRpZmllciwgZW5hYmxlZDogcHJvbXB0LmVuYWJsZWQgPz8gdHJ1ZSB9KSksXG4gICAgICB9LFxuICAgIF0sXG5cbiAgICBleHRlbnNpb25zOiBwcmVzZXQuZXh0ZW5zaW9ucyxcbiAgfTtcbn1cblxuY29uc3QgcHJlc2V0X21hbmFnZXIgPSBnZXRQcmVzZXRNYW5hZ2VyKCdvcGVuYWknKTtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldFByZXNldE5hbWVzKCk6IHN0cmluZ1tdIHtcbiAgcmV0dXJuIHN0cnVjdHVyZWRDbG9uZShbJ2luX3VzZScsIC4uLnByZXNldF9tYW5hZ2VyLmdldEFsbFByZXNldHMoKV0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TG9hZGVkUHJlc2V0TmFtZSgpOiBzdHJpbmcge1xuICByZXR1cm4gcHJlc2V0X21hbmFnZXIuZ2V0U2VsZWN0ZWRQcmVzZXROYW1lKCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBsb2FkUHJlc2V0KHByZXNldF9uYW1lOiBFeGNsdWRlPHN0cmluZywgJ2luX3VzZSc+KTogYm9vbGVhbiB7XG4gIGNvbnN0IHByZXNldF92YWx1ZSA9IHByZXNldF9tYW5hZ2VyLmZpbmRQcmVzZXQocHJlc2V0X25hbWUpO1xuICBpZiAoIXByZXNldF92YWx1ZSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBwcmVzZXRfbWFuYWdlci5zZWxlY3RQcmVzZXQocHJlc2V0X3ZhbHVlKTtcbiAgcmV0dXJuIHRydWU7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVQcmVzZXQoXG4gIHByZXNldF9uYW1lOiBFeGNsdWRlPHN0cmluZywgJ2luX3VzZSc+LFxuICBwcmVzZXQ6IFByZXNldCA9IGRlZmF1bHRfcHJlc2V0LFxuKTogUHJvbWlzZTxib29sZWFuPiB7XG4gIGlmIChnZXRQcmVzZXROYW1lcygpLmluY2x1ZGVzKHByZXNldF9uYW1lKSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBhd2FpdCBjcmVhdGVPclJlcGxhY2VQcmVzZXQocHJlc2V0X25hbWUsIHByZXNldCk7XG4gIHJldHVybiB0cnVlO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVPcmlnaW5hbFByZXNldERhdGEoXG4gIGRhdGE6IFJlY29yZDxzdHJpbmcsIGFueT4sXG4gIHVwZGF0ZXM6IF9PcmlnaW5hbFByZXNldCxcbiAgeyBpbl91c2UsIHJlbmRlciB9OiB7IGluX3VzZTogYm9vbGVhbjsgcmVuZGVyPzogJ2ltbWVkaWF0ZScgfCAnZGVib3VuY2VkJyB9LFxuKTogdm9pZCB7XG4gIGxldCBsb2Rhc2hfZGF0YSA9IF8oZGF0YSk7XG4gIE9iamVjdC5lbnRyaWVzKHNldHRpbmdzVG9VcGRhdGUpLmZvckVhY2goKFtrZXksIHsgb2FpX3NldHRpbmcgfV0pID0+IHtcbiAgICBsb2Rhc2hfZGF0YSA9IGxvZGFzaF9kYXRhLnNldChcbiAgICAgIGluX3VzZSA/IG9haV9zZXR0aW5nIDogXy5nZXQoaW5fdXNlX21hcCwgb2FpX3NldHRpbmcsIG9haV9zZXR0aW5nKSxcbiAgICAgIHVwZGF0ZXNba2V5IGFzIGtleW9mIF9PcmlnaW5hbFByZXNldF0sXG4gICAgKTtcbiAgfSk7XG4gIGxvZGFzaF9kYXRhLnZhbHVlKCk7XG5cbiAgaWYgKCFpbl91c2UpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCBjaGVja2JveGVzID0gJCgpO1xuICBjb25zdCBpbnB1dHMgPSAkKCk7XG4gIE9iamVjdC5lbnRyaWVzKHNldHRpbmdzVG9VcGRhdGUpLmZvckVhY2goKFtrZXksIHsgc2VsZWN0b3IsIHR5cGUgfV0pID0+IHtcbiAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgIGNhc2UgJ2NoZWNrYm94JzpcbiAgICAgICAgJChzZWxlY3RvcikucHJvcCgnY2hlY2tlZCcsIHVwZGF0ZXNba2V5IGFzIGtleW9mIF9PcmlnaW5hbFByZXNldF0pO1xuICAgICAgICBjaGVja2JveGVzLmFkZChzZWxlY3Rvcik7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnaW5wdXQnOlxuICAgICAgICAkKHNlbGVjdG9yKS52YWwodXBkYXRlc1trZXkgYXMga2V5b2YgX09yaWdpbmFsUHJlc2V0XSBhcyBudW1iZXIgfCBzdHJpbmcpO1xuICAgICAgICBpbnB1dHMuYWRkKHNlbGVjdG9yKTtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICB9KTtcblxuICAkKGNoZWNrYm94ZXMpLnRyaWdnZXIoJ2lucHV0JywgeyBzb3VyY2U6ICdwcmVzZXQnIH0pO1xuICAkKGlucHV0cykudHJpZ2dlcignaW5wdXQnLCB7IHNvdXJjZTogJ3ByZXNldCcgfSk7XG4gIHNhdmVTZXR0aW5nc0RlYm91bmNlZCgpO1xuICBpZiAocmVuZGVyID09PSAnZGVib3VuY2VkJykge1xuICAgIHByb21wdE1hbmFnZXIucmVuZGVyRGVib3VuY2VkKCk7XG4gIH0gZWxzZSB7XG4gICAgcHJvbXB0TWFuYWdlci5yZW5kZXIoZmFsc2UpO1xuICB9XG59XG50eXBlIFJlcGxhY2VQcmVzZXRPcHRpb25zID0ge1xuICByZW5kZXI/OiAnZGVib3VuY2VkJyB8ICdpbW1lZGlhdGUnO1xufTtcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVPclJlcGxhY2VQcmVzZXQoXG4gIHByZXNldF9uYW1lOiBMaXRlcmFsVW5pb248J2luX3VzZScsIHN0cmluZz4sXG4gIHByZXNldDogUHJlc2V0ID0gZGVmYXVsdF9wcmVzZXQsXG4gIHsgcmVuZGVyID0gJ2RlYm91bmNlZCcgfTogUmVwbGFjZVByZXNldE9wdGlvbnMgPSB7fSxcbik6IFByb21pc2U8Ym9vbGVhbj4ge1xuICBjb25zdCBvcmlnaW5hbF9wcmVzZXQgPSBmcm9tUHJlc2V0KHByZXNldCk7XG5cbiAgY29uc3QgaXNfZXhpc3RpbmcgPSBnZXRQcmVzZXROYW1lcygpLmluY2x1ZGVzKHByZXNldF9uYW1lKTtcbiAgaWYgKCFpc19leGlzdGluZykge1xuICAgIGNvbnN0IHsgcHJlc2V0cywgcHJlc2V0X25hbWVzIH0gPSBwcmVzZXRfbWFuYWdlci5nZXRQcmVzZXRMaXN0KCk7XG4gICAgcHJlc2V0cy5wdXNoKG9yaWdpbmFsX3ByZXNldCk7XG4gICAgKHByZXNldF9uYW1lcyBhcyBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+KVtwcmVzZXRfbmFtZV0gPSBwcmVzZXRzLmxlbmd0aCAtIDE7XG4gICAgcHJlc2V0X21hbmFnZXIuc2VsZWN0LmFwcGVuZChcbiAgICAgICQoJzxvcHRpb24+PC9vcHRpb24+JywgeyB2YWx1ZTogcHJlc2V0cy5sZW5ndGggLSAxLCB0ZXh0OiBwcmVzZXRfbmFtZSwgc2VsZWN0ZWQ6IGZhbHNlIH0pLFxuICAgICk7XG4gIH0gZWxzZSB7XG4gICAgdXBkYXRlT3JpZ2luYWxQcmVzZXREYXRhKFxuICAgICAgcHJlc2V0X25hbWUgPT09ICdpbl91c2UnID8gb2FpX3NldHRpbmdzIDogcHJlc2V0X21hbmFnZXIuZ2V0Q29tcGxldGlvblByZXNldEJ5TmFtZShwcmVzZXRfbmFtZSksXG4gICAgICBvcmlnaW5hbF9wcmVzZXQsXG4gICAgICB7XG4gICAgICAgIGluX3VzZTogcHJlc2V0X25hbWUgPT09ICdpbl91c2UnLFxuICAgICAgICByZW5kZXIsXG4gICAgICB9LFxuICAgICk7XG4gIH1cblxuICBpZiAocHJlc2V0X25hbWUgIT09ICdpbl91c2UnKSB7XG4gICAgYXdhaXQgcHJlc2V0X21hbmFnZXIuc2F2ZVByZXNldChwcmVzZXRfbmFtZSwgcHJlc2V0X21hbmFnZXIuZ2V0Q29tcGxldGlvblByZXNldEJ5TmFtZShwcmVzZXRfbmFtZSksIHtcbiAgICAgIHNraXBVcGRhdGU6IHRydWUsXG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gIWlzX2V4aXN0aW5nO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlUHJlc2V0KHByZXNldF9uYW1lOiBFeGNsdWRlPHN0cmluZywgJ2luX3VzZSc+KTogUHJvbWlzZTxib29sZWFuPiB7XG4gIHJldHVybiBCb29sZWFuKGF3YWl0IHByZXNldF9tYW5hZ2VyLmRlbGV0ZVByZXNldChwcmVzZXRfbmFtZSkpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVuYW1lUHJlc2V0KHByZXNldF9uYW1lOiBFeGNsdWRlPHN0cmluZywgJ2luX3VzZSc+LCBuZXdfbmFtZTogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gIGlmICghZ2V0UHJlc2V0TmFtZXMoKS5pbmNsdWRlcyhwcmVzZXRfbmFtZSkpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgYXdhaXQgY3JlYXRlUHJlc2V0KG5ld19uYW1lLCBnZXRQcmVzZXQocHJlc2V0X25hbWUpISk7XG4gIGF3YWl0IGRlbGV0ZVByZXNldChwcmVzZXRfbmFtZSk7XG4gIHJldHVybiB0cnVlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0UHJlc2V0KHByZXNldF9uYW1lOiBMaXRlcmFsVW5pb248J2luX3VzZScsIHN0cmluZz4pOiBQcmVzZXQge1xuICBjb25zdCBvcmlnaW5hbF9wcmVzZXQgPVxuICAgIHByZXNldF9uYW1lID09PSAnaW5fdXNlJyA/IG9haV9zZXR0aW5ncyA6IHByZXNldF9tYW5hZ2VyLmdldENvbXBsZXRpb25QcmVzZXRCeU5hbWUocHJlc2V0X25hbWUpO1xuICBpZiAoIW9yaWdpbmFsX3ByZXNldCkge1xuICAgIHRocm93IEVycm9yKGDpooTorr4gJyR7cHJlc2V0X25hbWV9JyDkuI3lrZjlnKhgKTtcbiAgfVxuICByZXR1cm4gc3RydWN0dXJlZENsb25lKHRvUHJlc2V0KG9yaWdpbmFsX3ByZXNldCwgeyBpbl91c2U6IHByZXNldF9uYW1lID09PSAnaW5fdXNlJyB9KSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXBsYWNlUHJlc2V0KFxuICBwcmVzZXRfbmFtZTogTGl0ZXJhbFVuaW9uPCdpbl91c2UnLCBzdHJpbmc+LFxuICBwcmVzZXQ6IFByZXNldCxcbiAgb3B0aW9uczogUmVwbGFjZVByZXNldE9wdGlvbnMgPSB7fSxcbik6IFByb21pc2U8dm9pZD4ge1xuICBpZiAoIWdldFByZXNldE5hbWVzKCkuaW5jbHVkZXMocHJlc2V0X25hbWUpKSB7XG4gICAgdGhyb3cgRXJyb3IoYOmihOiuviAnJHtwcmVzZXRfbmFtZX0nIOS4jeWtmOWcqGApO1xuICB9XG4gIGF3YWl0IGNyZWF0ZU9yUmVwbGFjZVByZXNldChwcmVzZXRfbmFtZSwgcHJlc2V0LCBvcHRpb25zKTtcbn1cblxudHlwZSBQcmVzZXRVcGRhdGVyID0gKChwcmVzZXQ6IFByZXNldCkgPT4gUHJlc2V0KSB8ICgocHJlc2V0OiBQcmVzZXQpID0+IFByb21pc2U8UHJlc2V0Pik7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVQcmVzZXRXaXRoKFxuICBwcmVzZXRfbmFtZTogTGl0ZXJhbFVuaW9uPCdpbl91c2UnLCBzdHJpbmc+LFxuICB1cGRhdGVyOiBQcmVzZXRVcGRhdGVyLFxuICBvcHRpb25zOiBSZXBsYWNlUHJlc2V0T3B0aW9ucyA9IHt9LFxuKTogUHJvbWlzZTxQcmVzZXQ+IHtcbiAgaWYgKCFnZXRQcmVzZXROYW1lcygpLmluY2x1ZGVzKHByZXNldF9uYW1lKSkge1xuICAgIHRocm93IEVycm9yKGDpooTorr4gJyR7cHJlc2V0X25hbWV9JyDkuI3lrZjlnKhgKTtcbiAgfVxuICBjb25zdCBwcmVzZXQgPSBhd2FpdCB1cGRhdGVyKGdldFByZXNldChwcmVzZXRfbmFtZSkhKTtcbiAgYXdhaXQgcmVwbGFjZVByZXNldChwcmVzZXRfbmFtZSwgcHJlc2V0LCBvcHRpb25zKTtcbiAgcmV0dXJuIHByZXNldDtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNldFByZXNldChcbiAgcHJlc2V0X25hbWU6IExpdGVyYWxVbmlvbjwnaW5fdXNlJywgc3RyaW5nPixcbiAgcHJlc2V0OiBQYXJ0aWFsRGVlcDxQcmVzZXQ+LFxuICBvcHRpb25zOiBSZXBsYWNlUHJlc2V0T3B0aW9ucyA9IHt9LFxuKTogUHJvbWlzZTxQcmVzZXQ+IHtcbiAgcmV0dXJuIGF3YWl0IHVwZGF0ZVByZXNldFdpdGgoXG4gICAgcHJlc2V0X25hbWUsXG4gICAgb2xkX3ByZXNldCA9PiB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzZXR0aW5nczogXy5kZWZhdWx0c0RlZXAocHJlc2V0LnNldHRpbmdzLCBvbGRfcHJlc2V0LnNldHRpbmdzKSxcbiAgICAgICAgcHJvbXB0czogcHJlc2V0LnByb21wdHMgPz8gb2xkX3ByZXNldC5wcm9tcHRzLFxuICAgICAgICBwcm9tcHRzX3VudXNlZDogcHJlc2V0LnByb21wdHNfdW51c2VkID8/IG9sZF9wcmVzZXQucHJvbXB0c191bnVzZWQsXG4gICAgICAgIGV4dGVuc2lvbnM6IF8uZGVmYXVsdHNEZWVwKHByZXNldC5leHRlbnNpb25zLCBvbGRfcHJlc2V0LmV4dGVuc2lvbnMpLFxuICAgICAgfTtcbiAgICB9LFxuICAgIG9wdGlvbnMsXG4gICk7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/function/preset.ts\n\n}")},"./src/function/script_repository.ts":
/*!*******************************************!*\
  !*** ./src/function/script_repository.ts ***!
  \*******************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   appendInexistentScriptButtons: () => (/* binding */ appendInexistentScriptButtons),\n/* harmony export */   getScriptButtons: () => (/* binding */ getScriptButtons),\n/* harmony export */   replaceScriptButtons: () => (/* binding */ replaceScriptButtons)\n/* harmony export */ });\n/* harmony import */ var _component_script_repository_data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/script_repository/data */ "./src/component/script_repository/data.ts");\n/* harmony import */ var _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/component/script_repository/script_controller */ "./src/component/script_repository/script_controller.ts");\n\n\nfunction getScriptButtons(script_id) {\n    if (!script_id) {\n        throw new Error(\'脚本ID不能为空\');\n    }\n    return _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_1__.ScriptManager.getInstance().getScriptButton(script_id);\n}\nfunction replaceScriptButtons(script_id, buttons) {\n    if (!script_id) {\n        throw new Error(`脚本ID不能为空`);\n    }\n    const script = _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_1__.ScriptManager.getInstance().getScriptById(script_id);\n    if (!script) {\n        throw new Error(`脚本不存在: ${script_id}`);\n    }\n    const type = _component_script_repository_data__WEBPACK_IMPORTED_MODULE_0__.ScriptData.getInstance().getScriptType(script);\n    script.buttons = buttons;\n    _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_1__.ScriptManager.getInstance().setScriptButton(script, type);\n}\nfunction appendInexistentScriptButtons(script_id, buttons) {\n    const script_buttons = getScriptButtons(script_id);\n    const inexistent_buttons = buttons.filter(button => !script_buttons.some(sb => sb.name === button.name));\n    if (inexistent_buttons.length === 0) {\n        return;\n    }\n    replaceScriptButtons(script_id, [...script_buttons, ...inexistent_buttons]);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZnVuY3Rpb24vc2NyaXB0X3JlcG9zaXRvcnkudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBZ0U7QUFDZ0I7QUFPekUsU0FBUyxnQkFBZ0IsQ0FBQyxTQUFpQjtJQUNoRCxJQUFJLENBQUMsU0FBUyxFQUFFLENBQUM7UUFDZixNQUFNLElBQUksS0FBSyxDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBQzlCLENBQUM7SUFDRCxPQUFPLHlGQUFhLENBQUMsV0FBVyxFQUFFLENBQUMsZUFBZSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQ2hFLENBQUM7QUFFTSxTQUFTLG9CQUFvQixDQUFDLFNBQWlCLEVBQUUsT0FBdUI7SUFDN0UsSUFBSSxDQUFDLFNBQVMsRUFBRSxDQUFDO1FBQ2YsTUFBTSxJQUFJLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUM5QixDQUFDO0lBRUQsTUFBTSxNQUFNLEdBQUcseUZBQWEsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxhQUFhLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDcEUsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDO1FBQ1osTUFBTSxJQUFJLEtBQUssQ0FBQyxVQUFVLFNBQVMsRUFBRSxDQUFDLENBQUM7SUFDekMsQ0FBQztJQUVELE1BQU0sSUFBSSxHQUFHLHlFQUFVLENBQUMsV0FBVyxFQUFFLENBQUMsYUFBYSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBRTVELE1BQU0sQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDO0lBQ3pCLHlGQUFhLENBQUMsV0FBVyxFQUFFLENBQUMsZUFBZSxDQUFDLE1BQU0sRUFBRSxJQUFJLENBQUMsQ0FBQztBQUM1RCxDQUFDO0FBRU0sU0FBUyw2QkFBNkIsQ0FBQyxTQUFpQixFQUFFLE9BQXVCO0lBQ3RGLE1BQU0sY0FBYyxHQUFHLGdCQUFnQixDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBQ25ELE1BQU0sa0JBQWtCLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxJQUFJLEtBQUssTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7SUFDekcsSUFBSSxrQkFBa0IsQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFLENBQUM7UUFDcEMsT0FBTztJQUNULENBQUM7SUFFRCxvQkFBb0IsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxHQUFHLGNBQWMsRUFBRSxHQUFHLGtCQUFrQixDQUFDLENBQUMsQ0FBQztBQUM5RSxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2Z1bmN0aW9uL3NjcmlwdF9yZXBvc2l0b3J5LnRzPzEyMTAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgU2NyaXB0RGF0YSB9IGZyb20gJ0AvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L2RhdGEnO1xuaW1wb3J0IHsgU2NyaXB0TWFuYWdlciB9IGZyb20gJ0AvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3NjcmlwdF9jb250cm9sbGVyJztcblxudHlwZSBTY3JpcHRCdXR0b24gPSB7XG4gIG5hbWU6IHN0cmluZztcbiAgdmlzaWJsZTogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFNjcmlwdEJ1dHRvbnMoc2NyaXB0X2lkOiBzdHJpbmcpOiBTY3JpcHRCdXR0b25bXSB7XG4gIGlmICghc2NyaXB0X2lkKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCfohJrmnKxJROS4jeiDveS4uuepuicpO1xuICB9XG4gIHJldHVybiBTY3JpcHRNYW5hZ2VyLmdldEluc3RhbmNlKCkuZ2V0U2NyaXB0QnV0dG9uKHNjcmlwdF9pZCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZXBsYWNlU2NyaXB0QnV0dG9ucyhzY3JpcHRfaWQ6IHN0cmluZywgYnV0dG9uczogU2NyaXB0QnV0dG9uW10pOiB2b2lkIHtcbiAgaWYgKCFzY3JpcHRfaWQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYOiEmuacrElE5LiN6IO95Li656m6YCk7XG4gIH1cblxuICBjb25zdCBzY3JpcHQgPSBTY3JpcHRNYW5hZ2VyLmdldEluc3RhbmNlKCkuZ2V0U2NyaXB0QnlJZChzY3JpcHRfaWQpO1xuICBpZiAoIXNjcmlwdCkge1xuICAgIHRocm93IG5ldyBFcnJvcihg6ISa5pys5LiN5a2Y5ZyoOiAke3NjcmlwdF9pZH1gKTtcbiAgfVxuXG4gIGNvbnN0IHR5cGUgPSBTY3JpcHREYXRhLmdldEluc3RhbmNlKCkuZ2V0U2NyaXB0VHlwZShzY3JpcHQpO1xuXG4gIHNjcmlwdC5idXR0b25zID0gYnV0dG9ucztcbiAgU2NyaXB0TWFuYWdlci5nZXRJbnN0YW5jZSgpLnNldFNjcmlwdEJ1dHRvbihzY3JpcHQsIHR5cGUpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYXBwZW5kSW5leGlzdGVudFNjcmlwdEJ1dHRvbnMoc2NyaXB0X2lkOiBzdHJpbmcsIGJ1dHRvbnM6IFNjcmlwdEJ1dHRvbltdKTogdm9pZCB7XG4gIGNvbnN0IHNjcmlwdF9idXR0b25zID0gZ2V0U2NyaXB0QnV0dG9ucyhzY3JpcHRfaWQpO1xuICBjb25zdCBpbmV4aXN0ZW50X2J1dHRvbnMgPSBidXR0b25zLmZpbHRlcihidXR0b24gPT4gIXNjcmlwdF9idXR0b25zLnNvbWUoc2IgPT4gc2IubmFtZSA9PT0gYnV0dG9uLm5hbWUpKTtcbiAgaWYgKGluZXhpc3RlbnRfYnV0dG9ucy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm47XG4gIH1cblxuICByZXBsYWNlU2NyaXB0QnV0dG9ucyhzY3JpcHRfaWQsIFsuLi5zY3JpcHRfYnV0dG9ucywgLi4uaW5leGlzdGVudF9idXR0b25zXSk7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/function/script_repository.ts\n\n}')},"./src/function/slash.ts":
/*!*******************************!*\
  !*** ./src/function/slash.ts ***!
  \*******************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   triggerSlash: () => (/* binding */ triggerSlash)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_scripts_slash_commands__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/scripts/slash-commands */ "@sillytavern/scripts/slash-commands");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! loglevel */ "./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_1__);\n\n\nasync function triggerSlash(command) {\n    const result = await (0,_sillytavern_scripts_slash_commands__WEBPACK_IMPORTED_MODULE_0__.executeSlashCommandsWithOptions)(command);\n    if (result.isError) {\n        throw Error(`运行 Slash 命令 \'${command}\' 时出错: ${result.errorMessage}`);\n    }\n    loglevel__WEBPACK_IMPORTED_MODULE_1___default().info(`运行 Slash 命令: ${command}`);\n    return result.pipe;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZnVuY3Rpb24vc2xhc2gudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFzRjtBQUUzRDtBQUVwQixLQUFLLFVBQVUsWUFBWSxDQUFDLE9BQWU7SUFDaEQsTUFBTSxNQUFNLEdBQUcsTUFBTSxvR0FBK0IsQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUM5RCxJQUFJLE1BQU0sQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUNuQixNQUFNLEtBQUssQ0FBQyxnQkFBZ0IsT0FBTyxVQUFVLE1BQU0sQ0FBQyxZQUFZLEVBQUUsQ0FBQyxDQUFDO0lBQ3RFLENBQUM7SUFFRCxvREFBUSxDQUFDLGdCQUFnQixPQUFPLEVBQUUsQ0FBQyxDQUFDO0lBQ3BDLE9BQU8sTUFBTSxDQUFDLElBQUksQ0FBQztBQUNyQixDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2Z1bmN0aW9uL3NsYXNoLnRzPzM1ZDAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZXhlY3V0ZVNsYXNoQ29tbWFuZHNXaXRoT3B0aW9ucyB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3NsYXNoLWNvbW1hbmRzJztcblxuaW1wb3J0IGxvZyBmcm9tICdsb2dsZXZlbCc7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB0cmlnZ2VyU2xhc2goY29tbWFuZDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZXhlY3V0ZVNsYXNoQ29tbWFuZHNXaXRoT3B0aW9ucyhjb21tYW5kKTtcbiAgaWYgKHJlc3VsdC5pc0Vycm9yKSB7XG4gICAgdGhyb3cgRXJyb3IoYOi/kOihjCBTbGFzaCDlkb3ku6QgJyR7Y29tbWFuZH0nIOaXtuWHuumUmTogJHtyZXN1bHQuZXJyb3JNZXNzYWdlfWApO1xuICB9XG5cbiAgbG9nLmluZm8oYOi/kOihjCBTbGFzaCDlkb3ku6Q6ICR7Y29tbWFuZH1gKTtcbiAgcmV0dXJuIHJlc3VsdC5waXBlO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/function/slash.ts\n\n}')},"./src/function/tavern_regex.ts":
/*!**************************************!*\
  !*** ./src/function/tavern_regex.ts ***!
  \**************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   formatAsTavernRegexedString: () => (/* binding */ formatAsTavernRegexedString),\n/* harmony export */   getCharacterRegexes: () => (/* binding */ getCharacterRegexes),\n/* harmony export */   getGlobalRegexes: () => (/* binding */ getGlobalRegexes),\n/* harmony export */   getTavernRegexes: () => (/* binding */ getTavernRegexes),\n/* harmony export */   isCharacterTavernRegexEnabled: () => (/* binding */ isCharacterTavernRegexEnabled),\n/* harmony export */   isCharacterTavernRegexesEnabled: () => (/* binding */ isCharacterTavernRegexesEnabled),\n/* harmony export */   replaceTavernRegexes: () => (/* binding */ replaceTavernRegexes),\n/* harmony export */   updateTavernRegexesWith: () => (/* binding */ updateTavernRegexesWith)\n/* harmony export */ });\n/* harmony import */ var _component_macrolike__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/macrolike */ \"./src/component/macrolike.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var _sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/scripts/extensions/regex/engine */ \"@sillytavern/scripts/extensions/regex/engine\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_4__);\n\n\n\n\n\nfunction formatAsTavernRegexedString(text, source, destination, { depth, character_name } = {}) {\n    let result = (0,_sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_3__.getRegexedString)(text, {\n        user_input: _sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_3__.regex_placement.USER_INPUT,\n        ai_output: _sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_3__.regex_placement.AI_OUTPUT,\n        slash_command: _sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_3__.regex_placement.SLASH_COMMAND,\n        world_info: _sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_3__.regex_placement.WORLD_INFO,\n        reasoning: _sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_3__.regex_placement.REASONING,\n    }[source], {\n        characterOverride: character_name,\n        isMarkdown: destination === 'display',\n        isPrompt: destination === 'prompt',\n        depth,\n    });\n    result = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.substituteParams)(result, undefined, character_name, undefined, undefined);\n    _component_macrolike__WEBPACK_IMPORTED_MODULE_0__.macros.forEach(macro => {\n        result = result.replace(macro.regex, (substring, ...args) => macro.replace({\n            role: {\n                user_input: 'user',\n                ai_output: 'assistant',\n                slash_command: 'system',\n                world_info: 'system',\n                reasoning: 'system',\n            }[source],\n            message_id: depth !== undefined ? _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat.length - depth - 1 : undefined,\n        }, substring, ...args));\n    });\n    return result;\n}\nfunction isCharacterTavernRegexEnabled() {\n    // @ts-ignore 2345\n    return _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.extension_settings?.character_allowed_regex?.includes(_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.characters?.[_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.this_chid]?.avatar);\n}\nfunction getGlobalRegexes() {\n    return _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.extension_settings.regex ?? [];\n}\nfunction getCharacterRegexes() {\n    // @ts-ignore\n    return _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.this_chid]?.data?.extensions?.regex_scripts ?? [];\n}\nfunction toTavernRegex(regex_script_data, scope) {\n    return {\n        id: regex_script_data.id,\n        script_name: regex_script_data.scriptName,\n        enabled: !regex_script_data.disabled,\n        run_on_edit: regex_script_data.runOnEdit,\n        scope: scope,\n        find_regex: regex_script_data.findRegex,\n        replace_string: regex_script_data.replaceString,\n        source: {\n            user_input: regex_script_data.placement.includes(_sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_3__.regex_placement.USER_INPUT),\n            ai_output: regex_script_data.placement.includes(_sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_3__.regex_placement.AI_OUTPUT),\n            slash_command: regex_script_data.placement.includes(_sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_3__.regex_placement.SLASH_COMMAND),\n            world_info: regex_script_data.placement.includes(_sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_3__.regex_placement.WORLD_INFO),\n        },\n        destination: {\n            display: regex_script_data.markdownOnly,\n            prompt: regex_script_data.promptOnly,\n        },\n        min_depth: typeof regex_script_data.minDepth === 'number' ? regex_script_data.minDepth : null,\n        max_depth: typeof regex_script_data.maxDepth === 'number' ? regex_script_data.maxDepth : null,\n    };\n}\nfunction fromTavernRegex(tavern_regex) {\n    return {\n        id: tavern_regex.id,\n        scriptName: tavern_regex.script_name,\n        disabled: !tavern_regex.enabled,\n        runOnEdit: tavern_regex.run_on_edit,\n        findRegex: tavern_regex.find_regex,\n        replaceString: tavern_regex.replace_string,\n        trimStrings: [], // TODO: handle this?\n        placement: [\n            ...(tavern_regex.source.user_input ? [_sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_3__.regex_placement.USER_INPUT] : []),\n            ...(tavern_regex.source.ai_output ? [_sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_3__.regex_placement.AI_OUTPUT] : []),\n            ...(tavern_regex.source.slash_command ? [_sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_3__.regex_placement.SLASH_COMMAND] : []),\n            ...(tavern_regex.source.world_info ? [_sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_3__.regex_placement.WORLD_INFO] : []),\n        ],\n        substituteRegex: 0, // TODO: handle this?\n        // @ts-ignore\n        minDepth: tavern_regex.min_depth,\n        // @ts-ignore\n        maxDepth: tavern_regex.max_depth,\n        markdownOnly: tavern_regex.destination.display,\n        promptOnly: tavern_regex.destination.prompt,\n    };\n}\nfunction isCharacterTavernRegexesEnabled() {\n    const result = isCharacterTavernRegexEnabled();\n    loglevel__WEBPACK_IMPORTED_MODULE_4___default().info(`查询到局部正则${result ? '被启用' : '被禁用'}`);\n    return result;\n}\nfunction getTavernRegexes({ scope = 'all', enable_state = 'all' } = {}) {\n    if (!['all', 'enabled', 'disabled'].includes(enable_state)) {\n        throw Error(`提供的 enable_state 无效, 请提供 'all', 'enabled' 或 'disabled', 你提供的是: ${enable_state}`);\n    }\n    if (!['all', 'global', 'character'].includes(scope)) {\n        throw Error(`提供的 scope 无效, 请提供 'all', 'global' 或 'character', 你提供的是: ${scope}`);\n    }\n    let regexes = [];\n    if (scope === 'all' || scope === 'global') {\n        regexes = [...regexes, ...getGlobalRegexes().map(regex => toTavernRegex(regex, 'global'))];\n    }\n    if (scope === 'all' || scope === 'character') {\n        regexes = [...regexes, ...getCharacterRegexes().map(regex => toTavernRegex(regex, 'character'))];\n    }\n    if (enable_state !== 'all') {\n        regexes = regexes.filter(regex => regex.enabled === (enable_state === 'enabled'));\n    }\n    return structuredClone(regexes);\n}\nasync function replaceTavernRegexes(regexes, { scope = 'all' }) {\n    if (!['all', 'global', 'character'].includes(scope)) {\n        throw Error(`提供的 scope 无效, 请提供 'all', 'global' 或 'character', 你提供的是: ${scope}`);\n    }\n    // FIXME: `trimStrings` and `substituteRegex` are not considered\n    const emptied_regexes = regexes.filter(regex => regex.script_name == '');\n    if (emptied_regexes.length > 0) {\n        throw Error(`不能将酒馆正则的名称设置为空字符串:\\n${JSON.stringify(emptied_regexes.map(regex => regex.id))}`);\n    }\n    const [global_regexes, character_regexes] = _.partition(regexes, regex => regex.scope === 'global').map(paritioned => paritioned.map(fromTavernRegex));\n    // @ts-ignore\n    const character = _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.this_chid];\n    if (scope === 'all' || scope === 'global') {\n        _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.extension_settings.regex = global_regexes;\n    }\n    if (scope === 'all' || scope === 'character') {\n        if (character) {\n            // @ts-ignore\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.this_chid].data.extensions.regex_scripts = character_regexes;\n            // @ts-ignore\n            await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.writeExtensionField)(_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.this_chid, 'regex_scripts', character_regexes);\n        }\n    }\n    await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.saveSettings)();\n    if (character) {\n        await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.saveChatConditional)();\n    }\n    await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.reloadCurrentChat)();\n    loglevel__WEBPACK_IMPORTED_MODULE_4___default().info(`替换酒馆正则\\\n${scope === 'all' || scope === 'global' ? `, 全局正则:\\n${JSON.stringify(global_regexes)}` : ``}\\\n${scope === 'all' || scope === 'character' ? `, 局部正则:\\n${JSON.stringify(character_regexes)}` : ``}`);\n}\nasync function updateTavernRegexesWith(updater, { scope = 'all' } = {}) {\n    let regexes = getTavernRegexes({ scope });\n    regexes = await updater(regexes);\n    loglevel__WEBPACK_IMPORTED_MODULE_4___default().info(`对${{ all: '全部', global: '全局', character: '局部' }[scope]}变量表进行更新`);\n    await replaceTavernRegexes(regexes, { scope });\n    return regexes;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZnVuY3Rpb24vdGF2ZXJuX3JlZ2V4LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQStDO0FBU2xCO0FBRTZEO0FBQ087QUFFdEU7QUFPcEIsU0FBUywyQkFBMkIsQ0FDekMsSUFBWSxFQUNaLE1BQWlGLEVBQ2pGLFdBQWlDLEVBQ2pDLEVBQUUsS0FBSyxFQUFFLGNBQWMsS0FBd0MsRUFBRTtJQUVqRSxJQUFJLE1BQU0sR0FBRyw4RkFBZ0IsQ0FDM0IsSUFBSSxFQUVGO1FBQ0UsVUFBVSxFQUFFLHlGQUFlLENBQUMsVUFBVTtRQUN0QyxTQUFTLEVBQUUseUZBQWUsQ0FBQyxTQUFTO1FBQ3BDLGFBQWEsRUFBRSx5RkFBZSxDQUFDLGFBQWE7UUFDNUMsVUFBVSxFQUFFLHlGQUFlLENBQUMsVUFBVTtRQUN0QyxTQUFTLEVBQUUseUZBQWUsQ0FBQyxTQUFTO0tBRXZDLENBQUMsTUFBTSxDQUFDLEVBQ1Q7UUFDRSxpQkFBaUIsRUFBRSxjQUFjO1FBQ2pDLFVBQVUsRUFBRSxXQUFXLEtBQUssU0FBUztRQUNyQyxRQUFRLEVBQUUsV0FBVyxLQUFLLFFBQVE7UUFDbEMsS0FBSztLQUNOLENBQ0YsQ0FBQztJQUNGLE1BQU0sR0FBRyxxRUFBZ0IsQ0FBQyxNQUFNLEVBQUUsU0FBUyxFQUFFLGNBQWMsRUFBRSxTQUFTLEVBQUUsU0FBUyxDQUFDLENBQUM7SUFDbkYsd0RBQU0sQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEVBQUU7UUFDckIsTUFBTSxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEtBQUssRUFBRSxDQUFDLFNBQVMsRUFBRSxHQUFHLElBQUksRUFBRSxFQUFFLENBQzFELEtBQUssQ0FBQyxPQUFPLENBQ1g7WUFDRSxJQUFJLEVBQ0Y7Z0JBQ0UsVUFBVSxFQUFFLE1BQU07Z0JBQ2xCLFNBQVMsRUFBRSxXQUFXO2dCQUN0QixhQUFhLEVBQUUsUUFBUTtnQkFDdkIsVUFBVSxFQUFFLFFBQVE7Z0JBQ3BCLFNBQVMsRUFBRSxRQUFRO2FBRXRCLENBQUMsTUFBTSxDQUFDO1lBQ1QsVUFBVSxFQUFFLEtBQUssS0FBSyxTQUFTLENBQUMsQ0FBQyxDQUFDLHFEQUFJLENBQUMsTUFBTSxHQUFHLEtBQUssR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVM7U0FDdEUsRUFDRCxTQUFTLEVBQ1QsR0FBRyxJQUFJLENBQ1IsQ0FDRixDQUFDO0lBQ0osQ0FBQyxDQUFDLENBQUM7SUFDSCxPQUFPLE1BQU0sQ0FBQztBQUNoQixDQUFDO0FBNEJNLFNBQVMsNkJBQTZCO0lBQzNDLGtCQUFrQjtJQUNsQixPQUFPLCtFQUFrQixFQUFFLHVCQUF1QixFQUFFLFFBQVEsQ0FBQywyREFBVSxFQUFFLENBQUMsMERBQVMsQ0FBQyxFQUFFLE1BQU0sQ0FBQyxDQUFDO0FBQ2hHLENBQUM7QUFFTSxTQUFTLGdCQUFnQjtJQUM5QixPQUFPLCtFQUFrQixDQUFDLEtBQUssSUFBSSxFQUFFLENBQUM7QUFDeEMsQ0FBQztBQUVNLFNBQVMsbUJBQW1CO0lBQ2pDLGFBQWE7SUFDYixPQUFPLDJEQUFVLENBQUMsMERBQVMsQ0FBQyxFQUFFLElBQUksRUFBRSxVQUFVLEVBQUUsYUFBYSxJQUFJLEVBQUUsQ0FBQztBQUN0RSxDQUFDO0FBRUQsU0FBUyxhQUFhLENBQUMsaUJBQWtDLEVBQUUsS0FBNkI7SUFDdEYsT0FBTztRQUNMLEVBQUUsRUFBRSxpQkFBaUIsQ0FBQyxFQUFFO1FBQ3hCLFdBQVcsRUFBRSxpQkFBaUIsQ0FBQyxVQUFVO1FBQ3pDLE9BQU8sRUFBRSxDQUFDLGlCQUFpQixDQUFDLFFBQVE7UUFDcEMsV0FBVyxFQUFFLGlCQUFpQixDQUFDLFNBQVM7UUFDeEMsS0FBSyxFQUFFLEtBQUs7UUFFWixVQUFVLEVBQUUsaUJBQWlCLENBQUMsU0FBUztRQUN2QyxjQUFjLEVBQUUsaUJBQWlCLENBQUMsYUFBYTtRQUUvQyxNQUFNLEVBQUU7WUFDTixVQUFVLEVBQUUsaUJBQWlCLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyx5RkFBZSxDQUFDLFVBQVUsQ0FBQztZQUM1RSxTQUFTLEVBQUUsaUJBQWlCLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyx5RkFBZSxDQUFDLFNBQVMsQ0FBQztZQUMxRSxhQUFhLEVBQUUsaUJBQWlCLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyx5RkFBZSxDQUFDLGFBQWEsQ0FBQztZQUNsRixVQUFVLEVBQUUsaUJBQWlCLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyx5RkFBZSxDQUFDLFVBQVUsQ0FBQztTQUM3RTtRQUVELFdBQVcsRUFBRTtZQUNYLE9BQU8sRUFBRSxpQkFBaUIsQ0FBQyxZQUFZO1lBQ3ZDLE1BQU0sRUFBRSxpQkFBaUIsQ0FBQyxVQUFVO1NBQ3JDO1FBRUQsU0FBUyxFQUFFLE9BQU8saUJBQWlCLENBQUMsUUFBUSxLQUFLLFFBQVEsQ0FBQyxDQUFDLENBQUMsaUJBQWlCLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxJQUFJO1FBQzdGLFNBQVMsRUFBRSxPQUFPLGlCQUFpQixDQUFDLFFBQVEsS0FBSyxRQUFRLENBQUMsQ0FBQyxDQUFDLGlCQUFpQixDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsSUFBSTtLQUM5RixDQUFDO0FBQ0osQ0FBQztBQUVELFNBQVMsZUFBZSxDQUFDLFlBQXlCO0lBQ2hELE9BQU87UUFDTCxFQUFFLEVBQUUsWUFBWSxDQUFDLEVBQUU7UUFDbkIsVUFBVSxFQUFFLFlBQVksQ0FBQyxXQUFXO1FBQ3BDLFFBQVEsRUFBRSxDQUFDLFlBQVksQ0FBQyxPQUFPO1FBQy9CLFNBQVMsRUFBRSxZQUFZLENBQUMsV0FBVztRQUVuQyxTQUFTLEVBQUUsWUFBWSxDQUFDLFVBQVU7UUFDbEMsYUFBYSxFQUFFLFlBQVksQ0FBQyxjQUFjO1FBQzFDLFdBQVcsRUFBRSxFQUFFLEVBQUUscUJBQXFCO1FBRXRDLFNBQVMsRUFBRTtZQUNULEdBQUcsQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyx5RkFBZSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7WUFDdkUsR0FBRyxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLHlGQUFlLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQztZQUNyRSxHQUFHLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLENBQUMseUZBQWUsQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDO1lBQzdFLEdBQUcsQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyx5RkFBZSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7U0FDeEU7UUFFRCxlQUFlLEVBQUUsQ0FBQyxFQUFFLHFCQUFxQjtRQUV6QyxhQUFhO1FBQ2IsUUFBUSxFQUFFLFlBQVksQ0FBQyxTQUFTO1FBQ2hDLGFBQWE7UUFDYixRQUFRLEVBQUUsWUFBWSxDQUFDLFNBQVM7UUFFaEMsWUFBWSxFQUFFLFlBQVksQ0FBQyxXQUFXLENBQUMsT0FBTztRQUM5QyxVQUFVLEVBQUUsWUFBWSxDQUFDLFdBQVcsQ0FBQyxNQUFNO0tBQzVDLENBQUM7QUFDSixDQUFDO0FBRU0sU0FBUywrQkFBK0I7SUFDN0MsTUFBTSxNQUFNLEdBQUcsNkJBQTZCLEVBQUUsQ0FBQztJQUUvQyxvREFBUSxDQUFDLFVBQVUsTUFBTSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUM7SUFDN0MsT0FBTyxNQUFNLENBQUM7QUFDaEIsQ0FBQztBQU9NLFNBQVMsZ0JBQWdCLENBQUMsRUFBRSxLQUFLLEdBQUcsS0FBSyxFQUFFLFlBQVksR0FBRyxLQUFLLEtBQTZCLEVBQUU7SUFDbkcsSUFBSSxDQUFDLENBQUMsS0FBSyxFQUFFLFNBQVMsRUFBRSxVQUFVLENBQUMsQ0FBQyxRQUFRLENBQUMsWUFBWSxDQUFDLEVBQUUsQ0FBQztRQUMzRCxNQUFNLEtBQUssQ0FBQyxrRUFBa0UsWUFBWSxFQUFFLENBQUMsQ0FBQztJQUNoRyxDQUFDO0lBQ0QsSUFBSSxDQUFDLENBQUMsS0FBSyxFQUFFLFFBQVEsRUFBRSxXQUFXLENBQUMsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQztRQUNwRCxNQUFNLEtBQUssQ0FBQywyREFBMkQsS0FBSyxFQUFFLENBQUMsQ0FBQztJQUNsRixDQUFDO0lBRUQsSUFBSSxPQUFPLEdBQWtCLEVBQUUsQ0FBQztJQUNoQyxJQUFJLEtBQUssS0FBSyxLQUFLLElBQUksS0FBSyxLQUFLLFFBQVEsRUFBRSxDQUFDO1FBQzFDLE9BQU8sR0FBRyxDQUFDLEdBQUcsT0FBTyxFQUFFLEdBQUcsZ0JBQWdCLEVBQUUsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxhQUFhLENBQUMsS0FBSyxFQUFFLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUM3RixDQUFDO0lBQ0QsSUFBSSxLQUFLLEtBQUssS0FBSyxJQUFJLEtBQUssS0FBSyxXQUFXLEVBQUUsQ0FBQztRQUM3QyxPQUFPLEdBQUcsQ0FBQyxHQUFHLE9BQU8sRUFBRSxHQUFHLG1CQUFtQixFQUFFLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsYUFBYSxDQUFDLEtBQUssRUFBRSxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDbkcsQ0FBQztJQUNELElBQUksWUFBWSxLQUFLLEtBQUssRUFBRSxDQUFDO1FBQzNCLE9BQU8sR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLE9BQU8sS0FBSyxDQUFDLFlBQVksS0FBSyxTQUFTLENBQUMsQ0FBQyxDQUFDO0lBQ3BGLENBQUM7SUFFRCxPQUFPLGVBQWUsQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUNsQyxDQUFDO0FBTU0sS0FBSyxVQUFVLG9CQUFvQixDQUN4QyxPQUFzQixFQUN0QixFQUFFLEtBQUssR0FBRyxLQUFLLEVBQThCO0lBRTdDLElBQUksQ0FBQyxDQUFDLEtBQUssRUFBRSxRQUFRLEVBQUUsV0FBVyxDQUFDLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUM7UUFDcEQsTUFBTSxLQUFLLENBQUMsMkRBQTJELEtBQUssRUFBRSxDQUFDLENBQUM7SUFDbEYsQ0FBQztJQUVELGdFQUFnRTtJQUNoRSxNQUFNLGVBQWUsR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLFdBQVcsSUFBSSxFQUFFLENBQUMsQ0FBQztJQUN6RSxJQUFJLGVBQWUsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFLENBQUM7UUFDL0IsTUFBTSxLQUFLLENBQUMsdUJBQXVCLElBQUksQ0FBQyxTQUFTLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUMvRixDQUFDO0lBQ0QsTUFBTSxDQUFDLGNBQWMsRUFBRSxpQkFBaUIsQ0FBQyxHQUFHLENBQUMsQ0FBQyxTQUFTLENBQUMsT0FBTyxFQUFFLEtBQUssQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLEtBQUssS0FBSyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDLEVBQUUsQ0FDbkgsVUFBVSxDQUFDLEdBQUcsQ0FBQyxlQUFlLENBQUMsQ0FDaEMsQ0FBQztJQUVGLGFBQWE7SUFDYixNQUFNLFNBQVMsR0FBRywyREFBVSxDQUFDLDBEQUFTLENBQUMsQ0FBQztJQUN4QyxJQUFJLEtBQUssS0FBSyxLQUFLLElBQUksS0FBSyxLQUFLLFFBQVEsRUFBRSxDQUFDO1FBQzFDLCtFQUFrQixDQUFDLEtBQUssR0FBRyxjQUFjLENBQUM7SUFDNUMsQ0FBQztJQUNELElBQUksS0FBSyxLQUFLLEtBQUssSUFBSSxLQUFLLEtBQUssV0FBVyxFQUFFLENBQUM7UUFDN0MsSUFBSSxTQUFTLEVBQUUsQ0FBQztZQUNkLGFBQWE7WUFDYiwyREFBVSxDQUFDLDBEQUFTLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLGFBQWEsR0FBRyxpQkFBaUIsQ0FBQztZQUN4RSxhQUFhO1lBQ2IsTUFBTSxvRkFBbUIsQ0FBQywwREFBUyxFQUFFLGVBQWUsRUFBRSxpQkFBaUIsQ0FBQyxDQUFDO1FBQzNFLENBQUM7SUFDSCxDQUFDO0lBQ0QsTUFBTSxpRUFBWSxFQUFFLENBQUM7SUFDckIsSUFBSSxTQUFTLEVBQUUsQ0FBQztRQUNkLE1BQU0sd0VBQW1CLEVBQUUsQ0FBQztJQUM5QixDQUFDO0lBQ0QsTUFBTSxzRUFBaUIsRUFBRSxDQUFDO0lBRTFCLG9EQUFRLENBQUM7RUFDVCxLQUFLLEtBQUssS0FBSyxJQUFJLEtBQUssS0FBSyxRQUFRLENBQUMsQ0FBQyxDQUFDLFlBQVksSUFBSSxDQUFDLFNBQVMsQ0FBQyxjQUFjLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFO0VBQ3pGLEtBQUssS0FBSyxLQUFLLElBQUksS0FBSyxLQUFLLFdBQVcsQ0FBQyxDQUFDLENBQUMsWUFBWSxJQUFJLENBQUMsU0FBUyxDQUFDLGlCQUFpQixDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztBQUNyRyxDQUFDO0FBTU0sS0FBSyxVQUFVLHVCQUF1QixDQUMzQyxPQUEyQixFQUMzQixFQUFFLEtBQUssR0FBRyxLQUFLLEtBQWlDLEVBQUU7SUFFbEQsSUFBSSxPQUFPLEdBQUcsZ0JBQWdCLENBQUMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDO0lBQzFDLE9BQU8sR0FBRyxNQUFNLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUNqQyxvREFBUSxDQUFDLElBQUksRUFBRSxHQUFHLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUMsQ0FBQztJQUMzRSxNQUFNLG9CQUFvQixDQUFDLE9BQU8sRUFBRSxFQUFFLEtBQUssRUFBRSxDQUFDLENBQUM7SUFDL0MsT0FBTyxPQUFPLENBQUM7QUFDakIsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9mdW5jdGlvbi90YXZlcm5fcmVnZXgudHM/Njg5YiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBtYWNyb3MgfSBmcm9tICdAL2NvbXBvbmVudC9tYWNyb2xpa2UnO1xuaW1wb3J0IHtcbiAgY2hhcmFjdGVycyxcbiAgY2hhdCxcbiAgcmVsb2FkQ3VycmVudENoYXQsXG4gIHNhdmVDaGF0Q29uZGl0aW9uYWwsXG4gIHNhdmVTZXR0aW5ncyxcbiAgc3Vic3RpdHV0ZVBhcmFtcyxcbiAgdGhpc19jaGlkLFxufSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0JztcbmltcG9ydCB7IFJlZ2V4U2NyaXB0RGF0YSB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL2NoYXItZGF0YSc7XG5pbXBvcnQgeyBleHRlbnNpb25fc2V0dGluZ3MsIHdyaXRlRXh0ZW5zaW9uRmllbGQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9leHRlbnNpb25zJztcbmltcG9ydCB7IGdldFJlZ2V4ZWRTdHJpbmcsIHJlZ2V4X3BsYWNlbWVudCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL2V4dGVuc2lvbnMvcmVnZXgvZW5naW5lJztcblxuaW1wb3J0IGxvZyBmcm9tICdsb2dsZXZlbCc7XG5cbnR5cGUgRm9ybWF0QXNUYXZlcm5SZWdleGVkU3RyaW5nT3B0aW9uID0ge1xuICBkZXB0aD86IG51bWJlcjtcbiAgY2hhcmFjdGVyX25hbWU/OiBzdHJpbmc7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gZm9ybWF0QXNUYXZlcm5SZWdleGVkU3RyaW5nKFxuICB0ZXh0OiBzdHJpbmcsXG4gIHNvdXJjZTogJ3VzZXJfaW5wdXQnIHwgJ2FpX291dHB1dCcgfCAnc2xhc2hfY29tbWFuZCcgfCAnd29ybGRfaW5mbycgfCAncmVhc29uaW5nJyxcbiAgZGVzdGluYXRpb246ICdkaXNwbGF5JyB8ICdwcm9tcHQnLFxuICB7IGRlcHRoLCBjaGFyYWN0ZXJfbmFtZSB9OiBGb3JtYXRBc1RhdmVyblJlZ2V4ZWRTdHJpbmdPcHRpb24gPSB7fSxcbikge1xuICBsZXQgcmVzdWx0ID0gZ2V0UmVnZXhlZFN0cmluZyhcbiAgICB0ZXh0LFxuICAgIChcbiAgICAgIHtcbiAgICAgICAgdXNlcl9pbnB1dDogcmVnZXhfcGxhY2VtZW50LlVTRVJfSU5QVVQsXG4gICAgICAgIGFpX291dHB1dDogcmVnZXhfcGxhY2VtZW50LkFJX09VVFBVVCxcbiAgICAgICAgc2xhc2hfY29tbWFuZDogcmVnZXhfcGxhY2VtZW50LlNMQVNIX0NPTU1BTkQsXG4gICAgICAgIHdvcmxkX2luZm86IHJlZ2V4X3BsYWNlbWVudC5XT1JMRF9JTkZPLFxuICAgICAgICByZWFzb25pbmc6IHJlZ2V4X3BsYWNlbWVudC5SRUFTT05JTkcsXG4gICAgICB9IGFzIGNvbnN0XG4gICAgKVtzb3VyY2VdLFxuICAgIHtcbiAgICAgIGNoYXJhY3Rlck92ZXJyaWRlOiBjaGFyYWN0ZXJfbmFtZSxcbiAgICAgIGlzTWFya2Rvd246IGRlc3RpbmF0aW9uID09PSAnZGlzcGxheScsXG4gICAgICBpc1Byb21wdDogZGVzdGluYXRpb24gPT09ICdwcm9tcHQnLFxuICAgICAgZGVwdGgsXG4gICAgfSxcbiAgKTtcbiAgcmVzdWx0ID0gc3Vic3RpdHV0ZVBhcmFtcyhyZXN1bHQsIHVuZGVmaW5lZCwgY2hhcmFjdGVyX25hbWUsIHVuZGVmaW5lZCwgdW5kZWZpbmVkKTtcbiAgbWFjcm9zLmZvckVhY2gobWFjcm8gPT4ge1xuICAgIHJlc3VsdCA9IHJlc3VsdC5yZXBsYWNlKG1hY3JvLnJlZ2V4LCAoc3Vic3RyaW5nLCAuLi5hcmdzKSA9PlxuICAgICAgbWFjcm8ucmVwbGFjZShcbiAgICAgICAge1xuICAgICAgICAgIHJvbGU6IChcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgdXNlcl9pbnB1dDogJ3VzZXInLFxuICAgICAgICAgICAgICBhaV9vdXRwdXQ6ICdhc3Npc3RhbnQnLFxuICAgICAgICAgICAgICBzbGFzaF9jb21tYW5kOiAnc3lzdGVtJyxcbiAgICAgICAgICAgICAgd29ybGRfaW5mbzogJ3N5c3RlbScsXG4gICAgICAgICAgICAgIHJlYXNvbmluZzogJ3N5c3RlbScsXG4gICAgICAgICAgICB9IGFzIGNvbnN0XG4gICAgICAgICAgKVtzb3VyY2VdLFxuICAgICAgICAgIG1lc3NhZ2VfaWQ6IGRlcHRoICE9PSB1bmRlZmluZWQgPyBjaGF0Lmxlbmd0aCAtIGRlcHRoIC0gMSA6IHVuZGVmaW5lZCxcbiAgICAgICAgfSxcbiAgICAgICAgc3Vic3RyaW5nLFxuICAgICAgICAuLi5hcmdzLFxuICAgICAgKSxcbiAgICApO1xuICB9KTtcbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxudHlwZSBUYXZlcm5SZWdleCA9IHtcbiAgaWQ6IHN0cmluZztcbiAgc2NyaXB0X25hbWU6IHN0cmluZztcbiAgZW5hYmxlZDogYm9vbGVhbjtcbiAgcnVuX29uX2VkaXQ6IGJvb2xlYW47XG4gIHNjb3BlOiAnZ2xvYmFsJyB8ICdjaGFyYWN0ZXInO1xuXG4gIGZpbmRfcmVnZXg6IHN0cmluZztcbiAgcmVwbGFjZV9zdHJpbmc6IHN0cmluZztcblxuICBzb3VyY2U6IHtcbiAgICB1c2VyX2lucHV0OiBib29sZWFuO1xuICAgIGFpX291dHB1dDogYm9vbGVhbjtcbiAgICBzbGFzaF9jb21tYW5kOiBib29sZWFuO1xuICAgIHdvcmxkX2luZm86IGJvb2xlYW47XG4gIH07XG5cbiAgZGVzdGluYXRpb246IHtcbiAgICBkaXNwbGF5OiBib29sZWFuO1xuICAgIHByb21wdDogYm9vbGVhbjtcbiAgfTtcblxuICBtaW5fZGVwdGg6IG51bWJlciB8IG51bGw7XG4gIG1heF9kZXB0aDogbnVtYmVyIHwgbnVsbDtcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0NoYXJhY3RlclRhdmVyblJlZ2V4RW5hYmxlZCgpOiBib29sZWFuIHtcbiAgLy8gQHRzLWlnbm9yZSAyMzQ1XG4gIHJldHVybiBleHRlbnNpb25fc2V0dGluZ3M/LmNoYXJhY3Rlcl9hbGxvd2VkX3JlZ2V4Py5pbmNsdWRlcyhjaGFyYWN0ZXJzPy5bdGhpc19jaGlkXT8uYXZhdGFyKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEdsb2JhbFJlZ2V4ZXMoKTogUmVnZXhTY3JpcHREYXRhW10ge1xuICByZXR1cm4gZXh0ZW5zaW9uX3NldHRpbmdzLnJlZ2V4ID8/IFtdO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q2hhcmFjdGVyUmVnZXhlcygpOiBSZWdleFNjcmlwdERhdGFbXSB7XG4gIC8vIEB0cy1pZ25vcmVcbiAgcmV0dXJuIGNoYXJhY3RlcnNbdGhpc19jaGlkXT8uZGF0YT8uZXh0ZW5zaW9ucz8ucmVnZXhfc2NyaXB0cyA/PyBbXTtcbn1cblxuZnVuY3Rpb24gdG9UYXZlcm5SZWdleChyZWdleF9zY3JpcHRfZGF0YTogUmVnZXhTY3JpcHREYXRhLCBzY29wZTogJ2dsb2JhbCcgfCAnY2hhcmFjdGVyJyk6IFRhdmVyblJlZ2V4IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogcmVnZXhfc2NyaXB0X2RhdGEuaWQsXG4gICAgc2NyaXB0X25hbWU6IHJlZ2V4X3NjcmlwdF9kYXRhLnNjcmlwdE5hbWUsXG4gICAgZW5hYmxlZDogIXJlZ2V4X3NjcmlwdF9kYXRhLmRpc2FibGVkLFxuICAgIHJ1bl9vbl9lZGl0OiByZWdleF9zY3JpcHRfZGF0YS5ydW5PbkVkaXQsXG4gICAgc2NvcGU6IHNjb3BlLFxuXG4gICAgZmluZF9yZWdleDogcmVnZXhfc2NyaXB0X2RhdGEuZmluZFJlZ2V4LFxuICAgIHJlcGxhY2Vfc3RyaW5nOiByZWdleF9zY3JpcHRfZGF0YS5yZXBsYWNlU3RyaW5nLFxuXG4gICAgc291cmNlOiB7XG4gICAgICB1c2VyX2lucHV0OiByZWdleF9zY3JpcHRfZGF0YS5wbGFjZW1lbnQuaW5jbHVkZXMocmVnZXhfcGxhY2VtZW50LlVTRVJfSU5QVVQpLFxuICAgICAgYWlfb3V0cHV0OiByZWdleF9zY3JpcHRfZGF0YS5wbGFjZW1lbnQuaW5jbHVkZXMocmVnZXhfcGxhY2VtZW50LkFJX09VVFBVVCksXG4gICAgICBzbGFzaF9jb21tYW5kOiByZWdleF9zY3JpcHRfZGF0YS5wbGFjZW1lbnQuaW5jbHVkZXMocmVnZXhfcGxhY2VtZW50LlNMQVNIX0NPTU1BTkQpLFxuICAgICAgd29ybGRfaW5mbzogcmVnZXhfc2NyaXB0X2RhdGEucGxhY2VtZW50LmluY2x1ZGVzKHJlZ2V4X3BsYWNlbWVudC5XT1JMRF9JTkZPKSxcbiAgICB9LFxuXG4gICAgZGVzdGluYXRpb246IHtcbiAgICAgIGRpc3BsYXk6IHJlZ2V4X3NjcmlwdF9kYXRhLm1hcmtkb3duT25seSxcbiAgICAgIHByb21wdDogcmVnZXhfc2NyaXB0X2RhdGEucHJvbXB0T25seSxcbiAgICB9LFxuXG4gICAgbWluX2RlcHRoOiB0eXBlb2YgcmVnZXhfc2NyaXB0X2RhdGEubWluRGVwdGggPT09ICdudW1iZXInID8gcmVnZXhfc2NyaXB0X2RhdGEubWluRGVwdGggOiBudWxsLFxuICAgIG1heF9kZXB0aDogdHlwZW9mIHJlZ2V4X3NjcmlwdF9kYXRhLm1heERlcHRoID09PSAnbnVtYmVyJyA/IHJlZ2V4X3NjcmlwdF9kYXRhLm1heERlcHRoIDogbnVsbCxcbiAgfTtcbn1cblxuZnVuY3Rpb24gZnJvbVRhdmVyblJlZ2V4KHRhdmVybl9yZWdleDogVGF2ZXJuUmVnZXgpOiBSZWdleFNjcmlwdERhdGEge1xuICByZXR1cm4ge1xuICAgIGlkOiB0YXZlcm5fcmVnZXguaWQsXG4gICAgc2NyaXB0TmFtZTogdGF2ZXJuX3JlZ2V4LnNjcmlwdF9uYW1lLFxuICAgIGRpc2FibGVkOiAhdGF2ZXJuX3JlZ2V4LmVuYWJsZWQsXG4gICAgcnVuT25FZGl0OiB0YXZlcm5fcmVnZXgucnVuX29uX2VkaXQsXG5cbiAgICBmaW5kUmVnZXg6IHRhdmVybl9yZWdleC5maW5kX3JlZ2V4LFxuICAgIHJlcGxhY2VTdHJpbmc6IHRhdmVybl9yZWdleC5yZXBsYWNlX3N0cmluZyxcbiAgICB0cmltU3RyaW5nczogW10sIC8vIFRPRE86IGhhbmRsZSB0aGlzP1xuXG4gICAgcGxhY2VtZW50OiBbXG4gICAgICAuLi4odGF2ZXJuX3JlZ2V4LnNvdXJjZS51c2VyX2lucHV0ID8gW3JlZ2V4X3BsYWNlbWVudC5VU0VSX0lOUFVUXSA6IFtdKSxcbiAgICAgIC4uLih0YXZlcm5fcmVnZXguc291cmNlLmFpX291dHB1dCA/IFtyZWdleF9wbGFjZW1lbnQuQUlfT1VUUFVUXSA6IFtdKSxcbiAgICAgIC4uLih0YXZlcm5fcmVnZXguc291cmNlLnNsYXNoX2NvbW1hbmQgPyBbcmVnZXhfcGxhY2VtZW50LlNMQVNIX0NPTU1BTkRdIDogW10pLFxuICAgICAgLi4uKHRhdmVybl9yZWdleC5zb3VyY2Uud29ybGRfaW5mbyA/IFtyZWdleF9wbGFjZW1lbnQuV09STERfSU5GT10gOiBbXSksXG4gICAgXSxcblxuICAgIHN1YnN0aXR1dGVSZWdleDogMCwgLy8gVE9ETzogaGFuZGxlIHRoaXM/XG5cbiAgICAvLyBAdHMtaWdub3JlXG4gICAgbWluRGVwdGg6IHRhdmVybl9yZWdleC5taW5fZGVwdGgsXG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIG1heERlcHRoOiB0YXZlcm5fcmVnZXgubWF4X2RlcHRoLFxuXG4gICAgbWFya2Rvd25Pbmx5OiB0YXZlcm5fcmVnZXguZGVzdGluYXRpb24uZGlzcGxheSxcbiAgICBwcm9tcHRPbmx5OiB0YXZlcm5fcmVnZXguZGVzdGluYXRpb24ucHJvbXB0LFxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNDaGFyYWN0ZXJUYXZlcm5SZWdleGVzRW5hYmxlZCgpOiBib29sZWFuIHtcbiAgY29uc3QgcmVzdWx0ID0gaXNDaGFyYWN0ZXJUYXZlcm5SZWdleEVuYWJsZWQoKTtcblxuICBsb2cuaW5mbyhg5p+l6K+i5Yiw5bGA6YOo5q2j5YiZJHtyZXN1bHQgPyAn6KKr5ZCv55SoJyA6ICfooqvnpoHnlKgnfWApO1xuICByZXR1cm4gcmVzdWx0O1xufVxuXG50eXBlIEdldFRhdmVyblJlZ2V4ZXNPcHRpb24gPSB7XG4gIHNjb3BlPzogJ2FsbCcgfCAnZ2xvYmFsJyB8ICdjaGFyYWN0ZXInOyAvLyDmjInmiYDlnKjljLrln5/nrZvpgInmraPliJlcbiAgZW5hYmxlX3N0YXRlPzogJ2FsbCcgfCAnZW5hYmxlZCcgfCAnZGlzYWJsZWQnOyAvLyDmjInmmK/lkKbooqvlvIDlkK/nrZvpgInmraPliJlcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRUYXZlcm5SZWdleGVzKHsgc2NvcGUgPSAnYWxsJywgZW5hYmxlX3N0YXRlID0gJ2FsbCcgfTogR2V0VGF2ZXJuUmVnZXhlc09wdGlvbiA9IHt9KTogVGF2ZXJuUmVnZXhbXSB7XG4gIGlmICghWydhbGwnLCAnZW5hYmxlZCcsICdkaXNhYmxlZCddLmluY2x1ZGVzKGVuYWJsZV9zdGF0ZSkpIHtcbiAgICB0aHJvdyBFcnJvcihg5o+Q5L6b55qEIGVuYWJsZV9zdGF0ZSDml6DmlYgsIOivt+aPkOS+myAnYWxsJywgJ2VuYWJsZWQnIOaIliAnZGlzYWJsZWQnLCDkvaDmj5DkvpvnmoTmmK86ICR7ZW5hYmxlX3N0YXRlfWApO1xuICB9XG4gIGlmICghWydhbGwnLCAnZ2xvYmFsJywgJ2NoYXJhY3RlciddLmluY2x1ZGVzKHNjb3BlKSkge1xuICAgIHRocm93IEVycm9yKGDmj5DkvpvnmoQgc2NvcGUg5peg5pWILCDor7fmj5DkvpsgJ2FsbCcsICdnbG9iYWwnIOaIliAnY2hhcmFjdGVyJywg5L2g5o+Q5L6b55qE5pivOiAke3Njb3BlfWApO1xuICB9XG5cbiAgbGV0IHJlZ2V4ZXM6IFRhdmVyblJlZ2V4W10gPSBbXTtcbiAgaWYgKHNjb3BlID09PSAnYWxsJyB8fCBzY29wZSA9PT0gJ2dsb2JhbCcpIHtcbiAgICByZWdleGVzID0gWy4uLnJlZ2V4ZXMsIC4uLmdldEdsb2JhbFJlZ2V4ZXMoKS5tYXAocmVnZXggPT4gdG9UYXZlcm5SZWdleChyZWdleCwgJ2dsb2JhbCcpKV07XG4gIH1cbiAgaWYgKHNjb3BlID09PSAnYWxsJyB8fCBzY29wZSA9PT0gJ2NoYXJhY3RlcicpIHtcbiAgICByZWdleGVzID0gWy4uLnJlZ2V4ZXMsIC4uLmdldENoYXJhY3RlclJlZ2V4ZXMoKS5tYXAocmVnZXggPT4gdG9UYXZlcm5SZWdleChyZWdleCwgJ2NoYXJhY3RlcicpKV07XG4gIH1cbiAgaWYgKGVuYWJsZV9zdGF0ZSAhPT0gJ2FsbCcpIHtcbiAgICByZWdleGVzID0gcmVnZXhlcy5maWx0ZXIocmVnZXggPT4gcmVnZXguZW5hYmxlZCA9PT0gKGVuYWJsZV9zdGF0ZSA9PT0gJ2VuYWJsZWQnKSk7XG4gIH1cblxuICByZXR1cm4gc3RydWN0dXJlZENsb25lKHJlZ2V4ZXMpO1xufVxuXG50eXBlIFJlcGxhY2VUYXZlcm5SZWdleGVzT3B0aW9uID0ge1xuICBzY29wZT86ICdhbGwnIHwgJ2dsb2JhbCcgfCAnY2hhcmFjdGVyJzsgLy8g6KaB5pu/5o2i55qE6YWS6aaG5q2j5YiZ6YOo5YiGXG59O1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVwbGFjZVRhdmVyblJlZ2V4ZXMoXG4gIHJlZ2V4ZXM6IFRhdmVyblJlZ2V4W10sXG4gIHsgc2NvcGUgPSAnYWxsJyB9OiBSZXBsYWNlVGF2ZXJuUmVnZXhlc09wdGlvbixcbik6IFByb21pc2U8dm9pZD4ge1xuICBpZiAoIVsnYWxsJywgJ2dsb2JhbCcsICdjaGFyYWN0ZXInXS5pbmNsdWRlcyhzY29wZSkpIHtcbiAgICB0aHJvdyBFcnJvcihg5o+Q5L6b55qEIHNjb3BlIOaXoOaViCwg6K+35o+Q5L6bICdhbGwnLCAnZ2xvYmFsJyDmiJYgJ2NoYXJhY3RlcicsIOS9oOaPkOS+m+eahOaYrzogJHtzY29wZX1gKTtcbiAgfVxuXG4gIC8vIEZJWE1FOiBgdHJpbVN0cmluZ3NgIGFuZCBgc3Vic3RpdHV0ZVJlZ2V4YCBhcmUgbm90IGNvbnNpZGVyZWRcbiAgY29uc3QgZW1wdGllZF9yZWdleGVzID0gcmVnZXhlcy5maWx0ZXIocmVnZXggPT4gcmVnZXguc2NyaXB0X25hbWUgPT0gJycpO1xuICBpZiAoZW1wdGllZF9yZWdleGVzLmxlbmd0aCA+IDApIHtcbiAgICB0aHJvdyBFcnJvcihg5LiN6IO95bCG6YWS6aaG5q2j5YiZ55qE5ZCN56ew6K6+572u5Li656m65a2X56ym5LiyOlxcbiR7SlNPTi5zdHJpbmdpZnkoZW1wdGllZF9yZWdleGVzLm1hcChyZWdleCA9PiByZWdleC5pZCkpfWApO1xuICB9XG4gIGNvbnN0IFtnbG9iYWxfcmVnZXhlcywgY2hhcmFjdGVyX3JlZ2V4ZXNdID0gXy5wYXJ0aXRpb24ocmVnZXhlcywgcmVnZXggPT4gcmVnZXguc2NvcGUgPT09ICdnbG9iYWwnKS5tYXAocGFyaXRpb25lZCA9PlxuICAgIHBhcml0aW9uZWQubWFwKGZyb21UYXZlcm5SZWdleCksXG4gICk7XG5cbiAgLy8gQHRzLWlnbm9yZVxuICBjb25zdCBjaGFyYWN0ZXIgPSBjaGFyYWN0ZXJzW3RoaXNfY2hpZF07XG4gIGlmIChzY29wZSA9PT0gJ2FsbCcgfHwgc2NvcGUgPT09ICdnbG9iYWwnKSB7XG4gICAgZXh0ZW5zaW9uX3NldHRpbmdzLnJlZ2V4ID0gZ2xvYmFsX3JlZ2V4ZXM7XG4gIH1cbiAgaWYgKHNjb3BlID09PSAnYWxsJyB8fCBzY29wZSA9PT0gJ2NoYXJhY3RlcicpIHtcbiAgICBpZiAoY2hhcmFjdGVyKSB7XG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICBjaGFyYWN0ZXJzW3RoaXNfY2hpZF0uZGF0YS5leHRlbnNpb25zLnJlZ2V4X3NjcmlwdHMgPSBjaGFyYWN0ZXJfcmVnZXhlcztcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgIGF3YWl0IHdyaXRlRXh0ZW5zaW9uRmllbGQodGhpc19jaGlkLCAncmVnZXhfc2NyaXB0cycsIGNoYXJhY3Rlcl9yZWdleGVzKTtcbiAgICB9XG4gIH1cbiAgYXdhaXQgc2F2ZVNldHRpbmdzKCk7XG4gIGlmIChjaGFyYWN0ZXIpIHtcbiAgICBhd2FpdCBzYXZlQ2hhdENvbmRpdGlvbmFsKCk7XG4gIH1cbiAgYXdhaXQgcmVsb2FkQ3VycmVudENoYXQoKTtcblxuICBsb2cuaW5mbyhg5pu/5o2i6YWS6aaG5q2j5YiZXFxcbiR7c2NvcGUgPT09ICdhbGwnIHx8IHNjb3BlID09PSAnZ2xvYmFsJyA/IGAsIOWFqOWxgOato+WImTpcXG4ke0pTT04uc3RyaW5naWZ5KGdsb2JhbF9yZWdleGVzKX1gIDogYGB9XFxcbiR7c2NvcGUgPT09ICdhbGwnIHx8IHNjb3BlID09PSAnY2hhcmFjdGVyJyA/IGAsIOWxgOmDqOato+WImTpcXG4ke0pTT04uc3RyaW5naWZ5KGNoYXJhY3Rlcl9yZWdleGVzKX1gIDogYGB9YCk7XG59XG5cbnR5cGUgVGF2ZXJuUmVnZXhVcGRhdGVyID1cbiAgfCAoKHJlZ2V4ZXM6IFRhdmVyblJlZ2V4W10pID0+IFRhdmVyblJlZ2V4W10pXG4gIHwgKChyZWdleGVzOiBUYXZlcm5SZWdleFtdKSA9PiBQcm9taXNlPFRhdmVyblJlZ2V4W10+KTtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVRhdmVyblJlZ2V4ZXNXaXRoKFxuICB1cGRhdGVyOiBUYXZlcm5SZWdleFVwZGF0ZXIsXG4gIHsgc2NvcGUgPSAnYWxsJyB9OiBSZXBsYWNlVGF2ZXJuUmVnZXhlc09wdGlvbiA9IHt9LFxuKTogUHJvbWlzZTxUYXZlcm5SZWdleFtdPiB7XG4gIGxldCByZWdleGVzID0gZ2V0VGF2ZXJuUmVnZXhlcyh7IHNjb3BlIH0pO1xuICByZWdleGVzID0gYXdhaXQgdXBkYXRlcihyZWdleGVzKTtcbiAgbG9nLmluZm8oYOWvuSR7eyBhbGw6ICflhajpg6gnLCBnbG9iYWw6ICflhajlsYAnLCBjaGFyYWN0ZXI6ICflsYDpg6gnIH1bc2NvcGVdfeWPmOmHj+ihqOi/m+ihjOabtOaWsGApO1xuICBhd2FpdCByZXBsYWNlVGF2ZXJuUmVnZXhlcyhyZWdleGVzLCB7IHNjb3BlIH0pO1xuICByZXR1cm4gcmVnZXhlcztcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/function/tavern_regex.ts\n\n}")},"./src/function/util.ts":
/*!******************************!*\
  !*** ./src/function/util.ts ***!
  \******************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   errorCatched: () => (/* binding */ errorCatched),\n/* harmony export */   getLastMessageId: () => (/* binding */ getLastMessageId),\n/* harmony export */   substitudeMacros: () => (/* binding */ substitudeMacros)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_1__);\n\n\nfunction substitudeMacros(text) {\n    const text_demacroed = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.substituteParamsExtended)(text);\n    loglevel__WEBPACK_IMPORTED_MODULE_1___default().info(`替换字符串中的宏, 字符串: '${text}', 结果: '${text_demacroed}'`);\n    return text_demacroed;\n}\nfunction getLastMessageId() {\n    return Number(substitudeMacros('{{lastMessageId}}'));\n}\nfunction errorCatched(fn) {\n    const onError = (error) => {\n        toastr.error(`${error.stack ? error.stack : error.name + ': ' + error.message}`);\n        throw error;\n    };\n    return (...args) => {\n        try {\n            const result = fn(...args);\n            if (result instanceof Promise) {\n                return result.catch(error => {\n                    onError(error);\n                });\n            }\n            return result;\n        }\n        catch (error) {\n            return onError(error);\n        }\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZnVuY3Rpb24vdXRpbC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBK0Q7QUFFcEM7QUFFcEIsU0FBUyxnQkFBZ0IsQ0FBQyxJQUFZO0lBQzNDLE1BQU0sY0FBYyxHQUFHLDZFQUF3QixDQUFDLElBQUksQ0FBQyxDQUFDO0lBRXRELG9EQUFRLENBQUMsbUJBQW1CLElBQUksV0FBVyxjQUFjLEdBQUcsQ0FBQyxDQUFDO0lBQzlELE9BQU8sY0FBYyxDQUFDO0FBQ3hCLENBQUM7QUFFTSxTQUFTLGdCQUFnQjtJQUM5QixPQUFPLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLENBQUM7QUFDdkQsQ0FBQztBQUVNLFNBQVMsWUFBWSxDQUFxQixFQUFxQjtJQUNwRSxNQUFNLE9BQU8sR0FBRyxDQUFDLEtBQVksRUFBRSxFQUFFO1FBQy9CLE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsSUFBSSxHQUFHLElBQUksR0FBRyxLQUFLLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQztRQUNqRixNQUFNLEtBQUssQ0FBQztJQUNkLENBQUMsQ0FBQztJQUNGLE9BQU8sQ0FBQyxHQUFHLElBQU8sRUFBSyxFQUFFO1FBQ3ZCLElBQUksQ0FBQztZQUNILE1BQU0sTUFBTSxHQUFHLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQyxDQUFDO1lBQzNCLElBQUksTUFBTSxZQUFZLE9BQU8sRUFBRSxDQUFDO2dCQUM5QixPQUFPLE1BQU0sQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLEVBQUU7b0JBQzFCLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQztnQkFDakIsQ0FBQyxDQUFNLENBQUM7WUFDVixDQUFDO1lBQ0QsT0FBTyxNQUFNLENBQUM7UUFDaEIsQ0FBQztRQUFDLE9BQU8sS0FBSyxFQUFFLENBQUM7WUFDZixPQUFPLE9BQU8sQ0FBQyxLQUFjLENBQUMsQ0FBQztRQUNqQyxDQUFDO0lBQ0gsQ0FBQyxDQUFDO0FBQ0osQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9mdW5jdGlvbi91dGlsLnRzPzUyMDYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc3Vic3RpdHV0ZVBhcmFtc0V4dGVuZGVkIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5cbmltcG9ydCBsb2cgZnJvbSAnbG9nbGV2ZWwnO1xuXG5leHBvcnQgZnVuY3Rpb24gc3Vic3RpdHVkZU1hY3Jvcyh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xuICBjb25zdCB0ZXh0X2RlbWFjcm9lZCA9IHN1YnN0aXR1dGVQYXJhbXNFeHRlbmRlZCh0ZXh0KTtcblxuICBsb2cuaW5mbyhg5pu/5o2i5a2X56ym5Liy5Lit55qE5a6PLCDlrZfnrKbkuLI6ICcke3RleHR9Jywg57uT5p6cOiAnJHt0ZXh0X2RlbWFjcm9lZH0nYCk7XG4gIHJldHVybiB0ZXh0X2RlbWFjcm9lZDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldExhc3RNZXNzYWdlSWQoKTogbnVtYmVyIHtcbiAgcmV0dXJuIE51bWJlcihzdWJzdGl0dWRlTWFjcm9zKCd7e2xhc3RNZXNzYWdlSWR9fScpKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGVycm9yQ2F0Y2hlZDxUIGV4dGVuZHMgYW55W10sIFU+KGZuOiAoLi4uYXJnczogVCkgPT4gVSk6ICguLi5hcmdzOiBUKSA9PiBVIHtcbiAgY29uc3Qgb25FcnJvciA9IChlcnJvcjogRXJyb3IpID0+IHtcbiAgICB0b2FzdHIuZXJyb3IoYCR7ZXJyb3Iuc3RhY2sgPyBlcnJvci5zdGFjayA6IGVycm9yLm5hbWUgKyAnOiAnICsgZXJyb3IubWVzc2FnZX1gKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfTtcbiAgcmV0dXJuICguLi5hcmdzOiBUKTogVSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGZuKC4uLmFyZ3MpO1xuICAgICAgaWYgKHJlc3VsdCBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgcmV0dXJuIHJlc3VsdC5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgICAgb25FcnJvcihlcnJvcik7XG4gICAgICAgIH0pIGFzIFU7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXR1cm4gb25FcnJvcihlcnJvciBhcyBFcnJvcik7XG4gICAgfVxuICB9O1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/function/util.ts\n\n}")},"./src/function/variables.ts":
/*!***********************************!*\
  !*** ./src/function/variables.ts ***!
  \***********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   deleteVariable: () => (/* binding */ deleteVariable),\n/* harmony export */   getVariables: () => (/* binding */ getVariables),\n/* harmony export */   insertOrAssignVariables: () => (/* binding */ insertOrAssignVariables),\n/* harmony export */   insertVariables: () => (/* binding */ insertVariables),\n/* harmony export */   replaceVariables: () => (/* binding */ replaceVariables),\n/* harmony export */   updateVariablesWith: () => (/* binding */ updateVariablesWith)\n/* harmony export */ });\n/* harmony import */ var _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/script_repository/script_controller */ \"./src/component/script_repository/script_controller.ts\");\n/* harmony import */ var _function_chat_message__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/function/chat_message */ \"./src/function/chat_message.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_4__);\n\n\n\n\n\nfunction getVariablesByType({ type = 'chat', message_id = 'latest', script_id }) {\n    switch (type) {\n        case 'message': {\n            if (message_id !== 'latest' && (message_id < -_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat.length || message_id >= _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat.length)) {\n                throw Error(`提供的 message_id(${message_id}) 超出了聊天消息楼层号范围`);\n            }\n            message_id = message_id === 'latest' ? -1 : message_id;\n            return (0,_function_chat_message__WEBPACK_IMPORTED_MODULE_1__.getChatMessages)(message_id)[0].data;\n        }\n        case 'chat': {\n            const metadata = _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata;\n            if (!metadata.variables) {\n                metadata.variables = {};\n            }\n            return metadata.variables;\n        }\n        case 'character': {\n            //@ts-ignore\n            return _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid]?.data?.extensions?.TavernHelper_characterScriptVariables || {};\n        }\n        case 'global':\n            return _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__.extension_settings.variables.global;\n        case 'script': {\n            if (!script_id) {\n                throw Error('获取脚本变量失败, 未指定 script_id');\n            }\n            const script_manager = _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_0__.ScriptManager.getInstance();\n            const script = script_manager.getScriptById(script_id);\n            if (!script) {\n                throw Error(`获取脚本变量失败, '${script_id}' 脚本不存在`);\n            }\n            return script_manager.getScriptVariables(script_id);\n        }\n    }\n}\nfunction getVariables({ type = 'chat', message_id = 'latest', script_id } = {}) {\n    const result = getVariablesByType({ type, message_id, script_id });\n    loglevel__WEBPACK_IMPORTED_MODULE_4___default().info(`获取${type === 'message'\n        ? `'${message_id}' 消息`\n        : type === 'chat'\n            ? '聊天'\n            : type === 'character'\n                ? '角色'\n                : type === 'script'\n                    ? `'${script_id}' 脚本`\n                    : '全局'}变量表:\\n${JSON.stringify(result)}`);\n    return structuredClone(result);\n}\nasync function replaceVariables(variables, { type = 'chat', message_id = 'latest', script_id } = {}) {\n    switch (type) {\n        case 'message':\n            if (message_id !== 'latest' && (message_id < -_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat.length || message_id >= _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat.length)) {\n                throw Error(`提供的 message_id(${message_id}) 超出了聊天消息楼层号范围`);\n            }\n            message_id = message_id === 'latest' ? _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat.length - 1 : message_id < 0 ? _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat.length + message_id : message_id;\n            await (0,_function_chat_message__WEBPACK_IMPORTED_MODULE_1__.setChatMessages)([{ message_id, data: variables }], { refresh: 'none' });\n            break;\n        case 'chat':\n            _.set(_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata, 'variables', variables);\n            await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.saveMetadata)();\n            break;\n        case 'character':\n            if (!_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid) {\n                throw new Error('保存变量失败，当前角色为空');\n            }\n            //@ts-ignore\n            await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__.writeExtensionField)(_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid, 'TavernHelper_characterScriptVariables', variables);\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.eventSource.emit('character_variables_changed', { variables });\n            break;\n        case 'global':\n            _.set(_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__.extension_settings.variables, 'global', variables);\n            await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.saveSettings)();\n            break;\n        case 'script':\n            if (!script_id) {\n                throw Error('保存变量失败, 未指定 script_id');\n            }\n            {\n                const script_manager = _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_0__.ScriptManager.getInstance();\n                const script = script_manager.getScriptById(script_id);\n                if (!script) {\n                    throw Error(`保存变量失败, '${script_id}' 脚本不存在`);\n                }\n                const script_type = script_manager['scriptData'].getScriptType(script);\n                await script_manager.updateScriptVariables(script_id, variables, script_type);\n            }\n            break;\n    }\n    loglevel__WEBPACK_IMPORTED_MODULE_4___default().info(`将${type === 'message'\n        ? `'${message_id}' 消息`\n        : type === 'chat'\n            ? '聊天'\n            : type === 'character'\n                ? '角色'\n                : type === 'script'\n                    ? `'${script_id}' 脚本`\n                    : '全局'}变量表替换为:\\n${JSON.stringify(variables)}`);\n}\nasync function updateVariablesWith(updater, { type = 'chat', message_id = 'latest', script_id } = {}) {\n    let variables = getVariables({ type, message_id, script_id });\n    variables = await updater(variables);\n    loglevel__WEBPACK_IMPORTED_MODULE_4___default().info(`对${type === 'message'\n        ? `'${message_id}' 消息`\n        : type === 'chat'\n            ? '聊天'\n            : type === 'character'\n                ? '角色'\n                : type === 'script'\n                    ? `'${script_id}' 脚本`\n                    : '全局'}变量表进行更新`);\n    await replaceVariables(variables, { type, message_id, script_id });\n    return variables;\n}\nasync function insertOrAssignVariables(variables, { type = 'chat', message_id = 'latest', script_id } = {}) {\n    return await updateVariablesWith(old_variables => _.merge(old_variables, variables), { type, message_id, script_id });\n}\nasync function insertVariables(variables, { type = 'chat', message_id = 'latest', script_id } = {}) {\n    return await updateVariablesWith(old_variables => _.defaultsDeep(old_variables, variables), {\n        type,\n        message_id,\n        script_id,\n    });\n}\nasync function deleteVariable(variable_path, { type = 'chat', message_id = 'latest', script_id } = {}) {\n    let delete_occurred = false;\n    const variables = await updateVariablesWith(old_variables => {\n        delete_occurred = _.unset(old_variables, variable_path);\n        return old_variables;\n    }, { type, message_id, script_id });\n    return { variables, delete_occurred };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFBRSxFQUFFLElBQUksRUFBRSxVQUFVLEVBQUUsU0FBUyxFQUFFLENBQUMsQ0FBQztBQUN4SCxDQUFDO0FBRU0sS0FBSyxVQUFVLGVBQWUsQ0FDbkMsU0FBOEIsRUFDOUIsRUFBRSxJQUFJLEdBQUcsTUFBTSxFQUFFLFVBQVUsR0FBRyxRQUFRLEVBQUUsU0FBUyxLQUFxQixFQUFFO0lBRXhFLE9BQU8sTUFBTSxtQkFBbUIsQ0FBQyxhQUFhLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxZQUFZLENBQUMsYUFBYSxFQUFFLFNBQVMsQ0FBQyxFQUFFO1FBQzFGLElBQUk7UUFDSixVQUFVO1FBQ1YsU0FBUztLQUNWLENBQUMsQ0FBQztBQUNMLENBQUM7QUFFTSxLQUFLLFVBQVUsY0FBYyxDQUNsQyxhQUFxQixFQUNyQixFQUFFLElBQUksR0FBRyxNQUFNLEVBQUUsVUFBVSxHQUFHLFFBQVEsRUFBRSxTQUFTLEtBQXFCLEVBQUU7SUFFeEUsSUFBSSxlQUFlLEdBQVksS0FBSyxDQUFDO0lBQ3JDLE1BQU0sU0FBUyxHQUFHLE1BQU0sbUJBQW1CLENBQ3pDLGFBQWEsQ0FBQyxFQUFFO1FBQ2QsZUFBZSxHQUFHLENBQUMsQ0FBQyxLQUFLLENBQUMsYUFBYSxFQUFFLGFBQWEsQ0FBQyxDQUFDO1FBQ3hELE9BQU8sYUFBYSxDQUFDO0lBQ3ZCLENBQUMsRUFDRCxFQUFFLElBQUksRUFBRSxVQUFVLEVBQUUsU0FBUyxFQUFFLENBQ2hDLENBQUM7SUFDRixPQUFPLEVBQUUsU0FBUyxFQUFFLGVBQWUsRUFBRSxDQUFDO0FBQ3hDLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvZnVuY3Rpb24vdmFyaWFibGVzLnRzP2UzYjMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgU2NyaXB0TWFuYWdlciB9IGZyb20gJ0AvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3NjcmlwdF9jb250cm9sbGVyJztcbmltcG9ydCB7IGdldENoYXRNZXNzYWdlcywgc2V0Q2hhdE1lc3NhZ2VzIH0gZnJvbSAnQC9mdW5jdGlvbi9jaGF0X21lc3NhZ2UnO1xuXG5pbXBvcnQge1xuICBjaGFyYWN0ZXJzLFxuICBjaGF0LFxuICBjaGF0X21ldGFkYXRhLFxuICBldmVudFNvdXJjZSxcbiAgc2F2ZU1ldGFkYXRhLFxuICBzYXZlU2V0dGluZ3MsXG4gIHRoaXNfY2hpZCxcbn0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5pbXBvcnQgeyBleHRlbnNpb25fc2V0dGluZ3MsIHdyaXRlRXh0ZW5zaW9uRmllbGQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9leHRlbnNpb25zJztcblxuaW1wb3J0IGxvZyBmcm9tICdsb2dsZXZlbCc7XG5cbnR5cGUgVmFyaWFibGVPcHRpb24gPSB7XG4gIHR5cGU/OiAnbWVzc2FnZScgfCAnY2hhdCcgfCAnY2hhcmFjdGVyJyB8ICdzY3JpcHQnIHwgJ2dsb2JhbCc7XG4gIG1lc3NhZ2VfaWQ/OiBudW1iZXIgfCAnbGF0ZXN0JztcbiAgc2NyaXB0X2lkPzogc3RyaW5nO1xufTtcblxuZnVuY3Rpb24gZ2V0VmFyaWFibGVzQnlUeXBlKHsgdHlwZSA9ICdjaGF0JywgbWVzc2FnZV9pZCA9ICdsYXRlc3QnLCBzY3JpcHRfaWQgfTogVmFyaWFibGVPcHRpb24pOiBSZWNvcmQ8c3RyaW5nLCBhbnk+IHtcbiAgc3dpdGNoICh0eXBlKSB7XG4gICAgY2FzZSAnbWVzc2FnZSc6IHtcbiAgICAgIGlmIChtZXNzYWdlX2lkICE9PSAnbGF0ZXN0JyAmJiAobWVzc2FnZV9pZCA8IC1jaGF0Lmxlbmd0aCB8fCBtZXNzYWdlX2lkID49IGNoYXQubGVuZ3RoKSkge1xuICAgICAgICB0aHJvdyBFcnJvcihg5o+Q5L6b55qEIG1lc3NhZ2VfaWQoJHttZXNzYWdlX2lkfSkg6LaF5Ye65LqG6IGK5aSp5raI5oGv5qW85bGC5Y+36IyD5Zu0YCk7XG4gICAgICB9XG4gICAgICBtZXNzYWdlX2lkID0gbWVzc2FnZV9pZCA9PT0gJ2xhdGVzdCcgPyAtMSA6IG1lc3NhZ2VfaWQ7XG4gICAgICByZXR1cm4gZ2V0Q2hhdE1lc3NhZ2VzKG1lc3NhZ2VfaWQpWzBdLmRhdGE7XG4gICAgfVxuICAgIGNhc2UgJ2NoYXQnOiB7XG4gICAgICBjb25zdCBtZXRhZGF0YSA9IGNoYXRfbWV0YWRhdGEgYXMge1xuICAgICAgICB2YXJpYWJsZXM6IFJlY29yZDxzdHJpbmcsIGFueT4gfCB1bmRlZmluZWQ7XG4gICAgICB9O1xuICAgICAgaWYgKCFtZXRhZGF0YS52YXJpYWJsZXMpIHtcbiAgICAgICAgbWV0YWRhdGEudmFyaWFibGVzID0ge307XG4gICAgICB9XG4gICAgICByZXR1cm4gbWV0YWRhdGEudmFyaWFibGVzO1xuICAgIH1cbiAgICBjYXNlICdjaGFyYWN0ZXInOiB7XG4gICAgICAvL0B0cy1pZ25vcmVcbiAgICAgIHJldHVybiBjaGFyYWN0ZXJzW3RoaXNfY2hpZF0/LmRhdGE/LmV4dGVuc2lvbnM/LlRhdmVybkhlbHBlcl9jaGFyYWN0ZXJTY3JpcHRWYXJpYWJsZXMgfHwge307XG4gICAgfVxuICAgIGNhc2UgJ2dsb2JhbCc6XG4gICAgICByZXR1cm4gZXh0ZW5zaW9uX3NldHRpbmdzLnZhcmlhYmxlcy5nbG9iYWw7XG4gICAgY2FzZSAnc2NyaXB0Jzoge1xuICAgICAgaWYgKCFzY3JpcHRfaWQpIHtcbiAgICAgICAgdGhyb3cgRXJyb3IoJ+iOt+WPluiEmuacrOWPmOmHj+Wksei0pSwg5pyq5oyH5a6aIHNjcmlwdF9pZCcpO1xuICAgICAgfVxuICAgICAgY29uc3Qgc2NyaXB0X21hbmFnZXIgPSBTY3JpcHRNYW5hZ2VyLmdldEluc3RhbmNlKCk7XG4gICAgICBjb25zdCBzY3JpcHQgPSBzY3JpcHRfbWFuYWdlci5nZXRTY3JpcHRCeUlkKHNjcmlwdF9pZCk7XG4gICAgICBpZiAoIXNjcmlwdCkge1xuICAgICAgICB0aHJvdyBFcnJvcihg6I635Y+W6ISa5pys5Y+Y6YeP5aSx6LSlLCAnJHtzY3JpcHRfaWR9JyDohJrmnKzkuI3lrZjlnKhgKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBzY3JpcHRfbWFuYWdlci5nZXRTY3JpcHRWYXJpYWJsZXMoc2NyaXB0X2lkKTtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFZhcmlhYmxlcyh7IHR5cGUgPSAnY2hhdCcsIG1lc3NhZ2VfaWQgPSAnbGF0ZXN0Jywgc2NyaXB0X2lkIH06IFZhcmlhYmxlT3B0aW9uID0ge30pOiBSZWNvcmQ8XG4gIHN0cmluZyxcbiAgYW55XG4+IHtcbiAgY29uc3QgcmVzdWx0ID0gZ2V0VmFyaWFibGVzQnlUeXBlKHsgdHlwZSwgbWVzc2FnZV9pZCwgc2NyaXB0X2lkIH0pO1xuXG4gIGxvZy5pbmZvKFxuICAgIGDojrflj5Yke1xuICAgICAgdHlwZSA9PT0gJ21lc3NhZ2UnXG4gICAgICAgID8gYCcke21lc3NhZ2VfaWR9JyDmtojmga9gXG4gICAgICAgIDogdHlwZSA9PT0gJ2NoYXQnXG4gICAgICAgID8gJ+iBiuWkqSdcbiAgICAgICAgOiB0eXBlID09PSAnY2hhcmFjdGVyJ1xuICAgICAgICA/ICfop5LoibInXG4gICAgICAgIDogdHlwZSA9PT0gJ3NjcmlwdCdcbiAgICAgICAgPyBgJyR7c2NyaXB0X2lkfScg6ISa5pysYFxuICAgICAgICA6ICflhajlsYAnXG4gICAgfeWPmOmHj+ihqDpcXG4ke0pTT04uc3RyaW5naWZ5KHJlc3VsdCl9YCxcbiAgKTtcbiAgcmV0dXJuIHN0cnVjdHVyZWRDbG9uZShyZXN1bHQpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVwbGFjZVZhcmlhYmxlcyhcbiAgdmFyaWFibGVzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+LFxuICB7IHR5cGUgPSAnY2hhdCcsIG1lc3NhZ2VfaWQgPSAnbGF0ZXN0Jywgc2NyaXB0X2lkIH06IFZhcmlhYmxlT3B0aW9uID0ge30sXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgc3dpdGNoICh0eXBlKSB7XG4gICAgY2FzZSAnbWVzc2FnZSc6XG4gICAgICBpZiAobWVzc2FnZV9pZCAhPT0gJ2xhdGVzdCcgJiYgKG1lc3NhZ2VfaWQgPCAtY2hhdC5sZW5ndGggfHwgbWVzc2FnZV9pZCA+PSBjaGF0Lmxlbmd0aCkpIHtcbiAgICAgICAgdGhyb3cgRXJyb3IoYOaPkOS+m+eahCBtZXNzYWdlX2lkKCR7bWVzc2FnZV9pZH0pIOi2heWHuuS6huiBiuWkqea2iOaBr+alvOWxguWPt+iMg+WbtGApO1xuICAgICAgfVxuICAgICAgbWVzc2FnZV9pZCA9IG1lc3NhZ2VfaWQgPT09ICdsYXRlc3QnID8gY2hhdC5sZW5ndGggLSAxIDogbWVzc2FnZV9pZCA8IDAgPyBjaGF0Lmxlbmd0aCArIG1lc3NhZ2VfaWQgOiBtZXNzYWdlX2lkO1xuICAgICAgYXdhaXQgc2V0Q2hhdE1lc3NhZ2VzKFt7IG1lc3NhZ2VfaWQsIGRhdGE6IHZhcmlhYmxlcyB9XSwgeyByZWZyZXNoOiAnbm9uZScgfSk7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdjaGF0JzpcbiAgICAgIF8uc2V0KGNoYXRfbWV0YWRhdGEsICd2YXJpYWJsZXMnLCB2YXJpYWJsZXMpO1xuICAgICAgYXdhaXQgc2F2ZU1ldGFkYXRhKCk7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdjaGFyYWN0ZXInOlxuICAgICAgaWYgKCF0aGlzX2NoaWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCfkv53lrZjlj5jph4/lpLHotKXvvIzlvZPliY3op5LoibLkuLrnqbonKTtcbiAgICAgIH1cbiAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgYXdhaXQgd3JpdGVFeHRlbnNpb25GaWVsZCh0aGlzX2NoaWQsICdUYXZlcm5IZWxwZXJfY2hhcmFjdGVyU2NyaXB0VmFyaWFibGVzJywgdmFyaWFibGVzKTtcbiAgICAgIGV2ZW50U291cmNlLmVtaXQoJ2NoYXJhY3Rlcl92YXJpYWJsZXNfY2hhbmdlZCcsIHsgdmFyaWFibGVzIH0pO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAnZ2xvYmFsJzpcbiAgICAgIF8uc2V0KGV4dGVuc2lvbl9zZXR0aW5ncy52YXJpYWJsZXMsICdnbG9iYWwnLCB2YXJpYWJsZXMpO1xuICAgICAgYXdhaXQgc2F2ZVNldHRpbmdzKCk7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdzY3JpcHQnOlxuICAgICAgaWYgKCFzY3JpcHRfaWQpIHtcbiAgICAgICAgdGhyb3cgRXJyb3IoJ+S/neWtmOWPmOmHj+Wksei0pSwg5pyq5oyH5a6aIHNjcmlwdF9pZCcpO1xuICAgICAgfVxuICAgICAge1xuICAgICAgICBjb25zdCBzY3JpcHRfbWFuYWdlciA9IFNjcmlwdE1hbmFnZXIuZ2V0SW5zdGFuY2UoKTtcbiAgICAgICAgY29uc3Qgc2NyaXB0ID0gc2NyaXB0X21hbmFnZXIuZ2V0U2NyaXB0QnlJZChzY3JpcHRfaWQpO1xuICAgICAgICBpZiAoIXNjcmlwdCkge1xuICAgICAgICAgIHRocm93IEVycm9yKGDkv53lrZjlj5jph4/lpLHotKUsICcke3NjcmlwdF9pZH0nIOiEmuacrOS4jeWtmOWcqGApO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHNjcmlwdF90eXBlID0gc2NyaXB0X21hbmFnZXJbJ3NjcmlwdERhdGEnXS5nZXRTY3JpcHRUeXBlKHNjcmlwdCk7XG4gICAgICAgIGF3YWl0IHNjcmlwdF9tYW5hZ2VyLnVwZGF0ZVNjcmlwdFZhcmlhYmxlcyhzY3JpcHRfaWQsIHZhcmlhYmxlcywgc2NyaXB0X3R5cGUpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gIH1cblxuICBsb2cuaW5mbyhcbiAgICBg5bCGJHtcbiAgICAgIHR5cGUgPT09ICdtZXNzYWdlJ1xuICAgICAgICA/IGAnJHttZXNzYWdlX2lkfScg5raI5oGvYFxuICAgICAgICA6IHR5cGUgPT09ICdjaGF0J1xuICAgICAgICA/ICfogYrlpKknXG4gICAgICAgIDogdHlwZSA9PT0gJ2NoYXJhY3RlcidcbiAgICAgICAgPyAn6KeS6ImyJ1xuICAgICAgICA6IHR5cGUgPT09ICdzY3JpcHQnXG4gICAgICAgID8gYCcke3NjcmlwdF9pZH0nIOiEmuacrGBcbiAgICAgICAgOiAn5YWo5bGAJ1xuICAgIH3lj5jph4/ooajmm7/mjaLkuLo6XFxuJHtKU09OLnN0cmluZ2lmeSh2YXJpYWJsZXMpfWAsXG4gICk7XG59XG5cbnR5cGUgVmFyaWFibGVzVXBkYXRlciA9XG4gIHwgKCh2YXJpYWJsZXM6IFJlY29yZDxzdHJpbmcsIGFueT4pID0+IFJlY29yZDxzdHJpbmcsIGFueT4pXG4gIHwgKCh2YXJpYWJsZXM6IFJlY29yZDxzdHJpbmcsIGFueT4pID0+IFByb21pc2U8UmVjb3JkPHN0cmluZywgYW55Pj4pO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlVmFyaWFibGVzV2l0aChcbiAgdXBkYXRlcjogVmFyaWFibGVzVXBkYXRlcixcbiAgeyB0eXBlID0gJ2NoYXQnLCBtZXNzYWdlX2lkID0gJ2xhdGVzdCcsIHNjcmlwdF9pZCB9OiBWYXJpYWJsZU9wdGlvbiA9IHt9LFxuKTogUHJvbWlzZTxSZWNvcmQ8c3RyaW5nLCBhbnk+PiB7XG4gIGxldCB2YXJpYWJsZXMgPSBnZXRWYXJpYWJsZXMoeyB0eXBlLCBtZXNzYWdlX2lkLCBzY3JpcHRfaWQgfSk7XG4gIHZhcmlhYmxlcyA9IGF3YWl0IHVwZGF0ZXIodmFyaWFibGVzKTtcbiAgbG9nLmluZm8oXG4gICAgYOWvuSR7XG4gICAgICB0eXBlID09PSAnbWVzc2FnZSdcbiAgICAgICAgPyBgJyR7bWVzc2FnZV9pZH0nIOa2iOaBr2BcbiAgICAgICAgOiB0eXBlID09PSAnY2hhdCdcbiAgICAgICAgPyAn6IGK5aSpJ1xuICAgICAgICA6IHR5cGUgPT09ICdjaGFyYWN0ZXInXG4gICAgICAgID8gJ+inkuiJsidcbiAgICAgICAgOiB0eXBlID09PSAnc2NyaXB0J1xuICAgICAgICA/IGAnJHtzY3JpcHRfaWR9JyDohJrmnKxgXG4gICAgICAgIDogJ+WFqOWxgCdcbiAgICB95Y+Y6YeP6KGo6L+b6KGM5pu05pawYCxcbiAgKTtcbiAgYXdhaXQgcmVwbGFjZVZhcmlhYmxlcyh2YXJpYWJsZXMsIHsgdHlwZSwgbWVzc2FnZV9pZCwgc2NyaXB0X2lkIH0pO1xuICByZXR1cm4gdmFyaWFibGVzO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaW5zZXJ0T3JBc3NpZ25WYXJpYWJsZXMoXG4gIHZhcmlhYmxlczogUmVjb3JkPHN0cmluZywgYW55PixcbiAgeyB0eXBlID0gJ2NoYXQnLCBtZXNzYWdlX2lkID0gJ2xhdGVzdCcsIHNjcmlwdF9pZCB9OiBWYXJpYWJsZU9wdGlvbiA9IHt9LFxuKTogUHJvbWlzZTxSZWNvcmQ8c3RyaW5nLCBhbnk+PiB7XG4gIHJldHVybiBhd2FpdCB1cGRhdGVWYXJpYWJsZXNXaXRoKG9sZF92YXJpYWJsZXMgPT4gXy5tZXJnZShvbGRfdmFyaWFibGVzLCB2YXJpYWJsZXMpLCB7IHR5cGUsIG1lc3NhZ2VfaWQsIHNjcmlwdF9pZCB9KTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGluc2VydFZhcmlhYmxlcyhcbiAgdmFyaWFibGVzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+LFxuICB7IHR5cGUgPSAnY2hhdCcsIG1lc3NhZ2VfaWQgPSAnbGF0ZXN0Jywgc2NyaXB0X2lkIH06IFZhcmlhYmxlT3B0aW9uID0ge30sXG4pOiBQcm9taXNlPFJlY29yZDxzdHJpbmcsIGFueT4+IHtcbiAgcmV0dXJuIGF3YWl0IHVwZGF0ZVZhcmlhYmxlc1dpdGgob2xkX3ZhcmlhYmxlcyA9PiBfLmRlZmF1bHRzRGVlcChvbGRfdmFyaWFibGVzLCB2YXJpYWJsZXMpLCB7XG4gICAgdHlwZSxcbiAgICBtZXNzYWdlX2lkLFxuICAgIHNjcmlwdF9pZCxcbiAgfSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVWYXJpYWJsZShcbiAgdmFyaWFibGVfcGF0aDogc3RyaW5nLFxuICB7IHR5cGUgPSAnY2hhdCcsIG1lc3NhZ2VfaWQgPSAnbGF0ZXN0Jywgc2NyaXB0X2lkIH06IFZhcmlhYmxlT3B0aW9uID0ge30sXG4pOiBQcm9taXNlPHsgdmFyaWFibGVzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+OyBkZWxldGVfb2NjdXJyZWQ6IGJvb2xlYW4gfT4ge1xuICBsZXQgZGVsZXRlX29jY3VycmVkOiBib29sZWFuID0gZmFsc2U7XG4gIGNvbnN0IHZhcmlhYmxlcyA9IGF3YWl0IHVwZGF0ZVZhcmlhYmxlc1dpdGgoXG4gICAgb2xkX3ZhcmlhYmxlcyA9PiB7XG4gICAgICBkZWxldGVfb2NjdXJyZWQgPSBfLnVuc2V0KG9sZF92YXJpYWJsZXMsIHZhcmlhYmxlX3BhdGgpO1xuICAgICAgcmV0dXJuIG9sZF92YXJpYWJsZXM7XG4gICAgfSxcbiAgICB7IHR5cGUsIG1lc3NhZ2VfaWQsIHNjcmlwdF9pZCB9LFxuICApO1xuICByZXR1cm4geyB2YXJpYWJsZXMsIGRlbGV0ZV9vY2N1cnJlZCB9O1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/function/variables.ts\n\n}")},"./src/function/version.ts":
/*!*********************************!*\
  !*** ./src/function/version.ts ***!
  \*********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getTavernHelperVersion: () => (/* binding */ getTavernHelperVersion),\n/* harmony export */   updateTavernHelper: () => (/* binding */ updateTavernHelper)\n/* harmony export */ });\n/* harmony import */ var _util_check_update__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/util/check_update */ \"./src/util/check_update.ts\");\n\nasync function getTavernHelperVersion() {\n    const currentVersion = await (0,_util_check_update__WEBPACK_IMPORTED_MODULE_0__.getCurrentVersion)(_util_check_update__WEBPACK_IMPORTED_MODULE_0__.VERSION_FILE_PATH);\n    if (typeof currentVersion !== 'string') {\n        throw new Error('获取的版本号无效');\n    }\n    return currentVersion;\n}\nasync function updateTavernHelper() {\n    return (0,_util_check_update__WEBPACK_IMPORTED_MODULE_0__.updateTavernHelper)();\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZnVuY3Rpb24vdmVyc2lvbi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFJNkI7QUFFdEIsS0FBSyxVQUFVLHNCQUFzQjtJQUMxQyxNQUFNLGNBQWMsR0FBRyxNQUFNLHFFQUFpQixDQUFDLGlFQUFpQixDQUFDLENBQUM7SUFDbEUsSUFBSSxPQUFPLGNBQWMsS0FBSyxRQUFRLEVBQUUsQ0FBQztRQUN2QyxNQUFNLElBQUksS0FBSyxDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBQzlCLENBQUM7SUFDRCxPQUFPLGNBQWMsQ0FBQztBQUN4QixDQUFDO0FBRU0sS0FBSyxVQUFVLGtCQUFrQjtJQUN0QyxPQUFPLHNFQUFzQixFQUFFLENBQUM7QUFDbEMsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9mdW5jdGlvbi92ZXJzaW9uLnRzPzI5OWQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgZ2V0Q3VycmVudFZlcnNpb24sXG4gIHVwZGF0ZVRhdmVybkhlbHBlciBhcyB1cGRhdGVUYXZlcm5IZWxwZXJJbXBsLFxuICBWRVJTSU9OX0ZJTEVfUEFUSCxcbn0gZnJvbSAnQC91dGlsL2NoZWNrX3VwZGF0ZSc7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRUYXZlcm5IZWxwZXJWZXJzaW9uKCk6IFByb21pc2U8c3RyaW5nPiB7XG4gIGNvbnN0IGN1cnJlbnRWZXJzaW9uID0gYXdhaXQgZ2V0Q3VycmVudFZlcnNpb24oVkVSU0lPTl9GSUxFX1BBVEgpO1xuICBpZiAodHlwZW9mIGN1cnJlbnRWZXJzaW9uICE9PSAnc3RyaW5nJykge1xuICAgIHRocm93IG5ldyBFcnJvcign6I635Y+W55qE54mI5pys5Y+35peg5pWIJyk7XG4gIH1cbiAgcmV0dXJuIGN1cnJlbnRWZXJzaW9uO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlVGF2ZXJuSGVscGVyKCkge1xuICByZXR1cm4gdXBkYXRlVGF2ZXJuSGVscGVySW1wbCgpO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/function/version.ts\n\n}")},"./src/function/worldbook.ts":
/*!***********************************!*\
  !*** ./src/function/worldbook.ts ***!
  \***********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createOrReplaceWorldbook: () => (/* binding */ createOrReplaceWorldbook),\n/* harmony export */   createWorldbook: () => (/* binding */ createWorldbook),\n/* harmony export */   createWorldbookEntries: () => (/* binding */ createWorldbookEntries),\n/* harmony export */   deleteWorldbook: () => (/* binding */ deleteWorldbook),\n/* harmony export */   deleteWorldbookEntries: () => (/* binding */ deleteWorldbookEntries),\n/* harmony export */   getCharWorldbookNames: () => (/* binding */ getCharWorldbookNames),\n/* harmony export */   getChatWorldbookName: () => (/* binding */ getChatWorldbookName),\n/* harmony export */   getGlobalWorldbookNames: () => (/* binding */ getGlobalWorldbookNames),\n/* harmony export */   getOrCreateChatWorldbook: () => (/* binding */ getOrCreateChatWorldbook),\n/* harmony export */   getWorldbook: () => (/* binding */ getWorldbook),\n/* harmony export */   getWorldbookNames: () => (/* binding */ getWorldbookNames),\n/* harmony export */   rebindCharWorldbooks: () => (/* binding */ rebindCharWorldbooks),\n/* harmony export */   rebindChatWorldbook: () => (/* binding */ rebindChatWorldbook),\n/* harmony export */   rebindGlobalWorldbooks: () => (/* binding */ rebindGlobalWorldbooks),\n/* harmony export */   replaceWorldbook: () => (/* binding */ replaceWorldbook),\n/* harmony export */   updateWorldbookWith: () => (/* binding */ updateWorldbookWith)\n/* harmony export */ });\n/* harmony import */ var _compatibility__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/compatibility */ \"./src/compatibility.ts\");\n/* harmony import */ var _function_lorebook__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/function/lorebook */ \"./src/function/lorebook.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/scripts/world-info */ \"@sillytavern/scripts/world-info\");\n\n\n\n\nfunction getWorldbookNames() {\n    return structuredClone(_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.world_names);\n}\nfunction getGlobalWorldbookNames() {\n    return structuredClone((0,_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.getWorldInfoSettings)().world_info.globalSelect);\n}\nasync function rebindGlobalWorldbooks(worldbook_names) {\n    const $world_info = $('#world_info');\n    $world_info.find('option[value!=\"\"]').remove();\n    $world_info.append(_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.world_names.map((item, i) => {\n        const should_select = worldbook_names.includes(item);\n        return new Option(item, String(i), should_select, should_select);\n    }));\n    _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.selected_world_info.length = 0;\n    _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.selected_world_info.push(...worldbook_names);\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.saveSettingsDebounced)();\n}\nfunction getCharWorldbookNames(character_name) {\n    return (0,_function_lorebook__WEBPACK_IMPORTED_MODULE_1__.getCharLorebooks)(character_name === 'current' ? undefined : { name: character_name });\n}\nasync function rebindCharWorldbooks(character_name, char_worldbooks) {\n    if (character_name !== 'current') {\n        throw Error(`目前不支持对非当前角色卡调用 bindCharWorldbooks`);\n    }\n    // TODO: 重做 characters.ts, 然后直接访问后端来修改这里\n    return (0,_function_lorebook__WEBPACK_IMPORTED_MODULE_1__.setCurrentCharLorebooks)(char_worldbooks);\n}\nfunction getChatWorldbookName(chat_name) {\n    if (chat_name !== 'current') {\n        throw Error(`目前不支持对非当前聊天调用 getChatWorldbookName`);\n    }\n    return (0,_function_lorebook__WEBPACK_IMPORTED_MODULE_1__.getChatLorebook)();\n}\nasync function rebindChatWorldbook(chat_name, worldbook_name) {\n    if (chat_name !== 'current') {\n        throw Error(`目前不支持对非当前聊天调用 getChatWorldbookName`);\n    }\n    await (0,_function_lorebook__WEBPACK_IMPORTED_MODULE_1__.setChatLorebook)(worldbook_name);\n}\nasync function getOrCreateChatWorldbook(chat_name, worldbook_name) {\n    if (chat_name !== 'current') {\n        throw Error(`目前不支持对非当前聊天调用 getChatWorldbookName`);\n    }\n    return await (0,_function_lorebook__WEBPACK_IMPORTED_MODULE_1__.getOrCreateChatLorebook)(worldbook_name);\n}\nconst _default_implicit_keys = {\n    addMemo: true,\n    matchPersonaDescription: false,\n    matchCharacterDescription: false,\n    matchCharacterPersonality: false,\n    matchCharacterDepthPrompt: false,\n    matchScenario: false,\n    matchCreatorNotes: false,\n    group: '',\n    groupOverride: false,\n    groupWeight: 100,\n    caseSensitive: null,\n    matchWholeWords: null,\n    useGroupScoring: null,\n    automationId: '',\n};\nfunction toWorldbookEntry(entry) {\n    let result = _({})\n        .set('uid', entry.uid)\n        .set('name', entry.comment)\n        .set('enabled', !entry.disable)\n        .set('strategy.type', entry.constant ? 'constant' : entry.vectorized ? 'vectorized' : 'selective')\n        .set('strategy.keys', entry.key.map(value => (0,_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.parseRegexFromString)(value) ?? value))\n        .set('strategy.keys_secondary', {\n        logic: { 0: 'and_any', 1: 'not_all', 2: 'not_any', 3: 'and_all' }[entry.selectiveLogic],\n        keys: entry.keysecondary.map(value => (0,_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.parseRegexFromString)(value) ?? value),\n    })\n        .set('strategy.scan_depth', entry.scanDepth ?? 'same_as_global')\n        .set('position.type', {\n        0: 'before_character_definition',\n        1: 'after_character_definition',\n        5: 'before_example_messages',\n        6: 'after_example_messages',\n        2: 'before_author_note',\n        3: 'after_author_note',\n        4: 'at_depth',\n    }[entry.position])\n        .set('position.role', { 0: 'system', 1: 'user', 2: 'assistant' }[entry.role ?? 0])\n        .set('position.depth', entry.depth)\n        .set('position.order', entry.order)\n        .set('content', entry.content)\n        .set('probability', entry.useProbability ? entry.probability : 100)\n        .set('recursion.prevent_incoming', entry.excludeRecursion)\n        .set('recursion.prevent_outgoing', entry.preventRecursion)\n        .set('recursion.delay_until', typeof entry.delayUntilRecursion === 'number' ? entry.delayUntilRecursion : null)\n        .set('effect.sticky', typeof entry.sticky === 'number' ? entry.sticky : null)\n        .set('effect.cooldown', typeof entry.cooldown === 'number' ? entry.cooldown : null)\n        .set('effect.delay', typeof entry.delay === 'number' ? entry.delay : null);\n    if (entry.extra) {\n        result = result.set('extra', entry.extra);\n    }\n    result = result.merge(_.pick(entry, Object.keys(_default_implicit_keys)));\n    return result.value();\n}\nfunction fromWorldbookEntry(entry, display_index) {\n    let result = _({})\n        .set('uid', entry.uid)\n        .set('displayIndex', display_index)\n        .set('comment', entry.name ?? '')\n        .set('disable', !(entry.enabled ?? true))\n        .set('constant', entry?.strategy?.type ? entry?.strategy?.type === 'constant' : true)\n        .set('selective', entry?.strategy?.type === 'selective')\n        .set('key', entry?.strategy?.keys?.map(_.toString) ?? [])\n        .set('selectiveLogic', {\n        and_any: 0,\n        not_all: 1,\n        not_any: 2,\n        and_all: 3,\n    }[entry?.strategy?.keys_secondary?.logic ?? 'and_any'])\n        .set('keysecondary', entry?.strategy?.keys_secondary?.keys?.map(_.toString) ?? [])\n        .set('scanDepth', entry?.strategy?.scan_depth === 'same_as_global' ? null : (entry?.strategy?.scan_depth ?? null))\n        .set('vectorized', entry?.strategy?.type === 'vectorized')\n        .set('position', {\n        before_character_definition: 0,\n        after_character_definition: 1,\n        before_example_messages: 5,\n        after_example_messages: 6,\n        before_author_note: 2,\n        after_author_note: 3,\n        at_depth: 4,\n    }[entry?.position?.type ?? 'at_depth'])\n        .set('role', { system: 0, user: 1, assistant: 2 }[entry?.position?.role ?? 'system'])\n        .set('depth', entry?.position?.depth ?? 4)\n        .set('order', entry?.position?.order ?? 100)\n        .set('content', entry.content ?? '')\n        .set('useProbability', true)\n        .set('probability', entry.probability ?? 100)\n        .set('excludeRecursion', entry.recursion?.prevent_incoming ?? false)\n        .set('preventRecursion', entry.recursion?.prevent_outgoing ?? false)\n        .set('delayUntilRecursion', entry.recursion?.delay_until ?? false)\n        .set('sticky', entry.effect?.sticky ?? null)\n        .set('cooldown', entry.effect?.cooldown ?? null)\n        .set('delay', entry.effect?.delay ?? null);\n    if (entry.extra) {\n        result = result.set('extra', entry.extra);\n    }\n    result = result.merge(_default_implicit_keys).merge(_.pick(entry, Object.keys(_default_implicit_keys)));\n    return result.value();\n}\nfunction handleWorldbookEntriesCollision(entries) {\n    const MAX_UID = 1_000_000;\n    const uid_set = new Set();\n    const handle_uid_collision = (index) => {\n        if (index === undefined) {\n            index = _.random(0, MAX_UID - 1);\n        }\n        let i = 1;\n        while (true) {\n            if (!uid_set.has(index)) {\n                uid_set.add(index);\n                return index;\n            }\n            index = (index + i * i) % MAX_UID;\n            ++i;\n        }\n    };\n    return entries.map(entry => ({\n        ...entry,\n        uid: handle_uid_collision(entry.uid),\n    }));\n}\nasync function createWorldbook(worldbook_name, worldbook = []) {\n    if (getWorldbookNames().includes(worldbook_name)) {\n        return false;\n    }\n    return await createOrReplaceWorldbook(worldbook_name, worldbook);\n}\nasync function createOrReplaceWorldbook(worldbook_name, worldbook = [], { render = 'debounced' } = {}) {\n    const is_existing = getWorldbookNames().includes(worldbook_name);\n    if (!getWorldbookNames().includes(worldbook_name)) {\n        const success = await (0,_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.createNewWorldInfo)(worldbook_name, { interactive: false });\n        if (!success) {\n            return false;\n        }\n    }\n    if (is_existing || worldbook.length > 0) {\n        await (0,_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.saveWorldInfo)(worldbook_name, {\n            entries: _.merge({}, ..._(handleWorldbookEntriesCollision(worldbook))\n                .map(fromWorldbookEntry)\n                .map(entry => ({ [entry.uid]: entry }))\n                .value()),\n        });\n        if (render === 'debounced') {\n            (0,_compatibility__WEBPACK_IMPORTED_MODULE_0__.reloadEditorDebounced)(worldbook_name);\n        }\n        else {\n            (0,_compatibility__WEBPACK_IMPORTED_MODULE_0__.reloadEditor)(worldbook_name);\n        }\n    }\n    return !is_existing;\n}\nasync function deleteWorldbook(worldbook_name) {\n    return await (0,_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.deleteWorldInfo)(worldbook_name);\n}\n// TODO: rename 需要处理世界书绑定\n// export function renameWorldbook(old_name: string, new_name: string): boolean;\nasync function getWorldbook(worldbook_name) {\n    if (!getWorldbookNames().includes(worldbook_name)) {\n        throw Error(`未能找到世界书 '${worldbook_name}'`);\n    }\n    const original_worldbook_entries = await (0,_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.loadWorldInfo)(worldbook_name).then(data => data ?? {});\n    return structuredClone(_(original_worldbook_entries.entries).values().sortBy('displayIndex').map(toWorldbookEntry).value());\n}\nasync function replaceWorldbook(worldbook_name, worldbook, options) {\n    if (!getWorldbookNames().includes(worldbook_name)) {\n        throw Error(`未能找到世界书 '${worldbook_name}'`);\n    }\n    await createOrReplaceWorldbook(worldbook_name, worldbook, options);\n}\nasync function updateWorldbookWith(worldbook_name, updater, options) {\n    await replaceWorldbook(worldbook_name, await updater(await getWorldbook(worldbook_name)), options);\n    return await getWorldbook(worldbook_name);\n}\nasync function createWorldbookEntries(worldbook_name, new_entries, options) {\n    let slice_start;\n    const worldbook = await updateWorldbookWith(worldbook_name, data => {\n        slice_start = data.length;\n        return [...data, ...new_entries];\n    }, options);\n    return { worldbook, new_entries: worldbook.slice(slice_start) };\n}\nasync function deleteWorldbookEntries(worldbook_name, predicate, options) {\n    let deleted_entries = [];\n    const worldbook = await updateWorldbookWith(worldbook_name, data => {\n        deleted_entries = _.remove(data, predicate);\n        return data;\n    }, options);\n    return { worldbook, deleted_entries };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TCxlQUFlLEdBQUcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsU0FBUyxDQUFDLENBQUM7UUFDNUMsT0FBTyxJQUFJLENBQUM7SUFDZCxDQUFDLEVBQ0QsT0FBTyxDQUNSLENBQUM7SUFDRixPQUFPLEVBQUUsU0FBUyxFQUFFLGVBQWUsRUFBRSxDQUFDO0FBQ3hDLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvZnVuY3Rpb24vd29ybGRib29rLnRzPzgwNGUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcmVsb2FkRWRpdG9yLCByZWxvYWRFZGl0b3JEZWJvdW5jZWQgfSBmcm9tICdAL2NvbXBhdGliaWxpdHknO1xuaW1wb3J0IHtcbiAgZ2V0Q2hhckxvcmVib29rcyxcbiAgZ2V0Q2hhdExvcmVib29rLFxuICBnZXRPckNyZWF0ZUNoYXRMb3JlYm9vayxcbiAgc2V0Q2hhdExvcmVib29rLFxuICBzZXRDdXJyZW50Q2hhckxvcmVib29rcyxcbn0gZnJvbSAnQC9mdW5jdGlvbi9sb3JlYm9vayc7XG5cbmltcG9ydCB7IHNhdmVTZXR0aW5nc0RlYm91bmNlZCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHQnO1xuaW1wb3J0IHtcbiAgY3JlYXRlTmV3V29ybGRJbmZvLFxuICBkZWxldGVXb3JsZEluZm8sXG4gIGdldFdvcmxkSW5mb1NldHRpbmdzLFxuICBsb2FkV29ybGRJbmZvLFxuICBwYXJzZVJlZ2V4RnJvbVN0cmluZyxcbiAgc2F2ZVdvcmxkSW5mbyxcbiAgc2VsZWN0ZWRfd29ybGRfaW5mbyxcbiAgd29ybGRfbmFtZXMsXG59IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3dvcmxkLWluZm8nO1xuXG5pbXBvcnQgeyBMaXRlcmFsVW5pb24sIFBhcnRpYWxEZWVwIH0gZnJvbSAndHlwZS1mZXN0JztcblxuZXhwb3J0IGZ1bmN0aW9uIGdldFdvcmxkYm9va05hbWVzKCk6IHN0cmluZ1tdIHtcbiAgcmV0dXJuIHN0cnVjdHVyZWRDbG9uZSh3b3JsZF9uYW1lcyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRHbG9iYWxXb3JsZGJvb2tOYW1lcygpOiBzdHJpbmdbXSB7XG4gIHJldHVybiBzdHJ1Y3R1cmVkQ2xvbmUoKGdldFdvcmxkSW5mb1NldHRpbmdzKCkud29ybGRfaW5mbyBhcyB7IGdsb2JhbFNlbGVjdDogc3RyaW5nW10gfSkuZ2xvYmFsU2VsZWN0KTtcbn1cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZWJpbmRHbG9iYWxXb3JsZGJvb2tzKHdvcmxkYm9va19uYW1lczogc3RyaW5nW10pOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgJHdvcmxkX2luZm8gPSAkKCcjd29ybGRfaW5mbycpO1xuICAkd29ybGRfaW5mby5maW5kKCdvcHRpb25bdmFsdWUhPVwiXCJdJykucmVtb3ZlKCk7XG4gICR3b3JsZF9pbmZvLmFwcGVuZChcbiAgICB3b3JsZF9uYW1lcy5tYXAoKGl0ZW0sIGkpID0+IHtcbiAgICAgIGNvbnN0IHNob3VsZF9zZWxlY3QgPSB3b3JsZGJvb2tfbmFtZXMuaW5jbHVkZXMoaXRlbSk7XG4gICAgICByZXR1cm4gbmV3IE9wdGlvbihpdGVtLCBTdHJpbmcoaSksIHNob3VsZF9zZWxlY3QsIHNob3VsZF9zZWxlY3QpO1xuICAgIH0pLFxuICApO1xuXG4gIHNlbGVjdGVkX3dvcmxkX2luZm8ubGVuZ3RoID0gMDtcbiAgc2VsZWN0ZWRfd29ybGRfaW5mby5wdXNoKC4uLndvcmxkYm9va19uYW1lcyk7XG4gIHNhdmVTZXR0aW5nc0RlYm91bmNlZCgpO1xufVxuXG50eXBlIENoYXJXb3JsZGJvb2tzID0ge1xuICBwcmltYXJ5OiBzdHJpbmcgfCBudWxsO1xuICBhZGRpdGlvbmFsOiBzdHJpbmdbXTtcbn07XG5leHBvcnQgZnVuY3Rpb24gZ2V0Q2hhcldvcmxkYm9va05hbWVzKGNoYXJhY3Rlcl9uYW1lOiBMaXRlcmFsVW5pb248J2N1cnJlbnQnLCBzdHJpbmc+KTogQ2hhcldvcmxkYm9va3Mge1xuICByZXR1cm4gZ2V0Q2hhckxvcmVib29rcyhjaGFyYWN0ZXJfbmFtZSA9PT0gJ2N1cnJlbnQnID8gdW5kZWZpbmVkIDogeyBuYW1lOiBjaGFyYWN0ZXJfbmFtZSB9KTtcbn1cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZWJpbmRDaGFyV29ybGRib29rcyhjaGFyYWN0ZXJfbmFtZTogJ2N1cnJlbnQnLCBjaGFyX3dvcmxkYm9va3M6IENoYXJXb3JsZGJvb2tzKTogUHJvbWlzZTx2b2lkPiB7XG4gIGlmIChjaGFyYWN0ZXJfbmFtZSAhPT0gJ2N1cnJlbnQnKSB7XG4gICAgdGhyb3cgRXJyb3IoYOebruWJjeS4jeaUr+aMgeWvuemdnuW9k+WJjeinkuiJsuWNoeiwg+eUqCBiaW5kQ2hhcldvcmxkYm9va3NgKTtcbiAgfVxuICAvLyBUT0RPOiDph43lgZogY2hhcmFjdGVycy50cywg54S25ZCO55u05o6l6K6/6Zeu5ZCO56uv5p2l5L+u5pS56L+Z6YeMXG4gIHJldHVybiBzZXRDdXJyZW50Q2hhckxvcmVib29rcyhjaGFyX3dvcmxkYm9va3MpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q2hhdFdvcmxkYm9va05hbWUoY2hhdF9uYW1lOiAnY3VycmVudCcpOiBzdHJpbmcgfCBudWxsIHtcbiAgaWYgKGNoYXRfbmFtZSAhPT0gJ2N1cnJlbnQnKSB7XG4gICAgdGhyb3cgRXJyb3IoYOebruWJjeS4jeaUr+aMgeWvuemdnuW9k+WJjeiBiuWkqeiwg+eUqCBnZXRDaGF0V29ybGRib29rTmFtZWApO1xuICB9XG4gIHJldHVybiBnZXRDaGF0TG9yZWJvb2soKTtcbn1cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZWJpbmRDaGF0V29ybGRib29rKGNoYXRfbmFtZTogJ2N1cnJlbnQnLCB3b3JsZGJvb2tfbmFtZTogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gIGlmIChjaGF0X25hbWUgIT09ICdjdXJyZW50Jykge1xuICAgIHRocm93IEVycm9yKGDnm67liY3kuI3mlK/mjIHlr7npnZ7lvZPliY3ogYrlpKnosIPnlKggZ2V0Q2hhdFdvcmxkYm9va05hbWVgKTtcbiAgfVxuICBhd2FpdCBzZXRDaGF0TG9yZWJvb2sod29ybGRib29rX25hbWUpO1xufVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldE9yQ3JlYXRlQ2hhdFdvcmxkYm9vayhjaGF0X25hbWU6ICdjdXJyZW50Jywgd29ybGRib29rX25hbWU/OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICBpZiAoY2hhdF9uYW1lICE9PSAnY3VycmVudCcpIHtcbiAgICB0aHJvdyBFcnJvcihg55uu5YmN5LiN5pSv5oyB5a+56Z2e5b2T5YmN6IGK5aSp6LCD55SoIGdldENoYXRXb3JsZGJvb2tOYW1lYCk7XG4gIH1cbiAgcmV0dXJuIGF3YWl0IGdldE9yQ3JlYXRlQ2hhdExvcmVib29rKHdvcmxkYm9va19uYW1lKTtcbn1cblxudHlwZSBXb3JsZGJvb2tFbnRyeSA9IHtcbiAgdWlkOiBudW1iZXI7XG4gIG5hbWU6IHN0cmluZztcbiAgZW5hYmxlZDogYm9vbGVhbjtcblxuICBzdHJhdGVneToge1xuICAgIHR5cGU6ICdjb25zdGFudCcgfCAnc2VsZWN0aXZlJyB8ICd2ZWN0b3JpemVkJztcbiAgICBrZXlzOiAoc3RyaW5nIHwgUmVnRXhwKVtdO1xuICAgIGtleXNfc2Vjb25kYXJ5OiB7IGxvZ2ljOiAnYW5kX2FueScgfCAnYW5kX2FsbCcgfCAnbm90X2FsbCcgfCAnbm90X2FueSc7IGtleXM6IChzdHJpbmcgfCBSZWdFeHApW10gfTtcbiAgICBzY2FuX2RlcHRoOiAnc2FtZV9hc19nbG9iYWwnIHwgbnVtYmVyO1xuICB9O1xuICBwb3NpdGlvbjoge1xuICAgIHR5cGU6XG4gICAgICB8ICdiZWZvcmVfY2hhcmFjdGVyX2RlZmluaXRpb24nXG4gICAgICB8ICdhZnRlcl9jaGFyYWN0ZXJfZGVmaW5pdGlvbidcbiAgICAgIHwgJ2JlZm9yZV9leGFtcGxlX21lc3NhZ2VzJ1xuICAgICAgfCAnYWZ0ZXJfZXhhbXBsZV9tZXNzYWdlcydcbiAgICAgIHwgJ2JlZm9yZV9hdXRob3Jfbm90ZSdcbiAgICAgIHwgJ2FmdGVyX2F1dGhvcl9ub3RlJ1xuICAgICAgfCAnYXRfZGVwdGgnO1xuICAgIHJvbGU6ICdzeXN0ZW0nIHwgJ2Fzc2lzdGFudCcgfCAndXNlcic7XG4gICAgZGVwdGg6IG51bWJlcjtcbiAgICBvcmRlcjogbnVtYmVyO1xuICB9O1xuXG4gIGNvbnRlbnQ6IHN0cmluZztcblxuICBwcm9iYWJpbGl0eTogbnVtYmVyO1xuICByZWN1cnNpb246IHtcbiAgICBwcmV2ZW50X2luY29taW5nOiBib29sZWFuO1xuICAgIHByZXZlbnRfb3V0Z29pbmc6IGJvb2xlYW47XG4gICAgZGVsYXlfdW50aWw6IG51bGwgfCBudW1iZXI7XG4gIH07XG4gIGVmZmVjdDoge1xuICAgIHN0aWNreTogbnVsbCB8IG51bWJlcjtcbiAgICBjb29sZG93bjogbnVsbCB8IG51bWJlcjtcbiAgICBkZWxheTogbnVsbCB8IG51bWJlcjtcbiAgfTtcblxuICBleHRyYT86IFJlY29yZDxzdHJpbmcsIGFueT47XG59O1xuXG5jb25zdCBfZGVmYXVsdF9pbXBsaWNpdF9rZXlzOiBfSW1wbGljaXRLZXlzID0ge1xuICBhZGRNZW1vOiB0cnVlLFxuICBtYXRjaFBlcnNvbmFEZXNjcmlwdGlvbjogZmFsc2UsXG4gIG1hdGNoQ2hhcmFjdGVyRGVzY3JpcHRpb246IGZhbHNlLFxuICBtYXRjaENoYXJhY3RlclBlcnNvbmFsaXR5OiBmYWxzZSxcbiAgbWF0Y2hDaGFyYWN0ZXJEZXB0aFByb21wdDogZmFsc2UsXG4gIG1hdGNoU2NlbmFyaW86IGZhbHNlLFxuICBtYXRjaENyZWF0b3JOb3RlczogZmFsc2UsXG4gIGdyb3VwOiAnJyxcbiAgZ3JvdXBPdmVycmlkZTogZmFsc2UsXG4gIGdyb3VwV2VpZ2h0OiAxMDAsXG4gIGNhc2VTZW5zaXRpdmU6IG51bGwsXG4gIG1hdGNoV2hvbGVXb3JkczogbnVsbCxcbiAgdXNlR3JvdXBTY29yaW5nOiBudWxsLFxuICBhdXRvbWF0aW9uSWQ6ICcnLFxufSBhcyBjb25zdDtcbnR5cGUgX0ltcGxpY2l0S2V5cyA9IHtcbiAgYWRkTWVtbzogdHJ1ZTtcbiAgbWF0Y2hQZXJzb25hRGVzY3JpcHRpb246IGZhbHNlO1xuICBtYXRjaENoYXJhY3RlckRlc2NyaXB0aW9uOiBmYWxzZTtcbiAgbWF0Y2hDaGFyYWN0ZXJQZXJzb25hbGl0eTogZmFsc2U7XG4gIG1hdGNoQ2hhcmFjdGVyRGVwdGhQcm9tcHQ6IGZhbHNlO1xuICBtYXRjaFNjZW5hcmlvOiBmYWxzZTtcbiAgbWF0Y2hDcmVhdG9yTm90ZXM6IGZhbHNlO1xuICBncm91cDogJyc7XG4gIGdyb3VwT3ZlcnJpZGU6IGZhbHNlO1xuICBncm91cFdlaWdodDogMTAwO1xuICBjYXNlU2Vuc2l0aXZlOiBudWxsO1xuICBtYXRjaFdob2xlV29yZHM6IG51bGw7XG4gIHVzZUdyb3VwU2NvcmluZzogbnVsbDtcbiAgYXV0b21hdGlvbklkOiAnJztcbn07XG50eXBlIF9PcmlnaW5hbFdvcmxkYm9va0VudHJ5ID0ge1xuICB1aWQ6IG51bWJlcjtcbiAgZGlzcGxheUluZGV4OiBudW1iZXI7XG4gIGNvbW1lbnQ6IHN0cmluZztcbiAgZGlzYWJsZTogYm9vbGVhbjtcblxuICBjb25zdGFudDogYm9vbGVhbjtcbiAgc2VsZWN0aXZlOiBib29sZWFuO1xuICBrZXk6IHN0cmluZ1tdO1xuICBzZWxlY3RpdmVMb2dpYzogMCB8IDEgfCAyIHwgMzsgLy8gMDogYW5kX2FueSwgMTogbm90X2FsbCwgMjogbm90X2FueSwgMzogYW5kX2FsbFxuICBrZXlzZWNvbmRhcnk6IHN0cmluZ1tdO1xuICBzY2FuRGVwdGg6IG51bWJlciB8IG51bGw7XG4gIHZlY3Rvcml6ZWQ6IGJvb2xlYW47XG4gIHBvc2l0aW9uOiAwIHwgMSB8IDIgfCAzIHwgNCB8IDUgfCA2O1xuICByb2xlOiAwIHwgMSB8IDIgfCBudWxsOyAvLyAwOiBzeXN0ZW0sIDE6IHVzZXIsIDI6IGFzc2lzdGFudFxuICBkZXB0aDogbnVtYmVyO1xuICBvcmRlcjogbnVtYmVyO1xuXG4gIGNvbnRlbnQ6IHN0cmluZztcblxuICB1c2VQcm9iYWJpbGl0eTogYm9vbGVhbjtcbiAgcHJvYmFiaWxpdHk6IG51bWJlcjtcbiAgZXhjbHVkZVJlY3Vyc2lvbjogYm9vbGVhbjtcbiAgcHJldmVudFJlY3Vyc2lvbjogYm9vbGVhbjtcbiAgZGVsYXlVbnRpbFJlY3Vyc2lvbjogYm9vbGVhbiB8IG51bWJlcjtcbiAgc3RpY2t5OiBudW1iZXIgfCBudWxsO1xuICBjb29sZG93bjogbnVtYmVyIHwgbnVsbDtcbiAgZGVsYXk6IG51bWJlciB8IG51bGw7XG5cbiAgZXh0cmE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xufTtcbmZ1bmN0aW9uIHRvV29ybGRib29rRW50cnkoZW50cnk6IF9PcmlnaW5hbFdvcmxkYm9va0VudHJ5ICYgX0ltcGxpY2l0S2V5cyk6IFdvcmxkYm9va0VudHJ5ICYgUGFydGlhbDxfSW1wbGljaXRLZXlzPiB7XG4gIGxldCByZXN1bHQgPSBfKHt9KVxuICAgIC5zZXQoJ3VpZCcsIGVudHJ5LnVpZClcbiAgICAuc2V0KCduYW1lJywgZW50cnkuY29tbWVudClcbiAgICAuc2V0KCdlbmFibGVkJywgIWVudHJ5LmRpc2FibGUpXG5cbiAgICAuc2V0KCdzdHJhdGVneS50eXBlJywgZW50cnkuY29uc3RhbnQgPyAnY29uc3RhbnQnIDogZW50cnkudmVjdG9yaXplZCA/ICd2ZWN0b3JpemVkJyA6ICdzZWxlY3RpdmUnKVxuICAgIC5zZXQoXG4gICAgICAnc3RyYXRlZ3kua2V5cycsXG4gICAgICBlbnRyeS5rZXkubWFwKHZhbHVlID0+IHBhcnNlUmVnZXhGcm9tU3RyaW5nKHZhbHVlKSA/PyB2YWx1ZSksXG4gICAgKVxuICAgIC5zZXQoJ3N0cmF0ZWd5LmtleXNfc2Vjb25kYXJ5Jywge1xuICAgICAgbG9naWM6ICh7IDA6ICdhbmRfYW55JywgMTogJ25vdF9hbGwnLCAyOiAnbm90X2FueScsIDM6ICdhbmRfYWxsJyB9IGFzIGNvbnN0KVtlbnRyeS5zZWxlY3RpdmVMb2dpY10sXG4gICAgICBrZXlzOiBlbnRyeS5rZXlzZWNvbmRhcnkubWFwKHZhbHVlID0+IHBhcnNlUmVnZXhGcm9tU3RyaW5nKHZhbHVlKSA/PyB2YWx1ZSksXG4gICAgfSlcbiAgICAuc2V0KCdzdHJhdGVneS5zY2FuX2RlcHRoJywgZW50cnkuc2NhbkRlcHRoID8/ICdzYW1lX2FzX2dsb2JhbCcpXG5cbiAgICAuc2V0KFxuICAgICAgJ3Bvc2l0aW9uLnR5cGUnLFxuICAgICAge1xuICAgICAgICAwOiAnYmVmb3JlX2NoYXJhY3Rlcl9kZWZpbml0aW9uJyxcbiAgICAgICAgMTogJ2FmdGVyX2NoYXJhY3Rlcl9kZWZpbml0aW9uJyxcbiAgICAgICAgNTogJ2JlZm9yZV9leGFtcGxlX21lc3NhZ2VzJyxcbiAgICAgICAgNjogJ2FmdGVyX2V4YW1wbGVfbWVzc2FnZXMnLFxuICAgICAgICAyOiAnYmVmb3JlX2F1dGhvcl9ub3RlJyxcbiAgICAgICAgMzogJ2FmdGVyX2F1dGhvcl9ub3RlJyxcbiAgICAgICAgNDogJ2F0X2RlcHRoJyxcbiAgICAgIH1bZW50cnkucG9zaXRpb25dLFxuICAgIClcbiAgICAuc2V0KCdwb3NpdGlvbi5yb2xlJywgKHsgMDogJ3N5c3RlbScsIDE6ICd1c2VyJywgMjogJ2Fzc2lzdGFudCcgfSBhcyBjb25zdClbZW50cnkucm9sZSA/PyAwXSlcbiAgICAuc2V0KCdwb3NpdGlvbi5kZXB0aCcsIGVudHJ5LmRlcHRoKVxuICAgIC5zZXQoJ3Bvc2l0aW9uLm9yZGVyJywgZW50cnkub3JkZXIpXG5cbiAgICAuc2V0KCdjb250ZW50JywgZW50cnkuY29udGVudClcblxuICAgIC5zZXQoJ3Byb2JhYmlsaXR5JywgZW50cnkudXNlUHJvYmFiaWxpdHkgPyBlbnRyeS5wcm9iYWJpbGl0eSA6IDEwMClcblxuICAgIC5zZXQoJ3JlY3Vyc2lvbi5wcmV2ZW50X2luY29taW5nJywgZW50cnkuZXhjbHVkZVJlY3Vyc2lvbilcbiAgICAuc2V0KCdyZWN1cnNpb24ucHJldmVudF9vdXRnb2luZycsIGVudHJ5LnByZXZlbnRSZWN1cnNpb24pXG4gICAgLnNldCgncmVjdXJzaW9uLmRlbGF5X3VudGlsJywgdHlwZW9mIGVudHJ5LmRlbGF5VW50aWxSZWN1cnNpb24gPT09ICdudW1iZXInID8gZW50cnkuZGVsYXlVbnRpbFJlY3Vyc2lvbiA6IG51bGwpXG5cbiAgICAuc2V0KCdlZmZlY3Quc3RpY2t5JywgdHlwZW9mIGVudHJ5LnN0aWNreSA9PT0gJ251bWJlcicgPyBlbnRyeS5zdGlja3kgOiBudWxsKVxuICAgIC5zZXQoJ2VmZmVjdC5jb29sZG93bicsIHR5cGVvZiBlbnRyeS5jb29sZG93biA9PT0gJ251bWJlcicgPyBlbnRyeS5jb29sZG93biA6IG51bGwpXG4gICAgLnNldCgnZWZmZWN0LmRlbGF5JywgdHlwZW9mIGVudHJ5LmRlbGF5ID09PSAnbnVtYmVyJyA/IGVudHJ5LmRlbGF5IDogbnVsbCk7XG5cbiAgaWYgKGVudHJ5LmV4dHJhKSB7XG4gICAgcmVzdWx0ID0gcmVzdWx0LnNldCgnZXh0cmEnLCBlbnRyeS5leHRyYSk7XG4gIH1cblxuICByZXN1bHQgPSByZXN1bHQubWVyZ2UoXy5waWNrKGVudHJ5LCBPYmplY3Qua2V5cyhfZGVmYXVsdF9pbXBsaWNpdF9rZXlzKSkpO1xuXG4gIHJldHVybiByZXN1bHQudmFsdWUoKSBhcyBXb3JsZGJvb2tFbnRyeSAmIF9JbXBsaWNpdEtleXM7XG59XG5mdW5jdGlvbiBmcm9tV29ybGRib29rRW50cnkoXG4gIGVudHJ5OiBQaWNrPFdvcmxkYm9va0VudHJ5LCAndWlkJz4gJiBQYXJ0aWFsRGVlcDxXb3JsZGJvb2tFbnRyeSAmIF9JbXBsaWNpdEtleXM+LFxuICBkaXNwbGF5X2luZGV4OiBudW1iZXIsXG4pOiBfT3JpZ2luYWxXb3JsZGJvb2tFbnRyeSAmIF9JbXBsaWNpdEtleXMge1xuICBsZXQgcmVzdWx0ID0gXyh7fSlcbiAgICAuc2V0KCd1aWQnLCBlbnRyeS51aWQpXG4gICAgLnNldCgnZGlzcGxheUluZGV4JywgZGlzcGxheV9pbmRleClcbiAgICAuc2V0KCdjb21tZW50JywgZW50cnkubmFtZSA/PyAnJylcbiAgICAuc2V0KCdkaXNhYmxlJywgIShlbnRyeS5lbmFibGVkID8/IHRydWUpKVxuXG4gICAgLnNldCgnY29uc3RhbnQnLCBlbnRyeT8uc3RyYXRlZ3k/LnR5cGUgPyBlbnRyeT8uc3RyYXRlZ3k/LnR5cGUgPT09ICdjb25zdGFudCcgOiB0cnVlKVxuICAgIC5zZXQoJ3NlbGVjdGl2ZScsIGVudHJ5Py5zdHJhdGVneT8udHlwZSA9PT0gJ3NlbGVjdGl2ZScpXG4gICAgLnNldCgna2V5JywgZW50cnk/LnN0cmF0ZWd5Py5rZXlzPy5tYXAoXy50b1N0cmluZykgPz8gW10pXG4gICAgLnNldChcbiAgICAgICdzZWxlY3RpdmVMb2dpYycsXG4gICAgICAoXG4gICAgICAgIHtcbiAgICAgICAgICBhbmRfYW55OiAwLFxuICAgICAgICAgIG5vdF9hbGw6IDEsXG4gICAgICAgICAgbm90X2FueTogMixcbiAgICAgICAgICBhbmRfYWxsOiAzLFxuICAgICAgICB9IGFzIGNvbnN0XG4gICAgICApW2VudHJ5Py5zdHJhdGVneT8ua2V5c19zZWNvbmRhcnk/LmxvZ2ljID8/ICdhbmRfYW55J10sXG4gICAgKVxuICAgIC5zZXQoJ2tleXNlY29uZGFyeScsIGVudHJ5Py5zdHJhdGVneT8ua2V5c19zZWNvbmRhcnk/LmtleXM/Lm1hcChfLnRvU3RyaW5nKSA/PyBbXSlcbiAgICAuc2V0KCdzY2FuRGVwdGgnLCBlbnRyeT8uc3RyYXRlZ3k/LnNjYW5fZGVwdGggPT09ICdzYW1lX2FzX2dsb2JhbCcgPyBudWxsIDogKGVudHJ5Py5zdHJhdGVneT8uc2Nhbl9kZXB0aCA/PyBudWxsKSlcbiAgICAuc2V0KCd2ZWN0b3JpemVkJywgZW50cnk/LnN0cmF0ZWd5Py50eXBlID09PSAndmVjdG9yaXplZCcpXG4gICAgLnNldChcbiAgICAgICdwb3NpdGlvbicsXG4gICAgICB7XG4gICAgICAgIGJlZm9yZV9jaGFyYWN0ZXJfZGVmaW5pdGlvbjogMCxcbiAgICAgICAgYWZ0ZXJfY2hhcmFjdGVyX2RlZmluaXRpb246IDEsXG4gICAgICAgIGJlZm9yZV9leGFtcGxlX21lc3NhZ2VzOiA1LFxuICAgICAgICBhZnRlcl9leGFtcGxlX21lc3NhZ2VzOiA2LFxuICAgICAgICBiZWZvcmVfYXV0aG9yX25vdGU6IDIsXG4gICAgICAgIGFmdGVyX2F1dGhvcl9ub3RlOiAzLFxuICAgICAgICBhdF9kZXB0aDogNCxcbiAgICAgIH1bZW50cnk/LnBvc2l0aW9uPy50eXBlID8/ICdhdF9kZXB0aCddLFxuICAgIClcbiAgICAuc2V0KCdyb2xlJywgKHsgc3lzdGVtOiAwLCB1c2VyOiAxLCBhc3Npc3RhbnQ6IDIgfSBhcyBjb25zdClbZW50cnk/LnBvc2l0aW9uPy5yb2xlID8/ICdzeXN0ZW0nXSlcbiAgICAuc2V0KCdkZXB0aCcsIGVudHJ5Py5wb3NpdGlvbj8uZGVwdGggPz8gNClcbiAgICAuc2V0KCdvcmRlcicsIGVudHJ5Py5wb3NpdGlvbj8ub3JkZXIgPz8gMTAwKVxuXG4gICAgLnNldCgnY29udGVudCcsIGVudHJ5LmNvbnRlbnQgPz8gJycpXG5cbiAgICAuc2V0KCd1c2VQcm9iYWJpbGl0eScsIHRydWUpXG4gICAgLnNldCgncHJvYmFiaWxpdHknLCBlbnRyeS5wcm9iYWJpbGl0eSA/PyAxMDApXG4gICAgLnNldCgnZXhjbHVkZVJlY3Vyc2lvbicsIGVudHJ5LnJlY3Vyc2lvbj8ucHJldmVudF9pbmNvbWluZyA/PyBmYWxzZSlcbiAgICAuc2V0KCdwcmV2ZW50UmVjdXJzaW9uJywgZW50cnkucmVjdXJzaW9uPy5wcmV2ZW50X291dGdvaW5nID8/IGZhbHNlKVxuICAgIC5zZXQoJ2RlbGF5VW50aWxSZWN1cnNpb24nLCBlbnRyeS5yZWN1cnNpb24/LmRlbGF5X3VudGlsID8/IGZhbHNlKVxuICAgIC5zZXQoJ3N0aWNreScsIGVudHJ5LmVmZmVjdD8uc3RpY2t5ID8/IG51bGwpXG4gICAgLnNldCgnY29vbGRvd24nLCBlbnRyeS5lZmZlY3Q/LmNvb2xkb3duID8/IG51bGwpXG4gICAgLnNldCgnZGVsYXknLCBlbnRyeS5lZmZlY3Q/LmRlbGF5ID8/IG51bGwpO1xuXG4gIGlmIChlbnRyeS5leHRyYSkge1xuICAgIHJlc3VsdCA9IHJlc3VsdC5zZXQoJ2V4dHJhJywgZW50cnkuZXh0cmEpO1xuICB9XG5cbiAgcmVzdWx0ID0gcmVzdWx0Lm1lcmdlKF9kZWZhdWx0X2ltcGxpY2l0X2tleXMgYXMgT2JqZWN0KS5tZXJnZShfLnBpY2soZW50cnksIE9iamVjdC5rZXlzKF9kZWZhdWx0X2ltcGxpY2l0X2tleXMpKSk7XG5cbiAgcmV0dXJuIHJlc3VsdC52YWx1ZSgpIGFzIF9PcmlnaW5hbFdvcmxkYm9va0VudHJ5ICYgX0ltcGxpY2l0S2V5cztcbn1cblxuZnVuY3Rpb24gaGFuZGxlV29ybGRib29rRW50cmllc0NvbGxpc2lvbihcbiAgZW50cmllczogUGFydGlhbERlZXA8V29ybGRib29rRW50cnk+W10sXG4pOiBBcnJheTxQaWNrPFdvcmxkYm9va0VudHJ5LCAndWlkJz4gJiBQYXJ0aWFsRGVlcDxXb3JsZGJvb2tFbnRyeSAmIF9JbXBsaWNpdEtleXM+PiB7XG4gIGNvbnN0IE1BWF9VSUQgPSAxXzAwMF8wMDAgYXMgY29uc3Q7XG5cbiAgY29uc3QgdWlkX3NldCA9IG5ldyBTZXQ8bnVtYmVyPigpO1xuICBjb25zdCBoYW5kbGVfdWlkX2NvbGxpc2lvbiA9IChpbmRleDogbnVtYmVyIHwgdW5kZWZpbmVkKSA9PiB7XG4gICAgaWYgKGluZGV4ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGluZGV4ID0gXy5yYW5kb20oMCwgTUFYX1VJRCAtIDEpO1xuICAgIH1cblxuICAgIGxldCBpID0gMTtcbiAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgaWYgKCF1aWRfc2V0LmhhcyhpbmRleCkpIHtcbiAgICAgICAgdWlkX3NldC5hZGQoaW5kZXgpO1xuICAgICAgICByZXR1cm4gaW5kZXg7XG4gICAgICB9XG5cbiAgICAgIGluZGV4ID0gKGluZGV4ICsgaSAqIGkpICUgTUFYX1VJRDtcbiAgICAgICsraTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIGVudHJpZXMubWFwKGVudHJ5ID0+ICh7XG4gICAgLi4uZW50cnksXG4gICAgdWlkOiBoYW5kbGVfdWlkX2NvbGxpc2lvbihlbnRyeS51aWQpLFxuICB9KSk7XG59XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlV29ybGRib29rKHdvcmxkYm9va19uYW1lOiBzdHJpbmcsIHdvcmxkYm9vazogV29ybGRib29rRW50cnlbXSA9IFtdKTogUHJvbWlzZTxib29sZWFuPiB7XG4gIGlmIChnZXRXb3JsZGJvb2tOYW1lcygpLmluY2x1ZGVzKHdvcmxkYm9va19uYW1lKSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gYXdhaXQgY3JlYXRlT3JSZXBsYWNlV29ybGRib29rKHdvcmxkYm9va19uYW1lLCB3b3JsZGJvb2spO1xufVxuXG5pbnRlcmZhY2UgUmVwbGFjZVdvcmxkYm9va09wdGlvbnMge1xuICByZW5kZXI/OiAnZGVib3VuY2VkJyB8ICdpbW1lZGlhdGUnO1xufVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZU9yUmVwbGFjZVdvcmxkYm9vayhcbiAgd29ybGRib29rX25hbWU6IHN0cmluZyxcbiAgd29ybGRib29rOiBQYXJ0aWFsRGVlcDxXb3JsZGJvb2tFbnRyeT5bXSA9IFtdLFxuICB7IHJlbmRlciA9ICdkZWJvdW5jZWQnIH06IFJlcGxhY2VXb3JsZGJvb2tPcHRpb25zID0ge30sXG4pOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgY29uc3QgaXNfZXhpc3RpbmcgPSBnZXRXb3JsZGJvb2tOYW1lcygpLmluY2x1ZGVzKHdvcmxkYm9va19uYW1lKTtcbiAgaWYgKCFnZXRXb3JsZGJvb2tOYW1lcygpLmluY2x1ZGVzKHdvcmxkYm9va19uYW1lKSkge1xuICAgIGNvbnN0IHN1Y2Nlc3MgPSBhd2FpdCBjcmVhdGVOZXdXb3JsZEluZm8od29ybGRib29rX25hbWUsIHsgaW50ZXJhY3RpdmU6IGZhbHNlIH0pO1xuICAgIGlmICghc3VjY2Vzcykge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuICBpZiAoaXNfZXhpc3RpbmcgfHwgd29ybGRib29rLmxlbmd0aCA+IDApIHtcbiAgICBhd2FpdCBzYXZlV29ybGRJbmZvKHdvcmxkYm9va19uYW1lLCB7XG4gICAgICBlbnRyaWVzOiBfLm1lcmdlKFxuICAgICAgICB7fSxcbiAgICAgICAgLi4uXyhoYW5kbGVXb3JsZGJvb2tFbnRyaWVzQ29sbGlzaW9uKHdvcmxkYm9vaykpXG4gICAgICAgICAgLm1hcChmcm9tV29ybGRib29rRW50cnkpXG4gICAgICAgICAgLm1hcChlbnRyeSA9PiAoeyBbZW50cnkudWlkXTogZW50cnkgfSkpXG4gICAgICAgICAgLnZhbHVlKCksXG4gICAgICApLFxuICAgIH0pO1xuICAgIGlmIChyZW5kZXIgPT09ICdkZWJvdW5jZWQnKSB7XG4gICAgICByZWxvYWRFZGl0b3JEZWJvdW5jZWQod29ybGRib29rX25hbWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZWxvYWRFZGl0b3Iod29ybGRib29rX25hbWUpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gIWlzX2V4aXN0aW5nO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlV29ybGRib29rKHdvcmxkYm9va19uYW1lOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgcmV0dXJuIGF3YWl0IGRlbGV0ZVdvcmxkSW5mbyh3b3JsZGJvb2tfbmFtZSk7XG59XG5cbi8vIFRPRE86IHJlbmFtZSDpnIDopoHlpITnkIbkuJbnlYzkuabnu5Hlrppcbi8vIGV4cG9ydCBmdW5jdGlvbiByZW5hbWVXb3JsZGJvb2sob2xkX25hbWU6IHN0cmluZywgbmV3X25hbWU6IHN0cmluZyk6IGJvb2xlYW47XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRXb3JsZGJvb2sod29ybGRib29rX25hbWU6IHN0cmluZyk6IFByb21pc2U8V29ybGRib29rRW50cnlbXT4ge1xuICBpZiAoIWdldFdvcmxkYm9va05hbWVzKCkuaW5jbHVkZXMod29ybGRib29rX25hbWUpKSB7XG4gICAgdGhyb3cgRXJyb3IoYOacquiDveaJvuWIsOS4lueVjOS5piAnJHt3b3JsZGJvb2tfbmFtZX0nYCk7XG4gIH1cbiAgY29uc3Qgb3JpZ2luYWxfd29ybGRib29rX2VudHJpZXMgPSBhd2FpdCBsb2FkV29ybGRJbmZvKHdvcmxkYm9va19uYW1lKS50aGVuKFxuICAgIGRhdGEgPT4gKGRhdGEhIGFzIHsgZW50cmllczogeyBbdWlkOiBudW1iZXJdOiBfT3JpZ2luYWxXb3JsZGJvb2tFbnRyeSAmIF9JbXBsaWNpdEtleXMgfSB9KSA/PyB7fSxcbiAgKTtcblxuICByZXR1cm4gc3RydWN0dXJlZENsb25lKFxuICAgIF8ob3JpZ2luYWxfd29ybGRib29rX2VudHJpZXMuZW50cmllcykudmFsdWVzKCkuc29ydEJ5KCdkaXNwbGF5SW5kZXgnKS5tYXAodG9Xb3JsZGJvb2tFbnRyeSkudmFsdWUoKSxcbiAgKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlcGxhY2VXb3JsZGJvb2soXG4gIHdvcmxkYm9va19uYW1lOiBzdHJpbmcsXG4gIHdvcmxkYm9vazogUGFydGlhbERlZXA8V29ybGRib29rRW50cnk+W10sXG4gIG9wdGlvbnM/OiBSZXBsYWNlV29ybGRib29rT3B0aW9ucyxcbik6IFByb21pc2U8dm9pZD4ge1xuICBpZiAoIWdldFdvcmxkYm9va05hbWVzKCkuaW5jbHVkZXMod29ybGRib29rX25hbWUpKSB7XG4gICAgdGhyb3cgRXJyb3IoYOacquiDveaJvuWIsOS4lueVjOS5piAnJHt3b3JsZGJvb2tfbmFtZX0nYCk7XG4gIH1cbiAgYXdhaXQgY3JlYXRlT3JSZXBsYWNlV29ybGRib29rKHdvcmxkYm9va19uYW1lLCB3b3JsZGJvb2ssIG9wdGlvbnMpO1xufVxuXG50eXBlIFdvcmxkYm9va1VwZGF0ZXIgPVxuICB8ICgod29ybGRib29rOiBXb3JsZGJvb2tFbnRyeVtdKSA9PiBQYXJ0aWFsRGVlcDxXb3JsZGJvb2tFbnRyeT5bXSlcbiAgfCAoKHdvcmxkYm9vazogV29ybGRib29rRW50cnlbXSkgPT4gUHJvbWlzZTxQYXJ0aWFsRGVlcDxXb3JsZGJvb2tFbnRyeT5bXT4pO1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVdvcmxkYm9va1dpdGgoXG4gIHdvcmxkYm9va19uYW1lOiBzdHJpbmcsXG4gIHVwZGF0ZXI6IFdvcmxkYm9va1VwZGF0ZXIsXG4gIG9wdGlvbnM/OiBSZXBsYWNlV29ybGRib29rT3B0aW9ucyxcbik6IFByb21pc2U8V29ybGRib29rRW50cnlbXT4ge1xuICBhd2FpdCByZXBsYWNlV29ybGRib29rKHdvcmxkYm9va19uYW1lLCBhd2FpdCB1cGRhdGVyKGF3YWl0IGdldFdvcmxkYm9vayh3b3JsZGJvb2tfbmFtZSkpLCBvcHRpb25zKTtcbiAgcmV0dXJuIGF3YWl0IGdldFdvcmxkYm9vayh3b3JsZGJvb2tfbmFtZSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVXb3JsZGJvb2tFbnRyaWVzKFxuICB3b3JsZGJvb2tfbmFtZTogc3RyaW5nLFxuICBuZXdfZW50cmllczogUGFydGlhbERlZXA8V29ybGRib29rRW50cnk+W10sXG4gIG9wdGlvbnM/OiBSZXBsYWNlV29ybGRib29rT3B0aW9ucyxcbik6IFByb21pc2U8eyB3b3JsZGJvb2s6IFdvcmxkYm9va0VudHJ5W107IG5ld19lbnRyaWVzOiBXb3JsZGJvb2tFbnRyeVtdIH0+IHtcbiAgbGV0IHNsaWNlX3N0YXJ0O1xuICBjb25zdCB3b3JsZGJvb2sgPSBhd2FpdCB1cGRhdGVXb3JsZGJvb2tXaXRoKFxuICAgIHdvcmxkYm9va19uYW1lLFxuICAgIGRhdGEgPT4ge1xuICAgICAgc2xpY2Vfc3RhcnQgPSBkYXRhLmxlbmd0aDtcbiAgICAgIHJldHVybiBbLi4uZGF0YSwgLi4ubmV3X2VudHJpZXNdO1xuICAgIH0sXG4gICAgb3B0aW9ucyxcbiAgKTtcbiAgcmV0dXJuIHsgd29ybGRib29rLCBuZXdfZW50cmllczogd29ybGRib29rLnNsaWNlKHNsaWNlX3N0YXJ0KSB9O1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlV29ybGRib29rRW50cmllcyhcbiAgd29ybGRib29rX25hbWU6IHN0cmluZyxcbiAgcHJlZGljYXRlOiAoZW50cnk6IFdvcmxkYm9va0VudHJ5KSA9PiBib29sZWFuLFxuICBvcHRpb25zPzogUmVwbGFjZVdvcmxkYm9va09wdGlvbnMsXG4pOiBQcm9taXNlPHsgd29ybGRib29rOiBXb3JsZGJvb2tFbnRyeVtdOyBkZWxldGVkX2VudHJpZXM6IFdvcmxkYm9va0VudHJ5W10gfT4ge1xuICBsZXQgZGVsZXRlZF9lbnRyaWVzOiBXb3JsZGJvb2tFbnRyeVtdID0gW107XG4gIGNvbnN0IHdvcmxkYm9vayA9IGF3YWl0IHVwZGF0ZVdvcmxkYm9va1dpdGgoXG4gICAgd29ybGRib29rX25hbWUsXG4gICAgZGF0YSA9PiB7XG4gICAgICBkZWxldGVkX2VudHJpZXMgPSBfLnJlbW92ZShkYXRhLCBwcmVkaWNhdGUpO1xuICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfSxcbiAgICBvcHRpb25zLFxuICApO1xuICByZXR1cm4geyB3b3JsZGJvb2ssIGRlbGV0ZWRfZW50cmllcyB9O1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/function/worldbook.ts\n\n}")},"./src/iframe_client/_exported.ts?raw":
/*!********************************************!*\
  !*** ./src/iframe_client/_exported.ts?raw ***!
  \********************************************/Q=>{Q.exports='"use strict";\nconst SillyTavern = window.parent.SillyTavern.getContext();\nconst TavernHelper = window.parent.TavernHelper;\nfor (const key in TavernHelper) {\n    window[key] = TavernHelper[key];\n}\nconst toastr = window.parent.toastr;\nconst log = window.parent.log;\nconst YAML = window.parent.YAML;\nconst z = window.parent.z;\nz.config(z.locales.zhCN());\nconst EjsTemplate = window.parent.EjsTemplate;\nconst Mvu = window.parent.Mvu;\n'},"./src/iframe_client/_impl.ts?raw":
/*!****************************************!*\
  !*** ./src/iframe_client/_impl.ts?raw ***!
  \****************************************/Q=>{Q.exports="\"use strict\";\n// @ts-expect-error\nvar detail;\n(function (detail) {\n    async function make_iframe_promise(message) {\n        return new Promise((resolve, _) => {\n            const uid = Date.now() + Math.random();\n            function handleMessage(event) {\n                if (event.data?.request === message.request + '_callback' && event.data.uid == uid) {\n                    window.removeEventListener('message', handleMessage);\n                    resolve(event.data.result);\n                }\n            }\n            window.addEventListener('message', handleMessage);\n            window.parent.postMessage({\n                uid: uid,\n                ...message,\n            }, '*');\n        });\n    }\n    detail.make_iframe_promise = make_iframe_promise;\n    function format_function_to_string(fn) {\n        const string = fn.toString();\n        const index = string.indexOf('\\n');\n        if (index > -1) {\n            return string.slice(0, index);\n        }\n        else {\n            return string;\n        }\n    }\n    detail.format_function_to_string = format_function_to_string;\n    function get_or_set(map, key, defaulter) {\n        const existing_value = map.get(key);\n        if (existing_value) {\n            return existing_value;\n        }\n        const default_value = defaulter();\n        map.set(key, default_value);\n        return default_value;\n    }\n    detail.get_or_set = get_or_set;\n    function extract(map, key) {\n        const value = map.get(key);\n        if (!value) {\n            return undefined;\n        }\n        map.delete(key);\n        return value;\n    }\n    detail.extract = extract;\n})(detail || (detail = {}));\n"},"./src/iframe_client/_multimap.ts?raw":
/*!********************************************!*\
  !*** ./src/iframe_client/_multimap.ts?raw ***!
  \********************************************/Q=>{Q.exports="\"use strict\";\n// 命名为 _multimap.ts, 保证它被插入在开头, 虽然最好换一种 iframe 内代码的做法\nclass Multimap {\n    size_ = 0;\n    map = new Map();\n    operator;\n    constructor(operator, iterable) {\n        this.operator = operator;\n        if (iterable) {\n            for (const [key, value] of iterable) {\n                this.put(key, value);\n            }\n        }\n        return this;\n    }\n    get size() {\n        return this.size_;\n    }\n    get(key) {\n        const values = this.map.get(key);\n        if (values) {\n            return this.operator.clone(values);\n        }\n        else {\n            return this.operator.create();\n        }\n    }\n    put(key, value) {\n        let values = this.map.get(key);\n        if (!values) {\n            values = this.operator.create();\n        }\n        if (!this.operator.add(value, values)) {\n            return false;\n        }\n        this.map.set(key, values);\n        this.size_++;\n        return true;\n    }\n    putAll(arg1, arg2) {\n        let pushed = 0;\n        if (arg2) {\n            const key = arg1;\n            const values = arg2;\n            for (const value of values) {\n                this.put(key, value);\n                pushed++;\n            }\n        }\n        else if (arg1 instanceof Multimap) {\n            for (const [key, value] of arg1.entries()) {\n                this.put(key, value);\n                pushed++;\n            }\n        }\n        else {\n            throw new TypeError('unexpected arguments');\n        }\n        return pushed > 0;\n    }\n    has(key) {\n        return this.map.has(key);\n    }\n    hasEntry(key, value) {\n        return this.operator.has(value, this.get(key));\n    }\n    delete(key) {\n        this.size_ -= this.operator.size(this.get(key));\n        return this.map.delete(key);\n    }\n    deleteEntry(key, value) {\n        const current = this.get(key);\n        if (!this.operator.delete(value, current)) {\n            return false;\n        }\n        this.map.set(key, current);\n        this.size_--;\n        return true;\n    }\n    clear() {\n        this.map.clear();\n        this.size_ = 0;\n    }\n    keys() {\n        return this.map.keys();\n    }\n    entries() {\n        const self = this;\n        function* gen() {\n            for (const [key, values] of self.map.entries()) {\n                for (const value of values) {\n                    yield [key, value];\n                }\n            }\n        }\n        return gen();\n    }\n    values() {\n        const self = this;\n        function* gen() {\n            for (const [, value] of self.entries()) {\n                yield value;\n            }\n        }\n        return gen();\n    }\n    forEach(callback, thisArg) {\n        for (const [key, value] of this.entries()) {\n            callback.call(thisArg === undefined ? this : thisArg, value, key, this);\n        }\n    }\n    [Symbol.iterator]() {\n        return this.entries();\n    }\n    asMap() {\n        const ret = new Map();\n        for (const key of this.keys()) {\n            ret.set(key, this.operator.clone(this.get(key)));\n        }\n        return ret;\n    }\n}\nclass ArrayMultimap extends Multimap {\n    constructor(iterable) {\n        super(new ArrayOperator(), iterable);\n    }\n    get [Symbol.toStringTag]() {\n        return 'ArrayMultimap';\n    }\n}\nclass ArrayOperator {\n    create() {\n        return [];\n    }\n    clone(collection) {\n        return collection.slice();\n    }\n    add(value, collection) {\n        collection.push(value);\n        return true;\n    }\n    size(collection) {\n        return collection.length;\n    }\n    delete(value, collection) {\n        const index = collection.indexOf(value);\n        if (index > -1) {\n            collection.splice(index, 1);\n            return true;\n        }\n        return false;\n    }\n    has(value, collection) {\n        return collection.includes(value);\n    }\n}\nclass SetMultimap extends Multimap {\n    constructor(iterable) {\n        super(new SetOperator(), iterable);\n    }\n    get [Symbol.toStringTag]() {\n        return 'SetMultimap';\n    }\n}\nclass SetOperator {\n    create() {\n        return new Set();\n    }\n    clone(collection) {\n        return new Set(collection);\n    }\n    add(value, collection) {\n        const prev = collection.size;\n        collection.add(value);\n        return prev !== collection.size;\n    }\n    size(collection) {\n        return collection.size;\n    }\n    delete(value, collection) {\n        return collection.delete(value);\n    }\n    has(value, collection) {\n        return collection.has(value);\n    }\n}\n"},"./src/iframe_client/event.ts?raw":
/*!****************************************!*\
  !*** ./src/iframe_client/event.ts?raw ***!
  \****************************************/Q=>{Q.exports="\"use strict\";\nfunction eventOn(event_type, listener) {\n    if (detail.try_get_wrapper(listener, event_type)) {\n        log.warn(`[Event][eventOn] 函数已经在监听 '${event_type}' 事件, 调用无效\\n\\n  ${detail.format_function_to_string(listener)}`);\n        return;\n    }\n    SillyTavern.eventSource.on(event_type, detail.get_or_make_wrapper(listener, event_type, false));\n    log.info(`[Event][eventOn] 函数开始监听 '${event_type}' 事件并将随事件触发\\n\\n  ${detail.format_function_to_string(listener)}`);\n}\nfunction eventOnButton(event_type, listener) {\n    const script_id = getScriptId();\n    if (detail.try_get_wrapper(listener, event_type)) {\n        log.warn(`[Event][eventOnButton](id为${String(script_id)}) 的脚本已经在监听 '${event_type}' 事件, 调用无效\\n\\n  ${detail.format_function_to_string(listener)}`);\n        return;\n    }\n    const event_type_with_script_id = `${String(script_id)}_${event_type}`;\n    SillyTavern.eventSource.on(event_type_with_script_id, detail.get_or_make_wrapper(listener, event_type_with_script_id, false));\n    log.info(`[Event][eventOnButton](script_id为${String(script_id)}) 函数开始监听 '${event_type}' 事件并将随事件触发\\n\\n  ${detail.format_function_to_string(listener)}`);\n}\nfunction eventMakeLast(event_type, listener) {\n    const is_listening = detail.try_get_wrapper(listener, event_type) !== undefined;\n    SillyTavern.eventSource.makeLast(event_type, detail.get_or_make_wrapper(listener, event_type, false));\n    if (is_listening) {\n        log.info(`函数调整为监听到 '${event_type}' 事件时最后触发\\n\\n  ${detail.format_function_to_string(listener)}`);\n    }\n    else {\n        log.info(`函数开始监听 '${event_type}' 事件并将随事件最后触发\\n\\n  ${detail.format_function_to_string(listener)}`);\n    }\n}\nfunction eventMakeFirst(event_type, listener) {\n    const is_listening = detail.try_get_wrapper(listener, event_type) !== undefined;\n    SillyTavern.eventSource.makeFirst(event_type, detail.get_or_make_wrapper(listener, event_type, false));\n    if (is_listening) {\n        log.info(`函数调整为监听到 '${event_type}' 事件时最先触发\\n\\n  ${detail.format_function_to_string(listener)}`);\n    }\n    else {\n        log.info(`函数开始监听 '${event_type}' 事件并将随事件最先触发\\n\\n  ${detail.format_function_to_string(listener)}`);\n    }\n}\nfunction eventOnce(event_type, listener) {\n    if (detail.try_get_wrapper(listener, event_type)) {\n        log.warn(`函数已经在监听 '${event_type}' 事件, 调用无效\\n\\n  ${detail.format_function_to_string(listener)}`);\n        return;\n    }\n    SillyTavern.eventSource.once(event_type, detail.get_or_make_wrapper(listener, event_type, true));\n    log.info(`函数开始监听下一次 '${event_type}' 事件并仅在该次事件时触发\\n\\n  ${detail.format_function_to_string(listener)}`);\n}\nasync function eventWaitOnce(event_type, listener) {\n    if (!listener) {\n        const do_nothing = () => { };\n        eventOnce(event_type, do_nothing);\n        return await eventWaitOnce(event_type, do_nothing);\n    }\n    const entry = `${event_type}#${listener.toString()}`;\n    return new Promise((resolve, _) => {\n        const uid = Date.now() + Math.random();\n        function handleMessage(event) {\n            if (event.data?.request === 'iframe_event_wait_callback' && event.data.uid == uid) {\n                window.removeEventListener('message', handleMessage);\n                resolve(event.data.result);\n                detail.waiting_event_map.deleteEntry(entry, uid);\n                log.info(`等待到函数因 '${event_type}' 事件触发后的执行结果: ${JSON.stringify(event.data.result)}\\n\\n  ${detail.format_function_to_string(listener)}`);\n            }\n        }\n        window.addEventListener('message', handleMessage);\n        detail.waiting_event_map.put(entry, uid);\n        log.info(`等待函数被 '${event_type}' 事件触发\\n\\n  ${detail.format_function_to_string(listener)}`);\n    });\n}\nasync function eventEmit(event_type, ...data) {\n    await SillyTavern.eventSource.emit(event_type, ...data);\n    log.info(`发送 '${event_type}' 事件, 携带数据: ${JSON.stringify(data)}`);\n}\nfunction eventEmitAndWait(event_type, ...data) {\n    SillyTavern.eventSource.emitAndWait(event_type, ...data);\n    log.info(`发送 '${event_type}' 事件, 携带数据: ${JSON.stringify(data)}`);\n}\nfunction eventRemoveListener(event_type, listener) {\n    const wrapper = detail.try_get_wrapper(listener, event_type);\n    if (!wrapper) {\n        log.warn(`函数没有监听 '${event_type}' 事件, 调用无效\\n\\n  ${detail.format_function_to_string(listener)}`);\n        return;\n    }\n    SillyTavern.eventSource.removeListener(event_type, wrapper);\n    detail.remove_wrapper(listener, event_type);\n    log.info(`函数不再监听 '${event_type}' 事件\\n\\n  ${detail.format_function_to_string(listener)}`);\n}\nfunction eventClearEvent(event_type) {\n    detail.listener_event_wrapper_map.forEach((event_wrapper_map, _) => {\n        const wrapper = event_wrapper_map.get(event_type);\n        if (wrapper) {\n            SillyTavern.eventSource.removeListener(event_type, wrapper);\n            event_wrapper_map.delete(event_type);\n        }\n    });\n    log.info(`所有函数都不再监听 '${event_type}' 事件`);\n}\nfunction eventClearListener(listener) {\n    const event_callback_map = detail.extract(detail.listener_event_wrapper_map, listener);\n    if (event_callback_map) {\n        event_callback_map.forEach((callback, event_type) => {\n            SillyTavern.eventSource.removeListener(event_type, callback);\n        });\n    }\n    log.info(`函数不再监听任何事件\\n\\n  ${detail.format_function_to_string(listener)}`);\n}\nfunction eventClearAll() {\n    detail.listener_event_wrapper_map.forEach((event_wrapper_map, _) => {\n        event_wrapper_map.forEach((wrapper, event_type) => {\n            SillyTavern.eventSource.removeListener(event_type, wrapper);\n        });\n    });\n    detail.listener_event_wrapper_map.clear();\n    log.info(`取消所有函数对所有事件的监听`);\n}\nconst iframe_events = {\n    MESSAGE_IFRAME_RENDER_STARTED: 'message_iframe_render_started',\n    MESSAGE_IFRAME_RENDER_ENDED: 'message_iframe_render_ended',\n    GENERATION_STARTED: 'js_generation_started',\n    STREAM_TOKEN_RECEIVED_FULLY: 'js_stream_token_received_fully',\n    STREAM_TOKEN_RECEIVED_INCREMENTALLY: 'js_stream_token_received_incrementally',\n    GENERATION_ENDED: 'js_generation_ended',\n};\nconst tavern_events = {\n    APP_READY: 'app_ready',\n    EXTRAS_CONNECTED: 'extras_connected',\n    MESSAGE_SWIPED: 'message_swiped',\n    MESSAGE_SENT: 'message_sent',\n    MESSAGE_RECEIVED: 'message_received',\n    MESSAGE_EDITED: 'message_edited',\n    MESSAGE_DELETED: 'message_deleted',\n    MESSAGE_UPDATED: 'message_updated',\n    MESSAGE_FILE_EMBEDDED: 'message_file_embedded',\n    IMPERSONATE_READY: 'impersonate_ready',\n    CHAT_CHANGED: 'chat_id_changed',\n    GENERATION_AFTER_COMMANDS: 'GENERATION_AFTER_COMMANDS',\n    GENERATION_STARTED: 'generation_started',\n    GENERATION_STOPPED: 'generation_stopped',\n    GENERATION_ENDED: 'generation_ended',\n    EXTENSIONS_FIRST_LOAD: 'extensions_first_load',\n    EXTENSION_SETTINGS_LOADED: 'extension_settings_loaded',\n    SETTINGS_LOADED: 'settings_loaded',\n    SETTINGS_UPDATED: 'settings_updated',\n    GROUP_UPDATED: 'group_updated',\n    MOVABLE_PANELS_RESET: 'movable_panels_reset',\n    SETTINGS_LOADED_BEFORE: 'settings_loaded_before',\n    SETTINGS_LOADED_AFTER: 'settings_loaded_after',\n    CHATCOMPLETION_SOURCE_CHANGED: 'chatcompletion_source_changed',\n    CHATCOMPLETION_MODEL_CHANGED: 'chatcompletion_model_changed',\n    OAI_PRESET_CHANGED_BEFORE: 'oai_preset_changed_before',\n    OAI_PRESET_CHANGED_AFTER: 'oai_preset_changed_after',\n    OAI_PRESET_EXPORT_READY: 'oai_preset_export_ready',\n    OAI_PRESET_IMPORT_READY: 'oai_preset_import_ready',\n    WORLDINFO_SETTINGS_UPDATED: 'worldinfo_settings_updated',\n    WORLDINFO_UPDATED: 'worldinfo_updated',\n    CHARACTER_EDITED: 'character_edited',\n    CHARACTER_PAGE_LOADED: 'character_page_loaded',\n    CHARACTER_GROUP_OVERLAY_STATE_CHANGE_BEFORE: 'character_group_overlay_state_change_before',\n    CHARACTER_GROUP_OVERLAY_STATE_CHANGE_AFTER: 'character_group_overlay_state_change_after',\n    USER_MESSAGE_RENDERED: 'user_message_rendered',\n    CHARACTER_MESSAGE_RENDERED: 'character_message_rendered',\n    FORCE_SET_BACKGROUND: 'force_set_background',\n    CHAT_DELETED: 'chat_deleted',\n    CHAT_CREATED: 'chat_created',\n    GROUP_CHAT_DELETED: 'group_chat_deleted',\n    GROUP_CHAT_CREATED: 'group_chat_created',\n    GENERATE_BEFORE_COMBINE_PROMPTS: 'generate_before_combine_prompts',\n    GENERATE_AFTER_COMBINE_PROMPTS: 'generate_after_combine_prompts',\n    GENERATE_AFTER_DATA: 'generate_after_data',\n    GROUP_MEMBER_DRAFTED: 'group_member_drafted',\n    WORLD_INFO_ACTIVATED: 'world_info_activated',\n    TEXT_COMPLETION_SETTINGS_READY: 'text_completion_settings_ready',\n    CHAT_COMPLETION_SETTINGS_READY: 'chat_completion_settings_ready',\n    CHAT_COMPLETION_PROMPT_READY: 'chat_completion_prompt_ready',\n    CHARACTER_FIRST_MESSAGE_SELECTED: 'character_first_message_selected',\n    // TODO: Naming convention is inconsistent with other events\n    CHARACTER_DELETED: 'characterDeleted',\n    CHARACTER_DUPLICATED: 'character_duplicated',\n    STREAM_TOKEN_RECEIVED: 'stream_token_received',\n    FILE_ATTACHMENT_DELETED: 'file_attachment_deleted',\n    WORLDINFO_FORCE_ACTIVATE: 'worldinfo_force_activate',\n    OPEN_CHARACTER_LIBRARY: 'open_character_library',\n    ONLINE_STATUS_CHANGED: 'online_status_changed',\n    IMAGE_SWIPED: 'image_swiped',\n    CONNECTION_PROFILE_LOADED: 'connection_profile_loaded',\n    TOOL_CALLS_PERFORMED: 'tool_calls_performed',\n    TOOL_CALLS_RENDERED: 'tool_calls_rendered',\n};\n//------------------------------------------------------------------------------------------------------------------------\n// @ts-expect-error\nvar detail;\n(function (detail) {\n    detail.listener_event_wrapper_map = new Map();\n    function try_get_wrapper(listener, event_type) {\n        return detail.listener_event_wrapper_map.get(listener)?.get(event_type);\n    }\n    detail.try_get_wrapper = try_get_wrapper;\n    function remove_wrapper(listener, event_type) {\n        detail.listener_event_wrapper_map.get(listener)?.delete(event_type);\n    }\n    detail.remove_wrapper = remove_wrapper;\n    function get_or_make_wrapper(listener, event_type, once) {\n        const default_wrapper = async (...args) => {\n            if (once) {\n                remove_wrapper(listener, event_type);\n            }\n            const result = await listener(...args);\n            log.info(`函数因监听到 '${event_type}' 事件而触发\\n\\n  ${detail.format_function_to_string(listener)}`);\n            const uid = detail.waiting_event_map.get(`${event_type}#${listener.toString()}`)[0];\n            if (uid) {\n                window.postMessage({\n                    request: 'iframe_event_wait_callback',\n                    uid: uid,\n                    result: result,\n                }, '*');\n            }\n            return result;\n        };\n        const default_event_wrapper_map = new Map([[event_type, default_wrapper]]);\n        const event_wrapper = detail.get_or_set(detail.listener_event_wrapper_map, listener, () => default_event_wrapper_map);\n        const wrapper = detail.get_or_set(event_wrapper, event_type, () => default_wrapper);\n        return wrapper;\n    }\n    detail.get_or_make_wrapper = get_or_make_wrapper;\n    detail.waiting_event_map = new ArrayMultimap();\n    $(window).on('unload', eventClearAll);\n})(detail || (detail = {}));\n"},"./src/iframe_client/index.ts":
/*!************************************!*\
  !*** ./src/iframe_client/index.ts ***!
  \************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   iframe_client: () => (/* binding */ iframe_client)\n/* harmony export */ });\n/* harmony import */ var _iframe_client_exported_raw__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/iframe_client/_exported?raw */ "./src/iframe_client/_exported.ts?raw");\n/* harmony import */ var _iframe_client_impl_raw__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/iframe_client/_impl?raw */ "./src/iframe_client/_impl.ts?raw");\n/* harmony import */ var _iframe_client_multimap_raw__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/iframe_client/_multimap?raw */ "./src/iframe_client/_multimap.ts?raw");\n/* harmony import */ var _iframe_client_event_raw__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/iframe_client/event?raw */ "./src/iframe_client/event.ts?raw");\n/* harmony import */ var _iframe_client_util_raw__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/iframe_client/util?raw */ "./src/iframe_client/util.ts?raw");\n/* harmony import */ var _iframe_client_variables_raw__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/iframe_client/variables?raw */ "./src/iframe_client/variables.ts?raw");\n// TODO: 导入 index 时使用 raw, 而不是分别使用 raw\n\n\n\n\n\n\nconst iframe_client = [_iframe_client_exported_raw__WEBPACK_IMPORTED_MODULE_0__, _iframe_client_impl_raw__WEBPACK_IMPORTED_MODULE_1__, _iframe_client_multimap_raw__WEBPACK_IMPORTED_MODULE_2__, _iframe_client_event_raw__WEBPACK_IMPORTED_MODULE_3__, _iframe_client_variables_raw__WEBPACK_IMPORTED_MODULE_5__, _iframe_client_util_raw__WEBPACK_IMPORTED_MODULE_4__].join(\'\\n\');\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvaWZyYW1lX2NsaWVudC9pbmRleC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUEsc0NBQXNDO0FBQ2dCO0FBQ1I7QUFDUTtBQUNSO0FBQ0Y7QUFDVTtBQUUvQyxNQUFNLGFBQWEsR0FBRyxDQUFDLHdEQUFTLEVBQUUsb0RBQUssRUFBRSx3REFBUyxFQUFFLHFEQUFLLEVBQUUseURBQVMsRUFBRSxvREFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2lmcmFtZV9jbGllbnQvaW5kZXgudHM/Nzc2YSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUT0RPOiDlr7zlhaUgaW5kZXgg5pe25L2/55SoIHJhdywg6ICM5LiN5piv5YiG5Yir5L2/55SoIHJhd1xuaW1wb3J0IF9leHBvcnRlZCBmcm9tICdAL2lmcmFtZV9jbGllbnQvX2V4cG9ydGVkP3Jhdyc7XG5pbXBvcnQgX2ltcGwgZnJvbSAnQC9pZnJhbWVfY2xpZW50L19pbXBsP3Jhdyc7XG5pbXBvcnQgX211bHRpbWFwIGZyb20gJ0AvaWZyYW1lX2NsaWVudC9fbXVsdGltYXA/cmF3JztcbmltcG9ydCBldmVudCBmcm9tICdAL2lmcmFtZV9jbGllbnQvZXZlbnQ/cmF3JztcbmltcG9ydCB1dGlsIGZyb20gJ0AvaWZyYW1lX2NsaWVudC91dGlsP3Jhdyc7XG5pbXBvcnQgdmFyaWFibGVzIGZyb20gJ0AvaWZyYW1lX2NsaWVudC92YXJpYWJsZXM/cmF3JztcblxuZXhwb3J0IGNvbnN0IGlmcmFtZV9jbGllbnQgPSBbX2V4cG9ydGVkLCBfaW1wbCwgX211bHRpbWFwLCBldmVudCwgdmFyaWFibGVzLCB1dGlsXS5qb2luKCdcXG4nKTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/iframe_client/index.ts\n\n}')},"./src/iframe_client/util.ts?raw":
/*!***************************************!*\
  !*** ./src/iframe_client/util.ts?raw ***!
  \***************************************/Q=>{Q.exports="\"use strict\";\nfunction getIframeName() {\n    return window.frameElement.id;\n}\nfunction getScriptId() {\n    return $(window.frameElement).attr('script-id') ?? 'unknown_script';\n}\nfunction getCurrentMessageId() {\n    return getMessageId(getIframeName());\n}\nfunction getMessageId(iframe_name) {\n    const match = iframe_name.match(/^message-iframe-(\\d+)-\\d+$/);\n    if (!match) {\n        throw Error(`获取 ${iframe_name} 所在楼层 id 时出错: 不要对全局脚本 iframe 调用 getMessageId!`);\n    }\n    return parseInt(match[1].toString());\n}\n"},"./src/iframe_client/variables.ts?raw":
/*!********************************************!*\
  !*** ./src/iframe_client/variables.ts?raw ***!
  \********************************************/Q=>{Q.exports="\"use strict\";\nfunction getAllVariables() {\n    const is_message_iframe = getIframeName().startsWith('message-iframe');\n    let data = _.merge({}, SillyTavern.extensionSettings.variables.global, SillyTavern.characters[SillyTavern.characterId]?.data?.extensions?.TavernHelper_characterScriptVariables);\n    if (!is_message_iframe) {\n        data = _.merge(data, TavernHelper.getVariables('script', getScriptId()));\n    }\n    data = _.merge(data, SillyTavern.chatMetadata.variables);\n    if (is_message_iframe) {\n        data = _.merge(data, ...SillyTavern.chat\n            .slice(0, getCurrentMessageId())\n            .map((chat_message) => chat_message?.variables?.[chat_message?.swipe_id ?? 0]));\n    }\n    return structuredClone(data);\n}\n//------------------------------------------------------------------------------------------------------------------------\n// 已被弃用的接口, 请尽量按照指示更新它们\n/** @deprecated 这个函数是在事件监听功能之前制作的, 现在请使用 `insertOrAssignVariables` 而用事件监听或条件判断来控制怎么更新 */\nasync function setVariables(message_id, new_or_updated_variables) {\n    let actual_message_id;\n    let actual_variables;\n    if (new_or_updated_variables) {\n        actual_message_id = message_id;\n        actual_variables = new_or_updated_variables;\n    }\n    else {\n        actual_message_id = getCurrentMessageId();\n        actual_variables = message_id;\n    }\n    if (typeof actual_message_id !== 'number' || typeof actual_variables !== 'object') {\n        return;\n    }\n    return detail.make_iframe_promise({\n        request: '[Variables][setVariables]',\n        message_id: actual_message_id,\n        variables: actual_variables,\n    });\n}\n"},"./src/index.ts":
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/(module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _component_audio__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/audio */ \"./src/component/audio/index.ts\");\n/* harmony import */ var _component_index__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/component/index */ \"./src/component/index.ts\");\n/* harmony import */ var _component_listener__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/component/listener */ \"./src/component/listener/index.ts\");\n/* harmony import */ var _component_macrolike__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/component/macrolike */ \"./src/component/macrolike.ts\");\n/* harmony import */ var _component_message_iframe__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/component/message_iframe */ \"./src/component/message_iframe/index.ts\");\n/* harmony import */ var _component_prompt_view__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/component/prompt_view */ \"./src/component/prompt_view/index.ts\");\n/* harmony import */ var _component_reference__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/component/reference */ \"./src/component/reference/index.ts\");\n/* harmony import */ var _component_script_repository_index__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @/component/script_repository/index */ \"./src/component/script_repository/index.ts\");\n/* harmony import */ var _component_script_repository_types__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @/component/script_repository/types */ \"./src/component/script_repository/types.ts\");\n/* harmony import */ var _component_variable_manager__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @/component/variable_manager */ \"./src/component/variable_manager/index.ts\");\n/* harmony import */ var _disable_incompatible_option__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @/disable_incompatible_option */ \"./src/disable_incompatible_option.ts\");\n/* harmony import */ var _function__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @/function */ \"./src/function/index.ts\");\n/* harmony import */ var _slash_command_audio__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @/slash_command/audio */ \"./src/slash_command/audio.ts\");\n/* harmony import */ var _slash_command_event__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @/slash_command/event */ \"./src/slash_command/event.ts\");\n/* harmony import */ var _util_check_update__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @/util/check_update */ \"./src/util/check_update.ts\");\n/* harmony import */ var _util_collapsible__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @/util/collapsible */ \"./src/util/collapsible.ts\");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_19___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_19__);\n/* harmony import */ var yaml__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! yaml */ \"yaml\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! zod */ \"zod\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_21___default = /*#__PURE__*/__webpack_require__.n(zod__WEBPACK_IMPORTED_MODULE_21__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_component_index__WEBPACK_IMPORTED_MODULE_1__, _component_listener__WEBPACK_IMPORTED_MODULE_2__, _component_script_repository_index__WEBPACK_IMPORTED_MODULE_7__, _component_variable_manager__WEBPACK_IMPORTED_MODULE_9__, yaml__WEBPACK_IMPORTED_MODULE_20__]);\n([_component_index__WEBPACK_IMPORTED_MODULE_1__, _component_listener__WEBPACK_IMPORTED_MODULE_2__, _component_script_repository_index__WEBPACK_IMPORTED_MODULE_7__, _component_variable_manager__WEBPACK_IMPORTED_MODULE_9__, yaml__WEBPACK_IMPORTED_MODULE_20__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n/* harmony import */ var yaml__WEBPACK_IMPORTED_MODULE_20___default = /*#__PURE__*/__webpack_require__.n(yaml__WEBPACK_IMPORTED_MODULE_20__);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst defaultSettings = {\n    enabled_extension: true,\n    render: {\n        ..._component_message_iframe__WEBPACK_IMPORTED_MODULE_4__.defaultIframeSettings,\n    },\n    script: {\n        ..._component_script_repository_types__WEBPACK_IMPORTED_MODULE_8__.defaultScriptSettings,\n    },\n    audio: {\n        ..._component_audio__WEBPACK_IMPORTED_MODULE_0__.defaultAudioSettings,\n    },\n    debug: {\n        enabled: false,\n    },\n};\nconst templatePath = `${_util_extension_variables__WEBPACK_IMPORTED_MODULE_16__.extensionFolderPath}/src/component`;\n/**\n * 设置页面切换\n *  @param event 事件对象\n * */\nfunction handleSettingPageChange(event) {\n    const target = $(event.currentTarget);\n    let id = target.attr('id');\n    if (id === undefined) {\n        return;\n    }\n    id = id.replace('-settings-title', '');\n    function resetAllTitleClasses() {\n        $('#main-settings-title').removeClass('title-item-active');\n        $('#render-settings-title').removeClass('title-item-active');\n        $('#script-settings-title').removeClass('title-item-active');\n        $('#toolbox-settings-title').removeClass('title-item-active');\n    }\n    function hideAllContentPanels() {\n        $('#main-settings-content').hide();\n        $('#render-settings-content').hide();\n        $('#script-settings-content').hide();\n        $('#toolbox-settings-content').hide();\n    }\n    resetAllTitleClasses();\n    hideAllContentPanels();\n    switch (id) {\n        case 'main':\n            $('#main-settings-title').addClass('title-item-active');\n            $('#main-settings-content').show();\n            break;\n        case 'render':\n            $('#render-settings-title').addClass('title-item-active');\n            $('#render-settings-content').show();\n            break;\n        case 'script':\n            $('#script-settings-title').addClass('title-item-active');\n            $('#script-settings-content').show();\n            break;\n        case 'toolbox':\n            $('#toolbox-settings-title').addClass('title-item-active');\n            $('#toolbox-settings-content').show();\n            break;\n    }\n}\n/**界面统一加载 */\nasync function initExtensionPanel() {\n    const getContainer = () => $('#extensions_settings');\n    const windowHtml = await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_18__.renderExtensionTemplateAsync)(`${_util_extension_variables__WEBPACK_IMPORTED_MODULE_16__.extensionFolderPath}`, 'index');\n    getContainer().append(windowHtml);\n    const $script_container = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_18__.renderExtensionTemplateAsync)(`${templatePath}/script_repository/public`, 'index'));\n    $('#script-settings-content').append($script_container);\n    const $iframe_container = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_18__.renderExtensionTemplateAsync)(`${templatePath}/message_iframe`, 'index'));\n    $('#render-settings-content').append($iframe_container);\n    const $variables_container = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_18__.renderExtensionTemplateAsync)(`${templatePath}/variable_manager/public`, 'variable_manager_entry'));\n    const $prompt_view_container = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_18__.renderExtensionTemplateAsync)(`${templatePath}/prompt_view/public`, 'prompt_view_entry'));\n    const $audio_container = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_18__.renderExtensionTemplateAsync)(`${templatePath}/audio`, 'index'));\n    $('#toolbox-settings-content').append($variables_container).append($prompt_view_container).append($audio_container);\n    const $reference_container = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_18__.renderExtensionTemplateAsync)(`${templatePath}/reference`, 'index'));\n    $('#extension-reference').append($reference_container);\n}\n/**\n * 版本控制\n */\nasync function handleVersionUpdate() {\n    const currentVersion = await (0,_util_check_update__WEBPACK_IMPORTED_MODULE_14__.getCurrentVersion)(_util_check_update__WEBPACK_IMPORTED_MODULE_14__.VERSION_FILE_PATH);\n    $('.version').text(`Ver ${currentVersion}`);\n    const isNeedUpdate = await (0,_util_check_update__WEBPACK_IMPORTED_MODULE_14__.runCheckWithPath)();\n    if (isNeedUpdate) {\n        (0,_util_check_update__WEBPACK_IMPORTED_MODULE_14__.addVersionUpdateElement)();\n    }\n    $('#update-extension').on('click', async () => await (0,_util_check_update__WEBPACK_IMPORTED_MODULE_14__.handleUpdateButton)());\n}\nfunction initThirdPartyObject() {\n    globalThis.log = (loglevel__WEBPACK_IMPORTED_MODULE_19___default());\n    globalThis.YAML = (yaml__WEBPACK_IMPORTED_MODULE_20___default());\n    globalThis.z = (zod__WEBPACK_IMPORTED_MODULE_21___default());\n}\nasync function initDebugMode() {\n    const debugEnabled = await (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_16__.getOrSaveSettingValue)('debug.enabled', defaultSettings.debug.enabled);\n    $('#debug-mode-toggle')\n        .prop('checked', debugEnabled)\n        .on('click', (event) => {\n        const isDebugMode = event.target.checked;\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_16__.saveSettingValue)('debug.enabled', isDebugMode);\n        if (isDebugMode) {\n            log.enableAll();\n        }\n        else {\n            log.setLevel('warn');\n        }\n    });\n    if (debugEnabled) {\n        log.enableAll();\n    }\n    else {\n        log.setLevel('warn');\n    }\n}\n/**\n * 初始化扩展面板\n */\njQuery(async () => {\n    await initExtensionPanel();\n    //@ts-ignore\n    if (!_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_18__.extension_settings[_util_extension_variables__WEBPACK_IMPORTED_MODULE_16__.extensionSettingName]) {\n        _.set(_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_18__.extension_settings, _util_extension_variables__WEBPACK_IMPORTED_MODULE_16__.extensionSettingName, defaultSettings);\n        // 删除旧版配置\n        _.unset(_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_18__.extension_settings, _util_extension_variables__WEBPACK_IMPORTED_MODULE_16__.extensionName);\n        (0,_util_check_update__WEBPACK_IMPORTED_MODULE_14__.showNewFeature)();\n        await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_17__.saveSettings)();\n    }\n    (0,_disable_incompatible_option__WEBPACK_IMPORTED_MODULE_10__.disableIncompatibleOption)();\n    initThirdPartyObject();\n    (0,_function__WEBPACK_IMPORTED_MODULE_11__.initTavernHelperObject)();\n    await initDebugMode();\n    // 默认显示主设置界面\n    $('#main-settings-title').addClass('title-item-active');\n    $('#main-settings-content').show();\n    $('#render-settings-content').hide();\n    $('#script-settings-content').hide();\n    $('#toolbox-settings-content').hide();\n    // 监听设置选项卡切换\n    $('#main-settings-title').on('click', (event) => handleSettingPageChange(event));\n    $('#render-settings-title').on('click', (event) => handleSettingPageChange(event));\n    $('#script-settings-title').on('click', (event) => handleSettingPageChange(event));\n    $('#toolbox-settings-title').on('click', (event) => handleSettingPageChange(event));\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_17__.eventSource.once(_sillytavern_script__WEBPACK_IMPORTED_MODULE_17__.event_types.APP_READY, async () => {\n        (0,_component_index__WEBPACK_IMPORTED_MODULE_1__.initExtensionMainPanel)();\n        await handleVersionUpdate();\n        await (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.initAudioComponents)();\n        (0,_slash_command_audio__WEBPACK_IMPORTED_MODULE_12__.initAudioSlashCommands)();\n        (0,_slash_command_event__WEBPACK_IMPORTED_MODULE_13__.initSlashEventEmit)();\n        await (0,_component_script_repository_index__WEBPACK_IMPORTED_MODULE_7__.buildScriptRepository)();\n        await (0,_component_message_iframe__WEBPACK_IMPORTED_MODULE_4__.initIframePanel)();\n        (0,_component_macrolike__WEBPACK_IMPORTED_MODULE_3__.renderAllMacros)();\n        await (0,_component_reference__WEBPACK_IMPORTED_MODULE_6__.initReference)();\n        await (0,_component_listener__WEBPACK_IMPORTED_MODULE_2__.initListener)();\n        (0,_component_variable_manager__WEBPACK_IMPORTED_MODULE_9__.initVariableManager)();\n        (0,_component_prompt_view__WEBPACK_IMPORTED_MODULE_5__.initPromptView)();\n    });\n    // 通用Collapsible折叠功能\n    _util_collapsible__WEBPACK_IMPORTED_MODULE_15__.Collapsible.initAll('.collapsible', {\n        headerSelector: 'div:first-child',\n        contentSelector: '.collapsible-content',\n        initiallyExpanded: false,\n        animationDuration: {\n            expand: 280,\n            collapse: 250,\n        },\n    });\n});\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0FBQztRQUNsQixNQUFNLG1FQUFhLEVBQUUsQ0FBQztRQUN0QixNQUFNLGlFQUFZLEVBQUUsQ0FBQztRQUNyQixnRkFBbUIsRUFBRSxDQUFDO1FBQ3RCLHNFQUFjLEVBQUUsQ0FBQztJQUNuQixDQUFDLENBQUMsQ0FBQztJQUVILG9CQUFvQjtJQUNwQiwyREFBVyxDQUFDLE9BQU8sQ0FBQyxjQUFjLEVBQUU7UUFDbEMsY0FBYyxFQUFFLGlCQUFpQjtRQUNqQyxlQUFlLEVBQUUsc0JBQXNCO1FBQ3ZDLGlCQUFpQixFQUFFLEtBQUs7UUFDeEIsaUJBQWlCLEVBQUU7WUFDakIsTUFBTSxFQUFFLEdBQUc7WUFDWCxRQUFRLEVBQUUsR0FBRztTQUNkO0tBQ0YsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvaW5kZXgudHM/ZmZiNCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBkZWZhdWx0QXVkaW9TZXR0aW5ncywgaW5pdEF1ZGlvQ29tcG9uZW50cyB9IGZyb20gJ0AvY29tcG9uZW50L2F1ZGlvJztcbmltcG9ydCB7IGluaXRFeHRlbnNpb25NYWluUGFuZWwgfSBmcm9tICdAL2NvbXBvbmVudC9pbmRleCc7XG5pbXBvcnQgeyBpbml0TGlzdGVuZXIgfSBmcm9tICdAL2NvbXBvbmVudC9saXN0ZW5lcic7XG5pbXBvcnQgeyByZW5kZXJBbGxNYWNyb3MgfSBmcm9tICdAL2NvbXBvbmVudC9tYWNyb2xpa2UnO1xuaW1wb3J0IHsgZGVmYXVsdElmcmFtZVNldHRpbmdzLCBpbml0SWZyYW1lUGFuZWwgfSBmcm9tICdAL2NvbXBvbmVudC9tZXNzYWdlX2lmcmFtZSc7XG5pbXBvcnQgeyBpbml0UHJvbXB0VmlldyB9IGZyb20gJ0AvY29tcG9uZW50L3Byb21wdF92aWV3JztcbmltcG9ydCB7IGluaXRSZWZlcmVuY2UgfSBmcm9tICdAL2NvbXBvbmVudC9yZWZlcmVuY2UnO1xuaW1wb3J0IHsgYnVpbGRTY3JpcHRSZXBvc2l0b3J5IH0gZnJvbSAnQC9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvaW5kZXgnO1xuaW1wb3J0IHsgZGVmYXVsdFNjcmlwdFNldHRpbmdzIH0gZnJvbSAnQC9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvdHlwZXMnO1xuaW1wb3J0IHsgaW5pdFZhcmlhYmxlTWFuYWdlciB9IGZyb20gJ0AvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXInO1xuaW1wb3J0IHsgZGlzYWJsZUluY29tcGF0aWJsZU9wdGlvbiB9IGZyb20gJ0AvZGlzYWJsZV9pbmNvbXBhdGlibGVfb3B0aW9uJztcbmltcG9ydCB7IGluaXRUYXZlcm5IZWxwZXJPYmplY3QgfSBmcm9tICdAL2Z1bmN0aW9uJztcbmltcG9ydCB7IGluaXRBdWRpb1NsYXNoQ29tbWFuZHMgfSBmcm9tICdAL3NsYXNoX2NvbW1hbmQvYXVkaW8nO1xuaW1wb3J0IHsgaW5pdFNsYXNoRXZlbnRFbWl0IH0gZnJvbSAnQC9zbGFzaF9jb21tYW5kL2V2ZW50JztcbmltcG9ydCB7XG4gIGFkZFZlcnNpb25VcGRhdGVFbGVtZW50LFxuICBnZXRDdXJyZW50VmVyc2lvbixcbiAgaGFuZGxlVXBkYXRlQnV0dG9uLFxuICBydW5DaGVja1dpdGhQYXRoLFxuICBzaG93TmV3RmVhdHVyZSxcbiAgVkVSU0lPTl9GSUxFX1BBVEgsXG59IGZyb20gJ0AvdXRpbC9jaGVja191cGRhdGUnO1xuaW1wb3J0IHsgQ29sbGFwc2libGUgfSBmcm9tICdAL3V0aWwvY29sbGFwc2libGUnO1xuaW1wb3J0IHtcbiAgZXh0ZW5zaW9uRm9sZGVyUGF0aCxcbiAgZXh0ZW5zaW9uTmFtZSxcbiAgZXh0ZW5zaW9uU2V0dGluZ05hbWUsXG4gIGdldE9yU2F2ZVNldHRpbmdWYWx1ZSxcbiAgc2F2ZVNldHRpbmdWYWx1ZSxcbn0gZnJvbSAnQC91dGlsL2V4dGVuc2lvbl92YXJpYWJsZXMnO1xuXG5pbXBvcnQgeyBldmVudF90eXBlcywgZXZlbnRTb3VyY2UsIHNhdmVTZXR0aW5ncyB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHQnO1xuaW1wb3J0IHsgZXh0ZW5zaW9uX3NldHRpbmdzLCByZW5kZXJFeHRlbnNpb25UZW1wbGF0ZUFzeW5jIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvZXh0ZW5zaW9ucyc7XG5cbmltcG9ydCBsb2dfb2JqZWN0IGZyb20gJ2xvZ2xldmVsJztcbmltcG9ydCBZQU1MX29iamVjdCBmcm9tICd5YW1sJztcbmltcG9ydCB6X29iamVjdCBmcm9tICd6b2QnO1xuXG5jb25zdCBkZWZhdWx0U2V0dGluZ3MgPSB7XG4gIGVuYWJsZWRfZXh0ZW5zaW9uOiB0cnVlLFxuICByZW5kZXI6IHtcbiAgICAuLi5kZWZhdWx0SWZyYW1lU2V0dGluZ3MsXG4gIH0sXG4gIHNjcmlwdDoge1xuICAgIC4uLmRlZmF1bHRTY3JpcHRTZXR0aW5ncyxcbiAgfSxcbiAgYXVkaW86IHtcbiAgICAuLi5kZWZhdWx0QXVkaW9TZXR0aW5ncyxcbiAgfSxcbiAgZGVidWc6IHtcbiAgICBlbmFibGVkOiBmYWxzZSxcbiAgfSxcbn07XG5cbmNvbnN0IHRlbXBsYXRlUGF0aCA9IGAke2V4dGVuc2lvbkZvbGRlclBhdGh9L3NyYy9jb21wb25lbnRgO1xuXG4vKipcbiAqIOiuvue9rumhtemdouWIh+aNolxuICogIEBwYXJhbSBldmVudCDkuovku7blr7nosaFcbiAqICovXG5mdW5jdGlvbiBoYW5kbGVTZXR0aW5nUGFnZUNoYW5nZShldmVudDogSlF1ZXJ5LkNsaWNrRXZlbnQpIHtcbiAgY29uc3QgdGFyZ2V0ID0gJChldmVudC5jdXJyZW50VGFyZ2V0KTtcbiAgbGV0IGlkID0gdGFyZ2V0LmF0dHIoJ2lkJyk7XG4gIGlmIChpZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGlkID0gaWQucmVwbGFjZSgnLXNldHRpbmdzLXRpdGxlJywgJycpO1xuXG4gIGZ1bmN0aW9uIHJlc2V0QWxsVGl0bGVDbGFzc2VzKCkge1xuICAgICQoJyNtYWluLXNldHRpbmdzLXRpdGxlJykucmVtb3ZlQ2xhc3MoJ3RpdGxlLWl0ZW0tYWN0aXZlJyk7XG4gICAgJCgnI3JlbmRlci1zZXR0aW5ncy10aXRsZScpLnJlbW92ZUNsYXNzKCd0aXRsZS1pdGVtLWFjdGl2ZScpO1xuICAgICQoJyNzY3JpcHQtc2V0dGluZ3MtdGl0bGUnKS5yZW1vdmVDbGFzcygndGl0bGUtaXRlbS1hY3RpdmUnKTtcbiAgICAkKCcjdG9vbGJveC1zZXR0aW5ncy10aXRsZScpLnJlbW92ZUNsYXNzKCd0aXRsZS1pdGVtLWFjdGl2ZScpO1xuICB9XG5cbiAgZnVuY3Rpb24gaGlkZUFsbENvbnRlbnRQYW5lbHMoKSB7XG4gICAgJCgnI21haW4tc2V0dGluZ3MtY29udGVudCcpLmhpZGUoKTtcbiAgICAkKCcjcmVuZGVyLXNldHRpbmdzLWNvbnRlbnQnKS5oaWRlKCk7XG4gICAgJCgnI3NjcmlwdC1zZXR0aW5ncy1jb250ZW50JykuaGlkZSgpO1xuICAgICQoJyN0b29sYm94LXNldHRpbmdzLWNvbnRlbnQnKS5oaWRlKCk7XG4gIH1cblxuICByZXNldEFsbFRpdGxlQ2xhc3NlcygpO1xuICBoaWRlQWxsQ29udGVudFBhbmVscygpO1xuXG4gIHN3aXRjaCAoaWQpIHtcbiAgICBjYXNlICdtYWluJzpcbiAgICAgICQoJyNtYWluLXNldHRpbmdzLXRpdGxlJykuYWRkQ2xhc3MoJ3RpdGxlLWl0ZW0tYWN0aXZlJyk7XG4gICAgICAkKCcjbWFpbi1zZXR0aW5ncy1jb250ZW50Jykuc2hvdygpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAncmVuZGVyJzpcbiAgICAgICQoJyNyZW5kZXItc2V0dGluZ3MtdGl0bGUnKS5hZGRDbGFzcygndGl0bGUtaXRlbS1hY3RpdmUnKTtcbiAgICAgICQoJyNyZW5kZXItc2V0dGluZ3MtY29udGVudCcpLnNob3coKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ3NjcmlwdCc6XG4gICAgICAkKCcjc2NyaXB0LXNldHRpbmdzLXRpdGxlJykuYWRkQ2xhc3MoJ3RpdGxlLWl0ZW0tYWN0aXZlJyk7XG4gICAgICAkKCcjc2NyaXB0LXNldHRpbmdzLWNvbnRlbnQnKS5zaG93KCk7XG4gICAgICBicmVhaztcbiAgICBjYXNlICd0b29sYm94JzpcbiAgICAgICQoJyN0b29sYm94LXNldHRpbmdzLXRpdGxlJykuYWRkQ2xhc3MoJ3RpdGxlLWl0ZW0tYWN0aXZlJyk7XG4gICAgICAkKCcjdG9vbGJveC1zZXR0aW5ncy1jb250ZW50Jykuc2hvdygpO1xuICAgICAgYnJlYWs7XG4gIH1cbn1cblxuLyoq55WM6Z2i57uf5LiA5Yqg6L29ICovXG5hc3luYyBmdW5jdGlvbiBpbml0RXh0ZW5zaW9uUGFuZWwoKSB7XG4gIGNvbnN0IGdldENvbnRhaW5lciA9ICgpID0+ICQoJyNleHRlbnNpb25zX3NldHRpbmdzJyk7XG4gIGNvbnN0IHdpbmRvd0h0bWwgPSBhd2FpdCByZW5kZXJFeHRlbnNpb25UZW1wbGF0ZUFzeW5jKGAke2V4dGVuc2lvbkZvbGRlclBhdGh9YCwgJ2luZGV4Jyk7XG4gIGdldENvbnRhaW5lcigpLmFwcGVuZCh3aW5kb3dIdG1sKTtcbiAgY29uc3QgJHNjcmlwdF9jb250YWluZXIgPSAkKGF3YWl0IHJlbmRlckV4dGVuc2lvblRlbXBsYXRlQXN5bmMoYCR7dGVtcGxhdGVQYXRofS9zY3JpcHRfcmVwb3NpdG9yeS9wdWJsaWNgLCAnaW5kZXgnKSk7XG4gICQoJyNzY3JpcHQtc2V0dGluZ3MtY29udGVudCcpLmFwcGVuZCgkc2NyaXB0X2NvbnRhaW5lcik7XG4gIGNvbnN0ICRpZnJhbWVfY29udGFpbmVyID0gJChhd2FpdCByZW5kZXJFeHRlbnNpb25UZW1wbGF0ZUFzeW5jKGAke3RlbXBsYXRlUGF0aH0vbWVzc2FnZV9pZnJhbWVgLCAnaW5kZXgnKSk7XG4gICQoJyNyZW5kZXItc2V0dGluZ3MtY29udGVudCcpLmFwcGVuZCgkaWZyYW1lX2NvbnRhaW5lcik7XG4gIGNvbnN0ICR2YXJpYWJsZXNfY29udGFpbmVyID0gJChcbiAgICBhd2FpdCByZW5kZXJFeHRlbnNpb25UZW1wbGF0ZUFzeW5jKGAke3RlbXBsYXRlUGF0aH0vdmFyaWFibGVfbWFuYWdlci9wdWJsaWNgLCAndmFyaWFibGVfbWFuYWdlcl9lbnRyeScpLFxuICApO1xuICBjb25zdCAkcHJvbXB0X3ZpZXdfY29udGFpbmVyID0gJChcbiAgICBhd2FpdCByZW5kZXJFeHRlbnNpb25UZW1wbGF0ZUFzeW5jKGAke3RlbXBsYXRlUGF0aH0vcHJvbXB0X3ZpZXcvcHVibGljYCwgJ3Byb21wdF92aWV3X2VudHJ5JyksXG4gICk7XG4gIGNvbnN0ICRhdWRpb19jb250YWluZXIgPSAkKGF3YWl0IHJlbmRlckV4dGVuc2lvblRlbXBsYXRlQXN5bmMoYCR7dGVtcGxhdGVQYXRofS9hdWRpb2AsICdpbmRleCcpKTtcbiAgJCgnI3Rvb2xib3gtc2V0dGluZ3MtY29udGVudCcpLmFwcGVuZCgkdmFyaWFibGVzX2NvbnRhaW5lcikuYXBwZW5kKCRwcm9tcHRfdmlld19jb250YWluZXIpLmFwcGVuZCgkYXVkaW9fY29udGFpbmVyKTtcbiAgY29uc3QgJHJlZmVyZW5jZV9jb250YWluZXIgPSAkKGF3YWl0IHJlbmRlckV4dGVuc2lvblRlbXBsYXRlQXN5bmMoYCR7dGVtcGxhdGVQYXRofS9yZWZlcmVuY2VgLCAnaW5kZXgnKSk7XG4gICQoJyNleHRlbnNpb24tcmVmZXJlbmNlJykuYXBwZW5kKCRyZWZlcmVuY2VfY29udGFpbmVyKTtcbn1cblxuLyoqXG4gKiDniYjmnKzmjqfliLZcbiAqL1xuYXN5bmMgZnVuY3Rpb24gaGFuZGxlVmVyc2lvblVwZGF0ZSgpIHtcbiAgY29uc3QgY3VycmVudFZlcnNpb24gPSBhd2FpdCBnZXRDdXJyZW50VmVyc2lvbihWRVJTSU9OX0ZJTEVfUEFUSCk7XG4gICQoJy52ZXJzaW9uJykudGV4dChgVmVyICR7Y3VycmVudFZlcnNpb259YCk7XG4gIGNvbnN0IGlzTmVlZFVwZGF0ZSA9IGF3YWl0IHJ1bkNoZWNrV2l0aFBhdGgoKTtcbiAgaWYgKGlzTmVlZFVwZGF0ZSkge1xuICAgIGFkZFZlcnNpb25VcGRhdGVFbGVtZW50KCk7XG4gIH1cbiAgJCgnI3VwZGF0ZS1leHRlbnNpb24nKS5vbignY2xpY2snLCBhc3luYyAoKSA9PiBhd2FpdCBoYW5kbGVVcGRhdGVCdXR0b24oKSk7XG59XG5cbmRlY2xhcmUgbmFtZXNwYWNlIGdsb2JhbFRoaXMge1xuICBsZXQgbG9nOiB0eXBlb2YgbG9nX29iamVjdDtcbiAgbGV0IFlBTUw6IHR5cGVvZiBZQU1MX29iamVjdDtcbiAgbGV0IHo6IHR5cGVvZiB6X29iamVjdDtcbn1cblxuZnVuY3Rpb24gaW5pdFRoaXJkUGFydHlPYmplY3QoKSB7XG4gIGdsb2JhbFRoaXMubG9nID0gbG9nX29iamVjdDtcbiAgZ2xvYmFsVGhpcy5ZQU1MID0gWUFNTF9vYmplY3Q7XG4gIGdsb2JhbFRoaXMueiA9IHpfb2JqZWN0O1xufVxuXG5hc3luYyBmdW5jdGlvbiBpbml0RGVidWdNb2RlKCkge1xuICBjb25zdCBkZWJ1Z0VuYWJsZWQgPSBhd2FpdCBnZXRPclNhdmVTZXR0aW5nVmFsdWUoJ2RlYnVnLmVuYWJsZWQnLCBkZWZhdWx0U2V0dGluZ3MuZGVidWcuZW5hYmxlZCk7XG4gICQoJyNkZWJ1Zy1tb2RlLXRvZ2dsZScpXG4gICAgLnByb3AoJ2NoZWNrZWQnLCBkZWJ1Z0VuYWJsZWQpXG4gICAgLm9uKCdjbGljaycsIChldmVudDogSlF1ZXJ5LkNsaWNrRXZlbnQpID0+IHtcbiAgICAgIGNvbnN0IGlzRGVidWdNb2RlID0gZXZlbnQudGFyZ2V0LmNoZWNrZWQ7XG4gICAgICBzYXZlU2V0dGluZ1ZhbHVlKCdkZWJ1Zy5lbmFibGVkJywgaXNEZWJ1Z01vZGUpO1xuICAgICAgaWYgKGlzRGVidWdNb2RlKSB7XG4gICAgICAgIGxvZy5lbmFibGVBbGwoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxvZy5zZXRMZXZlbCgnd2FybicpO1xuICAgICAgfVxuICAgIH0pO1xuICBpZiAoZGVidWdFbmFibGVkKSB7XG4gICAgbG9nLmVuYWJsZUFsbCgpO1xuICB9IGVsc2Uge1xuICAgIGxvZy5zZXRMZXZlbCgnd2FybicpO1xuICB9XG59XG5cbi8qKlxuICog5Yid5aeL5YyW5omp5bGV6Z2i5p2/XG4gKi9cbmpRdWVyeShhc3luYyAoKSA9PiB7XG4gIGF3YWl0IGluaXRFeHRlbnNpb25QYW5lbCgpO1xuICAvL0B0cy1pZ25vcmVcbiAgaWYgKCFleHRlbnNpb25fc2V0dGluZ3NbZXh0ZW5zaW9uU2V0dGluZ05hbWVdKSB7XG4gICAgXy5zZXQoZXh0ZW5zaW9uX3NldHRpbmdzLCBleHRlbnNpb25TZXR0aW5nTmFtZSwgZGVmYXVsdFNldHRpbmdzKTtcbiAgICAvLyDliKDpmaTml6fniYjphY3nva5cbiAgICBfLnVuc2V0KGV4dGVuc2lvbl9zZXR0aW5ncywgZXh0ZW5zaW9uTmFtZSk7XG4gICAgc2hvd05ld0ZlYXR1cmUoKTtcbiAgICBhd2FpdCBzYXZlU2V0dGluZ3MoKTtcbiAgfVxuXG4gIGRpc2FibGVJbmNvbXBhdGlibGVPcHRpb24oKTtcbiAgaW5pdFRoaXJkUGFydHlPYmplY3QoKTtcbiAgaW5pdFRhdmVybkhlbHBlck9iamVjdCgpO1xuICBhd2FpdCBpbml0RGVidWdNb2RlKCk7XG4gIC8vIOm7mOiupOaYvuekuuS4u+iuvue9rueVjOmdolxuICAkKCcjbWFpbi1zZXR0aW5ncy10aXRsZScpLmFkZENsYXNzKCd0aXRsZS1pdGVtLWFjdGl2ZScpO1xuICAkKCcjbWFpbi1zZXR0aW5ncy1jb250ZW50Jykuc2hvdygpO1xuICAkKCcjcmVuZGVyLXNldHRpbmdzLWNvbnRlbnQnKS5oaWRlKCk7XG4gICQoJyNzY3JpcHQtc2V0dGluZ3MtY29udGVudCcpLmhpZGUoKTtcbiAgJCgnI3Rvb2xib3gtc2V0dGluZ3MtY29udGVudCcpLmhpZGUoKTtcblxuICAvLyDnm5HlkKzorr7nva7pgInpobnljaHliIfmjaJcbiAgJCgnI21haW4tc2V0dGluZ3MtdGl0bGUnKS5vbignY2xpY2snLCAoZXZlbnQ6IEpRdWVyeS5DbGlja0V2ZW50KSA9PiBoYW5kbGVTZXR0aW5nUGFnZUNoYW5nZShldmVudCkpO1xuICAkKCcjcmVuZGVyLXNldHRpbmdzLXRpdGxlJykub24oJ2NsaWNrJywgKGV2ZW50OiBKUXVlcnkuQ2xpY2tFdmVudCkgPT4gaGFuZGxlU2V0dGluZ1BhZ2VDaGFuZ2UoZXZlbnQpKTtcbiAgJCgnI3NjcmlwdC1zZXR0aW5ncy10aXRsZScpLm9uKCdjbGljaycsIChldmVudDogSlF1ZXJ5LkNsaWNrRXZlbnQpID0+IGhhbmRsZVNldHRpbmdQYWdlQ2hhbmdlKGV2ZW50KSk7XG4gICQoJyN0b29sYm94LXNldHRpbmdzLXRpdGxlJykub24oJ2NsaWNrJywgKGV2ZW50OiBKUXVlcnkuQ2xpY2tFdmVudCkgPT4gaGFuZGxlU2V0dGluZ1BhZ2VDaGFuZ2UoZXZlbnQpKTtcblxuICBldmVudFNvdXJjZS5vbmNlKGV2ZW50X3R5cGVzLkFQUF9SRUFEWSwgYXN5bmMgKCkgPT4ge1xuICAgIGluaXRFeHRlbnNpb25NYWluUGFuZWwoKTtcbiAgICBhd2FpdCBoYW5kbGVWZXJzaW9uVXBkYXRlKCk7XG4gICAgYXdhaXQgaW5pdEF1ZGlvQ29tcG9uZW50cygpO1xuICAgIGluaXRBdWRpb1NsYXNoQ29tbWFuZHMoKTtcbiAgICBpbml0U2xhc2hFdmVudEVtaXQoKTtcbiAgICBhd2FpdCBidWlsZFNjcmlwdFJlcG9zaXRvcnkoKTtcbiAgICBhd2FpdCBpbml0SWZyYW1lUGFuZWwoKTtcbiAgICByZW5kZXJBbGxNYWNyb3MoKTtcbiAgICBhd2FpdCBpbml0UmVmZXJlbmNlKCk7XG4gICAgYXdhaXQgaW5pdExpc3RlbmVyKCk7XG4gICAgaW5pdFZhcmlhYmxlTWFuYWdlcigpO1xuICAgIGluaXRQcm9tcHRWaWV3KCk7XG4gIH0pO1xuXG4gIC8vIOmAmueUqENvbGxhcHNpYmxl5oqY5Y+g5Yqf6IO9XG4gIENvbGxhcHNpYmxlLmluaXRBbGwoJy5jb2xsYXBzaWJsZScsIHtcbiAgICBoZWFkZXJTZWxlY3RvcjogJ2RpdjpmaXJzdC1jaGlsZCcsXG4gICAgY29udGVudFNlbGVjdG9yOiAnLmNvbGxhcHNpYmxlLWNvbnRlbnQnLFxuICAgIGluaXRpYWxseUV4cGFuZGVkOiBmYWxzZSxcbiAgICBhbmltYXRpb25EdXJhdGlvbjoge1xuICAgICAgZXhwYW5kOiAyODAsXG4gICAgICBjb2xsYXBzZTogMjUwLFxuICAgIH0sXG4gIH0pO1xufSk7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/index.ts\n\n}")},"./src/script_url.ts":
/*!***************************!*\
  !*** ./src/script_url.ts ***!
  \***************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   script_url: () => (/* binding */ script_url)\n/* harmony export */ });\n/* harmony import */ var _util_map_util__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/util/map_util */ \"./src/util/map_util.ts\");\n\nfunction createObjectURLFromScript(code) {\n    return URL.createObjectURL(new Blob([code], { type: 'application/javascript' }));\n}\nclass ScriptUrl {\n    map = new Map();\n    get(name) {\n        return this.map.get(name);\n    }\n    set(name, code) {\n        this.map.set(name, createObjectURLFromScript(code));\n    }\n    delete(name) {\n        const url = (0,_util_map_util__WEBPACK_IMPORTED_MODULE_0__.extract)(this.map, name);\n        if (!url) {\n            return url;\n        }\n        URL.revokeObjectURL(url);\n        return url;\n    }\n}\nconst script_url = new ScriptUrl();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvc2NyaXB0X3VybC50cyIsIm1hcHBpbmdzIjoiOzs7OztBQUEwQztBQUUxQyxTQUFTLHlCQUF5QixDQUFDLElBQVk7SUFDN0MsT0FBTyxHQUFHLENBQUMsZUFBZSxDQUFDLElBQUksSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsRUFBRSxJQUFJLEVBQUUsd0JBQXdCLEVBQUUsQ0FBQyxDQUFDLENBQUM7QUFDbkYsQ0FBQztBQUVELE1BQU0sU0FBUztJQUNMLEdBQUcsR0FBd0IsSUFBSSxHQUFHLEVBQUUsQ0FBQztJQUV0QyxHQUFHLENBQUMsSUFBWTtRQUNyQixPQUFPLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzVCLENBQUM7SUFDTSxHQUFHLENBQUMsSUFBWSxFQUFFLElBQVk7UUFDbkMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsSUFBSSxFQUFFLHlCQUF5QixDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7SUFDdEQsQ0FBQztJQUNNLE1BQU0sQ0FBQyxJQUFZO1FBQ3hCLE1BQU0sR0FBRyxHQUFHLHVEQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsQ0FBQztRQUNwQyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7WUFDVCxPQUFPLEdBQUcsQ0FBQztRQUNiLENBQUM7UUFDRCxHQUFHLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3pCLE9BQU8sR0FBRyxDQUFDO0lBQ2IsQ0FBQztDQUNGO0FBRU0sTUFBTSxVQUFVLEdBQUcsSUFBSSxTQUFTLEVBQUUsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9zY3JpcHRfdXJsLnRzPzUzZjAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZXh0cmFjdCB9IGZyb20gJ0AvdXRpbC9tYXBfdXRpbCc7XG5cbmZ1bmN0aW9uIGNyZWF0ZU9iamVjdFVSTEZyb21TY3JpcHQoY29kZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgcmV0dXJuIFVSTC5jcmVhdGVPYmplY3RVUkwobmV3IEJsb2IoW2NvZGVdLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi9qYXZhc2NyaXB0JyB9KSk7XG59XG5cbmNsYXNzIFNjcmlwdFVybCB7XG4gIHByaXZhdGUgbWFwOiBNYXA8c3RyaW5nLCBzdHJpbmc+ID0gbmV3IE1hcCgpO1xuXG4gIHB1YmxpYyBnZXQobmFtZTogc3RyaW5nKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5tYXAuZ2V0KG5hbWUpO1xuICB9XG4gIHB1YmxpYyBzZXQobmFtZTogc3RyaW5nLCBjb2RlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICB0aGlzLm1hcC5zZXQobmFtZSwgY3JlYXRlT2JqZWN0VVJMRnJvbVNjcmlwdChjb2RlKSk7XG4gIH1cbiAgcHVibGljIGRlbGV0ZShuYW1lOiBzdHJpbmcpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICAgIGNvbnN0IHVybCA9IGV4dHJhY3QodGhpcy5tYXAsIG5hbWUpO1xuICAgIGlmICghdXJsKSB7XG4gICAgICByZXR1cm4gdXJsO1xuICAgIH1cbiAgICBVUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7XG4gICAgcmV0dXJuIHVybDtcbiAgfVxufVxuXG5leHBvcnQgY29uc3Qgc2NyaXB0X3VybCA9IG5ldyBTY3JpcHRVcmwoKTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/script_url.ts\n\n}")},"./src/slash_command/audio.ts":
/*!************************************!*\
  !*** ./src/slash_command/audio.ts ***!
  \************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   audioEnable: () => (/* binding */ audioEnable),\n/* harmony export */   audioImport: () => (/* binding */ audioImport),\n/* harmony export */   audioMode: () => (/* binding */ audioMode),\n/* harmony export */   audioPlay: () => (/* binding */ audioPlay),\n/* harmony export */   audioSelect: () => (/* binding */ audioSelect),\n/* harmony export */   initAudioSlashCommands: () => (/* binding */ initAudioSlashCommands)\n/* harmony export */ });\n/* harmony import */ var _component_audio__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/audio */ \"./src/component/audio/index.ts\");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var _sillytavern_scripts_slash_commands_SlashCommand__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sillytavern/scripts/slash-commands/SlashCommand */ \"@sillytavern/scripts/slash-commands/SlashCommand\");\n/* harmony import */ var _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @sillytavern/scripts/slash-commands/SlashCommandArgument */ \"@sillytavern/scripts/slash-commands/SlashCommandArgument\");\n/* harmony import */ var _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @sillytavern/scripts/slash-commands/SlashCommandCommonEnumsProvider */ \"@sillytavern/scripts/slash-commands/SlashCommandCommonEnumsProvider\");\n/* harmony import */ var _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @sillytavern/scripts/slash-commands/SlashCommandEnumValue */ \"@sillytavern/scripts/slash-commands/SlashCommandEnumValue\");\n/* harmony import */ var _sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @sillytavern/scripts/slash-commands/SlashCommandParser */ \"@sillytavern/scripts/slash-commands/SlashCommandParser\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_9__);\n\n\n\n\n\n\n\n\n\n\n/**\n * 切换音频播放模式\n */\nasync function audioMode(args) {\n    const type = args.type.toLowerCase();\n    const mode = args.mode.toLowerCase();\n    if (!['bgm', 'ambient'].includes(type) || !['repeat', 'random', 'single', 'stop'].includes(mode)) {\n        loglevel__WEBPACK_IMPORTED_MODULE_9___default().warn('WARN: Invalid arguments for /audiomode command');\n        return '';\n    }\n    if (type === 'bgm') {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.bgm_mode', mode);\n        const iconMap = {\n            repeat: 'fa-repeat',\n            random: 'fa-random',\n            single: 'fa-redo-alt',\n            stop: 'fa-cancel',\n        };\n        $('#audio_bgm_mode_icon').removeClass('fa-repeat fa-random fa-redo-alt fa-cancel');\n        $('#audio_bgm_mode_icon').addClass(iconMap[mode]);\n    }\n    else if (type === 'ambient') {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.ambient_mode', mode);\n        const iconMap = {\n            repeat: 'fa-repeat',\n            random: 'fa-random',\n            single: 'fa-redo-alt',\n            stop: 'fa-cancel',\n        };\n        $('#audio_ambient_mode_icon').removeClass('fa-repeat fa-random fa-redo-alt fa-cancel');\n        $('#audio_ambient_mode_icon').addClass(iconMap[mode]);\n    }\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.saveSettingsDebounced)();\n    return '';\n}\n/**\n * 切换播放器开关状态\n */\nasync function audioEnable(args) {\n    const type = args.type.toLowerCase();\n    const state = (args.state || 'true').toLowerCase();\n    if (!type) {\n        loglevel__WEBPACK_IMPORTED_MODULE_9___default().warn('WARN: Missing arguments for /audioenable command');\n        return '';\n    }\n    if (type === 'bgm') {\n        if (state === 'true') {\n            $('#enable_bgm').prop('checked', true);\n            await (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.onAudioEnabledClick)('bgm');\n        }\n        else if (state === 'false') {\n            $('#enable_bgm').prop('checked', false);\n            await (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.onAudioEnabledClick)('bgm');\n        }\n    }\n    else if (type === 'ambient') {\n        if (state === 'true') {\n            $('#enable_ambient').prop('checked', true);\n            await (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.onAudioEnabledClick)('ambient');\n        }\n        else if (state === 'false') {\n            $('#enable_ambient').prop('checked', false);\n            await (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.onAudioEnabledClick)('ambient');\n        }\n    }\n    return '';\n}\n/**\n * 切换播放/暂停状态\n */\nasync function audioPlay(args) {\n    const type = args.type.toLowerCase();\n    const play = (args.play || 'true').toLowerCase();\n    if (!type) {\n        loglevel__WEBPACK_IMPORTED_MODULE_9___default().warn('WARN: Missing arguments for /audioplaypause command');\n        return '';\n    }\n    if (type === 'bgm') {\n        if (play === 'true') {\n            await (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.playAudio)('bgm');\n        }\n        else if (play === 'false') {\n            const audioElement = $('#audio_bgm')[0];\n            audioElement.pause();\n        }\n    }\n    else if (type === 'ambient') {\n        if (play === 'true') {\n            await (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.playAudio)('ambient');\n        }\n        else if (play === 'false') {\n            const audioElement = $('#audio_ambient')[0];\n            audioElement.pause();\n        }\n    }\n    return '';\n}\n/**\n * 导入音频链接\n */\nasync function audioImport(args, url) {\n    const type = args.type.toLowerCase();\n    const play = (args.play || 'true').toLowerCase();\n    if (!type || !url) {\n        loglevel__WEBPACK_IMPORTED_MODULE_9___default().warn('WARN: Missing arguments for /audioimport command');\n        return '';\n    }\n    const urlArray = url\n        .split(',')\n        .map((url) => url.trim())\n        .filter((url) => url !== '')\n        .filter((url, index, self) => self.indexOf(url) === index);\n    if (urlArray.length === 0) {\n        loglevel__WEBPACK_IMPORTED_MODULE_9___default().warn('WARN: Invalid or empty URLs provided.');\n        return '';\n    }\n    if (!_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata.variables) {\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata.variables = {};\n    }\n    const typeKey = type === 'bgm' ? 'bgmurl' : 'ambienturl';\n    const existingUrls = _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata.variables[typeKey] || [];\n    const mergedUrls = [...new Set([...urlArray, ...existingUrls])];\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata.variables[typeKey] = mergedUrls;\n    (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__.saveMetadataDebounced)();\n    if (type === 'bgm') {\n        (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.updateAudioSelect)('bgm');\n    }\n    else if (type === 'ambient') {\n        (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.updateAudioSelect)('ambient');\n    }\n    if (play === 'true' && urlArray[0]) {\n        const selectedUrl = urlArray[0];\n        if (type === 'bgm') {\n            (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.bgm_selected', selectedUrl);\n            await (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.updateAudio)('bgm', true);\n        }\n        else if (type === 'ambient') {\n            (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.ambient_selected', selectedUrl);\n            await (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.updateAudio)('ambient', true);\n        }\n    }\n    return '';\n}\n/**\n * 选择并播放音频\n */\nasync function audioSelect(args, url) {\n    const type = args.type.toLowerCase();\n    if (!url) {\n        loglevel__WEBPACK_IMPORTED_MODULE_9___default().warn('WARN: Missing URL for /audioselect command');\n        return '';\n    }\n    if (!_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata.variables) {\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata.variables = {};\n    }\n    const playlist = type === 'bgm' ? _component_audio__WEBPACK_IMPORTED_MODULE_0__.list_BGMS : _component_audio__WEBPACK_IMPORTED_MODULE_0__.list_ambients;\n    const typeKey = type === 'bgm' ? 'bgmurl' : 'ambienturl';\n    if (playlist && playlist.includes(url)) {\n        if (type === 'bgm') {\n            (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.bgm_selected', url);\n            await (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.updateAudio)('bgm', true);\n        }\n        else if (type === 'ambient') {\n            (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.ambient_selected', url);\n            await (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.updateAudio)('ambient', true);\n        }\n        return '';\n    }\n    const existingUrls = _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata.variables[typeKey] || [];\n    const mergedUrls = [...new Set([url, ...existingUrls])];\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata.variables[typeKey] = mergedUrls;\n    (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__.saveMetadataDebounced)();\n    if (type === 'bgm') {\n        (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.updateAudioSelect)('bgm');\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.bgm_selected', url);\n        await (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.updateAudio)('bgm', true);\n    }\n    else if (type === 'ambient') {\n        (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.updateAudioSelect)('ambient');\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.ambient_selected', url);\n        await (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.updateAudio)('ambient', true);\n    }\n    return '';\n}\n/**\n * 初始化音频相关的 slash command\n */\nfunction initAudioSlashCommands() {\n    // 注册 audioselect 命令\n    _sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_8__.SlashCommandParser.addCommandObject(_sillytavern_scripts_slash_commands_SlashCommand__WEBPACK_IMPORTED_MODULE_4__.SlashCommand.fromProps({\n        name: 'audioselect',\n        callback: audioSelect,\n        namedArgumentList: [\n            _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.SlashCommandNamedArgument.fromProps({\n                name: 'type',\n                description: '选择播放器类型 (bgm 或 ambient)',\n                typeList: [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.ARGUMENT_TYPE.STRING],\n                enumList: [\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.SlashCommandEnumValue('bgm', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__.enumIcons.file),\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.SlashCommandEnumValue('ambient', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__.enumIcons.file),\n                ],\n                isRequired: true,\n            }),\n        ],\n        unnamedArgumentList: [new _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.SlashCommandArgument('url', [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.ARGUMENT_TYPE.STRING], true)],\n        helpString: `\n        <div>\n            选择并播放音频。如果音频链接不存在，则先导入再播放。\n        </div>\n        <div>\n            <strong>Example:</strong>\n            <ul>\n                <li>\n                    <pre><code>/audioselect type=bgm https://example.com/song.mp3</code></pre>\n                    选择并播放指定的音乐。\n                </li>\n                <li>\n                    <pre><code>/audioselect type=ambient https://example.com/sound.mp3</code></pre>\n                    选择并播放指定的音效。\n                </li>\n            </ul>\n        </div>\n      `,\n    }));\n    // 注册 audioimport 命令\n    _sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_8__.SlashCommandParser.addCommandObject(_sillytavern_scripts_slash_commands_SlashCommand__WEBPACK_IMPORTED_MODULE_4__.SlashCommand.fromProps({\n        name: 'audioimport',\n        callback: audioImport,\n        namedArgumentList: [\n            _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.SlashCommandNamedArgument.fromProps({\n                name: 'type',\n                description: '选择导入类型 (bgm 或 ambient)',\n                typeList: [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.ARGUMENT_TYPE.STRING],\n                enumList: [\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.SlashCommandEnumValue('bgm', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__.enumIcons.file),\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.SlashCommandEnumValue('ambient', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__.enumIcons.file),\n                ],\n                isRequired: true,\n            }),\n            _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.SlashCommandNamedArgument.fromProps({\n                name: 'play',\n                description: '导入后是否立即播放第一个链接',\n                typeList: [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.ARGUMENT_TYPE.BOOLEAN],\n                defaultValue: 'true',\n                isRequired: false,\n            }),\n        ],\n        unnamedArgumentList: [new _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.SlashCommandArgument('url', [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.ARGUMENT_TYPE.STRING], true)],\n        helpString: `\n        <div>\n            导入音频或音乐链接，并决定是否立即播放，默认为自动播放。可批量导入链接，使用英文逗号分隔。\n        </div>\n        <div>\n            <strong>Example:</strong>\n            <ul>\n                <li>\n                    <pre><code>/audioimport type=bgm https://example.com/song1.mp3,https://example.com/song2.mp3</code></pre>\n                    导入 BGM 音乐并立即播放第一个链接。\n                </li>\n                <li>\n                    <pre><code>/audioimport type=ambient play=false url=https://example.com/sound1.mp3,https://example.com/sound2.mp3 </code></pre>\n                    导入音效链接 (不自动播放)。\n                </li>\n            </ul>\n        </div>\n      `,\n    }));\n    // 注册 audioplay 命令\n    _sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_8__.SlashCommandParser.addCommandObject(_sillytavern_scripts_slash_commands_SlashCommand__WEBPACK_IMPORTED_MODULE_4__.SlashCommand.fromProps({\n        name: 'audioplay',\n        callback: audioPlay,\n        namedArgumentList: [\n            _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.SlashCommandNamedArgument.fromProps({\n                name: 'type',\n                description: '选择控制的播放器 (bgm 或 ambient)',\n                typeList: [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.ARGUMENT_TYPE.STRING],\n                enumList: [\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.SlashCommandEnumValue('bgm', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__.enumIcons.file),\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.SlashCommandEnumValue('ambient', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__.enumIcons.file),\n                ],\n                isRequired: true,\n            }),\n            new _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.SlashCommandNamedArgument('play', '播放或暂停', [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.ARGUMENT_TYPE.STRING], true, false, 'true', _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__.commonEnumProviders.boolean('trueFalse')()),\n        ],\n        helpString: `\n        <div>\n            控制音乐播放器或音效播放器的播放与暂停。\n        </div>\n        <div>\n            <strong>Example:</strong>\n            <ul>\n                <li>\n                    <pre><code>/audioplay type=bgm</code></pre>\n                    播放当前音乐。\n                </li>\n                <li>\n                    <pre><code>/audioplay type=ambient play=false</code></pre>\n                    暂停当前音效。\n                </li>\n            </ul>\n        </div>\n      `,\n    }));\n    // 注册 audioenable 命令\n    _sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_8__.SlashCommandParser.addCommandObject(_sillytavern_scripts_slash_commands_SlashCommand__WEBPACK_IMPORTED_MODULE_4__.SlashCommand.fromProps({\n        name: 'audioenable',\n        callback: audioEnable,\n        namedArgumentList: [\n            _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.SlashCommandNamedArgument.fromProps({\n                name: 'type',\n                description: '选择控制的播放器 (bgm 或 ambient)',\n                typeList: [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.ARGUMENT_TYPE.STRING],\n                enumList: [\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.SlashCommandEnumValue('bgm', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__.enumIcons.file),\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.SlashCommandEnumValue('ambient', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__.enumIcons.file),\n                ],\n                isRequired: true,\n            }),\n            new _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.SlashCommandNamedArgument('state', '打开或关闭播放器', [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.ARGUMENT_TYPE.STRING], false, false, 'true', _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__.commonEnumProviders.boolean('trueFalse')()),\n        ],\n        helpString: `\n        <div>\n            控制音乐播放器或音效播放器的开启与关闭。\n        </div>\n        <div>\n            <strong>Example:</strong>\n            <ul>\n                <li>\n                    <pre><code>/audioenable type=bgm state=true</code></pre>\n                    打开音乐播放器。\n                </li>\n                <li>\n                    <pre><code>/audioenable type=ambient state=false</code></pre>\n                    关闭音效播放器。\n                </li>\n            </ul>\n        </div>\n    `,\n    }));\n    // 注册 audiomode 命令\n    _sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_8__.SlashCommandParser.addCommandObject(_sillytavern_scripts_slash_commands_SlashCommand__WEBPACK_IMPORTED_MODULE_4__.SlashCommand.fromProps({\n        name: 'audiomode',\n        callback: audioMode,\n        namedArgumentList: [\n            _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.SlashCommandNamedArgument.fromProps({\n                name: 'type',\n                description: '选择控制的播放器 (bgm 或 ambient)',\n                typeList: [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.ARGUMENT_TYPE.STRING],\n                enumList: [\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.SlashCommandEnumValue('bgm', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__.enumIcons.file),\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.SlashCommandEnumValue('ambient', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__.enumIcons.file),\n                ],\n                isRequired: true,\n            }),\n            _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.SlashCommandNamedArgument.fromProps({\n                name: 'mode',\n                description: '选择播放模式',\n                typeList: [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.ARGUMENT_TYPE.STRING],\n                enumList: [\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.SlashCommandEnumValue('repeat', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__.enumIcons.loop),\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.SlashCommandEnumValue('random', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__.enumIcons.shuffle),\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.SlashCommandEnumValue('single', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__.enumIcons.redo),\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.SlashCommandEnumValue('stop', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__.enumIcons.stop),\n                ],\n                isRequired: true,\n            }),\n        ],\n        helpString: `\n        <div>\n            设置音频播放模式。\n        </div>\n        <div>\n            <strong>Example:</strong>\n            <ul>\n                <li>\n                    <pre><code>/audiomode type=bgm mode=repeat</code></pre>\n                    设置音乐为循环播放模式。\n                </li>\n                <li>\n                    <pre><code>/audiomode type=ambient mode=random</code></pre>\n                    设置音效为随机播放模式。\n                </li>\n                <li>\n                    <pre><code>/audiomode type=bgm mode=single</code></pre>\n                    设置音乐为单曲循环模式。\n                </li>\n                <li>\n                    <pre><code>/audiomode type=ambient mode=stop</code></pre>\n                    设置音效为停止播放模式。\n                </li>\n            </ul>\n        </div>\n    `,\n    }));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxJQUFJLEVBQUUsMEdBQVMsQ0FBQyxJQUFJLENBQUM7aUJBQ3hFO2dCQUNELFVBQVUsRUFBRSxJQUFJO2FBQ2pCLENBQUM7U0FDSDtRQUNELFVBQVUsRUFBRTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztLQXlCYjtLQUNBLENBQUMsQ0FDSCxDQUFDO0FBQ0osQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9zbGFzaF9jb21tYW5kL2F1ZGlvLnRzPzBjODAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgbGlzdF9CR01TLFxuICBsaXN0X2FtYmllbnRzLFxuICBvbkF1ZGlvRW5hYmxlZENsaWNrLFxuICBwbGF5QXVkaW8sXG4gIHVwZGF0ZUF1ZGlvLFxuICB1cGRhdGVBdWRpb1NlbGVjdCxcbn0gZnJvbSAnQC9jb21wb25lbnQvYXVkaW8nO1xuaW1wb3J0IHsgc2F2ZVNldHRpbmdWYWx1ZSB9IGZyb20gJ0AvdXRpbC9leHRlbnNpb25fdmFyaWFibGVzJztcblxuaW1wb3J0IHsgY2hhdF9tZXRhZGF0YSwgc2F2ZVNldHRpbmdzRGVib3VuY2VkIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5pbXBvcnQgeyBzYXZlTWV0YWRhdGFEZWJvdW5jZWQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9leHRlbnNpb25zJztcbmltcG9ydCB7IFNsYXNoQ29tbWFuZCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3NsYXNoLWNvbW1hbmRzL1NsYXNoQ29tbWFuZCc7XG5pbXBvcnQge1xuICBBUkdVTUVOVF9UWVBFLFxuICBTbGFzaENvbW1hbmRBcmd1bWVudCxcbiAgU2xhc2hDb21tYW5kTmFtZWRBcmd1bWVudCxcbn0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvc2xhc2gtY29tbWFuZHMvU2xhc2hDb21tYW5kQXJndW1lbnQnO1xuaW1wb3J0IHsgY29tbW9uRW51bVByb3ZpZGVycywgZW51bUljb25zIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvc2xhc2gtY29tbWFuZHMvU2xhc2hDb21tYW5kQ29tbW9uRW51bXNQcm92aWRlcic7XG5pbXBvcnQgeyBTbGFzaENvbW1hbmRFbnVtVmFsdWUsIGVudW1UeXBlcyB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3NsYXNoLWNvbW1hbmRzL1NsYXNoQ29tbWFuZEVudW1WYWx1ZSc7XG5pbXBvcnQgeyBTbGFzaENvbW1hbmRQYXJzZXIgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9zbGFzaC1jb21tYW5kcy9TbGFzaENvbW1hbmRQYXJzZXInO1xuXG5pbXBvcnQgbG9nIGZyb20gJ2xvZ2xldmVsJztcblxuaW50ZXJmYWNlIEF1ZGlvRWxlbWVudCBleHRlbmRzIEhUTUxFbGVtZW50IHtcbiAgcGF1c2UoKTogdm9pZDtcbn1cblxuLyoqXG4gKiDliIfmjaLpn7PpopHmkq3mlL7mqKHlvI9cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGF1ZGlvTW9kZShhcmdzOiB7IHR5cGU6IHN0cmluZzsgbW9kZTogc3RyaW5nIH0pOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgdHlwZSA9IGFyZ3MudHlwZS50b0xvd2VyQ2FzZSgpO1xuICBjb25zdCBtb2RlID0gYXJncy5tb2RlLnRvTG93ZXJDYXNlKCk7XG5cbiAgaWYgKCFbJ2JnbScsICdhbWJpZW50J10uaW5jbHVkZXModHlwZSkgfHwgIVsncmVwZWF0JywgJ3JhbmRvbScsICdzaW5nbGUnLCAnc3RvcCddLmluY2x1ZGVzKG1vZGUpKSB7XG4gICAgbG9nLndhcm4oJ1dBUk46IEludmFsaWQgYXJndW1lbnRzIGZvciAvYXVkaW9tb2RlIGNvbW1hbmQnKTtcbiAgICByZXR1cm4gJyc7XG4gIH1cblxuICBpZiAodHlwZSA9PT0gJ2JnbScpIHtcbiAgICBzYXZlU2V0dGluZ1ZhbHVlKCdhdWRpby5iZ21fbW9kZScsIG1vZGUpO1xuICAgIGNvbnN0IGljb25NYXA6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gICAgICByZXBlYXQ6ICdmYS1yZXBlYXQnLFxuICAgICAgcmFuZG9tOiAnZmEtcmFuZG9tJyxcbiAgICAgIHNpbmdsZTogJ2ZhLXJlZG8tYWx0JyxcbiAgICAgIHN0b3A6ICdmYS1jYW5jZWwnLFxuICAgIH07XG4gICAgJCgnI2F1ZGlvX2JnbV9tb2RlX2ljb24nKS5yZW1vdmVDbGFzcygnZmEtcmVwZWF0IGZhLXJhbmRvbSBmYS1yZWRvLWFsdCBmYS1jYW5jZWwnKTtcbiAgICAkKCcjYXVkaW9fYmdtX21vZGVfaWNvbicpLmFkZENsYXNzKGljb25NYXBbbW9kZV0pO1xuICB9IGVsc2UgaWYgKHR5cGUgPT09ICdhbWJpZW50Jykge1xuICAgIHNhdmVTZXR0aW5nVmFsdWUoJ2F1ZGlvLmFtYmllbnRfbW9kZScsIG1vZGUpO1xuICAgIGNvbnN0IGljb25NYXA6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gICAgICByZXBlYXQ6ICdmYS1yZXBlYXQnLFxuICAgICAgcmFuZG9tOiAnZmEtcmFuZG9tJyxcbiAgICAgIHNpbmdsZTogJ2ZhLXJlZG8tYWx0JyxcbiAgICAgIHN0b3A6ICdmYS1jYW5jZWwnLFxuICAgIH07XG4gICAgJCgnI2F1ZGlvX2FtYmllbnRfbW9kZV9pY29uJykucmVtb3ZlQ2xhc3MoJ2ZhLXJlcGVhdCBmYS1yYW5kb20gZmEtcmVkby1hbHQgZmEtY2FuY2VsJyk7XG4gICAgJCgnI2F1ZGlvX2FtYmllbnRfbW9kZV9pY29uJykuYWRkQ2xhc3MoaWNvbk1hcFttb2RlXSk7XG4gIH1cblxuICBzYXZlU2V0dGluZ3NEZWJvdW5jZWQoKTtcbiAgcmV0dXJuICcnO1xufVxuXG4vKipcbiAqIOWIh+aNouaSreaUvuWZqOW8gOWFs+eKtuaAgVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXVkaW9FbmFibGUoYXJnczogeyB0eXBlOiBzdHJpbmc7IHN0YXRlPzogc3RyaW5nIH0pOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgdHlwZSA9IGFyZ3MudHlwZS50b0xvd2VyQ2FzZSgpO1xuICBjb25zdCBzdGF0ZSA9IChhcmdzLnN0YXRlIHx8ICd0cnVlJykudG9Mb3dlckNhc2UoKTtcblxuICBpZiAoIXR5cGUpIHtcbiAgICBsb2cud2FybignV0FSTjogTWlzc2luZyBhcmd1bWVudHMgZm9yIC9hdWRpb2VuYWJsZSBjb21tYW5kJyk7XG4gICAgcmV0dXJuICcnO1xuICB9XG5cbiAgaWYgKHR5cGUgPT09ICdiZ20nKSB7XG4gICAgaWYgKHN0YXRlID09PSAndHJ1ZScpIHtcbiAgICAgICQoJyNlbmFibGVfYmdtJykucHJvcCgnY2hlY2tlZCcsIHRydWUpO1xuICAgICAgYXdhaXQgb25BdWRpb0VuYWJsZWRDbGljaygnYmdtJyk7XG4gICAgfSBlbHNlIGlmIChzdGF0ZSA9PT0gJ2ZhbHNlJykge1xuICAgICAgJCgnI2VuYWJsZV9iZ20nKS5wcm9wKCdjaGVja2VkJywgZmFsc2UpO1xuICAgICAgYXdhaXQgb25BdWRpb0VuYWJsZWRDbGljaygnYmdtJyk7XG4gICAgfVxuICB9IGVsc2UgaWYgKHR5cGUgPT09ICdhbWJpZW50Jykge1xuICAgIGlmIChzdGF0ZSA9PT0gJ3RydWUnKSB7XG4gICAgICAkKCcjZW5hYmxlX2FtYmllbnQnKS5wcm9wKCdjaGVja2VkJywgdHJ1ZSk7XG4gICAgICBhd2FpdCBvbkF1ZGlvRW5hYmxlZENsaWNrKCdhbWJpZW50Jyk7XG4gICAgfSBlbHNlIGlmIChzdGF0ZSA9PT0gJ2ZhbHNlJykge1xuICAgICAgJCgnI2VuYWJsZV9hbWJpZW50JykucHJvcCgnY2hlY2tlZCcsIGZhbHNlKTtcbiAgICAgIGF3YWl0IG9uQXVkaW9FbmFibGVkQ2xpY2soJ2FtYmllbnQnKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gJyc7XG59XG5cbi8qKlxuICog5YiH5o2i5pKt5pS+L+aaguWBnOeKtuaAgVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXVkaW9QbGF5KGFyZ3M6IHsgdHlwZTogc3RyaW5nOyBwbGF5Pzogc3RyaW5nIH0pOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgdHlwZSA9IGFyZ3MudHlwZS50b0xvd2VyQ2FzZSgpO1xuICBjb25zdCBwbGF5ID0gKGFyZ3MucGxheSB8fCAndHJ1ZScpLnRvTG93ZXJDYXNlKCk7XG5cbiAgaWYgKCF0eXBlKSB7XG4gICAgbG9nLndhcm4oJ1dBUk46IE1pc3NpbmcgYXJndW1lbnRzIGZvciAvYXVkaW9wbGF5cGF1c2UgY29tbWFuZCcpO1xuICAgIHJldHVybiAnJztcbiAgfVxuXG4gIGlmICh0eXBlID09PSAnYmdtJykge1xuICAgIGlmIChwbGF5ID09PSAndHJ1ZScpIHtcbiAgICAgIGF3YWl0IHBsYXlBdWRpbygnYmdtJyk7XG4gICAgfSBlbHNlIGlmIChwbGF5ID09PSAnZmFsc2UnKSB7XG4gICAgICBjb25zdCBhdWRpb0VsZW1lbnQgPSAkKCcjYXVkaW9fYmdtJylbMF0gYXMgQXVkaW9FbGVtZW50O1xuICAgICAgYXVkaW9FbGVtZW50LnBhdXNlKCk7XG4gICAgfVxuICB9IGVsc2UgaWYgKHR5cGUgPT09ICdhbWJpZW50Jykge1xuICAgIGlmIChwbGF5ID09PSAndHJ1ZScpIHtcbiAgICAgIGF3YWl0IHBsYXlBdWRpbygnYW1iaWVudCcpO1xuICAgIH0gZWxzZSBpZiAocGxheSA9PT0gJ2ZhbHNlJykge1xuICAgICAgY29uc3QgYXVkaW9FbGVtZW50ID0gJCgnI2F1ZGlvX2FtYmllbnQnKVswXSBhcyBBdWRpb0VsZW1lbnQ7XG4gICAgICBhdWRpb0VsZW1lbnQucGF1c2UoKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gJyc7XG59XG5cbi8qKlxuICog5a+85YWl6Z+z6aKR6ZO+5o6lXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhdWRpb0ltcG9ydChhcmdzOiB7IHR5cGU6IHN0cmluZzsgcGxheT86IHN0cmluZyB9LCB1cmw6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCB0eXBlID0gYXJncy50eXBlLnRvTG93ZXJDYXNlKCk7XG4gIGNvbnN0IHBsYXkgPSAoYXJncy5wbGF5IHx8ICd0cnVlJykudG9Mb3dlckNhc2UoKTtcblxuICBpZiAoIXR5cGUgfHwgIXVybCkge1xuICAgIGxvZy53YXJuKCdXQVJOOiBNaXNzaW5nIGFyZ3VtZW50cyBmb3IgL2F1ZGlvaW1wb3J0IGNvbW1hbmQnKTtcbiAgICByZXR1cm4gJyc7XG4gIH1cblxuICBjb25zdCB1cmxBcnJheSA9IHVybFxuICAgIC5zcGxpdCgnLCcpXG4gICAgLm1hcCgodXJsOiBzdHJpbmcpID0+IHVybC50cmltKCkpXG4gICAgLmZpbHRlcigodXJsOiBzdHJpbmcpID0+IHVybCAhPT0gJycpXG4gICAgLmZpbHRlcigodXJsOiBzdHJpbmcsIGluZGV4OiBudW1iZXIsIHNlbGY6IHN0cmluZ1tdKSA9PiBzZWxmLmluZGV4T2YodXJsKSA9PT0gaW5kZXgpO1xuICBpZiAodXJsQXJyYXkubGVuZ3RoID09PSAwKSB7XG4gICAgbG9nLndhcm4oJ1dBUk46IEludmFsaWQgb3IgZW1wdHkgVVJMcyBwcm92aWRlZC4nKTtcbiAgICByZXR1cm4gJyc7XG4gIH1cblxuICBpZiAoIWNoYXRfbWV0YWRhdGEudmFyaWFibGVzKSB7XG4gICAgY2hhdF9tZXRhZGF0YS52YXJpYWJsZXMgPSB7fTtcbiAgfVxuXG4gIGNvbnN0IHR5cGVLZXkgPSB0eXBlID09PSAnYmdtJyA/ICdiZ211cmwnIDogJ2FtYmllbnR1cmwnO1xuICBjb25zdCBleGlzdGluZ1VybHMgPSBjaGF0X21ldGFkYXRhLnZhcmlhYmxlc1t0eXBlS2V5XSB8fCBbXTtcbiAgY29uc3QgbWVyZ2VkVXJscyA9IFsuLi5uZXcgU2V0KFsuLi51cmxBcnJheSwgLi4uZXhpc3RpbmdVcmxzXSldO1xuXG4gIGNoYXRfbWV0YWRhdGEudmFyaWFibGVzW3R5cGVLZXldID0gbWVyZ2VkVXJscztcbiAgc2F2ZU1ldGFkYXRhRGVib3VuY2VkKCk7XG5cbiAgaWYgKHR5cGUgPT09ICdiZ20nKSB7XG4gICAgdXBkYXRlQXVkaW9TZWxlY3QoJ2JnbScpO1xuICB9IGVsc2UgaWYgKHR5cGUgPT09ICdhbWJpZW50Jykge1xuICAgIHVwZGF0ZUF1ZGlvU2VsZWN0KCdhbWJpZW50Jyk7XG4gIH1cblxuICBpZiAocGxheSA9PT0gJ3RydWUnICYmIHVybEFycmF5WzBdKSB7XG4gICAgY29uc3Qgc2VsZWN0ZWRVcmwgPSB1cmxBcnJheVswXTtcbiAgICBpZiAodHlwZSA9PT0gJ2JnbScpIHtcbiAgICAgIHNhdmVTZXR0aW5nVmFsdWUoJ2F1ZGlvLmJnbV9zZWxlY3RlZCcsIHNlbGVjdGVkVXJsKTtcbiAgICAgIGF3YWl0IHVwZGF0ZUF1ZGlvKCdiZ20nLCB0cnVlKTtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdhbWJpZW50Jykge1xuICAgICAgc2F2ZVNldHRpbmdWYWx1ZSgnYXVkaW8uYW1iaWVudF9zZWxlY3RlZCcsIHNlbGVjdGVkVXJsKTtcbiAgICAgIGF3YWl0IHVwZGF0ZUF1ZGlvKCdhbWJpZW50JywgdHJ1ZSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuICcnO1xufVxuXG4vKipcbiAqIOmAieaLqeW5tuaSreaUvumfs+mikVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXVkaW9TZWxlY3QoYXJnczogeyB0eXBlOiBzdHJpbmcgfSwgdXJsOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgdHlwZSA9IGFyZ3MudHlwZS50b0xvd2VyQ2FzZSgpO1xuXG4gIGlmICghdXJsKSB7XG4gICAgbG9nLndhcm4oJ1dBUk46IE1pc3NpbmcgVVJMIGZvciAvYXVkaW9zZWxlY3QgY29tbWFuZCcpO1xuICAgIHJldHVybiAnJztcbiAgfVxuXG4gIGlmICghY2hhdF9tZXRhZGF0YS52YXJpYWJsZXMpIHtcbiAgICBjaGF0X21ldGFkYXRhLnZhcmlhYmxlcyA9IHt9O1xuICB9XG5cbiAgY29uc3QgcGxheWxpc3QgPSB0eXBlID09PSAnYmdtJyA/IGxpc3RfQkdNUyA6IGxpc3RfYW1iaWVudHM7XG4gIGNvbnN0IHR5cGVLZXkgPSB0eXBlID09PSAnYmdtJyA/ICdiZ211cmwnIDogJ2FtYmllbnR1cmwnO1xuXG4gIGlmIChwbGF5bGlzdCAmJiBwbGF5bGlzdC5pbmNsdWRlcyh1cmwpKSB7XG4gICAgaWYgKHR5cGUgPT09ICdiZ20nKSB7XG4gICAgICBzYXZlU2V0dGluZ1ZhbHVlKCdhdWRpby5iZ21fc2VsZWN0ZWQnLCB1cmwpO1xuICAgICAgYXdhaXQgdXBkYXRlQXVkaW8oJ2JnbScsIHRydWUpO1xuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ2FtYmllbnQnKSB7XG4gICAgICBzYXZlU2V0dGluZ1ZhbHVlKCdhdWRpby5hbWJpZW50X3NlbGVjdGVkJywgdXJsKTtcbiAgICAgIGF3YWl0IHVwZGF0ZUF1ZGlvKCdhbWJpZW50JywgdHJ1ZSk7XG4gICAgfVxuICAgIHJldHVybiAnJztcbiAgfVxuXG4gIGNvbnN0IGV4aXN0aW5nVXJscyA9IGNoYXRfbWV0YWRhdGEudmFyaWFibGVzW3R5cGVLZXldIHx8IFtdO1xuXG4gIGNvbnN0IG1lcmdlZFVybHMgPSBbLi4ubmV3IFNldChbdXJsLCAuLi5leGlzdGluZ1VybHNdKV07XG4gIGNoYXRfbWV0YWRhdGEudmFyaWFibGVzW3R5cGVLZXldID0gbWVyZ2VkVXJscztcbiAgc2F2ZU1ldGFkYXRhRGVib3VuY2VkKCk7XG5cbiAgaWYgKHR5cGUgPT09ICdiZ20nKSB7XG4gICAgdXBkYXRlQXVkaW9TZWxlY3QoJ2JnbScpO1xuICAgIHNhdmVTZXR0aW5nVmFsdWUoJ2F1ZGlvLmJnbV9zZWxlY3RlZCcsIHVybCk7XG4gICAgYXdhaXQgdXBkYXRlQXVkaW8oJ2JnbScsIHRydWUpO1xuICB9IGVsc2UgaWYgKHR5cGUgPT09ICdhbWJpZW50Jykge1xuICAgIHVwZGF0ZUF1ZGlvU2VsZWN0KCdhbWJpZW50Jyk7XG4gICAgc2F2ZVNldHRpbmdWYWx1ZSgnYXVkaW8uYW1iaWVudF9zZWxlY3RlZCcsIHVybCk7XG4gICAgYXdhaXQgdXBkYXRlQXVkaW8oJ2FtYmllbnQnLCB0cnVlKTtcbiAgfVxuXG4gIHJldHVybiAnJztcbn1cblxuLyoqXG4gKiDliJ3lp4vljJbpn7PpopHnm7jlhbPnmoQgc2xhc2ggY29tbWFuZFxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5pdEF1ZGlvU2xhc2hDb21tYW5kcygpIHtcbiAgLy8g5rOo5YaMIGF1ZGlvc2VsZWN0IOWRveS7pFxuICBTbGFzaENvbW1hbmRQYXJzZXIuYWRkQ29tbWFuZE9iamVjdChcbiAgICBTbGFzaENvbW1hbmQuZnJvbVByb3BzKHtcbiAgICAgIG5hbWU6ICdhdWRpb3NlbGVjdCcsXG4gICAgICBjYWxsYmFjazogYXVkaW9TZWxlY3QsXG4gICAgICBuYW1lZEFyZ3VtZW50TGlzdDogW1xuICAgICAgICBTbGFzaENvbW1hbmROYW1lZEFyZ3VtZW50LmZyb21Qcm9wcyh7XG4gICAgICAgICAgbmFtZTogJ3R5cGUnLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAn6YCJ5oup5pKt5pS+5Zmo57G75Z6LIChiZ20g5oiWIGFtYmllbnQpJyxcbiAgICAgICAgICB0eXBlTGlzdDogW0FSR1VNRU5UX1RZUEUuU1RSSU5HXSxcbiAgICAgICAgICBlbnVtTGlzdDogW1xuICAgICAgICAgICAgbmV3IFNsYXNoQ29tbWFuZEVudW1WYWx1ZSgnYmdtJywgbnVsbCwgZW51bVR5cGVzLmVudW0sIGVudW1JY29ucy5maWxlKSxcbiAgICAgICAgICAgIG5ldyBTbGFzaENvbW1hbmRFbnVtVmFsdWUoJ2FtYmllbnQnLCBudWxsLCBlbnVtVHlwZXMuZW51bSwgZW51bUljb25zLmZpbGUpLFxuICAgICAgICAgIF0sXG4gICAgICAgICAgaXNSZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgfSksXG4gICAgICBdLFxuICAgICAgdW5uYW1lZEFyZ3VtZW50TGlzdDogW25ldyBTbGFzaENvbW1hbmRBcmd1bWVudCgndXJsJywgW0FSR1VNRU5UX1RZUEUuU1RSSU5HXSwgdHJ1ZSldLFxuICAgICAgaGVscFN0cmluZzogYFxuICAgICAgICA8ZGl2PlxuICAgICAgICAgICAg6YCJ5oup5bm25pKt5pS+6Z+z6aKR44CC5aaC5p6c6Z+z6aKR6ZO+5o6l5LiN5a2Y5Zyo77yM5YiZ5YWI5a+85YWl5YaN5pKt5pS+44CCXG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgPHN0cm9uZz5FeGFtcGxlOjwvc3Ryb25nPlxuICAgICAgICAgICAgPHVsPlxuICAgICAgICAgICAgICAgIDxsaT5cbiAgICAgICAgICAgICAgICAgICAgPHByZT48Y29kZT4vYXVkaW9zZWxlY3QgdHlwZT1iZ20gaHR0cHM6Ly9leGFtcGxlLmNvbS9zb25nLm1wMzwvY29kZT48L3ByZT5cbiAgICAgICAgICAgICAgICAgICAg6YCJ5oup5bm25pKt5pS+5oyH5a6a55qE6Z+z5LmQ44CCXG4gICAgICAgICAgICAgICAgPC9saT5cbiAgICAgICAgICAgICAgICA8bGk+XG4gICAgICAgICAgICAgICAgICAgIDxwcmU+PGNvZGU+L2F1ZGlvc2VsZWN0IHR5cGU9YW1iaWVudCBodHRwczovL2V4YW1wbGUuY29tL3NvdW5kLm1wMzwvY29kZT48L3ByZT5cbiAgICAgICAgICAgICAgICAgICAg6YCJ5oup5bm25pKt5pS+5oyH5a6a55qE6Z+z5pWI44CCXG4gICAgICAgICAgICAgICAgPC9saT5cbiAgICAgICAgICAgIDwvdWw+XG4gICAgICAgIDwvZGl2PlxuICAgICAgYCxcbiAgICB9KSxcbiAgKTtcblxuICAvLyDms6jlhowgYXVkaW9pbXBvcnQg5ZG95LukXG4gIFNsYXNoQ29tbWFuZFBhcnNlci5hZGRDb21tYW5kT2JqZWN0KFxuICAgIFNsYXNoQ29tbWFuZC5mcm9tUHJvcHMoe1xuICAgICAgbmFtZTogJ2F1ZGlvaW1wb3J0JyxcbiAgICAgIGNhbGxiYWNrOiBhdWRpb0ltcG9ydCxcbiAgICAgIG5hbWVkQXJndW1lbnRMaXN0OiBbXG4gICAgICAgIFNsYXNoQ29tbWFuZE5hbWVkQXJndW1lbnQuZnJvbVByb3BzKHtcbiAgICAgICAgICBuYW1lOiAndHlwZScsXG4gICAgICAgICAgZGVzY3JpcHRpb246ICfpgInmi6nlr7zlhaXnsbvlnosgKGJnbSDmiJYgYW1iaWVudCknLFxuICAgICAgICAgIHR5cGVMaXN0OiBbQVJHVU1FTlRfVFlQRS5TVFJJTkddLFxuICAgICAgICAgIGVudW1MaXN0OiBbXG4gICAgICAgICAgICBuZXcgU2xhc2hDb21tYW5kRW51bVZhbHVlKCdiZ20nLCBudWxsLCBlbnVtVHlwZXMuZW51bSwgZW51bUljb25zLmZpbGUpLFxuICAgICAgICAgICAgbmV3IFNsYXNoQ29tbWFuZEVudW1WYWx1ZSgnYW1iaWVudCcsIG51bGwsIGVudW1UeXBlcy5lbnVtLCBlbnVtSWNvbnMuZmlsZSksXG4gICAgICAgICAgXSxcbiAgICAgICAgICBpc1JlcXVpcmVkOiB0cnVlLFxuICAgICAgICB9KSxcbiAgICAgICAgU2xhc2hDb21tYW5kTmFtZWRBcmd1bWVudC5mcm9tUHJvcHMoe1xuICAgICAgICAgIG5hbWU6ICdwbGF5JyxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogJ+WvvOWFpeWQjuaYr+WQpueri+WNs+aSreaUvuesrOS4gOS4qumTvuaOpScsXG4gICAgICAgICAgdHlwZUxpc3Q6IFtBUkdVTUVOVF9UWVBFLkJPT0xFQU5dLFxuICAgICAgICAgIGRlZmF1bHRWYWx1ZTogJ3RydWUnLFxuICAgICAgICAgIGlzUmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICB9KSxcbiAgICAgIF0sXG4gICAgICB1bm5hbWVkQXJndW1lbnRMaXN0OiBbbmV3IFNsYXNoQ29tbWFuZEFyZ3VtZW50KCd1cmwnLCBbQVJHVU1FTlRfVFlQRS5TVFJJTkddLCB0cnVlKV0sXG4gICAgICBoZWxwU3RyaW5nOiBgXG4gICAgICAgIDxkaXY+XG4gICAgICAgICAgICDlr7zlhaXpn7PpopHmiJbpn7PkuZDpk77mjqXvvIzlubblhrPlrprmmK/lkKbnq4vljbPmkq3mlL7vvIzpu5jorqTkuLroh6rliqjmkq3mlL7jgILlj6/mibnph4/lr7zlhaXpk77mjqXvvIzkvb/nlKjoi7HmlofpgJflj7fliIbpmpTjgIJcbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXY+XG4gICAgICAgICAgICA8c3Ryb25nPkV4YW1wbGU6PC9zdHJvbmc+XG4gICAgICAgICAgICA8dWw+XG4gICAgICAgICAgICAgICAgPGxpPlxuICAgICAgICAgICAgICAgICAgICA8cHJlPjxjb2RlPi9hdWRpb2ltcG9ydCB0eXBlPWJnbSBodHRwczovL2V4YW1wbGUuY29tL3NvbmcxLm1wMyxodHRwczovL2V4YW1wbGUuY29tL3NvbmcyLm1wMzwvY29kZT48L3ByZT5cbiAgICAgICAgICAgICAgICAgICAg5a+85YWlIEJHTSDpn7PkuZDlubbnq4vljbPmkq3mlL7nrKzkuIDkuKrpk77mjqXjgIJcbiAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgICAgIDxsaT5cbiAgICAgICAgICAgICAgICAgICAgPHByZT48Y29kZT4vYXVkaW9pbXBvcnQgdHlwZT1hbWJpZW50IHBsYXk9ZmFsc2UgdXJsPWh0dHBzOi8vZXhhbXBsZS5jb20vc291bmQxLm1wMyxodHRwczovL2V4YW1wbGUuY29tL3NvdW5kMi5tcDMgPC9jb2RlPjwvcHJlPlxuICAgICAgICAgICAgICAgICAgICDlr7zlhaXpn7PmlYjpk77mjqUgKOS4jeiHquWKqOaSreaUvinjgIJcbiAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgPC91bD5cbiAgICAgICAgPC9kaXY+XG4gICAgICBgLFxuICAgIH0pLFxuICApO1xuXG4gIC8vIOazqOWGjCBhdWRpb3BsYXkg5ZG95LukXG4gIFNsYXNoQ29tbWFuZFBhcnNlci5hZGRDb21tYW5kT2JqZWN0KFxuICAgIFNsYXNoQ29tbWFuZC5mcm9tUHJvcHMoe1xuICAgICAgbmFtZTogJ2F1ZGlvcGxheScsXG4gICAgICBjYWxsYmFjazogYXVkaW9QbGF5LFxuICAgICAgbmFtZWRBcmd1bWVudExpc3Q6IFtcbiAgICAgICAgU2xhc2hDb21tYW5kTmFtZWRBcmd1bWVudC5mcm9tUHJvcHMoe1xuICAgICAgICAgIG5hbWU6ICd0eXBlJyxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogJ+mAieaLqeaOp+WItueahOaSreaUvuWZqCAoYmdtIOaIliBhbWJpZW50KScsXG4gICAgICAgICAgdHlwZUxpc3Q6IFtBUkdVTUVOVF9UWVBFLlNUUklOR10sXG4gICAgICAgICAgZW51bUxpc3Q6IFtcbiAgICAgICAgICAgIG5ldyBTbGFzaENvbW1hbmRFbnVtVmFsdWUoJ2JnbScsIG51bGwsIGVudW1UeXBlcy5lbnVtLCBlbnVtSWNvbnMuZmlsZSksXG4gICAgICAgICAgICBuZXcgU2xhc2hDb21tYW5kRW51bVZhbHVlKCdhbWJpZW50JywgbnVsbCwgZW51bVR5cGVzLmVudW0sIGVudW1JY29ucy5maWxlKSxcbiAgICAgICAgICBdLFxuICAgICAgICAgIGlzUmVxdWlyZWQ6IHRydWUsXG4gICAgICAgIH0pLFxuICAgICAgICBuZXcgU2xhc2hDb21tYW5kTmFtZWRBcmd1bWVudChcbiAgICAgICAgICAncGxheScsXG4gICAgICAgICAgJ+aSreaUvuaIluaaguWBnCcsXG4gICAgICAgICAgW0FSR1VNRU5UX1RZUEUuU1RSSU5HXSxcbiAgICAgICAgICB0cnVlLFxuICAgICAgICAgIGZhbHNlLFxuICAgICAgICAgICd0cnVlJyxcbiAgICAgICAgICBjb21tb25FbnVtUHJvdmlkZXJzLmJvb2xlYW4oJ3RydWVGYWxzZScpKCksXG4gICAgICAgICksXG4gICAgICBdLFxuICAgICAgaGVscFN0cmluZzogYFxuICAgICAgICA8ZGl2PlxuICAgICAgICAgICAg5o6n5Yi26Z+z5LmQ5pKt5pS+5Zmo5oiW6Z+z5pWI5pKt5pS+5Zmo55qE5pKt5pS+5LiO5pqC5YGc44CCXG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgPHN0cm9uZz5FeGFtcGxlOjwvc3Ryb25nPlxuICAgICAgICAgICAgPHVsPlxuICAgICAgICAgICAgICAgIDxsaT5cbiAgICAgICAgICAgICAgICAgICAgPHByZT48Y29kZT4vYXVkaW9wbGF5IHR5cGU9YmdtPC9jb2RlPjwvcHJlPlxuICAgICAgICAgICAgICAgICAgICDmkq3mlL7lvZPliY3pn7PkuZDjgIJcbiAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgICAgIDxsaT5cbiAgICAgICAgICAgICAgICAgICAgPHByZT48Y29kZT4vYXVkaW9wbGF5IHR5cGU9YW1iaWVudCBwbGF5PWZhbHNlPC9jb2RlPjwvcHJlPlxuICAgICAgICAgICAgICAgICAgICDmmoLlgZzlvZPliY3pn7PmlYjjgIJcbiAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgPC91bD5cbiAgICAgICAgPC9kaXY+XG4gICAgICBgLFxuICAgIH0pLFxuICApO1xuXG4gIC8vIOazqOWGjCBhdWRpb2VuYWJsZSDlkb3ku6RcbiAgU2xhc2hDb21tYW5kUGFyc2VyLmFkZENvbW1hbmRPYmplY3QoXG4gICAgU2xhc2hDb21tYW5kLmZyb21Qcm9wcyh7XG4gICAgICBuYW1lOiAnYXVkaW9lbmFibGUnLFxuICAgICAgY2FsbGJhY2s6IGF1ZGlvRW5hYmxlLFxuICAgICAgbmFtZWRBcmd1bWVudExpc3Q6IFtcbiAgICAgICAgU2xhc2hDb21tYW5kTmFtZWRBcmd1bWVudC5mcm9tUHJvcHMoe1xuICAgICAgICAgIG5hbWU6ICd0eXBlJyxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogJ+mAieaLqeaOp+WItueahOaSreaUvuWZqCAoYmdtIOaIliBhbWJpZW50KScsXG4gICAgICAgICAgdHlwZUxpc3Q6IFtBUkdVTUVOVF9UWVBFLlNUUklOR10sXG4gICAgICAgICAgZW51bUxpc3Q6IFtcbiAgICAgICAgICAgIG5ldyBTbGFzaENvbW1hbmRFbnVtVmFsdWUoJ2JnbScsIG51bGwsIGVudW1UeXBlcy5lbnVtLCBlbnVtSWNvbnMuZmlsZSksXG4gICAgICAgICAgICBuZXcgU2xhc2hDb21tYW5kRW51bVZhbHVlKCdhbWJpZW50JywgbnVsbCwgZW51bVR5cGVzLmVudW0sIGVudW1JY29ucy5maWxlKSxcbiAgICAgICAgICBdLFxuICAgICAgICAgIGlzUmVxdWlyZWQ6IHRydWUsXG4gICAgICAgIH0pLFxuICAgICAgICBuZXcgU2xhc2hDb21tYW5kTmFtZWRBcmd1bWVudChcbiAgICAgICAgICAnc3RhdGUnLFxuICAgICAgICAgICfmiZPlvIDmiJblhbPpl63mkq3mlL7lmagnLFxuICAgICAgICAgIFtBUkdVTUVOVF9UWVBFLlNUUklOR10sXG4gICAgICAgICAgZmFsc2UsXG4gICAgICAgICAgZmFsc2UsXG4gICAgICAgICAgJ3RydWUnLFxuICAgICAgICAgIGNvbW1vbkVudW1Qcm92aWRlcnMuYm9vbGVhbigndHJ1ZUZhbHNlJykoKSxcbiAgICAgICAgKSxcbiAgICAgIF0sXG4gICAgICBoZWxwU3RyaW5nOiBgXG4gICAgICAgIDxkaXY+XG4gICAgICAgICAgICDmjqfliLbpn7PkuZDmkq3mlL7lmajmiJbpn7PmlYjmkq3mlL7lmajnmoTlvIDlkK/kuI7lhbPpl63jgIJcbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXY+XG4gICAgICAgICAgICA8c3Ryb25nPkV4YW1wbGU6PC9zdHJvbmc+XG4gICAgICAgICAgICA8dWw+XG4gICAgICAgICAgICAgICAgPGxpPlxuICAgICAgICAgICAgICAgICAgICA8cHJlPjxjb2RlPi9hdWRpb2VuYWJsZSB0eXBlPWJnbSBzdGF0ZT10cnVlPC9jb2RlPjwvcHJlPlxuICAgICAgICAgICAgICAgICAgICDmiZPlvIDpn7PkuZDmkq3mlL7lmajjgIJcbiAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgICAgIDxsaT5cbiAgICAgICAgICAgICAgICAgICAgPHByZT48Y29kZT4vYXVkaW9lbmFibGUgdHlwZT1hbWJpZW50IHN0YXRlPWZhbHNlPC9jb2RlPjwvcHJlPlxuICAgICAgICAgICAgICAgICAgICDlhbPpl63pn7PmlYjmkq3mlL7lmajjgIJcbiAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgPC91bD5cbiAgICAgICAgPC9kaXY+XG4gICAgYCxcbiAgICB9KSxcbiAgKTtcblxuICAvLyDms6jlhowgYXVkaW9tb2RlIOWRveS7pFxuICBTbGFzaENvbW1hbmRQYXJzZXIuYWRkQ29tbWFuZE9iamVjdChcbiAgICBTbGFzaENvbW1hbmQuZnJvbVByb3BzKHtcbiAgICAgIG5hbWU6ICdhdWRpb21vZGUnLFxuICAgICAgY2FsbGJhY2s6IGF1ZGlvTW9kZSxcbiAgICAgIG5hbWVkQXJndW1lbnRMaXN0OiBbXG4gICAgICAgIFNsYXNoQ29tbWFuZE5hbWVkQXJndW1lbnQuZnJvbVByb3BzKHtcbiAgICAgICAgICBuYW1lOiAndHlwZScsXG4gICAgICAgICAgZGVzY3JpcHRpb246ICfpgInmi6nmjqfliLbnmoTmkq3mlL7lmaggKGJnbSDmiJYgYW1iaWVudCknLFxuICAgICAgICAgIHR5cGVMaXN0OiBbQVJHVU1FTlRfVFlQRS5TVFJJTkddLFxuICAgICAgICAgIGVudW1MaXN0OiBbXG4gICAgICAgICAgICBuZXcgU2xhc2hDb21tYW5kRW51bVZhbHVlKCdiZ20nLCBudWxsLCBlbnVtVHlwZXMuZW51bSwgZW51bUljb25zLmZpbGUpLFxuICAgICAgICAgICAgbmV3IFNsYXNoQ29tbWFuZEVudW1WYWx1ZSgnYW1iaWVudCcsIG51bGwsIGVudW1UeXBlcy5lbnVtLCBlbnVtSWNvbnMuZmlsZSksXG4gICAgICAgICAgXSxcbiAgICAgICAgICBpc1JlcXVpcmVkOiB0cnVlLFxuICAgICAgICB9KSxcbiAgICAgICAgU2xhc2hDb21tYW5kTmFtZWRBcmd1bWVudC5mcm9tUHJvcHMoe1xuICAgICAgICAgIG5hbWU6ICdtb2RlJyxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogJ+mAieaLqeaSreaUvuaooeW8jycsXG4gICAgICAgICAgdHlwZUxpc3Q6IFtBUkdVTUVOVF9UWVBFLlNUUklOR10sXG4gICAgICAgICAgZW51bUxpc3Q6IFtcbiAgICAgICAgICAgIG5ldyBTbGFzaENvbW1hbmRFbnVtVmFsdWUoJ3JlcGVhdCcsIG51bGwsIGVudW1UeXBlcy5lbnVtLCBlbnVtSWNvbnMubG9vcCksXG4gICAgICAgICAgICBuZXcgU2xhc2hDb21tYW5kRW51bVZhbHVlKCdyYW5kb20nLCBudWxsLCBlbnVtVHlwZXMuZW51bSwgZW51bUljb25zLnNodWZmbGUpLFxuICAgICAgICAgICAgbmV3IFNsYXNoQ29tbWFuZEVudW1WYWx1ZSgnc2luZ2xlJywgbnVsbCwgZW51bVR5cGVzLmVudW0sIGVudW1JY29ucy5yZWRvKSxcbiAgICAgICAgICAgIG5ldyBTbGFzaENvbW1hbmRFbnVtVmFsdWUoJ3N0b3AnLCBudWxsLCBlbnVtVHlwZXMuZW51bSwgZW51bUljb25zLnN0b3ApLFxuICAgICAgICAgIF0sXG4gICAgICAgICAgaXNSZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgfSksXG4gICAgICBdLFxuICAgICAgaGVscFN0cmluZzogYFxuICAgICAgICA8ZGl2PlxuICAgICAgICAgICAg6K6+572u6Z+z6aKR5pKt5pS+5qih5byP44CCXG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgPHN0cm9uZz5FeGFtcGxlOjwvc3Ryb25nPlxuICAgICAgICAgICAgPHVsPlxuICAgICAgICAgICAgICAgIDxsaT5cbiAgICAgICAgICAgICAgICAgICAgPHByZT48Y29kZT4vYXVkaW9tb2RlIHR5cGU9YmdtIG1vZGU9cmVwZWF0PC9jb2RlPjwvcHJlPlxuICAgICAgICAgICAgICAgICAgICDorr7nva7pn7PkuZDkuLrlvqrnjq/mkq3mlL7mqKHlvI/jgIJcbiAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgICAgIDxsaT5cbiAgICAgICAgICAgICAgICAgICAgPHByZT48Y29kZT4vYXVkaW9tb2RlIHR5cGU9YW1iaWVudCBtb2RlPXJhbmRvbTwvY29kZT48L3ByZT5cbiAgICAgICAgICAgICAgICAgICAg6K6+572u6Z+z5pWI5Li66ZqP5py65pKt5pS+5qih5byP44CCXG4gICAgICAgICAgICAgICAgPC9saT5cbiAgICAgICAgICAgICAgICA8bGk+XG4gICAgICAgICAgICAgICAgICAgIDxwcmU+PGNvZGU+L2F1ZGlvbW9kZSB0eXBlPWJnbSBtb2RlPXNpbmdsZTwvY29kZT48L3ByZT5cbiAgICAgICAgICAgICAgICAgICAg6K6+572u6Z+z5LmQ5Li65Y2V5puy5b6q546v5qih5byP44CCXG4gICAgICAgICAgICAgICAgPC9saT5cbiAgICAgICAgICAgICAgICA8bGk+XG4gICAgICAgICAgICAgICAgICAgIDxwcmU+PGNvZGU+L2F1ZGlvbW9kZSB0eXBlPWFtYmllbnQgbW9kZT1zdG9wPC9jb2RlPjwvcHJlPlxuICAgICAgICAgICAgICAgICAgICDorr7nva7pn7PmlYjkuLrlgZzmraLmkq3mlL7mqKHlvI/jgIJcbiAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgPC91bD5cbiAgICAgICAgPC9kaXY+XG4gICAgYCxcbiAgICB9KSxcbiAgKTtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/slash_command/audio.ts\n\n}")},"./src/slash_command/event.ts":
/*!************************************!*\
  !*** ./src/slash_command/event.ts ***!
  \************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   initSlashEventEmit: () => (/* binding */ initSlashEventEmit),\n/* harmony export */   slashEventEmit: () => (/* binding */ slashEventEmit)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ "@sillytavern/script");\n/* harmony import */ var _sillytavern_scripts_slash_commands_SlashCommand__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/slash-commands/SlashCommand */ "@sillytavern/scripts/slash-commands/SlashCommand");\n/* harmony import */ var _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/scripts/slash-commands/SlashCommandArgument */ "@sillytavern/scripts/slash-commands/SlashCommandArgument");\n/* harmony import */ var _sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/scripts/slash-commands/SlashCommandParser */ "@sillytavern/scripts/slash-commands/SlashCommandParser");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! loglevel */ "./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_4__);\n\n\n\n\n\nasync function slashEventEmit(named_args) {\n    const event = named_args.event;\n    const data = named_args.data ?? [];\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.emit(event, ...data);\n    loglevel__WEBPACK_IMPORTED_MODULE_4___default().info(`[Event][/event-emit] 发送 \'${event}\' 事件, 携带数据: ${JSON.stringify(data)}`);\n    return event;\n}\nfunction initSlashEventEmit() {\n    _sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_3__.SlashCommandParser.addCommandObject(_sillytavern_scripts_slash_commands_SlashCommand__WEBPACK_IMPORTED_MODULE_1__.SlashCommand.fromProps({\n        name: \'event-emit\',\n        callback: slashEventEmit,\n        returns: \'发送的事件名称\',\n        namedArgumentList: [\n            _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_2__.SlashCommandNamedArgument.fromProps({\n                name: \'event\',\n                description: \'事件名称\',\n                typeList: [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_2__.ARGUMENT_TYPE.STRING],\n                isRequired: true,\n            }),\n            _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_2__.SlashCommandNamedArgument.fromProps({\n                name: \'data\',\n                description: \'要传输的数据\',\n                typeList: [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_2__.ARGUMENT_TYPE.STRING],\n                isRequired: false,\n                acceptsMultiple: true,\n            }),\n        ],\n        unnamedArgumentList: [],\n        helpString: `\n    <div>\n        发送 \\`event\\` 事件, 同时可以发送一些数据.\n        所有正在监听该消息频道的 listener 函数都会自动运行, 并能用函数参数接收发送来的数据.\n        由于酒馆 STScript 输入方式的局限性, 所有数据将会以字符串 string 类型接收; 如果需要 number 等类型, 请自行转换.\n    </div>\n    <div>\n        <strong>Example:</strong>\n        <ul>\n            <li>\n                <pre><code class="language-stscript">/event-emit event="读档"</code></pre>\n            </li>\n            <li>\n                <pre><code class="language-stscript">/event-emit event="存档" data={{getvar::数据}} data=8 data=你好 {{user}}</code></pre>\n            </li>\n            <li>\n                <pre><code class="language-stscript">/event-emit event="随便什么名称" data="这是一个 数据" data={{user}}</code></pre>\n            </li>\n        </ul>\n    </div>\n  `,\n    }));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvc2xhc2hfY29tbWFuZC9ldmVudC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFrRDtBQUM4QjtBQUNvQztBQUN4QjtBQUVqRTtBQUVwQixLQUFLLFVBQVUsY0FBYyxDQUFDLFVBQWU7SUFDbEQsTUFBTSxLQUFLLEdBQVcsVUFBVSxDQUFDLEtBQUssQ0FBQztJQUN2QyxNQUFNLElBQUksR0FBYSxVQUFVLENBQUMsSUFBSSxJQUFJLEVBQUUsQ0FBQztJQUU3Qyw0REFBVyxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUUsR0FBRyxJQUFJLENBQUMsQ0FBQztJQUVqQyxvREFBUSxDQUFDLDRCQUE0QixLQUFLLGVBQWUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7SUFFakYsT0FBTyxLQUFLLENBQUM7QUFDZixDQUFDO0FBRU0sU0FBUyxrQkFBa0I7SUFDaEMsc0dBQWtCLENBQUMsZ0JBQWdCLENBQ2pDLDBGQUFZLENBQUMsU0FBUyxDQUFDO1FBQ3JCLElBQUksRUFBRSxZQUFZO1FBQ2xCLFFBQVEsRUFBRSxjQUFjO1FBQ3hCLE9BQU8sRUFBRSxTQUFTO1FBQ2xCLGlCQUFpQixFQUFFO1lBQ2pCLCtHQUF5QixDQUFDLFNBQVMsQ0FBQztnQkFDbEMsSUFBSSxFQUFFLE9BQU87Z0JBQ2IsV0FBVyxFQUFFLE1BQU07Z0JBQ25CLFFBQVEsRUFBRSxDQUFDLG1HQUFhLENBQUMsTUFBTSxDQUFDO2dCQUNoQyxVQUFVLEVBQUUsSUFBSTthQUNqQixDQUFDO1lBQ0YsK0dBQXlCLENBQUMsU0FBUyxDQUFDO2dCQUNsQyxJQUFJLEVBQUUsTUFBTTtnQkFDWixXQUFXLEVBQUUsUUFBUTtnQkFDckIsUUFBUSxFQUFFLENBQUMsbUdBQWEsQ0FBQyxNQUFNLENBQUM7Z0JBQ2hDLFVBQVUsRUFBRSxLQUFLO2dCQUNqQixlQUFlLEVBQUUsSUFBSTthQUN0QixDQUFDO1NBQ0g7UUFDRCxtQkFBbUIsRUFBRSxFQUFFO1FBQ3ZCLFVBQVUsRUFBRTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7R0FvQmY7S0FDRSxDQUFDLENBQ0gsQ0FBQztBQUNKLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvc2xhc2hfY29tbWFuZC9ldmVudC50cz9mNmU3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGV2ZW50U291cmNlIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5pbXBvcnQgeyBTbGFzaENvbW1hbmQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9zbGFzaC1jb21tYW5kcy9TbGFzaENvbW1hbmQnO1xuaW1wb3J0IHsgQVJHVU1FTlRfVFlQRSwgU2xhc2hDb21tYW5kTmFtZWRBcmd1bWVudCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3NsYXNoLWNvbW1hbmRzL1NsYXNoQ29tbWFuZEFyZ3VtZW50JztcbmltcG9ydCB7IFNsYXNoQ29tbWFuZFBhcnNlciB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3NsYXNoLWNvbW1hbmRzL1NsYXNoQ29tbWFuZFBhcnNlcic7XG5cbmltcG9ydCBsb2cgZnJvbSAnbG9nbGV2ZWwnO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2xhc2hFdmVudEVtaXQobmFtZWRfYXJnczogYW55KTogUHJvbWlzZTxhbnk+IHtcbiAgY29uc3QgZXZlbnQ6IHN0cmluZyA9IG5hbWVkX2FyZ3MuZXZlbnQ7XG4gIGNvbnN0IGRhdGE6IHN0cmluZ1tdID0gbmFtZWRfYXJncy5kYXRhID8/IFtdO1xuXG4gIGV2ZW50U291cmNlLmVtaXQoZXZlbnQsIC4uLmRhdGEpO1xuXG4gIGxvZy5pbmZvKGBbRXZlbnRdWy9ldmVudC1lbWl0XSDlj5HpgIEgJyR7ZXZlbnR9JyDkuovku7YsIOaQuuW4puaVsOaNrjogJHtKU09OLnN0cmluZ2lmeShkYXRhKX1gKTtcblxuICByZXR1cm4gZXZlbnQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpbml0U2xhc2hFdmVudEVtaXQoKSB7XG4gIFNsYXNoQ29tbWFuZFBhcnNlci5hZGRDb21tYW5kT2JqZWN0KFxuICAgIFNsYXNoQ29tbWFuZC5mcm9tUHJvcHMoe1xuICAgICAgbmFtZTogJ2V2ZW50LWVtaXQnLFxuICAgICAgY2FsbGJhY2s6IHNsYXNoRXZlbnRFbWl0LFxuICAgICAgcmV0dXJuczogJ+WPkemAgeeahOS6i+S7tuWQjeensCcsXG4gICAgICBuYW1lZEFyZ3VtZW50TGlzdDogW1xuICAgICAgICBTbGFzaENvbW1hbmROYW1lZEFyZ3VtZW50LmZyb21Qcm9wcyh7XG4gICAgICAgICAgbmFtZTogJ2V2ZW50JyxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogJ+S6i+S7tuWQjeensCcsXG4gICAgICAgICAgdHlwZUxpc3Q6IFtBUkdVTUVOVF9UWVBFLlNUUklOR10sXG4gICAgICAgICAgaXNSZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgfSksXG4gICAgICAgIFNsYXNoQ29tbWFuZE5hbWVkQXJndW1lbnQuZnJvbVByb3BzKHtcbiAgICAgICAgICBuYW1lOiAnZGF0YScsXG4gICAgICAgICAgZGVzY3JpcHRpb246ICfopoHkvKDovpPnmoTmlbDmja4nLFxuICAgICAgICAgIHR5cGVMaXN0OiBbQVJHVU1FTlRfVFlQRS5TVFJJTkddLFxuICAgICAgICAgIGlzUmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICAgIGFjY2VwdHNNdWx0aXBsZTogdHJ1ZSxcbiAgICAgICAgfSksXG4gICAgICBdLFxuICAgICAgdW5uYW1lZEFyZ3VtZW50TGlzdDogW10sXG4gICAgICBoZWxwU3RyaW5nOiBgXG4gICAgPGRpdj5cbiAgICAgICAg5Y+R6YCBIFxcYGV2ZW50XFxgIOS6i+S7tiwg5ZCM5pe25Y+v5Lul5Y+R6YCB5LiA5Lqb5pWw5o2uLlxuICAgICAgICDmiYDmnInmraPlnKjnm5HlkKzor6Xmtojmga/popHpgZPnmoQgbGlzdGVuZXIg5Ye95pWw6YO95Lya6Ieq5Yqo6L+Q6KGMLCDlubbog73nlKjlh73mlbDlj4LmlbDmjqXmlLblj5HpgIHmnaXnmoTmlbDmja4uXG4gICAgICAgIOeUseS6jumFkummhiBTVFNjcmlwdCDovpPlhaXmlrnlvI/nmoTlsYDpmZDmgKcsIOaJgOacieaVsOaNruWwhuS8muS7peWtl+espuS4siBzdHJpbmcg57G75Z6L5o6l5pS2OyDlpoLmnpzpnIDopoEgbnVtYmVyIOetieexu+Weiywg6K+36Ieq6KGM6L2s5o2iLlxuICAgIDwvZGl2PlxuICAgIDxkaXY+XG4gICAgICAgIDxzdHJvbmc+RXhhbXBsZTo8L3N0cm9uZz5cbiAgICAgICAgPHVsPlxuICAgICAgICAgICAgPGxpPlxuICAgICAgICAgICAgICAgIDxwcmU+PGNvZGUgY2xhc3M9XCJsYW5ndWFnZS1zdHNjcmlwdFwiPi9ldmVudC1lbWl0IGV2ZW50PVwi6K+75qGjXCI8L2NvZGU+PC9wcmU+XG4gICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgPGxpPlxuICAgICAgICAgICAgICAgIDxwcmU+PGNvZGUgY2xhc3M9XCJsYW5ndWFnZS1zdHNjcmlwdFwiPi9ldmVudC1lbWl0IGV2ZW50PVwi5a2Y5qGjXCIgZGF0YT17e2dldHZhcjo65pWw5o2ufX0gZGF0YT04IGRhdGE95L2g5aW9IHt7dXNlcn19PC9jb2RlPjwvcHJlPlxuICAgICAgICAgICAgPC9saT5cbiAgICAgICAgICAgIDxsaT5cbiAgICAgICAgICAgICAgICA8cHJlPjxjb2RlIGNsYXNzPVwibGFuZ3VhZ2Utc3RzY3JpcHRcIj4vZXZlbnQtZW1pdCBldmVudD1cIumaj+S+v+S7gOS5iOWQjeensFwiIGRhdGE9XCLov5nmmK/kuIDkuKog5pWw5o2uXCIgZGF0YT17e3VzZXJ9fTwvY29kZT48L3ByZT5cbiAgICAgICAgICAgIDwvbGk+XG4gICAgICAgIDwvdWw+XG4gICAgPC9kaXY+XG4gIGAsXG4gICAgfSksXG4gICk7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/slash_command/event.ts\n\n}')},"./src/third_party.html":
/*!******************************!*\
  !*** ./src/third_party.html ***!
  \******************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n// Module\nvar code = `<link rel="stylesheet" href="https://testingcf.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css" />\n${"<" + "script"} src="https://testingcf.jsdelivr.net/npm/jquery/dist/jquery.min.js">${"<" + "/script"}>\n${"<" + "script"} src="https://testingcf.jsdelivr.net/npm/jquery-ui/dist/jquery-ui.min.js">${"<" + "/script"}>\n<link rel="stylesheet" href="https://testingcf.jsdelivr.net/npm/jquery-ui/themes/base/theme.min.css" />\n${"<" + "script"} src="https://testingcf.jsdelivr.net/npm/lodash/lodash.min.js">${"<" + "/script"}>\n`;\n// Exports\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (code);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvdGhpcmRfcGFydHkuaHRtbCIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTtBQUNBLEVBQUUsZ0JBQWdCLHFFQUFxRSxnQkFBZ0I7QUFDdkcsRUFBRSxnQkFBZ0IsMkVBQTJFLGdCQUFnQjtBQUM3RztBQUNBLEVBQUUsZ0JBQWdCLGdFQUFnRSxnQkFBZ0I7QUFDbEc7QUFDQTtBQUNBLGlFQUFlLElBQUkiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvdGhpcmRfcGFydHkuaHRtbD9jYzhhIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIE1vZHVsZVxudmFyIGNvZGUgPSBgPGxpbmsgcmVsPVwic3R5bGVzaGVldFwiIGhyZWY9XCJodHRwczovL3Rlc3RpbmdjZi5qc2RlbGl2ci5uZXQvbnBtL2ZvbnQtYXdlc29tZS9jc3MvZm9udC1hd2Vzb21lLm1pbi5jc3NcIiAvPlxuJHtcIjxcIiArIFwic2NyaXB0XCJ9IHNyYz1cImh0dHBzOi8vdGVzdGluZ2NmLmpzZGVsaXZyLm5ldC9ucG0vanF1ZXJ5L2Rpc3QvanF1ZXJ5Lm1pbi5qc1wiPiR7XCI8XCIgKyBcIi9zY3JpcHRcIn0+XG4ke1wiPFwiICsgXCJzY3JpcHRcIn0gc3JjPVwiaHR0cHM6Ly90ZXN0aW5nY2YuanNkZWxpdnIubmV0L25wbS9qcXVlcnktdWkvZGlzdC9qcXVlcnktdWkubWluLmpzXCI+JHtcIjxcIiArIFwiL3NjcmlwdFwifT5cbjxsaW5rIHJlbD1cInN0eWxlc2hlZXRcIiBocmVmPVwiaHR0cHM6Ly90ZXN0aW5nY2YuanNkZWxpdnIubmV0L25wbS9qcXVlcnktdWkvdGhlbWVzL2Jhc2UvdGhlbWUubWluLmNzc1wiIC8+XG4ke1wiPFwiICsgXCJzY3JpcHRcIn0gc3JjPVwiaHR0cHM6Ly90ZXN0aW5nY2YuanNkZWxpdnIubmV0L25wbS9sb2Rhc2gvbG9kYXNoLm1pbi5qc1wiPiR7XCI8XCIgKyBcIi9zY3JpcHRcIn0+XG5gO1xuLy8gRXhwb3J0c1xuZXhwb3J0IGRlZmF1bHQgY29kZTsiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/third_party.html\n\n}')},"./src/util/check_update.ts":
/*!**********************************!*\
  !*** ./src/util/check_update.ts ***!
  \**********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VERSION_FILE_PATH: () => (/* binding */ VERSION_FILE_PATH),\n/* harmony export */   addVersionUpdateElement: () => (/* binding */ addVersionUpdateElement),\n/* harmony export */   getChangelog: () => (/* binding */ getChangelog),\n/* harmony export */   getCurrentVersion: () => (/* binding */ getCurrentVersion),\n/* harmony export */   getFileContentByPath: () => (/* binding */ getFileContentByPath),\n/* harmony export */   handleUpdateButton: () => (/* binding */ handleUpdateButton),\n/* harmony export */   parseChangelogBetweenVersions: () => (/* binding */ parseChangelogBetweenVersions),\n/* harmony export */   parseVersionFromFile: () => (/* binding */ parseVersionFromFile),\n/* harmony export */   runCheckWithPath: () => (/* binding */ runCheckWithPath),\n/* harmony export */   showNewFeature: () => (/* binding */ showNewFeature),\n/* harmony export */   updateTavernHelper: () => (/* binding */ updateTavernHelper)\n/* harmony export */ });\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _util_render_markdown__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/util/render_markdown */ \"./src/util/render_markdown.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var _sillytavern_scripts_i18n__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sillytavern/scripts/i18n */ \"@sillytavern/scripts/i18n\");\n/* harmony import */ var _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @sillytavern/scripts/popup */ \"@sillytavern/scripts/popup\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_6__);\n\n\n\n\n\n\n\nconst GITLAB_INSTANCE_URL = 'gitlab.com';\nconst GITLAB_PROJECT_PATH = 'novi028/JS-Slash-Runner';\nconst GITLAB_BRANCH = 'main';\nconst VERSION_FILE_PATH_GITLAB = 'manifest.json';\nconst CHANGELOG_FILE_PATH_GITLAB = 'CHANGELOG.md';\nconst VERSION_FILE_PATH = `/scripts/extensions/${_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.extensionFolderPath}/manifest.json`;\nlet CURRENT_VERSION;\nlet LATEST_VERSION;\nlet CHANGELOG_CONTENT;\n/**\n * 从 GitLab 仓库获取指定文件的原始内容 (支持项目 ID 或项目路径)\n * @param filePath 文件在仓库中的路径 (会被自动 URL 编码)\n * @returns 返回文件内容的 Promise<string>\n */\nasync function fetchRawFileContentFromGitLab(filePath) {\n    const idOrPathForUrl = typeof GITLAB_PROJECT_PATH === 'string' && GITLAB_PROJECT_PATH.includes('/')\n        ? encodeURIComponent(GITLAB_PROJECT_PATH)\n        : GITLAB_PROJECT_PATH;\n    const encodedFilePath = encodeURIComponent(filePath);\n    const url = `https://${GITLAB_INSTANCE_URL}/api/v4/projects/${idOrPathForUrl}/repository/files/${encodedFilePath}/raw?ref=${GITLAB_BRANCH}`;\n    const headers = {\n        'Cache-Control': 'no-cache',\n    };\n    try {\n        const response = await fetch(url, { method: 'GET', headers: headers });\n        if (!response.ok) {\n            let errorBody = '';\n            try {\n                errorBody = await response.text();\n            }\n            catch (e) {\n                /* ignore */\n            }\n            throw new Error(`[TavernHelper] 无法获取 GitLab 文件: ${response.status} ${response.statusText}. URL: ${url}. Response: ${errorBody}`);\n        }\n        const content = await response.text();\n        return content.trim();\n    }\n    catch (error) {\n        loglevel__WEBPACK_IMPORTED_MODULE_6___default().error('[TavernHelper] 获取 GitLab 文件内容时出错:', error);\n        throw error;\n    }\n}\n/**\n * 从 JSON 文件内容中解析 'version' 字段的值\n * @param content 文件内容字符串\n * @returns 解析出的版本号字符串 (例如 \"2.5.5\")\n * @throws 如果内容不是有效的 JSON，或者 'version' 字段不存在或不是字符串，则抛出错误\n */\nfunction parseVersionFromFile(content) {\n    try {\n        const data = JSON.parse(content);\n        if (data && typeof data.version === 'string') {\n            return data.version;\n        }\n        else {\n            throw new Error(\"[TavernHelper] 在 JSON 数据中未找到有效的 'version' 字段 (必须是字符串类型)\");\n        }\n    }\n    catch (error) {\n        loglevel__WEBPACK_IMPORTED_MODULE_6___default().error('[TavernHelper] 解析版本文件内容时出错:', error);\n        if (error instanceof SyntaxError) {\n            throw new Error(`[TavernHelper] 无法将文件内容解析为 JSON: ${error.message}`);\n        }\n        throw new Error(`[TavernHelper] 无法从文件内容中解析版本号: ${error instanceof Error ? error.message : String(error)}`);\n    }\n}\n/**\n * 获取当前版本号\n * @param path 版本号文件路径\n * @returns 当前版本号\n */\nasync function getCurrentVersion(path) {\n    CURRENT_VERSION = parseVersionFromFile(await getFileContentByPath(path));\n    return CURRENT_VERSION;\n}\n/**\n * 比较两个语义化版本号 (Semantic Versioning - Major.Minor.Patch)\n * @param versionA 版本号字符串 A (例如 \"2.5.5\")\n * @param versionB 版本号字符串 B (例如 \"1.0.0\")\n * @returns\n * - 正数 (> 0): 如果 versionA > versionB (A 更新)\n * - 负数 (< 0): 如果 versionA < versionB (B 更新)\n * - 0:        如果 versionA == versionB (版本相同)\n * 注意: 这个基础比较器不处理预发布标签 (-beta) 或构建元数据 (+build)。\n * 它会将 \"2.5.5-beta\" 和 \"2.5.5\" 在此比较中视为相等。\n */\nfunction compareSemVer(versionA, versionB) {\n    const cleanVersionA = versionA.split('-')[0].split('+')[0];\n    const cleanVersionB = versionB.split('-')[0].split('+')[0];\n    const partsA = cleanVersionA.split('.').map(Number);\n    const partsB = cleanVersionB.split('.').map(Number);\n    for (let i = 0; i < 3; i++) {\n        // 如果某个版本号部分缺失 (例如 \"1.2\" vs \"1.2.3\")，则视为 0\n        const numA = partsA[i] || 0;\n        const numB = partsB[i] || 0;\n        if (isNaN(numA) || isNaN(numB)) {\n            loglevel__WEBPACK_IMPORTED_MODULE_6___default().warn(`[TavernHelper] 版本号 \"${versionA}\" 或 \"${versionB}\" 包含非数字部分，可能导致比较不准确。`);\n            return 0;\n        }\n        if (numA > numB) {\n            return 1;\n        }\n        if (numA < numB) {\n            return -1;\n        }\n    }\n    return 0;\n}\nasync function getFileContentByPath(filePath) {\n    try {\n        const response = await fetch(filePath);\n        if (!response.ok) {\n            throw new Error(`HTTP error! status: ${response.status}`);\n        }\n        const content = await response.text();\n        return content;\n    }\n    catch (error) {\n        loglevel__WEBPACK_IMPORTED_MODULE_6___default().error(`读取文件 ${filePath} 失败:`, error);\n        throw error;\n    }\n}\nasync function runCheckWithPath() {\n    try {\n        LATEST_VERSION = parseVersionFromFile(await fetchRawFileContentFromGitLab(VERSION_FILE_PATH_GITLAB));\n        const comparisonResult = compareSemVer(LATEST_VERSION, CURRENT_VERSION);\n        if (comparisonResult > 0) {\n            loglevel__WEBPACK_IMPORTED_MODULE_6___default().info(`[TavernHelper] 需要更新！最新版本 ${LATEST_VERSION} > 当前版本 ${CURRENT_VERSION}`);\n            return true;\n        }\n        else if (comparisonResult === 0) {\n            loglevel__WEBPACK_IMPORTED_MODULE_6___default().info(`[TavernHelper] 当前版本 ${CURRENT_VERSION} 已是最新。`);\n            return false;\n        }\n        else {\n            loglevel__WEBPACK_IMPORTED_MODULE_6___default().warn(`[TavernHelper] 当前版本 ${CURRENT_VERSION} 比远程版本 ${LATEST_VERSION} 还新？`);\n            return false;\n        }\n    }\n    catch (error) {\n        loglevel__WEBPACK_IMPORTED_MODULE_6___default().error('[TavernHelper] 版本检查失败:', error);\n        return false;\n    }\n}\n/**\n * 添加版本更新提示元素\n */\nfunction addVersionUpdateElement() {\n    const container = $('#tavern-helper-extension-container .inline-drawer-header b');\n    container.append(`\n    <span style=\"color: red; font-size: 12px; font-weight: bold;\">\n      New!\n    </span>\n  `);\n    $('#version-update-text').closest('.flex-container .alignItemsCenter').append(`\n      <div style='background-color: var(--SmartThemeQuoteColor);border-radius: 50px;padding: 0 5px;height: 50%; font-size: calc(var(--mainFontSize) * 0.7);'>\n        最新：Ver ${LATEST_VERSION}\n      </div>\n    `);\n}\n/**\n * 解析变更日志内容，提取两个版本之间的日志\n * @param changelogContent 变更日志的完整内容\n * @param currentVersion 当前版本号\n * @param latestVersion 最新版本号\n * @returns 两个版本之间的日志内容\n */\nfunction parseChangelogBetweenVersions(changelogContent, currentVersion, latestVersion) {\n    // 查找所有版本标题，支持多种Markdown标题格式\n    // 匹配 ## 版本号 或 # 版本号 或 [版本号] 等格式\n    const versionRegex = /(?:^|\\n)(?:#{1,3}\\s*|\\[)([0-9]+\\.[0-9]+\\.[0-9]+)(?:\\]|\\s|$)/g;\n    const matches = [...changelogContent.matchAll(versionRegex)];\n    if (matches.length === 0) {\n        toastr.error('无法找到版本日志。');\n        return;\n    }\n    // 比较当前版本和最新版本\n    const comparisonResult = compareSemVer(latestVersion, currentVersion);\n    let extractedContent = '';\n    if (comparisonResult <= 0) {\n        // 当前版本大于或等于最新版本，只返回最新版本的日志\n        const latestVersionMatch = matches.find(match => match[1] === latestVersion);\n        if (!latestVersionMatch) {\n            toastr.error('获取更新日志失败');\n            return;\n        }\n        const startIndex = latestVersionMatch.index;\n        const nextVersionMatch = matches.find(match => match.index > startIndex);\n        const endIndex = nextVersionMatch ? nextVersionMatch.index : changelogContent.length;\n        extractedContent = changelogContent.substring(startIndex, endIndex).trim();\n    }\n    else {\n        const currentVersionMatch = matches.find(match => match[1] === currentVersion);\n        if (!currentVersionMatch) {\n            toastr.error(`无法找到版本 ${currentVersion} 的日志。`);\n            return;\n        }\n        const latestVersionMatch = matches.find(match => match[1] === latestVersion);\n        if (!latestVersionMatch) {\n            toastr.error(`无法找到版本 ${latestVersion} 的日志。`);\n            return;\n        }\n        const startIndex = currentVersionMatch.index;\n        const endIndex = latestVersionMatch.index;\n        extractedContent = changelogContent.substring(startIndex, endIndex).trim();\n    }\n    return (0,_util_render_markdown__WEBPACK_IMPORTED_MODULE_1__.renderMarkdown)(extractedContent);\n}\n/**\n * 弹出changeLog的popup\n */\nasync function handleUpdateButton() {\n    if (!CHANGELOG_CONTENT) {\n        await getChangelog();\n    }\n    const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_5__.callGenericPopup)(CHANGELOG_CONTENT, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_5__.POPUP_TYPE.CONFIRM, '', {\n        okButton: '更新',\n        cancelButton: '取消',\n    });\n    if (result) {\n        toastr.info('更新中……');\n        await updateTavernHelper();\n    }\n}\n/**\n * 获取变更日志\n * @returns 两个版本之间的日志内容\n */\nasync function getChangelog() {\n    toastr.info('获取更新日志中……');\n    const changelogContent = await fetchRawFileContentFromGitLab(CHANGELOG_FILE_PATH_GITLAB);\n    if (LATEST_VERSION === undefined) {\n        LATEST_VERSION = parseVersionFromFile(await fetchRawFileContentFromGitLab(VERSION_FILE_PATH_GITLAB));\n    }\n    if (CURRENT_VERSION === undefined) {\n        CURRENT_VERSION = parseVersionFromFile(await getFileContentByPath(VERSION_FILE_PATH));\n    }\n    const logs = parseChangelogBetweenVersions(changelogContent, CURRENT_VERSION, LATEST_VERSION);\n    if (!logs) {\n        toastr.error('无法获取更新日志');\n        return;\n    }\n    else {\n        CHANGELOG_CONTENT = logs;\n    }\n}\nasync function install_extension(url, global) {\n    const response = await fetch('/api/extensions/install', {\n        method: 'POST',\n        headers: (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.getRequestHeaders)(),\n        body: JSON.stringify({ url, global }),\n    });\n    return response;\n}\nasync function uninstall_extension(extension_name, global) {\n    const response = await fetch('/api/extensions/delete', {\n        method: 'POST',\n        headers: (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.getRequestHeaders)(),\n        body: JSON.stringify({ extensionName: extension_name, global }),\n    });\n    return response;\n}\nasync function reinstall_extension(extension_name, global) {\n    const response = await uninstall_extension(extension_name, global);\n    if (!response.ok) {\n        return response;\n    }\n    return install_extension(extension_name, global);\n}\nasync function update_extension(extension_name, global) {\n    const response = await fetch('/api/extensions/update', {\n        method: 'POST',\n        headers: (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.getRequestHeaders)(),\n        body: JSON.stringify({ extensionName: extension_name, global }),\n    });\n    return response;\n}\n/**\n * 更新酒馆助手\n */\nasync function updateTavernHelper() {\n    const global = getExtensionType(_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.extensionName) === 'global' ? true : false;\n    const reload = () => {\n        toastr.success(`成功更新酒馆助手, 准备刷新页面以生效...`);\n        loglevel__WEBPACK_IMPORTED_MODULE_6___default().info(`成功更新酒馆助手, 准备刷新页面以生效...`);\n        setTimeout(() => location.reload(), 3000);\n    };\n    const update_response = await update_extension(_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.extensionName, global);\n    if (update_response.ok) {\n        if ((await update_response.json()).isUpToDate) {\n            toastr.success(`酒馆助手已是最新版本, 无需更新`);\n            loglevel__WEBPACK_IMPORTED_MODULE_6___default().info(`酒馆助手已是最新版本, 无需更新`);\n        }\n        else {\n            reload();\n        }\n        return true;\n    }\n    const comfirm_reinstall = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_5__.callGenericPopup)(`更新失败: ${(await update_response.text()) || update_response.statusText}\n  是否尝试通过卸载重装来更新?\n  (可能因为网络问题而只卸载了没能重装, 请先复制 \\`https://gitlab.com/novi028/JS-Slash-Runner\\`)\n  `, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_5__.POPUP_TYPE.CONFIRM);\n    if (!comfirm_reinstall) {\n        return;\n    }\n    const reinstall_response = await reinstall_extension(_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.extensionName, global);\n    if (!reinstall_response.ok) {\n        const text = await reinstall_response.text();\n        toastr.error(text || reinstall_response.statusText, (0,_sillytavern_scripts_i18n__WEBPACK_IMPORTED_MODULE_4__.t) `更新酒馆助手失败`, { timeOut: 5000 });\n        loglevel__WEBPACK_IMPORTED_MODULE_6___default().error(`更新酒馆助手失败: ${text}`);\n        return false;\n    }\n    reload();\n    return true;\n}\n// 酒馆原代码复制来的\n/**\n * Gets the type of an extension based on its external ID.\n * @param {string} externalId External ID of the extension (excluding or including the leading 'third-party/')\n * @returns {string} Type of the extension (global, local, system, or empty string if not found)\n */\nfunction getExtensionType(externalId) {\n    const id = Object.keys(_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__.extensionTypes).find(\n    // eslint-disable-next-line no-shadow\n    (id) => id === externalId || (id.startsWith('third-party') && id.endsWith(externalId)));\n    return id ? _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__.extensionTypes[id] : 'local';\n}\n// 旧版更新后用\n/**\n *\n */\nasync function showNewFeature() {\n    let changelogContent = await fetchRawFileContentFromGitLab(CHANGELOG_FILE_PATH_GITLAB);\n    changelogContent = changelogContent + '\\n\\n*前端助手旧版配置已清除，请重新配置扩展设置*';\n    const logs = parseChangelogBetweenVersions(changelogContent, '3.0.0', '3.0.0');\n    if (logs) {\n        const modifiedLogs = logs.replace(/<h2([^>]*)>([^<]*)<\\/h2>/g, '<h2$1>酒馆助手 $2</h2>');\n        await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_5__.callGenericPopup)(modifiedLogs, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_5__.POPUP_TYPE.TEXT);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LENBQUMsQ0FBQztJQUN4RCxDQUFDO0FBQ0gsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy91dGlsL2NoZWNrX3VwZGF0ZS50cz8xYTA5Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGV4dGVuc2lvbkZvbGRlclBhdGgsIGV4dGVuc2lvbk5hbWUgfSBmcm9tICdAL3V0aWwvZXh0ZW5zaW9uX3ZhcmlhYmxlcyc7XG5pbXBvcnQgeyByZW5kZXJNYXJrZG93biB9IGZyb20gJ0AvdXRpbC9yZW5kZXJfbWFya2Rvd24nO1xuXG5pbXBvcnQgeyBnZXRSZXF1ZXN0SGVhZGVycyB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHQnO1xuaW1wb3J0IHsgZXh0ZW5zaW9uVHlwZXMgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9leHRlbnNpb25zJztcbmltcG9ydCB7IHQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9pMThuJztcbmltcG9ydCB7IFBPUFVQX1RZUEUsIGNhbGxHZW5lcmljUG9wdXAgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9wb3B1cCc7XG5cbmltcG9ydCBsb2cgZnJvbSAnbG9nbGV2ZWwnO1xuXG5jb25zdCBHSVRMQUJfSU5TVEFOQ0VfVVJMID0gJ2dpdGxhYi5jb20nO1xuY29uc3QgR0lUTEFCX1BST0pFQ1RfUEFUSCA9ICdub3ZpMDI4L0pTLVNsYXNoLVJ1bm5lcic7XG5jb25zdCBHSVRMQUJfQlJBTkNIID0gJ21haW4nO1xuY29uc3QgVkVSU0lPTl9GSUxFX1BBVEhfR0lUTEFCID0gJ21hbmlmZXN0Lmpzb24nO1xuY29uc3QgQ0hBTkdFTE9HX0ZJTEVfUEFUSF9HSVRMQUIgPSAnQ0hBTkdFTE9HLm1kJztcbmV4cG9ydCBjb25zdCBWRVJTSU9OX0ZJTEVfUEFUSCA9IGAvc2NyaXB0cy9leHRlbnNpb25zLyR7ZXh0ZW5zaW9uRm9sZGVyUGF0aH0vbWFuaWZlc3QuanNvbmA7XG5sZXQgQ1VSUkVOVF9WRVJTSU9OOiBzdHJpbmc7XG5sZXQgTEFURVNUX1ZFUlNJT046IHN0cmluZztcbmxldCBDSEFOR0VMT0dfQ09OVEVOVDogc3RyaW5nO1xuXG4vKipcbiAqIOS7jiBHaXRMYWIg5LuT5bqT6I635Y+W5oyH5a6a5paH5Lu255qE5Y6f5aeL5YaF5a65ICjmlK/mjIHpobnnm64gSUQg5oiW6aG555uu6Lev5b6EKVxuICogQHBhcmFtIGZpbGVQYXRoIOaWh+S7tuWcqOS7k+W6k+S4reeahOi3r+W+hCAo5Lya6KKr6Ieq5YqoIFVSTCDnvJbnoIEpXG4gKiBAcmV0dXJucyDov5Tlm57mlofku7blhoXlrrnnmoQgUHJvbWlzZTxzdHJpbmc+XG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGZldGNoUmF3RmlsZUNvbnRlbnRGcm9tR2l0TGFiKGZpbGVQYXRoOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICBjb25zdCBpZE9yUGF0aEZvclVybCA9XG4gICAgdHlwZW9mIEdJVExBQl9QUk9KRUNUX1BBVEggPT09ICdzdHJpbmcnICYmIEdJVExBQl9QUk9KRUNUX1BBVEguaW5jbHVkZXMoJy8nKVxuICAgICAgPyBlbmNvZGVVUklDb21wb25lbnQoR0lUTEFCX1BST0pFQ1RfUEFUSClcbiAgICAgIDogR0lUTEFCX1BST0pFQ1RfUEFUSDtcbiAgY29uc3QgZW5jb2RlZEZpbGVQYXRoID0gZW5jb2RlVVJJQ29tcG9uZW50KGZpbGVQYXRoKTtcbiAgY29uc3QgdXJsID0gYGh0dHBzOi8vJHtHSVRMQUJfSU5TVEFOQ0VfVVJMfS9hcGkvdjQvcHJvamVjdHMvJHtpZE9yUGF0aEZvclVybH0vcmVwb3NpdG9yeS9maWxlcy8ke2VuY29kZWRGaWxlUGF0aH0vcmF3P3JlZj0ke0dJVExBQl9CUkFOQ0h9YDtcblxuICBjb25zdCBoZWFkZXJzOiBIZWFkZXJzSW5pdCA9IHtcbiAgICAnQ2FjaGUtQ29udHJvbCc6ICduby1jYWNoZScsXG4gIH07XG5cbiAgdHJ5IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwgeyBtZXRob2Q6ICdHRVQnLCBoZWFkZXJzOiBoZWFkZXJzIH0pO1xuICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgIGxldCBlcnJvckJvZHkgPSAnJztcbiAgICAgIHRyeSB7XG4gICAgICAgIGVycm9yQm9keSA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgLyogaWdub3JlICovXG4gICAgICB9XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIGBbVGF2ZXJuSGVscGVyXSDml6Dms5Xojrflj5YgR2l0TGFiIOaWh+S7tjogJHtyZXNwb25zZS5zdGF0dXN9ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH0uIFVSTDogJHt1cmx9LiBSZXNwb25zZTogJHtlcnJvckJvZHl9YCxcbiAgICAgICk7XG4gICAgfVxuICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgcmV0dXJuIGNvbnRlbnQudHJpbSgpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGxvZy5lcnJvcignW1RhdmVybkhlbHBlcl0g6I635Y+WIEdpdExhYiDmlofku7blhoXlrrnml7blh7rplJk6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59XG5cbi8qKlxuICog5LuOIEpTT04g5paH5Lu25YaF5a655Lit6Kej5p6QICd2ZXJzaW9uJyDlrZfmrrXnmoTlgLxcbiAqIEBwYXJhbSBjb250ZW50IOaWh+S7tuWGheWuueWtl+espuS4slxuICogQHJldHVybnMg6Kej5p6Q5Ye655qE54mI5pys5Y+35a2X56ym5LiyICjkvovlpoIgXCIyLjUuNVwiKVxuICogQHRocm93cyDlpoLmnpzlhoXlrrnkuI3mmK/mnInmlYjnmoQgSlNPTu+8jOaIluiAhSAndmVyc2lvbicg5a2X5q615LiN5a2Y5Zyo5oiW5LiN5piv5a2X56ym5Liy77yM5YiZ5oqb5Ye66ZSZ6K+vXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVZlcnNpb25Gcm9tRmlsZShjb250ZW50OiBzdHJpbmcpOiBzdHJpbmcge1xuICB0cnkge1xuICAgIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKGNvbnRlbnQpO1xuXG4gICAgaWYgKGRhdGEgJiYgdHlwZW9mIGRhdGEudmVyc2lvbiA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHJldHVybiBkYXRhLnZlcnNpb247XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIltUYXZlcm5IZWxwZXJdIOWcqCBKU09OIOaVsOaNruS4reacquaJvuWIsOacieaViOeahCAndmVyc2lvbicg5a2X5q61ICjlv4XpobvmmK/lrZfnrKbkuLLnsbvlnospXCIpO1xuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBsb2cuZXJyb3IoJ1tUYXZlcm5IZWxwZXJdIOino+aekOeJiOacrOaWh+S7tuWGheWuueaXtuWHuumUmTonLCBlcnJvcik7XG5cbiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBTeW50YXhFcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBbVGF2ZXJuSGVscGVyXSDml6Dms5XlsIbmlofku7blhoXlrrnop6PmnpDkuLogSlNPTjogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgIH1cblxuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIGBbVGF2ZXJuSGVscGVyXSDml6Dms5Xku47mlofku7blhoXlrrnkuK3op6PmnpDniYjmnKzlj7c6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpfWAsXG4gICAgKTtcbiAgfVxufVxuXG4vKipcbiAqIOiOt+WPluW9k+WJjeeJiOacrOWPt1xuICogQHBhcmFtIHBhdGgg54mI5pys5Y+35paH5Lu26Lev5b6EXG4gKiBAcmV0dXJucyDlvZPliY3niYjmnKzlj7dcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEN1cnJlbnRWZXJzaW9uKHBhdGg6IHN0cmluZykge1xuICBDVVJSRU5UX1ZFUlNJT04gPSBwYXJzZVZlcnNpb25Gcm9tRmlsZShhd2FpdCBnZXRGaWxlQ29udGVudEJ5UGF0aChwYXRoKSk7XG4gIHJldHVybiBDVVJSRU5UX1ZFUlNJT047XG59XG5cbi8qKlxuICog5q+U6L6D5Lik5Liq6K+t5LmJ5YyW54mI5pys5Y+3IChTZW1hbnRpYyBWZXJzaW9uaW5nIC0gTWFqb3IuTWlub3IuUGF0Y2gpXG4gKiBAcGFyYW0gdmVyc2lvbkEg54mI5pys5Y+35a2X56ym5LiyIEEgKOS+i+WmgiBcIjIuNS41XCIpXG4gKiBAcGFyYW0gdmVyc2lvbkIg54mI5pys5Y+35a2X56ym5LiyIEIgKOS+i+WmgiBcIjEuMC4wXCIpXG4gKiBAcmV0dXJuc1xuICogLSDmraPmlbAgKD4gMCk6IOWmguaenCB2ZXJzaW9uQSA+IHZlcnNpb25CIChBIOabtOaWsClcbiAqIC0g6LSf5pWwICg8IDApOiDlpoLmnpwgdmVyc2lvbkEgPCB2ZXJzaW9uQiAoQiDmm7TmlrApXG4gKiAtIDA6ICAgICAgICDlpoLmnpwgdmVyc2lvbkEgPT0gdmVyc2lvbkIgKOeJiOacrOebuOWQjClcbiAqIOazqOaEjzog6L+Z5Liq5Z+656GA5q+U6L6D5Zmo5LiN5aSE55CG6aKE5Y+R5biD5qCH562+ICgtYmV0YSkg5oiW5p6E5bu65YWD5pWw5o2uICgrYnVpbGQp44CCXG4gKiDlroPkvJrlsIYgXCIyLjUuNS1iZXRhXCIg5ZKMIFwiMi41LjVcIiDlnKjmraTmr5TovoPkuK3op4bkuLrnm7jnrYnjgIJcbiAqL1xuZnVuY3Rpb24gY29tcGFyZVNlbVZlcih2ZXJzaW9uQTogc3RyaW5nLCB2ZXJzaW9uQjogc3RyaW5nKTogbnVtYmVyIHtcbiAgY29uc3QgY2xlYW5WZXJzaW9uQSA9IHZlcnNpb25BLnNwbGl0KCctJylbMF0uc3BsaXQoJysnKVswXTtcbiAgY29uc3QgY2xlYW5WZXJzaW9uQiA9IHZlcnNpb25CLnNwbGl0KCctJylbMF0uc3BsaXQoJysnKVswXTtcblxuICBjb25zdCBwYXJ0c0EgPSBjbGVhblZlcnNpb25BLnNwbGl0KCcuJykubWFwKE51bWJlcik7XG4gIGNvbnN0IHBhcnRzQiA9IGNsZWFuVmVyc2lvbkIuc3BsaXQoJy4nKS5tYXAoTnVtYmVyKTtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IDM7IGkrKykge1xuICAgIC8vIOWmguaenOafkOS4queJiOacrOWPt+mDqOWIhue8uuWksSAo5L6L5aaCIFwiMS4yXCIgdnMgXCIxLjIuM1wiKe+8jOWImeinhuS4uiAwXG4gICAgY29uc3QgbnVtQSA9IHBhcnRzQVtpXSB8fCAwO1xuICAgIGNvbnN0IG51bUIgPSBwYXJ0c0JbaV0gfHwgMDtcblxuICAgIGlmIChpc05hTihudW1BKSB8fCBpc05hTihudW1CKSkge1xuICAgICAgbG9nLndhcm4oYFtUYXZlcm5IZWxwZXJdIOeJiOacrOWPtyBcIiR7dmVyc2lvbkF9XCIg5oiWIFwiJHt2ZXJzaW9uQn1cIiDljIXlkKvpnZ7mlbDlrZfpg6jliIbvvIzlj6/og73lr7zoh7Tmr5TovoPkuI3lh4bnoa7jgIJgKTtcbiAgICAgIHJldHVybiAwO1xuICAgIH1cblxuICAgIGlmIChudW1BID4gbnVtQikge1xuICAgICAgcmV0dXJuIDE7XG4gICAgfVxuICAgIGlmIChudW1BIDwgbnVtQikge1xuICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiAwO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RmlsZUNvbnRlbnRCeVBhdGgoZmlsZVBhdGg6IHN0cmluZykge1xuICB0cnkge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goZmlsZVBhdGgpO1xuICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgSFRUUCBlcnJvciEgc3RhdHVzOiAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICB9XG4gICAgY29uc3QgY29udGVudCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcbiAgICByZXR1cm4gY29udGVudDtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBsb2cuZXJyb3IoYOivu+WPluaWh+S7tiAke2ZpbGVQYXRofSDlpLHotKU6YCwgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBydW5DaGVja1dpdGhQYXRoKCkge1xuICB0cnkge1xuICAgIExBVEVTVF9WRVJTSU9OID0gcGFyc2VWZXJzaW9uRnJvbUZpbGUoYXdhaXQgZmV0Y2hSYXdGaWxlQ29udGVudEZyb21HaXRMYWIoVkVSU0lPTl9GSUxFX1BBVEhfR0lUTEFCKSk7XG5cbiAgICBjb25zdCBjb21wYXJpc29uUmVzdWx0ID0gY29tcGFyZVNlbVZlcihMQVRFU1RfVkVSU0lPTiwgQ1VSUkVOVF9WRVJTSU9OKTtcblxuICAgIGlmIChjb21wYXJpc29uUmVzdWx0ID4gMCkge1xuICAgICAgbG9nLmluZm8oYFtUYXZlcm5IZWxwZXJdIOmcgOimgeabtOaWsO+8geacgOaWsOeJiOacrCAke0xBVEVTVF9WRVJTSU9OfSA+IOW9k+WJjeeJiOacrCAke0NVUlJFTlRfVkVSU0lPTn1gKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gZWxzZSBpZiAoY29tcGFyaXNvblJlc3VsdCA9PT0gMCkge1xuICAgICAgbG9nLmluZm8oYFtUYXZlcm5IZWxwZXJdIOW9k+WJjeeJiOacrCAke0NVUlJFTlRfVkVSU0lPTn0g5bey5piv5pyA5paw44CCYCk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxvZy53YXJuKGBbVGF2ZXJuSGVscGVyXSDlvZPliY3niYjmnKwgJHtDVVJSRU5UX1ZFUlNJT059IOavlOi/nOeoi+eJiOacrCAke0xBVEVTVF9WRVJTSU9OfSDov5jmlrDvvJ9gKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nLmVycm9yKCdbVGF2ZXJuSGVscGVyXSDniYjmnKzmo4Dmn6XlpLHotKU6JywgZXJyb3IpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG4vKipcbiAqIOa3u+WKoOeJiOacrOabtOaWsOaPkOekuuWFg+e0oFxuICovXG5leHBvcnQgZnVuY3Rpb24gYWRkVmVyc2lvblVwZGF0ZUVsZW1lbnQoKSB7XG4gIGNvbnN0IGNvbnRhaW5lciA9ICQoJyN0YXZlcm4taGVscGVyLWV4dGVuc2lvbi1jb250YWluZXIgLmlubGluZS1kcmF3ZXItaGVhZGVyIGInKTtcbiAgY29udGFpbmVyLmFwcGVuZChgXG4gICAgPHNwYW4gc3R5bGU9XCJjb2xvcjogcmVkOyBmb250LXNpemU6IDEycHg7IGZvbnQtd2VpZ2h0OiBib2xkO1wiPlxuICAgICAgTmV3IVxuICAgIDwvc3Bhbj5cbiAgYCk7XG4gICQoJyN2ZXJzaW9uLXVwZGF0ZS10ZXh0JykuY2xvc2VzdCgnLmZsZXgtY29udGFpbmVyIC5hbGlnbkl0ZW1zQ2VudGVyJykuYXBwZW5kKGBcbiAgICAgIDxkaXYgc3R5bGU9J2JhY2tncm91bmQtY29sb3I6IHZhcigtLVNtYXJ0VGhlbWVRdW90ZUNvbG9yKTtib3JkZXItcmFkaXVzOiA1MHB4O3BhZGRpbmc6IDAgNXB4O2hlaWdodDogNTAlOyBmb250LXNpemU6IGNhbGModmFyKC0tbWFpbkZvbnRTaXplKSAqIDAuNyk7Jz5cbiAgICAgICAg5pyA5paw77yaVmVyICR7TEFURVNUX1ZFUlNJT059XG4gICAgICA8L2Rpdj5cbiAgICBgKTtcbn1cblxuLyoqXG4gKiDop6PmnpDlj5jmm7Tml6Xlv5flhoXlrrnvvIzmj5Dlj5bkuKTkuKrniYjmnKzkuYvpl7TnmoTml6Xlv5dcbiAqIEBwYXJhbSBjaGFuZ2Vsb2dDb250ZW50IOWPmOabtOaXpeW/l+eahOWujOaVtOWGheWuuVxuICogQHBhcmFtIGN1cnJlbnRWZXJzaW9uIOW9k+WJjeeJiOacrOWPt1xuICogQHBhcmFtIGxhdGVzdFZlcnNpb24g5pyA5paw54mI5pys5Y+3XG4gKiBAcmV0dXJucyDkuKTkuKrniYjmnKzkuYvpl7TnmoTml6Xlv5flhoXlrrlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlQ2hhbmdlbG9nQmV0d2VlblZlcnNpb25zKFxuICBjaGFuZ2Vsb2dDb250ZW50OiBzdHJpbmcsXG4gIGN1cnJlbnRWZXJzaW9uOiBzdHJpbmcsXG4gIGxhdGVzdFZlcnNpb246IHN0cmluZyxcbik6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gIC8vIOafpeaJvuaJgOacieeJiOacrOagh+mimO+8jOaUr+aMgeWkmuenjU1hcmtkb3du5qCH6aKY5qC85byPXG4gIC8vIOWMuemFjSAjIyDniYjmnKzlj7cg5oiWICMg54mI5pys5Y+3IOaIliBb54mI5pys5Y+3XSDnrYnmoLzlvI9cbiAgY29uc3QgdmVyc2lvblJlZ2V4ID0gLyg/Ol58XFxuKSg/OiN7MSwzfVxccyp8XFxbKShbMC05XStcXC5bMC05XStcXC5bMC05XSspKD86XFxdfFxcc3wkKS9nO1xuICBjb25zdCBtYXRjaGVzID0gWy4uLmNoYW5nZWxvZ0NvbnRlbnQubWF0Y2hBbGwodmVyc2lvblJlZ2V4KV07XG5cbiAgaWYgKG1hdGNoZXMubGVuZ3RoID09PSAwKSB7XG4gICAgdG9hc3RyLmVycm9yKCfml6Dms5Xmib7liLDniYjmnKzml6Xlv5fjgIInKTtcbiAgICByZXR1cm47XG4gIH1cblxuICAvLyDmr5TovoPlvZPliY3niYjmnKzlkozmnIDmlrDniYjmnKxcbiAgY29uc3QgY29tcGFyaXNvblJlc3VsdCA9IGNvbXBhcmVTZW1WZXIobGF0ZXN0VmVyc2lvbiwgY3VycmVudFZlcnNpb24pO1xuICBsZXQgZXh0cmFjdGVkQ29udGVudCA9ICcnO1xuXG4gIGlmIChjb21wYXJpc29uUmVzdWx0IDw9IDApIHtcbiAgICAvLyDlvZPliY3niYjmnKzlpKfkuo7miJbnrYnkuo7mnIDmlrDniYjmnKzvvIzlj6rov5Tlm57mnIDmlrDniYjmnKznmoTml6Xlv5dcbiAgICBjb25zdCBsYXRlc3RWZXJzaW9uTWF0Y2ggPSBtYXRjaGVzLmZpbmQobWF0Y2ggPT4gbWF0Y2hbMV0gPT09IGxhdGVzdFZlcnNpb24pO1xuICAgIGlmICghbGF0ZXN0VmVyc2lvbk1hdGNoKSB7XG4gICAgICB0b2FzdHIuZXJyb3IoJ+iOt+WPluabtOaWsOaXpeW/l+Wksei0pScpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHN0YXJ0SW5kZXggPSBsYXRlc3RWZXJzaW9uTWF0Y2guaW5kZXg7XG4gICAgY29uc3QgbmV4dFZlcnNpb25NYXRjaCA9IG1hdGNoZXMuZmluZChtYXRjaCA9PiBtYXRjaC5pbmRleCA+IHN0YXJ0SW5kZXgpO1xuICAgIGNvbnN0IGVuZEluZGV4ID0gbmV4dFZlcnNpb25NYXRjaCA/IG5leHRWZXJzaW9uTWF0Y2guaW5kZXggOiBjaGFuZ2Vsb2dDb250ZW50Lmxlbmd0aDtcblxuICAgIGV4dHJhY3RlZENvbnRlbnQgPSBjaGFuZ2Vsb2dDb250ZW50LnN1YnN0cmluZyhzdGFydEluZGV4LCBlbmRJbmRleCkudHJpbSgpO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IGN1cnJlbnRWZXJzaW9uTWF0Y2ggPSBtYXRjaGVzLmZpbmQobWF0Y2ggPT4gbWF0Y2hbMV0gPT09IGN1cnJlbnRWZXJzaW9uKTtcbiAgICBpZiAoIWN1cnJlbnRWZXJzaW9uTWF0Y2gpIHtcbiAgICAgIHRvYXN0ci5lcnJvcihg5peg5rOV5om+5Yiw54mI5pysICR7Y3VycmVudFZlcnNpb259IOeahOaXpeW/l+OAgmApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGxhdGVzdFZlcnNpb25NYXRjaCA9IG1hdGNoZXMuZmluZChtYXRjaCA9PiBtYXRjaFsxXSA9PT0gbGF0ZXN0VmVyc2lvbik7XG4gICAgaWYgKCFsYXRlc3RWZXJzaW9uTWF0Y2gpIHtcbiAgICAgIHRvYXN0ci5lcnJvcihg5peg5rOV5om+5Yiw54mI5pysICR7bGF0ZXN0VmVyc2lvbn0g55qE5pel5b+X44CCYCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3Qgc3RhcnRJbmRleCA9IGN1cnJlbnRWZXJzaW9uTWF0Y2guaW5kZXg7XG4gICAgY29uc3QgZW5kSW5kZXggPSBsYXRlc3RWZXJzaW9uTWF0Y2guaW5kZXg7XG5cbiAgICBleHRyYWN0ZWRDb250ZW50ID0gY2hhbmdlbG9nQ29udGVudC5zdWJzdHJpbmcoc3RhcnRJbmRleCwgZW5kSW5kZXgpLnRyaW0oKTtcbiAgfVxuXG4gIHJldHVybiByZW5kZXJNYXJrZG93bihleHRyYWN0ZWRDb250ZW50KTtcbn1cblxuLyoqXG4gKiDlvLnlh7pjaGFuZ2VMb2fnmoRwb3B1cFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlVXBkYXRlQnV0dG9uKCkge1xuICBpZiAoIUNIQU5HRUxPR19DT05URU5UKSB7XG4gICAgYXdhaXQgZ2V0Q2hhbmdlbG9nKCk7XG4gIH1cbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2FsbEdlbmVyaWNQb3B1cChDSEFOR0VMT0dfQ09OVEVOVCwgUE9QVVBfVFlQRS5DT05GSVJNLCAnJywge1xuICAgIG9rQnV0dG9uOiAn5pu05pawJyxcbiAgICBjYW5jZWxCdXR0b246ICflj5bmtognLFxuICB9KTtcbiAgaWYgKHJlc3VsdCkge1xuICAgIHRvYXN0ci5pbmZvKCfmm7TmlrDkuK3igKbigKYnKTtcbiAgICBhd2FpdCB1cGRhdGVUYXZlcm5IZWxwZXIoKTtcbiAgfVxufVxuXG4vKipcbiAqIOiOt+WPluWPmOabtOaXpeW/l1xuICogQHJldHVybnMg5Lik5Liq54mI5pys5LmL6Ze055qE5pel5b+X5YaF5a65XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDaGFuZ2Vsb2coKSB7XG4gIHRvYXN0ci5pbmZvKCfojrflj5bmm7TmlrDml6Xlv5fkuK3igKbigKYnKTtcbiAgY29uc3QgY2hhbmdlbG9nQ29udGVudCA9IGF3YWl0IGZldGNoUmF3RmlsZUNvbnRlbnRGcm9tR2l0TGFiKENIQU5HRUxPR19GSUxFX1BBVEhfR0lUTEFCKTtcbiAgaWYgKExBVEVTVF9WRVJTSU9OID09PSB1bmRlZmluZWQpIHtcbiAgICBMQVRFU1RfVkVSU0lPTiA9IHBhcnNlVmVyc2lvbkZyb21GaWxlKGF3YWl0IGZldGNoUmF3RmlsZUNvbnRlbnRGcm9tR2l0TGFiKFZFUlNJT05fRklMRV9QQVRIX0dJVExBQikpO1xuICB9XG5cbiAgaWYgKENVUlJFTlRfVkVSU0lPTiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgQ1VSUkVOVF9WRVJTSU9OID0gcGFyc2VWZXJzaW9uRnJvbUZpbGUoYXdhaXQgZ2V0RmlsZUNvbnRlbnRCeVBhdGgoVkVSU0lPTl9GSUxFX1BBVEgpKTtcbiAgfVxuXG4gIGNvbnN0IGxvZ3MgPSBwYXJzZUNoYW5nZWxvZ0JldHdlZW5WZXJzaW9ucyhjaGFuZ2Vsb2dDb250ZW50LCBDVVJSRU5UX1ZFUlNJT04sIExBVEVTVF9WRVJTSU9OKTtcbiAgaWYgKCFsb2dzKSB7XG4gICAgdG9hc3RyLmVycm9yKCfml6Dms5Xojrflj5bmm7TmlrDml6Xlv5cnKTtcbiAgICByZXR1cm47XG4gIH0gZWxzZSB7XG4gICAgQ0hBTkdFTE9HX0NPTlRFTlQgPSBsb2dzO1xuICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGluc3RhbGxfZXh0ZW5zaW9uKHVybDogc3RyaW5nLCBnbG9iYWw6IGJvb2xlYW4pOiBQcm9taXNlPFJlc3BvbnNlPiB7XG4gIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJy9hcGkvZXh0ZW5zaW9ucy9pbnN0YWxsJywge1xuICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgIGhlYWRlcnM6IGdldFJlcXVlc3RIZWFkZXJzKCksXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyB1cmwsIGdsb2JhbCB9KSxcbiAgfSk7XG4gIHJldHVybiByZXNwb25zZTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gdW5pbnN0YWxsX2V4dGVuc2lvbihleHRlbnNpb25fbmFtZTogc3RyaW5nLCBnbG9iYWw6IGJvb2xlYW4pOiBQcm9taXNlPFJlc3BvbnNlPiB7XG4gIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJy9hcGkvZXh0ZW5zaW9ucy9kZWxldGUnLCB7XG4gICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgaGVhZGVyczogZ2V0UmVxdWVzdEhlYWRlcnMoKSxcbiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGV4dGVuc2lvbk5hbWU6IGV4dGVuc2lvbl9uYW1lLCBnbG9iYWwgfSksXG4gIH0pO1xuICByZXR1cm4gcmVzcG9uc2U7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHJlaW5zdGFsbF9leHRlbnNpb24oZXh0ZW5zaW9uX25hbWU6IHN0cmluZywgZ2xvYmFsOiBib29sZWFuKTogUHJvbWlzZTxSZXNwb25zZT4ge1xuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHVuaW5zdGFsbF9leHRlbnNpb24oZXh0ZW5zaW9uX25hbWUsIGdsb2JhbCk7XG4gIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICByZXR1cm4gcmVzcG9uc2U7XG4gIH1cbiAgcmV0dXJuIGluc3RhbGxfZXh0ZW5zaW9uKGV4dGVuc2lvbl9uYW1lLCBnbG9iYWwpO1xufVxuXG5hc3luYyBmdW5jdGlvbiB1cGRhdGVfZXh0ZW5zaW9uKGV4dGVuc2lvbl9uYW1lOiBzdHJpbmcsIGdsb2JhbDogYm9vbGVhbik6IFByb21pc2U8UmVzcG9uc2U+IHtcbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnL2FwaS9leHRlbnNpb25zL3VwZGF0ZScsIHtcbiAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICBoZWFkZXJzOiBnZXRSZXF1ZXN0SGVhZGVycygpLFxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgZXh0ZW5zaW9uTmFtZTogZXh0ZW5zaW9uX25hbWUsIGdsb2JhbCB9KSxcbiAgfSk7XG4gIHJldHVybiByZXNwb25zZTtcbn1cblxuLyoqXG4gKiDmm7TmlrDphZLppobliqnmiYtcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVRhdmVybkhlbHBlcigpIHtcbiAgY29uc3QgZ2xvYmFsID0gZ2V0RXh0ZW5zaW9uVHlwZShleHRlbnNpb25OYW1lKSA9PT0gJ2dsb2JhbCcgPyB0cnVlIDogZmFsc2U7XG5cbiAgY29uc3QgcmVsb2FkID0gKCkgPT4ge1xuICAgIHRvYXN0ci5zdWNjZXNzKGDmiJDlip/mm7TmlrDphZLppobliqnmiYssIOWHhuWkh+WIt+aWsOmhtemdouS7peeUn+aViC4uLmApO1xuICAgIGxvZy5pbmZvKGDmiJDlip/mm7TmlrDphZLppobliqnmiYssIOWHhuWkh+WIt+aWsOmhtemdouS7peeUn+aViC4uLmApO1xuICAgIHNldFRpbWVvdXQoKCkgPT4gbG9jYXRpb24ucmVsb2FkKCksIDMwMDApO1xuICB9O1xuXG4gIGNvbnN0IHVwZGF0ZV9yZXNwb25zZSA9IGF3YWl0IHVwZGF0ZV9leHRlbnNpb24oZXh0ZW5zaW9uTmFtZSwgZ2xvYmFsKTtcbiAgaWYgKHVwZGF0ZV9yZXNwb25zZS5vaykge1xuICAgIGlmICgoYXdhaXQgdXBkYXRlX3Jlc3BvbnNlLmpzb24oKSkuaXNVcFRvRGF0ZSkge1xuICAgICAgdG9hc3RyLnN1Y2Nlc3MoYOmFkummhuWKqeaJi+W3suaYr+acgOaWsOeJiOacrCwg5peg6ZyA5pu05pawYCk7XG4gICAgICBsb2cuaW5mbyhg6YWS6aaG5Yqp5omL5bey5piv5pyA5paw54mI5pysLCDml6DpnIDmm7TmlrBgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVsb2FkKCk7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIGNvbnN0IGNvbWZpcm1fcmVpbnN0YWxsID0gYXdhaXQgY2FsbEdlbmVyaWNQb3B1cChcbiAgICBg5pu05paw5aSx6LSlOiAkeyhhd2FpdCB1cGRhdGVfcmVzcG9uc2UudGV4dCgpKSB8fCB1cGRhdGVfcmVzcG9uc2Uuc3RhdHVzVGV4dH1cbiAg5piv5ZCm5bCd6K+V6YCa6L+H5Y246L296YeN6KOF5p2l5pu05pawP1xuICAo5Y+v6IO95Zug5Li6572R57uc6Zeu6aKY6ICM5Y+q5Y246L295LqG5rKh6IO96YeN6KOFLCDor7flhYjlpI3liLYgXFxgaHR0cHM6Ly9naXRsYWIuY29tL25vdmkwMjgvSlMtU2xhc2gtUnVubmVyXFxgKVxuICBgLFxuICAgIFBPUFVQX1RZUEUuQ09ORklSTSxcbiAgKTtcbiAgaWYgKCFjb21maXJtX3JlaW5zdGFsbCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IHJlaW5zdGFsbF9yZXNwb25zZSA9IGF3YWl0IHJlaW5zdGFsbF9leHRlbnNpb24oZXh0ZW5zaW9uTmFtZSwgZ2xvYmFsKTtcbiAgaWYgKCFyZWluc3RhbGxfcmVzcG9uc2Uub2spIHtcbiAgICBjb25zdCB0ZXh0ID0gYXdhaXQgcmVpbnN0YWxsX3Jlc3BvbnNlLnRleHQoKTtcbiAgICB0b2FzdHIuZXJyb3IodGV4dCB8fCByZWluc3RhbGxfcmVzcG9uc2Uuc3RhdHVzVGV4dCwgdGDmm7TmlrDphZLppobliqnmiYvlpLHotKVgLCB7IHRpbWVPdXQ6IDUwMDAgfSk7XG4gICAgbG9nLmVycm9yKGDmm7TmlrDphZLppobliqnmiYvlpLHotKU6ICR7dGV4dH1gKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICByZWxvYWQoKTtcbiAgcmV0dXJuIHRydWU7XG59XG5cbi8vIOmFkummhuWOn+S7o+eggeWkjeWItuadpeeahFxuLyoqXG4gKiBHZXRzIHRoZSB0eXBlIG9mIGFuIGV4dGVuc2lvbiBiYXNlZCBvbiBpdHMgZXh0ZXJuYWwgSUQuXG4gKiBAcGFyYW0ge3N0cmluZ30gZXh0ZXJuYWxJZCBFeHRlcm5hbCBJRCBvZiB0aGUgZXh0ZW5zaW9uIChleGNsdWRpbmcgb3IgaW5jbHVkaW5nIHRoZSBsZWFkaW5nICd0aGlyZC1wYXJ0eS8nKVxuICogQHJldHVybnMge3N0cmluZ30gVHlwZSBvZiB0aGUgZXh0ZW5zaW9uIChnbG9iYWwsIGxvY2FsLCBzeXN0ZW0sIG9yIGVtcHR5IHN0cmluZyBpZiBub3QgZm91bmQpXG4gKi9cbmZ1bmN0aW9uIGdldEV4dGVuc2lvblR5cGUoZXh0ZXJuYWxJZDogc3RyaW5nKSB7XG4gIGNvbnN0IGlkID0gT2JqZWN0LmtleXMoZXh0ZW5zaW9uVHlwZXMpLmZpbmQoXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXNoYWRvd1xuICAgIChpZDogc3RyaW5nKSA9PiBpZCA9PT0gZXh0ZXJuYWxJZCB8fCAoaWQuc3RhcnRzV2l0aCgndGhpcmQtcGFydHknKSAmJiBpZC5lbmRzV2l0aChleHRlcm5hbElkKSksXG4gICk7XG4gIHJldHVybiBpZCA/IGV4dGVuc2lvblR5cGVzW2lkXSA6ICdsb2NhbCc7XG59XG5cbi8vIOaXp+eJiOabtOaWsOWQjueUqFxuLyoqXG4gKlxuICovXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzaG93TmV3RmVhdHVyZSgpIHtcbiAgbGV0IGNoYW5nZWxvZ0NvbnRlbnQgPSBhd2FpdCBmZXRjaFJhd0ZpbGVDb250ZW50RnJvbUdpdExhYihDSEFOR0VMT0dfRklMRV9QQVRIX0dJVExBQik7XG4gIGNoYW5nZWxvZ0NvbnRlbnQgPSBjaGFuZ2Vsb2dDb250ZW50ICsgJ1xcblxcbirliY3nq6/liqnmiYvml6fniYjphY3nva7lt7LmuIXpmaTvvIzor7fph43mlrDphY3nva7mianlsZXorr7nva4qJztcbiAgY29uc3QgbG9ncyA9IHBhcnNlQ2hhbmdlbG9nQmV0d2VlblZlcnNpb25zKGNoYW5nZWxvZ0NvbnRlbnQsICczLjAuMCcsICczLjAuMCcpO1xuXG4gIGlmIChsb2dzKSB7XG4gICAgY29uc3QgbW9kaWZpZWRMb2dzID0gbG9ncy5yZXBsYWNlKC88aDIoW14+XSopPihbXjxdKik8XFwvaDI+L2csICc8aDIkMT7phZLppobliqnmiYsgJDI8L2gyPicpO1xuICAgIGF3YWl0IGNhbGxHZW5lcmljUG9wdXAobW9kaWZpZWRMb2dzLCBQT1BVUF9UWVBFLlRFWFQpO1xuICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/util/check_update.ts\n\n}")},"./src/util/collapsible.ts":
/*!*********************************!*\
  !*** ./src/util/collapsible.ts ***!
  \*********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Collapsible: () => (/* binding */ Collapsible)\n/* harmony export */ });\n/**\n * 折叠展开功能类\n */\nclass Collapsible {\n    $container;\n    $header;\n    $content;\n    options;\n    isAnimating = false;\n    /**\n     * 静态方法：初始化所有符合选择器的元素为可折叠元素\n     * @param containerSelector 容器选择器\n     * @param options 配置选项\n     * @returns Collapsible实例数组\n     */\n    static initAll(containerSelector, options = {}) {\n        const instances = [];\n        $(containerSelector).each(function () {\n            instances.push(new Collapsible($(this), options));\n        });\n        return instances;\n    }\n    /**\n     * 构造函数\n     * @param $container 容器元素\n     * @param options 配置选项\n     */\n    constructor($container, options = {}) {\n        this.$container = $container;\n        // 默认配置\n        const defaultOptions = {\n            headerSelector: '.collapsible-header',\n            contentSelector: '.collapsible-content',\n            expandedClass: 'expanded',\n            animationDuration: {\n                expand: 280,\n                collapse: 250,\n            },\n            easingFunction: 'swing',\n            initiallyExpanded: false,\n            callbacks: {},\n        };\n        // 合并配置\n        this.options = { ...defaultOptions, ...options };\n        // 获取元素\n        this.$header = this.$container.find(this.options.headerSelector);\n        this.$content = this.$container.find(this.options.contentSelector);\n        // 初始化事件\n        this.initEvents();\n        // 设置初始状态\n        if (!this.options.initiallyExpanded) {\n            this.$container.removeClass(this.options.expandedClass);\n            this.$content.hide();\n        }\n        else {\n            this.$container.addClass(this.options.expandedClass);\n            this.$content.show();\n        }\n    }\n    /**\n     * 初始化事件\n     */\n    initEvents() {\n        this.$header.on('click', (event) => {\n            // 检查点击是否发生在控件上，如果是则不触发折叠\n            if (this.shouldIgnoreClick(event.target)) {\n                return;\n            }\n            this.toggle();\n        });\n    }\n    /**\n     * 判断点击是否应该被忽略（不触发折叠）\n     * @param target 点击的目标元素\n     * @returns 是否应该忽略点击\n     */\n    shouldIgnoreClick(target) {\n        const $target = $(target);\n        // 检查是否点击在开关或其子元素上\n        if ($target.hasClass('toggle-switch') ||\n            $target.hasClass('toggle-input') ||\n            $target.hasClass('toggle-label') ||\n            $target.hasClass('toggle-handle') ||\n            $target.closest('.toggle-switch').length > 0) {\n            return true;\n        }\n        // 检查是否点击在按钮或其子元素上\n        if ($target.hasClass('menu_button') ||\n            $target.closest('.menu_button').length > 0 ||\n            $target.hasClass('TavernHelper-button') ||\n            $target.closest('.TavernHelper-button').length > 0) {\n            return true;\n        }\n        // 检查是否点击在表单元素上\n        if ($target.is('input, select, textarea, button, a') ||\n            $target.closest('input, select, textarea, button, a').length > 0) {\n            return true;\n        }\n        return false;\n    }\n    /**\n     * 切换展开/折叠状态\n     */\n    toggle() {\n        if (this.isAnimating)\n            return;\n        if (this.$container.hasClass(this.options.expandedClass)) {\n            this.collapse();\n        }\n        else {\n            this.expand();\n        }\n    }\n    /**\n     * 展开内容\n     */\n    expand() {\n        if (this.isAnimating || this.$container.hasClass(this.options.expandedClass))\n            return;\n        this.isAnimating = true;\n        // 执行展开前回调\n        if (this.options.callbacks?.beforeExpand) {\n            this.options.callbacks.beforeExpand();\n        }\n        this.$container.addClass(this.options.expandedClass);\n        this.$content.addClass('animating');\n        this.$content.slideDown({\n            duration: this.options.animationDuration.expand,\n            easing: this.options.easingFunction,\n            start: function () {\n                $(this).css({\n                    opacity: 0,\n                    transform: 'translateY(-10px) scaleY(0.95)',\n                });\n            },\n            progress: function (_animation, progress) {\n                $(this).css({\n                    opacity: progress,\n                    transform: `translateY(${-10 * (1 - progress)}px) scaleY(${0.95 + 0.05 * progress})`,\n                });\n            },\n            complete: () => {\n                this.$content\n                    .css({\n                    opacity: '',\n                    transform: '',\n                })\n                    .removeClass('animating');\n                this.isAnimating = false;\n                // 执行展开后回调\n                if (this.options.callbacks?.afterExpand) {\n                    this.options.callbacks.afterExpand();\n                }\n            },\n        });\n    }\n    /**\n     * 折叠内容\n     */\n    collapse() {\n        if (this.isAnimating || !this.$container.hasClass(this.options.expandedClass))\n            return;\n        this.isAnimating = true;\n        // 执行折叠前回调\n        if (this.options.callbacks?.beforeCollapse) {\n            this.options.callbacks.beforeCollapse();\n        }\n        this.$container.removeClass(this.options.expandedClass);\n        this.$content.addClass('animating');\n        this.$content.slideUp({\n            duration: this.options.animationDuration.collapse,\n            easing: this.options.easingFunction,\n            start: function () {\n                $(this).css({\n                    opacity: 1,\n                    transform: 'translateY(0) scaleY(1)',\n                });\n            },\n            progress: function (_animation, progress) {\n                const inverseProgress = 1 - progress;\n                $(this).css({\n                    opacity: inverseProgress,\n                    transform: `translateY(${-5 * progress}px) scaleY(${1 - 0.05 * progress})`,\n                });\n            },\n            complete: () => {\n                this.$content\n                    .css({\n                    opacity: '',\n                    transform: '',\n                })\n                    .removeClass('animating');\n                this.isAnimating = false;\n                // 执行折叠后回调\n                if (this.options.callbacks?.afterCollapse) {\n                    this.options.callbacks.afterCollapse();\n                }\n            },\n        });\n    }\n    /**\n     * 是否已展开\n     * @returns 是否已展开\n     */\n    isExpanded() {\n        return this.$container.hasClass(this.options.expandedClass);\n    }\n    /**\n     * 销毁实例，移除事件监听\n     */\n    destroy() {\n        this.$header.off('click');\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ZXIvLi9zcmMvdXRpbC9jb2xsYXBzaWJsZS50cz83OTlmIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICog5oqY5Y+g5bGV5byA6YWN572u5o6l5Y+jXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQ29sbGFwc2libGVPcHRpb25zIHtcbiAgLyoqIOinpuWPkeWZqOmAieaLqeWZqCAqL1xuICBoZWFkZXJTZWxlY3Rvcjogc3RyaW5nO1xuICAvKiog5YaF5a656YCJ5oup5ZmoICovXG4gIGNvbnRlbnRTZWxlY3Rvcjogc3RyaW5nO1xuICAvKiog5bGV5byA54q25oCB55qE57G75ZCNICovXG4gIGV4cGFuZGVkQ2xhc3M/OiBzdHJpbmc7XG4gIC8qKiDliqjnlLvmjIHnu63ml7bpl7Qo5q+r56eSKSAqL1xuICBhbmltYXRpb25EdXJhdGlvbj86IHtcbiAgICBleHBhbmQ6IG51bWJlcjtcbiAgICBjb2xsYXBzZTogbnVtYmVyO1xuICB9O1xuICAvKiog5Yqo55S757yT5Yqo5Ye95pWwICovXG4gIGVhc2luZ0Z1bmN0aW9uPzogc3RyaW5nO1xuICAvKiog5Yid5aeL54q25oCB5piv5ZCm5bGV5byAICovXG4gIGluaXRpYWxseUV4cGFuZGVkPzogYm9vbGVhbjtcbiAgLyoqIOWbnuiwg+WHveaVsCAqL1xuICBjYWxsYmFja3M/OiB7XG4gICAgYmVmb3JlRXhwYW5kPzogKCkgPT4gdm9pZDtcbiAgICBhZnRlckV4cGFuZD86ICgpID0+IHZvaWQ7XG4gICAgYmVmb3JlQ29sbGFwc2U/OiAoKSA9PiB2b2lkO1xuICAgIGFmdGVyQ29sbGFwc2U/OiAoKSA9PiB2b2lkO1xuICB9O1xufVxuXG4vKipcbiAqIOaKmOWPoOWxleW8gOWKn+iDveexu1xuICovXG5leHBvcnQgY2xhc3MgQ29sbGFwc2libGUge1xuICBwcml2YXRlICRjb250YWluZXI6IEpRdWVyeTtcbiAgcHJpdmF0ZSAkaGVhZGVyOiBKUXVlcnk7XG4gIHByaXZhdGUgJGNvbnRlbnQ6IEpRdWVyeTtcbiAgcHJpdmF0ZSBvcHRpb25zOiBDb2xsYXBzaWJsZU9wdGlvbnM7XG4gIHByaXZhdGUgaXNBbmltYXRpbmc6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAvKipcbiAgICog6Z2Z5oCB5pa55rOV77ya5Yid5aeL5YyW5omA5pyJ56ym5ZCI6YCJ5oup5Zmo55qE5YWD57Sg5Li65Y+v5oqY5Y+g5YWD57SgXG4gICAqIEBwYXJhbSBjb250YWluZXJTZWxlY3RvciDlrrnlmajpgInmi6nlmahcbiAgICogQHBhcmFtIG9wdGlvbnMg6YWN572u6YCJ6aG5XG4gICAqIEByZXR1cm5zIENvbGxhcHNpYmxl5a6e5L6L5pWw57uEXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGluaXRBbGwoY29udGFpbmVyU2VsZWN0b3I6IHN0cmluZywgb3B0aW9uczogUGFydGlhbDxDb2xsYXBzaWJsZU9wdGlvbnM+ID0ge30pOiBDb2xsYXBzaWJsZVtdIHtcbiAgICBjb25zdCBpbnN0YW5jZXM6IENvbGxhcHNpYmxlW10gPSBbXTtcbiAgICAkKGNvbnRhaW5lclNlbGVjdG9yKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIGluc3RhbmNlcy5wdXNoKG5ldyBDb2xsYXBzaWJsZSgkKHRoaXMpLCBvcHRpb25zKSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGluc3RhbmNlcztcbiAgfVxuXG4gIC8qKlxuICAgKiDmnoTpgKDlh73mlbBcbiAgICogQHBhcmFtICRjb250YWluZXIg5a655Zmo5YWD57SgXG4gICAqIEBwYXJhbSBvcHRpb25zIOmFjee9rumAiemhuVxuICAgKi9cbiAgY29uc3RydWN0b3IoJGNvbnRhaW5lcjogSlF1ZXJ5LCBvcHRpb25zOiBQYXJ0aWFsPENvbGxhcHNpYmxlT3B0aW9ucz4gPSB7fSkge1xuICAgIHRoaXMuJGNvbnRhaW5lciA9ICRjb250YWluZXI7XG5cbiAgICAvLyDpu5jorqTphY3nva5cbiAgICBjb25zdCBkZWZhdWx0T3B0aW9uczogQ29sbGFwc2libGVPcHRpb25zID0ge1xuICAgICAgaGVhZGVyU2VsZWN0b3I6ICcuY29sbGFwc2libGUtaGVhZGVyJyxcbiAgICAgIGNvbnRlbnRTZWxlY3RvcjogJy5jb2xsYXBzaWJsZS1jb250ZW50JyxcbiAgICAgIGV4cGFuZGVkQ2xhc3M6ICdleHBhbmRlZCcsXG4gICAgICBhbmltYXRpb25EdXJhdGlvbjoge1xuICAgICAgICBleHBhbmQ6IDI4MCxcbiAgICAgICAgY29sbGFwc2U6IDI1MCxcbiAgICAgIH0sXG4gICAgICBlYXNpbmdGdW5jdGlvbjogJ3N3aW5nJyxcbiAgICAgIGluaXRpYWxseUV4cGFuZGVkOiBmYWxzZSxcbiAgICAgIGNhbGxiYWNrczoge30sXG4gICAgfTtcblxuICAgIC8vIOWQiOW5tumFjee9rlxuICAgIHRoaXMub3B0aW9ucyA9IHsgLi4uZGVmYXVsdE9wdGlvbnMsIC4uLm9wdGlvbnMgfTtcblxuICAgIC8vIOiOt+WPluWFg+e0oFxuICAgIHRoaXMuJGhlYWRlciA9IHRoaXMuJGNvbnRhaW5lci5maW5kKHRoaXMub3B0aW9ucy5oZWFkZXJTZWxlY3Rvcik7XG4gICAgdGhpcy4kY29udGVudCA9IHRoaXMuJGNvbnRhaW5lci5maW5kKHRoaXMub3B0aW9ucy5jb250ZW50U2VsZWN0b3IpO1xuXG4gICAgLy8g5Yid5aeL5YyW5LqL5Lu2XG4gICAgdGhpcy5pbml0RXZlbnRzKCk7XG5cbiAgICAvLyDorr7nva7liJ3lp4vnirbmgIFcbiAgICBpZiAoIXRoaXMub3B0aW9ucy5pbml0aWFsbHlFeHBhbmRlZCkge1xuICAgICAgdGhpcy4kY29udGFpbmVyLnJlbW92ZUNsYXNzKHRoaXMub3B0aW9ucy5leHBhbmRlZENsYXNzKTtcbiAgICAgIHRoaXMuJGNvbnRlbnQuaGlkZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLiRjb250YWluZXIuYWRkQ2xhc3ModGhpcy5vcHRpb25zLmV4cGFuZGVkQ2xhc3MhKTtcbiAgICAgIHRoaXMuJGNvbnRlbnQuc2hvdygpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDliJ3lp4vljJbkuovku7ZcbiAgICovXG4gIHByaXZhdGUgaW5pdEV2ZW50cygpOiB2b2lkIHtcbiAgICB0aGlzLiRoZWFkZXIub24oJ2NsaWNrJywgKGV2ZW50OiBKUXVlcnkuQ2xpY2tFdmVudCkgPT4ge1xuICAgICAgLy8g5qOA5p+l54K55Ye75piv5ZCm5Y+R55Sf5Zyo5o6n5Lu25LiK77yM5aaC5p6c5piv5YiZ5LiN6Kem5Y+R5oqY5Y+gXG4gICAgICBpZiAodGhpcy5zaG91bGRJZ25vcmVDbGljayhldmVudC50YXJnZXQpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRoaXMudG9nZ2xlKCk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog5Yik5pat54K55Ye75piv5ZCm5bqU6K+l6KKr5b+955Wl77yI5LiN6Kem5Y+R5oqY5Y+g77yJXG4gICAqIEBwYXJhbSB0YXJnZXQg54K55Ye755qE55uu5qCH5YWD57SgXG4gICAqIEByZXR1cm5zIOaYr+WQpuW6lOivpeW/veeVpeeCueWHu1xuICAgKi9cbiAgcHJpdmF0ZSBzaG91bGRJZ25vcmVDbGljayh0YXJnZXQ6IEV2ZW50VGFyZ2V0KTogYm9vbGVhbiB7XG4gICAgY29uc3QgJHRhcmdldCA9ICQodGFyZ2V0KTtcblxuICAgIC8vIOajgOafpeaYr+WQpueCueWHu+WcqOW8gOWFs+aIluWFtuWtkOWFg+e0oOS4ilxuICAgIGlmIChcbiAgICAgICR0YXJnZXQuaGFzQ2xhc3MoJ3RvZ2dsZS1zd2l0Y2gnKSB8fFxuICAgICAgJHRhcmdldC5oYXNDbGFzcygndG9nZ2xlLWlucHV0JykgfHxcbiAgICAgICR0YXJnZXQuaGFzQ2xhc3MoJ3RvZ2dsZS1sYWJlbCcpIHx8XG4gICAgICAkdGFyZ2V0Lmhhc0NsYXNzKCd0b2dnbGUtaGFuZGxlJykgfHxcbiAgICAgICR0YXJnZXQuY2xvc2VzdCgnLnRvZ2dsZS1zd2l0Y2gnKS5sZW5ndGggPiAwXG4gICAgKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICAvLyDmo4Dmn6XmmK/lkKbngrnlh7vlnKjmjInpkq7miJblhbblrZDlhYPntKDkuIpcbiAgICBpZiAoXG4gICAgICAkdGFyZ2V0Lmhhc0NsYXNzKCdtZW51X2J1dHRvbicpIHx8XG4gICAgICAkdGFyZ2V0LmNsb3Nlc3QoJy5tZW51X2J1dHRvbicpLmxlbmd0aCA+IDAgfHxcbiAgICAgICR0YXJnZXQuaGFzQ2xhc3MoJ1RhdmVybkhlbHBlci1idXR0b24nKSB8fFxuICAgICAgJHRhcmdldC5jbG9zZXN0KCcuVGF2ZXJuSGVscGVyLWJ1dHRvbicpLmxlbmd0aCA+IDBcbiAgICApIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIC8vIOajgOafpeaYr+WQpueCueWHu+WcqOihqOWNleWFg+e0oOS4ilxuICAgIGlmIChcbiAgICAgICR0YXJnZXQuaXMoJ2lucHV0LCBzZWxlY3QsIHRleHRhcmVhLCBidXR0b24sIGEnKSB8fFxuICAgICAgJHRhcmdldC5jbG9zZXN0KCdpbnB1dCwgc2VsZWN0LCB0ZXh0YXJlYSwgYnV0dG9uLCBhJykubGVuZ3RoID4gMFxuICAgICkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgLyoqXG4gICAqIOWIh+aNouWxleW8gC/mipjlj6DnirbmgIFcbiAgICovXG4gIHB1YmxpYyB0b2dnbGUoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuaXNBbmltYXRpbmcpIHJldHVybjtcblxuICAgIGlmICh0aGlzLiRjb250YWluZXIuaGFzQ2xhc3ModGhpcy5vcHRpb25zLmV4cGFuZGVkQ2xhc3MhKSkge1xuICAgICAgdGhpcy5jb2xsYXBzZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmV4cGFuZCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDlsZXlvIDlhoXlrrlcbiAgICovXG4gIHB1YmxpYyBleHBhbmQoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuaXNBbmltYXRpbmcgfHwgdGhpcy4kY29udGFpbmVyLmhhc0NsYXNzKHRoaXMub3B0aW9ucy5leHBhbmRlZENsYXNzISkpIHJldHVybjtcblxuICAgIHRoaXMuaXNBbmltYXRpbmcgPSB0cnVlO1xuXG4gICAgLy8g5omn6KGM5bGV5byA5YmN5Zue6LCDXG4gICAgaWYgKHRoaXMub3B0aW9ucy5jYWxsYmFja3M/LmJlZm9yZUV4cGFuZCkge1xuICAgICAgdGhpcy5vcHRpb25zLmNhbGxiYWNrcy5iZWZvcmVFeHBhbmQoKTtcbiAgICB9XG5cbiAgICB0aGlzLiRjb250YWluZXIuYWRkQ2xhc3ModGhpcy5vcHRpb25zLmV4cGFuZGVkQ2xhc3MhKTtcbiAgICB0aGlzLiRjb250ZW50LmFkZENsYXNzKCdhbmltYXRpbmcnKTtcblxuICAgIHRoaXMuJGNvbnRlbnQuc2xpZGVEb3duKHtcbiAgICAgIGR1cmF0aW9uOiB0aGlzLm9wdGlvbnMuYW5pbWF0aW9uRHVyYXRpb24hLmV4cGFuZCxcbiAgICAgIGVhc2luZzogdGhpcy5vcHRpb25zLmVhc2luZ0Z1bmN0aW9uLFxuICAgICAgc3RhcnQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJCh0aGlzKS5jc3Moe1xuICAgICAgICAgIG9wYWNpdHk6IDAsXG4gICAgICAgICAgdHJhbnNmb3JtOiAndHJhbnNsYXRlWSgtMTBweCkgc2NhbGVZKDAuOTUpJyxcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgcHJvZ3Jlc3M6IGZ1bmN0aW9uIChfYW5pbWF0aW9uLCBwcm9ncmVzcykge1xuICAgICAgICAkKHRoaXMpLmNzcyh7XG4gICAgICAgICAgb3BhY2l0eTogcHJvZ3Jlc3MsXG4gICAgICAgICAgdHJhbnNmb3JtOiBgdHJhbnNsYXRlWSgkey0xMCAqICgxIC0gcHJvZ3Jlc3MpfXB4KSBzY2FsZVkoJHswLjk1ICsgMC4wNSAqIHByb2dyZXNzfSlgLFxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBjb21wbGV0ZTogKCkgPT4ge1xuICAgICAgICB0aGlzLiRjb250ZW50XG4gICAgICAgICAgLmNzcyh7XG4gICAgICAgICAgICBvcGFjaXR5OiAnJyxcbiAgICAgICAgICAgIHRyYW5zZm9ybTogJycsXG4gICAgICAgICAgfSlcbiAgICAgICAgICAucmVtb3ZlQ2xhc3MoJ2FuaW1hdGluZycpO1xuXG4gICAgICAgIHRoaXMuaXNBbmltYXRpbmcgPSBmYWxzZTtcblxuICAgICAgICAvLyDmiafooYzlsZXlvIDlkI7lm57osINcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5jYWxsYmFja3M/LmFmdGVyRXhwYW5kKSB7XG4gICAgICAgICAgdGhpcy5vcHRpb25zLmNhbGxiYWNrcy5hZnRlckV4cGFuZCgpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOaKmOWPoOWGheWuuVxuICAgKi9cbiAgcHVibGljIGNvbGxhcHNlKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmlzQW5pbWF0aW5nIHx8ICF0aGlzLiRjb250YWluZXIuaGFzQ2xhc3ModGhpcy5vcHRpb25zLmV4cGFuZGVkQ2xhc3MhKSkgcmV0dXJuO1xuXG4gICAgdGhpcy5pc0FuaW1hdGluZyA9IHRydWU7XG5cbiAgICAvLyDmiafooYzmipjlj6DliY3lm57osINcbiAgICBpZiAodGhpcy5vcHRpb25zLmNhbGxiYWNrcz8uYmVmb3JlQ29sbGFwc2UpIHtcbiAgICAgIHRoaXMub3B0aW9ucy5jYWxsYmFja3MuYmVmb3JlQ29sbGFwc2UoKTtcbiAgICB9XG5cbiAgICB0aGlzLiRjb250YWluZXIucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLmV4cGFuZGVkQ2xhc3MhKTtcbiAgICB0aGlzLiRjb250ZW50LmFkZENsYXNzKCdhbmltYXRpbmcnKTtcblxuICAgIHRoaXMuJGNvbnRlbnQuc2xpZGVVcCh7XG4gICAgICBkdXJhdGlvbjogdGhpcy5vcHRpb25zLmFuaW1hdGlvbkR1cmF0aW9uIS5jb2xsYXBzZSxcbiAgICAgIGVhc2luZzogdGhpcy5vcHRpb25zLmVhc2luZ0Z1bmN0aW9uLFxuICAgICAgc3RhcnQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJCh0aGlzKS5jc3Moe1xuICAgICAgICAgIG9wYWNpdHk6IDEsXG4gICAgICAgICAgdHJhbnNmb3JtOiAndHJhbnNsYXRlWSgwKSBzY2FsZVkoMSknLFxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBwcm9ncmVzczogZnVuY3Rpb24gKF9hbmltYXRpb24sIHByb2dyZXNzKSB7XG4gICAgICAgIGNvbnN0IGludmVyc2VQcm9ncmVzcyA9IDEgLSBwcm9ncmVzcztcbiAgICAgICAgJCh0aGlzKS5jc3Moe1xuICAgICAgICAgIG9wYWNpdHk6IGludmVyc2VQcm9ncmVzcyxcbiAgICAgICAgICB0cmFuc2Zvcm06IGB0cmFuc2xhdGVZKCR7LTUgKiBwcm9ncmVzc31weCkgc2NhbGVZKCR7MSAtIDAuMDUgKiBwcm9ncmVzc30pYCxcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgY29tcGxldGU6ICgpID0+IHtcbiAgICAgICAgdGhpcy4kY29udGVudFxuICAgICAgICAgIC5jc3Moe1xuICAgICAgICAgICAgb3BhY2l0eTogJycsXG4gICAgICAgICAgICB0cmFuc2Zvcm06ICcnLFxuICAgICAgICAgIH0pXG4gICAgICAgICAgLnJlbW92ZUNsYXNzKCdhbmltYXRpbmcnKTtcblxuICAgICAgICB0aGlzLmlzQW5pbWF0aW5nID0gZmFsc2U7XG5cbiAgICAgICAgLy8g5omn6KGM5oqY5Y+g5ZCO5Zue6LCDXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuY2FsbGJhY2tzPy5hZnRlckNvbGxhcHNlKSB7XG4gICAgICAgICAgdGhpcy5vcHRpb25zLmNhbGxiYWNrcy5hZnRlckNvbGxhcHNlKCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog5piv5ZCm5bey5bGV5byAXG4gICAqIEByZXR1cm5zIOaYr+WQpuW3suWxleW8gFxuICAgKi9cbiAgcHVibGljIGlzRXhwYW5kZWQoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuJGNvbnRhaW5lci5oYXNDbGFzcyh0aGlzLm9wdGlvbnMuZXhwYW5kZWRDbGFzcyEpO1xuICB9XG5cbiAgLyoqXG4gICAqIOmUgOavgeWunuS+i++8jOenu+mZpOS6i+S7tuebkeWQrFxuICAgKi9cbiAgcHVibGljIGRlc3Ryb3koKTogdm9pZCB7XG4gICAgdGhpcy4kaGVhZGVyLm9mZignY2xpY2snKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/util/collapsible.ts\n\n}")},"./src/util/extension_variables.ts":
/*!*****************************************!*\
  !*** ./src/util/extension_variables.ts ***!
  \*****************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   charsPath: () => (/* binding */ charsPath),\n/* harmony export */   extensionFolderPath: () => (/* binding */ extensionFolderPath),\n/* harmony export */   extensionName: () => (/* binding */ extensionName),\n/* harmony export */   extensionSettingName: () => (/* binding */ extensionSettingName),\n/* harmony export */   getCharAvatarPath: () => (/* binding */ getCharAvatarPath),\n/* harmony export */   getOrSaveSettingValue: () => (/* binding */ getOrSaveSettingValue),\n/* harmony export */   getSettingValue: () => (/* binding */ getSettingValue),\n/* harmony export */   getUserAvatarPath: () => (/* binding */ getUserAvatarPath),\n/* harmony export */   saveSettingValue: () => (/* binding */ saveSettingValue)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n// TODO: 为设置变量添加类型而非使用 any\n\n\nconst extensionName = 'JS-Slash-Runner';\nconst extensionSettingName = 'TavernHelper';\nconst extensionFolderPath = `third-party/${extensionName}`;\n// 获取头像原图\nconst charsPath = '/characters/';\nconst getUserAvatarPath = () => `./User Avatars/${_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.user_avatar}`;\nconst getCharAvatarPath = () => {\n    //@ts-ignore\n    const thumbnailPath = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.getThumbnailUrl)('avatar', _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid]?.avatar || _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid]?.name || '');\n    const targetAvatarImg = thumbnailPath.substring(thumbnailPath.lastIndexOf('=') + 1);\n    return charsPath + targetAvatarImg;\n};\n/**\n * 获取扩展设置变量的值\n *\n * @param path 设置变量的键\n * @param default_value 没有该键时的默认值\n * @returns 设置变量的值\n */\nfunction getSettingValue(path, default_value = undefined) {\n    // @ts-ignore\n    return _.get(_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__.extension_settings[extensionSettingName], path, default_value);\n}\n/**\n * 保存扩展设置变量的值\n *\n * @param path 设置变量的键\n * @param value 设置变量的值\n * @returns 设置变量的值\n */\nfunction saveSettingValue(path, value) {\n    // @ts-ignore\n    _.set(_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__.extension_settings[extensionSettingName], path, value);\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveSettingsDebounced)();\n    return value;\n}\n/**\n * 如果扩展有某设置变量，则返回该设置变量的值，否则设置该设置变量的值为 `default_value`\n *\n * @param path 设置变量的键\n * @param default_value 扩展没有该设置变量时应该设置并返回的默认值\n * @returns 设置变量的值\n */\nasync function getOrSaveSettingValue(path, default_value) {\n    // @ts-ignore\n    if (_.has(_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__.extension_settings[extensionSettingName], path)) {\n        return getSettingValue(path);\n    }\n    return saveSettingValue(path, default_value);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvdXRpbC9leHRlbnNpb25fdmFyaWFibGVzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQUEsMEJBQTBCO0FBQ3VGO0FBQzVDO0FBRTlELE1BQU0sYUFBYSxHQUFHLGlCQUFpQixDQUFDO0FBQ3hDLE1BQU0sb0JBQW9CLEdBQUcsY0FBYyxDQUFDO0FBRTVDLE1BQU0sbUJBQW1CLEdBQUcsZUFBZSxhQUFhLEVBQUUsQ0FBQztBQUVsRSxTQUFTO0FBQ0YsTUFBTSxTQUFTLEdBQUcsY0FBYyxDQUFDO0FBQ2pDLE1BQU0saUJBQWlCLEdBQUcsR0FBRyxFQUFFLENBQUMsa0JBQWtCLDREQUFXLEVBQUUsQ0FBQztBQUNoRSxNQUFNLGlCQUFpQixHQUFHLEdBQUcsRUFBRTtJQUNwQyxZQUFZO0lBQ1osTUFBTSxhQUFhLEdBQUcsb0VBQWUsQ0FBQyxRQUFRLEVBQUUsMkRBQVUsQ0FBQywwREFBUyxDQUFDLEVBQUUsTUFBTSxJQUFJLDJEQUFVLENBQUMsMERBQVMsQ0FBQyxFQUFFLElBQUksSUFBSSxFQUFFLENBQUMsQ0FBQztJQUNwSCxNQUFNLGVBQWUsR0FBRyxhQUFhLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFDcEYsT0FBTyxTQUFTLEdBQUcsZUFBZSxDQUFDO0FBQ3JDLENBQUMsQ0FBQztBQUVGOzs7Ozs7R0FNRztBQUNJLFNBQVMsZUFBZSxDQUFDLElBQVksRUFBRSxnQkFBcUIsU0FBUztJQUMxRSxhQUFhO0lBQ2IsT0FBTyxDQUFDLENBQUMsR0FBRyxDQUFDLCtFQUFrQixDQUFDLG9CQUFvQixDQUFDLEVBQUUsSUFBSSxFQUFFLGFBQWEsQ0FBQyxDQUFDO0FBQzlFLENBQUM7QUFFRDs7Ozs7O0dBTUc7QUFDSSxTQUFTLGdCQUFnQixDQUFJLElBQVksRUFBRSxLQUFRO0lBQ3hELGFBQWE7SUFDYixDQUFDLENBQUMsR0FBRyxDQUFDLCtFQUFrQixDQUFDLG9CQUFvQixDQUFDLEVBQUUsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFDO0lBQzdELDBFQUFxQixFQUFFLENBQUM7SUFDeEIsT0FBTyxLQUFLLENBQUM7QUFDZixDQUFDO0FBRUQ7Ozs7OztHQU1HO0FBQ0ksS0FBSyxVQUFVLHFCQUFxQixDQUFJLElBQVksRUFBRSxhQUFnQjtJQUMzRSxhQUFhO0lBQ2IsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFDLCtFQUFrQixDQUFDLG9CQUFvQixDQUFDLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQztRQUMxRCxPQUFPLGVBQWUsQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUMvQixDQUFDO0lBQ0QsT0FBTyxnQkFBZ0IsQ0FBQyxJQUFJLEVBQUUsYUFBYSxDQUFDLENBQUM7QUFDL0MsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy91dGlsL2V4dGVuc2lvbl92YXJpYWJsZXMudHM/YjgxMSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUT0RPOiDkuLrorr7nva7lj5jph4/mt7vliqDnsbvlnovogIzpnZ7kvb/nlKggYW55XG5pbXBvcnQgeyBjaGFyYWN0ZXJzLCBnZXRUaHVtYm5haWxVcmwsIHNhdmVTZXR0aW5nc0RlYm91bmNlZCwgdGhpc19jaGlkLCB1c2VyX2F2YXRhciB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHQnO1xuaW1wb3J0IHsgZXh0ZW5zaW9uX3NldHRpbmdzIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvZXh0ZW5zaW9ucyc7XG5cbmV4cG9ydCBjb25zdCBleHRlbnNpb25OYW1lID0gJ0pTLVNsYXNoLVJ1bm5lcic7XG5leHBvcnQgY29uc3QgZXh0ZW5zaW9uU2V0dGluZ05hbWUgPSAnVGF2ZXJuSGVscGVyJztcblxuZXhwb3J0IGNvbnN0IGV4dGVuc2lvbkZvbGRlclBhdGggPSBgdGhpcmQtcGFydHkvJHtleHRlbnNpb25OYW1lfWA7XG5cbi8vIOiOt+WPluWktOWDj+WOn+WbvlxuZXhwb3J0IGNvbnN0IGNoYXJzUGF0aCA9ICcvY2hhcmFjdGVycy8nO1xuZXhwb3J0IGNvbnN0IGdldFVzZXJBdmF0YXJQYXRoID0gKCkgPT4gYC4vVXNlciBBdmF0YXJzLyR7dXNlcl9hdmF0YXJ9YDtcbmV4cG9ydCBjb25zdCBnZXRDaGFyQXZhdGFyUGF0aCA9ICgpID0+IHtcbiAgLy9AdHMtaWdub3JlXG4gIGNvbnN0IHRodW1ibmFpbFBhdGggPSBnZXRUaHVtYm5haWxVcmwoJ2F2YXRhcicsIGNoYXJhY3RlcnNbdGhpc19jaGlkXT8uYXZhdGFyIHx8IGNoYXJhY3RlcnNbdGhpc19jaGlkXT8ubmFtZSB8fCAnJyk7XG4gIGNvbnN0IHRhcmdldEF2YXRhckltZyA9IHRodW1ibmFpbFBhdGguc3Vic3RyaW5nKHRodW1ibmFpbFBhdGgubGFzdEluZGV4T2YoJz0nKSArIDEpO1xuICByZXR1cm4gY2hhcnNQYXRoICsgdGFyZ2V0QXZhdGFySW1nO1xufTtcblxuLyoqXG4gKiDojrflj5bmianlsZXorr7nva7lj5jph4/nmoTlgLxcbiAqXG4gKiBAcGFyYW0gcGF0aCDorr7nva7lj5jph4/nmoTplK5cbiAqIEBwYXJhbSBkZWZhdWx0X3ZhbHVlIOayoeacieivpemUruaXtueahOm7mOiupOWAvFxuICogQHJldHVybnMg6K6+572u5Y+Y6YeP55qE5YC8XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRTZXR0aW5nVmFsdWUocGF0aDogc3RyaW5nLCBkZWZhdWx0X3ZhbHVlOiBhbnkgPSB1bmRlZmluZWQpOiBhbnkge1xuICAvLyBAdHMtaWdub3JlXG4gIHJldHVybiBfLmdldChleHRlbnNpb25fc2V0dGluZ3NbZXh0ZW5zaW9uU2V0dGluZ05hbWVdLCBwYXRoLCBkZWZhdWx0X3ZhbHVlKTtcbn1cblxuLyoqXG4gKiDkv53lrZjmianlsZXorr7nva7lj5jph4/nmoTlgLxcbiAqXG4gKiBAcGFyYW0gcGF0aCDorr7nva7lj5jph4/nmoTplK5cbiAqIEBwYXJhbSB2YWx1ZSDorr7nva7lj5jph4/nmoTlgLxcbiAqIEByZXR1cm5zIOiuvue9ruWPmOmHj+eahOWAvFxuICovXG5leHBvcnQgZnVuY3Rpb24gc2F2ZVNldHRpbmdWYWx1ZTxUPihwYXRoOiBzdHJpbmcsIHZhbHVlOiBUKTogVCB7XG4gIC8vIEB0cy1pZ25vcmVcbiAgXy5zZXQoZXh0ZW5zaW9uX3NldHRpbmdzW2V4dGVuc2lvblNldHRpbmdOYW1lXSwgcGF0aCwgdmFsdWUpO1xuICBzYXZlU2V0dGluZ3NEZWJvdW5jZWQoKTtcbiAgcmV0dXJuIHZhbHVlO1xufVxuXG4vKipcbiAqIOWmguaenOaJqeWxleacieafkOiuvue9ruWPmOmHj++8jOWImei/lOWbnuivpeiuvue9ruWPmOmHj+eahOWAvO+8jOWQpuWImeiuvue9ruivpeiuvue9ruWPmOmHj+eahOWAvOS4uiBgZGVmYXVsdF92YWx1ZWBcbiAqXG4gKiBAcGFyYW0gcGF0aCDorr7nva7lj5jph4/nmoTplK5cbiAqIEBwYXJhbSBkZWZhdWx0X3ZhbHVlIOaJqeWxleayoeacieivpeiuvue9ruWPmOmHj+aXtuW6lOivpeiuvue9ruW5tui/lOWbnueahOm7mOiupOWAvFxuICogQHJldHVybnMg6K6+572u5Y+Y6YeP55qE5YC8XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRPclNhdmVTZXR0aW5nVmFsdWU8VD4ocGF0aDogc3RyaW5nLCBkZWZhdWx0X3ZhbHVlOiBUKTogUHJvbWlzZTxUPiB7XG4gIC8vIEB0cy1pZ25vcmVcbiAgaWYgKF8uaGFzKGV4dGVuc2lvbl9zZXR0aW5nc1tleHRlbnNpb25TZXR0aW5nTmFtZV0sIHBhdGgpKSB7XG4gICAgcmV0dXJuIGdldFNldHRpbmdWYWx1ZShwYXRoKTtcbiAgfVxuICByZXR1cm4gc2F2ZVNldHRpbmdWYWx1ZShwYXRoLCBkZWZhdWx0X3ZhbHVlKTtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/util/extension_variables.ts\n\n}")},"./src/util/floating_dialog.ts":
/*!*************************************!*\
  !*** ./src/util/floating_dialog.ts ***!
  \*************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   FloatingDialog: () => (/* binding */ FloatingDialog)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_scripts_RossAscends_mods__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/scripts/RossAscends-mods */ \"@sillytavern/scripts/RossAscends-mods\");\n\nclass FloatingDialog {\n    static DEFAULT_MIN_WIDTH = 300;\n    static DEFAULT_MIN_HEIGHT = 250;\n    static DEFAULT_WIDTH = 600;\n    static DEFAULT_HEIGHT = 400;\n    // 移动端默认尺寸\n    static MOBILE_DEFAULT_MIN_WIDTH = 280;\n    static MOBILE_DEFAULT_MIN_HEIGHT = 200;\n    static MOBILE_DEFAULT_WIDTH = 200;\n    static MOBILE_DEFAULT_HEIGHT = 100;\n    /** 全局浮窗实例管理器 */\n    static instances = new Map();\n    dialog = null;\n    content = null;\n    options;\n    isCollapsed = false;\n    constructor(options) {\n        const isCurrentlyMobile = (0,_sillytavern_scripts_RossAscends_mods__WEBPACK_IMPORTED_MODULE_0__.isMobile)();\n        // 计算最终的尺寸值\n        const finalMinWidth = isCurrentlyMobile\n            ? options.mobileMinWidth ?? FloatingDialog.MOBILE_DEFAULT_MIN_WIDTH\n            : options.minWidth ?? FloatingDialog.DEFAULT_MIN_WIDTH;\n        const finalMinHeight = isCurrentlyMobile\n            ? options.mobileMinHeight ?? FloatingDialog.MOBILE_DEFAULT_MIN_HEIGHT\n            : options.minHeight ?? FloatingDialog.DEFAULT_MIN_HEIGHT;\n        const finalWidth = isCurrentlyMobile\n            ? options.mobileWidth ?? FloatingDialog.MOBILE_DEFAULT_WIDTH\n            : options.width ?? FloatingDialog.DEFAULT_WIDTH;\n        const finalHeight = isCurrentlyMobile\n            ? options.mobileHeight ?? FloatingDialog.MOBILE_DEFAULT_HEIGHT\n            : options.height ?? FloatingDialog.DEFAULT_HEIGHT;\n        this.options = {\n            ...options, // 先展开原始选项\n            // 然后覆盖计算后的尺寸值\n            minWidth: finalMinWidth,\n            minHeight: finalMinHeight,\n            width: finalWidth,\n            height: finalHeight,\n            resizable: options.resizable ?? true,\n            draggable: options.draggable ?? true,\n            collapsible: options.collapsible ?? true,\n            onClose: options.onClose ?? (() => { }),\n            onToggle: options.onToggle ?? (() => { }),\n            mobileMinWidth: options.mobileMinWidth,\n            mobileMinHeight: options.mobileMinHeight,\n            mobileWidth: options.mobileWidth,\n            mobileHeight: options.mobileHeight,\n        };\n    }\n    /**\n     * 创建或显示浮窗\n     * @param options 浮窗配置选项\n     * @returns 浮窗实例，如果已存在则返回现有实例\n     */\n    static create(options) {\n        const existing = FloatingDialog.instances.get(options.id);\n        if (existing) {\n            existing.focus();\n            return null; // 返回null表示没有创建新实例\n        }\n        const dialog = new FloatingDialog(options);\n        FloatingDialog.instances.set(options.id, dialog);\n        return dialog;\n    }\n    /**\n     * 获取指定ID的浮窗实例\n     * @param id 浮窗ID\n     * @returns 浮窗实例或null\n     */\n    static getInstance(id) {\n        return FloatingDialog.instances.get(id) || null;\n    }\n    /**\n     * 关闭指定ID的浮窗\n     * @param id 浮窗ID\n     * @returns 是否成功关闭\n     */\n    static close(id) {\n        const instance = FloatingDialog.instances.get(id);\n        if (instance) {\n            instance.close();\n            return true;\n        }\n        return false;\n    }\n    /**\n     * 渲染浮窗\n     * @returns 内容容器jQuery对象\n     */\n    render() {\n        this.unrender();\n        this.dialog = $(`\n      <div class=\"floating-dialog\" data-dialog-id=\"${this.options.id}\">\n        <div class=\"dialog-header\">\n          <div class=\"dialog-title\">${this.options.title}</div>\n          <div class=\"dialog-controls\">\n            ${this.options.collapsible\n            ? '<button class=\"dialog-toggle-btn\" title=\"折叠/展开内容\"><i class=\"fa-solid fa-chevron-up\"></i></button>'\n            : ''}\n            <button class=\"dialog-close-btn\" title=\"关闭\"><i class=\"fa-solid fa-times\"></i></button>\n          </div>\n        </div>\n        <div class=\"dialog-content\"></div>\n        ${(0,_sillytavern_scripts_RossAscends_mods__WEBPACK_IMPORTED_MODULE_0__.isMobile)() ? '<div class=\"dialog-resize-handle\"></div>' : ''}\n      </div>\n    `);\n        this.content = this.dialog.find('.dialog-content');\n        const cssValues = {\n            width: this.resolveCssSize(this.options.width, 'w'),\n            height: this.resolveCssSize(this.options.height, 'h'),\n            minWidth: this.resolveCssSize(this.options.minWidth, 'w'),\n            minHeight: this.resolveCssSize(this.options.minHeight, 'h'),\n        };\n        this.dialog.css(cssValues);\n        this.bindEvents();\n        this.initInteractions();\n        $('body').append(this.dialog);\n        this.centerDialog();\n        return this.content;\n    }\n    /**\n     * 将宽高选项解析为CSS尺寸字符串。\n     * - 若为数字，则追加px\n     * - 若为字符串，则原样返回\n     */\n    resolveCssSize(value, axis) {\n        if (typeof value === 'number' || typeof value === 'undefined') {\n            const isCurrentlyMobile = (0,_sillytavern_scripts_RossAscends_mods__WEBPACK_IMPORTED_MODULE_0__.isMobile)();\n            let fallback;\n            if (axis === 'w') {\n                fallback = isCurrentlyMobile ? FloatingDialog.MOBILE_DEFAULT_WIDTH : FloatingDialog.DEFAULT_WIDTH;\n            }\n            else {\n                fallback = isCurrentlyMobile ? FloatingDialog.MOBILE_DEFAULT_HEIGHT : FloatingDialog.DEFAULT_HEIGHT;\n            }\n            const numeric = typeof value === 'number' ? value : fallback;\n            return typeof numeric === 'number' ? `${numeric}px` : numeric;\n        }\n        return value;\n    }\n    /**\n     * 将宽高选项计算为像素值（用于jQuery UI resizable）。\n     * - 数字：直接返回\n     * - 百分比：按窗口尺寸计算\n     * - vw/vh：按视口宽高计算\n     * - 其它单位：尝试通过临时元素计算，否则回退默认像素\n     */\n    computePixelSize(value, axis) {\n        const viewportW = $(window).width() || 0;\n        const viewportH = $(window).height() || 0;\n        const isCurrentlyMobile = (0,_sillytavern_scripts_RossAscends_mods__WEBPACK_IMPORTED_MODULE_0__.isMobile)();\n        const fallback = axis === 'w'\n            ? isCurrentlyMobile\n                ? FloatingDialog.MOBILE_DEFAULT_MIN_WIDTH\n                : FloatingDialog.DEFAULT_MIN_WIDTH\n            : isCurrentlyMobile\n                ? FloatingDialog.MOBILE_DEFAULT_MIN_HEIGHT\n                : FloatingDialog.DEFAULT_MIN_HEIGHT;\n        if (typeof value === 'number' || typeof value === 'undefined') {\n            return typeof value === 'number' ? value : fallback;\n        }\n        const trimmed = value.trim();\n        // 百分比\n        const percentMatch = trimmed.match(/^([0-9]+(?:\\.[0-9]+)?)%$/);\n        if (percentMatch) {\n            const ratio = parseFloat(percentMatch[1]) / 100;\n            return Math.max(0, Math.round((axis === 'w' ? viewportW : viewportH) * ratio));\n        }\n        // vw/vh\n        const vwMatch = trimmed.match(/^([0-9]+(?:\\.[0-9]+)?)vw$/i);\n        if (vwMatch && axis === 'w') {\n            const ratio = parseFloat(vwMatch[1]) / 100;\n            return Math.max(0, Math.round(viewportW * ratio));\n        }\n        const vhMatch = trimmed.match(/^([0-9]+(?:\\.[0-9]+)?)vh$/i);\n        if (vhMatch && axis === 'h') {\n            const ratio = parseFloat(vhMatch[1]) / 100;\n            return Math.max(0, Math.round(viewportH * ratio));\n        }\n        // 其它单位：尝试通过临时元素计算\n        const temp = $('<div/>').css({\n            position: 'absolute',\n            visibility: 'hidden',\n            width: axis === 'w' ? trimmed : 'auto',\n            height: axis === 'h' ? trimmed : 'auto',\n        });\n        $('body').append(temp);\n        const measured = axis === 'w' ? temp.outerWidth() || 0 : temp.outerHeight() || 0;\n        temp.remove();\n        return measured || fallback;\n    }\n    /**\n     * 获取内容容器\n     * @returns 内容容器jQuery对象\n     */\n    getContent() {\n        return this.content;\n    }\n    /**\n     * 聚焦浮窗（置顶显示）\n     */\n    focus() {\n        if (this.dialog) {\n            const maxZIndex = Math.max(...Array.from($('.floating-dialog')).map(el => parseInt($(el).css('z-index') || '4000')));\n            this.dialog.css('z-index', maxZIndex + 1);\n        }\n    }\n    /**\n     * 设置浮窗标题\n     * @param title 新标题\n     */\n    setTitle(title) {\n        if (this.dialog) {\n            this.dialog.find('.dialog-title').text(title);\n        }\n    }\n    /**\n     * 切换折叠状态\n     */\n    toggle() {\n        if (!this.options.collapsible || !this.dialog)\n            return;\n        const $content = this.dialog.find('.dialog-content');\n        const $toggleBtn = this.dialog.find('.dialog-toggle-btn i');\n        const $resizeHandle = this.dialog.find('.dialog-resize-handle');\n        this.isCollapsed = !this.isCollapsed;\n        $content.slideToggle(300, () => {\n            if (this.isCollapsed) {\n                $toggleBtn.removeClass('fa-chevron-up').addClass('fa-chevron-down');\n                $resizeHandle.hide();\n            }\n            else {\n                $toggleBtn.removeClass('fa-chevron-down').addClass('fa-chevron-up');\n                $resizeHandle.show();\n            }\n        });\n        this.dialog.toggleClass('content-collapsed', this.isCollapsed);\n        this.options.onToggle(this.isCollapsed);\n    }\n    /**\n     * 关闭浮窗\n     */\n    close() {\n        if (this.dialog) {\n            this.options.onClose();\n            this.unrender();\n            FloatingDialog.instances.delete(this.options.id);\n        }\n    }\n    /**\n     * 销毁浮窗DOM\n     */\n    unrender() {\n        if (this.dialog) {\n            this.dialog.remove();\n            this.dialog = null;\n            this.content = null;\n        }\n    }\n    /**\n     * 绑定事件处理器\n     */\n    bindEvents() {\n        if (!this.dialog)\n            return;\n        this.dialog.find('.dialog-close-btn').on('click', () => {\n            this.close();\n        });\n        if (this.options.collapsible) {\n            this.dialog.find('.dialog-toggle-btn').on('click', () => {\n                this.toggle();\n            });\n        }\n        this.dialog.on('mousedown', () => {\n            this.focus();\n        });\n    }\n    /**\n     * 初始化拖拽和调整大小功能\n     */\n    initInteractions() {\n        if (!this.dialog)\n            return;\n        const isMobileDevice = (0,_sillytavern_scripts_RossAscends_mods__WEBPACK_IMPORTED_MODULE_0__.isMobile)();\n        // 拖拽功能\n        if (this.options.draggable) {\n            this.dialog.draggable({\n                handle: '.dialog-header',\n                containment: 'window',\n                start: () => {\n                    this.dialog?.addClass('dragging');\n                    this.focus();\n                },\n                stop: () => {\n                    this.dialog?.removeClass('dragging');\n                },\n            });\n        }\n        // 调整大小功能\n        if (this.options.resizable) {\n            this.dialog.resizable({\n                handles: isMobileDevice ? 'se' : 'n,e,s,w,ne,se,sw,nw',\n                minHeight: this.computePixelSize(this.options.minHeight, 'h'),\n                minWidth: this.computePixelSize(this.options.minWidth, 'w'),\n                start: () => {\n                    this.dialog?.addClass('resizing');\n                    this.focus();\n                    const minW = this.computePixelSize(this.options.minWidth, 'w');\n                    const minH = this.computePixelSize(this.options.minHeight, 'h');\n                    this.dialog.resizable('option', 'minWidth', minW);\n                    this.dialog.resizable('option', 'minHeight', minH);\n                },\n                stop: () => {\n                    this.dialog?.removeClass('resizing');\n                },\n            });\n        }\n        // 移动设备显示调整大小手柄\n        if (isMobileDevice && this.options.resizable) {\n            this.dialog.find('.dialog-resize-handle').show();\n        }\n    }\n    /**\n     * 将浮窗居中显示\n     */\n    centerDialog() {\n        if (!this.dialog)\n            return;\n        const windowWidth = $(window).width() || 0;\n        const windowHeight = $(window).height() || 0;\n        const dialogWidth = this.dialog.outerWidth() || 0;\n        const dialogHeight = this.dialog.outerHeight() || 0;\n        const left = Math.max(0, (windowWidth - dialogWidth) / 2);\n        const top = Math.max(0, (windowHeight - dialogHeight) / 2);\n        this.dialog.css({\n            left: `${left}px`,\n            top: `${top}px`,\n            position: 'fixed',\n            zIndex: 4000,\n        });\n        this.focus();\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvdXRpbC9mbG9hdGluZ19kaWFsb2cudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBaUU7QUFtQzFELE1BQU0sY0FBYztJQUNqQixNQUFNLENBQVUsaUJBQWlCLEdBQUcsR0FBRyxDQUFDO0lBQ3hDLE1BQU0sQ0FBVSxrQkFBa0IsR0FBRyxHQUFHLENBQUM7SUFDekMsTUFBTSxDQUFVLGFBQWEsR0FBRyxHQUFHLENBQUM7SUFDcEMsTUFBTSxDQUFVLGNBQWMsR0FBRyxHQUFHLENBQUM7SUFFN0MsVUFBVTtJQUNGLE1BQU0sQ0FBVSx3QkFBd0IsR0FBRyxHQUFHLENBQUM7SUFDL0MsTUFBTSxDQUFVLHlCQUF5QixHQUFHLEdBQUcsQ0FBQztJQUNoRCxNQUFNLENBQVUsb0JBQW9CLEdBQUcsR0FBRyxDQUFDO0lBQzNDLE1BQU0sQ0FBVSxxQkFBcUIsR0FBRyxHQUFHLENBQUM7SUFFcEQsZ0JBQWdCO0lBQ1IsTUFBTSxDQUFDLFNBQVMsR0FBZ0MsSUFBSSxHQUFHLEVBQUUsQ0FBQztJQUUxRCxNQUFNLEdBQStCLElBQUksQ0FBQztJQUMxQyxPQUFPLEdBQStCLElBQUksQ0FBQztJQUMzQyxPQUFPLENBR3NGO0lBQzdGLFdBQVcsR0FBRyxLQUFLLENBQUM7SUFFNUIsWUFBWSxPQUE4QjtRQUN4QyxNQUFNLGlCQUFpQixHQUFHLCtFQUFRLEVBQUUsQ0FBQztRQUVyQyxXQUFXO1FBQ1gsTUFBTSxhQUFhLEdBQUcsaUJBQWlCO1lBQ3JDLENBQUMsQ0FBQyxPQUFPLENBQUMsY0FBYyxJQUFJLGNBQWMsQ0FBQyx3QkFBd0I7WUFDbkUsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxRQUFRLElBQUksY0FBYyxDQUFDLGlCQUFpQixDQUFDO1FBQ3pELE1BQU0sY0FBYyxHQUFHLGlCQUFpQjtZQUN0QyxDQUFDLENBQUMsT0FBTyxDQUFDLGVBQWUsSUFBSSxjQUFjLENBQUMseUJBQXlCO1lBQ3JFLENBQUMsQ0FBQyxPQUFPLENBQUMsU0FBUyxJQUFJLGNBQWMsQ0FBQyxrQkFBa0IsQ0FBQztRQUMzRCxNQUFNLFVBQVUsR0FBRyxpQkFBaUI7WUFDbEMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxXQUFXLElBQUksY0FBYyxDQUFDLG9CQUFvQjtZQUM1RCxDQUFDLENBQUMsT0FBTyxDQUFDLEtBQUssSUFBSSxjQUFjLENBQUMsYUFBYSxDQUFDO1FBQ2xELE1BQU0sV0FBVyxHQUFHLGlCQUFpQjtZQUNuQyxDQUFDLENBQUMsT0FBTyxDQUFDLFlBQVksSUFBSSxjQUFjLENBQUMscUJBQXFCO1lBQzlELENBQUMsQ0FBQyxPQUFPLENBQUMsTUFBTSxJQUFJLGNBQWMsQ0FBQyxjQUFjLENBQUM7UUFFcEQsSUFBSSxDQUFDLE9BQU8sR0FBRztZQUNiLEdBQUcsT0FBTyxFQUFFLFVBQVU7WUFDdEIsY0FBYztZQUNkLFFBQVEsRUFBRSxhQUFhO1lBQ3ZCLFNBQVMsRUFBRSxjQUFjO1lBQ3pCLEtBQUssRUFBRSxVQUFVO1lBQ2pCLE1BQU0sRUFBRSxXQUFXO1lBQ25CLFNBQVMsRUFBRSxPQUFPLENBQUMsU0FBUyxJQUFJLElBQUk7WUFDcEMsU0FBUyxFQUFFLE9BQU8sQ0FBQyxTQUFTLElBQUksSUFBSTtZQUNwQyxXQUFXLEVBQUUsT0FBTyxDQUFDLFdBQVcsSUFBSSxJQUFJO1lBQ3hDLE9BQU8sRUFBRSxPQUFPLENBQUMsT0FBTyxJQUFJLENBQUMsR0FBRyxFQUFFLEdBQUUsQ0FBQyxDQUFDO1lBQ3RDLFFBQVEsRUFBRSxPQUFPLENBQUMsUUFBUSxJQUFJLENBQUMsR0FBRyxFQUFFLEdBQUUsQ0FBQyxDQUFDO1lBQ3hDLGNBQWMsRUFBRSxPQUFPLENBQUMsY0FBYztZQUN0QyxlQUFlLEVBQUUsT0FBTyxDQUFDLGVBQWU7WUFDeEMsV0FBVyxFQUFFLE9BQU8sQ0FBQyxXQUFXO1lBQ2hDLFlBQVksRUFBRSxPQUFPLENBQUMsWUFBWTtTQUNuQyxDQUFDO0lBQ0osQ0FBQztJQUVEOzs7O09BSUc7SUFDSSxNQUFNLENBQUMsTUFBTSxDQUFDLE9BQThCO1FBQ2pELE1BQU0sUUFBUSxHQUFHLGNBQWMsQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUMxRCxJQUFJLFFBQVEsRUFBRSxDQUFDO1lBQ2IsUUFBUSxDQUFDLEtBQUssRUFBRSxDQUFDO1lBQ2pCLE9BQU8sSUFBSSxDQUFDLENBQUMsa0JBQWtCO1FBQ2pDLENBQUM7UUFFRCxNQUFNLE1BQU0sR0FBRyxJQUFJLGNBQWMsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUMzQyxjQUFjLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsRUFBRSxFQUFFLE1BQU0sQ0FBQyxDQUFDO1FBQ2pELE9BQU8sTUFBTSxDQUFDO0lBQ2hCLENBQUM7SUFFRDs7OztPQUlHO0lBQ0ksTUFBTSxDQUFDLFdBQVcsQ0FBQyxFQUFVO1FBQ2xDLE9BQU8sY0FBYyxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLElBQUksSUFBSSxDQUFDO0lBQ2xELENBQUM7SUFFRDs7OztPQUlHO0lBQ0ksTUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFVO1FBQzVCLE1BQU0sUUFBUSxHQUFHLGNBQWMsQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQ2xELElBQUksUUFBUSxFQUFFLENBQUM7WUFDYixRQUFRLENBQUMsS0FBSyxFQUFFLENBQUM7WUFDakIsT0FBTyxJQUFJLENBQUM7UUFDZCxDQUFDO1FBQ0QsT0FBTyxLQUFLLENBQUM7SUFDZixDQUFDO0lBRUQ7OztPQUdHO0lBQ0ksTUFBTTtRQUNYLElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQztRQUVoQixJQUFJLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQztxREFDaUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxFQUFFOztzQ0FFOUIsSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLOztjQUcxQyxJQUFJLENBQUMsT0FBTyxDQUFDLFdBQVc7WUFDdEIsQ0FBQyxDQUFDLG1HQUFtRztZQUNyRyxDQUFDLENBQUMsRUFDTjs7Ozs7VUFLRiwrRUFBUSxFQUFFLENBQUMsQ0FBQyxDQUFDLDBDQUEwQyxDQUFDLENBQUMsQ0FBQyxFQUFFOztLQUVqRSxDQUFDLENBQUM7UUFFSCxJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLENBQUM7UUFFbkQsTUFBTSxTQUFTLEdBQUc7WUFDaEIsS0FBSyxFQUFFLElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLEVBQUUsR0FBRyxDQUFDO1lBQ25ELE1BQU0sRUFBRSxJQUFJLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsTUFBTSxFQUFFLEdBQUcsQ0FBQztZQUNyRCxRQUFRLEVBQUUsSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFFBQVEsRUFBRSxHQUFHLENBQUM7WUFDekQsU0FBUyxFQUFFLElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxTQUFTLEVBQUUsR0FBRyxDQUFDO1NBQzVELENBQUM7UUFFRixJQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUUzQixJQUFJLENBQUMsVUFBVSxFQUFFLENBQUM7UUFDbEIsSUFBSSxDQUFDLGdCQUFnQixFQUFFLENBQUM7UUFFeEIsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDOUIsSUFBSSxDQUFDLFlBQVksRUFBRSxDQUFDO1FBRXBCLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQztJQUN0QixDQUFDO0lBRUQ7Ozs7T0FJRztJQUNLLGNBQWMsQ0FBQyxLQUFrQyxFQUFFLElBQWU7UUFDeEUsSUFBSSxPQUFPLEtBQUssS0FBSyxRQUFRLElBQUksT0FBTyxLQUFLLEtBQUssV0FBVyxFQUFFLENBQUM7WUFDOUQsTUFBTSxpQkFBaUIsR0FBRywrRUFBUSxFQUFFLENBQUM7WUFDckMsSUFBSSxRQUF5QixDQUFDO1lBRTlCLElBQUksSUFBSSxLQUFLLEdBQUcsRUFBRSxDQUFDO2dCQUNqQixRQUFRLEdBQUcsaUJBQWlCLENBQUMsQ0FBQyxDQUFDLGNBQWMsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLENBQUMsY0FBYyxDQUFDLGFBQWEsQ0FBQztZQUNwRyxDQUFDO2lCQUFNLENBQUM7Z0JBQ04sUUFBUSxHQUFHLGlCQUFpQixDQUFDLENBQUMsQ0FBQyxjQUFjLENBQUMscUJBQXFCLENBQUMsQ0FBQyxDQUFDLGNBQWMsQ0FBQyxjQUFjLENBQUM7WUFDdEcsQ0FBQztZQUVELE1BQU0sT0FBTyxHQUFHLE9BQU8sS0FBSyxLQUFLLFFBQVEsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUM7WUFDN0QsT0FBTyxPQUFPLE9BQU8sS0FBSyxRQUFRLENBQUMsQ0FBQyxDQUFDLEdBQUcsT0FBTyxJQUFJLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQztRQUNoRSxDQUFDO1FBQ0QsT0FBTyxLQUFLLENBQUM7SUFDZixDQUFDO0lBRUQ7Ozs7OztPQU1HO0lBQ0ssZ0JBQWdCLENBQUMsS0FBa0MsRUFBRSxJQUFlO1FBQzFFLE1BQU0sU0FBUyxHQUFHLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDekMsTUFBTSxTQUFTLEdBQUcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLE1BQU0sRUFBRSxJQUFJLENBQUMsQ0FBQztRQUUxQyxNQUFNLGlCQUFpQixHQUFHLCtFQUFRLEVBQUUsQ0FBQztRQUNyQyxNQUFNLFFBQVEsR0FDWixJQUFJLEtBQUssR0FBRztZQUNWLENBQUMsQ0FBQyxpQkFBaUI7Z0JBQ2pCLENBQUMsQ0FBQyxjQUFjLENBQUMsd0JBQXdCO2dCQUN6QyxDQUFDLENBQUMsY0FBYyxDQUFDLGlCQUFpQjtZQUNwQyxDQUFDLENBQUMsaUJBQWlCO2dCQUNuQixDQUFDLENBQUMsY0FBYyxDQUFDLHlCQUF5QjtnQkFDMUMsQ0FBQyxDQUFDLGNBQWMsQ0FBQyxrQkFBa0IsQ0FBQztRQUV4QyxJQUFJLE9BQU8sS0FBSyxLQUFLLFFBQVEsSUFBSSxPQUFPLEtBQUssS0FBSyxXQUFXLEVBQUUsQ0FBQztZQUM5RCxPQUFPLE9BQU8sS0FBSyxLQUFLLFFBQVEsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUM7UUFDdEQsQ0FBQztRQUVELE1BQU0sT0FBTyxHQUFHLEtBQUssQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUM3QixNQUFNO1FBQ04sTUFBTSxZQUFZLEdBQUcsT0FBTyxDQUFDLEtBQUssQ0FBQywwQkFBMEIsQ0FBQyxDQUFDO1FBQy9ELElBQUksWUFBWSxFQUFFLENBQUM7WUFDakIsTUFBTSxLQUFLLEdBQUcsVUFBVSxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQztZQUNoRCxPQUFPLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLEtBQUssR0FBRyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEtBQUssQ0FBQyxDQUFDLENBQUM7UUFDakYsQ0FBQztRQUNELFFBQVE7UUFDUixNQUFNLE9BQU8sR0FBRyxPQUFPLENBQUMsS0FBSyxDQUFDLDRCQUE0QixDQUFDLENBQUM7UUFDNUQsSUFBSSxPQUFPLElBQUksSUFBSSxLQUFLLEdBQUcsRUFBRSxDQUFDO1lBQzVCLE1BQU0sS0FBSyxHQUFHLFVBQVUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUM7WUFDM0MsT0FBTyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLFNBQVMsR0FBRyxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBQ3BELENBQUM7UUFDRCxNQUFNLE9BQU8sR0FBRyxPQUFPLENBQUMsS0FBSyxDQUFDLDRCQUE0QixDQUFDLENBQUM7UUFDNUQsSUFBSSxPQUFPLElBQUksSUFBSSxLQUFLLEdBQUcsRUFBRSxDQUFDO1lBQzVCLE1BQU0sS0FBSyxHQUFHLFVBQVUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUM7WUFDM0MsT0FBTyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLFNBQVMsR0FBRyxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBQ3BELENBQUM7UUFFRCxrQkFBa0I7UUFDbEIsTUFBTSxJQUFJLEdBQUcsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQztZQUMzQixRQUFRLEVBQUUsVUFBVTtZQUNwQixVQUFVLEVBQUUsUUFBUTtZQUNwQixLQUFLLEVBQUUsSUFBSSxLQUFLLEdBQUcsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxNQUFNO1lBQ3RDLE1BQU0sRUFBRSxJQUFJLEtBQUssR0FBRyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLE1BQU07U0FDeEMsQ0FBQyxDQUFDO1FBQ0gsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN2QixNQUFNLFFBQVEsR0FBRyxJQUFJLEtBQUssR0FBRyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ2pGLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUNkLE9BQU8sUUFBUSxJQUFJLFFBQVEsQ0FBQztJQUM5QixDQUFDO0lBRUQ7OztPQUdHO0lBQ0ksVUFBVTtRQUNmLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQztJQUN0QixDQUFDO0lBRUQ7O09BRUc7SUFDSSxLQUFLO1FBQ1YsSUFBSSxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7WUFDaEIsTUFBTSxTQUFTLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FDeEIsR0FBRyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLElBQUksTUFBTSxDQUFDLENBQUMsQ0FDekYsQ0FBQztZQUVGLElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLFNBQVMsRUFBRSxTQUFTLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDNUMsQ0FBQztJQUNILENBQUM7SUFFRDs7O09BR0c7SUFDSSxRQUFRLENBQUMsS0FBYTtRQUMzQixJQUFJLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztZQUNoQixJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDaEQsQ0FBQztJQUNILENBQUM7SUFFRDs7T0FFRztJQUNJLE1BQU07UUFDWCxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxXQUFXLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTTtZQUFFLE9BQU87UUFFdEQsTUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsaUJBQWlCLENBQUMsQ0FBQztRQUNyRCxNQUFNLFVBQVUsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDO1FBQzVELE1BQU0sYUFBYSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLHVCQUF1QixDQUFDLENBQUM7UUFFaEUsSUFBSSxDQUFDLFdBQVcsR0FBRyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUM7UUFFckMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFO1lBQzdCLElBQUksSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO2dCQUNyQixVQUFVLENBQUMsV0FBVyxDQUFDLGVBQWUsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO2dCQUNwRSxhQUFhLENBQUMsSUFBSSxFQUFFLENBQUM7WUFDdkIsQ0FBQztpQkFBTSxDQUFDO2dCQUNOLFVBQVUsQ0FBQyxXQUFXLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxRQUFRLENBQUMsZUFBZSxDQUFDLENBQUM7Z0JBQ3BFLGFBQWEsQ0FBQyxJQUFJLEVBQUUsQ0FBQztZQUN2QixDQUFDO1FBQ0gsQ0FBQyxDQUFDLENBQUM7UUFFSCxJQUFJLENBQUMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxtQkFBbUIsRUFBRSxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7UUFDL0QsSUFBSSxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBQzFDLENBQUM7SUFFRDs7T0FFRztJQUNJLEtBQUs7UUFDVixJQUFJLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztZQUNoQixJQUFJLENBQUMsT0FBTyxDQUFDLE9BQU8sRUFBRSxDQUFDO1lBQ3ZCLElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUNoQixjQUFjLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQ25ELENBQUM7SUFDSCxDQUFDO0lBRUQ7O09BRUc7SUFDSyxRQUFRO1FBQ2QsSUFBSSxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7WUFDaEIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLEVBQUUsQ0FBQztZQUNyQixJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQztZQUNuQixJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQztRQUN0QixDQUFDO0lBQ0gsQ0FBQztJQUVEOztPQUVHO0lBQ0ssVUFBVTtRQUNoQixJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU07WUFBRSxPQUFPO1FBRXpCLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLG1CQUFtQixDQUFDLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxHQUFHLEVBQUU7WUFDckQsSUFBSSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ2YsQ0FBQyxDQUFDLENBQUM7UUFFSCxJQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDN0IsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsb0JBQW9CLENBQUMsQ0FBQyxFQUFFLENBQUMsT0FBTyxFQUFFLEdBQUcsRUFBRTtnQkFDdEQsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDO1lBQ2hCLENBQUMsQ0FBQyxDQUFDO1FBQ0wsQ0FBQztRQUVELElBQUksQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLFdBQVcsRUFBRSxHQUFHLEVBQUU7WUFDL0IsSUFBSSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ2YsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQ7O09BRUc7SUFDSyxnQkFBZ0I7UUFDdEIsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNO1lBQUUsT0FBTztRQUV6QixNQUFNLGNBQWMsR0FBRywrRUFBUSxFQUFFLENBQUM7UUFFbEMsT0FBTztRQUNQLElBQUksSUFBSSxDQUFDLE9BQU8sQ0FBQyxTQUFTLEVBQUUsQ0FBQztZQUMxQixJQUFJLENBQUMsTUFBYyxDQUFDLFNBQVMsQ0FBQztnQkFDN0IsTUFBTSxFQUFFLGdCQUFnQjtnQkFDeEIsV0FBVyxFQUFFLFFBQVE7Z0JBQ3JCLEtBQUssRUFBRSxHQUFHLEVBQUU7b0JBQ1YsSUFBSSxDQUFDLE1BQU0sRUFBRSxRQUFRLENBQUMsVUFBVSxDQUFDLENBQUM7b0JBQ2xDLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztnQkFDZixDQUFDO2dCQUNELElBQUksRUFBRSxHQUFHLEVBQUU7b0JBQ1QsSUFBSSxDQUFDLE1BQU0sRUFBRSxXQUFXLENBQUMsVUFBVSxDQUFDLENBQUM7Z0JBQ3ZDLENBQUM7YUFDRixDQUFDLENBQUM7UUFDTCxDQUFDO1FBRUQsU0FBUztRQUNULElBQUksSUFBSSxDQUFDLE9BQU8sQ0FBQyxTQUFTLEVBQUUsQ0FBQztZQUMxQixJQUFJLENBQUMsTUFBYyxDQUFDLFNBQVMsQ0FBQztnQkFDN0IsT0FBTyxFQUFFLGNBQWMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxxQkFBcUI7Z0JBQ3RELFNBQVMsRUFBRSxJQUFJLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxTQUFTLEVBQUUsR0FBRyxDQUFDO2dCQUM3RCxRQUFRLEVBQUUsSUFBSSxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsUUFBUSxFQUFFLEdBQUcsQ0FBQztnQkFDM0QsS0FBSyxFQUFFLEdBQUcsRUFBRTtvQkFDVixJQUFJLENBQUMsTUFBTSxFQUFFLFFBQVEsQ0FBQyxVQUFVLENBQUMsQ0FBQztvQkFDbEMsSUFBSSxDQUFDLEtBQUssRUFBRSxDQUFDO29CQUNiLE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFFBQVEsRUFBRSxHQUFHLENBQUMsQ0FBQztvQkFDL0QsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsU0FBUyxFQUFFLEdBQUcsQ0FBQyxDQUFDO29CQUMvRCxJQUFJLENBQUMsTUFBYyxDQUFDLFNBQVMsQ0FBQyxRQUFRLEVBQUUsVUFBVSxFQUFFLElBQUksQ0FBQyxDQUFDO29CQUMxRCxJQUFJLENBQUMsTUFBYyxDQUFDLFNBQVMsQ0FBQyxRQUFRLEVBQUUsV0FBVyxFQUFFLElBQUksQ0FBQyxDQUFDO2dCQUM5RCxDQUFDO2dCQUNELElBQUksRUFBRSxHQUFHLEVBQUU7b0JBQ1QsSUFBSSxDQUFDLE1BQU0sRUFBRSxXQUFXLENBQUMsVUFBVSxDQUFDLENBQUM7Z0JBQ3ZDLENBQUM7YUFDRixDQUFDLENBQUM7UUFDTCxDQUFDO1FBRUQsZUFBZTtRQUNmLElBQUksY0FBYyxJQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsU0FBUyxFQUFFLENBQUM7WUFDN0MsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsdUJBQXVCLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUNuRCxDQUFDO0lBQ0gsQ0FBQztJQUVEOztPQUVHO0lBQ0ssWUFBWTtRQUNsQixJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU07WUFBRSxPQUFPO1FBRXpCLE1BQU0sV0FBVyxHQUFHLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDM0MsTUFBTSxZQUFZLEdBQUcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLE1BQU0sRUFBRSxJQUFJLENBQUMsQ0FBQztRQUU3QyxNQUFNLFdBQVcsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLFVBQVUsRUFBRSxJQUFJLENBQUMsQ0FBQztRQUNsRCxNQUFNLFlBQVksR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLFdBQVcsRUFBRSxJQUFJLENBQUMsQ0FBQztRQUVwRCxNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDLFdBQVcsR0FBRyxXQUFXLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUMxRCxNQUFNLEdBQUcsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDLFlBQVksR0FBRyxZQUFZLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUUzRCxJQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQztZQUNkLElBQUksRUFBRSxHQUFHLElBQUksSUFBSTtZQUNqQixHQUFHLEVBQUUsR0FBRyxHQUFHLElBQUk7WUFDZixRQUFRLEVBQUUsT0FBTztZQUNqQixNQUFNLEVBQUUsSUFBSTtTQUNiLENBQUMsQ0FBQztRQUVILElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztJQUNmLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvdXRpbC9mbG9hdGluZ19kaWFsb2cudHM/OGYyZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBpc01vYmlsZSB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL1Jvc3NBc2NlbmRzLW1vZHMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIEZsb2F0aW5nRGlhbG9nT3B0aW9ucyB7XG4gIC8qKiDmta7nqpfmoIfpopggKi9cbiAgdGl0bGU6IHN0cmluZztcbiAgLyoqIOa1rueql+WUr+S4gOagh+ivhuespu+8jOeUqOS6jumYsuatoumHjeWkjeaJk+W8gCAqL1xuICBpZDogc3RyaW5nO1xuICAvKiog5pyA5bCP5a695bqm77yI5pSv5oyB5pWw5a2X5YOP57Sg5oiWQ1NT5Y2V5L2N77yM5aaCJzQwdncn44CBJzUwJSfvvIkgKi9cbiAgbWluV2lkdGg/OiBudW1iZXIgfCBzdHJpbmc7XG4gIC8qKiDmnIDlsI/pq5jluqbvvIjmlK/mjIHmlbDlrZflg4/ntKDmiJZDU1PljZXkvY3vvIzlpoInNDB2aCfjgIEnNTAlJ++8iSAqL1xuICBtaW5IZWlnaHQ/OiBudW1iZXIgfCBzdHJpbmc7XG4gIC8qKiDliJ3lp4vlrr3luqbvvIjmlK/mjIHmlbDlrZflg4/ntKDmiJZDU1PljZXkvY3vvIzlpoInODB2dyfjgIEnNTAlJ++8iSAqL1xuICB3aWR0aD86IG51bWJlciB8IHN0cmluZztcbiAgLyoqIOWIneWni+mrmOW6pu+8iOaUr+aMgeaVsOWtl+WDj+e0oOaIlkNTU+WNleS9je+8jOWmgic4MHZoJ+OAgSc1MCUn77yJICovXG4gIGhlaWdodD86IG51bWJlciB8IHN0cmluZztcbiAgLyoqIOenu+WKqOerr+acgOWwj+WuveW6pu+8iOaUr+aMgeaVsOWtl+WDj+e0oOaIlkNTU+WNleS9je+8jOWmgic5MHZ3J+OAgSc4MCUn77yJICovXG4gIG1vYmlsZU1pbldpZHRoPzogbnVtYmVyIHwgc3RyaW5nO1xuICAvKiog56e75Yqo56uv5pyA5bCP6auY5bqm77yI5pSv5oyB5pWw5a2X5YOP57Sg5oiWQ1NT5Y2V5L2N77yM5aaCJzUwdmgn44CBJzQwJSfvvIkgKi9cbiAgbW9iaWxlTWluSGVpZ2h0PzogbnVtYmVyIHwgc3RyaW5nO1xuICAvKiog56e75Yqo56uv5Yid5aeL5a695bqm77yI5pSv5oyB5pWw5a2X5YOP57Sg5oiWQ1NT5Y2V5L2N77yM5aaCJzk1dncn44CBJzkwJSfvvIkgKi9cbiAgbW9iaWxlV2lkdGg/OiBudW1iZXIgfCBzdHJpbmc7XG4gIC8qKiDnp7vliqjnq6/liJ3lp4vpq5jluqbvvIjmlK/mjIHmlbDlrZflg4/ntKDmiJZDU1PljZXkvY3vvIzlpoInNzB2aCfjgIEnNjAlJ++8iSAqL1xuICBtb2JpbGVIZWlnaHQ/OiBudW1iZXIgfCBzdHJpbmc7XG4gIC8qKiDmmK/lkKblj6/osIPmlbTlpKflsI8gKi9cbiAgcmVzaXphYmxlPzogYm9vbGVhbjtcbiAgLyoqIOaYr+WQpuWPr+aLluaLvSAqL1xuICBkcmFnZ2FibGU/OiBib29sZWFuO1xuICAvKiog5piv5ZCm5pi+56S65oqY5Y+g5oyJ6ZKuICovXG4gIGNvbGxhcHNpYmxlPzogYm9vbGVhbjtcbiAgLyoqIOWFs+mXreaXtueahOWbnuiwg+WHveaVsCAqL1xuICBvbkNsb3NlPzogKCkgPT4gdm9pZDtcbiAgLyoqIOaKmOWPoC/lsZXlvIDml7bnmoTlm57osIPlh73mlbAgKi9cbiAgb25Ub2dnbGU/OiAoY29sbGFwc2VkOiBib29sZWFuKSA9PiB2b2lkO1xufVxuXG5leHBvcnQgY2xhc3MgRmxvYXRpbmdEaWFsb2cge1xuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBERUZBVUxUX01JTl9XSURUSCA9IDMwMDtcbiAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgREVGQVVMVF9NSU5fSEVJR0hUID0gMjUwO1xuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBERUZBVUxUX1dJRFRIID0gNjAwO1xuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBERUZBVUxUX0hFSUdIVCA9IDQwMDtcblxuICAvLyDnp7vliqjnq6/pu5jorqTlsLrlr7hcbiAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgTU9CSUxFX0RFRkFVTFRfTUlOX1dJRFRIID0gMjgwO1xuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBNT0JJTEVfREVGQVVMVF9NSU5fSEVJR0hUID0gMjAwO1xuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBNT0JJTEVfREVGQVVMVF9XSURUSCA9IDIwMDtcbiAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgTU9CSUxFX0RFRkFVTFRfSEVJR0hUID0gMTAwO1xuXG4gIC8qKiDlhajlsYDmta7nqpflrp7kvovnrqHnkIblmaggKi9cbiAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2VzOiBNYXA8c3RyaW5nLCBGbG9hdGluZ0RpYWxvZz4gPSBuZXcgTWFwKCk7XG5cbiAgcHJpdmF0ZSBkaWFsb2c6IEpRdWVyeTxIVE1MRWxlbWVudD4gfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBjb250ZW50OiBKUXVlcnk8SFRNTEVsZW1lbnQ+IHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgb3B0aW9uczogUmVxdWlyZWQ8XG4gICAgT21pdDxGbG9hdGluZ0RpYWxvZ09wdGlvbnMsICdtb2JpbGVNaW5XaWR0aCcgfCAnbW9iaWxlTWluSGVpZ2h0JyB8ICdtb2JpbGVXaWR0aCcgfCAnbW9iaWxlSGVpZ2h0Jz5cbiAgPiAmXG4gICAgUGljazxGbG9hdGluZ0RpYWxvZ09wdGlvbnMsICdtb2JpbGVNaW5XaWR0aCcgfCAnbW9iaWxlTWluSGVpZ2h0JyB8ICdtb2JpbGVXaWR0aCcgfCAnbW9iaWxlSGVpZ2h0Jz47XG4gIHByaXZhdGUgaXNDb2xsYXBzZWQgPSBmYWxzZTtcblxuICBjb25zdHJ1Y3RvcihvcHRpb25zOiBGbG9hdGluZ0RpYWxvZ09wdGlvbnMpIHtcbiAgICBjb25zdCBpc0N1cnJlbnRseU1vYmlsZSA9IGlzTW9iaWxlKCk7XG5cbiAgICAvLyDorqHnrpfmnIDnu4jnmoTlsLrlr7jlgLxcbiAgICBjb25zdCBmaW5hbE1pbldpZHRoID0gaXNDdXJyZW50bHlNb2JpbGVcbiAgICAgID8gb3B0aW9ucy5tb2JpbGVNaW5XaWR0aCA/PyBGbG9hdGluZ0RpYWxvZy5NT0JJTEVfREVGQVVMVF9NSU5fV0lEVEhcbiAgICAgIDogb3B0aW9ucy5taW5XaWR0aCA/PyBGbG9hdGluZ0RpYWxvZy5ERUZBVUxUX01JTl9XSURUSDtcbiAgICBjb25zdCBmaW5hbE1pbkhlaWdodCA9IGlzQ3VycmVudGx5TW9iaWxlXG4gICAgICA/IG9wdGlvbnMubW9iaWxlTWluSGVpZ2h0ID8/IEZsb2F0aW5nRGlhbG9nLk1PQklMRV9ERUZBVUxUX01JTl9IRUlHSFRcbiAgICAgIDogb3B0aW9ucy5taW5IZWlnaHQgPz8gRmxvYXRpbmdEaWFsb2cuREVGQVVMVF9NSU5fSEVJR0hUO1xuICAgIGNvbnN0IGZpbmFsV2lkdGggPSBpc0N1cnJlbnRseU1vYmlsZVxuICAgICAgPyBvcHRpb25zLm1vYmlsZVdpZHRoID8/IEZsb2F0aW5nRGlhbG9nLk1PQklMRV9ERUZBVUxUX1dJRFRIXG4gICAgICA6IG9wdGlvbnMud2lkdGggPz8gRmxvYXRpbmdEaWFsb2cuREVGQVVMVF9XSURUSDtcbiAgICBjb25zdCBmaW5hbEhlaWdodCA9IGlzQ3VycmVudGx5TW9iaWxlXG4gICAgICA/IG9wdGlvbnMubW9iaWxlSGVpZ2h0ID8/IEZsb2F0aW5nRGlhbG9nLk1PQklMRV9ERUZBVUxUX0hFSUdIVFxuICAgICAgOiBvcHRpb25zLmhlaWdodCA/PyBGbG9hdGluZ0RpYWxvZy5ERUZBVUxUX0hFSUdIVDtcblxuICAgIHRoaXMub3B0aW9ucyA9IHtcbiAgICAgIC4uLm9wdGlvbnMsIC8vIOWFiOWxleW8gOWOn+Wni+mAiemhuVxuICAgICAgLy8g54S25ZCO6KaG55uW6K6h566X5ZCO55qE5bC65a+45YC8XG4gICAgICBtaW5XaWR0aDogZmluYWxNaW5XaWR0aCxcbiAgICAgIG1pbkhlaWdodDogZmluYWxNaW5IZWlnaHQsXG4gICAgICB3aWR0aDogZmluYWxXaWR0aCxcbiAgICAgIGhlaWdodDogZmluYWxIZWlnaHQsXG4gICAgICByZXNpemFibGU6IG9wdGlvbnMucmVzaXphYmxlID8/IHRydWUsXG4gICAgICBkcmFnZ2FibGU6IG9wdGlvbnMuZHJhZ2dhYmxlID8/IHRydWUsXG4gICAgICBjb2xsYXBzaWJsZTogb3B0aW9ucy5jb2xsYXBzaWJsZSA/PyB0cnVlLFxuICAgICAgb25DbG9zZTogb3B0aW9ucy5vbkNsb3NlID8/ICgoKSA9PiB7fSksXG4gICAgICBvblRvZ2dsZTogb3B0aW9ucy5vblRvZ2dsZSA/PyAoKCkgPT4ge30pLFxuICAgICAgbW9iaWxlTWluV2lkdGg6IG9wdGlvbnMubW9iaWxlTWluV2lkdGgsXG4gICAgICBtb2JpbGVNaW5IZWlnaHQ6IG9wdGlvbnMubW9iaWxlTWluSGVpZ2h0LFxuICAgICAgbW9iaWxlV2lkdGg6IG9wdGlvbnMubW9iaWxlV2lkdGgsXG4gICAgICBtb2JpbGVIZWlnaHQ6IG9wdGlvbnMubW9iaWxlSGVpZ2h0LFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICog5Yib5bu65oiW5pi+56S65rWu56qXXG4gICAqIEBwYXJhbSBvcHRpb25zIOa1rueql+mFjee9rumAiemhuVxuICAgKiBAcmV0dXJucyDmta7nqpflrp7kvovvvIzlpoLmnpzlt7LlrZjlnKjliJnov5Tlm57njrDmnInlrp7kvotcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgY3JlYXRlKG9wdGlvbnM6IEZsb2F0aW5nRGlhbG9nT3B0aW9ucyk6IEZsb2F0aW5nRGlhbG9nIHwgbnVsbCB7XG4gICAgY29uc3QgZXhpc3RpbmcgPSBGbG9hdGluZ0RpYWxvZy5pbnN0YW5jZXMuZ2V0KG9wdGlvbnMuaWQpO1xuICAgIGlmIChleGlzdGluZykge1xuICAgICAgZXhpc3RpbmcuZm9jdXMoKTtcbiAgICAgIHJldHVybiBudWxsOyAvLyDov5Tlm55udWxs6KGo56S65rKh5pyJ5Yib5bu65paw5a6e5L6LXG4gICAgfVxuXG4gICAgY29uc3QgZGlhbG9nID0gbmV3IEZsb2F0aW5nRGlhbG9nKG9wdGlvbnMpO1xuICAgIEZsb2F0aW5nRGlhbG9nLmluc3RhbmNlcy5zZXQob3B0aW9ucy5pZCwgZGlhbG9nKTtcbiAgICByZXR1cm4gZGlhbG9nO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluaMh+WumklE55qE5rWu56qX5a6e5L6LXG4gICAqIEBwYXJhbSBpZCDmta7nqpdJRFxuICAgKiBAcmV0dXJucyDmta7nqpflrp7kvovmiJZudWxsXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGdldEluc3RhbmNlKGlkOiBzdHJpbmcpOiBGbG9hdGluZ0RpYWxvZyB8IG51bGwge1xuICAgIHJldHVybiBGbG9hdGluZ0RpYWxvZy5pbnN0YW5jZXMuZ2V0KGlkKSB8fCBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIOWFs+mXreaMh+WumklE55qE5rWu56qXXG4gICAqIEBwYXJhbSBpZCDmta7nqpdJRFxuICAgKiBAcmV0dXJucyDmmK/lkKbmiJDlip/lhbPpl61cbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgY2xvc2UoaWQ6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGluc3RhbmNlID0gRmxvYXRpbmdEaWFsb2cuaW5zdGFuY2VzLmdldChpZCk7XG4gICAgaWYgKGluc3RhbmNlKSB7XG4gICAgICBpbnN0YW5jZS5jbG9zZSgpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmuLLmn5Pmta7nqpdcbiAgICogQHJldHVybnMg5YaF5a655a655ZmoalF1ZXJ55a+56LGhXG4gICAqL1xuICBwdWJsaWMgcmVuZGVyKCk6IEpRdWVyeTxIVE1MRWxlbWVudD4ge1xuICAgIHRoaXMudW5yZW5kZXIoKTtcblxuICAgIHRoaXMuZGlhbG9nID0gJChgXG4gICAgICA8ZGl2IGNsYXNzPVwiZmxvYXRpbmctZGlhbG9nXCIgZGF0YS1kaWFsb2ctaWQ9XCIke3RoaXMub3B0aW9ucy5pZH1cIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImRpYWxvZy1oZWFkZXJcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiZGlhbG9nLXRpdGxlXCI+JHt0aGlzLm9wdGlvbnMudGl0bGV9PC9kaXY+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cImRpYWxvZy1jb250cm9sc1wiPlxuICAgICAgICAgICAgJHtcbiAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLmNvbGxhcHNpYmxlXG4gICAgICAgICAgICAgICAgPyAnPGJ1dHRvbiBjbGFzcz1cImRpYWxvZy10b2dnbGUtYnRuXCIgdGl0bGU9XCLmipjlj6Av5bGV5byA5YaF5a65XCI+PGkgY2xhc3M9XCJmYS1zb2xpZCBmYS1jaGV2cm9uLXVwXCI+PC9pPjwvYnV0dG9uPidcbiAgICAgICAgICAgICAgICA6ICcnXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwiZGlhbG9nLWNsb3NlLWJ0blwiIHRpdGxlPVwi5YWz6ZetXCI+PGkgY2xhc3M9XCJmYS1zb2xpZCBmYS10aW1lc1wiPjwvaT48L2J1dHRvbj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJkaWFsb2ctY29udGVudFwiPjwvZGl2PlxuICAgICAgICAke2lzTW9iaWxlKCkgPyAnPGRpdiBjbGFzcz1cImRpYWxvZy1yZXNpemUtaGFuZGxlXCI+PC9kaXY+JyA6ICcnfVxuICAgICAgPC9kaXY+XG4gICAgYCk7XG5cbiAgICB0aGlzLmNvbnRlbnQgPSB0aGlzLmRpYWxvZy5maW5kKCcuZGlhbG9nLWNvbnRlbnQnKTtcblxuICAgIGNvbnN0IGNzc1ZhbHVlcyA9IHtcbiAgICAgIHdpZHRoOiB0aGlzLnJlc29sdmVDc3NTaXplKHRoaXMub3B0aW9ucy53aWR0aCwgJ3cnKSxcbiAgICAgIGhlaWdodDogdGhpcy5yZXNvbHZlQ3NzU2l6ZSh0aGlzLm9wdGlvbnMuaGVpZ2h0LCAnaCcpLFxuICAgICAgbWluV2lkdGg6IHRoaXMucmVzb2x2ZUNzc1NpemUodGhpcy5vcHRpb25zLm1pbldpZHRoLCAndycpLFxuICAgICAgbWluSGVpZ2h0OiB0aGlzLnJlc29sdmVDc3NTaXplKHRoaXMub3B0aW9ucy5taW5IZWlnaHQsICdoJyksXG4gICAgfTtcblxuICAgIHRoaXMuZGlhbG9nLmNzcyhjc3NWYWx1ZXMpO1xuXG4gICAgdGhpcy5iaW5kRXZlbnRzKCk7XG4gICAgdGhpcy5pbml0SW50ZXJhY3Rpb25zKCk7XG5cbiAgICAkKCdib2R5JykuYXBwZW5kKHRoaXMuZGlhbG9nKTtcbiAgICB0aGlzLmNlbnRlckRpYWxvZygpO1xuXG4gICAgcmV0dXJuIHRoaXMuY29udGVudDtcbiAgfVxuXG4gIC8qKlxuICAgKiDlsIblrr3pq5jpgInpobnop6PmnpDkuLpDU1PlsLrlr7jlrZfnrKbkuLLjgIJcbiAgICogLSDoi6XkuLrmlbDlrZfvvIzliJnov73liqBweFxuICAgKiAtIOiLpeS4uuWtl+espuS4su+8jOWImeWOn+agt+i/lOWbnlxuICAgKi9cbiAgcHJpdmF0ZSByZXNvbHZlQ3NzU2l6ZSh2YWx1ZTogbnVtYmVyIHwgc3RyaW5nIHwgdW5kZWZpbmVkLCBheGlzOiAndycgfCAnaCcpOiBzdHJpbmcge1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInIHx8IHR5cGVvZiB2YWx1ZSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIGNvbnN0IGlzQ3VycmVudGx5TW9iaWxlID0gaXNNb2JpbGUoKTtcbiAgICAgIGxldCBmYWxsYmFjazogbnVtYmVyIHwgc3RyaW5nO1xuXG4gICAgICBpZiAoYXhpcyA9PT0gJ3cnKSB7XG4gICAgICAgIGZhbGxiYWNrID0gaXNDdXJyZW50bHlNb2JpbGUgPyBGbG9hdGluZ0RpYWxvZy5NT0JJTEVfREVGQVVMVF9XSURUSCA6IEZsb2F0aW5nRGlhbG9nLkRFRkFVTFRfV0lEVEg7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmYWxsYmFjayA9IGlzQ3VycmVudGx5TW9iaWxlID8gRmxvYXRpbmdEaWFsb2cuTU9CSUxFX0RFRkFVTFRfSEVJR0hUIDogRmxvYXRpbmdEaWFsb2cuREVGQVVMVF9IRUlHSFQ7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IG51bWVyaWMgPSB0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInID8gdmFsdWUgOiBmYWxsYmFjaztcbiAgICAgIHJldHVybiB0eXBlb2YgbnVtZXJpYyA9PT0gJ251bWJlcicgPyBgJHtudW1lcmljfXB4YCA6IG51bWVyaWM7XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlsIblrr3pq5jpgInpobnorqHnrpfkuLrlg4/ntKDlgLzvvIjnlKjkuo5qUXVlcnkgVUkgcmVzaXphYmxl77yJ44CCXG4gICAqIC0g5pWw5a2X77ya55u05o6l6L+U5ZueXG4gICAqIC0g55m+5YiG5q+U77ya5oyJ56qX5Y+j5bC65a+46K6h566XXG4gICAqIC0gdncvdmjvvJrmjInop4blj6Plrr3pq5jorqHnrpdcbiAgICogLSDlhbblroPljZXkvY3vvJrlsJ3or5XpgJrov4fkuLTml7blhYPntKDorqHnrpfvvIzlkKbliJnlm57pgIDpu5jorqTlg4/ntKBcbiAgICovXG4gIHByaXZhdGUgY29tcHV0ZVBpeGVsU2l6ZSh2YWx1ZTogbnVtYmVyIHwgc3RyaW5nIHwgdW5kZWZpbmVkLCBheGlzOiAndycgfCAnaCcpOiBudW1iZXIge1xuICAgIGNvbnN0IHZpZXdwb3J0VyA9ICQod2luZG93KS53aWR0aCgpIHx8IDA7XG4gICAgY29uc3Qgdmlld3BvcnRIID0gJCh3aW5kb3cpLmhlaWdodCgpIHx8IDA7XG5cbiAgICBjb25zdCBpc0N1cnJlbnRseU1vYmlsZSA9IGlzTW9iaWxlKCk7XG4gICAgY29uc3QgZmFsbGJhY2sgPVxuICAgICAgYXhpcyA9PT0gJ3cnXG4gICAgICAgID8gaXNDdXJyZW50bHlNb2JpbGVcbiAgICAgICAgICA/IEZsb2F0aW5nRGlhbG9nLk1PQklMRV9ERUZBVUxUX01JTl9XSURUSFxuICAgICAgICAgIDogRmxvYXRpbmdEaWFsb2cuREVGQVVMVF9NSU5fV0lEVEhcbiAgICAgICAgOiBpc0N1cnJlbnRseU1vYmlsZVxuICAgICAgICA/IEZsb2F0aW5nRGlhbG9nLk1PQklMRV9ERUZBVUxUX01JTl9IRUlHSFRcbiAgICAgICAgOiBGbG9hdGluZ0RpYWxvZy5ERUZBVUxUX01JTl9IRUlHSFQ7XG5cbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJyB8fCB0eXBlb2YgdmFsdWUgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJyA/IHZhbHVlIDogZmFsbGJhY2s7XG4gICAgfVxuXG4gICAgY29uc3QgdHJpbW1lZCA9IHZhbHVlLnRyaW0oKTtcbiAgICAvLyDnmb7liIbmr5RcbiAgICBjb25zdCBwZXJjZW50TWF0Y2ggPSB0cmltbWVkLm1hdGNoKC9eKFswLTldKyg/OlxcLlswLTldKyk/KSUkLyk7XG4gICAgaWYgKHBlcmNlbnRNYXRjaCkge1xuICAgICAgY29uc3QgcmF0aW8gPSBwYXJzZUZsb2F0KHBlcmNlbnRNYXRjaFsxXSkgLyAxMDA7XG4gICAgICByZXR1cm4gTWF0aC5tYXgoMCwgTWF0aC5yb3VuZCgoYXhpcyA9PT0gJ3cnID8gdmlld3BvcnRXIDogdmlld3BvcnRIKSAqIHJhdGlvKSk7XG4gICAgfVxuICAgIC8vIHZ3L3ZoXG4gICAgY29uc3QgdndNYXRjaCA9IHRyaW1tZWQubWF0Y2goL14oWzAtOV0rKD86XFwuWzAtOV0rKT8pdnckL2kpO1xuICAgIGlmICh2d01hdGNoICYmIGF4aXMgPT09ICd3Jykge1xuICAgICAgY29uc3QgcmF0aW8gPSBwYXJzZUZsb2F0KHZ3TWF0Y2hbMV0pIC8gMTAwO1xuICAgICAgcmV0dXJuIE1hdGgubWF4KDAsIE1hdGgucm91bmQodmlld3BvcnRXICogcmF0aW8pKTtcbiAgICB9XG4gICAgY29uc3QgdmhNYXRjaCA9IHRyaW1tZWQubWF0Y2goL14oWzAtOV0rKD86XFwuWzAtOV0rKT8pdmgkL2kpO1xuICAgIGlmICh2aE1hdGNoICYmIGF4aXMgPT09ICdoJykge1xuICAgICAgY29uc3QgcmF0aW8gPSBwYXJzZUZsb2F0KHZoTWF0Y2hbMV0pIC8gMTAwO1xuICAgICAgcmV0dXJuIE1hdGgubWF4KDAsIE1hdGgucm91bmQodmlld3BvcnRIICogcmF0aW8pKTtcbiAgICB9XG5cbiAgICAvLyDlhbblroPljZXkvY3vvJrlsJ3or5XpgJrov4fkuLTml7blhYPntKDorqHnrpdcbiAgICBjb25zdCB0ZW1wID0gJCgnPGRpdi8+JykuY3NzKHtcbiAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgICAgdmlzaWJpbGl0eTogJ2hpZGRlbicsXG4gICAgICB3aWR0aDogYXhpcyA9PT0gJ3cnID8gdHJpbW1lZCA6ICdhdXRvJyxcbiAgICAgIGhlaWdodDogYXhpcyA9PT0gJ2gnID8gdHJpbW1lZCA6ICdhdXRvJyxcbiAgICB9KTtcbiAgICAkKCdib2R5JykuYXBwZW5kKHRlbXApO1xuICAgIGNvbnN0IG1lYXN1cmVkID0gYXhpcyA9PT0gJ3cnID8gdGVtcC5vdXRlcldpZHRoKCkgfHwgMCA6IHRlbXAub3V0ZXJIZWlnaHQoKSB8fCAwO1xuICAgIHRlbXAucmVtb3ZlKCk7XG4gICAgcmV0dXJuIG1lYXN1cmVkIHx8IGZhbGxiYWNrO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluWGheWuueWuueWZqFxuICAgKiBAcmV0dXJucyDlhoXlrrnlrrnlmahqUXVlcnnlr7nosaFcbiAgICovXG4gIHB1YmxpYyBnZXRDb250ZW50KCk6IEpRdWVyeTxIVE1MRWxlbWVudD4gfCBudWxsIHtcbiAgICByZXR1cm4gdGhpcy5jb250ZW50O1xuICB9XG5cbiAgLyoqXG4gICAqIOiBmueEpua1rueql++8iOe9rumhtuaYvuekuu+8iVxuICAgKi9cbiAgcHVibGljIGZvY3VzKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmRpYWxvZykge1xuICAgICAgY29uc3QgbWF4WkluZGV4ID0gTWF0aC5tYXgoXG4gICAgICAgIC4uLkFycmF5LmZyb20oJCgnLmZsb2F0aW5nLWRpYWxvZycpKS5tYXAoZWwgPT4gcGFyc2VJbnQoJChlbCkuY3NzKCd6LWluZGV4JykgfHwgJzQwMDAnKSksXG4gICAgICApO1xuXG4gICAgICB0aGlzLmRpYWxvZy5jc3MoJ3otaW5kZXgnLCBtYXhaSW5kZXggKyAxKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog6K6+572u5rWu56qX5qCH6aKYXG4gICAqIEBwYXJhbSB0aXRsZSDmlrDmoIfpophcbiAgICovXG4gIHB1YmxpYyBzZXRUaXRsZSh0aXRsZTogc3RyaW5nKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuZGlhbG9nKSB7XG4gICAgICB0aGlzLmRpYWxvZy5maW5kKCcuZGlhbG9nLXRpdGxlJykudGV4dCh0aXRsZSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWIh+aNouaKmOWPoOeKtuaAgVxuICAgKi9cbiAgcHVibGljIHRvZ2dsZSgpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMub3B0aW9ucy5jb2xsYXBzaWJsZSB8fCAhdGhpcy5kaWFsb2cpIHJldHVybjtcblxuICAgIGNvbnN0ICRjb250ZW50ID0gdGhpcy5kaWFsb2cuZmluZCgnLmRpYWxvZy1jb250ZW50Jyk7XG4gICAgY29uc3QgJHRvZ2dsZUJ0biA9IHRoaXMuZGlhbG9nLmZpbmQoJy5kaWFsb2ctdG9nZ2xlLWJ0biBpJyk7XG4gICAgY29uc3QgJHJlc2l6ZUhhbmRsZSA9IHRoaXMuZGlhbG9nLmZpbmQoJy5kaWFsb2ctcmVzaXplLWhhbmRsZScpO1xuXG4gICAgdGhpcy5pc0NvbGxhcHNlZCA9ICF0aGlzLmlzQ29sbGFwc2VkO1xuXG4gICAgJGNvbnRlbnQuc2xpZGVUb2dnbGUoMzAwLCAoKSA9PiB7XG4gICAgICBpZiAodGhpcy5pc0NvbGxhcHNlZCkge1xuICAgICAgICAkdG9nZ2xlQnRuLnJlbW92ZUNsYXNzKCdmYS1jaGV2cm9uLXVwJykuYWRkQ2xhc3MoJ2ZhLWNoZXZyb24tZG93bicpO1xuICAgICAgICAkcmVzaXplSGFuZGxlLmhpZGUoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICR0b2dnbGVCdG4ucmVtb3ZlQ2xhc3MoJ2ZhLWNoZXZyb24tZG93bicpLmFkZENsYXNzKCdmYS1jaGV2cm9uLXVwJyk7XG4gICAgICAgICRyZXNpemVIYW5kbGUuc2hvdygpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgdGhpcy5kaWFsb2cudG9nZ2xlQ2xhc3MoJ2NvbnRlbnQtY29sbGFwc2VkJywgdGhpcy5pc0NvbGxhcHNlZCk7XG4gICAgdGhpcy5vcHRpb25zLm9uVG9nZ2xlKHRoaXMuaXNDb2xsYXBzZWQpO1xuICB9XG5cbiAgLyoqXG4gICAqIOWFs+mXrea1rueql1xuICAgKi9cbiAgcHVibGljIGNsb3NlKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmRpYWxvZykge1xuICAgICAgdGhpcy5vcHRpb25zLm9uQ2xvc2UoKTtcbiAgICAgIHRoaXMudW5yZW5kZXIoKTtcbiAgICAgIEZsb2F0aW5nRGlhbG9nLmluc3RhbmNlcy5kZWxldGUodGhpcy5vcHRpb25zLmlkKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog6ZSA5q+B5rWu56qXRE9NXG4gICAqL1xuICBwcml2YXRlIHVucmVuZGVyKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmRpYWxvZykge1xuICAgICAgdGhpcy5kaWFsb2cucmVtb3ZlKCk7XG4gICAgICB0aGlzLmRpYWxvZyA9IG51bGw7XG4gICAgICB0aGlzLmNvbnRlbnQgPSBudWxsO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDnu5Hlrprkuovku7blpITnkIblmahcbiAgICovXG4gIHByaXZhdGUgYmluZEV2ZW50cygpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuZGlhbG9nKSByZXR1cm47XG5cbiAgICB0aGlzLmRpYWxvZy5maW5kKCcuZGlhbG9nLWNsb3NlLWJ0bicpLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcblxuICAgIGlmICh0aGlzLm9wdGlvbnMuY29sbGFwc2libGUpIHtcbiAgICAgIHRoaXMuZGlhbG9nLmZpbmQoJy5kaWFsb2ctdG9nZ2xlLWJ0bicpLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgdGhpcy50b2dnbGUoKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHRoaXMuZGlhbG9nLm9uKCdtb3VzZWRvd24nLCAoKSA9PiB7XG4gICAgICB0aGlzLmZvY3VzKCk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog5Yid5aeL5YyW5ouW5ou95ZKM6LCD5pW05aSn5bCP5Yqf6IO9XG4gICAqL1xuICBwcml2YXRlIGluaXRJbnRlcmFjdGlvbnMoKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmRpYWxvZykgcmV0dXJuO1xuXG4gICAgY29uc3QgaXNNb2JpbGVEZXZpY2UgPSBpc01vYmlsZSgpO1xuXG4gICAgLy8g5ouW5ou95Yqf6IO9XG4gICAgaWYgKHRoaXMub3B0aW9ucy5kcmFnZ2FibGUpIHtcbiAgICAgICh0aGlzLmRpYWxvZyBhcyBhbnkpLmRyYWdnYWJsZSh7XG4gICAgICAgIGhhbmRsZTogJy5kaWFsb2ctaGVhZGVyJyxcbiAgICAgICAgY29udGFpbm1lbnQ6ICd3aW5kb3cnLFxuICAgICAgICBzdGFydDogKCkgPT4ge1xuICAgICAgICAgIHRoaXMuZGlhbG9nPy5hZGRDbGFzcygnZHJhZ2dpbmcnKTtcbiAgICAgICAgICB0aGlzLmZvY3VzKCk7XG4gICAgICAgIH0sXG4gICAgICAgIHN0b3A6ICgpID0+IHtcbiAgICAgICAgICB0aGlzLmRpYWxvZz8ucmVtb3ZlQ2xhc3MoJ2RyYWdnaW5nJyk7XG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyDosIPmlbTlpKflsI/lip/og71cbiAgICBpZiAodGhpcy5vcHRpb25zLnJlc2l6YWJsZSkge1xuICAgICAgKHRoaXMuZGlhbG9nIGFzIGFueSkucmVzaXphYmxlKHtcbiAgICAgICAgaGFuZGxlczogaXNNb2JpbGVEZXZpY2UgPyAnc2UnIDogJ24sZSxzLHcsbmUsc2Usc3csbncnLFxuICAgICAgICBtaW5IZWlnaHQ6IHRoaXMuY29tcHV0ZVBpeGVsU2l6ZSh0aGlzLm9wdGlvbnMubWluSGVpZ2h0LCAnaCcpLFxuICAgICAgICBtaW5XaWR0aDogdGhpcy5jb21wdXRlUGl4ZWxTaXplKHRoaXMub3B0aW9ucy5taW5XaWR0aCwgJ3cnKSxcbiAgICAgICAgc3RhcnQ6ICgpID0+IHtcbiAgICAgICAgICB0aGlzLmRpYWxvZz8uYWRkQ2xhc3MoJ3Jlc2l6aW5nJyk7XG4gICAgICAgICAgdGhpcy5mb2N1cygpO1xuICAgICAgICAgIGNvbnN0IG1pblcgPSB0aGlzLmNvbXB1dGVQaXhlbFNpemUodGhpcy5vcHRpb25zLm1pbldpZHRoLCAndycpO1xuICAgICAgICAgIGNvbnN0IG1pbkggPSB0aGlzLmNvbXB1dGVQaXhlbFNpemUodGhpcy5vcHRpb25zLm1pbkhlaWdodCwgJ2gnKTtcbiAgICAgICAgICAodGhpcy5kaWFsb2cgYXMgYW55KS5yZXNpemFibGUoJ29wdGlvbicsICdtaW5XaWR0aCcsIG1pblcpO1xuICAgICAgICAgICh0aGlzLmRpYWxvZyBhcyBhbnkpLnJlc2l6YWJsZSgnb3B0aW9uJywgJ21pbkhlaWdodCcsIG1pbkgpO1xuICAgICAgICB9LFxuICAgICAgICBzdG9wOiAoKSA9PiB7XG4gICAgICAgICAgdGhpcy5kaWFsb2c/LnJlbW92ZUNsYXNzKCdyZXNpemluZycpO1xuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8g56e75Yqo6K6+5aSH5pi+56S66LCD5pW05aSn5bCP5omL5p+EXG4gICAgaWYgKGlzTW9iaWxlRGV2aWNlICYmIHRoaXMub3B0aW9ucy5yZXNpemFibGUpIHtcbiAgICAgIHRoaXMuZGlhbG9nLmZpbmQoJy5kaWFsb2ctcmVzaXplLWhhbmRsZScpLnNob3coKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5bCG5rWu56qX5bGF5Lit5pi+56S6XG4gICAqL1xuICBwcml2YXRlIGNlbnRlckRpYWxvZygpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuZGlhbG9nKSByZXR1cm47XG5cbiAgICBjb25zdCB3aW5kb3dXaWR0aCA9ICQod2luZG93KS53aWR0aCgpIHx8IDA7XG4gICAgY29uc3Qgd2luZG93SGVpZ2h0ID0gJCh3aW5kb3cpLmhlaWdodCgpIHx8IDA7XG5cbiAgICBjb25zdCBkaWFsb2dXaWR0aCA9IHRoaXMuZGlhbG9nLm91dGVyV2lkdGgoKSB8fCAwO1xuICAgIGNvbnN0IGRpYWxvZ0hlaWdodCA9IHRoaXMuZGlhbG9nLm91dGVySGVpZ2h0KCkgfHwgMDtcblxuICAgIGNvbnN0IGxlZnQgPSBNYXRoLm1heCgwLCAod2luZG93V2lkdGggLSBkaWFsb2dXaWR0aCkgLyAyKTtcbiAgICBjb25zdCB0b3AgPSBNYXRoLm1heCgwLCAod2luZG93SGVpZ2h0IC0gZGlhbG9nSGVpZ2h0KSAvIDIpO1xuXG4gICAgdGhpcy5kaWFsb2cuY3NzKHtcbiAgICAgIGxlZnQ6IGAke2xlZnR9cHhgLFxuICAgICAgdG9wOiBgJHt0b3B9cHhgLFxuICAgICAgcG9zaXRpb246ICdmaXhlZCcsXG4gICAgICB6SW5kZXg6IDQwMDAsXG4gICAgfSk7XG5cbiAgICB0aGlzLmZvY3VzKCk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/util/floating_dialog.ts\n\n}")},"./src/util/is_url.ts":
/*!****************************!*\
  !*** ./src/util/is_url.ts ***!
  \****************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   isUrl: () => (/* binding */ isUrl)\n/* harmony export */ });\nfunction isUrl(url) {\n    try {\n        new URL(url);\n        return true;\n    }\n    catch (error) {\n        return false;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvdXRpbC9pc191cmwudHMiLCJtYXBwaW5ncyI6Ijs7OztBQUFPLFNBQVMsS0FBSyxDQUFDLEdBQVc7SUFDL0IsSUFBSSxDQUFDO1FBQ0gsSUFBSSxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDYixPQUFPLElBQUksQ0FBQztJQUNkLENBQUM7SUFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO1FBQ2YsT0FBTyxLQUFLLENBQUM7SUFDZixDQUFDO0FBQ0gsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy91dGlsL2lzX3VybC50cz8xMDc2Il0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBmdW5jdGlvbiBpc1VybCh1cmw6IHN0cmluZyk6IGJvb2xlYW4ge1xuICB0cnkge1xuICAgIG5ldyBVUkwodXJsKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/util/is_url.ts\n\n}")},"./src/util/load_file_to_document.ts":
/*!*******************************************!*\
  !*** ./src/util/load_file_to_document.ts ***!
  \*******************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   loadFileToHead: () => (/* binding */ loadFileToHead)\n/* harmony export */ });\n/**\n * 加载 CSS 或 JS 文件，并将其附加到相应的文档部分。修改自SillyTavern的loadFileToDocument\n * CSS文件将作为内联<style>标签插入，JS文件依然作为<script>标签插入\n *\n * @param {string} url - 要加载的文件的 URL。\n * @param {string} type - 要加载的文件类型：\"CSS\" 或 \"JS\"\n * @param {string} id - 要设置的元素的 ID。\n */\nasync function loadFileToHead(url, type, id) {\n    return new Promise((resolve, reject) => {\n        if (type === 'css') {\n            fetch(url)\n                .then(response => {\n                if (!response.ok) {\n                    throw new Error(`HTTP error! status: ${response.status}`);\n                }\n                return response.text();\n            })\n                .then(cssContent => {\n                if (id) {\n                    const existingStyle = document.getElementById(id);\n                    if (existingStyle) {\n                        existingStyle.remove();\n                    }\n                }\n                const styleElement = document.createElement('style');\n                styleElement.textContent = cssContent;\n                if (id) {\n                    const cleanId = id.toString().replace(/[^a-z0-9_-]/gi, '_');\n                    styleElement.id = cleanId;\n                }\n                document.head.appendChild(styleElement);\n                resolve(styleElement);\n            })\n                .catch(error => {\n                reject(error);\n            });\n        }\n        else if (type === 'js') {\n            const element = document.createElement('script');\n            element.src = url;\n            if (id) {\n                const cleanId = id.toString().replace(/[^a-z0-9_-]/gi, '_');\n                element.id = cleanId;\n            }\n            element.onload = resolve;\n            element.onerror = reject;\n            document.body.appendChild(element);\n        }\n        else {\n            reject('Invalid type specified');\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvdXRpbC9sb2FkX2ZpbGVfdG9fZG9jdW1lbnQudHMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBOzs7Ozs7O0dBT0c7QUFFSSxLQUFLLFVBQVUsY0FBYyxDQUFDLEdBQVcsRUFBRSxJQUFrQixFQUFFLEVBQVc7SUFDL0UsT0FBTyxJQUFJLE9BQU8sQ0FBQyxDQUFDLE9BQU8sRUFBRSxNQUFNLEVBQUUsRUFBRTtRQUNyQyxJQUFJLElBQUksS0FBSyxLQUFLLEVBQUUsQ0FBQztZQUNuQixLQUFLLENBQUMsR0FBRyxDQUFDO2lCQUNQLElBQUksQ0FBQyxRQUFRLENBQUMsRUFBRTtnQkFDZixJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsRUFBRSxDQUFDO29CQUNqQixNQUFNLElBQUksS0FBSyxDQUFDLHVCQUF1QixRQUFRLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQztnQkFDNUQsQ0FBQztnQkFDRCxPQUFPLFFBQVEsQ0FBQyxJQUFJLEVBQUUsQ0FBQztZQUN6QixDQUFDLENBQUM7aUJBQ0QsSUFBSSxDQUFDLFVBQVUsQ0FBQyxFQUFFO2dCQUNqQixJQUFJLEVBQUUsRUFBRSxDQUFDO29CQUNQLE1BQU0sYUFBYSxHQUFHLFFBQVEsQ0FBQyxjQUFjLENBQUMsRUFBRSxDQUFDLENBQUM7b0JBQ2xELElBQUksYUFBYSxFQUFFLENBQUM7d0JBQ2xCLGFBQWEsQ0FBQyxNQUFNLEVBQUUsQ0FBQztvQkFDekIsQ0FBQztnQkFDSCxDQUFDO2dCQUVELE1BQU0sWUFBWSxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLENBQUM7Z0JBQ3JELFlBQVksQ0FBQyxXQUFXLEdBQUcsVUFBVSxDQUFDO2dCQUV0QyxJQUFJLEVBQUUsRUFBRSxDQUFDO29CQUNQLE1BQU0sT0FBTyxHQUFHLEVBQUUsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxPQUFPLENBQUMsZUFBZSxFQUFFLEdBQUcsQ0FBQyxDQUFDO29CQUM1RCxZQUFZLENBQUMsRUFBRSxHQUFHLE9BQU8sQ0FBQztnQkFDNUIsQ0FBQztnQkFFRCxRQUFRLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxZQUFZLENBQUMsQ0FBQztnQkFDeEMsT0FBTyxDQUFDLFlBQVksQ0FBQyxDQUFDO1lBQ3hCLENBQUMsQ0FBQztpQkFDRCxLQUFLLENBQUMsS0FBSyxDQUFDLEVBQUU7Z0JBQ2IsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ2hCLENBQUMsQ0FBQyxDQUFDO1FBQ1AsQ0FBQzthQUFNLElBQUksSUFBSSxLQUFLLElBQUksRUFBRSxDQUFDO1lBQ3pCLE1BQU0sT0FBTyxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDakQsT0FBTyxDQUFDLEdBQUcsR0FBRyxHQUFHLENBQUM7WUFFbEIsSUFBSSxFQUFFLEVBQUUsQ0FBQztnQkFDUCxNQUFNLE9BQU8sR0FBRyxFQUFFLENBQUMsUUFBUSxFQUFFLENBQUMsT0FBTyxDQUFDLGVBQWUsRUFBRSxHQUFHLENBQUMsQ0FBQztnQkFDNUQsT0FBTyxDQUFDLEVBQUUsR0FBRyxPQUFPLENBQUM7WUFDdkIsQ0FBQztZQUVELE9BQU8sQ0FBQyxNQUFNLEdBQUcsT0FBTyxDQUFDO1lBQ3pCLE9BQU8sQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDO1lBRXpCLFFBQVEsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ3JDLENBQUM7YUFBTSxDQUFDO1lBQ04sTUFBTSxDQUFDLHdCQUF3QixDQUFDLENBQUM7UUFDbkMsQ0FBQztJQUNILENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy91dGlsL2xvYWRfZmlsZV90b19kb2N1bWVudC50cz9iZDYxIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICog5Yqg6L29IENTUyDmiJYgSlMg5paH5Lu277yM5bm25bCG5YW26ZmE5Yqg5Yiw55u45bqU55qE5paH5qGj6YOo5YiG44CC5L+u5pS56IeqU2lsbHlUYXZlcm7nmoRsb2FkRmlsZVRvRG9jdW1lbnRcbiAqIENTU+aWh+S7tuWwhuS9nOS4uuWGheiBlDxzdHlsZT7moIfnrb7mj5LlhaXvvIxKU+aWh+S7tuS+neeEtuS9nOS4ujxzY3JpcHQ+5qCH562+5o+S5YWlXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHVybCAtIOimgeWKoOi9veeahOaWh+S7tueahCBVUkzjgIJcbiAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIC0g6KaB5Yqg6L2955qE5paH5Lu257G75Z6L77yaXCJDU1NcIiDmiJYgXCJKU1wiXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgLSDopoHorr7nva7nmoTlhYPntKDnmoQgSUTjgIJcbiAqL1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9hZEZpbGVUb0hlYWQodXJsOiBzdHJpbmcsIHR5cGU6ICdjc3MnIHwgJ2pzJywgaWQ/OiBzdHJpbmcpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBpZiAodHlwZSA9PT0gJ2NzcycpIHtcbiAgICAgIGZldGNoKHVybClcbiAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4ge1xuICAgICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSFRUUCBlcnJvciEgc3RhdHVzOiAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnRleHQoKTtcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oY3NzQ29udGVudCA9PiB7XG4gICAgICAgICAgaWYgKGlkKSB7XG4gICAgICAgICAgICBjb25zdCBleGlzdGluZ1N0eWxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xuICAgICAgICAgICAgaWYgKGV4aXN0aW5nU3R5bGUpIHtcbiAgICAgICAgICAgICAgZXhpc3RpbmdTdHlsZS5yZW1vdmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb25zdCBzdHlsZUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpO1xuICAgICAgICAgIHN0eWxlRWxlbWVudC50ZXh0Q29udGVudCA9IGNzc0NvbnRlbnQ7XG5cbiAgICAgICAgICBpZiAoaWQpIHtcbiAgICAgICAgICAgIGNvbnN0IGNsZWFuSWQgPSBpZC50b1N0cmluZygpLnJlcGxhY2UoL1teYS16MC05Xy1dL2dpLCAnXycpO1xuICAgICAgICAgICAgc3R5bGVFbGVtZW50LmlkID0gY2xlYW5JZDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHN0eWxlRWxlbWVudCk7XG4gICAgICAgICAgcmVzb2x2ZShzdHlsZUVsZW1lbnQpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ2pzJykge1xuICAgICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xuICAgICAgZWxlbWVudC5zcmMgPSB1cmw7XG5cbiAgICAgIGlmIChpZCkge1xuICAgICAgICBjb25zdCBjbGVhbklkID0gaWQudG9TdHJpbmcoKS5yZXBsYWNlKC9bXmEtejAtOV8tXS9naSwgJ18nKTtcbiAgICAgICAgZWxlbWVudC5pZCA9IGNsZWFuSWQ7XG4gICAgICB9XG5cbiAgICAgIGVsZW1lbnQub25sb2FkID0gcmVzb2x2ZTtcbiAgICAgIGVsZW1lbnQub25lcnJvciA9IHJlamVjdDtcblxuICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbGVtZW50KTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVqZWN0KCdJbnZhbGlkIHR5cGUgc3BlY2lmaWVkJyk7XG4gICAgfVxuICB9KTtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/util/load_file_to_document.ts\n\n}")},"./src/util/map_util.ts":
/*!******************************!*\
  !*** ./src/util/map_util.ts ***!
  \******************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   extract: () => (/* binding */ extract),\n/* harmony export */   get_or_set: () => (/* binding */ get_or_set),\n/* harmony export */   try_set: () => (/* binding */ try_set)\n/* harmony export */ });\nfunction try_set(map, key, value) {\n    if (map.has(key)) {\n        return false;\n    }\n    map.set(key, value);\n    return true;\n}\nfunction get_or_set(map, key, defaulter) {\n    const existing_value = map.get(key);\n    if (existing_value) {\n        return existing_value;\n    }\n    const default_value = defaulter();\n    map.set(key, default_value);\n    return default_value;\n}\nfunction extract(map, key) {\n    const value = map.get(key);\n    if (!value) {\n        return undefined;\n    }\n    map.delete(key);\n    return value;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvdXRpbC9tYXBfdXRpbC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBTyxTQUFTLE9BQU8sQ0FBTyxHQUFjLEVBQUUsR0FBTSxFQUFFLEtBQVE7SUFDNUQsSUFBSSxHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUM7UUFDakIsT0FBTyxLQUFLLENBQUM7SUFDZixDQUFDO0lBQ0QsR0FBRyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsS0FBSyxDQUFDLENBQUM7SUFDcEIsT0FBTyxJQUFJLENBQUM7QUFDZCxDQUFDO0FBRU0sU0FBUyxVQUFVLENBQU8sR0FBYyxFQUFFLEdBQU0sRUFBRSxTQUFrQjtJQUN6RSxNQUFNLGNBQWMsR0FBRyxHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ3BDLElBQUksY0FBYyxFQUFFLENBQUM7UUFDbkIsT0FBTyxjQUFjLENBQUM7SUFDeEIsQ0FBQztJQUNELE1BQU0sYUFBYSxHQUFHLFNBQVMsRUFBRSxDQUFDO0lBQ2xDLEdBQUcsQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLGFBQWEsQ0FBQyxDQUFDO0lBQzVCLE9BQU8sYUFBYSxDQUFDO0FBQ3ZCLENBQUM7QUFFTSxTQUFTLE9BQU8sQ0FBTyxHQUFjLEVBQUUsR0FBTTtJQUNsRCxNQUFNLEtBQUssR0FBRyxHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQzNCLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUNYLE9BQU8sU0FBUyxDQUFDO0lBQ25CLENBQUM7SUFDRCxHQUFHLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ2hCLE9BQU8sS0FBSyxDQUFDO0FBQ2YsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy91dGlsL21hcF91dGlsLnRzPzQ5NmUiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGZ1bmN0aW9uIHRyeV9zZXQ8SywgVj4obWFwOiBNYXA8SywgVj4sIGtleTogSywgdmFsdWU6IFYpOiBib29sZWFuIHtcbiAgaWYgKG1hcC5oYXMoa2V5KSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBtYXAuc2V0KGtleSwgdmFsdWUpO1xuICByZXR1cm4gdHJ1ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldF9vcl9zZXQ8SywgVj4obWFwOiBNYXA8SywgVj4sIGtleTogSywgZGVmYXVsdGVyOiAoKSA9PiBWKTogViB7XG4gIGNvbnN0IGV4aXN0aW5nX3ZhbHVlID0gbWFwLmdldChrZXkpO1xuICBpZiAoZXhpc3RpbmdfdmFsdWUpIHtcbiAgICByZXR1cm4gZXhpc3RpbmdfdmFsdWU7XG4gIH1cbiAgY29uc3QgZGVmYXVsdF92YWx1ZSA9IGRlZmF1bHRlcigpO1xuICBtYXAuc2V0KGtleSwgZGVmYXVsdF92YWx1ZSk7XG4gIHJldHVybiBkZWZhdWx0X3ZhbHVlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZXh0cmFjdDxLLCBWPihtYXA6IE1hcDxLLCBWPiwga2V5OiBLKTogViB8IHVuZGVmaW5lZCB7XG4gIGNvbnN0IHZhbHVlID0gbWFwLmdldChrZXkpO1xuICBpZiAoIXZhbHVlKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuICBtYXAuZGVsZXRlKGtleSk7XG4gIHJldHVybiB2YWx1ZTtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/util/map_util.ts\n\n}")},"./src/util/render_markdown.ts":
/*!*************************************!*\
  !*** ./src/util/render_markdown.ts ***!
  \*************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   renderMarkdown: () => (/* binding */ renderMarkdown)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ "@sillytavern/script");\n\nfunction renderMarkdown(markdown) {\n    const converter = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.reloadMarkdownProcessor)();\n    let htmlText = converter.makeHtml(markdown);\n    htmlText = `<div style="text-align: left; max-height:80dvh; overflow-y: auto;">${htmlText}</div>`;\n    return htmlText;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvdXRpbC9yZW5kZXJfbWFya2Rvd24udHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBOEQ7QUFFdkQsU0FBUyxjQUFjLENBQUMsUUFBZ0I7SUFDN0MsTUFBTSxTQUFTLEdBQUcsNEVBQXVCLEVBQUUsQ0FBQztJQUM1QyxJQUFJLFFBQVEsR0FBRyxTQUFTLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQzVDLFFBQVEsR0FBRyxzRUFBc0UsUUFBUSxRQUFRLENBQUM7SUFDbEcsT0FBTyxRQUFRLENBQUM7QUFDbEIsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy91dGlsL3JlbmRlcl9tYXJrZG93bi50cz9mOGJhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHJlbG9hZE1hcmtkb3duUHJvY2Vzc29yIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5cbmV4cG9ydCBmdW5jdGlvbiByZW5kZXJNYXJrZG93bihtYXJrZG93bjogc3RyaW5nKSB7XG4gIGNvbnN0IGNvbnZlcnRlciA9IHJlbG9hZE1hcmtkb3duUHJvY2Vzc29yKCk7XG4gIGxldCBodG1sVGV4dCA9IGNvbnZlcnRlci5tYWtlSHRtbChtYXJrZG93bik7XG4gIGh0bWxUZXh0ID0gYDxkaXYgc3R5bGU9XCJ0ZXh0LWFsaWduOiBsZWZ0OyBtYXgtaGVpZ2h0OjgwZHZoOyBvdmVyZmxvdy15OiBhdXRvO1wiPiR7aHRtbFRleHR9PC9kaXY+YDtcbiAgcmV0dXJuIGh0bWxUZXh0O1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/util/render_markdown.ts\n\n}')},"@sillytavern/lib/jszip.min.js":
/*!**************************************************!*\
  !*** external "../../../../../lib/jszip.min.js" ***!
  \**************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__lib_jszip_min_js_715b4132__},"@sillytavern/script":
/*!*******************************************!*\
  !*** external "../../../../../script.js" ***!
  \*******************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__script_js_588e7203__},"@sillytavern/scripts/PromptManager":
/*!**********************************************************!*\
  !*** external "../../../../../scripts/PromptManager.js" ***!
  \**********************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_PromptManager_js_3415be00__},"@sillytavern/scripts/RossAscends-mods":
/*!*************************************************************!*\
  !*** external "../../../../../scripts/RossAscends-mods.js" ***!
  \*************************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_RossAscends_mods_js_224b6398__},"@sillytavern/scripts/authors-note":
/*!*********************************************************!*\
  !*** external "../../../../../scripts/authors-note.js" ***!
  \*********************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_authors_note_js_60883899__},"@sillytavern/scripts/extensions":
/*!*******************************************************!*\
  !*** external "../../../../../scripts/extensions.js" ***!
  \*******************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_extensions_js_86ff8498__},"@sillytavern/scripts/extensions/regex/engine":
/*!********************************************************************!*\
  !*** external "../../../../../scripts/extensions/regex/engine.js" ***!
  \********************************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_extensions_regex_engine_js_bce0a3be__},"@sillytavern/scripts/i18n":
/*!*************************************************!*\
  !*** external "../../../../../scripts/i18n.js" ***!
  \*************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_i18n_js_b4bbac2e__},"@sillytavern/scripts/macros":
/*!***************************************************!*\
  !*** external "../../../../../scripts/macros.js" ***!
  \***************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_macros_js_3c1c7442__},"@sillytavern/scripts/openai":
/*!***************************************************!*\
  !*** external "../../../../../scripts/openai.js" ***!
  \***************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_openai_js_991751fb__},"@sillytavern/scripts/popup":
/*!**************************************************!*\
  !*** external "../../../../../scripts/popup.js" ***!
  \**************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_popup_js_d782a329__},"@sillytavern/scripts/power-user":
/*!*******************************************************!*\
  !*** external "../../../../../scripts/power-user.js" ***!
  \*******************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_power_user_js_8eb57d1d__},"@sillytavern/scripts/preset-manager":
/*!***********************************************************!*\
  !*** external "../../../../../scripts/preset-manager.js" ***!
  \***********************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_preset_manager_js_701cca77__},"@sillytavern/scripts/slash-commands":
/*!***********************************************************!*\
  !*** external "../../../../../scripts/slash-commands.js" ***!
  \***********************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_js_aacea5c1__},"@sillytavern/scripts/slash-commands/SlashCommand":
/*!************************************************************************!*\
  !*** external "../../../../../scripts/slash-commands/SlashCommand.js" ***!
  \************************************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_SlashCommand_js_7714abe5__},"@sillytavern/scripts/slash-commands/SlashCommandArgument":
/*!********************************************************************************!*\
  !*** external "../../../../../scripts/slash-commands/SlashCommandArgument.js" ***!
  \********************************************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_SlashCommandArgument_js_9ae1817d__},"@sillytavern/scripts/slash-commands/SlashCommandCommonEnumsProvider":
/*!*******************************************************************************************!*\
  !*** external "../../../../../scripts/slash-commands/SlashCommandCommonEnumsProvider.js" ***!
  \*******************************************************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_SlashCommandCommonEnumsProvider_js_56229d14__},"@sillytavern/scripts/slash-commands/SlashCommandEnumValue":
/*!*********************************************************************************!*\
  !*** external "../../../../../scripts/slash-commands/SlashCommandEnumValue.js" ***!
  \*********************************************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_SlashCommandEnumValue_js_4a448917__},"@sillytavern/scripts/slash-commands/SlashCommandParser":
/*!******************************************************************************!*\
  !*** external "../../../../../scripts/slash-commands/SlashCommandParser.js" ***!
  \******************************************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_SlashCommandParser_js_585e5f4d__},"@sillytavern/scripts/tokenizers":
/*!*******************************************************!*\
  !*** external "../../../../../scripts/tokenizers.js" ***!
  \*******************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_tokenizers_js_ea98bd2a__},"@sillytavern/scripts/utils":
/*!**************************************************!*\
  !*** external "../../../../../scripts/utils.js" ***!
  \**************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_utils_js_ee651b62__},"@sillytavern/scripts/world-info":
/*!*******************************************************!*\
  !*** external "../../../../../scripts/world-info.js" ***!
  \*******************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_world_info_js_1b945dbf__},lodash:
/*!********************!*\
  !*** external "_" ***!
  \********************/Q=>{Q.exports=_},yaml:
/*!**************************************************************************************************!*\
  !*** external ["https://fastly.jsdelivr.net/gh/N0VI028/JS-Slash-Runner/lib/yaml.min.js","YAML"] ***!
  \**************************************************************************************************/(Q,F,U)=>{var B=new Error;Q.exports=new Promise((Q,F)=>{if("undefined"!=typeof YAML)return Q();U.l("https://fastly.jsdelivr.net/gh/N0VI028/JS-Slash-Runner/lib/yaml.min.js",U=>{if("undefined"!=typeof YAML)return Q();var n=U&&("load"===U.type?"missing":U.type),s=U&&U.target&&U.target.src;B.message="Loading script failed.\n("+n+": "+s+")",B.name="ScriptExternalLoadError",B.type=n,B.request=s,F(B)},"YAML")}).then(()=>YAML)},zod:
/*!********************************************************************!*\
  !*** external ["https://testingcf.jsdelivr.net/npm/zod/+esm","z"] ***!
  \********************************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_zod_esm_8a34751a__.z}},__webpack_module_cache__={},hasSymbol,webpackQueues,webpackExports,webpackError,resolveQueue,inProgress,dataWebpackPrefix;function __webpack_require__(Q){var F=__webpack_module_cache__[Q];if(void 0!==F)return F.exports;var U=__webpack_module_cache__[Q]={exports:{}};return __webpack_modules__[Q].call(U.exports,U,U.exports,__webpack_require__),U.exports}hasSymbol="function"==typeof Symbol,webpackQueues=hasSymbol?Symbol("webpack queues"):"__webpack_queues__",webpackExports=hasSymbol?Symbol("webpack exports"):"__webpack_exports__",webpackError=hasSymbol?Symbol("webpack error"):"__webpack_error__",resolveQueue=Q=>{Q&&Q.d<1&&(Q.d=1,Q.forEach(Q=>Q.r--),Q.forEach(Q=>Q.r--?Q.r++:Q()))},__webpack_require__.a=(Q,F,U)=>{var B;U&&((B=[]).d=-1);var n,s,e,t=new Set,l=Q.exports,I=new Promise((Q,F)=>{e=F,s=Q});I[webpackExports]=l,I[webpackQueues]=Q=>(B&&Q(B),t.forEach(Q),I.catch(Q=>{})),Q.exports=I,F(Q=>{var F;n=(Q=>Q.map(Q=>{if(null!==Q&&"object"==typeof Q){if(Q[webpackQueues])return Q;if(Q.then){var F=[];F.d=0,Q.then(Q=>{U[webpackExports]=Q,resolveQueue(F)},Q=>{U[webpackError]=Q,resolveQueue(F)});var U={};return U[webpackQueues]=Q=>Q(F),U}}var B={};return B[webpackQueues]=Q=>{},B[webpackExports]=Q,B}))(Q);var U=()=>n.map(Q=>{if(Q[webpackError])throw Q[webpackError];return Q[webpackExports]}),s=new Promise(Q=>{(F=()=>Q(U)).r=0;var s=Q=>Q!==B&&!t.has(Q)&&(t.add(Q),Q&&!Q.d&&(F.r++,Q.push(F)));n.map(Q=>Q[webpackQueues](s))});return F.r?s:U()},Q=>(Q?e(I[webpackError]=Q):s(l),resolveQueue(B))),B&&B.d<0&&(B.d=0)},__webpack_require__.n=Q=>{var F=Q&&Q.__esModule?()=>Q.default:()=>Q;return __webpack_require__.d(F,{a:F}),F},__webpack_require__.d=(Q,F)=>{for(var U in F)__webpack_require__.o(F,U)&&!__webpack_require__.o(Q,U)&&Object.defineProperty(Q,U,{enumerable:!0,get:F[U]})},__webpack_require__.o=(Q,F)=>Object.prototype.hasOwnProperty.call(Q,F),inProgress={},dataWebpackPrefix="JS-Slash-Runner:",__webpack_require__.l=(Q,F,U,B)=>{if(inProgress[Q])inProgress[Q].push(F);else{var n,s;if(void 0!==U)for(var e=document.getElementsByTagName("script"),t=0;t<e.length;t++){var l=e[t];if(l.getAttribute("src")==Q||l.getAttribute("data-webpack")==dataWebpackPrefix+U){n=l;break}}n||(s=!0,(n=document.createElement("script")).type="module",n.charset="utf-8",n.timeout=120,__webpack_require__.nc&&n.setAttribute("nonce",__webpack_require__.nc),n.setAttribute("data-webpack",dataWebpackPrefix+U),n.src=Q),inProgress[Q]=[F];var I=(F,U)=>{n.onerror=n.onload=null,clearTimeout(c);var B=inProgress[Q];if(delete inProgress[Q],n.parentNode&&n.parentNode.removeChild(n),B&&B.forEach(Q=>Q(U)),F)return F(U)},c=setTimeout(I.bind(null,void 0,{type:"timeout",target:n}),12e4);n.onerror=I.bind(null,n.onerror),n.onload=I.bind(null,n.onload),s&&document.head.appendChild(n)}},__webpack_require__.r=Q=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(Q,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(Q,"__esModule",{value:!0})};var __webpack_exports__=__webpack_require__("./src/index.ts");__webpack_exports__=await __webpack_exports__;