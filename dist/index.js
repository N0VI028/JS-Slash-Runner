import*as __WEBPACK_EXTERNAL_MODULE__lib_jszip_min_js_715b4132__ from"../../../../../lib/jszip.min.js";import*as __WEBPACK_EXTERNAL_MODULE__script_js_588e7203__ from"../../../../../script.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_PromptManager_js_3415be00__ from"../../../../../scripts/PromptManager.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_RossAscends_mods_js_224b6398__ from"../../../../../scripts/RossAscends-mods.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_authors_note_js_60883899__ from"../../../../../scripts/authors-note.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_extensions_js_86ff8498__ from"../../../../../scripts/extensions.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_extensions_regex_engine_js_bce0a3be__ from"../../../../../scripts/extensions/regex/engine.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_group_chats_js_79178f54__ from"../../../../../scripts/group-chats.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_i18n_js_b4bbac2e__ from"../../../../../scripts/i18n.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_macros_js_3c1c7442__ from"../../../../../scripts/macros.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_openai_js_991751fb__ from"../../../../../scripts/openai.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_popup_js_d782a329__ from"../../../../../scripts/popup.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_power_user_js_8eb57d1d__ from"../../../../../scripts/power-user.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_js_aacea5c1__ from"../../../../../scripts/slash-commands.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_SlashCommand_js_7714abe5__ from"../../../../../scripts/slash-commands/SlashCommand.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_SlashCommandArgument_js_9ae1817d__ from"../../../../../scripts/slash-commands/SlashCommandArgument.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_SlashCommandCommonEnumsProvider_js_56229d14__ from"../../../../../scripts/slash-commands/SlashCommandCommonEnumsProvider.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_SlashCommandEnumValue_js_4a448917__ from"../../../../../scripts/slash-commands/SlashCommandEnumValue.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_SlashCommandParser_js_585e5f4d__ from"../../../../../scripts/slash-commands/SlashCommandParser.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_utils_js_ee651b62__ from"../../../../../scripts/utils.js";import*as __WEBPACK_EXTERNAL_MODULE__scripts_world_info_js_1b945dbf__ from"../../../../../scripts/world-info.js";var __webpack_modules__={"./node_modules/.pnpm/@socket.io+component-emitter@3.1.2/node_modules/@socket.io/component-emitter/lib/esm/index.js":
/*!**************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@socket.io+component-emitter@3.1.2/node_modules/@socket.io/component-emitter/lib/esm/index.js ***!
  \**************************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Emitter: () => (/* binding */ Emitter)\n/* harmony export */ });\n/**\n * Initialize a new `Emitter`.\n *\n * @api public\n */\n\nfunction Emitter(obj) {\n  if (obj) return mixin(obj);\n}\n\n/**\n * Mixin the emitter properties.\n *\n * @param {Object} obj\n * @return {Object}\n * @api private\n */\n\nfunction mixin(obj) {\n  for (var key in Emitter.prototype) {\n    obj[key] = Emitter.prototype[key];\n  }\n  return obj;\n}\n\n/**\n * Listen on the given `event` with `fn`.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.on =\nEmitter.prototype.addEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n  (this._callbacks['$' + event] = this._callbacks['$' + event] || [])\n    .push(fn);\n  return this;\n};\n\n/**\n * Adds an `event` listener that will be invoked a single\n * time then automatically removed.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.once = function(event, fn){\n  function on() {\n    this.off(event, on);\n    fn.apply(this, arguments);\n  }\n\n  on.fn = fn;\n  this.on(event, on);\n  return this;\n};\n\n/**\n * Remove the given callback for `event` or all\n * registered callbacks.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.off =\nEmitter.prototype.removeListener =\nEmitter.prototype.removeAllListeners =\nEmitter.prototype.removeEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n\n  // all\n  if (0 == arguments.length) {\n    this._callbacks = {};\n    return this;\n  }\n\n  // specific event\n  var callbacks = this._callbacks['$' + event];\n  if (!callbacks) return this;\n\n  // remove all handlers\n  if (1 == arguments.length) {\n    delete this._callbacks['$' + event];\n    return this;\n  }\n\n  // remove specific handler\n  var cb;\n  for (var i = 0; i < callbacks.length; i++) {\n    cb = callbacks[i];\n    if (cb === fn || cb.fn === fn) {\n      callbacks.splice(i, 1);\n      break;\n    }\n  }\n\n  // Remove event specific arrays for event types that no\n  // one is subscribed for to avoid memory leak.\n  if (callbacks.length === 0) {\n    delete this._callbacks['$' + event];\n  }\n\n  return this;\n};\n\n/**\n * Emit `event` with the given args.\n *\n * @param {String} event\n * @param {Mixed} ...\n * @return {Emitter}\n */\n\nEmitter.prototype.emit = function(event){\n  this._callbacks = this._callbacks || {};\n\n  var args = new Array(arguments.length - 1)\n    , callbacks = this._callbacks['$' + event];\n\n  for (var i = 1; i < arguments.length; i++) {\n    args[i - 1] = arguments[i];\n  }\n\n  if (callbacks) {\n    callbacks = callbacks.slice(0);\n    for (var i = 0, len = callbacks.length; i < len; ++i) {\n      callbacks[i].apply(this, args);\n    }\n  }\n\n  return this;\n};\n\n// alias used for reserved events (protected method)\nEmitter.prototype.emitReserved = Emitter.prototype.emit;\n\n/**\n * Return array of callbacks for `event`.\n *\n * @param {String} event\n * @return {Array}\n * @api public\n */\n\nEmitter.prototype.listeners = function(event){\n  this._callbacks = this._callbacks || {};\n  return this._callbacks['$' + event] || [];\n};\n\n/**\n * Check if this emitter has `event` handlers.\n *\n * @param {String} event\n * @return {Boolean}\n * @api public\n */\n\nEmitter.prototype.hasListeners = function(event){\n  return !! this.listeners(event).length;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vQHNvY2tldC5pbytjb21wb25lbnQtZW1pdHRlckAzLjEuMi9ub2RlX21vZHVsZXMvQHNvY2tldC5pby9jb21wb25lbnQtZW1pdHRlci9saWIvZXNtL2luZGV4LmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVPO0FBQ1A7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFFBQVE7QUFDbkIsWUFBWTtBQUNaO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsUUFBUTtBQUNuQixXQUFXLFVBQVU7QUFDckIsWUFBWTtBQUNaO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFFBQVE7QUFDbkIsV0FBVyxVQUFVO0FBQ3JCLFlBQVk7QUFDWjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFFBQVE7QUFDbkIsV0FBVyxVQUFVO0FBQ3JCLFlBQVk7QUFDWjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esa0JBQWtCLHNCQUFzQjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsUUFBUTtBQUNuQixXQUFXLE9BQU87QUFDbEIsWUFBWTtBQUNaOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSxrQkFBa0Isc0JBQXNCO0FBQ3hDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLDRDQUE0QyxTQUFTO0FBQ3JEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsV0FBVyxRQUFRO0FBQ25CLFlBQVk7QUFDWjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsUUFBUTtBQUNuQixZQUFZO0FBQ1o7QUFDQTs7QUFFQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9ub2RlX21vZHVsZXMvLnBucG0vQHNvY2tldC5pbytjb21wb25lbnQtZW1pdHRlckAzLjEuMi9ub2RlX21vZHVsZXMvQHNvY2tldC5pby9jb21wb25lbnQtZW1pdHRlci9saWIvZXNtL2luZGV4LmpzPzRhNjAiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBJbml0aWFsaXplIGEgbmV3IGBFbWl0dGVyYC5cbiAqXG4gKiBAYXBpIHB1YmxpY1xuICovXG5cbmV4cG9ydCBmdW5jdGlvbiBFbWl0dGVyKG9iaikge1xuICBpZiAob2JqKSByZXR1cm4gbWl4aW4ob2JqKTtcbn1cblxuLyoqXG4gKiBNaXhpbiB0aGUgZW1pdHRlciBwcm9wZXJ0aWVzLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBvYmpcbiAqIEByZXR1cm4ge09iamVjdH1cbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5cbmZ1bmN0aW9uIG1peGluKG9iaikge1xuICBmb3IgKHZhciBrZXkgaW4gRW1pdHRlci5wcm90b3R5cGUpIHtcbiAgICBvYmpba2V5XSA9IEVtaXR0ZXIucHJvdG90eXBlW2tleV07XG4gIH1cbiAgcmV0dXJuIG9iajtcbn1cblxuLyoqXG4gKiBMaXN0ZW4gb24gdGhlIGdpdmVuIGBldmVudGAgd2l0aCBgZm5gLlxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBldmVudFxuICogQHBhcmFtIHtGdW5jdGlvbn0gZm5cbiAqIEByZXR1cm4ge0VtaXR0ZXJ9XG4gKiBAYXBpIHB1YmxpY1xuICovXG5cbkVtaXR0ZXIucHJvdG90eXBlLm9uID1cbkVtaXR0ZXIucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbihldmVudCwgZm4pe1xuICB0aGlzLl9jYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3MgfHwge307XG4gICh0aGlzLl9jYWxsYmFja3NbJyQnICsgZXZlbnRdID0gdGhpcy5fY2FsbGJhY2tzWyckJyArIGV2ZW50XSB8fCBbXSlcbiAgICAucHVzaChmbik7XG4gIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBBZGRzIGFuIGBldmVudGAgbGlzdGVuZXIgdGhhdCB3aWxsIGJlIGludm9rZWQgYSBzaW5nbGVcbiAqIHRpbWUgdGhlbiBhdXRvbWF0aWNhbGx5IHJlbW92ZWQuXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IGV2ZW50XG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmblxuICogQHJldHVybiB7RW1pdHRlcn1cbiAqIEBhcGkgcHVibGljXG4gKi9cblxuRW1pdHRlci5wcm90b3R5cGUub25jZSA9IGZ1bmN0aW9uKGV2ZW50LCBmbil7XG4gIGZ1bmN0aW9uIG9uKCkge1xuICAgIHRoaXMub2ZmKGV2ZW50LCBvbik7XG4gICAgZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfVxuXG4gIG9uLmZuID0gZm47XG4gIHRoaXMub24oZXZlbnQsIG9uKTtcbiAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIFJlbW92ZSB0aGUgZ2l2ZW4gY2FsbGJhY2sgZm9yIGBldmVudGAgb3IgYWxsXG4gKiByZWdpc3RlcmVkIGNhbGxiYWNrcy5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gZXZlbnRcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGZuXG4gKiBAcmV0dXJuIHtFbWl0dGVyfVxuICogQGFwaSBwdWJsaWNcbiAqL1xuXG5FbWl0dGVyLnByb3RvdHlwZS5vZmYgPVxuRW1pdHRlci5wcm90b3R5cGUucmVtb3ZlTGlzdGVuZXIgPVxuRW1pdHRlci5wcm90b3R5cGUucmVtb3ZlQWxsTGlzdGVuZXJzID1cbkVtaXR0ZXIucHJvdG90eXBlLnJlbW92ZUV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbihldmVudCwgZm4pe1xuICB0aGlzLl9jYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3MgfHwge307XG5cbiAgLy8gYWxsXG4gIGlmICgwID09IGFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICB0aGlzLl9jYWxsYmFja3MgPSB7fTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8vIHNwZWNpZmljIGV2ZW50XG4gIHZhciBjYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3NbJyQnICsgZXZlbnRdO1xuICBpZiAoIWNhbGxiYWNrcykgcmV0dXJuIHRoaXM7XG5cbiAgLy8gcmVtb3ZlIGFsbCBoYW5kbGVyc1xuICBpZiAoMSA9PSBhcmd1bWVudHMubGVuZ3RoKSB7XG4gICAgZGVsZXRlIHRoaXMuX2NhbGxiYWNrc1snJCcgKyBldmVudF07XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvLyByZW1vdmUgc3BlY2lmaWMgaGFuZGxlclxuICB2YXIgY2I7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgY2FsbGJhY2tzLmxlbmd0aDsgaSsrKSB7XG4gICAgY2IgPSBjYWxsYmFja3NbaV07XG4gICAgaWYgKGNiID09PSBmbiB8fCBjYi5mbiA9PT0gZm4pIHtcbiAgICAgIGNhbGxiYWNrcy5zcGxpY2UoaSwgMSk7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICAvLyBSZW1vdmUgZXZlbnQgc3BlY2lmaWMgYXJyYXlzIGZvciBldmVudCB0eXBlcyB0aGF0IG5vXG4gIC8vIG9uZSBpcyBzdWJzY3JpYmVkIGZvciB0byBhdm9pZCBtZW1vcnkgbGVhay5cbiAgaWYgKGNhbGxiYWNrcy5sZW5ndGggPT09IDApIHtcbiAgICBkZWxldGUgdGhpcy5fY2FsbGJhY2tzWyckJyArIGV2ZW50XTtcbiAgfVxuXG4gIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBFbWl0IGBldmVudGAgd2l0aCB0aGUgZ2l2ZW4gYXJncy5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gZXZlbnRcbiAqIEBwYXJhbSB7TWl4ZWR9IC4uLlxuICogQHJldHVybiB7RW1pdHRlcn1cbiAqL1xuXG5FbWl0dGVyLnByb3RvdHlwZS5lbWl0ID0gZnVuY3Rpb24oZXZlbnQpe1xuICB0aGlzLl9jYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3MgfHwge307XG5cbiAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aCAtIDEpXG4gICAgLCBjYWxsYmFja3MgPSB0aGlzLl9jYWxsYmFja3NbJyQnICsgZXZlbnRdO1xuXG4gIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgYXJnc1tpIC0gMV0gPSBhcmd1bWVudHNbaV07XG4gIH1cblxuICBpZiAoY2FsbGJhY2tzKSB7XG4gICAgY2FsbGJhY2tzID0gY2FsbGJhY2tzLnNsaWNlKDApO1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBjYWxsYmFja3MubGVuZ3RoOyBpIDwgbGVuOyArK2kpIHtcbiAgICAgIGNhbGxiYWNrc1tpXS5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdGhpcztcbn07XG5cbi8vIGFsaWFzIHVzZWQgZm9yIHJlc2VydmVkIGV2ZW50cyAocHJvdGVjdGVkIG1ldGhvZClcbkVtaXR0ZXIucHJvdG90eXBlLmVtaXRSZXNlcnZlZCA9IEVtaXR0ZXIucHJvdG90eXBlLmVtaXQ7XG5cbi8qKlxuICogUmV0dXJuIGFycmF5IG9mIGNhbGxiYWNrcyBmb3IgYGV2ZW50YC5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gZXZlbnRcbiAqIEByZXR1cm4ge0FycmF5fVxuICogQGFwaSBwdWJsaWNcbiAqL1xuXG5FbWl0dGVyLnByb3RvdHlwZS5saXN0ZW5lcnMgPSBmdW5jdGlvbihldmVudCl7XG4gIHRoaXMuX2NhbGxiYWNrcyA9IHRoaXMuX2NhbGxiYWNrcyB8fCB7fTtcbiAgcmV0dXJuIHRoaXMuX2NhbGxiYWNrc1snJCcgKyBldmVudF0gfHwgW107XG59O1xuXG4vKipcbiAqIENoZWNrIGlmIHRoaXMgZW1pdHRlciBoYXMgYGV2ZW50YCBoYW5kbGVycy5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gZXZlbnRcbiAqIEByZXR1cm4ge0Jvb2xlYW59XG4gKiBAYXBpIHB1YmxpY1xuICovXG5cbkVtaXR0ZXIucHJvdG90eXBlLmhhc0xpc3RlbmVycyA9IGZ1bmN0aW9uKGV2ZW50KXtcbiAgcmV0dXJuICEhIHRoaXMubGlzdGVuZXJzKGV2ZW50KS5sZW5ndGg7XG59O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/@socket.io+component-emitter@3.1.2/node_modules/@socket.io/component-emitter/lib/esm/index.js\n")},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/has-cors.js":
/*!***************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/has-cors.js ***!
  \***************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   hasCORS: () => (/* binding */ hasCORS)\n/* harmony export */ });\n// imported from https://github.com/component/has-cors\nlet value = false;\ntry {\n    value = typeof XMLHttpRequest !== 'undefined' &&\n        'withCredentials' in new XMLHttpRequest();\n}\ncatch (err) {\n    // if XMLHttp support is disabled in IE then it will throw\n    // when trying to create\n}\nconst hasCORS = value;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vY29udHJpYi9oYXMtY29ycy5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL25vZGVfbW9kdWxlcy8ucG5wbS9lbmdpbmUuaW8tY2xpZW50QDYuNi4zL25vZGVfbW9kdWxlcy9lbmdpbmUuaW8tY2xpZW50L2J1aWxkL2VzbS9jb250cmliL2hhcy1jb3JzLmpzP2M0MjkiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gaW1wb3J0ZWQgZnJvbSBodHRwczovL2dpdGh1Yi5jb20vY29tcG9uZW50L2hhcy1jb3JzXG5sZXQgdmFsdWUgPSBmYWxzZTtcbnRyeSB7XG4gICAgdmFsdWUgPSB0eXBlb2YgWE1MSHR0cFJlcXVlc3QgIT09ICd1bmRlZmluZWQnICYmXG4gICAgICAgICd3aXRoQ3JlZGVudGlhbHMnIGluIG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xufVxuY2F0Y2ggKGVycikge1xuICAgIC8vIGlmIFhNTEh0dHAgc3VwcG9ydCBpcyBkaXNhYmxlZCBpbiBJRSB0aGVuIGl0IHdpbGwgdGhyb3dcbiAgICAvLyB3aGVuIHRyeWluZyB0byBjcmVhdGVcbn1cbmV4cG9ydCBjb25zdCBoYXNDT1JTID0gdmFsdWU7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/has-cors.js\n")},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/parseqs.js":
/*!**************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/parseqs.js ***!
  \**************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   decode: () => (/* binding */ decode),\n/* harmony export */   encode: () => (/* binding */ encode)\n/* harmony export */ });\n// imported from https://github.com/galkn/querystring\n/**\n * Compiles a querystring\n * Returns string representation of the object\n *\n * @param {Object}\n * @api private\n */\nfunction encode(obj) {\n    let str = '';\n    for (let i in obj) {\n        if (obj.hasOwnProperty(i)) {\n            if (str.length)\n                str += '&';\n            str += encodeURIComponent(i) + '=' + encodeURIComponent(obj[i]);\n        }\n    }\n    return str;\n}\n/**\n * Parses a simple querystring into an object\n *\n * @param {String} qs\n * @api private\n */\nfunction decode(qs) {\n    let qry = {};\n    let pairs = qs.split('&');\n    for (let i = 0, l = pairs.length; i < l; i++) {\n        let pair = pairs[i].split('=');\n        qry[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);\n    }\n    return qry;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vY29udHJpYi9wYXJzZXFzLmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsUUFBUTtBQUNuQjtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0Esc0NBQXNDLE9BQU87QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL25vZGVfbW9kdWxlcy8ucG5wbS9lbmdpbmUuaW8tY2xpZW50QDYuNi4zL25vZGVfbW9kdWxlcy9lbmdpbmUuaW8tY2xpZW50L2J1aWxkL2VzbS9jb250cmliL3BhcnNlcXMuanM/YTllMCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBpbXBvcnRlZCBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9nYWxrbi9xdWVyeXN0cmluZ1xuLyoqXG4gKiBDb21waWxlcyBhIHF1ZXJ5c3RyaW5nXG4gKiBSZXR1cm5zIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgb2JqZWN0XG4gKlxuICogQHBhcmFtIHtPYmplY3R9XG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGVuY29kZShvYmopIHtcbiAgICBsZXQgc3RyID0gJyc7XG4gICAgZm9yIChsZXQgaSBpbiBvYmopIHtcbiAgICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShpKSkge1xuICAgICAgICAgICAgaWYgKHN0ci5sZW5ndGgpXG4gICAgICAgICAgICAgICAgc3RyICs9ICcmJztcbiAgICAgICAgICAgIHN0ciArPSBlbmNvZGVVUklDb21wb25lbnQoaSkgKyAnPScgKyBlbmNvZGVVUklDb21wb25lbnQob2JqW2ldKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gc3RyO1xufVxuLyoqXG4gKiBQYXJzZXMgYSBzaW1wbGUgcXVlcnlzdHJpbmcgaW50byBhbiBvYmplY3RcbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gcXNcbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5leHBvcnQgZnVuY3Rpb24gZGVjb2RlKHFzKSB7XG4gICAgbGV0IHFyeSA9IHt9O1xuICAgIGxldCBwYWlycyA9IHFzLnNwbGl0KCcmJyk7XG4gICAgZm9yIChsZXQgaSA9IDAsIGwgPSBwYWlycy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgbGV0IHBhaXIgPSBwYWlyc1tpXS5zcGxpdCgnPScpO1xuICAgICAgICBxcnlbZGVjb2RlVVJJQ29tcG9uZW50KHBhaXJbMF0pXSA9IGRlY29kZVVSSUNvbXBvbmVudChwYWlyWzFdKTtcbiAgICB9XG4gICAgcmV0dXJuIHFyeTtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/parseqs.js\n")},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/parseuri.js":
/*!***************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/parseuri.js ***!
  \***************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   parse: () => (/* binding */ parse)\n/* harmony export */ });\n// imported from https://github.com/galkn/parseuri\n/**\n * Parses a URI\n *\n * Note: we could also have used the built-in URL object, but it isn't supported on all platforms.\n *\n * See:\n * - https://developer.mozilla.org/en-US/docs/Web/API/URL\n * - https://caniuse.com/url\n * - https://www.rfc-editor.org/rfc/rfc3986#appendix-B\n *\n * History of the parse() method:\n * - first commit: https://github.com/socketio/socket.io-client/commit/4ee1d5d94b3906a9c052b459f1a818b15f38f91c\n * - export into its own module: https://github.com/socketio/engine.io-client/commit/de2c561e4564efeb78f1bdb1ba39ef81b2822cb3\n * - reimport: https://github.com/socketio/engine.io-client/commit/df32277c3f6d622eec5ed09f493cae3f3391d242\n *\n * @author Steven Levithan <stevenlevithan.com> (MIT license)\n * @api private\n */\nconst re = /^(?:(?![^:@\\/?#]+:[^:@\\/]*@)(http|https|ws|wss):\\/\\/)?((?:(([^:@\\/?#]*)(?::([^:@\\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/;\nconst parts = [\n    'source', 'protocol', 'authority', 'userInfo', 'user', 'password', 'host', 'port', 'relative', 'path', 'directory', 'file', 'query', 'anchor'\n];\nfunction parse(str) {\n    if (str.length > 8000) {\n        throw \"URI too long\";\n    }\n    const src = str, b = str.indexOf('['), e = str.indexOf(']');\n    if (b != -1 && e != -1) {\n        str = str.substring(0, b) + str.substring(b, e).replace(/:/g, ';') + str.substring(e, str.length);\n    }\n    let m = re.exec(str || ''), uri = {}, i = 14;\n    while (i--) {\n        uri[parts[i]] = m[i] || '';\n    }\n    if (b != -1 && e != -1) {\n        uri.source = src;\n        uri.host = uri.host.substring(1, uri.host.length - 1).replace(/;/g, ':');\n        uri.authority = uri.authority.replace('[', '').replace(']', '').replace(/;/g, ':');\n        uri.ipv6uri = true;\n    }\n    uri.pathNames = pathNames(uri, uri['path']);\n    uri.queryKey = queryKey(uri, uri['query']);\n    return uri;\n}\nfunction pathNames(obj, path) {\n    const regx = /\\/{2,9}/g, names = path.replace(regx, \"/\").split(\"/\");\n    if (path.slice(0, 1) == '/' || path.length === 0) {\n        names.splice(0, 1);\n    }\n    if (path.slice(-1) == '/') {\n        names.splice(names.length - 1, 1);\n    }\n    return names;\n}\nfunction queryKey(uri, query) {\n    const data = {};\n    query.replace(/(?:^|&)([^&=]*)=?([^&]*)/g, function ($0, $1, $2) {\n        if ($1) {\n            data[$1] = $2;\n        }\n    });\n    return data;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vY29udHJpYi9wYXJzZXVyaS5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1SEFBdUgsSUFBSSxHQUFHLElBQUksU0FBUyxJQUFJO0FBQy9JO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdFQUF3RTtBQUN4RTtBQUNBLHdDQUF3QztBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0VBQXdFO0FBQ3hFLGtGQUFrRjtBQUNsRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQixJQUFJO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL25vZGVfbW9kdWxlcy8ucG5wbS9lbmdpbmUuaW8tY2xpZW50QDYuNi4zL25vZGVfbW9kdWxlcy9lbmdpbmUuaW8tY2xpZW50L2J1aWxkL2VzbS9jb250cmliL3BhcnNldXJpLmpzP2NjZjEiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gaW1wb3J0ZWQgZnJvbSBodHRwczovL2dpdGh1Yi5jb20vZ2Fsa24vcGFyc2V1cmlcbi8qKlxuICogUGFyc2VzIGEgVVJJXG4gKlxuICogTm90ZTogd2UgY291bGQgYWxzbyBoYXZlIHVzZWQgdGhlIGJ1aWx0LWluIFVSTCBvYmplY3QsIGJ1dCBpdCBpc24ndCBzdXBwb3J0ZWQgb24gYWxsIHBsYXRmb3Jtcy5cbiAqXG4gKiBTZWU6XG4gKiAtIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9VUkxcbiAqIC0gaHR0cHM6Ly9jYW5pdXNlLmNvbS91cmxcbiAqIC0gaHR0cHM6Ly93d3cucmZjLWVkaXRvci5vcmcvcmZjL3JmYzM5ODYjYXBwZW5kaXgtQlxuICpcbiAqIEhpc3Rvcnkgb2YgdGhlIHBhcnNlKCkgbWV0aG9kOlxuICogLSBmaXJzdCBjb21taXQ6IGh0dHBzOi8vZ2l0aHViLmNvbS9zb2NrZXRpby9zb2NrZXQuaW8tY2xpZW50L2NvbW1pdC80ZWUxZDVkOTRiMzkwNmE5YzA1MmI0NTlmMWE4MThiMTVmMzhmOTFjXG4gKiAtIGV4cG9ydCBpbnRvIGl0cyBvd24gbW9kdWxlOiBodHRwczovL2dpdGh1Yi5jb20vc29ja2V0aW8vZW5naW5lLmlvLWNsaWVudC9jb21taXQvZGUyYzU2MWU0NTY0ZWZlYjc4ZjFiZGIxYmEzOWVmODFiMjgyMmNiM1xuICogLSByZWltcG9ydDogaHR0cHM6Ly9naXRodWIuY29tL3NvY2tldGlvL2VuZ2luZS5pby1jbGllbnQvY29tbWl0L2RmMzIyNzdjM2Y2ZDYyMmVlYzVlZDA5ZjQ5M2NhZTNmMzM5MWQyNDJcbiAqXG4gKiBAYXV0aG9yIFN0ZXZlbiBMZXZpdGhhbiA8c3RldmVubGV2aXRoYW4uY29tPiAoTUlUIGxpY2Vuc2UpXG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuY29uc3QgcmUgPSAvXig/Oig/IVteOkBcXC8/I10rOlteOkBcXC9dKkApKGh0dHB8aHR0cHN8d3N8d3NzKTpcXC9cXC8pPygoPzooKFteOkBcXC8/I10qKSg/OjooW146QFxcLz8jXSopKT8pP0ApPygoPzpbYS1mMC05XXswLDR9Oil7Miw3fVthLWYwLTldezAsNH18W146XFwvPyNdKikoPzo6KFxcZCopKT8pKCgoXFwvKD86W14/I10oPyFbXj8jXFwvXSpcXC5bXj8jXFwvLl0rKD86Wz8jXXwkKSkpKlxcLz8pPyhbXj8jXFwvXSopKSg/OlxcPyhbXiNdKikpPyg/OiMoLiopKT8pLztcbmNvbnN0IHBhcnRzID0gW1xuICAgICdzb3VyY2UnLCAncHJvdG9jb2wnLCAnYXV0aG9yaXR5JywgJ3VzZXJJbmZvJywgJ3VzZXInLCAncGFzc3dvcmQnLCAnaG9zdCcsICdwb3J0JywgJ3JlbGF0aXZlJywgJ3BhdGgnLCAnZGlyZWN0b3J5JywgJ2ZpbGUnLCAncXVlcnknLCAnYW5jaG9yJ1xuXTtcbmV4cG9ydCBmdW5jdGlvbiBwYXJzZShzdHIpIHtcbiAgICBpZiAoc3RyLmxlbmd0aCA+IDgwMDApIHtcbiAgICAgICAgdGhyb3cgXCJVUkkgdG9vIGxvbmdcIjtcbiAgICB9XG4gICAgY29uc3Qgc3JjID0gc3RyLCBiID0gc3RyLmluZGV4T2YoJ1snKSwgZSA9IHN0ci5pbmRleE9mKCddJyk7XG4gICAgaWYgKGIgIT0gLTEgJiYgZSAhPSAtMSkge1xuICAgICAgICBzdHIgPSBzdHIuc3Vic3RyaW5nKDAsIGIpICsgc3RyLnN1YnN0cmluZyhiLCBlKS5yZXBsYWNlKC86L2csICc7JykgKyBzdHIuc3Vic3RyaW5nKGUsIHN0ci5sZW5ndGgpO1xuICAgIH1cbiAgICBsZXQgbSA9IHJlLmV4ZWMoc3RyIHx8ICcnKSwgdXJpID0ge30sIGkgPSAxNDtcbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIHVyaVtwYXJ0c1tpXV0gPSBtW2ldIHx8ICcnO1xuICAgIH1cbiAgICBpZiAoYiAhPSAtMSAmJiBlICE9IC0xKSB7XG4gICAgICAgIHVyaS5zb3VyY2UgPSBzcmM7XG4gICAgICAgIHVyaS5ob3N0ID0gdXJpLmhvc3Quc3Vic3RyaW5nKDEsIHVyaS5ob3N0Lmxlbmd0aCAtIDEpLnJlcGxhY2UoLzsvZywgJzonKTtcbiAgICAgICAgdXJpLmF1dGhvcml0eSA9IHVyaS5hdXRob3JpdHkucmVwbGFjZSgnWycsICcnKS5yZXBsYWNlKCddJywgJycpLnJlcGxhY2UoLzsvZywgJzonKTtcbiAgICAgICAgdXJpLmlwdjZ1cmkgPSB0cnVlO1xuICAgIH1cbiAgICB1cmkucGF0aE5hbWVzID0gcGF0aE5hbWVzKHVyaSwgdXJpWydwYXRoJ10pO1xuICAgIHVyaS5xdWVyeUtleSA9IHF1ZXJ5S2V5KHVyaSwgdXJpWydxdWVyeSddKTtcbiAgICByZXR1cm4gdXJpO1xufVxuZnVuY3Rpb24gcGF0aE5hbWVzKG9iaiwgcGF0aCkge1xuICAgIGNvbnN0IHJlZ3ggPSAvXFwvezIsOX0vZywgbmFtZXMgPSBwYXRoLnJlcGxhY2UocmVneCwgXCIvXCIpLnNwbGl0KFwiL1wiKTtcbiAgICBpZiAocGF0aC5zbGljZSgwLCAxKSA9PSAnLycgfHwgcGF0aC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgbmFtZXMuc3BsaWNlKDAsIDEpO1xuICAgIH1cbiAgICBpZiAocGF0aC5zbGljZSgtMSkgPT0gJy8nKSB7XG4gICAgICAgIG5hbWVzLnNwbGljZShuYW1lcy5sZW5ndGggLSAxLCAxKTtcbiAgICB9XG4gICAgcmV0dXJuIG5hbWVzO1xufVxuZnVuY3Rpb24gcXVlcnlLZXkodXJpLCBxdWVyeSkge1xuICAgIGNvbnN0IGRhdGEgPSB7fTtcbiAgICBxdWVyeS5yZXBsYWNlKC8oPzpefCYpKFteJj1dKik9PyhbXiZdKikvZywgZnVuY3Rpb24gKCQwLCAkMSwgJDIpIHtcbiAgICAgICAgaWYgKCQxKSB7XG4gICAgICAgICAgICBkYXRhWyQxXSA9ICQyO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIGRhdGE7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/parseuri.js\n")},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/globals.js":
/*!******************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/globals.js ***!
  \******************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createCookieJar: () => (/* binding */ createCookieJar),\n/* harmony export */   defaultBinaryType: () => (/* binding */ defaultBinaryType),\n/* harmony export */   globalThisShim: () => (/* binding */ globalThisShim),\n/* harmony export */   nextTick: () => (/* binding */ nextTick)\n/* harmony export */ });\nconst nextTick = (() => {\n    const isPromiseAvailable = typeof Promise === "function" && typeof Promise.resolve === "function";\n    if (isPromiseAvailable) {\n        return (cb) => Promise.resolve().then(cb);\n    }\n    else {\n        return (cb, setTimeoutFn) => setTimeoutFn(cb, 0);\n    }\n})();\nconst globalThisShim = (() => {\n    if (typeof self !== "undefined") {\n        return self;\n    }\n    else if (typeof window !== "undefined") {\n        return window;\n    }\n    else {\n        return Function("return this")();\n    }\n})();\nconst defaultBinaryType = "arraybuffer";\nfunction createCookieJar() { }\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vZ2xvYmFscy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDTTtBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDTTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2VuZ2luZS5pby1jbGllbnRANi42LjMvbm9kZV9tb2R1bGVzL2VuZ2luZS5pby1jbGllbnQvYnVpbGQvZXNtL2dsb2JhbHMuanM/ZDc0MSJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgbmV4dFRpY2sgPSAoKCkgPT4ge1xuICAgIGNvbnN0IGlzUHJvbWlzZUF2YWlsYWJsZSA9IHR5cGVvZiBQcm9taXNlID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFByb21pc2UucmVzb2x2ZSA9PT0gXCJmdW5jdGlvblwiO1xuICAgIGlmIChpc1Byb21pc2VBdmFpbGFibGUpIHtcbiAgICAgICAgcmV0dXJuIChjYikgPT4gUHJvbWlzZS5yZXNvbHZlKCkudGhlbihjYik7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gKGNiLCBzZXRUaW1lb3V0Rm4pID0+IHNldFRpbWVvdXRGbihjYiwgMCk7XG4gICAgfVxufSkoKTtcbmV4cG9ydCBjb25zdCBnbG9iYWxUaGlzU2hpbSA9ICgoKSA9PiB7XG4gICAgaWYgKHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgIHJldHVybiBzZWxmO1xuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgIHJldHVybiB3aW5kb3c7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gRnVuY3Rpb24oXCJyZXR1cm4gdGhpc1wiKSgpO1xuICAgIH1cbn0pKCk7XG5leHBvcnQgY29uc3QgZGVmYXVsdEJpbmFyeVR5cGUgPSBcImFycmF5YnVmZmVyXCI7XG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQ29va2llSmFyKCkgeyB9XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/globals.js\n')},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/index.js":
/*!****************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/index.js ***!
  \****************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Fetch: () => (/* reexport safe */ _transports_polling_fetch_js__WEBPACK_IMPORTED_MODULE_6__.Fetch),\n/* harmony export */   NodeWebSocket: () => (/* reexport safe */ _transports_websocket_node_js__WEBPACK_IMPORTED_MODULE_8__.WS),\n/* harmony export */   NodeXHR: () => (/* reexport safe */ _transports_polling_xhr_node_js__WEBPACK_IMPORTED_MODULE_7__.XHR),\n/* harmony export */   Socket: () => (/* reexport safe */ _socket_js__WEBPACK_IMPORTED_MODULE_0__.Socket),\n/* harmony export */   SocketWithUpgrade: () => (/* reexport safe */ _socket_js__WEBPACK_IMPORTED_MODULE_0__.SocketWithUpgrade),\n/* harmony export */   SocketWithoutUpgrade: () => (/* reexport safe */ _socket_js__WEBPACK_IMPORTED_MODULE_0__.SocketWithoutUpgrade),\n/* harmony export */   Transport: () => (/* reexport safe */ _transport_js__WEBPACK_IMPORTED_MODULE_1__.Transport),\n/* harmony export */   TransportError: () => (/* reexport safe */ _transport_js__WEBPACK_IMPORTED_MODULE_1__.TransportError),\n/* harmony export */   WebSocket: () => (/* reexport safe */ _transports_websocket_node_js__WEBPACK_IMPORTED_MODULE_8__.WS),\n/* harmony export */   WebTransport: () => (/* reexport safe */ _transports_webtransport_js__WEBPACK_IMPORTED_MODULE_9__.WT),\n/* harmony export */   XHR: () => (/* reexport safe */ _transports_polling_xhr_node_js__WEBPACK_IMPORTED_MODULE_7__.XHR),\n/* harmony export */   installTimerFunctions: () => (/* reexport safe */ _util_js__WEBPACK_IMPORTED_MODULE_3__.installTimerFunctions),\n/* harmony export */   nextTick: () => (/* reexport safe */ _globals_node_js__WEBPACK_IMPORTED_MODULE_5__.nextTick),\n/* harmony export */   parse: () => (/* reexport safe */ _contrib_parseuri_js__WEBPACK_IMPORTED_MODULE_4__.parse),\n/* harmony export */   protocol: () => (/* binding */ protocol),\n/* harmony export */   transports: () => (/* reexport safe */ _transports_index_js__WEBPACK_IMPORTED_MODULE_2__.transports)\n/* harmony export */ });\n/* harmony import */ var _socket_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./socket.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/socket.js");\n/* harmony import */ var _transport_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./transport.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transport.js");\n/* harmony import */ var _transports_index_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./transports/index.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/index.js");\n/* harmony import */ var _util_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./util.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/util.js");\n/* harmony import */ var _contrib_parseuri_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./contrib/parseuri.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/parseuri.js");\n/* harmony import */ var _globals_node_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./globals.node.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/globals.js");\n/* harmony import */ var _transports_polling_fetch_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./transports/polling-fetch.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling-fetch.js");\n/* harmony import */ var _transports_polling_xhr_node_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./transports/polling-xhr.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling-xhr.js");\n/* harmony import */ var _transports_websocket_node_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./transports/websocket.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/websocket.js");\n/* harmony import */ var _transports_webtransport_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./transports/webtransport.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/webtransport.js");\n\n\n\nconst protocol = _socket_js__WEBPACK_IMPORTED_MODULE_0__.Socket.protocol;\n\n\n\n\n\n\n\n\n\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBcUM7QUFDbkI7QUFDcUQ7QUFDaEUsaUJBQWlCLDhDQUFNO0FBQzZCO0FBQ1I7QUFDRDtBQUNKO0FBQ0Q7QUFDUztBQUNZO0FBQ2hCO0FBQ21CO0FBQ1Q7QUFDTSIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL25vZGVfbW9kdWxlcy8ucG5wbS9lbmdpbmUuaW8tY2xpZW50QDYuNi4zL25vZGVfbW9kdWxlcy9lbmdpbmUuaW8tY2xpZW50L2J1aWxkL2VzbS9pbmRleC5qcz8xZTE2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFNvY2tldCB9IGZyb20gXCIuL3NvY2tldC5qc1wiO1xuZXhwb3J0IHsgU29ja2V0IH07XG5leHBvcnQgeyBTb2NrZXRXaXRob3V0VXBncmFkZSwgU29ja2V0V2l0aFVwZ3JhZGUsIH0gZnJvbSBcIi4vc29ja2V0LmpzXCI7XG5leHBvcnQgY29uc3QgcHJvdG9jb2wgPSBTb2NrZXQucHJvdG9jb2w7XG5leHBvcnQgeyBUcmFuc3BvcnQsIFRyYW5zcG9ydEVycm9yIH0gZnJvbSBcIi4vdHJhbnNwb3J0LmpzXCI7XG5leHBvcnQgeyB0cmFuc3BvcnRzIH0gZnJvbSBcIi4vdHJhbnNwb3J0cy9pbmRleC5qc1wiO1xuZXhwb3J0IHsgaW5zdGFsbFRpbWVyRnVuY3Rpb25zIH0gZnJvbSBcIi4vdXRpbC5qc1wiO1xuZXhwb3J0IHsgcGFyc2UgfSBmcm9tIFwiLi9jb250cmliL3BhcnNldXJpLmpzXCI7XG5leHBvcnQgeyBuZXh0VGljayB9IGZyb20gXCIuL2dsb2JhbHMubm9kZS5qc1wiO1xuZXhwb3J0IHsgRmV0Y2ggfSBmcm9tIFwiLi90cmFuc3BvcnRzL3BvbGxpbmctZmV0Y2guanNcIjtcbmV4cG9ydCB7IFhIUiBhcyBOb2RlWEhSIH0gZnJvbSBcIi4vdHJhbnNwb3J0cy9wb2xsaW5nLXhoci5ub2RlLmpzXCI7XG5leHBvcnQgeyBYSFIgfSBmcm9tIFwiLi90cmFuc3BvcnRzL3BvbGxpbmcteGhyLmpzXCI7XG5leHBvcnQgeyBXUyBhcyBOb2RlV2ViU29ja2V0IH0gZnJvbSBcIi4vdHJhbnNwb3J0cy93ZWJzb2NrZXQubm9kZS5qc1wiO1xuZXhwb3J0IHsgV1MgYXMgV2ViU29ja2V0IH0gZnJvbSBcIi4vdHJhbnNwb3J0cy93ZWJzb2NrZXQuanNcIjtcbmV4cG9ydCB7IFdUIGFzIFdlYlRyYW5zcG9ydCB9IGZyb20gXCIuL3RyYW5zcG9ydHMvd2VidHJhbnNwb3J0LmpzXCI7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/index.js\n')},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/socket.js":
/*!*****************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/socket.js ***!
  \*****************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Socket: () => (/* binding */ Socket),\n/* harmony export */   SocketWithUpgrade: () => (/* binding */ SocketWithUpgrade),\n/* harmony export */   SocketWithoutUpgrade: () => (/* binding */ SocketWithoutUpgrade)\n/* harmony export */ });\n/* harmony import */ var _transports_index_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./transports/index.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/index.js");\n/* harmony import */ var _util_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./util.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/util.js");\n/* harmony import */ var _contrib_parseqs_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./contrib/parseqs.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/parseqs.js");\n/* harmony import */ var _contrib_parseuri_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./contrib/parseuri.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/parseuri.js");\n/* harmony import */ var _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @socket.io/component-emitter */ "./node_modules/.pnpm/@socket.io+component-emitter@3.1.2/node_modules/@socket.io/component-emitter/lib/esm/index.js");\n/* harmony import */ var engine_io_parser__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! engine.io-parser */ "./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/index.js");\n/* harmony import */ var _globals_node_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./globals.node.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/globals.js");\n\n\n\n\n\n\n\nconst withEventListeners = typeof addEventListener === "function" &&\n    typeof removeEventListener === "function";\nconst OFFLINE_EVENT_LISTENERS = [];\nif (withEventListeners) {\n    // within a ServiceWorker, any event handler for the \'offline\' event must be added on the initial evaluation of the\n    // script, so we create one single event listener here which will forward the event to the socket instances\n    addEventListener("offline", () => {\n        OFFLINE_EVENT_LISTENERS.forEach((listener) => listener());\n    }, false);\n}\n/**\n * This class provides a WebSocket-like interface to connect to an Engine.IO server. The connection will be established\n * with one of the available low-level transports, like HTTP long-polling, WebSocket or WebTransport.\n *\n * This class comes without upgrade mechanism, which means that it will keep the first low-level transport that\n * successfully establishes the connection.\n *\n * In order to allow tree-shaking, there are no transports included, that\'s why the `transports` option is mandatory.\n *\n * @example\n * import { SocketWithoutUpgrade, WebSocket } from "engine.io-client";\n *\n * const socket = new SocketWithoutUpgrade({\n *   transports: [WebSocket]\n * });\n *\n * socket.on("open", () => {\n *   socket.send("hello");\n * });\n *\n * @see SocketWithUpgrade\n * @see Socket\n */\nclass SocketWithoutUpgrade extends _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_4__.Emitter {\n    /**\n     * Socket constructor.\n     *\n     * @param {String|Object} uri - uri or options\n     * @param {Object} opts - options\n     */\n    constructor(uri, opts) {\n        super();\n        this.binaryType = _globals_node_js__WEBPACK_IMPORTED_MODULE_6__.defaultBinaryType;\n        this.writeBuffer = [];\n        this._prevBufferLen = 0;\n        this._pingInterval = -1;\n        this._pingTimeout = -1;\n        this._maxPayload = -1;\n        /**\n         * The expiration timestamp of the {@link _pingTimeoutTimer} object is tracked, in case the timer is throttled and the\n         * callback is not fired on time. This can happen for example when a laptop is suspended or when a phone is locked.\n         */\n        this._pingTimeoutTime = Infinity;\n        if (uri && "object" === typeof uri) {\n            opts = uri;\n            uri = null;\n        }\n        if (uri) {\n            const parsedUri = (0,_contrib_parseuri_js__WEBPACK_IMPORTED_MODULE_3__.parse)(uri);\n            opts.hostname = parsedUri.host;\n            opts.secure =\n                parsedUri.protocol === "https" || parsedUri.protocol === "wss";\n            opts.port = parsedUri.port;\n            if (parsedUri.query)\n                opts.query = parsedUri.query;\n        }\n        else if (opts.host) {\n            opts.hostname = (0,_contrib_parseuri_js__WEBPACK_IMPORTED_MODULE_3__.parse)(opts.host).host;\n        }\n        (0,_util_js__WEBPACK_IMPORTED_MODULE_1__.installTimerFunctions)(this, opts);\n        this.secure =\n            null != opts.secure\n                ? opts.secure\n                : typeof location !== "undefined" && "https:" === location.protocol;\n        if (opts.hostname && !opts.port) {\n            // if no port is specified manually, use the protocol default\n            opts.port = this.secure ? "443" : "80";\n        }\n        this.hostname =\n            opts.hostname ||\n                (typeof location !== "undefined" ? location.hostname : "localhost");\n        this.port =\n            opts.port ||\n                (typeof location !== "undefined" && location.port\n                    ? location.port\n                    : this.secure\n                        ? "443"\n                        : "80");\n        this.transports = [];\n        this._transportsByName = {};\n        opts.transports.forEach((t) => {\n            const transportName = t.prototype.name;\n            this.transports.push(transportName);\n            this._transportsByName[transportName] = t;\n        });\n        this.opts = Object.assign({\n            path: "/engine.io",\n            agent: false,\n            withCredentials: false,\n            upgrade: true,\n            timestampParam: "t",\n            rememberUpgrade: false,\n            addTrailingSlash: true,\n            rejectUnauthorized: true,\n            perMessageDeflate: {\n                threshold: 1024,\n            },\n            transportOptions: {},\n            closeOnBeforeunload: false,\n        }, opts);\n        this.opts.path =\n            this.opts.path.replace(/\\/$/, "") +\n                (this.opts.addTrailingSlash ? "/" : "");\n        if (typeof this.opts.query === "string") {\n            this.opts.query = (0,_contrib_parseqs_js__WEBPACK_IMPORTED_MODULE_2__.decode)(this.opts.query);\n        }\n        if (withEventListeners) {\n            if (this.opts.closeOnBeforeunload) {\n                // Firefox closes the connection when the "beforeunload" event is emitted but not Chrome. This event listener\n                // ensures every browser behaves the same (no "disconnect" event at the Socket.IO level when the page is\n                // closed/reloaded)\n                this._beforeunloadEventListener = () => {\n                    if (this.transport) {\n                        // silently close the transport\n                        this.transport.removeAllListeners();\n                        this.transport.close();\n                    }\n                };\n                addEventListener("beforeunload", this._beforeunloadEventListener, false);\n            }\n            if (this.hostname !== "localhost") {\n                this._offlineEventListener = () => {\n                    this._onClose("transport close", {\n                        description: "network connection lost",\n                    });\n                };\n                OFFLINE_EVENT_LISTENERS.push(this._offlineEventListener);\n            }\n        }\n        if (this.opts.withCredentials) {\n            this._cookieJar = (0,_globals_node_js__WEBPACK_IMPORTED_MODULE_6__.createCookieJar)();\n        }\n        this._open();\n    }\n    /**\n     * Creates transport of the given type.\n     *\n     * @param {String} name - transport name\n     * @return {Transport}\n     * @private\n     */\n    createTransport(name) {\n        const query = Object.assign({}, this.opts.query);\n        // append engine.io protocol identifier\n        query.EIO = engine_io_parser__WEBPACK_IMPORTED_MODULE_5__.protocol;\n        // transport name\n        query.transport = name;\n        // session id if we already have one\n        if (this.id)\n            query.sid = this.id;\n        const opts = Object.assign({}, this.opts, {\n            query,\n            socket: this,\n            hostname: this.hostname,\n            secure: this.secure,\n            port: this.port,\n        }, this.opts.transportOptions[name]);\n        return new this._transportsByName[name](opts);\n    }\n    /**\n     * Initializes transport to use and starts probe.\n     *\n     * @private\n     */\n    _open() {\n        if (this.transports.length === 0) {\n            // Emit error on next tick so it can be listened to\n            this.setTimeoutFn(() => {\n                this.emitReserved("error", "No transports available");\n            }, 0);\n            return;\n        }\n        const transportName = this.opts.rememberUpgrade &&\n            SocketWithoutUpgrade.priorWebsocketSuccess &&\n            this.transports.indexOf("websocket") !== -1\n            ? "websocket"\n            : this.transports[0];\n        this.readyState = "opening";\n        const transport = this.createTransport(transportName);\n        transport.open();\n        this.setTransport(transport);\n    }\n    /**\n     * Sets the current transport. Disables the existing one (if any).\n     *\n     * @private\n     */\n    setTransport(transport) {\n        if (this.transport) {\n            this.transport.removeAllListeners();\n        }\n        // set up transport\n        this.transport = transport;\n        // set up transport listeners\n        transport\n            .on("drain", this._onDrain.bind(this))\n            .on("packet", this._onPacket.bind(this))\n            .on("error", this._onError.bind(this))\n            .on("close", (reason) => this._onClose("transport close", reason));\n    }\n    /**\n     * Called when connection is deemed open.\n     *\n     * @private\n     */\n    onOpen() {\n        this.readyState = "open";\n        SocketWithoutUpgrade.priorWebsocketSuccess =\n            "websocket" === this.transport.name;\n        this.emitReserved("open");\n        this.flush();\n    }\n    /**\n     * Handles a packet.\n     *\n     * @private\n     */\n    _onPacket(packet) {\n        if ("opening" === this.readyState ||\n            "open" === this.readyState ||\n            "closing" === this.readyState) {\n            this.emitReserved("packet", packet);\n            // Socket is live - any packet counts\n            this.emitReserved("heartbeat");\n            switch (packet.type) {\n                case "open":\n                    this.onHandshake(JSON.parse(packet.data));\n                    break;\n                case "ping":\n                    this._sendPacket("pong");\n                    this.emitReserved("ping");\n                    this.emitReserved("pong");\n                    this._resetPingTimeout();\n                    break;\n                case "error":\n                    const err = new Error("server error");\n                    // @ts-ignore\n                    err.code = packet.data;\n                    this._onError(err);\n                    break;\n                case "message":\n                    this.emitReserved("data", packet.data);\n                    this.emitReserved("message", packet.data);\n                    break;\n            }\n        }\n        else {\n        }\n    }\n    /**\n     * Called upon handshake completion.\n     *\n     * @param {Object} data - handshake obj\n     * @private\n     */\n    onHandshake(data) {\n        this.emitReserved("handshake", data);\n        this.id = data.sid;\n        this.transport.query.sid = data.sid;\n        this._pingInterval = data.pingInterval;\n        this._pingTimeout = data.pingTimeout;\n        this._maxPayload = data.maxPayload;\n        this.onOpen();\n        // In case open handler closes socket\n        if ("closed" === this.readyState)\n            return;\n        this._resetPingTimeout();\n    }\n    /**\n     * Sets and resets ping timeout timer based on server pings.\n     *\n     * @private\n     */\n    _resetPingTimeout() {\n        this.clearTimeoutFn(this._pingTimeoutTimer);\n        const delay = this._pingInterval + this._pingTimeout;\n        this._pingTimeoutTime = Date.now() + delay;\n        this._pingTimeoutTimer = this.setTimeoutFn(() => {\n            this._onClose("ping timeout");\n        }, delay);\n        if (this.opts.autoUnref) {\n            this._pingTimeoutTimer.unref();\n        }\n    }\n    /**\n     * Called on `drain` event\n     *\n     * @private\n     */\n    _onDrain() {\n        this.writeBuffer.splice(0, this._prevBufferLen);\n        // setting prevBufferLen = 0 is very important\n        // for example, when upgrading, upgrade packet is sent over,\n        // and a nonzero prevBufferLen could cause problems on `drain`\n        this._prevBufferLen = 0;\n        if (0 === this.writeBuffer.length) {\n            this.emitReserved("drain");\n        }\n        else {\n            this.flush();\n        }\n    }\n    /**\n     * Flush write buffers.\n     *\n     * @private\n     */\n    flush() {\n        if ("closed" !== this.readyState &&\n            this.transport.writable &&\n            !this.upgrading &&\n            this.writeBuffer.length) {\n            const packets = this._getWritablePackets();\n            this.transport.send(packets);\n            // keep track of current length of writeBuffer\n            // splice writeBuffer and callbackBuffer on `drain`\n            this._prevBufferLen = packets.length;\n            this.emitReserved("flush");\n        }\n    }\n    /**\n     * Ensure the encoded size of the writeBuffer is below the maxPayload value sent by the server (only for HTTP\n     * long-polling)\n     *\n     * @private\n     */\n    _getWritablePackets() {\n        const shouldCheckPayloadSize = this._maxPayload &&\n            this.transport.name === "polling" &&\n            this.writeBuffer.length > 1;\n        if (!shouldCheckPayloadSize) {\n            return this.writeBuffer;\n        }\n        let payloadSize = 1; // first packet type\n        for (let i = 0; i < this.writeBuffer.length; i++) {\n            const data = this.writeBuffer[i].data;\n            if (data) {\n                payloadSize += (0,_util_js__WEBPACK_IMPORTED_MODULE_1__.byteLength)(data);\n            }\n            if (i > 0 && payloadSize > this._maxPayload) {\n                return this.writeBuffer.slice(0, i);\n            }\n            payloadSize += 2; // separator + packet type\n        }\n        return this.writeBuffer;\n    }\n    /**\n     * Checks whether the heartbeat timer has expired but the socket has not yet been notified.\n     *\n     * Note: this method is private for now because it does not really fit the WebSocket API, but if we put it in the\n     * `write()` method then the message would not be buffered by the Socket.IO client.\n     *\n     * @return {boolean}\n     * @private\n     */\n    /* private */ _hasPingExpired() {\n        if (!this._pingTimeoutTime)\n            return true;\n        const hasExpired = Date.now() > this._pingTimeoutTime;\n        if (hasExpired) {\n            this._pingTimeoutTime = 0;\n            (0,_globals_node_js__WEBPACK_IMPORTED_MODULE_6__.nextTick)(() => {\n                this._onClose("ping timeout");\n            }, this.setTimeoutFn);\n        }\n        return hasExpired;\n    }\n    /**\n     * Sends a message.\n     *\n     * @param {String} msg - message.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @return {Socket} for chaining.\n     */\n    write(msg, options, fn) {\n        this._sendPacket("message", msg, options, fn);\n        return this;\n    }\n    /**\n     * Sends a message. Alias of {@link Socket#write}.\n     *\n     * @param {String} msg - message.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @return {Socket} for chaining.\n     */\n    send(msg, options, fn) {\n        this._sendPacket("message", msg, options, fn);\n        return this;\n    }\n    /**\n     * Sends a packet.\n     *\n     * @param {String} type: packet type.\n     * @param {String} data.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @private\n     */\n    _sendPacket(type, data, options, fn) {\n        if ("function" === typeof data) {\n            fn = data;\n            data = undefined;\n        }\n        if ("function" === typeof options) {\n            fn = options;\n            options = null;\n        }\n        if ("closing" === this.readyState || "closed" === this.readyState) {\n            return;\n        }\n        options = options || {};\n        options.compress = false !== options.compress;\n        const packet = {\n            type: type,\n            data: data,\n            options: options,\n        };\n        this.emitReserved("packetCreate", packet);\n        this.writeBuffer.push(packet);\n        if (fn)\n            this.once("flush", fn);\n        this.flush();\n    }\n    /**\n     * Closes the connection.\n     */\n    close() {\n        const close = () => {\n            this._onClose("forced close");\n            this.transport.close();\n        };\n        const cleanupAndClose = () => {\n            this.off("upgrade", cleanupAndClose);\n            this.off("upgradeError", cleanupAndClose);\n            close();\n        };\n        const waitForUpgrade = () => {\n            // wait for upgrade to finish since we can\'t send packets while pausing a transport\n            this.once("upgrade", cleanupAndClose);\n            this.once("upgradeError", cleanupAndClose);\n        };\n        if ("opening" === this.readyState || "open" === this.readyState) {\n            this.readyState = "closing";\n            if (this.writeBuffer.length) {\n                this.once("drain", () => {\n                    if (this.upgrading) {\n                        waitForUpgrade();\n                    }\n                    else {\n                        close();\n                    }\n                });\n            }\n            else if (this.upgrading) {\n                waitForUpgrade();\n            }\n            else {\n                close();\n            }\n        }\n        return this;\n    }\n    /**\n     * Called upon transport error\n     *\n     * @private\n     */\n    _onError(err) {\n        SocketWithoutUpgrade.priorWebsocketSuccess = false;\n        if (this.opts.tryAllTransports &&\n            this.transports.length > 1 &&\n            this.readyState === "opening") {\n            this.transports.shift();\n            return this._open();\n        }\n        this.emitReserved("error", err);\n        this._onClose("transport error", err);\n    }\n    /**\n     * Called upon transport close.\n     *\n     * @private\n     */\n    _onClose(reason, description) {\n        if ("opening" === this.readyState ||\n            "open" === this.readyState ||\n            "closing" === this.readyState) {\n            // clear timers\n            this.clearTimeoutFn(this._pingTimeoutTimer);\n            // stop event from firing again for transport\n            this.transport.removeAllListeners("close");\n            // ensure transport won\'t stay open\n            this.transport.close();\n            // ignore further transport communication\n            this.transport.removeAllListeners();\n            if (withEventListeners) {\n                if (this._beforeunloadEventListener) {\n                    removeEventListener("beforeunload", this._beforeunloadEventListener, false);\n                }\n                if (this._offlineEventListener) {\n                    const i = OFFLINE_EVENT_LISTENERS.indexOf(this._offlineEventListener);\n                    if (i !== -1) {\n                        OFFLINE_EVENT_LISTENERS.splice(i, 1);\n                    }\n                }\n            }\n            // set ready state\n            this.readyState = "closed";\n            // clear session id\n            this.id = null;\n            // emit close event\n            this.emitReserved("close", reason, description);\n            // clean buffers after, so users can still\n            // grab the buffers on `close` event\n            this.writeBuffer = [];\n            this._prevBufferLen = 0;\n        }\n    }\n}\nSocketWithoutUpgrade.protocol = engine_io_parser__WEBPACK_IMPORTED_MODULE_5__.protocol;\n/**\n * This class provides a WebSocket-like interface to connect to an Engine.IO server. The connection will be established\n * with one of the available low-level transports, like HTTP long-polling, WebSocket or WebTransport.\n *\n * This class comes with an upgrade mechanism, which means that once the connection is established with the first\n * low-level transport, it will try to upgrade to a better transport.\n *\n * In order to allow tree-shaking, there are no transports included, that\'s why the `transports` option is mandatory.\n *\n * @example\n * import { SocketWithUpgrade, WebSocket } from "engine.io-client";\n *\n * const socket = new SocketWithUpgrade({\n *   transports: [WebSocket]\n * });\n *\n * socket.on("open", () => {\n *   socket.send("hello");\n * });\n *\n * @see SocketWithoutUpgrade\n * @see Socket\n */\nclass SocketWithUpgrade extends SocketWithoutUpgrade {\n    constructor() {\n        super(...arguments);\n        this._upgrades = [];\n    }\n    onOpen() {\n        super.onOpen();\n        if ("open" === this.readyState && this.opts.upgrade) {\n            for (let i = 0; i < this._upgrades.length; i++) {\n                this._probe(this._upgrades[i]);\n            }\n        }\n    }\n    /**\n     * Probes a transport.\n     *\n     * @param {String} name - transport name\n     * @private\n     */\n    _probe(name) {\n        let transport = this.createTransport(name);\n        let failed = false;\n        SocketWithoutUpgrade.priorWebsocketSuccess = false;\n        const onTransportOpen = () => {\n            if (failed)\n                return;\n            transport.send([{ type: "ping", data: "probe" }]);\n            transport.once("packet", (msg) => {\n                if (failed)\n                    return;\n                if ("pong" === msg.type && "probe" === msg.data) {\n                    this.upgrading = true;\n                    this.emitReserved("upgrading", transport);\n                    if (!transport)\n                        return;\n                    SocketWithoutUpgrade.priorWebsocketSuccess =\n                        "websocket" === transport.name;\n                    this.transport.pause(() => {\n                        if (failed)\n                            return;\n                        if ("closed" === this.readyState)\n                            return;\n                        cleanup();\n                        this.setTransport(transport);\n                        transport.send([{ type: "upgrade" }]);\n                        this.emitReserved("upgrade", transport);\n                        transport = null;\n                        this.upgrading = false;\n                        this.flush();\n                    });\n                }\n                else {\n                    const err = new Error("probe error");\n                    // @ts-ignore\n                    err.transport = transport.name;\n                    this.emitReserved("upgradeError", err);\n                }\n            });\n        };\n        function freezeTransport() {\n            if (failed)\n                return;\n            // Any callback called by transport should be ignored since now\n            failed = true;\n            cleanup();\n            transport.close();\n            transport = null;\n        }\n        // Handle any error that happens while probing\n        const onerror = (err) => {\n            const error = new Error("probe error: " + err);\n            // @ts-ignore\n            error.transport = transport.name;\n            freezeTransport();\n            this.emitReserved("upgradeError", error);\n        };\n        function onTransportClose() {\n            onerror("transport closed");\n        }\n        // When the socket is closed while we\'re probing\n        function onclose() {\n            onerror("socket closed");\n        }\n        // When the socket is upgraded while we\'re probing\n        function onupgrade(to) {\n            if (transport && to.name !== transport.name) {\n                freezeTransport();\n            }\n        }\n        // Remove all listeners on the transport and on self\n        const cleanup = () => {\n            transport.removeListener("open", onTransportOpen);\n            transport.removeListener("error", onerror);\n            transport.removeListener("close", onTransportClose);\n            this.off("close", onclose);\n            this.off("upgrading", onupgrade);\n        };\n        transport.once("open", onTransportOpen);\n        transport.once("error", onerror);\n        transport.once("close", onTransportClose);\n        this.once("close", onclose);\n        this.once("upgrading", onupgrade);\n        if (this._upgrades.indexOf("webtransport") !== -1 &&\n            name !== "webtransport") {\n            // favor WebTransport\n            this.setTimeoutFn(() => {\n                if (!failed) {\n                    transport.open();\n                }\n            }, 200);\n        }\n        else {\n            transport.open();\n        }\n    }\n    onHandshake(data) {\n        this._upgrades = this._filterUpgrades(data.upgrades);\n        super.onHandshake(data);\n    }\n    /**\n     * Filters upgrades, returning only those matching client transports.\n     *\n     * @param {Array} upgrades - server upgrades\n     * @private\n     */\n    _filterUpgrades(upgrades) {\n        const filteredUpgrades = [];\n        for (let i = 0; i < upgrades.length; i++) {\n            if (~this.transports.indexOf(upgrades[i]))\n                filteredUpgrades.push(upgrades[i]);\n        }\n        return filteredUpgrades;\n    }\n}\n/**\n * This class provides a WebSocket-like interface to connect to an Engine.IO server. The connection will be established\n * with one of the available low-level transports, like HTTP long-polling, WebSocket or WebTransport.\n *\n * This class comes with an upgrade mechanism, which means that once the connection is established with the first\n * low-level transport, it will try to upgrade to a better transport.\n *\n * @example\n * import { Socket } from "engine.io-client";\n *\n * const socket = new Socket();\n *\n * socket.on("open", () => {\n *   socket.send("hello");\n * });\n *\n * @see SocketWithoutUpgrade\n * @see SocketWithUpgrade\n */\nclass Socket extends SocketWithUpgrade {\n    constructor(uri, opts = {}) {\n        const o = typeof uri === "object" ? uri : opts;\n        if (!o.transports ||\n            (o.transports && typeof o.transports[0] === "string")) {\n            o.transports = (o.transports || ["polling", "websocket", "webtransport"])\n                .map((transportName) => _transports_index_js__WEBPACK_IMPORTED_MODULE_0__.transports[transportName])\n                .filter((t) => !!t);\n        }\n        super(uri, o);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vc29ja2V0LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBeUU7QUFDWDtBQUNoQjtBQUNBO0FBQ1M7QUFDWDtBQUNzQztBQUNsRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLGtDQUFrQztBQUM5QztBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ08sbUNBQW1DLGlFQUFPO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBLGVBQWUsZUFBZTtBQUM5QixlQUFlLFFBQVE7QUFDdkI7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLCtEQUFpQjtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEMseUJBQXlCO0FBQ3JFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsMkRBQUs7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QiwyREFBSztBQUNqQztBQUNBLFFBQVEsK0RBQXFCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLGdDQUFnQztBQUNoQztBQUNBLFNBQVM7QUFDVDtBQUNBO0FB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bW9kdWxlcy8ucG5wbS9lbmdpbmUuaW8tY2xpZW50QDYuNi4zL25vZGVfbW9kdWxlcy9lbmdpbmUuaW8tY2xpZW50L2J1aWxkL2VzbS9zb2NrZXQuanM/YTBkMCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB0cmFuc3BvcnRzIGFzIERFRkFVTFRfVFJBTlNQT1JUUyB9IGZyb20gXCIuL3RyYW5zcG9ydHMvaW5kZXguanNcIjtcbmltcG9ydCB7IGluc3RhbGxUaW1lckZ1bmN0aW9ucywgYnl0ZUxlbmd0aCB9IGZyb20gXCIuL3V0aWwuanNcIjtcbmltcG9ydCB7IGRlY29kZSB9IGZyb20gXCIuL2NvbnRyaWIvcGFyc2Vxcy5qc1wiO1xuaW1wb3J0IHsgcGFyc2UgfSBmcm9tIFwiLi9jb250cmliL3BhcnNldXJpLmpzXCI7XG5pbXBvcnQgeyBFbWl0dGVyIH0gZnJvbSBcIkBzb2NrZXQuaW8vY29tcG9uZW50LWVtaXR0ZXJcIjtcbmltcG9ydCB7IHByb3RvY29sIH0gZnJvbSBcImVuZ2luZS5pby1wYXJzZXJcIjtcbmltcG9ydCB7IGNyZWF0ZUNvb2tpZUphciwgZGVmYXVsdEJpbmFyeVR5cGUsIG5leHRUaWNrLCB9IGZyb20gXCIuL2dsb2JhbHMubm9kZS5qc1wiO1xuY29uc3Qgd2l0aEV2ZW50TGlzdGVuZXJzID0gdHlwZW9mIGFkZEV2ZW50TGlzdGVuZXIgPT09IFwiZnVuY3Rpb25cIiAmJlxuICAgIHR5cGVvZiByZW1vdmVFdmVudExpc3RlbmVyID09PSBcImZ1bmN0aW9uXCI7XG5jb25zdCBPRkZMSU5FX0VWRU5UX0xJU1RFTkVSUyA9IFtdO1xuaWYgKHdpdGhFdmVudExpc3RlbmVycykge1xuICAgIC8vIHdpdGhpbiBhIFNlcnZpY2VXb3JrZXIsIGFueSBldmVudCBoYW5kbGVyIGZvciB0aGUgJ29mZmxpbmUnIGV2ZW50IG11c3QgYmUgYWRkZWQgb24gdGhlIGluaXRpYWwgZXZhbHVhdGlvbiBvZiB0aGVcbiAgICAvLyBzY3JpcHQsIHNvIHdlIGNyZWF0ZSBvbmUgc2luZ2xlIGV2ZW50IGxpc3RlbmVyIGhlcmUgd2hpY2ggd2lsbCBmb3J3YXJkIHRoZSBldmVudCB0byB0aGUgc29ja2V0IGluc3RhbmNlc1xuICAgIGFkZEV2ZW50TGlzdGVuZXIoXCJvZmZsaW5lXCIsICgpID0+IHtcbiAgICAgICAgT0ZGTElORV9FVkVOVF9MSVNURU5FUlMuZm9yRWFjaCgobGlzdGVuZXIpID0+IGxpc3RlbmVyKCkpO1xuICAgIH0sIGZhbHNlKTtcbn1cbi8qKlxuICogVGhpcyBjbGFzcyBwcm92aWRlcyBhIFdlYlNvY2tldC1saWtlIGludGVyZmFjZSB0byBjb25uZWN0IHRvIGFuIEVuZ2luZS5JTyBzZXJ2ZXIuIFRoZSBjb25uZWN0aW9uIHdpbGwgYmUgZXN0YWJsaXNoZWRcbiAqIHdpdGggb25lIG9mIHRoZSBhdmFpbGFibGUgbG93LWxldmVsIHRyYW5zcG9ydHMsIGxpa2UgSFRUUCBsb25nLXBvbGxpbmcsIFdlYlNvY2tldCBvciBXZWJUcmFuc3BvcnQuXG4gKlxuICogVGhpcyBjbGFzcyBjb21lcyB3aXRob3V0IHVwZ3JhZGUgbWVjaGFuaXNtLCB3aGljaCBtZWFucyB0aGF0IGl0IHdpbGwga2VlcCB0aGUgZmlyc3QgbG93LWxldmVsIHRyYW5zcG9ydCB0aGF0XG4gKiBzdWNjZXNzZnVsbHkgZXN0YWJsaXNoZXMgdGhlIGNvbm5lY3Rpb24uXG4gKlxuICogSW4gb3JkZXIgdG8gYWxsb3cgdHJlZS1zaGFraW5nLCB0aGVyZSBhcmUgbm8gdHJhbnNwb3J0cyBpbmNsdWRlZCwgdGhhdCdzIHdoeSB0aGUgYHRyYW5zcG9ydHNgIG9wdGlvbiBpcyBtYW5kYXRvcnkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IFNvY2tldFdpdGhvdXRVcGdyYWRlLCBXZWJTb2NrZXQgfSBmcm9tIFwiZW5naW5lLmlvLWNsaWVudFwiO1xuICpcbiAqIGNvbnN0IHNvY2tldCA9IG5ldyBTb2NrZXRXaXRob3V0VXBncmFkZSh7XG4gKiAgIHRyYW5zcG9ydHM6IFtXZWJTb2NrZXRdXG4gKiB9KTtcbiAqXG4gKiBzb2NrZXQub24oXCJvcGVuXCIsICgpID0+IHtcbiAqICAgc29ja2V0LnNlbmQoXCJoZWxsb1wiKTtcbiAqIH0pO1xuICpcbiAqIEBzZWUgU29ja2V0V2l0aFVwZ3JhZGVcbiAqIEBzZWUgU29ja2V0XG4gKi9cbmV4cG9ydCBjbGFzcyBTb2NrZXRXaXRob3V0VXBncmFkZSBleHRlbmRzIEVtaXR0ZXIge1xuICAgIC8qKlxuICAgICAqIFNvY2tldCBjb25zdHJ1Y3Rvci5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfE9iamVjdH0gdXJpIC0gdXJpIG9yIG9wdGlvbnNcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb3B0cyAtIG9wdGlvbnNcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih1cmksIG9wdHMpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5iaW5hcnlUeXBlID0gZGVmYXVsdEJpbmFyeVR5cGU7XG4gICAgICAgIHRoaXMud3JpdGVCdWZmZXIgPSBbXTtcbiAgICAgICAgdGhpcy5fcHJldkJ1ZmZlckxlbiA9IDA7XG4gICAgICAgIHRoaXMuX3BpbmdJbnRlcnZhbCA9IC0xO1xuICAgICAgICB0aGlzLl9waW5nVGltZW91dCA9IC0xO1xuICAgICAgICB0aGlzLl9tYXhQYXlsb2FkID0gLTE7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgZXhwaXJhdGlvbiB0aW1lc3RhbXAgb2YgdGhlIHtAbGluayBfcGluZ1RpbWVvdXRUaW1lcn0gb2JqZWN0IGlzIHRyYWNrZWQsIGluIGNhc2UgdGhlIHRpbWVyIGlzIHRocm90dGxlZCBhbmQgdGhlXG4gICAgICAgICAqIGNhbGxiYWNrIGlzIG5vdCBmaXJlZCBvbiB0aW1lLiBUaGlzIGNhbiBoYXBwZW4gZm9yIGV4YW1wbGUgd2hlbiBhIGxhcHRvcCBpcyBzdXNwZW5kZWQgb3Igd2hlbiBhIHBob25lIGlzIGxvY2tlZC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3BpbmdUaW1lb3V0VGltZSA9IEluZmluaXR5O1xuICAgICAgICBpZiAodXJpICYmIFwib2JqZWN0XCIgPT09IHR5cGVvZiB1cmkpIHtcbiAgICAgICAgICAgIG9wdHMgPSB1cmk7XG4gICAgICAgICAgICB1cmkgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmICh1cmkpIHtcbiAgICAgICAgICAgIGNvbnN0IHBhcnNlZFVyaSA9IHBhcnNlKHVyaSk7XG4gICAgICAgICAgICBvcHRzLmhvc3RuYW1lID0gcGFyc2VkVXJpLmhvc3Q7XG4gICAgICAgICAgICBvcHRzLnNlY3VyZSA9XG4gICAgICAgICAgICAgICAgcGFyc2VkVXJpLnByb3RvY29sID09PSBcImh0dHBzXCIgfHwgcGFyc2VkVXJpLnByb3RvY29sID09PSBcIndzc1wiO1xuICAgICAgICAgICAgb3B0cy5wb3J0ID0gcGFyc2VkVXJpLnBvcnQ7XG4gICAgICAgICAgICBpZiAocGFyc2VkVXJpLnF1ZXJ5KVxuICAgICAgICAgICAgICAgIG9wdHMucXVlcnkgPSBwYXJzZWRVcmkucXVlcnk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAob3B0cy5ob3N0KSB7XG4gICAgICAgICAgICBvcHRzLmhvc3RuYW1lID0gcGFyc2Uob3B0cy5ob3N0KS5ob3N0O1xuICAgICAgICB9XG4gICAgICAgIGluc3RhbGxUaW1lckZ1bmN0aW9ucyh0aGlzLCBvcHRzKTtcbiAgICAgICAgdGhpcy5zZWN1cmUgPVxuICAgICAgICAgICAgbnVsbCAhPSBvcHRzLnNlY3VyZVxuICAgICAgICAgICAgICAgID8gb3B0cy5zZWN1cmVcbiAgICAgICAgICAgICAgICA6IHR5cGVvZiBsb2NhdGlvbiAhPT0gXCJ1bmRlZmluZWRcIiAmJiBcImh0dHBzOlwiID09PSBsb2NhdGlvbi5wcm90b2NvbDtcbiAgICAgICAgaWYgKG9wdHMuaG9zdG5hbWUgJiYgIW9wdHMucG9ydCkge1xuICAgICAgICAgICAgLy8gaWYgbm8gcG9ydCBpcyBzcGVjaWZpZWQgbWFudWFsbHksIHVzZSB0aGUgcHJvdG9jb2wgZGVmYXVsdFxuICAgICAgICAgICAgb3B0cy5wb3J0ID0gdGhpcy5zZWN1cmUgPyBcIjQ0M1wiIDogXCI4MFwiO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaG9zdG5hbWUgPVxuICAgICAgICAgICAgb3B0cy5ob3N0bmFtZSB8fFxuICAgICAgICAgICAgICAgICh0eXBlb2YgbG9jYXRpb24gIT09IFwidW5kZWZpbmVkXCIgPyBsb2NhdGlvbi5ob3N0bmFtZSA6IFwibG9jYWxob3N0XCIpO1xuICAgICAgICB0aGlzLnBvcnQgPVxuICAgICAgICAgICAgb3B0cy5wb3J0IHx8XG4gICAgICAgICAgICAgICAgKHR5cGVvZiBsb2NhdGlvbiAhPT0gXCJ1bmRlZmluZWRcIiAmJiBsb2NhdGlvbi5wb3J0XG4gICAgICAgICAgICAgICAgICAgID8gbG9jYXRpb24ucG9ydFxuICAgICAgICAgICAgICAgICAgICA6IHRoaXMuc2VjdXJlXG4gICAgICAgICAgICAgICAgICAgICAgICA/IFwiNDQzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIDogXCI4MFwiKTtcbiAgICAgICAgdGhpcy50cmFuc3BvcnRzID0gW107XG4gICAgICAgIHRoaXMuX3RyYW5zcG9ydHNCeU5hbWUgPSB7fTtcbiAgICAgICAgb3B0cy50cmFuc3BvcnRzLmZvckVhY2goKHQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHRyYW5zcG9ydE5hbWUgPSB0LnByb3RvdHlwZS5uYW1lO1xuICAgICAgICAgICAgdGhpcy50cmFuc3BvcnRzLnB1c2godHJhbnNwb3J0TmFtZSk7XG4gICAgICAgICAgICB0aGlzLl90cmFuc3BvcnRzQnlOYW1lW3RyYW5zcG9ydE5hbWVdID0gdDtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMub3B0cyA9IE9iamVjdC5hc3NpZ24oe1xuICAgICAgICAgICAgcGF0aDogXCIvZW5naW5lLmlvXCIsXG4gICAgICAgICAgICBhZ2VudDogZmFsc2UsXG4gICAgICAgICAgICB3aXRoQ3JlZGVudGlhbHM6IGZhbHNlLFxuICAgICAgICAgICAgdXBncmFkZTogdHJ1ZSxcbiAgICAgICAgICAgIHRpbWVzdGFtcFBhcmFtOiBcInRcIixcbiAgICAgICAgICAgIHJlbWVtYmVyVXBncmFkZTogZmFsc2UsXG4gICAgICAgICAgICBhZGRUcmFpbGluZ1NsYXNoOiB0cnVlLFxuICAgICAgICAgICAgcmVqZWN0VW5hdXRob3JpemVkOiB0cnVlLFxuICAgICAgICAgICAgcGVyTWVzc2FnZURlZmxhdGU6IHtcbiAgICAgICAgICAgICAgICB0aHJlc2hvbGQ6IDEwMjQsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdHJhbnNwb3J0T3B0aW9uczoge30sXG4gICAgICAgICAgICBjbG9zZU9uQmVmb3JldW5sb2FkOiBmYWxzZSxcbiAgICAgICAgfSwgb3B0cyk7XG4gICAgICAgIHRoaXMub3B0cy5wYXRoID1cbiAgICAgICAgICAgIHRoaXMub3B0cy5wYXRoLnJlcGxhY2UoL1xcLyQvLCBcIlwiKSArXG4gICAgICAgICAgICAgICAgKHRoaXMub3B0cy5hZGRUcmFpbGluZ1NsYXNoID8gXCIvXCIgOiBcIlwiKTtcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLm9wdHMucXVlcnkgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHRoaXMub3B0cy5xdWVyeSA9IGRlY29kZSh0aGlzLm9wdHMucXVlcnkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh3aXRoRXZlbnRMaXN0ZW5lcnMpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLm9wdHMuY2xvc2VPbkJlZm9yZXVubG9hZCkge1xuICAgICAgICAgICAgICAgIC8vIEZpcmVmb3ggY2xvc2VzIHRoZSBjb25uZWN0aW9uIHdoZW4gdGhlIFwiYmVmb3JldW5sb2FkXCIgZXZlbnQgaXMgZW1pdHRlZCBidXQgbm90IENocm9tZS4gVGhpcyBldmVudCBsaXN0ZW5lclxuICAgICAgICAgICAgICAgIC8vIGVuc3VyZXMgZXZlcnkgYnJvd3NlciBiZWhhdmVzIHRoZSBzYW1lIChubyBcImRpc2Nvbm5lY3RcIiBldmVudCBhdCB0aGUgU29ja2V0LklPIGxldmVsIHdoZW4gdGhlIHBhZ2UgaXNcbiAgICAgICAgICAgICAgICAvLyBjbG9zZWQvcmVsb2FkZWQpXG4gICAgICAgICAgICAgICAgdGhpcy5fYmVmb3JldW5sb2FkRXZlbnRMaXN0ZW5lciA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMudHJhbnNwb3J0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzaWxlbnRseSBjbG9zZSB0aGUgdHJhbnNwb3J0XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRyYW5zcG9ydC5yZW1vdmVBbGxMaXN0ZW5lcnMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHJhbnNwb3J0LmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGFkZEV2ZW50TGlzdGVuZXIoXCJiZWZvcmV1bmxvYWRcIiwgdGhpcy5fYmVmb3JldW5sb2FkRXZlbnRMaXN0ZW5lciwgZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuaG9zdG5hbWUgIT09IFwibG9jYWxob3N0XCIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vZmZsaW5lRXZlbnRMaXN0ZW5lciA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fb25DbG9zZShcInRyYW5zcG9ydCBjbG9zZVwiLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJuZXR3b3JrIGNvbm5lY3Rpb24gbG9zdFwiLFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIE9GRkxJTkVfRVZFTlRfTElTVEVORVJTLnB1c2godGhpcy5fb2ZmbGluZUV2ZW50TGlzdGVuZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm9wdHMud2l0aENyZWRlbnRpYWxzKSB7XG4gICAgICAgICAgICB0aGlzLl9jb29raWVKYXIgPSBjcmVhdGVDb29raWVKYXIoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9vcGVuKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgdHJhbnNwb3J0IG9mIHRoZSBnaXZlbiB0eXBlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgLSB0cmFuc3BvcnQgbmFtZVxuICAgICAqIEByZXR1cm4ge1RyYW5zcG9ydH1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIGNyZWF0ZVRyYW5zcG9ydChuYW1lKSB7XG4gICAgICAgIGNvbnN0IHF1ZXJ5ID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5vcHRzLnF1ZXJ5KTtcbiAgICAgICAgLy8gYXBwZW5kIGVuZ2luZS5pbyBwcm90b2NvbCBpZGVudGlmaWVyXG4gICAgICAgIHF1ZXJ5LkVJTyA9IHByb3RvY29sO1xuICAgICAgICAvLyB0cmFuc3BvcnQgbmFtZVxuICAgICAgICBxdWVyeS50cmFuc3BvcnQgPSBuYW1lO1xuICAgICAgICAvLyBzZXNzaW9uIGlkIGlmIHdlIGFscmVhZHkgaGF2ZSBvbmVcbiAgICAgICAgaWYgKHRoaXMuaWQpXG4gICAgICAgICAgICBxdWVyeS5zaWQgPSB0aGlzLmlkO1xuICAgICAgICBjb25zdCBvcHRzID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5vcHRzLCB7XG4gICAgICAgICAgICBxdWVyeSxcbiAgICAgICAgICAgIHNvY2tldDogdGhpcyxcbiAgICAgICAgICAgIGhvc3RuYW1lOiB0aGlzLmhvc3RuYW1lLFxuICAgICAgICAgICAgc2VjdXJlOiB0aGlzLnNlY3VyZSxcbiAgICAgICAgICAgIHBvcnQ6IHRoaXMucG9ydCxcbiAgICAgICAgfSwgdGhpcy5vcHRzLnRyYW5zcG9ydE9wdGlvbnNbbmFtZV0pO1xuICAgICAgICByZXR1cm4gbmV3IHRoaXMuX3RyYW5zcG9ydHNCeU5hbWVbbmFtZV0ob3B0cyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEluaXRpYWxpemVzIHRyYW5zcG9ydCB0byB1c2UgYW5kIHN0YXJ0cyBwcm9iZS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX29wZW4oKSB7XG4gICAgICAgIGlmICh0aGlzLnRyYW5zcG9ydHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAvLyBFbWl0IGVycm9yIG9uIG5leHQgdGljayBzbyBpdCBjYW4gYmUgbGlzdGVuZWQgdG9cbiAgICAgICAgICAgIHRoaXMuc2V0VGltZW91dEZuKCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcImVycm9yXCIsIFwiTm8gdHJhbnNwb3J0cyBhdmFpbGFibGVcIik7XG4gICAgICAgICAgICB9LCAwKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB0cmFuc3BvcnROYW1lID0gdGhpcy5vcHRzLnJlbWVtYmVyVXBncmFkZSAmJlxuICAgICAgICAgICAgU29ja2V0V2l0aG91dFVwZ3JhZGUucHJpb3JXZWJzb2NrZXRTdWNjZXNzICYmXG4gICAgICAgICAgICB0aGlzLnRyYW5zcG9ydHMuaW5kZXhPZihcIndlYnNvY2tldFwiKSAhPT0gLTFcbiAgICAgICAgICAgID8gXCJ3ZWJzb2NrZXRcIlxuICAgICAgICAgICAgOiB0aGlzLnRyYW5zcG9ydHNbMF07XG4gICAgICAgIHRoaXMucmVhZHlTdGF0ZSA9IFwib3BlbmluZ1wiO1xuICAgICAgICBjb25zdCB0cmFuc3BvcnQgPSB0aGlzLmNyZWF0ZVRyYW5zcG9ydCh0cmFuc3BvcnROYW1lKTtcbiAgICAgICAgdHJhbnNwb3J0Lm9wZW4oKTtcbiAgICAgICAgdGhpcy5zZXRUcmFuc3BvcnQodHJhbnNwb3J0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgY3VycmVudCB0cmFuc3BvcnQuIERpc2FibGVzIHRoZSBleGlzdGluZyBvbmUgKGlmIGFueSkuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHNldFRyYW5zcG9ydCh0cmFuc3BvcnQpIHtcbiAgICAgICAgaWYgKHRoaXMudHJhbnNwb3J0KSB7XG4gICAgICAgICAgICB0aGlzLnRyYW5zcG9ydC5yZW1vdmVBbGxMaXN0ZW5lcnMoKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBzZXQgdXAgdHJhbnNwb3J0XG4gICAgICAgIHRoaXMudHJhbnNwb3J0ID0gdHJhbnNwb3J0O1xuICAgICAgICAvLyBzZXQgdXAgdHJhbnNwb3J0IGxpc3RlbmVyc1xuICAgICAgICB0cmFuc3BvcnRcbiAgICAgICAgICAgIC5vbihcImRyYWluXCIsIHRoaXMuX29uRHJhaW4uYmluZCh0aGlzKSlcbiAgICAgICAgICAgIC5vbihcInBhY2tldFwiLCB0aGlzLl9vblBhY2tldC5iaW5kKHRoaXMpKVxuICAgICAgICAgICAgLm9uKFwiZXJyb3JcIiwgdGhpcy5fb25FcnJvci5iaW5kKHRoaXMpKVxuICAgICAgICAgICAgLm9uKFwiY2xvc2VcIiwgKHJlYXNvbikgPT4gdGhpcy5fb25DbG9zZShcInRyYW5zcG9ydCBjbG9zZVwiLCByZWFzb24pKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHdoZW4gY29ubmVjdGlvbiBpcyBkZWVtZWQgb3Blbi5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgb25PcGVuKCkge1xuICAgICAgICB0aGlzLnJlYWR5U3RhdGUgPSBcIm9wZW5cIjtcbiAgICAgICAgU29ja2V0V2l0aG91dFVwZ3JhZGUucHJpb3JXZWJzb2NrZXRTdWNjZXNzID1cbiAgICAgICAgICAgIFwid2Vic29ja2V0XCIgPT09IHRoaXMudHJhbnNwb3J0Lm5hbWU7XG4gICAgICAgIHRoaXMuZW1pdFJlc2VydmVkKFwib3BlblwiKTtcbiAgICAgICAgdGhpcy5mbHVzaCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBIYW5kbGVzIGEgcGFja2V0LlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfb25QYWNrZXQocGFja2V0KSB7XG4gICAgICAgIGlmIChcIm9wZW5pbmdcIiA9PT0gdGhpcy5yZWFkeVN0YXRlIHx8XG4gICAgICAgICAgICBcIm9wZW5cIiA9PT0gdGhpcy5yZWFkeVN0YXRlIHx8XG4gICAgICAgICAgICBcImNsb3NpbmdcIiA9PT0gdGhpcy5yZWFkeVN0YXRlKSB7XG4gICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcInBhY2tldFwiLCBwYWNrZXQpO1xuICAgICAgICAgICAgLy8gU29ja2V0IGlzIGxpdmUgLSBhbnkgcGFja2V0IGNvdW50c1xuICAgICAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJoZWFydGJlYXRcIik7XG4gICAgICAgICAgICBzd2l0Y2ggKHBhY2tldC50eXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcIm9wZW5cIjpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkhhbmRzaGFrZShKU09OLnBhcnNlKHBhY2tldC5kYXRhKSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJwaW5nXCI6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3NlbmRQYWNrZXQoXCJwb25nXCIpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcInBpbmdcIik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdFJlc2VydmVkKFwicG9uZ1wiKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVzZXRQaW5nVGltZW91dCgpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwiZXJyb3JcIjpcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZXJyID0gbmV3IEVycm9yKFwic2VydmVyIGVycm9yXCIpO1xuICAgICAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICAgICAgICAgIGVyci5jb2RlID0gcGFja2V0LmRhdGE7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX29uRXJyb3IoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcIm1lc3NhZ2VcIjpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJkYXRhXCIsIHBhY2tldC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJtZXNzYWdlXCIsIHBhY2tldC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHVwb24gaGFuZHNoYWtlIGNvbXBsZXRpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YSAtIGhhbmRzaGFrZSBvYmpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIG9uSGFuZHNoYWtlKGRhdGEpIHtcbiAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJoYW5kc2hha2VcIiwgZGF0YSk7XG4gICAgICAgIHRoaXMuaWQgPSBkYXRhLnNpZDtcbiAgICAgICAgdGhpcy50cmFuc3BvcnQucXVlcnkuc2lkID0gZGF0YS5zaWQ7XG4gICAgICAgIHRoaXMuX3BpbmdJbnRlcnZhbCA9IGRhdGEucGluZ0ludGVydmFsO1xuICAgICAgICB0aGlzLl9waW5nVGltZW91dCA9IGRhdGEucGluZ1RpbWVvdXQ7XG4gICAgICAgIHRoaXMuX21heFBheWxvYWQgPSBkYXRhLm1heFBheWxvYWQ7XG4gICAgICAgIHRoaXMub25PcGVuKCk7XG4gICAgICAgIC8vIEluIGNhc2Ugb3BlbiBoYW5kbGVyIGNsb3NlcyBzb2NrZXRcbiAgICAgICAgaWYgKFwiY2xvc2VkXCIgPT09IHRoaXMucmVhZHlTdGF0ZSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdGhpcy5fcmVzZXRQaW5nVGltZW91dCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXRzIGFuZCByZXNldHMgcGluZyB0aW1lb3V0IHRpbWVyIGJhc2VkIG9uIHNlcnZlciBwaW5ncy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3Jlc2V0UGluZ1RpbWVvdXQoKSB7XG4gICAgICAgIHRoaXMuY2xlYXJUaW1lb3V0Rm4odGhpcy5fcGluZ1RpbWVvdXRUaW1lcik7XG4gICAgICAgIGNvbnN0IGRlbGF5ID0gdGhpcy5fcGluZ0ludGVydmFsICsgdGhpcy5fcGluZ1RpbWVvdXQ7XG4gICAgICAgIHRoaXMuX3BpbmdUaW1lb3V0VGltZSA9IERhdGUubm93KCkgKyBkZWxheTtcbiAgICAgICAgdGhpcy5fcGluZ1RpbWVvdXRUaW1lciA9IHRoaXMuc2V0VGltZW91dEZuKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX29uQ2xvc2UoXCJwaW5nIHRpbWVvdXRcIik7XG4gICAgICAgIH0sIGRlbGF5KTtcbiAgICAgICAgaWYgKHRoaXMub3B0cy5hdXRvVW5yZWYpIHtcbiAgICAgICAgICAgIHRoaXMuX3BpbmdUaW1lb3V0VGltZXIudW5yZWYoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgb24gYGRyYWluYCBldmVudFxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfb25EcmFpbigpIHtcbiAgICAgICAgdGhpcy53cml0ZUJ1ZmZlci5zcGxpY2UoMCwgdGhpcy5fcHJldkJ1ZmZlckxlbik7XG4gICAgICAgIC8vIHNldHRpbmcgcHJldkJ1ZmZlckxlbiA9IDAgaXMgdmVyeSBpbXBvcnRhbnRcbiAgICAgICAgLy8gZm9yIGV4YW1wbGUsIHdoZW4gdXBncmFkaW5nLCB1cGdyYWRlIHBhY2tldCBpcyBzZW50IG92ZXIsXG4gICAgICAgIC8vIGFuZCBhIG5vbnplcm8gcHJldkJ1ZmZlckxlbiBjb3VsZCBjYXVzZSBwcm9ibGVtcyBvbiBgZHJhaW5gXG4gICAgICAgIHRoaXMuX3ByZXZCdWZmZXJMZW4gPSAwO1xuICAgICAgICBpZiAoMCA9PT0gdGhpcy53cml0ZUJ1ZmZlci5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMuZW1pdFJlc2VydmVkKFwiZHJhaW5cIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmZsdXNoKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogRmx1c2ggd3JpdGUgYnVmZmVycy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgZmx1c2goKSB7XG4gICAgICAgIGlmIChcImNsb3NlZFwiICE9PSB0aGlzLnJlYWR5U3RhdGUgJiZcbiAgICAgICAgICAgIHRoaXMudHJhbnNwb3J0LndyaXRhYmxlICYmXG4gICAgICAgICAgICAhdGhpcy51cGdyYWRpbmcgJiZcbiAgICAgICAgICAgIHRoaXMud3JpdGVCdWZmZXIubGVuZ3RoKSB7XG4gICAgICAgICAgICBjb25zdCBwYWNrZXRzID0gdGhpcy5fZ2V0V3JpdGFibGVQYWNrZXRzKCk7XG4gICAgICAgICAgICB0aGlzLnRyYW5zcG9ydC5zZW5kKHBhY2tldHMpO1xuICAgICAgICAgICAgLy8ga2VlcCB0cmFjayBvZiBjdXJyZW50IGxlbmd0aCBvZiB3cml0ZUJ1ZmZlclxuICAgICAgICAgICAgLy8gc3BsaWNlIHdyaXRlQnVmZmVyIGFuZCBjYWxsYmFja0J1ZmZlciBvbiBgZHJhaW5gXG4gICAgICAgICAgICB0aGlzLl9wcmV2QnVmZmVyTGVuID0gcGFja2V0cy5sZW5ndGg7XG4gICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcImZsdXNoXCIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEVuc3VyZSB0aGUgZW5jb2RlZCBzaXplIG9mIHRoZSB3cml0ZUJ1ZmZlciBpcyBiZWxvdyB0aGUgbWF4UGF5bG9hZCB2YWx1ZSBzZW50IGJ5IHRoZSBzZXJ2ZXIgKG9ubHkgZm9yIEhUVFBcbiAgICAgKiBsb25nLXBvbGxpbmcpXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9nZXRXcml0YWJsZVBhY2tldHMoKSB7XG4gICAgICAgIGNvbnN0IHNob3VsZENoZWNrUGF5bG9hZFNpemUgPSB0aGlzLl9tYXhQYXlsb2FkICYmXG4gICAgICAgICAgICB0aGlzLnRyYW5zcG9ydC5uYW1lID09PSBcInBvbGxpbmdcIiAmJlxuICAgICAgICAgICAgdGhpcy53cml0ZUJ1ZmZlci5sZW5ndGggPiAxO1xuICAgICAgICBpZiAoIXNob3VsZENoZWNrUGF5bG9hZFNpemUpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLndyaXRlQnVmZmVyO1xuICAgICAgICB9XG4gICAgICAgIGxldCBwYXlsb2FkU2l6ZSA9IDE7IC8vIGZpcnN0IHBhY2tldCB0eXBlXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy53cml0ZUJ1ZmZlci5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMud3JpdGVCdWZmZXJbaV0uZGF0YTtcbiAgICAgICAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgcGF5bG9hZFNpemUgKz0gYnl0ZUxlbmd0aChkYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpID4gMCAmJiBwYXlsb2FkU2l6ZSA+IHRoaXMuX21heFBheWxvYWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy53cml0ZUJ1ZmZlci5zbGljZSgwLCBpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHBheWxvYWRTaXplICs9IDI7IC8vIHNlcGFyYXRvciArIHBhY2tldCB0eXBlXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMud3JpdGVCdWZmZXI7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENoZWNrcyB3aGV0aGVyIHRoZSBoZWFydGJlYXQgdGltZXIgaGFzIGV4cGlyZWQgYnV0IHRoZSBzb2NrZXQgaGFzIG5vdCB5ZXQgYmVlbiBub3RpZmllZC5cbiAgICAgKlxuICAgICAqIE5vdGU6IHRoaXMgbWV0aG9kIGlzIHByaXZhdGUgZm9yIG5vdyBiZWNhdXNlIGl0IGRvZXMgbm90IHJlYWxseSBmaXQgdGhlIFdlYlNvY2tldCBBUEksIGJ1dCBpZiB3ZSBwdXQgaXQgaW4gdGhlXG4gICAgICogYHdyaXRlKClgIG1ldGhvZCB0aGVuIHRoZSBtZXNzYWdlIHdvdWxkIG5vdCBiZSBidWZmZXJlZCBieSB0aGUgU29ja2V0LklPIGNsaWVudC5cbiAgICAgKlxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICAvKiBwcml2YXRlICovIF9oYXNQaW5nRXhwaXJlZCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9waW5nVGltZW91dFRpbWUpXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgY29uc3QgaGFzRXhwaXJlZCA9IERhdGUubm93KCkgPiB0aGlzLl9waW5nVGltZW91dFRpbWU7XG4gICAgICAgIGlmIChoYXNFeHBpcmVkKSB7XG4gICAgICAgICAgICB0aGlzLl9waW5nVGltZW91dFRpbWUgPSAwO1xuICAgICAgICAgICAgbmV4dFRpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uQ2xvc2UoXCJwaW5nIHRpbWVvdXRcIik7XG4gICAgICAgICAgICB9LCB0aGlzLnNldFRpbWVvdXRGbik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGhhc0V4cGlyZWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlbmRzIGEgbWVzc2FnZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBtc2cgLSBtZXNzYWdlLlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIC0gY2FsbGJhY2sgZnVuY3Rpb24uXG4gICAgICogQHJldHVybiB7U29ja2V0fSBmb3IgY2hhaW5pbmcuXG4gICAgICovXG4gICAgd3JpdGUobXNnLCBvcHRpb25zLCBmbikge1xuICAgICAgICB0aGlzLl9zZW5kUGFja2V0KFwibWVzc2FnZVwiLCBtc2csIG9wdGlvbnMsIGZuKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlbmRzIGEgbWVzc2FnZS4gQWxpYXMgb2Yge0BsaW5rIFNvY2tldCN3cml0ZX0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gbXNnIC0gbWVzc2FnZS5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucy5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiAtIGNhbGxiYWNrIGZ1bmN0aW9uLlxuICAgICAqIEByZXR1cm4ge1NvY2tldH0gZm9yIGNoYWluaW5nLlxuICAgICAqL1xuICAgIHNlbmQobXNnLCBvcHRpb25zLCBmbikge1xuICAgICAgICB0aGlzLl9zZW5kUGFja2V0KFwibWVzc2FnZVwiLCBtc2csIG9wdGlvbnMsIGZuKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlbmRzIGEgcGFja2V0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHR5cGU6IHBhY2tldCB0eXBlLlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBkYXRhLlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIC0gY2FsbGJhY2sgZnVuY3Rpb24uXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfc2VuZFBhY2tldCh0eXBlLCBkYXRhLCBvcHRpb25zLCBmbikge1xuICAgICAgICBpZiAoXCJmdW5jdGlvblwiID09PSB0eXBlb2YgZGF0YSkge1xuICAgICAgICAgICAgZm4gPSBkYXRhO1xuICAgICAgICAgICAgZGF0YSA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoXCJmdW5jdGlvblwiID09PSB0eXBlb2Ygb3B0aW9ucykge1xuICAgICAgICAgICAgZm4gPSBvcHRpb25zO1xuICAgICAgICAgICAgb3B0aW9ucyA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFwiY2xvc2luZ1wiID09PSB0aGlzLnJlYWR5U3RhdGUgfHwgXCJjbG9zZWRcIiA9PT0gdGhpcy5yZWFkeVN0YXRlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gICAgICAgIG9wdGlvbnMuY29tcHJlc3MgPSBmYWxzZSAhPT0gb3B0aW9ucy5jb21wcmVzcztcbiAgICAgICAgY29uc3QgcGFja2V0ID0ge1xuICAgICAgICAgICAgdHlwZTogdHlwZSxcbiAgICAgICAgICAgIGRhdGE6IGRhdGEsXG4gICAgICAgICAgICBvcHRpb25zOiBvcHRpb25zLFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcInBhY2tldENyZWF0ZVwiLCBwYWNrZXQpO1xuICAgICAgICB0aGlzLndyaXRlQnVmZmVyLnB1c2gocGFja2V0KTtcbiAgICAgICAgaWYgKGZuKVxuICAgICAgICAgICAgdGhpcy5vbmNlKFwiZmx1c2hcIiwgZm4pO1xuICAgICAgICB0aGlzLmZsdXNoKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENsb3NlcyB0aGUgY29ubmVjdGlvbi5cbiAgICAgKi9cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgY29uc3QgY2xvc2UgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9vbkNsb3NlKFwiZm9yY2VkIGNsb3NlXCIpO1xuICAgICAgICAgICAgdGhpcy50cmFuc3BvcnQuY2xvc2UoKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgY2xlYW51cEFuZENsb3NlID0gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5vZmYoXCJ1cGdyYWRlXCIsIGNsZWFudXBBbmRDbG9zZSk7XG4gICAgICAgICAgICB0aGlzLm9mZihcInVwZ3JhZGVFcnJvclwiLCBjbGVhbnVwQW5kQ2xvc2UpO1xuICAgICAgICAgICAgY2xvc2UoKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3Qgd2FpdEZvclVwZ3JhZGUgPSAoKSA9PiB7XG4gICAgICAgICAgICAvLyB3YWl0IGZvciB1cGdyYWRlIHRvIGZpbmlzaCBzaW5jZSB3ZSBjYW4ndCBzZW5kIHBhY2tldHMgd2hpbGUgcGF1c2luZyBhIHRyYW5zcG9ydFxuICAgICAgICAgICAgdGhpcy5vbmNlKFwidXBncmFkZVwiLCBjbGVhbnVwQW5kQ2xvc2UpO1xuICAgICAgICAgICAgdGhpcy5vbmNlKFwidXBncmFkZUVycm9yXCIsIGNsZWFudXBBbmRDbG9zZSk7XG4gICAgICAgIH07XG4gICAgICAgIGlmIChcIm9wZW5pbmdcIiA9PT0gdGhpcy5yZWFkeVN0YXRlIHx8IFwib3BlblwiID09PSB0aGlzLnJlYWR5U3RhdGUpIHtcbiAgICAgICAgICAgIHRoaXMucmVhZHlTdGF0ZSA9IFwiY2xvc2luZ1wiO1xuICAgICAgICAgICAgaWYgKHRoaXMud3JpdGVCdWZmZXIubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbmNlKFwiZHJhaW5cIiwgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy51cGdyYWRpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdhaXRGb3JVcGdyYWRlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLnVwZ3JhZGluZykge1xuICAgICAgICAgICAgICAgIHdhaXRGb3JVcGdyYWRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjbG9zZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgdXBvbiB0cmFuc3BvcnQgZXJyb3JcbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX29uRXJyb3IoZXJyKSB7XG4gICAgICAgIFNvY2tldFdpdGhvdXRVcGdyYWRlLnByaW9yV2Vic29ja2V0U3VjY2VzcyA9IGZhbHNlO1xuICAgICAgICBpZiAodGhpcy5vcHRzLnRyeUFsbFRyYW5zcG9ydHMgJiZcbiAgICAgICAgICAgIHRoaXMudHJhbnNwb3J0cy5sZW5ndGggPiAxICYmXG4gICAgICAgICAgICB0aGlzLnJlYWR5U3RhdGUgPT09IFwib3BlbmluZ1wiKSB7XG4gICAgICAgICAgICB0aGlzLnRyYW5zcG9ydHMuc2hpZnQoKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vcGVuKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJlcnJvclwiLCBlcnIpO1xuICAgICAgICB0aGlzLl9vbkNsb3NlKFwidHJhbnNwb3J0IGVycm9yXCIsIGVycik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxlZCB1cG9uIHRyYW5zcG9ydCBjbG9zZS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX29uQ2xvc2UocmVhc29uLCBkZXNjcmlwdGlvbikge1xuICAgICAgICBpZiAoXCJvcGVuaW5nXCIgPT09IHRoaXMucmVhZHlTdGF0ZSB8fFxuICAgICAgICAgICAgXCJvcGVuXCIgPT09IHRoaXMucmVhZHlTdGF0ZSB8fFxuICAgICAgICAgICAgXCJjbG9zaW5nXCIgPT09IHRoaXMucmVhZHlTdGF0ZSkge1xuICAgICAgICAgICAgLy8gY2xlYXIgdGltZXJzXG4gICAgICAgICAgICB0aGlzLmNsZWFyVGltZW91dEZuKHRoaXMuX3BpbmdUaW1lb3V0VGltZXIpO1xuICAgICAgICAgICAgLy8gc3RvcCBldmVudCBmcm9tIGZpcmluZyBhZ2FpbiBmb3IgdHJhbnNwb3J0XG4gICAgICAgICAgICB0aGlzLnRyYW5zcG9ydC5yZW1vdmVBbGxMaXN0ZW5lcnMoXCJjbG9zZVwiKTtcbiAgICAgICAgICAgIC8vIGVuc3VyZSB0cmFuc3BvcnQgd29uJ3Qgc3RheSBvcGVuXG4gICAgICAgICAgICB0aGlzLnRyYW5zcG9ydC5jbG9zZSgpO1xuICAgICAgICAgICAgLy8gaWdub3JlIGZ1cnRoZXIgdHJhbnNwb3J0IGNvbW11bmljYXRpb25cbiAgICAgICAgICAgIHRoaXMudHJhbnNwb3J0LnJlbW92ZUFsbExpc3RlbmVycygpO1xuICAgICAgICAgICAgaWYgKHdpdGhFdmVudExpc3RlbmVycykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9iZWZvcmV1bmxvYWRFdmVudExpc3RlbmVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZUV2ZW50TGlzdGVuZXIoXCJiZWZvcmV1bmxvYWRcIiwgdGhpcy5fYmVmb3JldW5sb2FkRXZlbnRMaXN0ZW5lciwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fb2ZmbGluZUV2ZW50TGlzdGVuZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IE9GRkxJTkVfRVZFTlRfTElTVEVORVJTLmluZGV4T2YodGhpcy5fb2ZmbGluZUV2ZW50TGlzdGVuZXIpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIE9GRkxJTkVfRVZFTlRfTElTVEVORVJTLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIHNldCByZWFkeSBzdGF0ZVxuICAgICAgICAgICAgdGhpcy5yZWFkeVN0YXRlID0gXCJjbG9zZWRcIjtcbiAgICAgICAgICAgIC8vIGNsZWFyIHNlc3Npb24gaWRcbiAgICAgICAgICAgIHRoaXMuaWQgPSBudWxsO1xuICAgICAgICAgICAgLy8gZW1pdCBjbG9zZSBldmVudFxuICAgICAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJjbG9zZVwiLCByZWFzb24sIGRlc2NyaXB0aW9uKTtcbiAgICAgICAgICAgIC8vIGNsZWFuIGJ1ZmZlcnMgYWZ0ZXIsIHNvIHVzZXJzIGNhbiBzdGlsbFxuICAgICAgICAgICAgLy8gZ3JhYiB0aGUgYnVmZmVycyBvbiBgY2xvc2VgIGV2ZW50XG4gICAgICAgICAgICB0aGlzLndyaXRlQnVmZmVyID0gW107XG4gICAgICAgICAgICB0aGlzLl9wcmV2QnVmZmVyTGVuID0gMDtcbiAgICAgICAgfVxuICAgIH1cbn1cblNvY2tldFdpdGhvdXRVcGdyYWRlLnByb3RvY29sID0gcHJvdG9jb2w7XG4vKipcbiAqIFRoaXMgY2xhc3MgcHJvdmlkZXMgYSBXZWJTb2NrZXQtbGlrZSBpbnRlcmZhY2UgdG8gY29ubmVjdCB0byBhbiBFbmdpbmUuSU8gc2VydmVyLiBUaGUgY29ubmVjdGlvbiB3aWxsIGJlIGVzdGFibGlzaGVkXG4gKiB3aXRoIG9uZSBvZiB0aGUgYXZhaWxhYmxlIGxvdy1sZXZlbCB0cmFuc3BvcnRzLCBsaWtlIEhUVFAgbG9uZy1wb2xsaW5nLCBXZWJTb2NrZXQgb3IgV2ViVHJhbnNwb3J0LlxuICpcbiAqIFRoaXMgY2xhc3MgY29tZXMgd2l0aCBhbiB1cGdyYWRlIG1lY2hhbmlzbSwgd2hpY2ggbWVhbnMgdGhhdCBvbmNlIHRoZSBjb25uZWN0aW9uIGlzIGVzdGFibGlzaGVkIHdpdGggdGhlIGZpcnN0XG4gKiBsb3ctbGV2ZWwgdHJhbnNwb3J0LCBpdCB3aWxsIHRyeSB0byB1cGdyYWRlIHRvIGEgYmV0dGVyIHRyYW5zcG9ydC5cbiAqXG4gKiBJbiBvcmRlciB0byBhbGxvdyB0cmVlLXNoYWtpbmcsIHRoZXJlIGFyZSBubyB0cmFuc3BvcnRzIGluY2x1ZGVkLCB0aGF0J3Mgd2h5IHRoZSBgdHJhbnNwb3J0c2Agb3B0aW9uIGlzIG1hbmRhdG9yeS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgU29ja2V0V2l0aFVwZ3JhZGUsIFdlYlNvY2tldCB9IGZyb20gXCJlbmdpbmUuaW8tY2xpZW50XCI7XG4gKlxuICogY29uc3Qgc29ja2V0ID0gbmV3IFNvY2tldFdpdGhVcGdyYWRlKHtcbiAqICAgdHJhbnNwb3J0czogW1dlYlNvY2tldF1cbiAqIH0pO1xuICpcbiAqIHNvY2tldC5vbihcIm9wZW5cIiwgKCkgPT4ge1xuICogICBzb2NrZXQuc2VuZChcImhlbGxvXCIpO1xuICogfSk7XG4gKlxuICogQHNlZSBTb2NrZXRXaXRob3V0VXBncmFkZVxuICogQHNlZSBTb2NrZXRcbiAqL1xuZXhwb3J0IGNsYXNzIFNvY2tldFdpdGhVcGdyYWRlIGV4dGVuZHMgU29ja2V0V2l0aG91dFVwZ3JhZGUge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlciguLi5hcmd1bWVudHMpO1xuICAgICAgICB0aGlzLl91cGdyYWRlcyA9IFtdO1xuICAgIH1cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIHN1cGVyLm9uT3BlbigpO1xuICAgICAgICBpZiAoXCJvcGVuXCIgPT09IHRoaXMucmVhZHlTdGF0ZSAmJiB0aGlzLm9wdHMudXBncmFkZSkge1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLl91cGdyYWRlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHRoaXMuX3Byb2JlKHRoaXMuX3VwZ3JhZGVzW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBQcm9iZXMgYSB0cmFuc3BvcnQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZSAtIHRyYW5zcG9ydCBuYW1lXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfcHJvYmUobmFtZSkge1xuICAgICAgICBsZXQgdHJhbnNwb3J0ID0gdGhpcy5jcmVhdGVUcmFuc3BvcnQobmFtZSk7XG4gICAgICAgIGxldCBmYWlsZWQgPSBmYWxzZTtcbiAgICAgICAgU29ja2V0V2l0aG91dFVwZ3JhZGUucHJpb3JXZWJzb2NrZXRTdWNjZXNzID0gZmFsc2U7XG4gICAgICAgIGNvbnN0IG9uVHJhbnNwb3J0T3BlbiA9ICgpID0+IHtcbiAgICAgICAgICAgIGlmIChmYWlsZWQpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgdHJhbnNwb3J0LnNlbmQoW3sgdHlwZTogXCJwaW5nXCIsIGRhdGE6IFwicHJvYmVcIiB9XSk7XG4gICAgICAgICAgICB0cmFuc3BvcnQub25jZShcInBhY2tldFwiLCAobXNnKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGZhaWxlZClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIGlmIChcInBvbmdcIiA9PT0gbXNnLnR5cGUgJiYgXCJwcm9iZVwiID09PSBtc2cuZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZ3JhZGluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdFJlc2VydmVkKFwidXBncmFkaW5nXCIsIHRyYW5zcG9ydCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghdHJhbnNwb3J0KVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICBTb2NrZXRXaXRob3V0VXBncmFkZS5wcmlvcldlYnNvY2tldFN1Y2Nlc3MgPVxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ3ZWJzb2NrZXRcIiA9PT0gdHJhbnNwb3J0Lm5hbWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudHJhbnNwb3J0LnBhdXNlKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmYWlsZWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFwiY2xvc2VkXCIgPT09IHRoaXMucmVhZHlTdGF0ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICBjbGVhbnVwKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFRyYW5zcG9ydCh0cmFuc3BvcnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNwb3J0LnNlbmQoW3sgdHlwZTogXCJ1cGdyYWRlXCIgfV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJ1cGdyYWRlXCIsIHRyYW5zcG9ydCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc3BvcnQgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGdyYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmx1c2goKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlcnIgPSBuZXcgRXJyb3IoXCJwcm9iZSBlcnJvclwiKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICBlcnIudHJhbnNwb3J0ID0gdHJhbnNwb3J0Lm5hbWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdFJlc2VydmVkKFwidXBncmFkZUVycm9yXCIsIGVycik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIGZ1bmN0aW9uIGZyZWV6ZVRyYW5zcG9ydCgpIHtcbiAgICAgICAgICAgIGlmIChmYWlsZWQpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgLy8gQW55IGNhbGxiYWNrIGNhbGxlZCBieSB0cmFuc3BvcnQgc2hvdWxkIGJlIGlnbm9yZWQgc2luY2Ugbm93XG4gICAgICAgICAgICBmYWlsZWQgPSB0cnVlO1xuICAgICAgICAgICAgY2xlYW51cCgpO1xuICAgICAgICAgICAgdHJhbnNwb3J0LmNsb3NlKCk7XG4gICAgICAgICAgICB0cmFuc3BvcnQgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIC8vIEhhbmRsZSBhbnkgZXJyb3IgdGhhdCBoYXBwZW5zIHdoaWxlIHByb2JpbmdcbiAgICAgICAgY29uc3Qgb25lcnJvciA9IChlcnIpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKFwicHJvYmUgZXJyb3I6IFwiICsgZXJyKTtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIGVycm9yLnRyYW5zcG9ydCA9IHRyYW5zcG9ydC5uYW1lO1xuICAgICAgICAgICAgZnJlZXplVHJhbnNwb3J0KCk7XG4gICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcInVwZ3JhZGVFcnJvclwiLCBlcnJvcik7XG4gICAgICAgIH07XG4gICAgICAgIGZ1bmN0aW9uIG9uVHJhbnNwb3J0Q2xvc2UoKSB7XG4gICAgICAgICAgICBvbmVycm9yKFwidHJhbnNwb3J0IGNsb3NlZFwiKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBXaGVuIHRoZSBzb2NrZXQgaXMgY2xvc2VkIHdoaWxlIHdlJ3JlIHByb2JpbmdcbiAgICAgICAgZnVuY3Rpb24gb25jbG9zZSgpIHtcbiAgICAgICAgICAgIG9uZXJyb3IoXCJzb2NrZXQgY2xvc2VkXCIpO1xuICAgICAgICB9XG4gICAgICAgIC8vIFdoZW4gdGhlIHNvY2tldCBpcyB1cGdyYWRlZCB3aGlsZSB3ZSdyZSBwcm9iaW5nXG4gICAgICAgIGZ1bmN0aW9uIG9udXBncmFkZSh0bykge1xuICAgICAgICAgICAgaWYgKHRyYW5zcG9ydCAmJiB0by5uYW1lICE9PSB0cmFuc3BvcnQubmFtZSkge1xuICAgICAgICAgICAgICAgIGZyZWV6ZVRyYW5zcG9ydCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIFJlbW92ZSBhbGwgbGlzdGVuZXJzIG9uIHRoZSB0cmFuc3BvcnQgYW5kIG9uIHNlbGZcbiAgICAgICAgY29uc3QgY2xlYW51cCA9ICgpID0+IHtcbiAgICAgICAgICAgIHRyYW5zcG9ydC5yZW1vdmVMaXN0ZW5lcihcIm9wZW5cIiwgb25UcmFuc3BvcnRPcGVuKTtcbiAgICAgICAgICAgIHRyYW5zcG9ydC5yZW1vdmVMaXN0ZW5lcihcImVycm9yXCIsIG9uZXJyb3IpO1xuICAgICAgICAgICAgdHJhbnNwb3J0LnJlbW92ZUxpc3RlbmVyKFwiY2xvc2VcIiwgb25UcmFuc3BvcnRDbG9zZSk7XG4gICAgICAgICAgICB0aGlzLm9mZihcImNsb3NlXCIsIG9uY2xvc2UpO1xuICAgICAgICAgICAgdGhpcy5vZmYoXCJ1cGdyYWRpbmdcIiwgb251cGdyYWRlKTtcbiAgICAgICAgfTtcbiAgICAgICAgdHJhbnNwb3J0Lm9uY2UoXCJvcGVuXCIsIG9uVHJhbnNwb3J0T3Blbik7XG4gICAgICAgIHRyYW5zcG9ydC5vbmNlKFwiZXJyb3JcIiwgb25lcnJvcik7XG4gICAgICAgIHRyYW5zcG9ydC5vbmNlKFwiY2xvc2VcIiwgb25UcmFuc3BvcnRDbG9zZSk7XG4gICAgICAgIHRoaXMub25jZShcImNsb3NlXCIsIG9uY2xvc2UpO1xuICAgICAgICB0aGlzLm9uY2UoXCJ1cGdyYWRpbmdcIiwgb251cGdyYWRlKTtcbiAgICAgICAgaWYgKHRoaXMuX3VwZ3JhZGVzLmluZGV4T2YoXCJ3ZWJ0cmFuc3BvcnRcIikgIT09IC0xICYmXG4gICAgICAgICAgICBuYW1lICE9PSBcIndlYnRyYW5zcG9ydFwiKSB7XG4gICAgICAgICAgICAvLyBmYXZvciBXZWJUcmFuc3BvcnRcbiAgICAgICAgICAgIHRoaXMuc2V0VGltZW91dEZuKCgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIWZhaWxlZCkge1xuICAgICAgICAgICAgICAgICAgICB0cmFuc3BvcnQub3BlbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIDIwMCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0cmFuc3BvcnQub3BlbigpO1xuICAgICAgICB9XG4gICAgfVxuICAgIG9uSGFuZHNoYWtlKGRhdGEpIHtcbiAgICAgICAgdGhpcy5fdXBncmFkZXMgPSB0aGlzLl9maWx0ZXJVcGdyYWRlcyhkYXRhLnVwZ3JhZGVzKTtcbiAgICAgICAgc3VwZXIub25IYW5kc2hha2UoZGF0YSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZpbHRlcnMgdXBncmFkZXMsIHJldHVybmluZyBvbmx5IHRob3NlIG1hdGNoaW5nIGNsaWVudCB0cmFuc3BvcnRzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtBcnJheX0gdXBncmFkZXMgLSBzZXJ2ZXIgdXBncmFkZXNcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9maWx0ZXJVcGdyYWRlcyh1cGdyYWRlcykge1xuICAgICAgICBjb25zdCBmaWx0ZXJlZFVwZ3JhZGVzID0gW107XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdXBncmFkZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmICh+dGhpcy50cmFuc3BvcnRzLmluZGV4T2YodXBncmFkZXNbaV0pKVxuICAgICAgICAgICAgICAgIGZpbHRlcmVkVXBncmFkZXMucHVzaCh1cGdyYWRlc1tpXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZpbHRlcmVkVXBncmFkZXM7XG4gICAgfVxufVxuLyoqXG4gKiBUaGlzIGNsYXNzIHByb3ZpZGVzIGEgV2ViU29ja2V0LWxpa2UgaW50ZXJmYWNlIHRvIGNvbm5lY3QgdG8gYW4gRW5naW5lLklPIHNlcnZlci4gVGhlIGNvbm5lY3Rpb24gd2lsbCBiZSBlc3RhYmxpc2hlZFxuICogd2l0aCBvbmUgb2YgdGhlIGF2YWlsYWJsZSBsb3ctbGV2ZWwgdHJhbnNwb3J0cywgbGlrZSBIVFRQIGxvbmctcG9sbGluZywgV2ViU29ja2V0IG9yIFdlYlRyYW5zcG9ydC5cbiAqXG4gKiBUaGlzIGNsYXNzIGNvbWVzIHdpdGggYW4gdXBncmFkZSBtZWNoYW5pc20sIHdoaWNoIG1lYW5zIHRoYXQgb25jZSB0aGUgY29ubmVjdGlvbiBpcyBlc3RhYmxpc2hlZCB3aXRoIHRoZSBmaXJzdFxuICogbG93LWxldmVsIHRyYW5zcG9ydCwgaXQgd2lsbCB0cnkgdG8gdXBncmFkZSB0byBhIGJldHRlciB0cmFuc3BvcnQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IFNvY2tldCB9IGZyb20gXCJlbmdpbmUuaW8tY2xpZW50XCI7XG4gKlxuICogY29uc3Qgc29ja2V0ID0gbmV3IFNvY2tldCgpO1xuICpcbiAqIHNvY2tldC5vbihcIm9wZW5cIiwgKCkgPT4ge1xuICogICBzb2NrZXQuc2VuZChcImhlbGxvXCIpO1xuICogfSk7XG4gKlxuICogQHNlZSBTb2NrZXRXaXRob3V0VXBncmFkZVxuICogQHNlZSBTb2NrZXRXaXRoVXBncmFkZVxuICovXG5leHBvcnQgY2xhc3MgU29ja2V0IGV4dGVuZHMgU29ja2V0V2l0aFVwZ3JhZGUge1xuICAgIGNvbnN0cnVjdG9yKHVyaSwgb3B0cyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IG8gPSB0eXBlb2YgdXJpID09PSBcIm9iamVjdFwiID8gdXJpIDogb3B0cztcbiAgICAgICAgaWYgKCFvLnRyYW5zcG9ydHMgfHxcbiAgICAgICAgICAgIChvLnRyYW5zcG9ydHMgJiYgdHlwZW9mIG8udHJhbnNwb3J0c1swXSA9PT0gXCJzdHJpbmdcIikpIHtcbiAgICAgICAgICAgIG8udHJhbnNwb3J0cyA9IChvLnRyYW5zcG9ydHMgfHwgW1wicG9sbGluZ1wiLCBcIndlYnNvY2tldFwiLCBcIndlYnRyYW5zcG9ydFwiXSlcbiAgICAgICAgICAgICAgICAubWFwKCh0cmFuc3BvcnROYW1lKSA9PiBERUZBVUxUX1RSQU5TUE9SVFNbdHJhbnNwb3J0TmFtZV0pXG4gICAgICAgICAgICAgICAgLmZpbHRlcigodCkgPT4gISF0KTtcbiAgICAgICAgfVxuICAgICAgICBzdXBlcih1cmksIG8pO1xuICAgIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/socket.js\n')},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transport.js":
/*!********************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transport.js ***!
  \********************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Transport: () => (/* binding */ Transport),\n/* harmony export */   TransportError: () => (/* binding */ TransportError)\n/* harmony export */ });\n/* harmony import */ var engine_io_parser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! engine.io-parser */ "./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/index.js");\n/* harmony import */ var _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @socket.io/component-emitter */ "./node_modules/.pnpm/@socket.io+component-emitter@3.1.2/node_modules/@socket.io/component-emitter/lib/esm/index.js");\n/* harmony import */ var _util_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./util.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/util.js");\n/* harmony import */ var _contrib_parseqs_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./contrib/parseqs.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/parseqs.js");\n\n\n\n\nclass TransportError extends Error {\n    constructor(reason, description, context) {\n        super(reason);\n        this.description = description;\n        this.context = context;\n        this.type = "TransportError";\n    }\n}\nclass Transport extends _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_1__.Emitter {\n    /**\n     * Transport abstract constructor.\n     *\n     * @param {Object} opts - options\n     * @protected\n     */\n    constructor(opts) {\n        super();\n        this.writable = false;\n        (0,_util_js__WEBPACK_IMPORTED_MODULE_2__.installTimerFunctions)(this, opts);\n        this.opts = opts;\n        this.query = opts.query;\n        this.socket = opts.socket;\n        this.supportsBinary = !opts.forceBase64;\n    }\n    /**\n     * Emits an error.\n     *\n     * @param {String} reason\n     * @param description\n     * @param context - the error context\n     * @return {Transport} for chaining\n     * @protected\n     */\n    onError(reason, description, context) {\n        super.emitReserved("error", new TransportError(reason, description, context));\n        return this;\n    }\n    /**\n     * Opens the transport.\n     */\n    open() {\n        this.readyState = "opening";\n        this.doOpen();\n        return this;\n    }\n    /**\n     * Closes the transport.\n     */\n    close() {\n        if (this.readyState === "opening" || this.readyState === "open") {\n            this.doClose();\n            this.onClose();\n        }\n        return this;\n    }\n    /**\n     * Sends multiple packets.\n     *\n     * @param {Array} packets\n     */\n    send(packets) {\n        if (this.readyState === "open") {\n            this.write(packets);\n        }\n        else {\n            // this might happen if the transport was silently closed in the beforeunload event handler\n        }\n    }\n    /**\n     * Called upon open\n     *\n     * @protected\n     */\n    onOpen() {\n        this.readyState = "open";\n        this.writable = true;\n        super.emitReserved("open");\n    }\n    /**\n     * Called with data.\n     *\n     * @param {String} data\n     * @protected\n     */\n    onData(data) {\n        const packet = (0,engine_io_parser__WEBPACK_IMPORTED_MODULE_0__.decodePacket)(data, this.socket.binaryType);\n        this.onPacket(packet);\n    }\n    /**\n     * Called with a decoded packet.\n     *\n     * @protected\n     */\n    onPacket(packet) {\n        super.emitReserved("packet", packet);\n    }\n    /**\n     * Called upon close.\n     *\n     * @protected\n     */\n    onClose(details) {\n        this.readyState = "closed";\n        super.emitReserved("close", details);\n    }\n    /**\n     * Pauses the transport, in order not to lose packets during an upgrade.\n     *\n     * @param onPause\n     */\n    pause(onPause) { }\n    createUri(schema, query = {}) {\n        return (schema +\n            "://" +\n            this._hostname() +\n            this._port() +\n            this.opts.path +\n            this._query(query));\n    }\n    _hostname() {\n        const hostname = this.opts.hostname;\n        return hostname.indexOf(":") === -1 ? hostname : "[" + hostname + "]";\n    }\n    _port() {\n        if (this.opts.port &&\n            ((this.opts.secure && Number(this.opts.port !== 443)) ||\n                (!this.opts.secure && Number(this.opts.port) !== 80))) {\n            return ":" + this.opts.port;\n        }\n        else {\n            return "";\n        }\n    }\n    _query(query) {\n        const encodedQuery = (0,_contrib_parseqs_js__WEBPACK_IMPORTED_MODULE_3__.encode)(query);\n        return encodedQuery.length ? "?" + encodedQuery : "";\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdHJhbnNwb3J0LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFnRDtBQUNPO0FBQ0w7QUFDSjtBQUN2QztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ08sd0JBQXdCLGlFQUFPO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSwrREFBcUI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0EsZ0JBQWdCLFdBQVc7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxPQUFPO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBLHVCQUF1Qiw4REFBWTtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQztBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QiwyREFBTTtBQUNuQztBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdHJhbnNwb3J0LmpzP2VjM2YiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZGVjb2RlUGFja2V0IH0gZnJvbSBcImVuZ2luZS5pby1wYXJzZXJcIjtcbmltcG9ydCB7IEVtaXR0ZXIgfSBmcm9tIFwiQHNvY2tldC5pby9jb21wb25lbnQtZW1pdHRlclwiO1xuaW1wb3J0IHsgaW5zdGFsbFRpbWVyRnVuY3Rpb25zIH0gZnJvbSBcIi4vdXRpbC5qc1wiO1xuaW1wb3J0IHsgZW5jb2RlIH0gZnJvbSBcIi4vY29udHJpYi9wYXJzZXFzLmpzXCI7XG5leHBvcnQgY2xhc3MgVHJhbnNwb3J0RXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gICAgY29uc3RydWN0b3IocmVhc29uLCBkZXNjcmlwdGlvbiwgY29udGV4dCkge1xuICAgICAgICBzdXBlcihyZWFzb24pO1xuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XG4gICAgICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQ7XG4gICAgICAgIHRoaXMudHlwZSA9IFwiVHJhbnNwb3J0RXJyb3JcIjtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgVHJhbnNwb3J0IGV4dGVuZHMgRW1pdHRlciB7XG4gICAgLyoqXG4gICAgICogVHJhbnNwb3J0IGFic3RyYWN0IGNvbnN0cnVjdG9yLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9wdHMgLSBvcHRpb25zXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKG9wdHMpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy53cml0YWJsZSA9IGZhbHNlO1xuICAgICAgICBpbnN0YWxsVGltZXJGdW5jdGlvbnModGhpcywgb3B0cyk7XG4gICAgICAgIHRoaXMub3B0cyA9IG9wdHM7XG4gICAgICAgIHRoaXMucXVlcnkgPSBvcHRzLnF1ZXJ5O1xuICAgICAgICB0aGlzLnNvY2tldCA9IG9wdHMuc29ja2V0O1xuICAgICAgICB0aGlzLnN1cHBvcnRzQmluYXJ5ID0gIW9wdHMuZm9yY2VCYXNlNjQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEVtaXRzIGFuIGVycm9yLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHJlYXNvblxuICAgICAqIEBwYXJhbSBkZXNjcmlwdGlvblxuICAgICAqIEBwYXJhbSBjb250ZXh0IC0gdGhlIGVycm9yIGNvbnRleHRcbiAgICAgKiBAcmV0dXJuIHtUcmFuc3BvcnR9IGZvciBjaGFpbmluZ1xuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBvbkVycm9yKHJlYXNvbiwgZGVzY3JpcHRpb24sIGNvbnRleHQpIHtcbiAgICAgICAgc3VwZXIuZW1pdFJlc2VydmVkKFwiZXJyb3JcIiwgbmV3IFRyYW5zcG9ydEVycm9yKHJlYXNvbiwgZGVzY3JpcHRpb24sIGNvbnRleHQpKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE9wZW5zIHRoZSB0cmFuc3BvcnQuXG4gICAgICovXG4gICAgb3BlbigpIHtcbiAgICAgICAgdGhpcy5yZWFkeVN0YXRlID0gXCJvcGVuaW5nXCI7XG4gICAgICAgIHRoaXMuZG9PcGVuKCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDbG9zZXMgdGhlIHRyYW5zcG9ydC5cbiAgICAgKi9cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgaWYgKHRoaXMucmVhZHlTdGF0ZSA9PT0gXCJvcGVuaW5nXCIgfHwgdGhpcy5yZWFkeVN0YXRlID09PSBcIm9wZW5cIikge1xuICAgICAgICAgICAgdGhpcy5kb0Nsb3NlKCk7XG4gICAgICAgICAgICB0aGlzLm9uQ2xvc2UoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VuZHMgbXVsdGlwbGUgcGFja2V0cy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IHBhY2tldHNcbiAgICAgKi9cbiAgICBzZW5kKHBhY2tldHMpIHtcbiAgICAgICAgaWYgKHRoaXMucmVhZHlTdGF0ZSA9PT0gXCJvcGVuXCIpIHtcbiAgICAgICAgICAgIHRoaXMud3JpdGUocGFja2V0cyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyB0aGlzIG1pZ2h0IGhhcHBlbiBpZiB0aGUgdHJhbnNwb3J0IHdhcyBzaWxlbnRseSBjbG9zZWQgaW4gdGhlIGJlZm9yZXVubG9hZCBldmVudCBoYW5kbGVyXG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHVwb24gb3BlblxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIG9uT3BlbigpIHtcbiAgICAgICAgdGhpcy5yZWFkeVN0YXRlID0gXCJvcGVuXCI7XG4gICAgICAgIHRoaXMud3JpdGFibGUgPSB0cnVlO1xuICAgICAgICBzdXBlci5lbWl0UmVzZXJ2ZWQoXCJvcGVuXCIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgd2l0aCBkYXRhLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGRhdGFcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgb25EYXRhKGRhdGEpIHtcbiAgICAgICAgY29uc3QgcGFja2V0ID0gZGVjb2RlUGFja2V0KGRhdGEsIHRoaXMuc29ja2V0LmJpbmFyeVR5cGUpO1xuICAgICAgICB0aGlzLm9uUGFja2V0KHBhY2tldCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxlZCB3aXRoIGEgZGVjb2RlZCBwYWNrZXQuXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgb25QYWNrZXQocGFja2V0KSB7XG4gICAgICAgIHN1cGVyLmVtaXRSZXNlcnZlZChcInBhY2tldFwiLCBwYWNrZXQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgdXBvbiBjbG9zZS5cbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBvbkNsb3NlKGRldGFpbHMpIHtcbiAgICAgICAgdGhpcy5yZWFkeVN0YXRlID0gXCJjbG9zZWRcIjtcbiAgICAgICAgc3VwZXIuZW1pdFJlc2VydmVkKFwiY2xvc2VcIiwgZGV0YWlscyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBhdXNlcyB0aGUgdHJhbnNwb3J0LCBpbiBvcmRlciBub3QgdG8gbG9zZSBwYWNrZXRzIGR1cmluZyBhbiB1cGdyYWRlLlxuICAgICAqXG4gICAgICogQHBhcmFtIG9uUGF1c2VcbiAgICAgKi9cbiAgICBwYXVzZShvblBhdXNlKSB7IH1cbiAgICBjcmVhdGVVcmkoc2NoZW1hLCBxdWVyeSA9IHt9KSB7XG4gICAgICAgIHJldHVybiAoc2NoZW1hICtcbiAgICAgICAgICAgIFwiOi8vXCIgK1xuICAgICAgICAgICAgdGhpcy5faG9zdG5hbWUoKSArXG4gICAgICAgICAgICB0aGlzLl9wb3J0KCkgK1xuICAgICAgICAgICAgdGhpcy5vcHRzLnBhdGggK1xuICAgICAgICAgICAgdGhpcy5fcXVlcnkocXVlcnkpKTtcbiAgICB9XG4gICAgX2hvc3RuYW1lKCkge1xuICAgICAgICBjb25zdCBob3N0bmFtZSA9IHRoaXMub3B0cy5ob3N0bmFtZTtcbiAgICAgICAgcmV0dXJuIGhvc3RuYW1lLmluZGV4T2YoXCI6XCIpID09PSAtMSA/IGhvc3RuYW1lIDogXCJbXCIgKyBob3N0bmFtZSArIFwiXVwiO1xuICAgIH1cbiAgICBfcG9ydCgpIHtcbiAgICAgICAgaWYgKHRoaXMub3B0cy5wb3J0ICYmXG4gICAgICAgICAgICAoKHRoaXMub3B0cy5zZWN1cmUgJiYgTnVtYmVyKHRoaXMub3B0cy5wb3J0ICE9PSA0NDMpKSB8fFxuICAgICAgICAgICAgICAgICghdGhpcy5vcHRzLnNlY3VyZSAmJiBOdW1iZXIodGhpcy5vcHRzLnBvcnQpICE9PSA4MCkpKSB7XG4gICAgICAgICAgICByZXR1cm4gXCI6XCIgKyB0aGlzLm9wdHMucG9ydDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICB9XG4gICAgfVxuICAgIF9xdWVyeShxdWVyeSkge1xuICAgICAgICBjb25zdCBlbmNvZGVkUXVlcnkgPSBlbmNvZGUocXVlcnkpO1xuICAgICAgICByZXR1cm4gZW5jb2RlZFF1ZXJ5Lmxlbmd0aCA/IFwiP1wiICsgZW5jb2RlZFF1ZXJ5IDogXCJcIjtcbiAgICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transport.js\n')},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/index.js":
/*!***************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/index.js ***!
  \***************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   transports: () => (/* binding */ transports)\n/* harmony export */ });\n/* harmony import */ var _polling_xhr_node_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./polling-xhr.node.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling-xhr.js");\n/* harmony import */ var _websocket_node_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./websocket.node.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/websocket.js");\n/* harmony import */ var _webtransport_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./webtransport.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/webtransport.js");\n\n\n\nconst transports = {\n    websocket: _websocket_node_js__WEBPACK_IMPORTED_MODULE_1__.WS,\n    webtransport: _webtransport_js__WEBPACK_IMPORTED_MODULE_2__.WT,\n    polling: _polling_xhr_node_js__WEBPACK_IMPORTED_MODULE_0__.XHR,\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdHJhbnNwb3J0cy9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQTRDO0FBQ0g7QUFDRjtBQUNoQztBQUNQLGVBQWUsa0RBQUU7QUFDakIsa0JBQWtCLGdEQUFFO0FBQ3BCLGFBQWEscURBQUc7QUFDaEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdHJhbnNwb3J0cy9pbmRleC5qcz85NWYzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFhIUiB9IGZyb20gXCIuL3BvbGxpbmcteGhyLm5vZGUuanNcIjtcbmltcG9ydCB7IFdTIH0gZnJvbSBcIi4vd2Vic29ja2V0Lm5vZGUuanNcIjtcbmltcG9ydCB7IFdUIH0gZnJvbSBcIi4vd2VidHJhbnNwb3J0LmpzXCI7XG5leHBvcnQgY29uc3QgdHJhbnNwb3J0cyA9IHtcbiAgICB3ZWJzb2NrZXQ6IFdTLFxuICAgIHdlYnRyYW5zcG9ydDogV1QsXG4gICAgcG9sbGluZzogWEhSLFxufTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/index.js\n')},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling-fetch.js":
/*!***********************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling-fetch.js ***!
  \***********************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Fetch: () => (/* binding */ Fetch)\n/* harmony export */ });\n/* harmony import */ var _polling_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./polling.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling.js");\n\n/**\n * HTTP long-polling based on the built-in `fetch()` method.\n *\n * Usage: browser, Node.js (since v18), Deno, Bun\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/fetch\n * @see https://caniuse.com/fetch\n * @see https://nodejs.org/api/globals.html#fetch\n */\nclass Fetch extends _polling_js__WEBPACK_IMPORTED_MODULE_0__.Polling {\n    doPoll() {\n        this._fetch()\n            .then((res) => {\n            if (!res.ok) {\n                return this.onError("fetch read error", res.status, res);\n            }\n            res.text().then((data) => this.onData(data));\n        })\n            .catch((err) => {\n            this.onError("fetch read error", err);\n        });\n    }\n    doWrite(data, callback) {\n        this._fetch(data)\n            .then((res) => {\n            if (!res.ok) {\n                return this.onError("fetch write error", res.status, res);\n            }\n            callback();\n        })\n            .catch((err) => {\n            this.onError("fetch write error", err);\n        });\n    }\n    _fetch(data) {\n        var _a;\n        const isPost = data !== undefined;\n        const headers = new Headers(this.opts.extraHeaders);\n        if (isPost) {\n            headers.set("content-type", "text/plain;charset=UTF-8");\n        }\n        (_a = this.socket._cookieJar) === null || _a === void 0 ? void 0 : _a.appendCookies(headers);\n        return fetch(this.uri(), {\n            method: isPost ? "POST" : "GET",\n            body: isPost ? data : null,\n            headers,\n            credentials: this.opts.withCredentials ? "include" : "omit",\n        }).then((res) => {\n            var _a;\n            // @ts-ignore getSetCookie() was added in Node.js v19.7.0\n            (_a = this.socket._cookieJar) === null || _a === void 0 ? void 0 : _a.parseCookies(res.headers.getSetCookie());\n            return res;\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdHJhbnNwb3J0cy9wb2xsaW5nLWZldGNoLmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQXVDO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPLG9CQUFvQixnREFBTztBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvREFBb0Q7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL25vZGVfbW9kdWxlcy8ucG5wbS9lbmdpbmUuaW8tY2xpZW50QDYuNi4zL25vZGVfbW9kdWxlcy9lbmdpbmUuaW8tY2xpZW50L2J1aWxkL2VzbS90cmFuc3BvcnRzL3BvbGxpbmctZmV0Y2guanM/MmI4ZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQb2xsaW5nIH0gZnJvbSBcIi4vcG9sbGluZy5qc1wiO1xuLyoqXG4gKiBIVFRQIGxvbmctcG9sbGluZyBiYXNlZCBvbiB0aGUgYnVpbHQtaW4gYGZldGNoKClgIG1ldGhvZC5cbiAqXG4gKiBVc2FnZTogYnJvd3NlciwgTm9kZS5qcyAoc2luY2UgdjE4KSwgRGVubywgQnVuXG4gKlxuICogQHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvZmV0Y2hcbiAqIEBzZWUgaHR0cHM6Ly9jYW5pdXNlLmNvbS9mZXRjaFxuICogQHNlZSBodHRwczovL25vZGVqcy5vcmcvYXBpL2dsb2JhbHMuaHRtbCNmZXRjaFxuICovXG5leHBvcnQgY2xhc3MgRmV0Y2ggZXh0ZW5kcyBQb2xsaW5nIHtcbiAgICBkb1BvbGwoKSB7XG4gICAgICAgIHRoaXMuX2ZldGNoKClcbiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgIGlmICghcmVzLm9rKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMub25FcnJvcihcImZldGNoIHJlYWQgZXJyb3JcIiwgcmVzLnN0YXR1cywgcmVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlcy50ZXh0KCkudGhlbigoZGF0YSkgPT4gdGhpcy5vbkRhdGEoZGF0YSkpO1xuICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIHRoaXMub25FcnJvcihcImZldGNoIHJlYWQgZXJyb3JcIiwgZXJyKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGRvV3JpdGUoZGF0YSwgY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5fZmV0Y2goZGF0YSlcbiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgIGlmICghcmVzLm9rKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMub25FcnJvcihcImZldGNoIHdyaXRlIGVycm9yXCIsIHJlcy5zdGF0dXMsIHJlcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIHRoaXMub25FcnJvcihcImZldGNoIHdyaXRlIGVycm9yXCIsIGVycik7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBfZmV0Y2goZGF0YSkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGNvbnN0IGlzUG9zdCA9IGRhdGEgIT09IHVuZGVmaW5lZDtcbiAgICAgICAgY29uc3QgaGVhZGVycyA9IG5ldyBIZWFkZXJzKHRoaXMub3B0cy5leHRyYUhlYWRlcnMpO1xuICAgICAgICBpZiAoaXNQb3N0KSB7XG4gICAgICAgICAgICBoZWFkZXJzLnNldChcImNvbnRlbnQtdHlwZVwiLCBcInRleHQvcGxhaW47Y2hhcnNldD1VVEYtOFwiKTtcbiAgICAgICAgfVxuICAgICAgICAoX2EgPSB0aGlzLnNvY2tldC5fY29va2llSmFyKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuYXBwZW5kQ29va2llcyhoZWFkZXJzKTtcbiAgICAgICAgcmV0dXJuIGZldGNoKHRoaXMudXJpKCksIHtcbiAgICAgICAgICAgIG1ldGhvZDogaXNQb3N0ID8gXCJQT1NUXCIgOiBcIkdFVFwiLFxuICAgICAgICAgICAgYm9keTogaXNQb3N0ID8gZGF0YSA6IG51bGwsXG4gICAgICAgICAgICBoZWFkZXJzLFxuICAgICAgICAgICAgY3JlZGVudGlhbHM6IHRoaXMub3B0cy53aXRoQ3JlZGVudGlhbHMgPyBcImluY2x1ZGVcIiA6IFwib21pdFwiLFxuICAgICAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUgZ2V0U2V0Q29va2llKCkgd2FzIGFkZGVkIGluIE5vZGUuanMgdjE5LjcuMFxuICAgICAgICAgICAgKF9hID0gdGhpcy5zb2NrZXQuX2Nvb2tpZUphcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnBhcnNlQ29va2llcyhyZXMuaGVhZGVycy5nZXRTZXRDb29raWUoKSk7XG4gICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICB9KTtcbiAgICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling-fetch.js\n')},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling-xhr.js":
/*!*********************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling-xhr.js ***!
  \*********************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BaseXHR: () => (/* binding */ BaseXHR),\n/* harmony export */   Request: () => (/* binding */ Request),\n/* harmony export */   XHR: () => (/* binding */ XHR)\n/* harmony export */ });\n/* harmony import */ var _polling_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./polling.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling.js");\n/* harmony import */ var _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @socket.io/component-emitter */ "./node_modules/.pnpm/@socket.io+component-emitter@3.1.2/node_modules/@socket.io/component-emitter/lib/esm/index.js");\n/* harmony import */ var _util_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../util.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/util.js");\n/* harmony import */ var _globals_node_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../globals.node.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/globals.js");\n/* harmony import */ var _contrib_has_cors_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../contrib/has-cors.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/contrib/has-cors.js");\n\n\n\n\n\nfunction empty() { }\nclass BaseXHR extends _polling_js__WEBPACK_IMPORTED_MODULE_0__.Polling {\n    /**\n     * XHR Polling constructor.\n     *\n     * @param {Object} opts\n     * @package\n     */\n    constructor(opts) {\n        super(opts);\n        if (typeof location !== "undefined") {\n            const isSSL = "https:" === location.protocol;\n            let port = location.port;\n            // some user agents have empty `location.port`\n            if (!port) {\n                port = isSSL ? "443" : "80";\n            }\n            this.xd =\n                (typeof location !== "undefined" &&\n                    opts.hostname !== location.hostname) ||\n                    port !== opts.port;\n        }\n    }\n    /**\n     * Sends data.\n     *\n     * @param {String} data to send.\n     * @param {Function} called upon flush.\n     * @private\n     */\n    doWrite(data, fn) {\n        const req = this.request({\n            method: "POST",\n            data: data,\n        });\n        req.on("success", fn);\n        req.on("error", (xhrStatus, context) => {\n            this.onError("xhr post error", xhrStatus, context);\n        });\n    }\n    /**\n     * Starts a poll cycle.\n     *\n     * @private\n     */\n    doPoll() {\n        const req = this.request();\n        req.on("data", this.onData.bind(this));\n        req.on("error", (xhrStatus, context) => {\n            this.onError("xhr poll error", xhrStatus, context);\n        });\n        this.pollXhr = req;\n    }\n}\nclass Request extends _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_1__.Emitter {\n    /**\n     * Request constructor\n     *\n     * @param {Object} options\n     * @package\n     */\n    constructor(createRequest, uri, opts) {\n        super();\n        this.createRequest = createRequest;\n        (0,_util_js__WEBPACK_IMPORTED_MODULE_2__.installTimerFunctions)(this, opts);\n        this._opts = opts;\n        this._method = opts.method || "GET";\n        this._uri = uri;\n        this._data = undefined !== opts.data ? opts.data : null;\n        this._create();\n    }\n    /**\n     * Creates the XHR object and sends the request.\n     *\n     * @private\n     */\n    _create() {\n        var _a;\n        const opts = (0,_util_js__WEBPACK_IMPORTED_MODULE_2__.pick)(this._opts, "agent", "pfx", "key", "passphrase", "cert", "ca", "ciphers", "rejectUnauthorized", "autoUnref");\n        opts.xdomain = !!this._opts.xd;\n        const xhr = (this._xhr = this.createRequest(opts));\n        try {\n            xhr.open(this._method, this._uri, true);\n            try {\n                if (this._opts.extraHeaders) {\n                    // @ts-ignore\n                    xhr.setDisableHeaderCheck && xhr.setDisableHeaderCheck(true);\n                    for (let i in this._opts.extraHeaders) {\n                        if (this._opts.extraHeaders.hasOwnProperty(i)) {\n                            xhr.setRequestHeader(i, this._opts.extraHeaders[i]);\n                        }\n                    }\n                }\n            }\n            catch (e) { }\n            if ("POST" === this._method) {\n                try {\n                    xhr.setRequestHeader("Content-type", "text/plain;charset=UTF-8");\n                }\n                catch (e) { }\n            }\n            try {\n                xhr.setRequestHeader("Accept", "*/*");\n            }\n            catch (e) { }\n            (_a = this._opts.cookieJar) === null || _a === void 0 ? void 0 : _a.addCookies(xhr);\n            // ie6 check\n            if ("withCredentials" in xhr) {\n                xhr.withCredentials = this._opts.withCredentials;\n            }\n            if (this._opts.requestTimeout) {\n                xhr.timeout = this._opts.requestTimeout;\n            }\n            xhr.onreadystatechange = () => {\n                var _a;\n                if (xhr.readyState === 3) {\n                    (_a = this._opts.cookieJar) === null || _a === void 0 ? void 0 : _a.parseCookies(\n                    // @ts-ignore\n                    xhr.getResponseHeader("set-cookie"));\n                }\n                if (4 !== xhr.readyState)\n                    return;\n                if (200 === xhr.status || 1223 === xhr.status) {\n                    this._onLoad();\n                }\n                else {\n                    // make sure the `error` event handler that\'s user-set\n                    // does not throw in the same tick and gets caught here\n                    this.setTimeoutFn(() => {\n                        this._onError(typeof xhr.status === "number" ? xhr.status : 0);\n                    }, 0);\n                }\n            };\n            xhr.send(this._data);\n        }\n        catch (e) {\n            // Need to defer since .create() is called directly from the constructor\n            // and thus the \'error\' event can only be only bound *after* this exception\n            // occurs.  Therefore, also, we cannot throw here at all.\n            this.setTimeoutFn(() => {\n                this._onError(e);\n            }, 0);\n            return;\n        }\n        if (typeof document !== "undefined") {\n            this._index = Request.requestsCount++;\n            Request.requests[this._index] = this;\n        }\n    }\n    /**\n     * Called upon error.\n     *\n     * @private\n     */\n    _onError(err) {\n        this.emitReserved("error", err, this._xhr);\n        this._cleanup(true);\n    }\n    /**\n     * Cleans up house.\n     *\n     * @private\n     */\n    _cleanup(fromError) {\n        if ("undefined" === typeof this._xhr || null === this._xhr) {\n            return;\n        }\n        this._xhr.onreadystatechange = empty;\n        if (fromError) {\n            try {\n                this._xhr.abort();\n            }\n            catch (e) { }\n        }\n        if (typeof document !== "undefined") {\n            delete Request.requests[this._index];\n        }\n        this._xhr = null;\n    }\n    /**\n     * Called upon load.\n     *\n     * @private\n     */\n    _onLoad() {\n        const data = this._xhr.responseText;\n        if (data !== null) {\n            this.emitReserved("data", data);\n            this.emitReserved("success");\n            this._cleanup();\n        }\n    }\n    /**\n     * Aborts the request.\n     *\n     * @package\n     */\n    abort() {\n        this._cleanup();\n    }\n}\nRequest.requestsCount = 0;\nRequest.requests = {};\n/**\n * Aborts pending requests when unloading the window. This is needed to prevent\n * memory leaks (e.g. when using IE) and to ensure that no spurious error is\n * emitted.\n */\nif (typeof document !== "undefined") {\n    // @ts-ignore\n    if (typeof attachEvent === "function") {\n        // @ts-ignore\n        attachEvent("onunload", unloadHandler);\n    }\n    else if (typeof addEventListener === "function") {\n        const terminationEvent = "onpagehide" in _globals_node_js__WEBPACK_IMPORTED_MODULE_3__.globalThisShim ? "pagehide" : "unload";\n        addEventListener(terminationEvent, unloadHandler, false);\n    }\n}\nfunction unloadHandler() {\n    for (let i in Request.requests) {\n        if (Request.requests.hasOwnProperty(i)) {\n            Request.requests[i].abort();\n        }\n    }\n}\nconst hasXHR2 = (function () {\n    const xhr = newRequest({\n        xdomain: false,\n    });\n    return xhr && xhr.responseType !== null;\n})();\n/**\n * HTTP long-polling based on the built-in `XMLHttpRequest` object.\n *\n * Usage: browser\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest\n */\nclass XHR extends BaseXHR {\n    constructor(opts) {\n        super(opts);\n        const forceBase64 = opts && opts.forceBase64;\n        this.supportsBinary = hasXHR2 && !forceBase64;\n    }\n    request(opts = {}) {\n        Object.assign(opts, { xd: this.xd }, this.opts);\n        return new Request(newRequest, this.uri(), opts);\n    }\n}\nfunction newRequest(opts) {\n    const xdomain = opts.xdomain;\n    // XMLHttpRequest can be disabled on IE\n    try {\n        if ("undefined" !== typeof XMLHttpRequest && (!xdomain || _contrib_has_cors_js__WEBPACK_IMPORTED_MODULE_4__.hasCORS)) {\n            return new XMLHttpRequest();\n        }\n    }\n    catch (e) { }\n    if (!xdomain) {\n        try {\n            return new _globals_node_js__WEBPACK_IMPORTED_MODULE_3__.globalThisShim[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP");\n        }\n        catch (e) { }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdHJhbnNwb3J0cy9wb2xsaW5nLXhoci5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUF1QztBQUNnQjtBQUNFO0FBQ1M7QUFDakI7QUFDakQ7QUFDTyxzQkFBc0IsZ0RBQU87QUFDcEM7QUFDQTtBQUNBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkIsZUFBZSxVQUFVO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDTyxzQkFBc0IsaUVBQU87QUFDcEM7QUFDQTtBQUNBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLCtEQUFxQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQiw4Q0FBSTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxRUFBcUU7QUFDckU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyw0RUFBMEI7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckIsOEJBQThCLGFBQWE7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrRUFBa0UseURBQU87QUFDekU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLDREQUFVO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2VuZ2luZS5pby1jbGllbnRANi42LjMvbm9kZV9tb2R1bGVzL2VuZ2luZS5pby1jbGllbnQvYnVpbGQvZXNtL3RyYW5zcG9ydHMvcG9sbGluZy14aHIuanM/NjBlYyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQb2xsaW5nIH0gZnJvbSBcIi4vcG9sbGluZy5qc1wiO1xuaW1wb3J0IHsgRW1pdHRlciB9IGZyb20gXCJAc29ja2V0LmlvL2NvbXBvbmVudC1lbWl0dGVyXCI7XG5pbXBvcnQgeyBpbnN0YWxsVGltZXJGdW5jdGlvbnMsIHBpY2sgfSBmcm9tIFwiLi4vdXRpbC5qc1wiO1xuaW1wb3J0IHsgZ2xvYmFsVGhpc1NoaW0gYXMgZ2xvYmFsVGhpcyB9IGZyb20gXCIuLi9nbG9iYWxzLm5vZGUuanNcIjtcbmltcG9ydCB7IGhhc0NPUlMgfSBmcm9tIFwiLi4vY29udHJpYi9oYXMtY29ycy5qc1wiO1xuZnVuY3Rpb24gZW1wdHkoKSB7IH1cbmV4cG9ydCBjbGFzcyBCYXNlWEhSIGV4dGVuZHMgUG9sbGluZyB7XG4gICAgLyoqXG4gICAgICogWEhSIFBvbGxpbmcgY29uc3RydWN0b3IuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb3B0c1xuICAgICAqIEBwYWNrYWdlXG4gICAgICovXG4gICAgY29uc3RydWN0b3Iob3B0cykge1xuICAgICAgICBzdXBlcihvcHRzKTtcbiAgICAgICAgaWYgKHR5cGVvZiBsb2NhdGlvbiAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgICAgY29uc3QgaXNTU0wgPSBcImh0dHBzOlwiID09PSBsb2NhdGlvbi5wcm90b2NvbDtcbiAgICAgICAgICAgIGxldCBwb3J0ID0gbG9jYXRpb24ucG9ydDtcbiAgICAgICAgICAgIC8vIHNvbWUgdXNlciBhZ2VudHMgaGF2ZSBlbXB0eSBgbG9jYXRpb24ucG9ydGBcbiAgICAgICAgICAgIGlmICghcG9ydCkge1xuICAgICAgICAgICAgICAgIHBvcnQgPSBpc1NTTCA/IFwiNDQzXCIgOiBcIjgwXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnhkID1cbiAgICAgICAgICAgICAgICAodHlwZW9mIGxvY2F0aW9uICE9PSBcInVuZGVmaW5lZFwiICYmXG4gICAgICAgICAgICAgICAgICAgIG9wdHMuaG9zdG5hbWUgIT09IGxvY2F0aW9uLmhvc3RuYW1lKSB8fFxuICAgICAgICAgICAgICAgICAgICBwb3J0ICE9PSBvcHRzLnBvcnQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VuZHMgZGF0YS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBkYXRhIHRvIHNlbmQuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGVkIHVwb24gZmx1c2guXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBkb1dyaXRlKGRhdGEsIGZuKSB7XG4gICAgICAgIGNvbnN0IHJlcSA9IHRoaXMucmVxdWVzdCh7XG4gICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgICAgZGF0YTogZGF0YSxcbiAgICAgICAgfSk7XG4gICAgICAgIHJlcS5vbihcInN1Y2Nlc3NcIiwgZm4pO1xuICAgICAgICByZXEub24oXCJlcnJvclwiLCAoeGhyU3RhdHVzLCBjb250ZXh0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLm9uRXJyb3IoXCJ4aHIgcG9zdCBlcnJvclwiLCB4aHJTdGF0dXMsIGNvbnRleHQpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3RhcnRzIGEgcG9sbCBjeWNsZS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgZG9Qb2xsKCkge1xuICAgICAgICBjb25zdCByZXEgPSB0aGlzLnJlcXVlc3QoKTtcbiAgICAgICAgcmVxLm9uKFwiZGF0YVwiLCB0aGlzLm9uRGF0YS5iaW5kKHRoaXMpKTtcbiAgICAgICAgcmVxLm9uKFwiZXJyb3JcIiwgKHhoclN0YXR1cywgY29udGV4dCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5vbkVycm9yKFwieGhyIHBvbGwgZXJyb3JcIiwgeGhyU3RhdHVzLCBjb250ZXh0KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMucG9sbFhociA9IHJlcTtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgUmVxdWVzdCBleHRlbmRzIEVtaXR0ZXIge1xuICAgIC8qKlxuICAgICAqIFJlcXVlc3QgY29uc3RydWN0b3JcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zXG4gICAgICogQHBhY2thZ2VcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihjcmVhdGVSZXF1ZXN0LCB1cmksIG9wdHMpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5jcmVhdGVSZXF1ZXN0ID0gY3JlYXRlUmVxdWVzdDtcbiAgICAgICAgaW5zdGFsbFRpbWVyRnVuY3Rpb25zKHRoaXMsIG9wdHMpO1xuICAgICAgICB0aGlzLl9vcHRzID0gb3B0cztcbiAgICAgICAgdGhpcy5fbWV0aG9kID0gb3B0cy5tZXRob2QgfHwgXCJHRVRcIjtcbiAgICAgICAgdGhpcy5fdXJpID0gdXJpO1xuICAgICAgICB0aGlzLl9kYXRhID0gdW5kZWZpbmVkICE9PSBvcHRzLmRhdGEgPyBvcHRzLmRhdGEgOiBudWxsO1xuICAgICAgICB0aGlzLl9jcmVhdGUoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyB0aGUgWEhSIG9iamVjdCBhbmQgc2VuZHMgdGhlIHJlcXVlc3QuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9jcmVhdGUoKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgY29uc3Qgb3B0cyA9IHBpY2sodGhpcy5fb3B0cywgXCJhZ2VudFwiLCBcInBmeFwiLCBcImtleVwiLCBcInBhc3NwaHJhc2VcIiwgXCJjZXJ0XCIsIFwiY2FcIiwgXCJjaXBoZXJzXCIsIFwicmVqZWN0VW5hdXRob3JpemVkXCIsIFwiYXV0b1VucmVmXCIpO1xuICAgICAgICBvcHRzLnhkb21haW4gPSAhIXRoaXMuX29wdHMueGQ7XG4gICAgICAgIGNvbnN0IHhociA9ICh0aGlzLl94aHIgPSB0aGlzLmNyZWF0ZVJlcXVlc3Qob3B0cykpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgeGhyLm9wZW4odGhpcy5fbWV0aG9kLCB0aGlzLl91cmksIHRydWUpO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fb3B0cy5leHRyYUhlYWRlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICB4aHIuc2V0RGlzYWJsZUhlYWRlckNoZWNrICYmIHhoci5zZXREaXNhYmxlSGVhZGVyQ2hlY2sodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgaW4gdGhpcy5fb3B0cy5leHRyYUhlYWRlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9vcHRzLmV4dHJhSGVhZGVycy5oYXNPd25Qcm9wZXJ0eShpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKGksIHRoaXMuX29wdHMuZXh0cmFIZWFkZXJzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7IH1cbiAgICAgICAgICAgIGlmIChcIlBPU1RcIiA9PT0gdGhpcy5fbWV0aG9kKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoXCJDb250ZW50LXR5cGVcIiwgXCJ0ZXh0L3BsYWluO2NoYXJzZXQ9VVRGLThcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7IH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoXCJBY2NlcHRcIiwgXCIqLypcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkgeyB9XG4gICAgICAgICAgICAoX2EgPSB0aGlzLl9vcHRzLmNvb2tpZUphcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmFkZENvb2tpZXMoeGhyKTtcbiAgICAgICAgICAgIC8vIGllNiBjaGVja1xuICAgICAgICAgICAgaWYgKFwid2l0aENyZWRlbnRpYWxzXCIgaW4geGhyKSB7XG4gICAgICAgICAgICAgICAgeGhyLndpdGhDcmVkZW50aWFscyA9IHRoaXMuX29wdHMud2l0aENyZWRlbnRpYWxzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuX29wdHMucmVxdWVzdFRpbWVvdXQpIHtcbiAgICAgICAgICAgICAgICB4aHIudGltZW91dCA9IHRoaXMuX29wdHMucmVxdWVzdFRpbWVvdXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgICAgICBpZiAoeGhyLnJlYWR5U3RhdGUgPT09IDMpIHtcbiAgICAgICAgICAgICAgICAgICAgKF9hID0gdGhpcy5fb3B0cy5jb29raWVKYXIpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5wYXJzZUNvb2tpZXMoXG4gICAgICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICAgICAgeGhyLmdldFJlc3BvbnNlSGVhZGVyKFwic2V0LWNvb2tpZVwiKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICg0ICE9PSB4aHIucmVhZHlTdGF0ZSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIGlmICgyMDAgPT09IHhoci5zdGF0dXMgfHwgMTIyMyA9PT0geGhyLnN0YXR1cykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9vbkxvYWQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIG1ha2Ugc3VyZSB0aGUgYGVycm9yYCBldmVudCBoYW5kbGVyIHRoYXQncyB1c2VyLXNldFxuICAgICAgICAgICAgICAgICAgICAvLyBkb2VzIG5vdCB0aHJvdyBpbiB0aGUgc2FtZSB0aWNrIGFuZCBnZXRzIGNhdWdodCBoZXJlXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0VGltZW91dEZuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX29uRXJyb3IodHlwZW9mIHhoci5zdGF0dXMgPT09IFwibnVtYmVyXCIgPyB4aHIuc3RhdHVzIDogMCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB4aHIuc2VuZCh0aGlzLl9kYXRhKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgLy8gTmVlZCB0byBkZWZlciBzaW5jZSAuY3JlYXRlKCkgaXMgY2FsbGVkIGRpcmVjdGx5IGZyb20gdGhlIGNvbnN0cnVjdG9yXG4gICAgICAgICAgICAvLyBhbmQgdGh1cyB0aGUgJ2Vycm9yJyBldmVudCBjYW4gb25seSBiZSBvbmx5IGJvdW5kICphZnRlciogdGhpcyBleGNlcHRpb25cbiAgICAgICAgICAgIC8vIG9jY3Vycy4gIFRoZXJlZm9yZSwgYWxzbywgd2UgY2Fubm90IHRocm93IGhlcmUgYXQgYWxsLlxuICAgICAgICAgICAgdGhpcy5zZXRUaW1lb3V0Rm4oKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uRXJyb3IoZSk7XG4gICAgICAgICAgICB9LCAwKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGRvY3VtZW50ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICB0aGlzLl9pbmRleCA9IFJlcXVlc3QucmVxdWVzdHNDb3VudCsrO1xuICAgICAgICAgICAgUmVxdWVzdC5yZXF1ZXN0c1t0aGlzLl9pbmRleF0gPSB0aGlzO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxlZCB1cG9uIGVycm9yLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfb25FcnJvcihlcnIpIHtcbiAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJlcnJvclwiLCBlcnIsIHRoaXMuX3hocik7XG4gICAgICAgIHRoaXMuX2NsZWFudXAodHJ1ZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENsZWFucyB1cCBob3VzZS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2NsZWFudXAoZnJvbUVycm9yKSB7XG4gICAgICAgIGlmIChcInVuZGVmaW5lZFwiID09PSB0eXBlb2YgdGhpcy5feGhyIHx8IG51bGwgPT09IHRoaXMuX3hocikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3hoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBlbXB0eTtcbiAgICAgICAgaWYgKGZyb21FcnJvcikge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0aGlzLl94aHIuYWJvcnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7IH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGRvY3VtZW50ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICBkZWxldGUgUmVxdWVzdC5yZXF1ZXN0c1t0aGlzLl9pbmRleF07XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5feGhyID0gbnVsbDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHVwb24gbG9hZC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX29uTG9hZCgpIHtcbiAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMuX3hoci5yZXNwb25zZVRleHQ7XG4gICAgICAgIGlmIChkYXRhICE9PSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcImRhdGFcIiwgZGF0YSk7XG4gICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcInN1Y2Nlc3NcIik7XG4gICAgICAgICAgICB0aGlzLl9jbGVhbnVwKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQWJvcnRzIHRoZSByZXF1ZXN0LlxuICAgICAqXG4gICAgICogQHBhY2thZ2VcbiAgICAgKi9cbiAgICBhYm9ydCgpIHtcbiAgICAgICAgdGhpcy5fY2xlYW51cCgpO1xuICAgIH1cbn1cblJlcXVlc3QucmVxdWVzdHNDb3VudCA9IDA7XG5SZXF1ZXN0LnJlcXVlc3RzID0ge307XG4vKipcbiAqIEFib3J0cyBwZW5kaW5nIHJlcXVlc3RzIHdoZW4gdW5sb2FkaW5nIHRoZSB3aW5kb3cuIFRoaXMgaXMgbmVlZGVkIHRvIHByZXZlbnRcbiAqIG1lbW9yeSBsZWFrcyAoZS5nLiB3aGVuIHVzaW5nIElFKSBhbmQgdG8gZW5zdXJlIHRoYXQgbm8gc3B1cmlvdXMgZXJyb3IgaXNcbiAqIGVtaXR0ZWQuXG4gKi9cbmlmICh0eXBlb2YgZG9jdW1lbnQgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgaWYgKHR5cGVvZiBhdHRhY2hFdmVudCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgYXR0YWNoRXZlbnQoXCJvbnVubG9hZFwiLCB1bmxvYWRIYW5kbGVyKTtcbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZW9mIGFkZEV2ZW50TGlzdGVuZXIgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICBjb25zdCB0ZXJtaW5hdGlvbkV2ZW50ID0gXCJvbnBhZ2VoaWRlXCIgaW4gZ2xvYmFsVGhpcyA/IFwicGFnZWhpZGVcIiA6IFwidW5sb2FkXCI7XG4gICAgICAgIGFkZEV2ZW50TGlzdGVuZXIodGVybWluYXRpb25FdmVudCwgdW5sb2FkSGFuZGxlciwgZmFsc2UpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHVubG9hZEhhbmRsZXIoKSB7XG4gICAgZm9yIChsZXQgaSBpbiBSZXF1ZXN0LnJlcXVlc3RzKSB7XG4gICAgICAgIGlmIChSZXF1ZXN0LnJlcXVlc3RzLmhhc093blByb3BlcnR5KGkpKSB7XG4gICAgICAgICAgICBSZXF1ZXN0LnJlcXVlc3RzW2ldLmFib3J0KCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5jb25zdCBoYXNYSFIyID0gKGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCB4aHIgPSBuZXdSZXF1ZXN0KHtcbiAgICAgICAgeGRvbWFpbjogZmFsc2UsXG4gICAgfSk7XG4gICAgcmV0dXJuIHhociAmJiB4aHIucmVzcG9uc2VUeXBlICE9PSBudWxsO1xufSkoKTtcbi8qKlxuICogSFRUUCBsb25nLXBvbGxpbmcgYmFzZWQgb24gdGhlIGJ1aWx0LWluIGBYTUxIdHRwUmVxdWVzdGAgb2JqZWN0LlxuICpcbiAqIFVzYWdlOiBicm93c2VyXG4gKlxuICogQHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvWE1MSHR0cFJlcXVlc3RcbiAqL1xuZXhwb3J0IGNsYXNzIFhIUiBleHRlbmRzIEJhc2VYSFIge1xuICAgIGNvbnN0cnVjdG9yKG9wdHMpIHtcbiAgICAgICAgc3VwZXIob3B0cyk7XG4gICAgICAgIGNvbnN0IGZvcmNlQmFzZTY0ID0gb3B0cyAmJiBvcHRzLmZvcmNlQmFzZTY0O1xuICAgICAgICB0aGlzLnN1cHBvcnRzQmluYXJ5ID0gaGFzWEhSMiAmJiAhZm9yY2VCYXNlNjQ7XG4gICAgfVxuICAgIHJlcXVlc3Qob3B0cyA9IHt9KSB7XG4gICAgICAgIE9iamVjdC5hc3NpZ24ob3B0cywgeyB4ZDogdGhpcy54ZCB9LCB0aGlzLm9wdHMpO1xuICAgICAgICByZXR1cm4gbmV3IFJlcXVlc3QobmV3UmVxdWVzdCwgdGhpcy51cmkoKSwgb3B0cyk7XG4gICAgfVxufVxuZnVuY3Rpb24gbmV3UmVxdWVzdChvcHRzKSB7XG4gICAgY29uc3QgeGRvbWFpbiA9IG9wdHMueGRvbWFpbjtcbiAgICAvLyBYTUxIdHRwUmVxdWVzdCBjYW4gYmUgZGlzYWJsZWQgb24gSUVcbiAgICB0cnkge1xuICAgICAgICBpZiAoXCJ1bmRlZmluZWRcIiAhPT0gdHlwZW9mIFhNTEh0dHBSZXF1ZXN0ICYmICgheGRvbWFpbiB8fCBoYXNDT1JTKSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNhdGNoIChlKSB7IH1cbiAgICBpZiAoIXhkb21haW4pIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgZ2xvYmFsVGhpc1tbXCJBY3RpdmVcIl0uY29uY2F0KFwiT2JqZWN0XCIpLmpvaW4oXCJYXCIpXShcIk1pY3Jvc29mdC5YTUxIVFRQXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7IH1cbiAgICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling-xhr.js\n')},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling.js":
/*!*****************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling.js ***!
  \*****************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Polling: () => (/* binding */ Polling)\n/* harmony export */ });\n/* harmony import */ var _transport_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../transport.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transport.js");\n/* harmony import */ var _util_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../util.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/util.js");\n/* harmony import */ var engine_io_parser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! engine.io-parser */ "./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/index.js");\n\n\n\nclass Polling extends _transport_js__WEBPACK_IMPORTED_MODULE_0__.Transport {\n    constructor() {\n        super(...arguments);\n        this._polling = false;\n    }\n    get name() {\n        return "polling";\n    }\n    /**\n     * Opens the socket (triggers polling). We write a PING message to determine\n     * when the transport is open.\n     *\n     * @protected\n     */\n    doOpen() {\n        this._poll();\n    }\n    /**\n     * Pauses polling.\n     *\n     * @param {Function} onPause - callback upon buffers are flushed and transport is paused\n     * @package\n     */\n    pause(onPause) {\n        this.readyState = "pausing";\n        const pause = () => {\n            this.readyState = "paused";\n            onPause();\n        };\n        if (this._polling || !this.writable) {\n            let total = 0;\n            if (this._polling) {\n                total++;\n                this.once("pollComplete", function () {\n                    --total || pause();\n                });\n            }\n            if (!this.writable) {\n                total++;\n                this.once("drain", function () {\n                    --total || pause();\n                });\n            }\n        }\n        else {\n            pause();\n        }\n    }\n    /**\n     * Starts polling cycle.\n     *\n     * @private\n     */\n    _poll() {\n        this._polling = true;\n        this.doPoll();\n        this.emitReserved("poll");\n    }\n    /**\n     * Overloads onData to detect payloads.\n     *\n     * @protected\n     */\n    onData(data) {\n        const callback = (packet) => {\n            // if its the first message we consider the transport open\n            if ("opening" === this.readyState && packet.type === "open") {\n                this.onOpen();\n            }\n            // if its a close packet, we close the ongoing requests\n            if ("close" === packet.type) {\n                this.onClose({ description: "transport closed by the server" });\n                return false;\n            }\n            // otherwise bypass onData and handle the message\n            this.onPacket(packet);\n        };\n        // decode payload\n        (0,engine_io_parser__WEBPACK_IMPORTED_MODULE_2__.decodePayload)(data, this.socket.binaryType).forEach(callback);\n        // if an event did not trigger closing\n        if ("closed" !== this.readyState) {\n            // if we got data we\'re not polling\n            this._polling = false;\n            this.emitReserved("pollComplete");\n            if ("open" === this.readyState) {\n                this._poll();\n            }\n            else {\n            }\n        }\n    }\n    /**\n     * For polling, send a close packet.\n     *\n     * @protected\n     */\n    doClose() {\n        const close = () => {\n            this.write([{ type: "close" }]);\n        };\n        if ("open" === this.readyState) {\n            close();\n        }\n        else {\n            // in case we\'re trying to close while\n            // handshaking is in progress (GH-164)\n            this.once("open", close);\n        }\n    }\n    /**\n     * Writes a packets payload.\n     *\n     * @param {Array} packets - data packets\n     * @protected\n     */\n    write(packets) {\n        this.writable = false;\n        (0,engine_io_parser__WEBPACK_IMPORTED_MODULE_2__.encodePayload)(packets, (data) => {\n            this.doWrite(data, () => {\n                this.writable = true;\n                this.emitReserved("drain");\n            });\n        });\n    }\n    /**\n     * Generates uri for connection.\n     *\n     * @private\n     */\n    uri() {\n        const schema = this.opts.secure ? "https" : "http";\n        const query = this.query || {};\n        // cache busting is forced\n        if (false !== this.opts.timestampRequests) {\n            query[this.opts.timestampParam] = (0,_util_js__WEBPACK_IMPORTED_MODULE_1__.randomString)();\n        }\n        if (!this.supportsBinary && !query.sid) {\n            query.b64 = 1;\n        }\n        return this.createUri(schema, query);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdHJhbnNwb3J0cy9wb2xsaW5nLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBNEM7QUFDRjtBQUNzQjtBQUN6RCxzQkFBc0Isb0RBQVM7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFVBQVU7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsK0NBQStDO0FBQzlFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsK0RBQWE7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsZUFBZTtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsT0FBTztBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsK0RBQWE7QUFDckI7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLHNEQUFZO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2VuZ2luZS5pby1jbGllbnRANi42LjMvbm9kZV9tb2R1bGVzL2VuZ2luZS5pby1jbGllbnQvYnVpbGQvZXNtL3RyYW5zcG9ydHMvcG9sbGluZy5qcz9jZGFjIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFRyYW5zcG9ydCB9IGZyb20gXCIuLi90cmFuc3BvcnQuanNcIjtcbmltcG9ydCB7IHJhbmRvbVN0cmluZyB9IGZyb20gXCIuLi91dGlsLmpzXCI7XG5pbXBvcnQgeyBlbmNvZGVQYXlsb2FkLCBkZWNvZGVQYXlsb2FkIH0gZnJvbSBcImVuZ2luZS5pby1wYXJzZXJcIjtcbmV4cG9ydCBjbGFzcyBQb2xsaW5nIGV4dGVuZHMgVHJhbnNwb3J0IHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoLi4uYXJndW1lbnRzKTtcbiAgICAgICAgdGhpcy5fcG9sbGluZyA9IGZhbHNlO1xuICAgIH1cbiAgICBnZXQgbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIFwicG9sbGluZ1wiO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBPcGVucyB0aGUgc29ja2V0ICh0cmlnZ2VycyBwb2xsaW5nKS4gV2Ugd3JpdGUgYSBQSU5HIG1lc3NhZ2UgdG8gZGV0ZXJtaW5lXG4gICAgICogd2hlbiB0aGUgdHJhbnNwb3J0IGlzIG9wZW4uXG4gICAgICpcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgZG9PcGVuKCkge1xuICAgICAgICB0aGlzLl9wb2xsKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBhdXNlcyBwb2xsaW5nLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gb25QYXVzZSAtIGNhbGxiYWNrIHVwb24gYnVmZmVycyBhcmUgZmx1c2hlZCBhbmQgdHJhbnNwb3J0IGlzIHBhdXNlZFxuICAgICAqIEBwYWNrYWdlXG4gICAgICovXG4gICAgcGF1c2Uob25QYXVzZSkge1xuICAgICAgICB0aGlzLnJlYWR5U3RhdGUgPSBcInBhdXNpbmdcIjtcbiAgICAgICAgY29uc3QgcGF1c2UgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnJlYWR5U3RhdGUgPSBcInBhdXNlZFwiO1xuICAgICAgICAgICAgb25QYXVzZSgpO1xuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5fcG9sbGluZyB8fCAhdGhpcy53cml0YWJsZSkge1xuICAgICAgICAgICAgbGV0IHRvdGFsID0gMDtcbiAgICAgICAgICAgIGlmICh0aGlzLl9wb2xsaW5nKSB7XG4gICAgICAgICAgICAgICAgdG90YWwrKztcbiAgICAgICAgICAgICAgICB0aGlzLm9uY2UoXCJwb2xsQ29tcGxldGVcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAtLXRvdGFsIHx8IHBhdXNlKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXRoaXMud3JpdGFibGUpIHtcbiAgICAgICAgICAgICAgICB0b3RhbCsrO1xuICAgICAgICAgICAgICAgIHRoaXMub25jZShcImRyYWluXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgLS10b3RhbCB8fCBwYXVzZSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcGF1c2UoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdGFydHMgcG9sbGluZyBjeWNsZS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3BvbGwoKSB7XG4gICAgICAgIHRoaXMuX3BvbGxpbmcgPSB0cnVlO1xuICAgICAgICB0aGlzLmRvUG9sbCgpO1xuICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcInBvbGxcIik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE92ZXJsb2FkcyBvbkRhdGEgdG8gZGV0ZWN0IHBheWxvYWRzLlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIG9uRGF0YShkYXRhKSB7XG4gICAgICAgIGNvbnN0IGNhbGxiYWNrID0gKHBhY2tldCkgPT4ge1xuICAgICAgICAgICAgLy8gaWYgaXRzIHRoZSBmaXJzdCBtZXNzYWdlIHdlIGNvbnNpZGVyIHRoZSB0cmFuc3BvcnQgb3BlblxuICAgICAgICAgICAgaWYgKFwib3BlbmluZ1wiID09PSB0aGlzLnJlYWR5U3RhdGUgJiYgcGFja2V0LnR5cGUgPT09IFwib3BlblwiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbk9wZW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGlmIGl0cyBhIGNsb3NlIHBhY2tldCwgd2UgY2xvc2UgdGhlIG9uZ29pbmcgcmVxdWVzdHNcbiAgICAgICAgICAgIGlmIChcImNsb3NlXCIgPT09IHBhY2tldC50eXBlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbkNsb3NlKHsgZGVzY3JpcHRpb246IFwidHJhbnNwb3J0IGNsb3NlZCBieSB0aGUgc2VydmVyXCIgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gb3RoZXJ3aXNlIGJ5cGFzcyBvbkRhdGEgYW5kIGhhbmRsZSB0aGUgbWVzc2FnZVxuICAgICAgICAgICAgdGhpcy5vblBhY2tldChwYWNrZXQpO1xuICAgICAgICB9O1xuICAgICAgICAvLyBkZWNvZGUgcGF5bG9hZFxuICAgICAgICBkZWNvZGVQYXlsb2FkKGRhdGEsIHRoaXMuc29ja2V0LmJpbmFyeVR5cGUpLmZvckVhY2goY2FsbGJhY2spO1xuICAgICAgICAvLyBpZiBhbiBldmVudCBkaWQgbm90IHRyaWdnZXIgY2xvc2luZ1xuICAgICAgICBpZiAoXCJjbG9zZWRcIiAhPT0gdGhpcy5yZWFkeVN0YXRlKSB7XG4gICAgICAgICAgICAvLyBpZiB3ZSBnb3QgZGF0YSB3ZSdyZSBub3QgcG9sbGluZ1xuICAgICAgICAgICAgdGhpcy5fcG9sbGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJwb2xsQ29tcGxldGVcIik7XG4gICAgICAgICAgICBpZiAoXCJvcGVuXCIgPT09IHRoaXMucmVhZHlTdGF0ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3BvbGwoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZvciBwb2xsaW5nLCBzZW5kIGEgY2xvc2UgcGFja2V0LlxuICAgICAqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIGRvQ2xvc2UoKSB7XG4gICAgICAgIGNvbnN0IGNsb3NlID0gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy53cml0ZShbeyB0eXBlOiBcImNsb3NlXCIgfV0pO1xuICAgICAgICB9O1xuICAgICAgICBpZiAoXCJvcGVuXCIgPT09IHRoaXMucmVhZHlTdGF0ZSkge1xuICAgICAgICAgICAgY2xvc2UoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIGluIGNhc2Ugd2UncmUgdHJ5aW5nIHRvIGNsb3NlIHdoaWxlXG4gICAgICAgICAgICAvLyBoYW5kc2hha2luZyBpcyBpbiBwcm9ncmVzcyAoR0gtMTY0KVxuICAgICAgICAgICAgdGhpcy5vbmNlKFwib3BlblwiLCBjbG9zZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogV3JpdGVzIGEgcGFja2V0cyBwYXlsb2FkLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtBcnJheX0gcGFja2V0cyAtIGRhdGEgcGFja2V0c1xuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICB3cml0ZShwYWNrZXRzKSB7XG4gICAgICAgIHRoaXMud3JpdGFibGUgPSBmYWxzZTtcbiAgICAgICAgZW5jb2RlUGF5bG9hZChwYWNrZXRzLCAoZGF0YSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kb1dyaXRlKGRhdGEsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLndyaXRhYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcImRyYWluXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZW5lcmF0ZXMgdXJpIGZvciBjb25uZWN0aW9uLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICB1cmkoKSB7XG4gICAgICAgIGNvbnN0IHNjaGVtYSA9IHRoaXMub3B0cy5zZWN1cmUgPyBcImh0dHBzXCIgOiBcImh0dHBcIjtcbiAgICAgICAgY29uc3QgcXVlcnkgPSB0aGlzLnF1ZXJ5IHx8IHt9O1xuICAgICAgICAvLyBjYWNoZSBidXN0aW5nIGlzIGZvcmNlZFxuICAgICAgICBpZiAoZmFsc2UgIT09IHRoaXMub3B0cy50aW1lc3RhbXBSZXF1ZXN0cykge1xuICAgICAgICAgICAgcXVlcnlbdGhpcy5vcHRzLnRpbWVzdGFtcFBhcmFtXSA9IHJhbmRvbVN0cmluZygpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5zdXBwb3J0c0JpbmFyeSAmJiAhcXVlcnkuc2lkKSB7XG4gICAgICAgICAgICBxdWVyeS5iNjQgPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZVVyaShzY2hlbWEsIHF1ZXJ5KTtcbiAgICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/polling.js\n')},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/websocket.js":
/*!*******************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/websocket.js ***!
  \*******************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BaseWS: () => (/* binding */ BaseWS),\n/* harmony export */   WS: () => (/* binding */ WS)\n/* harmony export */ });\n/* harmony import */ var _transport_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../transport.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transport.js");\n/* harmony import */ var _util_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../util.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/util.js");\n/* harmony import */ var engine_io_parser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! engine.io-parser */ "./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/index.js");\n/* harmony import */ var _globals_node_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../globals.node.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/globals.js");\n\n\n\n\n// detect ReactNative environment\nconst isReactNative = typeof navigator !== "undefined" &&\n    typeof navigator.product === "string" &&\n    navigator.product.toLowerCase() === "reactnative";\nclass BaseWS extends _transport_js__WEBPACK_IMPORTED_MODULE_0__.Transport {\n    get name() {\n        return "websocket";\n    }\n    doOpen() {\n        const uri = this.uri();\n        const protocols = this.opts.protocols;\n        // React Native only supports the \'headers\' option, and will print a warning if anything else is passed\n        const opts = isReactNative\n            ? {}\n            : (0,_util_js__WEBPACK_IMPORTED_MODULE_1__.pick)(this.opts, "agent", "perMessageDeflate", "pfx", "key", "passphrase", "cert", "ca", "ciphers", "rejectUnauthorized", "localAddress", "protocolVersion", "origin", "maxPayload", "family", "checkServerIdentity");\n        if (this.opts.extraHeaders) {\n            opts.headers = this.opts.extraHeaders;\n        }\n        try {\n            this.ws = this.createSocket(uri, protocols, opts);\n        }\n        catch (err) {\n            return this.emitReserved("error", err);\n        }\n        this.ws.binaryType = this.socket.binaryType;\n        this.addEventListeners();\n    }\n    /**\n     * Adds event listeners to the socket\n     *\n     * @private\n     */\n    addEventListeners() {\n        this.ws.onopen = () => {\n            if (this.opts.autoUnref) {\n                this.ws._socket.unref();\n            }\n            this.onOpen();\n        };\n        this.ws.onclose = (closeEvent) => this.onClose({\n            description: "websocket connection closed",\n            context: closeEvent,\n        });\n        this.ws.onmessage = (ev) => this.onData(ev.data);\n        this.ws.onerror = (e) => this.onError("websocket error", e);\n    }\n    write(packets) {\n        this.writable = false;\n        // encodePacket efficient as it uses WS framing\n        // no need for encodePayload\n        for (let i = 0; i < packets.length; i++) {\n            const packet = packets[i];\n            const lastPacket = i === packets.length - 1;\n            (0,engine_io_parser__WEBPACK_IMPORTED_MODULE_2__.encodePacket)(packet, this.supportsBinary, (data) => {\n                // Sometimes the websocket has already been closed but the browser didn\'t\n                // have a chance of informing us about it yet, in that case send will\n                // throw an error\n                try {\n                    this.doWrite(packet, data);\n                }\n                catch (e) {\n                }\n                if (lastPacket) {\n                    // fake drain\n                    // defer to next tick to allow Socket to clear writeBuffer\n                    (0,_globals_node_js__WEBPACK_IMPORTED_MODULE_3__.nextTick)(() => {\n                        this.writable = true;\n                        this.emitReserved("drain");\n                    }, this.setTimeoutFn);\n                }\n            });\n        }\n    }\n    doClose() {\n        if (typeof this.ws !== "undefined") {\n            this.ws.onerror = () => { };\n            this.ws.close();\n            this.ws = null;\n        }\n    }\n    /**\n     * Generates uri for connection.\n     *\n     * @private\n     */\n    uri() {\n        const schema = this.opts.secure ? "wss" : "ws";\n        const query = this.query || {};\n        // append timestamp to URI\n        if (this.opts.timestampRequests) {\n            query[this.opts.timestampParam] = (0,_util_js__WEBPACK_IMPORTED_MODULE_1__.randomString)();\n        }\n        // communicate binary support capabilities\n        if (!this.supportsBinary) {\n            query.b64 = 1;\n        }\n        return this.createUri(schema, query);\n    }\n}\nconst WebSocketCtor = _globals_node_js__WEBPACK_IMPORTED_MODULE_3__.globalThisShim.WebSocket || _globals_node_js__WEBPACK_IMPORTED_MODULE_3__.globalThisShim.MozWebSocket;\n/**\n * WebSocket transport based on the built-in `WebSocket` object.\n *\n * Usage: browser, Node.js (since v21), Deno, Bun\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/WebSocket\n * @see https://caniuse.com/mdn-api_websocket\n * @see https://nodejs.org/api/globals.html#websocket\n */\nclass WS extends BaseWS {\n    createSocket(uri, protocols, opts) {\n        return !isReactNative\n            ? protocols\n                ? new WebSocketCtor(uri, protocols)\n                : new WebSocketCtor(uri)\n            : new WebSocketCtor(uri, protocols, opts);\n    }\n    doWrite(_packet, data) {\n        this.ws.send(data);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdHJhbnNwb3J0cy93ZWJzb2NrZXQuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQTRDO0FBQ0k7QUFDQTtBQUM0QjtBQUM1RTtBQUNBO0FBQ0E7QUFDQTtBQUNPLHFCQUFxQixvREFBUztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLDhDQUFJO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixvQkFBb0I7QUFDNUM7QUFDQTtBQUNBLFlBQVksOERBQVk7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQiwwREFBUTtBQUM1QjtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLHNEQUFZO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsNERBQVUsY0FBYyw0REFBVTtBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdHJhbnNwb3J0cy93ZWJzb2NrZXQuanM/YzQ2MCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUcmFuc3BvcnQgfSBmcm9tIFwiLi4vdHJhbnNwb3J0LmpzXCI7XG5pbXBvcnQgeyBwaWNrLCByYW5kb21TdHJpbmcgfSBmcm9tIFwiLi4vdXRpbC5qc1wiO1xuaW1wb3J0IHsgZW5jb2RlUGFja2V0IH0gZnJvbSBcImVuZ2luZS5pby1wYXJzZXJcIjtcbmltcG9ydCB7IGdsb2JhbFRoaXNTaGltIGFzIGdsb2JhbFRoaXMsIG5leHRUaWNrIH0gZnJvbSBcIi4uL2dsb2JhbHMubm9kZS5qc1wiO1xuLy8gZGV0ZWN0IFJlYWN0TmF0aXZlIGVudmlyb25tZW50XG5jb25zdCBpc1JlYWN0TmF0aXZlID0gdHlwZW9mIG5hdmlnYXRvciAhPT0gXCJ1bmRlZmluZWRcIiAmJlxuICAgIHR5cGVvZiBuYXZpZ2F0b3IucHJvZHVjdCA9PT0gXCJzdHJpbmdcIiAmJlxuICAgIG5hdmlnYXRvci5wcm9kdWN0LnRvTG93ZXJDYXNlKCkgPT09IFwicmVhY3RuYXRpdmVcIjtcbmV4cG9ydCBjbGFzcyBCYXNlV1MgZXh0ZW5kcyBUcmFuc3BvcnQge1xuICAgIGdldCBuYW1lKCkge1xuICAgICAgICByZXR1cm4gXCJ3ZWJzb2NrZXRcIjtcbiAgICB9XG4gICAgZG9PcGVuKCkge1xuICAgICAgICBjb25zdCB1cmkgPSB0aGlzLnVyaSgpO1xuICAgICAgICBjb25zdCBwcm90b2NvbHMgPSB0aGlzLm9wdHMucHJvdG9jb2xzO1xuICAgICAgICAvLyBSZWFjdCBOYXRpdmUgb25seSBzdXBwb3J0cyB0aGUgJ2hlYWRlcnMnIG9wdGlvbiwgYW5kIHdpbGwgcHJpbnQgYSB3YXJuaW5nIGlmIGFueXRoaW5nIGVsc2UgaXMgcGFzc2VkXG4gICAgICAgIGNvbnN0IG9wdHMgPSBpc1JlYWN0TmF0aXZlXG4gICAgICAgICAgICA/IHt9XG4gICAgICAgICAgICA6IHBpY2sodGhpcy5vcHRzLCBcImFnZW50XCIsIFwicGVyTWVzc2FnZURlZmxhdGVcIiwgXCJwZnhcIiwgXCJrZXlcIiwgXCJwYXNzcGhyYXNlXCIsIFwiY2VydFwiLCBcImNhXCIsIFwiY2lwaGVyc1wiLCBcInJlamVjdFVuYXV0aG9yaXplZFwiLCBcImxvY2FsQWRkcmVzc1wiLCBcInByb3RvY29sVmVyc2lvblwiLCBcIm9yaWdpblwiLCBcIm1heFBheWxvYWRcIiwgXCJmYW1pbHlcIiwgXCJjaGVja1NlcnZlcklkZW50aXR5XCIpO1xuICAgICAgICBpZiAodGhpcy5vcHRzLmV4dHJhSGVhZGVycykge1xuICAgICAgICAgICAgb3B0cy5oZWFkZXJzID0gdGhpcy5vcHRzLmV4dHJhSGVhZGVycztcbiAgICAgICAgfVxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdGhpcy53cyA9IHRoaXMuY3JlYXRlU29ja2V0KHVyaSwgcHJvdG9jb2xzLCBvcHRzKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5lbWl0UmVzZXJ2ZWQoXCJlcnJvclwiLCBlcnIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMud3MuYmluYXJ5VHlwZSA9IHRoaXMuc29ja2V0LmJpbmFyeVR5cGU7XG4gICAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyBldmVudCBsaXN0ZW5lcnMgdG8gdGhlIHNvY2tldFxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBhZGRFdmVudExpc3RlbmVycygpIHtcbiAgICAgICAgdGhpcy53cy5vbm9wZW4gPSAoKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5vcHRzLmF1dG9VbnJlZikge1xuICAgICAgICAgICAgICAgIHRoaXMud3MuX3NvY2tldC51bnJlZigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5vbk9wZW4oKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy53cy5vbmNsb3NlID0gKGNsb3NlRXZlbnQpID0+IHRoaXMub25DbG9zZSh7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJ3ZWJzb2NrZXQgY29ubmVjdGlvbiBjbG9zZWRcIixcbiAgICAgICAgICAgIGNvbnRleHQ6IGNsb3NlRXZlbnQsXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLndzLm9ubWVzc2FnZSA9IChldikgPT4gdGhpcy5vbkRhdGEoZXYuZGF0YSk7XG4gICAgICAgIHRoaXMud3Mub25lcnJvciA9IChlKSA9PiB0aGlzLm9uRXJyb3IoXCJ3ZWJzb2NrZXQgZXJyb3JcIiwgZSk7XG4gICAgfVxuICAgIHdyaXRlKHBhY2tldHMpIHtcbiAgICAgICAgdGhpcy53cml0YWJsZSA9IGZhbHNlO1xuICAgICAgICAvLyBlbmNvZGVQYWNrZXQgZWZmaWNpZW50IGFzIGl0IHVzZXMgV1MgZnJhbWluZ1xuICAgICAgICAvLyBubyBuZWVkIGZvciBlbmNvZGVQYXlsb2FkXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFja2V0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgcGFja2V0ID0gcGFja2V0c1tpXTtcbiAgICAgICAgICAgIGNvbnN0IGxhc3RQYWNrZXQgPSBpID09PSBwYWNrZXRzLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICBlbmNvZGVQYWNrZXQocGFja2V0LCB0aGlzLnN1cHBvcnRzQmluYXJ5LCAoZGF0YSkgPT4ge1xuICAgICAgICAgICAgICAgIC8vIFNvbWV0aW1lcyB0aGUgd2Vic29ja2V0IGhhcyBhbHJlYWR5IGJlZW4gY2xvc2VkIGJ1dCB0aGUgYnJvd3NlciBkaWRuJ3RcbiAgICAgICAgICAgICAgICAvLyBoYXZlIGEgY2hhbmNlIG9mIGluZm9ybWluZyB1cyBhYm91dCBpdCB5ZXQsIGluIHRoYXQgY2FzZSBzZW5kIHdpbGxcbiAgICAgICAgICAgICAgICAvLyB0aHJvdyBhbiBlcnJvclxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZG9Xcml0ZShwYWNrZXQsIGRhdGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobGFzdFBhY2tldCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBmYWtlIGRyYWluXG4gICAgICAgICAgICAgICAgICAgIC8vIGRlZmVyIHRvIG5leHQgdGljayB0byBhbGxvdyBTb2NrZXQgdG8gY2xlYXIgd3JpdGVCdWZmZXJcbiAgICAgICAgICAgICAgICAgICAgbmV4dFRpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy53cml0YWJsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcImRyYWluXCIpO1xuICAgICAgICAgICAgICAgICAgICB9LCB0aGlzLnNldFRpbWVvdXRGbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZG9DbG9zZSgpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLndzICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICB0aGlzLndzLm9uZXJyb3IgPSAoKSA9PiB7IH07XG4gICAgICAgICAgICB0aGlzLndzLmNsb3NlKCk7XG4gICAgICAgICAgICB0aGlzLndzID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZW5lcmF0ZXMgdXJpIGZvciBjb25uZWN0aW9uLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICB1cmkoKSB7XG4gICAgICAgIGNvbnN0IHNjaGVtYSA9IHRoaXMub3B0cy5zZWN1cmUgPyBcIndzc1wiIDogXCJ3c1wiO1xuICAgICAgICBjb25zdCBxdWVyeSA9IHRoaXMucXVlcnkgfHwge307XG4gICAgICAgIC8vIGFwcGVuZCB0aW1lc3RhbXAgdG8gVVJJXG4gICAgICAgIGlmICh0aGlzLm9wdHMudGltZXN0YW1wUmVxdWVzdHMpIHtcbiAgICAgICAgICAgIHF1ZXJ5W3RoaXMub3B0cy50aW1lc3RhbXBQYXJhbV0gPSByYW5kb21TdHJpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBjb21tdW5pY2F0ZSBiaW5hcnkgc3VwcG9ydCBjYXBhYmlsaXRpZXNcbiAgICAgICAgaWYgKCF0aGlzLnN1cHBvcnRzQmluYXJ5KSB7XG4gICAgICAgICAgICBxdWVyeS5iNjQgPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZVVyaShzY2hlbWEsIHF1ZXJ5KTtcbiAgICB9XG59XG5jb25zdCBXZWJTb2NrZXRDdG9yID0gZ2xvYmFsVGhpcy5XZWJTb2NrZXQgfHwgZ2xvYmFsVGhpcy5Nb3pXZWJTb2NrZXQ7XG4vKipcbiAqIFdlYlNvY2tldCB0cmFuc3BvcnQgYmFzZWQgb24gdGhlIGJ1aWx0LWluIGBXZWJTb2NrZXRgIG9iamVjdC5cbiAqXG4gKiBVc2FnZTogYnJvd3NlciwgTm9kZS5qcyAoc2luY2UgdjIxKSwgRGVubywgQnVuXG4gKlxuICogQHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvV2ViU29ja2V0XG4gKiBAc2VlIGh0dHBzOi8vY2FuaXVzZS5jb20vbWRuLWFwaV93ZWJzb2NrZXRcbiAqIEBzZWUgaHR0cHM6Ly9ub2RlanMub3JnL2FwaS9nbG9iYWxzLmh0bWwjd2Vic29ja2V0XG4gKi9cbmV4cG9ydCBjbGFzcyBXUyBleHRlbmRzIEJhc2VXUyB7XG4gICAgY3JlYXRlU29ja2V0KHVyaSwgcHJvdG9jb2xzLCBvcHRzKSB7XG4gICAgICAgIHJldHVybiAhaXNSZWFjdE5hdGl2ZVxuICAgICAgICAgICAgPyBwcm90b2NvbHNcbiAgICAgICAgICAgICAgICA/IG5ldyBXZWJTb2NrZXRDdG9yKHVyaSwgcHJvdG9jb2xzKVxuICAgICAgICAgICAgICAgIDogbmV3IFdlYlNvY2tldEN0b3IodXJpKVxuICAgICAgICAgICAgOiBuZXcgV2ViU29ja2V0Q3Rvcih1cmksIHByb3RvY29scywgb3B0cyk7XG4gICAgfVxuICAgIGRvV3JpdGUoX3BhY2tldCwgZGF0YSkge1xuICAgICAgICB0aGlzLndzLnNlbmQoZGF0YSk7XG4gICAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/websocket.js\n')},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/webtransport.js":
/*!**********************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/webtransport.js ***!
  \**********************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   WT: () => (/* binding */ WT)\n/* harmony export */ });\n/* harmony import */ var _transport_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../transport.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transport.js");\n/* harmony import */ var _globals_node_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../globals.node.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/globals.js");\n/* harmony import */ var engine_io_parser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! engine.io-parser */ "./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/index.js");\n\n\n\n/**\n * WebTransport transport based on the built-in `WebTransport` object.\n *\n * Usage: browser, Node.js (with the `@fails-components/webtransport` package)\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/WebTransport\n * @see https://caniuse.com/webtransport\n */\nclass WT extends _transport_js__WEBPACK_IMPORTED_MODULE_0__.Transport {\n    get name() {\n        return "webtransport";\n    }\n    doOpen() {\n        try {\n            // @ts-ignore\n            this._transport = new WebTransport(this.createUri("https"), this.opts.transportOptions[this.name]);\n        }\n        catch (err) {\n            return this.emitReserved("error", err);\n        }\n        this._transport.closed\n            .then(() => {\n            this.onClose();\n        })\n            .catch((err) => {\n            this.onError("webtransport error", err);\n        });\n        // note: we could have used async/await, but that would require some additional polyfills\n        this._transport.ready.then(() => {\n            this._transport.createBidirectionalStream().then((stream) => {\n                const decoderStream = (0,engine_io_parser__WEBPACK_IMPORTED_MODULE_2__.createPacketDecoderStream)(Number.MAX_SAFE_INTEGER, this.socket.binaryType);\n                const reader = stream.readable.pipeThrough(decoderStream).getReader();\n                const encoderStream = (0,engine_io_parser__WEBPACK_IMPORTED_MODULE_2__.createPacketEncoderStream)();\n                encoderStream.readable.pipeTo(stream.writable);\n                this._writer = encoderStream.writable.getWriter();\n                const read = () => {\n                    reader\n                        .read()\n                        .then(({ done, value }) => {\n                        if (done) {\n                            return;\n                        }\n                        this.onPacket(value);\n                        read();\n                    })\n                        .catch((err) => {\n                    });\n                };\n                read();\n                const packet = { type: "open" };\n                if (this.query.sid) {\n                    packet.data = `{"sid":"${this.query.sid}"}`;\n                }\n                this._writer.write(packet).then(() => this.onOpen());\n            });\n        });\n    }\n    write(packets) {\n        this.writable = false;\n        for (let i = 0; i < packets.length; i++) {\n            const packet = packets[i];\n            const lastPacket = i === packets.length - 1;\n            this._writer.write(packet).then(() => {\n                if (lastPacket) {\n                    (0,_globals_node_js__WEBPACK_IMPORTED_MODULE_1__.nextTick)(() => {\n                        this.writable = true;\n                        this.emitReserved("drain");\n                    }, this.setTimeoutFn);\n                }\n            });\n        }\n    }\n    doClose() {\n        var _a;\n        (_a = this._transport) === null || _a === void 0 ? void 0 : _a.close();\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdHJhbnNwb3J0cy93ZWJ0cmFuc3BvcnQuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUE0QztBQUNFO0FBQzJDO0FBQ3pGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTyxpQkFBaUIsb0RBQVM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQywyRUFBeUI7QUFDL0Q7QUFDQSxzQ0FBc0MsMkVBQXlCO0FBQy9EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsYUFBYTtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQSxvQ0FBb0MsU0FBUyxlQUFlLEVBQUU7QUFDOUQ7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLG9CQUFvQjtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQiwwREFBUTtBQUM1QjtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2VuZ2luZS5pby1jbGllbnRANi42LjMvbm9kZV9tb2R1bGVzL2VuZ2luZS5pby1jbGllbnQvYnVpbGQvZXNtL3RyYW5zcG9ydHMvd2VidHJhbnNwb3J0LmpzPzIzMzUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVHJhbnNwb3J0IH0gZnJvbSBcIi4uL3RyYW5zcG9ydC5qc1wiO1xuaW1wb3J0IHsgbmV4dFRpY2sgfSBmcm9tIFwiLi4vZ2xvYmFscy5ub2RlLmpzXCI7XG5pbXBvcnQgeyBjcmVhdGVQYWNrZXREZWNvZGVyU3RyZWFtLCBjcmVhdGVQYWNrZXRFbmNvZGVyU3RyZWFtLCB9IGZyb20gXCJlbmdpbmUuaW8tcGFyc2VyXCI7XG4vKipcbiAqIFdlYlRyYW5zcG9ydCB0cmFuc3BvcnQgYmFzZWQgb24gdGhlIGJ1aWx0LWluIGBXZWJUcmFuc3BvcnRgIG9iamVjdC5cbiAqXG4gKiBVc2FnZTogYnJvd3NlciwgTm9kZS5qcyAod2l0aCB0aGUgYEBmYWlscy1jb21wb25lbnRzL3dlYnRyYW5zcG9ydGAgcGFja2FnZSlcbiAqXG4gKiBAc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9XZWJUcmFuc3BvcnRcbiAqIEBzZWUgaHR0cHM6Ly9jYW5pdXNlLmNvbS93ZWJ0cmFuc3BvcnRcbiAqL1xuZXhwb3J0IGNsYXNzIFdUIGV4dGVuZHMgVHJhbnNwb3J0IHtcbiAgICBnZXQgbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIFwid2VidHJhbnNwb3J0XCI7XG4gICAgfVxuICAgIGRvT3BlbigpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIHRoaXMuX3RyYW5zcG9ydCA9IG5ldyBXZWJUcmFuc3BvcnQodGhpcy5jcmVhdGVVcmkoXCJodHRwc1wiKSwgdGhpcy5vcHRzLnRyYW5zcG9ydE9wdGlvbnNbdGhpcy5uYW1lXSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZW1pdFJlc2VydmVkKFwiZXJyb3JcIiwgZXJyKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl90cmFuc3BvcnQuY2xvc2VkXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLm9uQ2xvc2UoKTtcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICB0aGlzLm9uRXJyb3IoXCJ3ZWJ0cmFuc3BvcnQgZXJyb3JcIiwgZXJyKTtcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIG5vdGU6IHdlIGNvdWxkIGhhdmUgdXNlZCBhc3luYy9hd2FpdCwgYnV0IHRoYXQgd291bGQgcmVxdWlyZSBzb21lIGFkZGl0aW9uYWwgcG9seWZpbGxzXG4gICAgICAgIHRoaXMuX3RyYW5zcG9ydC5yZWFkeS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX3RyYW5zcG9ydC5jcmVhdGVCaWRpcmVjdGlvbmFsU3RyZWFtKCkudGhlbigoc3RyZWFtKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZGVjb2RlclN0cmVhbSA9IGNyZWF0ZVBhY2tldERlY29kZXJTdHJlYW0oTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIsIHRoaXMuc29ja2V0LmJpbmFyeVR5cGUpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlYWRlciA9IHN0cmVhbS5yZWFkYWJsZS5waXBlVGhyb3VnaChkZWNvZGVyU3RyZWFtKS5nZXRSZWFkZXIoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBlbmNvZGVyU3RyZWFtID0gY3JlYXRlUGFja2V0RW5jb2RlclN0cmVhbSgpO1xuICAgICAgICAgICAgICAgIGVuY29kZXJTdHJlYW0ucmVhZGFibGUucGlwZVRvKHN0cmVhbS53cml0YWJsZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5fd3JpdGVyID0gZW5jb2RlclN0cmVhbS53cml0YWJsZS5nZXRXcml0ZXIoKTtcbiAgICAgICAgICAgICAgICBjb25zdCByZWFkID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZWFkZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yZWFkKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKCh7IGRvbmUsIHZhbHVlIH0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkb25lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vblBhY2tldCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWFkKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHJlYWQoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBwYWNrZXQgPSB7IHR5cGU6IFwib3BlblwiIH07XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucXVlcnkuc2lkKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhY2tldC5kYXRhID0gYHtcInNpZFwiOlwiJHt0aGlzLnF1ZXJ5LnNpZH1cIn1gO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLl93cml0ZXIud3JpdGUocGFja2V0KS50aGVuKCgpID0+IHRoaXMub25PcGVuKCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICB3cml0ZShwYWNrZXRzKSB7XG4gICAgICAgIHRoaXMud3JpdGFibGUgPSBmYWxzZTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYWNrZXRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBwYWNrZXQgPSBwYWNrZXRzW2ldO1xuICAgICAgICAgICAgY29uc3QgbGFzdFBhY2tldCA9IGkgPT09IHBhY2tldHMubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgIHRoaXMuX3dyaXRlci53cml0ZShwYWNrZXQpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChsYXN0UGFja2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIG5leHRUaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMud3JpdGFibGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJkcmFpblwiKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgdGhpcy5zZXRUaW1lb3V0Rm4pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGRvQ2xvc2UoKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgKF9hID0gdGhpcy5fdHJhbnNwb3J0KSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuY2xvc2UoKTtcbiAgICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/transports/webtransport.js\n')},"./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/util.js":
/*!***************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/util.js ***!
  \***************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   byteLength: () => (/* binding */ byteLength),\n/* harmony export */   installTimerFunctions: () => (/* binding */ installTimerFunctions),\n/* harmony export */   pick: () => (/* binding */ pick),\n/* harmony export */   randomString: () => (/* binding */ randomString)\n/* harmony export */ });\n/* harmony import */ var _globals_node_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./globals.node.js */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/globals.js");\n\nfunction pick(obj, ...attr) {\n    return attr.reduce((acc, k) => {\n        if (obj.hasOwnProperty(k)) {\n            acc[k] = obj[k];\n        }\n        return acc;\n    }, {});\n}\n// Keep a reference to the real timeout functions so they can be used when overridden\nconst NATIVE_SET_TIMEOUT = _globals_node_js__WEBPACK_IMPORTED_MODULE_0__.globalThisShim.setTimeout;\nconst NATIVE_CLEAR_TIMEOUT = _globals_node_js__WEBPACK_IMPORTED_MODULE_0__.globalThisShim.clearTimeout;\nfunction installTimerFunctions(obj, opts) {\n    if (opts.useNativeTimers) {\n        obj.setTimeoutFn = NATIVE_SET_TIMEOUT.bind(_globals_node_js__WEBPACK_IMPORTED_MODULE_0__.globalThisShim);\n        obj.clearTimeoutFn = NATIVE_CLEAR_TIMEOUT.bind(_globals_node_js__WEBPACK_IMPORTED_MODULE_0__.globalThisShim);\n    }\n    else {\n        obj.setTimeoutFn = _globals_node_js__WEBPACK_IMPORTED_MODULE_0__.globalThisShim.setTimeout.bind(_globals_node_js__WEBPACK_IMPORTED_MODULE_0__.globalThisShim);\n        obj.clearTimeoutFn = _globals_node_js__WEBPACK_IMPORTED_MODULE_0__.globalThisShim.clearTimeout.bind(_globals_node_js__WEBPACK_IMPORTED_MODULE_0__.globalThisShim);\n    }\n}\n// base64 encoded buffers are about 33% bigger (https://en.wikipedia.org/wiki/Base64)\nconst BASE64_OVERHEAD = 1.33;\n// we could also have used `new Blob([obj]).size`, but it isn\'t supported in IE9\nfunction byteLength(obj) {\n    if (typeof obj === "string") {\n        return utf8Length(obj);\n    }\n    // arraybuffer or blob\n    return Math.ceil((obj.byteLength || obj.size) * BASE64_OVERHEAD);\n}\nfunction utf8Length(str) {\n    let c = 0, length = 0;\n    for (let i = 0, l = str.length; i < l; i++) {\n        c = str.charCodeAt(i);\n        if (c < 0x80) {\n            length += 1;\n        }\n        else if (c < 0x800) {\n            length += 2;\n        }\n        else if (c < 0xd800 || c >= 0xe000) {\n            length += 3;\n        }\n        else {\n            i++;\n            length += 4;\n        }\n    }\n    return length;\n}\n/**\n * Generates a random 8-characters string.\n */\nfunction randomString() {\n    return (Date.now().toString(36).substring(3) +\n        Math.random().toString(36).substring(2, 5));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdXRpbC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFpRTtBQUMxRDtBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLLElBQUk7QUFDVDtBQUNBO0FBQ0EsMkJBQTJCLDREQUFVO0FBQ3JDLDZCQUE2Qiw0REFBVTtBQUNoQztBQUNQO0FBQ0EsbURBQW1ELDREQUFVO0FBQzdELHVEQUF1RCw0REFBVTtBQUNqRTtBQUNBO0FBQ0EsMkJBQTJCLDREQUFVLGlCQUFpQiw0REFBVTtBQUNoRSw2QkFBNkIsNERBQVUsbUJBQW1CLDREQUFVO0FBQ3BFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsT0FBTztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLWNsaWVudEA2LjYuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLWNsaWVudC9idWlsZC9lc20vdXRpbC5qcz82MmEyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdsb2JhbFRoaXNTaGltIGFzIGdsb2JhbFRoaXMgfSBmcm9tIFwiLi9nbG9iYWxzLm5vZGUuanNcIjtcbmV4cG9ydCBmdW5jdGlvbiBwaWNrKG9iaiwgLi4uYXR0cikge1xuICAgIHJldHVybiBhdHRyLnJlZHVjZSgoYWNjLCBrKSA9PiB7XG4gICAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoaykpIHtcbiAgICAgICAgICAgIGFjY1trXSA9IG9ialtrXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYWNjO1xuICAgIH0sIHt9KTtcbn1cbi8vIEtlZXAgYSByZWZlcmVuY2UgdG8gdGhlIHJlYWwgdGltZW91dCBmdW5jdGlvbnMgc28gdGhleSBjYW4gYmUgdXNlZCB3aGVuIG92ZXJyaWRkZW5cbmNvbnN0IE5BVElWRV9TRVRfVElNRU9VVCA9IGdsb2JhbFRoaXMuc2V0VGltZW91dDtcbmNvbnN0IE5BVElWRV9DTEVBUl9USU1FT1VUID0gZ2xvYmFsVGhpcy5jbGVhclRpbWVvdXQ7XG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbFRpbWVyRnVuY3Rpb25zKG9iaiwgb3B0cykge1xuICAgIGlmIChvcHRzLnVzZU5hdGl2ZVRpbWVycykge1xuICAgICAgICBvYmouc2V0VGltZW91dEZuID0gTkFUSVZFX1NFVF9USU1FT1VULmJpbmQoZ2xvYmFsVGhpcyk7XG4gICAgICAgIG9iai5jbGVhclRpbWVvdXRGbiA9IE5BVElWRV9DTEVBUl9USU1FT1VULmJpbmQoZ2xvYmFsVGhpcyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBvYmouc2V0VGltZW91dEZuID0gZ2xvYmFsVGhpcy5zZXRUaW1lb3V0LmJpbmQoZ2xvYmFsVGhpcyk7XG4gICAgICAgIG9iai5jbGVhclRpbWVvdXRGbiA9IGdsb2JhbFRoaXMuY2xlYXJUaW1lb3V0LmJpbmQoZ2xvYmFsVGhpcyk7XG4gICAgfVxufVxuLy8gYmFzZTY0IGVuY29kZWQgYnVmZmVycyBhcmUgYWJvdXQgMzMlIGJpZ2dlciAoaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQmFzZTY0KVxuY29uc3QgQkFTRTY0X09WRVJIRUFEID0gMS4zMztcbi8vIHdlIGNvdWxkIGFsc28gaGF2ZSB1c2VkIGBuZXcgQmxvYihbb2JqXSkuc2l6ZWAsIGJ1dCBpdCBpc24ndCBzdXBwb3J0ZWQgaW4gSUU5XG5leHBvcnQgZnVuY3Rpb24gYnl0ZUxlbmd0aChvYmopIHtcbiAgICBpZiAodHlwZW9mIG9iaiA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICByZXR1cm4gdXRmOExlbmd0aChvYmopO1xuICAgIH1cbiAgICAvLyBhcnJheWJ1ZmZlciBvciBibG9iXG4gICAgcmV0dXJuIE1hdGguY2VpbCgob2JqLmJ5dGVMZW5ndGggfHwgb2JqLnNpemUpICogQkFTRTY0X09WRVJIRUFEKTtcbn1cbmZ1bmN0aW9uIHV0ZjhMZW5ndGgoc3RyKSB7XG4gICAgbGV0IGMgPSAwLCBsZW5ndGggPSAwO1xuICAgIGZvciAobGV0IGkgPSAwLCBsID0gc3RyLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICBjID0gc3RyLmNoYXJDb2RlQXQoaSk7XG4gICAgICAgIGlmIChjIDwgMHg4MCkge1xuICAgICAgICAgICAgbGVuZ3RoICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoYyA8IDB4ODAwKSB7XG4gICAgICAgICAgICBsZW5ndGggKz0gMjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjIDwgMHhkODAwIHx8IGMgPj0gMHhlMDAwKSB7XG4gICAgICAgICAgICBsZW5ndGggKz0gMztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgIGxlbmd0aCArPSA0O1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBsZW5ndGg7XG59XG4vKipcbiAqIEdlbmVyYXRlcyBhIHJhbmRvbSA4LWNoYXJhY3RlcnMgc3RyaW5nLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcmFuZG9tU3RyaW5nKCkge1xuICAgIHJldHVybiAoRGF0ZS5ub3coKS50b1N0cmluZygzNikuc3Vic3RyaW5nKDMpICtcbiAgICAgICAgTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyaW5nKDIsIDUpKTtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/util.js\n')},"./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/commons.js":
/*!******************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/commons.js ***!
  \******************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ERROR_PACKET: () => (/* binding */ ERROR_PACKET),\n/* harmony export */   PACKET_TYPES: () => (/* binding */ PACKET_TYPES),\n/* harmony export */   PACKET_TYPES_REVERSE: () => (/* binding */ PACKET_TYPES_REVERSE)\n/* harmony export */ });\nconst PACKET_TYPES = Object.create(null); // no Map = no polyfill\nPACKET_TYPES["open"] = "0";\nPACKET_TYPES["close"] = "1";\nPACKET_TYPES["ping"] = "2";\nPACKET_TYPES["pong"] = "3";\nPACKET_TYPES["message"] = "4";\nPACKET_TYPES["upgrade"] = "5";\nPACKET_TYPES["noop"] = "6";\nconst PACKET_TYPES_REVERSE = Object.create(null);\nObject.keys(PACKET_TYPES).forEach((key) => {\n    PACKET_TYPES_REVERSE[PACKET_TYPES[key]] = key;\n});\nconst ERROR_PACKET = { type: "error", data: "parser error" };\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLXBhcnNlckA1LjIuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLXBhcnNlci9idWlsZC9lc20vY29tbW9ucy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSwwQ0FBMEM7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsdUJBQXVCO0FBQ3FDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2VuZ2luZS5pby1wYXJzZXJANS4yLjMvbm9kZV9tb2R1bGVzL2VuZ2luZS5pby1wYXJzZXIvYnVpbGQvZXNtL2NvbW1vbnMuanM/ZmU0MyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBQQUNLRVRfVFlQRVMgPSBPYmplY3QuY3JlYXRlKG51bGwpOyAvLyBubyBNYXAgPSBubyBwb2x5ZmlsbFxuUEFDS0VUX1RZUEVTW1wib3BlblwiXSA9IFwiMFwiO1xuUEFDS0VUX1RZUEVTW1wiY2xvc2VcIl0gPSBcIjFcIjtcblBBQ0tFVF9UWVBFU1tcInBpbmdcIl0gPSBcIjJcIjtcblBBQ0tFVF9UWVBFU1tcInBvbmdcIl0gPSBcIjNcIjtcblBBQ0tFVF9UWVBFU1tcIm1lc3NhZ2VcIl0gPSBcIjRcIjtcblBBQ0tFVF9UWVBFU1tcInVwZ3JhZGVcIl0gPSBcIjVcIjtcblBBQ0tFVF9UWVBFU1tcIm5vb3BcIl0gPSBcIjZcIjtcbmNvbnN0IFBBQ0tFVF9UWVBFU19SRVZFUlNFID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbk9iamVjdC5rZXlzKFBBQ0tFVF9UWVBFUykuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgUEFDS0VUX1RZUEVTX1JFVkVSU0VbUEFDS0VUX1RZUEVTW2tleV1dID0ga2V5O1xufSk7XG5jb25zdCBFUlJPUl9QQUNLRVQgPSB7IHR5cGU6IFwiZXJyb3JcIiwgZGF0YTogXCJwYXJzZXIgZXJyb3JcIiB9O1xuZXhwb3J0IHsgUEFDS0VUX1RZUEVTLCBQQUNLRVRfVFlQRVNfUkVWRVJTRSwgRVJST1JfUEFDS0VUIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/commons.js\n')},"./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/contrib/base64-arraybuffer.js":
/*!*************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/contrib/base64-arraybuffer.js ***!
  \*************************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   decode: () => (/* binding */ decode),\n/* harmony export */   encode: () => (/* binding */ encode)\n/* harmony export */ });\n// imported from https://github.com/socketio/base64-arraybuffer\nconst chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n// Use a lookup table to find the index.\nconst lookup = typeof Uint8Array === 'undefined' ? [] : new Uint8Array(256);\nfor (let i = 0; i < chars.length; i++) {\n    lookup[chars.charCodeAt(i)] = i;\n}\nconst encode = (arraybuffer) => {\n    let bytes = new Uint8Array(arraybuffer), i, len = bytes.length, base64 = '';\n    for (i = 0; i < len; i += 3) {\n        base64 += chars[bytes[i] >> 2];\n        base64 += chars[((bytes[i] & 3) << 4) | (bytes[i + 1] >> 4)];\n        base64 += chars[((bytes[i + 1] & 15) << 2) | (bytes[i + 2] >> 6)];\n        base64 += chars[bytes[i + 2] & 63];\n    }\n    if (len % 3 === 2) {\n        base64 = base64.substring(0, base64.length - 1) + '=';\n    }\n    else if (len % 3 === 1) {\n        base64 = base64.substring(0, base64.length - 2) + '==';\n    }\n    return base64;\n};\nconst decode = (base64) => {\n    let bufferLength = base64.length * 0.75, len = base64.length, i, p = 0, encoded1, encoded2, encoded3, encoded4;\n    if (base64[base64.length - 1] === '=') {\n        bufferLength--;\n        if (base64[base64.length - 2] === '=') {\n            bufferLength--;\n        }\n    }\n    const arraybuffer = new ArrayBuffer(bufferLength), bytes = new Uint8Array(arraybuffer);\n    for (i = 0; i < len; i += 4) {\n        encoded1 = lookup[base64.charCodeAt(i)];\n        encoded2 = lookup[base64.charCodeAt(i + 1)];\n        encoded3 = lookup[base64.charCodeAt(i + 2)];\n        encoded4 = lookup[base64.charCodeAt(i + 3)];\n        bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);\n        bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);\n        bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);\n    }\n    return arraybuffer;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLXBhcnNlckA1LjIuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLXBhcnNlci9idWlsZC9lc20vY29udHJpYi9iYXNlNjQtYXJyYXlidWZmZXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixrQkFBa0I7QUFDbEM7QUFDQTtBQUNPO0FBQ1A7QUFDQSxnQkFBZ0IsU0FBUztBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixTQUFTO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2VuZ2luZS5pby1wYXJzZXJANS4yLjMvbm9kZV9tb2R1bGVzL2VuZ2luZS5pby1wYXJzZXIvYnVpbGQvZXNtL2NvbnRyaWIvYmFzZTY0LWFycmF5YnVmZmVyLmpzPzRiNTgiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gaW1wb3J0ZWQgZnJvbSBodHRwczovL2dpdGh1Yi5jb20vc29ja2V0aW8vYmFzZTY0LWFycmF5YnVmZmVyXG5jb25zdCBjaGFycyA9ICdBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvJztcbi8vIFVzZSBhIGxvb2t1cCB0YWJsZSB0byBmaW5kIHRoZSBpbmRleC5cbmNvbnN0IGxvb2t1cCA9IHR5cGVvZiBVaW50OEFycmF5ID09PSAndW5kZWZpbmVkJyA/IFtdIDogbmV3IFVpbnQ4QXJyYXkoMjU2KTtcbmZvciAobGV0IGkgPSAwOyBpIDwgY2hhcnMubGVuZ3RoOyBpKyspIHtcbiAgICBsb29rdXBbY2hhcnMuY2hhckNvZGVBdChpKV0gPSBpO1xufVxuZXhwb3J0IGNvbnN0IGVuY29kZSA9IChhcnJheWJ1ZmZlcikgPT4ge1xuICAgIGxldCBieXRlcyA9IG5ldyBVaW50OEFycmF5KGFycmF5YnVmZmVyKSwgaSwgbGVuID0gYnl0ZXMubGVuZ3RoLCBiYXNlNjQgPSAnJztcbiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpICs9IDMpIHtcbiAgICAgICAgYmFzZTY0ICs9IGNoYXJzW2J5dGVzW2ldID4+IDJdO1xuICAgICAgICBiYXNlNjQgKz0gY2hhcnNbKChieXRlc1tpXSAmIDMpIDw8IDQpIHwgKGJ5dGVzW2kgKyAxXSA+PiA0KV07XG4gICAgICAgIGJhc2U2NCArPSBjaGFyc1soKGJ5dGVzW2kgKyAxXSAmIDE1KSA8PCAyKSB8IChieXRlc1tpICsgMl0gPj4gNildO1xuICAgICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaSArIDJdICYgNjNdO1xuICAgIH1cbiAgICBpZiAobGVuICUgMyA9PT0gMikge1xuICAgICAgICBiYXNlNjQgPSBiYXNlNjQuc3Vic3RyaW5nKDAsIGJhc2U2NC5sZW5ndGggLSAxKSArICc9JztcbiAgICB9XG4gICAgZWxzZSBpZiAobGVuICUgMyA9PT0gMSkge1xuICAgICAgICBiYXNlNjQgPSBiYXNlNjQuc3Vic3RyaW5nKDAsIGJhc2U2NC5sZW5ndGggLSAyKSArICc9PSc7XG4gICAgfVxuICAgIHJldHVybiBiYXNlNjQ7XG59O1xuZXhwb3J0IGNvbnN0IGRlY29kZSA9IChiYXNlNjQpID0+IHtcbiAgICBsZXQgYnVmZmVyTGVuZ3RoID0gYmFzZTY0Lmxlbmd0aCAqIDAuNzUsIGxlbiA9IGJhc2U2NC5sZW5ndGgsIGksIHAgPSAwLCBlbmNvZGVkMSwgZW5jb2RlZDIsIGVuY29kZWQzLCBlbmNvZGVkNDtcbiAgICBpZiAoYmFzZTY0W2Jhc2U2NC5sZW5ndGggLSAxXSA9PT0gJz0nKSB7XG4gICAgICAgIGJ1ZmZlckxlbmd0aC0tO1xuICAgICAgICBpZiAoYmFzZTY0W2Jhc2U2NC5sZW5ndGggLSAyXSA9PT0gJz0nKSB7XG4gICAgICAgICAgICBidWZmZXJMZW5ndGgtLTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBhcnJheWJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcihidWZmZXJMZW5ndGgpLCBieXRlcyA9IG5ldyBVaW50OEFycmF5KGFycmF5YnVmZmVyKTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpICs9IDQpIHtcbiAgICAgICAgZW5jb2RlZDEgPSBsb29rdXBbYmFzZTY0LmNoYXJDb2RlQXQoaSldO1xuICAgICAgICBlbmNvZGVkMiA9IGxvb2t1cFtiYXNlNjQuY2hhckNvZGVBdChpICsgMSldO1xuICAgICAgICBlbmNvZGVkMyA9IGxvb2t1cFtiYXNlNjQuY2hhckNvZGVBdChpICsgMildO1xuICAgICAgICBlbmNvZGVkNCA9IGxvb2t1cFtiYXNlNjQuY2hhckNvZGVBdChpICsgMyldO1xuICAgICAgICBieXRlc1twKytdID0gKGVuY29kZWQxIDw8IDIpIHwgKGVuY29kZWQyID4+IDQpO1xuICAgICAgICBieXRlc1twKytdID0gKChlbmNvZGVkMiAmIDE1KSA8PCA0KSB8IChlbmNvZGVkMyA+PiAyKTtcbiAgICAgICAgYnl0ZXNbcCsrXSA9ICgoZW5jb2RlZDMgJiAzKSA8PCA2KSB8IChlbmNvZGVkNCAmIDYzKTtcbiAgICB9XG4gICAgcmV0dXJuIGFycmF5YnVmZmVyO1xufTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/contrib/base64-arraybuffer.js\n")},"./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/decodePacket.browser.js":
/*!*******************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/decodePacket.browser.js ***!
  \*******************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   decodePacket: () => (/* binding */ decodePacket)\n/* harmony export */ });\n/* harmony import */ var _commons_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./commons.js */ "./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/commons.js");\n/* harmony import */ var _contrib_base64_arraybuffer_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./contrib/base64-arraybuffer.js */ "./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/contrib/base64-arraybuffer.js");\n\n\nconst withNativeArrayBuffer = typeof ArrayBuffer === "function";\nconst decodePacket = (encodedPacket, binaryType) => {\n    if (typeof encodedPacket !== "string") {\n        return {\n            type: "message",\n            data: mapBinary(encodedPacket, binaryType),\n        };\n    }\n    const type = encodedPacket.charAt(0);\n    if (type === "b") {\n        return {\n            type: "message",\n            data: decodeBase64Packet(encodedPacket.substring(1), binaryType),\n        };\n    }\n    const packetType = _commons_js__WEBPACK_IMPORTED_MODULE_0__.PACKET_TYPES_REVERSE[type];\n    if (!packetType) {\n        return _commons_js__WEBPACK_IMPORTED_MODULE_0__.ERROR_PACKET;\n    }\n    return encodedPacket.length > 1\n        ? {\n            type: _commons_js__WEBPACK_IMPORTED_MODULE_0__.PACKET_TYPES_REVERSE[type],\n            data: encodedPacket.substring(1),\n        }\n        : {\n            type: _commons_js__WEBPACK_IMPORTED_MODULE_0__.PACKET_TYPES_REVERSE[type],\n        };\n};\nconst decodeBase64Packet = (data, binaryType) => {\n    if (withNativeArrayBuffer) {\n        const decoded = (0,_contrib_base64_arraybuffer_js__WEBPACK_IMPORTED_MODULE_1__.decode)(data);\n        return mapBinary(decoded, binaryType);\n    }\n    else {\n        return { base64: true, data }; // fallback for old browsers\n    }\n};\nconst mapBinary = (data, binaryType) => {\n    switch (binaryType) {\n        case "blob":\n            if (data instanceof Blob) {\n                // from WebSocket + binaryType "blob"\n                return data;\n            }\n            else {\n                // from HTTP long-polling or WebTransport\n                return new Blob([data]);\n            }\n        case "arraybuffer":\n        default:\n            if (data instanceof ArrayBuffer) {\n                // from HTTP long-polling (base64) or WebSocket + binaryType "arraybuffer"\n                return data;\n            }\n            else {\n                // from WebTransport (Uint8Array)\n                return data.buffer;\n            }\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLXBhcnNlckA1LjIuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLXBhcnNlci9idWlsZC9lc20vZGVjb2RlUGFja2V0LmJyb3dzZXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQW1FO0FBQ1Y7QUFDekQ7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLDZEQUFvQjtBQUMzQztBQUNBLGVBQWUscURBQVk7QUFDM0I7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLDZEQUFvQjtBQUN0QztBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsNkRBQW9CO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHNFQUFNO0FBQzlCO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixzQkFBc0I7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLXBhcnNlckA1LjIuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLXBhcnNlci9idWlsZC9lc20vZGVjb2RlUGFja2V0LmJyb3dzZXIuanM/OTFiYiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBFUlJPUl9QQUNLRVQsIFBBQ0tFVF9UWVBFU19SRVZFUlNFLCB9IGZyb20gXCIuL2NvbW1vbnMuanNcIjtcbmltcG9ydCB7IGRlY29kZSB9IGZyb20gXCIuL2NvbnRyaWIvYmFzZTY0LWFycmF5YnVmZmVyLmpzXCI7XG5jb25zdCB3aXRoTmF0aXZlQXJyYXlCdWZmZXIgPSB0eXBlb2YgQXJyYXlCdWZmZXIgPT09IFwiZnVuY3Rpb25cIjtcbmV4cG9ydCBjb25zdCBkZWNvZGVQYWNrZXQgPSAoZW5jb2RlZFBhY2tldCwgYmluYXJ5VHlwZSkgPT4ge1xuICAgIGlmICh0eXBlb2YgZW5jb2RlZFBhY2tldCAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogXCJtZXNzYWdlXCIsXG4gICAgICAgICAgICBkYXRhOiBtYXBCaW5hcnkoZW5jb2RlZFBhY2tldCwgYmluYXJ5VHlwZSksXG4gICAgICAgIH07XG4gICAgfVxuICAgIGNvbnN0IHR5cGUgPSBlbmNvZGVkUGFja2V0LmNoYXJBdCgwKTtcbiAgICBpZiAodHlwZSA9PT0gXCJiXCIpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6IFwibWVzc2FnZVwiLFxuICAgICAgICAgICAgZGF0YTogZGVjb2RlQmFzZTY0UGFja2V0KGVuY29kZWRQYWNrZXQuc3Vic3RyaW5nKDEpLCBiaW5hcnlUeXBlKSxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgY29uc3QgcGFja2V0VHlwZSA9IFBBQ0tFVF9UWVBFU19SRVZFUlNFW3R5cGVdO1xuICAgIGlmICghcGFja2V0VHlwZSkge1xuICAgICAgICByZXR1cm4gRVJST1JfUEFDS0VUO1xuICAgIH1cbiAgICByZXR1cm4gZW5jb2RlZFBhY2tldC5sZW5ndGggPiAxXG4gICAgICAgID8ge1xuICAgICAgICAgICAgdHlwZTogUEFDS0VUX1RZUEVTX1JFVkVSU0VbdHlwZV0sXG4gICAgICAgICAgICBkYXRhOiBlbmNvZGVkUGFja2V0LnN1YnN0cmluZygxKSxcbiAgICAgICAgfVxuICAgICAgICA6IHtcbiAgICAgICAgICAgIHR5cGU6IFBBQ0tFVF9UWVBFU19SRVZFUlNFW3R5cGVdLFxuICAgICAgICB9O1xufTtcbmNvbnN0IGRlY29kZUJhc2U2NFBhY2tldCA9IChkYXRhLCBiaW5hcnlUeXBlKSA9PiB7XG4gICAgaWYgKHdpdGhOYXRpdmVBcnJheUJ1ZmZlcikge1xuICAgICAgICBjb25zdCBkZWNvZGVkID0gZGVjb2RlKGRhdGEpO1xuICAgICAgICByZXR1cm4gbWFwQmluYXJ5KGRlY29kZWQsIGJpbmFyeVR5cGUpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHsgYmFzZTY0OiB0cnVlLCBkYXRhIH07IC8vIGZhbGxiYWNrIGZvciBvbGQgYnJvd3NlcnNcbiAgICB9XG59O1xuY29uc3QgbWFwQmluYXJ5ID0gKGRhdGEsIGJpbmFyeVR5cGUpID0+IHtcbiAgICBzd2l0Y2ggKGJpbmFyeVR5cGUpIHtcbiAgICAgICAgY2FzZSBcImJsb2JcIjpcbiAgICAgICAgICAgIGlmIChkYXRhIGluc3RhbmNlb2YgQmxvYikge1xuICAgICAgICAgICAgICAgIC8vIGZyb20gV2ViU29ja2V0ICsgYmluYXJ5VHlwZSBcImJsb2JcIlxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gZnJvbSBIVFRQIGxvbmctcG9sbGluZyBvciBXZWJUcmFuc3BvcnRcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEJsb2IoW2RhdGFdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgY2FzZSBcImFycmF5YnVmZmVyXCI6XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICBpZiAoZGF0YSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XG4gICAgICAgICAgICAgICAgLy8gZnJvbSBIVFRQIGxvbmctcG9sbGluZyAoYmFzZTY0KSBvciBXZWJTb2NrZXQgKyBiaW5hcnlUeXBlIFwiYXJyYXlidWZmZXJcIlxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gZnJvbSBXZWJUcmFuc3BvcnQgKFVpbnQ4QXJyYXkpXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEuYnVmZmVyO1xuICAgICAgICAgICAgfVxuICAgIH1cbn07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/decodePacket.browser.js\n')},"./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/encodePacket.browser.js":
/*!*******************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/encodePacket.browser.js ***!
  \*******************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   encodePacket: () => (/* binding */ encodePacket),\n/* harmony export */   encodePacketToBinary: () => (/* binding */ encodePacketToBinary)\n/* harmony export */ });\n/* harmony import */ var _commons_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./commons.js */ "./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/commons.js");\n\nconst withNativeBlob = typeof Blob === "function" ||\n    (typeof Blob !== "undefined" &&\n        Object.prototype.toString.call(Blob) === "[object BlobConstructor]");\nconst withNativeArrayBuffer = typeof ArrayBuffer === "function";\n// ArrayBuffer.isView method is not defined in IE10\nconst isView = (obj) => {\n    return typeof ArrayBuffer.isView === "function"\n        ? ArrayBuffer.isView(obj)\n        : obj && obj.buffer instanceof ArrayBuffer;\n};\nconst encodePacket = ({ type, data }, supportsBinary, callback) => {\n    if (withNativeBlob && data instanceof Blob) {\n        if (supportsBinary) {\n            return callback(data);\n        }\n        else {\n            return encodeBlobAsBase64(data, callback);\n        }\n    }\n    else if (withNativeArrayBuffer &&\n        (data instanceof ArrayBuffer || isView(data))) {\n        if (supportsBinary) {\n            return callback(data);\n        }\n        else {\n            return encodeBlobAsBase64(new Blob([data]), callback);\n        }\n    }\n    // plain string\n    return callback(_commons_js__WEBPACK_IMPORTED_MODULE_0__.PACKET_TYPES[type] + (data || ""));\n};\nconst encodeBlobAsBase64 = (data, callback) => {\n    const fileReader = new FileReader();\n    fileReader.onload = function () {\n        const content = fileReader.result.split(",")[1];\n        callback("b" + (content || ""));\n    };\n    return fileReader.readAsDataURL(data);\n};\nfunction toArray(data) {\n    if (data instanceof Uint8Array) {\n        return data;\n    }\n    else if (data instanceof ArrayBuffer) {\n        return new Uint8Array(data);\n    }\n    else {\n        return new Uint8Array(data.buffer, data.byteOffset, data.byteLength);\n    }\n}\nlet TEXT_ENCODER;\nfunction encodePacketToBinary(packet, callback) {\n    if (withNativeBlob && packet.data instanceof Blob) {\n        return packet.data.arrayBuffer().then(toArray).then(callback);\n    }\n    else if (withNativeArrayBuffer &&\n        (packet.data instanceof ArrayBuffer || isView(packet.data))) {\n        return callback(toArray(packet.data));\n    }\n    encodePacket(packet, false, (encoded) => {\n        if (!TEXT_ENCODER) {\n            TEXT_ENCODER = new TextEncoder();\n        }\n        callback(TEXT_ENCODER.encode(encoded));\n    });\n}\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLXBhcnNlckA1LjIuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLXBhcnNlci9idWlsZC9lc20vZW5jb2RlUGFja2V0LmJyb3dzZXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQTRDO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLFlBQVk7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLHFEQUFZO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3dCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL2VuZ2luZS5pby1wYXJzZXJANS4yLjMvbm9kZV9tb2R1bGVzL2VuZ2luZS5pby1wYXJzZXIvYnVpbGQvZXNtL2VuY29kZVBhY2tldC5icm93c2VyLmpzP2UzNzAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUEFDS0VUX1RZUEVTIH0gZnJvbSBcIi4vY29tbW9ucy5qc1wiO1xuY29uc3Qgd2l0aE5hdGl2ZUJsb2IgPSB0eXBlb2YgQmxvYiA9PT0gXCJmdW5jdGlvblwiIHx8XG4gICAgKHR5cGVvZiBCbG9iICE9PSBcInVuZGVmaW5lZFwiICYmXG4gICAgICAgIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChCbG9iKSA9PT0gXCJbb2JqZWN0IEJsb2JDb25zdHJ1Y3Rvcl1cIik7XG5jb25zdCB3aXRoTmF0aXZlQXJyYXlCdWZmZXIgPSB0eXBlb2YgQXJyYXlCdWZmZXIgPT09IFwiZnVuY3Rpb25cIjtcbi8vIEFycmF5QnVmZmVyLmlzVmlldyBtZXRob2QgaXMgbm90IGRlZmluZWQgaW4gSUUxMFxuY29uc3QgaXNWaWV3ID0gKG9iaikgPT4ge1xuICAgIHJldHVybiB0eXBlb2YgQXJyYXlCdWZmZXIuaXNWaWV3ID09PSBcImZ1bmN0aW9uXCJcbiAgICAgICAgPyBBcnJheUJ1ZmZlci5pc1ZpZXcob2JqKVxuICAgICAgICA6IG9iaiAmJiBvYmouYnVmZmVyIGluc3RhbmNlb2YgQXJyYXlCdWZmZXI7XG59O1xuY29uc3QgZW5jb2RlUGFja2V0ID0gKHsgdHlwZSwgZGF0YSB9LCBzdXBwb3J0c0JpbmFyeSwgY2FsbGJhY2spID0+IHtcbiAgICBpZiAod2l0aE5hdGl2ZUJsb2IgJiYgZGF0YSBpbnN0YW5jZW9mIEJsb2IpIHtcbiAgICAgICAgaWYgKHN1cHBvcnRzQmluYXJ5KSB7XG4gICAgICAgICAgICByZXR1cm4gY2FsbGJhY2soZGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZW5jb2RlQmxvYkFzQmFzZTY0KGRhdGEsIGNhbGxiYWNrKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmICh3aXRoTmF0aXZlQXJyYXlCdWZmZXIgJiZcbiAgICAgICAgKGRhdGEgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlciB8fCBpc1ZpZXcoZGF0YSkpKSB7XG4gICAgICAgIGlmIChzdXBwb3J0c0JpbmFyeSkge1xuICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKGRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGVuY29kZUJsb2JBc0Jhc2U2NChuZXcgQmxvYihbZGF0YV0pLCBjYWxsYmFjayk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gcGxhaW4gc3RyaW5nXG4gICAgcmV0dXJuIGNhbGxiYWNrKFBBQ0tFVF9UWVBFU1t0eXBlXSArIChkYXRhIHx8IFwiXCIpKTtcbn07XG5jb25zdCBlbmNvZGVCbG9iQXNCYXNlNjQgPSAoZGF0YSwgY2FsbGJhY2spID0+IHtcbiAgICBjb25zdCBmaWxlUmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcbiAgICBmaWxlUmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc3QgY29udGVudCA9IGZpbGVSZWFkZXIucmVzdWx0LnNwbGl0KFwiLFwiKVsxXTtcbiAgICAgICAgY2FsbGJhY2soXCJiXCIgKyAoY29udGVudCB8fCBcIlwiKSk7XG4gICAgfTtcbiAgICByZXR1cm4gZmlsZVJlYWRlci5yZWFkQXNEYXRhVVJMKGRhdGEpO1xufTtcbmZ1bmN0aW9uIHRvQXJyYXkoZGF0YSkge1xuICAgIGlmIChkYXRhIGluc3RhbmNlb2YgVWludDhBcnJheSkge1xuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZGF0YSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XG4gICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheShkYXRhKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheShkYXRhLmJ1ZmZlciwgZGF0YS5ieXRlT2Zmc2V0LCBkYXRhLmJ5dGVMZW5ndGgpO1xuICAgIH1cbn1cbmxldCBURVhUX0VOQ09ERVI7XG5leHBvcnQgZnVuY3Rpb24gZW5jb2RlUGFja2V0VG9CaW5hcnkocGFja2V0LCBjYWxsYmFjaykge1xuICAgIGlmICh3aXRoTmF0aXZlQmxvYiAmJiBwYWNrZXQuZGF0YSBpbnN0YW5jZW9mIEJsb2IpIHtcbiAgICAgICAgcmV0dXJuIHBhY2tldC5kYXRhLmFycmF5QnVmZmVyKCkudGhlbih0b0FycmF5KS50aGVuKGNhbGxiYWNrKTtcbiAgICB9XG4gICAgZWxzZSBpZiAod2l0aE5hdGl2ZUFycmF5QnVmZmVyICYmXG4gICAgICAgIChwYWNrZXQuZGF0YSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyIHx8IGlzVmlldyhwYWNrZXQuZGF0YSkpKSB7XG4gICAgICAgIHJldHVybiBjYWxsYmFjayh0b0FycmF5KHBhY2tldC5kYXRhKSk7XG4gICAgfVxuICAgIGVuY29kZVBhY2tldChwYWNrZXQsIGZhbHNlLCAoZW5jb2RlZCkgPT4ge1xuICAgICAgICBpZiAoIVRFWFRfRU5DT0RFUikge1xuICAgICAgICAgICAgVEVYVF9FTkNPREVSID0gbmV3IFRleHRFbmNvZGVyKCk7XG4gICAgICAgIH1cbiAgICAgICAgY2FsbGJhY2soVEVYVF9FTkNPREVSLmVuY29kZShlbmNvZGVkKSk7XG4gICAgfSk7XG59XG5leHBvcnQgeyBlbmNvZGVQYWNrZXQgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/encodePacket.browser.js\n')},"./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/index.js":
/*!****************************************************************************************************!*\
  !*** ./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/index.js ***!
  \****************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createPacketDecoderStream: () => (/* binding */ createPacketDecoderStream),\n/* harmony export */   createPacketEncoderStream: () => (/* binding */ createPacketEncoderStream),\n/* harmony export */   decodePacket: () => (/* reexport safe */ _decodePacket_js__WEBPACK_IMPORTED_MODULE_1__.decodePacket),\n/* harmony export */   decodePayload: () => (/* binding */ decodePayload),\n/* harmony export */   encodePacket: () => (/* reexport safe */ _encodePacket_js__WEBPACK_IMPORTED_MODULE_0__.encodePacket),\n/* harmony export */   encodePayload: () => (/* binding */ encodePayload),\n/* harmony export */   protocol: () => (/* binding */ protocol)\n/* harmony export */ });\n/* harmony import */ var _encodePacket_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./encodePacket.js */ "./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/encodePacket.browser.js");\n/* harmony import */ var _decodePacket_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./decodePacket.js */ "./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/decodePacket.browser.js");\n/* harmony import */ var _commons_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./commons.js */ "./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/commons.js");\n\n\n\nconst SEPARATOR = String.fromCharCode(30); // see https://en.wikipedia.org/wiki/Delimiter#ASCII_delimited_text\nconst encodePayload = (packets, callback) => {\n    // some packets may be added to the array while encoding, so the initial length must be saved\n    const length = packets.length;\n    const encodedPackets = new Array(length);\n    let count = 0;\n    packets.forEach((packet, i) => {\n        // force base64 encoding for binary packets\n        (0,_encodePacket_js__WEBPACK_IMPORTED_MODULE_0__.encodePacket)(packet, false, (encodedPacket) => {\n            encodedPackets[i] = encodedPacket;\n            if (++count === length) {\n                callback(encodedPackets.join(SEPARATOR));\n            }\n        });\n    });\n};\nconst decodePayload = (encodedPayload, binaryType) => {\n    const encodedPackets = encodedPayload.split(SEPARATOR);\n    const packets = [];\n    for (let i = 0; i < encodedPackets.length; i++) {\n        const decodedPacket = (0,_decodePacket_js__WEBPACK_IMPORTED_MODULE_1__.decodePacket)(encodedPackets[i], binaryType);\n        packets.push(decodedPacket);\n        if (decodedPacket.type === "error") {\n            break;\n        }\n    }\n    return packets;\n};\nfunction createPacketEncoderStream() {\n    return new TransformStream({\n        transform(packet, controller) {\n            (0,_encodePacket_js__WEBPACK_IMPORTED_MODULE_0__.encodePacketToBinary)(packet, (encodedPacket) => {\n                const payloadLength = encodedPacket.length;\n                let header;\n                // inspired by the WebSocket format: https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API/Writing_WebSocket_servers#decoding_payload_length\n                if (payloadLength < 126) {\n                    header = new Uint8Array(1);\n                    new DataView(header.buffer).setUint8(0, payloadLength);\n                }\n                else if (payloadLength < 65536) {\n                    header = new Uint8Array(3);\n                    const view = new DataView(header.buffer);\n                    view.setUint8(0, 126);\n                    view.setUint16(1, payloadLength);\n                }\n                else {\n                    header = new Uint8Array(9);\n                    const view = new DataView(header.buffer);\n                    view.setUint8(0, 127);\n                    view.setBigUint64(1, BigInt(payloadLength));\n                }\n                // first bit indicates whether the payload is plain text (0) or binary (1)\n                if (packet.data && typeof packet.data !== "string") {\n                    header[0] |= 0x80;\n                }\n                controller.enqueue(header);\n                controller.enqueue(encodedPacket);\n            });\n        },\n    });\n}\nlet TEXT_DECODER;\nfunction totalLength(chunks) {\n    return chunks.reduce((acc, chunk) => acc + chunk.length, 0);\n}\nfunction concatChunks(chunks, size) {\n    if (chunks[0].length === size) {\n        return chunks.shift();\n    }\n    const buffer = new Uint8Array(size);\n    let j = 0;\n    for (let i = 0; i < size; i++) {\n        buffer[i] = chunks[0][j++];\n        if (j === chunks[0].length) {\n            chunks.shift();\n            j = 0;\n        }\n    }\n    if (chunks.length && j < chunks[0].length) {\n        chunks[0] = chunks[0].slice(j);\n    }\n    return buffer;\n}\nfunction createPacketDecoderStream(maxPayload, binaryType) {\n    if (!TEXT_DECODER) {\n        TEXT_DECODER = new TextDecoder();\n    }\n    const chunks = [];\n    let state = 0 /* State.READ_HEADER */;\n    let expectedLength = -1;\n    let isBinary = false;\n    return new TransformStream({\n        transform(chunk, controller) {\n            chunks.push(chunk);\n            while (true) {\n                if (state === 0 /* State.READ_HEADER */) {\n                    if (totalLength(chunks) < 1) {\n                        break;\n                    }\n                    const header = concatChunks(chunks, 1);\n                    isBinary = (header[0] & 0x80) === 0x80;\n                    expectedLength = header[0] & 0x7f;\n                    if (expectedLength < 126) {\n                        state = 3 /* State.READ_PAYLOAD */;\n                    }\n                    else if (expectedLength === 126) {\n                        state = 1 /* State.READ_EXTENDED_LENGTH_16 */;\n                    }\n                    else {\n                        state = 2 /* State.READ_EXTENDED_LENGTH_64 */;\n                    }\n                }\n                else if (state === 1 /* State.READ_EXTENDED_LENGTH_16 */) {\n                    if (totalLength(chunks) < 2) {\n                        break;\n                    }\n                    const headerArray = concatChunks(chunks, 2);\n                    expectedLength = new DataView(headerArray.buffer, headerArray.byteOffset, headerArray.length).getUint16(0);\n                    state = 3 /* State.READ_PAYLOAD */;\n                }\n                else if (state === 2 /* State.READ_EXTENDED_LENGTH_64 */) {\n                    if (totalLength(chunks) < 8) {\n                        break;\n                    }\n                    const headerArray = concatChunks(chunks, 8);\n                    const view = new DataView(headerArray.buffer, headerArray.byteOffset, headerArray.length);\n                    const n = view.getUint32(0);\n                    if (n > Math.pow(2, 53 - 32) - 1) {\n                        // the maximum safe integer in JavaScript is 2^53 - 1\n                        controller.enqueue(_commons_js__WEBPACK_IMPORTED_MODULE_2__.ERROR_PACKET);\n                        break;\n                    }\n                    expectedLength = n * Math.pow(2, 32) + view.getUint32(4);\n                    state = 3 /* State.READ_PAYLOAD */;\n                }\n                else {\n                    if (totalLength(chunks) < expectedLength) {\n                        break;\n                    }\n                    const data = concatChunks(chunks, expectedLength);\n                    controller.enqueue((0,_decodePacket_js__WEBPACK_IMPORTED_MODULE_1__.decodePacket)(isBinary ? data : TEXT_DECODER.decode(data), binaryType));\n                    state = 0 /* State.READ_HEADER */;\n                }\n                if (expectedLength === 0 || expectedLength > maxPayload) {\n                    controller.enqueue(_commons_js__WEBPACK_IMPORTED_MODULE_2__.ERROR_PACKET);\n                    break;\n                }\n            }\n        },\n    });\n}\nconst protocol = 4;\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vZW5naW5lLmlvLXBhcnNlckA1LjIuMy9ub2RlX21vZHVsZXMvZW5naW5lLmlvLXBhcnNlci9idWlsZC9lc20vaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUF1RTtBQUN0QjtBQUNKO0FBQzdDLDJDQUEyQztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsOERBQVk7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLDJCQUEyQjtBQUMvQyw4QkFBOEIsOERBQVk7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQSxZQUFZLHNFQUFvQjtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1QsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsVUFBVTtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkMscURBQVk7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUMsOERBQVk7QUFDbkQ7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLHFEQUFZO0FBQ25EO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxLQUFLO0FBQ0w7QUFDTztBQUM4RCIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL25vZGVfbW9kdWxlcy8ucG5wbS9lbmdpbmUuaW8tcGFyc2VyQDUuMi4zL25vZGVfbW9kdWxlcy9lbmdpbmUuaW8tcGFyc2VyL2J1aWxkL2VzbS9pbmRleC5qcz8zN2ZlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGVuY29kZVBhY2tldCwgZW5jb2RlUGFja2V0VG9CaW5hcnkgfSBmcm9tIFwiLi9lbmNvZGVQYWNrZXQuanNcIjtcbmltcG9ydCB7IGRlY29kZVBhY2tldCB9IGZyb20gXCIuL2RlY29kZVBhY2tldC5qc1wiO1xuaW1wb3J0IHsgRVJST1JfUEFDS0VULCB9IGZyb20gXCIuL2NvbW1vbnMuanNcIjtcbmNvbnN0IFNFUEFSQVRPUiA9IFN0cmluZy5mcm9tQ2hhckNvZGUoMzApOyAvLyBzZWUgaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvRGVsaW1pdGVyI0FTQ0lJX2RlbGltaXRlZF90ZXh0XG5jb25zdCBlbmNvZGVQYXlsb2FkID0gKHBhY2tldHMsIGNhbGxiYWNrKSA9PiB7XG4gICAgLy8gc29tZSBwYWNrZXRzIG1heSBiZSBhZGRlZCB0byB0aGUgYXJyYXkgd2hpbGUgZW5jb2RpbmcsIHNvIHRoZSBpbml0aWFsIGxlbmd0aCBtdXN0IGJlIHNhdmVkXG4gICAgY29uc3QgbGVuZ3RoID0gcGFja2V0cy5sZW5ndGg7XG4gICAgY29uc3QgZW5jb2RlZFBhY2tldHMgPSBuZXcgQXJyYXkobGVuZ3RoKTtcbiAgICBsZXQgY291bnQgPSAwO1xuICAgIHBhY2tldHMuZm9yRWFjaCgocGFja2V0LCBpKSA9PiB7XG4gICAgICAgIC8vIGZvcmNlIGJhc2U2NCBlbmNvZGluZyBmb3IgYmluYXJ5IHBhY2tldHNcbiAgICAgICAgZW5jb2RlUGFja2V0KHBhY2tldCwgZmFsc2UsIChlbmNvZGVkUGFja2V0KSA9PiB7XG4gICAgICAgICAgICBlbmNvZGVkUGFja2V0c1tpXSA9IGVuY29kZWRQYWNrZXQ7XG4gICAgICAgICAgICBpZiAoKytjb3VudCA9PT0gbGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soZW5jb2RlZFBhY2tldHMuam9pbihTRVBBUkFUT1IpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSk7XG59O1xuY29uc3QgZGVjb2RlUGF5bG9hZCA9IChlbmNvZGVkUGF5bG9hZCwgYmluYXJ5VHlwZSkgPT4ge1xuICAgIGNvbnN0IGVuY29kZWRQYWNrZXRzID0gZW5jb2RlZFBheWxvYWQuc3BsaXQoU0VQQVJBVE9SKTtcbiAgICBjb25zdCBwYWNrZXRzID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlbmNvZGVkUGFja2V0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBkZWNvZGVkUGFja2V0ID0gZGVjb2RlUGFja2V0KGVuY29kZWRQYWNrZXRzW2ldLCBiaW5hcnlUeXBlKTtcbiAgICAgICAgcGFja2V0cy5wdXNoKGRlY29kZWRQYWNrZXQpO1xuICAgICAgICBpZiAoZGVjb2RlZFBhY2tldC50eXBlID09PSBcImVycm9yXCIpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBwYWNrZXRzO1xufTtcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVQYWNrZXRFbmNvZGVyU3RyZWFtKCkge1xuICAgIHJldHVybiBuZXcgVHJhbnNmb3JtU3RyZWFtKHtcbiAgICAgICAgdHJhbnNmb3JtKHBhY2tldCwgY29udHJvbGxlcikge1xuICAgICAgICAgICAgZW5jb2RlUGFja2V0VG9CaW5hcnkocGFja2V0LCAoZW5jb2RlZFBhY2tldCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHBheWxvYWRMZW5ndGggPSBlbmNvZGVkUGFja2V0Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICBsZXQgaGVhZGVyO1xuICAgICAgICAgICAgICAgIC8vIGluc3BpcmVkIGJ5IHRoZSBXZWJTb2NrZXQgZm9ybWF0OiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvV2ViU29ja2V0c19BUEkvV3JpdGluZ19XZWJTb2NrZXRfc2VydmVycyNkZWNvZGluZ19wYXlsb2FkX2xlbmd0aFxuICAgICAgICAgICAgICAgIGlmIChwYXlsb2FkTGVuZ3RoIDwgMTI2KSB7XG4gICAgICAgICAgICAgICAgICAgIGhlYWRlciA9IG5ldyBVaW50OEFycmF5KDEpO1xuICAgICAgICAgICAgICAgICAgICBuZXcgRGF0YVZpZXcoaGVhZGVyLmJ1ZmZlcikuc2V0VWludDgoMCwgcGF5bG9hZExlbmd0aCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHBheWxvYWRMZW5ndGggPCA2NTUzNikge1xuICAgICAgICAgICAgICAgICAgICBoZWFkZXIgPSBuZXcgVWludDhBcnJheSgzKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmlldyA9IG5ldyBEYXRhVmlldyhoZWFkZXIuYnVmZmVyKTtcbiAgICAgICAgICAgICAgICAgICAgdmlldy5zZXRVaW50OCgwLCAxMjYpO1xuICAgICAgICAgICAgICAgICAgICB2aWV3LnNldFVpbnQxNigxLCBwYXlsb2FkTGVuZ3RoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGhlYWRlciA9IG5ldyBVaW50OEFycmF5KDkpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2aWV3ID0gbmV3IERhdGFWaWV3KGhlYWRlci5idWZmZXIpO1xuICAgICAgICAgICAgICAgICAgICB2aWV3LnNldFVpbnQ4KDAsIDEyNyk7XG4gICAgICAgICAgICAgICAgICAgIHZpZXcuc2V0QmlnVWludDY0KDEsIEJpZ0ludChwYXlsb2FkTGVuZ3RoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIGZpcnN0IGJpdCBpbmRpY2F0ZXMgd2hldGhlciB0aGUgcGF5bG9hZCBpcyBwbGFpbiB0ZXh0ICgwKSBvciBiaW5hcnkgKDEpXG4gICAgICAgICAgICAgICAgaWYgKHBhY2tldC5kYXRhICYmIHR5cGVvZiBwYWNrZXQuZGF0YSAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgICAgICBoZWFkZXJbMF0gfD0gMHg4MDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKGhlYWRlcik7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKGVuY29kZWRQYWNrZXQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgfSk7XG59XG5sZXQgVEVYVF9ERUNPREVSO1xuZnVuY3Rpb24gdG90YWxMZW5ndGgoY2h1bmtzKSB7XG4gICAgcmV0dXJuIGNodW5rcy5yZWR1Y2UoKGFjYywgY2h1bmspID0+IGFjYyArIGNodW5rLmxlbmd0aCwgMCk7XG59XG5mdW5jdGlvbiBjb25jYXRDaHVua3MoY2h1bmtzLCBzaXplKSB7XG4gICAgaWYgKGNodW5rc1swXS5sZW5ndGggPT09IHNpemUpIHtcbiAgICAgICAgcmV0dXJuIGNodW5rcy5zaGlmdCgpO1xuICAgIH1cbiAgICBjb25zdCBidWZmZXIgPSBuZXcgVWludDhBcnJheShzaXplKTtcbiAgICBsZXQgaiA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaXplOyBpKyspIHtcbiAgICAgICAgYnVmZmVyW2ldID0gY2h1bmtzWzBdW2orK107XG4gICAgICAgIGlmIChqID09PSBjaHVua3NbMF0ubGVuZ3RoKSB7XG4gICAgICAgICAgICBjaHVua3Muc2hpZnQoKTtcbiAgICAgICAgICAgIGogPSAwO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChjaHVua3MubGVuZ3RoICYmIGogPCBjaHVua3NbMF0ubGVuZ3RoKSB7XG4gICAgICAgIGNodW5rc1swXSA9IGNodW5rc1swXS5zbGljZShqKTtcbiAgICB9XG4gICAgcmV0dXJuIGJ1ZmZlcjtcbn1cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVQYWNrZXREZWNvZGVyU3RyZWFtKG1heFBheWxvYWQsIGJpbmFyeVR5cGUpIHtcbiAgICBpZiAoIVRFWFRfREVDT0RFUikge1xuICAgICAgICBURVhUX0RFQ09ERVIgPSBuZXcgVGV4dERlY29kZXIoKTtcbiAgICB9XG4gICAgY29uc3QgY2h1bmtzID0gW107XG4gICAgbGV0IHN0YXRlID0gMCAvKiBTdGF0ZS5SRUFEX0hFQURFUiAqLztcbiAgICBsZXQgZXhwZWN0ZWRMZW5ndGggPSAtMTtcbiAgICBsZXQgaXNCaW5hcnkgPSBmYWxzZTtcbiAgICByZXR1cm4gbmV3IFRyYW5zZm9ybVN0cmVhbSh7XG4gICAgICAgIHRyYW5zZm9ybShjaHVuaywgY29udHJvbGxlcikge1xuICAgICAgICAgICAgY2h1bmtzLnB1c2goY2h1bmspO1xuICAgICAgICAgICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGUgPT09IDAgLyogU3RhdGUuUkVBRF9IRUFERVIgKi8pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRvdGFsTGVuZ3RoKGNodW5rcykgPCAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb25zdCBoZWFkZXIgPSBjb25jYXRDaHVua3MoY2h1bmtzLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgaXNCaW5hcnkgPSAoaGVhZGVyWzBdICYgMHg4MCkgPT09IDB4ODA7XG4gICAgICAgICAgICAgICAgICAgIGV4cGVjdGVkTGVuZ3RoID0gaGVhZGVyWzBdICYgMHg3ZjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV4cGVjdGVkTGVuZ3RoIDwgMTI2KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IDMgLyogU3RhdGUuUkVBRF9QQVlMT0FEICovO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGV4cGVjdGVkTGVuZ3RoID09PSAxMjYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlID0gMSAvKiBTdGF0ZS5SRUFEX0VYVEVOREVEX0xFTkdUSF8xNiAqLztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlID0gMiAvKiBTdGF0ZS5SRUFEX0VYVEVOREVEX0xFTkdUSF82NCAqLztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChzdGF0ZSA9PT0gMSAvKiBTdGF0ZS5SRUFEX0VYVEVOREVEX0xFTkdUSF8xNiAqLykge1xuICAgICAgICAgICAgICAgICAgICBpZiAodG90YWxMZW5ndGgoY2h1bmtzKSA8IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRlckFycmF5ID0gY29uY2F0Q2h1bmtzKGNodW5rcywgMik7XG4gICAgICAgICAgICAgICAgICAgIGV4cGVjdGVkTGVuZ3RoID0gbmV3IERhdGFWaWV3KGhlYWRlckFycmF5LmJ1ZmZlciwgaGVhZGVyQXJyYXkuYnl0ZU9mZnNldCwgaGVhZGVyQXJyYXkubGVuZ3RoKS5nZXRVaW50MTYoMCk7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gMyAvKiBTdGF0ZS5SRUFEX1BBWUxPQUQgKi87XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHN0YXRlID09PSAyIC8qIFN0YXRlLlJFQURfRVhURU5ERURfTEVOR1RIXzY0ICovKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0b3RhbExlbmd0aChjaHVua3MpIDwgOCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaGVhZGVyQXJyYXkgPSBjb25jYXRDaHVua3MoY2h1bmtzLCA4KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmlldyA9IG5ldyBEYXRhVmlldyhoZWFkZXJBcnJheS5idWZmZXIsIGhlYWRlckFycmF5LmJ5dGVPZmZzZXQsIGhlYWRlckFycmF5Lmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB2aWV3LmdldFVpbnQzMigwKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG4gPiBNYXRoLnBvdygyLCA1MyAtIDMyKSAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZSBtYXhpbXVtIHNhZmUgaW50ZWdlciBpbiBKYXZhU2NyaXB0IGlzIDJeNTMgLSAxXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoRVJST1JfUEFDS0VUKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGV4cGVjdGVkTGVuZ3RoID0gbiAqIE1hdGgucG93KDIsIDMyKSArIHZpZXcuZ2V0VWludDMyKDQpO1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IDMgLyogU3RhdGUuUkVBRF9QQVlMT0FEICovO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRvdGFsTGVuZ3RoKGNodW5rcykgPCBleHBlY3RlZExlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IGNvbmNhdENodW5rcyhjaHVua3MsIGV4cGVjdGVkTGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKGRlY29kZVBhY2tldChpc0JpbmFyeSA/IGRhdGEgOiBURVhUX0RFQ09ERVIuZGVjb2RlKGRhdGEpLCBiaW5hcnlUeXBlKSk7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gMCAvKiBTdGF0ZS5SRUFEX0hFQURFUiAqLztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGV4cGVjdGVkTGVuZ3RoID09PSAwIHx8IGV4cGVjdGVkTGVuZ3RoID4gbWF4UGF5bG9hZCkge1xuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoRVJST1JfUEFDS0VUKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgIH0pO1xufVxuZXhwb3J0IGNvbnN0IHByb3RvY29sID0gNDtcbmV4cG9ydCB7IGVuY29kZVBhY2tldCwgZW5jb2RlUGF5bG9hZCwgZGVjb2RlUGFja2V0LCBkZWNvZGVQYXlsb2FkLCB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/engine.io-parser@5.2.3/node_modules/engine.io-parser/build/esm/index.js\n')},"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js":
/*!*********************************************************************************!*\
  !*** ./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js ***!
  \*********************************************************************************/function(module,exports,__webpack_require__){eval('var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__;/*\n* loglevel - https://github.com/pimterry/loglevel\n*\n* Copyright (c) 2013 Tim Perry\n* Licensed under the MIT license.\n*/\n(function (root, definition) {\n    "use strict";\n    if (true) {\n        !(__WEBPACK_AMD_DEFINE_FACTORY__ = (definition),\n\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === \'function\' ?\n\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.call(exports, __webpack_require__, exports, module)) :\n\t\t__WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n    } else {}\n}(this, function () {\n    "use strict";\n\n    // Slightly dubious tricks to cut down minimized file size\n    var noop = function() {};\n    var undefinedType = "undefined";\n    var isIE = (typeof window !== undefinedType) && (typeof window.navigator !== undefinedType) && (\n        /Trident\\/|MSIE /.test(window.navigator.userAgent)\n    );\n\n    var logMethods = [\n        "trace",\n        "debug",\n        "info",\n        "warn",\n        "error"\n    ];\n\n    var _loggersByName = {};\n    var defaultLogger = null;\n\n    // Cross-browser bind equivalent that works at least back to IE6\n    function bindMethod(obj, methodName) {\n        var method = obj[methodName];\n        if (typeof method.bind === \'function\') {\n            return method.bind(obj);\n        } else {\n            try {\n                return Function.prototype.bind.call(method, obj);\n            } catch (e) {\n                // Missing bind shim or IE8 + Modernizr, fallback to wrapping\n                return function() {\n                    return Function.prototype.apply.apply(method, [obj, arguments]);\n                };\n            }\n        }\n    }\n\n    // Trace() doesn\'t print the message in IE, so for that case we need to wrap it\n    function traceForIE() {\n        if (console.log) {\n            if (console.log.apply) {\n                console.log.apply(console, arguments);\n            } else {\n                // In old IE, native console methods themselves don\'t have apply().\n                Function.prototype.apply.apply(console.log, [console, arguments]);\n            }\n        }\n        if (console.trace) console.trace();\n    }\n\n    // Build the best logging method possible for this env\n    // Wherever possible we want to bind, not wrap, to preserve stack traces\n    function realMethod(methodName) {\n        if (methodName === \'debug\') {\n            methodName = \'log\';\n        }\n\n        if (typeof console === undefinedType) {\n            return false; // No method possible, for now - fixed later by enableLoggingWhenConsoleArrives\n        } else if (methodName === \'trace\' && isIE) {\n            return traceForIE;\n        } else if (console[methodName] !== undefined) {\n            return bindMethod(console, methodName);\n        } else if (console.log !== undefined) {\n            return bindMethod(console, \'log\');\n        } else {\n            return noop;\n        }\n    }\n\n    // These private functions always need `this` to be set properly\n\n    function replaceLoggingMethods() {\n        /*jshint validthis:true */\n        var level = this.getLevel();\n\n        // Replace the actual methods.\n        for (var i = 0; i < logMethods.length; i++) {\n            var methodName = logMethods[i];\n            this[methodName] = (i < level) ?\n                noop :\n                this.methodFactory(methodName, level, this.name);\n        }\n\n        // Define log.log as an alias for log.debug\n        this.log = this.debug;\n\n        // Return any important warnings.\n        if (typeof console === undefinedType && level < this.levels.SILENT) {\n            return "No console available for logging";\n        }\n    }\n\n    // In old IE versions, the console isn\'t present until you first open it.\n    // We build realMethod() replacements here that regenerate logging methods\n    function enableLoggingWhenConsoleArrives(methodName) {\n        return function () {\n            if (typeof console !== undefinedType) {\n                replaceLoggingMethods.call(this);\n                this[methodName].apply(this, arguments);\n            }\n        };\n    }\n\n    // By default, we use closely bound real methods wherever possible, and\n    // otherwise we wait for a console to appear, and then try again.\n    function defaultMethodFactory(methodName, _level, _loggerName) {\n        /*jshint validthis:true */\n        return realMethod(methodName) ||\n               enableLoggingWhenConsoleArrives.apply(this, arguments);\n    }\n\n    function Logger(name, factory) {\n      // Private instance variables.\n      var self = this;\n      /**\n       * The level inherited from a parent logger (or a global default). We\n       * cache this here rather than delegating to the parent so that it stays\n       * in sync with the actual logging methods that we have installed (the\n       * parent could change levels but we might not have rebuilt the loggers\n       * in this child yet).\n       * @type {number}\n       */\n      var inheritedLevel;\n      /**\n       * The default level for this logger, if any. If set, this overrides\n       * `inheritedLevel`.\n       * @type {number|null}\n       */\n      var defaultLevel;\n      /**\n       * A user-specific level for this logger. If set, this overrides\n       * `defaultLevel`.\n       * @type {number|null}\n       */\n      var userLevel;\n\n      var storageKey = "loglevel";\n      if (typeof name === "string") {\n        storageKey += ":" + name;\n      } else if (typeof name === "symbol") {\n        storageKey = undefined;\n      }\n\n      function persistLevelIfPossible(levelNum) {\n          var levelName = (logMethods[levelNum] || \'silent\').toUpperCase();\n\n          if (typeof window === undefinedType || !storageKey) return;\n\n          // Use localStorage if available\n          try {\n              window.localStorage[storageKey] = levelName;\n              return;\n          } catch (ignore) {}\n\n          // Use session cookie as fallback\n          try {\n              window.document.cookie =\n                encodeURIComponent(storageKey) + "=" + levelName + ";";\n          } catch (ignore) {}\n      }\n\n      function getPersistedLevel() {\n          var storedLevel;\n\n          if (typeof window === undefinedType || !storageKey) return;\n\n          try {\n              storedLevel = window.localStorage[storageKey];\n          } catch (ignore) {}\n\n          // Fallback to cookies if local storage gives us nothing\n          if (typeof storedLevel === undefinedType) {\n              try {\n                  var cookie = window.document.cookie;\n                  var cookieName = encodeURIComponent(storageKey);\n                  var location = cookie.indexOf(cookieName + "=");\n                  if (location !== -1) {\n                      storedLevel = /^([^;]+)/.exec(\n                          cookie.slice(location + cookieName.length + 1)\n                      )[1];\n                  }\n              } catch (ignore) {}\n          }\n\n          // If the stored level is not valid, treat it as if nothing was stored.\n          if (self.levels[storedLevel] === undefined) {\n              storedLevel = undefined;\n          }\n\n          return storedLevel;\n      }\n\n      function clearPersistedLevel() {\n          if (typeof window === undefinedType || !storageKey) return;\n\n          // Use localStorage if available\n          try {\n              window.localStorage.removeItem(storageKey);\n          } catch (ignore) {}\n\n          // Use session cookie as fallback\n          try {\n              window.document.cookie =\n                encodeURIComponent(storageKey) + "=; expires=Thu, 01 Jan 1970 00:00:00 UTC";\n          } catch (ignore) {}\n      }\n\n      function normalizeLevel(input) {\n          var level = input;\n          if (typeof level === "string" && self.levels[level.toUpperCase()] !== undefined) {\n              level = self.levels[level.toUpperCase()];\n          }\n          if (typeof level === "number" && level >= 0 && level <= self.levels.SILENT) {\n              return level;\n          } else {\n              throw new TypeError("log.setLevel() called with invalid level: " + input);\n          }\n      }\n\n      /*\n       *\n       * Public logger API - see https://github.com/pimterry/loglevel for details\n       *\n       */\n\n      self.name = name;\n\n      self.levels = { "TRACE": 0, "DEBUG": 1, "INFO": 2, "WARN": 3,\n          "ERROR": 4, "SILENT": 5};\n\n      self.methodFactory = factory || defaultMethodFactory;\n\n      self.getLevel = function () {\n          if (userLevel != null) {\n            return userLevel;\n          } else if (defaultLevel != null) {\n            return defaultLevel;\n          } else {\n            return inheritedLevel;\n          }\n      };\n\n      self.setLevel = function (level, persist) {\n          userLevel = normalizeLevel(level);\n          if (persist !== false) {  // defaults to true\n              persistLevelIfPossible(userLevel);\n          }\n\n          // NOTE: in v2, this should call rebuild(), which updates children.\n          return replaceLoggingMethods.call(self);\n      };\n\n      self.setDefaultLevel = function (level) {\n          defaultLevel = normalizeLevel(level);\n          if (!getPersistedLevel()) {\n              self.setLevel(level, false);\n          }\n      };\n\n      self.resetLevel = function () {\n          userLevel = null;\n          clearPersistedLevel();\n          replaceLoggingMethods.call(self);\n      };\n\n      self.enableAll = function(persist) {\n          self.setLevel(self.levels.TRACE, persist);\n      };\n\n      self.disableAll = function(persist) {\n          self.setLevel(self.levels.SILENT, persist);\n      };\n\n      self.rebuild = function () {\n          if (defaultLogger !== self) {\n              inheritedLevel = normalizeLevel(defaultLogger.getLevel());\n          }\n          replaceLoggingMethods.call(self);\n\n          if (defaultLogger === self) {\n              for (var childName in _loggersByName) {\n                _loggersByName[childName].rebuild();\n              }\n          }\n      };\n\n      // Initialize all the internal levels.\n      inheritedLevel = normalizeLevel(\n          defaultLogger ? defaultLogger.getLevel() : "WARN"\n      );\n      var initialLevel = getPersistedLevel();\n      if (initialLevel != null) {\n          userLevel = normalizeLevel(initialLevel);\n      }\n      replaceLoggingMethods.call(self);\n    }\n\n    /*\n     *\n     * Top-level API\n     *\n     */\n\n    defaultLogger = new Logger();\n\n    defaultLogger.getLogger = function getLogger(name) {\n        if ((typeof name !== "symbol" && typeof name !== "string") || name === "") {\n            throw new TypeError("You must supply a name when creating a logger.");\n        }\n\n        var logger = _loggersByName[name];\n        if (!logger) {\n            logger = _loggersByName[name] = new Logger(\n                name,\n                defaultLogger.methodFactory\n            );\n        }\n        return logger;\n    };\n\n    // Grab the current global log variable in case of overwrite\n    var _log = (typeof window !== undefinedType) ? window.log : undefined;\n    defaultLogger.noConflict = function() {\n        if (typeof window !== undefinedType &&\n               window.log === defaultLogger) {\n            window.log = _log;\n        }\n\n        return defaultLogger;\n    };\n\n    defaultLogger.getLoggers = function getLoggers() {\n        return _loggersByName;\n    };\n\n    // ES6 default export, for compatibility\n    defaultLogger[\'default\'] = defaultLogger;\n\n    return defaultLogger;\n}));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vbG9nbGV2ZWxAMS45LjIvbm9kZV9tb2R1bGVzL2xvZ2xldmVsL2xpYi9sb2dsZXZlbC5qcyIsIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxJQUEwQztBQUNsRCxRQUFRLG9DQUFPLFVBQVU7QUFBQTtBQUFBO0FBQUE7QUFBQSxrR0FBQztBQUMxQixNQUFNLEtBQUssRUFJTjtBQUNMLENBQUM7QUFDRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsMEJBQTBCO0FBQzFCLFVBQVU7QUFDVjtBQUNBLFVBQVU7QUFDVjtBQUNBLFVBQVU7QUFDVjtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0Esd0JBQXdCLHVCQUF1QjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7O0FBRVo7QUFDQTtBQUNBO0FBQ0EscUVBQXFFO0FBQ3JFLFlBQVk7QUFDWjs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxZQUFZOztBQUVaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMENBQTBDO0FBQzFDO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsWUFBWTs7QUFFWjtBQUNBO0FBQ0E7QUFDQSxxREFBcUQ7QUFDckQsWUFBWTtBQUNaOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBLHNCQUFzQjtBQUN0Qjs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxvQ0FBb0M7QUFDcEM7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL25vZGVfbW9kdWxlcy8ucG5wbS9sb2dsZXZlbEAxLjkuMi9ub2RlX21vZHVsZXMvbG9nbGV2ZWwvbGliL2xvZ2xldmVsLmpzP2RkMDciXSwic291cmNlc0NvbnRlbnQiOlsiLypcbiogbG9nbGV2ZWwgLSBodHRwczovL2dpdGh1Yi5jb20vcGltdGVycnkvbG9nbGV2ZWxcbipcbiogQ29weXJpZ2h0IChjKSAyMDEzIFRpbSBQZXJyeVxuKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4qL1xuKGZ1bmN0aW9uIChyb290LCBkZWZpbml0aW9uKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgICAgICBkZWZpbmUoZGVmaW5pdGlvbik7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cykge1xuICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGRlZmluaXRpb24oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByb290LmxvZyA9IGRlZmluaXRpb24oKTtcbiAgICB9XG59KHRoaXMsIGZ1bmN0aW9uICgpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIC8vIFNsaWdodGx5IGR1YmlvdXMgdHJpY2tzIHRvIGN1dCBkb3duIG1pbmltaXplZCBmaWxlIHNpemVcbiAgICB2YXIgbm9vcCA9IGZ1bmN0aW9uKCkge307XG4gICAgdmFyIHVuZGVmaW5lZFR5cGUgPSBcInVuZGVmaW5lZFwiO1xuICAgIHZhciBpc0lFID0gKHR5cGVvZiB3aW5kb3cgIT09IHVuZGVmaW5lZFR5cGUpICYmICh0eXBlb2Ygd2luZG93Lm5hdmlnYXRvciAhPT0gdW5kZWZpbmVkVHlwZSkgJiYgKFxuICAgICAgICAvVHJpZGVudFxcL3xNU0lFIC8udGVzdCh3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudClcbiAgICApO1xuXG4gICAgdmFyIGxvZ01ldGhvZHMgPSBbXG4gICAgICAgIFwidHJhY2VcIixcbiAgICAgICAgXCJkZWJ1Z1wiLFxuICAgICAgICBcImluZm9cIixcbiAgICAgICAgXCJ3YXJuXCIsXG4gICAgICAgIFwiZXJyb3JcIlxuICAgIF07XG5cbiAgICB2YXIgX2xvZ2dlcnNCeU5hbWUgPSB7fTtcbiAgICB2YXIgZGVmYXVsdExvZ2dlciA9IG51bGw7XG5cbiAgICAvLyBDcm9zcy1icm93c2VyIGJpbmQgZXF1aXZhbGVudCB0aGF0IHdvcmtzIGF0IGxlYXN0IGJhY2sgdG8gSUU2XG4gICAgZnVuY3Rpb24gYmluZE1ldGhvZChvYmosIG1ldGhvZE5hbWUpIHtcbiAgICAgICAgdmFyIG1ldGhvZCA9IG9ialttZXRob2ROYW1lXTtcbiAgICAgICAgaWYgKHR5cGVvZiBtZXRob2QuYmluZCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgcmV0dXJuIG1ldGhvZC5iaW5kKG9iaik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHJldHVybiBGdW5jdGlvbi5wcm90b3R5cGUuYmluZC5jYWxsKG1ldGhvZCwgb2JqKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAvLyBNaXNzaW5nIGJpbmQgc2hpbSBvciBJRTggKyBNb2Rlcm5penIsIGZhbGxiYWNrIHRvIHdyYXBwaW5nXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gRnVuY3Rpb24ucHJvdG90eXBlLmFwcGx5LmFwcGx5KG1ldGhvZCwgW29iaiwgYXJndW1lbnRzXSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIFRyYWNlKCkgZG9lc24ndCBwcmludCB0aGUgbWVzc2FnZSBpbiBJRSwgc28gZm9yIHRoYXQgY2FzZSB3ZSBuZWVkIHRvIHdyYXAgaXRcbiAgICBmdW5jdGlvbiB0cmFjZUZvcklFKCkge1xuICAgICAgICBpZiAoY29uc29sZS5sb2cpIHtcbiAgICAgICAgICAgIGlmIChjb25zb2xlLmxvZy5hcHBseSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nLmFwcGx5KGNvbnNvbGUsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIEluIG9sZCBJRSwgbmF0aXZlIGNvbnNvbGUgbWV0aG9kcyB0aGVtc2VsdmVzIGRvbid0IGhhdmUgYXBwbHkoKS5cbiAgICAgICAgICAgICAgICBGdW5jdGlvbi5wcm90b3R5cGUuYXBwbHkuYXBwbHkoY29uc29sZS5sb2csIFtjb25zb2xlLCBhcmd1bWVudHNdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoY29uc29sZS50cmFjZSkgY29uc29sZS50cmFjZSgpO1xuICAgIH1cblxuICAgIC8vIEJ1aWxkIHRoZSBiZXN0IGxvZ2dpbmcgbWV0aG9kIHBvc3NpYmxlIGZvciB0aGlzIGVudlxuICAgIC8vIFdoZXJldmVyIHBvc3NpYmxlIHdlIHdhbnQgdG8gYmluZCwgbm90IHdyYXAsIHRvIHByZXNlcnZlIHN0YWNrIHRyYWNlc1xuICAgIGZ1bmN0aW9uIHJlYWxNZXRob2QobWV0aG9kTmFtZSkge1xuICAgICAgICBpZiAobWV0aG9kTmFtZSA9PT0gJ2RlYnVnJykge1xuICAgICAgICAgICAgbWV0aG9kTmFtZSA9ICdsb2cnO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHR5cGVvZiBjb25zb2xlID09PSB1bmRlZmluZWRUeXBlKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7IC8vIE5vIG1ldGhvZCBwb3NzaWJsZSwgZm9yIG5vdyAtIGZpeGVkIGxhdGVyIGJ5IGVuYWJsZUxvZ2dpbmdXaGVuQ29uc29sZUFycml2ZXNcbiAgICAgICAgfSBlbHNlIGlmIChtZXRob2ROYW1lID09PSAndHJhY2UnICYmIGlzSUUpIHtcbiAgICAgICAgICAgIHJldHVybiB0cmFjZUZvcklFO1xuICAgICAgICB9IGVsc2UgaWYgKGNvbnNvbGVbbWV0aG9kTmFtZV0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIGJpbmRNZXRob2QoY29uc29sZSwgbWV0aG9kTmFtZSk7XG4gICAgICAgIH0gZWxzZSBpZiAoY29uc29sZS5sb2cgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIGJpbmRNZXRob2QoY29uc29sZSwgJ2xvZycpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG5vb3A7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBUaGVzZSBwcml2YXRlIGZ1bmN0aW9ucyBhbHdheXMgbmVlZCBgdGhpc2AgdG8gYmUgc2V0IHByb3Blcmx5XG5cbiAgICBmdW5jdGlvbiByZXBsYWNlTG9nZ2luZ01ldGhvZHMoKSB7XG4gICAgICAgIC8qanNoaW50IHZhbGlkdGhpczp0cnVlICovXG4gICAgICAgIHZhciBsZXZlbCA9IHRoaXMuZ2V0TGV2ZWwoKTtcblxuICAgICAgICAvLyBSZXBsYWNlIHRoZSBhY3R1YWwgbWV0aG9kcy5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsb2dNZXRob2RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgbWV0aG9kTmFtZSA9IGxvZ01ldGhvZHNbaV07XG4gICAgICAgICAgICB0aGlzW21ldGhvZE5hbWVdID0gKGkgPCBsZXZlbCkgP1xuICAgICAgICAgICAgICAgIG5vb3AgOlxuICAgICAgICAgICAgICAgIHRoaXMubWV0aG9kRmFjdG9yeShtZXRob2ROYW1lLCBsZXZlbCwgdGhpcy5uYW1lKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIERlZmluZSBsb2cubG9nIGFzIGFuIGFsaWFzIGZvciBsb2cuZGVidWdcbiAgICAgICAgdGhpcy5sb2cgPSB0aGlzLmRlYnVnO1xuXG4gICAgICAgIC8vIFJldHVybiBhbnkgaW1wb3J0YW50IHdhcm5pbmdzLlxuICAgICAgICBpZiAodHlwZW9mIGNvbnNvbGUgPT09IHVuZGVmaW5lZFR5cGUgJiYgbGV2ZWwgPCB0aGlzLmxldmVscy5TSUxFTlQpIHtcbiAgICAgICAgICAgIHJldHVybiBcIk5vIGNvbnNvbGUgYXZhaWxhYmxlIGZvciBsb2dnaW5nXCI7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBJbiBvbGQgSUUgdmVyc2lvbnMsIHRoZSBjb25zb2xlIGlzbid0IHByZXNlbnQgdW50aWwgeW91IGZpcnN0IG9wZW4gaXQuXG4gICAgLy8gV2UgYnVpbGQgcmVhbE1ldGhvZCgpIHJlcGxhY2VtZW50cyBoZXJlIHRoYXQgcmVnZW5lcmF0ZSBsb2dnaW5nIG1ldGhvZHNcbiAgICBmdW5jdGlvbiBlbmFibGVMb2dnaW5nV2hlbkNvbnNvbGVBcnJpdmVzKG1ldGhvZE5hbWUpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgY29uc29sZSAhPT0gdW5kZWZpbmVkVHlwZSkge1xuICAgICAgICAgICAgICAgIHJlcGxhY2VMb2dnaW5nTWV0aG9kcy5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgICAgIHRoaXNbbWV0aG9kTmFtZV0uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBCeSBkZWZhdWx0LCB3ZSB1c2UgY2xvc2VseSBib3VuZCByZWFsIG1ldGhvZHMgd2hlcmV2ZXIgcG9zc2libGUsIGFuZFxuICAgIC8vIG90aGVyd2lzZSB3ZSB3YWl0IGZvciBhIGNvbnNvbGUgdG8gYXBwZWFyLCBhbmQgdGhlbiB0cnkgYWdhaW4uXG4gICAgZnVuY3Rpb24gZGVmYXVsdE1ldGhvZEZhY3RvcnkobWV0aG9kTmFtZSwgX2xldmVsLCBfbG9nZ2VyTmFtZSkge1xuICAgICAgICAvKmpzaGludCB2YWxpZHRoaXM6dHJ1ZSAqL1xuICAgICAgICByZXR1cm4gcmVhbE1ldGhvZChtZXRob2ROYW1lKSB8fFxuICAgICAgICAgICAgICAgZW5hYmxlTG9nZ2luZ1doZW5Db25zb2xlQXJyaXZlcy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIExvZ2dlcihuYW1lLCBmYWN0b3J5KSB7XG4gICAgICAvLyBQcml2YXRlIGluc3RhbmNlIHZhcmlhYmxlcy5cbiAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgIC8qKlxuICAgICAgICogVGhlIGxldmVsIGluaGVyaXRlZCBmcm9tIGEgcGFyZW50IGxvZ2dlciAob3IgYSBnbG9iYWwgZGVmYXVsdCkuIFdlXG4gICAgICAgKiBjYWNoZSB0aGlzIGhlcmUgcmF0aGVyIHRoYW4gZGVsZWdhdGluZyB0byB0aGUgcGFyZW50IHNvIHRoYXQgaXQgc3RheXNcbiAgICAgICAqIGluIHN5bmMgd2l0aCB0aGUgYWN0dWFsIGxvZ2dpbmcgbWV0aG9kcyB0aGF0IHdlIGhhdmUgaW5zdGFsbGVkICh0aGVcbiAgICAgICAqIHBhcmVudCBjb3VsZCBjaGFuZ2UgbGV2ZWxzIGJ1dCB3ZSBtaWdodCBub3QgaGF2ZSByZWJ1aWx0IHRoZSBsb2dnZXJzXG4gICAgICAgKiBpbiB0aGlzIGNoaWxkIHlldCkuXG4gICAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAgICovXG4gICAgICB2YXIgaW5oZXJpdGVkTGV2ZWw7XG4gICAgICAvKipcbiAgICAgICAqIFRoZSBkZWZhdWx0IGxldmVsIGZvciB0aGlzIGxvZ2dlciwgaWYgYW55LiBJZiBzZXQsIHRoaXMgb3ZlcnJpZGVzXG4gICAgICAgKiBgaW5oZXJpdGVkTGV2ZWxgLlxuICAgICAgICogQHR5cGUge251bWJlcnxudWxsfVxuICAgICAgICovXG4gICAgICB2YXIgZGVmYXVsdExldmVsO1xuICAgICAgLyoqXG4gICAgICAgKiBBIHVzZXItc3BlY2lmaWMgbGV2ZWwgZm9yIHRoaXMgbG9nZ2VyLiBJZiBzZXQsIHRoaXMgb3ZlcnJpZGVzXG4gICAgICAgKiBgZGVmYXVsdExldmVsYC5cbiAgICAgICAqIEB0eXBlIHtudW1iZXJ8bnVsbH1cbiAgICAgICAqL1xuICAgICAgdmFyIHVzZXJMZXZlbDtcblxuICAgICAgdmFyIHN0b3JhZ2VLZXkgPSBcImxvZ2xldmVsXCI7XG4gICAgICBpZiAodHlwZW9mIG5hbWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgc3RvcmFnZUtleSArPSBcIjpcIiArIG5hbWU7XG4gICAgICB9IGVsc2UgaWYgKHR5cGVvZiBuYW1lID09PSBcInN5bWJvbFwiKSB7XG4gICAgICAgIHN0b3JhZ2VLZXkgPSB1bmRlZmluZWQ7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIHBlcnNpc3RMZXZlbElmUG9zc2libGUobGV2ZWxOdW0pIHtcbiAgICAgICAgICB2YXIgbGV2ZWxOYW1lID0gKGxvZ01ldGhvZHNbbGV2ZWxOdW1dIHx8ICdzaWxlbnQnKS50b1VwcGVyQ2FzZSgpO1xuXG4gICAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09IHVuZGVmaW5lZFR5cGUgfHwgIXN0b3JhZ2VLZXkpIHJldHVybjtcblxuICAgICAgICAgIC8vIFVzZSBsb2NhbFN0b3JhZ2UgaWYgYXZhaWxhYmxlXG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZVtzdG9yYWdlS2V5XSA9IGxldmVsTmFtZTtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH0gY2F0Y2ggKGlnbm9yZSkge31cblxuICAgICAgICAgIC8vIFVzZSBzZXNzaW9uIGNvb2tpZSBhcyBmYWxsYmFja1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIHdpbmRvdy5kb2N1bWVudC5jb29raWUgPVxuICAgICAgICAgICAgICAgIGVuY29kZVVSSUNvbXBvbmVudChzdG9yYWdlS2V5KSArIFwiPVwiICsgbGV2ZWxOYW1lICsgXCI7XCI7XG4gICAgICAgICAgfSBjYXRjaCAoaWdub3JlKSB7fVxuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBnZXRQZXJzaXN0ZWRMZXZlbCgpIHtcbiAgICAgICAgICB2YXIgc3RvcmVkTGV2ZWw7XG5cbiAgICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gdW5kZWZpbmVkVHlwZSB8fCAhc3RvcmFnZUtleSkgcmV0dXJuO1xuXG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgc3RvcmVkTGV2ZWwgPSB3aW5kb3cubG9jYWxTdG9yYWdlW3N0b3JhZ2VLZXldO1xuICAgICAgICAgIH0gY2F0Y2ggKGlnbm9yZSkge31cblxuICAgICAgICAgIC8vIEZhbGxiYWNrIHRvIGNvb2tpZXMgaWYgbG9jYWwgc3RvcmFnZSBnaXZlcyB1cyBub3RoaW5nXG4gICAgICAgICAgaWYgKHR5cGVvZiBzdG9yZWRMZXZlbCA9PT0gdW5kZWZpbmVkVHlwZSkge1xuICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgdmFyIGNvb2tpZSA9IHdpbmRvdy5kb2N1bWVudC5jb29raWU7XG4gICAgICAgICAgICAgICAgICB2YXIgY29va2llTmFtZSA9IGVuY29kZVVSSUNvbXBvbmVudChzdG9yYWdlS2V5KTtcbiAgICAgICAgICAgICAgICAgIHZhciBsb2NhdGlvbiA9IGNvb2tpZS5pbmRleE9mKGNvb2tpZU5hbWUgKyBcIj1cIik7XG4gICAgICAgICAgICAgICAgICBpZiAobG9jYXRpb24gIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgc3RvcmVkTGV2ZWwgPSAvXihbXjtdKykvLmV4ZWMoXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNvb2tpZS5zbGljZShsb2NhdGlvbiArIGNvb2tpZU5hbWUubGVuZ3RoICsgMSlcbiAgICAgICAgICAgICAgICAgICAgICApWzFdO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9IGNhdGNoIChpZ25vcmUpIHt9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gSWYgdGhlIHN0b3JlZCBsZXZlbCBpcyBub3QgdmFsaWQsIHRyZWF0IGl0IGFzIGlmIG5vdGhpbmcgd2FzIHN0b3JlZC5cbiAgICAgICAgICBpZiAoc2VsZi5sZXZlbHNbc3RvcmVkTGV2ZWxdID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgc3RvcmVkTGV2ZWwgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIHN0b3JlZExldmVsO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBjbGVhclBlcnNpc3RlZExldmVsKCkge1xuICAgICAgICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSB1bmRlZmluZWRUeXBlIHx8ICFzdG9yYWdlS2V5KSByZXR1cm47XG5cbiAgICAgICAgICAvLyBVc2UgbG9jYWxTdG9yYWdlIGlmIGF2YWlsYWJsZVxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShzdG9yYWdlS2V5KTtcbiAgICAgICAgICB9IGNhdGNoIChpZ25vcmUpIHt9XG5cbiAgICAgICAgICAvLyBVc2Ugc2Vzc2lvbiBjb29raWUgYXMgZmFsbGJhY2tcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICB3aW5kb3cuZG9jdW1lbnQuY29va2llID1cbiAgICAgICAgICAgICAgICBlbmNvZGVVUklDb21wb25lbnQoc3RvcmFnZUtleSkgKyBcIj07IGV4cGlyZXM9VGh1LCAwMSBKYW4gMTk3MCAwMDowMDowMCBVVENcIjtcbiAgICAgICAgICB9IGNhdGNoIChpZ25vcmUpIHt9XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIG5vcm1hbGl6ZUxldmVsKGlucHV0KSB7XG4gICAgICAgICAgdmFyIGxldmVsID0gaW5wdXQ7XG4gICAgICAgICAgaWYgKHR5cGVvZiBsZXZlbCA9PT0gXCJzdHJpbmdcIiAmJiBzZWxmLmxldmVsc1tsZXZlbC50b1VwcGVyQ2FzZSgpXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgIGxldmVsID0gc2VsZi5sZXZlbHNbbGV2ZWwudG9VcHBlckNhc2UoKV07XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh0eXBlb2YgbGV2ZWwgPT09IFwibnVtYmVyXCIgJiYgbGV2ZWwgPj0gMCAmJiBsZXZlbCA8PSBzZWxmLmxldmVscy5TSUxFTlQpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGxldmVsO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJsb2cuc2V0TGV2ZWwoKSBjYWxsZWQgd2l0aCBpbnZhbGlkIGxldmVsOiBcIiArIGlucHV0KTtcbiAgICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8qXG4gICAgICAgKlxuICAgICAgICogUHVibGljIGxvZ2dlciBBUEkgLSBzZWUgaHR0cHM6Ly9naXRodWIuY29tL3BpbXRlcnJ5L2xvZ2xldmVsIGZvciBkZXRhaWxzXG4gICAgICAgKlxuICAgICAgICovXG5cbiAgICAgIHNlbGYubmFtZSA9IG5hbWU7XG5cbiAgICAgIHNlbGYubGV2ZWxzID0geyBcIlRSQUNFXCI6IDAsIFwiREVCVUdcIjogMSwgXCJJTkZPXCI6IDIsIFwiV0FSTlwiOiAzLFxuICAgICAgICAgIFwiRVJST1JcIjogNCwgXCJTSUxFTlRcIjogNX07XG5cbiAgICAgIHNlbGYubWV0aG9kRmFjdG9yeSA9IGZhY3RvcnkgfHwgZGVmYXVsdE1ldGhvZEZhY3Rvcnk7XG5cbiAgICAgIHNlbGYuZ2V0TGV2ZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgaWYgKHVzZXJMZXZlbCAhPSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4gdXNlckxldmVsO1xuICAgICAgICAgIH0gZWxzZSBpZiAoZGVmYXVsdExldmVsICE9IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybiBkZWZhdWx0TGV2ZWw7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBpbmhlcml0ZWRMZXZlbDtcbiAgICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBzZWxmLnNldExldmVsID0gZnVuY3Rpb24gKGxldmVsLCBwZXJzaXN0KSB7XG4gICAgICAgICAgdXNlckxldmVsID0gbm9ybWFsaXplTGV2ZWwobGV2ZWwpO1xuICAgICAgICAgIGlmIChwZXJzaXN0ICE9PSBmYWxzZSkgeyAgLy8gZGVmYXVsdHMgdG8gdHJ1ZVxuICAgICAgICAgICAgICBwZXJzaXN0TGV2ZWxJZlBvc3NpYmxlKHVzZXJMZXZlbCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gTk9URTogaW4gdjIsIHRoaXMgc2hvdWxkIGNhbGwgcmVidWlsZCgpLCB3aGljaCB1cGRhdGVzIGNoaWxkcmVuLlxuICAgICAgICAgIHJldHVybiByZXBsYWNlTG9nZ2luZ01ldGhvZHMuY2FsbChzZWxmKTtcbiAgICAgIH07XG5cbiAgICAgIHNlbGYuc2V0RGVmYXVsdExldmVsID0gZnVuY3Rpb24gKGxldmVsKSB7XG4gICAgICAgICAgZGVmYXVsdExldmVsID0gbm9ybWFsaXplTGV2ZWwobGV2ZWwpO1xuICAgICAgICAgIGlmICghZ2V0UGVyc2lzdGVkTGV2ZWwoKSkge1xuICAgICAgICAgICAgICBzZWxmLnNldExldmVsKGxldmVsLCBmYWxzZSk7XG4gICAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgc2VsZi5yZXNldExldmVsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHVzZXJMZXZlbCA9IG51bGw7XG4gICAgICAgICAgY2xlYXJQZXJzaXN0ZWRMZXZlbCgpO1xuICAgICAgICAgIHJlcGxhY2VMb2dnaW5nTWV0aG9kcy5jYWxsKHNlbGYpO1xuICAgICAgfTtcblxuICAgICAgc2VsZi5lbmFibGVBbGwgPSBmdW5jdGlvbihwZXJzaXN0KSB7XG4gICAgICAgICAgc2VsZi5zZXRMZXZlbChzZWxmLmxldmVscy5UUkFDRSwgcGVyc2lzdCk7XG4gICAgICB9O1xuXG4gICAgICBzZWxmLmRpc2FibGVBbGwgPSBmdW5jdGlvbihwZXJzaXN0KSB7XG4gICAgICAgICAgc2VsZi5zZXRMZXZlbChzZWxmLmxldmVscy5TSUxFTlQsIHBlcnNpc3QpO1xuICAgICAgfTtcblxuICAgICAgc2VsZi5yZWJ1aWxkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGlmIChkZWZhdWx0TG9nZ2VyICE9PSBzZWxmKSB7XG4gICAgICAgICAgICAgIGluaGVyaXRlZExldmVsID0gbm9ybWFsaXplTGV2ZWwoZGVmYXVsdExvZ2dlci5nZXRMZXZlbCgpKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmVwbGFjZUxvZ2dpbmdNZXRob2RzLmNhbGwoc2VsZik7XG5cbiAgICAgICAgICBpZiAoZGVmYXVsdExvZ2dlciA9PT0gc2VsZikge1xuICAgICAgICAgICAgICBmb3IgKHZhciBjaGlsZE5hbWUgaW4gX2xvZ2dlcnNCeU5hbWUpIHtcbiAgICAgICAgICAgICAgICBfbG9nZ2Vyc0J5TmFtZVtjaGlsZE5hbWVdLnJlYnVpbGQoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIC8vIEluaXRpYWxpemUgYWxsIHRoZSBpbnRlcm5hbCBsZXZlbHMuXG4gICAgICBpbmhlcml0ZWRMZXZlbCA9IG5vcm1hbGl6ZUxldmVsKFxuICAgICAgICAgIGRlZmF1bHRMb2dnZXIgPyBkZWZhdWx0TG9nZ2VyLmdldExldmVsKCkgOiBcIldBUk5cIlxuICAgICAgKTtcbiAgICAgIHZhciBpbml0aWFsTGV2ZWwgPSBnZXRQZXJzaXN0ZWRMZXZlbCgpO1xuICAgICAgaWYgKGluaXRpYWxMZXZlbCAhPSBudWxsKSB7XG4gICAgICAgICAgdXNlckxldmVsID0gbm9ybWFsaXplTGV2ZWwoaW5pdGlhbExldmVsKTtcbiAgICAgIH1cbiAgICAgIHJlcGxhY2VMb2dnaW5nTWV0aG9kcy5jYWxsKHNlbGYpO1xuICAgIH1cblxuICAgIC8qXG4gICAgICpcbiAgICAgKiBUb3AtbGV2ZWwgQVBJXG4gICAgICpcbiAgICAgKi9cblxuICAgIGRlZmF1bHRMb2dnZXIgPSBuZXcgTG9nZ2VyKCk7XG5cbiAgICBkZWZhdWx0TG9nZ2VyLmdldExvZ2dlciA9IGZ1bmN0aW9uIGdldExvZ2dlcihuYW1lKSB7XG4gICAgICAgIGlmICgodHlwZW9mIG5hbWUgIT09IFwic3ltYm9sXCIgJiYgdHlwZW9mIG5hbWUgIT09IFwic3RyaW5nXCIpIHx8IG5hbWUgPT09IFwiXCIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJZb3UgbXVzdCBzdXBwbHkgYSBuYW1lIHdoZW4gY3JlYXRpbmcgYSBsb2dnZXIuXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGxvZ2dlciA9IF9sb2dnZXJzQnlOYW1lW25hbWVdO1xuICAgICAgICBpZiAoIWxvZ2dlcikge1xuICAgICAgICAgICAgbG9nZ2VyID0gX2xvZ2dlcnNCeU5hbWVbbmFtZV0gPSBuZXcgTG9nZ2VyKFxuICAgICAgICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgICAgICAgZGVmYXVsdExvZ2dlci5tZXRob2RGYWN0b3J5XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBsb2dnZXI7XG4gICAgfTtcblxuICAgIC8vIEdyYWIgdGhlIGN1cnJlbnQgZ2xvYmFsIGxvZyB2YXJpYWJsZSBpbiBjYXNlIG9mIG92ZXJ3cml0ZVxuICAgIHZhciBfbG9nID0gKHR5cGVvZiB3aW5kb3cgIT09IHVuZGVmaW5lZFR5cGUpID8gd2luZG93LmxvZyA6IHVuZGVmaW5lZDtcbiAgICBkZWZhdWx0TG9nZ2VyLm5vQ29uZmxpY3QgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09IHVuZGVmaW5lZFR5cGUgJiZcbiAgICAgICAgICAgICAgIHdpbmRvdy5sb2cgPT09IGRlZmF1bHRMb2dnZXIpIHtcbiAgICAgICAgICAgIHdpbmRvdy5sb2cgPSBfbG9nO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGRlZmF1bHRMb2dnZXI7XG4gICAgfTtcblxuICAgIGRlZmF1bHRMb2dnZXIuZ2V0TG9nZ2VycyA9IGZ1bmN0aW9uIGdldExvZ2dlcnMoKSB7XG4gICAgICAgIHJldHVybiBfbG9nZ2Vyc0J5TmFtZTtcbiAgICB9O1xuXG4gICAgLy8gRVM2IGRlZmF1bHQgZXhwb3J0LCBmb3IgY29tcGF0aWJpbGl0eVxuICAgIGRlZmF1bHRMb2dnZXJbJ2RlZmF1bHQnXSA9IGRlZmF1bHRMb2dnZXI7XG5cbiAgICByZXR1cm4gZGVmYXVsdExvZ2dlcjtcbn0pKTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\n')},"./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/contrib/backo2.js":
/*!*************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/contrib/backo2.js ***!
  \*************************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Backoff: () => (/* binding */ Backoff)\n/* harmony export */ });\n/**\n * Initialize backoff timer with `opts`.\n *\n * - `min` initial timeout in milliseconds [100]\n * - `max` max timeout [10000]\n * - `jitter` [0]\n * - `factor` [2]\n *\n * @param {Object} opts\n * @api public\n */\nfunction Backoff(opts) {\n    opts = opts || {};\n    this.ms = opts.min || 100;\n    this.max = opts.max || 10000;\n    this.factor = opts.factor || 2;\n    this.jitter = opts.jitter > 0 && opts.jitter <= 1 ? opts.jitter : 0;\n    this.attempts = 0;\n}\n/**\n * Return the backoff duration.\n *\n * @return {Number}\n * @api public\n */\nBackoff.prototype.duration = function () {\n    var ms = this.ms * Math.pow(this.factor, this.attempts++);\n    if (this.jitter) {\n        var rand = Math.random();\n        var deviation = Math.floor(rand * this.jitter * ms);\n        ms = (Math.floor(rand * 10) & 1) == 0 ? ms - deviation : ms + deviation;\n    }\n    return Math.min(ms, this.max) | 0;\n};\n/**\n * Reset the number of attempts.\n *\n * @api public\n */\nBackoff.prototype.reset = function () {\n    this.attempts = 0;\n};\n/**\n * Set the minimum duration\n *\n * @api public\n */\nBackoff.prototype.setMin = function (min) {\n    this.ms = min;\n};\n/**\n * Set the maximum duration\n *\n * @api public\n */\nBackoff.prototype.setMax = function (max) {\n    this.max = max;\n};\n/**\n * Set the jitter\n *\n * @api public\n */\nBackoff.prototype.setJitter = function (jitter) {\n    this.jitter = jitter;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLWNsaWVudEA0LjguMS9ub2RlX21vZHVsZXMvc29ja2V0LmlvLWNsaWVudC9idWlsZC9lc20vY29udHJpYi9iYWNrbzIuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFFBQVE7QUFDbkI7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLWNsaWVudEA0LjguMS9ub2RlX21vZHVsZXMvc29ja2V0LmlvLWNsaWVudC9idWlsZC9lc20vY29udHJpYi9iYWNrbzIuanM/MDMyYiJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEluaXRpYWxpemUgYmFja29mZiB0aW1lciB3aXRoIGBvcHRzYC5cbiAqXG4gKiAtIGBtaW5gIGluaXRpYWwgdGltZW91dCBpbiBtaWxsaXNlY29uZHMgWzEwMF1cbiAqIC0gYG1heGAgbWF4IHRpbWVvdXQgWzEwMDAwXVxuICogLSBgaml0dGVyYCBbMF1cbiAqIC0gYGZhY3RvcmAgWzJdXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IG9wdHNcbiAqIEBhcGkgcHVibGljXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBCYWNrb2ZmKG9wdHMpIHtcbiAgICBvcHRzID0gb3B0cyB8fCB7fTtcbiAgICB0aGlzLm1zID0gb3B0cy5taW4gfHwgMTAwO1xuICAgIHRoaXMubWF4ID0gb3B0cy5tYXggfHwgMTAwMDA7XG4gICAgdGhpcy5mYWN0b3IgPSBvcHRzLmZhY3RvciB8fCAyO1xuICAgIHRoaXMuaml0dGVyID0gb3B0cy5qaXR0ZXIgPiAwICYmIG9wdHMuaml0dGVyIDw9IDEgPyBvcHRzLmppdHRlciA6IDA7XG4gICAgdGhpcy5hdHRlbXB0cyA9IDA7XG59XG4vKipcbiAqIFJldHVybiB0aGUgYmFja29mZiBkdXJhdGlvbi5cbiAqXG4gKiBAcmV0dXJuIHtOdW1iZXJ9XG4gKiBAYXBpIHB1YmxpY1xuICovXG5CYWNrb2ZmLnByb3RvdHlwZS5kdXJhdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgbXMgPSB0aGlzLm1zICogTWF0aC5wb3codGhpcy5mYWN0b3IsIHRoaXMuYXR0ZW1wdHMrKyk7XG4gICAgaWYgKHRoaXMuaml0dGVyKSB7XG4gICAgICAgIHZhciByYW5kID0gTWF0aC5yYW5kb20oKTtcbiAgICAgICAgdmFyIGRldmlhdGlvbiA9IE1hdGguZmxvb3IocmFuZCAqIHRoaXMuaml0dGVyICogbXMpO1xuICAgICAgICBtcyA9IChNYXRoLmZsb29yKHJhbmQgKiAxMCkgJiAxKSA9PSAwID8gbXMgLSBkZXZpYXRpb24gOiBtcyArIGRldmlhdGlvbjtcbiAgICB9XG4gICAgcmV0dXJuIE1hdGgubWluKG1zLCB0aGlzLm1heCkgfCAwO1xufTtcbi8qKlxuICogUmVzZXQgdGhlIG51bWJlciBvZiBhdHRlbXB0cy5cbiAqXG4gKiBAYXBpIHB1YmxpY1xuICovXG5CYWNrb2ZmLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmF0dGVtcHRzID0gMDtcbn07XG4vKipcbiAqIFNldCB0aGUgbWluaW11bSBkdXJhdGlvblxuICpcbiAqIEBhcGkgcHVibGljXG4gKi9cbkJhY2tvZmYucHJvdG90eXBlLnNldE1pbiA9IGZ1bmN0aW9uIChtaW4pIHtcbiAgICB0aGlzLm1zID0gbWluO1xufTtcbi8qKlxuICogU2V0IHRoZSBtYXhpbXVtIGR1cmF0aW9uXG4gKlxuICogQGFwaSBwdWJsaWNcbiAqL1xuQmFja29mZi5wcm90b3R5cGUuc2V0TWF4ID0gZnVuY3Rpb24gKG1heCkge1xuICAgIHRoaXMubWF4ID0gbWF4O1xufTtcbi8qKlxuICogU2V0IHRoZSBqaXR0ZXJcbiAqXG4gKiBAYXBpIHB1YmxpY1xuICovXG5CYWNrb2ZmLnByb3RvdHlwZS5zZXRKaXR0ZXIgPSBmdW5jdGlvbiAoaml0dGVyKSB7XG4gICAgdGhpcy5qaXR0ZXIgPSBqaXR0ZXI7XG59O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/contrib/backo2.js\n")},"./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/index.js":
/*!****************************************************************************************************!*\
  !*** ./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/index.js ***!
  \****************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Fetch: () => (/* reexport safe */ engine_io_client__WEBPACK_IMPORTED_MODULE_4__.Fetch),\n/* harmony export */   Manager: () => (/* reexport safe */ _manager_js__WEBPACK_IMPORTED_MODULE_1__.Manager),\n/* harmony export */   NodeWebSocket: () => (/* reexport safe */ engine_io_client__WEBPACK_IMPORTED_MODULE_4__.NodeWebSocket),\n/* harmony export */   NodeXHR: () => (/* reexport safe */ engine_io_client__WEBPACK_IMPORTED_MODULE_4__.NodeXHR),\n/* harmony export */   Socket: () => (/* reexport safe */ _socket_js__WEBPACK_IMPORTED_MODULE_2__.Socket),\n/* harmony export */   WebSocket: () => (/* reexport safe */ engine_io_client__WEBPACK_IMPORTED_MODULE_4__.WebSocket),\n/* harmony export */   WebTransport: () => (/* reexport safe */ engine_io_client__WEBPACK_IMPORTED_MODULE_4__.WebTransport),\n/* harmony export */   XHR: () => (/* reexport safe */ engine_io_client__WEBPACK_IMPORTED_MODULE_4__.XHR),\n/* harmony export */   connect: () => (/* binding */ lookup),\n/* harmony export */   "default": () => (/* binding */ lookup),\n/* harmony export */   io: () => (/* binding */ lookup),\n/* harmony export */   protocol: () => (/* reexport safe */ socket_io_parser__WEBPACK_IMPORTED_MODULE_3__.protocol)\n/* harmony export */ });\n/* harmony import */ var _url_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./url.js */ "./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/url.js");\n/* harmony import */ var _manager_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./manager.js */ "./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/manager.js");\n/* harmony import */ var _socket_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./socket.js */ "./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/socket.js");\n/* harmony import */ var socket_io_parser__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! socket.io-parser */ "./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/index.js");\n/* harmony import */ var engine_io_client__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! engine.io-client */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/index.js");\n\n\n\n/**\n * Managers cache.\n */\nconst cache = {};\nfunction lookup(uri, opts) {\n    if (typeof uri === "object") {\n        opts = uri;\n        uri = undefined;\n    }\n    opts = opts || {};\n    const parsed = (0,_url_js__WEBPACK_IMPORTED_MODULE_0__.url)(uri, opts.path || "/socket.io");\n    const source = parsed.source;\n    const id = parsed.id;\n    const path = parsed.path;\n    const sameNamespace = cache[id] && path in cache[id]["nsps"];\n    const newConnection = opts.forceNew ||\n        opts["force new connection"] ||\n        false === opts.multiplex ||\n        sameNamespace;\n    let io;\n    if (newConnection) {\n        io = new _manager_js__WEBPACK_IMPORTED_MODULE_1__.Manager(source, opts);\n    }\n    else {\n        if (!cache[id]) {\n            cache[id] = new _manager_js__WEBPACK_IMPORTED_MODULE_1__.Manager(source, opts);\n        }\n        io = cache[id];\n    }\n    if (parsed.query && !opts.query) {\n        opts.query = parsed.queryKey;\n    }\n    return io.socket(parsed.path, opts);\n}\n// so that "lookup" can be used both as a function (e.g. `io(...)`) and as a\n// namespace (e.g. `io.connect(...)`), for backward compatibility\nObject.assign(lookup, {\n    Manager: _manager_js__WEBPACK_IMPORTED_MODULE_1__.Manager,\n    Socket: _socket_js__WEBPACK_IMPORTED_MODULE_2__.Socket,\n    io: lookup,\n    connect: lookup,\n});\n/**\n * Protocol version.\n *\n * @public\n */\n\n/**\n * Expose constructors for standalone build.\n *\n * @public\n */\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLWNsaWVudEA0LjguMS9ub2RlX21vZHVsZXMvc29ja2V0LmlvLWNsaWVudC9idWlsZC9lc20vaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBK0I7QUFDUTtBQUNGO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLDRDQUFHO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLGdEQUFPO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixnREFBTztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYLFVBQVU7QUFDVjtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDNEM7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNnRjtBQUNnQiIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL25vZGVfbW9kdWxlcy8ucG5wbS9zb2NrZXQuaW8tY2xpZW50QDQuOC4xL25vZGVfbW9kdWxlcy9zb2NrZXQuaW8tY2xpZW50L2J1aWxkL2VzbS9pbmRleC5qcz8zODUxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVybCB9IGZyb20gXCIuL3VybC5qc1wiO1xuaW1wb3J0IHsgTWFuYWdlciB9IGZyb20gXCIuL21hbmFnZXIuanNcIjtcbmltcG9ydCB7IFNvY2tldCB9IGZyb20gXCIuL3NvY2tldC5qc1wiO1xuLyoqXG4gKiBNYW5hZ2VycyBjYWNoZS5cbiAqL1xuY29uc3QgY2FjaGUgPSB7fTtcbmZ1bmN0aW9uIGxvb2t1cCh1cmksIG9wdHMpIHtcbiAgICBpZiAodHlwZW9mIHVyaSA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICBvcHRzID0gdXJpO1xuICAgICAgICB1cmkgPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIG9wdHMgPSBvcHRzIHx8IHt9O1xuICAgIGNvbnN0IHBhcnNlZCA9IHVybCh1cmksIG9wdHMucGF0aCB8fCBcIi9zb2NrZXQuaW9cIik7XG4gICAgY29uc3Qgc291cmNlID0gcGFyc2VkLnNvdXJjZTtcbiAgICBjb25zdCBpZCA9IHBhcnNlZC5pZDtcbiAgICBjb25zdCBwYXRoID0gcGFyc2VkLnBhdGg7XG4gICAgY29uc3Qgc2FtZU5hbWVzcGFjZSA9IGNhY2hlW2lkXSAmJiBwYXRoIGluIGNhY2hlW2lkXVtcIm5zcHNcIl07XG4gICAgY29uc3QgbmV3Q29ubmVjdGlvbiA9IG9wdHMuZm9yY2VOZXcgfHxcbiAgICAgICAgb3B0c1tcImZvcmNlIG5ldyBjb25uZWN0aW9uXCJdIHx8XG4gICAgICAgIGZhbHNlID09PSBvcHRzLm11bHRpcGxleCB8fFxuICAgICAgICBzYW1lTmFtZXNwYWNlO1xuICAgIGxldCBpbztcbiAgICBpZiAobmV3Q29ubmVjdGlvbikge1xuICAgICAgICBpbyA9IG5ldyBNYW5hZ2VyKHNvdXJjZSwgb3B0cyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpZiAoIWNhY2hlW2lkXSkge1xuICAgICAgICAgICAgY2FjaGVbaWRdID0gbmV3IE1hbmFnZXIoc291cmNlLCBvcHRzKTtcbiAgICAgICAgfVxuICAgICAgICBpbyA9IGNhY2hlW2lkXTtcbiAgICB9XG4gICAgaWYgKHBhcnNlZC5xdWVyeSAmJiAhb3B0cy5xdWVyeSkge1xuICAgICAgICBvcHRzLnF1ZXJ5ID0gcGFyc2VkLnF1ZXJ5S2V5O1xuICAgIH1cbiAgICByZXR1cm4gaW8uc29ja2V0KHBhcnNlZC5wYXRoLCBvcHRzKTtcbn1cbi8vIHNvIHRoYXQgXCJsb29rdXBcIiBjYW4gYmUgdXNlZCBib3RoIGFzIGEgZnVuY3Rpb24gKGUuZy4gYGlvKC4uLilgKSBhbmQgYXMgYVxuLy8gbmFtZXNwYWNlIChlLmcuIGBpby5jb25uZWN0KC4uLilgKSwgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHlcbk9iamVjdC5hc3NpZ24obG9va3VwLCB7XG4gICAgTWFuYWdlcixcbiAgICBTb2NrZXQsXG4gICAgaW86IGxvb2t1cCxcbiAgICBjb25uZWN0OiBsb29rdXAsXG59KTtcbi8qKlxuICogUHJvdG9jb2wgdmVyc2lvbi5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCB7IHByb3RvY29sIH0gZnJvbSBcInNvY2tldC5pby1wYXJzZXJcIjtcbi8qKlxuICogRXhwb3NlIGNvbnN0cnVjdG9ycyBmb3Igc3RhbmRhbG9uZSBidWlsZC5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCB7IE1hbmFnZXIsIFNvY2tldCwgbG9va3VwIGFzIGlvLCBsb29rdXAgYXMgY29ubmVjdCwgbG9va3VwIGFzIGRlZmF1bHQsIH07XG5leHBvcnQgeyBGZXRjaCwgTm9kZVhIUiwgWEhSLCBOb2RlV2ViU29ja2V0LCBXZWJTb2NrZXQsIFdlYlRyYW5zcG9ydCwgfSBmcm9tIFwiZW5naW5lLmlvLWNsaWVudFwiO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/index.js\n')},"./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/manager.js":
/*!******************************************************************************************************!*\
  !*** ./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/manager.js ***!
  \******************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Manager: () => (/* binding */ Manager)\n/* harmony export */ });\n/* harmony import */ var engine_io_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! engine.io-client */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/index.js");\n/* harmony import */ var _socket_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./socket.js */ "./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/socket.js");\n/* harmony import */ var socket_io_parser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! socket.io-parser */ "./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/index.js");\n/* harmony import */ var _on_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./on.js */ "./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/on.js");\n/* harmony import */ var _contrib_backo2_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./contrib/backo2.js */ "./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/contrib/backo2.js");\n/* harmony import */ var _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @socket.io/component-emitter */ "./node_modules/.pnpm/@socket.io+component-emitter@3.1.2/node_modules/@socket.io/component-emitter/lib/esm/index.js");\n\n\n\n\n\n\nclass Manager extends _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_5__.Emitter {\n    constructor(uri, opts) {\n        var _a;\n        super();\n        this.nsps = {};\n        this.subs = [];\n        if (uri && "object" === typeof uri) {\n            opts = uri;\n            uri = undefined;\n        }\n        opts = opts || {};\n        opts.path = opts.path || "/socket.io";\n        this.opts = opts;\n        (0,engine_io_client__WEBPACK_IMPORTED_MODULE_0__.installTimerFunctions)(this, opts);\n        this.reconnection(opts.reconnection !== false);\n        this.reconnectionAttempts(opts.reconnectionAttempts || Infinity);\n        this.reconnectionDelay(opts.reconnectionDelay || 1000);\n        this.reconnectionDelayMax(opts.reconnectionDelayMax || 5000);\n        this.randomizationFactor((_a = opts.randomizationFactor) !== null && _a !== void 0 ? _a : 0.5);\n        this.backoff = new _contrib_backo2_js__WEBPACK_IMPORTED_MODULE_4__.Backoff({\n            min: this.reconnectionDelay(),\n            max: this.reconnectionDelayMax(),\n            jitter: this.randomizationFactor(),\n        });\n        this.timeout(null == opts.timeout ? 20000 : opts.timeout);\n        this._readyState = "closed";\n        this.uri = uri;\n        const _parser = opts.parser || socket_io_parser__WEBPACK_IMPORTED_MODULE_2__;\n        this.encoder = new _parser.Encoder();\n        this.decoder = new _parser.Decoder();\n        this._autoConnect = opts.autoConnect !== false;\n        if (this._autoConnect)\n            this.open();\n    }\n    reconnection(v) {\n        if (!arguments.length)\n            return this._reconnection;\n        this._reconnection = !!v;\n        if (!v) {\n            this.skipReconnect = true;\n        }\n        return this;\n    }\n    reconnectionAttempts(v) {\n        if (v === undefined)\n            return this._reconnectionAttempts;\n        this._reconnectionAttempts = v;\n        return this;\n    }\n    reconnectionDelay(v) {\n        var _a;\n        if (v === undefined)\n            return this._reconnectionDelay;\n        this._reconnectionDelay = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setMin(v);\n        return this;\n    }\n    randomizationFactor(v) {\n        var _a;\n        if (v === undefined)\n            return this._randomizationFactor;\n        this._randomizationFactor = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setJitter(v);\n        return this;\n    }\n    reconnectionDelayMax(v) {\n        var _a;\n        if (v === undefined)\n            return this._reconnectionDelayMax;\n        this._reconnectionDelayMax = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setMax(v);\n        return this;\n    }\n    timeout(v) {\n        if (!arguments.length)\n            return this._timeout;\n        this._timeout = v;\n        return this;\n    }\n    /**\n     * Starts trying to reconnect if reconnection is enabled and we have not\n     * started reconnecting yet\n     *\n     * @private\n     */\n    maybeReconnectOnOpen() {\n        // Only try to reconnect if it\'s the first time we\'re connecting\n        if (!this._reconnecting &&\n            this._reconnection &&\n            this.backoff.attempts === 0) {\n            // keeps reconnection from firing twice for the same reconnection loop\n            this.reconnect();\n        }\n    }\n    /**\n     * Sets the current transport `socket`.\n     *\n     * @param {Function} fn - optional, callback\n     * @return self\n     * @public\n     */\n    open(fn) {\n        if (~this._readyState.indexOf("open"))\n            return this;\n        this.engine = new engine_io_client__WEBPACK_IMPORTED_MODULE_0__.Socket(this.uri, this.opts);\n        const socket = this.engine;\n        const self = this;\n        this._readyState = "opening";\n        this.skipReconnect = false;\n        // emit `open`\n        const openSubDestroy = (0,_on_js__WEBPACK_IMPORTED_MODULE_3__.on)(socket, "open", function () {\n            self.onopen();\n            fn && fn();\n        });\n        const onError = (err) => {\n            this.cleanup();\n            this._readyState = "closed";\n            this.emitReserved("error", err);\n            if (fn) {\n                fn(err);\n            }\n            else {\n                // Only do this if there is no fn to handle the error\n                this.maybeReconnectOnOpen();\n            }\n        };\n        // emit `error`\n        const errorSub = (0,_on_js__WEBPACK_IMPORTED_MODULE_3__.on)(socket, "error", onError);\n        if (false !== this._timeout) {\n            const timeout = this._timeout;\n            // set timer\n            const timer = this.setTimeoutFn(() => {\n                openSubDestroy();\n                onError(new Error("timeout"));\n                socket.close();\n            }, timeout);\n            if (this.opts.autoUnref) {\n                timer.unref();\n            }\n            this.subs.push(() => {\n                this.clearTimeoutFn(timer);\n            });\n        }\n        this.subs.push(openSubDestroy);\n        this.subs.push(errorSub);\n        return this;\n    }\n    /**\n     * Alias for open()\n     *\n     * @return self\n     * @public\n     */\n    connect(fn) {\n        return this.open(fn);\n    }\n    /**\n     * Called upon transport open.\n     *\n     * @private\n     */\n    onopen() {\n        // clear old subs\n        this.cleanup();\n        // mark as open\n        this._readyState = "open";\n        this.emitReserved("open");\n        // add new subs\n        const socket = this.engine;\n        this.subs.push((0,_on_js__WEBPACK_IMPORTED_MODULE_3__.on)(socket, "ping", this.onping.bind(this)), (0,_on_js__WEBPACK_IMPORTED_MODULE_3__.on)(socket, "data", this.ondata.bind(this)), (0,_on_js__WEBPACK_IMPORTED_MODULE_3__.on)(socket, "error", this.onerror.bind(this)), (0,_on_js__WEBPACK_IMPORTED_MODULE_3__.on)(socket, "close", this.onclose.bind(this)), \n        // @ts-ignore\n        (0,_on_js__WEBPACK_IMPORTED_MODULE_3__.on)(this.decoder, "decoded", this.ondecoded.bind(this)));\n    }\n    /**\n     * Called upon a ping.\n     *\n     * @private\n     */\n    onping() {\n        this.emitReserved("ping");\n    }\n    /**\n     * Called with data.\n     *\n     * @private\n     */\n    ondata(data) {\n        try {\n            this.decoder.add(data);\n        }\n        catch (e) {\n            this.onclose("parse error", e);\n        }\n    }\n    /**\n     * Called when parser fully decodes a packet.\n     *\n     * @private\n     */\n    ondecoded(packet) {\n        // the nextTick call prevents an exception in a user-provided event listener from triggering a disconnection due to a "parse error"\n        (0,engine_io_client__WEBPACK_IMPORTED_MODULE_0__.nextTick)(() => {\n            this.emitReserved("packet", packet);\n        }, this.setTimeoutFn);\n    }\n    /**\n     * Called upon socket error.\n     *\n     * @private\n     */\n    onerror(err) {\n        this.emitReserved("error", err);\n    }\n    /**\n     * Creates a new socket for the given `nsp`.\n     *\n     * @return {Socket}\n     * @public\n     */\n    socket(nsp, opts) {\n        let socket = this.nsps[nsp];\n        if (!socket) {\n            socket = new _socket_js__WEBPACK_IMPORTED_MODULE_1__.Socket(this, nsp, opts);\n            this.nsps[nsp] = socket;\n        }\n        else if (this._autoConnect && !socket.active) {\n            socket.connect();\n        }\n        return socket;\n    }\n    /**\n     * Called upon a socket close.\n     *\n     * @param socket\n     * @private\n     */\n    _destroy(socket) {\n        const nsps = Object.keys(this.nsps);\n        for (const nsp of nsps) {\n            const socket = this.nsps[nsp];\n            if (socket.active) {\n                return;\n            }\n        }\n        this._close();\n    }\n    /**\n     * Writes a packet.\n     *\n     * @param packet\n     * @private\n     */\n    _packet(packet) {\n        const encodedPackets = this.encoder.encode(packet);\n        for (let i = 0; i < encodedPackets.length; i++) {\n            this.engine.write(encodedPackets[i], packet.options);\n        }\n    }\n    /**\n     * Clean up transport subscriptions and packet buffer.\n     *\n     * @private\n     */\n    cleanup() {\n        this.subs.forEach((subDestroy) => subDestroy());\n        this.subs.length = 0;\n        this.decoder.destroy();\n    }\n    /**\n     * Close the current socket.\n     *\n     * @private\n     */\n    _close() {\n        this.skipReconnect = true;\n        this._reconnecting = false;\n        this.onclose("forced close");\n    }\n    /**\n     * Alias for close()\n     *\n     * @private\n     */\n    disconnect() {\n        return this._close();\n    }\n    /**\n     * Called when:\n     *\n     * - the low-level engine is closed\n     * - the parser encountered a badly formatted packet\n     * - all sockets are disconnected\n     *\n     * @private\n     */\n    onclose(reason, description) {\n        var _a;\n        this.cleanup();\n        (_a = this.engine) === null || _a === void 0 ? void 0 : _a.close();\n        this.backoff.reset();\n        this._readyState = "closed";\n        this.emitReserved("close", reason, description);\n        if (this._reconnection && !this.skipReconnect) {\n            this.reconnect();\n        }\n    }\n    /**\n     * Attempt a reconnection.\n     *\n     * @private\n     */\n    reconnect() {\n        if (this._reconnecting || this.skipReconnect)\n            return this;\n        const self = this;\n        if (this.backoff.attempts >= this._reconnectionAttempts) {\n            this.backoff.reset();\n            this.emitReserved("reconnect_failed");\n            this._reconnecting = false;\n        }\n        else {\n            const delay = this.backoff.duration();\n            this._reconnecting = true;\n            const timer = this.setTimeoutFn(() => {\n                if (self.skipReconnect)\n                    return;\n                this.emitReserved("reconnect_attempt", self.backoff.attempts);\n                // check again for the case socket closed in above events\n                if (self.skipReconnect)\n                    return;\n                self.open((err) => {\n                    if (err) {\n                        self._reconnecting = false;\n                        self.reconnect();\n                        this.emitReserved("reconnect_error", err);\n                    }\n                    else {\n                        self.onreconnect();\n                    }\n                });\n            }, delay);\n            if (this.opts.autoUnref) {\n                timer.unref();\n            }\n            this.subs.push(() => {\n                this.clearTimeoutFn(timer);\n            });\n        }\n    }\n    /**\n     * Called upon successful reconnect.\n     *\n     * @private\n     */\n    onreconnect() {\n        const attempt = this.backoff.attempts;\n        this._reconnecting = false;\n        this.backoff.reset();\n        this.emitReserved("reconnect", attempt);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLWNsaWVudEA0LjguMS9ub2RlX21vZHVsZXMvc29ja2V0LmlvLWNsaWVudC9idWlsZC9lc20vbWFuYWdlci5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQXNGO0FBQ2pEO0FBQ007QUFDZDtBQUNpQjtBQUNVO0FBQ2pELHNCQUFzQixpRUFBTztBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLHVFQUFxQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLHVEQUFPO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUMsNkNBQU07QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxVQUFVO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixvREFBTTtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLDBDQUFFO0FBQ2pDO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsMENBQUU7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsMENBQUUsMENBQTBDLDBDQUFFLDBDQUEwQywwQ0FBRSw0Q0FBNEMsMENBQUU7QUFDL0o7QUFDQSxRQUFRLDBDQUFFO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsMERBQVE7QUFDaEI7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsOENBQU07QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsMkJBQTJCO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL3NvY2tldC5pby1jbGllbnRANC44LjEvbm9kZV9tb2R1bGVzL3NvY2tldC5pby1jbGllbnQvYnVpbGQvZXNtL21hbmFnZXIuanM/NmNmZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBTb2NrZXQgYXMgRW5naW5lLCBpbnN0YWxsVGltZXJGdW5jdGlvbnMsIG5leHRUaWNrLCB9IGZyb20gXCJlbmdpbmUuaW8tY2xpZW50XCI7XG5pbXBvcnQgeyBTb2NrZXQgfSBmcm9tIFwiLi9zb2NrZXQuanNcIjtcbmltcG9ydCAqIGFzIHBhcnNlciBmcm9tIFwic29ja2V0LmlvLXBhcnNlclwiO1xuaW1wb3J0IHsgb24gfSBmcm9tIFwiLi9vbi5qc1wiO1xuaW1wb3J0IHsgQmFja29mZiB9IGZyb20gXCIuL2NvbnRyaWIvYmFja28yLmpzXCI7XG5pbXBvcnQgeyBFbWl0dGVyLCB9IGZyb20gXCJAc29ja2V0LmlvL2NvbXBvbmVudC1lbWl0dGVyXCI7XG5leHBvcnQgY2xhc3MgTWFuYWdlciBleHRlbmRzIEVtaXR0ZXIge1xuICAgIGNvbnN0cnVjdG9yKHVyaSwgb3B0cykge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMubnNwcyA9IHt9O1xuICAgICAgICB0aGlzLnN1YnMgPSBbXTtcbiAgICAgICAgaWYgKHVyaSAmJiBcIm9iamVjdFwiID09PSB0eXBlb2YgdXJpKSB7XG4gICAgICAgICAgICBvcHRzID0gdXJpO1xuICAgICAgICAgICAgdXJpID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIG9wdHMgPSBvcHRzIHx8IHt9O1xuICAgICAgICBvcHRzLnBhdGggPSBvcHRzLnBhdGggfHwgXCIvc29ja2V0LmlvXCI7XG4gICAgICAgIHRoaXMub3B0cyA9IG9wdHM7XG4gICAgICAgIGluc3RhbGxUaW1lckZ1bmN0aW9ucyh0aGlzLCBvcHRzKTtcbiAgICAgICAgdGhpcy5yZWNvbm5lY3Rpb24ob3B0cy5yZWNvbm5lY3Rpb24gIT09IGZhbHNlKTtcbiAgICAgICAgdGhpcy5yZWNvbm5lY3Rpb25BdHRlbXB0cyhvcHRzLnJlY29ubmVjdGlvbkF0dGVtcHRzIHx8IEluZmluaXR5KTtcbiAgICAgICAgdGhpcy5yZWNvbm5lY3Rpb25EZWxheShvcHRzLnJlY29ubmVjdGlvbkRlbGF5IHx8IDEwMDApO1xuICAgICAgICB0aGlzLnJlY29ubmVjdGlvbkRlbGF5TWF4KG9wdHMucmVjb25uZWN0aW9uRGVsYXlNYXggfHwgNTAwMCk7XG4gICAgICAgIHRoaXMucmFuZG9taXphdGlvbkZhY3RvcigoX2EgPSBvcHRzLnJhbmRvbWl6YXRpb25GYWN0b3IpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IDAuNSk7XG4gICAgICAgIHRoaXMuYmFja29mZiA9IG5ldyBCYWNrb2ZmKHtcbiAgICAgICAgICAgIG1pbjogdGhpcy5yZWNvbm5lY3Rpb25EZWxheSgpLFxuICAgICAgICAgICAgbWF4OiB0aGlzLnJlY29ubmVjdGlvbkRlbGF5TWF4KCksXG4gICAgICAgICAgICBqaXR0ZXI6IHRoaXMucmFuZG9taXphdGlvbkZhY3RvcigpLFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy50aW1lb3V0KG51bGwgPT0gb3B0cy50aW1lb3V0ID8gMjAwMDAgOiBvcHRzLnRpbWVvdXQpO1xuICAgICAgICB0aGlzLl9yZWFkeVN0YXRlID0gXCJjbG9zZWRcIjtcbiAgICAgICAgdGhpcy51cmkgPSB1cmk7XG4gICAgICAgIGNvbnN0IF9wYXJzZXIgPSBvcHRzLnBhcnNlciB8fCBwYXJzZXI7XG4gICAgICAgIHRoaXMuZW5jb2RlciA9IG5ldyBfcGFyc2VyLkVuY29kZXIoKTtcbiAgICAgICAgdGhpcy5kZWNvZGVyID0gbmV3IF9wYXJzZXIuRGVjb2RlcigpO1xuICAgICAgICB0aGlzLl9hdXRvQ29ubmVjdCA9IG9wdHMuYXV0b0Nvbm5lY3QgIT09IGZhbHNlO1xuICAgICAgICBpZiAodGhpcy5fYXV0b0Nvbm5lY3QpXG4gICAgICAgICAgICB0aGlzLm9wZW4oKTtcbiAgICB9XG4gICAgcmVjb25uZWN0aW9uKHYpIHtcbiAgICAgICAgaWYgKCFhcmd1bWVudHMubGVuZ3RoKVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlY29ubmVjdGlvbjtcbiAgICAgICAgdGhpcy5fcmVjb25uZWN0aW9uID0gISF2O1xuICAgICAgICBpZiAoIXYpIHtcbiAgICAgICAgICAgIHRoaXMuc2tpcFJlY29ubmVjdCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHJlY29ubmVjdGlvbkF0dGVtcHRzKHYpIHtcbiAgICAgICAgaWYgKHYgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZWNvbm5lY3Rpb25BdHRlbXB0cztcbiAgICAgICAgdGhpcy5fcmVjb25uZWN0aW9uQXR0ZW1wdHMgPSB2O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgcmVjb25uZWN0aW9uRGVsYXkodikge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGlmICh2ID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVjb25uZWN0aW9uRGVsYXk7XG4gICAgICAgIHRoaXMuX3JlY29ubmVjdGlvbkRlbGF5ID0gdjtcbiAgICAgICAgKF9hID0gdGhpcy5iYWNrb2ZmKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Euc2V0TWluKHYpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgcmFuZG9taXphdGlvbkZhY3Rvcih2KSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgaWYgKHYgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9yYW5kb21pemF0aW9uRmFjdG9yO1xuICAgICAgICB0aGlzLl9yYW5kb21pemF0aW9uRmFjdG9yID0gdjtcbiAgICAgICAgKF9hID0gdGhpcy5iYWNrb2ZmKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Euc2V0Sml0dGVyKHYpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgcmVjb25uZWN0aW9uRGVsYXlNYXgodikge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGlmICh2ID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVjb25uZWN0aW9uRGVsYXlNYXg7XG4gICAgICAgIHRoaXMuX3JlY29ubmVjdGlvbkRlbGF5TWF4ID0gdjtcbiAgICAgICAgKF9hID0gdGhpcy5iYWNrb2ZmKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Euc2V0TWF4KHYpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgdGltZW91dCh2KSB7XG4gICAgICAgIGlmICghYXJndW1lbnRzLmxlbmd0aClcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl90aW1lb3V0O1xuICAgICAgICB0aGlzLl90aW1lb3V0ID0gdjtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN0YXJ0cyB0cnlpbmcgdG8gcmVjb25uZWN0IGlmIHJlY29ubmVjdGlvbiBpcyBlbmFibGVkIGFuZCB3ZSBoYXZlIG5vdFxuICAgICAqIHN0YXJ0ZWQgcmVjb25uZWN0aW5nIHlldFxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBtYXliZVJlY29ubmVjdE9uT3BlbigpIHtcbiAgICAgICAgLy8gT25seSB0cnkgdG8gcmVjb25uZWN0IGlmIGl0J3MgdGhlIGZpcnN0IHRpbWUgd2UncmUgY29ubmVjdGluZ1xuICAgICAgICBpZiAoIXRoaXMuX3JlY29ubmVjdGluZyAmJlxuICAgICAgICAgICAgdGhpcy5fcmVjb25uZWN0aW9uICYmXG4gICAgICAgICAgICB0aGlzLmJhY2tvZmYuYXR0ZW1wdHMgPT09IDApIHtcbiAgICAgICAgICAgIC8vIGtlZXBzIHJlY29ubmVjdGlvbiBmcm9tIGZpcmluZyB0d2ljZSBmb3IgdGhlIHNhbWUgcmVjb25uZWN0aW9uIGxvb3BcbiAgICAgICAgICAgIHRoaXMucmVjb25uZWN0KCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgY3VycmVudCB0cmFuc3BvcnQgYHNvY2tldGAuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiAtIG9wdGlvbmFsLCBjYWxsYmFja1xuICAgICAqIEByZXR1cm4gc2VsZlxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICBvcGVuKGZuKSB7XG4gICAgICAgIGlmICh+dGhpcy5fcmVhZHlTdGF0ZS5pbmRleE9mKFwib3BlblwiKSlcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB0aGlzLmVuZ2luZSA9IG5ldyBFbmdpbmUodGhpcy51cmksIHRoaXMub3B0cyk7XG4gICAgICAgIGNvbnN0IHNvY2tldCA9IHRoaXMuZW5naW5lO1xuICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcbiAgICAgICAgdGhpcy5fcmVhZHlTdGF0ZSA9IFwib3BlbmluZ1wiO1xuICAgICAgICB0aGlzLnNraXBSZWNvbm5lY3QgPSBmYWxzZTtcbiAgICAgICAgLy8gZW1pdCBgb3BlbmBcbiAgICAgICAgY29uc3Qgb3BlblN1YkRlc3Ryb3kgPSBvbihzb2NrZXQsIFwib3BlblwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBzZWxmLm9ub3BlbigpO1xuICAgICAgICAgICAgZm4gJiYgZm4oKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IG9uRXJyb3IgPSAoZXJyKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNsZWFudXAoKTtcbiAgICAgICAgICAgIHRoaXMuX3JlYWR5U3RhdGUgPSBcImNsb3NlZFwiO1xuICAgICAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJlcnJvclwiLCBlcnIpO1xuICAgICAgICAgICAgaWYgKGZuKSB7XG4gICAgICAgICAgICAgICAgZm4oZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIE9ubHkgZG8gdGhpcyBpZiB0aGVyZSBpcyBubyBmbiB0byBoYW5kbGUgdGhlIGVycm9yXG4gICAgICAgICAgICAgICAgdGhpcy5tYXliZVJlY29ubmVjdE9uT3BlbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAvLyBlbWl0IGBlcnJvcmBcbiAgICAgICAgY29uc3QgZXJyb3JTdWIgPSBvbihzb2NrZXQsIFwiZXJyb3JcIiwgb25FcnJvcik7XG4gICAgICAgIGlmIChmYWxzZSAhPT0gdGhpcy5fdGltZW91dCkge1xuICAgICAgICAgICAgY29uc3QgdGltZW91dCA9IHRoaXMuX3RpbWVvdXQ7XG4gICAgICAgICAgICAvLyBzZXQgdGltZXJcbiAgICAgICAgICAgIGNvbnN0IHRpbWVyID0gdGhpcy5zZXRUaW1lb3V0Rm4oKCkgPT4ge1xuICAgICAgICAgICAgICAgIG9wZW5TdWJEZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgb25FcnJvcihuZXcgRXJyb3IoXCJ0aW1lb3V0XCIpKTtcbiAgICAgICAgICAgICAgICBzb2NrZXQuY2xvc2UoKTtcbiAgICAgICAgICAgIH0sIHRpbWVvdXQpO1xuICAgICAgICAgICAgaWYgKHRoaXMub3B0cy5hdXRvVW5yZWYpIHtcbiAgICAgICAgICAgICAgICB0aW1lci51bnJlZigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zdWJzLnB1c2goKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJUaW1lb3V0Rm4odGltZXIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zdWJzLnB1c2gob3BlblN1YkRlc3Ryb3kpO1xuICAgICAgICB0aGlzLnN1YnMucHVzaChlcnJvclN1Yik7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBbGlhcyBmb3Igb3BlbigpXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHNlbGZcbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgY29ubmVjdChmbikge1xuICAgICAgICByZXR1cm4gdGhpcy5vcGVuKGZuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHVwb24gdHJhbnNwb3J0IG9wZW4uXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIG9ub3BlbigpIHtcbiAgICAgICAgLy8gY2xlYXIgb2xkIHN1YnNcbiAgICAgICAgdGhpcy5jbGVhbnVwKCk7XG4gICAgICAgIC8vIG1hcmsgYXMgb3BlblxuICAgICAgICB0aGlzLl9yZWFkeVN0YXRlID0gXCJvcGVuXCI7XG4gICAgICAgIHRoaXMuZW1pdFJlc2VydmVkKFwib3BlblwiKTtcbiAgICAgICAgLy8gYWRkIG5ldyBzdWJzXG4gICAgICAgIGNvbnN0IHNvY2tldCA9IHRoaXMuZW5naW5lO1xuICAgICAgICB0aGlzLnN1YnMucHVzaChvbihzb2NrZXQsIFwicGluZ1wiLCB0aGlzLm9ucGluZy5iaW5kKHRoaXMpKSwgb24oc29ja2V0LCBcImRhdGFcIiwgdGhpcy5vbmRhdGEuYmluZCh0aGlzKSksIG9uKHNvY2tldCwgXCJlcnJvclwiLCB0aGlzLm9uZXJyb3IuYmluZCh0aGlzKSksIG9uKHNvY2tldCwgXCJjbG9zZVwiLCB0aGlzLm9uY2xvc2UuYmluZCh0aGlzKSksIFxuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIG9uKHRoaXMuZGVjb2RlciwgXCJkZWNvZGVkXCIsIHRoaXMub25kZWNvZGVkLmJpbmQodGhpcykpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHVwb24gYSBwaW5nLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBvbnBpbmcoKSB7XG4gICAgICAgIHRoaXMuZW1pdFJlc2VydmVkKFwicGluZ1wiKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHdpdGggZGF0YS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgb25kYXRhKGRhdGEpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMuZGVjb2Rlci5hZGQoZGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHRoaXMub25jbG9zZShcInBhcnNlIGVycm9yXCIsIGUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxlZCB3aGVuIHBhcnNlciBmdWxseSBkZWNvZGVzIGEgcGFja2V0LlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBvbmRlY29kZWQocGFja2V0KSB7XG4gICAgICAgIC8vIHRoZSBuZXh0VGljayBjYWxsIHByZXZlbnRzIGFuIGV4Y2VwdGlvbiBpbiBhIHVzZXItcHJvdmlkZWQgZXZlbnQgbGlzdGVuZXIgZnJvbSB0cmlnZ2VyaW5nIGEgZGlzY29ubmVjdGlvbiBkdWUgdG8gYSBcInBhcnNlIGVycm9yXCJcbiAgICAgICAgbmV4dFRpY2soKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJwYWNrZXRcIiwgcGFja2V0KTtcbiAgICAgICAgfSwgdGhpcy5zZXRUaW1lb3V0Rm4pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgdXBvbiBzb2NrZXQgZXJyb3IuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIG9uZXJyb3IoZXJyKSB7XG4gICAgICAgIHRoaXMuZW1pdFJlc2VydmVkKFwiZXJyb3JcIiwgZXJyKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyBzb2NrZXQgZm9yIHRoZSBnaXZlbiBgbnNwYC5cbiAgICAgKlxuICAgICAqIEByZXR1cm4ge1NvY2tldH1cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgc29ja2V0KG5zcCwgb3B0cykge1xuICAgICAgICBsZXQgc29ja2V0ID0gdGhpcy5uc3BzW25zcF07XG4gICAgICAgIGlmICghc29ja2V0KSB7XG4gICAgICAgICAgICBzb2NrZXQgPSBuZXcgU29ja2V0KHRoaXMsIG5zcCwgb3B0cyk7XG4gICAgICAgICAgICB0aGlzLm5zcHNbbnNwXSA9IHNvY2tldDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLl9hdXRvQ29ubmVjdCAmJiAhc29ja2V0LmFjdGl2ZSkge1xuICAgICAgICAgICAgc29ja2V0LmNvbm5lY3QoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc29ja2V0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgdXBvbiBhIHNvY2tldCBjbG9zZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBzb2NrZXRcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9kZXN0cm95KHNvY2tldCkge1xuICAgICAgICBjb25zdCBuc3BzID0gT2JqZWN0LmtleXModGhpcy5uc3BzKTtcbiAgICAgICAgZm9yIChjb25zdCBuc3Agb2YgbnNwcykge1xuICAgICAgICAgICAgY29uc3Qgc29ja2V0ID0gdGhpcy5uc3BzW25zcF07XG4gICAgICAgICAgICBpZiAoc29ja2V0LmFjdGl2ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9jbG9zZSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBXcml0ZXMgYSBwYWNrZXQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFja2V0XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfcGFja2V0KHBhY2tldCkge1xuICAgICAgICBjb25zdCBlbmNvZGVkUGFja2V0cyA9IHRoaXMuZW5jb2Rlci5lbmNvZGUocGFja2V0KTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlbmNvZGVkUGFja2V0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5lbmdpbmUud3JpdGUoZW5jb2RlZFBhY2tldHNbaV0sIHBhY2tldC5vcHRpb25zKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBDbGVhbiB1cCB0cmFuc3BvcnQgc3Vic2NyaXB0aW9ucyBhbmQgcGFja2V0IGJ1ZmZlci5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgY2xlYW51cCgpIHtcbiAgICAgICAgdGhpcy5zdWJzLmZvckVhY2goKHN1YkRlc3Ryb3kpID0+IHN1YkRlc3Ryb3koKSk7XG4gICAgICAgIHRoaXMuc3Vicy5sZW5ndGggPSAwO1xuICAgICAgICB0aGlzLmRlY29kZXIuZGVzdHJveSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDbG9zZSB0aGUgY3VycmVudCBzb2NrZXQuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9jbG9zZSgpIHtcbiAgICAgICAgdGhpcy5za2lwUmVjb25uZWN0ID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fcmVjb25uZWN0aW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMub25jbG9zZShcImZvcmNlZCBjbG9zZVwiKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWxpYXMgZm9yIGNsb3NlKClcbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgZGlzY29ubmVjdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Nsb3NlKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxlZCB3aGVuOlxuICAgICAqXG4gICAgICogLSB0aGUgbG93LWxldmVsIGVuZ2luZSBpcyBjbG9zZWRcbiAgICAgKiAtIHRoZSBwYXJzZXIgZW5jb3VudGVyZWQgYSBiYWRseSBmb3JtYXR0ZWQgcGFja2V0XG4gICAgICogLSBhbGwgc29ja2V0cyBhcmUgZGlzY29ubmVjdGVkXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIG9uY2xvc2UocmVhc29uLCBkZXNjcmlwdGlvbikge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHRoaXMuY2xlYW51cCgpO1xuICAgICAgICAoX2EgPSB0aGlzLmVuZ2luZSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmNsb3NlKCk7XG4gICAgICAgIHRoaXMuYmFja29mZi5yZXNldCgpO1xuICAgICAgICB0aGlzLl9yZWFkeVN0YXRlID0gXCJjbG9zZWRcIjtcbiAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJjbG9zZVwiLCByZWFzb24sIGRlc2NyaXB0aW9uKTtcbiAgICAgICAgaWYgKHRoaXMuX3JlY29ubmVjdGlvbiAmJiAhdGhpcy5za2lwUmVjb25uZWN0KSB7XG4gICAgICAgICAgICB0aGlzLnJlY29ubmVjdCgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEF0dGVtcHQgYSByZWNvbm5lY3Rpb24uXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHJlY29ubmVjdCgpIHtcbiAgICAgICAgaWYgKHRoaXMuX3JlY29ubmVjdGluZyB8fCB0aGlzLnNraXBSZWNvbm5lY3QpXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG4gICAgICAgIGlmICh0aGlzLmJhY2tvZmYuYXR0ZW1wdHMgPj0gdGhpcy5fcmVjb25uZWN0aW9uQXR0ZW1wdHMpIHtcbiAgICAgICAgICAgIHRoaXMuYmFja29mZi5yZXNldCgpO1xuICAgICAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJyZWNvbm5lY3RfZmFpbGVkXCIpO1xuICAgICAgICAgICAgdGhpcy5fcmVjb25uZWN0aW5nID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBkZWxheSA9IHRoaXMuYmFja29mZi5kdXJhdGlvbigpO1xuICAgICAgICAgICAgdGhpcy5fcmVjb25uZWN0aW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIGNvbnN0IHRpbWVyID0gdGhpcy5zZXRUaW1lb3V0Rm4oKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChzZWxmLnNraXBSZWNvbm5lY3QpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcInJlY29ubmVjdF9hdHRlbXB0XCIsIHNlbGYuYmFja29mZi5hdHRlbXB0cyk7XG4gICAgICAgICAgICAgICAgLy8gY2hlY2sgYWdhaW4gZm9yIHRoZSBjYXNlIHNvY2tldCBjbG9zZWQgaW4gYWJvdmUgZXZlbnRzXG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuc2tpcFJlY29ubmVjdClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIHNlbGYub3BlbigoZXJyKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3JlY29ubmVjdGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5yZWNvbm5lY3QoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdFJlc2VydmVkKFwicmVjb25uZWN0X2Vycm9yXCIsIGVycik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm9ucmVjb25uZWN0KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sIGRlbGF5KTtcbiAgICAgICAgICAgIGlmICh0aGlzLm9wdHMuYXV0b1VucmVmKSB7XG4gICAgICAgICAgICAgICAgdGltZXIudW5yZWYoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc3Vicy5wdXNoKCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmNsZWFyVGltZW91dEZuKHRpbWVyKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxlZCB1cG9uIHN1Y2Nlc3NmdWwgcmVjb25uZWN0LlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBvbnJlY29ubmVjdCgpIHtcbiAgICAgICAgY29uc3QgYXR0ZW1wdCA9IHRoaXMuYmFja29mZi5hdHRlbXB0cztcbiAgICAgICAgdGhpcy5fcmVjb25uZWN0aW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMuYmFja29mZi5yZXNldCgpO1xuICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcInJlY29ubmVjdFwiLCBhdHRlbXB0KTtcbiAgICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/manager.js\n')},"./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/on.js":
/*!*************************************************************************************************!*\
  !*** ./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/on.js ***!
  \*************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   on: () => (/* binding */ on)\n/* harmony export */ });\nfunction on(obj, ev, fn) {\n    obj.on(ev, fn);\n    return function subDestroy() {\n        obj.off(ev, fn);\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLWNsaWVudEA0LjguMS9ub2RlX21vZHVsZXMvc29ja2V0LmlvLWNsaWVudC9idWlsZC9lc20vb24uanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL25vZGVfbW9kdWxlcy8ucG5wbS9zb2NrZXQuaW8tY2xpZW50QDQuOC4xL25vZGVfbW9kdWxlcy9zb2NrZXQuaW8tY2xpZW50L2J1aWxkL2VzbS9vbi5qcz9lMWY4Il0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBmdW5jdGlvbiBvbihvYmosIGV2LCBmbikge1xuICAgIG9iai5vbihldiwgZm4pO1xuICAgIHJldHVybiBmdW5jdGlvbiBzdWJEZXN0cm95KCkge1xuICAgICAgICBvYmoub2ZmKGV2LCBmbik7XG4gICAgfTtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/on.js\n")},"./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/socket.js":
/*!*****************************************************************************************************!*\
  !*** ./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/socket.js ***!
  \*****************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Socket: () => (/* binding */ Socket)\n/* harmony export */ });\n/* harmony import */ var socket_io_parser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! socket.io-parser */ "./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/index.js");\n/* harmony import */ var _on_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./on.js */ "./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/on.js");\n/* harmony import */ var _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @socket.io/component-emitter */ "./node_modules/.pnpm/@socket.io+component-emitter@3.1.2/node_modules/@socket.io/component-emitter/lib/esm/index.js");\n\n\n\n/**\n * Internal events.\n * These events can\'t be emitted by the user.\n */\nconst RESERVED_EVENTS = Object.freeze({\n    connect: 1,\n    connect_error: 1,\n    disconnect: 1,\n    disconnecting: 1,\n    // EventEmitter reserved events: https://nodejs.org/api/events.html#events_event_newlistener\n    newListener: 1,\n    removeListener: 1,\n});\n/**\n * A Socket is the fundamental class for interacting with the server.\n *\n * A Socket belongs to a certain Namespace (by default /) and uses an underlying {@link Manager} to communicate.\n *\n * @example\n * const socket = io();\n *\n * socket.on("connect", () => {\n *   console.log("connected");\n * });\n *\n * // send an event to the server\n * socket.emit("foo", "bar");\n *\n * socket.on("foobar", () => {\n *   // an event was received from the server\n * });\n *\n * // upon disconnection\n * socket.on("disconnect", (reason) => {\n *   console.log(`disconnected due to ${reason}`);\n * });\n */\nclass Socket extends _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_2__.Emitter {\n    /**\n     * `Socket` constructor.\n     */\n    constructor(io, nsp, opts) {\n        super();\n        /**\n         * Whether the socket is currently connected to the server.\n         *\n         * @example\n         * const socket = io();\n         *\n         * socket.on("connect", () => {\n         *   console.log(socket.connected); // true\n         * });\n         *\n         * socket.on("disconnect", () => {\n         *   console.log(socket.connected); // false\n         * });\n         */\n        this.connected = false;\n        /**\n         * Whether the connection state was recovered after a temporary disconnection. In that case, any missed packets will\n         * be transmitted by the server.\n         */\n        this.recovered = false;\n        /**\n         * Buffer for packets received before the CONNECT packet\n         */\n        this.receiveBuffer = [];\n        /**\n         * Buffer for packets that will be sent once the socket is connected\n         */\n        this.sendBuffer = [];\n        /**\n         * The queue of packets to be sent with retry in case of failure.\n         *\n         * Packets are sent one by one, each waiting for the server acknowledgement, in order to guarantee the delivery order.\n         * @private\n         */\n        this._queue = [];\n        /**\n         * A sequence to generate the ID of the {@link QueuedPacket}.\n         * @private\n         */\n        this._queueSeq = 0;\n        this.ids = 0;\n        /**\n         * A map containing acknowledgement handlers.\n         *\n         * The `withError` attribute is used to differentiate handlers that accept an error as first argument:\n         *\n         * - `socket.emit("test", (err, value) => { ... })` with `ackTimeout` option\n         * - `socket.timeout(5000).emit("test", (err, value) => { ... })`\n         * - `const value = await socket.emitWithAck("test")`\n         *\n         * From those that don\'t:\n         *\n         * - `socket.emit("test", (value) => { ... });`\n         *\n         * In the first case, the handlers will be called with an error when:\n         *\n         * - the timeout is reached\n         * - the socket gets disconnected\n         *\n         * In the second case, the handlers will be simply discarded upon disconnection, since the client will never receive\n         * an acknowledgement from the server.\n         *\n         * @private\n         */\n        this.acks = {};\n        this.flags = {};\n        this.io = io;\n        this.nsp = nsp;\n        if (opts && opts.auth) {\n            this.auth = opts.auth;\n        }\n        this._opts = Object.assign({}, opts);\n        if (this.io._autoConnect)\n            this.open();\n    }\n    /**\n     * Whether the socket is currently disconnected\n     *\n     * @example\n     * const socket = io();\n     *\n     * socket.on("connect", () => {\n     *   console.log(socket.disconnected); // false\n     * });\n     *\n     * socket.on("disconnect", () => {\n     *   console.log(socket.disconnected); // true\n     * });\n     */\n    get disconnected() {\n        return !this.connected;\n    }\n    /**\n     * Subscribe to open, close and packet events\n     *\n     * @private\n     */\n    subEvents() {\n        if (this.subs)\n            return;\n        const io = this.io;\n        this.subs = [\n            (0,_on_js__WEBPACK_IMPORTED_MODULE_1__.on)(io, "open", this.onopen.bind(this)),\n            (0,_on_js__WEBPACK_IMPORTED_MODULE_1__.on)(io, "packet", this.onpacket.bind(this)),\n            (0,_on_js__WEBPACK_IMPORTED_MODULE_1__.on)(io, "error", this.onerror.bind(this)),\n            (0,_on_js__WEBPACK_IMPORTED_MODULE_1__.on)(io, "close", this.onclose.bind(this)),\n        ];\n    }\n    /**\n     * Whether the Socket will try to reconnect when its Manager connects or reconnects.\n     *\n     * @example\n     * const socket = io();\n     *\n     * console.log(socket.active); // true\n     *\n     * socket.on("disconnect", (reason) => {\n     *   if (reason === "io server disconnect") {\n     *     // the disconnection was initiated by the server, you need to manually reconnect\n     *     console.log(socket.active); // false\n     *   }\n     *   // else the socket will automatically try to reconnect\n     *   console.log(socket.active); // true\n     * });\n     */\n    get active() {\n        return !!this.subs;\n    }\n    /**\n     * "Opens" the socket.\n     *\n     * @example\n     * const socket = io({\n     *   autoConnect: false\n     * });\n     *\n     * socket.connect();\n     */\n    connect() {\n        if (this.connected)\n            return this;\n        this.subEvents();\n        if (!this.io["_reconnecting"])\n            this.io.open(); // ensure open\n        if ("open" === this.io._readyState)\n            this.onopen();\n        return this;\n    }\n    /**\n     * Alias for {@link connect()}.\n     */\n    open() {\n        return this.connect();\n    }\n    /**\n     * Sends a `message` event.\n     *\n     * This method mimics the WebSocket.send() method.\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/WebSocket/send\n     *\n     * @example\n     * socket.send("hello");\n     *\n     * // this is equivalent to\n     * socket.emit("message", "hello");\n     *\n     * @return self\n     */\n    send(...args) {\n        args.unshift("message");\n        this.emit.apply(this, args);\n        return this;\n    }\n    /**\n     * Override `emit`.\n     * If the event is in `events`, it\'s emitted normally.\n     *\n     * @example\n     * socket.emit("hello", "world");\n     *\n     * // all serializable datastructures are supported (no need to call JSON.stringify)\n     * socket.emit("hello", 1, "2", { 3: ["4"], 5: Uint8Array.from([6]) });\n     *\n     * // with an acknowledgement from the server\n     * socket.emit("hello", "world", (val) => {\n     *   // ...\n     * });\n     *\n     * @return self\n     */\n    emit(ev, ...args) {\n        var _a, _b, _c;\n        if (RESERVED_EVENTS.hasOwnProperty(ev)) {\n            throw new Error(\'"\' + ev.toString() + \'" is a reserved event name\');\n        }\n        args.unshift(ev);\n        if (this._opts.retries && !this.flags.fromQueue && !this.flags.volatile) {\n            this._addToQueue(args);\n            return this;\n        }\n        const packet = {\n            type: socket_io_parser__WEBPACK_IMPORTED_MODULE_0__.PacketType.EVENT,\n            data: args,\n        };\n        packet.options = {};\n        packet.options.compress = this.flags.compress !== false;\n        // event ack callback\n        if ("function" === typeof args[args.length - 1]) {\n            const id = this.ids++;\n            const ack = args.pop();\n            this._registerAckCallback(id, ack);\n            packet.id = id;\n        }\n        const isTransportWritable = (_b = (_a = this.io.engine) === null || _a === void 0 ? void 0 : _a.transport) === null || _b === void 0 ? void 0 : _b.writable;\n        const isConnected = this.connected && !((_c = this.io.engine) === null || _c === void 0 ? void 0 : _c._hasPingExpired());\n        const discardPacket = this.flags.volatile && !isTransportWritable;\n        if (discardPacket) {\n        }\n        else if (isConnected) {\n            this.notifyOutgoingListeners(packet);\n            this.packet(packet);\n        }\n        else {\n            this.sendBuffer.push(packet);\n        }\n        this.flags = {};\n        return this;\n    }\n    /**\n     * @private\n     */\n    _registerAckCallback(id, ack) {\n        var _a;\n        const timeout = (_a = this.flags.timeout) !== null && _a !== void 0 ? _a : this._opts.ackTimeout;\n        if (timeout === undefined) {\n            this.acks[id] = ack;\n            return;\n        }\n        // @ts-ignore\n        const timer = this.io.setTimeoutFn(() => {\n            delete this.acks[id];\n            for (let i = 0; i < this.sendBuffer.length; i++) {\n                if (this.sendBuffer[i].id === id) {\n                    this.sendBuffer.splice(i, 1);\n                }\n            }\n            ack.call(this, new Error("operation has timed out"));\n        }, timeout);\n        const fn = (...args) => {\n            // @ts-ignore\n            this.io.clearTimeoutFn(timer);\n            ack.apply(this, args);\n        };\n        fn.withError = true;\n        this.acks[id] = fn;\n    }\n    /**\n     * Emits an event and waits for an acknowledgement\n     *\n     * @example\n     * // without timeout\n     * const response = await socket.emitWithAck("hello", "world");\n     *\n     * // with a specific timeout\n     * try {\n     *   const response = await socket.timeout(1000).emitWithAck("hello", "world");\n     * } catch (err) {\n     *   // the server did not acknowledge the event in the given delay\n     * }\n     *\n     * @return a Promise that will be fulfilled when the server acknowledges the event\n     */\n    emitWithAck(ev, ...args) {\n        return new Promise((resolve, reject) => {\n            const fn = (arg1, arg2) => {\n                return arg1 ? reject(arg1) : resolve(arg2);\n            };\n            fn.withError = true;\n            args.push(fn);\n            this.emit(ev, ...args);\n        });\n    }\n    /**\n     * Add the packet to the queue.\n     * @param args\n     * @private\n     */\n    _addToQueue(args) {\n        let ack;\n        if (typeof args[args.length - 1] === "function") {\n            ack = args.pop();\n        }\n        const packet = {\n            id: this._queueSeq++,\n            tryCount: 0,\n            pending: false,\n            args,\n            flags: Object.assign({ fromQueue: true }, this.flags),\n        };\n        args.push((err, ...responseArgs) => {\n            if (packet !== this._queue[0]) {\n                // the packet has already been acknowledged\n                return;\n            }\n            const hasError = err !== null;\n            if (hasError) {\n                if (packet.tryCount > this._opts.retries) {\n                    this._queue.shift();\n                    if (ack) {\n                        ack(err);\n                    }\n                }\n            }\n            else {\n                this._queue.shift();\n                if (ack) {\n                    ack(null, ...responseArgs);\n                }\n            }\n            packet.pending = false;\n            return this._drainQueue();\n        });\n        this._queue.push(packet);\n        this._drainQueue();\n    }\n    /**\n     * Send the first packet of the queue, and wait for an acknowledgement from the server.\n     * @param force - whether to resend a packet that has not been acknowledged yet\n     *\n     * @private\n     */\n    _drainQueue(force = false) {\n        if (!this.connected || this._queue.length === 0) {\n            return;\n        }\n        const packet = this._queue[0];\n        if (packet.pending && !force) {\n            return;\n        }\n        packet.pending = true;\n        packet.tryCount++;\n        this.flags = packet.flags;\n        this.emit.apply(this, packet.args);\n    }\n    /**\n     * Sends a packet.\n     *\n     * @param packet\n     * @private\n     */\n    packet(packet) {\n        packet.nsp = this.nsp;\n        this.io._packet(packet);\n    }\n    /**\n     * Called upon engine `open`.\n     *\n     * @private\n     */\n    onopen() {\n        if (typeof this.auth == "function") {\n            this.auth((data) => {\n                this._sendConnectPacket(data);\n            });\n        }\n        else {\n            this._sendConnectPacket(this.auth);\n        }\n    }\n    /**\n     * Sends a CONNECT packet to initiate the Socket.IO session.\n     *\n     * @param data\n     * @private\n     */\n    _sendConnectPacket(data) {\n        this.packet({\n            type: socket_io_parser__WEBPACK_IMPORTED_MODULE_0__.PacketType.CONNECT,\n            data: this._pid\n                ? Object.assign({ pid: this._pid, offset: this._lastOffset }, data)\n                : data,\n        });\n    }\n    /**\n     * Called upon engine or manager `error`.\n     *\n     * @param err\n     * @private\n     */\n    onerror(err) {\n        if (!this.connected) {\n            this.emitReserved("connect_error", err);\n        }\n    }\n    /**\n     * Called upon engine `close`.\n     *\n     * @param reason\n     * @param description\n     * @private\n     */\n    onclose(reason, description) {\n        this.connected = false;\n        delete this.id;\n        this.emitReserved("disconnect", reason, description);\n        this._clearAcks();\n    }\n    /**\n     * Clears the acknowledgement handlers upon disconnection, since the client will never receive an acknowledgement from\n     * the server.\n     *\n     * @private\n     */\n    _clearAcks() {\n        Object.keys(this.acks).forEach((id) => {\n            const isBuffered = this.sendBuffer.some((packet) => String(packet.id) === id);\n            if (!isBuffered) {\n                // note: handlers that do not accept an error as first argument are ignored here\n                const ack = this.acks[id];\n                delete this.acks[id];\n                if (ack.withError) {\n                    ack.call(this, new Error("socket has been disconnected"));\n                }\n            }\n        });\n    }\n    /**\n     * Called with socket packet.\n     *\n     * @param packet\n     * @private\n     */\n    onpacket(packet) {\n        const sameNamespace = packet.nsp === this.nsp;\n        if (!sameNamespace)\n            return;\n        switch (packet.type) {\n            case socket_io_parser__WEBPACK_IMPORTED_MODULE_0__.PacketType.CONNECT:\n                if (packet.data && packet.data.sid) {\n                    this.onconnect(packet.data.sid, packet.data.pid);\n                }\n                else {\n                    this.emitReserved("connect_error", new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));\n                }\n                break;\n            case socket_io_parser__WEBPACK_IMPORTED_MODULE_0__.PacketType.EVENT:\n            case socket_io_parser__WEBPACK_IMPORTED_MODULE_0__.PacketType.BINARY_EVENT:\n                this.onevent(packet);\n                break;\n            case socket_io_parser__WEBPACK_IMPORTED_MODULE_0__.PacketType.ACK:\n            case socket_io_parser__WEBPACK_IMPORTED_MODULE_0__.PacketType.BINARY_ACK:\n                this.onack(packet);\n                break;\n            case socket_io_parser__WEBPACK_IMPORTED_MODULE_0__.PacketType.DISCONNECT:\n                this.ondisconnect();\n                break;\n            case socket_io_parser__WEBPACK_IMPORTED_MODULE_0__.PacketType.CONNECT_ERROR:\n                this.destroy();\n                const err = new Error(packet.data.message);\n                // @ts-ignore\n                err.data = packet.data.data;\n                this.emitReserved("connect_error", err);\n                break;\n        }\n    }\n    /**\n     * Called upon a server event.\n     *\n     * @param packet\n     * @private\n     */\n    onevent(packet) {\n        const args = packet.data || [];\n        if (null != packet.id) {\n            args.push(this.ack(packet.id));\n        }\n        if (this.connected) {\n            this.emitEvent(args);\n        }\n        else {\n            this.receiveBuffer.push(Object.freeze(args));\n        }\n    }\n    emitEvent(args) {\n        if (this._anyListeners && this._anyListeners.length) {\n            const listeners = this._anyListeners.slice();\n            for (const listener of listeners) {\n                listener.apply(this, args);\n            }\n        }\n        super.emit.apply(this, args);\n        if (this._pid && args.length && typeof args[args.length - 1] === "string") {\n            this._lastOffset = args[args.length - 1];\n        }\n    }\n    /**\n     * Produces an ack callback to emit with an event.\n     *\n     * @private\n     */\n    ack(id) {\n        const self = this;\n        let sent = false;\n        return function (...args) {\n            // prevent double callbacks\n            if (sent)\n                return;\n            sent = true;\n            self.packet({\n                type: socket_io_parser__WEBPACK_IMPORTED_MODULE_0__.PacketType.ACK,\n                id: id,\n                data: args,\n            });\n        };\n    }\n    /**\n     * Called upon a server acknowledgement.\n     *\n     * @param packet\n     * @private\n     */\n    onack(packet) {\n        const ack = this.acks[packet.id];\n        if (typeof ack !== "function") {\n            return;\n        }\n        delete this.acks[packet.id];\n        // @ts-ignore FIXME ack is incorrectly inferred as \'never\'\n        if (ack.withError) {\n            packet.data.unshift(null);\n        }\n        // @ts-ignore\n        ack.apply(this, packet.data);\n    }\n    /**\n     * Called upon server connect.\n     *\n     * @private\n     */\n    onconnect(id, pid) {\n        this.id = id;\n        this.recovered = pid && this._pid === pid;\n        this._pid = pid; // defined only if connection state recovery is enabled\n        this.connected = true;\n        this.emitBuffered();\n        this.emitReserved("connect");\n        this._drainQueue(true);\n    }\n    /**\n     * Emit buffered events (received and emitted).\n     *\n     * @private\n     */\n    emitBuffered() {\n        this.receiveBuffer.forEach((args) => this.emitEvent(args));\n        this.receiveBuffer = [];\n        this.sendBuffer.forEach((packet) => {\n            this.notifyOutgoingListeners(packet);\n            this.packet(packet);\n        });\n        this.sendBuffer = [];\n    }\n    /**\n     * Called upon server disconnect.\n     *\n     * @private\n     */\n    ondisconnect() {\n        this.destroy();\n        this.onclose("io server disconnect");\n    }\n    /**\n     * Called upon forced client/server side disconnections,\n     * this method ensures the manager stops tracking us and\n     * that reconnections don\'t get triggered for this.\n     *\n     * @private\n     */\n    destroy() {\n        if (this.subs) {\n            // clean subscriptions to avoid reconnections\n            this.subs.forEach((subDestroy) => subDestroy());\n            this.subs = undefined;\n        }\n        this.io["_destroy"](this);\n    }\n    /**\n     * Disconnects the socket manually. In that case, the socket will not try to reconnect.\n     *\n     * If this is the last active Socket instance of the {@link Manager}, the low-level connection will be closed.\n     *\n     * @example\n     * const socket = io();\n     *\n     * socket.on("disconnect", (reason) => {\n     *   // console.log(reason); prints "io client disconnect"\n     * });\n     *\n     * socket.disconnect();\n     *\n     * @return self\n     */\n    disconnect() {\n        if (this.connected) {\n            this.packet({ type: socket_io_parser__WEBPACK_IMPORTED_MODULE_0__.PacketType.DISCONNECT });\n        }\n        // remove socket from pool\n        this.destroy();\n        if (this.connected) {\n            // fire events\n            this.onclose("io client disconnect");\n        }\n        return this;\n    }\n    /**\n     * Alias for {@link disconnect()}.\n     *\n     * @return self\n     */\n    close() {\n        return this.disconnect();\n    }\n    /**\n     * Sets the compress flag.\n     *\n     * @example\n     * socket.compress(false).emit("hello");\n     *\n     * @param compress - if `true`, compresses the sending data\n     * @return self\n     */\n    compress(compress) {\n        this.flags.compress = compress;\n        return this;\n    }\n    /**\n     * Sets a modifier for a subsequent event emission that the event message will be dropped when this socket is not\n     * ready to send messages.\n     *\n     * @example\n     * socket.volatile.emit("hello"); // the server may or may not receive it\n     *\n     * @returns self\n     */\n    get volatile() {\n        this.flags.volatile = true;\n        return this;\n    }\n    /**\n     * Sets a modifier for a subsequent event emission that the callback will be called with an error when the\n     * given number of milliseconds have elapsed without an acknowledgement from the server:\n     *\n     * @example\n     * socket.timeout(5000).emit("my-event", (err) => {\n     *   if (err) {\n     *     // the server did not acknowledge the event in the given delay\n     *   }\n     * });\n     *\n     * @returns self\n     */\n    timeout(timeout) {\n        this.flags.timeout = timeout;\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback.\n     *\n     * @example\n     * socket.onAny((event, ...args) => {\n     *   console.log(`got ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    onAny(listener) {\n        this._anyListeners = this._anyListeners || [];\n        this._anyListeners.push(listener);\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback. The listener is added to the beginning of the listeners array.\n     *\n     * @example\n     * socket.prependAny((event, ...args) => {\n     *   console.log(`got event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    prependAny(listener) {\n        this._anyListeners = this._anyListeners || [];\n        this._anyListeners.unshift(listener);\n        return this;\n    }\n    /**\n     * Removes the listener that will be fired when any event is emitted.\n     *\n     * @example\n     * const catchAllListener = (event, ...args) => {\n     *   console.log(`got event ${event}`);\n     * }\n     *\n     * socket.onAny(catchAllListener);\n     *\n     * // remove a specific listener\n     * socket.offAny(catchAllListener);\n     *\n     * // or remove all listeners\n     * socket.offAny();\n     *\n     * @param listener\n     */\n    offAny(listener) {\n        if (!this._anyListeners) {\n            return this;\n        }\n        if (listener) {\n            const listeners = this._anyListeners;\n            for (let i = 0; i < listeners.length; i++) {\n                if (listener === listeners[i]) {\n                    listeners.splice(i, 1);\n                    return this;\n                }\n            }\n        }\n        else {\n            this._anyListeners = [];\n        }\n        return this;\n    }\n    /**\n     * Returns an array of listeners that are listening for any event that is specified. This array can be manipulated,\n     * e.g. to remove listeners.\n     */\n    listenersAny() {\n        return this._anyListeners || [];\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback.\n     *\n     * Note: acknowledgements sent to the server are not included.\n     *\n     * @example\n     * socket.onAnyOutgoing((event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    onAnyOutgoing(listener) {\n        this._anyOutgoingListeners = this._anyOutgoingListeners || [];\n        this._anyOutgoingListeners.push(listener);\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback. The listener is added to the beginning of the listeners array.\n     *\n     * Note: acknowledgements sent to the server are not included.\n     *\n     * @example\n     * socket.prependAnyOutgoing((event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    prependAnyOutgoing(listener) {\n        this._anyOutgoingListeners = this._anyOutgoingListeners || [];\n        this._anyOutgoingListeners.unshift(listener);\n        return this;\n    }\n    /**\n     * Removes the listener that will be fired when any event is emitted.\n     *\n     * @example\n     * const catchAllListener = (event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * }\n     *\n     * socket.onAnyOutgoing(catchAllListener);\n     *\n     * // remove a specific listener\n     * socket.offAnyOutgoing(catchAllListener);\n     *\n     * // or remove all listeners\n     * socket.offAnyOutgoing();\n     *\n     * @param [listener] - the catch-all listener (optional)\n     */\n    offAnyOutgoing(listener) {\n        if (!this._anyOutgoingListeners) {\n            return this;\n        }\n        if (listener) {\n            const listeners = this._anyOutgoingListeners;\n            for (let i = 0; i < listeners.length; i++) {\n                if (listener === listeners[i]) {\n                    listeners.splice(i, 1);\n                    return this;\n                }\n            }\n        }\n        else {\n            this._anyOutgoingListeners = [];\n        }\n        return this;\n    }\n    /**\n     * Returns an array of listeners that are listening for any event that is specified. This array can be manipulated,\n     * e.g. to remove listeners.\n     */\n    listenersAnyOutgoing() {\n        return this._anyOutgoingListeners || [];\n    }\n    /**\n     * Notify the listeners for each packet sent\n     *\n     * @param packet\n     *\n     * @private\n     */\n    notifyOutgoingListeners(packet) {\n        if (this._anyOutgoingListeners && this._anyOutgoingListeners.length) {\n            const listeners = this._anyOutgoingListeners.slice();\n            for (const listener of listeners) {\n                listener.apply(this, packet.data);\n            }\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLWNsaWVudEA0LjguMS9ub2RlX21vZHVsZXMvc29ja2V0LmlvLWNsaWVudC9idWlsZC9lc20vc29ja2V0LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBOEM7QUFDakI7QUFDMkI7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLGtGQUFrRixlQUFlO0FBQ2pHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDLE9BQU87QUFDL0MsSUFBSTtBQUNKO0FBQ08scUJBQXFCLGlFQUFPO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QztBQUM1QyxZQUFZO0FBQ1o7QUFDQTtBQUNBLDRDQUE0QztBQUM1QyxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRCxtQkFBbUI7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0RBQW9ELEtBQUs7QUFDekQsa0VBQWtFLEtBQUs7QUFDdkU7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0MsS0FBSyxFQUFFO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQztBQUMzQyxRQUFRO0FBQ1I7QUFDQTtBQUNBLDJDQUEyQztBQUMzQyxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksMENBQUU7QUFDZCxZQUFZLDBDQUFFO0FBQ2QsWUFBWSwwQ0FBRTtBQUNkLFlBQVksMENBQUU7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDO0FBQ3ZDO0FBQ0E7QUFDQSxxQ0FBcUM7QUFDckMsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixnQkFBZ0I7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQyxtQ0FBbUM7QUFDekU7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQix3REFBVTtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsNEJBQTRCO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLGlCQUFpQjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0Isd0RBQVU7QUFDNUI7QUFDQSxrQ0FBa0MsMENBQTBDO0FBQzVFO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsd0RBQVU7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsd0RBQVU7QUFDM0IsaUJBQWlCLHdEQUFVO0FBQzNCO0FBQ0E7QUFDQSxpQkFBaUIsd0RBQVU7QUFDM0IsaUJBQWlCLHdEQUFVO0FBQzNCO0FBQ0E7QUFDQSxpQkFBaUIsd0RBQVU7QUFDM0I7QUFDQTtBQUNBLGlCQUFpQix3REFBVTtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQix3REFBVTtBQUNoQztBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBEQUEwRCxjQUFjO0FBQ3hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakMsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLE1BQU0sd0RBQVUsYUFBYTtBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixtQkFBbUI7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLE1BQU07QUFDbEMsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsTUFBTTtBQUN4QyxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsTUFBTTtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsc0JBQXNCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsTUFBTTtBQUN6QyxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsTUFBTTtBQUN6QyxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsTUFBTTtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsc0JBQXNCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL3NvY2tldC5pby1jbGllbnRANC44LjEvbm9kZV9tb2R1bGVzL3NvY2tldC5pby1jbGllbnQvYnVpbGQvZXNtL3NvY2tldC5qcz80MjFmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhY2tldFR5cGUgfSBmcm9tIFwic29ja2V0LmlvLXBhcnNlclwiO1xuaW1wb3J0IHsgb24gfSBmcm9tIFwiLi9vbi5qc1wiO1xuaW1wb3J0IHsgRW1pdHRlciwgfSBmcm9tIFwiQHNvY2tldC5pby9jb21wb25lbnQtZW1pdHRlclwiO1xuLyoqXG4gKiBJbnRlcm5hbCBldmVudHMuXG4gKiBUaGVzZSBldmVudHMgY2FuJ3QgYmUgZW1pdHRlZCBieSB0aGUgdXNlci5cbiAqL1xuY29uc3QgUkVTRVJWRURfRVZFTlRTID0gT2JqZWN0LmZyZWV6ZSh7XG4gICAgY29ubmVjdDogMSxcbiAgICBjb25uZWN0X2Vycm9yOiAxLFxuICAgIGRpc2Nvbm5lY3Q6IDEsXG4gICAgZGlzY29ubmVjdGluZzogMSxcbiAgICAvLyBFdmVudEVtaXR0ZXIgcmVzZXJ2ZWQgZXZlbnRzOiBodHRwczovL25vZGVqcy5vcmcvYXBpL2V2ZW50cy5odG1sI2V2ZW50c19ldmVudF9uZXdsaXN0ZW5lclxuICAgIG5ld0xpc3RlbmVyOiAxLFxuICAgIHJlbW92ZUxpc3RlbmVyOiAxLFxufSk7XG4vKipcbiAqIEEgU29ja2V0IGlzIHRoZSBmdW5kYW1lbnRhbCBjbGFzcyBmb3IgaW50ZXJhY3Rpbmcgd2l0aCB0aGUgc2VydmVyLlxuICpcbiAqIEEgU29ja2V0IGJlbG9uZ3MgdG8gYSBjZXJ0YWluIE5hbWVzcGFjZSAoYnkgZGVmYXVsdCAvKSBhbmQgdXNlcyBhbiB1bmRlcmx5aW5nIHtAbGluayBNYW5hZ2VyfSB0byBjb21tdW5pY2F0ZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogY29uc3Qgc29ja2V0ID0gaW8oKTtcbiAqXG4gKiBzb2NrZXQub24oXCJjb25uZWN0XCIsICgpID0+IHtcbiAqICAgY29uc29sZS5sb2coXCJjb25uZWN0ZWRcIik7XG4gKiB9KTtcbiAqXG4gKiAvLyBzZW5kIGFuIGV2ZW50IHRvIHRoZSBzZXJ2ZXJcbiAqIHNvY2tldC5lbWl0KFwiZm9vXCIsIFwiYmFyXCIpO1xuICpcbiAqIHNvY2tldC5vbihcImZvb2JhclwiLCAoKSA9PiB7XG4gKiAgIC8vIGFuIGV2ZW50IHdhcyByZWNlaXZlZCBmcm9tIHRoZSBzZXJ2ZXJcbiAqIH0pO1xuICpcbiAqIC8vIHVwb24gZGlzY29ubmVjdGlvblxuICogc29ja2V0Lm9uKFwiZGlzY29ubmVjdFwiLCAocmVhc29uKSA9PiB7XG4gKiAgIGNvbnNvbGUubG9nKGBkaXNjb25uZWN0ZWQgZHVlIHRvICR7cmVhc29ufWApO1xuICogfSk7XG4gKi9cbmV4cG9ydCBjbGFzcyBTb2NrZXQgZXh0ZW5kcyBFbWl0dGVyIHtcbiAgICAvKipcbiAgICAgKiBgU29ja2V0YCBjb25zdHJ1Y3Rvci5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihpbywgbnNwLCBvcHRzKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBXaGV0aGVyIHRoZSBzb2NrZXQgaXMgY3VycmVudGx5IGNvbm5lY3RlZCB0byB0aGUgc2VydmVyLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAZXhhbXBsZVxuICAgICAgICAgKiBjb25zdCBzb2NrZXQgPSBpbygpO1xuICAgICAgICAgKlxuICAgICAgICAgKiBzb2NrZXQub24oXCJjb25uZWN0XCIsICgpID0+IHtcbiAgICAgICAgICogICBjb25zb2xlLmxvZyhzb2NrZXQuY29ubmVjdGVkKTsgLy8gdHJ1ZVxuICAgICAgICAgKiB9KTtcbiAgICAgICAgICpcbiAgICAgICAgICogc29ja2V0Lm9uKFwiZGlzY29ubmVjdFwiLCAoKSA9PiB7XG4gICAgICAgICAqICAgY29uc29sZS5sb2coc29ja2V0LmNvbm5lY3RlZCk7IC8vIGZhbHNlXG4gICAgICAgICAqIH0pO1xuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5jb25uZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFdoZXRoZXIgdGhlIGNvbm5lY3Rpb24gc3RhdGUgd2FzIHJlY292ZXJlZCBhZnRlciBhIHRlbXBvcmFyeSBkaXNjb25uZWN0aW9uLiBJbiB0aGF0IGNhc2UsIGFueSBtaXNzZWQgcGFja2V0cyB3aWxsXG4gICAgICAgICAqIGJlIHRyYW5zbWl0dGVkIGJ5IHRoZSBzZXJ2ZXIuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnJlY292ZXJlZCA9IGZhbHNlO1xuICAgICAgICAvKipcbiAgICAgICAgICogQnVmZmVyIGZvciBwYWNrZXRzIHJlY2VpdmVkIGJlZm9yZSB0aGUgQ09OTkVDVCBwYWNrZXRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucmVjZWl2ZUJ1ZmZlciA9IFtdO1xuICAgICAgICAvKipcbiAgICAgICAgICogQnVmZmVyIGZvciBwYWNrZXRzIHRoYXQgd2lsbCBiZSBzZW50IG9uY2UgdGhlIHNvY2tldCBpcyBjb25uZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc2VuZEJ1ZmZlciA9IFtdO1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHF1ZXVlIG9mIHBhY2tldHMgdG8gYmUgc2VudCB3aXRoIHJldHJ5IGluIGNhc2Ugb2YgZmFpbHVyZS5cbiAgICAgICAgICpcbiAgICAgICAgICogUGFja2V0cyBhcmUgc2VudCBvbmUgYnkgb25lLCBlYWNoIHdhaXRpbmcgZm9yIHRoZSBzZXJ2ZXIgYWNrbm93bGVkZ2VtZW50LCBpbiBvcmRlciB0byBndWFyYW50ZWUgdGhlIGRlbGl2ZXJ5IG9yZGVyLlxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fcXVldWUgPSBbXTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgc2VxdWVuY2UgdG8gZ2VuZXJhdGUgdGhlIElEIG9mIHRoZSB7QGxpbmsgUXVldWVkUGFja2V0fS5cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3F1ZXVlU2VxID0gMDtcbiAgICAgICAgdGhpcy5pZHMgPSAwO1xuICAgICAgICAvKipcbiAgICAgICAgICogQSBtYXAgY29udGFpbmluZyBhY2tub3dsZWRnZW1lbnQgaGFuZGxlcnMuXG4gICAgICAgICAqXG4gICAgICAgICAqIFRoZSBgd2l0aEVycm9yYCBhdHRyaWJ1dGUgaXMgdXNlZCB0byBkaWZmZXJlbnRpYXRlIGhhbmRsZXJzIHRoYXQgYWNjZXB0IGFuIGVycm9yIGFzIGZpcnN0IGFyZ3VtZW50OlxuICAgICAgICAgKlxuICAgICAgICAgKiAtIGBzb2NrZXQuZW1pdChcInRlc3RcIiwgKGVyciwgdmFsdWUpID0+IHsgLi4uIH0pYCB3aXRoIGBhY2tUaW1lb3V0YCBvcHRpb25cbiAgICAgICAgICogLSBgc29ja2V0LnRpbWVvdXQoNTAwMCkuZW1pdChcInRlc3RcIiwgKGVyciwgdmFsdWUpID0+IHsgLi4uIH0pYFxuICAgICAgICAgKiAtIGBjb25zdCB2YWx1ZSA9IGF3YWl0IHNvY2tldC5lbWl0V2l0aEFjayhcInRlc3RcIilgXG4gICAgICAgICAqXG4gICAgICAgICAqIEZyb20gdGhvc2UgdGhhdCBkb24ndDpcbiAgICAgICAgICpcbiAgICAgICAgICogLSBgc29ja2V0LmVtaXQoXCJ0ZXN0XCIsICh2YWx1ZSkgPT4geyAuLi4gfSk7YFxuICAgICAgICAgKlxuICAgICAgICAgKiBJbiB0aGUgZmlyc3QgY2FzZSwgdGhlIGhhbmRsZXJzIHdpbGwgYmUgY2FsbGVkIHdpdGggYW4gZXJyb3Igd2hlbjpcbiAgICAgICAgICpcbiAgICAgICAgICogLSB0aGUgdGltZW91dCBpcyByZWFjaGVkXG4gICAgICAgICAqIC0gdGhlIHNvY2tldCBnZXRzIGRpc2Nvbm5lY3RlZFxuICAgICAgICAgKlxuICAgICAgICAgKiBJbiB0aGUgc2Vjb25kIGNhc2UsIHRoZSBoYW5kbGVycyB3aWxsIGJlIHNpbXBseSBkaXNjYXJkZWQgdXBvbiBkaXNjb25uZWN0aW9uLCBzaW5jZSB0aGUgY2xpZW50IHdpbGwgbmV2ZXIgcmVjZWl2ZVxuICAgICAgICAgKiBhbiBhY2tub3dsZWRnZW1lbnQgZnJvbSB0aGUgc2VydmVyLlxuICAgICAgICAgKlxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5hY2tzID0ge307XG4gICAgICAgIHRoaXMuZmxhZ3MgPSB7fTtcbiAgICAgICAgdGhpcy5pbyA9IGlvO1xuICAgICAgICB0aGlzLm5zcCA9IG5zcDtcbiAgICAgICAgaWYgKG9wdHMgJiYgb3B0cy5hdXRoKSB7XG4gICAgICAgICAgICB0aGlzLmF1dGggPSBvcHRzLmF1dGg7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fb3B0cyA9IE9iamVjdC5hc3NpZ24oe30sIG9wdHMpO1xuICAgICAgICBpZiAodGhpcy5pby5fYXV0b0Nvbm5lY3QpXG4gICAgICAgICAgICB0aGlzLm9wZW4oKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogV2hldGhlciB0aGUgc29ja2V0IGlzIGN1cnJlbnRseSBkaXNjb25uZWN0ZWRcbiAgICAgKlxuICAgICAqIEBleGFtcGxlXG4gICAgICogY29uc3Qgc29ja2V0ID0gaW8oKTtcbiAgICAgKlxuICAgICAqIHNvY2tldC5vbihcImNvbm5lY3RcIiwgKCkgPT4ge1xuICAgICAqICAgY29uc29sZS5sb2coc29ja2V0LmRpc2Nvbm5lY3RlZCk7IC8vIGZhbHNlXG4gICAgICogfSk7XG4gICAgICpcbiAgICAgKiBzb2NrZXQub24oXCJkaXNjb25uZWN0XCIsICgpID0+IHtcbiAgICAgKiAgIGNvbnNvbGUubG9nKHNvY2tldC5kaXNjb25uZWN0ZWQpOyAvLyB0cnVlXG4gICAgICogfSk7XG4gICAgICovXG4gICAgZ2V0IGRpc2Nvbm5lY3RlZCgpIHtcbiAgICAgICAgcmV0dXJuICF0aGlzLmNvbm5lY3RlZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3Vic2NyaWJlIHRvIG9wZW4sIGNsb3NlIGFuZCBwYWNrZXQgZXZlbnRzXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHN1YkV2ZW50cygpIHtcbiAgICAgICAgaWYgKHRoaXMuc3VicylcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgY29uc3QgaW8gPSB0aGlzLmlvO1xuICAgICAgICB0aGlzLnN1YnMgPSBbXG4gICAgICAgICAgICBvbihpbywgXCJvcGVuXCIsIHRoaXMub25vcGVuLmJpbmQodGhpcykpLFxuICAgICAgICAgICAgb24oaW8sIFwicGFja2V0XCIsIHRoaXMub25wYWNrZXQuYmluZCh0aGlzKSksXG4gICAgICAgICAgICBvbihpbywgXCJlcnJvclwiLCB0aGlzLm9uZXJyb3IuYmluZCh0aGlzKSksXG4gICAgICAgICAgICBvbihpbywgXCJjbG9zZVwiLCB0aGlzLm9uY2xvc2UuYmluZCh0aGlzKSksXG4gICAgICAgIF07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFdoZXRoZXIgdGhlIFNvY2tldCB3aWxsIHRyeSB0byByZWNvbm5lY3Qgd2hlbiBpdHMgTWFuYWdlciBjb25uZWN0cyBvciByZWNvbm5lY3RzLlxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBjb25zdCBzb2NrZXQgPSBpbygpO1xuICAgICAqXG4gICAgICogY29uc29sZS5sb2coc29ja2V0LmFjdGl2ZSk7IC8vIHRydWVcbiAgICAgKlxuICAgICAqIHNvY2tldC5vbihcImRpc2Nvbm5lY3RcIiwgKHJlYXNvbikgPT4ge1xuICAgICAqICAgaWYgKHJlYXNvbiA9PT0gXCJpbyBzZXJ2ZXIgZGlzY29ubmVjdFwiKSB7XG4gICAgICogICAgIC8vIHRoZSBkaXNjb25uZWN0aW9uIHdhcyBpbml0aWF0ZWQgYnkgdGhlIHNlcnZlciwgeW91IG5lZWQgdG8gbWFudWFsbHkgcmVjb25uZWN0XG4gICAgICogICAgIGNvbnNvbGUubG9nKHNvY2tldC5hY3RpdmUpOyAvLyBmYWxzZVxuICAgICAqICAgfVxuICAgICAqICAgLy8gZWxzZSB0aGUgc29ja2V0IHdpbGwgYXV0b21hdGljYWxseSB0cnkgdG8gcmVjb25uZWN0XG4gICAgICogICBjb25zb2xlLmxvZyhzb2NrZXQuYWN0aXZlKTsgLy8gdHJ1ZVxuICAgICAqIH0pO1xuICAgICAqL1xuICAgIGdldCBhY3RpdmUoKSB7XG4gICAgICAgIHJldHVybiAhIXRoaXMuc3VicztcbiAgICB9XG4gICAgLyoqXG4gICAgICogXCJPcGVuc1wiIHRoZSBzb2NrZXQuXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIGNvbnN0IHNvY2tldCA9IGlvKHtcbiAgICAgKiAgIGF1dG9Db25uZWN0OiBmYWxzZVxuICAgICAqIH0pO1xuICAgICAqXG4gICAgICogc29ja2V0LmNvbm5lY3QoKTtcbiAgICAgKi9cbiAgICBjb25uZWN0KCkge1xuICAgICAgICBpZiAodGhpcy5jb25uZWN0ZWQpXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgdGhpcy5zdWJFdmVudHMoKTtcbiAgICAgICAgaWYgKCF0aGlzLmlvW1wiX3JlY29ubmVjdGluZ1wiXSlcbiAgICAgICAgICAgIHRoaXMuaW8ub3BlbigpOyAvLyBlbnN1cmUgb3BlblxuICAgICAgICBpZiAoXCJvcGVuXCIgPT09IHRoaXMuaW8uX3JlYWR5U3RhdGUpXG4gICAgICAgICAgICB0aGlzLm9ub3BlbigpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWxpYXMgZm9yIHtAbGluayBjb25uZWN0KCl9LlxuICAgICAqL1xuICAgIG9wZW4oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbm5lY3QoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VuZHMgYSBgbWVzc2FnZWAgZXZlbnQuXG4gICAgICpcbiAgICAgKiBUaGlzIG1ldGhvZCBtaW1pY3MgdGhlIFdlYlNvY2tldC5zZW5kKCkgbWV0aG9kLlxuICAgICAqXG4gICAgICogQHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvV2ViU29ja2V0L3NlbmRcbiAgICAgKlxuICAgICAqIEBleGFtcGxlXG4gICAgICogc29ja2V0LnNlbmQoXCJoZWxsb1wiKTtcbiAgICAgKlxuICAgICAqIC8vIHRoaXMgaXMgZXF1aXZhbGVudCB0b1xuICAgICAqIHNvY2tldC5lbWl0KFwibWVzc2FnZVwiLCBcImhlbGxvXCIpO1xuICAgICAqXG4gICAgICogQHJldHVybiBzZWxmXG4gICAgICovXG4gICAgc2VuZCguLi5hcmdzKSB7XG4gICAgICAgIGFyZ3MudW5zaGlmdChcIm1lc3NhZ2VcIik7XG4gICAgICAgIHRoaXMuZW1pdC5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE92ZXJyaWRlIGBlbWl0YC5cbiAgICAgKiBJZiB0aGUgZXZlbnQgaXMgaW4gYGV2ZW50c2AsIGl0J3MgZW1pdHRlZCBub3JtYWxseS5cbiAgICAgKlxuICAgICAqIEBleGFtcGxlXG4gICAgICogc29ja2V0LmVtaXQoXCJoZWxsb1wiLCBcIndvcmxkXCIpO1xuICAgICAqXG4gICAgICogLy8gYWxsIHNlcmlhbGl6YWJsZSBkYXRhc3RydWN0dXJlcyBhcmUgc3VwcG9ydGVkIChubyBuZWVkIHRvIGNhbGwgSlNPTi5zdHJpbmdpZnkpXG4gICAgICogc29ja2V0LmVtaXQoXCJoZWxsb1wiLCAxLCBcIjJcIiwgeyAzOiBbXCI0XCJdLCA1OiBVaW50OEFycmF5LmZyb20oWzZdKSB9KTtcbiAgICAgKlxuICAgICAqIC8vIHdpdGggYW4gYWNrbm93bGVkZ2VtZW50IGZyb20gdGhlIHNlcnZlclxuICAgICAqIHNvY2tldC5lbWl0KFwiaGVsbG9cIiwgXCJ3b3JsZFwiLCAodmFsKSA9PiB7XG4gICAgICogICAvLyAuLi5cbiAgICAgKiB9KTtcbiAgICAgKlxuICAgICAqIEByZXR1cm4gc2VsZlxuICAgICAqL1xuICAgIGVtaXQoZXYsIC4uLmFyZ3MpIHtcbiAgICAgICAgdmFyIF9hLCBfYiwgX2M7XG4gICAgICAgIGlmIChSRVNFUlZFRF9FVkVOVFMuaGFzT3duUHJvcGVydHkoZXYpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1wiJyArIGV2LnRvU3RyaW5nKCkgKyAnXCIgaXMgYSByZXNlcnZlZCBldmVudCBuYW1lJyk7XG4gICAgICAgIH1cbiAgICAgICAgYXJncy51bnNoaWZ0KGV2KTtcbiAgICAgICAgaWYgKHRoaXMuX29wdHMucmV0cmllcyAmJiAhdGhpcy5mbGFncy5mcm9tUXVldWUgJiYgIXRoaXMuZmxhZ3Mudm9sYXRpbGUpIHtcbiAgICAgICAgICAgIHRoaXMuX2FkZFRvUXVldWUoYXJncyk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBwYWNrZXQgPSB7XG4gICAgICAgICAgICB0eXBlOiBQYWNrZXRUeXBlLkVWRU5ULFxuICAgICAgICAgICAgZGF0YTogYXJncyxcbiAgICAgICAgfTtcbiAgICAgICAgcGFja2V0Lm9wdGlvbnMgPSB7fTtcbiAgICAgICAgcGFja2V0Lm9wdGlvbnMuY29tcHJlc3MgPSB0aGlzLmZsYWdzLmNvbXByZXNzICE9PSBmYWxzZTtcbiAgICAgICAgLy8gZXZlbnQgYWNrIGNhbGxiYWNrXG4gICAgICAgIGlmIChcImZ1bmN0aW9uXCIgPT09IHR5cGVvZiBhcmdzW2FyZ3MubGVuZ3RoIC0gMV0pIHtcbiAgICAgICAgICAgIGNvbnN0IGlkID0gdGhpcy5pZHMrKztcbiAgICAgICAgICAgIGNvbnN0IGFjayA9IGFyZ3MucG9wKCk7XG4gICAgICAgICAgICB0aGlzLl9yZWdpc3RlckFja0NhbGxiYWNrKGlkLCBhY2spO1xuICAgICAgICAgICAgcGFja2V0LmlkID0gaWQ7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaXNUcmFuc3BvcnRXcml0YWJsZSA9IChfYiA9IChfYSA9IHRoaXMuaW8uZW5naW5lKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EudHJhbnNwb3J0KSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Iud3JpdGFibGU7XG4gICAgICAgIGNvbnN0IGlzQ29ubmVjdGVkID0gdGhpcy5jb25uZWN0ZWQgJiYgISgoX2MgPSB0aGlzLmlvLmVuZ2luZSkgPT09IG51bGwgfHwgX2MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jLl9oYXNQaW5nRXhwaXJlZCgpKTtcbiAgICAgICAgY29uc3QgZGlzY2FyZFBhY2tldCA9IHRoaXMuZmxhZ3Mudm9sYXRpbGUgJiYgIWlzVHJhbnNwb3J0V3JpdGFibGU7XG4gICAgICAgIGlmIChkaXNjYXJkUGFja2V0KSB7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoaXNDb25uZWN0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMubm90aWZ5T3V0Z29pbmdMaXN0ZW5lcnMocGFja2V0KTtcbiAgICAgICAgICAgIHRoaXMucGFja2V0KHBhY2tldCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNlbmRCdWZmZXIucHVzaChwYWNrZXQpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZmxhZ3MgPSB7fTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3JlZ2lzdGVyQWNrQ2FsbGJhY2soaWQsIGFjaykge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGNvbnN0IHRpbWVvdXQgPSAoX2EgPSB0aGlzLmZsYWdzLnRpbWVvdXQpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IHRoaXMuX29wdHMuYWNrVGltZW91dDtcbiAgICAgICAgaWYgKHRpbWVvdXQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5hY2tzW2lkXSA9IGFjaztcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGNvbnN0IHRpbWVyID0gdGhpcy5pby5zZXRUaW1lb3V0Rm4oKCkgPT4ge1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMuYWNrc1tpZF07XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuc2VuZEJ1ZmZlci5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNlbmRCdWZmZXJbaV0uaWQgPT09IGlkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VuZEJ1ZmZlci5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYWNrLmNhbGwodGhpcywgbmV3IEVycm9yKFwib3BlcmF0aW9uIGhhcyB0aW1lZCBvdXRcIikpO1xuICAgICAgICB9LCB0aW1lb3V0KTtcbiAgICAgICAgY29uc3QgZm4gPSAoLi4uYXJncykgPT4ge1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgdGhpcy5pby5jbGVhclRpbWVvdXRGbih0aW1lcik7XG4gICAgICAgICAgICBhY2suYXBwbHkodGhpcywgYXJncyk7XG4gICAgICAgIH07XG4gICAgICAgIGZuLndpdGhFcnJvciA9IHRydWU7XG4gICAgICAgIHRoaXMuYWNrc1tpZF0gPSBmbjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRW1pdHMgYW4gZXZlbnQgYW5kIHdhaXRzIGZvciBhbiBhY2tub3dsZWRnZW1lbnRcbiAgICAgKlxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gd2l0aG91dCB0aW1lb3V0XG4gICAgICogY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBzb2NrZXQuZW1pdFdpdGhBY2soXCJoZWxsb1wiLCBcIndvcmxkXCIpO1xuICAgICAqXG4gICAgICogLy8gd2l0aCBhIHNwZWNpZmljIHRpbWVvdXRcbiAgICAgKiB0cnkge1xuICAgICAqICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBzb2NrZXQudGltZW91dCgxMDAwKS5lbWl0V2l0aEFjayhcImhlbGxvXCIsIFwid29ybGRcIik7XG4gICAgICogfSBjYXRjaCAoZXJyKSB7XG4gICAgICogICAvLyB0aGUgc2VydmVyIGRpZCBub3QgYWNrbm93bGVkZ2UgdGhlIGV2ZW50IGluIHRoZSBnaXZlbiBkZWxheVxuICAgICAqIH1cbiAgICAgKlxuICAgICAqIEByZXR1cm4gYSBQcm9taXNlIHRoYXQgd2lsbCBiZSBmdWxmaWxsZWQgd2hlbiB0aGUgc2VydmVyIGFja25vd2xlZGdlcyB0aGUgZXZlbnRcbiAgICAgKi9cbiAgICBlbWl0V2l0aEFjayhldiwgLi4uYXJncykge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZm4gPSAoYXJnMSwgYXJnMikgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiBhcmcxID8gcmVqZWN0KGFyZzEpIDogcmVzb2x2ZShhcmcyKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBmbi53aXRoRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgYXJncy5wdXNoKGZuKTtcbiAgICAgICAgICAgIHRoaXMuZW1pdChldiwgLi4uYXJncyk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGQgdGhlIHBhY2tldCB0byB0aGUgcXVldWUuXG4gICAgICogQHBhcmFtIGFyZ3NcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9hZGRUb1F1ZXVlKGFyZ3MpIHtcbiAgICAgICAgbGV0IGFjaztcbiAgICAgICAgaWYgKHR5cGVvZiBhcmdzW2FyZ3MubGVuZ3RoIC0gMV0gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgYWNrID0gYXJncy5wb3AoKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBwYWNrZXQgPSB7XG4gICAgICAgICAgICBpZDogdGhpcy5fcXVldWVTZXErKyxcbiAgICAgICAgICAgIHRyeUNvdW50OiAwLFxuICAgICAgICAgICAgcGVuZGluZzogZmFsc2UsXG4gICAgICAgICAgICBhcmdzLFxuICAgICAgICAgICAgZmxhZ3M6IE9iamVjdC5hc3NpZ24oeyBmcm9tUXVldWU6IHRydWUgfSwgdGhpcy5mbGFncyksXG4gICAgICAgIH07XG4gICAgICAgIGFyZ3MucHVzaCgoZXJyLCAuLi5yZXNwb25zZUFyZ3MpID0+IHtcbiAgICAgICAgICAgIGlmIChwYWNrZXQgIT09IHRoaXMuX3F1ZXVlWzBdKSB7XG4gICAgICAgICAgICAgICAgLy8gdGhlIHBhY2tldCBoYXMgYWxyZWFkeSBiZWVuIGFja25vd2xlZGdlZFxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGhhc0Vycm9yID0gZXJyICE9PSBudWxsO1xuICAgICAgICAgICAgaWYgKGhhc0Vycm9yKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBhY2tldC50cnlDb3VudCA+IHRoaXMuX29wdHMucmV0cmllcykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9xdWV1ZS5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYWNrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY2soZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX3F1ZXVlLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgaWYgKGFjaykge1xuICAgICAgICAgICAgICAgICAgICBhY2sobnVsbCwgLi4ucmVzcG9uc2VBcmdzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwYWNrZXQucGVuZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2RyYWluUXVldWUoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX3F1ZXVlLnB1c2gocGFja2V0KTtcbiAgICAgICAgdGhpcy5fZHJhaW5RdWV1ZSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZW5kIHRoZSBmaXJzdCBwYWNrZXQgb2YgdGhlIHF1ZXVlLCBhbmQgd2FpdCBmb3IgYW4gYWNrbm93bGVkZ2VtZW50IGZyb20gdGhlIHNlcnZlci5cbiAgICAgKiBAcGFyYW0gZm9yY2UgLSB3aGV0aGVyIHRvIHJlc2VuZCBhIHBhY2tldCB0aGF0IGhhcyBub3QgYmVlbiBhY2tub3dsZWRnZWQgeWV0XG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9kcmFpblF1ZXVlKGZvcmNlID0gZmFsc2UpIHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbm5lY3RlZCB8fCB0aGlzLl9xdWV1ZS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBwYWNrZXQgPSB0aGlzLl9xdWV1ZVswXTtcbiAgICAgICAgaWYgKHBhY2tldC5wZW5kaW5nICYmICFmb3JjZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHBhY2tldC5wZW5kaW5nID0gdHJ1ZTtcbiAgICAgICAgcGFja2V0LnRyeUNvdW50Kys7XG4gICAgICAgIHRoaXMuZmxhZ3MgPSBwYWNrZXQuZmxhZ3M7XG4gICAgICAgIHRoaXMuZW1pdC5hcHBseSh0aGlzLCBwYWNrZXQuYXJncyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlbmRzIGEgcGFja2V0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhY2tldFxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgcGFja2V0KHBhY2tldCkge1xuICAgICAgICBwYWNrZXQubnNwID0gdGhpcy5uc3A7XG4gICAgICAgIHRoaXMuaW8uX3BhY2tldChwYWNrZXQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgdXBvbiBlbmdpbmUgYG9wZW5gLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBvbm9wZW4oKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5hdXRoID09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgdGhpcy5hdXRoKChkYXRhKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc2VuZENvbm5lY3RQYWNrZXQoZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX3NlbmRDb25uZWN0UGFja2V0KHRoaXMuYXV0aCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VuZHMgYSBDT05ORUNUIHBhY2tldCB0byBpbml0aWF0ZSB0aGUgU29ja2V0LklPIHNlc3Npb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZGF0YVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3NlbmRDb25uZWN0UGFja2V0KGRhdGEpIHtcbiAgICAgICAgdGhpcy5wYWNrZXQoe1xuICAgICAgICAgICAgdHlwZTogUGFja2V0VHlwZS5DT05ORUNULFxuICAgICAgICAgICAgZGF0YTogdGhpcy5fcGlkXG4gICAgICAgICAgICAgICAgPyBPYmplY3QuYXNzaWduKHsgcGlkOiB0aGlzLl9waWQsIG9mZnNldDogdGhpcy5fbGFzdE9mZnNldCB9LCBkYXRhKVxuICAgICAgICAgICAgICAgIDogZGF0YSxcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxlZCB1cG9uIGVuZ2luZSBvciBtYW5hZ2VyIGBlcnJvcmAuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZXJyXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBvbmVycm9yKGVycikge1xuICAgICAgICBpZiAoIXRoaXMuY29ubmVjdGVkKSB7XG4gICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcImNvbm5lY3RfZXJyb3JcIiwgZXJyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgdXBvbiBlbmdpbmUgYGNsb3NlYC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSByZWFzb25cbiAgICAgKiBAcGFyYW0gZGVzY3JpcHRpb25cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIG9uY2xvc2UocmVhc29uLCBkZXNjcmlwdGlvbikge1xuICAgICAgICB0aGlzLmNvbm5lY3RlZCA9IGZhbHNlO1xuICAgICAgICBkZWxldGUgdGhpcy5pZDtcbiAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJkaXNjb25uZWN0XCIsIHJlYXNvbiwgZGVzY3JpcHRpb24pO1xuICAgICAgICB0aGlzLl9jbGVhckFja3MoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2xlYXJzIHRoZSBhY2tub3dsZWRnZW1lbnQgaGFuZGxlcnMgdXBvbiBkaXNjb25uZWN0aW9uLCBzaW5jZSB0aGUgY2xpZW50IHdpbGwgbmV2ZXIgcmVjZWl2ZSBhbiBhY2tub3dsZWRnZW1lbnQgZnJvbVxuICAgICAqIHRoZSBzZXJ2ZXIuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9jbGVhckFja3MoKSB7XG4gICAgICAgIE9iamVjdC5rZXlzKHRoaXMuYWNrcykuZm9yRWFjaCgoaWQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGlzQnVmZmVyZWQgPSB0aGlzLnNlbmRCdWZmZXIuc29tZSgocGFja2V0KSA9PiBTdHJpbmcocGFja2V0LmlkKSA9PT0gaWQpO1xuICAgICAgICAgICAgaWYgKCFpc0J1ZmZlcmVkKSB7XG4gICAgICAgICAgICAgICAgLy8gbm90ZTogaGFuZGxlcnMgdGhhdCBkbyBub3QgYWNjZXB0IGFuIGVycm9yIGFzIGZpcnN0IGFyZ3VtZW50IGFyZSBpZ25vcmVkIGhlcmVcbiAgICAgICAgICAgICAgICBjb25zdCBhY2sgPSB0aGlzLmFja3NbaWRdO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmFja3NbaWRdO1xuICAgICAgICAgICAgICAgIGlmIChhY2sud2l0aEVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjay5jYWxsKHRoaXMsIG5ldyBFcnJvcihcInNvY2tldCBoYXMgYmVlbiBkaXNjb25uZWN0ZWRcIikpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxlZCB3aXRoIHNvY2tldCBwYWNrZXQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFja2V0XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBvbnBhY2tldChwYWNrZXQpIHtcbiAgICAgICAgY29uc3Qgc2FtZU5hbWVzcGFjZSA9IHBhY2tldC5uc3AgPT09IHRoaXMubnNwO1xuICAgICAgICBpZiAoIXNhbWVOYW1lc3BhY2UpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHN3aXRjaCAocGFja2V0LnR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgUGFja2V0VHlwZS5DT05ORUNUOlxuICAgICAgICAgICAgICAgIGlmIChwYWNrZXQuZGF0YSAmJiBwYWNrZXQuZGF0YS5zaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbmNvbm5lY3QocGFja2V0LmRhdGEuc2lkLCBwYWNrZXQuZGF0YS5waWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJjb25uZWN0X2Vycm9yXCIsIG5ldyBFcnJvcihcIkl0IHNlZW1zIHlvdSBhcmUgdHJ5aW5nIHRvIHJlYWNoIGEgU29ja2V0LklPIHNlcnZlciBpbiB2Mi54IHdpdGggYSB2My54IGNsaWVudCwgYnV0IHRoZXkgYXJlIG5vdCBjb21wYXRpYmxlIChtb3JlIGluZm9ybWF0aW9uIGhlcmU6IGh0dHBzOi8vc29ja2V0LmlvL2RvY3MvdjMvbWlncmF0aW5nLWZyb20tMi14LXRvLTMtMC8pXCIpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFBhY2tldFR5cGUuRVZFTlQ6XG4gICAgICAgICAgICBjYXNlIFBhY2tldFR5cGUuQklOQVJZX0VWRU5UOlxuICAgICAgICAgICAgICAgIHRoaXMub25ldmVudChwYWNrZXQpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBQYWNrZXRUeXBlLkFDSzpcbiAgICAgICAgICAgIGNhc2UgUGFja2V0VHlwZS5CSU5BUllfQUNLOlxuICAgICAgICAgICAgICAgIHRoaXMub25hY2socGFja2V0KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgUGFja2V0VHlwZS5ESVNDT05ORUNUOlxuICAgICAgICAgICAgICAgIHRoaXMub25kaXNjb25uZWN0KCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFBhY2tldFR5cGUuQ09OTkVDVF9FUlJPUjpcbiAgICAgICAgICAgICAgICB0aGlzLmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICBjb25zdCBlcnIgPSBuZXcgRXJyb3IocGFja2V0LmRhdGEubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgIGVyci5kYXRhID0gcGFja2V0LmRhdGEuZGF0YTtcbiAgICAgICAgICAgICAgICB0aGlzLmVtaXRSZXNlcnZlZChcImNvbm5lY3RfZXJyb3JcIiwgZXJyKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgdXBvbiBhIHNlcnZlciBldmVudC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYWNrZXRcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIG9uZXZlbnQocGFja2V0KSB7XG4gICAgICAgIGNvbnN0IGFyZ3MgPSBwYWNrZXQuZGF0YSB8fCBbXTtcbiAgICAgICAgaWYgKG51bGwgIT0gcGFja2V0LmlkKSB7XG4gICAgICAgICAgICBhcmdzLnB1c2godGhpcy5hY2socGFja2V0LmlkKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuY29ubmVjdGVkKSB7XG4gICAgICAgICAgICB0aGlzLmVtaXRFdmVudChhcmdzKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucmVjZWl2ZUJ1ZmZlci5wdXNoKE9iamVjdC5mcmVlemUoYXJncykpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVtaXRFdmVudChhcmdzKSB7XG4gICAgICAgIGlmICh0aGlzLl9hbnlMaXN0ZW5lcnMgJiYgdGhpcy5fYW55TGlzdGVuZXJzLmxlbmd0aCkge1xuICAgICAgICAgICAgY29uc3QgbGlzdGVuZXJzID0gdGhpcy5fYW55TGlzdGVuZXJzLnNsaWNlKCk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGxpc3RlbmVyIG9mIGxpc3RlbmVycykge1xuICAgICAgICAgICAgICAgIGxpc3RlbmVyLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHN1cGVyLmVtaXQuYXBwbHkodGhpcywgYXJncyk7XG4gICAgICAgIGlmICh0aGlzLl9waWQgJiYgYXJncy5sZW5ndGggJiYgdHlwZW9mIGFyZ3NbYXJncy5sZW5ndGggLSAxXSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgdGhpcy5fbGFzdE9mZnNldCA9IGFyZ3NbYXJncy5sZW5ndGggLSAxXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBQcm9kdWNlcyBhbiBhY2sgY2FsbGJhY2sgdG8gZW1pdCB3aXRoIGFuIGV2ZW50LlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBhY2soaWQpIHtcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG4gICAgICAgIGxldCBzZW50ID0gZmFsc2U7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoLi4uYXJncykge1xuICAgICAgICAgICAgLy8gcHJldmVudCBkb3VibGUgY2FsbGJhY2tzXG4gICAgICAgICAgICBpZiAoc2VudClcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICBzZW50ID0gdHJ1ZTtcbiAgICAgICAgICAgIHNlbGYucGFja2V0KHtcbiAgICAgICAgICAgICAgICB0eXBlOiBQYWNrZXRUeXBlLkFDSyxcbiAgICAgICAgICAgICAgICBpZDogaWQsXG4gICAgICAgICAgICAgICAgZGF0YTogYXJncyxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgdXBvbiBhIHNlcnZlciBhY2tub3dsZWRnZW1lbnQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFja2V0XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBvbmFjayhwYWNrZXQpIHtcbiAgICAgICAgY29uc3QgYWNrID0gdGhpcy5hY2tzW3BhY2tldC5pZF07XG4gICAgICAgIGlmICh0eXBlb2YgYWNrICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBkZWxldGUgdGhpcy5hY2tzW3BhY2tldC5pZF07XG4gICAgICAgIC8vIEB0cy1pZ25vcmUgRklYTUUgYWNrIGlzIGluY29ycmVjdGx5IGluZmVycmVkIGFzICduZXZlcidcbiAgICAgICAgaWYgKGFjay53aXRoRXJyb3IpIHtcbiAgICAgICAgICAgIHBhY2tldC5kYXRhLnVuc2hpZnQobnVsbCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICBhY2suYXBwbHkodGhpcywgcGFja2V0LmRhdGEpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgdXBvbiBzZXJ2ZXIgY29ubmVjdC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgb25jb25uZWN0KGlkLCBwaWQpIHtcbiAgICAgICAgdGhpcy5pZCA9IGlkO1xuICAgICAgICB0aGlzLnJlY292ZXJlZCA9IHBpZCAmJiB0aGlzLl9waWQgPT09IHBpZDtcbiAgICAgICAgdGhpcy5fcGlkID0gcGlkOyAvLyBkZWZpbmVkIG9ubHkgaWYgY29ubmVjdGlvbiBzdGF0ZSByZWNvdmVyeSBpcyBlbmFibGVkXG4gICAgICAgIHRoaXMuY29ubmVjdGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5lbWl0QnVmZmVyZWQoKTtcbiAgICAgICAgdGhpcy5lbWl0UmVzZXJ2ZWQoXCJjb25uZWN0XCIpO1xuICAgICAgICB0aGlzLl9kcmFpblF1ZXVlKHRydWUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBFbWl0IGJ1ZmZlcmVkIGV2ZW50cyAocmVjZWl2ZWQgYW5kIGVtaXR0ZWQpLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBlbWl0QnVmZmVyZWQoKSB7XG4gICAgICAgIHRoaXMucmVjZWl2ZUJ1ZmZlci5mb3JFYWNoKChhcmdzKSA9PiB0aGlzLmVtaXRFdmVudChhcmdzKSk7XG4gICAgICAgIHRoaXMucmVjZWl2ZUJ1ZmZlciA9IFtdO1xuICAgICAgICB0aGlzLnNlbmRCdWZmZXIuZm9yRWFjaCgocGFja2V0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLm5vdGlmeU91dGdvaW5nTGlzdGVuZXJzKHBhY2tldCk7XG4gICAgICAgICAgICB0aGlzLnBhY2tldChwYWNrZXQpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zZW5kQnVmZmVyID0gW107XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxlZCB1cG9uIHNlcnZlciBkaXNjb25uZWN0LlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBvbmRpc2Nvbm5lY3QoKSB7XG4gICAgICAgIHRoaXMuZGVzdHJveSgpO1xuICAgICAgICB0aGlzLm9uY2xvc2UoXCJpbyBzZXJ2ZXIgZGlzY29ubmVjdFwiKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHVwb24gZm9yY2VkIGNsaWVudC9zZXJ2ZXIgc2lkZSBkaXNjb25uZWN0aW9ucyxcbiAgICAgKiB0aGlzIG1ldGhvZCBlbnN1cmVzIHRoZSBtYW5hZ2VyIHN0b3BzIHRyYWNraW5nIHVzIGFuZFxuICAgICAqIHRoYXQgcmVjb25uZWN0aW9ucyBkb24ndCBnZXQgdHJpZ2dlcmVkIGZvciB0aGlzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBkZXN0cm95KCkge1xuICAgICAgICBpZiAodGhpcy5zdWJzKSB7XG4gICAgICAgICAgICAvLyBjbGVhbiBzdWJzY3JpcHRpb25zIHRvIGF2b2lkIHJlY29ubmVjdGlvbnNcbiAgICAgICAgICAgIHRoaXMuc3Vicy5mb3JFYWNoKChzdWJEZXN0cm95KSA9PiBzdWJEZXN0cm95KCkpO1xuICAgICAgICAgICAgdGhpcy5zdWJzID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaW9bXCJfZGVzdHJveVwiXSh0aGlzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRGlzY29ubmVjdHMgdGhlIHNvY2tldCBtYW51YWxseS4gSW4gdGhhdCBjYXNlLCB0aGUgc29ja2V0IHdpbGwgbm90IHRyeSB0byByZWNvbm5lY3QuXG4gICAgICpcbiAgICAgKiBJZiB0aGlzIGlzIHRoZSBsYXN0IGFjdGl2ZSBTb2NrZXQgaW5zdGFuY2Ugb2YgdGhlIHtAbGluayBNYW5hZ2VyfSwgdGhlIGxvdy1sZXZlbCBjb25uZWN0aW9uIHdpbGwgYmUgY2xvc2VkLlxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBjb25zdCBzb2NrZXQgPSBpbygpO1xuICAgICAqXG4gICAgICogc29ja2V0Lm9uKFwiZGlzY29ubmVjdFwiLCAocmVhc29uKSA9PiB7XG4gICAgICogICAvLyBjb25zb2xlLmxvZyhyZWFzb24pOyBwcmludHMgXCJpbyBjbGllbnQgZGlzY29ubmVjdFwiXG4gICAgICogfSk7XG4gICAgICpcbiAgICAgKiBzb2NrZXQuZGlzY29ubmVjdCgpO1xuICAgICAqXG4gICAgICogQHJldHVybiBzZWxmXG4gICAgICovXG4gICAgZGlzY29ubmVjdCgpIHtcbiAgICAgICAgaWYgKHRoaXMuY29ubmVjdGVkKSB7XG4gICAgICAgICAgICB0aGlzLnBhY2tldCh7IHR5cGU6IFBhY2tldFR5cGUuRElTQ09OTkVDVCB9KTtcbiAgICAgICAgfVxuICAgICAgICAvLyByZW1vdmUgc29ja2V0IGZyb20gcG9vbFxuICAgICAgICB0aGlzLmRlc3Ryb3koKTtcbiAgICAgICAgaWYgKHRoaXMuY29ubmVjdGVkKSB7XG4gICAgICAgICAgICAvLyBmaXJlIGV2ZW50c1xuICAgICAgICAgICAgdGhpcy5vbmNsb3NlKFwiaW8gY2xpZW50IGRpc2Nvbm5lY3RcIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFsaWFzIGZvciB7QGxpbmsgZGlzY29ubmVjdCgpfS5cbiAgICAgKlxuICAgICAqIEByZXR1cm4gc2VsZlxuICAgICAqL1xuICAgIGNsb3NlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kaXNjb25uZWN0KCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIGNvbXByZXNzIGZsYWcuXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIHNvY2tldC5jb21wcmVzcyhmYWxzZSkuZW1pdChcImhlbGxvXCIpO1xuICAgICAqXG4gICAgICogQHBhcmFtIGNvbXByZXNzIC0gaWYgYHRydWVgLCBjb21wcmVzc2VzIHRoZSBzZW5kaW5nIGRhdGFcbiAgICAgKiBAcmV0dXJuIHNlbGZcbiAgICAgKi9cbiAgICBjb21wcmVzcyhjb21wcmVzcykge1xuICAgICAgICB0aGlzLmZsYWdzLmNvbXByZXNzID0gY29tcHJlc3M7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXRzIGEgbW9kaWZpZXIgZm9yIGEgc3Vic2VxdWVudCBldmVudCBlbWlzc2lvbiB0aGF0IHRoZSBldmVudCBtZXNzYWdlIHdpbGwgYmUgZHJvcHBlZCB3aGVuIHRoaXMgc29ja2V0IGlzIG5vdFxuICAgICAqIHJlYWR5IHRvIHNlbmQgbWVzc2FnZXMuXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIHNvY2tldC52b2xhdGlsZS5lbWl0KFwiaGVsbG9cIik7IC8vIHRoZSBzZXJ2ZXIgbWF5IG9yIG1heSBub3QgcmVjZWl2ZSBpdFxuICAgICAqXG4gICAgICogQHJldHVybnMgc2VsZlxuICAgICAqL1xuICAgIGdldCB2b2xhdGlsZSgpIHtcbiAgICAgICAgdGhpcy5mbGFncy52b2xhdGlsZSA9IHRydWU7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXRzIGEgbW9kaWZpZXIgZm9yIGEgc3Vic2VxdWVudCBldmVudCBlbWlzc2lvbiB0aGF0IHRoZSBjYWxsYmFjayB3aWxsIGJlIGNhbGxlZCB3aXRoIGFuIGVycm9yIHdoZW4gdGhlXG4gICAgICogZ2l2ZW4gbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyBoYXZlIGVsYXBzZWQgd2l0aG91dCBhbiBhY2tub3dsZWRnZW1lbnQgZnJvbSB0aGUgc2VydmVyOlxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBzb2NrZXQudGltZW91dCg1MDAwKS5lbWl0KFwibXktZXZlbnRcIiwgKGVycikgPT4ge1xuICAgICAqICAgaWYgKGVycikge1xuICAgICAqICAgICAvLyB0aGUgc2VydmVyIGRpZCBub3QgYWNrbm93bGVkZ2UgdGhlIGV2ZW50IGluIHRoZSBnaXZlbiBkZWxheVxuICAgICAqICAgfVxuICAgICAqIH0pO1xuICAgICAqXG4gICAgICogQHJldHVybnMgc2VsZlxuICAgICAqL1xuICAgIHRpbWVvdXQodGltZW91dCkge1xuICAgICAgICB0aGlzLmZsYWdzLnRpbWVvdXQgPSB0aW1lb3V0O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyBhIGxpc3RlbmVyIHRoYXQgd2lsbCBiZSBmaXJlZCB3aGVuIGFueSBldmVudCBpcyBlbWl0dGVkLiBUaGUgZXZlbnQgbmFtZSBpcyBwYXNzZWQgYXMgdGhlIGZpcnN0IGFyZ3VtZW50IHRvIHRoZVxuICAgICAqIGNhbGxiYWNrLlxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBzb2NrZXQub25BbnkoKGV2ZW50LCAuLi5hcmdzKSA9PiB7XG4gICAgICogICBjb25zb2xlLmxvZyhgZ290ICR7ZXZlbnR9YCk7XG4gICAgICogfSk7XG4gICAgICpcbiAgICAgKiBAcGFyYW0gbGlzdGVuZXJcbiAgICAgKi9cbiAgICBvbkFueShsaXN0ZW5lcikge1xuICAgICAgICB0aGlzLl9hbnlMaXN0ZW5lcnMgPSB0aGlzLl9hbnlMaXN0ZW5lcnMgfHwgW107XG4gICAgICAgIHRoaXMuX2FueUxpc3RlbmVycy5wdXNoKGxpc3RlbmVyKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZHMgYSBsaXN0ZW5lciB0aGF0IHdpbGwgYmUgZmlyZWQgd2hlbiBhbnkgZXZlbnQgaXMgZW1pdHRlZC4gVGhlIGV2ZW50IG5hbWUgaXMgcGFzc2VkIGFzIHRoZSBmaXJzdCBhcmd1bWVudCB0byB0aGVcbiAgICAgKiBjYWxsYmFjay4gVGhlIGxpc3RlbmVyIGlzIGFkZGVkIHRvIHRoZSBiZWdpbm5pbmcgb2YgdGhlIGxpc3RlbmVycyBhcnJheS5cbiAgICAgKlxuICAgICAqIEBleGFtcGxlXG4gICAgICogc29ja2V0LnByZXBlbmRBbnkoKGV2ZW50LCAuLi5hcmdzKSA9PiB7XG4gICAgICogICBjb25zb2xlLmxvZyhgZ290IGV2ZW50ICR7ZXZlbnR9YCk7XG4gICAgICogfSk7XG4gICAgICpcbiAgICAgKiBAcGFyYW0gbGlzdGVuZXJcbiAgICAgKi9cbiAgICBwcmVwZW5kQW55KGxpc3RlbmVyKSB7XG4gICAgICAgIHRoaXMuX2FueUxpc3RlbmVycyA9IHRoaXMuX2FueUxpc3RlbmVycyB8fCBbXTtcbiAgICAgICAgdGhpcy5fYW55TGlzdGVuZXJzLnVuc2hpZnQobGlzdGVuZXIpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyB0aGUgbGlzdGVuZXIgdGhhdCB3aWxsIGJlIGZpcmVkIHdoZW4gYW55IGV2ZW50IGlzIGVtaXR0ZWQuXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIGNvbnN0IGNhdGNoQWxsTGlzdGVuZXIgPSAoZXZlbnQsIC4uLmFyZ3MpID0+IHtcbiAgICAgKiAgIGNvbnNvbGUubG9nKGBnb3QgZXZlbnQgJHtldmVudH1gKTtcbiAgICAgKiB9XG4gICAgICpcbiAgICAgKiBzb2NrZXQub25BbnkoY2F0Y2hBbGxMaXN0ZW5lcik7XG4gICAgICpcbiAgICAgKiAvLyByZW1vdmUgYSBzcGVjaWZpYyBsaXN0ZW5lclxuICAgICAqIHNvY2tldC5vZmZBbnkoY2F0Y2hBbGxMaXN0ZW5lcik7XG4gICAgICpcbiAgICAgKiAvLyBvciByZW1vdmUgYWxsIGxpc3RlbmVyc1xuICAgICAqIHNvY2tldC5vZmZBbnkoKTtcbiAgICAgKlxuICAgICAqIEBwYXJhbSBsaXN0ZW5lclxuICAgICAqL1xuICAgIG9mZkFueShsaXN0ZW5lcikge1xuICAgICAgICBpZiAoIXRoaXMuX2FueUxpc3RlbmVycykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxpc3RlbmVyKSB7XG4gICAgICAgICAgICBjb25zdCBsaXN0ZW5lcnMgPSB0aGlzLl9hbnlMaXN0ZW5lcnM7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3RlbmVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChsaXN0ZW5lciA9PT0gbGlzdGVuZXJzW2ldKSB7XG4gICAgICAgICAgICAgICAgICAgIGxpc3RlbmVycy5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2FueUxpc3RlbmVycyA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGFuIGFycmF5IG9mIGxpc3RlbmVycyB0aGF0IGFyZSBsaXN0ZW5pbmcgZm9yIGFueSBldmVudCB0aGF0IGlzIHNwZWNpZmllZC4gVGhpcyBhcnJheSBjYW4gYmUgbWFuaXB1bGF0ZWQsXG4gICAgICogZS5nLiB0byByZW1vdmUgbGlzdGVuZXJzLlxuICAgICAqL1xuICAgIGxpc3RlbmVyc0FueSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FueUxpc3RlbmVycyB8fCBbXTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyBhIGxpc3RlbmVyIHRoYXQgd2lsbCBiZSBmaXJlZCB3aGVuIGFueSBldmVudCBpcyBlbWl0dGVkLiBUaGUgZXZlbnQgbmFtZSBpcyBwYXNzZWQgYXMgdGhlIGZpcnN0IGFyZ3VtZW50IHRvIHRoZVxuICAgICAqIGNhbGxiYWNrLlxuICAgICAqXG4gICAgICogTm90ZTogYWNrbm93bGVkZ2VtZW50cyBzZW50IHRvIHRoZSBzZXJ2ZXIgYXJlIG5vdCBpbmNsdWRlZC5cbiAgICAgKlxuICAgICAqIEBleGFtcGxlXG4gICAgICogc29ja2V0Lm9uQW55T3V0Z29pbmcoKGV2ZW50LCAuLi5hcmdzKSA9PiB7XG4gICAgICogICBjb25zb2xlLmxvZyhgc2VudCBldmVudCAke2V2ZW50fWApO1xuICAgICAqIH0pO1xuICAgICAqXG4gICAgICogQHBhcmFtIGxpc3RlbmVyXG4gICAgICovXG4gICAgb25BbnlPdXRnb2luZyhsaXN0ZW5lcikge1xuICAgICAgICB0aGlzLl9hbnlPdXRnb2luZ0xpc3RlbmVycyA9IHRoaXMuX2FueU91dGdvaW5nTGlzdGVuZXJzIHx8IFtdO1xuICAgICAgICB0aGlzLl9hbnlPdXRnb2luZ0xpc3RlbmVycy5wdXNoKGxpc3RlbmVyKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZHMgYSBsaXN0ZW5lciB0aGF0IHdpbGwgYmUgZmlyZWQgd2hlbiBhbnkgZXZlbnQgaXMgZW1pdHRlZC4gVGhlIGV2ZW50IG5hbWUgaXMgcGFzc2VkIGFzIHRoZSBmaXJzdCBhcmd1bWVudCB0byB0aGVcbiAgICAgKiBjYWxsYmFjay4gVGhlIGxpc3RlbmVyIGlzIGFkZGVkIHRvIHRoZSBiZWdpbm5pbmcgb2YgdGhlIGxpc3RlbmVycyBhcnJheS5cbiAgICAgKlxuICAgICAqIE5vdGU6IGFja25vd2xlZGdlbWVudHMgc2VudCB0byB0aGUgc2VydmVyIGFyZSBub3QgaW5jbHVkZWQuXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIHNvY2tldC5wcmVwZW5kQW55T3V0Z29pbmcoKGV2ZW50LCAuLi5hcmdzKSA9PiB7XG4gICAgICogICBjb25zb2xlLmxvZyhgc2VudCBldmVudCAke2V2ZW50fWApO1xuICAgICAqIH0pO1xuICAgICAqXG4gICAgICogQHBhcmFtIGxpc3RlbmVyXG4gICAgICovXG4gICAgcHJlcGVuZEFueU91dGdvaW5nKGxpc3RlbmVyKSB7XG4gICAgICAgIHRoaXMuX2FueU91dGdvaW5nTGlzdGVuZXJzID0gdGhpcy5fYW55T3V0Z29pbmdMaXN0ZW5lcnMgfHwgW107XG4gICAgICAgIHRoaXMuX2FueU91dGdvaW5nTGlzdGVuZXJzLnVuc2hpZnQobGlzdGVuZXIpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyB0aGUgbGlzdGVuZXIgdGhhdCB3aWxsIGJlIGZpcmVkIHdoZW4gYW55IGV2ZW50IGlzIGVtaXR0ZWQuXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIGNvbnN0IGNhdGNoQWxsTGlzdGVuZXIgPSAoZXZlbnQsIC4uLmFyZ3MpID0+IHtcbiAgICAgKiAgIGNvbnNvbGUubG9nKGBzZW50IGV2ZW50ICR7ZXZlbnR9YCk7XG4gICAgICogfVxuICAgICAqXG4gICAgICogc29ja2V0Lm9uQW55T3V0Z29pbmcoY2F0Y2hBbGxMaXN0ZW5lcik7XG4gICAgICpcbiAgICAgKiAvLyByZW1vdmUgYSBzcGVjaWZpYyBsaXN0ZW5lclxuICAgICAqIHNvY2tldC5vZmZBbnlPdXRnb2luZyhjYXRjaEFsbExpc3RlbmVyKTtcbiAgICAgKlxuICAgICAqIC8vIG9yIHJlbW92ZSBhbGwgbGlzdGVuZXJzXG4gICAgICogc29ja2V0Lm9mZkFueU91dGdvaW5nKCk7XG4gICAgICpcbiAgICAgKiBAcGFyYW0gW2xpc3RlbmVyXSAtIHRoZSBjYXRjaC1hbGwgbGlzdGVuZXIgKG9wdGlvbmFsKVxuICAgICAqL1xuICAgIG9mZkFueU91dGdvaW5nKGxpc3RlbmVyKSB7XG4gICAgICAgIGlmICghdGhpcy5fYW55T3V0Z29pbmdMaXN0ZW5lcnMpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChsaXN0ZW5lcikge1xuICAgICAgICAgICAgY29uc3QgbGlzdGVuZXJzID0gdGhpcy5fYW55T3V0Z29pbmdMaXN0ZW5lcnM7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3RlbmVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChsaXN0ZW5lciA9PT0gbGlzdGVuZXJzW2ldKSB7XG4gICAgICAgICAgICAgICAgICAgIGxpc3RlbmVycy5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2FueU91dGdvaW5nTGlzdGVuZXJzID0gW107XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYW4gYXJyYXkgb2YgbGlzdGVuZXJzIHRoYXQgYXJlIGxpc3RlbmluZyBmb3IgYW55IGV2ZW50IHRoYXQgaXMgc3BlY2lmaWVkLiBUaGlzIGFycmF5IGNhbiBiZSBtYW5pcHVsYXRlZCxcbiAgICAgKiBlLmcuIHRvIHJlbW92ZSBsaXN0ZW5lcnMuXG4gICAgICovXG4gICAgbGlzdGVuZXJzQW55T3V0Z29pbmcoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hbnlPdXRnb2luZ0xpc3RlbmVycyB8fCBbXTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogTm90aWZ5IHRoZSBsaXN0ZW5lcnMgZm9yIGVhY2ggcGFja2V0IHNlbnRcbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYWNrZXRcbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgbm90aWZ5T3V0Z29pbmdMaXN0ZW5lcnMocGFja2V0KSB7XG4gICAgICAgIGlmICh0aGlzLl9hbnlPdXRnb2luZ0xpc3RlbmVycyAmJiB0aGlzLl9hbnlPdXRnb2luZ0xpc3RlbmVycy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbnN0IGxpc3RlbmVycyA9IHRoaXMuX2FueU91dGdvaW5nTGlzdGVuZXJzLnNsaWNlKCk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGxpc3RlbmVyIG9mIGxpc3RlbmVycykge1xuICAgICAgICAgICAgICAgIGxpc3RlbmVyLmFwcGx5KHRoaXMsIHBhY2tldC5kYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/socket.js\n')},"./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/url.js":
/*!**************************************************************************************************!*\
  !*** ./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/url.js ***!
  \**************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   url: () => (/* binding */ url)\n/* harmony export */ });\n/* harmony import */ var engine_io_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! engine.io-client */ "./node_modules/.pnpm/engine.io-client@6.6.3/node_modules/engine.io-client/build/esm/index.js");\n\n/**\n * URL parser.\n *\n * @param uri - url\n * @param path - the request path of the connection\n * @param loc - An object meant to mimic window.location.\n *        Defaults to window.location.\n * @public\n */\nfunction url(uri, path = "", loc) {\n    let obj = uri;\n    // default to window.location\n    loc = loc || (typeof location !== "undefined" && location);\n    if (null == uri)\n        uri = loc.protocol + "//" + loc.host;\n    // relative path support\n    if (typeof uri === "string") {\n        if ("/" === uri.charAt(0)) {\n            if ("/" === uri.charAt(1)) {\n                uri = loc.protocol + uri;\n            }\n            else {\n                uri = loc.host + uri;\n            }\n        }\n        if (!/^(https?|wss?):\\/\\//.test(uri)) {\n            if ("undefined" !== typeof loc) {\n                uri = loc.protocol + "//" + uri;\n            }\n            else {\n                uri = "https://" + uri;\n            }\n        }\n        // parse\n        obj = (0,engine_io_client__WEBPACK_IMPORTED_MODULE_0__.parse)(uri);\n    }\n    // make sure we treat `localhost:80` and `localhost` equally\n    if (!obj.port) {\n        if (/^(http|ws)$/.test(obj.protocol)) {\n            obj.port = "80";\n        }\n        else if (/^(http|ws)s$/.test(obj.protocol)) {\n            obj.port = "443";\n        }\n    }\n    obj.path = obj.path || "/";\n    const ipv6 = obj.host.indexOf(":") !== -1;\n    const host = ipv6 ? "[" + obj.host + "]" : obj.host;\n    // define unique id\n    obj.id = obj.protocol + "://" + host + ":" + obj.port + path;\n    // define href\n    obj.href =\n        obj.protocol +\n            "://" +\n            host +\n            (loc && loc.port === obj.port ? "" : ":" + obj.port);\n    return obj;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLWNsaWVudEA0LjguMS9ub2RlX21vZHVsZXMvc29ja2V0LmlvLWNsaWVudC9idWlsZC9lc20vdXJsLmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQXlDO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyx1REFBSztBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL3NvY2tldC5pby1jbGllbnRANC44LjEvbm9kZV9tb2R1bGVzL3NvY2tldC5pby1jbGllbnQvYnVpbGQvZXNtL3VybC5qcz9lOTcxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHBhcnNlIH0gZnJvbSBcImVuZ2luZS5pby1jbGllbnRcIjtcbi8qKlxuICogVVJMIHBhcnNlci5cbiAqXG4gKiBAcGFyYW0gdXJpIC0gdXJsXG4gKiBAcGFyYW0gcGF0aCAtIHRoZSByZXF1ZXN0IHBhdGggb2YgdGhlIGNvbm5lY3Rpb25cbiAqIEBwYXJhbSBsb2MgLSBBbiBvYmplY3QgbWVhbnQgdG8gbWltaWMgd2luZG93LmxvY2F0aW9uLlxuICogICAgICAgIERlZmF1bHRzIHRvIHdpbmRvdy5sb2NhdGlvbi5cbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVybCh1cmksIHBhdGggPSBcIlwiLCBsb2MpIHtcbiAgICBsZXQgb2JqID0gdXJpO1xuICAgIC8vIGRlZmF1bHQgdG8gd2luZG93LmxvY2F0aW9uXG4gICAgbG9jID0gbG9jIHx8ICh0eXBlb2YgbG9jYXRpb24gIT09IFwidW5kZWZpbmVkXCIgJiYgbG9jYXRpb24pO1xuICAgIGlmIChudWxsID09IHVyaSlcbiAgICAgICAgdXJpID0gbG9jLnByb3RvY29sICsgXCIvL1wiICsgbG9jLmhvc3Q7XG4gICAgLy8gcmVsYXRpdmUgcGF0aCBzdXBwb3J0XG4gICAgaWYgKHR5cGVvZiB1cmkgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgaWYgKFwiL1wiID09PSB1cmkuY2hhckF0KDApKSB7XG4gICAgICAgICAgICBpZiAoXCIvXCIgPT09IHVyaS5jaGFyQXQoMSkpIHtcbiAgICAgICAgICAgICAgICB1cmkgPSBsb2MucHJvdG9jb2wgKyB1cmk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB1cmkgPSBsb2MuaG9zdCArIHVyaTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIS9eKGh0dHBzP3x3c3M/KTpcXC9cXC8vLnRlc3QodXJpKSkge1xuICAgICAgICAgICAgaWYgKFwidW5kZWZpbmVkXCIgIT09IHR5cGVvZiBsb2MpIHtcbiAgICAgICAgICAgICAgICB1cmkgPSBsb2MucHJvdG9jb2wgKyBcIi8vXCIgKyB1cmk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB1cmkgPSBcImh0dHBzOi8vXCIgKyB1cmk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gcGFyc2VcbiAgICAgICAgb2JqID0gcGFyc2UodXJpKTtcbiAgICB9XG4gICAgLy8gbWFrZSBzdXJlIHdlIHRyZWF0IGBsb2NhbGhvc3Q6ODBgIGFuZCBgbG9jYWxob3N0YCBlcXVhbGx5XG4gICAgaWYgKCFvYmoucG9ydCkge1xuICAgICAgICBpZiAoL14oaHR0cHx3cykkLy50ZXN0KG9iai5wcm90b2NvbCkpIHtcbiAgICAgICAgICAgIG9iai5wb3J0ID0gXCI4MFwiO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKC9eKGh0dHB8d3MpcyQvLnRlc3Qob2JqLnByb3RvY29sKSkge1xuICAgICAgICAgICAgb2JqLnBvcnQgPSBcIjQ0M1wiO1xuICAgICAgICB9XG4gICAgfVxuICAgIG9iai5wYXRoID0gb2JqLnBhdGggfHwgXCIvXCI7XG4gICAgY29uc3QgaXB2NiA9IG9iai5ob3N0LmluZGV4T2YoXCI6XCIpICE9PSAtMTtcbiAgICBjb25zdCBob3N0ID0gaXB2NiA/IFwiW1wiICsgb2JqLmhvc3QgKyBcIl1cIiA6IG9iai5ob3N0O1xuICAgIC8vIGRlZmluZSB1bmlxdWUgaWRcbiAgICBvYmouaWQgPSBvYmoucHJvdG9jb2wgKyBcIjovL1wiICsgaG9zdCArIFwiOlwiICsgb2JqLnBvcnQgKyBwYXRoO1xuICAgIC8vIGRlZmluZSBocmVmXG4gICAgb2JqLmhyZWYgPVxuICAgICAgICBvYmoucHJvdG9jb2wgK1xuICAgICAgICAgICAgXCI6Ly9cIiArXG4gICAgICAgICAgICBob3N0ICtcbiAgICAgICAgICAgIChsb2MgJiYgbG9jLnBvcnQgPT09IG9iai5wb3J0ID8gXCJcIiA6IFwiOlwiICsgb2JqLnBvcnQpO1xuICAgIHJldHVybiBvYmo7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/url.js\n')},"./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/binary.js":
/*!*****************************************************************************************************!*\
  !*** ./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/binary.js ***!
  \*****************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   deconstructPacket: () => (/* binding */ deconstructPacket),\n/* harmony export */   reconstructPacket: () => (/* binding */ reconstructPacket)\n/* harmony export */ });\n/* harmony import */ var _is_binary_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./is-binary.js */ "./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/is-binary.js");\n\n/**\n * Replaces every Buffer | ArrayBuffer | Blob | File in packet with a numbered placeholder.\n *\n * @param {Object} packet - socket.io event packet\n * @return {Object} with deconstructed packet and list of buffers\n * @public\n */\nfunction deconstructPacket(packet) {\n    const buffers = [];\n    const packetData = packet.data;\n    const pack = packet;\n    pack.data = _deconstructPacket(packetData, buffers);\n    pack.attachments = buffers.length; // number of binary \'attachments\'\n    return { packet: pack, buffers: buffers };\n}\nfunction _deconstructPacket(data, buffers) {\n    if (!data)\n        return data;\n    if ((0,_is_binary_js__WEBPACK_IMPORTED_MODULE_0__.isBinary)(data)) {\n        const placeholder = { _placeholder: true, num: buffers.length };\n        buffers.push(data);\n        return placeholder;\n    }\n    else if (Array.isArray(data)) {\n        const newData = new Array(data.length);\n        for (let i = 0; i < data.length; i++) {\n            newData[i] = _deconstructPacket(data[i], buffers);\n        }\n        return newData;\n    }\n    else if (typeof data === "object" && !(data instanceof Date)) {\n        const newData = {};\n        for (const key in data) {\n            if (Object.prototype.hasOwnProperty.call(data, key)) {\n                newData[key] = _deconstructPacket(data[key], buffers);\n            }\n        }\n        return newData;\n    }\n    return data;\n}\n/**\n * Reconstructs a binary packet from its placeholder packet and buffers\n *\n * @param {Object} packet - event packet with placeholders\n * @param {Array} buffers - binary buffers to put in placeholder positions\n * @return {Object} reconstructed packet\n * @public\n */\nfunction reconstructPacket(packet, buffers) {\n    packet.data = _reconstructPacket(packet.data, buffers);\n    delete packet.attachments; // no longer useful\n    return packet;\n}\nfunction _reconstructPacket(data, buffers) {\n    if (!data)\n        return data;\n    if (data && data._placeholder === true) {\n        const isIndexValid = typeof data.num === "number" &&\n            data.num >= 0 &&\n            data.num < buffers.length;\n        if (isIndexValid) {\n            return buffers[data.num]; // appropriate buffer (should be natural order anyway)\n        }\n        else {\n            throw new Error("illegal attachments");\n        }\n    }\n    else if (Array.isArray(data)) {\n        for (let i = 0; i < data.length; i++) {\n            data[i] = _reconstructPacket(data[i], buffers);\n        }\n    }\n    else if (typeof data === "object") {\n        for (const key in data) {\n            if (Object.prototype.hasOwnProperty.call(data, key)) {\n                data[key] = _reconstructPacket(data[key], buffers);\n            }\n        }\n    }\n    return data;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLXBhcnNlckA0LjIuNC9ub2RlX21vZHVsZXMvc29ja2V0LmlvLXBhcnNlci9idWlsZC9lc20vYmluYXJ5LmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUEwQztBQUMxQztBQUNBO0FBQ0E7QUFDQSxXQUFXLFFBQVE7QUFDbkIsWUFBWSxRQUFRO0FBQ3BCO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDO0FBQ3ZDLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsdURBQVE7QUFDaEIsOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsaUJBQWlCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsUUFBUTtBQUNuQixXQUFXLE9BQU87QUFDbEIsWUFBWSxRQUFRO0FBQ3BCO0FBQ0E7QUFDTztBQUNQO0FBQ0EsK0JBQStCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixpQkFBaUI7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL3NvY2tldC5pby1wYXJzZXJANC4yLjQvbm9kZV9tb2R1bGVzL3NvY2tldC5pby1wYXJzZXIvYnVpbGQvZXNtL2JpbmFyeS5qcz9jMTk0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGlzQmluYXJ5IH0gZnJvbSBcIi4vaXMtYmluYXJ5LmpzXCI7XG4vKipcbiAqIFJlcGxhY2VzIGV2ZXJ5IEJ1ZmZlciB8IEFycmF5QnVmZmVyIHwgQmxvYiB8IEZpbGUgaW4gcGFja2V0IHdpdGggYSBudW1iZXJlZCBwbGFjZWhvbGRlci5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gcGFja2V0IC0gc29ja2V0LmlvIGV2ZW50IHBhY2tldFxuICogQHJldHVybiB7T2JqZWN0fSB3aXRoIGRlY29uc3RydWN0ZWQgcGFja2V0IGFuZCBsaXN0IG9mIGJ1ZmZlcnNcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRlY29uc3RydWN0UGFja2V0KHBhY2tldCkge1xuICAgIGNvbnN0IGJ1ZmZlcnMgPSBbXTtcbiAgICBjb25zdCBwYWNrZXREYXRhID0gcGFja2V0LmRhdGE7XG4gICAgY29uc3QgcGFjayA9IHBhY2tldDtcbiAgICBwYWNrLmRhdGEgPSBfZGVjb25zdHJ1Y3RQYWNrZXQocGFja2V0RGF0YSwgYnVmZmVycyk7XG4gICAgcGFjay5hdHRhY2htZW50cyA9IGJ1ZmZlcnMubGVuZ3RoOyAvLyBudW1iZXIgb2YgYmluYXJ5ICdhdHRhY2htZW50cydcbiAgICByZXR1cm4geyBwYWNrZXQ6IHBhY2ssIGJ1ZmZlcnM6IGJ1ZmZlcnMgfTtcbn1cbmZ1bmN0aW9uIF9kZWNvbnN0cnVjdFBhY2tldChkYXRhLCBidWZmZXJzKSB7XG4gICAgaWYgKCFkYXRhKVxuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICBpZiAoaXNCaW5hcnkoZGF0YSkpIHtcbiAgICAgICAgY29uc3QgcGxhY2Vob2xkZXIgPSB7IF9wbGFjZWhvbGRlcjogdHJ1ZSwgbnVtOiBidWZmZXJzLmxlbmd0aCB9O1xuICAgICAgICBidWZmZXJzLnB1c2goZGF0YSk7XG4gICAgICAgIHJldHVybiBwbGFjZWhvbGRlcjtcbiAgICB9XG4gICAgZWxzZSBpZiAoQXJyYXkuaXNBcnJheShkYXRhKSkge1xuICAgICAgICBjb25zdCBuZXdEYXRhID0gbmV3IEFycmF5KGRhdGEubGVuZ3RoKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBuZXdEYXRhW2ldID0gX2RlY29uc3RydWN0UGFja2V0KGRhdGFbaV0sIGJ1ZmZlcnMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXdEYXRhO1xuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlb2YgZGF0YSA9PT0gXCJvYmplY3RcIiAmJiAhKGRhdGEgaW5zdGFuY2VvZiBEYXRlKSkge1xuICAgICAgICBjb25zdCBuZXdEYXRhID0ge307XG4gICAgICAgIGZvciAoY29uc3Qga2V5IGluIGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZGF0YSwga2V5KSkge1xuICAgICAgICAgICAgICAgIG5ld0RhdGFba2V5XSA9IF9kZWNvbnN0cnVjdFBhY2tldChkYXRhW2tleV0sIGJ1ZmZlcnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXdEYXRhO1xuICAgIH1cbiAgICByZXR1cm4gZGF0YTtcbn1cbi8qKlxuICogUmVjb25zdHJ1Y3RzIGEgYmluYXJ5IHBhY2tldCBmcm9tIGl0cyBwbGFjZWhvbGRlciBwYWNrZXQgYW5kIGJ1ZmZlcnNcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gcGFja2V0IC0gZXZlbnQgcGFja2V0IHdpdGggcGxhY2Vob2xkZXJzXG4gKiBAcGFyYW0ge0FycmF5fSBidWZmZXJzIC0gYmluYXJ5IGJ1ZmZlcnMgdG8gcHV0IGluIHBsYWNlaG9sZGVyIHBvc2l0aW9uc1xuICogQHJldHVybiB7T2JqZWN0fSByZWNvbnN0cnVjdGVkIHBhY2tldFxuICogQHB1YmxpY1xuICovXG5leHBvcnQgZnVuY3Rpb24gcmVjb25zdHJ1Y3RQYWNrZXQocGFja2V0LCBidWZmZXJzKSB7XG4gICAgcGFja2V0LmRhdGEgPSBfcmVjb25zdHJ1Y3RQYWNrZXQocGFja2V0LmRhdGEsIGJ1ZmZlcnMpO1xuICAgIGRlbGV0ZSBwYWNrZXQuYXR0YWNobWVudHM7IC8vIG5vIGxvbmdlciB1c2VmdWxcbiAgICByZXR1cm4gcGFja2V0O1xufVxuZnVuY3Rpb24gX3JlY29uc3RydWN0UGFja2V0KGRhdGEsIGJ1ZmZlcnMpIHtcbiAgICBpZiAoIWRhdGEpXG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgIGlmIChkYXRhICYmIGRhdGEuX3BsYWNlaG9sZGVyID09PSB0cnVlKSB7XG4gICAgICAgIGNvbnN0IGlzSW5kZXhWYWxpZCA9IHR5cGVvZiBkYXRhLm51bSA9PT0gXCJudW1iZXJcIiAmJlxuICAgICAgICAgICAgZGF0YS5udW0gPj0gMCAmJlxuICAgICAgICAgICAgZGF0YS5udW0gPCBidWZmZXJzLmxlbmd0aDtcbiAgICAgICAgaWYgKGlzSW5kZXhWYWxpZCkge1xuICAgICAgICAgICAgcmV0dXJuIGJ1ZmZlcnNbZGF0YS5udW1dOyAvLyBhcHByb3ByaWF0ZSBidWZmZXIgKHNob3VsZCBiZSBuYXR1cmFsIG9yZGVyIGFueXdheSlcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImlsbGVnYWwgYXR0YWNobWVudHNcIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoQXJyYXkuaXNBcnJheShkYXRhKSkge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGRhdGFbaV0gPSBfcmVjb25zdHJ1Y3RQYWNrZXQoZGF0YVtpXSwgYnVmZmVycyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZW9mIGRhdGEgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gZGF0YSkge1xuICAgICAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChkYXRhLCBrZXkpKSB7XG4gICAgICAgICAgICAgICAgZGF0YVtrZXldID0gX3JlY29uc3RydWN0UGFja2V0KGRhdGFba2V5XSwgYnVmZmVycyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGRhdGE7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/binary.js\n')},"./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/index.js":
/*!****************************************************************************************************!*\
  !*** ./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/index.js ***!
  \****************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Decoder: () => (/* binding */ Decoder),\n/* harmony export */   Encoder: () => (/* binding */ Encoder),\n/* harmony export */   PacketType: () => (/* binding */ PacketType),\n/* harmony export */   protocol: () => (/* binding */ protocol)\n/* harmony export */ });\n/* harmony import */ var _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @socket.io/component-emitter */ "./node_modules/.pnpm/@socket.io+component-emitter@3.1.2/node_modules/@socket.io/component-emitter/lib/esm/index.js");\n/* harmony import */ var _binary_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./binary.js */ "./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/binary.js");\n/* harmony import */ var _is_binary_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./is-binary.js */ "./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/is-binary.js");\n\n\n\n/**\n * These strings must not be used as event names, as they have a special meaning.\n */\nconst RESERVED_EVENTS = [\n    "connect",\n    "connect_error",\n    "disconnect",\n    "disconnecting",\n    "newListener",\n    "removeListener", // used by the Node.js EventEmitter\n];\n/**\n * Protocol version.\n *\n * @public\n */\nconst protocol = 5;\nvar PacketType;\n(function (PacketType) {\n    PacketType[PacketType["CONNECT"] = 0] = "CONNECT";\n    PacketType[PacketType["DISCONNECT"] = 1] = "DISCONNECT";\n    PacketType[PacketType["EVENT"] = 2] = "EVENT";\n    PacketType[PacketType["ACK"] = 3] = "ACK";\n    PacketType[PacketType["CONNECT_ERROR"] = 4] = "CONNECT_ERROR";\n    PacketType[PacketType["BINARY_EVENT"] = 5] = "BINARY_EVENT";\n    PacketType[PacketType["BINARY_ACK"] = 6] = "BINARY_ACK";\n})(PacketType || (PacketType = {}));\n/**\n * A socket.io Encoder instance\n */\nclass Encoder {\n    /**\n     * Encoder constructor\n     *\n     * @param {function} replacer - custom replacer to pass down to JSON.parse\n     */\n    constructor(replacer) {\n        this.replacer = replacer;\n    }\n    /**\n     * Encode a packet as a single string if non-binary, or as a\n     * buffer sequence, depending on packet type.\n     *\n     * @param {Object} obj - packet object\n     */\n    encode(obj) {\n        if (obj.type === PacketType.EVENT || obj.type === PacketType.ACK) {\n            if ((0,_is_binary_js__WEBPACK_IMPORTED_MODULE_2__.hasBinary)(obj)) {\n                return this.encodeAsBinary({\n                    type: obj.type === PacketType.EVENT\n                        ? PacketType.BINARY_EVENT\n                        : PacketType.BINARY_ACK,\n                    nsp: obj.nsp,\n                    data: obj.data,\n                    id: obj.id,\n                });\n            }\n        }\n        return [this.encodeAsString(obj)];\n    }\n    /**\n     * Encode packet as string.\n     */\n    encodeAsString(obj) {\n        // first is type\n        let str = "" + obj.type;\n        // attachments if we have them\n        if (obj.type === PacketType.BINARY_EVENT ||\n            obj.type === PacketType.BINARY_ACK) {\n            str += obj.attachments + "-";\n        }\n        // if we have a namespace other than `/`\n        // we append it followed by a comma `,`\n        if (obj.nsp && "/" !== obj.nsp) {\n            str += obj.nsp + ",";\n        }\n        // immediately followed by the id\n        if (null != obj.id) {\n            str += obj.id;\n        }\n        // json data\n        if (null != obj.data) {\n            str += JSON.stringify(obj.data, this.replacer);\n        }\n        return str;\n    }\n    /**\n     * Encode packet as \'buffer sequence\' by removing blobs, and\n     * deconstructing packet into object with placeholders and\n     * a list of buffers.\n     */\n    encodeAsBinary(obj) {\n        const deconstruction = (0,_binary_js__WEBPACK_IMPORTED_MODULE_1__.deconstructPacket)(obj);\n        const pack = this.encodeAsString(deconstruction.packet);\n        const buffers = deconstruction.buffers;\n        buffers.unshift(pack); // add packet info to beginning of data list\n        return buffers; // write all the buffers\n    }\n}\n// see https://stackoverflow.com/questions/8511281/check-if-a-value-is-an-object-in-javascript\nfunction isObject(value) {\n    return Object.prototype.toString.call(value) === "[object Object]";\n}\n/**\n * A socket.io Decoder instance\n *\n * @return {Object} decoder\n */\nclass Decoder extends _socket_io_component_emitter__WEBPACK_IMPORTED_MODULE_0__.Emitter {\n    /**\n     * Decoder constructor\n     *\n     * @param {function} reviver - custom reviver to pass down to JSON.stringify\n     */\n    constructor(reviver) {\n        super();\n        this.reviver = reviver;\n    }\n    /**\n     * Decodes an encoded packet string into packet JSON.\n     *\n     * @param {String} obj - encoded packet\n     */\n    add(obj) {\n        let packet;\n        if (typeof obj === "string") {\n            if (this.reconstructor) {\n                throw new Error("got plaintext data when reconstructing a packet");\n            }\n            packet = this.decodeString(obj);\n            const isBinaryEvent = packet.type === PacketType.BINARY_EVENT;\n            if (isBinaryEvent || packet.type === PacketType.BINARY_ACK) {\n                packet.type = isBinaryEvent ? PacketType.EVENT : PacketType.ACK;\n                // binary packet\'s json\n                this.reconstructor = new BinaryReconstructor(packet);\n                // no attachments, labeled binary but no binary data to follow\n                if (packet.attachments === 0) {\n                    super.emitReserved("decoded", packet);\n                }\n            }\n            else {\n                // non-binary full packet\n                super.emitReserved("decoded", packet);\n            }\n        }\n        else if ((0,_is_binary_js__WEBPACK_IMPORTED_MODULE_2__.isBinary)(obj) || obj.base64) {\n            // raw binary data\n            if (!this.reconstructor) {\n                throw new Error("got binary data when not reconstructing a packet");\n            }\n            else {\n                packet = this.reconstructor.takeBinaryData(obj);\n                if (packet) {\n                    // received final buffer\n                    this.reconstructor = null;\n                    super.emitReserved("decoded", packet);\n                }\n            }\n        }\n        else {\n            throw new Error("Unknown type: " + obj);\n        }\n    }\n    /**\n     * Decode a packet String (JSON data)\n     *\n     * @param {String} str\n     * @return {Object} packet\n     */\n    decodeString(str) {\n        let i = 0;\n        // look up type\n        const p = {\n            type: Number(str.charAt(0)),\n        };\n        if (PacketType[p.type] === undefined) {\n            throw new Error("unknown packet type " + p.type);\n        }\n        // look up attachments if type binary\n        if (p.type === PacketType.BINARY_EVENT ||\n            p.type === PacketType.BINARY_ACK) {\n            const start = i + 1;\n            while (str.charAt(++i) !== "-" && i != str.length) { }\n            const buf = str.substring(start, i);\n            if (buf != Number(buf) || str.charAt(i) !== "-") {\n                throw new Error("Illegal attachments");\n            }\n            p.attachments = Number(buf);\n        }\n        // look up namespace (if any)\n        if ("/" === str.charAt(i + 1)) {\n            const start = i + 1;\n            while (++i) {\n                const c = str.charAt(i);\n                if ("," === c)\n                    break;\n                if (i === str.length)\n                    break;\n            }\n            p.nsp = str.substring(start, i);\n        }\n        else {\n            p.nsp = "/";\n        }\n        // look up id\n        const next = str.charAt(i + 1);\n        if ("" !== next && Number(next) == next) {\n            const start = i + 1;\n            while (++i) {\n                const c = str.charAt(i);\n                if (null == c || Number(c) != c) {\n                    --i;\n                    break;\n                }\n                if (i === str.length)\n                    break;\n            }\n            p.id = Number(str.substring(start, i + 1));\n        }\n        // look up json data\n        if (str.charAt(++i)) {\n            const payload = this.tryParse(str.substr(i));\n            if (Decoder.isPayloadValid(p.type, payload)) {\n                p.data = payload;\n            }\n            else {\n                throw new Error("invalid payload");\n            }\n        }\n        return p;\n    }\n    tryParse(str) {\n        try {\n            return JSON.parse(str, this.reviver);\n        }\n        catch (e) {\n            return false;\n        }\n    }\n    static isPayloadValid(type, payload) {\n        switch (type) {\n            case PacketType.CONNECT:\n                return isObject(payload);\n            case PacketType.DISCONNECT:\n                return payload === undefined;\n            case PacketType.CONNECT_ERROR:\n                return typeof payload === "string" || isObject(payload);\n            case PacketType.EVENT:\n            case PacketType.BINARY_EVENT:\n                return (Array.isArray(payload) &&\n                    (typeof payload[0] === "number" ||\n                        (typeof payload[0] === "string" &&\n                            RESERVED_EVENTS.indexOf(payload[0]) === -1)));\n            case PacketType.ACK:\n            case PacketType.BINARY_ACK:\n                return Array.isArray(payload);\n        }\n    }\n    /**\n     * Deallocates a parser\'s resources\n     */\n    destroy() {\n        if (this.reconstructor) {\n            this.reconstructor.finishedReconstruction();\n            this.reconstructor = null;\n        }\n    }\n}\n/**\n * A manager of a binary event\'s \'buffer sequence\'. Should\n * be constructed whenever a packet of type BINARY_EVENT is\n * decoded.\n *\n * @param {Object} packet\n * @return {BinaryReconstructor} initialized reconstructor\n */\nclass BinaryReconstructor {\n    constructor(packet) {\n        this.packet = packet;\n        this.buffers = [];\n        this.reconPack = packet;\n    }\n    /**\n     * Method to be called when binary data received from connection\n     * after a BINARY_EVENT packet.\n     *\n     * @param {Buffer | ArrayBuffer} binData - the raw binary data received\n     * @return {null | Object} returns null if more binary data is expected or\n     *   a reconstructed packet object if all buffers have been received.\n     */\n    takeBinaryData(binData) {\n        this.buffers.push(binData);\n        if (this.buffers.length === this.reconPack.attachments) {\n            // done with buffer list\n            const packet = (0,_binary_js__WEBPACK_IMPORTED_MODULE_1__.reconstructPacket)(this.reconPack, this.buffers);\n            this.finishedReconstruction();\n            return packet;\n        }\n        return null;\n    }\n    /**\n     * Cleans up binary packet reconstruction variables.\n     */\n    finishedReconstruction() {\n        this.reconPack = null;\n        this.buffers = [];\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLXBhcnNlckA0LjIuNC9ub2RlX21vZHVsZXMvc29ja2V0LmlvLXBhcnNlci9idWlsZC9lc20vaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUF1RDtBQUNZO0FBQ2Q7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNBO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsZ0NBQWdDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsZUFBZSxVQUFVO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkI7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLHdEQUFTO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQiw2REFBaUI7QUFDaEQ7QUFDQTtBQUNBLCtCQUErQjtBQUMvQix3QkFBd0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxRQUFRO0FBQ3BCO0FBQ08sc0JBQXNCLGlFQUFPO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBLGVBQWUsVUFBVTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsdURBQVE7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsUUFBUTtBQUN2QixnQkFBZ0IsUUFBUTtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFFBQVE7QUFDbkIsWUFBWSxxQkFBcUI7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsc0JBQXNCO0FBQ3JDLGdCQUFnQixlQUFlO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQiw2REFBaUI7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLXBhcnNlckA0LjIuNC9ub2RlX21vZHVsZXMvc29ja2V0LmlvLXBhcnNlci9idWlsZC9lc20vaW5kZXguanM/YTdjYyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBFbWl0dGVyIH0gZnJvbSBcIkBzb2NrZXQuaW8vY29tcG9uZW50LWVtaXR0ZXJcIjtcbmltcG9ydCB7IGRlY29uc3RydWN0UGFja2V0LCByZWNvbnN0cnVjdFBhY2tldCB9IGZyb20gXCIuL2JpbmFyeS5qc1wiO1xuaW1wb3J0IHsgaXNCaW5hcnksIGhhc0JpbmFyeSB9IGZyb20gXCIuL2lzLWJpbmFyeS5qc1wiO1xuLyoqXG4gKiBUaGVzZSBzdHJpbmdzIG11c3Qgbm90IGJlIHVzZWQgYXMgZXZlbnQgbmFtZXMsIGFzIHRoZXkgaGF2ZSBhIHNwZWNpYWwgbWVhbmluZy5cbiAqL1xuY29uc3QgUkVTRVJWRURfRVZFTlRTID0gW1xuICAgIFwiY29ubmVjdFwiLFxuICAgIFwiY29ubmVjdF9lcnJvclwiLFxuICAgIFwiZGlzY29ubmVjdFwiLFxuICAgIFwiZGlzY29ubmVjdGluZ1wiLFxuICAgIFwibmV3TGlzdGVuZXJcIixcbiAgICBcInJlbW92ZUxpc3RlbmVyXCIsIC8vIHVzZWQgYnkgdGhlIE5vZGUuanMgRXZlbnRFbWl0dGVyXG5dO1xuLyoqXG4gKiBQcm90b2NvbCB2ZXJzaW9uLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGNvbnN0IHByb3RvY29sID0gNTtcbmV4cG9ydCB2YXIgUGFja2V0VHlwZTtcbihmdW5jdGlvbiAoUGFja2V0VHlwZSkge1xuICAgIFBhY2tldFR5cGVbUGFja2V0VHlwZVtcIkNPTk5FQ1RcIl0gPSAwXSA9IFwiQ09OTkVDVFwiO1xuICAgIFBhY2tldFR5cGVbUGFja2V0VHlwZVtcIkRJU0NPTk5FQ1RcIl0gPSAxXSA9IFwiRElTQ09OTkVDVFwiO1xuICAgIFBhY2tldFR5cGVbUGFja2V0VHlwZVtcIkVWRU5UXCJdID0gMl0gPSBcIkVWRU5UXCI7XG4gICAgUGFja2V0VHlwZVtQYWNrZXRUeXBlW1wiQUNLXCJdID0gM10gPSBcIkFDS1wiO1xuICAgIFBhY2tldFR5cGVbUGFja2V0VHlwZVtcIkNPTk5FQ1RfRVJST1JcIl0gPSA0XSA9IFwiQ09OTkVDVF9FUlJPUlwiO1xuICAgIFBhY2tldFR5cGVbUGFja2V0VHlwZVtcIkJJTkFSWV9FVkVOVFwiXSA9IDVdID0gXCJCSU5BUllfRVZFTlRcIjtcbiAgICBQYWNrZXRUeXBlW1BhY2tldFR5cGVbXCJCSU5BUllfQUNLXCJdID0gNl0gPSBcIkJJTkFSWV9BQ0tcIjtcbn0pKFBhY2tldFR5cGUgfHwgKFBhY2tldFR5cGUgPSB7fSkpO1xuLyoqXG4gKiBBIHNvY2tldC5pbyBFbmNvZGVyIGluc3RhbmNlXG4gKi9cbmV4cG9ydCBjbGFzcyBFbmNvZGVyIHtcbiAgICAvKipcbiAgICAgKiBFbmNvZGVyIGNvbnN0cnVjdG9yXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSByZXBsYWNlciAtIGN1c3RvbSByZXBsYWNlciB0byBwYXNzIGRvd24gdG8gSlNPTi5wYXJzZVxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHJlcGxhY2VyKSB7XG4gICAgICAgIHRoaXMucmVwbGFjZXIgPSByZXBsYWNlcjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRW5jb2RlIGEgcGFja2V0IGFzIGEgc2luZ2xlIHN0cmluZyBpZiBub24tYmluYXJ5LCBvciBhcyBhXG4gICAgICogYnVmZmVyIHNlcXVlbmNlLCBkZXBlbmRpbmcgb24gcGFja2V0IHR5cGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqIC0gcGFja2V0IG9iamVjdFxuICAgICAqL1xuICAgIGVuY29kZShvYmopIHtcbiAgICAgICAgaWYgKG9iai50eXBlID09PSBQYWNrZXRUeXBlLkVWRU5UIHx8IG9iai50eXBlID09PSBQYWNrZXRUeXBlLkFDSykge1xuICAgICAgICAgICAgaWYgKGhhc0JpbmFyeShvYmopKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZW5jb2RlQXNCaW5hcnkoe1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBvYmoudHlwZSA9PT0gUGFja2V0VHlwZS5FVkVOVFxuICAgICAgICAgICAgICAgICAgICAgICAgPyBQYWNrZXRUeXBlLkJJTkFSWV9FVkVOVFxuICAgICAgICAgICAgICAgICAgICAgICAgOiBQYWNrZXRUeXBlLkJJTkFSWV9BQ0ssXG4gICAgICAgICAgICAgICAgICAgIG5zcDogb2JqLm5zcCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogb2JqLmRhdGEsXG4gICAgICAgICAgICAgICAgICAgIGlkOiBvYmouaWQsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFt0aGlzLmVuY29kZUFzU3RyaW5nKG9iaildO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBFbmNvZGUgcGFja2V0IGFzIHN0cmluZy5cbiAgICAgKi9cbiAgICBlbmNvZGVBc1N0cmluZyhvYmopIHtcbiAgICAgICAgLy8gZmlyc3QgaXMgdHlwZVxuICAgICAgICBsZXQgc3RyID0gXCJcIiArIG9iai50eXBlO1xuICAgICAgICAvLyBhdHRhY2htZW50cyBpZiB3ZSBoYXZlIHRoZW1cbiAgICAgICAgaWYgKG9iai50eXBlID09PSBQYWNrZXRUeXBlLkJJTkFSWV9FVkVOVCB8fFxuICAgICAgICAgICAgb2JqLnR5cGUgPT09IFBhY2tldFR5cGUuQklOQVJZX0FDSykge1xuICAgICAgICAgICAgc3RyICs9IG9iai5hdHRhY2htZW50cyArIFwiLVwiO1xuICAgICAgICB9XG4gICAgICAgIC8vIGlmIHdlIGhhdmUgYSBuYW1lc3BhY2Ugb3RoZXIgdGhhbiBgL2BcbiAgICAgICAgLy8gd2UgYXBwZW5kIGl0IGZvbGxvd2VkIGJ5IGEgY29tbWEgYCxgXG4gICAgICAgIGlmIChvYmoubnNwICYmIFwiL1wiICE9PSBvYmoubnNwKSB7XG4gICAgICAgICAgICBzdHIgKz0gb2JqLm5zcCArIFwiLFwiO1xuICAgICAgICB9XG4gICAgICAgIC8vIGltbWVkaWF0ZWx5IGZvbGxvd2VkIGJ5IHRoZSBpZFxuICAgICAgICBpZiAobnVsbCAhPSBvYmouaWQpIHtcbiAgICAgICAgICAgIHN0ciArPSBvYmouaWQ7XG4gICAgICAgIH1cbiAgICAgICAgLy8ganNvbiBkYXRhXG4gICAgICAgIGlmIChudWxsICE9IG9iai5kYXRhKSB7XG4gICAgICAgICAgICBzdHIgKz0gSlNPTi5zdHJpbmdpZnkob2JqLmRhdGEsIHRoaXMucmVwbGFjZXIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdHI7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEVuY29kZSBwYWNrZXQgYXMgJ2J1ZmZlciBzZXF1ZW5jZScgYnkgcmVtb3ZpbmcgYmxvYnMsIGFuZFxuICAgICAqIGRlY29uc3RydWN0aW5nIHBhY2tldCBpbnRvIG9iamVjdCB3aXRoIHBsYWNlaG9sZGVycyBhbmRcbiAgICAgKiBhIGxpc3Qgb2YgYnVmZmVycy5cbiAgICAgKi9cbiAgICBlbmNvZGVBc0JpbmFyeShvYmopIHtcbiAgICAgICAgY29uc3QgZGVjb25zdHJ1Y3Rpb24gPSBkZWNvbnN0cnVjdFBhY2tldChvYmopO1xuICAgICAgICBjb25zdCBwYWNrID0gdGhpcy5lbmNvZGVBc1N0cmluZyhkZWNvbnN0cnVjdGlvbi5wYWNrZXQpO1xuICAgICAgICBjb25zdCBidWZmZXJzID0gZGVjb25zdHJ1Y3Rpb24uYnVmZmVycztcbiAgICAgICAgYnVmZmVycy51bnNoaWZ0KHBhY2spOyAvLyBhZGQgcGFja2V0IGluZm8gdG8gYmVnaW5uaW5nIG9mIGRhdGEgbGlzdFxuICAgICAgICByZXR1cm4gYnVmZmVyczsgLy8gd3JpdGUgYWxsIHRoZSBidWZmZXJzXG4gICAgfVxufVxuLy8gc2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzg1MTEyODEvY2hlY2staWYtYS12YWx1ZS1pcy1hbi1vYmplY3QtaW4tamF2YXNjcmlwdFxuZnVuY3Rpb24gaXNPYmplY3QodmFsdWUpIHtcbiAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHZhbHVlKSA9PT0gXCJbb2JqZWN0IE9iamVjdF1cIjtcbn1cbi8qKlxuICogQSBzb2NrZXQuaW8gRGVjb2RlciBpbnN0YW5jZVxuICpcbiAqIEByZXR1cm4ge09iamVjdH0gZGVjb2RlclxuICovXG5leHBvcnQgY2xhc3MgRGVjb2RlciBleHRlbmRzIEVtaXR0ZXIge1xuICAgIC8qKlxuICAgICAqIERlY29kZXIgY29uc3RydWN0b3JcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IHJldml2ZXIgLSBjdXN0b20gcmV2aXZlciB0byBwYXNzIGRvd24gdG8gSlNPTi5zdHJpbmdpZnlcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihyZXZpdmVyKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMucmV2aXZlciA9IHJldml2ZXI7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERlY29kZXMgYW4gZW5jb2RlZCBwYWNrZXQgc3RyaW5nIGludG8gcGFja2V0IEpTT04uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gb2JqIC0gZW5jb2RlZCBwYWNrZXRcbiAgICAgKi9cbiAgICBhZGQob2JqKSB7XG4gICAgICAgIGxldCBwYWNrZXQ7XG4gICAgICAgIGlmICh0eXBlb2Ygb2JqID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5yZWNvbnN0cnVjdG9yKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiZ290IHBsYWludGV4dCBkYXRhIHdoZW4gcmVjb25zdHJ1Y3RpbmcgYSBwYWNrZXRcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwYWNrZXQgPSB0aGlzLmRlY29kZVN0cmluZyhvYmopO1xuICAgICAgICAgICAgY29uc3QgaXNCaW5hcnlFdmVudCA9IHBhY2tldC50eXBlID09PSBQYWNrZXRUeXBlLkJJTkFSWV9FVkVOVDtcbiAgICAgICAgICAgIGlmIChpc0JpbmFyeUV2ZW50IHx8IHBhY2tldC50eXBlID09PSBQYWNrZXRUeXBlLkJJTkFSWV9BQ0spIHtcbiAgICAgICAgICAgICAgICBwYWNrZXQudHlwZSA9IGlzQmluYXJ5RXZlbnQgPyBQYWNrZXRUeXBlLkVWRU5UIDogUGFja2V0VHlwZS5BQ0s7XG4gICAgICAgICAgICAgICAgLy8gYmluYXJ5IHBhY2tldCdzIGpzb25cbiAgICAgICAgICAgICAgICB0aGlzLnJlY29uc3RydWN0b3IgPSBuZXcgQmluYXJ5UmVjb25zdHJ1Y3RvcihwYWNrZXQpO1xuICAgICAgICAgICAgICAgIC8vIG5vIGF0dGFjaG1lbnRzLCBsYWJlbGVkIGJpbmFyeSBidXQgbm8gYmluYXJ5IGRhdGEgdG8gZm9sbG93XG4gICAgICAgICAgICAgICAgaWYgKHBhY2tldC5hdHRhY2htZW50cyA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBzdXBlci5lbWl0UmVzZXJ2ZWQoXCJkZWNvZGVkXCIsIHBhY2tldCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gbm9uLWJpbmFyeSBmdWxsIHBhY2tldFxuICAgICAgICAgICAgICAgIHN1cGVyLmVtaXRSZXNlcnZlZChcImRlY29kZWRcIiwgcGFja2V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChpc0JpbmFyeShvYmopIHx8IG9iai5iYXNlNjQpIHtcbiAgICAgICAgICAgIC8vIHJhdyBiaW5hcnkgZGF0YVxuICAgICAgICAgICAgaWYgKCF0aGlzLnJlY29uc3RydWN0b3IpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJnb3QgYmluYXJ5IGRhdGEgd2hlbiBub3QgcmVjb25zdHJ1Y3RpbmcgYSBwYWNrZXRcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBwYWNrZXQgPSB0aGlzLnJlY29uc3RydWN0b3IudGFrZUJpbmFyeURhdGEob2JqKTtcbiAgICAgICAgICAgICAgICBpZiAocGFja2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHJlY2VpdmVkIGZpbmFsIGJ1ZmZlclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlY29uc3RydWN0b3IgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICBzdXBlci5lbWl0UmVzZXJ2ZWQoXCJkZWNvZGVkXCIsIHBhY2tldCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVW5rbm93biB0eXBlOiBcIiArIG9iaik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogRGVjb2RlIGEgcGFja2V0IFN0cmluZyAoSlNPTiBkYXRhKVxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHN0clxuICAgICAqIEByZXR1cm4ge09iamVjdH0gcGFja2V0XG4gICAgICovXG4gICAgZGVjb2RlU3RyaW5nKHN0cikge1xuICAgICAgICBsZXQgaSA9IDA7XG4gICAgICAgIC8vIGxvb2sgdXAgdHlwZVxuICAgICAgICBjb25zdCBwID0ge1xuICAgICAgICAgICAgdHlwZTogTnVtYmVyKHN0ci5jaGFyQXQoMCkpLFxuICAgICAgICB9O1xuICAgICAgICBpZiAoUGFja2V0VHlwZVtwLnR5cGVdID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInVua25vd24gcGFja2V0IHR5cGUgXCIgKyBwLnR5cGUpO1xuICAgICAgICB9XG4gICAgICAgIC8vIGxvb2sgdXAgYXR0YWNobWVudHMgaWYgdHlwZSBiaW5hcnlcbiAgICAgICAgaWYgKHAudHlwZSA9PT0gUGFja2V0VHlwZS5CSU5BUllfRVZFTlQgfHxcbiAgICAgICAgICAgIHAudHlwZSA9PT0gUGFja2V0VHlwZS5CSU5BUllfQUNLKSB7XG4gICAgICAgICAgICBjb25zdCBzdGFydCA9IGkgKyAxO1xuICAgICAgICAgICAgd2hpbGUgKHN0ci5jaGFyQXQoKytpKSAhPT0gXCItXCIgJiYgaSAhPSBzdHIubGVuZ3RoKSB7IH1cbiAgICAgICAgICAgIGNvbnN0IGJ1ZiA9IHN0ci5zdWJzdHJpbmcoc3RhcnQsIGkpO1xuICAgICAgICAgICAgaWYgKGJ1ZiAhPSBOdW1iZXIoYnVmKSB8fCBzdHIuY2hhckF0KGkpICE9PSBcIi1cIikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIklsbGVnYWwgYXR0YWNobWVudHNcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwLmF0dGFjaG1lbnRzID0gTnVtYmVyKGJ1Zik7XG4gICAgICAgIH1cbiAgICAgICAgLy8gbG9vayB1cCBuYW1lc3BhY2UgKGlmIGFueSlcbiAgICAgICAgaWYgKFwiL1wiID09PSBzdHIuY2hhckF0KGkgKyAxKSkge1xuICAgICAgICAgICAgY29uc3Qgc3RhcnQgPSBpICsgMTtcbiAgICAgICAgICAgIHdoaWxlICgrK2kpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjID0gc3RyLmNoYXJBdChpKTtcbiAgICAgICAgICAgICAgICBpZiAoXCIsXCIgPT09IGMpXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGlmIChpID09PSBzdHIubGVuZ3RoKVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHAubnNwID0gc3RyLnN1YnN0cmluZyhzdGFydCwgaSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBwLm5zcCA9IFwiL1wiO1xuICAgICAgICB9XG4gICAgICAgIC8vIGxvb2sgdXAgaWRcbiAgICAgICAgY29uc3QgbmV4dCA9IHN0ci5jaGFyQXQoaSArIDEpO1xuICAgICAgICBpZiAoXCJcIiAhPT0gbmV4dCAmJiBOdW1iZXIobmV4dCkgPT0gbmV4dCkge1xuICAgICAgICAgICAgY29uc3Qgc3RhcnQgPSBpICsgMTtcbiAgICAgICAgICAgIHdoaWxlICgrK2kpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjID0gc3RyLmNoYXJBdChpKTtcbiAgICAgICAgICAgICAgICBpZiAobnVsbCA9PSBjIHx8IE51bWJlcihjKSAhPSBjKSB7XG4gICAgICAgICAgICAgICAgICAgIC0taTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChpID09PSBzdHIubGVuZ3RoKVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHAuaWQgPSBOdW1iZXIoc3RyLnN1YnN0cmluZyhzdGFydCwgaSArIDEpKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBsb29rIHVwIGpzb24gZGF0YVxuICAgICAgICBpZiAoc3RyLmNoYXJBdCgrK2kpKSB7XG4gICAgICAgICAgICBjb25zdCBwYXlsb2FkID0gdGhpcy50cnlQYXJzZShzdHIuc3Vic3RyKGkpKTtcbiAgICAgICAgICAgIGlmIChEZWNvZGVyLmlzUGF5bG9hZFZhbGlkKHAudHlwZSwgcGF5bG9hZCkpIHtcbiAgICAgICAgICAgICAgICBwLmRhdGEgPSBwYXlsb2FkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiaW52YWxpZCBwYXlsb2FkXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwO1xuICAgIH1cbiAgICB0cnlQYXJzZShzdHIpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKHN0ciwgdGhpcy5yZXZpdmVyKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBpc1BheWxvYWRWYWxpZCh0eXBlLCBwYXlsb2FkKSB7XG4gICAgICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICAgICAgY2FzZSBQYWNrZXRUeXBlLkNPTk5FQ1Q6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGlzT2JqZWN0KHBheWxvYWQpO1xuICAgICAgICAgICAgY2FzZSBQYWNrZXRUeXBlLkRJU0NPTk5FQ1Q6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBheWxvYWQgPT09IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIGNhc2UgUGFja2V0VHlwZS5DT05ORUNUX0VSUk9SOlxuICAgICAgICAgICAgICAgIHJldHVybiB0eXBlb2YgcGF5bG9hZCA9PT0gXCJzdHJpbmdcIiB8fCBpc09iamVjdChwYXlsb2FkKTtcbiAgICAgICAgICAgIGNhc2UgUGFja2V0VHlwZS5FVkVOVDpcbiAgICAgICAgICAgIGNhc2UgUGFja2V0VHlwZS5CSU5BUllfRVZFTlQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIChBcnJheS5pc0FycmF5KHBheWxvYWQpICYmXG4gICAgICAgICAgICAgICAgICAgICh0eXBlb2YgcGF5bG9hZFswXSA9PT0gXCJudW1iZXJcIiB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgKHR5cGVvZiBwYXlsb2FkWzBdID09PSBcInN0cmluZ1wiICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVTRVJWRURfRVZFTlRTLmluZGV4T2YocGF5bG9hZFswXSkgPT09IC0xKSkpO1xuICAgICAgICAgICAgY2FzZSBQYWNrZXRUeXBlLkFDSzpcbiAgICAgICAgICAgIGNhc2UgUGFja2V0VHlwZS5CSU5BUllfQUNLOlxuICAgICAgICAgICAgICAgIHJldHVybiBBcnJheS5pc0FycmF5KHBheWxvYWQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERlYWxsb2NhdGVzIGEgcGFyc2VyJ3MgcmVzb3VyY2VzXG4gICAgICovXG4gICAgZGVzdHJveSgpIHtcbiAgICAgICAgaWYgKHRoaXMucmVjb25zdHJ1Y3Rvcikge1xuICAgICAgICAgICAgdGhpcy5yZWNvbnN0cnVjdG9yLmZpbmlzaGVkUmVjb25zdHJ1Y3Rpb24oKTtcbiAgICAgICAgICAgIHRoaXMucmVjb25zdHJ1Y3RvciA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG59XG4vKipcbiAqIEEgbWFuYWdlciBvZiBhIGJpbmFyeSBldmVudCdzICdidWZmZXIgc2VxdWVuY2UnLiBTaG91bGRcbiAqIGJlIGNvbnN0cnVjdGVkIHdoZW5ldmVyIGEgcGFja2V0IG9mIHR5cGUgQklOQVJZX0VWRU5UIGlzXG4gKiBkZWNvZGVkLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBwYWNrZXRcbiAqIEByZXR1cm4ge0JpbmFyeVJlY29uc3RydWN0b3J9IGluaXRpYWxpemVkIHJlY29uc3RydWN0b3JcbiAqL1xuY2xhc3MgQmluYXJ5UmVjb25zdHJ1Y3RvciB7XG4gICAgY29uc3RydWN0b3IocGFja2V0KSB7XG4gICAgICAgIHRoaXMucGFja2V0ID0gcGFja2V0O1xuICAgICAgICB0aGlzLmJ1ZmZlcnMgPSBbXTtcbiAgICAgICAgdGhpcy5yZWNvblBhY2sgPSBwYWNrZXQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE1ldGhvZCB0byBiZSBjYWxsZWQgd2hlbiBiaW5hcnkgZGF0YSByZWNlaXZlZCBmcm9tIGNvbm5lY3Rpb25cbiAgICAgKiBhZnRlciBhIEJJTkFSWV9FVkVOVCBwYWNrZXQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0J1ZmZlciB8IEFycmF5QnVmZmVyfSBiaW5EYXRhIC0gdGhlIHJhdyBiaW5hcnkgZGF0YSByZWNlaXZlZFxuICAgICAqIEByZXR1cm4ge251bGwgfCBPYmplY3R9IHJldHVybnMgbnVsbCBpZiBtb3JlIGJpbmFyeSBkYXRhIGlzIGV4cGVjdGVkIG9yXG4gICAgICogICBhIHJlY29uc3RydWN0ZWQgcGFja2V0IG9iamVjdCBpZiBhbGwgYnVmZmVycyBoYXZlIGJlZW4gcmVjZWl2ZWQuXG4gICAgICovXG4gICAgdGFrZUJpbmFyeURhdGEoYmluRGF0YSkge1xuICAgICAgICB0aGlzLmJ1ZmZlcnMucHVzaChiaW5EYXRhKTtcbiAgICAgICAgaWYgKHRoaXMuYnVmZmVycy5sZW5ndGggPT09IHRoaXMucmVjb25QYWNrLmF0dGFjaG1lbnRzKSB7XG4gICAgICAgICAgICAvLyBkb25lIHdpdGggYnVmZmVyIGxpc3RcbiAgICAgICAgICAgIGNvbnN0IHBhY2tldCA9IHJlY29uc3RydWN0UGFja2V0KHRoaXMucmVjb25QYWNrLCB0aGlzLmJ1ZmZlcnMpO1xuICAgICAgICAgICAgdGhpcy5maW5pc2hlZFJlY29uc3RydWN0aW9uKCk7XG4gICAgICAgICAgICByZXR1cm4gcGFja2V0O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDbGVhbnMgdXAgYmluYXJ5IHBhY2tldCByZWNvbnN0cnVjdGlvbiB2YXJpYWJsZXMuXG4gICAgICovXG4gICAgZmluaXNoZWRSZWNvbnN0cnVjdGlvbigpIHtcbiAgICAgICAgdGhpcy5yZWNvblBhY2sgPSBudWxsO1xuICAgICAgICB0aGlzLmJ1ZmZlcnMgPSBbXTtcbiAgICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/index.js\n')},"./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/is-binary.js":
/*!********************************************************************************************************!*\
  !*** ./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/is-binary.js ***!
  \********************************************************************************************************/(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   hasBinary: () => (/* binding */ hasBinary),\n/* harmony export */   isBinary: () => (/* binding */ isBinary)\n/* harmony export */ });\nconst withNativeArrayBuffer = typeof ArrayBuffer === "function";\nconst isView = (obj) => {\n    return typeof ArrayBuffer.isView === "function"\n        ? ArrayBuffer.isView(obj)\n        : obj.buffer instanceof ArrayBuffer;\n};\nconst toString = Object.prototype.toString;\nconst withNativeBlob = typeof Blob === "function" ||\n    (typeof Blob !== "undefined" &&\n        toString.call(Blob) === "[object BlobConstructor]");\nconst withNativeFile = typeof File === "function" ||\n    (typeof File !== "undefined" &&\n        toString.call(File) === "[object FileConstructor]");\n/**\n * Returns true if obj is a Buffer, an ArrayBuffer, a Blob or a File.\n *\n * @private\n */\nfunction isBinary(obj) {\n    return ((withNativeArrayBuffer && (obj instanceof ArrayBuffer || isView(obj))) ||\n        (withNativeBlob && obj instanceof Blob) ||\n        (withNativeFile && obj instanceof File));\n}\nfunction hasBinary(obj, toJSON) {\n    if (!obj || typeof obj !== "object") {\n        return false;\n    }\n    if (Array.isArray(obj)) {\n        for (let i = 0, l = obj.length; i < l; i++) {\n            if (hasBinary(obj[i])) {\n                return true;\n            }\n        }\n        return false;\n    }\n    if (isBinary(obj)) {\n        return true;\n    }\n    if (obj.toJSON &&\n        typeof obj.toJSON === "function" &&\n        arguments.length === 1) {\n        return hasBinary(obj.toJSON(), true);\n    }\n    for (const key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key) && hasBinary(obj[key])) {\n            return true;\n        }\n    }\n    return false;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLXBhcnNlckA0LjIuNC9ub2RlX21vZHVsZXMvc29ja2V0LmlvLXBhcnNlci9idWlsZC9lc20vaXMtYmluYXJ5LmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0MsT0FBTztBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9ub2RlX21vZHVsZXMvLnBucG0vc29ja2V0LmlvLXBhcnNlckA0LjIuNC9ub2RlX21vZHVsZXMvc29ja2V0LmlvLXBhcnNlci9idWlsZC9lc20vaXMtYmluYXJ5LmpzPzI0OWIiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgd2l0aE5hdGl2ZUFycmF5QnVmZmVyID0gdHlwZW9mIEFycmF5QnVmZmVyID09PSBcImZ1bmN0aW9uXCI7XG5jb25zdCBpc1ZpZXcgPSAob2JqKSA9PiB7XG4gICAgcmV0dXJuIHR5cGVvZiBBcnJheUJ1ZmZlci5pc1ZpZXcgPT09IFwiZnVuY3Rpb25cIlxuICAgICAgICA/IEFycmF5QnVmZmVyLmlzVmlldyhvYmopXG4gICAgICAgIDogb2JqLmJ1ZmZlciBpbnN0YW5jZW9mIEFycmF5QnVmZmVyO1xufTtcbmNvbnN0IHRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztcbmNvbnN0IHdpdGhOYXRpdmVCbG9iID0gdHlwZW9mIEJsb2IgPT09IFwiZnVuY3Rpb25cIiB8fFxuICAgICh0eXBlb2YgQmxvYiAhPT0gXCJ1bmRlZmluZWRcIiAmJlxuICAgICAgICB0b1N0cmluZy5jYWxsKEJsb2IpID09PSBcIltvYmplY3QgQmxvYkNvbnN0cnVjdG9yXVwiKTtcbmNvbnN0IHdpdGhOYXRpdmVGaWxlID0gdHlwZW9mIEZpbGUgPT09IFwiZnVuY3Rpb25cIiB8fFxuICAgICh0eXBlb2YgRmlsZSAhPT0gXCJ1bmRlZmluZWRcIiAmJlxuICAgICAgICB0b1N0cmluZy5jYWxsKEZpbGUpID09PSBcIltvYmplY3QgRmlsZUNvbnN0cnVjdG9yXVwiKTtcbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIG9iaiBpcyBhIEJ1ZmZlciwgYW4gQXJyYXlCdWZmZXIsIGEgQmxvYiBvciBhIEZpbGUuXG4gKlxuICogQHByaXZhdGVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzQmluYXJ5KG9iaikge1xuICAgIHJldHVybiAoKHdpdGhOYXRpdmVBcnJheUJ1ZmZlciAmJiAob2JqIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIgfHwgaXNWaWV3KG9iaikpKSB8fFxuICAgICAgICAod2l0aE5hdGl2ZUJsb2IgJiYgb2JqIGluc3RhbmNlb2YgQmxvYikgfHxcbiAgICAgICAgKHdpdGhOYXRpdmVGaWxlICYmIG9iaiBpbnN0YW5jZW9mIEZpbGUpKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBoYXNCaW5hcnkob2JqLCB0b0pTT04pIHtcbiAgICBpZiAoIW9iaiB8fCB0eXBlb2Ygb2JqICE9PSBcIm9iamVjdFwiKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKEFycmF5LmlzQXJyYXkob2JqKSkge1xuICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IG9iai5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChoYXNCaW5hcnkob2JqW2ldKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKGlzQmluYXJ5KG9iaikpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGlmIChvYmoudG9KU09OICYmXG4gICAgICAgIHR5cGVvZiBvYmoudG9KU09OID09PSBcImZ1bmN0aW9uXCIgJiZcbiAgICAgICAgYXJndW1lbnRzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICByZXR1cm4gaGFzQmluYXJ5KG9iai50b0pTT04oKSwgdHJ1ZSk7XG4gICAgfVxuICAgIGZvciAoY29uc3Qga2V5IGluIG9iaikge1xuICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSAmJiBoYXNCaW5hcnkob2JqW2tleV0pKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/.pnpm/socket.io-parser@4.2.4/node_modules/socket.io-parser/build/esm/is-binary.js\n')},"./src/compatibility.ts":
/*!******************************!*\
  !*** ./src/compatibility.ts ***!
  \******************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   reloadEditor: () => (/* binding */ reloadEditor),\n/* harmony export */   reloadEditorDebounced: () => (/* binding */ reloadEditorDebounced)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/scripts/world-info */ \"@sillytavern/scripts/world-info\");\n\n/**\n * Reloads the editor with the specified world info file\n * @param file The file to load in the editor\n * @param loadIfNotSelected Indicates whether to load the file even if it's not currently selected\n */\nfunction reloadEditor(file, load_if_not_selected = false) {\n    const current_index = Number($('#world_editor_select').val());\n    const selected_index = _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_0__.world_names.indexOf(file);\n    if (selected_index !== -1 && (load_if_not_selected || current_index === selected_index)) {\n        $('#world_editor_select').val(selected_index).trigger('change');\n    }\n}\nconst reloadEditorDebounced = _.debounce(reloadEditor, 1000);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcGF0aWJpbGl0eS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBOEQ7QUFFOUQ7Ozs7R0FJRztBQUNJLFNBQVMsWUFBWSxDQUFDLElBQVksRUFBRSx1QkFBZ0MsS0FBSztJQUM5RSxNQUFNLGFBQWEsR0FBRyxNQUFNLENBQUMsQ0FBQyxDQUFDLHNCQUFzQixDQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUM5RCxNQUFNLGNBQWMsR0FBRyx3RUFBVyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUNqRCxJQUFJLGNBQWMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLG9CQUFvQixJQUFJLGFBQWEsS0FBSyxjQUFjLENBQUMsRUFBRSxDQUFDO1FBQ3hGLENBQUMsQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxjQUFjLENBQUMsQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUM7SUFDbEUsQ0FBQztBQUNILENBQUM7QUFFTSxNQUFNLHFCQUFxQixHQUFHLENBQUMsQ0FBQyxRQUFRLENBQUMsWUFBWSxFQUFFLElBQUksQ0FBQyxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBhdGliaWxpdHkudHM/ODUwYyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB3b3JsZF9uYW1lcyB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3dvcmxkLWluZm8nO1xuXG4vKipcbiAqIFJlbG9hZHMgdGhlIGVkaXRvciB3aXRoIHRoZSBzcGVjaWZpZWQgd29ybGQgaW5mbyBmaWxlXG4gKiBAcGFyYW0gZmlsZSBUaGUgZmlsZSB0byBsb2FkIGluIHRoZSBlZGl0b3JcbiAqIEBwYXJhbSBsb2FkSWZOb3RTZWxlY3RlZCBJbmRpY2F0ZXMgd2hldGhlciB0byBsb2FkIHRoZSBmaWxlIGV2ZW4gaWYgaXQncyBub3QgY3VycmVudGx5IHNlbGVjdGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZWxvYWRFZGl0b3IoZmlsZTogc3RyaW5nLCBsb2FkX2lmX25vdF9zZWxlY3RlZDogYm9vbGVhbiA9IGZhbHNlKSB7XG4gIGNvbnN0IGN1cnJlbnRfaW5kZXggPSBOdW1iZXIoJCgnI3dvcmxkX2VkaXRvcl9zZWxlY3QnKS52YWwoKSk7XG4gIGNvbnN0IHNlbGVjdGVkX2luZGV4ID0gd29ybGRfbmFtZXMuaW5kZXhPZihmaWxlKTtcbiAgaWYgKHNlbGVjdGVkX2luZGV4ICE9PSAtMSAmJiAobG9hZF9pZl9ub3Rfc2VsZWN0ZWQgfHwgY3VycmVudF9pbmRleCA9PT0gc2VsZWN0ZWRfaW5kZXgpKSB7XG4gICAgJCgnI3dvcmxkX2VkaXRvcl9zZWxlY3QnKS52YWwoc2VsZWN0ZWRfaW5kZXgpLnRyaWdnZXIoJ2NoYW5nZScpO1xuICB9XG59XG5cbmV4cG9ydCBjb25zdCByZWxvYWRFZGl0b3JEZWJvdW5jZWQgPSBfLmRlYm91bmNlKHJlbG9hZEVkaXRvciwgMTAwMCk7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/compatibility.ts\n")},"./src/component/audio/index.ts":
/*!**************************************!*\
  !*** ./src/component/audio/index.ts ***!
  \**************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   defaultAudioSettings: () => (/* binding */ defaultAudioSettings),\n/* harmony export */   getAudioUrl: () => (/* binding */ getAudioUrl),\n/* harmony export */   getAudioUrlWithCacheBusting: () => (/* binding */ getAudioUrlWithCacheBusting),\n/* harmony export */   getNextFileByMode: () => (/* binding */ getNextFileByMode),\n/* harmony export */   initAudioComponents: () => (/* binding */ initAudioComponents),\n/* harmony export */   initAudioEventListeners: () => (/* binding */ initAudioEventListeners),\n/* harmony export */   initializeProgressBar: () => (/* binding */ initializeProgressBar),\n/* harmony export */   list_BGMS: () => (/* binding */ list_BGMS),\n/* harmony export */   list_ambients: () => (/* binding */ list_ambients),\n/* harmony export */   onAudioEnabledClick: () => (/* binding */ onAudioEnabledClick),\n/* harmony export */   playAudio: () => (/* binding */ playAudio),\n/* harmony export */   refreshAudioResources: () => (/* binding */ refreshAudioResources),\n/* harmony export */   toggleAudioControls: () => (/* binding */ toggleAudioControls),\n/* harmony export */   togglePlayPause: () => (/* binding */ togglePlayPause),\n/* harmony export */   updateAudio: () => (/* binding */ updateAudio),\n/* harmony export */   updateAudioSelect: () => (/* binding */ updateAudioSelect)\n/* harmony export */ });\n/* harmony import */ var _util_collapsible__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/util/collapsible */ \"./src/util/collapsible.ts\");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sillytavern/scripts/popup */ \"@sillytavern/scripts/popup\");\n/* harmony import */ var _sillytavern_scripts_RossAscends_mods__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @sillytavern/scripts/RossAscends-mods */ \"@sillytavern/scripts/RossAscends-mods\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_7__);\n\n\n\n\n\n\n\n\nlet isExtensionEnabled;\nlet isAudioEnabled;\nlet list_BGMS = [];\nlet list_ambients = [];\nlet bgmEnded = true;\nlet ambientEnded = true;\nconst templatePath = `${_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.extensionFolderPath}/src/component/audio`;\n// 定义默认音频设置\nconst defaultAudioSettings = {\n    audio_enabled: true,\n    bgm_enabled: true,\n    ambient_enabled: true,\n    bgm_mode: 'repeat',\n    bgm_muted: false,\n    bgm_volume: 50,\n    bgm_selected: null,\n    bgm_current_time: 0,\n    ambient_mode: 'stop',\n    ambient_muted: false,\n    ambient_volume: 50,\n    ambient_selected: null,\n    ambient_current_time: 0,\n    audio_cooldown: 0,\n};\n/**\n * 更新音频\n * @param type 音频类型 \"bgm\" 或 \"ambient\"\n * @param isUserInput 是否由用户操作触发-将导致音频中断\n */\nasync function updateAudio(type = 'bgm', isUserInput = false) {\n    if (!(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.audio_enabled')) {\n        return;\n    }\n    const isTypeEnabled = type === 'bgm' ? (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.bgm_enabled') : (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.ambient_enabled');\n    if (!isTypeEnabled) {\n        return;\n    }\n    const audioEnded = type === 'bgm' ? bgmEnded : ambientEnded;\n    const audioSelector = `#audio_${type}`;\n    if (!isUserInput && $(audioSelector).attr('src') != '' && !audioEnded) {\n        return;\n    }\n    let audio_url = '';\n    const playlist = await getAudioUrl(type);\n    if (isUserInput) {\n        audio_url =\n            type === 'bgm'\n                ? (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.bgm_selected') || playlist[0]\n                : (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.ambient_selected') || playlist[0];\n    }\n    else {\n        const mode = type === 'bgm' ? (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.bgm_mode') : (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.ambient_mode');\n        const selected = type === 'bgm' ? (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.bgm_selected') : (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.ambient_selected');\n        audio_url = getNextFileByMode(mode, playlist, selected);\n    }\n    if (!audio_url) {\n        return;\n    }\n    const audio = $(audioSelector)[0];\n    // 对于ambient类型，处理掉防缓存后缀\n    if (type === 'ambient') {\n        const cleanAudioSrc = audio.src.split('?')[0];\n        const cleanAudioUrl = audio_url.split('?')[0];\n        if (decodeURIComponent(cleanAudioSrc) === decodeURIComponent(cleanAudioUrl) && !audioEnded) {\n            return;\n        }\n    }\n    else if (decodeURIComponent(audio.src) === decodeURIComponent(audio_url) && !audioEnded) {\n        return;\n    }\n    // 设置audioEnded状态\n    if (type === 'bgm') {\n        bgmEnded = false;\n    }\n    else {\n        ambientEnded = false;\n    }\n    if (type === 'bgm') {\n        audio.src = audio_url;\n        audio.load();\n        await new Promise(resolve => {\n            const canPlayHandler = () => {\n                audio.removeEventListener('canplaythrough', canPlayHandler);\n                resolve();\n            };\n            if (audio.readyState >= HTMLMediaElement.HAVE_ENOUGH_DATA) {\n                resolve();\n            }\n            else {\n                audio.addEventListener('canplaythrough', canPlayHandler);\n            }\n        });\n        await playAudio(type);\n    }\n    else {\n        // 对于ambient类型，使用缓存破坏\n        const audioUrlWithCacheBusting = getAudioUrlWithCacheBusting(audio_url);\n        audio.src = audioUrlWithCacheBusting;\n        audio.load();\n        await new Promise(resolve => {\n            const canPlayHandler = () => {\n                audio.removeEventListener('canplaythrough', canPlayHandler);\n                resolve();\n            };\n            if (audio.readyState >= HTMLMediaElement.HAVE_ENOUGH_DATA) {\n                resolve();\n            }\n            else {\n                audio.addEventListener('canplaythrough', canPlayHandler);\n            }\n        });\n        await playAudio(type);\n    }\n    // 更新选中的音频\n    if (type === 'bgm') {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.bgm_selected', audio_url);\n    }\n    else {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.ambient_selected', audio_url);\n    }\n    // 更新选择器\n    const selectElement = $(`#audio_${type}_select`);\n    if (selectElement.val() !== audio_url) {\n        selectElement.val(audio_url);\n    }\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.saveSettingsDebounced)();\n}\n/**\n * 更新音频下拉选择菜单\n * @param type 音频类型 \"bgm\" 或 \"ambient\"\n */\nasync function updateAudioSelect(type = 'bgm') {\n    if (!(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)(`audio.${type}_enabled`)) {\n        return;\n    }\n    const selectElement = $(`#audio_${type}_select`);\n    selectElement.empty();\n    if (type === 'bgm') {\n        list_BGMS = await getAudioUrl('bgm');\n    }\n    else {\n        list_ambients = await getAudioUrl('ambient');\n    }\n    const audioList = type === 'bgm' ? list_BGMS : list_ambients;\n    let selectedSetting = type === 'bgm' ? (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.bgm_selected') : (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.ambient_selected');\n    if (audioList && audioList.length > 0) {\n        // 检查当前选择的音频是否在列表中，如果不在则选择第一个\n        if (!audioList.includes(selectedSetting)) {\n            loglevel__WEBPACK_IMPORTED_MODULE_7___default().warn(`[Audio] 当前选择的音频 ${selectedSetting} 不在列表中，自动选择列表第一个音频`);\n            selectedSetting = audioList[0];\n            if (type === 'bgm') {\n                (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.bgm_selected', selectedSetting);\n            }\n            else {\n                (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.ambient_selected', selectedSetting);\n            }\n            (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.saveSettingsDebounced)();\n        }\n        const audioFiles = Array.isArray(audioList) ? audioList : audioList.split(',').map(file => file.trim());\n        audioFiles.forEach((file) => {\n            const fileLabel = file.replace(/^.*[\\\\\\/]/, '').replace(/\\.[^/.]+$/, '');\n            selectElement.append(new Option(fileLabel, file));\n        });\n        selectElement.val(selectedSetting);\n    }\n    else {\n        loglevel__WEBPACK_IMPORTED_MODULE_7___default().warn(`[Audio] 暂无可用的 ${type.toUpperCase()} 资源`);\n    }\n}\n/**\n * 获取音频URL\n * @param type 音频类型 \"bgm\" 或 \"ambient\"\n * @returns 音频URL数组\n */\nasync function getAudioUrl(type = 'bgm') {\n    const typeKey = type === 'bgm' ? 'bgmurl' : 'ambienturl';\n    //@ts-ignore\n    const chatSpecificUrls = _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata.variables?.[typeKey] || [];\n    return chatSpecificUrls;\n}\n/**\n * 添加缓存参数防止缓存\n * @param originalUrl 原始URL\n */\nfunction getAudioUrlWithCacheBusting(originalUrl) {\n    if (!originalUrl)\n        return '';\n    const cacheBuster = new Date().getTime();\n    const separator = originalUrl.includes('?') ? '&' : '?';\n    return `${originalUrl}${separator}_=${cacheBuster}`;\n}\n/**\n * 根据播放模式获取下一个音频文件\n * @param mode 播放模式\n * @param playlist 播放列表\n * @param currentFile 当前文件\n */\nfunction getNextFileByMode(mode, playlist, currentFile) {\n    if (!playlist || playlist.length === 0) {\n        return '';\n    }\n    switch (mode) {\n        case 'repeat':\n            return playlist[0];\n        case 'single':\n            return currentFile || playlist[0];\n        case 'random': {\n            const filteredPlaylist = playlist.filter(file => file !== currentFile);\n            if (filteredPlaylist.length === 0) {\n                return playlist[0];\n            }\n            const randomIndex = Math.floor(Math.random() * filteredPlaylist.length);\n            return filteredPlaylist[randomIndex];\n        }\n        case 'stop':\n            return '';\n        default:\n            return playlist[0];\n    }\n}\n/**\n * 切换音频控件状态\n * @param type 音频类型 \"bgm\" 或 \"ambient\"\n * @param status 是否启用\n */\nfunction toggleAudioControls(type, status = 'enable') {\n    const isMainEnabled = $('#audio_enabled').prop('checked');\n    const shouldEnable = isMainEnabled && status === 'enable';\n    const controlIds = [\n        `#audio_${type}_play_pause`,\n        `#audio_${type}_mute`,\n        `#audio_${type}_mode`,\n        `#audio_${type}_select`,\n        `#audio_${type}_volume_slider`,\n    ];\n    controlIds.forEach(id => {\n        $(id).prop('disabled', !shouldEnable);\n    });\n}\n/**\n * 点击音频启用按钮时的通用处理函数\n * @param type 音频类型 \"bgm\" 或 \"ambient\"\n */\nasync function onAudioEnabledClick(type = 'bgm') {\n    const enabled = $(`#enable_${type}`).prop('checked');\n    (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)(`audio.${type}_enabled`, enabled);\n    if (enabled) {\n        toggleAudioControls(type, 'enable');\n        await updateAudio(type, false);\n    }\n    else {\n        $(`#audio_${type}`)[0].pause();\n        toggleAudioControls(type, 'disable');\n    }\n}\n/**\n * 初始化音频事件监听\n * @param type 音频类型 \"bgm\" 或 \"ambient\"\n */\nfunction initAudioEventListeners(type) {\n    $(`#audio_${type}`).on('ended', async function () {\n        if (type === 'bgm') {\n            bgmEnded = true;\n        }\n        else {\n            ambientEnded = true;\n        }\n        const mode = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)(`audio.${type}_mode`);\n        if (mode === 'stop') {\n            return;\n        }\n        await updateAudio(type, false);\n    });\n}\n/**\n * 初始化进度条\n * @param type 音频类型 \"bgm\" 或 \"ambient\"\n */\nfunction initializeProgressBar(type) {\n    const $audioElement = $(`#audio_${type}`);\n    const $progressSlider = $(`#audio_${type}_progress_slider`);\n    $audioElement.on('timeupdate', function () {\n        if (!isNaN(this.duration)) {\n            const progressPercent = (this.currentTime / this.duration) * 100;\n            $progressSlider.val(progressPercent);\n        }\n        const cooldownBGM = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.audio_cooldown');\n        const remainingTime = this.duration - this.currentTime;\n        if (cooldownBGM > 0 && remainingTime <= cooldownBGM && !this.isFadingOut) {\n            const initialVolume = this.volume;\n            const fadeStep = initialVolume / (cooldownBGM * 10);\n            this.isFadingOut = true;\n            const fadeOutInterval = setInterval(() => {\n                if (this.volume > 0) {\n                    this.volume = Math.max(0, this.volume - fadeStep);\n                }\n                else {\n                    clearInterval(fadeOutInterval);\n                    this.isFadingOut = false;\n                }\n            }, 100);\n        }\n    });\n    $audioElement.on('play', function () {\n        const cooldownBGM = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.audio_cooldown');\n        const targetVolume = $(`#audio_${type}_volume_slider`).val() / 100;\n        if (cooldownBGM <= 0) {\n            this.volume = targetVolume;\n            return;\n        }\n        this.volume = 0;\n        const fadeStep = targetVolume / (cooldownBGM * 10);\n        const fadeInInterval = setInterval(() => {\n            if (this.volume < targetVolume) {\n                this.volume = Math.min(targetVolume, this.volume + fadeStep);\n            }\n            else {\n                clearInterval(fadeInInterval);\n            }\n        }, 100);\n    });\n    $audioElement.on('loadedmetadata', function () {\n        if (!isNaN(this.duration)) {\n            $progressSlider.attr('max', 100);\n        }\n    });\n    $progressSlider.on('input', function () {\n        const value = $(this).val();\n        if (!isNaN($audioElement[0].duration)) {\n            $audioElement[0].currentTime = (value / 100) * $audioElement[0].duration;\n        }\n    });\n}\n/**\n * 音量滑块滚轮调节事件处理\n * @param e 事件对象\n */\nfunction onVolumeSliderWheelEvent(e) {\n    const slider = $(this);\n    e.preventDefault();\n    e.stopPropagation();\n    const delta = e.deltaY / 20;\n    const sliderVal = Number(slider.val());\n    let newVal = sliderVal - delta;\n    if (newVal < 0) {\n        newVal = 0;\n    }\n    else if (newVal > 100) {\n        newVal = 100;\n    }\n    slider.val(newVal).trigger('input');\n}\n/**\n * 长按音量控制按钮出现音量调节\n * @param volumeControlId 音量控制按钮ID\n * @param iconId 音量控制按钮图标ID\n */\nfunction handleLongPress(volumeControlId, iconId) {\n    const $volumeControl = $(`#${volumeControlId}`);\n    const $icon = $(`#${iconId}`);\n    let pressTimer;\n    if ((0,_sillytavern_scripts_RossAscends_mods__WEBPACK_IMPORTED_MODULE_5__.isMobile)()) {\n        $icon.on('touchstart', function (e) {\n            pressTimer = setTimeout(() => {\n                $volumeControl.css('display', 'block');\n            }, 500);\n        });\n        $icon.on('touchend', function (e) {\n            clearTimeout(pressTimer);\n        });\n        $(document).on('click', function (event) {\n            if (!$icon.is(event.target) &&\n                $icon.has(event.target).length === 0 &&\n                !$volumeControl.is(event.target) &&\n                $volumeControl.has(event.target).length === 0) {\n                $volumeControl.css('display', 'none');\n            }\n        });\n    }\n}\n/**\n * 刷新音频资源\n */\nasync function refreshAudioResources() {\n    updateAudioSelect('bgm');\n    updateAudioSelect('ambient');\n}\n/**\n * 打开音频资源管理弹窗\n * @param typeKey 音频类型 \"bgmurl\" 或 \"ambienturl\"\n */\nasync function openUrlManagerPopup(typeKey) {\n    const urlManager = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__.renderExtensionTemplateAsync)(`${templatePath}`, 'audio_url_manager'));\n    urlManager.prepend(`\n    <style>\n      #saved_audio_url.empty::after {\n        content: \"暂无音频\";\n        color: #999;\n        margin-top: 20px;\n        font-size: 12px;\n      }\n    </style>\n  `);\n    const savedAudioUrl = urlManager.find('#saved_audio_url').empty();\n    const urlTemplate = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__.renderExtensionTemplateAsync)(`${templatePath}`, 'audio_url_template'));\n    if (!_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata.variables) {\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata.variables = {};\n    }\n    let urlValue = _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata.variables[typeKey];\n    if (!urlValue) {\n        urlValue = [];\n        savedAudioUrl.addClass('empty');\n    }\n    else {\n        try {\n            if (urlValue.length === 0) {\n                savedAudioUrl.addClass('empty');\n            }\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_7___default().error(`[Audio] Failed to parse ${typeKey}:`, error);\n            return null;\n        }\n    }\n    const updatedUrls = {};\n    let newUrlOrder = [...urlValue];\n    function renderUrl(container, url) {\n        const urlHtml = urlTemplate.clone();\n        let fileName;\n        if (url.includes('/')) {\n            const parts = url.split('/');\n            fileName = parts[parts.length - 1] || parts[parts.length - 2];\n        }\n        else {\n            fileName = url;\n        }\n        const id = fileName.replace(/\\./g, '-');\n        urlHtml.attr('id', id);\n        urlHtml.find('.audio_url_name').text(fileName);\n        urlHtml.find('.audio_url_name').attr('data-url', url);\n        urlHtml.find('.edit_existing_url').on('click', async function () {\n            const currentUrl = urlHtml.find('.audio_url_name').attr('data-url');\n            if (!currentUrl) {\n                loglevel__WEBPACK_IMPORTED_MODULE_7___default().error('[Audio] No URL found for this element.');\n                return;\n            }\n            const inputUrl = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__.callGenericPopup)('', _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__.POPUP_TYPE.INPUT, currentUrl);\n            if (!inputUrl) {\n                return;\n            }\n            const newFileName = inputUrl.split('/').pop();\n            const newId = newFileName.replace(/\\./g, '-');\n            urlHtml.attr('id', newId);\n            urlHtml.find('.audio_url_name').text(newFileName);\n            urlHtml.find('.audio_url_name').attr('data-url', inputUrl);\n            updatedUrls[currentUrl] = inputUrl;\n        });\n        urlHtml.find('.delete_url').on('click', async function () {\n            const confirmDelete = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__.callGenericPopup)('确认要删除此链接?', _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__.POPUP_TYPE.CONFIRM);\n            if (!confirmDelete) {\n                return;\n            }\n            // 仅从DOM中移除元素\n            urlHtml.remove();\n            // 检查是否需要显示空状态提示\n            if (savedAudioUrl.find('.audio_url_name').length === 0) {\n                savedAudioUrl.addClass('empty');\n            }\n        });\n        container.append(urlHtml);\n    }\n    urlValue.forEach(url => {\n        renderUrl(savedAudioUrl, url);\n    });\n    urlManager.find('#import_button').on('click', async function () {\n        const newUrls = await openUrlImportPopup();\n        if (!newUrls) {\n            loglevel__WEBPACK_IMPORTED_MODULE_7___default().debug(`[Audio] ${typeKey} URL导入已取消`);\n            return;\n        }\n        savedAudioUrl.removeClass('empty');\n        newUrls.forEach(url => {\n            renderUrl(savedAudioUrl, url);\n        });\n    });\n    savedAudioUrl.sortable({\n        delay: (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_6__.getSortableDelay)(),\n        handle: '.drag-handle',\n        stop: function () {\n            newUrlOrder = [];\n            savedAudioUrl.find('.audio_url_name').each(function () {\n                const newUrl = $(this).attr('data-url');\n                if (newUrl) {\n                    newUrlOrder.push(newUrl);\n                }\n            });\n        },\n    });\n    const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__.callGenericPopup)(urlManager, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__.POPUP_TYPE.CONFIRM, '', {\n        okButton: `确认`,\n        cancelButton: `取消`,\n    });\n    if (!result) {\n        return;\n    }\n    else {\n        // 直接读取所有data-url属性，生成新的URL列表\n        const newUrlList = [];\n        savedAudioUrl.find('.audio_url_name').each(function () {\n            const url = $(this).attr('data-url');\n            if (url) {\n                newUrlList.push(url);\n            }\n        });\n        // 检查当前播放的音频是否在新的列表中\n        const currentBgmUrl = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.bgm_selected');\n        const currentAmbientUrl = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.ambient_selected');\n        // 如果当前播放的音频不在新的列表中，停止播放\n        if (typeKey === 'bgmurl' && currentBgmUrl && !newUrlList.includes(currentBgmUrl)) {\n            const bgmAudio = $('#audio_bgm')[0];\n            bgmAudio.pause();\n            bgmEnded = true;\n        }\n        else if (typeKey === 'ambienturl' && currentAmbientUrl && !newUrlList.includes(currentAmbientUrl)) {\n            const ambientAudio = $('#audio_ambient')[0];\n            ambientAudio.pause();\n            ambientEnded = true;\n        }\n        // 更新并保存新的URL列表\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata.variables[typeKey] = newUrlList;\n        (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__.saveMetadataDebounced)();\n        if (typeKey === 'bgmurl') {\n            updateAudioSelect('bgm');\n        }\n        else if (typeKey === 'ambienturl') {\n            updateAudioSelect('ambient');\n        }\n    }\n}\n/**\n * 点击音频总开关时的处理函数\n */\nasync function handleAudioToggle(enable = true, userInput = true) {\n    if (userInput) {\n        isAudioEnabled = enable;\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.audio_enabled', isAudioEnabled);\n    }\n    if (enable) {\n        $('#audio-player-content').removeClass('audio-disabled-mask');\n        if (isExtensionEnabled === undefined) {\n            isExtensionEnabled = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('enabled_extension');\n        }\n        if (!isExtensionEnabled) {\n            return;\n        }\n        toggleAudioControls('bgm', 'enable');\n        toggleAudioControls('ambient', 'enable');\n        const bgmUrl = await getAudioUrl('bgm');\n        const ambientUrl = await getAudioUrl('ambient');\n        if (bgmUrl.length > 0) {\n            const bgmAudioElement = $('#audio_bgm')[0];\n            try {\n                await bgmAudioElement.play();\n            }\n            catch (error) {\n                throw new Error('[Audio] 播放音乐失败：没有提供有效源');\n            }\n        }\n        if (ambientUrl.length > 0) {\n            const ambientAudioElement = $('#audio_ambient')[0];\n            try {\n                await ambientAudioElement.play();\n            }\n            catch (error) {\n                throw new Error('[Audio] 播放音效失败：没有提供有效源');\n            }\n        }\n    }\n    else {\n        $('#audio-player-content').addClass('audio-disabled-mask');\n        $('#audio_bgm')[0].pause();\n        $('#audio_ambient')[0].pause();\n        toggleAudioControls('bgm', 'disable');\n        toggleAudioControls('ambient', 'disable');\n    }\n}\n/**\n * 播放音频\n * @param type 音频类型 \"bgm\" 或 \"ambient\"\n */\nasync function playAudio(type) {\n    if (!(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('enabled_extension') ||\n        !(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.audio_enabled') ||\n        !(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)(`audio.${type}_enabled`)) {\n        return;\n    }\n    const audioElement = $(`#audio_${type}`)[0];\n    const playPauseIcon = $(`#audio_${type}_play_pause_icon`);\n    if (audioElement.error && audioElement.error.code === 4) {\n        loglevel__WEBPACK_IMPORTED_MODULE_7___default().warn(`The ${type} element has no supported sources. Trying to reload selected audio from dropdown...`);\n        const selectedAudio = $(`#audio_${type}_select`).val();\n        if (!selectedAudio) {\n            loglevel__WEBPACK_IMPORTED_MODULE_7___default().error(`No audio selected for ${type}`);\n            return;\n        }\n        audioElement.src = selectedAudio;\n        audioElement.load();\n    }\n    try {\n        await audioElement.play();\n        playPauseIcon.removeClass('fa-play');\n        playPauseIcon.addClass('fa-pause');\n    }\n    catch (error) {\n        loglevel__WEBPACK_IMPORTED_MODULE_7___default().error(`[Audio] 播放 ${type} 音频时出错:`, error);\n    }\n}\n/**\n * 点击各自音频模式按钮时的通用处理函数\n * @param type 音频类型 \"bgm\" 或 \"ambient\"\n */\nasync function onAudioModeClick(type) {\n    const modes = [\n        { mode: 'repeat', icon: 'fa-repeat' },\n        { mode: 'random', icon: 'fa-random' },\n        { mode: 'single', icon: 'fa-redo-alt' },\n        { mode: 'stop', icon: 'fa-cancel' },\n    ];\n    const currentModeIndex = modes.findIndex(m => m.mode === (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)(`audio.${type}_mode`));\n    const nextModeIndex = (currentModeIndex + 1) % modes.length;\n    (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)(`audio.${type}_mode`, modes[nextModeIndex].mode);\n    $(`#audio_${type}_mode_icon`).removeClass('fa-repeat fa-random fa-redo-alt fa-cancel');\n    $(`#audio_${type}_mode_icon`).addClass(modes[nextModeIndex].icon);\n}\n/**\n * 音频选择变化时的通用处理函数\n * @param type 音频类型 \"bgm\" 或 \"ambient\"\n */\nasync function onAudioSelectChange(type) {\n    (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)(`audio.${type}_selected`, $(`#audio_${type}_select`).val());\n    await updateAudio(type, true);\n}\n/**\n * 输入冷却时间的处理函数\n * @param type 音频类型 \"bgm\" 或 \"ambient\"\n */\nasync function onAudioCooldownInput() {\n    (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.audio_cooldown', ~~$(`#audio_cooldown`).val());\n}\n/**\n * 音频音量变化时的通用处理函数\n * @param type 音频类型 \"bgm\" 或 \"ambient\"\n */\nasync function onAudioVolumeChange(type) {\n    (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)(`audio.${type}_volume`, ~~$(`#audio_${type}_volume_slider`).val());\n    $(`#audio_${type}`).prop('volume', (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)(`audio.${type}_volume`) * 0.01);\n    $(`#audio_${type}_volume`).text((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)(`audio.${type}_volume`));\n}\n/**\n * 点击音频静音按钮时的通用处理函数\n * @param type 音频类型 \"bgm\" 或 \"ambient\"\n */\nasync function onAudioMuteClick(type) {\n    (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)(`audio.${type}_muted`, !(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)(`audio.${type}_muted`));\n    $(`#audio_${type}_mute_icon`).toggleClass('fa-volume-high');\n    $(`#audio_${type}_mute_icon`).toggleClass('fa-volume-mute');\n    $(`#audio_${type}`).prop('muted', !$(`#audio_${type}`).prop('muted'));\n    $(`#audio_${type}_mute`).toggleClass('redOverlayGlow');\n}\n/**\n * 切换播放/暂停状态\n * @param type 音频类型 \"bgm\" 或 \"ambient\"\n */\nasync function togglePlayPause(type) {\n    if (!(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.audio_enabled')) {\n        return;\n    }\n    const audioElement = $(`#audio_${type}`)[0];\n    const playPauseIcon = $(`#audio_${type}_play_pause_icon`);\n    if (audioElement.paused) {\n        await playAudio(type);\n    }\n    else {\n        audioElement.pause();\n        playPauseIcon.removeClass('fa-pause');\n        playPauseIcon.addClass('fa-play');\n    }\n}\n/**\n * 打开URL导入弹窗\n * @param type 音频类型\n */\nasync function openUrlImportPopup() {\n    const input = (await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__.callGenericPopup)('输入要导入的网络音频链接（每行一个）', _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_4__.POPUP_TYPE.INPUT, ''));\n    if (!input) {\n        loglevel__WEBPACK_IMPORTED_MODULE_7___default().debug('[Audio] URL import cancelled');\n        return null;\n    }\n    const urlArray = input\n        .trim()\n        .split('\\n')\n        .map((url) => url.trim())\n        .filter((url) => url !== '');\n    return Array.from(new Set(urlArray));\n}\n// 聊天更改时的事件处理\n_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.eventSource.on(_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.event_types.CHAT_CHANGED, async () => {\n    const $bgmPlayer = $('#audio_bgm')[0];\n    const $ambientPlayer = $('#audio_ambient')[0];\n    if ($bgmPlayer && !$bgmPlayer.paused) {\n        $bgmPlayer.pause();\n    }\n    if ($ambientPlayer && !$ambientPlayer.paused) {\n        $ambientPlayer.pause();\n    }\n    await refreshAudioResources();\n    loglevel__WEBPACK_IMPORTED_MODULE_7___default().info('[Audio] 聊天已更改，音频资源刷新完成');\n});\n/** 初始化样式\n * @param type 音频类型 \"bgm\" 或 \"ambient\"\n */\nfunction initAudioStyles(type) {\n    // 隐藏默认播放器样式\n    $(`#audio_${type}`).hide();\n    if ((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)(`audio.${type}_muted`)) {\n        $(`#audio_${type}_mute_icon`).removeClass('fa-volume-high');\n        $(`#audio_${type}_mute_icon`).addClass('fa-volume-mute');\n        $(`#audio_${type}_mute`).addClass('redOverlayGlow');\n        $(`#audio_${type}`).prop('muted', true);\n    }\n    else {\n        $(`#audio_${type}_mute_icon`).addClass('fa-volume-high');\n        $(`#audio_${type}_mute_icon`).removeClass('fa-volume-mute');\n        $(`#audio_${type}_mute`).removeClass('redOverlayGlow');\n        $(`#audio_${type}`).prop('muted', false);\n    }\n    $(`#enable_${type}`).prop('checked', (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)(`audio.${type}_enabled`));\n    const audioElement = $(`#audio_${type}`)[0];\n    const playPauseIcon = $(`#audio_${type}_play_pause_icon`);\n    if (audioElement && audioElement.paused) {\n        playPauseIcon.removeClass('fa-pause');\n        playPauseIcon.addClass('fa-play');\n    }\n    else if (audioElement && !audioElement.paused) {\n        playPauseIcon.removeClass('fa-play');\n        playPauseIcon.addClass('fa-pause');\n    }\n    updateAudioSelect(type);\n    initializeProgressBar(type);\n}\n/**\n * 初始化所有音频相关组件和事件监听器\n */\nasync function initAudioComponents() {\n    // 加载音频播放器样式\n    await (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_6__.loadFileToDocument)(`/scripts/extensions/${_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.extensionFolderPath}/src/component/audio/style.css`, 'css');\n    isAudioEnabled = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.audio_enabled');\n    handleAudioToggle(isAudioEnabled, false);\n    $('#audio-enable-toggle')\n        .prop('checked', isAudioEnabled)\n        .on('click', (event) => handleAudioToggle(event.target.checked, true));\n    // 初始化折叠控件\n    _util_collapsible__WEBPACK_IMPORTED_MODULE_0__.Collapsible.initAll('#audio-player-header', {\n        headerSelector: '#audio-player-header',\n        contentSelector: '#audio-player-content',\n        initiallyExpanded: true,\n        animationDuration: {\n            expand: 280,\n            collapse: 250,\n        },\n    });\n    // 初始化音乐和音效样式\n    initAudioStyles('bgm');\n    initAudioStyles('ambient');\n    const audioTypes = ['bgm', 'ambient'];\n    const bindTypeEvents = (type, events) => {\n        events.forEach(({ selector, event, handler }) => {\n            $(`#${selector}`).on(event, () => handler(type));\n        });\n    };\n    audioTypes.forEach(type => {\n        $(`#enable_${type}`).on('click', () => onAudioEnabledClick(type));\n        bindTypeEvents(type, [\n            {\n                selector: `enable_${type}`,\n                event: 'click',\n                handler: onAudioEnabledClick,\n            },\n            {\n                selector: `audio_${type}_mode`,\n                event: 'click',\n                handler: onAudioModeClick,\n            },\n            {\n                selector: `audio_${type}_mute`,\n                event: 'click',\n                handler: onAudioMuteClick,\n            },\n            {\n                selector: `audio_${type}_volume_slider`,\n                event: 'input',\n                handler: onAudioVolumeChange,\n            },\n            {\n                selector: `audio_${type}_select`,\n                event: 'change',\n                handler: onAudioSelectChange,\n            },\n            {\n                selector: `audio_${type}_play_pause`,\n                event: 'click',\n                handler: togglePlayPause,\n            },\n        ]);\n        $('#audio_cooldown').on('input', onAudioCooldownInput).val((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('audio.audio_cooldown'));\n        // 监听音频结束事件\n        initAudioEventListeners('bgm');\n        initAudioEventListeners('ambient');\n        const volumeSlider = $(`#audio_${type}_volume_slider`).get(0);\n        if (volumeSlider) {\n            volumeSlider.addEventListener('wheel', onVolumeSliderWheelEvent, {\n                passive: false,\n            });\n        }\n    });\n    $('#audio_refresh_assets').on('click', async () => {\n        await refreshAudioResources();\n    });\n    handleLongPress('bgm-volume-control', 'audio_bgm_mute_icon');\n    handleLongPress('ambient-volume-control', 'audio_ambient_mute_icon');\n    const urlManagerMap = {\n        bgm: 'bgmurl',\n        ambient: 'ambienturl',\n    };\n    audioTypes.forEach(type => {\n        $(`#${type}_manager_button`).on('click', async () => {\n            await openUrlManagerPopup(urlManagerMap[type]);\n            await refreshAudioResources();\n        });\n    });\n    const bgmAudio = $('#audio_bgm')[0];\n    const ambientAudio = $('#audio_ambient')[0];\n    const togglePlayPauseIcon = (audioElement, iconSelector) => {\n        const icon = $(iconSelector);\n        audioElement.addEventListener('play', () => icon.removeClass('fa-play').addClass('fa-pause'));\n        audioElement.addEventListener('pause', () => icon.removeClass('fa-pause').addClass('fa-play'));\n    };\n    togglePlayPauseIcon(bgmAudio, '#audio_bgm_play_pause_icon');\n    togglePlayPauseIcon(ambientAudio, '#audio_ambient_play_pause_icon');\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QztJQUVGLFVBQVUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUU7UUFDeEIsQ0FBQyxDQUFDLElBQUksSUFBSSxpQkFBaUIsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDbEQsTUFBTSxtQkFBbUIsQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUE0QixDQUFDLENBQUM7WUFDMUUsTUFBTSxxQkFBcUIsRUFBRSxDQUFDO1FBQ2hDLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxNQUFNLFFBQVEsR0FBRyxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFxQixDQUFDO0lBQ3hELE1BQU0sWUFBWSxHQUFHLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLENBQUMsQ0FBcUIsQ0FBQztJQUVoRSxNQUFNLG1CQUFtQixHQUFHLENBQUMsWUFBOEIsRUFBRSxZQUFvQixFQUFFLEVBQUU7UUFDbkYsTUFBTSxJQUFJLEdBQUcsQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDO1FBQzdCLFlBQVksQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLEVBQUUsR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUMsQ0FBQyxRQUFRLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQztRQUM5RixZQUFZLENBQUMsZ0JBQWdCLENBQUMsT0FBTyxFQUFFLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsVUFBVSxDQUFDLENBQUMsUUFBUSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUM7SUFDakcsQ0FBQyxDQUFDO0lBRUYsbUJBQW1CLENBQUMsUUFBUSxFQUFFLDRCQUE0QixDQUFDLENBQUM7SUFDNUQsbUJBQW1CLENBQUMsWUFBWSxFQUFFLGdDQUFnQyxDQUFDLENBQUM7QUFDdEUsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9jb21wb25lbnQvYXVkaW8vaW5kZXgudHM/NTVjMiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb2xsYXBzaWJsZSB9IGZyb20gJ0AvdXRpbC9jb2xsYXBzaWJsZSc7XG5pbXBvcnQgeyBleHRlbnNpb25Gb2xkZXJQYXRoLCBnZXRTZXR0aW5nVmFsdWUsIHNhdmVTZXR0aW5nVmFsdWUgfSBmcm9tICdAL3V0aWwvZXh0ZW5zaW9uX3ZhcmlhYmxlcyc7XG5cbmltcG9ydCB7IGNoYXRfbWV0YWRhdGEsIGV2ZW50U291cmNlLCBldmVudF90eXBlcywgc2F2ZVNldHRpbmdzRGVib3VuY2VkIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5pbXBvcnQgeyByZW5kZXJFeHRlbnNpb25UZW1wbGF0ZUFzeW5jLCBzYXZlTWV0YWRhdGFEZWJvdW5jZWQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9leHRlbnNpb25zJztcbmltcG9ydCB7IFBPUFVQX1RZUEUsIGNhbGxHZW5lcmljUG9wdXAgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9wb3B1cCc7XG5pbXBvcnQgeyBpc01vYmlsZSB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL1Jvc3NBc2NlbmRzLW1vZHMnO1xuaW1wb3J0IHsgZ2V0U29ydGFibGVEZWxheSwgbG9hZEZpbGVUb0RvY3VtZW50IH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvdXRpbHMnO1xuXG5pbXBvcnQgbG9nIGZyb20gJ2xvZ2xldmVsJztcblxubGV0IGlzRXh0ZW5zaW9uRW5hYmxlZDogYm9vbGVhbjtcbmxldCBpc0F1ZGlvRW5hYmxlZDogYm9vbGVhbjtcbmV4cG9ydCBsZXQgbGlzdF9CR01TOiBzdHJpbmdbXSA9IFtdO1xuZXhwb3J0IGxldCBsaXN0X2FtYmllbnRzOiBzdHJpbmdbXSA9IFtdO1xubGV0IGJnbUVuZGVkID0gdHJ1ZTtcbmxldCBhbWJpZW50RW5kZWQgPSB0cnVlO1xuXG5jb25zdCB0ZW1wbGF0ZVBhdGggPSBgJHtleHRlbnNpb25Gb2xkZXJQYXRofS9zcmMvY29tcG9uZW50L2F1ZGlvYDtcbi8vIOWumuS5iem7mOiupOmfs+mikeiuvue9rlxuZXhwb3J0IGNvbnN0IGRlZmF1bHRBdWRpb1NldHRpbmdzID0ge1xuICBhdWRpb19lbmFibGVkOiB0cnVlLFxuICBiZ21fZW5hYmxlZDogdHJ1ZSxcbiAgYW1iaWVudF9lbmFibGVkOiB0cnVlLFxuICBiZ21fbW9kZTogJ3JlcGVhdCcsXG4gIGJnbV9tdXRlZDogZmFsc2UsXG4gIGJnbV92b2x1bWU6IDUwLFxuICBiZ21fc2VsZWN0ZWQ6IG51bGwsXG4gIGJnbV9jdXJyZW50X3RpbWU6IDAsXG4gIGFtYmllbnRfbW9kZTogJ3N0b3AnLFxuICBhbWJpZW50X211dGVkOiBmYWxzZSxcbiAgYW1iaWVudF92b2x1bWU6IDUwLFxuICBhbWJpZW50X3NlbGVjdGVkOiBudWxsLFxuICBhbWJpZW50X2N1cnJlbnRfdGltZTogMCxcbiAgYXVkaW9fY29vbGRvd246IDAsXG59O1xuXG4vKipcbiAqIOabtOaWsOmfs+mikVxuICogQHBhcmFtIHR5cGUg6Z+z6aKR57G75Z6LIFwiYmdtXCIg5oiWIFwiYW1iaWVudFwiXG4gKiBAcGFyYW0gaXNVc2VySW5wdXQg5piv5ZCm55Sx55So5oi35pON5L2c6Kem5Y+RLeWwhuWvvOiHtOmfs+mikeS4reaWrVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlQXVkaW8odHlwZSA9ICdiZ20nLCBpc1VzZXJJbnB1dCA9IGZhbHNlKSB7XG4gIGlmICghZ2V0U2V0dGluZ1ZhbHVlKCdhdWRpby5hdWRpb19lbmFibGVkJykpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCBpc1R5cGVFbmFibGVkID1cbiAgICB0eXBlID09PSAnYmdtJyA/IGdldFNldHRpbmdWYWx1ZSgnYXVkaW8uYmdtX2VuYWJsZWQnKSA6IGdldFNldHRpbmdWYWx1ZSgnYXVkaW8uYW1iaWVudF9lbmFibGVkJyk7XG5cbiAgaWYgKCFpc1R5cGVFbmFibGVkKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IGF1ZGlvRW5kZWQgPSB0eXBlID09PSAnYmdtJyA/IGJnbUVuZGVkIDogYW1iaWVudEVuZGVkO1xuICBjb25zdCBhdWRpb1NlbGVjdG9yID0gYCNhdWRpb18ke3R5cGV9YDtcblxuICBpZiAoIWlzVXNlcklucHV0ICYmICQoYXVkaW9TZWxlY3RvcikuYXR0cignc3JjJykgIT0gJycgJiYgIWF1ZGlvRW5kZWQpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBsZXQgYXVkaW9fdXJsID0gJyc7XG4gIGNvbnN0IHBsYXlsaXN0ID0gYXdhaXQgZ2V0QXVkaW9VcmwodHlwZSBhcyAnYmdtJyB8ICdhbWJpZW50Jyk7XG5cbiAgaWYgKGlzVXNlcklucHV0KSB7XG4gICAgYXVkaW9fdXJsID1cbiAgICAgIHR5cGUgPT09ICdiZ20nXG4gICAgICAgID8gZ2V0U2V0dGluZ1ZhbHVlKCdhdWRpby5iZ21fc2VsZWN0ZWQnKSB8fCBwbGF5bGlzdFswXVxuICAgICAgICA6IGdldFNldHRpbmdWYWx1ZSgnYXVkaW8uYW1iaWVudF9zZWxlY3RlZCcpIHx8IHBsYXlsaXN0WzBdO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IG1vZGUgPSB0eXBlID09PSAnYmdtJyA/IGdldFNldHRpbmdWYWx1ZSgnYXVkaW8uYmdtX21vZGUnKSA6IGdldFNldHRpbmdWYWx1ZSgnYXVkaW8uYW1iaWVudF9tb2RlJyk7XG5cbiAgICBjb25zdCBzZWxlY3RlZCA9IHR5cGUgPT09ICdiZ20nID8gZ2V0U2V0dGluZ1ZhbHVlKCdhdWRpby5iZ21fc2VsZWN0ZWQnKSA6IGdldFNldHRpbmdWYWx1ZSgnYXVkaW8uYW1iaWVudF9zZWxlY3RlZCcpO1xuXG4gICAgYXVkaW9fdXJsID0gZ2V0TmV4dEZpbGVCeU1vZGUobW9kZSwgcGxheWxpc3QsIHNlbGVjdGVkKTtcbiAgfVxuXG4gIGlmICghYXVkaW9fdXJsKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgYXVkaW8gPSAkKGF1ZGlvU2VsZWN0b3IpWzBdIGFzIEhUTUxBdWRpb0VsZW1lbnQ7XG5cbiAgLy8g5a+55LqOYW1iaWVudOexu+Wei++8jOWkhOeQhuaOiemYsue8k+WtmOWQjue8gFxuICBpZiAodHlwZSA9PT0gJ2FtYmllbnQnKSB7XG4gICAgY29uc3QgY2xlYW5BdWRpb1NyYyA9IGF1ZGlvLnNyYy5zcGxpdCgnPycpWzBdO1xuICAgIGNvbnN0IGNsZWFuQXVkaW9VcmwgPSBhdWRpb191cmwuc3BsaXQoJz8nKVswXTtcbiAgICBpZiAoZGVjb2RlVVJJQ29tcG9uZW50KGNsZWFuQXVkaW9TcmMpID09PSBkZWNvZGVVUklDb21wb25lbnQoY2xlYW5BdWRpb1VybCkgJiYgIWF1ZGlvRW5kZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH0gZWxzZSBpZiAoZGVjb2RlVVJJQ29tcG9uZW50KGF1ZGlvLnNyYykgPT09IGRlY29kZVVSSUNvbXBvbmVudChhdWRpb191cmwpICYmICFhdWRpb0VuZGVkKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8g6K6+572uYXVkaW9FbmRlZOeKtuaAgVxuICBpZiAodHlwZSA9PT0gJ2JnbScpIHtcbiAgICBiZ21FbmRlZCA9IGZhbHNlO1xuICB9IGVsc2Uge1xuICAgIGFtYmllbnRFbmRlZCA9IGZhbHNlO1xuICB9XG5cbiAgaWYgKHR5cGUgPT09ICdiZ20nKSB7XG4gICAgYXVkaW8uc3JjID0gYXVkaW9fdXJsO1xuICAgIGF1ZGlvLmxvYWQoKTtcblxuICAgIGF3YWl0IG5ldyBQcm9taXNlPHZvaWQ+KHJlc29sdmUgPT4ge1xuICAgICAgY29uc3QgY2FuUGxheUhhbmRsZXIgPSAoKSA9PiB7XG4gICAgICAgIGF1ZGlvLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NhbnBsYXl0aHJvdWdoJywgY2FuUGxheUhhbmRsZXIpO1xuICAgICAgICByZXNvbHZlKCk7XG4gICAgICB9O1xuXG4gICAgICBpZiAoYXVkaW8ucmVhZHlTdGF0ZSA+PSBIVE1MTWVkaWFFbGVtZW50LkhBVkVfRU5PVUdIX0RBVEEpIHtcbiAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXVkaW8uYWRkRXZlbnRMaXN0ZW5lcignY2FucGxheXRocm91Z2gnLCBjYW5QbGF5SGFuZGxlcik7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBhd2FpdCBwbGF5QXVkaW8odHlwZSk7XG4gIH0gZWxzZSB7XG4gICAgLy8g5a+55LqOYW1iaWVudOexu+Wei++8jOS9v+eUqOe8k+WtmOegtOWdj1xuICAgIGNvbnN0IGF1ZGlvVXJsV2l0aENhY2hlQnVzdGluZyA9IGdldEF1ZGlvVXJsV2l0aENhY2hlQnVzdGluZyhhdWRpb191cmwpO1xuICAgIGF1ZGlvLnNyYyA9IGF1ZGlvVXJsV2l0aENhY2hlQnVzdGluZztcbiAgICBhdWRpby5sb2FkKCk7XG5cbiAgICBhd2FpdCBuZXcgUHJvbWlzZTx2b2lkPihyZXNvbHZlID0+IHtcbiAgICAgIGNvbnN0IGNhblBsYXlIYW5kbGVyID0gKCkgPT4ge1xuICAgICAgICBhdWRpby5yZW1vdmVFdmVudExpc3RlbmVyKCdjYW5wbGF5dGhyb3VnaCcsIGNhblBsYXlIYW5kbGVyKTtcbiAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgfTtcblxuICAgICAgaWYgKGF1ZGlvLnJlYWR5U3RhdGUgPj0gSFRNTE1lZGlhRWxlbWVudC5IQVZFX0VOT1VHSF9EQVRBKSB7XG4gICAgICAgIHJlc29sdmUoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGF1ZGlvLmFkZEV2ZW50TGlzdGVuZXIoJ2NhbnBsYXl0aHJvdWdoJywgY2FuUGxheUhhbmRsZXIpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgYXdhaXQgcGxheUF1ZGlvKHR5cGUgYXMgJ2JnbScgfCAnYW1iaWVudCcpO1xuICB9XG5cbiAgLy8g5pu05paw6YCJ5Lit55qE6Z+z6aKRXG4gIGlmICh0eXBlID09PSAnYmdtJykge1xuICAgIHNhdmVTZXR0aW5nVmFsdWUoJ2F1ZGlvLmJnbV9zZWxlY3RlZCcsIGF1ZGlvX3VybCk7XG4gIH0gZWxzZSB7XG4gICAgc2F2ZVNldHRpbmdWYWx1ZSgnYXVkaW8uYW1iaWVudF9zZWxlY3RlZCcsIGF1ZGlvX3VybCk7XG4gIH1cblxuICAvLyDmm7TmlrDpgInmi6nlmahcbiAgY29uc3Qgc2VsZWN0RWxlbWVudCA9ICQoYCNhdWRpb18ke3R5cGV9X3NlbGVjdGApO1xuICBpZiAoc2VsZWN0RWxlbWVudC52YWwoKSAhPT0gYXVkaW9fdXJsKSB7XG4gICAgc2VsZWN0RWxlbWVudC52YWwoYXVkaW9fdXJsKTtcbiAgfVxuXG4gIHNhdmVTZXR0aW5nc0RlYm91bmNlZCgpO1xufVxuXG4vKipcbiAqIOabtOaWsOmfs+mikeS4i+aLiemAieaLqeiPnOWNlVxuICogQHBhcmFtIHR5cGUg6Z+z6aKR57G75Z6LIFwiYmdtXCIg5oiWIFwiYW1iaWVudFwiXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVBdWRpb1NlbGVjdCh0eXBlID0gJ2JnbScpIHtcbiAgaWYgKCFnZXRTZXR0aW5nVmFsdWUoYGF1ZGlvLiR7dHlwZX1fZW5hYmxlZGApKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3Qgc2VsZWN0RWxlbWVudCA9ICQoYCNhdWRpb18ke3R5cGV9X3NlbGVjdGApO1xuICBzZWxlY3RFbGVtZW50LmVtcHR5KCk7XG5cbiAgaWYgKHR5cGUgPT09ICdiZ20nKSB7XG4gICAgbGlzdF9CR01TID0gYXdhaXQgZ2V0QXVkaW9VcmwoJ2JnbScpO1xuICB9IGVsc2Uge1xuICAgIGxpc3RfYW1iaWVudHMgPSBhd2FpdCBnZXRBdWRpb1VybCgnYW1iaWVudCcpO1xuICB9XG5cbiAgY29uc3QgYXVkaW9MaXN0ID0gdHlwZSA9PT0gJ2JnbScgPyBsaXN0X0JHTVMgOiBsaXN0X2FtYmllbnRzO1xuICBsZXQgc2VsZWN0ZWRTZXR0aW5nID1cbiAgICB0eXBlID09PSAnYmdtJyA/IGdldFNldHRpbmdWYWx1ZSgnYXVkaW8uYmdtX3NlbGVjdGVkJykgOiBnZXRTZXR0aW5nVmFsdWUoJ2F1ZGlvLmFtYmllbnRfc2VsZWN0ZWQnKTtcblxuICBpZiAoYXVkaW9MaXN0ICYmIGF1ZGlvTGlzdC5sZW5ndGggPiAwKSB7XG4gICAgLy8g5qOA5p+l5b2T5YmN6YCJ5oup55qE6Z+z6aKR5piv5ZCm5Zyo5YiX6KGo5Lit77yM5aaC5p6c5LiN5Zyo5YiZ6YCJ5oup56ys5LiA5LiqXG4gICAgaWYgKCFhdWRpb0xpc3QuaW5jbHVkZXMoc2VsZWN0ZWRTZXR0aW5nKSkge1xuICAgICAgbG9nLndhcm4oYFtBdWRpb10g5b2T5YmN6YCJ5oup55qE6Z+z6aKRICR7c2VsZWN0ZWRTZXR0aW5nfSDkuI3lnKjliJfooajkuK3vvIzoh6rliqjpgInmi6nliJfooajnrKzkuIDkuKrpn7PpopFgKTtcbiAgICAgIHNlbGVjdGVkU2V0dGluZyA9IGF1ZGlvTGlzdFswXTtcbiAgICAgIGlmICh0eXBlID09PSAnYmdtJykge1xuICAgICAgICBzYXZlU2V0dGluZ1ZhbHVlKCdhdWRpby5iZ21fc2VsZWN0ZWQnLCBzZWxlY3RlZFNldHRpbmcpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2F2ZVNldHRpbmdWYWx1ZSgnYXVkaW8uYW1iaWVudF9zZWxlY3RlZCcsIHNlbGVjdGVkU2V0dGluZyk7XG4gICAgICB9XG4gICAgICBzYXZlU2V0dGluZ3NEZWJvdW5jZWQoKTtcbiAgICB9XG5cbiAgICBjb25zdCBhdWRpb0ZpbGVzID0gQXJyYXkuaXNBcnJheShhdWRpb0xpc3QpID8gYXVkaW9MaXN0IDogYXVkaW9MaXN0LnNwbGl0KCcsJykubWFwKGZpbGUgPT4gZmlsZS50cmltKCkpO1xuICAgIGF1ZGlvRmlsZXMuZm9yRWFjaCgoZmlsZTogc3RyaW5nKSA9PiB7XG4gICAgICBjb25zdCBmaWxlTGFiZWwgPSBmaWxlLnJlcGxhY2UoL14uKltcXFxcXFwvXS8sICcnKS5yZXBsYWNlKC9cXC5bXi8uXSskLywgJycpO1xuICAgICAgc2VsZWN0RWxlbWVudC5hcHBlbmQobmV3IE9wdGlvbihmaWxlTGFiZWwsIGZpbGUpKTtcbiAgICB9KTtcblxuICAgIHNlbGVjdEVsZW1lbnQudmFsKHNlbGVjdGVkU2V0dGluZyk7XG4gIH0gZWxzZSB7XG4gICAgbG9nLndhcm4oYFtBdWRpb10g5pqC5peg5Y+v55So55qEICR7dHlwZS50b1VwcGVyQ2FzZSgpfSDotYTmupBgKTtcbiAgfVxufVxuXG4vKipcbiAqIOiOt+WPlumfs+mikVVSTFxuICogQHBhcmFtIHR5cGUg6Z+z6aKR57G75Z6LIFwiYmdtXCIg5oiWIFwiYW1iaWVudFwiXG4gKiBAcmV0dXJucyDpn7PpopFVUkzmlbDnu4RcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEF1ZGlvVXJsKHR5cGUgPSAnYmdtJykge1xuICBjb25zdCB0eXBlS2V5ID0gdHlwZSA9PT0gJ2JnbScgPyAnYmdtdXJsJyA6ICdhbWJpZW50dXJsJztcbiAgLy9AdHMtaWdub3JlXG4gIGNvbnN0IGNoYXRTcGVjaWZpY1VybHMgPSBjaGF0X21ldGFkYXRhLnZhcmlhYmxlcz8uW3R5cGVLZXldIHx8IFtdO1xuICByZXR1cm4gY2hhdFNwZWNpZmljVXJscztcbn1cblxuLyoqXG4gKiDmt7vliqDnvJPlrZjlj4LmlbDpmLLmraLnvJPlrZhcbiAqIEBwYXJhbSBvcmlnaW5hbFVybCDljp/lp4tVUkxcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEF1ZGlvVXJsV2l0aENhY2hlQnVzdGluZyhvcmlnaW5hbFVybDogc3RyaW5nKSB7XG4gIGlmICghb3JpZ2luYWxVcmwpIHJldHVybiAnJztcbiAgY29uc3QgY2FjaGVCdXN0ZXIgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcbiAgY29uc3Qgc2VwYXJhdG9yID0gb3JpZ2luYWxVcmwuaW5jbHVkZXMoJz8nKSA/ICcmJyA6ICc/JztcbiAgcmV0dXJuIGAke29yaWdpbmFsVXJsfSR7c2VwYXJhdG9yfV89JHtjYWNoZUJ1c3Rlcn1gO1xufVxuXG4vKipcbiAqIOagueaNruaSreaUvuaooeW8j+iOt+WPluS4i+S4gOS4qumfs+mikeaWh+S7tlxuICogQHBhcmFtIG1vZGUg5pKt5pS+5qih5byPXG4gKiBAcGFyYW0gcGxheWxpc3Qg5pKt5pS+5YiX6KGoXG4gKiBAcGFyYW0gY3VycmVudEZpbGUg5b2T5YmN5paH5Lu2XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXROZXh0RmlsZUJ5TW9kZShtb2RlOiBzdHJpbmcsIHBsYXlsaXN0OiBzdHJpbmdbXSwgY3VycmVudEZpbGU6IHN0cmluZykge1xuICBpZiAoIXBsYXlsaXN0IHx8IHBsYXlsaXN0Lmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiAnJztcbiAgfVxuXG4gIHN3aXRjaCAobW9kZSkge1xuICAgIGNhc2UgJ3JlcGVhdCc6XG4gICAgICByZXR1cm4gcGxheWxpc3RbMF07XG4gICAgY2FzZSAnc2luZ2xlJzpcbiAgICAgIHJldHVybiBjdXJyZW50RmlsZSB8fCBwbGF5bGlzdFswXTtcbiAgICBjYXNlICdyYW5kb20nOiB7XG4gICAgICBjb25zdCBmaWx0ZXJlZFBsYXlsaXN0ID0gcGxheWxpc3QuZmlsdGVyKGZpbGUgPT4gZmlsZSAhPT0gY3VycmVudEZpbGUpO1xuICAgICAgaWYgKGZpbHRlcmVkUGxheWxpc3QubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybiBwbGF5bGlzdFswXTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHJhbmRvbUluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogZmlsdGVyZWRQbGF5bGlzdC5sZW5ndGgpO1xuICAgICAgcmV0dXJuIGZpbHRlcmVkUGxheWxpc3RbcmFuZG9tSW5kZXhdO1xuICAgIH1cbiAgICBjYXNlICdzdG9wJzpcbiAgICAgIHJldHVybiAnJztcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIHBsYXlsaXN0WzBdO1xuICB9XG59XG5cbi8qKlxuICog5YiH5o2i6Z+z6aKR5o6n5Lu254q25oCBXG4gKiBAcGFyYW0gdHlwZSDpn7PpopHnsbvlnosgXCJiZ21cIiDmiJYgXCJhbWJpZW50XCJcbiAqIEBwYXJhbSBzdGF0dXMg5piv5ZCm5ZCv55SoXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0b2dnbGVBdWRpb0NvbnRyb2xzKHR5cGU6ICdiZ20nIHwgJ2FtYmllbnQnLCBzdGF0dXMgPSAnZW5hYmxlJykge1xuICBjb25zdCBpc01haW5FbmFibGVkID0gJCgnI2F1ZGlvX2VuYWJsZWQnKS5wcm9wKCdjaGVja2VkJyk7XG5cbiAgY29uc3Qgc2hvdWxkRW5hYmxlID0gaXNNYWluRW5hYmxlZCAmJiBzdGF0dXMgPT09ICdlbmFibGUnO1xuXG4gIGNvbnN0IGNvbnRyb2xJZHMgPSBbXG4gICAgYCNhdWRpb18ke3R5cGV9X3BsYXlfcGF1c2VgLFxuICAgIGAjYXVkaW9fJHt0eXBlfV9tdXRlYCxcbiAgICBgI2F1ZGlvXyR7dHlwZX1fbW9kZWAsXG4gICAgYCNhdWRpb18ke3R5cGV9X3NlbGVjdGAsXG4gICAgYCNhdWRpb18ke3R5cGV9X3ZvbHVtZV9zbGlkZXJgLFxuICBdO1xuXG4gIGNvbnRyb2xJZHMuZm9yRWFjaChpZCA9PiB7XG4gICAgJChpZCkucHJvcCgnZGlzYWJsZWQnLCAhc2hvdWxkRW5hYmxlKTtcbiAgfSk7XG59XG5cbi8qKlxuICog54K55Ye76Z+z6aKR5ZCv55So5oyJ6ZKu5pe255qE6YCa55So5aSE55CG5Ye95pWwXG4gKiBAcGFyYW0gdHlwZSDpn7PpopHnsbvlnosgXCJiZ21cIiDmiJYgXCJhbWJpZW50XCJcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG9uQXVkaW9FbmFibGVkQ2xpY2sodHlwZSA9ICdiZ20nKSB7XG4gIGNvbnN0IGVuYWJsZWQgPSAkKGAjZW5hYmxlXyR7dHlwZX1gKS5wcm9wKCdjaGVja2VkJyk7XG4gIHNhdmVTZXR0aW5nVmFsdWUoYGF1ZGlvLiR7dHlwZX1fZW5hYmxlZGAsIGVuYWJsZWQpO1xuXG4gIGlmIChlbmFibGVkKSB7XG4gICAgdG9nZ2xlQXVkaW9Db250cm9scyh0eXBlIGFzICdiZ20nIHwgJ2FtYmllbnQnLCAnZW5hYmxlJyk7XG4gICAgYXdhaXQgdXBkYXRlQXVkaW8odHlwZSwgZmFsc2UpO1xuICB9IGVsc2Uge1xuICAgICgkKGAjYXVkaW9fJHt0eXBlfWApWzBdIGFzIEhUTUxBdWRpb0VsZW1lbnQpLnBhdXNlKCk7XG4gICAgdG9nZ2xlQXVkaW9Db250cm9scyh0eXBlIGFzICdiZ20nIHwgJ2FtYmllbnQnLCAnZGlzYWJsZScpO1xuICB9XG59XG5cbi8qKlxuICog5Yid5aeL5YyW6Z+z6aKR5LqL5Lu255uR5ZCsXG4gKiBAcGFyYW0gdHlwZSDpn7PpopHnsbvlnosgXCJiZ21cIiDmiJYgXCJhbWJpZW50XCJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluaXRBdWRpb0V2ZW50TGlzdGVuZXJzKHR5cGU6ICdiZ20nIHwgJ2FtYmllbnQnKSB7XG4gICgkKGAjYXVkaW9fJHt0eXBlfWApIGFzIEhUTUxBdWRpb0VsZW1lbnQpLm9uKCdlbmRlZCcsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICBpZiAodHlwZSA9PT0gJ2JnbScpIHtcbiAgICAgIGJnbUVuZGVkID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgYW1iaWVudEVuZGVkID0gdHJ1ZTtcbiAgICB9XG4gICAgY29uc3QgbW9kZSA9IGdldFNldHRpbmdWYWx1ZShgYXVkaW8uJHt0eXBlfV9tb2RlYCk7XG5cbiAgICBpZiAobW9kZSA9PT0gJ3N0b3AnKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgYXdhaXQgdXBkYXRlQXVkaW8odHlwZSwgZmFsc2UpO1xuICB9KTtcbn1cblxuLyoqXG4gKiDliJ3lp4vljJbov5vluqbmnaFcbiAqIEBwYXJhbSB0eXBlIOmfs+mikeexu+WeiyBcImJnbVwiIOaIliBcImFtYmllbnRcIlxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5pdGlhbGl6ZVByb2dyZXNzQmFyKHR5cGU6ICdiZ20nIHwgJ2FtYmllbnQnKSB7XG4gIGNvbnN0ICRhdWRpb0VsZW1lbnQgPSAkKGAjYXVkaW9fJHt0eXBlfWApO1xuICBjb25zdCAkcHJvZ3Jlc3NTbGlkZXIgPSAkKGAjYXVkaW9fJHt0eXBlfV9wcm9ncmVzc19zbGlkZXJgKTtcblxuICAkYXVkaW9FbGVtZW50Lm9uKCd0aW1ldXBkYXRlJywgZnVuY3Rpb24gKCkge1xuICAgIGlmICghaXNOYU4odGhpcy5kdXJhdGlvbikpIHtcbiAgICAgIGNvbnN0IHByb2dyZXNzUGVyY2VudCA9ICh0aGlzLmN1cnJlbnRUaW1lIC8gdGhpcy5kdXJhdGlvbikgKiAxMDA7XG4gICAgICAkcHJvZ3Jlc3NTbGlkZXIudmFsKHByb2dyZXNzUGVyY2VudCk7XG4gICAgfVxuICAgIGNvbnN0IGNvb2xkb3duQkdNID0gZ2V0U2V0dGluZ1ZhbHVlKCdhdWRpby5hdWRpb19jb29sZG93bicpO1xuICAgIGNvbnN0IHJlbWFpbmluZ1RpbWUgPSB0aGlzLmR1cmF0aW9uIC0gdGhpcy5jdXJyZW50VGltZTtcblxuICAgIGlmIChjb29sZG93bkJHTSA+IDAgJiYgcmVtYWluaW5nVGltZSA8PSBjb29sZG93bkJHTSAmJiAhdGhpcy5pc0ZhZGluZ091dCkge1xuICAgICAgY29uc3QgaW5pdGlhbFZvbHVtZSA9IHRoaXMudm9sdW1lO1xuICAgICAgY29uc3QgZmFkZVN0ZXAgPSBpbml0aWFsVm9sdW1lIC8gKGNvb2xkb3duQkdNICogMTApO1xuICAgICAgdGhpcy5pc0ZhZGluZ091dCA9IHRydWU7XG5cbiAgICAgIGNvbnN0IGZhZGVPdXRJbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMudm9sdW1lID4gMCkge1xuICAgICAgICAgIHRoaXMudm9sdW1lID0gTWF0aC5tYXgoMCwgdGhpcy52b2x1bWUgLSBmYWRlU3RlcCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY2xlYXJJbnRlcnZhbChmYWRlT3V0SW50ZXJ2YWwpO1xuICAgICAgICAgIHRoaXMuaXNGYWRpbmdPdXQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfSwgMTAwKTtcbiAgICB9XG4gIH0pO1xuXG4gICRhdWRpb0VsZW1lbnQub24oJ3BsYXknLCBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgY29vbGRvd25CR00gPSBnZXRTZXR0aW5nVmFsdWUoJ2F1ZGlvLmF1ZGlvX2Nvb2xkb3duJyk7XG4gICAgY29uc3QgdGFyZ2V0Vm9sdW1lID0gJChgI2F1ZGlvXyR7dHlwZX1fdm9sdW1lX3NsaWRlcmApLnZhbCgpIC8gMTAwO1xuXG4gICAgaWYgKGNvb2xkb3duQkdNIDw9IDApIHtcbiAgICAgIHRoaXMudm9sdW1lID0gdGFyZ2V0Vm9sdW1lO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMudm9sdW1lID0gMDtcbiAgICBjb25zdCBmYWRlU3RlcCA9IHRhcmdldFZvbHVtZSAvIChjb29sZG93bkJHTSAqIDEwKTtcbiAgICBjb25zdCBmYWRlSW5JbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgIGlmICh0aGlzLnZvbHVtZSA8IHRhcmdldFZvbHVtZSkge1xuICAgICAgICB0aGlzLnZvbHVtZSA9IE1hdGgubWluKHRhcmdldFZvbHVtZSwgdGhpcy52b2x1bWUgKyBmYWRlU3RlcCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjbGVhckludGVydmFsKGZhZGVJbkludGVydmFsKTtcbiAgICAgIH1cbiAgICB9LCAxMDApO1xuICB9KTtcblxuICAkYXVkaW9FbGVtZW50Lm9uKCdsb2FkZWRtZXRhZGF0YScsIGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIWlzTmFOKHRoaXMuZHVyYXRpb24pKSB7XG4gICAgICAkcHJvZ3Jlc3NTbGlkZXIuYXR0cignbWF4JywgMTAwKTtcbiAgICB9XG4gIH0pO1xuXG4gICRwcm9ncmVzc1NsaWRlci5vbignaW5wdXQnLCBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgdmFsdWUgPSAkKHRoaXMpLnZhbCgpO1xuICAgIGlmICghaXNOYU4oJGF1ZGlvRWxlbWVudFswXS5kdXJhdGlvbikpIHtcbiAgICAgICRhdWRpb0VsZW1lbnRbMF0uY3VycmVudFRpbWUgPSAodmFsdWUgLyAxMDApICogJGF1ZGlvRWxlbWVudFswXS5kdXJhdGlvbjtcbiAgICB9XG4gIH0pO1xufVxuXG4vKipcbiAqIOmfs+mHj+a7keWdl+a7mui9ruiwg+iKguS6i+S7tuWkhOeQhlxuICogQHBhcmFtIGUg5LqL5Lu25a+56LGhXG4gKi9cbmZ1bmN0aW9uIG9uVm9sdW1lU2xpZGVyV2hlZWxFdmVudCh0aGlzOiBhbnksIGU6IFdoZWVsRXZlbnQpIHtcbiAgY29uc3Qgc2xpZGVyID0gJCh0aGlzKTtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gIGNvbnN0IGRlbHRhID0gZS5kZWx0YVkgLyAyMDtcbiAgY29uc3Qgc2xpZGVyVmFsID0gTnVtYmVyKHNsaWRlci52YWwoKSk7XG5cbiAgbGV0IG5ld1ZhbCA9IHNsaWRlclZhbCAtIGRlbHRhO1xuICBpZiAobmV3VmFsIDwgMCkge1xuICAgIG5ld1ZhbCA9IDA7XG4gIH0gZWxzZSBpZiAobmV3VmFsID4gMTAwKSB7XG4gICAgbmV3VmFsID0gMTAwO1xuICB9XG5cbiAgc2xpZGVyLnZhbChuZXdWYWwpLnRyaWdnZXIoJ2lucHV0Jyk7XG59XG5cbi8qKlxuICog6ZW/5oyJ6Z+z6YeP5o6n5Yi25oyJ6ZKu5Ye6546w6Z+z6YeP6LCD6IqCXG4gKiBAcGFyYW0gdm9sdW1lQ29udHJvbElkIOmfs+mHj+aOp+WItuaMiemSrklEXG4gKiBAcGFyYW0gaWNvbklkIOmfs+mHj+aOp+WItuaMiemSruWbvuagh0lEXG4gKi9cbmZ1bmN0aW9uIGhhbmRsZUxvbmdQcmVzcyh2b2x1bWVDb250cm9sSWQ6IHN0cmluZywgaWNvbklkOiBzdHJpbmcpIHtcbiAgY29uc3QgJHZvbHVtZUNvbnRyb2wgPSAkKGAjJHt2b2x1bWVDb250cm9sSWR9YCk7XG4gIGNvbnN0ICRpY29uID0gJChgIyR7aWNvbklkfWApO1xuICBsZXQgcHJlc3NUaW1lcjogbnVtYmVyIHwgdW5kZWZpbmVkO1xuXG4gIGlmIChpc01vYmlsZSgpKSB7XG4gICAgJGljb24ub24oJ3RvdWNoc3RhcnQnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgcHJlc3NUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAkdm9sdW1lQ29udHJvbC5jc3MoJ2Rpc3BsYXknLCAnYmxvY2snKTtcbiAgICAgIH0sIDUwMCk7XG4gICAgfSk7XG5cbiAgICAkaWNvbi5vbigndG91Y2hlbmQnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgY2xlYXJUaW1lb3V0KHByZXNzVGltZXIpO1xuICAgIH0pO1xuXG4gICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICBpZiAoXG4gICAgICAgICEkaWNvbi5pcyhldmVudC50YXJnZXQpICYmXG4gICAgICAgICRpY29uLmhhcyhldmVudC50YXJnZXQpLmxlbmd0aCA9PT0gMCAmJlxuICAgICAgICAhJHZvbHVtZUNvbnRyb2wuaXMoZXZlbnQudGFyZ2V0KSAmJlxuICAgICAgICAkdm9sdW1lQ29udHJvbC5oYXMoZXZlbnQudGFyZ2V0KS5sZW5ndGggPT09IDBcbiAgICAgICkge1xuICAgICAgICAkdm9sdW1lQ29udHJvbC5jc3MoJ2Rpc3BsYXknLCAnbm9uZScpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG5cbi8qKlxuICog5Yi35paw6Z+z6aKR6LWE5rqQXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZWZyZXNoQXVkaW9SZXNvdXJjZXMoKSB7XG4gIHVwZGF0ZUF1ZGlvU2VsZWN0KCdiZ20nKTtcbiAgdXBkYXRlQXVkaW9TZWxlY3QoJ2FtYmllbnQnKTtcbn1cblxuLyoqXG4gKiDmiZPlvIDpn7PpopHotYTmupDnrqHnkIblvLnnqpdcbiAqIEBwYXJhbSB0eXBlS2V5IOmfs+mikeexu+WeiyBcImJnbXVybFwiIOaIliBcImFtYmllbnR1cmxcIlxuICovXG5cbmFzeW5jIGZ1bmN0aW9uIG9wZW5VcmxNYW5hZ2VyUG9wdXAodHlwZUtleTogJ2JnbXVybCcgfCAnYW1iaWVudHVybCcpIHtcbiAgY29uc3QgdXJsTWFuYWdlciA9ICQoYXdhaXQgcmVuZGVyRXh0ZW5zaW9uVGVtcGxhdGVBc3luYyhgJHt0ZW1wbGF0ZVBhdGh9YCwgJ2F1ZGlvX3VybF9tYW5hZ2VyJykpO1xuICB1cmxNYW5hZ2VyLnByZXBlbmQoYFxuICAgIDxzdHlsZT5cbiAgICAgICNzYXZlZF9hdWRpb191cmwuZW1wdHk6OmFmdGVyIHtcbiAgICAgICAgY29udGVudDogXCLmmoLml6Dpn7PpopFcIjtcbiAgICAgICAgY29sb3I6ICM5OTk7XG4gICAgICAgIG1hcmdpbi10b3A6IDIwcHg7XG4gICAgICAgIGZvbnQtc2l6ZTogMTJweDtcbiAgICAgIH1cbiAgICA8L3N0eWxlPlxuICBgKTtcbiAgY29uc3Qgc2F2ZWRBdWRpb1VybCA9IHVybE1hbmFnZXIuZmluZCgnI3NhdmVkX2F1ZGlvX3VybCcpLmVtcHR5KCk7XG4gIGNvbnN0IHVybFRlbXBsYXRlID0gJChhd2FpdCByZW5kZXJFeHRlbnNpb25UZW1wbGF0ZUFzeW5jKGAke3RlbXBsYXRlUGF0aH1gLCAnYXVkaW9fdXJsX3RlbXBsYXRlJykpO1xuXG4gIGlmICghY2hhdF9tZXRhZGF0YS52YXJpYWJsZXMpIHtcbiAgICBjaGF0X21ldGFkYXRhLnZhcmlhYmxlcyA9IHt9O1xuICB9XG5cbiAgbGV0IHVybFZhbHVlOiBzdHJpbmdbXSA9IGNoYXRfbWV0YWRhdGEudmFyaWFibGVzW3R5cGVLZXldO1xuICBpZiAoIXVybFZhbHVlKSB7XG4gICAgdXJsVmFsdWUgPSBbXTtcblxuICAgIHNhdmVkQXVkaW9VcmwuYWRkQ2xhc3MoJ2VtcHR5Jyk7XG4gIH0gZWxzZSB7XG4gICAgdHJ5IHtcbiAgICAgIGlmICh1cmxWYWx1ZS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgc2F2ZWRBdWRpb1VybC5hZGRDbGFzcygnZW1wdHknKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nLmVycm9yKGBbQXVkaW9dIEZhaWxlZCB0byBwYXJzZSAke3R5cGVLZXl9OmAsIGVycm9yKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IHVwZGF0ZWRVcmxzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge307XG4gIGxldCBuZXdVcmxPcmRlciA9IFsuLi51cmxWYWx1ZV07XG4gIGZ1bmN0aW9uIHJlbmRlclVybChjb250YWluZXI6IEpRdWVyeTxIVE1MRWxlbWVudD4sIHVybDogc3RyaW5nKSB7XG4gICAgY29uc3QgdXJsSHRtbCA9IHVybFRlbXBsYXRlLmNsb25lKCk7XG4gICAgbGV0IGZpbGVOYW1lO1xuICAgIGlmICh1cmwuaW5jbHVkZXMoJy8nKSkge1xuICAgICAgY29uc3QgcGFydHMgPSB1cmwuc3BsaXQoJy8nKTtcbiAgICAgIGZpbGVOYW1lID0gcGFydHNbcGFydHMubGVuZ3RoIC0gMV0gfHwgcGFydHNbcGFydHMubGVuZ3RoIC0gMl07XG4gICAgfSBlbHNlIHtcbiAgICAgIGZpbGVOYW1lID0gdXJsO1xuICAgIH1cblxuICAgIGNvbnN0IGlkID0gZmlsZU5hbWUucmVwbGFjZSgvXFwuL2csICctJyk7XG5cbiAgICB1cmxIdG1sLmF0dHIoJ2lkJywgaWQpO1xuICAgIHVybEh0bWwuZmluZCgnLmF1ZGlvX3VybF9uYW1lJykudGV4dChmaWxlTmFtZSk7XG5cbiAgICB1cmxIdG1sLmZpbmQoJy5hdWRpb191cmxfbmFtZScpLmF0dHIoJ2RhdGEtdXJsJywgdXJsKTtcblxuICAgIHVybEh0bWwuZmluZCgnLmVkaXRfZXhpc3RpbmdfdXJsJykub24oJ2NsaWNrJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgY3VycmVudFVybCA9IHVybEh0bWwuZmluZCgnLmF1ZGlvX3VybF9uYW1lJykuYXR0cignZGF0YS11cmwnKTtcblxuICAgICAgaWYgKCFjdXJyZW50VXJsKSB7XG4gICAgICAgIGxvZy5lcnJvcignW0F1ZGlvXSBObyBVUkwgZm91bmQgZm9yIHRoaXMgZWxlbWVudC4nKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBpbnB1dFVybCA9IGF3YWl0IGNhbGxHZW5lcmljUG9wdXAoJycsIFBPUFVQX1RZUEUuSU5QVVQsIGN1cnJlbnRVcmwpO1xuXG4gICAgICBpZiAoIWlucHV0VXJsKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgbmV3RmlsZU5hbWUgPSBpbnB1dFVybC5zcGxpdCgnLycpLnBvcCgpO1xuXG4gICAgICBjb25zdCBuZXdJZCA9IG5ld0ZpbGVOYW1lLnJlcGxhY2UoL1xcLi9nLCAnLScpO1xuXG4gICAgICB1cmxIdG1sLmF0dHIoJ2lkJywgbmV3SWQpO1xuICAgICAgdXJsSHRtbC5maW5kKCcuYXVkaW9fdXJsX25hbWUnKS50ZXh0KG5ld0ZpbGVOYW1lKTtcbiAgICAgIHVybEh0bWwuZmluZCgnLmF1ZGlvX3VybF9uYW1lJykuYXR0cignZGF0YS11cmwnLCBpbnB1dFVybCk7XG5cbiAgICAgIHVwZGF0ZWRVcmxzW2N1cnJlbnRVcmxdID0gaW5wdXRVcmw7XG4gICAgfSk7XG5cbiAgICB1cmxIdG1sLmZpbmQoJy5kZWxldGVfdXJsJykub24oJ2NsaWNrJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgY29uZmlybURlbGV0ZSA9IGF3YWl0IGNhbGxHZW5lcmljUG9wdXAoJ+ehruiupOimgeWIoOmZpOatpOmTvuaOpT8nLCBQT1BVUF9UWVBFLkNPTkZJUk0pO1xuXG4gICAgICBpZiAoIWNvbmZpcm1EZWxldGUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyDku4Xku45ET03kuK3np7vpmaTlhYPntKBcbiAgICAgIHVybEh0bWwucmVtb3ZlKCk7XG5cbiAgICAgIC8vIOajgOafpeaYr+WQpumcgOimgeaYvuekuuepuueKtuaAgeaPkOekulxuICAgICAgaWYgKHNhdmVkQXVkaW9VcmwuZmluZCgnLmF1ZGlvX3VybF9uYW1lJykubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHNhdmVkQXVkaW9VcmwuYWRkQ2xhc3MoJ2VtcHR5Jyk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBjb250YWluZXIuYXBwZW5kKHVybEh0bWwpO1xuICB9XG5cbiAgdXJsVmFsdWUuZm9yRWFjaCh1cmwgPT4ge1xuICAgIHJlbmRlclVybChzYXZlZEF1ZGlvVXJsLCB1cmwpO1xuICB9KTtcbiAgdXJsTWFuYWdlci5maW5kKCcjaW1wb3J0X2J1dHRvbicpLm9uKCdjbGljaycsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBuZXdVcmxzID0gYXdhaXQgb3BlblVybEltcG9ydFBvcHVwKCk7XG5cbiAgICBpZiAoIW5ld1VybHMpIHtcbiAgICAgIGxvZy5kZWJ1ZyhgW0F1ZGlvXSAke3R5cGVLZXl9IFVSTOWvvOWFpeW3suWPlua2iGApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHNhdmVkQXVkaW9VcmwucmVtb3ZlQ2xhc3MoJ2VtcHR5Jyk7XG5cbiAgICBuZXdVcmxzLmZvckVhY2godXJsID0+IHtcbiAgICAgIHJlbmRlclVybChzYXZlZEF1ZGlvVXJsLCB1cmwpO1xuICAgIH0pO1xuICB9KTtcbiAgKHNhdmVkQXVkaW9VcmwgYXMgYW55KS5zb3J0YWJsZSh7XG4gICAgZGVsYXk6IGdldFNvcnRhYmxlRGVsYXkoKSxcbiAgICBoYW5kbGU6ICcuZHJhZy1oYW5kbGUnLFxuICAgIHN0b3A6IGZ1bmN0aW9uICgpIHtcbiAgICAgIG5ld1VybE9yZGVyID0gW107XG4gICAgICBzYXZlZEF1ZGlvVXJsLmZpbmQoJy5hdWRpb191cmxfbmFtZScpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICBjb25zdCBuZXdVcmwgPSAkKHRoaXMpLmF0dHIoJ2RhdGEtdXJsJyk7XG4gICAgICAgIGlmIChuZXdVcmwpIHtcbiAgICAgICAgICBuZXdVcmxPcmRlci5wdXNoKG5ld1VybCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0sXG4gIH0pO1xuICBjb25zdCByZXN1bHQgPSBhd2FpdCBjYWxsR2VuZXJpY1BvcHVwKHVybE1hbmFnZXIsIFBPUFVQX1RZUEUuQ09ORklSTSwgJycsIHtcbiAgICBva0J1dHRvbjogYOehruiupGAsXG4gICAgY2FuY2VsQnV0dG9uOiBg5Y+W5raIYCxcbiAgfSk7XG5cbiAgaWYgKCFyZXN1bHQpIHtcbiAgICByZXR1cm47XG4gIH0gZWxzZSB7XG4gICAgLy8g55u05o6l6K+75Y+W5omA5pyJZGF0YS11cmzlsZ7mgKfvvIznlJ/miJDmlrDnmoRVUkzliJfooahcbiAgICBjb25zdCBuZXdVcmxMaXN0OiBzdHJpbmdbXSA9IFtdO1xuICAgIHNhdmVkQXVkaW9VcmwuZmluZCgnLmF1ZGlvX3VybF9uYW1lJykuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCB1cmwgPSAkKHRoaXMpLmF0dHIoJ2RhdGEtdXJsJyk7XG4gICAgICBpZiAodXJsKSB7XG4gICAgICAgIG5ld1VybExpc3QucHVzaCh1cmwpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8g5qOA5p+l5b2T5YmN5pKt5pS+55qE6Z+z6aKR5piv5ZCm5Zyo5paw55qE5YiX6KGo5LitXG4gICAgY29uc3QgY3VycmVudEJnbVVybCA9IGdldFNldHRpbmdWYWx1ZSgnYXVkaW8uYmdtX3NlbGVjdGVkJyk7XG4gICAgY29uc3QgY3VycmVudEFtYmllbnRVcmwgPSBnZXRTZXR0aW5nVmFsdWUoJ2F1ZGlvLmFtYmllbnRfc2VsZWN0ZWQnKTtcblxuICAgIC8vIOWmguaenOW9k+WJjeaSreaUvueahOmfs+mikeS4jeWcqOaWsOeahOWIl+ihqOS4re+8jOWBnOatouaSreaUvlxuICAgIGlmICh0eXBlS2V5ID09PSAnYmdtdXJsJyAmJiBjdXJyZW50QmdtVXJsICYmICFuZXdVcmxMaXN0LmluY2x1ZGVzKGN1cnJlbnRCZ21VcmwpKSB7XG4gICAgICBjb25zdCBiZ21BdWRpbyA9ICQoJyNhdWRpb19iZ20nKVswXSBhcyBIVE1MQXVkaW9FbGVtZW50O1xuICAgICAgYmdtQXVkaW8ucGF1c2UoKTtcbiAgICAgIGJnbUVuZGVkID0gdHJ1ZTtcbiAgICB9IGVsc2UgaWYgKHR5cGVLZXkgPT09ICdhbWJpZW50dXJsJyAmJiBjdXJyZW50QW1iaWVudFVybCAmJiAhbmV3VXJsTGlzdC5pbmNsdWRlcyhjdXJyZW50QW1iaWVudFVybCkpIHtcbiAgICAgIGNvbnN0IGFtYmllbnRBdWRpbyA9ICQoJyNhdWRpb19hbWJpZW50JylbMF0gYXMgSFRNTEF1ZGlvRWxlbWVudDtcbiAgICAgIGFtYmllbnRBdWRpby5wYXVzZSgpO1xuICAgICAgYW1iaWVudEVuZGVkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICAvLyDmm7TmlrDlubbkv53lrZjmlrDnmoRVUkzliJfooahcbiAgICBjaGF0X21ldGFkYXRhLnZhcmlhYmxlc1t0eXBlS2V5XSA9IG5ld1VybExpc3Q7XG4gICAgc2F2ZU1ldGFkYXRhRGVib3VuY2VkKCk7XG4gICAgaWYgKHR5cGVLZXkgPT09ICdiZ211cmwnKSB7XG4gICAgICB1cGRhdGVBdWRpb1NlbGVjdCgnYmdtJyk7XG4gICAgfSBlbHNlIGlmICh0eXBlS2V5ID09PSAnYW1iaWVudHVybCcpIHtcbiAgICAgIHVwZGF0ZUF1ZGlvU2VsZWN0KCdhbWJpZW50Jyk7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICog54K55Ye76Z+z6aKR5oC75byA5YWz5pe255qE5aSE55CG5Ye95pWwXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUF1ZGlvVG9nZ2xlKGVuYWJsZTogYm9vbGVhbiA9IHRydWUsIHVzZXJJbnB1dDogYm9vbGVhbiA9IHRydWUpIHtcbiAgaWYgKHVzZXJJbnB1dCkge1xuICAgIGlzQXVkaW9FbmFibGVkID0gZW5hYmxlO1xuICAgIHNhdmVTZXR0aW5nVmFsdWUoJ2F1ZGlvLmF1ZGlvX2VuYWJsZWQnLCBpc0F1ZGlvRW5hYmxlZCk7XG4gIH1cblxuICBpZiAoZW5hYmxlKSB7XG4gICAgJCgnI2F1ZGlvLXBsYXllci1jb250ZW50JykucmVtb3ZlQ2xhc3MoJ2F1ZGlvLWRpc2FibGVkLW1hc2snKTtcbiAgICBpZiAoaXNFeHRlbnNpb25FbmFibGVkID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGlzRXh0ZW5zaW9uRW5hYmxlZCA9IGdldFNldHRpbmdWYWx1ZSgnZW5hYmxlZF9leHRlbnNpb24nKTtcbiAgICB9XG4gICAgaWYgKCFpc0V4dGVuc2lvbkVuYWJsZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdG9nZ2xlQXVkaW9Db250cm9scygnYmdtJywgJ2VuYWJsZScpO1xuICAgIHRvZ2dsZUF1ZGlvQ29udHJvbHMoJ2FtYmllbnQnLCAnZW5hYmxlJyk7XG4gICAgY29uc3QgYmdtVXJsID0gYXdhaXQgZ2V0QXVkaW9VcmwoJ2JnbScpO1xuICAgIGNvbnN0IGFtYmllbnRVcmwgPSBhd2FpdCBnZXRBdWRpb1VybCgnYW1iaWVudCcpO1xuICAgIGlmIChiZ21VcmwubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3QgYmdtQXVkaW9FbGVtZW50ID0gJCgnI2F1ZGlvX2JnbScpWzBdIGFzIEhUTUxBdWRpb0VsZW1lbnQ7XG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCBiZ21BdWRpb0VsZW1lbnQucGxheSgpO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdbQXVkaW9dIOaSreaUvumfs+S5kOWksei0pe+8muayoeacieaPkOS+m+acieaViOa6kCcpO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoYW1iaWVudFVybC5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCBhbWJpZW50QXVkaW9FbGVtZW50ID0gJCgnI2F1ZGlvX2FtYmllbnQnKVswXSBhcyBIVE1MQXVkaW9FbGVtZW50O1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgYW1iaWVudEF1ZGlvRWxlbWVudC5wbGF5KCk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1tBdWRpb10g5pKt5pS+6Z+z5pWI5aSx6LSl77ya5rKh5pyJ5o+Q5L6b5pyJ5pWI5rqQJyk7XG4gICAgICB9XG4gICAgfVxuICB9IGVsc2Uge1xuICAgICQoJyNhdWRpby1wbGF5ZXItY29udGVudCcpLmFkZENsYXNzKCdhdWRpby1kaXNhYmxlZC1tYXNrJyk7XG4gICAgKCQoJyNhdWRpb19iZ20nKVswXSBhcyBIVE1MQXVkaW9FbGVtZW50KS5wYXVzZSgpO1xuICAgICgkKCcjYXVkaW9fYW1iaWVudCcpWzBdIGFzIEhUTUxBdWRpb0VsZW1lbnQpLnBhdXNlKCk7XG4gICAgdG9nZ2xlQXVkaW9Db250cm9scygnYmdtJywgJ2Rpc2FibGUnKTtcbiAgICB0b2dnbGVBdWRpb0NvbnRyb2xzKCdhbWJpZW50JywgJ2Rpc2FibGUnKTtcbiAgfVxufVxuXG4vKipcbiAqIOaSreaUvumfs+mikVxuICogQHBhcmFtIHR5cGUg6Z+z6aKR57G75Z6LIFwiYmdtXCIg5oiWIFwiYW1iaWVudFwiXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwbGF5QXVkaW8odHlwZTogJ2JnbScgfCAnYW1iaWVudCcpIHtcbiAgaWYgKFxuICAgICFnZXRTZXR0aW5nVmFsdWUoJ2VuYWJsZWRfZXh0ZW5zaW9uJykgfHxcbiAgICAhZ2V0U2V0dGluZ1ZhbHVlKCdhdWRpby5hdWRpb19lbmFibGVkJykgfHxcbiAgICAhZ2V0U2V0dGluZ1ZhbHVlKGBhdWRpby4ke3R5cGV9X2VuYWJsZWRgKVxuICApIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCBhdWRpb0VsZW1lbnQgPSAkKGAjYXVkaW9fJHt0eXBlfWApWzBdIGFzIEhUTUxBdWRpb0VsZW1lbnQ7XG4gIGNvbnN0IHBsYXlQYXVzZUljb24gPSAkKGAjYXVkaW9fJHt0eXBlfV9wbGF5X3BhdXNlX2ljb25gKTtcblxuICBpZiAoYXVkaW9FbGVtZW50LmVycm9yICYmIGF1ZGlvRWxlbWVudC5lcnJvci5jb2RlID09PSA0KSB7XG4gICAgbG9nLndhcm4oYFRoZSAke3R5cGV9IGVsZW1lbnQgaGFzIG5vIHN1cHBvcnRlZCBzb3VyY2VzLiBUcnlpbmcgdG8gcmVsb2FkIHNlbGVjdGVkIGF1ZGlvIGZyb20gZHJvcGRvd24uLi5gKTtcblxuICAgIGNvbnN0IHNlbGVjdGVkQXVkaW8gPSAkKGAjYXVkaW9fJHt0eXBlfV9zZWxlY3RgKS52YWwoKSBhcyBzdHJpbmc7XG4gICAgaWYgKCFzZWxlY3RlZEF1ZGlvKSB7XG4gICAgICBsb2cuZXJyb3IoYE5vIGF1ZGlvIHNlbGVjdGVkIGZvciAke3R5cGV9YCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgYXVkaW9FbGVtZW50LnNyYyA9IHNlbGVjdGVkQXVkaW87XG4gICAgYXVkaW9FbGVtZW50LmxvYWQoKTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgYXdhaXQgYXVkaW9FbGVtZW50LnBsYXkoKTtcbiAgICBwbGF5UGF1c2VJY29uLnJlbW92ZUNsYXNzKCdmYS1wbGF5Jyk7XG4gICAgcGxheVBhdXNlSWNvbi5hZGRDbGFzcygnZmEtcGF1c2UnKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBsb2cuZXJyb3IoYFtBdWRpb10g5pKt5pS+ICR7dHlwZX0g6Z+z6aKR5pe25Ye66ZSZOmAsIGVycm9yKTtcbiAgfVxufVxuXG4vKipcbiAqIOeCueWHu+WQhOiHqumfs+mikeaooeW8j+aMiemSruaXtueahOmAmueUqOWkhOeQhuWHveaVsFxuICogQHBhcmFtIHR5cGUg6Z+z6aKR57G75Z6LIFwiYmdtXCIg5oiWIFwiYW1iaWVudFwiXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIG9uQXVkaW9Nb2RlQ2xpY2sodHlwZTogJ2JnbScgfCAnYW1iaWVudCcpIHtcbiAgY29uc3QgbW9kZXMgPSBbXG4gICAgeyBtb2RlOiAncmVwZWF0JywgaWNvbjogJ2ZhLXJlcGVhdCcgfSxcbiAgICB7IG1vZGU6ICdyYW5kb20nLCBpY29uOiAnZmEtcmFuZG9tJyB9LFxuICAgIHsgbW9kZTogJ3NpbmdsZScsIGljb246ICdmYS1yZWRvLWFsdCcgfSxcbiAgICB7IG1vZGU6ICdzdG9wJywgaWNvbjogJ2ZhLWNhbmNlbCcgfSxcbiAgXTtcblxuICBjb25zdCBjdXJyZW50TW9kZUluZGV4ID0gbW9kZXMuZmluZEluZGV4KG0gPT4gbS5tb2RlID09PSBnZXRTZXR0aW5nVmFsdWUoYGF1ZGlvLiR7dHlwZX1fbW9kZWApKTtcblxuICBjb25zdCBuZXh0TW9kZUluZGV4ID0gKGN1cnJlbnRNb2RlSW5kZXggKyAxKSAlIG1vZGVzLmxlbmd0aDtcblxuICBzYXZlU2V0dGluZ1ZhbHVlKGBhdWRpby4ke3R5cGV9X21vZGVgLCBtb2Rlc1tuZXh0TW9kZUluZGV4XS5tb2RlKTtcblxuICAkKGAjYXVkaW9fJHt0eXBlfV9tb2RlX2ljb25gKS5yZW1vdmVDbGFzcygnZmEtcmVwZWF0IGZhLXJhbmRvbSBmYS1yZWRvLWFsdCBmYS1jYW5jZWwnKTtcblxuICAkKGAjYXVkaW9fJHt0eXBlfV9tb2RlX2ljb25gKS5hZGRDbGFzcyhtb2Rlc1tuZXh0TW9kZUluZGV4XS5pY29uKTtcbn1cblxuLyoqXG4gKiDpn7PpopHpgInmi6nlj5jljJbml7bnmoTpgJrnlKjlpITnkIblh73mlbBcbiAqIEBwYXJhbSB0eXBlIOmfs+mikeexu+WeiyBcImJnbVwiIOaIliBcImFtYmllbnRcIlxuICovXG5hc3luYyBmdW5jdGlvbiBvbkF1ZGlvU2VsZWN0Q2hhbmdlKHR5cGU6ICdiZ20nIHwgJ2FtYmllbnQnKSB7XG4gIHNhdmVTZXR0aW5nVmFsdWUoYGF1ZGlvLiR7dHlwZX1fc2VsZWN0ZWRgLCAkKGAjYXVkaW9fJHt0eXBlfV9zZWxlY3RgKS52YWwoKSk7XG4gIGF3YWl0IHVwZGF0ZUF1ZGlvKHR5cGUsIHRydWUpO1xufVxuXG4vKipcbiAqIOi+k+WFpeWGt+WNtOaXtumXtOeahOWkhOeQhuWHveaVsFxuICogQHBhcmFtIHR5cGUg6Z+z6aKR57G75Z6LIFwiYmdtXCIg5oiWIFwiYW1iaWVudFwiXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIG9uQXVkaW9Db29sZG93bklucHV0KCkge1xuICBzYXZlU2V0dGluZ1ZhbHVlKCdhdWRpby5hdWRpb19jb29sZG93bicsIH5+KCQoYCNhdWRpb19jb29sZG93bmApLnZhbCgpIGFzIHN0cmluZykpO1xufVxuXG4vKipcbiAqIOmfs+mikemfs+mHj+WPmOWMluaXtueahOmAmueUqOWkhOeQhuWHveaVsFxuICogQHBhcmFtIHR5cGUg6Z+z6aKR57G75Z6LIFwiYmdtXCIg5oiWIFwiYW1iaWVudFwiXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIG9uQXVkaW9Wb2x1bWVDaGFuZ2UodHlwZTogJ2JnbScgfCAnYW1iaWVudCcpIHtcbiAgc2F2ZVNldHRpbmdWYWx1ZShgYXVkaW8uJHt0eXBlfV92b2x1bWVgLCB+figkKGAjYXVkaW9fJHt0eXBlfV92b2x1bWVfc2xpZGVyYCkudmFsKCkgYXMgc3RyaW5nKSk7XG4gICQoYCNhdWRpb18ke3R5cGV9YCkucHJvcCgndm9sdW1lJywgZ2V0U2V0dGluZ1ZhbHVlKGBhdWRpby4ke3R5cGV9X3ZvbHVtZWApICogMC4wMSk7XG4gICQoYCNhdWRpb18ke3R5cGV9X3ZvbHVtZWApLnRleHQoZ2V0U2V0dGluZ1ZhbHVlKGBhdWRpby4ke3R5cGV9X3ZvbHVtZWApKTtcbn1cblxuLyoqXG4gKiDngrnlh7vpn7PpopHpnZnpn7PmjInpkq7ml7bnmoTpgJrnlKjlpITnkIblh73mlbBcbiAqIEBwYXJhbSB0eXBlIOmfs+mikeexu+WeiyBcImJnbVwiIOaIliBcImFtYmllbnRcIlxuICovXG5hc3luYyBmdW5jdGlvbiBvbkF1ZGlvTXV0ZUNsaWNrKHR5cGU6ICdiZ20nIHwgJ2FtYmllbnQnKSB7XG4gIHNhdmVTZXR0aW5nVmFsdWUoYGF1ZGlvLiR7dHlwZX1fbXV0ZWRgLCAhZ2V0U2V0dGluZ1ZhbHVlKGBhdWRpby4ke3R5cGV9X211dGVkYCkpO1xuICAkKGAjYXVkaW9fJHt0eXBlfV9tdXRlX2ljb25gKS50b2dnbGVDbGFzcygnZmEtdm9sdW1lLWhpZ2gnKTtcbiAgJChgI2F1ZGlvXyR7dHlwZX1fbXV0ZV9pY29uYCkudG9nZ2xlQ2xhc3MoJ2ZhLXZvbHVtZS1tdXRlJyk7XG4gICQoYCNhdWRpb18ke3R5cGV9YCkucHJvcCgnbXV0ZWQnLCAhJChgI2F1ZGlvXyR7dHlwZX1gKS5wcm9wKCdtdXRlZCcpKTtcbiAgJChgI2F1ZGlvXyR7dHlwZX1fbXV0ZWApLnRvZ2dsZUNsYXNzKCdyZWRPdmVybGF5R2xvdycpO1xufVxuXG4vKipcbiAqIOWIh+aNouaSreaUvi/mmoLlgZznirbmgIFcbiAqIEBwYXJhbSB0eXBlIOmfs+mikeexu+WeiyBcImJnbVwiIOaIliBcImFtYmllbnRcIlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdG9nZ2xlUGxheVBhdXNlKHR5cGU6ICdiZ20nIHwgJ2FtYmllbnQnKSB7XG4gIGlmICghZ2V0U2V0dGluZ1ZhbHVlKCdhdWRpby5hdWRpb19lbmFibGVkJykpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCBhdWRpb0VsZW1lbnQgPSAkKGAjYXVkaW9fJHt0eXBlfWApWzBdIGFzIEhUTUxBdWRpb0VsZW1lbnQ7XG4gIGNvbnN0IHBsYXlQYXVzZUljb24gPSAkKGAjYXVkaW9fJHt0eXBlfV9wbGF5X3BhdXNlX2ljb25gKTtcblxuICBpZiAoYXVkaW9FbGVtZW50LnBhdXNlZCkge1xuICAgIGF3YWl0IHBsYXlBdWRpbyh0eXBlKTtcbiAgfSBlbHNlIHtcbiAgICBhdWRpb0VsZW1lbnQucGF1c2UoKTtcbiAgICBwbGF5UGF1c2VJY29uLnJlbW92ZUNsYXNzKCdmYS1wYXVzZScpO1xuICAgIHBsYXlQYXVzZUljb24uYWRkQ2xhc3MoJ2ZhLXBsYXknKTtcbiAgfVxufVxuXG4vKipcbiAqIOaJk+W8gFVSTOWvvOWFpeW8ueeql1xuICogQHBhcmFtIHR5cGUg6Z+z6aKR57G75Z6LXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIG9wZW5VcmxJbXBvcnRQb3B1cCgpOiBQcm9taXNlPHN0cmluZ1tdIHwgbnVsbD4ge1xuICBjb25zdCBpbnB1dCA9IChhd2FpdCBjYWxsR2VuZXJpY1BvcHVwKCfovpPlhaXopoHlr7zlhaXnmoTnvZHnu5zpn7PpopHpk77mjqXvvIjmr4/ooYzkuIDkuKrvvIknLCBQT1BVUF9UWVBFLklOUFVULCAnJykpIGFzIHN0cmluZyB8IG51bGw7XG5cbiAgaWYgKCFpbnB1dCkge1xuICAgIGxvZy5kZWJ1ZygnW0F1ZGlvXSBVUkwgaW1wb3J0IGNhbmNlbGxlZCcpO1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgY29uc3QgdXJsQXJyYXkgPSBpbnB1dFxuICAgIC50cmltKClcbiAgICAuc3BsaXQoJ1xcbicpXG4gICAgLm1hcCgodXJsOiBzdHJpbmcpID0+IHVybC50cmltKCkpXG4gICAgLmZpbHRlcigodXJsOiBzdHJpbmcpID0+IHVybCAhPT0gJycpO1xuXG4gIHJldHVybiBBcnJheS5mcm9tKG5ldyBTZXQodXJsQXJyYXkpKTtcbn1cblxuLy8g6IGK5aSp5pu05pS55pe255qE5LqL5Lu25aSE55CGXG5ldmVudFNvdXJjZS5vbihldmVudF90eXBlcy5DSEFUX0NIQU5HRUQsIGFzeW5jICgpID0+IHtcbiAgY29uc3QgJGJnbVBsYXllciA9ICQoJyNhdWRpb19iZ20nKVswXSBhcyBIVE1MQXVkaW9FbGVtZW50O1xuICBjb25zdCAkYW1iaWVudFBsYXllciA9ICQoJyNhdWRpb19hbWJpZW50JylbMF0gYXMgSFRNTEF1ZGlvRWxlbWVudDtcblxuICBpZiAoJGJnbVBsYXllciAmJiAhJGJnbVBsYXllci5wYXVzZWQpIHtcbiAgICAkYmdtUGxheWVyLnBhdXNlKCk7XG4gIH1cblxuICBpZiAoJGFtYmllbnRQbGF5ZXIgJiYgISRhbWJpZW50UGxheWVyLnBhdXNlZCkge1xuICAgICRhbWJpZW50UGxheWVyLnBhdXNlKCk7XG4gIH1cbiAgYXdhaXQgcmVmcmVzaEF1ZGlvUmVzb3VyY2VzKCk7XG4gIGxvZy5pbmZvKCdbQXVkaW9dIOiBiuWkqeW3suabtOaUue+8jOmfs+mikei1hOa6kOWIt+aWsOWujOaIkCcpO1xufSk7XG5cbi8qKiDliJ3lp4vljJbmoLflvI9cbiAqIEBwYXJhbSB0eXBlIOmfs+mikeexu+WeiyBcImJnbVwiIOaIliBcImFtYmllbnRcIlxuICovXG5mdW5jdGlvbiBpbml0QXVkaW9TdHlsZXModHlwZTogJ2JnbScgfCAnYW1iaWVudCcpIHtcbiAgLy8g6ZqQ6JeP6buY6K6k5pKt5pS+5Zmo5qC35byPXG4gICQoYCNhdWRpb18ke3R5cGV9YCkuaGlkZSgpO1xuXG4gIGlmIChnZXRTZXR0aW5nVmFsdWUoYGF1ZGlvLiR7dHlwZX1fbXV0ZWRgKSkge1xuICAgICQoYCNhdWRpb18ke3R5cGV9X211dGVfaWNvbmApLnJlbW92ZUNsYXNzKCdmYS12b2x1bWUtaGlnaCcpO1xuICAgICQoYCNhdWRpb18ke3R5cGV9X211dGVfaWNvbmApLmFkZENsYXNzKCdmYS12b2x1bWUtbXV0ZScpO1xuICAgICQoYCNhdWRpb18ke3R5cGV9X211dGVgKS5hZGRDbGFzcygncmVkT3ZlcmxheUdsb3cnKTtcbiAgICAkKGAjYXVkaW9fJHt0eXBlfWApLnByb3AoJ211dGVkJywgdHJ1ZSk7XG4gIH0gZWxzZSB7XG4gICAgJChgI2F1ZGlvXyR7dHlwZX1fbXV0ZV9pY29uYCkuYWRkQ2xhc3MoJ2ZhLXZvbHVtZS1oaWdoJyk7XG4gICAgJChgI2F1ZGlvXyR7dHlwZX1fbXV0ZV9pY29uYCkucmVtb3ZlQ2xhc3MoJ2ZhLXZvbHVtZS1tdXRlJyk7XG4gICAgJChgI2F1ZGlvXyR7dHlwZX1fbXV0ZWApLnJlbW92ZUNsYXNzKCdyZWRPdmVybGF5R2xvdycpO1xuICAgICQoYCNhdWRpb18ke3R5cGV9YCkucHJvcCgnbXV0ZWQnLCBmYWxzZSk7XG4gIH1cblxuICAkKGAjZW5hYmxlXyR7dHlwZX1gKS5wcm9wKCdjaGVja2VkJywgZ2V0U2V0dGluZ1ZhbHVlKGBhdWRpby4ke3R5cGV9X2VuYWJsZWRgKSk7XG5cbiAgY29uc3QgYXVkaW9FbGVtZW50ID0gJChgI2F1ZGlvXyR7dHlwZX1gKVswXSBhcyBIVE1MQXVkaW9FbGVtZW50O1xuICBjb25zdCBwbGF5UGF1c2VJY29uID0gJChgI2F1ZGlvXyR7dHlwZX1fcGxheV9wYXVzZV9pY29uYCk7XG5cbiAgaWYgKGF1ZGlvRWxlbWVudCAmJiBhdWRpb0VsZW1lbnQucGF1c2VkKSB7XG4gICAgcGxheVBhdXNlSWNvbi5yZW1vdmVDbGFzcygnZmEtcGF1c2UnKTtcbiAgICBwbGF5UGF1c2VJY29uLmFkZENsYXNzKCdmYS1wbGF5Jyk7XG4gIH0gZWxzZSBpZiAoYXVkaW9FbGVtZW50ICYmICFhdWRpb0VsZW1lbnQucGF1c2VkKSB7XG4gICAgcGxheVBhdXNlSWNvbi5yZW1vdmVDbGFzcygnZmEtcGxheScpO1xuICAgIHBsYXlQYXVzZUljb24uYWRkQ2xhc3MoJ2ZhLXBhdXNlJyk7XG4gIH1cbiAgdXBkYXRlQXVkaW9TZWxlY3QodHlwZSk7XG4gIGluaXRpYWxpemVQcm9ncmVzc0Jhcih0eXBlKTtcbn1cblxuLyoqXG4gKiDliJ3lp4vljJbmiYDmnInpn7PpopHnm7jlhbPnu4Tku7blkozkuovku7bnm5HlkKzlmahcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGluaXRBdWRpb0NvbXBvbmVudHMoKSB7XG4gIC8vIOWKoOi9vemfs+mikeaSreaUvuWZqOagt+W8j1xuICBhd2FpdCBsb2FkRmlsZVRvRG9jdW1lbnQoYC9zY3JpcHRzL2V4dGVuc2lvbnMvJHtleHRlbnNpb25Gb2xkZXJQYXRofS9zcmMvY29tcG9uZW50L2F1ZGlvL3N0eWxlLmNzc2AsICdjc3MnKTtcblxuICBpc0F1ZGlvRW5hYmxlZCA9IGdldFNldHRpbmdWYWx1ZSgnYXVkaW8uYXVkaW9fZW5hYmxlZCcpO1xuICBoYW5kbGVBdWRpb1RvZ2dsZShpc0F1ZGlvRW5hYmxlZCwgZmFsc2UpO1xuICAkKCcjYXVkaW8tZW5hYmxlLXRvZ2dsZScpXG4gICAgLnByb3AoJ2NoZWNrZWQnLCBpc0F1ZGlvRW5hYmxlZClcbiAgICAub24oJ2NsaWNrJywgKGV2ZW50OiBKUXVlcnkuQ2xpY2tFdmVudCkgPT4gaGFuZGxlQXVkaW9Ub2dnbGUoZXZlbnQudGFyZ2V0LmNoZWNrZWQsIHRydWUpKTtcblxuICAvLyDliJ3lp4vljJbmipjlj6Dmjqfku7ZcbiAgQ29sbGFwc2libGUuaW5pdEFsbCgnI2F1ZGlvLXBsYXllci1oZWFkZXInLCB7XG4gICAgaGVhZGVyU2VsZWN0b3I6ICcjYXVkaW8tcGxheWVyLWhlYWRlcicsXG4gICAgY29udGVudFNlbGVjdG9yOiAnI2F1ZGlvLXBsYXllci1jb250ZW50JyxcbiAgICBpbml0aWFsbHlFeHBhbmRlZDogdHJ1ZSxcbiAgICBhbmltYXRpb25EdXJhdGlvbjoge1xuICAgICAgZXhwYW5kOiAyODAsXG4gICAgICBjb2xsYXBzZTogMjUwLFxuICAgIH0sXG4gIH0pO1xuXG4gIC8vIOWIneWni+WMlumfs+S5kOWSjOmfs+aViOagt+W8j1xuICBpbml0QXVkaW9TdHlsZXMoJ2JnbScpO1xuICBpbml0QXVkaW9TdHlsZXMoJ2FtYmllbnQnKTtcblxuICBjb25zdCBhdWRpb1R5cGVzID0gWydiZ20nLCAnYW1iaWVudCddIGFzIGNvbnN0O1xuXG4gIGNvbnN0IGJpbmRUeXBlRXZlbnRzID0gKFxuICAgIHR5cGU6ICdiZ20nIHwgJ2FtYmllbnQnLFxuICAgIGV2ZW50czogQXJyYXk8e1xuICAgICAgc2VsZWN0b3I6IHN0cmluZztcbiAgICAgIGV2ZW50OiBzdHJpbmc7XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tc2hhZG93XG4gICAgICBoYW5kbGVyOiAodHlwZTogJ2JnbScgfCAnYW1iaWVudCcpID0+IHZvaWQ7XG4gICAgfT4sXG4gICkgPT4ge1xuICAgIGV2ZW50cy5mb3JFYWNoKCh7IHNlbGVjdG9yLCBldmVudCwgaGFuZGxlciB9KSA9PiB7XG4gICAgICAkKGAjJHtzZWxlY3Rvcn1gKS5vbihldmVudCwgKCkgPT4gaGFuZGxlcih0eXBlKSk7XG4gICAgfSk7XG4gIH07XG5cbiAgYXVkaW9UeXBlcy5mb3JFYWNoKHR5cGUgPT4ge1xuICAgICQoYCNlbmFibGVfJHt0eXBlfWApLm9uKCdjbGljaycsICgpID0+IG9uQXVkaW9FbmFibGVkQ2xpY2sodHlwZSkpO1xuXG4gICAgYmluZFR5cGVFdmVudHModHlwZSwgW1xuICAgICAge1xuICAgICAgICBzZWxlY3RvcjogYGVuYWJsZV8ke3R5cGV9YCxcbiAgICAgICAgZXZlbnQ6ICdjbGljaycsXG4gICAgICAgIGhhbmRsZXI6IG9uQXVkaW9FbmFibGVkQ2xpY2ssXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBzZWxlY3RvcjogYGF1ZGlvXyR7dHlwZX1fbW9kZWAsXG4gICAgICAgIGV2ZW50OiAnY2xpY2snLFxuICAgICAgICBoYW5kbGVyOiBvbkF1ZGlvTW9kZUNsaWNrLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgc2VsZWN0b3I6IGBhdWRpb18ke3R5cGV9X211dGVgLFxuICAgICAgICBldmVudDogJ2NsaWNrJyxcbiAgICAgICAgaGFuZGxlcjogb25BdWRpb011dGVDbGljayxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIHNlbGVjdG9yOiBgYXVkaW9fJHt0eXBlfV92b2x1bWVfc2xpZGVyYCxcbiAgICAgICAgZXZlbnQ6ICdpbnB1dCcsXG4gICAgICAgIGhhbmRsZXI6IG9uQXVkaW9Wb2x1bWVDaGFuZ2UsXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBzZWxlY3RvcjogYGF1ZGlvXyR7dHlwZX1fc2VsZWN0YCxcbiAgICAgICAgZXZlbnQ6ICdjaGFuZ2UnLFxuICAgICAgICBoYW5kbGVyOiBvbkF1ZGlvU2VsZWN0Q2hhbmdlLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgc2VsZWN0b3I6IGBhdWRpb18ke3R5cGV9X3BsYXlfcGF1c2VgLFxuICAgICAgICBldmVudDogJ2NsaWNrJyxcbiAgICAgICAgaGFuZGxlcjogdG9nZ2xlUGxheVBhdXNlLFxuICAgICAgfSxcbiAgICBdKTtcblxuICAgICQoJyNhdWRpb19jb29sZG93bicpLm9uKCdpbnB1dCcsIG9uQXVkaW9Db29sZG93bklucHV0KS52YWwoZ2V0U2V0dGluZ1ZhbHVlKCdhdWRpby5hdWRpb19jb29sZG93bicpKTtcblxuICAgIC8vIOebkeWQrOmfs+mikee7k+adn+S6i+S7tlxuICAgIGluaXRBdWRpb0V2ZW50TGlzdGVuZXJzKCdiZ20nKTtcbiAgICBpbml0QXVkaW9FdmVudExpc3RlbmVycygnYW1iaWVudCcpO1xuXG4gICAgY29uc3Qgdm9sdW1lU2xpZGVyID0gJChgI2F1ZGlvXyR7dHlwZX1fdm9sdW1lX3NsaWRlcmApLmdldCgwKTtcbiAgICBpZiAodm9sdW1lU2xpZGVyKSB7XG4gICAgICB2b2x1bWVTbGlkZXIuYWRkRXZlbnRMaXN0ZW5lcignd2hlZWwnLCBvblZvbHVtZVNsaWRlcldoZWVsRXZlbnQsIHtcbiAgICAgICAgcGFzc2l2ZTogZmFsc2UsXG4gICAgICB9KTtcbiAgICB9XG4gIH0pO1xuXG4gICQoJyNhdWRpb19yZWZyZXNoX2Fzc2V0cycpLm9uKCdjbGljaycsIGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCByZWZyZXNoQXVkaW9SZXNvdXJjZXMoKTtcbiAgfSk7XG5cbiAgaGFuZGxlTG9uZ1ByZXNzKCdiZ20tdm9sdW1lLWNvbnRyb2wnLCAnYXVkaW9fYmdtX211dGVfaWNvbicpO1xuICBoYW5kbGVMb25nUHJlc3MoJ2FtYmllbnQtdm9sdW1lLWNvbnRyb2wnLCAnYXVkaW9fYW1iaWVudF9tdXRlX2ljb24nKTtcblxuICBjb25zdCB1cmxNYW5hZ2VyTWFwID0ge1xuICAgIGJnbTogJ2JnbXVybCcsXG4gICAgYW1iaWVudDogJ2FtYmllbnR1cmwnLFxuICB9O1xuXG4gIGF1ZGlvVHlwZXMuZm9yRWFjaCh0eXBlID0+IHtcbiAgICAkKGAjJHt0eXBlfV9tYW5hZ2VyX2J1dHRvbmApLm9uKCdjbGljaycsIGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IG9wZW5VcmxNYW5hZ2VyUG9wdXAodXJsTWFuYWdlck1hcFt0eXBlXSBhcyAnYmdtdXJsJyB8ICdhbWJpZW50dXJsJyk7XG4gICAgICBhd2FpdCByZWZyZXNoQXVkaW9SZXNvdXJjZXMoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgY29uc3QgYmdtQXVkaW8gPSAkKCcjYXVkaW9fYmdtJylbMF0gYXMgSFRNTEF1ZGlvRWxlbWVudDtcbiAgY29uc3QgYW1iaWVudEF1ZGlvID0gJCgnI2F1ZGlvX2FtYmllbnQnKVswXSBhcyBIVE1MQXVkaW9FbGVtZW50O1xuXG4gIGNvbnN0IHRvZ2dsZVBsYXlQYXVzZUljb24gPSAoYXVkaW9FbGVtZW50OiBIVE1MQXVkaW9FbGVtZW50LCBpY29uU2VsZWN0b3I6IHN0cmluZykgPT4ge1xuICAgIGNvbnN0IGljb24gPSAkKGljb25TZWxlY3Rvcik7XG4gICAgYXVkaW9FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3BsYXknLCAoKSA9PiBpY29uLnJlbW92ZUNsYXNzKCdmYS1wbGF5JykuYWRkQ2xhc3MoJ2ZhLXBhdXNlJykpO1xuICAgIGF1ZGlvRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdwYXVzZScsICgpID0+IGljb24ucmVtb3ZlQ2xhc3MoJ2ZhLXBhdXNlJykuYWRkQ2xhc3MoJ2ZhLXBsYXknKSk7XG4gIH07XG5cbiAgdG9nZ2xlUGxheVBhdXNlSWNvbihiZ21BdWRpbywgJyNhdWRpb19iZ21fcGxheV9wYXVzZV9pY29uJyk7XG4gIHRvZ2dsZVBsYXlQYXVzZUljb24oYW1iaWVudEF1ZGlvLCAnI2F1ZGlvX2FtYmllbnRfcGxheV9wYXVzZV9pY29uJyk7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/component/audio/index.ts\n")},"./src/component/listener/index.ts":
/*!*****************************************!*\
  !*** ./src/component/listener/index.ts ***!
  \*****************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   initListener: () => (/* binding */ initListener)\n/* harmony export */ });\n/* harmony import */ var _component_script_repository_index__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/script_repository/index */ \"./src/component/script_repository/index.ts\");\n/* harmony import */ var _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/component/script_repository/script_controller */ \"./src/component/script_repository/script_controller.ts\");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var socket_io_client__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! socket.io-client */ \"./node_modules/.pnpm/socket.io-client@4.8.1/node_modules/socket.io-client/build/esm/index.js\");\n\n\n\n\n\n\n\nconst templatePath = `${_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.extensionFolderPath}/src/component/listener`;\nconst default_settings = {\n    enabled: false,\n    url: 'http://localhost:6621',\n    duration: 1000,\n    enable_echo: true,\n};\nlet socket;\nlet refresh_iframe_debounced;\nfunction reset_refresh_duration() {\n    refresh_iframe_debounced = _.debounce(refresh_iframe, (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getSettingValue)('listener.duration'));\n}\nasync function refresh_iframe() {\n    loglevel__WEBPACK_IMPORTED_MODULE_5___default().info(`[Listener] 已将 iframe 刷新为最新版本`);\n    // @ts-expect-error\n    const character = _sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.this_chid];\n    if (character) {\n        await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.saveChatConditional)();\n    }\n    const scriptManager = _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_1__.ScriptManager.getInstance();\n    const globalScripts = scriptManager.getGlobalScripts();\n    await scriptManager.stopScriptsByType(globalScripts, _component_script_repository_index__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL);\n    await scriptManager.runScriptsByType(globalScripts, _component_script_repository_index__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL);\n    await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.reloadCurrentChat)();\n}\nfunction toggle_status(should_enable) {\n    if (should_enable) {\n        $('#online_status_indicator').addClass('success');\n    }\n    else {\n        $('#online_status_indicator').removeClass('success');\n    }\n}\nfunction connect_socket(url) {\n    if (socket) {\n        toggle_status(false);\n        socket.close();\n    }\n    if (!(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getSettingValue)('listener.enabled') || !(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getSettingValue)('listener.url')) {\n        return;\n    }\n    socket = (0,socket_io_client__WEBPACK_IMPORTED_MODULE_6__.io)(url);\n    socket.on('connect_error', (error) => {\n        toggle_status(false);\n        if (socket.active) {\n            if ((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getSettingValue)('listener.enable_echo')) {\n                toastr.error(`连接酒馆助手实时监听功能出错, 尝试重连...\\n${error.name}: ${error.message}`);\n            }\n            loglevel__WEBPACK_IMPORTED_MODULE_5___default().error(`${error.name}: ${error.message}${error.stack ?? ''}`);\n        }\n        else {\n            if ((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getSettingValue)('listener.enable_echo')) {\n                toastr.error(`连接酒馆助手实时监听功能出错, 请手动连接重试!\\n${error.name}: ${error.message}`);\n            }\n            loglevel__WEBPACK_IMPORTED_MODULE_5___default().error(`${error.name}: ${error.message}${error.stack ?? ''}`);\n        }\n    });\n    socket.on('connect', () => {\n        toggle_status(true);\n        loglevel__WEBPACK_IMPORTED_MODULE_5___default().info('[Listener] 成功连接至服务器');\n    });\n    socket.on('iframe_updated', () => {\n        refresh_iframe_debounced();\n    });\n    socket.on('disconnect', (reason, details) => {\n        if ((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getSettingValue)('listener.enable_echo')) {\n            toastr.warning(`酒馆助手实时监听器断开连接: ${reason}`);\n        }\n        toggle_status(false);\n        loglevel__WEBPACK_IMPORTED_MODULE_5___default().info(`[Listener] 与服务器断开连接: ${reason}\\n${details}`);\n    });\n}\n/**\n * 初始化实时监听\n */\nasync function initListener() {\n    const $listener_container = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_4__.renderExtensionTemplateAsync)(`${templatePath}`, 'index'));\n    $listener_container\n        .find('#iframe_update_listener_enabled')\n        .prop('checked', await (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getOrSaveSettingValue)('listener.enabled', default_settings.enabled))\n        .on('click', async function () {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.saveSettingValue)('listener.enabled', $(this).prop('checked'));\n        connect_socket((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getSettingValue)('listener.url'));\n    });\n    $listener_container\n        .find('#iframe_update_listener_enable_echo')\n        .prop('checked', await (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getOrSaveSettingValue)('listener.enable_echo', default_settings.enable_echo))\n        .on('click', function () {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.saveSettingValue)('listener.enable_echo', $(this).prop('checked'));\n    });\n    $listener_container\n        .find('#iframe_update_listener_url')\n        .val(await (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getOrSaveSettingValue)('listener.url', default_settings.url))\n        .on('input', async function () {\n        const url = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.saveSettingValue)('listener.url', String($(this).val()));\n        connect_socket(url);\n    });\n    $listener_container\n        .find('#iframe_update_listener_duration')\n        .val(await (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getOrSaveSettingValue)('listener.duration', default_settings.duration))\n        .on('input', async function () {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.saveSettingValue)('listener.duration', Number($(this).val()));\n        reset_refresh_duration();\n    });\n    $('#extension-listener').append($listener_container);\n    reset_refresh_duration();\n    connect_socket((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_2__.getSettingValue)('listener.url'));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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USxDQUFDLENBQUM7U0FDaEYsRUFBRSxDQUFDLE9BQU8sRUFBRSxLQUFLO1FBQ2hCLDJFQUFnQixDQUFDLG1CQUFtQixFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBQzdELHNCQUFzQixFQUFFLENBQUM7SUFDM0IsQ0FBQyxDQUFDLENBQUM7SUFFTCxDQUFDLENBQUMscUJBQXFCLENBQUMsQ0FBQyxNQUFNLENBQUMsbUJBQW1CLENBQUMsQ0FBQztJQUVyRCxzQkFBc0IsRUFBRSxDQUFDO0lBQ3pCLGNBQWMsQ0FBQywwRUFBZSxDQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUM7QUFDbEQsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9jb21wb25lbnQvbGlzdGVuZXIvaW5kZXgudHM/Y2Y1NCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBTY3JpcHRUeXBlIH0gZnJvbSAnQC9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvaW5kZXgnO1xuaW1wb3J0IHsgU2NyaXB0TWFuYWdlciB9IGZyb20gJ0AvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3NjcmlwdF9jb250cm9sbGVyJztcbmltcG9ydCB7XG4gIGV4dGVuc2lvbkZvbGRlclBhdGgsXG4gIGdldE9yU2F2ZVNldHRpbmdWYWx1ZSxcbiAgZ2V0U2V0dGluZ1ZhbHVlLFxuICBzYXZlU2V0dGluZ1ZhbHVlLFxufSBmcm9tICdAL3V0aWwvZXh0ZW5zaW9uX3ZhcmlhYmxlcyc7XG5cbmltcG9ydCB7IGNoYXJhY3RlcnMsIHJlbG9hZEN1cnJlbnRDaGF0LCBzYXZlQ2hhdENvbmRpdGlvbmFsLCB0aGlzX2NoaWQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0JztcbmltcG9ydCB7IHJlbmRlckV4dGVuc2lvblRlbXBsYXRlQXN5bmMgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9leHRlbnNpb25zJztcblxuaW1wb3J0IGxvZyBmcm9tICdsb2dsZXZlbCc7XG5pbXBvcnQgeyBpbyB9IGZyb20gJ3NvY2tldC5pby1jbGllbnQnO1xuXG5jb25zdCB0ZW1wbGF0ZVBhdGggPSBgJHtleHRlbnNpb25Gb2xkZXJQYXRofS9zcmMvY29tcG9uZW50L2xpc3RlbmVyYDtcbmNvbnN0IGRlZmF1bHRfc2V0dGluZ3MgPSB7XG4gIGVuYWJsZWQ6IGZhbHNlLFxuICB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjY2MjEnLFxuICBkdXJhdGlvbjogMTAwMCxcbiAgZW5hYmxlX2VjaG86IHRydWUsXG59IGFzIGNvbnN0O1xuXG5sZXQgc29ja2V0OiBSZXR1cm5UeXBlPHR5cGVvZiBpbz47XG5cbmxldCByZWZyZXNoX2lmcmFtZV9kZWJvdW5jZWQ6IF8uRGVib3VuY2VkRnVuYzwoKSA9PiBQcm9taXNlPHZvaWQ+PjtcbmZ1bmN0aW9uIHJlc2V0X3JlZnJlc2hfZHVyYXRpb24oKSB7XG4gIHJlZnJlc2hfaWZyYW1lX2RlYm91bmNlZCA9IF8uZGVib3VuY2UocmVmcmVzaF9pZnJhbWUsIGdldFNldHRpbmdWYWx1ZSgnbGlzdGVuZXIuZHVyYXRpb24nKSk7XG59XG5hc3luYyBmdW5jdGlvbiByZWZyZXNoX2lmcmFtZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgbG9nLmluZm8oYFtMaXN0ZW5lcl0g5bey5bCGIGlmcmFtZSDliLfmlrDkuLrmnIDmlrDniYjmnKxgKTtcblxuICAvLyBAdHMtZXhwZWN0LWVycm9yXG4gIGNvbnN0IGNoYXJhY3RlciA9IGNoYXJhY3RlcnNbdGhpc19jaGlkXTtcbiAgaWYgKGNoYXJhY3Rlcikge1xuICAgIGF3YWl0IHNhdmVDaGF0Q29uZGl0aW9uYWwoKTtcbiAgfVxuXG4gIGNvbnN0IHNjcmlwdE1hbmFnZXIgPSBTY3JpcHRNYW5hZ2VyLmdldEluc3RhbmNlKCk7XG4gIGNvbnN0IGdsb2JhbFNjcmlwdHMgPSBzY3JpcHRNYW5hZ2VyLmdldEdsb2JhbFNjcmlwdHMoKTtcblxuICBhd2FpdCBzY3JpcHRNYW5hZ2VyLnN0b3BTY3JpcHRzQnlUeXBlKGdsb2JhbFNjcmlwdHMsIFNjcmlwdFR5cGUuR0xPQkFMKTtcbiAgYXdhaXQgc2NyaXB0TWFuYWdlci5ydW5TY3JpcHRzQnlUeXBlKGdsb2JhbFNjcmlwdHMsIFNjcmlwdFR5cGUuR0xPQkFMKTtcbiAgYXdhaXQgcmVsb2FkQ3VycmVudENoYXQoKTtcbn1cblxuZnVuY3Rpb24gdG9nZ2xlX3N0YXR1cyhzaG91bGRfZW5hYmxlOiBib29sZWFuKSB7XG4gIGlmIChzaG91bGRfZW5hYmxlKSB7XG4gICAgJCgnI29ubGluZV9zdGF0dXNfaW5kaWNhdG9yJykuYWRkQ2xhc3MoJ3N1Y2Nlc3MnKTtcbiAgfSBlbHNlIHtcbiAgICAkKCcjb25saW5lX3N0YXR1c19pbmRpY2F0b3InKS5yZW1vdmVDbGFzcygnc3VjY2VzcycpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGNvbm5lY3Rfc29ja2V0KHVybDogc3RyaW5nKTogdm9pZCB7XG4gIGlmIChzb2NrZXQpIHtcbiAgICB0b2dnbGVfc3RhdHVzKGZhbHNlKTtcbiAgICBzb2NrZXQuY2xvc2UoKTtcbiAgfVxuICBpZiAoIWdldFNldHRpbmdWYWx1ZSgnbGlzdGVuZXIuZW5hYmxlZCcpIHx8ICFnZXRTZXR0aW5nVmFsdWUoJ2xpc3RlbmVyLnVybCcpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgc29ja2V0ID0gaW8odXJsKTtcblxuICBzb2NrZXQub24oJ2Nvbm5lY3RfZXJyb3InLCAoZXJyb3I6IEVycm9yKSA9PiB7XG4gICAgdG9nZ2xlX3N0YXR1cyhmYWxzZSk7XG4gICAgaWYgKHNvY2tldC5hY3RpdmUpIHtcbiAgICAgIGlmIChnZXRTZXR0aW5nVmFsdWUoJ2xpc3RlbmVyLmVuYWJsZV9lY2hvJykpIHtcbiAgICAgICAgdG9hc3RyLmVycm9yKGDov57mjqXphZLppobliqnmiYvlrp7ml7bnm5HlkKzlip/og73lh7rplJksIOWwneivlemHjei/ni4uLlxcbiR7ZXJyb3IubmFtZX06ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgIH1cbiAgICAgIGxvZy5lcnJvcihgJHtlcnJvci5uYW1lfTogJHtlcnJvci5tZXNzYWdlfSR7ZXJyb3Iuc3RhY2sgPz8gJyd9YCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChnZXRTZXR0aW5nVmFsdWUoJ2xpc3RlbmVyLmVuYWJsZV9lY2hvJykpIHtcbiAgICAgICAgdG9hc3RyLmVycm9yKGDov57mjqXphZLppobliqnmiYvlrp7ml7bnm5HlkKzlip/og73lh7rplJksIOivt+aJi+WKqOi/nuaOpemHjeivlSFcXG4ke2Vycm9yLm5hbWV9OiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgICB9XG4gICAgICBsb2cuZXJyb3IoYCR7ZXJyb3IubmFtZX06ICR7ZXJyb3IubWVzc2FnZX0ke2Vycm9yLnN0YWNrID8/ICcnfWApO1xuICAgIH1cbiAgfSk7XG5cbiAgc29ja2V0Lm9uKCdjb25uZWN0JywgKCkgPT4ge1xuICAgIHRvZ2dsZV9zdGF0dXModHJ1ZSk7XG4gICAgbG9nLmluZm8oJ1tMaXN0ZW5lcl0g5oiQ5Yqf6L+e5o6l6Iez5pyN5Yqh5ZmoJyk7XG4gIH0pO1xuXG4gIHNvY2tldC5vbignaWZyYW1lX3VwZGF0ZWQnLCAoKSA9PiB7XG4gICAgcmVmcmVzaF9pZnJhbWVfZGVib3VuY2VkKCk7XG4gIH0pO1xuXG4gIHNvY2tldC5vbignZGlzY29ubmVjdCcsIChyZWFzb24sIGRldGFpbHMpID0+IHtcbiAgICBpZiAoZ2V0U2V0dGluZ1ZhbHVlKCdsaXN0ZW5lci5lbmFibGVfZWNobycpKSB7XG4gICAgICB0b2FzdHIud2FybmluZyhg6YWS6aaG5Yqp5omL5a6e5pe255uR5ZCs5Zmo5pat5byA6L+e5o6lOiAke3JlYXNvbn1gKTtcbiAgICB9XG4gICAgdG9nZ2xlX3N0YXR1cyhmYWxzZSk7XG4gICAgbG9nLmluZm8oYFtMaXN0ZW5lcl0g5LiO5pyN5Yqh5Zmo5pat5byA6L+e5o6lOiAke3JlYXNvbn1cXG4ke2RldGFpbHN9YCk7XG4gIH0pO1xufVxuXG4vKipcbiAqIOWIneWni+WMluWunuaXtuebkeWQrFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaW5pdExpc3RlbmVyKCkge1xuICBjb25zdCAkbGlzdGVuZXJfY29udGFpbmVyID0gJChhd2FpdCByZW5kZXJFeHRlbnNpb25UZW1wbGF0ZUFzeW5jKGAke3RlbXBsYXRlUGF0aH1gLCAnaW5kZXgnKSk7XG5cbiAgJGxpc3RlbmVyX2NvbnRhaW5lclxuICAgIC5maW5kKCcjaWZyYW1lX3VwZGF0ZV9saXN0ZW5lcl9lbmFibGVkJylcbiAgICAucHJvcCgnY2hlY2tlZCcsIGF3YWl0IGdldE9yU2F2ZVNldHRpbmdWYWx1ZSgnbGlzdGVuZXIuZW5hYmxlZCcsIGRlZmF1bHRfc2V0dGluZ3MuZW5hYmxlZCkpXG4gICAgLm9uKCdjbGljaycsIGFzeW5jIGZ1bmN0aW9uICh0aGlzOiBIVE1MSW5wdXRFbGVtZW50KSB7XG4gICAgICBzYXZlU2V0dGluZ1ZhbHVlKCdsaXN0ZW5lci5lbmFibGVkJywgJCh0aGlzKS5wcm9wKCdjaGVja2VkJykpO1xuICAgICAgY29ubmVjdF9zb2NrZXQoZ2V0U2V0dGluZ1ZhbHVlKCdsaXN0ZW5lci51cmwnKSk7XG4gICAgfSk7XG5cbiAgJGxpc3RlbmVyX2NvbnRhaW5lclxuICAgIC5maW5kKCcjaWZyYW1lX3VwZGF0ZV9saXN0ZW5lcl9lbmFibGVfZWNobycpXG4gICAgLnByb3AoJ2NoZWNrZWQnLCBhd2FpdCBnZXRPclNhdmVTZXR0aW5nVmFsdWUoJ2xpc3RlbmVyLmVuYWJsZV9lY2hvJywgZGVmYXVsdF9zZXR0aW5ncy5lbmFibGVfZWNobykpXG4gICAgLm9uKCdjbGljaycsIGZ1bmN0aW9uICh0aGlzOiBIVE1MSW5wdXRFbGVtZW50KSB7XG4gICAgICBzYXZlU2V0dGluZ1ZhbHVlKCdsaXN0ZW5lci5lbmFibGVfZWNobycsICQodGhpcykucHJvcCgnY2hlY2tlZCcpKTtcbiAgICB9KTtcblxuICAkbGlzdGVuZXJfY29udGFpbmVyXG4gICAgLmZpbmQoJyNpZnJhbWVfdXBkYXRlX2xpc3RlbmVyX3VybCcpXG4gICAgLnZhbChhd2FpdCBnZXRPclNhdmVTZXR0aW5nVmFsdWUoJ2xpc3RlbmVyLnVybCcsIGRlZmF1bHRfc2V0dGluZ3MudXJsKSlcbiAgICAub24oJ2lucHV0JywgYXN5bmMgZnVuY3Rpb24gKHRoaXM6IEhUTUxJbnB1dEVsZW1lbnQpIHtcbiAgICAgIGNvbnN0IHVybCA9IHNhdmVTZXR0aW5nVmFsdWUoJ2xpc3RlbmVyLnVybCcsIFN0cmluZygkKHRoaXMpLnZhbCgpKSk7XG4gICAgICBjb25uZWN0X3NvY2tldCh1cmwpO1xuICAgIH0pO1xuXG4gICRsaXN0ZW5lcl9jb250YWluZXJcbiAgICAuZmluZCgnI2lmcmFtZV91cGRhdGVfbGlzdGVuZXJfZHVyYXRpb24nKVxuICAgIC52YWwoYXdhaXQgZ2V0T3JTYXZlU2V0dGluZ1ZhbHVlKCdsaXN0ZW5lci5kdXJhdGlvbicsIGRlZmF1bHRfc2V0dGluZ3MuZHVyYXRpb24pKVxuICAgIC5vbignaW5wdXQnLCBhc3luYyBmdW5jdGlvbiAodGhpczogSFRNTElucHV0RWxlbWVudCkge1xuICAgICAgc2F2ZVNldHRpbmdWYWx1ZSgnbGlzdGVuZXIuZHVyYXRpb24nLCBOdW1iZXIoJCh0aGlzKS52YWwoKSkpO1xuICAgICAgcmVzZXRfcmVmcmVzaF9kdXJhdGlvbigpO1xuICAgIH0pO1xuXG4gICQoJyNleHRlbnNpb24tbGlzdGVuZXInKS5hcHBlbmQoJGxpc3RlbmVyX2NvbnRhaW5lcik7XG5cbiAgcmVzZXRfcmVmcmVzaF9kdXJhdGlvbigpO1xuICBjb25uZWN0X3NvY2tldChnZXRTZXR0aW5nVmFsdWUoJ2xpc3RlbmVyLnVybCcpKTtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/component/listener/index.ts\n")},"./src/component/macro.ts":
/*!********************************!*\
  !*** ./src/component/macro.ts ***!
  \********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   registerAllMacros: () => (/* binding */ registerAllMacros),\n/* harmony export */   registerMacro: () => (/* binding */ registerMacro),\n/* harmony export */   unregisterAllMacros: () => (/* binding */ unregisterAllMacros),\n/* harmony export */   unregisterMacro: () => (/* binding */ unregisterMacro)\n/* harmony export */ });\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/util/extension_variables */ "./src/util/extension_variables.ts");\n/* harmony import */ var _sillytavern_scripts_macros__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/macros */ "@sillytavern/scripts/macros");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! loglevel */ "./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\nconst predefinedMacros = new Map([\n    [\'userAvatarPath\', _util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.getUserAvatarPath],\n    [\'charAvatarPath\', _util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.getCharAvatarPath],\n]);\n/**\n * 注册一个宏\n * @param {string} key - 宏的名称\n * @param {MacroFunction|string} value - 字符串或返回字符串的函数\n */\nfunction registerMacro(key, value) {\n    _sillytavern_scripts_macros__WEBPACK_IMPORTED_MODULE_1__.MacrosParser.registerMacro(key, value);\n    loglevel__WEBPACK_IMPORTED_MODULE_2___default().info(`[Macro] 宏 "${key}" 注册成功`);\n}\n/**\n * 注册所有预定义的宏\n */\nfunction registerAllMacros() {\n    for (const [key, value] of predefinedMacros.entries()) {\n        _sillytavern_scripts_macros__WEBPACK_IMPORTED_MODULE_1__.MacrosParser.registerMacro(key, value);\n        loglevel__WEBPACK_IMPORTED_MODULE_2___default().info(`[Macro] 宏 "${key}" 注册成功`);\n    }\n}\n/**\n * 注销指定的宏\n * @param {string} key - 要注销的宏名称\n */\nfunction unregisterMacro(key) {\n    _sillytavern_scripts_macros__WEBPACK_IMPORTED_MODULE_1__.MacrosParser.unregisterMacro(key);\n    loglevel__WEBPACK_IMPORTED_MODULE_2___default().info(`[Macro] 宏 "${key}" 注销成功`);\n}\n/**\n * 注销所有预定义的宏\n */\nfunction unregisterAllMacros() {\n    for (const key of predefinedMacros.keys()) {\n        _sillytavern_scripts_macros__WEBPACK_IMPORTED_MODULE_1__.MacrosParser.unregisterMacro(key);\n        loglevel__WEBPACK_IMPORTED_MODULE_2___default().info(`[Macro] 宏 "${key}" 注销成功`);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L21hY3JvLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQWtGO0FBRVI7QUFFL0M7QUFFM0IsTUFBTSxnQkFBZ0IsR0FBRyxJQUFJLEdBQUcsQ0FBaUM7SUFDL0QsQ0FBQyxnQkFBZ0IsRUFBRSx3RUFBaUIsQ0FBQztJQUNyQyxDQUFDLGdCQUFnQixFQUFFLHdFQUFpQixDQUFDO0NBQ3RDLENBQUMsQ0FBQztBQUVIOzs7O0dBSUc7QUFDSSxTQUFTLGFBQWEsQ0FBQyxHQUFXLEVBQUUsS0FBNkI7SUFDdEUscUVBQVksQ0FBQyxhQUFhLENBQUMsR0FBRyxFQUFFLEtBQUssQ0FBQyxDQUFDO0lBQ3ZDLG9EQUFRLENBQUMsY0FBYyxHQUFHLFFBQVEsQ0FBQyxDQUFDO0FBQ3RDLENBQUM7QUFFRDs7R0FFRztBQUNJLFNBQVMsaUJBQWlCO0lBQy9CLEtBQUssTUFBTSxDQUFDLEdBQUcsRUFBRSxLQUFLLENBQUMsSUFBSSxnQkFBZ0IsQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUFDO1FBQ3RELHFFQUFZLENBQUMsYUFBYSxDQUFDLEdBQUcsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUN2QyxvREFBUSxDQUFDLGNBQWMsR0FBRyxRQUFRLENBQUMsQ0FBQztJQUN0QyxDQUFDO0FBQ0gsQ0FBQztBQUVEOzs7R0FHRztBQUNJLFNBQVMsZUFBZSxDQUFDLEdBQVc7SUFDekMscUVBQVksQ0FBQyxlQUFlLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDbEMsb0RBQVEsQ0FBQyxjQUFjLEdBQUcsUUFBUSxDQUFDLENBQUM7QUFDdEMsQ0FBQztBQUVEOztHQUVHO0FBQ0ksU0FBUyxtQkFBbUI7SUFDakMsS0FBSyxNQUFNLEdBQUcsSUFBSSxnQkFBZ0IsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDO1FBQzFDLHFFQUFZLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ2xDLG9EQUFRLENBQUMsY0FBYyxHQUFHLFFBQVEsQ0FBQyxDQUFDO0lBQ3RDLENBQUM7QUFDSCxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBvbmVudC9tYWNyby50cz8yNTAyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldENoYXJBdmF0YXJQYXRoLCBnZXRVc2VyQXZhdGFyUGF0aCB9IGZyb20gJ0AvdXRpbC9leHRlbnNpb25fdmFyaWFibGVzJztcblxuaW1wb3J0IHsgTWFjcm9GdW5jdGlvbiwgTWFjcm9zUGFyc2VyIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvbWFjcm9zJztcblxuaW1wb3J0IGxvZyBmcm9tICdsb2dsZXZlbCc7XG5cbmNvbnN0IHByZWRlZmluZWRNYWNyb3MgPSBuZXcgTWFwPHN0cmluZywgc3RyaW5nIHwgTWFjcm9GdW5jdGlvbj4oW1xuICBbJ3VzZXJBdmF0YXJQYXRoJywgZ2V0VXNlckF2YXRhclBhdGhdLFxuICBbJ2NoYXJBdmF0YXJQYXRoJywgZ2V0Q2hhckF2YXRhclBhdGhdLFxuXSk7XG5cbi8qKlxuICog5rOo5YaM5LiA5Liq5a6PXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5IC0g5a6P55qE5ZCN56ewXG4gKiBAcGFyYW0ge01hY3JvRnVuY3Rpb258c3RyaW5nfSB2YWx1ZSAtIOWtl+espuS4suaIlui/lOWbnuWtl+espuS4sueahOWHveaVsFxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVnaXN0ZXJNYWNybyhrZXk6IHN0cmluZywgdmFsdWU6IHN0cmluZyB8IE1hY3JvRnVuY3Rpb24pIHtcbiAgTWFjcm9zUGFyc2VyLnJlZ2lzdGVyTWFjcm8oa2V5LCB2YWx1ZSk7XG4gIGxvZy5pbmZvKGBbTWFjcm9dIOWujyBcIiR7a2V5fVwiIOazqOWGjOaIkOWKn2ApO1xufVxuXG4vKipcbiAqIOazqOWGjOaJgOaciemihOWumuS5ieeahOWuj1xuICovXG5leHBvcnQgZnVuY3Rpb24gcmVnaXN0ZXJBbGxNYWNyb3MoKSB7XG4gIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIHByZWRlZmluZWRNYWNyb3MuZW50cmllcygpKSB7XG4gICAgTWFjcm9zUGFyc2VyLnJlZ2lzdGVyTWFjcm8oa2V5LCB2YWx1ZSk7XG4gICAgbG9nLmluZm8oYFtNYWNyb10g5a6PIFwiJHtrZXl9XCIg5rOo5YaM5oiQ5YqfYCk7XG4gIH1cbn1cblxuLyoqXG4gKiDms6jplIDmjIflrprnmoTlro9cbiAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgLSDopoHms6jplIDnmoTlro/lkI3np7BcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVucmVnaXN0ZXJNYWNybyhrZXk6IHN0cmluZykge1xuICBNYWNyb3NQYXJzZXIudW5yZWdpc3Rlck1hY3JvKGtleSk7XG4gIGxvZy5pbmZvKGBbTWFjcm9dIOWujyBcIiR7a2V5fVwiIOazqOmUgOaIkOWKn2ApO1xufVxuXG4vKipcbiAqIOazqOmUgOaJgOaciemihOWumuS5ieeahOWuj1xuICovXG5leHBvcnQgZnVuY3Rpb24gdW5yZWdpc3RlckFsbE1hY3JvcygpIHtcbiAgZm9yIChjb25zdCBrZXkgb2YgcHJlZGVmaW5lZE1hY3Jvcy5rZXlzKCkpIHtcbiAgICBNYWNyb3NQYXJzZXIudW5yZWdpc3Rlck1hY3JvKGtleSk7XG4gICAgbG9nLmluZm8oYFtNYWNyb10g5a6PIFwiJHtrZXl9XCIg5rOo6ZSA5oiQ5YqfYCk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/component/macro.ts\n')},"./src/component/macrolike.ts":
/*!************************************!*\
  !*** ./src/component/macrolike.ts ***!
  \************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   destroyMacroOnExtension: () => (/* binding */ destroyMacroOnExtension),\n/* harmony export */   initializeMacroOnExtension: () => (/* binding */ initializeMacroOnExtension),\n/* harmony export */   registerMacroLike: () => (/* binding */ registerMacroLike),\n/* harmony export */   renderAllMacros: () => (/* binding */ renderAllMacros)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n\n\nconst macros = [\n    {\n        regex: /\\{\\{get_global_variable::(.*?)\\}\\}/gi,\n        replace: (_context, _substring, path) => {\n            const variables = _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__.extension_settings.variables.global;\n            return JSON.stringify(_.get(variables, path, null));\n        },\n    },\n    {\n        regex: /\\{\\{get_chat_variable::(.*?)\\}\\}/gi,\n        replace: (_context, _substring, path) => {\n            const variables = _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat_metadata.variables;\n            return JSON.stringify(_.get(variables, path, null));\n        },\n    },\n    {\n        regex: /\\{\\{get_message_variable::(.*?)\\}\\}/gi,\n        replace: (context, _substring, path) => {\n            const variables = (context.message_id !== undefined ? _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.slice(0, context.message_id + 1) : _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat)\n                .map(chat_message => _.get(chat_message, ['variables', chat_message.swipe_id ?? 0]))\n                .findLast(data => data !== undefined) ?? {};\n            return JSON.stringify(_.get(variables, path, null));\n        },\n    },\n];\nfunction registerMacroLike(regex, replace) {\n    macros.push({ regex, replace });\n}\nfunction demacroOnPrompt(event_data) {\n    if (event_data.dryRun) {\n        return;\n    }\n    for (const message of event_data.chat) {\n        for (const macro of macros) {\n            message.content = message.content.replace(macro.regex, (substring, ...args) => macro.replace({ role: message.role }, substring, ...args));\n        }\n    }\n}\nfunction demacroOnRender(message_id) {\n    const $mes = $(`div.mes[mesid=\"${message_id}\"]`);\n    const $mes_text = $mes.find('.mes_text');\n    if ($mes_text.length === 0 || !macros.some(macro => macro.regex.test($mes_text.text()))) {\n        return;\n    }\n    const replace_html = (html) => {\n        for (const macro of macros) {\n            html = html.replace(macro.regex, (substring, ...args) => macro.replace({ message_id: Number(message_id), role: $mes.attr('is_user') === 'true' ? 'user' : 'assistant' }, substring, ...args));\n        }\n        return html;\n    };\n    $mes_text.html((_index, html) => replace_html(html));\n    $mes_text\n        .find('code')\n        .filter((_index, node) => macros.some(macro => macro.regex.test($(node).text())))\n        .text((_index, text) => replace_html(text));\n}\nfunction renderAllMacros() {\n    $('div.mes').each((_index, node) => {\n        demacroOnRender($(node).attr('mesid'));\n    });\n}\nfunction initializeMacroOnExtension() {\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.on(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.CHAT_COMPLETION_PROMPT_READY, demacroOnPrompt);\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.on(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.CHARACTER_MESSAGE_RENDERED, demacroOnRender);\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.on(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.USER_MESSAGE_RENDERED, demacroOnRender);\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.on(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.MESSAGE_UPDATED, demacroOnRender);\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.on(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.MESSAGE_SWIPED, demacroOnRender);\n}\nfunction destroyMacroOnExtension() {\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.removeListener(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.CHAT_COMPLETION_PROMPT_READY, demacroOnPrompt);\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.removeListener(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.CHARACTER_MESSAGE_RENDERED, demacroOnRender);\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.removeListener(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.USER_MESSAGE_RENDERED, demacroOnRender);\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.removeListener(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.MESSAGE_UPDATED, demacroOnRender);\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.removeListener(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.MESSAGE_SWIPED, demacroOnRender);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QztJQUN6RSw0REFBVyxDQUFDLGNBQWMsQ0FBQyw0REFBVyxDQUFDLGNBQWMsRUFBRSxlQUFlLENBQUMsQ0FBQztBQUMxRSxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBvbmVudC9tYWNyb2xpa2UudHM/YzgwMyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjaGF0LCBjaGF0X21ldGFkYXRhLCBldmVudF90eXBlcywgZXZlbnRTb3VyY2UgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0JztcbmltcG9ydCB7IGV4dGVuc2lvbl9zZXR0aW5ncyB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL2V4dGVuc2lvbnMnO1xuXG5pbnRlcmZhY2UgTWFjcm9MaWtlIHtcbiAgcmVnZXg6IFJlZ0V4cDtcbiAgcmVwbGFjZTogKGNvbnRleHQ6IENvbnRleHQsIHN1YnN0cmluZzogc3RyaW5nLCAuLi5hcmdzOiBhbnlbXSkgPT4gc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgQ29udGV4dCB7XG4gIG1lc3NhZ2VfaWQ/OiBudW1iZXI7XG4gIHJvbGU/OiAndXNlcicgfCAnYXNzaXN0YW50JyB8ICdzeXN0ZW0nO1xufVxuXG5jb25zdCBtYWNyb3M6IE1hY3JvTGlrZVtdID0gW1xuICB7XG4gICAgcmVnZXg6IC9cXHtcXHtnZXRfZ2xvYmFsX3ZhcmlhYmxlOjooLio/KVxcfVxcfS9naSxcbiAgICByZXBsYWNlOiAoX2NvbnRleHQ6IENvbnRleHQsIF9zdWJzdHJpbmc6IHN0cmluZywgcGF0aDogc3RyaW5nKSA9PiB7XG4gICAgICBjb25zdCB2YXJpYWJsZXMgPSBleHRlbnNpb25fc2V0dGluZ3MudmFyaWFibGVzLmdsb2JhbDtcbiAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShfLmdldCh2YXJpYWJsZXMsIHBhdGgsIG51bGwpKTtcbiAgICB9LFxuICB9LFxuICB7XG4gICAgcmVnZXg6IC9cXHtcXHtnZXRfY2hhdF92YXJpYWJsZTo6KC4qPylcXH1cXH0vZ2ksXG4gICAgcmVwbGFjZTogKF9jb250ZXh0OiBDb250ZXh0LCBfc3Vic3RyaW5nOiBzdHJpbmcsIHBhdGg6IHN0cmluZykgPT4ge1xuICAgICAgY29uc3QgdmFyaWFibGVzID0gKGNoYXRfbWV0YWRhdGEgYXMgeyB2YXJpYWJsZXM6IE9iamVjdCB9KS52YXJpYWJsZXM7XG4gICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoXy5nZXQodmFyaWFibGVzLCBwYXRoLCBudWxsKSk7XG4gICAgfSxcbiAgfSxcbiAge1xuICAgIHJlZ2V4OiAvXFx7XFx7Z2V0X21lc3NhZ2VfdmFyaWFibGU6OiguKj8pXFx9XFx9L2dpLFxuICAgIHJlcGxhY2U6IChjb250ZXh0OiBDb250ZXh0LCBfc3Vic3RyaW5nOiBzdHJpbmcsIHBhdGg6IHN0cmluZykgPT4ge1xuICAgICAgY29uc3QgdmFyaWFibGVzID1cbiAgICAgICAgKGNvbnRleHQubWVzc2FnZV9pZCAhPT0gdW5kZWZpbmVkID8gY2hhdC5zbGljZSgwLCBjb250ZXh0Lm1lc3NhZ2VfaWQgKyAxKSA6IGNoYXQpXG4gICAgICAgICAgLm1hcChjaGF0X21lc3NhZ2UgPT4gXy5nZXQoY2hhdF9tZXNzYWdlLCBbJ3ZhcmlhYmxlcycsIGNoYXRfbWVzc2FnZS5zd2lwZV9pZCA/PyAwXSkpXG4gICAgICAgICAgLmZpbmRMYXN0KGRhdGEgPT4gZGF0YSAhPT0gdW5kZWZpbmVkKSA/PyB7fTtcbiAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShfLmdldCh2YXJpYWJsZXMsIHBhdGgsIG51bGwpKTtcbiAgICB9LFxuICB9LFxuXTtcblxuZXhwb3J0IGZ1bmN0aW9uIHJlZ2lzdGVyTWFjcm9MaWtlKFxuICByZWdleDogUmVnRXhwLFxuICByZXBsYWNlOiAoY29udGV4dDogQ29udGV4dCwgc3Vic3RyaW5nOiBzdHJpbmcsIC4uLmFyZ3M6IGFueVtdKSA9PiBzdHJpbmcsXG4pIHtcbiAgbWFjcm9zLnB1c2goeyByZWdleCwgcmVwbGFjZSB9KTtcbn1cblxuZnVuY3Rpb24gZGVtYWNyb09uUHJvbXB0KGV2ZW50X2RhdGE6IFBhcmFtZXRlcnM8TGlzdGVuZXJUeXBlWydjaGF0X2NvbXBsZXRpb25fcHJvbXB0X3JlYWR5J10+WzBdKSB7XG4gIGlmIChldmVudF9kYXRhLmRyeVJ1bikge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGZvciAoY29uc3QgbWVzc2FnZSBvZiBldmVudF9kYXRhLmNoYXQpIHtcbiAgICBmb3IgKGNvbnN0IG1hY3JvIG9mIG1hY3Jvcykge1xuICAgICAgbWVzc2FnZS5jb250ZW50ID0gbWVzc2FnZS5jb250ZW50LnJlcGxhY2UobWFjcm8ucmVnZXgsIChzdWJzdHJpbmc6IHN0cmluZywgLi4uYXJnczogYW55W10pID0+XG4gICAgICAgIG1hY3JvLnJlcGxhY2UoeyByb2xlOiBtZXNzYWdlLnJvbGUgYXMgJ3VzZXInIHwgJ2Fzc2lzdGFudCcgfCAnc3lzdGVtJyB9LCBzdWJzdHJpbmcsIC4uLmFyZ3MpLFxuICAgICAgKTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gZGVtYWNyb09uUmVuZGVyKG1lc3NhZ2VfaWQ6IHN0cmluZykge1xuICBjb25zdCAkbWVzID0gJChgZGl2Lm1lc1ttZXNpZD1cIiR7bWVzc2FnZV9pZH1cIl1gKTtcbiAgY29uc3QgJG1lc190ZXh0ID0gJG1lcy5maW5kKCcubWVzX3RleHQnKTtcbiAgaWYgKCRtZXNfdGV4dC5sZW5ndGggPT09IDAgfHwgIW1hY3Jvcy5zb21lKG1hY3JvID0+IG1hY3JvLnJlZ2V4LnRlc3QoJG1lc190ZXh0LnRleHQoKSkpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgcmVwbGFjZV9odG1sID0gKGh0bWw6IHN0cmluZykgPT4ge1xuICAgIGZvciAoY29uc3QgbWFjcm8gb2YgbWFjcm9zKSB7XG4gICAgICBodG1sID0gaHRtbC5yZXBsYWNlKG1hY3JvLnJlZ2V4LCAoc3Vic3RyaW5nOiBzdHJpbmcsIC4uLmFyZ3M6IGFueVtdKSA9PlxuICAgICAgICBtYWNyby5yZXBsYWNlKFxuICAgICAgICAgIHsgbWVzc2FnZV9pZDogTnVtYmVyKG1lc3NhZ2VfaWQpLCByb2xlOiAkbWVzLmF0dHIoJ2lzX3VzZXInKSA9PT0gJ3RydWUnID8gJ3VzZXInIDogJ2Fzc2lzdGFudCcgfSxcbiAgICAgICAgICBzdWJzdHJpbmcsXG4gICAgICAgICAgLi4uYXJncyxcbiAgICAgICAgKSxcbiAgICAgICk7XG4gICAgfVxuICAgIHJldHVybiBodG1sO1xuICB9O1xuXG4gICRtZXNfdGV4dC5odG1sKChfaW5kZXgsIGh0bWwpID0+IHJlcGxhY2VfaHRtbChodG1sKSk7XG4gICRtZXNfdGV4dFxuICAgIC5maW5kKCdjb2RlJylcbiAgICAuZmlsdGVyKChfaW5kZXgsIG5vZGUpID0+IG1hY3Jvcy5zb21lKG1hY3JvID0+IG1hY3JvLnJlZ2V4LnRlc3QoJChub2RlKS50ZXh0KCkpKSlcbiAgICAudGV4dCgoX2luZGV4LCB0ZXh0KSA9PiByZXBsYWNlX2h0bWwodGV4dCkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVuZGVyQWxsTWFjcm9zKCkge1xuICAkKCdkaXYubWVzJykuZWFjaCgoX2luZGV4LCBub2RlKSA9PiB7XG4gICAgZGVtYWNyb09uUmVuZGVyKCQobm9kZSkuYXR0cignbWVzaWQnKSEpO1xuICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGluaXRpYWxpemVNYWNyb09uRXh0ZW5zaW9uKCkge1xuICBldmVudFNvdXJjZS5vbihldmVudF90eXBlcy5DSEFUX0NPTVBMRVRJT05fUFJPTVBUX1JFQURZLCBkZW1hY3JvT25Qcm9tcHQpO1xuICBldmVudFNvdXJjZS5vbihldmVudF90eXBlcy5DSEFSQUNURVJfTUVTU0FHRV9SRU5ERVJFRCwgZGVtYWNyb09uUmVuZGVyKTtcbiAgZXZlbnRTb3VyY2Uub24oZXZlbnRfdHlwZXMuVVNFUl9NRVNTQUdFX1JFTkRFUkVELCBkZW1hY3JvT25SZW5kZXIpO1xuICBldmVudFNvdXJjZS5vbihldmVudF90eXBlcy5NRVNTQUdFX1VQREFURUQsIGRlbWFjcm9PblJlbmRlcik7XG4gIGV2ZW50U291cmNlLm9uKGV2ZW50X3R5cGVzLk1FU1NBR0VfU1dJUEVELCBkZW1hY3JvT25SZW5kZXIpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVzdHJveU1hY3JvT25FeHRlbnNpb24oKSB7XG4gIGV2ZW50U291cmNlLnJlbW92ZUxpc3RlbmVyKGV2ZW50X3R5cGVzLkNIQVRfQ09NUExFVElPTl9QUk9NUFRfUkVBRFksIGRlbWFjcm9PblByb21wdCk7XG4gIGV2ZW50U291cmNlLnJlbW92ZUxpc3RlbmVyKGV2ZW50X3R5cGVzLkNIQVJBQ1RFUl9NRVNTQUdFX1JFTkRFUkVELCBkZW1hY3JvT25SZW5kZXIpO1xuICBldmVudFNvdXJjZS5yZW1vdmVMaXN0ZW5lcihldmVudF90eXBlcy5VU0VSX01FU1NBR0VfUkVOREVSRUQsIGRlbWFjcm9PblJlbmRlcik7XG4gIGV2ZW50U291cmNlLnJlbW92ZUxpc3RlbmVyKGV2ZW50X3R5cGVzLk1FU1NBR0VfVVBEQVRFRCwgZGVtYWNyb09uUmVuZGVyKTtcbiAgZXZlbnRTb3VyY2UucmVtb3ZlTGlzdGVuZXIoZXZlbnRfdHlwZXMuTUVTU0FHRV9TV0lQRUQsIGRlbWFjcm9PblJlbmRlcik7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/component/macrolike.ts\n")},"./src/component/main.ts":
/*!*******************************!*\
  !*** ./src/component/main.ts ***!
  \*******************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   initExtensionMainPanel: () => (/* binding */ initExtensionMainPanel)\n/* harmony export */ });\n/* harmony import */ var _component_macro__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/macro */ \"./src/component/macro.ts\");\n/* harmony import */ var _component_macrolike__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/component/macrolike */ \"./src/component/macrolike.ts\");\n/* harmony import */ var _component_message_iframe_render_hide_style__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/component/message_iframe/render_hide_style */ \"./src/component/message_iframe/render_hide_style.ts\");\n/* harmony import */ var _component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/component/message_iframe/render_message */ \"./src/component/message_iframe/render_message.ts\");\n/* harmony import */ var _component_message_iframe_render_optimize__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/component/message_iframe/render_optimize */ \"./src/component/message_iframe/render_optimize.ts\");\n/* harmony import */ var _component_script_iframe__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/component/script_iframe */ \"./src/component/script_iframe.ts\");\n/* harmony import */ var _component_script_repository_index__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/component/script_repository/index */ \"./src/component/script_repository/index.ts\");\n/* harmony import */ var _component_toastr__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @/component/toastr */ \"./src/component/toastr.ts\");\n/* harmony import */ var _iframe_client_index__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @/iframe_client/index */ \"./src/iframe_client/index.ts\");\n/* harmony import */ var _iframe_server_index__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @/iframe_server/index */ \"./src/iframe_server/index.ts\");\n/* harmony import */ var _iframe_server_variables__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @/iframe_server/variables */ \"./src/iframe_server/variables.ts\");\n/* harmony import */ var _script_url__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @/script_url */ \"./src/script_url.ts\");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst handleChatLoaded = async () => {\n    await (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_3__.renderAllIframes)();\n    (0,_component_message_iframe_render_hide_style__WEBPACK_IMPORTED_MODULE_2__.addCodeToggleButtonsToAllMessages)();\n};\nconst handleChatChanged = async () => {\n    (0,_component_macrolike__WEBPACK_IMPORTED_MODULE_1__.renderAllMacros)();\n};\nconst handlePartialRender = (mesId) => {\n    const mesIdNumber = parseInt(mesId, 10);\n    (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_3__.renderPartialIframes)(mesIdNumber);\n};\nconst handleMessageDeleted = (mesId) => {\n    const mesIdNumber = parseInt(mesId, 10);\n    (0,_iframe_server_variables__WEBPACK_IMPORTED_MODULE_10__.clearTempVariables)();\n    (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_3__.renderMessageAfterDelete)(mesIdNumber);\n    if ((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_12__.getSettingValue)('render.render_hide_style')) {\n        (0,_component_message_iframe_render_hide_style__WEBPACK_IMPORTED_MODULE_2__.addCodeToggleButtonsToAllMessages)();\n    }\n};\nconst handleVariableUpdated = (mesId) => {\n    const mesIdNumber = parseInt(mesId, 10);\n    (0,_iframe_server_variables__WEBPACK_IMPORTED_MODULE_10__.shouldUpdateVariables)(mesIdNumber);\n};\n/**\n * 初始化扩展主设置界面\n */\nfunction initExtensionMainPanel() {\n    const isEnabled = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_12__.getSettingValue)('enabled_extension');\n    if (isEnabled) {\n        handleExtensionToggle(false, true);\n    }\n    $('#extension-enable-toggle')\n        .prop('checked', isEnabled)\n        .on('change', function (event) {\n        handleExtensionToggle(true, $(event.currentTarget).prop('checked'));\n    });\n}\nasync function handleExtensionToggle(userAction = true, enable = true) {\n    if (userAction) {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_12__.saveSettingValue)('enabled_extension', enable);\n    }\n    if (enable) {\n        // 指示器样式\n        $('#extension-status-icon').css('color', 'green').next().text('扩展已启用');\n        _script_url__WEBPACK_IMPORTED_MODULE_11__.script_url.set('iframe_client', _iframe_client_index__WEBPACK_IMPORTED_MODULE_8__.iframe_client);\n        _script_url__WEBPACK_IMPORTED_MODULE_11__.script_url.set('viewport_adjust_script', _component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_3__.viewport_adjust_script);\n        _script_url__WEBPACK_IMPORTED_MODULE_11__.script_url.set('tampermonkey_script', _component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_3__.tampermonkey_script);\n        (0,_component_macro__WEBPACK_IMPORTED_MODULE_0__.registerAllMacros)();\n        (0,_component_toastr__WEBPACK_IMPORTED_MODULE_7__.initializeToastr)();\n        (0,_component_macrolike__WEBPACK_IMPORTED_MODULE_1__.initializeMacroOnExtension)();\n        (0,_component_script_iframe__WEBPACK_IMPORTED_MODULE_5__.initializeCharacterLevelOnExtension)();\n        (0,_component_script_repository_index__WEBPACK_IMPORTED_MODULE_6__.buildScriptRepositoryOnExtension)();\n        // 重新注入前端卡优化的样式和设置\n        if (userAction && (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_12__.getSettingValue)('render.rendering_optimize')) {\n            (0,_component_message_iframe_render_optimize__WEBPACK_IMPORTED_MODULE_4__.addRenderingOptimizeSettings)();\n        }\n        if (userAction && (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_12__.getSettingValue)('render.render_hide_style')) {\n            (0,_component_message_iframe_render_hide_style__WEBPACK_IMPORTED_MODULE_2__.addRenderingHideStyleSettings)();\n        }\n        window.addEventListener('message', _iframe_server_index__WEBPACK_IMPORTED_MODULE_9__.handleIframe);\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_13__.eventSource.on(_sillytavern_script__WEBPACK_IMPORTED_MODULE_13__.event_types.CHAT_CHANGED, handleChatChanged);\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_13__.eventSource.on('chatLoaded', handleChatLoaded);\n        _component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_3__.partialRenderEvents.forEach(eventType => {\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_13__.eventSource.on(eventType, handlePartialRender);\n        });\n        _iframe_server_variables__WEBPACK_IMPORTED_MODULE_10__.checkVariablesEvents.forEach(eventType => {\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_13__.eventSource.on(eventType, handleVariableUpdated);\n        });\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_13__.eventSource.on(_sillytavern_script__WEBPACK_IMPORTED_MODULE_13__.event_types.MESSAGE_DELETED, handleMessageDeleted);\n        if (userAction && _sillytavern_script__WEBPACK_IMPORTED_MODULE_13__.this_chid !== undefined) {\n            await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_13__.reloadCurrentChat)();\n        }\n    }\n    else {\n        // 指示器样式\n        $('#extension-status-icon').css('color', 'red').next().text('扩展已禁用');\n        _script_url__WEBPACK_IMPORTED_MODULE_11__.script_url.delete('iframe_client');\n        _script_url__WEBPACK_IMPORTED_MODULE_11__.script_url.delete('viewport_adjust_script');\n        _script_url__WEBPACK_IMPORTED_MODULE_11__.script_url.delete('tampermonkey_script');\n        (0,_component_macro__WEBPACK_IMPORTED_MODULE_0__.unregisterAllMacros)();\n        (0,_component_macrolike__WEBPACK_IMPORTED_MODULE_1__.destroyMacroOnExtension)();\n        (0,_component_script_iframe__WEBPACK_IMPORTED_MODULE_5__.destroyCharacterLevelOnExtension)();\n        (0,_component_script_repository_index__WEBPACK_IMPORTED_MODULE_6__.destroyScriptRepositoryOnExtension)();\n        if ((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_12__.getSettingValue)('render.rendering_optimize')) {\n            (0,_component_message_iframe_render_optimize__WEBPACK_IMPORTED_MODULE_4__.removeRenderingOptimizeSettings)();\n        }\n        if ((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_12__.getSettingValue)('render.render_hide_style')) {\n            (0,_component_message_iframe_render_hide_style__WEBPACK_IMPORTED_MODULE_2__.removeRenderingHideStyleSettings)();\n        }\n        window.removeEventListener('message', _iframe_server_index__WEBPACK_IMPORTED_MODULE_9__.handleIframe);\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_13__.eventSource.removeListener(_sillytavern_script__WEBPACK_IMPORTED_MODULE_13__.event_types.CHAT_CHANGED, handleChatChanged);\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_13__.eventSource.removeListener('chatLoaded', handleChatLoaded);\n        _component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_3__.partialRenderEvents.forEach(eventType => {\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_13__.eventSource.removeListener(eventType, handlePartialRender);\n        });\n        _iframe_server_variables__WEBPACK_IMPORTED_MODULE_10__.checkVariablesEvents.forEach(eventType => {\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_13__.eventSource.removeListener(eventType, handleVariableUpdated);\n        });\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_13__.eventSource.removeListener(_sillytavern_script__WEBPACK_IMPORTED_MODULE_13__.event_types.MESSAGE_DELETED, handleMessageDeleted);\n        if (userAction && _sillytavern_script__WEBPACK_IMPORTED_MODULE_13__.this_chid !== undefined) {\n            await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_13__.reloadCurrentChat)();\n        }\n    }\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_13__.saveSettingsDebounced)();\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LHVFQUFpQixFQUFFLENBQUM7UUFDNUIsQ0FBQztJQUNILENBQUM7SUFDRCwyRUFBcUIsRUFBRSxDQUFDO0FBQzFCLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvY29tcG9uZW50L21haW4udHM/OTdiNyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyByZWdpc3RlckFsbE1hY3JvcywgdW5yZWdpc3RlckFsbE1hY3JvcyB9IGZyb20gJ0AvY29tcG9uZW50L21hY3JvJztcbmltcG9ydCB7IGRlc3Ryb3lNYWNyb09uRXh0ZW5zaW9uLCBpbml0aWFsaXplTWFjcm9PbkV4dGVuc2lvbiwgcmVuZGVyQWxsTWFjcm9zIH0gZnJvbSAnQC9jb21wb25lbnQvbWFjcm9saWtlJztcbmltcG9ydCB7XG4gIGFkZENvZGVUb2dnbGVCdXR0b25zVG9BbGxNZXNzYWdlcyxcbiAgYWRkUmVuZGVyaW5nSGlkZVN0eWxlU2V0dGluZ3MsXG4gIHJlbW92ZVJlbmRlcmluZ0hpZGVTdHlsZVNldHRpbmdzLFxufSBmcm9tICdAL2NvbXBvbmVudC9tZXNzYWdlX2lmcmFtZS9yZW5kZXJfaGlkZV9zdHlsZSc7XG5pbXBvcnQge1xuICBwYXJ0aWFsUmVuZGVyRXZlbnRzLFxuICByZW5kZXJBbGxJZnJhbWVzLFxuICByZW5kZXJNZXNzYWdlQWZ0ZXJEZWxldGUsXG4gIHJlbmRlclBhcnRpYWxJZnJhbWVzLFxuICB0YW1wZXJtb25rZXlfc2NyaXB0LFxuICB2aWV3cG9ydF9hZGp1c3Rfc2NyaXB0LFxufSBmcm9tICdAL2NvbXBvbmVudC9tZXNzYWdlX2lmcmFtZS9yZW5kZXJfbWVzc2FnZSc7XG5pbXBvcnQge1xuICBhZGRSZW5kZXJpbmdPcHRpbWl6ZVNldHRpbmdzLFxuICByZW1vdmVSZW5kZXJpbmdPcHRpbWl6ZVNldHRpbmdzLFxufSBmcm9tICdAL2NvbXBvbmVudC9tZXNzYWdlX2lmcmFtZS9yZW5kZXJfb3B0aW1pemUnO1xuaW1wb3J0IHsgZGVzdHJveUNoYXJhY3RlckxldmVsT25FeHRlbnNpb24sIGluaXRpYWxpemVDaGFyYWN0ZXJMZXZlbE9uRXh0ZW5zaW9uIH0gZnJvbSAnQC9jb21wb25lbnQvc2NyaXB0X2lmcmFtZSc7XG5pbXBvcnQge1xuICBidWlsZFNjcmlwdFJlcG9zaXRvcnlPbkV4dGVuc2lvbixcbiAgZGVzdHJveVNjcmlwdFJlcG9zaXRvcnlPbkV4dGVuc2lvbixcbn0gZnJvbSAnQC9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvaW5kZXgnO1xuaW1wb3J0IHsgaW5pdGlhbGl6ZVRvYXN0ciB9IGZyb20gJ0AvY29tcG9uZW50L3RvYXN0cic7XG5pbXBvcnQgeyBpZnJhbWVfY2xpZW50IH0gZnJvbSAnQC9pZnJhbWVfY2xpZW50L2luZGV4JztcbmltcG9ydCB7IGhhbmRsZUlmcmFtZSB9IGZyb20gJ0AvaWZyYW1lX3NlcnZlci9pbmRleCc7XG5pbXBvcnQgeyBjaGVja1ZhcmlhYmxlc0V2ZW50cywgY2xlYXJUZW1wVmFyaWFibGVzLCBzaG91bGRVcGRhdGVWYXJpYWJsZXMgfSBmcm9tICdAL2lmcmFtZV9zZXJ2ZXIvdmFyaWFibGVzJztcbmltcG9ydCB7IHNjcmlwdF91cmwgfSBmcm9tICdAL3NjcmlwdF91cmwnO1xuaW1wb3J0IHsgZ2V0U2V0dGluZ1ZhbHVlLCBzYXZlU2V0dGluZ1ZhbHVlIH0gZnJvbSAnQC91dGlsL2V4dGVuc2lvbl92YXJpYWJsZXMnO1xuaW1wb3J0IHsgZXZlbnRTb3VyY2UsIGV2ZW50X3R5cGVzLCByZWxvYWRDdXJyZW50Q2hhdCwgc2F2ZVNldHRpbmdzRGVib3VuY2VkLCB0aGlzX2NoaWQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0JztcblxuY29uc3QgaGFuZGxlQ2hhdExvYWRlZCA9IGFzeW5jICgpID0+IHtcbiAgYXdhaXQgcmVuZGVyQWxsSWZyYW1lcygpO1xuICBhZGRDb2RlVG9nZ2xlQnV0dG9uc1RvQWxsTWVzc2FnZXMoKTtcbn07XG5cbmNvbnN0IGhhbmRsZUNoYXRDaGFuZ2VkID0gYXN5bmMgKCkgPT4ge1xuICByZW5kZXJBbGxNYWNyb3MoKTtcbn07XG5cbmNvbnN0IGhhbmRsZVBhcnRpYWxSZW5kZXIgPSAobWVzSWQ6IHN0cmluZykgPT4ge1xuICBjb25zdCBtZXNJZE51bWJlciA9IHBhcnNlSW50KG1lc0lkLCAxMCk7XG4gIHJlbmRlclBhcnRpYWxJZnJhbWVzKG1lc0lkTnVtYmVyKTtcbn07XG5cbmNvbnN0IGhhbmRsZU1lc3NhZ2VEZWxldGVkID0gKG1lc0lkOiBzdHJpbmcpID0+IHtcbiAgY29uc3QgbWVzSWROdW1iZXIgPSBwYXJzZUludChtZXNJZCwgMTApO1xuICBjbGVhclRlbXBWYXJpYWJsZXMoKTtcbiAgcmVuZGVyTWVzc2FnZUFmdGVyRGVsZXRlKG1lc0lkTnVtYmVyKTtcbiAgaWYgKGdldFNldHRpbmdWYWx1ZSgncmVuZGVyLnJlbmRlcl9oaWRlX3N0eWxlJykpIHtcbiAgICBhZGRDb2RlVG9nZ2xlQnV0dG9uc1RvQWxsTWVzc2FnZXMoKTtcbiAgfVxufTtcblxuY29uc3QgaGFuZGxlVmFyaWFibGVVcGRhdGVkID0gKG1lc0lkOiBzdHJpbmcpID0+IHtcbiAgY29uc3QgbWVzSWROdW1iZXIgPSBwYXJzZUludChtZXNJZCwgMTApO1xuICBzaG91bGRVcGRhdGVWYXJpYWJsZXMobWVzSWROdW1iZXIpO1xufTtcblxuLyoqXG4gKiDliJ3lp4vljJbmianlsZXkuLvorr7nva7nlYzpnaJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluaXRFeHRlbnNpb25NYWluUGFuZWwoKSB7XG4gIGNvbnN0IGlzRW5hYmxlZCA9IGdldFNldHRpbmdWYWx1ZSgnZW5hYmxlZF9leHRlbnNpb24nKTtcbiAgaWYgKGlzRW5hYmxlZCkge1xuICAgIGhhbmRsZUV4dGVuc2lvblRvZ2dsZShmYWxzZSwgdHJ1ZSk7XG4gIH1cbiAgJCgnI2V4dGVuc2lvbi1lbmFibGUtdG9nZ2xlJylcbiAgICAucHJvcCgnY2hlY2tlZCcsIGlzRW5hYmxlZClcbiAgICAub24oJ2NoYW5nZScsIGZ1bmN0aW9uIChldmVudDogSlF1ZXJ5LkNoYW5nZUV2ZW50KSB7XG4gICAgICBoYW5kbGVFeHRlbnNpb25Ub2dnbGUodHJ1ZSwgJChldmVudC5jdXJyZW50VGFyZ2V0KS5wcm9wKCdjaGVja2VkJykpO1xuICAgIH0pO1xufVxuXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVFeHRlbnNpb25Ub2dnbGUodXNlckFjdGlvbjogYm9vbGVhbiA9IHRydWUsIGVuYWJsZTogYm9vbGVhbiA9IHRydWUpIHtcbiAgaWYgKHVzZXJBY3Rpb24pIHtcbiAgICBzYXZlU2V0dGluZ1ZhbHVlKCdlbmFibGVkX2V4dGVuc2lvbicsIGVuYWJsZSk7XG4gIH1cbiAgaWYgKGVuYWJsZSkge1xuICAgIC8vIOaMh+ekuuWZqOagt+W8j1xuICAgICQoJyNleHRlbnNpb24tc3RhdHVzLWljb24nKS5jc3MoJ2NvbG9yJywgJ2dyZWVuJykubmV4dCgpLnRleHQoJ+aJqeWxleW3suWQr+eUqCcpO1xuXG4gICAgc2NyaXB0X3VybC5zZXQoJ2lmcmFtZV9jbGllbnQnLCBpZnJhbWVfY2xpZW50KTtcbiAgICBzY3JpcHRfdXJsLnNldCgndmlld3BvcnRfYWRqdXN0X3NjcmlwdCcsIHZpZXdwb3J0X2FkanVzdF9zY3JpcHQpO1xuICAgIHNjcmlwdF91cmwuc2V0KCd0YW1wZXJtb25rZXlfc2NyaXB0JywgdGFtcGVybW9ua2V5X3NjcmlwdCk7XG5cbiAgICByZWdpc3RlckFsbE1hY3JvcygpO1xuICAgIGluaXRpYWxpemVUb2FzdHIoKTtcbiAgICBpbml0aWFsaXplTWFjcm9PbkV4dGVuc2lvbigpO1xuICAgIGluaXRpYWxpemVDaGFyYWN0ZXJMZXZlbE9uRXh0ZW5zaW9uKCk7XG4gICAgYnVpbGRTY3JpcHRSZXBvc2l0b3J5T25FeHRlbnNpb24oKTtcblxuICAgIC8vIOmHjeaWsOazqOWFpeWJjeerr+WNoeS8mOWMlueahOagt+W8j+WSjOiuvue9rlxuICAgIGlmICh1c2VyQWN0aW9uICYmIGdldFNldHRpbmdWYWx1ZSgncmVuZGVyLnJlbmRlcmluZ19vcHRpbWl6ZScpKSB7XG4gICAgICBhZGRSZW5kZXJpbmdPcHRpbWl6ZVNldHRpbmdzKCk7XG4gICAgfVxuICAgIGlmICh1c2VyQWN0aW9uICYmIGdldFNldHRpbmdWYWx1ZSgncmVuZGVyLnJlbmRlcl9oaWRlX3N0eWxlJykpIHtcbiAgICAgIGFkZFJlbmRlcmluZ0hpZGVTdHlsZVNldHRpbmdzKCk7XG4gICAgfVxuXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBoYW5kbGVJZnJhbWUpO1xuXG4gICAgZXZlbnRTb3VyY2Uub24oZXZlbnRfdHlwZXMuQ0hBVF9DSEFOR0VELCBoYW5kbGVDaGF0Q2hhbmdlZCk7XG4gICAgZXZlbnRTb3VyY2Uub24oJ2NoYXRMb2FkZWQnLCBoYW5kbGVDaGF0TG9hZGVkKTtcblxuICAgIHBhcnRpYWxSZW5kZXJFdmVudHMuZm9yRWFjaChldmVudFR5cGUgPT4ge1xuICAgICAgZXZlbnRTb3VyY2Uub24oZXZlbnRUeXBlLCBoYW5kbGVQYXJ0aWFsUmVuZGVyKTtcbiAgICB9KTtcblxuICAgIGNoZWNrVmFyaWFibGVzRXZlbnRzLmZvckVhY2goZXZlbnRUeXBlID0+IHtcbiAgICAgIGV2ZW50U291cmNlLm9uKGV2ZW50VHlwZSwgaGFuZGxlVmFyaWFibGVVcGRhdGVkKTtcbiAgICB9KTtcbiAgICBldmVudFNvdXJjZS5vbihldmVudF90eXBlcy5NRVNTQUdFX0RFTEVURUQsIGhhbmRsZU1lc3NhZ2VEZWxldGVkKTtcbiAgICBpZiAodXNlckFjdGlvbiAmJiB0aGlzX2NoaWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgYXdhaXQgcmVsb2FkQ3VycmVudENoYXQoKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgLy8g5oyH56S65Zmo5qC35byPXG4gICAgJCgnI2V4dGVuc2lvbi1zdGF0dXMtaWNvbicpLmNzcygnY29sb3InLCAncmVkJykubmV4dCgpLnRleHQoJ+aJqeWxleW3suemgeeUqCcpO1xuXG4gICAgc2NyaXB0X3VybC5kZWxldGUoJ2lmcmFtZV9jbGllbnQnKTtcbiAgICBzY3JpcHRfdXJsLmRlbGV0ZSgndmlld3BvcnRfYWRqdXN0X3NjcmlwdCcpO1xuICAgIHNjcmlwdF91cmwuZGVsZXRlKCd0YW1wZXJtb25rZXlfc2NyaXB0Jyk7XG5cbiAgICB1bnJlZ2lzdGVyQWxsTWFjcm9zKCk7XG4gICAgZGVzdHJveU1hY3JvT25FeHRlbnNpb24oKTtcbiAgICBkZXN0cm95Q2hhcmFjdGVyTGV2ZWxPbkV4dGVuc2lvbigpO1xuICAgIGRlc3Ryb3lTY3JpcHRSZXBvc2l0b3J5T25FeHRlbnNpb24oKTtcblxuICAgIGlmIChnZXRTZXR0aW5nVmFsdWUoJ3JlbmRlci5yZW5kZXJpbmdfb3B0aW1pemUnKSkge1xuICAgICAgcmVtb3ZlUmVuZGVyaW5nT3B0aW1pemVTZXR0aW5ncygpO1xuICAgIH1cblxuICAgIGlmIChnZXRTZXR0aW5nVmFsdWUoJ3JlbmRlci5yZW5kZXJfaGlkZV9zdHlsZScpKSB7XG4gICAgICByZW1vdmVSZW5kZXJpbmdIaWRlU3R5bGVTZXR0aW5ncygpO1xuICAgIH1cblxuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgaGFuZGxlSWZyYW1lKTtcblxuICAgIGV2ZW50U291cmNlLnJlbW92ZUxpc3RlbmVyKGV2ZW50X3R5cGVzLkNIQVRfQ0hBTkdFRCwgaGFuZGxlQ2hhdENoYW5nZWQpO1xuICAgIGV2ZW50U291cmNlLnJlbW92ZUxpc3RlbmVyKCdjaGF0TG9hZGVkJywgaGFuZGxlQ2hhdExvYWRlZCk7XG4gICAgcGFydGlhbFJlbmRlckV2ZW50cy5mb3JFYWNoKGV2ZW50VHlwZSA9PiB7XG4gICAgICBldmVudFNvdXJjZS5yZW1vdmVMaXN0ZW5lcihldmVudFR5cGUsIGhhbmRsZVBhcnRpYWxSZW5kZXIpO1xuICAgIH0pO1xuICAgIGNoZWNrVmFyaWFibGVzRXZlbnRzLmZvckVhY2goZXZlbnRUeXBlID0+IHtcbiAgICAgIGV2ZW50U291cmNlLnJlbW92ZUxpc3RlbmVyKGV2ZW50VHlwZSwgaGFuZGxlVmFyaWFibGVVcGRhdGVkKTtcbiAgICB9KTtcbiAgICBldmVudFNvdXJjZS5yZW1vdmVMaXN0ZW5lcihldmVudF90eXBlcy5NRVNTQUdFX0RFTEVURUQsIGhhbmRsZU1lc3NhZ2VEZWxldGVkKTtcbiAgICBpZiAodXNlckFjdGlvbiAmJiB0aGlzX2NoaWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgYXdhaXQgcmVsb2FkQ3VycmVudENoYXQoKTtcbiAgICB9XG4gIH1cbiAgc2F2ZVNldHRpbmdzRGVib3VuY2VkKCk7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/component/main.ts\n")},"./src/component/message_iframe/index.ts":
/*!***********************************************!*\
  !*** ./src/component/message_iframe/index.ts ***!
  \***********************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   defaultIframeSettings: () => (/* binding */ defaultIframeSettings),\n/* harmony export */   handleRenderEnableToggle: () => (/* binding */ handleRenderEnableToggle),\n/* harmony export */   handleRenderingHideStyleToggle: () => (/* binding */ handleRenderingHideStyleToggle),\n/* harmony export */   handleRenderingOptimizationToggle: () => (/* binding */ handleRenderingOptimizationToggle),\n/* harmony export */   initIframePanel: () => (/* binding */ initIframePanel),\n/* harmony export */   injectLoadingStyles: () => (/* binding */ injectLoadingStyles),\n/* harmony export */   onDepthInput: () => (/* binding */ onDepthInput)\n/* harmony export */ });\n/* harmony import */ var _component_message_iframe_render_hide_style__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/message_iframe/render_hide_style */ \"./src/component/message_iframe/render_hide_style.ts\");\n/* harmony import */ var _component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/component/message_iframe/render_message */ \"./src/component/message_iframe/render_message.ts\");\n/* harmony import */ var _component_message_iframe_render_optimize__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/component/message_iframe/render_optimize */ \"./src/component/message_iframe/render_optimize.ts\");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n\n\n\n\n\nconst defaultIframeSettings = {\n    render_enabled: true,\n    tampermonkey_compatibility: false,\n    render_depth: 0,\n    render_optimize: false,\n};\n/**\n * 注入加载样式\n */\nfunction injectLoadingStyles() {\n    if ($('#iframe-loading-styles').length)\n        return;\n    const styleSheet = $('<style>', {\n        id: 'iframe-loading-styles',\n        text: `\n        .iframe-loading-overlay{\n          position:absolute;\n          top:0;\n          left:0;\n          right:0;\n          bottom:0;\n          background:rgba(0,0,0,.7);\n          display:flex;\n          justify-content:center;\n          align-items:center;\n          z-index:1000;\n          transition:opacity .3s ease\n        }\n        .iframe-loading-content{\n          color:#fff;\n          display:flex;\n          align-items:center;\n          gap:10px;\n          font-size:16px\n        }\n        .iframe-loading-content i{\n          font-size:20px\n        }\n        .loading-text {\n          transition: opacity 0.3s ease;\n        }`,\n    });\n    $('head').append(styleSheet);\n}\n/**\n * 添加前端渲染快速按钮\n */\nfunction addRenderQuickButton() {\n    const buttonHtml = $(`\n  <div id=\"tavern-helper-render-container\" class=\"list-group-item flex-container flexGap5 interactable\">\n      <div class=\"fa-solid fa-puzzle-piece extensionsMenuExtensionButton\" /></div>\n      <span id=\"tavern-helper-render-text\">${(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_3__.getSettingValue)('render.render_enabled') ? '关闭前端渲染' : '开启前端渲染'}</span>\n  </div>`);\n    buttonHtml.css('display', 'flex');\n    $('#extensionsMenu').append(buttonHtml);\n    const isRenderEnabled = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_3__.getSettingValue)('render.render_enabled') ?? defaultIframeSettings.render_enabled;\n    $('#tavern-helper-render-container').on('click', async function () {\n        $('#tavern-helper-render-text').text(!isRenderEnabled ? '关闭前端渲染' : '开启前端渲染');\n        await handleRenderEnableToggle(!isRenderEnabled, true);\n        $('#render-enable-toggle').prop('checked', isRenderEnabled);\n    });\n}\n/**\n * 初始化iframe控制面板\n */\nasync function initIframePanel() {\n    // 处理重型前端卡渲染优化\n    const isRenderingOptimizeEnabled = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_3__.getSettingValue)('render.render_optimize') ?? defaultIframeSettings.render_optimize;\n    if (isRenderingOptimizeEnabled) {\n        await handleRenderingOptimizationToggle(true, false);\n    }\n    $('#render-optimize-toggle')\n        .prop('checked', isRenderingOptimizeEnabled)\n        .on('click', (event) => handleRenderingOptimizationToggle(event.target.checked, true));\n    // 处理处理深度设置\n    const renderDepth = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_3__.getSettingValue)('render.render_depth') ?? defaultIframeSettings.render_depth;\n    $('#render-depth')\n        .val(renderDepth)\n        .on('blur', function (event) {\n        onDepthInput(event.target.value);\n    });\n    // 处理油猴兼容性设置\n    const isTampermonkeyEnabled = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_3__.getSettingValue)('render.tampermonkey_compatibility') ?? defaultIframeSettings.tampermonkey_compatibility;\n    if (isTampermonkeyEnabled) {\n        (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_1__.handleTampermonkeyCompatibilityChange)(true, false);\n    }\n    $('#tampermonkey-compatibility-toggle')\n        .prop('checked', isTampermonkeyEnabled)\n        .on('click', (event) => (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_1__.handleTampermonkeyCompatibilityChange)(event.target.checked, true));\n    // 首先处理前端渲染设置 - 这个必须先执行，因为它可能会调用reloadCurrentChat\n    const isRenderEnabled = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_3__.getSettingValue)('render.render_enabled') ?? defaultIframeSettings.render_enabled;\n    await handleRenderEnableToggle(isRenderEnabled, false);\n    $('#render-enable-toggle')\n        .prop('checked', isRenderEnabled)\n        .on('click', (event) => handleRenderEnableToggle(event.target.checked, true));\n    // 处理代码块折叠设置 - 这个放在渲染设置之后，确保不被reloadCurrentChat清除\n    const isRenderingHideStyleEnabled = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_3__.getSettingValue)('render.render_hide_style');\n    if (isRenderingHideStyleEnabled) {\n        await handleRenderingHideStyleToggle(true, false);\n    }\n    $('#render-hide-style-toggle')\n        .prop('checked', isRenderingHideStyleEnabled)\n        .on('click', (event) => handleRenderingHideStyleToggle(event.target.checked, true));\n    $(window).on('resize', function () {\n        if ($('iframe[data-needs-vh=\"true\"]').length) {\n            (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_1__.updateIframeViewportHeight)();\n        }\n    });\n    addRenderQuickButton();\n    injectLoadingStyles();\n    (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_1__.setupIframeRemovalListener)();\n}\n/**\n * 处理深度输入改变时\n */\nasync function onDepthInput(value) {\n    const processDepth = parseInt(value, 10);\n    if (processDepth < 0) {\n        toastr.warning('处理深度不能为负数');\n        $('#render-depth').val((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_3__.getSettingValue)('render.render_depth'));\n        return;\n    }\n    (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_3__.saveSettingValue)('render.render_depth', processDepth);\n    await (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_1__.clearAndRenderAllIframes)();\n}\n/**\n * 处理渲染器启用设置改变\n * @param enable 是否启用渲染器\n * @param userInput 是否由用户手动触发\n */\nasync function handleRenderEnableToggle(enable, userInput = true) {\n    if (userInput) {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_3__.saveSettingValue)('render.render_enabled', enable);\n    }\n    if (enable) {\n        $('#render-settings-content .extension-content-item').slice(3).css('opacity', 1);\n        await (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_1__.renderAllIframes)();\n    }\n    else {\n        $('#render-settings-content .extension-content-item').slice(3).css('opacity', 0.5);\n        await (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_1__.clearAllIframes)();\n        if (userInput && _sillytavern_script__WEBPACK_IMPORTED_MODULE_4__.this_chid !== undefined) {\n            await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_4__.reloadCurrentChat)();\n        }\n    }\n}\n/**\n * 处理代码块折叠设置改变\n * @param enable 是否启用代码块折叠\n * @param userInput 是否由用户手动触发\n */\nasync function handleRenderingHideStyleToggle(enable, userInput = true) {\n    if (userInput) {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_3__.saveSettingValue)('render.render_hide_style', enable);\n    }\n    if (enable) {\n        (0,_component_message_iframe_render_hide_style__WEBPACK_IMPORTED_MODULE_0__.addRenderingHideStyleSettings)();\n        if (userInput) {\n            await (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_1__.clearAndRenderAllIframes)();\n        }\n    }\n    else {\n        (0,_component_message_iframe_render_hide_style__WEBPACK_IMPORTED_MODULE_0__.removeRenderingHideStyleSettings)();\n        if (userInput) {\n            await (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_1__.clearAndRenderAllIframes)();\n        }\n    }\n}\n/**\n * 处理重型前端卡渲染优化\n * @param enable 是否启用重型前端卡渲染优化\n * @param userInput 是否由用户手动触发\n */\nasync function handleRenderingOptimizationToggle(enable, userInput = true) {\n    if (userInput) {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_3__.saveSettingValue)('render.render_optimize', enable);\n    }\n    if (enable) {\n        (0,_component_message_iframe_render_optimize__WEBPACK_IMPORTED_MODULE_2__.addRenderingOptimizeSettings)();\n        if (userInput) {\n            await (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_1__.clearAndRenderAllIframes)();\n        }\n    }\n    else {\n        (0,_component_message_iframe_render_optimize__WEBPACK_IMPORTED_MODULE_2__.removeRenderingOptimizeSettings)();\n        if (userInput) {\n            await (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_1__.clearAndRenderAllIframes)();\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L21lc3NhZ2VfaWZyYW1lL2luZGV4LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUdzRDtBQVFIO0FBSUM7QUFDMkI7QUFFWjtBQUU1RCxNQUFNLHFCQUFxQixHQUFHO0lBQ25DLGNBQWMsRUFBRSxJQUFJO0lBQ3BCLDBCQUEwQixFQUFFLEtBQUs7SUFDakMsWUFBWSxFQUFFLENBQUM7SUFDZixlQUFlLEVBQUUsS0FBSztDQUN2QixDQUFDO0FBRUY7O0dBRUc7QUFDSSxTQUFTLG1CQUFtQjtJQUNqQyxJQUFJLENBQUMsQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDLE1BQU07UUFBRSxPQUFPO0lBRS9DLE1BQU0sVUFBVSxHQUFHLENBQUMsQ0FBQyxTQUFTLEVBQUU7UUFDOUIsRUFBRSxFQUFFLHVCQUF1QjtRQUMzQixJQUFJLEVBQUU7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O1VBMEJBO0tBQ1AsQ0FBQyxDQUFDO0lBRUgsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQztBQUMvQixDQUFDO0FBRUQ7O0dBRUc7QUFDSCxTQUFTLG9CQUFvQjtJQUMzQixNQUFNLFVBQVUsR0FBRyxDQUFDLENBQUM7Ozs2Q0FHc0IsMEVBQWUsQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLFFBQVE7U0FDbEcsQ0FBQyxDQUFDO0lBQ1QsVUFBVSxDQUFDLEdBQUcsQ0FBQyxTQUFTLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDbEMsQ0FBQyxDQUFDLGlCQUFpQixDQUFDLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBQ3hDLE1BQU0sZUFBZSxHQUFHLDBFQUFlLENBQUMsdUJBQXVCLENBQUMsSUFBSSxxQkFBcUIsQ0FBQyxjQUFjLENBQUM7SUFDekcsQ0FBQyxDQUFDLGlDQUFpQyxDQUFDLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxLQUFLO1FBQ3BELENB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QyxDQUFDO0lBQ0gsQ0FBQztTQUFNLENBQUM7UUFDTiwwR0FBK0IsRUFBRSxDQUFDO1FBQ2xDLElBQUksU0FBUyxFQUFFLENBQUM7WUFDZCxNQUFNLGtHQUF3QixFQUFFLENBQUM7UUFDbkMsQ0FBQztJQUNILENBQUM7QUFDSCxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBvbmVudC9tZXNzYWdlX2lmcmFtZS9pbmRleC50cz9iMzRmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIGFkZFJlbmRlcmluZ0hpZGVTdHlsZVNldHRpbmdzLFxuICByZW1vdmVSZW5kZXJpbmdIaWRlU3R5bGVTZXR0aW5ncyxcbn0gZnJvbSAnQC9jb21wb25lbnQvbWVzc2FnZV9pZnJhbWUvcmVuZGVyX2hpZGVfc3R5bGUnO1xuaW1wb3J0IHtcbiAgY2xlYXJBbGxJZnJhbWVzLFxuICBjbGVhckFuZFJlbmRlckFsbElmcmFtZXMsXG4gIGhhbmRsZVRhbXBlcm1vbmtleUNvbXBhdGliaWxpdHlDaGFuZ2UsXG4gIHJlbmRlckFsbElmcmFtZXMsXG4gIHNldHVwSWZyYW1lUmVtb3ZhbExpc3RlbmVyLFxuICB1cGRhdGVJZnJhbWVWaWV3cG9ydEhlaWdodCxcbn0gZnJvbSAnQC9jb21wb25lbnQvbWVzc2FnZV9pZnJhbWUvcmVuZGVyX21lc3NhZ2UnO1xuaW1wb3J0IHtcbiAgYWRkUmVuZGVyaW5nT3B0aW1pemVTZXR0aW5ncyxcbiAgcmVtb3ZlUmVuZGVyaW5nT3B0aW1pemVTZXR0aW5ncyxcbn0gZnJvbSAnQC9jb21wb25lbnQvbWVzc2FnZV9pZnJhbWUvcmVuZGVyX29wdGltaXplJztcbmltcG9ydCB7IGdldFNldHRpbmdWYWx1ZSwgc2F2ZVNldHRpbmdWYWx1ZSB9IGZyb20gJ0AvdXRpbC9leHRlbnNpb25fdmFyaWFibGVzJztcblxuaW1wb3J0IHsgcmVsb2FkQ3VycmVudENoYXQsIHRoaXNfY2hpZCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHQnO1xuXG5leHBvcnQgY29uc3QgZGVmYXVsdElmcmFtZVNldHRpbmdzID0ge1xuICByZW5kZXJfZW5hYmxlZDogdHJ1ZSxcbiAgdGFtcGVybW9ua2V5X2NvbXBhdGliaWxpdHk6IGZhbHNlLFxuICByZW5kZXJfZGVwdGg6IDAsXG4gIHJlbmRlcl9vcHRpbWl6ZTogZmFsc2UsXG59O1xuXG4vKipcbiAqIOazqOWFpeWKoOi9veagt+W8j1xuICovXG5leHBvcnQgZnVuY3Rpb24gaW5qZWN0TG9hZGluZ1N0eWxlcygpIHtcbiAgaWYgKCQoJyNpZnJhbWUtbG9hZGluZy1zdHlsZXMnKS5sZW5ndGgpIHJldHVybjtcblxuICBjb25zdCBzdHlsZVNoZWV0ID0gJCgnPHN0eWxlPicsIHtcbiAgICBpZDogJ2lmcmFtZS1sb2FkaW5nLXN0eWxlcycsXG4gICAgdGV4dDogYFxuICAgICAgICAuaWZyYW1lLWxvYWRpbmctb3ZlcmxheXtcbiAgICAgICAgICBwb3NpdGlvbjphYnNvbHV0ZTtcbiAgICAgICAgICB0b3A6MDtcbiAgICAgICAgICBsZWZ0OjA7XG4gICAgICAgICAgcmlnaHQ6MDtcbiAgICAgICAgICBib3R0b206MDtcbiAgICAgICAgICBiYWNrZ3JvdW5kOnJnYmEoMCwwLDAsLjcpO1xuICAgICAgICAgIGRpc3BsYXk6ZmxleDtcbiAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO1xuICAgICAgICAgIGFsaWduLWl0ZW1zOmNlbnRlcjtcbiAgICAgICAgICB6LWluZGV4OjEwMDA7XG4gICAgICAgICAgdHJhbnNpdGlvbjpvcGFjaXR5IC4zcyBlYXNlXG4gICAgICAgIH1cbiAgICAgICAgLmlmcmFtZS1sb2FkaW5nLWNvbnRlbnR7XG4gICAgICAgICAgY29sb3I6I2ZmZjtcbiAgICAgICAgICBkaXNwbGF5OmZsZXg7XG4gICAgICAgICAgYWxpZ24taXRlbXM6Y2VudGVyO1xuICAgICAgICAgIGdhcDoxMHB4O1xuICAgICAgICAgIGZvbnQtc2l6ZToxNnB4XG4gICAgICAgIH1cbiAgICAgICAgLmlmcmFtZS1sb2FkaW5nLWNvbnRlbnQgaXtcbiAgICAgICAgICBmb250LXNpemU6MjBweFxuICAgICAgICB9XG4gICAgICAgIC5sb2FkaW5nLXRleHQge1xuICAgICAgICAgIHRyYW5zaXRpb246IG9wYWNpdHkgMC4zcyBlYXNlO1xuICAgICAgICB9YCxcbiAgfSk7XG5cbiAgJCgnaGVhZCcpLmFwcGVuZChzdHlsZVNoZWV0KTtcbn1cblxuLyoqXG4gKiDmt7vliqDliY3nq6/muLLmn5Plv6vpgJ/mjInpkq5cbiAqL1xuZnVuY3Rpb24gYWRkUmVuZGVyUXVpY2tCdXR0b24oKSB7XG4gIGNvbnN0IGJ1dHRvbkh0bWwgPSAkKGBcbiAgPGRpdiBpZD1cInRhdmVybi1oZWxwZXItcmVuZGVyLWNvbnRhaW5lclwiIGNsYXNzPVwibGlzdC1ncm91cC1pdGVtIGZsZXgtY29udGFpbmVyIGZsZXhHYXA1IGludGVyYWN0YWJsZVwiPlxuICAgICAgPGRpdiBjbGFzcz1cImZhLXNvbGlkIGZhLXB1enpsZS1waWVjZSBleHRlbnNpb25zTWVudUV4dGVuc2lvbkJ1dHRvblwiIC8+PC9kaXY+XG4gICAgICA8c3BhbiBpZD1cInRhdmVybi1oZWxwZXItcmVuZGVyLXRleHRcIj4ke2dldFNldHRpbmdWYWx1ZSgncmVuZGVyLnJlbmRlcl9lbmFibGVkJykgPyAn5YWz6Zet5YmN56uv5riy5p+TJyA6ICflvIDlkK/liY3nq6/muLLmn5MnfTwvc3Bhbj5cbiAgPC9kaXY+YCk7XG4gIGJ1dHRvbkh0bWwuY3NzKCdkaXNwbGF5JywgJ2ZsZXgnKTtcbiAgJCgnI2V4dGVuc2lvbnNNZW51JykuYXBwZW5kKGJ1dHRvbkh0bWwpO1xuICBjb25zdCBpc1JlbmRlckVuYWJsZWQgPSBnZXRTZXR0aW5nVmFsdWUoJ3JlbmRlci5yZW5kZXJfZW5hYmxlZCcpID8/IGRlZmF1bHRJZnJhbWVTZXR0aW5ncy5yZW5kZXJfZW5hYmxlZDtcbiAgJCgnI3RhdmVybi1oZWxwZXItcmVuZGVyLWNvbnRhaW5lcicpLm9uKCdjbGljaycsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAkKCcjdGF2ZXJuLWhlbHBlci1yZW5kZXItdGV4dCcpLnRleHQoIWlzUmVuZGVyRW5hYmxlZCA/ICflhbPpl63liY3nq6/muLLmn5MnIDogJ+W8gOWQr+WJjeerr+a4suafkycpO1xuICAgIGF3YWl0IGhhbmRsZVJlbmRlckVuYWJsZVRvZ2dsZSghaXNSZW5kZXJFbmFibGVkLCB0cnVlKTtcbiAgICAkKCcjcmVuZGVyLWVuYWJsZS10b2dnbGUnKS5wcm9wKCdjaGVja2VkJywgaXNSZW5kZXJFbmFibGVkKTtcbiAgfSk7XG59XG5cbi8qKlxuICog5Yid5aeL5YyWaWZyYW1l5o6n5Yi26Z2i5p2/XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbml0SWZyYW1lUGFuZWwoKSB7XG4gIC8vIOWkhOeQhumHjeWei+WJjeerr+WNoea4suafk+S8mOWMllxuICBjb25zdCBpc1JlbmRlcmluZ09wdGltaXplRW5hYmxlZCA9IGdldFNldHRpbmdWYWx1ZSgncmVuZGVyLnJlbmRlcl9vcHRpbWl6ZScpID8/IGRlZmF1bHRJZnJhbWVTZXR0aW5ncy5yZW5kZXJfb3B0aW1pemU7XG4gIGlmIChpc1JlbmRlcmluZ09wdGltaXplRW5hYmxlZCkge1xuICAgIGF3YWl0IGhhbmRsZVJlbmRlcmluZ09wdGltaXphdGlvblRvZ2dsZSh0cnVlLCBmYWxzZSk7XG4gIH1cbiAgJCgnI3JlbmRlci1vcHRpbWl6ZS10b2dnbGUnKVxuICAgIC5wcm9wKCdjaGVja2VkJywgaXNSZW5kZXJpbmdPcHRpbWl6ZUVuYWJsZWQpXG4gICAgLm9uKCdjbGljaycsIChldmVudDogSlF1ZXJ5LkNsaWNrRXZlbnQpID0+IGhhbmRsZVJlbmRlcmluZ09wdGltaXphdGlvblRvZ2dsZShldmVudC50YXJnZXQuY2hlY2tlZCwgdHJ1ZSkpO1xuICAvLyDlpITnkIblpITnkIbmt7Hluqborr7nva5cbiAgY29uc3QgcmVuZGVyRGVwdGggPSBnZXRTZXR0aW5nVmFsdWUoJ3JlbmRlci5yZW5kZXJfZGVwdGgnKSA/PyBkZWZhdWx0SWZyYW1lU2V0dGluZ3MucmVuZGVyX2RlcHRoO1xuICAkKCcjcmVuZGVyLWRlcHRoJylcbiAgICAudmFsKHJlbmRlckRlcHRoKVxuICAgIC5vbignYmx1cicsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgb25EZXB0aElucHV0KChldmVudC50YXJnZXQgYXMgSFRNTElucHV0RWxlbWVudCkudmFsdWUpO1xuICAgIH0pO1xuXG4gIC8vIOWkhOeQhuayueeMtOWFvOWuueaAp+iuvue9rlxuICBjb25zdCBpc1RhbXBlcm1vbmtleUVuYWJsZWQgPSBnZXRTZXR0aW5nVmFsdWUoJ3JlbmRlci50YW1wZXJtb25rZXlfY29tcGF0aWJpbGl0eScpID8/IGRlZmF1bHRJZnJhbWVTZXR0aW5ncy50YW1wZXJtb25rZXlfY29tcGF0aWJpbGl0eTtcbiAgaWYgKGlzVGFtcGVybW9ua2V5RW5hYmxlZCkge1xuICAgIGhhbmRsZVRhbXBlcm1vbmtleUNvbXBhdGliaWxpdHlDaGFuZ2UodHJ1ZSwgZmFsc2UpO1xuICB9XG4gICQoJyN0YW1wZXJtb25rZXktY29tcGF0aWJpbGl0eS10b2dnbGUnKVxuICAgIC5wcm9wKCdjaGVja2VkJywgaXNUYW1wZXJtb25rZXlFbmFibGVkKVxuICAgIC5vbignY2xpY2snLCAoZXZlbnQ6IEpRdWVyeS5DbGlja0V2ZW50KSA9PiBoYW5kbGVUYW1wZXJtb25rZXlDb21wYXRpYmlsaXR5Q2hhbmdlKGV2ZW50LnRhcmdldC5jaGVja2VkLCB0cnVlKSk7XG5cbiAgLy8g6aaW5YWI5aSE55CG5YmN56uv5riy5p+T6K6+572uIC0g6L+Z5Liq5b+F6aG75YWI5omn6KGM77yM5Zug5Li65a6D5Y+v6IO95Lya6LCD55SocmVsb2FkQ3VycmVudENoYXRcbiAgY29uc3QgaXNSZW5kZXJFbmFibGVkID0gZ2V0U2V0dGluZ1ZhbHVlKCdyZW5kZXIucmVuZGVyX2VuYWJsZWQnKSA/PyBkZWZhdWx0SWZyYW1lU2V0dGluZ3MucmVuZGVyX2VuYWJsZWQ7XG4gIGF3YWl0IGhhbmRsZVJlbmRlckVuYWJsZVRvZ2dsZShpc1JlbmRlckVuYWJsZWQsIGZhbHNlKTtcbiAgJCgnI3JlbmRlci1lbmFibGUtdG9nZ2xlJylcbiAgICAucHJvcCgnY2hlY2tlZCcsIGlzUmVuZGVyRW5hYmxlZClcbiAgICAub24oJ2NsaWNrJywgKGV2ZW50OiBKUXVlcnkuQ2xpY2tFdmVudCkgPT4gaGFuZGxlUmVuZGVyRW5hYmxlVG9nZ2xlKGV2ZW50LnRhcmdldC5jaGVja2VkLCB0cnVlKSk7XG5cbiAgLy8g5aSE55CG5Luj56CB5Z2X5oqY5Y+g6K6+572uIC0g6L+Z5Liq5pS+5Zyo5riy5p+T6K6+572u5LmL5ZCO77yM56Gu5L+d5LiN6KKrcmVsb2FkQ3VycmVudENoYXTmuIXpmaRcbiAgY29uc3QgaXNSZW5kZXJpbmdIaWRlU3R5bGVFbmFibGVkID0gZ2V0U2V0dGluZ1ZhbHVlKCdyZW5kZXIucmVuZGVyX2hpZGVfc3R5bGUnKTtcbiAgaWYgKGlzUmVuZGVyaW5nSGlkZVN0eWxlRW5hYmxlZCkge1xuICAgIGF3YWl0IGhhbmRsZVJlbmRlcmluZ0hpZGVTdHlsZVRvZ2dsZSh0cnVlLCBmYWxzZSk7XG4gIH1cbiAgJCgnI3JlbmRlci1oaWRlLXN0eWxlLXRvZ2dsZScpXG4gICAgLnByb3AoJ2NoZWNrZWQnLCBpc1JlbmRlcmluZ0hpZGVTdHlsZUVuYWJsZWQpXG4gICAgLm9uKCdjbGljaycsIChldmVudDogSlF1ZXJ5LkNsaWNrRXZlbnQpID0+IGhhbmRsZVJlbmRlcmluZ0hpZGVTdHlsZVRvZ2dsZShldmVudC50YXJnZXQuY2hlY2tlZCwgdHJ1ZSkpO1xuXG4gICQod2luZG93KS5vbigncmVzaXplJywgZnVuY3Rpb24gKCkge1xuICAgIGlmICgkKCdpZnJhbWVbZGF0YS1uZWVkcy12aD1cInRydWVcIl0nKS5sZW5ndGgpIHtcbiAgICAgIHVwZGF0ZUlmcmFtZVZpZXdwb3J0SGVpZ2h0KCk7XG4gICAgfVxuICB9KTtcblxuICBhZGRSZW5kZXJRdWlja0J1dHRvbigpO1xuICBpbmplY3RMb2FkaW5nU3R5bGVzKCk7XG4gIHNldHVwSWZyYW1lUmVtb3ZhbExpc3RlbmVyKCk7XG59XG5cbi8qKlxuICog5aSE55CG5rex5bqm6L6T5YWl5pS55Y+Y5pe2XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBvbkRlcHRoSW5wdXQodmFsdWU6IHN0cmluZykge1xuICBjb25zdCBwcm9jZXNzRGVwdGggPSBwYXJzZUludCh2YWx1ZSwgMTApO1xuXG4gIGlmIChwcm9jZXNzRGVwdGggPCAwKSB7XG4gICAgdG9hc3RyLndhcm5pbmcoJ+WkhOeQhua3seW6puS4jeiDveS4uui0n+aVsCcpO1xuICAgICQoJyNyZW5kZXItZGVwdGgnKS52YWwoZ2V0U2V0dGluZ1ZhbHVlKCdyZW5kZXIucmVuZGVyX2RlcHRoJykpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHNhdmVTZXR0aW5nVmFsdWUoJ3JlbmRlci5yZW5kZXJfZGVwdGgnLCBwcm9jZXNzRGVwdGgpO1xuXG4gIGF3YWl0IGNsZWFyQW5kUmVuZGVyQWxsSWZyYW1lcygpO1xufVxuXG4vKipcbiAqIOWkhOeQhua4suafk+WZqOWQr+eUqOiuvue9ruaUueWPmFxuICogQHBhcmFtIGVuYWJsZSDmmK/lkKblkK/nlKjmuLLmn5PlmahcbiAqIEBwYXJhbSB1c2VySW5wdXQg5piv5ZCm55Sx55So5oi35omL5Yqo6Kem5Y+RXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYW5kbGVSZW5kZXJFbmFibGVUb2dnbGUoZW5hYmxlOiBib29sZWFuLCB1c2VySW5wdXQ6IGJvb2xlYW4gPSB0cnVlKSB7XG4gIGlmICh1c2VySW5wdXQpIHtcbiAgICBzYXZlU2V0dGluZ1ZhbHVlKCdyZW5kZXIucmVuZGVyX2VuYWJsZWQnLCBlbmFibGUpO1xuICB9XG4gIGlmIChlbmFibGUpIHtcbiAgICAkKCcjcmVuZGVyLXNldHRpbmdzLWNvbnRlbnQgLmV4dGVuc2lvbi1jb250ZW50LWl0ZW0nKS5zbGljZSgzKS5jc3MoJ29wYWNpdHknLCAxKTtcbiAgICBhd2FpdCByZW5kZXJBbGxJZnJhbWVzKCk7XG4gIH0gZWxzZSB7XG4gICAgJCgnI3JlbmRlci1zZXR0aW5ncy1jb250ZW50IC5leHRlbnNpb24tY29udGVudC1pdGVtJykuc2xpY2UoMykuY3NzKCdvcGFjaXR5JywgMC41KTtcbiAgICBhd2FpdCBjbGVhckFsbElmcmFtZXMoKTtcbiAgICBpZiAodXNlcklucHV0ICYmIHRoaXNfY2hpZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBhd2FpdCByZWxvYWRDdXJyZW50Q2hhdCgpO1xuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIOWkhOeQhuS7o+eggeWdl+aKmOWPoOiuvue9ruaUueWPmFxuICogQHBhcmFtIGVuYWJsZSDmmK/lkKblkK/nlKjku6PnoIHlnZfmipjlj6BcbiAqIEBwYXJhbSB1c2VySW5wdXQg5piv5ZCm55Sx55So5oi35omL5Yqo6Kem5Y+RXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYW5kbGVSZW5kZXJpbmdIaWRlU3R5bGVUb2dnbGUoZW5hYmxlOiBib29sZWFuLCB1c2VySW5wdXQ6IGJvb2xlYW4gPSB0cnVlKSB7XG4gIGlmICh1c2VySW5wdXQpIHtcbiAgICBzYXZlU2V0dGluZ1ZhbHVlKCdyZW5kZXIucmVuZGVyX2hpZGVfc3R5bGUnLCBlbmFibGUpO1xuICB9XG5cbiAgaWYgKGVuYWJsZSkge1xuICAgIGFkZFJlbmRlcmluZ0hpZGVTdHlsZVNldHRpbmdzKCk7XG4gICAgaWYgKHVzZXJJbnB1dCkge1xuICAgICAgYXdhaXQgY2xlYXJBbmRSZW5kZXJBbGxJZnJhbWVzKCk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJlbW92ZVJlbmRlcmluZ0hpZGVTdHlsZVNldHRpbmdzKCk7XG4gICAgaWYgKHVzZXJJbnB1dCkge1xuICAgICAgYXdhaXQgY2xlYXJBbmRSZW5kZXJBbGxJZnJhbWVzKCk7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICog5aSE55CG6YeN5Z6L5YmN56uv5Y2h5riy5p+T5LyY5YyWXG4gKiBAcGFyYW0gZW5hYmxlIOaYr+WQpuWQr+eUqOmHjeWei+WJjeerr+WNoea4suafk+S8mOWMllxuICogQHBhcmFtIHVzZXJJbnB1dCDmmK/lkKbnlLHnlKjmiLfmiYvliqjop6blj5FcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZVJlbmRlcmluZ09wdGltaXphdGlvblRvZ2dsZShlbmFibGU6IGJvb2xlYW4sIHVzZXJJbnB1dDogYm9vbGVhbiA9IHRydWUpIHtcbiAgaWYgKHVzZXJJbnB1dCkge1xuICAgIHNhdmVTZXR0aW5nVmFsdWUoJ3JlbmRlci5yZW5kZXJfb3B0aW1pemUnLCBlbmFibGUpO1xuICB9XG5cbiAgaWYgKGVuYWJsZSkge1xuICAgIGFkZFJlbmRlcmluZ09wdGltaXplU2V0dGluZ3MoKTtcbiAgICBpZiAodXNlcklucHV0KSB7XG4gICAgICBhd2FpdCBjbGVhckFuZFJlbmRlckFsbElmcmFtZXMoKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgcmVtb3ZlUmVuZGVyaW5nT3B0aW1pemVTZXR0aW5ncygpO1xuICAgIGlmICh1c2VySW5wdXQpIHtcbiAgICAgIGF3YWl0IGNsZWFyQW5kUmVuZGVyQWxsSWZyYW1lcygpO1xuICAgIH1cbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/component/message_iframe/index.ts\n")},"./src/component/message_iframe/render_hide_style.ts":
/*!***********************************************************!*\
  !*** ./src/component/message_iframe/render_hide_style.ts ***!
  \***********************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addCodeToggleButtonsToAllMessages: () => (/* binding */ addCodeToggleButtonsToAllMessages),\n/* harmony export */   addRenderingHideStyleSettings: () => (/* binding */ addRenderingHideStyleSettings),\n/* harmony export */   addToggleButtonToCodeBlock: () => (/* binding */ addToggleButtonToCodeBlock),\n/* harmony export */   injectCodeBlockHideStyles: () => (/* binding */ injectCodeBlockHideStyles),\n/* harmony export */   removeAllCodeToggleButtons: () => (/* binding */ removeAllCodeToggleButtons),\n/* harmony export */   removeCodeToggleButtonsByMesId: () => (/* binding */ removeCodeToggleButtonsByMesId),\n/* harmony export */   removeRenderingHideStyleSettings: () => (/* binding */ removeRenderingHideStyleSettings)\n/* harmony export */ });\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n\n/**\n * 注入代码块隐藏样式\n */\nfunction injectCodeBlockHideStyles() {\n    const styleId = 'hidden-code-block-styles';\n    let style = document.getElementById(styleId);\n    if (!style) {\n        style = document.createElement('style');\n        style.setAttribute('type', 'text/css');\n        style.setAttribute('id', styleId);\n        document.head.appendChild(style);\n    }\n    style.innerHTML = `\n      pre {\n        display: none;\n      }\n      .code-toggle-button {\n        display: inline-block;\n        margin: 5px 0;\n        padding: 5px 10px;\n        background-color: rgba(0, 0, 0, 0.1);\n        border-radius: 4px;\n        cursor: pointer;\n        font-size: 0.9em;\n        user-select: none;\n        transition: background-color 0.3s;\n      }\n      .code-toggle-button:hover {\n        background-color: rgba(0, 0, 0, 0.2);\n      }\n      .popup:has(#qr--modalEditor) .popup-content > #qr--modalEditor > #qr--main > .qr--modal-messageContainer > #qr--modal-messageHolder > #qr--modal-message {\n        color: var(--SmartThemeEmColor) !important;\n      }\n    `;\n}\n/**\n * 移除代码块隐藏样式\n */\nfunction removeCodeBlockHideStyles() {\n    const styleId = 'hidden-code-block-styles';\n    const style = document.getElementById(styleId);\n    if (style) {\n        style.remove();\n    }\n}\n/**\n * 为单个代码块添加折叠按钮\n * @param $pre 代码块元素\n */\nfunction addToggleButtonToCodeBlock($pre) {\n    if (!(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.getSettingValue)('render.render_hide_style')) {\n        return;\n    }\n    if ($pre.prev('.code-toggle-button').length > 0) {\n        return;\n    }\n    const $toggleButton = $('<div class=\"code-toggle-button\" title=\"关闭[酒馆助手-渲染器-渲染优化]以取消此折叠功能\">显示代码块</div>');\n    $toggleButton.on('click', function () {\n        const isVisible = $pre.is(':visible');\n        if (isVisible) {\n            $pre.hide();\n            $(this).text('显示代码块');\n        }\n        else {\n            $pre.show();\n            $(this).text('隐藏代码块');\n        }\n    });\n    $pre.before($toggleButton);\n}\n/**\n * 为消息添加折叠控件\n * @param $mesText 消息文本元素\n */\nfunction addToggleButtonsToMessage($mesText) {\n    if ($mesText.find('.code-toggle-button').length > 0 || $mesText.find('pre').length === 0) {\n        return;\n    }\n    $mesText.find('pre').each(function (_index, element) {\n        const $pre = $(element);\n        const $code = $pre.find('code');\n        if ($code.length) {\n            addToggleButtonToCodeBlock($pre);\n        }\n    });\n}\n/**\n * 给所有消息添加折叠控件\n */\nfunction addCodeToggleButtonsToAllMessages() {\n    if (!(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.getSettingValue)('render.render_hide_style') || (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.getSettingValue)('render.render_enabled')) {\n        return;\n    }\n    const $chat = $('#chat');\n    if (!$chat.length) {\n        return;\n    }\n    $chat.find('.mes .mes_block .mes_text, .mes .mes_block .mes_reasoning_details').each(function (_index, element) {\n        const $mesText = $(element);\n        addToggleButtonsToMessage($mesText);\n    });\n}\n/**\n * 根据mesId移除折叠控件\n * @param mesId 消息ID\n */\nfunction removeCodeToggleButtonsByMesId(mesId) {\n    const $messageElement = $(`div[mesid=\"${mesId}\"] .mes_text .code-toggle-button`);\n    $messageElement.each(function () {\n        $(this).off('click').remove();\n    });\n}\n/**\n * 移除所有折叠控件\n */\nfunction removeAllCodeToggleButtons() {\n    $('.code-toggle-button').each(function () {\n        $(this).off('click').remove();\n    });\n    // 去掉所有pre的display:none\n    $('pre').css('display', 'block');\n}\n/**\n * 添加代码块折叠设置\n */\nfunction addRenderingHideStyleSettings() {\n    injectCodeBlockHideStyles();\n    addCodeToggleButtonsToAllMessages();\n}\n/**\n * 移除代码块折叠设置\n */\nfunction removeRenderingHideStyleSettings() {\n    removeCodeBlockHideStyles();\n    removeAllCodeToggleButtons();\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L21lc3NhZ2VfaWZyYW1lL3JlbmRlcl9oaWRlX3N0eWxlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQTZEO0FBRTdEOztHQUVHO0FBQ0ksU0FBUyx5QkFBeUI7SUFDdkMsTUFBTSxPQUFPLEdBQUcsMEJBQTBCLENBQUM7SUFDM0MsSUFBSSxLQUFLLEdBQUcsUUFBUSxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUM3QyxJQUFJLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDWCxLQUFLLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUN4QyxLQUFLLENBQUMsWUFBWSxDQUFDLE1BQU0sRUFBRSxVQUFVLENBQUMsQ0FBQztRQUN2QyxLQUFLLENBQUMsWUFBWSxDQUFDLElBQUksRUFBRSxPQUFPLENBQUMsQ0FBQztRQUNsQyxRQUFRLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUNuQyxDQUFDO0lBQ0QsS0FBSyxDQUFDLFNBQVMsR0FBRzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0tBcUJmLENBQUM7QUFDTixDQUFDO0FBRUQ7O0dBRUc7QUFDSCxTQUFTLHlCQUF5QjtJQUNoQyxNQUFNLE9BQU8sR0FBRywwQkFBMEIsQ0FBQztJQUMzQyxNQUFNLEtBQUssR0FBRyxRQUFRLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQy9DLElBQUksS0FBSyxFQUFFLENBQUM7UUFDVixLQUFLLENBQUMsTUFBTSxFQUFFLENBQUM7SUFDakIsQ0FBQztBQUNILENBQUM7QUFFRDs7O0dBR0c7QUFDSSxTQUFTLDBCQUEwQixDQUFDLElBQXlCO0lBQ2xFLElBQUksQ0FBQywwRUFBZSxDQUFDLDBCQUEwQixDQUFDLEVBQUUsQ0FBQztRQUNqRCxPQUFPO0lBQ1QsQ0FBQztJQUVELElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUUsQ0FBQztRQUNoRCxPQUFPO0lBQ1QsQ0FBQztJQUVELE1BQU0sYUFBYSxHQUFHLENBQUMsQ0FDckIsK0VBQStFLENBQ2hGLENBQUM7SUFFRixhQUFhLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRTtRQUN4QixNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsRUFBRSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBRXRDLElBQUksU0FBUyxFQUFFLENBQUM7WUFDZCxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7WUFDWixDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ3hCLENBQUM7YUFBTSxDQUFDO1lBQ04sSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDO1lBQ1osQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUN4QixDQUFDO0lBQ0gsQ0FBQyxDQUFDLENBQUM7SUFFSCxJQUFJLENBQUMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxDQUFDO0FBQzdCLENBQUM7QUFFRDs7O0dBR0c7QUFDSCxTQUFTLHlCQUF5QixDQUFDLFFBQTZCO0lBQzlELElBQUksUUFBUSxDQUFDLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDLE1BQU0sR0FBRyxDQUFDLElBQUksUUFBUSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFLENBQUM7UUFDekYsT0FBTztJQUNULENBQUM7SUFFRCxRQUFRLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLE1BQU0sRUFBRSxPQUFPO1FBQ2pELE1BQU0sSUFBSSxHQUFHLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUN4QixNQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ2hDLElBQUksS0FBSyxDQUFDLE1BQU0sRUFBRSxDQUFDO1lBQ2pCLDBCQUEwQixDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ25DLENBQUM7SUFDSCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUM7QUFFRDs7R0FFRztBQUNJLFNBQVMsaUNBQWlDO0lBQy9DLElBQUksQ0FBQywwRUFBZSxDQUFDLDBCQUEwQixDQUFDLElBQUksMEVBQWUsQ0FBQyx1QkFBdUIsQ0FBQyxFQUFFLENBQUM7UUFDN0YsT0FBTztJQUNULENBQUM7SUFDRCxNQUFNLEtBQUssR0FBRyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDekIsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUNsQixPQUFPO0lBQ1QsQ0FBQztJQUVELEtBQUssQ0FBQyxJQUFJLENBQUMsbUVBQW1FLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxNQUFNLEVBQUUsT0FBTztRQUM1RyxNQUFNLFFBQVEsR0FBRyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDNUIseUJBQXlCLENBQUMsUUFBUSxDQUFDLENBQUM7SUFDdEMsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDO0FBRUQ7OztHQUdHO0FBQ0ksU0FBUyw4QkFBOEIsQ0FBQyxLQUFhO0lBQzFELE1BQU0sZUFBZSxHQUFHLENBQUMsQ0FBQyxjQUFjLEtBQUssa0NBQWtDLENBQUMsQ0FBQztJQUNqRixlQUFlLENBQUMsSUFBSSxDQUFDO1FBQ25CLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUM7SUFDaEMsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDO0FBRUQ7O0dBRUc7QUFDSSxTQUFTLDBCQUEwQjtJQUN4QyxDQUFDLENBQUMscUJBQXFCLENBQUMsQ0FBQyxJQUFJLENBQUM7UUFDNUIsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQztJQUNoQyxDQUFDLENBQUMsQ0FBQztJQUNILHVCQUF1QjtJQUN2QixDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsR0FBRyxDQUFDLFNBQVMsRUFBRSxPQUFPLENBQUMsQ0FBQztBQUNuQyxDQUFDO0FBRUQ7O0dBRUc7QUFDSSxTQUFTLDZCQUE2QjtJQUMzQyx5QkFBeUIsRUFBRSxDQUFDO0lBQzVCLGlDQUFpQyxFQUFFLENBQUM7QUFDdEMsQ0FBQztBQUVEOztHQUVHO0FBQ0ksU0FBUyxnQ0FBZ0M7SUFDOUMseUJBQXlCLEVBQUUsQ0FBQztJQUM1QiwwQkFBMEIsRUFBRSxDQUFDO0FBQy9CLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvY29tcG9uZW50L21lc3NhZ2VfaWZyYW1lL3JlbmRlcl9oaWRlX3N0eWxlLnRzPzMwMTIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ2V0U2V0dGluZ1ZhbHVlIH0gZnJvbSAnQC91dGlsL2V4dGVuc2lvbl92YXJpYWJsZXMnO1xuXG4vKipcbiAqIOazqOWFpeS7o+eggeWdl+makOiXj+agt+W8j1xuICovXG5leHBvcnQgZnVuY3Rpb24gaW5qZWN0Q29kZUJsb2NrSGlkZVN0eWxlcygpIHtcbiAgY29uc3Qgc3R5bGVJZCA9ICdoaWRkZW4tY29kZS1ibG9jay1zdHlsZXMnO1xuICBsZXQgc3R5bGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChzdHlsZUlkKTtcbiAgaWYgKCFzdHlsZSkge1xuICAgIHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTtcbiAgICBzdHlsZS5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAndGV4dC9jc3MnKTtcbiAgICBzdHlsZS5zZXRBdHRyaWJ1dGUoJ2lkJywgc3R5bGVJZCk7XG4gICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzdHlsZSk7XG4gIH1cbiAgc3R5bGUuaW5uZXJIVE1MID0gYFxuICAgICAgcHJlIHtcbiAgICAgICAgZGlzcGxheTogbm9uZTtcbiAgICAgIH1cbiAgICAgIC5jb2RlLXRvZ2dsZS1idXR0b24ge1xuICAgICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gICAgICAgIG1hcmdpbjogNXB4IDA7XG4gICAgICAgIHBhZGRpbmc6IDVweCAxMHB4O1xuICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDAsIDAsIDAsIDAuMSk7XG4gICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgICBmb250LXNpemU6IDAuOWVtO1xuICAgICAgICB1c2VyLXNlbGVjdDogbm9uZTtcbiAgICAgICAgdHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjNzO1xuICAgICAgfVxuICAgICAgLmNvZGUtdG9nZ2xlLWJ1dHRvbjpob3ZlciB7XG4gICAgICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMCwgMCwgMC4yKTtcbiAgICAgIH1cbiAgICAgIC5wb3B1cDpoYXMoI3FyLS1tb2RhbEVkaXRvcikgLnBvcHVwLWNvbnRlbnQgPiAjcXItLW1vZGFsRWRpdG9yID4gI3FyLS1tYWluID4gLnFyLS1tb2RhbC1tZXNzYWdlQ29udGFpbmVyID4gI3FyLS1tb2RhbC1tZXNzYWdlSG9sZGVyID4gI3FyLS1tb2RhbC1tZXNzYWdlIHtcbiAgICAgICAgY29sb3I6IHZhcigtLVNtYXJ0VGhlbWVFbUNvbG9yKSAhaW1wb3J0YW50O1xuICAgICAgfVxuICAgIGA7XG59XG5cbi8qKlxuICog56e76Zmk5Luj56CB5Z2X6ZqQ6JeP5qC35byPXG4gKi9cbmZ1bmN0aW9uIHJlbW92ZUNvZGVCbG9ja0hpZGVTdHlsZXMoKSB7XG4gIGNvbnN0IHN0eWxlSWQgPSAnaGlkZGVuLWNvZGUtYmxvY2stc3R5bGVzJztcbiAgY29uc3Qgc3R5bGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChzdHlsZUlkKTtcbiAgaWYgKHN0eWxlKSB7XG4gICAgc3R5bGUucmVtb3ZlKCk7XG4gIH1cbn1cblxuLyoqXG4gKiDkuLrljZXkuKrku6PnoIHlnZfmt7vliqDmipjlj6DmjInpkq5cbiAqIEBwYXJhbSAkcHJlIOS7o+eggeWdl+WFg+e0oFxuICovXG5leHBvcnQgZnVuY3Rpb24gYWRkVG9nZ2xlQnV0dG9uVG9Db2RlQmxvY2soJHByZTogSlF1ZXJ5PEhUTUxFbGVtZW50Pikge1xuICBpZiAoIWdldFNldHRpbmdWYWx1ZSgncmVuZGVyLnJlbmRlcl9oaWRlX3N0eWxlJykpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoJHByZS5wcmV2KCcuY29kZS10b2dnbGUtYnV0dG9uJykubGVuZ3RoID4gMCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0ICR0b2dnbGVCdXR0b24gPSAkKFxuICAgICc8ZGl2IGNsYXNzPVwiY29kZS10b2dnbGUtYnV0dG9uXCIgdGl0bGU9XCLlhbPpl61b6YWS6aaG5Yqp5omLLea4suafk+WZqC3muLLmn5PkvJjljJZd5Lul5Y+W5raI5q2k5oqY5Y+g5Yqf6IO9XCI+5pi+56S65Luj56CB5Z2XPC9kaXY+JyxcbiAgKTtcblxuICAkdG9nZ2xlQnV0dG9uLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBpc1Zpc2libGUgPSAkcHJlLmlzKCc6dmlzaWJsZScpO1xuXG4gICAgaWYgKGlzVmlzaWJsZSkge1xuICAgICAgJHByZS5oaWRlKCk7XG4gICAgICAkKHRoaXMpLnRleHQoJ+aYvuekuuS7o+eggeWdlycpO1xuICAgIH0gZWxzZSB7XG4gICAgICAkcHJlLnNob3coKTtcbiAgICAgICQodGhpcykudGV4dCgn6ZqQ6JeP5Luj56CB5Z2XJyk7XG4gICAgfVxuICB9KTtcblxuICAkcHJlLmJlZm9yZSgkdG9nZ2xlQnV0dG9uKTtcbn1cblxuLyoqXG4gKiDkuLrmtojmga/mt7vliqDmipjlj6Dmjqfku7ZcbiAqIEBwYXJhbSAkbWVzVGV4dCDmtojmga/mlofmnKzlhYPntKBcbiAqL1xuZnVuY3Rpb24gYWRkVG9nZ2xlQnV0dG9uc1RvTWVzc2FnZSgkbWVzVGV4dDogSlF1ZXJ5PEhUTUxFbGVtZW50Pikge1xuICBpZiAoJG1lc1RleHQuZmluZCgnLmNvZGUtdG9nZ2xlLWJ1dHRvbicpLmxlbmd0aCA+IDAgfHwgJG1lc1RleHQuZmluZCgncHJlJykubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgJG1lc1RleHQuZmluZCgncHJlJykuZWFjaChmdW5jdGlvbiAoX2luZGV4LCBlbGVtZW50KSB7XG4gICAgY29uc3QgJHByZSA9ICQoZWxlbWVudCk7XG4gICAgY29uc3QgJGNvZGUgPSAkcHJlLmZpbmQoJ2NvZGUnKTtcbiAgICBpZiAoJGNvZGUubGVuZ3RoKSB7XG4gICAgICBhZGRUb2dnbGVCdXR0b25Ub0NvZGVCbG9jaygkcHJlKTtcbiAgICB9XG4gIH0pO1xufVxuXG4vKipcbiAqIOe7meaJgOaciea2iOaBr+a3u+WKoOaKmOWPoOaOp+S7tlxuICovXG5leHBvcnQgZnVuY3Rpb24gYWRkQ29kZVRvZ2dsZUJ1dHRvbnNUb0FsbE1lc3NhZ2VzKCkge1xuICBpZiAoIWdldFNldHRpbmdWYWx1ZSgncmVuZGVyLnJlbmRlcl9oaWRlX3N0eWxlJykgfHwgZ2V0U2V0dGluZ1ZhbHVlKCdyZW5kZXIucmVuZGVyX2VuYWJsZWQnKSkge1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCAkY2hhdCA9ICQoJyNjaGF0Jyk7XG4gIGlmICghJGNoYXQubGVuZ3RoKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgJGNoYXQuZmluZCgnLm1lcyAubWVzX2Jsb2NrIC5tZXNfdGV4dCwgLm1lcyAubWVzX2Jsb2NrIC5tZXNfcmVhc29uaW5nX2RldGFpbHMnKS5lYWNoKGZ1bmN0aW9uIChfaW5kZXgsIGVsZW1lbnQpIHtcbiAgICBjb25zdCAkbWVzVGV4dCA9ICQoZWxlbWVudCk7XG4gICAgYWRkVG9nZ2xlQnV0dG9uc1RvTWVzc2FnZSgkbWVzVGV4dCk7XG4gIH0pO1xufVxuXG4vKipcbiAqIOagueaNrm1lc0lk56e76Zmk5oqY5Y+g5o6n5Lu2XG4gKiBAcGFyYW0gbWVzSWQg5raI5oGvSURcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUNvZGVUb2dnbGVCdXR0b25zQnlNZXNJZChtZXNJZDogbnVtYmVyKSB7XG4gIGNvbnN0ICRtZXNzYWdlRWxlbWVudCA9ICQoYGRpdlttZXNpZD1cIiR7bWVzSWR9XCJdIC5tZXNfdGV4dCAuY29kZS10b2dnbGUtYnV0dG9uYCk7XG4gICRtZXNzYWdlRWxlbWVudC5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAkKHRoaXMpLm9mZignY2xpY2snKS5yZW1vdmUoKTtcbiAgfSk7XG59XG5cbi8qKlxuICog56e76Zmk5omA5pyJ5oqY5Y+g5o6n5Lu2XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVBbGxDb2RlVG9nZ2xlQnV0dG9ucygpIHtcbiAgJCgnLmNvZGUtdG9nZ2xlLWJ1dHRvbicpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICQodGhpcykub2ZmKCdjbGljaycpLnJlbW92ZSgpO1xuICB9KTtcbiAgLy8g5Y675o6J5omA5pyJcHJl55qEZGlzcGxheTpub25lXG4gICQoJ3ByZScpLmNzcygnZGlzcGxheScsICdibG9jaycpO1xufVxuXG4vKipcbiAqIOa3u+WKoOS7o+eggeWdl+aKmOWPoOiuvue9rlxuICovXG5leHBvcnQgZnVuY3Rpb24gYWRkUmVuZGVyaW5nSGlkZVN0eWxlU2V0dGluZ3MoKSB7XG4gIGluamVjdENvZGVCbG9ja0hpZGVTdHlsZXMoKTtcbiAgYWRkQ29kZVRvZ2dsZUJ1dHRvbnNUb0FsbE1lc3NhZ2VzKCk7XG59XG5cbi8qKlxuICog56e76Zmk5Luj56CB5Z2X5oqY5Y+g6K6+572uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVSZW5kZXJpbmdIaWRlU3R5bGVTZXR0aW5ncygpIHtcbiAgcmVtb3ZlQ29kZUJsb2NrSGlkZVN0eWxlcygpO1xuICByZW1vdmVBbGxDb2RlVG9nZ2xlQnV0dG9ucygpO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/component/message_iframe/render_hide_style.ts\n")},"./src/component/message_iframe/render_message.ts":
/*!********************************************************!*\
  !*** ./src/component/message_iframe/render_message.ts ***!
  \********************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   clearAllIframes: () => (/* binding */ clearAllIframes),\n/* harmony export */   clearAndRenderAllIframes: () => (/* binding */ clearAndRenderAllIframes),\n/* harmony export */   destroyIframe: () => (/* binding */ destroyIframe),\n/* harmony export */   handlePartialRender: () => (/* binding */ handlePartialRender),\n/* harmony export */   handleRenderToggle: () => (/* binding */ handleRenderToggle),\n/* harmony export */   handleTampermonkeyCompatibilityChange: () => (/* binding */ handleTampermonkeyCompatibilityChange),\n/* harmony export */   partialRenderEvents: () => (/* binding */ partialRenderEvents),\n/* harmony export */   renderAllIframes: () => (/* binding */ renderAllIframes),\n/* harmony export */   renderMessageAfterDelete: () => (/* binding */ renderMessageAfterDelete),\n/* harmony export */   renderPartialIframes: () => (/* binding */ renderPartialIframes),\n/* harmony export */   setupIframeRemovalListener: () => (/* binding */ setupIframeRemovalListener),\n/* harmony export */   tampermonkey_script: () => (/* binding */ tampermonkey_script),\n/* harmony export */   updateIframeViewportHeight: () => (/* binding */ updateIframeViewportHeight),\n/* harmony export */   viewport_adjust_script: () => (/* binding */ viewport_adjust_script)\n/* harmony export */ });\n/* harmony import */ var _component_message_iframe_render_hide_style__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/message_iframe/render_hide_style */ \"./src/component/message_iframe/render_hide_style.ts\");\n/* harmony import */ var _component_message_iframe_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/component/message_iframe/utils */ \"./src/component/message_iframe/utils.ts\");\n/* harmony import */ var _script_url__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/script_url */ \"./src/script_url.ts\");\n/* harmony import */ var _third_party_html__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/third_party.html */ \"./src/third_party.html\");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n\n\n\n\n\n\n\nlet tampermonkeyMessageListener = null;\nconst RENDER_MODES = {\n    FULL: 'FULL',\n    PARTIAL: 'PARTIAL',\n};\n/**\n * 渲染消息到iframe\n * @param mode 渲染模式\n * @param specificMesId 指定消息ID\n */\nasync function renderMessagesInIframes(mode = RENDER_MODES.FULL, specificMesId = null) {\n    if (!(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_4__.getSettingValue)('enabled_extension') || !(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_4__.getSettingValue)('render.render_enabled')) {\n        return;\n    }\n    const context = (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_6__.getContext)();\n    const totalMessages = context.chat.length;\n    const processDepth = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_4__.getSettingValue)('render.render_depth') ?? 0;\n    const depthLimit = processDepth > 0 ? processDepth : totalMessages;\n    const depthLimitedMessageIds = [...Array(totalMessages).keys()].slice(-depthLimit);\n    let messagesToRenderIds = [];\n    const messagesToCancelIds = [...Array(totalMessages).keys()].filter(id => !depthLimitedMessageIds.includes(id));\n    if (mode === RENDER_MODES.FULL) {\n        messagesToRenderIds = depthLimitedMessageIds;\n    }\n    else if (mode === RENDER_MODES.PARTIAL && specificMesId !== null) {\n        if (depthLimitedMessageIds.includes(specificMesId)) {\n            messagesToRenderIds = [specificMesId];\n        }\n        else {\n            return;\n        }\n    }\n    for (const messageId of messagesToCancelIds) {\n        const message = context.chat[messageId];\n        const $iframes = $(`[id^=\"message-iframe-${messageId}-\"]`);\n        if ($iframes.length > 0) {\n            await Promise.all($iframes.toArray().map(async (iframe) => {\n                await destroyIframe(iframe);\n            }));\n            (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_5__.updateMessageBlock)(messageId, message);\n        }\n        if ((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_4__.getSettingValue)('render.render_hide_style')) {\n            const $mesTexts = $(`.mes[mesid=\"${messageId}\"] .mes_block .mes_reasoning_details, .mes[mesid=\"${messageId}\"] .mes_block .mes_text`);\n            $mesTexts.each(function () {\n                const $codeBlock = $(this).find('pre');\n                if ($codeBlock.length) {\n                    (0,_component_message_iframe_render_hide_style__WEBPACK_IMPORTED_MODULE_0__.addToggleButtonToCodeBlock)($codeBlock);\n                }\n            });\n        }\n    }\n    for (const messageId of messagesToRenderIds) {\n        const $messageElement = $(`.mes[mesid=\"${messageId}\"]`);\n        if (!$messageElement.length) {\n            log.debug(`未找到 mesid: ${messageId} 对应的消息元素。`);\n            continue;\n        }\n        const $codeElements = $messageElement.find('pre');\n        if (!$codeElements.length) {\n            continue;\n        }\n        let iframeCounter = 1;\n        $codeElements.each(function () {\n            let extractedText = (0,_component_message_iframe_utils__WEBPACK_IMPORTED_MODULE_1__.extractTextFromCode)(this);\n            if (extractedText.includes('<body') && extractedText.includes('</body>')) {\n                const disableLoading = /\x3c!--\\s*disable-default-loading\\s*--\x3e/.test(extractedText);\n                const hasMinVh = /min-height:\\s*[^;]*vh/.test(extractedText);\n                const hasJsVhUsage = /\\d+vh/.test(extractedText);\n                if (hasMinVh || hasJsVhUsage) {\n                    extractedText = processAllVhUnits(extractedText);\n                }\n                const needsVhHandling = hasMinVh || hasJsVhUsage;\n                let $wrapper = $('<div>').css({\n                    position: 'relative',\n                    width: '100%',\n                });\n                const $iframe = $('<iframe>')\n                    .attr({\n                    id: `message-iframe-${messageId}-${iframeCounter}`,\n                    loading: 'lazy',\n                })\n                    .css({\n                    margin: '5px auto',\n                    border: 'none',\n                    width: '100%',\n                });\n                iframeCounter++;\n                if (needsVhHandling) {\n                    $iframe.attr('data-needs-vh', 'true');\n                }\n                let loadingTimeout = null;\n                if (!disableLoading) {\n                    const $loadingOverlay = $('<div>').addClass('iframe-loading-overlay').html(`\n                <div class=\"iframe-loading-content\">\n                  <i class=\"fa-solid fa-spinner fa-spin\"></i>\n                  <span class=\"loading-text\">Loading...</span>\n                </div>`);\n                    loadingTimeout = setTimeout(() => {\n                        const $loadingText = $loadingOverlay.find('.loading-text');\n                        if ($loadingText.length) {\n                            $loadingText.text('如加载时间过长，请检查网络');\n                        }\n                    }, 10000);\n                    $wrapper.append($loadingOverlay);\n                }\n                $wrapper.append($iframe);\n                const srcdocContent = `\n            <html>\n            <head>\n              <style>\n              ${needsVhHandling ? `:root{--viewport-height:${window.innerHeight}px;}` : ``}\n              html,body{margin:0;padding:0;overflow:hidden!important;max-width:100%!important;box-sizing:border-box}\n              .user_avatar,.user-avatar{background-image:url('${(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_4__.getUserAvatarPath)()}')}\n              .char_avatar,.char-avatar{background-image:url('${(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_4__.getCharAvatarPath)()}')}\n              </style>\n              ${_third_party_html__WEBPACK_IMPORTED_MODULE_3__[\"default\"]}\n              <script src=\"${_script_url__WEBPACK_IMPORTED_MODULE_2__.script_url.get('iframe_client')}\"><\/script>\n            </head>\n            <body>\n              ${extractedText}\n              ${needsVhHandling ? `<script src=\"${_script_url__WEBPACK_IMPORTED_MODULE_2__.script_url.get('viewport_adjust_script')}\"><\/script>` : ``}\n\n              ${(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_4__.getSettingValue)('render.tampermonkey_compatibility')\n                    ? `<script src=\"${_script_url__WEBPACK_IMPORTED_MODULE_2__.script_url.get('tampermonkey_script')}\"><\/script>`\n                    : ``}\n            </body>\n            </html>\n          `;\n                $iframe.attr('srcdoc', srcdocContent);\n                $iframe.on('load', function () {\n                    observeIframeContent(this);\n                    $wrapper = $(this).parent();\n                    if ($wrapper.length) {\n                        const $loadingOverlay = $wrapper.find('.iframe-loading-overlay');\n                        if ($loadingOverlay.length) {\n                            $loadingOverlay.css('opacity', '0');\n                            setTimeout(() => $loadingOverlay.remove(), 300);\n                        }\n                    }\n                    if ($(this).attr('data-needs-vh') === 'true') {\n                        this.contentWindow?.postMessage({\n                            request: 'updateViewportHeight',\n                            newHeight: window.innerHeight,\n                        }, '*');\n                    }\n                    _sillytavern_script__WEBPACK_IMPORTED_MODULE_5__.eventSource.emitAndWait('message_iframe_render_ended', this.id);\n                    if ((0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_4__.getSettingValue)('render.render_hide_style')) {\n                        (0,_component_message_iframe_render_hide_style__WEBPACK_IMPORTED_MODULE_0__.removeCodeToggleButtonsByMesId)(messageId);\n                    }\n                    if (loadingTimeout) {\n                        clearTimeout(loadingTimeout);\n                    }\n                });\n                _sillytavern_script__WEBPACK_IMPORTED_MODULE_5__.eventSource.emitAndWait('message_iframe_render_started', $iframe.attr('id'));\n                $(this).replaceWith($wrapper);\n            }\n            else {\n                (0,_component_message_iframe_render_hide_style__WEBPACK_IMPORTED_MODULE_0__.addToggleButtonToCodeBlock)($(this));\n            }\n        });\n    }\n}\n/**\n * 使用了min-height:vh时，自动调整iframe高度\n */\nconst viewport_adjust_script = `\n$(window).on(\"message\", function (event) {\n    if (event.originalEvent.data.request === \"updateViewportHeight\") {\n        const newHeight = event.originalEvent.data.newHeight;\n        $(\"html\").css(\"--viewport-height\", newHeight + \"px\");\n    }\n});\n`;\n/**\n * 油猴脚本\n */\nconst tampermonkey_script = `\nclass AudioManager {\n  constructor() {\n    this.currentlyPlaying = null;\n  }\n  handlePlay(audio) {\n    if (this.currentlyPlaying && this.currentlyPlaying !== audio) {\n      this.currentlyPlaying.pause();\n    }\n    window.parent.postMessage({\n      type: 'audioPlay',\n      iframeId: window.frameElement.id\n    }, '*');\n\n    this.currentlyPlaying = audio;\n  }\n  stopAll() {\n    if (this.currentlyPlaying) {\n      this.currentlyPlaying.pause();\n      this.currentlyPlaying = null;\n    }\n  }\n}\nconst audioManager = new AudioManager();\n$('.qr-button').on('click', function() {\n  const buttonName = $(this).text().trim();\n  window.parent.postMessage({ type: 'buttonClick', name: buttonName }, '*');\n});\n$('.st-text').each(function() {\n  $(this).on('input', function() {\n    window.parent.postMessage({ type: 'textInput', text: $(this).val() }, '*');\n  });\n  $(this).on('change', function() {\n    window.parent.postMessage({ type: 'textInput', text: $(this).val() }, '*');\n  });\n  const textarea = this;\n  const observer = new MutationObserver((mutations) => {\n    mutations.forEach((mutation) => {\n      if (mutation.type === 'attributes' && mutation.attributeName === 'value') {\n        window.parent.postMessage({ type: 'textInput', text: $(textarea).val() }, '*');\n      }\n    });\n  });\n  observer.observe(textarea, { attributes: true });\n});\n$('.st-send-button').on('click', function() {\n  window.parent.postMessage({ type: 'sendClick' }, '*');\n});\n$('.st-audio').on('play', function() {\n  audioManager.handlePlay(this);\n});\n$(window).on('message', function(event) {\n  if (event.originalEvent.data.type === 'stopAudio' &&\n    event.originalEvent.data.iframeId !== window.frameElement.id) {\n    audioManager.stopAll();\n  }\n});\n`;\n/**\n * 转换代码块中所有vh单位（包括JavaScript动态设置）\n * @param htmlContent 代码块内容\n * @returns 转换后的代码块内容\n */\nfunction processAllVhUnits(htmlContent) {\n    const viewportHeight = window.innerHeight;\n    let processedContent = htmlContent.replace(/((?:document\\.body\\.style\\.minHeight|\\.style\\.minHeight|setProperty\\s*\\(\\s*['\"]min-height['\"])\\s*[=,]\\s*['\"`])([^'\"`]*?)(['\"`])/g, (match, prefix, value, suffix) => {\n        if (value.includes('vh')) {\n            const convertedValue = value.replace(/(\\d+(?:\\.\\d+)?)vh/g, (num) => {\n                const numValue = parseFloat(num);\n                if (numValue === 100) {\n                    return `var(--viewport-height, ${viewportHeight}px)`;\n                }\n                else {\n                    return `calc(var(--viewport-height, ${viewportHeight}px) * ${numValue / 100})`;\n                }\n            });\n            return prefix + convertedValue + suffix;\n        }\n        return match;\n    });\n    processedContent = processedContent.replace(/min-height:\\s*([^;]*vh[^;]*);/g, expression => {\n        const processedExpression = expression.replace(/(\\d+(?:\\.\\d+)?)vh/g, num => {\n            const numValue = parseFloat(num);\n            if (numValue === 100) {\n                return `var(--viewport-height, ${viewportHeight}px)`;\n            }\n            else {\n                return `calc(var(--viewport-height, ${viewportHeight}px) * ${numValue / 100})`;\n            }\n        });\n        return `${processedExpression};`;\n    });\n    processedContent = processedContent.replace(/style\\s*=\\s*[\"']([^\"']*min-height:\\s*[^\"']*vh[^\"']*?)[\"']/gi, (match, styleContent) => {\n        const processedStyleContent = styleContent.replace(/min-height:\\s*([^;]*vh[^;]*)/g, (expression) => {\n            const processedExpression = expression.replace(/(\\d+(?:\\.\\d+)?)vh/g, num => {\n                const numValue = parseFloat(num);\n                if (numValue === 100) {\n                    return `var(--viewport-height, ${viewportHeight}px)`;\n                }\n                else {\n                    return `calc(var(--viewport-height, ${viewportHeight}px) * ${numValue / 100})`;\n                }\n            });\n            return processedExpression;\n        });\n        return match.replace(styleContent, processedStyleContent);\n    });\n    return processedContent;\n}\n/**\n * 使用了min-height:vh时，更新iframe的viewport高度\n */\nfunction updateIframeViewportHeight() {\n    $(window).on('resize', function () {\n        if ($('iframe[data-needs-vh=\"true\"]').length) {\n            const viewportHeight = window.innerHeight;\n            $('iframe[data-needs-vh=\"true\"]').each(function () {\n                const iframe = this;\n                if (iframe.contentWindow) {\n                    iframe.contentWindow.postMessage({\n                        request: 'updateViewportHeight',\n                        newHeight: viewportHeight,\n                    }, '*');\n                }\n            });\n        }\n    });\n}\n/**\n * 获取或创建共享的ResizeObserver实例\n */\nfunction getSharedResizeObserver() {\n    if (!window._sharedResizeObserver) {\n        window._observedElements = new Map();\n        window._sharedResizeObserver = new ResizeObserver(entries => {\n            for (const entry of entries) {\n                const element = entry.target;\n                const data = window._observedElements?.get(element);\n                if (data) {\n                    const { iframe } = data;\n                    adjustIframeHeight(iframe);\n                }\n            }\n        });\n    }\n    return window._sharedResizeObserver;\n}\n/**\n * 调整iframe高度\n * @param iframe iframe元素\n */\nfunction adjustIframeHeight(iframe) {\n    const $iframe = $(iframe);\n    if (!$iframe.length || !$iframe[0].contentWindow || !$iframe[0].contentWindow.document.body) {\n        return;\n    }\n    const doc = $iframe[0].contentWindow.document;\n    const bodyHeight = doc.body.offsetHeight;\n    const htmlHeight = doc.documentElement.offsetHeight;\n    const newHeight = Math.max(bodyHeight, htmlHeight);\n    const currentHeight = parseFloat($iframe.css('height')) || 0;\n    if (Math.abs(currentHeight - newHeight) > 5) {\n        $iframe.css('height', newHeight + 'px');\n        if ($iframe.attr('data-needs-vh') === 'true' && iframe.contentWindow) {\n            iframe.contentWindow.postMessage({\n                request: 'updateViewportHeight',\n                newHeight: window.innerHeight,\n            }, '*');\n        }\n    }\n}\n/**\n * 观察iframe内容用于自动调整高度\n * @param iframe iframe元素\n */\nfunction observeIframeContent(iframe) {\n    const $iframe = $(iframe);\n    if (!$iframe.length || !$iframe[0].contentWindow || !$iframe[0].contentWindow.document.body) {\n        return;\n    }\n    try {\n        const docBody = $iframe[0].contentWindow.document.body;\n        const resizeObserver = getSharedResizeObserver();\n        if (window._observedElements) {\n            for (const [element, data] of window._observedElements.entries()) {\n                if (data.iframe === iframe) {\n                    resizeObserver.unobserve(element);\n                    window._observedElements.delete(element);\n                    break;\n                }\n            }\n        }\n        window._observedElements?.set(docBody, { iframe });\n        resizeObserver.observe(docBody);\n        adjustIframeHeight(iframe);\n    }\n    catch (error) {\n        log.error('[Render] 设置 iframe 内容观察时出错:', error);\n    }\n}\n/**\n * 处理油猴脚本兼容模式传来的消息\n * @param event 消息事件\n */\nfunction handleTampermonkeyMessages(event) {\n    if (event.data.type === 'buttonClick') {\n        const buttonName = event.data.name;\n        $('.qr--button.menu_button').each(function () {\n            if ($(this).find('.qr--button-label').text().trim() === buttonName) {\n                $(this).trigger('click');\n            }\n        });\n    }\n    else if (event.data.type === 'textInput') {\n        const $sendTextarea = jQuery('#send_textarea');\n        if ($sendTextarea.length) {\n            $sendTextarea.val(event.data.text).trigger('input').trigger('change');\n        }\n    }\n    else if (event.data.type === 'sendClick') {\n        const $sendButton = jQuery('#send_but');\n        if ($sendButton.length) {\n            $sendButton.trigger('click');\n        }\n    }\n}\n/**\n * 油猴兼容模式-创建全局音频管理器\n */\nfunction createGlobalAudioManager() {\n    let currentPlayingIframeId = null;\n    window.addEventListener('message', function (event) {\n        if (event.data.type === 'audioPlay') {\n            const newIframeId = event.data.iframeId;\n            if (currentPlayingIframeId && currentPlayingIframeId !== newIframeId) {\n                $('iframe').each(function () {\n                    const iframe = this;\n                    if (iframe.contentWindow) {\n                        iframe.contentWindow.postMessage({\n                            type: 'stopAudio',\n                            iframeId: newIframeId,\n                        }, '*');\n                    }\n                });\n            }\n            currentPlayingIframeId = newIframeId;\n        }\n    });\n}\n/**\n * 处理油猴兼容性设置改变\n */\nasync function handleTampermonkeyCompatibilityChange(enable, userInput = true) {\n    if (userInput) {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_4__.saveSettingValue)('render.tampermonkey_compatibility', enable);\n    }\n    if (!(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_4__.getSettingValue)('enabled_extension')) {\n        return;\n    }\n    if (enable) {\n        if (!tampermonkeyMessageListener) {\n            tampermonkeyMessageListener = handleTampermonkeyMessages;\n            window.addEventListener('message', tampermonkeyMessageListener);\n            createGlobalAudioManager();\n        }\n    }\n    else if (tampermonkeyMessageListener) {\n        window.removeEventListener('message', tampermonkeyMessageListener);\n        tampermonkeyMessageListener = null;\n    }\n    await clearAndRenderAllIframes();\n}\nconst partialRenderEvents = [\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_5__.event_types.CHARACTER_MESSAGE_RENDERED,\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_5__.event_types.USER_MESSAGE_RENDERED,\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_5__.event_types.MESSAGE_UPDATED,\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_5__.event_types.MESSAGE_SWIPED,\n];\nasync function handleRenderToggle(userInput = true, enable = true) {\n    if (enable) {\n        renderMessagesInIframes(RENDER_MODES.FULL);\n    }\n    if (userInput) {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_4__.saveSettingValue)('render.render_enabled', enable);\n    }\n}\n/**\n * 清理后，重新渲染所有iframe\n */\nasync function clearAndRenderAllIframes() {\n    await clearAllIframes();\n    if (_sillytavern_script__WEBPACK_IMPORTED_MODULE_5__.this_chid !== undefined) {\n        await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_5__.reloadCurrentChat)();\n        await renderAllIframes();\n    }\n}\n/**\n * 渲染所有iframe\n */\nasync function renderAllIframes() {\n    await renderMessagesInIframes(RENDER_MODES.FULL);\n    log.info('[Render] 渲染所有iframe');\n}\n/**\n * 渲染部分iframe\n * @param mesId 消息ID\n */\nasync function renderPartialIframes(mesId) {\n    const processDepth = parseInt($('#render-depth').val(), 10);\n    const context = (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_6__.getContext)();\n    const totalMessages = context.chat.length;\n    if (processDepth > 0) {\n        const depthOffset = totalMessages - processDepth;\n        if (mesId < depthOffset) {\n            return;\n        }\n    }\n    await renderMessagesInIframes(RENDER_MODES.PARTIAL, mesId);\n    log.info('[Render] 渲染' + mesId + '号消息的iframe');\n}\n/**\n * 销毁iframe\n * @param iframe iframe元素\n */\nfunction destroyIframe(iframe) {\n    return new Promise(resolve => {\n        const $iframe = $(iframe);\n        if (!$iframe.length) {\n            resolve();\n            return;\n        }\n        const iframeId = $iframe.attr('id');\n        $iframe.off();\n        try {\n            if ($iframe[0].contentWindow) {\n                const iframeDoc = $iframe[0].contentWindow.document;\n                if (iframeDoc) {\n                    $(iframeDoc).find('*').off();\n                    $(iframeDoc).off();\n                }\n            }\n        }\n        catch (e) {\n            log.debug('[Render] 清理iframe内部事件时出错:', e);\n        }\n        try {\n            const $mediaElements = $iframe.contents().find('audio, video');\n            $mediaElements.each(function () {\n                if (this instanceof HTMLMediaElement) {\n                    this.pause();\n                    this.src = '';\n                    this.load();\n                    $(this).off();\n                }\n            });\n        }\n        catch (e) {\n            log.debug('[Render] 清理媒体元素时出错:', e);\n        }\n        if ($iframe[0].contentWindow && 'stop' in $iframe[0].contentWindow) {\n            $iframe[0].contentWindow.stop();\n        }\n        // 如果有ResizeObserver实例和已观察元素的记录\n        if (window._sharedResizeObserver && window._observedElements) {\n            for (const [element, data] of window._observedElements.entries()) {\n                if (data.iframe === iframe) {\n                    window._sharedResizeObserver.unobserve(element);\n                    window._observedElements.delete(element);\n                    break;\n                }\n            }\n        }\n        // 清空iframe内容\n        if ($iframe[0].contentWindow) {\n            try {\n                if (iframeId && typeof _sillytavern_script__WEBPACK_IMPORTED_MODULE_5__.eventSource.removeListener === 'function') {\n                    _sillytavern_script__WEBPACK_IMPORTED_MODULE_5__.eventSource.removeListener('message_iframe_render_ended', iframeId);\n                    _sillytavern_script__WEBPACK_IMPORTED_MODULE_5__.eventSource.removeListener('message_iframe_render_started', iframeId);\n                }\n            }\n            catch (e) {\n                log.debug('[Render] 清空iframe内容时出错:', e);\n            }\n        }\n        // 从DOM中移除\n        $iframe.remove();\n        // 移除jQuery数据缓存\n        try {\n            $iframe.removeData();\n        }\n        catch (e) {\n            log.debug('[Render] 移除jQuery数据缓存时出错:', e);\n        }\n        if (window._observedElements?.size === 0 && window._sharedResizeObserver) {\n            window._sharedResizeObserver.disconnect();\n            window._sharedResizeObserver = undefined;\n            log.info('[Render] 所有iframe已移除，停止观察');\n        }\n        // 确保所有清理操作都完成后再resolve\n        setTimeout(() => {\n            resolve();\n        }, 0);\n    });\n}\n/**\n * 清理所有iframe\n * @returns {Promise<void>}\n */\nasync function clearAllIframes() {\n    const $iframes = $('iframe[id^=\"message-iframe\"]');\n    await Promise.all($iframes.toArray().map(async (iframe) => {\n        await destroyIframe(iframe);\n    }));\n    // 清理相关的事件监听器\n    try {\n        if (typeof _sillytavern_script__WEBPACK_IMPORTED_MODULE_5__.eventSource.removeListener === 'function') {\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_5__.eventSource.removeListener('message_iframe_render_started', null);\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_5__.eventSource.removeListener('message_iframe_render_ended', null);\n        }\n    }\n    catch (e) {\n        log.debug('[Render] 清理事件监听器时出错:', e);\n    }\n    // 尝试主动触发垃圾回收\n    try {\n        let arr = [];\n        for (let i = 0; i < 10; i++) {\n            arr.push(new Array(1000000).fill(1));\n        }\n        arr = null;\n        if (window.gc) {\n            window.gc();\n        }\n    }\n    catch (e) {\n        log.debug('尝试触发垃圾回收时出错:', e);\n    }\n}\n/**\n * 设置iframe移除监听器\n * @returns {MutationObserver} 观察器实例\n */\nfunction setupIframeRemovalListener() {\n    const observer = new MutationObserver(mutations => {\n        mutations.forEach(mutation => {\n            if (mutation.removedNodes.length) {\n                mutation.removedNodes.forEach(node => {\n                    if (node instanceof HTMLIFrameElement) {\n                        destroyIframe(node).catch(err => {\n                            log.error('[Render] 清理iframe时出错:', err);\n                        });\n                    }\n                    else if (node instanceof HTMLElement) {\n                        const iframes = node.querySelectorAll('iframe');\n                        if (iframes.length) {\n                            iframes.forEach(iframe => {\n                                destroyIframe(iframe).catch(err => {\n                                    log.error('[Render] 清理iframe时出错:', err);\n                                });\n                            });\n                        }\n                    }\n                });\n            }\n        });\n    });\n    observer.observe(document.body, { childList: true, subtree: true });\n    return observer;\n}\n/**\n * 删除消息后重新渲染\n * @param mesId 消息ID\n */\nasync function renderMessageAfterDelete(mesId) {\n    const context = (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_6__.getContext)();\n    const processDepth = parseInt($('#render-depth').val(), 10);\n    const totalMessages = context.chat.length;\n    const maxRemainId = mesId - 1;\n    const getMessage = (id) => {\n        const message = context.chat[id] ?? {};\n        return message;\n    };\n    const getIframe = (id) => {\n        const $iframe = $('[id^=\"message-iframe-' + id + '-\"]');\n        return $iframe.length > 0 ? $iframe.get(0) : null;\n    };\n    const checkCodeBlock = (message) => {\n        return /```[\\s\\S]*?```/.test(message.mes);\n    };\n    // 考虑到高楼层的情况，深度为0时，只渲染最后一个消息\n    if (processDepth === 0) {\n        const message = getMessage(maxRemainId);\n        const hasCodeBlock = checkCodeBlock(message);\n        const iframe = getIframe(maxRemainId);\n        if (!hasCodeBlock && !iframe) {\n            return;\n        }\n        await destroyIframe(iframe);\n        (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_5__.updateMessageBlock)(maxRemainId, message);\n        renderPartialIframes(maxRemainId);\n    }\n    else {\n        let startRenderIndex = totalMessages - processDepth;\n        if (startRenderIndex < 0) {\n            startRenderIndex = 0;\n        }\n        for (let i = startRenderIndex; i <= maxRemainId; i++) {\n            const message = getMessage(i);\n            const hasCodeBlock = checkCodeBlock(message);\n            const iframe = getIframe(i);\n            if (!hasCodeBlock && !iframe) {\n                continue;\n            }\n            await destroyIframe(iframe);\n            (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_5__.updateMessageBlock)(i, message);\n            renderPartialIframes(i);\n        }\n    }\n}\nconst handlePartialRender = (mesId) => {\n    log.info('[Render] 触发局部渲染，消息ID:', mesId);\n    const processDepth = parseInt($('#render-depth').val(), 10);\n    const context = (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_6__.getContext)();\n    const totalMessages = context.chat.length;\n    if (processDepth > 0) {\n        const depthOffset = totalMessages - processDepth;\n        if (mesId < depthOffset) {\n            return;\n        }\n    }\n    setTimeout(() => {\n        renderMessagesInIframes(RENDER_MODES.PARTIAL, mesId);\n    }, 100);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L21lc3NhZ2VfaWZyYW1lL3JlbmRlcl9tZXNzYWdlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUdzRDtBQUNpQjtBQUM3QjtBQUNHO0FBQ3dFO0FBRUo7QUFDcEQ7QUFFN0QsSUFBSSwyQkFBMkIsR0FBMkMsSUFBSSxDQUFDO0FBRS9FLE1BQU0sWUFBWSxHQUFHO0lBQ25CLElBQUksRUFBRSxNQUFNO0lBQ1osT0FBTyxFQUFFLFNBQVM7Q0FDbkIsQ0FBQztBQUVGOzs7O0dBSUc7QUFDSCxLQUFLLFVBQVUsdUJBQXVCLENBQUMsSUFBSSxHQUFHLFlBQVksQ0FBQyxJQUFJLEVBQUUsZ0JBQStCLElBQUk7SUFDbEcsSUFBSSxDQUFDLDBFQUFlLENBQUMsbUJBQW1CLENBQUMsSUFBSSxDQUFDLDBFQUFlLENBQUMsdUJBQXVCLENBQUMsRUFBRSxDQUFDO1FBQ3ZGLE9BQU87SUFDVCxDQUFDO0lBQ0QsTUFBTSxPQUFPLEdBQUcsMkVBQVUsRUFBRSxDQUFDO0lBQzdCLE1BQU0sYUFBYSxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDO0lBQzFDLE1BQU0sWUFBWSxHQUFHLDBFQUFlLENBQUMscUJBQXFCLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDakUsTUFBTSxVQUFVLEdBQUcsWUFBWSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxhQUFhLENBQUM7SUFDbkUsTUFBTSxzQkFBc0IsR0FBRyxDQUFDLEdBQUcsS0FBSyxDQUFDLGFBQWEsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUM7SUFFbkYsSUFBSSxtQkFBbUIsR0FBYSxFQUFFLENBQUM7SUFDdkMsTUFBTSxtQkFBbUIsR0FBYSxDQUFDLEdBQUcsS0FBSyxDQUFDLGFBQWEsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsTUFBTSxDQUMzRSxFQUFF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QUMsQ0FBQztJQUN2RCxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUM7QUFDVixDQUFDLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvY29tcG9uZW50L21lc3NhZ2VfaWZyYW1lL3JlbmRlcl9tZXNzYWdlLnRzPzBjMTgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgYWRkVG9nZ2xlQnV0dG9uVG9Db2RlQmxvY2ssXG4gIHJlbW92ZUNvZGVUb2dnbGVCdXR0b25zQnlNZXNJZCxcbn0gZnJvbSAnQC9jb21wb25lbnQvbWVzc2FnZV9pZnJhbWUvcmVuZGVyX2hpZGVfc3R5bGUnO1xuaW1wb3J0IHsgZXh0cmFjdFRleHRGcm9tQ29kZSB9IGZyb20gJ0AvY29tcG9uZW50L21lc3NhZ2VfaWZyYW1lL3V0aWxzJztcbmltcG9ydCB7IHNjcmlwdF91cmwgfSBmcm9tICdAL3NjcmlwdF91cmwnO1xuaW1wb3J0IHRoaXJkX3BhcnR5IGZyb20gJ0AvdGhpcmRfcGFydHkuaHRtbCc7XG5pbXBvcnQgeyBnZXRDaGFyQXZhdGFyUGF0aCwgZ2V0U2V0dGluZ1ZhbHVlLCBnZXRVc2VyQXZhdGFyUGF0aCwgc2F2ZVNldHRpbmdWYWx1ZSB9IGZyb20gJ0AvdXRpbC9leHRlbnNpb25fdmFyaWFibGVzJztcblxuaW1wb3J0IHsgZXZlbnRTb3VyY2UsIGV2ZW50X3R5cGVzLCByZWxvYWRDdXJyZW50Q2hhdCwgdGhpc19jaGlkLCB1cGRhdGVNZXNzYWdlQmxvY2sgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0JztcbmltcG9ydCB7IGdldENvbnRleHQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9leHRlbnNpb25zJztcblxubGV0IHRhbXBlcm1vbmtleU1lc3NhZ2VMaXN0ZW5lcjogKChldmVudDogTWVzc2FnZUV2ZW50KSA9PiB2b2lkKSB8IG51bGwgPSBudWxsO1xuXG5jb25zdCBSRU5ERVJfTU9ERVMgPSB7XG4gIEZVTEw6ICdGVUxMJyxcbiAgUEFSVElBTDogJ1BBUlRJQUwnLFxufTtcblxuLyoqXG4gKiDmuLLmn5Pmtojmga/liLBpZnJhbWVcbiAqIEBwYXJhbSBtb2RlIOa4suafk+aooeW8j1xuICogQHBhcmFtIHNwZWNpZmljTWVzSWQg5oyH5a6a5raI5oGvSURcbiAqL1xuYXN5bmMgZnVuY3Rpb24gcmVuZGVyTWVzc2FnZXNJbklmcmFtZXMobW9kZSA9IFJFTkRFUl9NT0RFUy5GVUxMLCBzcGVjaWZpY01lc0lkOiBudW1iZXIgfCBudWxsID0gbnVsbCkge1xuICBpZiAoIWdldFNldHRpbmdWYWx1ZSgnZW5hYmxlZF9leHRlbnNpb24nKSB8fCAhZ2V0U2V0dGluZ1ZhbHVlKCdyZW5kZXIucmVuZGVyX2VuYWJsZWQnKSkge1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCBjb250ZXh0ID0gZ2V0Q29udGV4dCgpO1xuICBjb25zdCB0b3RhbE1lc3NhZ2VzID0gY29udGV4dC5jaGF0Lmxlbmd0aDtcbiAgY29uc3QgcHJvY2Vzc0RlcHRoID0gZ2V0U2V0dGluZ1ZhbHVlKCdyZW5kZXIucmVuZGVyX2RlcHRoJykgPz8gMDtcbiAgY29uc3QgZGVwdGhMaW1pdCA9IHByb2Nlc3NEZXB0aCA+IDAgPyBwcm9jZXNzRGVwdGggOiB0b3RhbE1lc3NhZ2VzO1xuICBjb25zdCBkZXB0aExpbWl0ZWRNZXNzYWdlSWRzID0gWy4uLkFycmF5KHRvdGFsTWVzc2FnZXMpLmtleXMoKV0uc2xpY2UoLWRlcHRoTGltaXQpO1xuXG4gIGxldCBtZXNzYWdlc1RvUmVuZGVySWRzOiBudW1iZXJbXSA9IFtdO1xuICBjb25zdCBtZXNzYWdlc1RvQ2FuY2VsSWRzOiBudW1iZXJbXSA9IFsuLi5BcnJheSh0b3RhbE1lc3NhZ2VzKS5rZXlzKCldLmZpbHRlcihcbiAgICBpZCA9PiAhZGVwdGhMaW1pdGVkTWVzc2FnZUlkcy5pbmNsdWRlcyhpZCksXG4gICk7XG5cbiAgaWYgKG1vZGUgPT09IFJFTkRFUl9NT0RFUy5GVUxMKSB7XG4gICAgbWVzc2FnZXNUb1JlbmRlcklkcyA9IGRlcHRoTGltaXRlZE1lc3NhZ2VJZHM7XG4gIH0gZWxzZSBpZiAobW9kZSA9PT0gUkVOREVSX01PREVTLlBBUlRJQUwgJiYgc3BlY2lmaWNNZXNJZCAhPT0gbnVsbCkge1xuICAgIGlmIChkZXB0aExpbWl0ZWRNZXNzYWdlSWRzLmluY2x1ZGVzKHNwZWNpZmljTWVzSWQpKSB7XG4gICAgICBtZXNzYWdlc1RvUmVuZGVySWRzID0gW3NwZWNpZmljTWVzSWRdO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9XG5cbiAgZm9yIChjb25zdCBtZXNzYWdlSWQgb2YgbWVzc2FnZXNUb0NhbmNlbElkcykge1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjb250ZXh0LmNoYXRbbWVzc2FnZUlkXTtcbiAgICBjb25zdCAkaWZyYW1lcyA9ICQoYFtpZF49XCJtZXNzYWdlLWlmcmFtZS0ke21lc3NhZ2VJZH0tXCJdYCk7XG4gICAgaWYgKCRpZnJhbWVzLmxlbmd0aCA+IDApIHtcbiAgICAgIGF3YWl0IFByb21pc2UuYWxsKFxuICAgICAgICAkaWZyYW1lcy50b0FycmF5KCkubWFwKGFzeW5jIGlmcmFtZSA9PiB7XG4gICAgICAgICAgYXdhaXQgZGVzdHJveUlmcmFtZShpZnJhbWUgYXMgSFRNTElGcmFtZUVsZW1lbnQpO1xuICAgICAgICB9KSxcbiAgICAgICk7XG4gICAgICB1cGRhdGVNZXNzYWdlQmxvY2sobWVzc2FnZUlkLCBtZXNzYWdlKTtcbiAgICB9XG4gICAgaWYgKGdldFNldHRpbmdWYWx1ZSgncmVuZGVyLnJlbmRlcl9oaWRlX3N0eWxlJykpIHtcbiAgICAgIGNvbnN0ICRtZXNUZXh0cyA9ICQoXG4gICAgICAgIGAubWVzW21lc2lkPVwiJHttZXNzYWdlSWR9XCJdIC5tZXNfYmxvY2sgLm1lc19yZWFzb25pbmdfZGV0YWlscywgLm1lc1ttZXNpZD1cIiR7bWVzc2FnZUlkfVwiXSAubWVzX2Jsb2NrIC5tZXNfdGV4dGAsXG4gICAgICApO1xuICAgICAgJG1lc1RleHRzLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICBjb25zdCAkY29kZUJsb2NrID0gJCh0aGlzKS5maW5kKCdwcmUnKTtcbiAgICAgICAgaWYgKCRjb2RlQmxvY2subGVuZ3RoKSB7XG4gICAgICAgICAgYWRkVG9nZ2xlQnV0dG9uVG9Db2RlQmxvY2soJGNvZGVCbG9jayk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGZvciAoY29uc3QgbWVzc2FnZUlkIG9mIG1lc3NhZ2VzVG9SZW5kZXJJZHMpIHtcbiAgICBjb25zdCAkbWVzc2FnZUVsZW1lbnQgPSAkKGAubWVzW21lc2lkPVwiJHttZXNzYWdlSWR9XCJdYCk7XG4gICAgaWYgKCEkbWVzc2FnZUVsZW1lbnQubGVuZ3RoKSB7XG4gICAgICBsb2cuZGVidWcoYOacquaJvuWIsCBtZXNpZDogJHttZXNzYWdlSWR9IOWvueW6lOeahOa2iOaBr+WFg+e0oOOAgmApO1xuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgY29uc3QgJGNvZGVFbGVtZW50cyA9ICRtZXNzYWdlRWxlbWVudC5maW5kKCdwcmUnKTtcbiAgICBpZiAoISRjb2RlRWxlbWVudHMubGVuZ3RoKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBsZXQgaWZyYW1lQ291bnRlciA9IDE7XG5cbiAgICAkY29kZUVsZW1lbnRzLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IGV4dHJhY3RlZFRleHQgPSBleHRyYWN0VGV4dEZyb21Db2RlKHRoaXMpO1xuICAgICAgaWYgKGV4dHJhY3RlZFRleHQuaW5jbHVkZXMoJzxib2R5JykgJiYgZXh0cmFjdGVkVGV4dC5pbmNsdWRlcygnPC9ib2R5PicpKSB7XG4gICAgICAgIGNvbnN0IGRpc2FibGVMb2FkaW5nID0gLzwhLS1cXHMqZGlzYWJsZS1kZWZhdWx0LWxvYWRpbmdcXHMqLS0+Ly50ZXN0KGV4dHJhY3RlZFRleHQpO1xuICAgICAgICBjb25zdCBoYXNNaW5WaCA9IC9taW4taGVpZ2h0OlxccypbXjtdKnZoLy50ZXN0KGV4dHJhY3RlZFRleHQpO1xuICAgICAgICBjb25zdCBoYXNKc1ZoVXNhZ2UgPSAvXFxkK3ZoLy50ZXN0KGV4dHJhY3RlZFRleHQpO1xuXG4gICAgICAgIGlmIChoYXNNaW5WaCB8fCBoYXNKc1ZoVXNhZ2UpIHtcbiAgICAgICAgICBleHRyYWN0ZWRUZXh0ID0gcHJvY2Vzc0FsbFZoVW5pdHMoZXh0cmFjdGVkVGV4dCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbmVlZHNWaEhhbmRsaW5nID0gaGFzTWluVmggfHwgaGFzSnNWaFVzYWdlO1xuXG4gICAgICAgIGxldCAkd3JhcHBlciA9ICQoJzxkaXY+JykuY3NzKHtcbiAgICAgICAgICBwb3NpdGlvbjogJ3JlbGF0aXZlJyxcbiAgICAgICAgICB3aWR0aDogJzEwMCUnLFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCAkaWZyYW1lID0gJCgnPGlmcmFtZT4nKVxuICAgICAgICAgIC5hdHRyKHtcbiAgICAgICAgICAgIGlkOiBgbWVzc2FnZS1pZnJhbWUtJHttZXNzYWdlSWR9LSR7aWZyYW1lQ291bnRlcn1gLFxuICAgICAgICAgICAgbG9hZGluZzogJ2xhenknLFxuICAgICAgICAgIH0pXG4gICAgICAgICAgLmNzcyh7XG4gICAgICAgICAgICBtYXJnaW46ICc1cHggYXV0bycsXG4gICAgICAgICAgICBib3JkZXI6ICdub25lJyxcbiAgICAgICAgICAgIHdpZHRoOiAnMTAwJScsXG4gICAgICAgICAgfSkgYXMgSlF1ZXJ5PEhUTUxJRnJhbWVFbGVtZW50PjtcblxuICAgICAgICBpZnJhbWVDb3VudGVyKys7XG5cbiAgICAgICAgaWYgKG5lZWRzVmhIYW5kbGluZykge1xuICAgICAgICAgICRpZnJhbWUuYXR0cignZGF0YS1uZWVkcy12aCcsICd0cnVlJyk7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgbG9hZGluZ1RpbWVvdXQ6IE5vZGVKUy5UaW1lb3V0IHwgbnVsbCA9IG51bGw7XG4gICAgICAgIGlmICghZGlzYWJsZUxvYWRpbmcpIHtcbiAgICAgICAgICBjb25zdCAkbG9hZGluZ092ZXJsYXkgPSAkKCc8ZGl2PicpLmFkZENsYXNzKCdpZnJhbWUtbG9hZGluZy1vdmVybGF5JykuaHRtbChgXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImlmcmFtZS1sb2FkaW5nLWNvbnRlbnRcIj5cbiAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPVwiZmEtc29saWQgZmEtc3Bpbm5lciBmYS1zcGluXCI+PC9pPlxuICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJsb2FkaW5nLXRleHRcIj5Mb2FkaW5nLi4uPC9zcGFuPlxuICAgICAgICAgICAgICAgIDwvZGl2PmApO1xuXG4gICAgICAgICAgbG9hZGluZ1RpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0ICRsb2FkaW5nVGV4dCA9ICRsb2FkaW5nT3ZlcmxheS5maW5kKCcubG9hZGluZy10ZXh0Jyk7XG4gICAgICAgICAgICBpZiAoJGxvYWRpbmdUZXh0Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAkbG9hZGluZ1RleHQudGV4dCgn5aaC5Yqg6L295pe26Ze06L+H6ZW/77yM6K+35qOA5p+l572R57ucJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSwgMTAwMDApO1xuXG4gICAgICAgICAgJHdyYXBwZXIuYXBwZW5kKCRsb2FkaW5nT3ZlcmxheSk7XG4gICAgICAgIH1cblxuICAgICAgICAkd3JhcHBlci5hcHBlbmQoJGlmcmFtZSk7XG5cbiAgICAgICAgY29uc3Qgc3JjZG9jQ29udGVudCA9IGBcbiAgICAgICAgICAgIDxodG1sPlxuICAgICAgICAgICAgPGhlYWQ+XG4gICAgICAgICAgICAgIDxzdHlsZT5cbiAgICAgICAgICAgICAgJHtuZWVkc1ZoSGFuZGxpbmcgPyBgOnJvb3R7LS12aWV3cG9ydC1oZWlnaHQ6JHt3aW5kb3cuaW5uZXJIZWlnaHR9cHg7fWAgOiBgYH1cbiAgICAgICAgICAgICAgaHRtbCxib2R5e21hcmdpbjowO3BhZGRpbmc6MDtvdmVyZmxvdzpoaWRkZW4haW1wb3J0YW50O21heC13aWR0aDoxMDAlIWltcG9ydGFudDtib3gtc2l6aW5nOmJvcmRlci1ib3h9XG4gICAgICAgICAgICAgIC51c2VyX2F2YXRhciwudXNlci1hdmF0YXJ7YmFja2dyb3VuZC1pbWFnZTp1cmwoJyR7Z2V0VXNlckF2YXRhclBhdGgoKX0nKX1cbiAgICAgICAgICAgICAgLmNoYXJfYXZhdGFyLC5jaGFyLWF2YXRhcntiYWNrZ3JvdW5kLWltYWdlOnVybCgnJHtnZXRDaGFyQXZhdGFyUGF0aCgpfScpfVxuICAgICAgICAgICAgICA8L3N0eWxlPlxuICAgICAgICAgICAgICAke3RoaXJkX3BhcnR5fVxuICAgICAgICAgICAgICA8c2NyaXB0IHNyYz1cIiR7c2NyaXB0X3VybC5nZXQoJ2lmcmFtZV9jbGllbnQnKX1cIj48L3NjcmlwdD5cbiAgICAgICAgICAgIDwvaGVhZD5cbiAgICAgICAgICAgIDxib2R5PlxuICAgICAgICAgICAgICAke2V4dHJhY3RlZFRleHR9XG4gICAgICAgICAgICAgICR7bmVlZHNWaEhhbmRsaW5nID8gYDxzY3JpcHQgc3JjPVwiJHtzY3JpcHRfdXJsLmdldCgndmlld3BvcnRfYWRqdXN0X3NjcmlwdCcpfVwiPjwvc2NyaXB0PmAgOiBgYH1cblxuICAgICAgICAgICAgICAke1xuICAgICAgICAgICAgICAgIGdldFNldHRpbmdWYWx1ZSgncmVuZGVyLnRhbXBlcm1vbmtleV9jb21wYXRpYmlsaXR5JylcbiAgICAgICAgICAgICAgICAgID8gYDxzY3JpcHQgc3JjPVwiJHtzY3JpcHRfdXJsLmdldCgndGFtcGVybW9ua2V5X3NjcmlwdCcpfVwiPjwvc2NyaXB0PmBcbiAgICAgICAgICAgICAgICAgIDogYGBcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgPC9ib2R5PlxuICAgICAgICAgICAgPC9odG1sPlxuICAgICAgICAgIGA7XG5cbiAgICAgICAgJGlmcmFtZS5hdHRyKCdzcmNkb2MnLCBzcmNkb2NDb250ZW50KTtcblxuICAgICAgICAkaWZyYW1lLm9uKCdsb2FkJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIG9ic2VydmVJZnJhbWVDb250ZW50KHRoaXMpO1xuXG4gICAgICAgICAgJHdyYXBwZXIgPSAkKHRoaXMpLnBhcmVudCgpO1xuICAgICAgICAgIGlmICgkd3JhcHBlci5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbnN0ICRsb2FkaW5nT3ZlcmxheSA9ICR3cmFwcGVyLmZpbmQoJy5pZnJhbWUtbG9hZGluZy1vdmVybGF5Jyk7XG4gICAgICAgICAgICBpZiAoJGxvYWRpbmdPdmVybGF5Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAkbG9hZGluZ092ZXJsYXkuY3NzKCdvcGFjaXR5JywgJzAnKTtcbiAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiAkbG9hZGluZ092ZXJsYXkucmVtb3ZlKCksIDMwMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKCQodGhpcykuYXR0cignZGF0YS1uZWVkcy12aCcpID09PSAndHJ1ZScpIHtcbiAgICAgICAgICAgIHRoaXMuY29udGVudFdpbmRvdz8ucG9zdE1lc3NhZ2UoXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByZXF1ZXN0OiAndXBkYXRlVmlld3BvcnRIZWlnaHQnLFxuICAgICAgICAgICAgICAgIG5ld0hlaWdodDogd2luZG93LmlubmVySGVpZ2h0LFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAnKicsXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGV2ZW50U291cmNlLmVtaXRBbmRXYWl0KCdtZXNzYWdlX2lmcmFtZV9yZW5kZXJfZW5kZWQnLCB0aGlzLmlkKTtcblxuICAgICAgICAgIGlmIChnZXRTZXR0aW5nVmFsdWUoJ3JlbmRlci5yZW5kZXJfaGlkZV9zdHlsZScpKSB7XG4gICAgICAgICAgICByZW1vdmVDb2RlVG9nZ2xlQnV0dG9uc0J5TWVzSWQobWVzc2FnZUlkKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAobG9hZGluZ1RpbWVvdXQpIHtcbiAgICAgICAgICAgIGNsZWFyVGltZW91dChsb2FkaW5nVGltZW91dCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBldmVudFNvdXJjZS5lbWl0QW5kV2FpdCgnbWVzc2FnZV9pZnJhbWVfcmVuZGVyX3N0YXJ0ZWQnLCAkaWZyYW1lLmF0dHIoJ2lkJykpO1xuICAgICAgICAkKHRoaXMpLnJlcGxhY2VXaXRoKCR3cmFwcGVyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGFkZFRvZ2dsZUJ1dHRvblRvQ29kZUJsb2NrKCQodGhpcykpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG5cbi8qKlxuICog5L2/55So5LqGbWluLWhlaWdodDp2aOaXtu+8jOiHquWKqOiwg+aVtGlmcmFtZemrmOW6plxuICovXG5leHBvcnQgY29uc3Qgdmlld3BvcnRfYWRqdXN0X3NjcmlwdCA9IGBcbiQod2luZG93KS5vbihcIm1lc3NhZ2VcIiwgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgaWYgKGV2ZW50Lm9yaWdpbmFsRXZlbnQuZGF0YS5yZXF1ZXN0ID09PSBcInVwZGF0ZVZpZXdwb3J0SGVpZ2h0XCIpIHtcbiAgICAgICAgY29uc3QgbmV3SGVpZ2h0ID0gZXZlbnQub3JpZ2luYWxFdmVudC5kYXRhLm5ld0hlaWdodDtcbiAgICAgICAgJChcImh0bWxcIikuY3NzKFwiLS12aWV3cG9ydC1oZWlnaHRcIiwgbmV3SGVpZ2h0ICsgXCJweFwiKTtcbiAgICB9XG59KTtcbmA7XG5cbi8qKlxuICog5rK554y06ISa5pysXG4gKi9cbmV4cG9ydCBjb25zdCB0YW1wZXJtb25rZXlfc2NyaXB0ID0gYFxuY2xhc3MgQXVkaW9NYW5hZ2VyIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5jdXJyZW50bHlQbGF5aW5nID0gbnVsbDtcbiAgfVxuICBoYW5kbGVQbGF5KGF1ZGlvKSB7XG4gICAgaWYgKHRoaXMuY3VycmVudGx5UGxheWluZyAmJiB0aGlzLmN1cnJlbnRseVBsYXlpbmcgIT09IGF1ZGlvKSB7XG4gICAgICB0aGlzLmN1cnJlbnRseVBsYXlpbmcucGF1c2UoKTtcbiAgICB9XG4gICAgd2luZG93LnBhcmVudC5wb3N0TWVzc2FnZSh7XG4gICAgICB0eXBlOiAnYXVkaW9QbGF5JyxcbiAgICAgIGlmcmFtZUlkOiB3aW5kb3cuZnJhbWVFbGVtZW50LmlkXG4gICAgfSwgJyonKTtcblxuICAgIHRoaXMuY3VycmVudGx5UGxheWluZyA9IGF1ZGlvO1xuICB9XG4gIHN0b3BBbGwoKSB7XG4gICAgaWYgKHRoaXMuY3VycmVudGx5UGxheWluZykge1xuICAgICAgdGhpcy5jdXJyZW50bHlQbGF5aW5nLnBhdXNlKCk7XG4gICAgICB0aGlzLmN1cnJlbnRseVBsYXlpbmcgPSBudWxsO1xuICAgIH1cbiAgfVxufVxuY29uc3QgYXVkaW9NYW5hZ2VyID0gbmV3IEF1ZGlvTWFuYWdlcigpO1xuJCgnLnFyLWJ1dHRvbicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICBjb25zdCBidXR0b25OYW1lID0gJCh0aGlzKS50ZXh0KCkudHJpbSgpO1xuICB3aW5kb3cucGFyZW50LnBvc3RNZXNzYWdlKHsgdHlwZTogJ2J1dHRvbkNsaWNrJywgbmFtZTogYnV0dG9uTmFtZSB9LCAnKicpO1xufSk7XG4kKCcuc3QtdGV4dCcpLmVhY2goZnVuY3Rpb24oKSB7XG4gICQodGhpcykub24oJ2lucHV0JywgZnVuY3Rpb24oKSB7XG4gICAgd2luZG93LnBhcmVudC5wb3N0TWVzc2FnZSh7IHR5cGU6ICd0ZXh0SW5wdXQnLCB0ZXh0OiAkKHRoaXMpLnZhbCgpIH0sICcqJyk7XG4gIH0pO1xuICAkKHRoaXMpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHtcbiAgICB3aW5kb3cucGFyZW50LnBvc3RNZXNzYWdlKHsgdHlwZTogJ3RleHRJbnB1dCcsIHRleHQ6ICQodGhpcykudmFsKCkgfSwgJyonKTtcbiAgfSk7XG4gIGNvbnN0IHRleHRhcmVhID0gdGhpcztcbiAgY29uc3Qgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigobXV0YXRpb25zKSA9PiB7XG4gICAgbXV0YXRpb25zLmZvckVhY2goKG11dGF0aW9uKSA9PiB7XG4gICAgICBpZiAobXV0YXRpb24udHlwZSA9PT0gJ2F0dHJpYnV0ZXMnICYmIG11dGF0aW9uLmF0dHJpYnV0ZU5hbWUgPT09ICd2YWx1ZScpIHtcbiAgICAgICAgd2luZG93LnBhcmVudC5wb3N0TWVzc2FnZSh7IHR5cGU6ICd0ZXh0SW5wdXQnLCB0ZXh0OiAkKHRleHRhcmVhKS52YWwoKSB9LCAnKicpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbiAgb2JzZXJ2ZXIub2JzZXJ2ZSh0ZXh0YXJlYSwgeyBhdHRyaWJ1dGVzOiB0cnVlIH0pO1xufSk7XG4kKCcuc3Qtc2VuZC1idXR0b24nKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgd2luZG93LnBhcmVudC5wb3N0TWVzc2FnZSh7IHR5cGU6ICdzZW5kQ2xpY2snIH0sICcqJyk7XG59KTtcbiQoJy5zdC1hdWRpbycpLm9uKCdwbGF5JywgZnVuY3Rpb24oKSB7XG4gIGF1ZGlvTWFuYWdlci5oYW5kbGVQbGF5KHRoaXMpO1xufSk7XG4kKHdpbmRvdykub24oJ21lc3NhZ2UnLCBmdW5jdGlvbihldmVudCkge1xuICBpZiAoZXZlbnQub3JpZ2luYWxFdmVudC5kYXRhLnR5cGUgPT09ICdzdG9wQXVkaW8nICYmXG4gICAgZXZlbnQub3JpZ2luYWxFdmVudC5kYXRhLmlmcmFtZUlkICE9PSB3aW5kb3cuZnJhbWVFbGVtZW50LmlkKSB7XG4gICAgYXVkaW9NYW5hZ2VyLnN0b3BBbGwoKTtcbiAgfVxufSk7XG5gO1xuXG4vKipcbiAqIOi9rOaNouS7o+eggeWdl+S4reaJgOaciXZo5Y2V5L2N77yI5YyF5ousSmF2YVNjcmlwdOWKqOaAgeiuvue9ru+8iVxuICogQHBhcmFtIGh0bWxDb250ZW50IOS7o+eggeWdl+WGheWuuVxuICogQHJldHVybnMg6L2s5o2i5ZCO55qE5Luj56CB5Z2X5YaF5a65XG4gKi9cbmZ1bmN0aW9uIHByb2Nlc3NBbGxWaFVuaXRzKGh0bWxDb250ZW50OiBzdHJpbmcpIHtcbiAgY29uc3Qgdmlld3BvcnRIZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7XG5cbiAgbGV0IHByb2Nlc3NlZENvbnRlbnQgPSBodG1sQ29udGVudC5yZXBsYWNlKFxuICAgIC8oKD86ZG9jdW1lbnRcXC5ib2R5XFwuc3R5bGVcXC5taW5IZWlnaHR8XFwuc3R5bGVcXC5taW5IZWlnaHR8c2V0UHJvcGVydHlcXHMqXFwoXFxzKlsnXCJdbWluLWhlaWdodFsnXCJdKVxccypbPSxdXFxzKlsnXCJgXSkoW14nXCJgXSo/KShbJ1wiYF0pL2csXG4gICAgKG1hdGNoLCBwcmVmaXgsIHZhbHVlLCBzdWZmaXgpID0+IHtcbiAgICAgIGlmICh2YWx1ZS5pbmNsdWRlcygndmgnKSkge1xuICAgICAgICBjb25zdCBjb252ZXJ0ZWRWYWx1ZSA9IHZhbHVlLnJlcGxhY2UoLyhcXGQrKD86XFwuXFxkKyk/KXZoL2csIChudW06IHN0cmluZykgPT4ge1xuICAgICAgICAgIGNvbnN0IG51bVZhbHVlID0gcGFyc2VGbG9hdChudW0pO1xuICAgICAgICAgIGlmIChudW1WYWx1ZSA9PT0gMTAwKSB7XG4gICAgICAgICAgICByZXR1cm4gYHZhcigtLXZpZXdwb3J0LWhlaWdodCwgJHt2aWV3cG9ydEhlaWdodH1weClgO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gYGNhbGModmFyKC0tdmlld3BvcnQtaGVpZ2h0LCAke3ZpZXdwb3J0SGVpZ2h0fXB4KSAqICR7bnVtVmFsdWUgLyAxMDB9KWA7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHByZWZpeCArIGNvbnZlcnRlZFZhbHVlICsgc3VmZml4O1xuICAgICAgfVxuICAgICAgcmV0dXJuIG1hdGNoO1xuICAgIH0sXG4gICk7XG5cbiAgcHJvY2Vzc2VkQ29udGVudCA9IHByb2Nlc3NlZENvbnRlbnQucmVwbGFjZSgvbWluLWhlaWdodDpcXHMqKFteO10qdmhbXjtdKik7L2csIGV4cHJlc3Npb24gPT4ge1xuICAgIGNvbnN0IHByb2Nlc3NlZEV4cHJlc3Npb24gPSBleHByZXNzaW9uLnJlcGxhY2UoLyhcXGQrKD86XFwuXFxkKyk/KXZoL2csIG51bSA9PiB7XG4gICAgICBjb25zdCBudW1WYWx1ZSA9IHBhcnNlRmxvYXQobnVtKTtcbiAgICAgIGlmIChudW1WYWx1ZSA9PT0gMTAwKSB7XG4gICAgICAgIHJldHVybiBgdmFyKC0tdmlld3BvcnQtaGVpZ2h0LCAke3ZpZXdwb3J0SGVpZ2h0fXB4KWA7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gYGNhbGModmFyKC0tdmlld3BvcnQtaGVpZ2h0LCAke3ZpZXdwb3J0SGVpZ2h0fXB4KSAqICR7bnVtVmFsdWUgLyAxMDB9KWA7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIGAke3Byb2Nlc3NlZEV4cHJlc3Npb259O2A7XG4gIH0pO1xuXG4gIHByb2Nlc3NlZENvbnRlbnQgPSBwcm9jZXNzZWRDb250ZW50LnJlcGxhY2UoXG4gICAgL3N0eWxlXFxzKj1cXHMqW1wiJ10oW15cIiddKm1pbi1oZWlnaHQ6XFxzKlteXCInXSp2aFteXCInXSo/KVtcIiddL2dpLFxuICAgIChtYXRjaCwgc3R5bGVDb250ZW50KSA9PiB7XG4gICAgICBjb25zdCBwcm9jZXNzZWRTdHlsZUNvbnRlbnQgPSBzdHlsZUNvbnRlbnQucmVwbGFjZSgvbWluLWhlaWdodDpcXHMqKFteO10qdmhbXjtdKikvZywgKGV4cHJlc3Npb246IHN0cmluZykgPT4ge1xuICAgICAgICBjb25zdCBwcm9jZXNzZWRFeHByZXNzaW9uID0gZXhwcmVzc2lvbi5yZXBsYWNlKC8oXFxkKyg/OlxcLlxcZCspPyl2aC9nLCBudW0gPT4ge1xuICAgICAgICAgIGNvbnN0IG51bVZhbHVlID0gcGFyc2VGbG9hdChudW0pO1xuICAgICAgICAgIGlmIChudW1WYWx1ZSA9PT0gMTAwKSB7XG4gICAgICAgICAgICByZXR1cm4gYHZhcigtLXZpZXdwb3J0LWhlaWdodCwgJHt2aWV3cG9ydEhlaWdodH1weClgO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gYGNhbGModmFyKC0tdmlld3BvcnQtaGVpZ2h0LCAke3ZpZXdwb3J0SGVpZ2h0fXB4KSAqICR7bnVtVmFsdWUgLyAxMDB9KWA7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHByb2Nlc3NlZEV4cHJlc3Npb247XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBtYXRjaC5yZXBsYWNlKHN0eWxlQ29udGVudCwgcHJvY2Vzc2VkU3R5bGVDb250ZW50KTtcbiAgICB9LFxuICApO1xuXG4gIHJldHVybiBwcm9jZXNzZWRDb250ZW50O1xufVxuXG4vKipcbiAqIOS9v+eUqOS6hm1pbi1oZWlnaHQ6dmjml7bvvIzmm7TmlrBpZnJhbWXnmoR2aWV3cG9ydOmrmOW6plxuICovXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlSWZyYW1lVmlld3BvcnRIZWlnaHQoKSB7XG4gICQod2luZG93KS5vbigncmVzaXplJywgZnVuY3Rpb24gKCkge1xuICAgIGlmICgkKCdpZnJhbWVbZGF0YS1uZWVkcy12aD1cInRydWVcIl0nKS5sZW5ndGgpIHtcbiAgICAgIGNvbnN0IHZpZXdwb3J0SGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0O1xuICAgICAgJCgnaWZyYW1lW2RhdGEtbmVlZHMtdmg9XCJ0cnVlXCJdJykuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnN0IGlmcmFtZSA9IHRoaXMgYXMgSFRNTElGcmFtZUVsZW1lbnQ7XG4gICAgICAgIGlmIChpZnJhbWUuY29udGVudFdpbmRvdykge1xuICAgICAgICAgIGlmcmFtZS5jb250ZW50V2luZG93LnBvc3RNZXNzYWdlKFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICByZXF1ZXN0OiAndXBkYXRlVmlld3BvcnRIZWlnaHQnLFxuICAgICAgICAgICAgICBuZXdIZWlnaHQ6IHZpZXdwb3J0SGVpZ2h0LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICcqJyxcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH0pO1xufVxuXG4vKipcbiAqIOiOt+WPluaIluWIm+W7uuWFseS6q+eahFJlc2l6ZU9ic2VydmVy5a6e5L6LXG4gKi9cbmZ1bmN0aW9uIGdldFNoYXJlZFJlc2l6ZU9ic2VydmVyKCk6IFJlc2l6ZU9ic2VydmVyIHtcbiAgaWYgKCF3aW5kb3cuX3NoYXJlZFJlc2l6ZU9ic2VydmVyKSB7XG4gICAgd2luZG93Ll9vYnNlcnZlZEVsZW1lbnRzID0gbmV3IE1hcCgpO1xuXG4gICAgd2luZG93Ll9zaGFyZWRSZXNpemVPYnNlcnZlciA9IG5ldyBSZXNpemVPYnNlcnZlcihlbnRyaWVzID0+IHtcbiAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgZW50cmllcykge1xuICAgICAgICBjb25zdCBlbGVtZW50ID0gZW50cnkudGFyZ2V0O1xuXG4gICAgICAgIGNvbnN0IGRhdGEgPSB3aW5kb3cuX29ic2VydmVkRWxlbWVudHM/LmdldChlbGVtZW50IGFzIEhUTUxFbGVtZW50KTtcbiAgICAgICAgaWYgKGRhdGEpIHtcbiAgICAgICAgICBjb25zdCB7IGlmcmFtZSB9ID0gZGF0YTtcbiAgICAgICAgICBhZGp1c3RJZnJhbWVIZWlnaHQoaWZyYW1lKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIHdpbmRvdy5fc2hhcmVkUmVzaXplT2JzZXJ2ZXI7XG59XG5cbi8qKlxuICog6LCD5pW0aWZyYW1l6auY5bqmXG4gKiBAcGFyYW0gaWZyYW1lIGlmcmFtZeWFg+e0oFxuICovXG5mdW5jdGlvbiBhZGp1c3RJZnJhbWVIZWlnaHQoaWZyYW1lOiBIVE1MSUZyYW1lRWxlbWVudCkge1xuICBjb25zdCAkaWZyYW1lID0gJChpZnJhbWUpO1xuICBpZiAoISRpZnJhbWUubGVuZ3RoIHx8ICEkaWZyYW1lWzBdLmNvbnRlbnRXaW5kb3cgfHwgISRpZnJhbWVbMF0uY29udGVudFdpbmRvdy5kb2N1bWVudC5ib2R5KSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgZG9jID0gJGlmcmFtZVswXS5jb250ZW50V2luZG93LmRvY3VtZW50O1xuXG4gIGNvbnN0IGJvZHlIZWlnaHQgPSBkb2MuYm9keS5vZmZzZXRIZWlnaHQ7XG4gIGNvbnN0IGh0bWxIZWlnaHQgPSBkb2MuZG9jdW1lbnRFbGVtZW50Lm9mZnNldEhlaWdodDtcblxuICBjb25zdCBuZXdIZWlnaHQgPSBNYXRoLm1heChib2R5SGVpZ2h0LCBodG1sSGVpZ2h0KTtcbiAgY29uc3QgY3VycmVudEhlaWdodCA9IHBhcnNlRmxvYXQoJGlmcmFtZS5jc3MoJ2hlaWdodCcpKSB8fCAwO1xuXG4gIGlmIChNYXRoLmFicyhjdXJyZW50SGVpZ2h0IC0gbmV3SGVpZ2h0KSA+IDUpIHtcbiAgICAkaWZyYW1lLmNzcygnaGVpZ2h0JywgbmV3SGVpZ2h0ICsgJ3B4Jyk7XG5cbiAgICBpZiAoJGlmcmFtZS5hdHRyKCdkYXRhLW5lZWRzLXZoJykgPT09ICd0cnVlJyAmJiBpZnJhbWUuY29udGVudFdpbmRvdykge1xuICAgICAgaWZyYW1lLmNvbnRlbnRXaW5kb3cucG9zdE1lc3NhZ2UoXG4gICAgICAgIHtcbiAgICAgICAgICByZXF1ZXN0OiAndXBkYXRlVmlld3BvcnRIZWlnaHQnLFxuICAgICAgICAgIG5ld0hlaWdodDogd2luZG93LmlubmVySGVpZ2h0LFxuICAgICAgICB9LFxuICAgICAgICAnKicsXG4gICAgICApO1xuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIOinguWvn2lmcmFtZeWGheWuueeUqOS6juiHquWKqOiwg+aVtOmrmOW6plxuICogQHBhcmFtIGlmcmFtZSBpZnJhbWXlhYPntKBcbiAqL1xuZnVuY3Rpb24gb2JzZXJ2ZUlmcmFtZUNvbnRlbnQoaWZyYW1lOiBIVE1MSUZyYW1lRWxlbWVudCkge1xuICBjb25zdCAkaWZyYW1lID0gJChpZnJhbWUpO1xuICBpZiAoISRpZnJhbWUubGVuZ3RoIHx8ICEkaWZyYW1lWzBdLmNvbnRlbnRXaW5kb3cgfHwgISRpZnJhbWVbMF0uY29udGVudFdpbmRvdy5kb2N1bWVudC5ib2R5KSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIHRyeSB7XG4gICAgY29uc3QgZG9jQm9keSA9ICRpZnJhbWVbMF0uY29udGVudFdpbmRvdy5kb2N1bWVudC5ib2R5O1xuXG4gICAgY29uc3QgcmVzaXplT2JzZXJ2ZXIgPSBnZXRTaGFyZWRSZXNpemVPYnNlcnZlcigpO1xuXG4gICAgaWYgKHdpbmRvdy5fb2JzZXJ2ZWRFbGVtZW50cykge1xuICAgICAgZm9yIChjb25zdCBbZWxlbWVudCwgZGF0YV0gb2Ygd2luZG93Ll9vYnNlcnZlZEVsZW1lbnRzLmVudHJpZXMoKSkge1xuICAgICAgICBpZiAoZGF0YS5pZnJhbWUgPT09IGlmcmFtZSkge1xuICAgICAgICAgIHJlc2l6ZU9ic2VydmVyLnVub2JzZXJ2ZShlbGVtZW50KTtcbiAgICAgICAgICB3aW5kb3cuX29ic2VydmVkRWxlbWVudHMuZGVsZXRlKGVsZW1lbnQpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgd2luZG93Ll9vYnNlcnZlZEVsZW1lbnRzPy5zZXQoZG9jQm9keSwgeyBpZnJhbWUgfSk7XG4gICAgcmVzaXplT2JzZXJ2ZXIub2JzZXJ2ZShkb2NCb2R5KTtcblxuICAgIGFkanVzdElmcmFtZUhlaWdodChpZnJhbWUpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGxvZy5lcnJvcignW1JlbmRlcl0g6K6+572uIGlmcmFtZSDlhoXlrrnop4Llr5/ml7blh7rplJk6JywgZXJyb3IpO1xuICB9XG59XG5cbi8qKlxuICog5aSE55CG5rK554y06ISa5pys5YW85a655qih5byP5Lyg5p2l55qE5raI5oGvXG4gKiBAcGFyYW0gZXZlbnQg5raI5oGv5LqL5Lu2XG4gKi9cbmZ1bmN0aW9uIGhhbmRsZVRhbXBlcm1vbmtleU1lc3NhZ2VzKGV2ZW50OiBNZXNzYWdlRXZlbnQpOiB2b2lkIHtcbiAgaWYgKGV2ZW50LmRhdGEudHlwZSA9PT0gJ2J1dHRvbkNsaWNrJykge1xuICAgIGNvbnN0IGJ1dHRvbk5hbWUgPSBldmVudC5kYXRhLm5hbWU7XG4gICAgJCgnLnFyLS1idXR0b24ubWVudV9idXR0b24nKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICgkKHRoaXMpLmZpbmQoJy5xci0tYnV0dG9uLWxhYmVsJykudGV4dCgpLnRyaW0oKSA9PT0gYnV0dG9uTmFtZSkge1xuICAgICAgICAkKHRoaXMpLnRyaWdnZXIoJ2NsaWNrJyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0gZWxzZSBpZiAoZXZlbnQuZGF0YS50eXBlID09PSAndGV4dElucHV0Jykge1xuICAgIGNvbnN0ICRzZW5kVGV4dGFyZWEgPSBqUXVlcnkoJyNzZW5kX3RleHRhcmVhJyk7XG4gICAgaWYgKCRzZW5kVGV4dGFyZWEubGVuZ3RoKSB7XG4gICAgICAkc2VuZFRleHRhcmVhLnZhbChldmVudC5kYXRhLnRleHQpLnRyaWdnZXIoJ2lucHV0JykudHJpZ2dlcignY2hhbmdlJyk7XG4gICAgfVxuICB9IGVsc2UgaWYgKGV2ZW50LmRhdGEudHlwZSA9PT0gJ3NlbmRDbGljaycpIHtcbiAgICBjb25zdCAkc2VuZEJ1dHRvbiA9IGpRdWVyeSgnI3NlbmRfYnV0Jyk7XG4gICAgaWYgKCRzZW5kQnV0dG9uLmxlbmd0aCkge1xuICAgICAgJHNlbmRCdXR0b24udHJpZ2dlcignY2xpY2snKTtcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiDmsrnnjLTlhbzlrrnmqKHlvI8t5Yib5bu65YWo5bGA6Z+z6aKR566h55CG5ZmoXG4gKi9cbmZ1bmN0aW9uIGNyZWF0ZUdsb2JhbEF1ZGlvTWFuYWdlcigpIHtcbiAgbGV0IGN1cnJlbnRQbGF5aW5nSWZyYW1lSWQ6IHN0cmluZyB8IG51bGwgPSBudWxsO1xuXG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgaWYgKGV2ZW50LmRhdGEudHlwZSA9PT0gJ2F1ZGlvUGxheScpIHtcbiAgICAgIGNvbnN0IG5ld0lmcmFtZUlkID0gZXZlbnQuZGF0YS5pZnJhbWVJZDtcblxuICAgICAgaWYgKGN1cnJlbnRQbGF5aW5nSWZyYW1lSWQgJiYgY3VycmVudFBsYXlpbmdJZnJhbWVJZCAhPT0gbmV3SWZyYW1lSWQpIHtcbiAgICAgICAgJCgnaWZyYW1lJykuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgY29uc3QgaWZyYW1lID0gdGhpcyBhcyBIVE1MSUZyYW1lRWxlbWVudDtcbiAgICAgICAgICBpZiAoaWZyYW1lLmNvbnRlbnRXaW5kb3cpIHtcbiAgICAgICAgICAgIGlmcmFtZS5jb250ZW50V2luZG93LnBvc3RNZXNzYWdlKFxuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ3N0b3BBdWRpbycsXG4gICAgICAgICAgICAgICAgaWZyYW1lSWQ6IG5ld0lmcmFtZUlkLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAnKicsXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGN1cnJlbnRQbGF5aW5nSWZyYW1lSWQgPSBuZXdJZnJhbWVJZDtcbiAgICB9XG4gIH0pO1xufVxuXG4vKipcbiAqIOWkhOeQhuayueeMtOWFvOWuueaAp+iuvue9ruaUueWPmFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlVGFtcGVybW9ua2V5Q29tcGF0aWJpbGl0eUNoYW5nZShlbmFibGU6IGJvb2xlYW4sIHVzZXJJbnB1dDogYm9vbGVhbiA9IHRydWUpIHtcbiAgaWYgKHVzZXJJbnB1dCkge1xuICAgIHNhdmVTZXR0aW5nVmFsdWUoJ3JlbmRlci50YW1wZXJtb25rZXlfY29tcGF0aWJpbGl0eScsIGVuYWJsZSk7XG4gIH1cblxuICBpZiAoIWdldFNldHRpbmdWYWx1ZSgnZW5hYmxlZF9leHRlbnNpb24nKSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmIChlbmFibGUpIHtcbiAgICBpZiAoIXRhbXBlcm1vbmtleU1lc3NhZ2VMaXN0ZW5lcikge1xuICAgICAgdGFtcGVybW9ua2V5TWVzc2FnZUxpc3RlbmVyID0gaGFuZGxlVGFtcGVybW9ua2V5TWVzc2FnZXM7XG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIHRhbXBlcm1vbmtleU1lc3NhZ2VMaXN0ZW5lcik7XG4gICAgICBjcmVhdGVHbG9iYWxBdWRpb01hbmFnZXIoKTtcbiAgICB9XG4gIH0gZWxzZSBpZiAodGFtcGVybW9ua2V5TWVzc2FnZUxpc3RlbmVyKSB7XG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCB0YW1wZXJtb25rZXlNZXNzYWdlTGlzdGVuZXIpO1xuICAgIHRhbXBlcm1vbmtleU1lc3NhZ2VMaXN0ZW5lciA9IG51bGw7XG4gIH1cblxuICBhd2FpdCBjbGVhckFuZFJlbmRlckFsbElmcmFtZXMoKTtcbn1cblxuLy8g5omp5bGVV2luZG935o6l5Y+j5a6a5LmJXG5kZWNsYXJlIGdsb2JhbCB7XG4gIGludGVyZmFjZSBXaW5kb3cge1xuICAgIF9zaGFyZWRSZXNpemVPYnNlcnZlcj86IFJlc2l6ZU9ic2VydmVyO1xuICAgIF9vYnNlcnZlZEVsZW1lbnRzPzogTWFwPEhUTUxFbGVtZW50LCB7IGlmcmFtZTogSFRNTElGcmFtZUVsZW1lbnQgfT47XG4gICAgZ2M/OiAoKSA9PiB2b2lkO1xuICB9XG59XG5cbmV4cG9ydCBjb25zdCBwYXJ0aWFsUmVuZGVyRXZlbnRzID0gW1xuICBldmVudF90eXBlcy5DSEFSQUNURVJfTUVTU0FHRV9SRU5ERVJFRCxcbiAgZXZlbnRfdHlwZXMuVVNFUl9NRVNTQUdFX1JFTkRFUkVELFxuICBldmVudF90eXBlcy5NRVNTQUdFX1VQREFURUQsXG4gIGV2ZW50X3R5cGVzLk1FU1NBR0VfU1dJUEVELFxuXTtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZVJlbmRlclRvZ2dsZSh1c2VySW5wdXQ6IGJvb2xlYW4gPSB0cnVlLCBlbmFibGU6IGJvb2xlYW4gPSB0cnVlKSB7XG4gIGlmIChlbmFibGUpIHtcbiAgICByZW5kZXJNZXNzYWdlc0luSWZyYW1lcyhSRU5ERVJfTU9ERVMuRlVMTCk7XG4gIH1cbiAgaWYgKHVzZXJJbnB1dCkge1xuICAgIHNhdmVTZXR0aW5nVmFsdWUoJ3JlbmRlci5yZW5kZXJfZW5hYmxlZCcsIGVuYWJsZSk7XG4gIH1cbn1cblxuLyoqXG4gKiDmuIXnkIblkI7vvIzph43mlrDmuLLmn5PmiYDmnIlpZnJhbWVcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNsZWFyQW5kUmVuZGVyQWxsSWZyYW1lcygpIHtcbiAgYXdhaXQgY2xlYXJBbGxJZnJhbWVzKCk7XG4gIGlmICh0aGlzX2NoaWQgIT09IHVuZGVmaW5lZCkge1xuICAgIGF3YWl0IHJlbG9hZEN1cnJlbnRDaGF0KCk7XG4gICAgYXdhaXQgcmVuZGVyQWxsSWZyYW1lcygpO1xuICB9XG59XG5cbi8qKlxuICog5riy5p+T5omA5pyJaWZyYW1lXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW5kZXJBbGxJZnJhbWVzKCkge1xuICBhd2FpdCByZW5kZXJNZXNzYWdlc0luSWZyYW1lcyhSRU5ERVJfTU9ERVMuRlVMTCk7XG4gIGxvZy5pbmZvKCdbUmVuZGVyXSDmuLLmn5PmiYDmnIlpZnJhbWUnKTtcbn1cblxuLyoqXG4gKiDmuLLmn5Ppg6jliIZpZnJhbWVcbiAqIEBwYXJhbSBtZXNJZCDmtojmga9JRFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVuZGVyUGFydGlhbElmcmFtZXMobWVzSWQ6IG51bWJlcikge1xuICBjb25zdCBwcm9jZXNzRGVwdGggPSBwYXJzZUludCgkKCcjcmVuZGVyLWRlcHRoJykudmFsKCkgYXMgc3RyaW5nLCAxMCk7XG4gIGNvbnN0IGNvbnRleHQgPSBnZXRDb250ZXh0KCk7XG4gIGNvbnN0IHRvdGFsTWVzc2FnZXMgPSBjb250ZXh0LmNoYXQubGVuZ3RoO1xuXG4gIGlmIChwcm9jZXNzRGVwdGggPiAwKSB7XG4gICAgY29uc3QgZGVwdGhPZmZzZXQgPSB0b3RhbE1lc3NhZ2VzIC0gcHJvY2Vzc0RlcHRoO1xuXG4gICAgaWYgKG1lc0lkIDwgZGVwdGhPZmZzZXQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH1cblxuICBhd2FpdCByZW5kZXJNZXNzYWdlc0luSWZyYW1lcyhSRU5ERVJfTU9ERVMuUEFSVElBTCwgbWVzSWQpO1xuXG4gIGxvZy5pbmZvKCdbUmVuZGVyXSDmuLLmn5MnICsgbWVzSWQgKyAn5Y+35raI5oGv55qEaWZyYW1lJyk7XG59XG5cbi8qKlxuICog6ZSA5q+BaWZyYW1lXG4gKiBAcGFyYW0gaWZyYW1lIGlmcmFtZeWFg+e0oFxuICovXG5leHBvcnQgZnVuY3Rpb24gZGVzdHJveUlmcmFtZShpZnJhbWU6IEhUTUxJRnJhbWVFbGVtZW50KTogUHJvbWlzZTx2b2lkPiB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICBjb25zdCAkaWZyYW1lID0gJChpZnJhbWUpO1xuXG4gICAgaWYgKCEkaWZyYW1lLmxlbmd0aCkge1xuICAgICAgcmVzb2x2ZSgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGlmcmFtZUlkID0gJGlmcmFtZS5hdHRyKCdpZCcpO1xuXG4gICAgJGlmcmFtZS5vZmYoKTtcblxuICAgIHRyeSB7XG4gICAgICBpZiAoJGlmcmFtZVswXS5jb250ZW50V2luZG93KSB7XG4gICAgICAgIGNvbnN0IGlmcmFtZURvYyA9ICRpZnJhbWVbMF0uY29udGVudFdpbmRvdy5kb2N1bWVudDtcbiAgICAgICAgaWYgKGlmcmFtZURvYykge1xuICAgICAgICAgICQoaWZyYW1lRG9jKS5maW5kKCcqJykub2ZmKCk7XG4gICAgICAgICAgJChpZnJhbWVEb2MpLm9mZigpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgbG9nLmRlYnVnKCdbUmVuZGVyXSDmuIXnkIZpZnJhbWXlhoXpg6jkuovku7bml7blh7rplJk6JywgZSk7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0ICRtZWRpYUVsZW1lbnRzID0gJGlmcmFtZS5jb250ZW50cygpLmZpbmQoJ2F1ZGlvLCB2aWRlbycpO1xuICAgICAgJG1lZGlhRWxlbWVudHMuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzIGluc3RhbmNlb2YgSFRNTE1lZGlhRWxlbWVudCkge1xuICAgICAgICAgIHRoaXMucGF1c2UoKTtcbiAgICAgICAgICB0aGlzLnNyYyA9ICcnO1xuICAgICAgICAgIHRoaXMubG9hZCgpO1xuICAgICAgICAgICQodGhpcykub2ZmKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGxvZy5kZWJ1ZygnW1JlbmRlcl0g5riF55CG5aqS5L2T5YWD57Sg5pe25Ye66ZSZOicsIGUpO1xuICAgIH1cblxuICAgIGlmICgkaWZyYW1lWzBdLmNvbnRlbnRXaW5kb3cgJiYgJ3N0b3AnIGluICRpZnJhbWVbMF0uY29udGVudFdpbmRvdykge1xuICAgICAgJGlmcmFtZVswXS5jb250ZW50V2luZG93LnN0b3AoKTtcbiAgICB9XG5cbiAgICAvLyDlpoLmnpzmnIlSZXNpemVPYnNlcnZlcuWunuS+i+WSjOW3suinguWvn+WFg+e0oOeahOiusOW9lVxuICAgIGlmICh3aW5kb3cuX3NoYXJlZFJlc2l6ZU9ic2VydmVyICYmIHdpbmRvdy5fb2JzZXJ2ZWRFbGVtZW50cykge1xuICAgICAgZm9yIChjb25zdCBbZWxlbWVudCwgZGF0YV0gb2Ygd2luZG93Ll9vYnNlcnZlZEVsZW1lbnRzLmVudHJpZXMoKSkge1xuICAgICAgICBpZiAoZGF0YS5pZnJhbWUgPT09IGlmcmFtZSkge1xuICAgICAgICAgIHdpbmRvdy5fc2hhcmVkUmVzaXplT2JzZXJ2ZXIudW5vYnNlcnZlKGVsZW1lbnQpO1xuICAgICAgICAgIHdpbmRvdy5fb2JzZXJ2ZWRFbGVtZW50cy5kZWxldGUoZWxlbWVudCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyDmuIXnqbppZnJhbWXlhoXlrrlcbiAgICBpZiAoJGlmcmFtZVswXS5jb250ZW50V2luZG93KSB7XG4gICAgICB0cnkge1xuICAgICAgICBpZiAoaWZyYW1lSWQgJiYgdHlwZW9mIGV2ZW50U291cmNlLnJlbW92ZUxpc3RlbmVyID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgZXZlbnRTb3VyY2UucmVtb3ZlTGlzdGVuZXIoJ21lc3NhZ2VfaWZyYW1lX3JlbmRlcl9lbmRlZCcsIGlmcmFtZUlkIGFzIGFueSk7XG4gICAgICAgICAgZXZlbnRTb3VyY2UucmVtb3ZlTGlzdGVuZXIoJ21lc3NhZ2VfaWZyYW1lX3JlbmRlcl9zdGFydGVkJywgaWZyYW1lSWQgYXMgYW55KTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBsb2cuZGVidWcoJ1tSZW5kZXJdIOa4heepumlmcmFtZeWGheWuueaXtuWHuumUmTonLCBlKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyDku45ET03kuK3np7vpmaRcbiAgICAkaWZyYW1lLnJlbW92ZSgpO1xuXG4gICAgLy8g56e76ZmkalF1ZXJ55pWw5o2u57yT5a2YXG4gICAgdHJ5IHtcbiAgICAgICRpZnJhbWUucmVtb3ZlRGF0YSgpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGxvZy5kZWJ1ZygnW1JlbmRlcl0g56e76ZmkalF1ZXJ55pWw5o2u57yT5a2Y5pe25Ye66ZSZOicsIGUpO1xuICAgIH1cblxuICAgIGlmICh3aW5kb3cuX29ic2VydmVkRWxlbWVudHM/LnNpemUgPT09IDAgJiYgd2luZG93Ll9zaGFyZWRSZXNpemVPYnNlcnZlcikge1xuICAgICAgd2luZG93Ll9zaGFyZWRSZXNpemVPYnNlcnZlci5kaXNjb25uZWN0KCk7XG4gICAgICB3aW5kb3cuX3NoYXJlZFJlc2l6ZU9ic2VydmVyID0gdW5kZWZpbmVkO1xuICAgICAgbG9nLmluZm8oJ1tSZW5kZXJdIOaJgOaciWlmcmFtZeW3suenu+mZpO+8jOWBnOatouinguWvnycpO1xuICAgIH1cblxuICAgIC8vIOehruS/neaJgOaciea4heeQhuaTjeS9nOmDveWujOaIkOWQjuWGjXJlc29sdmVcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHJlc29sdmUoKTtcbiAgICB9LCAwKTtcbiAgfSk7XG59XG5cbi8qKlxuICog5riF55CG5omA5pyJaWZyYW1lXG4gKiBAcmV0dXJucyB7UHJvbWlzZTx2b2lkPn1cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNsZWFyQWxsSWZyYW1lcygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgJGlmcmFtZXMgPSAkKCdpZnJhbWVbaWRePVwibWVzc2FnZS1pZnJhbWVcIl0nKTtcbiAgYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgJGlmcmFtZXMudG9BcnJheSgpLm1hcChhc3luYyBpZnJhbWUgPT4ge1xuICAgICAgYXdhaXQgZGVzdHJveUlmcmFtZShpZnJhbWUgYXMgSFRNTElGcmFtZUVsZW1lbnQpO1xuICAgIH0pLFxuICApO1xuXG4gIC8vIOa4heeQhuebuOWFs+eahOS6i+S7tuebkeWQrOWZqFxuICB0cnkge1xuICAgIGlmICh0eXBlb2YgZXZlbnRTb3VyY2UucmVtb3ZlTGlzdGVuZXIgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIGV2ZW50U291cmNlLnJlbW92ZUxpc3RlbmVyKCdtZXNzYWdlX2lmcmFtZV9yZW5kZXJfc3RhcnRlZCcsIG51bGwgYXMgYW55KTtcbiAgICAgIGV2ZW50U291cmNlLnJlbW92ZUxpc3RlbmVyKCdtZXNzYWdlX2lmcmFtZV9yZW5kZXJfZW5kZWQnLCBudWxsIGFzIGFueSk7XG4gICAgfVxuICB9IGNhdGNoIChlKSB7XG4gICAgbG9nLmRlYnVnKCdbUmVuZGVyXSDmuIXnkIbkuovku7bnm5HlkKzlmajml7blh7rplJk6JywgZSk7XG4gIH1cblxuICAvLyDlsJ3or5XkuLvliqjop6blj5HlnoPlnL7lm57mlLZcbiAgdHJ5IHtcbiAgICBsZXQgYXJyID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMDsgaSsrKSB7XG4gICAgICBhcnIucHVzaChuZXcgQXJyYXkoMTAwMDAwMCkuZmlsbCgxKSk7XG4gICAgfVxuICAgIGFyciA9IG51bGwgYXMgYW55O1xuXG4gICAgaWYgKHdpbmRvdy5nYykge1xuICAgICAgd2luZG93LmdjKCk7XG4gICAgfVxuICB9IGNhdGNoIChlKSB7XG4gICAgbG9nLmRlYnVnKCflsJ3or5Xop6blj5HlnoPlnL7lm57mlLbml7blh7rplJk6JywgZSk7XG4gIH1cbn1cblxuLyoqXG4gKiDorr7nva5pZnJhbWXnp7vpmaTnm5HlkKzlmahcbiAqIEByZXR1cm5zIHtNdXRhdGlvbk9ic2VydmVyfSDop4Llr5/lmajlrp7kvotcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldHVwSWZyYW1lUmVtb3ZhbExpc3RlbmVyKCk6IE11dGF0aW9uT2JzZXJ2ZXIge1xuICBjb25zdCBvYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKG11dGF0aW9ucyA9PiB7XG4gICAgbXV0YXRpb25zLmZvckVhY2gobXV0YXRpb24gPT4ge1xuICAgICAgaWYgKG11dGF0aW9uLnJlbW92ZWROb2Rlcy5sZW5ndGgpIHtcbiAgICAgICAgbXV0YXRpb24ucmVtb3ZlZE5vZGVzLmZvckVhY2gobm9kZSA9PiB7XG4gICAgICAgICAgaWYgKG5vZGUgaW5zdGFuY2VvZiBIVE1MSUZyYW1lRWxlbWVudCkge1xuICAgICAgICAgICAgZGVzdHJveUlmcmFtZShub2RlKS5jYXRjaChlcnIgPT4ge1xuICAgICAgICAgICAgICBsb2cuZXJyb3IoJ1tSZW5kZXJdIOa4heeQhmlmcmFtZeaXtuWHuumUmTonLCBlcnIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBlbHNlIGlmIChub2RlIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgICAgIGNvbnN0IGlmcmFtZXMgPSBub2RlLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lmcmFtZScpO1xuICAgICAgICAgICAgaWYgKGlmcmFtZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgIGlmcmFtZXMuZm9yRWFjaChpZnJhbWUgPT4ge1xuICAgICAgICAgICAgICAgIGRlc3Ryb3lJZnJhbWUoaWZyYW1lKS5jYXRjaChlcnIgPT4ge1xuICAgICAgICAgICAgICAgICAgbG9nLmVycm9yKCdbUmVuZGVyXSDmuIXnkIZpZnJhbWXml7blh7rplJk6JywgZXJyKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG5cbiAgb2JzZXJ2ZXIub2JzZXJ2ZShkb2N1bWVudC5ib2R5LCB7IGNoaWxkTGlzdDogdHJ1ZSwgc3VidHJlZTogdHJ1ZSB9KTtcbiAgcmV0dXJuIG9ic2VydmVyO1xufVxuXG4vKipcbiAqIOWIoOmZpOa2iOaBr+WQjumHjeaWsOa4suafk1xuICogQHBhcmFtIG1lc0lkIOa2iOaBr0lEXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW5kZXJNZXNzYWdlQWZ0ZXJEZWxldGUobWVzSWQ6IG51bWJlcikge1xuICBjb25zdCBjb250ZXh0ID0gZ2V0Q29udGV4dCgpO1xuICBjb25zdCBwcm9jZXNzRGVwdGggPSBwYXJzZUludCgkKCcjcmVuZGVyLWRlcHRoJykudmFsKCkgYXMgc3RyaW5nLCAxMCk7XG4gIGNvbnN0IHRvdGFsTWVzc2FnZXMgPSBjb250ZXh0LmNoYXQubGVuZ3RoO1xuICBjb25zdCBtYXhSZW1haW5JZCA9IG1lc0lkIC0gMTtcblxuICBjb25zdCBnZXRNZXNzYWdlID0gKGlkOiBudW1iZXIpID0+IHtcbiAgICBjb25zdCBtZXNzYWdlID0gY29udGV4dC5jaGF0W2lkXSA/PyB7fTtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfTtcblxuICBjb25zdCBnZXRJZnJhbWUgPSAoaWQ6IG51bWJlcikgPT4ge1xuICAgIGNvbnN0ICRpZnJhbWUgPSAkKCdbaWRePVwibWVzc2FnZS1pZnJhbWUtJyArIGlkICsgJy1cIl0nKTtcbiAgICByZXR1cm4gJGlmcmFtZS5sZW5ndGggPiAwID8gKCRpZnJhbWUuZ2V0KDApIGFzIEhUTUxJRnJhbWVFbGVtZW50KSA6IG51bGw7XG4gIH07XG5cbiAgY29uc3QgY2hlY2tDb2RlQmxvY2sgPSAobWVzc2FnZTogYW55KSA9PiB7XG4gICAgcmV0dXJuIC9gYGBbXFxzXFxTXSo/YGBgLy50ZXN0KG1lc3NhZ2UubWVzKTtcbiAgfTtcbiAgLy8g6ICD6JmR5Yiw6auY5qW85bGC55qE5oOF5Ya177yM5rex5bqm5Li6MOaXtu+8jOWPqua4suafk+acgOWQjuS4gOS4qua2iOaBr1xuICBpZiAocHJvY2Vzc0RlcHRoID09PSAwKSB7XG4gICAgY29uc3QgbWVzc2FnZSA9IGdldE1lc3NhZ2UobWF4UmVtYWluSWQpO1xuICAgIGNvbnN0IGhhc0NvZGVCbG9jayA9IGNoZWNrQ29kZUJsb2NrKG1lc3NhZ2UpO1xuICAgIGNvbnN0IGlmcmFtZSA9IGdldElmcmFtZShtYXhSZW1haW5JZCk7XG5cbiAgICBpZiAoIWhhc0NvZGVCbG9jayAmJiAhaWZyYW1lKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGF3YWl0IGRlc3Ryb3lJZnJhbWUoaWZyYW1lIGFzIEhUTUxJRnJhbWVFbGVtZW50KTtcbiAgICB1cGRhdGVNZXNzYWdlQmxvY2sobWF4UmVtYWluSWQsIG1lc3NhZ2UpO1xuICAgIHJlbmRlclBhcnRpYWxJZnJhbWVzKG1heFJlbWFpbklkKTtcbiAgfSBlbHNlIHtcbiAgICBsZXQgc3RhcnRSZW5kZXJJbmRleCA9IHRvdGFsTWVzc2FnZXMgLSBwcm9jZXNzRGVwdGg7XG4gICAgaWYgKHN0YXJ0UmVuZGVySW5kZXggPCAwKSB7XG4gICAgICBzdGFydFJlbmRlckluZGV4ID0gMDtcbiAgICB9XG5cbiAgICBmb3IgKGxldCBpID0gc3RhcnRSZW5kZXJJbmRleDsgaSA8PSBtYXhSZW1haW5JZDsgaSsrKSB7XG4gICAgICBjb25zdCBtZXNzYWdlID0gZ2V0TWVzc2FnZShpKTtcbiAgICAgIGNvbnN0IGhhc0NvZGVCbG9jayA9IGNoZWNrQ29kZUJsb2NrKG1lc3NhZ2UpO1xuICAgICAgY29uc3QgaWZyYW1lID0gZ2V0SWZyYW1lKGkpO1xuXG4gICAgICBpZiAoIWhhc0NvZGVCbG9jayAmJiAhaWZyYW1lKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgYXdhaXQgZGVzdHJveUlmcmFtZShpZnJhbWUgYXMgSFRNTElGcmFtZUVsZW1lbnQpO1xuICAgICAgdXBkYXRlTWVzc2FnZUJsb2NrKGksIG1lc3NhZ2UpO1xuICAgICAgcmVuZGVyUGFydGlhbElmcmFtZXMoaSk7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBjb25zdCBoYW5kbGVQYXJ0aWFsUmVuZGVyID0gKG1lc0lkOiBudW1iZXIpID0+IHtcbiAgbG9nLmluZm8oJ1tSZW5kZXJdIOinpuWPkeWxgOmDqOa4suafk++8jOa2iOaBr0lEOicsIG1lc0lkKTtcbiAgY29uc3QgcHJvY2Vzc0RlcHRoID0gcGFyc2VJbnQoJCgnI3JlbmRlci1kZXB0aCcpLnZhbCgpIGFzIHN0cmluZywgMTApO1xuICBjb25zdCBjb250ZXh0ID0gZ2V0Q29udGV4dCgpO1xuICBjb25zdCB0b3RhbE1lc3NhZ2VzID0gY29udGV4dC5jaGF0Lmxlbmd0aDtcblxuICBpZiAocHJvY2Vzc0RlcHRoID4gMCkge1xuICAgIGNvbnN0IGRlcHRoT2Zmc2V0ID0gdG90YWxNZXNzYWdlcyAtIHByb2Nlc3NEZXB0aDtcblxuICAgIGlmIChtZXNJZCA8IGRlcHRoT2Zmc2V0KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9XG5cbiAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgcmVuZGVyTWVzc2FnZXNJbklmcmFtZXMoUkVOREVSX01PREVTLlBBUlRJQUwsIG1lc0lkKTtcbiAgfSwgMTAwKTtcbn07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/component/message_iframe/render_message.ts\n")},"./src/component/message_iframe/render_optimize.ts":
/*!*********************************************************!*\
  !*** ./src/component/message_iframe/render_optimize.ts ***!
  \*********************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addRenderingOptimizeSettings: () => (/* binding */ addRenderingOptimizeSettings),\n/* harmony export */   removeRenderingOptimizeSettings: () => (/* binding */ removeRenderingOptimizeSettings)\n/* harmony export */ });\n// 保存原始高亮方法\nconst originalHighlightElement = hljs.highlightElement;\n/**\n * 添加前端卡渲染优化设置\n */\nfunction addRenderingOptimizeSettings() {\n    hljs.highlightElement = function () {\n        return;\n    };\n}\n/**\n * 移除前端卡渲染优化设置\n */\nfunction removeRenderingOptimizeSettings() {\n    hljs.highlightElement = originalHighlightElement;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L21lc3NhZ2VfaWZyYW1lL3JlbmRlcl9vcHRpbWl6ZS50cyIsIm1hcHBpbmdzIjoiOzs7OztBQUFBLFdBQVc7QUFDWCxNQUFNLHdCQUF3QixHQUFHLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQztBQUV2RDs7R0FFRztBQUNJLFNBQVMsNEJBQTRCO0lBQzFDLElBQUksQ0FBQyxnQkFBZ0IsR0FBRztRQUN0QixPQUFPO0lBQ1QsQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQUVEOztHQUVHO0FBQ0ksU0FBUywrQkFBK0I7SUFDN0MsSUFBSSxDQUFDLGdCQUFnQixHQUFHLHdCQUF3QixDQUFDO0FBQ25ELENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvY29tcG9uZW50L21lc3NhZ2VfaWZyYW1lL3JlbmRlcl9vcHRpbWl6ZS50cz9jMjExIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIOS/neWtmOWOn+Wni+mrmOS6ruaWueazlVxuY29uc3Qgb3JpZ2luYWxIaWdobGlnaHRFbGVtZW50ID0gaGxqcy5oaWdobGlnaHRFbGVtZW50O1xuXG4vKipcbiAqIOa3u+WKoOWJjeerr+WNoea4suafk+S8mOWMluiuvue9rlxuICovXG5leHBvcnQgZnVuY3Rpb24gYWRkUmVuZGVyaW5nT3B0aW1pemVTZXR0aW5ncygpIHtcbiAgaGxqcy5oaWdobGlnaHRFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybjtcbiAgfTtcbn1cblxuLyoqXG4gKiDnp7vpmaTliY3nq6/ljaHmuLLmn5PkvJjljJborr7nva5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZVJlbmRlcmluZ09wdGltaXplU2V0dGluZ3MoKSB7XG4gIGhsanMuaGlnaGxpZ2h0RWxlbWVudCA9IG9yaWdpbmFsSGlnaGxpZ2h0RWxlbWVudDtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/component/message_iframe/render_optimize.ts\n")},"./src/component/message_iframe/utils.ts":
/*!***********************************************!*\
  !*** ./src/component/message_iframe/utils.ts ***!
  \***********************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   extractTextFromCode: () => (/* binding */ extractTextFromCode)\n/* harmony export */ });\n/**\n * 提取代码块中的文本\n * @param codeElement 代码块元素\n * @returns 提取的文本\n */\nfunction extractTextFromCode(codeElement) {\n    let textContent = '';\n    $(codeElement)\n        .contents()\n        .each(function () {\n        if (this.nodeType === Node.TEXT_NODE) {\n            textContent += this.textContent;\n        }\n        else if (this.nodeType === Node.ELEMENT_NODE) {\n            textContent += extractTextFromCode(this);\n        }\n    });\n    return textContent;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L21lc3NhZ2VfaWZyYW1lL3V0aWxzLnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTs7OztHQUlHO0FBQ0ksU0FBUyxtQkFBbUIsQ0FBQyxXQUF3QjtJQUMxRCxJQUFJLFdBQVcsR0FBRyxFQUFFLENBQUM7SUFFckIsQ0FBQyxDQUFDLFdBQVcsQ0FBQztTQUNYLFFBQVEsRUFBRTtTQUNWLElBQUksQ0FBQztRQUNKLElBQUksSUFBSSxDQUFDLFFBQVEsS0FBSyxJQUFJLENBQUMsU0FBUyxFQUFFLENBQUM7WUFDckMsV0FBVyxJQUFJLElBQUksQ0FBQyxXQUFXLENBQUM7UUFDbEMsQ0FBQzthQUFNLElBQUksSUFBSSxDQUFDLFFBQVEsS0FBSyxJQUFJLENBQUMsWUFBWSxFQUFFLENBQUM7WUFDL0MsV0FBVyxJQUFJLG1CQUFtQixDQUFDLElBQW1CLENBQUMsQ0FBQztRQUMxRCxDQUFDO0lBQ0gsQ0FBQyxDQUFDLENBQUM7SUFFTCxPQUFPLFdBQVcsQ0FBQztBQUNyQixDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBvbmVudC9tZXNzYWdlX2lmcmFtZS91dGlscy50cz81NTQ1Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICog5o+Q5Y+W5Luj56CB5Z2X5Lit55qE5paH5pysXG4gKiBAcGFyYW0gY29kZUVsZW1lbnQg5Luj56CB5Z2X5YWD57SgXG4gKiBAcmV0dXJucyDmj5Dlj5bnmoTmlofmnKxcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGV4dHJhY3RUZXh0RnJvbUNvZGUoY29kZUVsZW1lbnQ6IEhUTUxFbGVtZW50KSB7XG4gIGxldCB0ZXh0Q29udGVudCA9ICcnO1xuXG4gICQoY29kZUVsZW1lbnQpXG4gICAgLmNvbnRlbnRzKClcbiAgICAuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAodGhpcy5ub2RlVHlwZSA9PT0gTm9kZS5URVhUX05PREUpIHtcbiAgICAgICAgdGV4dENvbnRlbnQgKz0gdGhpcy50ZXh0Q29udGVudDtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5ub2RlVHlwZSA9PT0gTm9kZS5FTEVNRU5UX05PREUpIHtcbiAgICAgICAgdGV4dENvbnRlbnQgKz0gZXh0cmFjdFRleHRGcm9tQ29kZSh0aGlzIGFzIEhUTUxFbGVtZW50KTtcbiAgICAgIH1cbiAgICB9KTtcblxuICByZXR1cm4gdGV4dENvbnRlbnQ7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/component/message_iframe/utils.ts\n")},"./src/component/reference/index.ts":
/*!******************************************!*\
  !*** ./src/component/reference/index.ts ***!
  \******************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   initReference: () => (/* binding */ initReference)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/scripts/slash-commands/SlashCommandParser */ \"@sillytavern/scripts/slash-commands/SlashCommandParser\");\n\nfunction formatSlashCommands() {\n    const cmdList = Object.keys(_sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_0__.SlashCommandParser.commands)\n        .filter(key => _sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_0__.SlashCommandParser.commands[key].name === key) // exclude aliases\n        .sort((a, b) => a.toLowerCase().localeCompare(b.toLowerCase()))\n        .map(key => _sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_0__.SlashCommandParser.commands[key]);\n    const transform_unnamed_arg = (arg) => {\n        return {\n            is_required: arg.isRequired,\n            default_value: arg.defaultValue ?? undefined,\n            accepts_multiple: arg.acceptsMultiple,\n            enum_list: arg.enumList.length > 0 ? arg.enumList.map(e => e.value) : undefined,\n            type_list: arg.typeList.length > 0 ? arg.typeList : undefined,\n        };\n    };\n    const transform_named_arg = (arg) => {\n        return {\n            name: arg.name,\n            ...transform_unnamed_arg(arg),\n        };\n    };\n    const transform_help_string = (help_string) => {\n        const content = $('<span>').html(help_string);\n        return content\n            .text()\n            .split('\\n')\n            .map(line => line.trim())\n            .filter(line => line !== '')\n            .join(' ');\n    };\n    return cmdList\n        .map(cmd => ({\n        name: cmd.name,\n        named_args: cmd.namedArgumentList.map(transform_named_arg) ?? [],\n        unnamed_args: cmd.unnamedArgumentList.map(transform_unnamed_arg) ?? [],\n        return_type: cmd.returns ?? 'void',\n        help_string: transform_help_string(cmd.helpString) ?? 'NO DETAILS',\n    }))\n        .map(cmd => `/${cmd.name}${cmd.named_args.length > 0 ? ` ` : ``}${cmd.named_args\n        .map(arg => `[${arg.accepts_multiple ? `...` : ``}${arg.name}=${arg.enum_list ? arg.enum_list.join('|') : arg.type_list ? arg.type_list.join('|') : ''}]${arg.is_required ? `` : `?`}${arg.default_value ? `=${arg.default_value}` : ``}`)\n        .join(' ')}${cmd.unnamed_args.length > 0 ? ` ` : ``}${cmd.unnamed_args\n        .map(arg => `(${arg.accepts_multiple ? `...` : ``}${arg.enum_list ? arg.enum_list.join('|') : arg.type_list ? arg.type_list.join('|') : ''})${arg.is_required ? `` : `?`}${arg.default_value ? `=${arg.default_value}` : ``}`)\n        .join(' ')} // ${cmd.help_string}`)\n        .join('\\n');\n}\nasync function initReference() {\n    $('#download_slash_commands').on('click', function () {\n        const url = URL.createObjectURL(new Blob([formatSlashCommands()], { type: 'text/plain' }));\n        $(this).attr('href', url);\n        $(this).attr('download', 'slash_command.txt');\n        setTimeout(() => URL.revokeObjectURL(url), 0);\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0FBQyxDQUFDLENBQUMsQ0FBQyxFQUN0RixJQUFJLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLEdBQUcsQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLElBQUksR0FBRyxDQUFDLGFBQWEsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FDdEY7U0FDQSxJQUFJLENBQUMsR0FBRyxDQUFDLE9BQU8sR0FBRyxDQUFDLFdBQVcsRUFBRSxDQUN2QztTQUNBLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUNoQixDQUFDO0FBRU0sS0FBSyxVQUFVLGFBQWE7SUFDakMsQ0FBQyxDQUFDLDBCQUEwQixDQUFDLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRTtRQUN4QyxNQUFNLEdBQUcsR0FBRyxHQUFHLENBQUMsZUFBZSxDQUFDLElBQUksSUFBSSxDQUFDLENBQUMsbUJBQW1CLEVBQUUsQ0FBQyxFQUFFLEVBQUUsSUFBSSxFQUFFLFlBQVksRUFBRSxDQUFDLENBQUMsQ0FBQztRQUMzRixDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxHQUFHLENBQUMsQ0FBQztRQUMxQixDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsRUFBRSxtQkFBbUIsQ0FBQyxDQUFDO1FBQzlDLFVBQVUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxHQUFHLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQ2hELENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9jb21wb25lbnQvcmVmZXJlbmNlL2luZGV4LnRzPzQ2ZTEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgU2xhc2hDb21tYW5kQXJndW1lbnQsXG4gIFNsYXNoQ29tbWFuZE5hbWVkQXJndW1lbnQsXG59IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3NsYXNoLWNvbW1hbmRzL1NsYXNoQ29tbWFuZEFyZ3VtZW50JztcbmltcG9ydCB7IFNsYXNoQ29tbWFuZFBhcnNlciB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3NsYXNoLWNvbW1hbmRzL1NsYXNoQ29tbWFuZFBhcnNlcic7XG5cbmZ1bmN0aW9uIGZvcm1hdFNsYXNoQ29tbWFuZHMoKTogc3RyaW5nIHtcbiAgY29uc3QgY21kTGlzdCA9IE9iamVjdC5rZXlzKFNsYXNoQ29tbWFuZFBhcnNlci5jb21tYW5kcylcbiAgICAuZmlsdGVyKGtleSA9PiBTbGFzaENvbW1hbmRQYXJzZXIuY29tbWFuZHNba2V5XS5uYW1lID09PSBrZXkpIC8vIGV4Y2x1ZGUgYWxpYXNlc1xuICAgIC5zb3J0KChhLCBiKSA9PiBhLnRvTG93ZXJDYXNlKCkubG9jYWxlQ29tcGFyZShiLnRvTG93ZXJDYXNlKCkpKVxuICAgIC5tYXAoa2V5ID0+IFNsYXNoQ29tbWFuZFBhcnNlci5jb21tYW5kc1trZXldKTtcblxuICBjb25zdCB0cmFuc2Zvcm1fdW5uYW1lZF9hcmcgPSAoYXJnOiBTbGFzaENvbW1hbmRBcmd1bWVudCkgPT4ge1xuICAgIHJldHVybiB7XG4gICAgICBpc19yZXF1aXJlZDogYXJnLmlzUmVxdWlyZWQsXG4gICAgICBkZWZhdWx0X3ZhbHVlOiBhcmcuZGVmYXVsdFZhbHVlID8/IHVuZGVmaW5lZCxcbiAgICAgIGFjY2VwdHNfbXVsdGlwbGU6IGFyZy5hY2NlcHRzTXVsdGlwbGUsXG4gICAgICBlbnVtX2xpc3Q6IGFyZy5lbnVtTGlzdC5sZW5ndGggPiAwID8gYXJnLmVudW1MaXN0Lm1hcChlID0+IGUudmFsdWUpIDogdW5kZWZpbmVkLFxuICAgICAgdHlwZV9saXN0OiBhcmcudHlwZUxpc3QubGVuZ3RoID4gMCA/IGFyZy50eXBlTGlzdCA6IHVuZGVmaW5lZCxcbiAgICB9O1xuICB9O1xuXG4gIGNvbnN0IHRyYW5zZm9ybV9uYW1lZF9hcmcgPSAoYXJnOiBTbGFzaENvbW1hbmROYW1lZEFyZ3VtZW50KSA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IGFyZy5uYW1lLFxuICAgICAgLi4udHJhbnNmb3JtX3VubmFtZWRfYXJnKGFyZyksXG4gICAgfTtcbiAgfTtcblxuICBjb25zdCB0cmFuc2Zvcm1faGVscF9zdHJpbmcgPSAoaGVscF9zdHJpbmc6IHN0cmluZykgPT4ge1xuICAgIGNvbnN0IGNvbnRlbnQgPSAkKCc8c3Bhbj4nKS5odG1sKGhlbHBfc3RyaW5nKTtcbiAgICByZXR1cm4gY29udGVudFxuICAgICAgLnRleHQoKVxuICAgICAgLnNwbGl0KCdcXG4nKVxuICAgICAgLm1hcChsaW5lID0+IGxpbmUudHJpbSgpKVxuICAgICAgLmZpbHRlcihsaW5lID0+IGxpbmUgIT09ICcnKVxuICAgICAgLmpvaW4oJyAnKTtcbiAgfTtcblxuICByZXR1cm4gY21kTGlzdFxuICAgIC5tYXAoY21kID0+ICh7XG4gICAgICBuYW1lOiBjbWQubmFtZSxcbiAgICAgIG5hbWVkX2FyZ3M6IGNtZC5uYW1lZEFyZ3VtZW50TGlzdC5tYXAodHJhbnNmb3JtX25hbWVkX2FyZykgPz8gW10sXG4gICAgICB1bm5hbWVkX2FyZ3M6IGNtZC51bm5hbWVkQXJndW1lbnRMaXN0Lm1hcCh0cmFuc2Zvcm1fdW5uYW1lZF9hcmcpID8/IFtdLFxuICAgICAgcmV0dXJuX3R5cGU6IGNtZC5yZXR1cm5zID8/ICd2b2lkJyxcbiAgICAgIGhlbHBfc3RyaW5nOiB0cmFuc2Zvcm1faGVscF9zdHJpbmcoY21kLmhlbHBTdHJpbmcpID8/ICdOTyBERVRBSUxTJyxcbiAgICB9KSlcbiAgICAubWFwKFxuICAgICAgY21kID0+XG4gICAgICAgIGAvJHtjbWQubmFtZX0ke2NtZC5uYW1lZF9hcmdzLmxlbmd0aCA+IDAgPyBgIGAgOiBgYH0ke2NtZC5uYW1lZF9hcmdzXG4gICAgICAgICAgLm1hcChcbiAgICAgICAgICAgIGFyZyA9PlxuICAgICAgICAgICAgICBgWyR7YXJnLmFjY2VwdHNfbXVsdGlwbGUgPyBgLi4uYCA6IGBgfSR7YXJnLm5hbWV9PSR7XG4gICAgICAgICAgICAgICAgYXJnLmVudW1fbGlzdCA/IGFyZy5lbnVtX2xpc3Quam9pbignfCcpIDogYXJnLnR5cGVfbGlzdCA/IGFyZy50eXBlX2xpc3Quam9pbignfCcpIDogJydcbiAgICAgICAgICAgICAgfV0ke2FyZy5pc19yZXF1aXJlZCA/IGBgIDogYD9gfSR7YXJnLmRlZmF1bHRfdmFsdWUgPyBgPSR7YXJnLmRlZmF1bHRfdmFsdWV9YCA6IGBgfWAsXG4gICAgICAgICAgKVxuICAgICAgICAgIC5qb2luKCcgJyl9JHtjbWQudW5uYW1lZF9hcmdzLmxlbmd0aCA+IDAgPyBgIGAgOiBgYH0ke2NtZC51bm5hbWVkX2FyZ3NcbiAgICAgICAgICAubWFwKFxuICAgICAgICAgICAgYXJnID0+XG4gICAgICAgICAgICAgIGAoJHthcmcuYWNjZXB0c19tdWx0aXBsZSA/IGAuLi5gIDogYGB9JHtcbiAgICAgICAgICAgICAgICBhcmcuZW51bV9saXN0ID8gYXJnLmVudW1fbGlzdC5qb2luKCd8JykgOiBhcmcudHlwZV9saXN0ID8gYXJnLnR5cGVfbGlzdC5qb2luKCd8JykgOiAnJ1xuICAgICAgICAgICAgICB9KSR7YXJnLmlzX3JlcXVpcmVkID8gYGAgOiBgP2B9JHthcmcuZGVmYXVsdF92YWx1ZSA/IGA9JHthcmcuZGVmYXVsdF92YWx1ZX1gIDogYGB9YCxcbiAgICAgICAgICApXG4gICAgICAgICAgLmpvaW4oJyAnKX0gLy8gJHtjbWQuaGVscF9zdHJpbmd9YCxcbiAgICApXG4gICAgLmpvaW4oJ1xcbicpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaW5pdFJlZmVyZW5jZSgpIHtcbiAgJCgnI2Rvd25sb2FkX3NsYXNoX2NvbW1hbmRzJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IHVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwobmV3IEJsb2IoW2Zvcm1hdFNsYXNoQ29tbWFuZHMoKV0sIHsgdHlwZTogJ3RleHQvcGxhaW4nIH0pKTtcbiAgICAkKHRoaXMpLmF0dHIoJ2hyZWYnLCB1cmwpO1xuICAgICQodGhpcykuYXR0cignZG93bmxvYWQnLCAnc2xhc2hfY29tbWFuZC50eHQnKTtcbiAgICBzZXRUaW1lb3V0KCgpID0+IFVSTC5yZXZva2VPYmplY3RVUkwodXJsKSwgMCk7XG4gIH0pO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/component/reference/index.ts\n")},"./src/component/script_iframe.ts":
/*!****************************************!*\
  !*** ./src/component/script_iframe.ts ***!
  \****************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   destroyCharacterLevelOnExtension: () => (/* binding */ destroyCharacterLevelOnExtension),\n/* harmony export */   initializeCharacterLevelOnExtension: () => (/* binding */ initializeCharacterLevelOnExtension)\n/* harmony export */ });\n/* harmony import */ var _function_tavern_regex__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/function/tavern_regex */ \"./src/function/tavern_regex.ts\");\n/* harmony import */ var _script_url__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/script_url */ \"./src/script_url.ts\");\n/* harmony import */ var _third_party_html__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/third_party.html */ \"./src/third_party.html\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_4__);\n\n\n\n\n\nfunction loadScripts() {\n    const prefix = '脚本-';\n    const filterScriptFromRegex = (script) => script.scriptName.replace(/^【.*】/, '').startsWith(prefix);\n    const isEnabled = (script) => !script.disabled;\n    const toName = (script) => script.scriptName.replace(/^【.*】/, '').replace(prefix, '');\n    const scripts = [];\n    const enabled_global_regexes = (0,_function_tavern_regex__WEBPACK_IMPORTED_MODULE_0__.getGlobalRegexes)().filter(filterScriptFromRegex).filter(isEnabled);\n    scripts.push(...enabled_global_regexes);\n    const enabled_character_regexes = (0,_function_tavern_regex__WEBPACK_IMPORTED_MODULE_0__.getCharacterRegexes)()\n        .filter(filterScriptFromRegex)\n        .filter(isEnabled)\n        .filter(script => ((0,_function_tavern_regex__WEBPACK_IMPORTED_MODULE_0__.isCharacterTavernRegexEnabled)() ? true : script.runOnEdit));\n    scripts.push(...enabled_character_regexes);\n    const to_script = (script) => ({ name: toName(script), code: script.replaceString });\n    return scripts.map(to_script);\n}\nconst script_map = new Map();\nfunction makeScriptIframe(script) {\n    const iframe = document.createElement('iframe');\n    iframe.style.display = 'none';\n    iframe.id = `script-iframe-${script.name}`;\n    const srcdocContent = `\n    <html>\n    <head>\n      ${_third_party_html__WEBPACK_IMPORTED_MODULE_2__[\"default\"]}\n      <script src=\"${_script_url__WEBPACK_IMPORTED_MODULE_1__.script_url.get('iframe_client')}\"><\/script>\n    </head>\n    <body>\n      ${script.code}\n    </body>\n    </html>\n  `;\n    iframe.srcdoc = srcdocContent;\n    const load_promise = new Promise(resolve => {\n        iframe.onload = () => {\n            loglevel__WEBPACK_IMPORTED_MODULE_4___default().info(`[(deprecated)Script](${iframe.id}) 加载完毕`);\n            resolve();\n        };\n    });\n    document.body.appendChild(iframe);\n    return { iframe, load_promise };\n}\nfunction destroy() {\n    if (script_map.size !== 0) {\n        loglevel__WEBPACK_IMPORTED_MODULE_4___default().info(`[(deprecated)Script] 清理全局脚本...`);\n        script_map.forEach((iframe, _) => {\n            iframe.remove();\n        });\n        script_map.clear();\n        loglevel__WEBPACK_IMPORTED_MODULE_4___default().info(`[(deprecated)Script] 全局脚本清理完成!`);\n    }\n}\nasync function initialize() {\n    try {\n        destroy();\n        const scripts = loadScripts();\n        loglevel__WEBPACK_IMPORTED_MODULE_4___default().info(`[(deprecated)Script] 加载全局脚本: ${JSON.stringify(scripts.map(script => script.name))}`);\n        const load_promises = [];\n        scripts.forEach(script => {\n            const { iframe, load_promise } = makeScriptIframe(script);\n            script_map.set(script.name, iframe);\n            load_promises.push(load_promise);\n        });\n        await Promise.allSettled(load_promises);\n    }\n    catch (error) {\n        loglevel__WEBPACK_IMPORTED_MODULE_4___default().error('[(deprecated)Script] 全局脚本加载失败:', error);\n        throw error;\n    }\n}\nconst load_events = [_sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.event_types.CHAT_CHANGED];\nfunction initializeCharacterLevelOnExtension() {\n    initialize();\n    load_events.forEach(eventType => {\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.eventSource.makeFirst(eventType, initialize);\n    });\n}\nfunction destroyCharacterLevelOnExtension() {\n    load_events.forEach(eventType => {\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_3__.eventSource.removeListener(eventType, initialize);\n    });\n    destroy();\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O0FBQ0gsQ0FBQztBQUVELE1BQU0sV0FBVyxHQUFHLENBQUMsNERBQVcsQ0FBQyxZQUFZLENBQVUsQ0FBQztBQUVqRCxTQUFTLG1DQUFtQztJQUNqRCxVQUFVLEVBQUUsQ0FBQztJQUNiLFdBQVcsQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLEVBQUU7UUFDOUIsNERBQVcsQ0FBQyxTQUFTLENBQUMsU0FBUyxFQUFFLFVBQVUsQ0FBQyxDQUFDO0lBQy9DLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQztBQUVNLFNBQVMsZ0NBQWdDO0lBQzlDLFdBQVcsQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLEVBQUU7UUFDOUIsNERBQVcsQ0FBQyxjQUFjLENBQUMsU0FBUyxFQUFFLFVBQVUsQ0FBQyxDQUFDO0lBQ3BELENBQUMsQ0FBQyxDQUFDO0lBQ0gsT0FBTyxFQUFFLENBQUM7QUFDWixDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBvbmVudC9zY3JpcHRfaWZyYW1lLnRzPzc0NzIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ2V0Q2hhcmFjdGVyUmVnZXhlcywgZ2V0R2xvYmFsUmVnZXhlcywgaXNDaGFyYWN0ZXJUYXZlcm5SZWdleEVuYWJsZWQgfSBmcm9tICdAL2Z1bmN0aW9uL3RhdmVybl9yZWdleCc7XG5pbXBvcnQgeyBzY3JpcHRfdXJsIH0gZnJvbSAnQC9zY3JpcHRfdXJsJztcbmltcG9ydCB0aGlyZF9wYXJ0eSBmcm9tICdAL3RoaXJkX3BhcnR5Lmh0bWwnO1xuXG5pbXBvcnQgeyBldmVudF90eXBlcywgZXZlbnRTb3VyY2UgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0JztcbmltcG9ydCB7IFJlZ2V4U2NyaXB0RGF0YSB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL2NoYXItZGF0YSc7XG5cbmltcG9ydCBsb2cgZnJvbSAnbG9nbGV2ZWwnO1xuXG5pbnRlcmZhY2UgU2NyaXB0IHtcbiAgbmFtZTogc3RyaW5nO1xuICBjb2RlOiBzdHJpbmc7XG59XG5cbmZ1bmN0aW9uIGxvYWRTY3JpcHRzKCk6IFNjcmlwdFtdIHtcbiAgY29uc3QgcHJlZml4ID0gJ+iEmuacrC0nO1xuICBjb25zdCBmaWx0ZXJTY3JpcHRGcm9tUmVnZXggPSAoc2NyaXB0OiBSZWdleFNjcmlwdERhdGEpID0+XG4gICAgc2NyaXB0LnNjcmlwdE5hbWUucmVwbGFjZSgvXuOAkC4q44CRLywgJycpLnN0YXJ0c1dpdGgocHJlZml4KTtcbiAgY29uc3QgaXNFbmFibGVkID0gKHNjcmlwdDogUmVnZXhTY3JpcHREYXRhKSA9PiAhc2NyaXB0LmRpc2FibGVkO1xuICBjb25zdCB0b05hbWUgPSAoc2NyaXB0OiBSZWdleFNjcmlwdERhdGEpID0+IHNjcmlwdC5zY3JpcHROYW1lLnJlcGxhY2UoL17jgJAuKuOAkS8sICcnKS5yZXBsYWNlKHByZWZpeCwgJycpO1xuXG4gIGNvbnN0IHNjcmlwdHM6IFJlZ2V4U2NyaXB0RGF0YVtdID0gW107XG5cbiAgY29uc3QgZW5hYmxlZF9nbG9iYWxfcmVnZXhlcyA9IGdldEdsb2JhbFJlZ2V4ZXMoKS5maWx0ZXIoZmlsdGVyU2NyaXB0RnJvbVJlZ2V4KS5maWx0ZXIoaXNFbmFibGVkKTtcbiAgc2NyaXB0cy5wdXNoKC4uLmVuYWJsZWRfZ2xvYmFsX3JlZ2V4ZXMpO1xuXG4gIGNvbnN0IGVuYWJsZWRfY2hhcmFjdGVyX3JlZ2V4ZXMgPSBnZXRDaGFyYWN0ZXJSZWdleGVzKClcbiAgICAuZmlsdGVyKGZpbHRlclNjcmlwdEZyb21SZWdleClcbiAgICAuZmlsdGVyKGlzRW5hYmxlZClcbiAgICAuZmlsdGVyKHNjcmlwdCA9PiAoaXNDaGFyYWN0ZXJUYXZlcm5SZWdleEVuYWJsZWQoKSA/IHRydWUgOiBzY3JpcHQucnVuT25FZGl0KSk7XG4gIHNjcmlwdHMucHVzaCguLi5lbmFibGVkX2NoYXJhY3Rlcl9yZWdleGVzKTtcblxuICBjb25zdCB0b19zY3JpcHQgPSAoc2NyaXB0OiBSZWdleFNjcmlwdERhdGEpID0+ICh7IG5hbWU6IHRvTmFtZShzY3JpcHQpLCBjb2RlOiBzY3JpcHQucmVwbGFjZVN0cmluZyB9KTtcbiAgcmV0dXJuIHNjcmlwdHMubWFwKHRvX3NjcmlwdCk7XG59XG5cbmNvbnN0IHNjcmlwdF9tYXA6IE1hcDxzdHJpbmcsIEhUTUxJRnJhbWVFbGVtZW50PiA9IG5ldyBNYXAoKTtcblxuZnVuY3Rpb24gbWFrZVNjcmlwdElmcmFtZShzY3JpcHQ6IFNjcmlwdCk6IHsgaWZyYW1lOiBIVE1MSUZyYW1lRWxlbWVudDsgbG9hZF9wcm9taXNlOiBQcm9taXNlPHZvaWQ+IH0ge1xuICBjb25zdCBpZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpZnJhbWUnKTtcbiAgaWZyYW1lLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gIGlmcmFtZS5pZCA9IGBzY3JpcHQtaWZyYW1lLSR7c2NyaXB0Lm5hbWV9YDtcblxuICBjb25zdCBzcmNkb2NDb250ZW50ID0gYFxuICAgIDxodG1sPlxuICAgIDxoZWFkPlxuICAgICAgJHt0aGlyZF9wYXJ0eX1cbiAgICAgIDxzY3JpcHQgc3JjPVwiJHtzY3JpcHRfdXJsLmdldCgnaWZyYW1lX2NsaWVudCcpfVwiPjwvc2NyaXB0PlxuICAgIDwvaGVhZD5cbiAgICA8Ym9keT5cbiAgICAgICR7c2NyaXB0LmNvZGV9XG4gICAgPC9ib2R5PlxuICAgIDwvaHRtbD5cbiAgYDtcblxuICBpZnJhbWUuc3JjZG9jID0gc3JjZG9jQ29udGVudDtcblxuICBjb25zdCBsb2FkX3Byb21pc2UgPSBuZXcgUHJvbWlzZTx2b2lkPihyZXNvbHZlID0+IHtcbiAgICBpZnJhbWUub25sb2FkID0gKCkgPT4ge1xuICAgICAgbG9nLmluZm8oYFsoZGVwcmVjYXRlZClTY3JpcHRdKCR7aWZyYW1lLmlkfSkg5Yqg6L295a6M5q+VYCk7XG4gICAgICByZXNvbHZlKCk7XG4gICAgfTtcbiAgfSk7XG5cbiAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChpZnJhbWUpO1xuXG4gIHJldHVybiB7IGlmcmFtZSwgbG9hZF9wcm9taXNlIH07XG59XG5cbmZ1bmN0aW9uIGRlc3Ryb3koKTogdm9pZCB7XG4gIGlmIChzY3JpcHRfbWFwLnNpemUgIT09IDApIHtcbiAgICBsb2cuaW5mbyhgWyhkZXByZWNhdGVkKVNjcmlwdF0g5riF55CG5YWo5bGA6ISa5pysLi4uYCk7XG4gICAgc2NyaXB0X21hcC5mb3JFYWNoKChpZnJhbWUsIF8pID0+IHtcbiAgICAgIGlmcmFtZS5yZW1vdmUoKTtcbiAgICB9KTtcbiAgICBzY3JpcHRfbWFwLmNsZWFyKCk7XG4gICAgbG9nLmluZm8oYFsoZGVwcmVjYXRlZClTY3JpcHRdIOWFqOWxgOiEmuacrOa4heeQhuWujOaIkCFgKTtcbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBpbml0aWFsaXplKCk6IFByb21pc2U8dm9pZD4ge1xuICB0cnkge1xuICAgIGRlc3Ryb3koKTtcblxuICAgIGNvbnN0IHNjcmlwdHMgPSBsb2FkU2NyaXB0cygpO1xuICAgIGxvZy5pbmZvKGBbKGRlcHJlY2F0ZWQpU2NyaXB0XSDliqDovb3lhajlsYDohJrmnKw6ICR7SlNPTi5zdHJpbmdpZnkoc2NyaXB0cy5tYXAoc2NyaXB0ID0+IHNjcmlwdC5uYW1lKSl9YCk7XG5cbiAgICBjb25zdCBsb2FkX3Byb21pc2VzOiBQcm9taXNlPHZvaWQ+W10gPSBbXTtcblxuICAgIHNjcmlwdHMuZm9yRWFjaChzY3JpcHQgPT4ge1xuICAgICAgY29uc3QgeyBpZnJhbWUsIGxvYWRfcHJvbWlzZSB9ID0gbWFrZVNjcmlwdElmcmFtZShzY3JpcHQpO1xuICAgICAgc2NyaXB0X21hcC5zZXQoc2NyaXB0Lm5hbWUsIGlmcmFtZSk7XG4gICAgICBsb2FkX3Byb21pc2VzLnB1c2gobG9hZF9wcm9taXNlKTtcbiAgICB9KTtcblxuICAgIGF3YWl0IFByb21pc2UuYWxsU2V0dGxlZChsb2FkX3Byb21pc2VzKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBsb2cuZXJyb3IoJ1soZGVwcmVjYXRlZClTY3JpcHRdIOWFqOWxgOiEmuacrOWKoOi9veWksei0pTonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxuY29uc3QgbG9hZF9ldmVudHMgPSBbZXZlbnRfdHlwZXMuQ0hBVF9DSEFOR0VEXSBhcyBjb25zdDtcblxuZXhwb3J0IGZ1bmN0aW9uIGluaXRpYWxpemVDaGFyYWN0ZXJMZXZlbE9uRXh0ZW5zaW9uKCkge1xuICBpbml0aWFsaXplKCk7XG4gIGxvYWRfZXZlbnRzLmZvckVhY2goZXZlbnRUeXBlID0+IHtcbiAgICBldmVudFNvdXJjZS5tYWtlRmlyc3QoZXZlbnRUeXBlLCBpbml0aWFsaXplKTtcbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZXN0cm95Q2hhcmFjdGVyTGV2ZWxPbkV4dGVuc2lvbigpIHtcbiAgbG9hZF9ldmVudHMuZm9yRWFjaChldmVudFR5cGUgPT4ge1xuICAgIGV2ZW50U291cmNlLnJlbW92ZUxpc3RlbmVyKGV2ZW50VHlwZSwgaW5pdGlhbGl6ZSk7XG4gIH0pO1xuICBkZXN0cm95KCk7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/component/script_iframe.ts\n")},"./src/component/script_repository/button.ts":
/*!***************************************************!*\
  !*** ./src/component/script_repository/button.ts ***!
  \***************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Button: () => (/* binding */ Button),\n/* harmony export */   ButtonFactory: () => (/* binding */ ButtonFactory),\n/* harmony export */   ButtonManager: () => (/* binding */ ButtonManager),\n/* harmony export */   ScriptButton: () => (/* binding */ ScriptButton),\n/* harmony export */   bindQrEnabledChangeListener: () => (/* binding */ bindQrEnabledChangeListener),\n/* harmony export */   checkQrEnabledStatusAndAddButton: () => (/* binding */ checkQrEnabledStatusAndAddButton),\n/* harmony export */   initScriptButton: () => (/* binding */ initScriptButton),\n/* harmony export */   unbindQrEnabledChangeListener: () => (/* binding */ unbindQrEnabledChangeListener)\n/* harmony export */ });\n/* harmony import */ var _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/script_repository/script_controller */ \"./src/component/script_repository/script_controller.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\nlet isQrEnabled = false;\nlet isCombined = false;\nclass Button {\n    id;\n    name;\n    visible;\n    scriptId;\n    constructor(name, scriptId, visible = true) {\n        this.id = `${scriptId}_${name}`;\n        this.name = name;\n        this.scriptId = scriptId;\n        this.visible = visible;\n    }\n    remove() {\n        $(`#${this.id}`).remove();\n    }\n}\nclass ScriptButton extends Button {\n    constructor(name, scriptId, visible = true) {\n        super(name, scriptId, visible);\n    }\n    render() {\n        return `<div class=\"qr--button menu_button interactable\" id=\"${this.id}\">${this.name}</div>`;\n    }\n    bindEvents() {\n        $(`#${this.id}`).on('click', () => {\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.eventSource.emit(this.id);\n            loglevel__WEBPACK_IMPORTED_MODULE_2___default().info(`[ScriptManager] 点击按钮：${this.id}`);\n        });\n    }\n}\nclass ButtonFactory {\n    static createButton(type, name, scriptId, visible = true) {\n        switch (type) {\n            case 'script':\n            default:\n                return new ScriptButton(name, scriptId, visible);\n        }\n    }\n}\nclass ButtonManager {\n    buttons = [];\n    /**\n     * 将按钮从旧容器迁移到新容器\n     * @param oldContainerId 旧容器ID\n     * @param newContainerId 新容器ID\n     */\n    migrateButtonsToNewContainer(oldContainerId, newContainerId) {\n        const $oldButtons = $(`#${oldContainerId} .qr--button`);\n        const $newContainer = $(`#${newContainerId}`);\n        if ($oldButtons.length && $newContainer.length) {\n            $oldButtons.detach().appendTo($newContainer);\n            this.buttons.forEach(button => {\n                button.bindEvents();\n            });\n        }\n    }\n    /**\n     * 获取脚本容器ID\n     * @param scriptId 脚本ID\n     * @returns 脚本容器ID\n     */\n    getScriptContainerId(scriptId) {\n        return `script_container_${scriptId}`;\n    }\n    /**\n     * 从脚本数据创建按钮\n     * @param globalScripts 全局脚本\n     * @param characterScripts 角色脚本\n     * @param isGlobalEnabled 全局脚本是否启用\n     * @param isCharacterEnabled 角色脚本是否启用\n     */\n    createButtonsFromScripts(globalScripts, characterScripts, isGlobalEnabled, isCharacterEnabled) {\n        this.clearButtons();\n        const hasGlobalVisibleButtons = isGlobalEnabled &&\n            globalScripts.some(script => script.enabled &&\n                script.buttons &&\n                script.buttons.length > 0 &&\n                script.buttons.some(button => button.visible));\n        const hasCharacterVisibleButtons = isCharacterEnabled &&\n            characterScripts.some(script => script.enabled &&\n                script.buttons &&\n                script.buttons.length > 0 &&\n                script.buttons.some(button => button.visible));\n        if (!hasGlobalVisibleButtons && !hasCharacterVisibleButtons) {\n            return;\n        }\n        if (isGlobalEnabled && hasGlobalVisibleButtons) {\n            this.addScriptButtons(globalScripts);\n        }\n        if (isCharacterEnabled && hasCharacterVisibleButtons) {\n            this.addScriptButtons(characterScripts);\n        }\n    }\n    /**\n     * 添加脚本按钮\n     * @param scripts 脚本列表\n     */\n    addScriptButtons(scripts) {\n        scripts.forEach(script => {\n            if (script.enabled && script.buttons && script.buttons.length > 0) {\n                const visibleButtons = script.buttons\n                    .filter(buttonData => buttonData.visible)\n                    .map(buttonData => ButtonFactory.createButton('script', buttonData.name, script.id, buttonData.visible));\n                if (visibleButtons.length > 0) {\n                    this.addButtonsGroup(visibleButtons, script.id);\n                }\n            }\n        });\n    }\n    /**\n     * 添加按钮组\n     * @param buttons 按钮列表\n     * @param scriptId 脚本ID\n     */\n    addButtonsGroup(buttons, scriptId) {\n        if (buttons.length === 0)\n            return;\n        const containerId = this.getScriptContainerId(scriptId);\n        $(`#${containerId}`).remove();\n        let containerHtml = `<div id=\"${containerId}\" class=\"qr--buttons th--button\">`;\n        buttons.forEach(button => {\n            this.buttons = this.buttons.filter(btn => btn.id !== button.id);\n            this.buttons.push(button);\n            containerHtml += button.render();\n        });\n        containerHtml += '</div>';\n        if (isCombined) {\n            $('#send_form #qr--bar .qr--buttons').first().append(containerHtml);\n        }\n        else {\n            $('#send_form #qr--bar').first().append(containerHtml);\n        }\n        buttons.forEach(button => button.bindEvents());\n    }\n    /**\n     * 为指定脚本添加所有按钮\n     * @param script 脚本\n     */\n    addButtonsForScript(script) {\n        if (!script.buttons || script.buttons.length === 0)\n            return;\n        const visibleButtons = script.buttons\n            .filter(buttonData => buttonData.visible)\n            .map(buttonData => ButtonFactory.createButton('script', buttonData.name, script.id, buttonData.visible));\n        if (visibleButtons.length > 0) {\n            this.addButtonsGroup(visibleButtons, script.id);\n        }\n    }\n    /**\n     * 移除指定脚本的按钮\n     * @param scriptId 脚本ID\n     */\n    removeButtonsByScriptId(scriptId) {\n        const containerId = this.getScriptContainerId(scriptId);\n        $(`#${containerId}`).remove();\n    }\n    /**\n     * 清除所有按钮\n     */\n    clearButtons() {\n        this.buttons.forEach(btn => btn.remove());\n        this.buttons = [];\n        $('.th-button').remove();\n    }\n}\nconst buttonManager = new ButtonManager();\n/**\n * 设置按钮时需要执行的行为\n */\nfunction _setButtonLogic() {\n    const scriptManager = _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_0__.ScriptManager.getInstance();\n    const globalScripts = scriptManager.getGlobalScripts();\n    const characterScripts = scriptManager.getCharacterScripts();\n    const isGlobalEnabled = scriptManager.isGlobalScriptEnabled;\n    const isCharacterEnabled = scriptManager.isCharacterScriptEnabled;\n    buttonManager.createButtonsFromScripts(globalScripts, characterScripts, isGlobalEnabled, isCharacterEnabled);\n}\n/**\n * qr启用或者禁用时重新添加按钮\n */\nfunction bindQrEnabledChangeListener() {\n    $(`#qr--isEnabled`).on('change', () => {\n        isQrEnabled = $('#qr--isEnabled').prop('checked');\n        checkQrEnabledStatusAndAddButton();\n        loglevel__WEBPACK_IMPORTED_MODULE_2___default().info('[script_manager] 创建按钮');\n    });\n    $('#qr--isCombined').on('change', () => {\n        isCombined = $('#qr--isCombined').prop('checked');\n        checkQrEnabledStatusAndAddButton();\n        loglevel__WEBPACK_IMPORTED_MODULE_2___default().info('[script_manager] 创建按钮');\n    });\n    $('#qr--global-setListAdd, #qr--chat-setListAdd, .qr--del').on('click', () => {\n        checkQrEnabledStatusAndAddButton();\n        loglevel__WEBPACK_IMPORTED_MODULE_2___default().info('[script_manager] 创建按钮');\n    });\n}\n/**\n * 解绑 qr--isEnabled 元素的 change 事件监听器\n */\nfunction unbindQrEnabledChangeListener() {\n    $(`#qr--isEnabled, #qr--isCombined`).off('change');\n    $(`#qr--global-setListAdd, #qr--chat-setListAdd, .qr--del`).off('click');\n}\n/**\n * 根据qr--isEnabled状态处理容器\n */\nfunction checkQrEnabledStatus() {\n    isQrEnabled = $('#qr--isEnabled').prop('checked');\n    const qrBarLength = $('#send_form #qr--bar').length;\n    if (!isQrEnabled) {\n        if (qrBarLength === 0) {\n            $('#send_form').append('<div class=\"flex-container flexGap5\" id=\"qr--bar\"></div>');\n        }\n        else {\n            $('#send_form #qr--bar').not(':first').remove();\n        }\n    }\n}\n/**\n * 检查qr--isCombined状态\n */\nfunction checkQrCombinedStatus() {\n    isCombined = $('#qr--isCombined').prop('checked');\n    if (!isQrEnabled) {\n        if (isCombined) {\n            const $qrBar = $('#send_form #qr--bar');\n            const isThButtonExist = $qrBar.find('.th--buttons').length > 0;\n            if (!isThButtonExist) {\n                $qrBar.append('<div class=\"qr--buttons th--buttons\"></div>');\n            }\n        }\n    }\n}\n/**\n * 检查qr--isEnabled和qr--isCombined状态并添加按钮\n */\nfunction checkQrEnabledStatusAndAddButton() {\n    checkQrEnabledStatus();\n    checkQrCombinedStatus();\n    _setButtonLogic();\n}\n/**\n * 初始化脚本按钮，包括确认qr容器和绑定change事件\n */\nfunction initScriptButton() {\n    checkQrEnabledStatus();\n    checkQrCombinedStatus();\n    bindQrEnabledChangeListener();\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L2J1dHRvbi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBZ0Y7QUFFOUI7QUFFdkI7QUFFM0IsSUFBSSxXQUFXLEdBQUcsS0FBSyxDQUFDO0FBQ3hCLElBQUksVUFBVSxHQUFHLEtBQUssQ0FBQztBQUNoQixNQUFlLE1BQU07SUFDMUIsRUFBRSxDQUFTO0lBQ1gsSUFBSSxDQUFTO0lBQ2IsT0FBTyxDQUFVO0lBQ2pCLFFBQVEsQ0FBUztJQUVqQixZQUFZLElBQVksRUFBRSxRQUFnQixFQUFFLFVBQW1CLElBQUk7UUFDakUsSUFBSSxDQUFDLEVBQUUsR0FBRyxHQUFHLFFBQVEsSUFBSSxJQUFJLEVBQUUsQ0FBQztRQUNoQyxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztRQUNqQixJQUFJLENBQUMsUUFBUSxHQUFHLFFBQVEsQ0FBQztRQUN6QixJQUFJLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQztJQUN6QixDQUFDO0lBTUQsTUFBTTtRQUNKLENBQUMsQ0FBQyxJQUFJLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDO0lBQzVCLENBQUM7Q0FDRjtBQUVNLE1BQU0sWUFBYSxTQUFRLE1BQU07SUFDdEMsWUFBWSxJQUFZLEVBQUUsUUFBZ0IsRUFBRSxVQUFtQixJQUFJO1FBQ2pFLEtBQUssQ0FBQyxJQUFJLEVBQUUsUUFBUSxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQ2pDLENBQUM7SUFFRCxNQUFNO1FBQ0osT0FBTyx3REFBd0QsSUFBSSxDQUFDLEVBQUUsS0FBSyxJQUFJLENBQUMsSUFBSSxRQUFRLENBQUM7SUFDL0YsQ0FBQztJQUVELFVBQVU7UUFDUixDQUFDLENBQUMsSUFBSSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsT0FBTyxFQUFFLEdBQUcsRUFBRTtZQUNoQyw0REFBVyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMs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LENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDO1FBQ2xELENBQUM7SUFDSCxDQUFDO0FBQ0gsQ0FBQztBQUVEOztHQUVHO0FBQ0gsU0FBUyxxQkFBcUI7SUFDNUIsVUFBVSxHQUFHLENBQUMsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztJQUNsRCxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDakIsSUFBSSxVQUFVLEVBQUUsQ0FBQztZQUNmLE1BQU0sTUFBTSxHQUFHLENBQUMsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO1lBQ3hDLE1BQU0sZUFBZSxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQztZQUMvRCxJQUFJLENBQUMsZUFBZSxFQUFFLENBQUM7Z0JBQ3JCLE1BQU0sQ0FBQyxNQUFNLENBQUMsNkNBQTZDLENBQUMsQ0FBQztZQUMvRCxDQUFDO1FBQ0gsQ0FBQztJQUNILENBQUM7QUFDSCxDQUFDO0FBRUQ7O0dBRUc7QUFDSSxTQUFTLGdDQUFnQztJQUM5QyxvQkFBb0IsRUFBRSxDQUFDO0lBQ3ZCLHFCQUFxQixFQUFFLENBQUM7SUFDeEIsZUFBZSxFQUFFLENBQUM7QUFDcEIsQ0FBQztBQUVEOztHQUVHO0FBQ0ksU0FBUyxnQkFBZ0I7SUFDOUIsb0JBQW9CLEVBQUUsQ0FBQztJQUN2QixxQkFBcUIsRUFBRSxDQUFDO0lBQ3hCLDJCQUEyQixFQUFFLENBQUM7QUFDaEMsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvYnV0dG9uLnRzP2UyMmIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgU2NyaXB0TWFuYWdlciB9IGZyb20gJ0AvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3NjcmlwdF9jb250cm9sbGVyJztcbmltcG9ydCB7IFNjcmlwdCB9IGZyb20gJ0AvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3R5cGVzJztcbmltcG9ydCB7IGV2ZW50U291cmNlIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5cbmltcG9ydCBsb2cgZnJvbSAnbG9nbGV2ZWwnO1xuXG5sZXQgaXNRckVuYWJsZWQgPSBmYWxzZTtcbmxldCBpc0NvbWJpbmVkID0gZmFsc2U7XG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQnV0dG9uIHtcbiAgaWQ6IHN0cmluZztcbiAgbmFtZTogc3RyaW5nO1xuICB2aXNpYmxlOiBib29sZWFuO1xuICBzY3JpcHRJZDogc3RyaW5nO1xuXG4gIGNvbnN0cnVjdG9yKG5hbWU6IHN0cmluZywgc2NyaXB0SWQ6IHN0cmluZywgdmlzaWJsZTogYm9vbGVhbiA9IHRydWUpIHtcbiAgICB0aGlzLmlkID0gYCR7c2NyaXB0SWR9XyR7bmFtZX1gO1xuICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgdGhpcy5zY3JpcHRJZCA9IHNjcmlwdElkO1xuICAgIHRoaXMudmlzaWJsZSA9IHZpc2libGU7XG4gIH1cblxuICBhYnN0cmFjdCByZW5kZXIoKTogc3RyaW5nO1xuXG4gIGFic3RyYWN0IGJpbmRFdmVudHMoKTogdm9pZDtcblxuICByZW1vdmUoKTogdm9pZCB7XG4gICAgJChgIyR7dGhpcy5pZH1gKS5yZW1vdmUoKTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgU2NyaXB0QnV0dG9uIGV4dGVuZHMgQnV0dG9uIHtcbiAgY29uc3RydWN0b3IobmFtZTogc3RyaW5nLCBzY3JpcHRJZDogc3RyaW5nLCB2aXNpYmxlOiBib29sZWFuID0gdHJ1ZSkge1xuICAgIHN1cGVyKG5hbWUsIHNjcmlwdElkLCB2aXNpYmxlKTtcbiAgfVxuXG4gIHJlbmRlcigpOiBzdHJpbmcge1xuICAgIHJldHVybiBgPGRpdiBjbGFzcz1cInFyLS1idXR0b24gbWVudV9idXR0b24gaW50ZXJhY3RhYmxlXCIgaWQ9XCIke3RoaXMuaWR9XCI+JHt0aGlzLm5hbWV9PC9kaXY+YDtcbiAgfVxuXG4gIGJpbmRFdmVudHMoKTogdm9pZCB7XG4gICAgJChgIyR7dGhpcy5pZH1gKS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICBldmVudFNvdXJjZS5lbWl0KHRoaXMuaWQpO1xuICAgICAgbG9nLmluZm8oYFtTY3JpcHRNYW5hZ2VyXSDngrnlh7vmjInpkq7vvJoke3RoaXMuaWR9YCk7XG4gICAgfSk7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIEJ1dHRvbkZhY3Rvcnkge1xuICBzdGF0aWMgY3JlYXRlQnV0dG9uKHR5cGU6IHN0cmluZywgbmFtZTogc3RyaW5nLCBzY3JpcHRJZDogc3RyaW5nLCB2aXNpYmxlOiBib29sZWFuID0gdHJ1ZSk6IEJ1dHRvbiB7XG4gICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICBjYXNlICdzY3JpcHQnOlxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIG5ldyBTY3JpcHRCdXR0b24obmFtZSwgc2NyaXB0SWQsIHZpc2libGUpO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgQnV0dG9uTWFuYWdlciB7XG4gIHByaXZhdGUgYnV0dG9uczogQnV0dG9uW10gPSBbXTtcblxuICAvKipcbiAgICog5bCG5oyJ6ZKu5LuO5pen5a655Zmo6L+B56e75Yiw5paw5a655ZmoXG4gICAqIEBwYXJhbSBvbGRDb250YWluZXJJZCDml6flrrnlmahJRFxuICAgKiBAcGFyYW0gbmV3Q29udGFpbmVySWQg5paw5a655ZmoSURcbiAgICovXG4gIG1pZ3JhdGVCdXR0b25zVG9OZXdDb250YWluZXIob2xkQ29udGFpbmVySWQ6IHN0cmluZywgbmV3Q29udGFpbmVySWQ6IHN0cmluZyk6IHZvaWQge1xuICAgIGNvbnN0ICRvbGRCdXR0b25zID0gJChgIyR7b2xkQ29udGFpbmVySWR9IC5xci0tYnV0dG9uYCk7XG4gICAgY29uc3QgJG5ld0NvbnRhaW5lciA9ICQoYCMke25ld0NvbnRhaW5lcklkfWApO1xuXG4gICAgaWYgKCRvbGRCdXR0b25zLmxlbmd0aCAmJiAkbmV3Q29udGFpbmVyLmxlbmd0aCkge1xuICAgICAgJG9sZEJ1dHRvbnMuZGV0YWNoKCkuYXBwZW5kVG8oJG5ld0NvbnRhaW5lcik7XG5cbiAgICAgIHRoaXMuYnV0dG9ucy5mb3JFYWNoKGJ1dHRvbiA9PiB7XG4gICAgICAgIGJ1dHRvbi5iaW5kRXZlbnRzKCk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W6ISa5pys5a655ZmoSURcbiAgICogQHBhcmFtIHNjcmlwdElkIOiEmuacrElEXG4gICAqIEByZXR1cm5zIOiEmuacrOWuueWZqElEXG4gICAqL1xuICBwcml2YXRlIGdldFNjcmlwdENvbnRhaW5lcklkKHNjcmlwdElkOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIHJldHVybiBgc2NyaXB0X2NvbnRhaW5lcl8ke3NjcmlwdElkfWA7XG4gIH1cblxuICAvKipcbiAgICog5LuO6ISa5pys5pWw5o2u5Yib5bu65oyJ6ZKuXG4gICAqIEBwYXJhbSBnbG9iYWxTY3JpcHRzIOWFqOWxgOiEmuacrFxuICAgKiBAcGFyYW0gY2hhcmFjdGVyU2NyaXB0cyDop5LoibLohJrmnKxcbiAgICogQHBhcmFtIGlzR2xvYmFsRW5hYmxlZCDlhajlsYDohJrmnKzmmK/lkKblkK/nlKhcbiAgICogQHBhcmFtIGlzQ2hhcmFjdGVyRW5hYmxlZCDop5LoibLohJrmnKzmmK/lkKblkK/nlKhcbiAgICovXG4gIGNyZWF0ZUJ1dHRvbnNGcm9tU2NyaXB0cyhcbiAgICBnbG9iYWxTY3JpcHRzOiBTY3JpcHRbXSxcbiAgICBjaGFyYWN0ZXJTY3JpcHRzOiBTY3JpcHRbXSxcbiAgICBpc0dsb2JhbEVuYWJsZWQ6IGJvb2xlYW4sXG4gICAgaXNDaGFyYWN0ZXJFbmFibGVkOiBib29sZWFuLFxuICApOiB2b2lkIHtcbiAgICB0aGlzLmNsZWFyQnV0dG9ucygpO1xuXG4gICAgY29uc3QgaGFzR2xvYmFsVmlzaWJsZUJ1dHRvbnMgPVxuICAgICAgaXNHbG9iYWxFbmFibGVkICYmXG4gICAgICBnbG9iYWxTY3JpcHRzLnNvbWUoXG4gICAgICAgIHNjcmlwdCA9PlxuICAgICAgICAgIHNjcmlwdC5lbmFibGVkICYmXG4gICAgICAgICAgc2NyaXB0LmJ1dHRvbnMgJiZcbiAgICAgICAgICBzY3JpcHQuYnV0dG9ucy5sZW5ndGggPiAwICYmXG4gICAgICAgICAgc2NyaXB0LmJ1dHRvbnMuc29tZShidXR0b24gPT4gYnV0dG9uLnZpc2libGUpLFxuICAgICAgKTtcblxuICAgIGNvbnN0IGhhc0NoYXJhY3RlclZpc2libGVCdXR0b25zID1cbiAgICAgIGlzQ2hhcmFjdGVyRW5hYmxlZCAmJlxuICAgICAgY2hhcmFjdGVyU2NyaXB0cy5zb21lKFxuICAgICAgICBzY3JpcHQgPT5cbiAgICAgICAgICBzY3JpcHQuZW5hYmxlZCAmJlxuICAgICAgICAgIHNjcmlwdC5idXR0b25zICYmXG4gICAgICAgICAgc2NyaXB0LmJ1dHRvbnMubGVuZ3RoID4gMCAmJlxuICAgICAgICAgIHNjcmlwdC5idXR0b25zLnNvbWUoYnV0dG9uID0+IGJ1dHRvbi52aXNpYmxlKSxcbiAgICAgICk7XG5cbiAgICBpZiAoIWhhc0dsb2JhbFZpc2libGVCdXR0b25zICYmICFoYXNDaGFyYWN0ZXJWaXNpYmxlQnV0dG9ucykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChpc0dsb2JhbEVuYWJsZWQgJiYgaGFzR2xvYmFsVmlzaWJsZUJ1dHRvbnMpIHtcbiAgICAgIHRoaXMuYWRkU2NyaXB0QnV0dG9ucyhnbG9iYWxTY3JpcHRzKTtcbiAgICB9XG5cbiAgICBpZiAoaXNDaGFyYWN0ZXJFbmFibGVkICYmIGhhc0NoYXJhY3RlclZpc2libGVCdXR0b25zKSB7XG4gICAgICB0aGlzLmFkZFNjcmlwdEJ1dHRvbnMoY2hhcmFjdGVyU2NyaXB0cyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOa3u+WKoOiEmuacrOaMiemSrlxuICAgKiBAcGFyYW0gc2NyaXB0cyDohJrmnKzliJfooahcbiAgICovXG4gIHByaXZhdGUgYWRkU2NyaXB0QnV0dG9ucyhzY3JpcHRzOiBTY3JpcHRbXSk6IHZvaWQge1xuICAgIHNjcmlwdHMuZm9yRWFjaChzY3JpcHQgPT4ge1xuICAgICAgaWYgKHNjcmlwdC5lbmFibGVkICYmIHNjcmlwdC5idXR0b25zICYmIHNjcmlwdC5idXR0b25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc3QgdmlzaWJsZUJ1dHRvbnMgPSBzY3JpcHQuYnV0dG9uc1xuICAgICAgICAgIC5maWx0ZXIoYnV0dG9uRGF0YSA9PiBidXR0b25EYXRhLnZpc2libGUpXG4gICAgICAgICAgLm1hcChidXR0b25EYXRhID0+IEJ1dHRvbkZhY3RvcnkuY3JlYXRlQnV0dG9uKCdzY3JpcHQnLCBidXR0b25EYXRhLm5hbWUsIHNjcmlwdC5pZCwgYnV0dG9uRGF0YS52aXNpYmxlKSk7XG5cbiAgICAgICAgaWYgKHZpc2libGVCdXR0b25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICB0aGlzLmFkZEJ1dHRvbnNHcm91cCh2aXNpYmxlQnV0dG9ucywgc2NyaXB0LmlkKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOa3u+WKoOaMiemSrue7hFxuICAgKiBAcGFyYW0gYnV0dG9ucyDmjInpkq7liJfooahcbiAgICogQHBhcmFtIHNjcmlwdElkIOiEmuacrElEXG4gICAqL1xuICBwcml2YXRlIGFkZEJ1dHRvbnNHcm91cChidXR0b25zOiBCdXR0b25bXSwgc2NyaXB0SWQ6IHN0cmluZyk6IHZvaWQge1xuICAgIGlmIChidXR0b25zLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuXG4gICAgY29uc3QgY29udGFpbmVySWQgPSB0aGlzLmdldFNjcmlwdENvbnRhaW5lcklkKHNjcmlwdElkKTtcblxuICAgICQoYCMke2NvbnRhaW5lcklkfWApLnJlbW92ZSgpO1xuXG4gICAgbGV0IGNvbnRhaW5lckh0bWwgPSBgPGRpdiBpZD1cIiR7Y29udGFpbmVySWR9XCIgY2xhc3M9XCJxci0tYnV0dG9ucyB0aC0tYnV0dG9uXCI+YDtcblxuICAgIGJ1dHRvbnMuZm9yRWFjaChidXR0b24gPT4ge1xuICAgICAgdGhpcy5idXR0b25zID0gdGhpcy5idXR0b25zLmZpbHRlcihidG4gPT4gYnRuLmlkICE9PSBidXR0b24uaWQpO1xuICAgICAgdGhpcy5idXR0b25zLnB1c2goYnV0dG9uKTtcbiAgICAgIGNvbnRhaW5lckh0bWwgKz0gYnV0dG9uLnJlbmRlcigpO1xuICAgIH0pO1xuXG4gICAgY29udGFpbmVySHRtbCArPSAnPC9kaXY+JztcblxuICAgIGlmIChpc0NvbWJpbmVkKSB7XG4gICAgICAkKCcjc2VuZF9mb3JtICNxci0tYmFyIC5xci0tYnV0dG9ucycpLmZpcnN0KCkuYXBwZW5kKGNvbnRhaW5lckh0bWwpO1xuICAgIH0gZWxzZSB7XG4gICAgICAkKCcjc2VuZF9mb3JtICNxci0tYmFyJykuZmlyc3QoKS5hcHBlbmQoY29udGFpbmVySHRtbCk7XG4gICAgfVxuXG4gICAgYnV0dG9ucy5mb3JFYWNoKGJ1dHRvbiA9PiBidXR0b24uYmluZEV2ZW50cygpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDkuLrmjIflrprohJrmnKzmt7vliqDmiYDmnInmjInpkq5cbiAgICogQHBhcmFtIHNjcmlwdCDohJrmnKxcbiAgICovXG4gIGFkZEJ1dHRvbnNGb3JTY3JpcHQoc2NyaXB0OiBTY3JpcHQpOiB2b2lkIHtcbiAgICBpZiAoIXNjcmlwdC5idXR0b25zIHx8IHNjcmlwdC5idXR0b25zLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuXG4gICAgY29uc3QgdmlzaWJsZUJ1dHRvbnMgPSBzY3JpcHQuYnV0dG9uc1xuICAgICAgLmZpbHRlcihidXR0b25EYXRhID0+IGJ1dHRvbkRhdGEudmlzaWJsZSlcbiAgICAgIC5tYXAoYnV0dG9uRGF0YSA9PiBCdXR0b25GYWN0b3J5LmNyZWF0ZUJ1dHRvbignc2NyaXB0JywgYnV0dG9uRGF0YS5uYW1lLCBzY3JpcHQuaWQsIGJ1dHRvbkRhdGEudmlzaWJsZSkpO1xuXG4gICAgaWYgKHZpc2libGVCdXR0b25zLmxlbmd0aCA+IDApIHtcbiAgICAgIHRoaXMuYWRkQnV0dG9uc0dyb3VwKHZpc2libGVCdXR0b25zLCBzY3JpcHQuaWQpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDnp7vpmaTmjIflrprohJrmnKznmoTmjInpkq5cbiAgICogQHBhcmFtIHNjcmlwdElkIOiEmuacrElEXG4gICAqL1xuICByZW1vdmVCdXR0b25zQnlTY3JpcHRJZChzY3JpcHRJZDogc3RyaW5nKTogdm9pZCB7XG4gICAgY29uc3QgY29udGFpbmVySWQgPSB0aGlzLmdldFNjcmlwdENvbnRhaW5lcklkKHNjcmlwdElkKTtcbiAgICAkKGAjJHtjb250YWluZXJJZH1gKS5yZW1vdmUoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmuIXpmaTmiYDmnInmjInpkq5cbiAgICovXG4gIGNsZWFyQnV0dG9ucygpOiB2b2lkIHtcbiAgICB0aGlzLmJ1dHRvbnMuZm9yRWFjaChidG4gPT4gYnRuLnJlbW92ZSgpKTtcbiAgICB0aGlzLmJ1dHRvbnMgPSBbXTtcblxuICAgICQoJy50aC1idXR0b24nKS5yZW1vdmUoKTtcbiAgfVxufVxuXG5jb25zdCBidXR0b25NYW5hZ2VyID0gbmV3IEJ1dHRvbk1hbmFnZXIoKTtcblxuLyoqXG4gKiDorr7nva7mjInpkq7ml7bpnIDopoHmiafooYznmoTooYzkuLpcbiAqL1xuZnVuY3Rpb24gX3NldEJ1dHRvbkxvZ2ljKCkge1xuICBjb25zdCBzY3JpcHRNYW5hZ2VyID0gU2NyaXB0TWFuYWdlci5nZXRJbnN0YW5jZSgpO1xuXG4gIGNvbnN0IGdsb2JhbFNjcmlwdHMgPSBzY3JpcHRNYW5hZ2VyLmdldEdsb2JhbFNjcmlwdHMoKTtcbiAgY29uc3QgY2hhcmFjdGVyU2NyaXB0cyA9IHNjcmlwdE1hbmFnZXIuZ2V0Q2hhcmFjdGVyU2NyaXB0cygpO1xuICBjb25zdCBpc0dsb2JhbEVuYWJsZWQgPSBzY3JpcHRNYW5hZ2VyLmlzR2xvYmFsU2NyaXB0RW5hYmxlZDtcbiAgY29uc3QgaXNDaGFyYWN0ZXJFbmFibGVkID0gc2NyaXB0TWFuYWdlci5pc0NoYXJhY3RlclNjcmlwdEVuYWJsZWQ7XG5cbiAgYnV0dG9uTWFuYWdlci5jcmVhdGVCdXR0b25zRnJvbVNjcmlwdHMoZ2xvYmFsU2NyaXB0cywgY2hhcmFjdGVyU2NyaXB0cywgaXNHbG9iYWxFbmFibGVkLCBpc0NoYXJhY3RlckVuYWJsZWQpO1xufVxuXG4vKipcbiAqIHFy5ZCv55So5oiW6ICF56aB55So5pe26YeN5paw5re75Yqg5oyJ6ZKuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBiaW5kUXJFbmFibGVkQ2hhbmdlTGlzdGVuZXIoKSB7XG4gICQoYCNxci0taXNFbmFibGVkYCkub24oJ2NoYW5nZScsICgpID0+IHtcbiAgICBpc1FyRW5hYmxlZCA9ICQoJyNxci0taXNFbmFibGVkJykucHJvcCgnY2hlY2tlZCcpO1xuICAgIGNoZWNrUXJFbmFibGVkU3RhdHVzQW5kQWRkQnV0dG9uKCk7XG4gICAgbG9nLmluZm8oJ1tzY3JpcHRfbWFuYWdlcl0g5Yib5bu65oyJ6ZKuJyk7XG4gIH0pO1xuXG4gICQoJyNxci0taXNDb21iaW5lZCcpLm9uKCdjaGFuZ2UnLCAoKSA9PiB7XG4gICAgaXNDb21iaW5lZCA9ICQoJyNxci0taXNDb21iaW5lZCcpLnByb3AoJ2NoZWNrZWQnKTtcbiAgICBjaGVja1FyRW5hYmxlZFN0YXR1c0FuZEFkZEJ1dHRvbigpO1xuICAgIGxvZy5pbmZvKCdbc2NyaXB0X21hbmFnZXJdIOWIm+W7uuaMiemSricpO1xuICB9KTtcblxuICAkKCcjcXItLWdsb2JhbC1zZXRMaXN0QWRkLCAjcXItLWNoYXQtc2V0TGlzdEFkZCwgLnFyLS1kZWwnKS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgY2hlY2tRckVuYWJsZWRTdGF0dXNBbmRBZGRCdXR0b24oKTtcbiAgICBsb2cuaW5mbygnW3NjcmlwdF9tYW5hZ2VyXSDliJvlu7rmjInpkq4nKTtcbiAgfSk7XG59XG5cbi8qKlxuICog6Kej57uRIHFyLS1pc0VuYWJsZWQg5YWD57Sg55qEIGNoYW5nZSDkuovku7bnm5HlkKzlmahcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVuYmluZFFyRW5hYmxlZENoYW5nZUxpc3RlbmVyKCkge1xuICAkKGAjcXItLWlzRW5hYmxlZCwgI3FyLS1pc0NvbWJpbmVkYCkub2ZmKCdjaGFuZ2UnKTtcbiAgJChgI3FyLS1nbG9iYWwtc2V0TGlzdEFkZCwgI3FyLS1jaGF0LXNldExpc3RBZGQsIC5xci0tZGVsYCkub2ZmKCdjbGljaycpO1xufVxuXG4vKipcbiAqIOagueaNrnFyLS1pc0VuYWJsZWTnirbmgIHlpITnkIblrrnlmahcbiAqL1xuZnVuY3Rpb24gY2hlY2tRckVuYWJsZWRTdGF0dXMoKSB7XG4gIGlzUXJFbmFibGVkID0gJCgnI3FyLS1pc0VuYWJsZWQnKS5wcm9wKCdjaGVja2VkJyk7XG4gIGNvbnN0IHFyQmFyTGVuZ3RoID0gJCgnI3NlbmRfZm9ybSAjcXItLWJhcicpLmxlbmd0aDtcbiAgaWYgKCFpc1FyRW5hYmxlZCkge1xuICAgIGlmIChxckJhckxlbmd0aCA9PT0gMCkge1xuICAgICAgJCgnI3NlbmRfZm9ybScpLmFwcGVuZCgnPGRpdiBjbGFzcz1cImZsZXgtY29udGFpbmVyIGZsZXhHYXA1XCIgaWQ9XCJxci0tYmFyXCI+PC9kaXY+Jyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICQoJyNzZW5kX2Zvcm0gI3FyLS1iYXInKS5ub3QoJzpmaXJzdCcpLnJlbW92ZSgpO1xuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIOajgOafpXFyLS1pc0NvbWJpbmVk54q25oCBXG4gKi9cbmZ1bmN0aW9uIGNoZWNrUXJDb21iaW5lZFN0YXR1cygpIHtcbiAgaXNDb21iaW5lZCA9ICQoJyNxci0taXNDb21iaW5lZCcpLnByb3AoJ2NoZWNrZWQnKTtcbiAgaWYgKCFpc1FyRW5hYmxlZCkge1xuICAgIGlmIChpc0NvbWJpbmVkKSB7XG4gICAgICBjb25zdCAkcXJCYXIgPSAkKCcjc2VuZF9mb3JtICNxci0tYmFyJyk7XG4gICAgICBjb25zdCBpc1RoQnV0dG9uRXhpc3QgPSAkcXJCYXIuZmluZCgnLnRoLS1idXR0b25zJykubGVuZ3RoID4gMDtcbiAgICAgIGlmICghaXNUaEJ1dHRvbkV4aXN0KSB7XG4gICAgICAgICRxckJhci5hcHBlbmQoJzxkaXYgY2xhc3M9XCJxci0tYnV0dG9ucyB0aC0tYnV0dG9uc1wiPjwvZGl2PicpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIOajgOafpXFyLS1pc0VuYWJsZWTlkoxxci0taXNDb21iaW5lZOeKtuaAgeW5tua3u+WKoOaMiemSrlxuICovXG5leHBvcnQgZnVuY3Rpb24gY2hlY2tRckVuYWJsZWRTdGF0dXNBbmRBZGRCdXR0b24oKSB7XG4gIGNoZWNrUXJFbmFibGVkU3RhdHVzKCk7XG4gIGNoZWNrUXJDb21iaW5lZFN0YXR1cygpO1xuICBfc2V0QnV0dG9uTG9naWMoKTtcbn1cblxuLyoqXG4gKiDliJ3lp4vljJbohJrmnKzmjInpkq7vvIzljIXmi6znoa7orqRxcuWuueWZqOWSjOe7keWummNoYW5nZeS6i+S7tlxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5pdFNjcmlwdEJ1dHRvbigpIHtcbiAgY2hlY2tRckVuYWJsZWRTdGF0dXMoKTtcbiAgY2hlY2tRckNvbWJpbmVkU3RhdHVzKCk7XG4gIGJpbmRRckVuYWJsZWRDaGFuZ2VMaXN0ZW5lcigpO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/component/script_repository/button.ts\n")},"./src/component/script_repository/data.ts":
/*!*************************************************!*\
  !*** ./src/component/script_repository/data.ts ***!
  \*************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ScriptData: () => (/* binding */ ScriptData),\n/* harmony export */   purgeEmbeddedScripts: () => (/* binding */ purgeEmbeddedScripts)\n/* harmony export */ });\n/* harmony import */ var _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/script_repository/types */ \"./src/component/script_repository/types.ts\");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_5__);\n\n\n\n\n\n\n/**\n * 脚本数据管理类\n */\nclass ScriptData {\n    static instance;\n    globalScripts = [];\n    characterScripts = [];\n    _isGlobalScriptEnabled = false;\n    _isCharacterScriptEnabled = false;\n    constructor() {\n        this.loadScripts();\n    }\n    get isGlobalScriptEnabled() {\n        return this._isGlobalScriptEnabled;\n    }\n    get isCharacterScriptEnabled() {\n        return this._isCharacterScriptEnabled;\n    }\n    static getInstance() {\n        if (!ScriptData.instance) {\n            ScriptData.instance = new ScriptData();\n        }\n        return ScriptData.instance;\n    }\n    static destroyInstance() {\n        if (ScriptData.instance) {\n            ScriptData.instance = undefined;\n        }\n    }\n    /**\n     * 检查当前角色是否启用了脚本库\n     * @returns 角色脚本库是否启用\n     */\n    checkCharacterScriptEnabled() {\n        const charactersWithScripts = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('script.characters_with_scripts') || [];\n        //@ts-ignore\n        const avatar = _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.characters?.[_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid]?.avatar;\n        return charactersWithScripts?.includes(avatar) || false;\n    }\n    /**\n     * 加载脚本库原始数据，支持新旧数据结构兼容\n     */\n    loadScripts() {\n        const rawGlobalRepository = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('script.scriptsRepository') || [];\n        this.globalScripts = this.migrateAndExtractScripts(rawGlobalRepository, _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL);\n        //@ts-ignore\n        const rawCharacterRepository = _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid]?.data?.extensions?.TavernHelper_scripts || [];\n        this.characterScripts = this.migrateAndExtractScripts(rawCharacterRepository, _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.CHARACTER);\n        this._isGlobalScriptEnabled = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('script.global_script_enabled') ?? false;\n        this._isCharacterScriptEnabled = this.checkCharacterScriptEnabled();\n    }\n    /**\n     * 检查并迁移数据结构，确保向后兼容\n     * @param repository 原始仓库数据\n     * @param type 脚本类型\n     * @returns 提取的脚本数组\n     */\n    migrateAndExtractScripts(repository, type) {\n        if (!Array.isArray(repository)) {\n            return [];\n        }\n        let needsMigration = false;\n        const migratedRepository = [];\n        for (const item of repository) {\n            if ((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.isScript)(item)) {\n                needsMigration = true;\n                migratedRepository.push({\n                    type: 'script',\n                    value: new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.Script(item),\n                });\n            }\n            else if ((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.isScriptRepositoryItem)(item)) {\n                if (item.type === 'script') {\n                    migratedRepository.push({\n                        type: 'script',\n                        value: new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.Script(item.value),\n                    });\n                }\n                else if (item.type === 'folder') {\n                    migratedRepository.push({\n                        type: 'folder',\n                        id: item.id,\n                        name: item.name,\n                        icon: item.icon || 'fa-folder',\n                        color: item.color || document.documentElement.style.getPropertyValue('--SmartThemeBodyColor'),\n                        value: Array.isArray(item.value) ? item.value.map((s) => new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.Script(s)) : [],\n                    });\n                }\n            }\n            else {\n                loglevel__WEBPACK_IMPORTED_MODULE_5___default().warn('[ScriptManager] 无法解析的脚本数据:', item);\n            }\n        }\n        if (needsMigration) {\n            this.saveMigratedRepository(migratedRepository, type);\n        }\n        return (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.extractScriptsFromRepository)(migratedRepository);\n    }\n    /**\n     * 保存迁移后的仓库数据\n     * @param repository 迁移后的仓库数据\n     * @param type 脚本类型\n     */\n    async saveMigratedRepository(repository, type) {\n        try {\n            if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL) {\n                (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('script.scriptsRepository', repository);\n            }\n            else {\n                if (!_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid) {\n                    loglevel__WEBPACK_IMPORTED_MODULE_5___default().warn('[ScriptManager] 无法保存角色脚本迁移数据：当前角色为空');\n                    return;\n                }\n                //@ts-ignore\n                await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__.writeExtensionField)(_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid, 'TavernHelper_scripts', repository);\n            }\n            loglevel__WEBPACK_IMPORTED_MODULE_5___default().info(`[ScriptManager] 成功迁移${type}脚本数据结构`);\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_5___default().error(`[ScriptManager] 迁移${type}脚本数据失败:`, error);\n        }\n    }\n    /**\n     * 获取全局脚本列表\n     */\n    getGlobalScripts() {\n        return this.globalScripts;\n    }\n    /**\n     * 获取角色脚本列表\n     */\n    getCharacterScripts() {\n        //@ts-ignore\n        const rawCharacterRepository = _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid]?.data?.extensions?.TavernHelper_scripts || [];\n        this.characterScripts = this.migrateAndExtractScripts(rawCharacterRepository, _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.CHARACTER);\n        return this.characterScripts;\n    }\n    /**\n     * 根据ID获取脚本\n     * @param id 脚本ID\n     * @returns 脚本对象，如果不存在则返回undefined\n     */\n    getScriptById(id) {\n        let script = this.globalScripts.find((s) => s.id === id);\n        if (script)\n            return script;\n        script = this.characterScripts.find((s) => s.id === id);\n        if (script)\n            return script;\n        return undefined;\n    }\n    /**\n     * 保存单个脚本到设置中，不存在则添加到末尾，存在则覆盖\n     * @param script 脚本\n     * @param type 脚本类型\n     */\n    async saveScript(script, type) {\n        if (!script.name || script.name.trim() === '') {\n            throw new Error('[ScriptManager] 保存失败，脚本名称为空');\n        }\n        const rawRepository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL\n            ? (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('script.scriptsRepository') || []\n            : //@ts-ignore\n                _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid]?.data?.extensions?.TavernHelper_scripts || [];\n        const repository = this.ensureRepositoryStructure(rawRepository);\n        let foundIndex = -1;\n        let foundInFolder = false;\n        let folderIndex = -1;\n        for (let i = 0; i < repository.length; i++) {\n            const item = repository[i];\n            if (item.type === 'script' && item.value.id === script.id) {\n                foundIndex = i;\n                break;\n            }\n            else if (item.type === 'folder') {\n                const scripts = item.value;\n                const scriptIndex = scripts.findIndex(s => s.id === script.id);\n                if (scriptIndex !== -1) {\n                    foundInFolder = true;\n                    folderIndex = i;\n                    foundIndex = scriptIndex;\n                    break;\n                }\n            }\n        }\n        if (foundInFolder && folderIndex >= 0) {\n            const folder = repository[folderIndex];\n            folder.value[foundIndex] = script;\n        }\n        else if (foundIndex >= 0) {\n            repository[foundIndex].value = script;\n        }\n        else {\n            repository.push({\n                type: 'script',\n                value: script,\n            });\n        }\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL) {\n            await this.saveGlobalRepositoryItems(repository);\n        }\n        else {\n            await this.saveCharacterRepositoryItems(repository);\n        }\n        this.loadScripts();\n    }\n    /**\n     * 确保仓库使用新的数据结构\n     * @param rawRepository 原始仓库数据\n     * @returns 规范化的仓库数据\n     */\n    ensureRepositoryStructure(rawRepository) {\n        const repository = [];\n        for (const item of rawRepository) {\n            if ((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.isScript)(item)) {\n                repository.push({\n                    type: 'script',\n                    value: new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.Script(item),\n                });\n            }\n            else if ((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.isScriptRepositoryItem)(item)) {\n                if (item.type === 'script') {\n                    repository.push({\n                        type: 'script',\n                        value: new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.Script(item.value),\n                    });\n                }\n                else if (item.type === 'folder') {\n                    if (!item.icon) {\n                        item.icon = 'fa-folder';\n                    }\n                    if (!item.color) {\n                        item.color = document.documentElement.style.getPropertyValue('--SmartThemeBodyColor');\n                    }\n                    repository.push({\n                        ...item,\n                        value: Array.isArray(item.value) ? item.value.map((s) => new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.Script(s)) : [],\n                    });\n                }\n            }\n            else {\n                try {\n                    repository.push({\n                        type: 'script',\n                        value: new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.Script(item),\n                    });\n                }\n                catch (error) {\n                    loglevel__WEBPACK_IMPORTED_MODULE_5___default().warn('[ScriptManager] 无法解析的脚本数据:', item, error);\n                }\n            }\n        }\n        return repository;\n    }\n    /**\n     * 保存全局脚本数组到扩展设置\n     * @param array 脚本数组\n     */\n    async saveGlobalScripts(array) {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('script.scriptsRepository', array);\n        this.globalScripts = array;\n    }\n    /**\n     * 保存脚本数组到角色卡数据\n     * @param array 脚本数组\n     */\n    async saveCharacterScripts(array) {\n        if (!_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid) {\n            throw new Error('[ScriptManager] 保存失败，当前角色为空');\n        }\n        //@ts-ignore\n        await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__.writeExtensionField)(_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid, 'TavernHelper_scripts', array);\n        this.characterScripts = array;\n    }\n    /**\n     * 保存全局脚本仓库项数组到扩展设置\n     * @param repository 仓库项数组\n     */\n    async saveGlobalRepositoryItems(repository) {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('script.scriptsRepository', repository);\n        this.globalScripts = (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.extractScriptsFromRepository)(repository);\n    }\n    /**\n     * 保存脚本仓库项数组到角色卡数据\n     * @param repository 仓库项数组\n     */\n    async saveCharacterRepositoryItems(repository) {\n        if (!_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid) {\n            throw new Error('[ScriptManager] 保存失败，当前角色为空');\n        }\n        //@ts-ignore\n        await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__.writeExtensionField)(_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid, 'TavernHelper_scripts', repository);\n        this.characterScripts = (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.extractScriptsFromRepository)(repository);\n    }\n    /**\n     * 从脚本库中删除脚本\n     * @param id 脚本ID\n     * @param type 脚本类型\n     */\n    async deleteScript(id, type) {\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL ? this.getGlobalRepositoryItems() : this.getCharacterRepositoryItems();\n        let scriptFound = false;\n        for (let i = 0; i < repository.length; i++) {\n            const item = repository[i];\n            if (item.type === 'script' && item.value.id === id) {\n                repository.splice(i, 1);\n                scriptFound = true;\n                break;\n            }\n            else if (item.type === 'folder') {\n                const scripts = item.value;\n                const foundIndex = scripts.findIndex(s => s.id === id);\n                if (foundIndex !== -1) {\n                    scripts.splice(foundIndex, 1);\n                    scriptFound = true;\n                    break;\n                }\n            }\n        }\n        if (!scriptFound) {\n            throw new Error('[ScriptManager] 删除脚本失败，脚本不存在');\n        }\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL) {\n            await this.saveGlobalRepositoryItems(repository);\n        }\n        else {\n            await this.saveCharacterRepositoryItems(repository);\n        }\n    }\n    /**\n     * 更新脚本启用状态\n     * @param type 脚本类型\n     * @param enable 是否启用\n     */\n    async updateScriptTypeEnableState(type, enable) {\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL) {\n            (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('script.global_script_enabled', enable);\n            this._isGlobalScriptEnabled = enable;\n        }\n        else {\n            const charactersWithScripts = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('script.characters_with_scripts') || [];\n            //@ts-ignore\n            const avatar = _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.characters?.[_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid]?.avatar;\n            if (enable) {\n                if (avatar && !charactersWithScripts.includes(avatar)) {\n                    charactersWithScripts.push(avatar);\n                }\n            }\n            else {\n                const index = charactersWithScripts.indexOf(avatar);\n                if (index !== -1) {\n                    charactersWithScripts.splice(index, 1);\n                }\n            }\n            (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('script.characters_with_scripts', charactersWithScripts);\n            this._isCharacterScriptEnabled = enable;\n        }\n    }\n    /**\n     * 获取脚本的类型\n     * @param script 脚本对象\n     * @returns 脚本类型\n     */\n    getScriptType(script) {\n        return this.globalScripts.some(s => s.id === script.id) ? _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL : _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.CHARACTER;\n    }\n    /**\n     * 刷新角色脚本启用状态\n     */\n    refreshCharacterScriptEnabledState() {\n        this._isCharacterScriptEnabled = this.checkCharacterScriptEnabled();\n    }\n    /**\n     * 获取全局脚本仓库项\n     */\n    getGlobalRepositoryItems() {\n        const rawRepository = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('script.scriptsRepository') || [];\n        return this.ensureRepositoryStructure(rawRepository);\n    }\n    /**\n     * 获取角色脚本仓库项\n     */\n    getCharacterRepositoryItems() {\n        //@ts-ignore\n        const rawRepository = _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid]?.data?.extensions?.TavernHelper_scripts || [];\n        return this.ensureRepositoryStructure(rawRepository);\n    }\n    /**\n     * 创建文件夹\n     * @param name 文件夹名称\n     * @param type 脚本类型\n     * @param icon 文件夹图标（可选）\n     * @param color 文件夹颜色（可选）\n     * @returns 新创建的文件夹ID\n     */\n    async createFolder(name, type, icon, color) {\n        if (!name || name.trim() === '') {\n            throw new Error('[ScriptManager] 文件夹名称不能为空');\n        }\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL ? this.getGlobalRepositoryItems() : this.getCharacterRepositoryItems();\n        const existingFolder = repository.find(item => item.type === 'folder' && item.name === name.trim());\n        if (existingFolder) {\n            throw new Error('[ScriptManager] 文件夹名称已存在');\n        }\n        const folderId = (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_4__.uuidv4)();\n        const newFolder = {\n            type: 'folder',\n            id: folderId,\n            name: name.trim(),\n            icon: icon || 'fa-folder',\n            color: color || document.documentElement.style.getPropertyValue('--SmartThemeBodyColor'),\n            value: [],\n        };\n        repository.unshift(newFolder);\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL) {\n            await this.saveGlobalRepositoryItems(repository);\n        }\n        else {\n            await this.saveCharacterRepositoryItems(repository);\n        }\n        return folderId;\n    }\n    /**\n     * 编辑文件夹\n     * @param folderId 文件夹ID\n     * @param newName 新名称\n     * @param type 脚本类型\n     * @param newIcon 新图标\n     * @param newColor 新颜色\n     */\n    async editFolder(folderId, newName, type, newIcon, newColor) {\n        if (!newName || newName.trim() === '') {\n            throw new Error('[ScriptManager] 文件夹名称不能为空');\n        }\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL ? this.getGlobalRepositoryItems() : this.getCharacterRepositoryItems();\n        const folderIndex = repository.findIndex(item => item.type === 'folder' && item.id === folderId);\n        if (folderIndex === -1) {\n            throw new Error('[ScriptManager] 文件夹不存在');\n        }\n        const existingFolder = repository.find(item => item.type === 'folder' && item.name === newName.trim() && item.id !== folderId);\n        if (existingFolder) {\n            throw new Error('[ScriptManager] 文件夹名称已存在');\n        }\n        repository[folderIndex].name = newName.trim();\n        if (newIcon !== undefined) {\n            repository[folderIndex].icon = newIcon;\n        }\n        if (newColor !== undefined) {\n            repository[folderIndex].color = newColor;\n        }\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL) {\n            await this.saveGlobalRepositoryItems(repository);\n        }\n        else {\n            await this.saveCharacterRepositoryItems(repository);\n        }\n    }\n    /**\n     * 删除文件夹（同时删除内部的所有脚本）\n     * @param folderId 文件夹ID\n     * @param type 脚本类型\n     */\n    async deleteFolder(folderId, type) {\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL ? this.getGlobalRepositoryItems() : this.getCharacterRepositoryItems();\n        const folderIndex = repository.findIndex(item => item.type === 'folder' && item.id === folderId);\n        if (folderIndex === -1) {\n            throw new Error('[ScriptManager] 文件夹不存在');\n        }\n        repository.splice(folderIndex, 1);\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL) {\n            await this.saveGlobalRepositoryItems(repository);\n        }\n        else {\n            await this.saveCharacterRepositoryItems(repository);\n        }\n    }\n    /**\n     * 将项目（脚本或文件夹）移动到其他类型的仓库\n     * @param item 要移动的项目信息\n     * @param sourceType 源类型\n     */\n    async moveItemToOtherType(item, sourceType) {\n        const targetType = (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.getOppositeScriptType)(sourceType);\n        const sourceRepository = sourceType === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL ? this.getGlobalRepositoryItems() : this.getCharacterRepositoryItems();\n        let itemFound = false;\n        let foundItem = null;\n        if (item.type === 'script') {\n            for (let i = 0; i < sourceRepository.length; i++) {\n                const repoItem = sourceRepository[i];\n                if (repoItem.type === 'script' && repoItem.value.id === item.id) {\n                    foundItem = repoItem;\n                    sourceRepository.splice(i, 1);\n                    itemFound = true;\n                    break;\n                }\n                else if (repoItem.type === 'folder') {\n                    const scripts = repoItem.value;\n                    const foundIndex = scripts.findIndex(s => s.id === item.id);\n                    if (foundIndex !== -1) {\n                        foundItem = { type: 'script', value: scripts[foundIndex] };\n                        scripts.splice(foundIndex, 1);\n                        itemFound = true;\n                        break;\n                    }\n                }\n            }\n            if (!itemFound) {\n                throw new Error('[ScriptManager] 移动脚本失败，脚本不存在');\n            }\n        }\n        else if (item.type === 'folder') {\n            const folderIndex = sourceRepository.findIndex(repoItem => repoItem.type === 'folder' && repoItem.id === item.id);\n            if (folderIndex === -1) {\n                throw new Error('[ScriptManager] 文件夹不存在');\n            }\n            foundItem = sourceRepository[folderIndex];\n            sourceRepository.splice(folderIndex, 1);\n            itemFound = true;\n        }\n        if (!itemFound || !foundItem) {\n            throw new Error('[ScriptManager] 移动失败，项目不存在');\n        }\n        const targetRepository = targetType === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL ? this.getGlobalRepositoryItems() : this.getCharacterRepositoryItems();\n        if (foundItem.type === 'folder') {\n            const existingFolder = targetRepository.find(repoItem => repoItem.type === 'folder' && repoItem.name === foundItem.name);\n            if (existingFolder) {\n                toastr.error('目标位置已存在同名文件夹');\n                throw new Error('[ScriptManager] 目标位置已存在同名文件夹');\n            }\n            targetRepository.unshift(foundItem);\n        }\n        else {\n            targetRepository.push(foundItem);\n        }\n        if (sourceType === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL) {\n            await this.saveGlobalRepositoryItems(sourceRepository);\n            await this.saveCharacterRepositoryItems(targetRepository);\n        }\n        else {\n            await this.saveCharacterRepositoryItems(sourceRepository);\n            await this.saveGlobalRepositoryItems(targetRepository);\n        }\n    }\n    /**\n     * 将脚本移动到文件夹\n     * @param scriptId 脚本ID\n     * @param targetFolderId 目标文件夹ID，如果为null则移动到根级别\n     * @param type 脚本类型\n     */\n    async moveScriptToFolder(scriptId, targetFolderId, type) {\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL ? this.getGlobalRepositoryItems() : this.getCharacterRepositoryItems();\n        let script = null;\n        for (let i = 0; i < repository.length; i++) {\n            const item = repository[i];\n            if (item.type === 'script' && item.value.id === scriptId) {\n                script = item.value;\n                repository.splice(i, 1);\n                break;\n            }\n            else if (item.type === 'folder') {\n                const scripts = item.value;\n                const foundIndex = scripts.findIndex(s => s.id === scriptId);\n                if (foundIndex !== -1) {\n                    script = scripts[foundIndex];\n                    scripts.splice(foundIndex, 1);\n                    break;\n                }\n            }\n        }\n        if (!script) {\n            throw new Error('[ScriptManager] 脚本不存在');\n        }\n        if (targetFolderId === null) {\n            repository.push({\n                type: 'script',\n                value: script,\n            });\n        }\n        else {\n            const targetFolder = repository.find(item => item.type === 'folder' && item.id === targetFolderId);\n            if (!targetFolder) {\n                throw new Error('[ScriptManager] 目标文件夹不存在');\n            }\n            const folderScripts = targetFolder.value;\n            const existingScript = folderScripts.find(s => s.name === script.name);\n            if (existingScript) {\n                throw new Error('[ScriptManager] 文件夹中已存在同名脚本');\n            }\n            folderScripts.push(script);\n        }\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL) {\n            await this.saveGlobalRepositoryItems(repository);\n        }\n        else {\n            await this.saveCharacterRepositoryItems(repository);\n        }\n    }\n    /**\n     * 获取文件夹中的脚本列表\n     * @param folderId 文件夹ID\n     * @param type 脚本类型\n     */\n    getFolderScripts(folderId, type) {\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL ? this.getGlobalRepositoryItems() : this.getCharacterRepositoryItems();\n        const folder = repository.find(item => item.type === 'folder' && item.id === folderId);\n        if (!folder) {\n            return [];\n        }\n        return folder.value;\n    }\n    /**\n     * 获取根级别的脚本列表\n     * @param type 脚本类型\n     */\n    getRootScripts(type) {\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL ? this.getGlobalRepositoryItems() : this.getCharacterRepositoryItems();\n        return repository.filter(item => item.type === 'script').map(item => item.value);\n    }\n    /**\n     * 获取所有文件夹列表\n     * @param type 脚本类型\n     */\n    getFolders(type) {\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL ? this.getGlobalRepositoryItems() : this.getCharacterRepositoryItems();\n        return repository.filter(item => item.type === 'folder');\n    }\n    /**\n     * 批量切换文件夹内所有脚本的启用状态\n     * @param folderId 文件夹ID\n     * @param type 脚本类型\n     * @param enable 是否启用\n     */\n    async toggleFolderScripts(folderId, type, enable) {\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL ? this.getGlobalRepositoryItems() : this.getCharacterRepositoryItems();\n        const folder = repository.find(item => item.type === 'folder' && item.id === folderId);\n        if (!folder) {\n            throw new Error('[ScriptManager] 文件夹不存在');\n        }\n        const scripts = folder.value;\n        let hasChanges = false;\n        for (const script of scripts) {\n            if (script.enabled !== enable) {\n                script.enabled = enable;\n                hasChanges = true;\n            }\n        }\n        if (hasChanges) {\n            if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_0__.ScriptType.GLOBAL) {\n                await this.saveGlobalRepositoryItems(repository);\n            }\n            else {\n                await this.saveCharacterRepositoryItems(repository);\n            }\n        }\n    }\n    /**\n     * 获取文件夹内脚本的整体启用状态\n     * @param folderId 文件夹ID\n     * @param type 脚本类型\n     * @returns 'all' - 全部启用, 'none' - 全部禁用\n     */\n    getFolderScriptsState(folderId, type) {\n        const scripts = this.getFolderScripts(folderId, type);\n        if (scripts.length === 0) {\n            return 'none';\n        }\n        const enabledCount = scripts.filter(script => script.enabled).length;\n        if (enabledCount === 0) {\n            return 'none';\n        }\n        else {\n            return 'all';\n        }\n    }\n}\n/**\n * 从脚本允许列表中删除角色\n * @param param0\n */\nasync function purgeEmbeddedScripts({ character }) {\n    const avatar = character?.character?.avatar;\n    const charactersWithScripts = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.getSettingValue)('script.characters_with_scripts') || [];\n    if (avatar) {\n        localStorage.removeItem(`AlertScript_${avatar}`);\n        if (charactersWithScripts?.includes(avatar)) {\n            const index = charactersWithScripts.indexOf(avatar);\n            if (index !== -1) {\n                charactersWithScripts.splice(index, 1);\n                (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('script.characters_with_scripts', charactersWithScripts);\n            }\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L2RhdGEudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBUTZDO0FBQ2tDO0FBQ25CO0FBQ1U7QUFDbEI7QUFFekI7QUFFM0I7O0dBRUc7QUFDSSxNQUFNLFVBQVU7SUFDYixNQUFNLENBQUMsUUFBUSxDQUFhO0lBQzVCLGFBQWEsR0FBYSxFQUFFLENBQUM7SUFDN0IsZ0JBQWdCLEdBQWEsRUFBRSxDQUFDO0lBQ2hDLHNCQUFzQixHQUFZLEtBQUssQ0FBQztJQUN4Qyx5QkFBeUIsR0FBWSxLQUFLLENBQUM7SUFFbkQ7UUFDRSxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7SUFDckIsQ0FBQztJQUVELElBQVcscUJBQXFCO1FBQzlCLE9BQU8sSUFBSSxDQUFDLHNCQUFzQixDQUFDO0lBQ3JDLENBQUM7SUFFRCxJQUFXLHdCQUF3QjtRQUNqQyxPQUFPLElBQUksQ0FBQyx5QkFBeUIsQ0FBQztJQUN4QyxDQUFDO0lBRU0sTUFBTSxDQUFDLFdBQVc7UUFDdkIsSUFBSSxDQUFDLFVBQVUsQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUN6QixVQUFVLENBQUMsUUFBUSxHQUFHLElBQUksVUFBVSxFQUFFLENBQUM7UUFDekMsQ0FBQztRQUNELE9BQU8sVUFBVSxDQUFDLFFBQVEsQ0FBQztJQUM3QixDQUFDO0lBRU0sTUFBTSxDQUFDLGVBQWU7UUFDM0IsSUFBSSxVQUFVLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDeEIsVUFBVSxDQUFDLFFBQVEsR0FBRyxTQUFrQyxDQUFDO1FBQzNELENBQUM7SUFDSCxDQUFDO0lBRUQ7OztPQUdHO0lBQ0ksMkJBQTJCO1FBQ2hDLE1BQU0scUJBQXFCLEdBQUcsMEVBQWUsQ0FBQyxnQ0FBZ0MsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUN0RixZQUFZO1FBQ1osTUFBTSxNQUFNLEdBQUcsMkRBQVUsRUFBRSxDQUFDLDBEQUFTLENBQUMsRUFBRSxNQUFNLENBQUM7UUFDL0MsT0FBTyxxQkFBcUIsRUFBRSxRQUFRLENBQUMsTUFBTSxDQUFDLElBQUksS0FBSyxDQUFDO0lBQzFELENBQUM7SUFFRDs7T0FFRztJQUNILFdBQVc7UUFDVCxNQUFNLG1CQUFtQixHQUFHLDBFQUFlLENBQUMsMEJBQTBCLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDOUUsSUFBSSxDQUFDLGFBQWEsR0FBRyxJQUFJLENBQUMsd0JBQXdCLENBQUMsbUJBQW1CLEVBQUUsMEVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUMzRixZQUFZO1FBQ1osTUFBTSxzQkFBc0IsR0FBRywyREFBVSxDQUFDLDBEQUFTLENBQUMsRUFBRSxJQUFJLEVBQUUsVUFBVSxFQUFFLG9CQUFvQixJQUFJLEVBQUUsQ0FBQztRQUNuRyxJQUFJLENBQUMsZ0JBQWdCLEdBQUcsSUFBSSxDQUFDLHdCQUF3QixDQUFDLHNCQUFzQixFQUFFLDBFQUFVLENBQUMsU0FBUyxDQUFDLENBQUM7UUFFcEcsSUFBSSxDQUFDLHNCQUFzQixHQUFHLDBFQUFlLENBQUMsOEJBQThCLENBQUMsSUFBSSxLQUFLLENBQUM7UUFDdkYsSUFBSSxDQUFDLHlCQUF5QixHQUFHLElBQUksQ0FBQywyQkFBMkIsRUFBRSxDQUFDO0lBQ3RFLENBQUM7SUFFRDs7Ozs7T0FLRztJQUNLLHdCQUF3QixDQUFDLFVBQWlCLEVBQUUsSUFBZ0I7UUFDbEUsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLEVBQUUsQ0FBQztZQUMvQixPQUFPLEVBQUUsQ0FBQztRQUNaLENBQUM7UUFFRCxJQUFJLGNBQWMsR0FBRyxLQUFLLENBQUM7UUFDM0IsTUFBTSxrQkFBa0IsR0FBMkIsRUFBRSxDQUFDO1FBRXRELEtBQUssTUFBTSxJQUFJLElBQUksVUFBVSxFQUFFLENBQUM7WUFDOUIsSUFBSSw0RUFBUSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUM7Z0JBQ25CLGNBQWMsR0FBRyxJQUFJLENBQUM7Z0JBQ3RCLGtCQUFrQixDQUFDLElBQUksQ0FBQztvQkFDdEIsSUFBSSxFQUFFLFFBQVE7b0JBQ2QsS0FBSyxFQUFFLElBQUksc0VBQU0sQ0FBQyxJQUFJLENBQUM7aUJBQ3hCLENBQUMsQ0FBQztZQUNMLENBQUM7aUJBQU0sSUFBSSwwRkFBc0IsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDO2dCQUN4QyxJQUFJLElBQUksQ0FBQyxJQUFJLEtBQUssUUFBUSxFQUFFLENBQUM7b0JBQzNCLGtCQUFrQixDQUFDLElBQUksQ0FBQzt3QkFDdEIsSUFBSSxFQUFFLFFBQVE7d0JBQ2QsS0FBSyxFQUFFLElBQUksc0VBQU0sQ0FBQyxJQUFJLENBQUMsS0FBd0IsQ0FBQztxQkFDakQsQ0FBQyxDQUFDO2dCQUNMLENBQUM7cUJBQU0sSUFBSSxJQUFJLENBQUMsSUFBSSxLQUFLLFFBQVEsRUFBRSxDQUFDO29CQUNsQyxrQkFBa0IsQ0FBQyxJQUFJLENBQUM7d0JBQ3RCLElBQUksRUFBRSxRQUFRO3dCQUNkLEVBQUUsRUFBRSxJQUFJLENBQUMsRUFBRTt3QkFDWCxJQUFJLEVBQUUsSUFBSSxDQUFDLElBQUk7d0JBQ2YsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJLElBQUksV0FBVzt3QkFDOUIsS0FBSyxFQUFFLElBQUksQ0FBQyxLQUFLLElBQUksUUFBUSxDQUFDLGVBQWUsQ0FBQyxLQUFLLENBQUMsZ0JBQWdCLENBQUMsdUJBQXVCLENBQUM7d0JBQzdGLEtBQUssRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFNLEVBQUUsRUFBRSxDQUFDLElBQUksc0VBQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFO3FCQUNsRixDQUFDLENBQUM7Z0JBQ0wsQ0FBQztZQUNILENBQUM7aUJBQU0sQ0FBQztnQkFDTixvREFBUSxDQUFDLDRCQUE0QixFQUFFLElBQUksQ0FBQyxDQUFDO1lBQy9DLENBQUM7UUFDSCxDQUFDO1FBRUQsSUFBSSxjQUFjLEVBQUUsQ0FBQztZQUNuQixJQUFJLENBQUMsc0JBQXNCLENBQUMsa0JBQWtCLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDeEQsQ0FBQztRQUVELE9BQU8sZ0dBQTRCLENBQUMsa0JBQWtCLENBQUMsQ0FBQztJQUMxRCxDQUFDO0lBRUQ7Ozs7T0FJRztJQUNLLEtBQUssQ0FBQyxzQkFBc0IsQ0FBQyxVQUFrQyxFQUFFLElBQWdCO1FBQ3ZGLElBQUksQ0FBQztZQUNILElBQUksSUFBSSxLQUFLLDBFQUFVLENBQUMsTUFBTSxFQUFFLENBQUM7Z0JBQy9CLDJFQUFnQixDQUFDLDBCQUEwQixFQUFFLFVBQVUsQ0FBQyxDQUFDO1lBQzNELENBQUM7aUJBQU0sQ0FBQztnQkFDTixJQUFJLENBQUMsMERBQVMsRUFBRSxDQUFDO29CQUNmLG9EQUFRLENBQUMscUNBQXFDLENBQUMsQ0FBQztvQkFDaEQsT0FBTztnQkFDVCxDQUFDO2dCQUNELFlBQVk7Z0JBQ1osTUFBTSxvRkFBbUIsQ0FBQywwREFBUyxFQUFFLHNCQUFzQixFQUFFLFVBQVUsQ0FBQyxDQUFDO1lBQzNFLENBQUM7WUFDRCxvREFBUSxDQUFDLHVCQUF1QixJQUFJLFFBQVEsQ0FBQyxDQUFDO1FBQ2hELENBQUM7UUFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO1lBQ2YscURBQVMsQ0FBQyxxQkFBcUIsSUFBSSxTQUFTLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDdkQsQ0FBQztJQUNILENBQUM7SUFFRDs7T0FFRztJQUNILGdCQUFnQjtRQUNkLE9BQU8sSUFBSSxDQUFDLGFBQWEsQ0FBQztJQUM1QixDQUFDO0lBRUQ7O09BRUc7SUFDSCxtQkFBbUI7UUFDakIsWUFBWTtRQUNaLE1BQU0sc0JBQXNCLEdBQUcsMkRBQVUsQ0FBQywwREFBUyxDQUFDLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRSxvQkFBb0IsSUFBSSxFQUFFLENBQUM7UUFDbkcsSUFBSSxDQUFDLGdCQUFnQixHQUFHLElBQUksQ0FBQyx3QkFBd0IsQ0FBQyxzQkFBc0IsRUFBRSwwRUFBVSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQ3BHLE9BQU8sSUFBSSxDQUFDLGdCQUFnQixDQUFDO0lBQy9CLENBQUM7SUFFRDs7OztPQUlHO0lBQ0gsYUFBYSxDQUFDLEVBQVU7UUFDdEIsSUFBSSxNQUFNLEdBQUcsSUFBSSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFTLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLEtBQUssRUFBRSxDQUFDLENBQUM7UUFDakUsSUFBSSxNQUFNO1lBQUUsT0FBTyxNQUFNLENBQUM7UUFFMUIsTUFBTSxHQUFHLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFTLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLEtBQUssRUFBRSxDQUFDLENBQUM7UUFDaEUsSUFBSSxNQUFNO1lBQUUsT0FBTyxNQUFNLENBQUM7UUFFMUIsT0FBTyxTQUFTLENBQUM7SUFDbkIsQ0FBQztJQUVEOzs7O09BSUc7SUFDSCxLQUFLLENBQUMsVUFBVSxDQUFDLE1BQWMsRUFBRSxJQUFnQjtRQUMvQyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksSUFBSSxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxLQUFLLEVBQUUsRUFBRSxDQUFDO1lBQzlDLE1BQU0sSUFBSSxLQUFLLENBQUMsNkJBQTZCLENBQUMsQ0FBQztRQUNqRCxDQUFDO1FBRUQsTUFBTSxhQUFhLEdBQ2pCLElBQUksS0FBSywwRUFBVSxDQUFDLE1BQU07WUFDeEIsQ0FBQyxDQUFDLDBFQUFlLENBQUMsMEJBQTBCLENBQUMsSUFBSSxFQUFFO1lBQ25ELENBQUMsQ0FBQyxZQUFZO2dCQUNaLDJEQUFVLENBQUMsMERBQVMsQ0FBQyxFQUFFLElBQUksRUFBRSxVQUFVLEVBQUUsb0JBQW9CLElBQUksRUFBRSxDQUFDO1FBRTFFLE1BQU0sVUFBVSxHQUFHLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyxhQUFhLENBQUMsQ0FBQztRQUVqRSxJQUFJLFVBQVUsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUNwQixJQUFJLGFBQWEsR0FBRyxLQUFLLENBQUM7UUFDMUIsSUFBSSxXQUFXLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFFckIsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLFVBQVUsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQztZQUMzQyxNQUFNLElBQUksR0FBRyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDM0IsSUFBSSxJQUFJLENBQUMsSUFBSSxLQUFLLFFBQVEsSUFBSyxJQUFJLENBQUMsS0FBZ0IsQ0FBQyxFQUFFLEtBQUssTUFBTSxDQUFDLEVBQUUsRUFBRSxDQUFDO2dCQUN0RSxVQUFVLEdBQUcsQ0FBQyxDQUFDO2dCQUNmLE1BQU07WUFDUixDQUFDO2lCQUFNLElBQUksSUFBSSxDQUFDLElBQUksS0FBSyxRQUFRLEVBQUUsQ0FBQztnQkFDbEMsTUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLEtBQWlCLENBQUM7Z0JBQ3ZDLE1BQU0sV0FBVyxHQUFHLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxLQUFLLE1BQU0sQ0FBQyxFQUFFLENBQUMsQ0FBQztnQkFDL0QsSUFBSSxXQUFXLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQztvQkFDdkIsYUFBYSxHQUFHLElBQUksQ0FBQztvQkFDckIsV0FBVyxHQUFHLENBQUMsQ0FBQztvQkFDaEIsVUFBVSxHQUFHLFdBQVcsQ0FBQztvQkFDekIsTUFBTTtnQkFDUixDQUFDO1lBQ0gsQ0FBQztRQUNILENBQUM7UUFFRCxJQUFJLGFBQWEsSUFBSSxXQUFXLElBQUksQ0FBQyxFQUFFLENBQUM7WUFDdEMsTUFBTSxNQUFNLEdBQUcsVUFBVSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBQ3RDLE1BQU0sQ0FBQyxLQUFrQixDQUFDLFVBQVUsQ0FBQyxHQUFHLE1BQU0sQ0FBQztRQUNsRCxDQUFDO2FBQU0sSUFBSSxVQUFVLElBQUksQ0FBQyxFQUFFLENBQUM7WUFDMUIsVUFBVSxDQUFDLFVBQVUsQ0FBQyxDQUFDLEtBQWdCLEdBQUcsTUFBTSxDQUFDO1FBQ3BELENBQUM7YUFBTSxDQUFDO1lBQ04sVUFBVSxDQUFDLElBQUksQ0FBQztnQkFDZCxJQUFJLEVBQUUsUUFBUTtnQkFDZCxLQUFLLEVBQUUsTUFBTTthQUNkLENBQUMsQ0FBQztRQUNMLENBQUM7UUFFRCxJQUFJLElBQUksS0FBSywwRUFBVSxDQUFDLE1BQU0sRUFBRSxDQUFDO1lBQy9CLE1BQU0sSUFBSSxDQUFDLHlCQUF5QixDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQ25ELENBQUM7YUFBTSxDQUFDO1lBQ04sTUFBTSxJQUFJLENBQUMsNEJBQTRCLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDdEQsQ0FBQztRQUVELElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztJQUNyQixDQUFDO0lBRUQ7Ozs7T0FJRztJQUNLLHlCQUF5QixDQUFDLGFBQW9CO1FBQ3BELE1BQU0sVUFBVSxHQUEyQixFQUFFLENBQUM7UUFFOUMsS0FBSyxNQUFNLElBQUksSUFBSSxhQUFhLEVBQUUsQ0FBQztZQUNqQyxJQUFJLDRFQUFRLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQztnQkFDbkIsVUFBVSxDQUFDLElBQUksQ0FBQztvQkFDZCxJQUFJLEVBQUUsUUFBUTtvQkFDZCxLQUFLLEVBQUUsSUFBSSxzRUFBTSxDQUFDLElBQUksQ0FBQztpQkFDeEIsQ0FBQyxDQUFDO1lBQ0wsQ0FBQztpQkFBTSxJQUFJLDBGQUFzQixDQUFDLElBQUksQ0FBQyxFQUFFLENBQUM7Z0JBQ3hDLElBQUksSUFBSSxDQUFDLElBQUksS0FBSyxRQUFRLEVBQUUsQ0FBQztvQkFDM0IsVUFBVSxDQUFDLElBQUksQ0FBQzt3QkFDZCxJQUFJLEVBQUUsUUFBUTt3QkFDZCxLQUFLLEVBQUUsSUFBSSxzRUFBTSxDQUFDLElBQUksQ0FBQyxLQUF3QixDQUFDO3FCQUNqRCxDQUFDLENBQUM7Z0JBQ0wsQ0FBQztxQkFBTSxJQUFJLElBQUksQ0FBQyxJQUFJLEtBQUssUUFBUSxFQUFFLENBQUM7b0JBQ2xDLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7d0JBQ2YsSUFBSSxDQUFDLElBQUksR0FBRyxXQUFXLENBQUM7b0JBQzFCLENBQUM7b0JBQ0QsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQzt3QkFDaEIsSUFBSSxDQUFDLEtBQUssR0FBRyxRQUFRLENBQUMsZUFBZSxDQUFDLEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDO29CQUN4RixDQUFDO29CQUNELFVBQVUsQ0FBQyxJQUFJLENBQUM7d0JBQ2QsR0FBRyxJQUFJO3dCQUNQLEtBQUssRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFNLEVBQUUsRUFBRSxDQUFDLElBQUksc0VBQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFO3FCQUNsRixDQUFDLENBQUM7Z0JBQ0wsQ0FBQztZQUNILENBQUM7aUJBQU0sQ0FBQztnQkFDTixJQUFJLENBQUM7b0JBQ0gsVUFBVSxDQUFDLElBQUksQ0FBQzt3QkFDZCxJQUFJLEVBQUUsUUFBUTt3QkFDZCxLQUFLLEVBQUUsSUFBSSxzRUFBTSxDQUFDLElBQUksQ0FBQztxQkFDeEIsQ0FBQyxDQUFDO2dCQUNMLENBQUM7Z0JBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztvQkFDZixvREFBUSxDQUFDLDRCQUE0QixFQUFFLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQztnQkFDdEQsQ0FBQztZQUNILENBQUM7UUFDSCxDQUFDO1FBRUQsT0FBTyxVQUFVLENBQUM7SUFDcEIsQ0FBQztJQUVEOzs7T0FHRztJQUNILEtBQUssQ0FBQyxpQkFBaUIsQ0FBQyxLQUFlO1FBQ3JDLDJFQUFnQixDQUFDLDBCQUEwQixFQUFFLEtBQUssQ0FBQyxDQUFDO1FBQ3BELElBQUksQ0FBQyxhQUFhLEdBQUcsS0FBSyxDQUFDO0lBQzdCLENBQUM7SUFFRDs7O09BR0c7SUFDSCxLQUFLLENBQUMsb0JBQW9CLENBQUMsS0FBZTtRQUN4QyxJQUFJLENBQUMsMERBQVMsRUFBRSxDQUFDO1lBQ2YsTUFBTSxJQUFJLEtBQUssQ0FBQyw2QkFBNkIsQ0FBQyxDQUFDO1FBQ2pELENBQUM7UUFFRCxZQUFZO1FBQ1osTUFBTSxvRkFBbUIsQ0FBQywwREFBUyxFQUFFLHNCQUFzQixFQUFFLEtBQUssQ0FBQyxDQUFDO1FBRXBFLElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxLQUFLLENBQUM7SUFDaEMsQ0FBQztJQUVEOzs7T0FHRztJQUNILEtBQUssQ0FBQyx5QkFBeUIsQ0FBQyxVQUFrQztRQUNoRSwyRUFBZ0IsQ0FBQywwQkFBMEIsRUFBRSxVQUFVLENBQUMsQ0FBQztRQUN6RCxJQUFJLENBQUMsYUFBYSxHQUFHLGdHQUE0QixDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBQ2hFLENBQUM7SUFFRDs7O09BR0c7SUFDSCxLQUFLLENBQUMsNEJBQTRCLENBQUMsVUFBa0M7UUFDbkUsSUFBSSxDQUFDLDBEQUFTLEVBQUUsQ0FBQztZQUNmLE1BQU0sSUFBSSxLQUFLLENBQUMsNkJBQTZCLENBQUMsQ0FBQztRQUNqRCxDQUFDO1FBQ0QsWUFBWTtRQUNaLE1BQU0sb0ZBQW1CLENBQUMsMERBQVMsRUFBRSxzQkFBc0IsRUFBRSxVQUFVLENBQUMsQ0FBQztRQUV6RSxJQUFJLENBQUMsZ0JBQWdCLEdBQUcsZ0dBQTRCLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDbkUsQ0FBQztJQUVEOzs7O09BSUc7SUFDSCxLQUFLLENBQUMsWUFBWSxDQUFDLEVBQVUsRUFBRSxJQUFnQjtRQUM3QyxNQUFNLFVBQVUsR0FDZCxJQUFJLEtBQUssMEVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyx3QkFBd0IsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsMkJBQTJCLEVBQUUsQ0FBQztRQUVwRyxJQUFJLFdBQVcsR0FBRyxLQUFLLENBQUM7UUFFeEIsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLFVBQVUsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQztZQUMzQyxNQUFNLElBQUksR0FBRyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDM0IsSUFBSSxJQUFJLENBQUMsSUFBSSxLQUFLLFFBQVEsSUFBSyxJQUFJLENBQUMsS0FBZ0IsQ0FBQyxFQUFFLEtBQUssRUFBRSxFQUFFLENBQUM7Z0JBQy9ELFVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO2dCQUN4QixXQUFXLEdBQUcsSUFBSSxDQUFDO2dCQUNuQixNQUFNO1lBQ1IsQ0FBQztpQkFBTSxJQUFJLElBQUksQ0FBQyxJQUFJLEtBQUssUUFBUSxFQUFFLENBQUM7Z0JBQ2xDLE1BQU0sT0FBTyxHQUFHLElBQUksQ0FBQyxLQUFpQixDQUFDO2dCQUN2QyxNQUFNLFVBQVUsR0FBRyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQztnQkFDdkQsSUFBSSxVQUFVLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQztvQkFDdEIsT0FBTyxDQUFDLE1BQU0sQ0FBQyxVQUFVLEVBQUUsQ0FBQyxDQUFDLENBQUM7b0JBQzlCLFdBQVcsR0FBRyxJQUFJLENBQUM7b0JBQ25CLE1BQU07Z0JBQ1IsQ0FBQztZQUNILENBQUM7UUFDSCxDQUFDO1FBRUQsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQ2pCLE1BQU0sSUFBSSxLQUFLLENBQUMsOEJBQThCLENBQUMsQ0FBQztRQUNsRCxDQUFDO1FBRUQsSUFBSSxJQUFJLEtBQUssMEVBQVUsQ0FBQyxNQUFNLEVBQUUsQ0FBQztZQUMvQixNQUFNLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUNuRCxDQUFDO2FBQU0sQ0FBQztZQUNOLE1BQU0sSUFBSSxDQUFDLDRCQUE0QixDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQ3RELENBQUM7SUFDSCxDQUFDO0lBRUQ7Ozs7T0FJRztJQUNILEtBQUssQ0FBQywyQkFBMkIsQ0FBQyxJQUFnQixFQUFFLE1BQWU7UUFDakUsSUFBSSxJQUFJLEtBQUssMEVBQVUsQ0FBQyxNQUFNLEVBQUUsQ0FBQztZQUMvQiwyRUFBZ0IsQ0FBQyw4QkFBOEIsRUFBRSxNQUFNLENBQUMsQ0FBQztZQUN6RCxJQUFJLENBQUMsc0JBQXNCLEdBQUcsTUFBTSxDQUFDO1FBQ3ZDLENBQUM7YUFBTSxDQUFDO1lBQ04sTUFBTSxxQkFBcUIsR0FBRywwRUFBZSxDQUFDLGdDQUFnQyxDQUFDLElBQUksRUFBRSxDQUFDO1lBQ3RGLFlBQVk7WUFDWixNQUFNLE1BQU0sR0FBRywyREFBVSxFQUFFLENBQUMsMERBQVMsQ0FBQyxFQUFFLE1BQU0sQ0FBQztZQUUvQyxJQUFJLE1BQU0sRUFBRSxDQUFDO2dCQUNYLElBQUksTUFBTSxJQUFJLENBQUMscUJBQXFCLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUM7b0JBQ3RELHFCQUFxQixDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztnQkFDckMsQ0FBQztZQUNILENBQUM7aUJBQU0sQ0FBQztnQkFDTixNQUFNLEtBQUssR0FBRyxxQkFBcUIsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUM7Z0JBQ3BELElBQUksS0FBSyxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUM7b0JBQ2pCLHFCQUFxQixDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUM7Z0JBQ3pDLENBQUM7WUFDSCxDQUFDO1lBRUQsMkVBQWdCLENBQUMsZ0NBQWdDLEVBQUUscUJBQXFCLENBQUMsQ0FBQztZQUMxRSxJQUFJLENBQUMseUJBQXlCLEdBQUcsTUFBTSxDQUFDO1FBQzFDLENBQUM7SUFDSCxDQUFDO0lBRUQ7Ozs7T0FJRztJQUNJLGFBQWEsQ0FBQyxNQUFjO1FBQ2pDLE9BQU8sSUFBSSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxLQUFLLE1BQU0sQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsMEVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLDBFQUFVLENBQUMsU0FBUyxDQUFDO0lBQ3JHLENBQUM7SUFFRDs7T0FFRztJQUNILGtDQUFrQztRQUNoQyxJQUFJLENBQUMseUJBQXlCLEdBQUcsSUFBSSxDQUFDLDJCQUEyQixFQUFFLENBQUM7SUFDdEUsQ0FBQztJQUVEOztPQUVHO0lBQ0gsd0JBQXdCO1FBQ3RCLE1BQU0sYUFBYSxHQUFHLDBFQUFlLENBQUMsMEJBQTBCLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDeEUsT0FBTyxJQUFJLENBQUMseUJBQXlCLENBQUMsYUFBYSxDQUFDLENBQUM7SUFDdkQsQ0FBQztJQUVEOztPQUVHO0lBQ0gsMkJBQTJCO1FBQ3pCLFlBQVk7UUFDWixNQUFNLGFBQWEsR0FBRywyREFBVSxDQUFDLDBEQUFTLENBQUMsRUFBRSxJQUFJLEVBQUUsVUFBVSxFQUFFLG9CQUFvQixJQUFJLEVBQUUsQ0FBQztRQUMxRixPQUFPLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyxhQUFhLENBQUMsQ0FBQztJQUN2RCxDQUFDO0lBRUQ7Ozs7Ozs7T0FPRztJQUNILEtBQUssQ0FBQyxZQUFZLENBQUMsSUFBWSxFQUFFLElBQWdCLEVBQUUsSUFBYSxFQUFFLEtBQWM7UUFDOUUsSUFBSSxDQUFDLElBQUksSUFBSSxJQUFJLENBQUMsSUFBSSxFQUFFLEtBQUssRUFBRSxFQUFFLENBQUM7WUFDaEMsTUFBTSxJQUFJLEtBQUssQ0FBQywyQkFBMkIsQ0FBQyxDQUFDO1FBQy9DLENBQUM7UUFFRCxNQUFNLFVBQVUsR0FDZCxJQUFJLEtBQUssMEVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyx3QkFBd0IsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsMkJBQTJCLEVBQUUsQ0FBQztRQUVwRyxNQUFNLGNBQWMsR0FBRyxVQUFVLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLElBQUksS0FBSyxRQUFRLElBQUksSUFBSSxDQUFDLElBQUksS0FBSyxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQztRQUNwRyxJQUFJLGNBQWMsRUFBRSxDQUFDO1lBQ25CLE1BQU0sSUFBSSxLQUFLLENBQUMsMEJBQTBCLENBQUMsQ0FBQztRQUM5QyxDQUFDO1FBRUQsTUFBTSxRQUFRLEdBQUcsa0VBQU0sRUFBRSxDQUFDO1FBQzFCLE1BQU0sU0FBUyxHQUF5QjtZQUN0QyxJQUFJLEVBQUUsUUFBUTtZQUNkLEVBQUUsRUFBRSxRQUFRO1lBQ1osSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJLEVBQUU7WUFDakIsSUFBSSxFQUFFLElBQUksSUFBSSxXQUFXO1lBQ3pCLEtBQUssRUFBRSxLQUFLLElBQUksUUFBUSxDQUFDLGVBQWUsQ0FBQyxLQUFLLENBQUMsZ0JBQWdCLENBQUMsdUJBQXVCLENBQUM7WUFDeEYsS0FBSyxFQUFFLEVBQUU7U0FDVixDQUFDO1FBRUYsVUFBVSxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUU5QixJQUFJLElBQUksS0FBSywwRUFBVSxDQUFDLE1BQU0sRUFBRSxDQUFDO1lBQy9CLE1BQU0sSUFBSSxDQUFDLHlCQUF5QixDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQ25ELENBQUM7YUFBTSxDQUFDO1lBQ04sTUFBTSxJQUFJLENBQUMsNEJBQTRCLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDdEQsQ0FBQztRQUVELE9BQU8sUUFBUSxDQUFDO0lBQ2xCLENBQUM7SUFFRDs7Ozs7OztPQU9HO0lBQ0gsS0FBSyxDQUFDLFVBQVUsQ0FDZCxRQUFnQixFQUNoQixPQUFlLEVBQ2YsSUFBZ0IsRUFDaEIsT0FBZ0IsRUFDaEIsUUFBaUI7UUFFakIsSUFBSSxDQUFDLE9BQU8sSUFBSSxPQUFPLENBQUMsSUFBSSxFQUFFLEtBQUssRUFBRSxFQUFFLENBQUM7WUFDdEMsTUFBTSxJQUFJLEtBQUssQ0FBQywyQkFBMkIsQ0FBQyxDQUFDO1FBQy9DLENBQUM7UUFFRCxNQUFNLFVBQVUsR0FDZCxJQUFJLEtBQUssMEVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyx3QkFBd0IsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsMkJBQTJCLEVBQUUsQ0FBQztRQUVwRyxNQUFNLFdBQVcsR0FBRyxVQUFVLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLElBQUksS0FBSyxRQUFRLElBQUksSUFBSSxDQUFDLEVBQUUsS0FBSyxRQUFRLENBQUMsQ0FBQztRQUNqRyxJQUFJLFdBQVcsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDO1lBQ3ZCLE1BQU0sSUFBSSxLQUFLLENBQUMsd0JBQXdCLENBQUMsQ0FBQztRQUM1QyxDQUFDO1FBRUQsTUFBTSxjQUFjLEdBQUcsVUFBVSxDQUFDLElBQUksQ0FDcEMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsSUFBSSxLQUFLLFFBQVEsSUFBSSxJQUFJLENBQUMsSUFBSSxLQUFLLE9BQU8sQ0FBQyxJQUFJLEVBQUUsSUFBSSxJQUFJLENBQUMsRUFBRSxLQUFLLFFBQVEsQ0FDdkYsQ0FBQztRQUNGLElBQUksY0FBYyxFQUFFLENBQUM7WUFDbkIsTUFBTSxJQUFJLEtBQUssQ0FBQywwQkFBMEIsQ0FBQyxDQUFDO1FBQzlDLENBQUM7UUFFRCxVQUFVLENBQUMsV0FBVyxDQUFDLENBQUMsSUFBSSxHQUFHLE9BQU8sQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUM5QyxJQUFJLE9BQU8sS0FBSyxTQUFTLEVBQUUsQ0FBQztZQUMxQixVQUFVLENBQUMsV0FBVyxDQUFDLENBQUMsSUFBSSxHQUFHLE9BQU8sQ0FBQztRQUN6QyxDQUFDO1FBQ0QsSUFBSSxRQUFRLEtBQUssU0FBUyxFQUFFLENBQUM7WUFDM0IsVUFBVSxDQUFDLFdBQVcsQ0FBQyxDQUFDLEtBQUssR0FBRyxRQUFRLENBQUM7UUFDM0MsQ0FBQztRQUVELElBQUksSUFBSSxLQUFLLDBFQUFVLENBQUMsTUFBTSxFQUFFLENBQUM7WUFDL0IsTUFBTSxJQUFJLENBQUMseUJBQXlCLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDbkQsQ0FBQzthQUFNLENBQUM7WUFDTixNQUFNLElBQUksQ0FBQyw0QkFBNEIsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUN0RCxDQUFDO0lBQ0gsQ0FBQztJQUVEOzs7O09BSUc7SUFDSCxLQUFLLENBQUMsWUFBWSxDQUFDLFFBQWdCLEVBQUUsSUFBZ0I7UUFDbkQsTUFBTSxVQUFVLEdBQ2QsSUFBSSxLQUFLLDBFQUFVLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsd0JBQXdCLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLDJCQUEyQixFQUFFLENBQUM7UUFFcEcsTUFBTSxXQUFXLEdBQUcsVUFBVSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxJQUFJLEtBQUssUUFBUSxJQUFJLElBQUksQ0FBQyxFQUFFLEtBQUssUUFBUSxDQUFDLENBQUM7UUFDakcsSUFBSSxXQUFXLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQztZQUN2QixNQUFNLElBQUksS0FBSyxDQUFDLHdCQUF3QixDQUFDLENBQUM7UUFDNUMsQ0FBQztRQUVELFVBQVUsQ0FBQyxNQUFNLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBRWxDLElBQUksSUFBSSxLQUFLLDBFQUFVLENBQUMsTUFBTSxFQUFFLENBQUM7WUFDL0IsTUFBTSxJQUFJLENBQUMseUJBQXlCLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDbkQsQ0FBQzthQUFNLENBQUM7WUFDTixNQUFNLElBQUksQ0FBQyw0QkFBNEIsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUN0RCxDQUFDO0lBQ0gsQ0FBQztJQUVEOzs7O09BSUc7SUFDSCxLQUFLLENBQUMsbUJBQW1CLENBQ3ZCLElBQW9GLEVBQ3BGLFVBQXNCO1FBRXRCLE1BQU0sVUFBVSxHQUFHLHlGQUFxQixDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBRXJELE1BQU0sZ0JBQWdCLEdBQ3BCLFVBQVUsS0FBSywwRUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLHdCQUF3QixFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQywyQkFBMkIsRUFBRSxDQUFDO1FBRTFHLElBQUksU0FBUyxHQUFHLEtBQUssQ0FBQztRQUN0QixJQUFJLFNBQVMsR0FBZ0MsSUFBSSxDQUFDO1FBRWxELElBQUksSUFBSSxDQUFDLElBQUksS0FBSyxRQUFRLEVBQUUsQ0FBQztZQUMzQixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsZ0JBQWdCLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7Z0JBQ2pELE1BQU0sUUFBUSxHQUFHLGdCQUFnQixDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUNyQyxJQUFJLFFBQVEsQ0FBQyxJQUFJLEtBQUssUUFBUSxJQUFLLFFBQVEsQ0FBQyxLQUFnQixDQUFDLEVBQUUsS0FBSyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUM7b0JBQzVFLFNBQVMsR0FBRyxRQUFRLENBQUM7b0JBQ3JCLGdCQUFnQixDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7b0JBQzlCLFNBQVMsR0FBRyxJQUFJLENBQUM7b0JBQ2pCLE1BQU07Z0JBQ1IsQ0FBQztxQkFBTSxJQUFJLFFBQVEsQ0FBQyxJQUFJLEtBQUssUUFBUSxFQUFFLENBQUM7b0JBQ3RDLE1BQU0sT0FBTyxHQUFHLFFBQVEsQ0FBQyxLQUFpQixDQUFDO29CQUMzQyxNQUFNLFVBQVUsR0FBRyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsS0FBSyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7b0JBQzVELElBQUksVUFBVSxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUM7d0JBQ3RCLFNBQVMsR0FBRyxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsS0FBSyxFQUFFLE9BQU8sQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDO3dCQUMzRCxPQUFPLENBQUMsTUFBTSxDQUFDLFVBQVUsRUFBRSxDQUFDLENBQUMsQ0FBQzt3QkFDOUIsU0FBUyxHQUFHLElBQUksQ0FBQzt3QkFDakIsTUFBTTtvQkFDUixDQUFDO2dCQUNILENBQUM7WUFDSCxDQUFDO1lBRUQsSUFBSSxDQUFDLFNBQVMsRUFBRSxDQUFDO2dCQUNmLE1BQU0sSUFBSSxLQUFLLENBQUMsOEJBQThCLENBQUMsQ0FBQztZQUNsRCxDQUFDO1FBQ0gsQ0FBQzthQUFNLElBQUksSUFBSSxDQUFDLElBQUksS0FBSyxRQUFRLEVBQUUsQ0FBQztZQUNsQyxNQUFNLFdBQVcsR0FBRyxnQkFBZ0IsQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxRQUFRLENBQUMsSUFBSSxLQUFLLFFBQVEsSUFBSSxRQUFRLENBQUMsRUFBRSxLQUFLLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQztZQUNsSCxJQUFJLFdBQVcsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDO2dCQUN2QixNQUFNLElBQUksS0FBSyxDQUFDLHdCQUF3QixDQUFDLENBQUM7WUFDNUMsQ0FBQztZQUVELFNBQVMsR0FBRyxnQkFBZ0IsQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUMxQyxnQkFBZ0IsQ0FBQyxNQUFNLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBQ3hDLFNBQVMsR0FBRyxJQUFJLENBQUM7UUFDbkIsQ0FBQztRQUVELElBQUksQ0FBQyxTQUFTLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQztZQUM3QixNQUFNLElBQUksS0FBSyxDQUFDLDRCQUE0QixDQUFDLENBQUM7UUFDaEQsQ0FBQztRQUVELE1BQU0sZ0JBQWdCLEdBQ3BCLFVBQVUsS0FBSywwRUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLHdCQUF3QixFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQywyQkFBMkIsRUFBRSxDQUFDO1FBRTFHLElBQUksU0FBUyxDQUFDLElBQUksS0FBSyxRQUFRLEVBQUUsQ0FBQztZQUNoQyxNQUFNLGNBQWMsR0FBRyxnQkFBZ0IsQ0FBQyxJQUFJLENBQzFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsUUFBUSxDQUFDLElBQUksS0FBSyxRQUFRLElBQUksUUFBUSxDQUFDLElBQUksS0FBSyxTQUFVLENBQUMsSUFBSSxDQUM1RSxDQUFDO1lBQ0YsSUFBSSxjQUFjLEVBQUUsQ0FBQztnQkFDbkIsTUFBTSxDQUFDLEtBQUssQ0FBQyxjQUFjLENBQUMsQ0FBQztnQkFDN0IsTUFBTSxJQUFJLEtBQUssQ0FBQyw4QkFBOEIsQ0FBQyxDQUFDO1lBQ2xELENBQUM7WUFDRCxnQkFBZ0IsQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDdEMsQ0FBQzthQUFNLENBQUM7WUFDTixnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDbkMsQ0FBQztRQUVELElBQUksVUFBVSxLQUFLLDBFQUFVLENBQUMsTUFBTSxFQUFFLENBQUM7WUFDckMsTUFBTSxJQUFJLENBQUMseUJBQXlCLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztZQUN2RCxNQUFNLElBQUksQ0FBQyw0QkFBNEIsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1FBQzVELENBQUM7YUFBTSxDQUFDO1lBQ04sTUFBTSxJQUFJLENBQUMsNEJBQTRCLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztZQUMxRCxNQUFNLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1FBQ3pELENBQUM7SUFDSCxDQUFDO0lBRUQ7Ozs7O09BS0c7SUFDSCxLQUFLLENBQUMsa0JBQWtCLENBQUMsUUFBZ0IsRUFBRSxjQUE2QixFQUFFLElBQWdCO1FBQ3hGLE1BQU0sVUFBVSxHQUNkLElBQUksS0FBSywwRUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLHdCQUF3QixFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQywyQkFBMkIsRUFBRSxDQUFDO1FBRXBHLElBQUksTUFBTSxHQUFrQixJQUFJLENBQUM7UUFFakMsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLFVBQVUsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQztZQUMzQyxNQUFNLElBQUksR0FBRyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDM0IsSUFBSSxJQUFJLENBQUMsSUFBSSxLQUFLLFFBQVEsSUFBSyxJQUFJLENBQUMsS0FBZ0IsQ0FBQyxFQUFFLEtBQUssUUFBUSxFQUFFLENBQUM7Z0JBQ3JFLE1BQU0sR0FBRyxJQUFJLENBQUMsS0FBZSxDQUFDO2dCQUM5QixVQUFVLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztnQkFDeEIsTUFBTTtZQUNSLENBQUM7aUJBQU0sSUFBSSxJQUFJLENBQUMsSUFBSSxLQUFLLFFBQVEsRUFBRSxDQUFDO2dCQUNsQyxNQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsS0FBaUIsQ0FBQztnQkFDdkMsTUFBTSxVQUFVLEdBQUcsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLEtBQUssUUFBUSxDQUFDLENBQUM7Z0JBQzdELElBQUksVUFBVSxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUM7b0JBQ3RCLE1BQU0sR0FBRyxPQUFPLENBQUMsVUFBVSxDQUFDLENBQUM7b0JBQzdCLE9BQU8sQ0FBQyxNQUFNLENBQUMsVUFBVSxFQUFFLENBQUMsQ0FBQyxDQUFDO29CQUM5QixNQUFNO2dCQUNSLENBQUM7WUFDSCxDQUFDO1FBQ0gsQ0FBQztRQUVELElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztZQUNaLE1BQU0sSUFBSSxLQUFLLENBQUMsdUJBQXVCLENBQUMsQ0FBQztRQUMzQyxDQUFDO1FBRUQsSUFBSSxjQUFjLEtBQUssSUFBSSxFQUFFLENBQUM7WUFDNUIsVUFBVSxDQUFDLElBQUksQ0FBQztnQkFDZCxJQUFJLEVBQUUsUUFBUTtnQkFDZCxLQUFLLEVBQUUsTUFBTTthQUNkLENBQUMsQ0FBQztRQUNMLENBQUM7YUFBTSxDQUFDO1lBQ04sTUFBTSxZQUFZLEdBQUcsVUFBVSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxJQUFJLEtBQUssUUFBUSxJQUFJLElBQUksQ0FBQyxFQUFFLEtBQUssY0FBYyxDQUFDLENBQUM7WUFDbkcsSUFBSSxDQUFDLFlBQVksRUFBRSxDQUFDO2dCQUNsQixNQUFNLElBQUksS0FBSyxDQUFDLDBCQUEwQixDQUFDLENBQUM7WUFDOUMsQ0FBQztZQUVELE1BQU0sYUFBYSxHQUFHLFlBQVksQ0FBQyxLQUFpQixDQUFDO1lBQ3JELE1BQU0sY0FBYyxHQUFHLGFBQWEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxLQUFLLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUN2RSxJQUFJLGNBQWMsRUFBRSxDQUFDO2dCQUNuQixNQUFNLElBQUksS0FBSyxDQUFDLDZCQUE2QixDQUFDLENBQUM7WUFDakQsQ0FBQztZQUVELGFBQWEsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDN0IsQ0FBQztRQUVELElBQUksSUFBSSxLQUFLLDBFQUFVLENBQUMsTUFBTSxFQUFFLENBQUM7WUFDL0IsTUFBTSxJQUFJLENBQUMseUJBQXlCLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDbkQsQ0FBQzthQUFNLENBQUM7WUFDTixNQUFNLElBQUksQ0FBQyw0QkFBNEIsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUN0RCxDQUFDO0lBQ0gsQ0FBQztJQUVEOzs7O09BSUc7SUFDSCxnQkFBZ0IsQ0FBQyxRQUFnQixFQUFFLElBQWdCO1FBQ2pELE1BQU0sVUFBVSxHQUNkLElBQUksS0FBSywwRUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLHdCQUF3QixFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQywyQkFBMkIsRUFBRSxDQUFDO1FBRXBHLE1BQU0sTUFBTSxHQUFHLFVBQVUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsSUFBSSxLQUFLLFFBQVEsSUFBSSxJQUFJLENBQUMsRUFBRSxLQUFLLFFBQVEsQ0FBQyxDQUFDO1FBRXZGLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztZQUNaLE9BQU8sRUFBRSxDQUFDO1FBQ1osQ0FBQztRQUVELE9BQU8sTUFBTSxDQUFDLEtBQWlCLENBQUM7SUFDbEMsQ0FBQztJQUVEOzs7T0FHRztJQUNILGNBQWMsQ0FBQyxJQUFnQjtRQUM3QixNQUFNLFVBQVUsR0FDZCxJQUFJLEtBQUssMEVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyx3QkFBd0IsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsMkJBQTJCLEVBQUUsQ0FBQztRQUVwRyxPQUFPLFVBQVUsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsSUFBSSxLQUFLLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxLQUFlLENBQUMsQ0FBQztJQUM3RixDQUFDO0lBRUQ7OztPQUdHO0lBQ0gsVUFBVSxDQUFDLElBQWdCO1FBQ3pCLE1BQU0sVUFBVSxHQUNkLElBQUksS0FBSywwRUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLHdCQUF3QixFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQywyQkFBMkIsRUFBRSxDQUFDO1FBRXBHLE9BQU8sVUFBVSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxJQUFJLEtBQUssUUFBUSxDQUFDLENBQUM7SUFDM0QsQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0gsS0FBSyxDQUFDLG1CQUFtQixDQUFDLFFBQWdCLEVBQUUsSUFBZ0IsRUFBRSxNQUFlO1FBQzNFLE1BQU0sVUFBVSxHQUNkLElBQUksS0FBSywwRUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLHdCQUF3QixFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQywyQkFBMkIsRUFBRSxDQUFDO1FBRXBHLE1BQU0sTUFBTSxHQUFHLFVBQVUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsSUFBSSxLQUFLLFFBQVEsSUFBSSxJQUFJLENBQUMsRUFBRSxLQUFLLFFBQVEsQ0FBQyxDQUFDO1FBQ3ZGLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztZQUNaLE1BQU0sSUFBSSxLQUFLLENBQUMsd0JBQXdCLENBQUMsQ0FBQztRQUM1QyxDQUFDO1FBRUQsTUFBTSxPQUFPLEdBQUcsTUFBTSxDQUFDLEtBQWlCLENBQUM7UUFDekMsSUFBSSxVQUFVLEdBQUcsS0FBSyxDQUFDO1FBRXZCLEtBQUssTUFBTSxNQUFNLElBQUksT0FBTyxFQUFFLENBQUM7WUFDN0IsSUFBSSxNQUFNLENBQUMsT0FBTyxLQUFLLE1BQU0sRUFBRSxDQUFDO2dCQUM5QixNQUFNLENBQUMsT0FBTyxHQUFHLE1BQU0sQ0FBQztnQkFDeEIsVUFBVSxHQUFHLElBQUksQ0FBQztZQUNwQixDQUFDO1FBQ0gsQ0FBQztRQUVELElBQUksVUFBVSxFQUFFLENBQUM7WUFDZixJQUFJLElBQUksS0FBSywwRUFBVSxDQUFDLE1BQU0sRUFBRSxDQUFDO2dCQUMvQixNQUFNLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyxVQUFVLENBQUMsQ0FBQztZQUNuRCxDQUFDO2lCQUFNLENBQUM7Z0JBQ04sTUFBTSxJQUFJLENBQUMsNEJBQTRCLENBQUMsVUFBVSxDQUFDLENBQUM7WUFDdEQsQ0FBQztRQUNILENBQUM7SUFDSCxDQUFDO0lBRUQ7Ozs7O09BS0c7SUFDSCxxQkFBcUIsQ0FBQyxRQUFnQixFQUFFLElBQWdCO1FBQ3RELE1BQU0sT0FBTyxHQUFHLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFFdEQsSUFBSSxPQUFPLENBQUMsTUFBTSxLQUFLLENBQUMsRUFBRSxDQUFDO1lBQ3pCLE9BQU8sTUFBTSxDQUFDO1FBQ2hCLENBQUM7UUFFRCxNQUFNLFlBQVksR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLE1BQU0sQ0FBQztRQUVyRSxJQUFJLFlBQVksS0FBSyxDQUFDLEVBQUUsQ0FBQztZQUN2QixPQUFPLE1BQU0sQ0FBQztRQUNoQixDQUFDO2FBQU0sQ0FBQztZQUNOLE9BQU8sS0FBSyxDQUFDO1FBQ2YsQ0FBQztJQUNILENBQUM7Q0FDRjtBQUVEOzs7R0FHRztBQUNJLEtBQUssVUFBVSxvQkFBb0IsQ0FBQyxFQUFFLFNBQVMsRUFBc0I7SUFDMUUsTUFBTSxNQUFNLEdBQUcsU0FBUyxFQUFFLFNBQVMsRUFBRSxNQUFNLENBQUM7SUFDNUMsTUFBTSxxQkFBcUIsR0FBRywwRUFBZSxDQUFDLGdDQUFnQyxDQUFDLElBQUksRUFBRSxDQUFDO0lBQ3RGLElBQUksTUFBTSxFQUFFLENBQUM7UUFDWCxZQUFZLENBQUMsVUFBVSxDQUFDLGVBQWUsTUFBTSxFQUFFLENBQUMsQ0FBQztRQUNqRCxJQUFJLHFCQUFxQixFQUFFLFFBQVEsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDO1lBQzVDLE1BQU0sS0FBSyxHQUFHLHFCQUFxQixDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUNwRCxJQUFJLEtBQUssS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDO2dCQUNqQixxQkFBcUIsQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFDO2dCQUN2QywyRUFBZ0IsQ0FBQyxnQ0FBZ0MsRUFBRSxxQkFBcUIsQ0FBQyxDQUFDO1lBQzVFLENBQUM7UUFDSCxDQUFDO0lBQ0gsQ0FBQztBQUNILENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L2RhdGEudHM/MzY5OCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBleHRyYWN0U2NyaXB0c0Zyb21SZXBvc2l0b3J5LFxuICBnZXRPcHBvc2l0ZVNjcmlwdFR5cGUsXG4gIGlzU2NyaXB0LFxuICBpc1NjcmlwdFJlcG9zaXRvcnlJdGVtLFxuICBTY3JpcHQsXG4gIFNjcmlwdFJlcG9zaXRvcnlJdGVtLFxuICBTY3JpcHRUeXBlLFxufSBmcm9tICdAL2NvbXBvbmVudC9zY3JpcHRfcmVwb3NpdG9yeS90eXBlcyc7XG5pbXBvcnQgeyBnZXRTZXR0aW5nVmFsdWUsIHNhdmVTZXR0aW5nVmFsdWUgfSBmcm9tICdAL3V0aWwvZXh0ZW5zaW9uX3ZhcmlhYmxlcyc7XG5pbXBvcnQgeyBjaGFyYWN0ZXJzLCB0aGlzX2NoaWQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0JztcbmltcG9ydCB7IHdyaXRlRXh0ZW5zaW9uRmllbGQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9leHRlbnNpb25zJztcbmltcG9ydCB7IHV1aWR2NCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3V0aWxzJztcblxuaW1wb3J0IGxvZyBmcm9tICdsb2dsZXZlbCc7XG5cbi8qKlxuICog6ISa5pys5pWw5o2u566h55CG57G7XG4gKi9cbmV4cG9ydCBjbGFzcyBTY3JpcHREYXRhIHtcbiAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2U6IFNjcmlwdERhdGE7XG4gIHByaXZhdGUgZ2xvYmFsU2NyaXB0czogU2NyaXB0W10gPSBbXTtcbiAgcHJpdmF0ZSBjaGFyYWN0ZXJTY3JpcHRzOiBTY3JpcHRbXSA9IFtdO1xuICBwcml2YXRlIF9pc0dsb2JhbFNjcmlwdEVuYWJsZWQ6IGJvb2xlYW4gPSBmYWxzZTtcbiAgcHJpdmF0ZSBfaXNDaGFyYWN0ZXJTY3JpcHRFbmFibGVkOiBib29sZWFuID0gZmFsc2U7XG5cbiAgcHJpdmF0ZSBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmxvYWRTY3JpcHRzKCk7XG4gIH1cblxuICBwdWJsaWMgZ2V0IGlzR2xvYmFsU2NyaXB0RW5hYmxlZCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5faXNHbG9iYWxTY3JpcHRFbmFibGVkO1xuICB9XG5cbiAgcHVibGljIGdldCBpc0NoYXJhY3RlclNjcmlwdEVuYWJsZWQoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuX2lzQ2hhcmFjdGVyU2NyaXB0RW5hYmxlZDtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgZ2V0SW5zdGFuY2UoKTogU2NyaXB0RGF0YSB7XG4gICAgaWYgKCFTY3JpcHREYXRhLmluc3RhbmNlKSB7XG4gICAgICBTY3JpcHREYXRhLmluc3RhbmNlID0gbmV3IFNjcmlwdERhdGEoKTtcbiAgICB9XG4gICAgcmV0dXJuIFNjcmlwdERhdGEuaW5zdGFuY2U7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIGRlc3Ryb3lJbnN0YW5jZSgpOiB2b2lkIHtcbiAgICBpZiAoU2NyaXB0RGF0YS5pbnN0YW5jZSkge1xuICAgICAgU2NyaXB0RGF0YS5pbnN0YW5jZSA9IHVuZGVmaW5lZCBhcyB1bmtub3duIGFzIFNjcmlwdERhdGE7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOajgOafpeW9k+WJjeinkuiJsuaYr+WQpuWQr+eUqOS6huiEmuacrOW6k1xuICAgKiBAcmV0dXJucyDop5LoibLohJrmnKzlupPmmK/lkKblkK/nlKhcbiAgICovXG4gIHB1YmxpYyBjaGVja0NoYXJhY3RlclNjcmlwdEVuYWJsZWQoKTogYm9vbGVhbiB7XG4gICAgY29uc3QgY2hhcmFjdGVyc1dpdGhTY3JpcHRzID0gZ2V0U2V0dGluZ1ZhbHVlKCdzY3JpcHQuY2hhcmFjdGVyc193aXRoX3NjcmlwdHMnKSB8fCBbXTtcbiAgICAvL0B0cy1pZ25vcmVcbiAgICBjb25zdCBhdmF0YXIgPSBjaGFyYWN0ZXJzPy5bdGhpc19jaGlkXT8uYXZhdGFyO1xuICAgIHJldHVybiBjaGFyYWN0ZXJzV2l0aFNjcmlwdHM/LmluY2x1ZGVzKGF2YXRhcikgfHwgZmFsc2U7XG4gIH1cblxuICAvKipcbiAgICog5Yqg6L296ISa5pys5bqT5Y6f5aeL5pWw5o2u77yM5pSv5oyB5paw5pen5pWw5o2u57uT5p6E5YW85a65XG4gICAqL1xuICBsb2FkU2NyaXB0cygpIHtcbiAgICBjb25zdCByYXdHbG9iYWxSZXBvc2l0b3J5ID0gZ2V0U2V0dGluZ1ZhbHVlKCdzY3JpcHQuc2NyaXB0c1JlcG9zaXRvcnknKSB8fCBbXTtcbiAgICB0aGlzLmdsb2JhbFNjcmlwdHMgPSB0aGlzLm1pZ3JhdGVBbmRFeHRyYWN0U2NyaXB0cyhyYXdHbG9iYWxSZXBvc2l0b3J5LCBTY3JpcHRUeXBlLkdMT0JBTCk7XG4gICAgLy9AdHMtaWdub3JlXG4gICAgY29uc3QgcmF3Q2hhcmFjdGVyUmVwb3NpdG9yeSA9IGNoYXJhY3RlcnNbdGhpc19jaGlkXT8uZGF0YT8uZXh0ZW5zaW9ucz8uVGF2ZXJuSGVscGVyX3NjcmlwdHMgfHwgW107XG4gICAgdGhpcy5jaGFyYWN0ZXJTY3JpcHRzID0gdGhpcy5taWdyYXRlQW5kRXh0cmFjdFNjcmlwdHMocmF3Q2hhcmFjdGVyUmVwb3NpdG9yeSwgU2NyaXB0VHlwZS5DSEFSQUNURVIpO1xuXG4gICAgdGhpcy5faXNHbG9iYWxTY3JpcHRFbmFibGVkID0gZ2V0U2V0dGluZ1ZhbHVlKCdzY3JpcHQuZ2xvYmFsX3NjcmlwdF9lbmFibGVkJykgPz8gZmFsc2U7XG4gICAgdGhpcy5faXNDaGFyYWN0ZXJTY3JpcHRFbmFibGVkID0gdGhpcy5jaGVja0NoYXJhY3RlclNjcmlwdEVuYWJsZWQoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmo4Dmn6Xlubbov4Hnp7vmlbDmja7nu5PmnoTvvIznoa7kv53lkJHlkI7lhbzlrrlcbiAgICogQHBhcmFtIHJlcG9zaXRvcnkg5Y6f5aeL5LuT5bqT5pWw5o2uXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKiBAcmV0dXJucyDmj5Dlj5bnmoTohJrmnKzmlbDnu4RcbiAgICovXG4gIHByaXZhdGUgbWlncmF0ZUFuZEV4dHJhY3RTY3JpcHRzKHJlcG9zaXRvcnk6IGFueVtdLCB0eXBlOiBTY3JpcHRUeXBlKTogU2NyaXB0W10ge1xuICAgIGlmICghQXJyYXkuaXNBcnJheShyZXBvc2l0b3J5KSkge1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cblxuICAgIGxldCBuZWVkc01pZ3JhdGlvbiA9IGZhbHNlO1xuICAgIGNvbnN0IG1pZ3JhdGVkUmVwb3NpdG9yeTogU2NyaXB0UmVwb3NpdG9yeUl0ZW1bXSA9IFtdO1xuXG4gICAgZm9yIChjb25zdCBpdGVtIG9mIHJlcG9zaXRvcnkpIHtcbiAgICAgIGlmIChpc1NjcmlwdChpdGVtKSkge1xuICAgICAgICBuZWVkc01pZ3JhdGlvbiA9IHRydWU7XG4gICAgICAgIG1pZ3JhdGVkUmVwb3NpdG9yeS5wdXNoKHtcbiAgICAgICAgICB0eXBlOiAnc2NyaXB0JyxcbiAgICAgICAgICB2YWx1ZTogbmV3IFNjcmlwdChpdGVtKSxcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2UgaWYgKGlzU2NyaXB0UmVwb3NpdG9yeUl0ZW0oaXRlbSkpIHtcbiAgICAgICAgaWYgKGl0ZW0udHlwZSA9PT0gJ3NjcmlwdCcpIHtcbiAgICAgICAgICBtaWdyYXRlZFJlcG9zaXRvcnkucHVzaCh7XG4gICAgICAgICAgICB0eXBlOiAnc2NyaXB0JyxcbiAgICAgICAgICAgIHZhbHVlOiBuZXcgU2NyaXB0KGl0ZW0udmFsdWUgYXMgUGFydGlhbDxTY3JpcHQ+KSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIGlmIChpdGVtLnR5cGUgPT09ICdmb2xkZXInKSB7XG4gICAgICAgICAgbWlncmF0ZWRSZXBvc2l0b3J5LnB1c2goe1xuICAgICAgICAgICAgdHlwZTogJ2ZvbGRlcicsXG4gICAgICAgICAgICBpZDogaXRlbS5pZCxcbiAgICAgICAgICAgIG5hbWU6IGl0ZW0ubmFtZSxcbiAgICAgICAgICAgIGljb246IGl0ZW0uaWNvbiB8fCAnZmEtZm9sZGVyJyxcbiAgICAgICAgICAgIGNvbG9yOiBpdGVtLmNvbG9yIHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCctLVNtYXJ0VGhlbWVCb2R5Q29sb3InKSxcbiAgICAgICAgICAgIHZhbHVlOiBBcnJheS5pc0FycmF5KGl0ZW0udmFsdWUpID8gaXRlbS52YWx1ZS5tYXAoKHM6IGFueSkgPT4gbmV3IFNjcmlwdChzKSkgOiBbXSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbG9nLndhcm4oJ1tTY3JpcHRNYW5hZ2VyXSDml6Dms5Xop6PmnpDnmoTohJrmnKzmlbDmja46JywgaXRlbSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKG5lZWRzTWlncmF0aW9uKSB7XG4gICAgICB0aGlzLnNhdmVNaWdyYXRlZFJlcG9zaXRvcnkobWlncmF0ZWRSZXBvc2l0b3J5LCB0eXBlKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZXh0cmFjdFNjcmlwdHNGcm9tUmVwb3NpdG9yeShtaWdyYXRlZFJlcG9zaXRvcnkpO1xuICB9XG5cbiAgLyoqXG4gICAqIOS/neWtmOi/geenu+WQjueahOS7k+W6k+aVsOaNrlxuICAgKiBAcGFyYW0gcmVwb3NpdG9yeSDov4Hnp7vlkI7nmoTku5PlupPmlbDmja5cbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHNhdmVNaWdyYXRlZFJlcG9zaXRvcnkocmVwb3NpdG9yeTogU2NyaXB0UmVwb3NpdG9yeUl0ZW1bXSwgdHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBpZiAodHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwpIHtcbiAgICAgICAgc2F2ZVNldHRpbmdWYWx1ZSgnc2NyaXB0LnNjcmlwdHNSZXBvc2l0b3J5JywgcmVwb3NpdG9yeSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoIXRoaXNfY2hpZCkge1xuICAgICAgICAgIGxvZy53YXJuKCdbU2NyaXB0TWFuYWdlcl0g5peg5rOV5L+d5a2Y6KeS6Imy6ISa5pys6L+B56e75pWw5o2u77ya5b2T5YmN6KeS6Imy5Li656m6Jyk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICBhd2FpdCB3cml0ZUV4dGVuc2lvbkZpZWxkKHRoaXNfY2hpZCwgJ1RhdmVybkhlbHBlcl9zY3JpcHRzJywgcmVwb3NpdG9yeSk7XG4gICAgICB9XG4gICAgICBsb2cuaW5mbyhgW1NjcmlwdE1hbmFnZXJdIOaIkOWKn+i/geenuyR7dHlwZX3ohJrmnKzmlbDmja7nu5PmnoRgKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nLmVycm9yKGBbU2NyaXB0TWFuYWdlcl0g6L+B56e7JHt0eXBlfeiEmuacrOaVsOaNruWksei0pTpgLCBlcnJvcik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluWFqOWxgOiEmuacrOWIl+ihqFxuICAgKi9cbiAgZ2V0R2xvYmFsU2NyaXB0cygpOiBTY3JpcHRbXSB7XG4gICAgcmV0dXJuIHRoaXMuZ2xvYmFsU2NyaXB0cztcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5bop5LoibLohJrmnKzliJfooahcbiAgICovXG4gIGdldENoYXJhY3RlclNjcmlwdHMoKTogU2NyaXB0W10ge1xuICAgIC8vQHRzLWlnbm9yZVxuICAgIGNvbnN0IHJhd0NoYXJhY3RlclJlcG9zaXRvcnkgPSBjaGFyYWN0ZXJzW3RoaXNfY2hpZF0/LmRhdGE/LmV4dGVuc2lvbnM/LlRhdmVybkhlbHBlcl9zY3JpcHRzIHx8IFtdO1xuICAgIHRoaXMuY2hhcmFjdGVyU2NyaXB0cyA9IHRoaXMubWlncmF0ZUFuZEV4dHJhY3RTY3JpcHRzKHJhd0NoYXJhY3RlclJlcG9zaXRvcnksIFNjcmlwdFR5cGUuQ0hBUkFDVEVSKTtcbiAgICByZXR1cm4gdGhpcy5jaGFyYWN0ZXJTY3JpcHRzO1xuICB9XG5cbiAgLyoqXG4gICAqIOagueaNrklE6I635Y+W6ISa5pysXG4gICAqIEBwYXJhbSBpZCDohJrmnKxJRFxuICAgKiBAcmV0dXJucyDohJrmnKzlr7nosaHvvIzlpoLmnpzkuI3lrZjlnKjliJnov5Tlm551bmRlZmluZWRcbiAgICovXG4gIGdldFNjcmlwdEJ5SWQoaWQ6IHN0cmluZyk6IFNjcmlwdCB8IHVuZGVmaW5lZCB7XG4gICAgbGV0IHNjcmlwdCA9IHRoaXMuZ2xvYmFsU2NyaXB0cy5maW5kKChzOiBTY3JpcHQpID0+IHMuaWQgPT09IGlkKTtcbiAgICBpZiAoc2NyaXB0KSByZXR1cm4gc2NyaXB0O1xuXG4gICAgc2NyaXB0ID0gdGhpcy5jaGFyYWN0ZXJTY3JpcHRzLmZpbmQoKHM6IFNjcmlwdCkgPT4gcy5pZCA9PT0gaWQpO1xuICAgIGlmIChzY3JpcHQpIHJldHVybiBzY3JpcHQ7XG5cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgLyoqXG4gICAqIOS/neWtmOWNleS4quiEmuacrOWIsOiuvue9ruS4re+8jOS4jeWtmOWcqOWImea3u+WKoOWIsOacq+Wwvu+8jOWtmOWcqOWImeimhuebllxuICAgKiBAcGFyYW0gc2NyaXB0IOiEmuacrFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIGFzeW5jIHNhdmVTY3JpcHQoc2NyaXB0OiBTY3JpcHQsIHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAoIXNjcmlwdC5uYW1lIHx8IHNjcmlwdC5uYW1lLnRyaW0oKSA9PT0gJycpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignW1NjcmlwdE1hbmFnZXJdIOS/neWtmOWksei0pe+8jOiEmuacrOWQjeensOS4uuepuicpO1xuICAgIH1cblxuICAgIGNvbnN0IHJhd1JlcG9zaXRvcnkgPVxuICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUxcbiAgICAgICAgPyBnZXRTZXR0aW5nVmFsdWUoJ3NjcmlwdC5zY3JpcHRzUmVwb3NpdG9yeScpIHx8IFtdXG4gICAgICAgIDogLy9AdHMtaWdub3JlXG4gICAgICAgICAgY2hhcmFjdGVyc1t0aGlzX2NoaWRdPy5kYXRhPy5leHRlbnNpb25zPy5UYXZlcm5IZWxwZXJfc2NyaXB0cyB8fCBbXTtcblxuICAgIGNvbnN0IHJlcG9zaXRvcnkgPSB0aGlzLmVuc3VyZVJlcG9zaXRvcnlTdHJ1Y3R1cmUocmF3UmVwb3NpdG9yeSk7XG5cbiAgICBsZXQgZm91bmRJbmRleCA9IC0xO1xuICAgIGxldCBmb3VuZEluRm9sZGVyID0gZmFsc2U7XG4gICAgbGV0IGZvbGRlckluZGV4ID0gLTE7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlcG9zaXRvcnkubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGl0ZW0gPSByZXBvc2l0b3J5W2ldO1xuICAgICAgaWYgKGl0ZW0udHlwZSA9PT0gJ3NjcmlwdCcgJiYgKGl0ZW0udmFsdWUgYXMgU2NyaXB0KS5pZCA9PT0gc2NyaXB0LmlkKSB7XG4gICAgICAgIGZvdW5kSW5kZXggPSBpO1xuICAgICAgICBicmVhaztcbiAgICAgIH0gZWxzZSBpZiAoaXRlbS50eXBlID09PSAnZm9sZGVyJykge1xuICAgICAgICBjb25zdCBzY3JpcHRzID0gaXRlbS52YWx1ZSBhcyBTY3JpcHRbXTtcbiAgICAgICAgY29uc3Qgc2NyaXB0SW5kZXggPSBzY3JpcHRzLmZpbmRJbmRleChzID0+IHMuaWQgPT09IHNjcmlwdC5pZCk7XG4gICAgICAgIGlmIChzY3JpcHRJbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICBmb3VuZEluRm9sZGVyID0gdHJ1ZTtcbiAgICAgICAgICBmb2xkZXJJbmRleCA9IGk7XG4gICAgICAgICAgZm91bmRJbmRleCA9IHNjcmlwdEluZGV4O1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGZvdW5kSW5Gb2xkZXIgJiYgZm9sZGVySW5kZXggPj0gMCkge1xuICAgICAgY29uc3QgZm9sZGVyID0gcmVwb3NpdG9yeVtmb2xkZXJJbmRleF07XG4gICAgICAoZm9sZGVyLnZhbHVlIGFzIFNjcmlwdFtdKVtmb3VuZEluZGV4XSA9IHNjcmlwdDtcbiAgICB9IGVsc2UgaWYgKGZvdW5kSW5kZXggPj0gMCkge1xuICAgICAgKHJlcG9zaXRvcnlbZm91bmRJbmRleF0udmFsdWUgYXMgU2NyaXB0KSA9IHNjcmlwdDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVwb3NpdG9yeS5wdXNoKHtcbiAgICAgICAgdHlwZTogJ3NjcmlwdCcsXG4gICAgICAgIHZhbHVlOiBzY3JpcHQsXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAodHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwpIHtcbiAgICAgIGF3YWl0IHRoaXMuc2F2ZUdsb2JhbFJlcG9zaXRvcnlJdGVtcyhyZXBvc2l0b3J5KTtcbiAgICB9IGVsc2Uge1xuICAgICAgYXdhaXQgdGhpcy5zYXZlQ2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKHJlcG9zaXRvcnkpO1xuICAgIH1cblxuICAgIHRoaXMubG9hZFNjcmlwdHMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDnoa7kv53ku5PlupPkvb/nlKjmlrDnmoTmlbDmja7nu5PmnoRcbiAgICogQHBhcmFtIHJhd1JlcG9zaXRvcnkg5Y6f5aeL5LuT5bqT5pWw5o2uXG4gICAqIEByZXR1cm5zIOinhOiMg+WMlueahOS7k+W6k+aVsOaNrlxuICAgKi9cbiAgcHJpdmF0ZSBlbnN1cmVSZXBvc2l0b3J5U3RydWN0dXJlKHJhd1JlcG9zaXRvcnk6IGFueVtdKTogU2NyaXB0UmVwb3NpdG9yeUl0ZW1bXSB7XG4gICAgY29uc3QgcmVwb3NpdG9yeTogU2NyaXB0UmVwb3NpdG9yeUl0ZW1bXSA9IFtdO1xuXG4gICAgZm9yIChjb25zdCBpdGVtIG9mIHJhd1JlcG9zaXRvcnkpIHtcbiAgICAgIGlmIChpc1NjcmlwdChpdGVtKSkge1xuICAgICAgICByZXBvc2l0b3J5LnB1c2goe1xuICAgICAgICAgIHR5cGU6ICdzY3JpcHQnLFxuICAgICAgICAgIHZhbHVlOiBuZXcgU2NyaXB0KGl0ZW0pLFxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSBpZiAoaXNTY3JpcHRSZXBvc2l0b3J5SXRlbShpdGVtKSkge1xuICAgICAgICBpZiAoaXRlbS50eXBlID09PSAnc2NyaXB0Jykge1xuICAgICAgICAgIHJlcG9zaXRvcnkucHVzaCh7XG4gICAgICAgICAgICB0eXBlOiAnc2NyaXB0JyxcbiAgICAgICAgICAgIHZhbHVlOiBuZXcgU2NyaXB0KGl0ZW0udmFsdWUgYXMgUGFydGlhbDxTY3JpcHQ+KSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIGlmIChpdGVtLnR5cGUgPT09ICdmb2xkZXInKSB7XG4gICAgICAgICAgaWYgKCFpdGVtLmljb24pIHtcbiAgICAgICAgICAgIGl0ZW0uaWNvbiA9ICdmYS1mb2xkZXInO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoIWl0ZW0uY29sb3IpIHtcbiAgICAgICAgICAgIGl0ZW0uY29sb3IgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnLS1TbWFydFRoZW1lQm9keUNvbG9yJyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJlcG9zaXRvcnkucHVzaCh7XG4gICAgICAgICAgICAuLi5pdGVtLFxuICAgICAgICAgICAgdmFsdWU6IEFycmF5LmlzQXJyYXkoaXRlbS52YWx1ZSkgPyBpdGVtLnZhbHVlLm1hcCgoczogYW55KSA9PiBuZXcgU2NyaXB0KHMpKSA6IFtdLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIHJlcG9zaXRvcnkucHVzaCh7XG4gICAgICAgICAgICB0eXBlOiAnc2NyaXB0JyxcbiAgICAgICAgICAgIHZhbHVlOiBuZXcgU2NyaXB0KGl0ZW0pLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGxvZy53YXJuKCdbU2NyaXB0TWFuYWdlcl0g5peg5rOV6Kej5p6Q55qE6ISa5pys5pWw5o2uOicsIGl0ZW0sIGVycm9yKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiByZXBvc2l0b3J5O1xuICB9XG5cbiAgLyoqXG4gICAqIOS/neWtmOWFqOWxgOiEmuacrOaVsOe7hOWIsOaJqeWxleiuvue9rlxuICAgKiBAcGFyYW0gYXJyYXkg6ISa5pys5pWw57uEXG4gICAqL1xuICBhc3luYyBzYXZlR2xvYmFsU2NyaXB0cyhhcnJheTogU2NyaXB0W10pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBzYXZlU2V0dGluZ1ZhbHVlKCdzY3JpcHQuc2NyaXB0c1JlcG9zaXRvcnknLCBhcnJheSk7XG4gICAgdGhpcy5nbG9iYWxTY3JpcHRzID0gYXJyYXk7XG4gIH1cblxuICAvKipcbiAgICog5L+d5a2Y6ISa5pys5pWw57uE5Yiw6KeS6Imy5Y2h5pWw5o2uXG4gICAqIEBwYXJhbSBhcnJheSDohJrmnKzmlbDnu4RcbiAgICovXG4gIGFzeW5jIHNhdmVDaGFyYWN0ZXJTY3JpcHRzKGFycmF5OiBTY3JpcHRbXSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICghdGhpc19jaGlkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDkv53lrZjlpLHotKXvvIzlvZPliY3op5LoibLkuLrnqbonKTtcbiAgICB9XG5cbiAgICAvL0B0cy1pZ25vcmVcbiAgICBhd2FpdCB3cml0ZUV4dGVuc2lvbkZpZWxkKHRoaXNfY2hpZCwgJ1RhdmVybkhlbHBlcl9zY3JpcHRzJywgYXJyYXkpO1xuXG4gICAgdGhpcy5jaGFyYWN0ZXJTY3JpcHRzID0gYXJyYXk7XG4gIH1cblxuICAvKipcbiAgICog5L+d5a2Y5YWo5bGA6ISa5pys5LuT5bqT6aG55pWw57uE5Yiw5omp5bGV6K6+572uXG4gICAqIEBwYXJhbSByZXBvc2l0b3J5IOS7k+W6k+mhueaVsOe7hFxuICAgKi9cbiAgYXN5bmMgc2F2ZUdsb2JhbFJlcG9zaXRvcnlJdGVtcyhyZXBvc2l0b3J5OiBTY3JpcHRSZXBvc2l0b3J5SXRlbVtdKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgc2F2ZVNldHRpbmdWYWx1ZSgnc2NyaXB0LnNjcmlwdHNSZXBvc2l0b3J5JywgcmVwb3NpdG9yeSk7XG4gICAgdGhpcy5nbG9iYWxTY3JpcHRzID0gZXh0cmFjdFNjcmlwdHNGcm9tUmVwb3NpdG9yeShyZXBvc2l0b3J5KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDkv53lrZjohJrmnKzku5PlupPpobnmlbDnu4TliLDop5LoibLljaHmlbDmja5cbiAgICogQHBhcmFtIHJlcG9zaXRvcnkg5LuT5bqT6aG55pWw57uEXG4gICAqL1xuICBhc3luYyBzYXZlQ2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKHJlcG9zaXRvcnk6IFNjcmlwdFJlcG9zaXRvcnlJdGVtW10pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAoIXRoaXNfY2hpZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdbU2NyaXB0TWFuYWdlcl0g5L+d5a2Y5aSx6LSl77yM5b2T5YmN6KeS6Imy5Li656m6Jyk7XG4gICAgfVxuICAgIC8vQHRzLWlnbm9yZVxuICAgIGF3YWl0IHdyaXRlRXh0ZW5zaW9uRmllbGQodGhpc19jaGlkLCAnVGF2ZXJuSGVscGVyX3NjcmlwdHMnLCByZXBvc2l0b3J5KTtcblxuICAgIHRoaXMuY2hhcmFjdGVyU2NyaXB0cyA9IGV4dHJhY3RTY3JpcHRzRnJvbVJlcG9zaXRvcnkocmVwb3NpdG9yeSk7XG4gIH1cblxuICAvKipcbiAgICog5LuO6ISa5pys5bqT5Lit5Yig6Zmk6ISa5pysXG4gICAqIEBwYXJhbSBpZCDohJrmnKxJRFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIGFzeW5jIGRlbGV0ZVNjcmlwdChpZDogc3RyaW5nLCB0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgcmVwb3NpdG9yeSA9XG4gICAgICB0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCA/IHRoaXMuZ2V0R2xvYmFsUmVwb3NpdG9yeUl0ZW1zKCkgOiB0aGlzLmdldENoYXJhY3RlclJlcG9zaXRvcnlJdGVtcygpO1xuXG4gICAgbGV0IHNjcmlwdEZvdW5kID0gZmFsc2U7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlcG9zaXRvcnkubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGl0ZW0gPSByZXBvc2l0b3J5W2ldO1xuICAgICAgaWYgKGl0ZW0udHlwZSA9PT0gJ3NjcmlwdCcgJiYgKGl0ZW0udmFsdWUgYXMgU2NyaXB0KS5pZCA9PT0gaWQpIHtcbiAgICAgICAgcmVwb3NpdG9yeS5zcGxpY2UoaSwgMSk7XG4gICAgICAgIHNjcmlwdEZvdW5kID0gdHJ1ZTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9IGVsc2UgaWYgKGl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicpIHtcbiAgICAgICAgY29uc3Qgc2NyaXB0cyA9IGl0ZW0udmFsdWUgYXMgU2NyaXB0W107XG4gICAgICAgIGNvbnN0IGZvdW5kSW5kZXggPSBzY3JpcHRzLmZpbmRJbmRleChzID0+IHMuaWQgPT09IGlkKTtcbiAgICAgICAgaWYgKGZvdW5kSW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgc2NyaXB0cy5zcGxpY2UoZm91bmRJbmRleCwgMSk7XG4gICAgICAgICAgc2NyaXB0Rm91bmQgPSB0cnVlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCFzY3JpcHRGb3VuZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdbU2NyaXB0TWFuYWdlcl0g5Yig6Zmk6ISa5pys5aSx6LSl77yM6ISa5pys5LiN5a2Y5ZyoJyk7XG4gICAgfVxuXG4gICAgaWYgKHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMKSB7XG4gICAgICBhd2FpdCB0aGlzLnNhdmVHbG9iYWxSZXBvc2l0b3J5SXRlbXMocmVwb3NpdG9yeSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGF3YWl0IHRoaXMuc2F2ZUNoYXJhY3RlclJlcG9zaXRvcnlJdGVtcyhyZXBvc2l0b3J5KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5pu05paw6ISa5pys5ZCv55So54q25oCBXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKiBAcGFyYW0gZW5hYmxlIOaYr+WQpuWQr+eUqFxuICAgKi9cbiAgYXN5bmMgdXBkYXRlU2NyaXB0VHlwZUVuYWJsZVN0YXRlKHR5cGU6IFNjcmlwdFR5cGUsIGVuYWJsZTogYm9vbGVhbik6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICh0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCkge1xuICAgICAgc2F2ZVNldHRpbmdWYWx1ZSgnc2NyaXB0Lmdsb2JhbF9zY3JpcHRfZW5hYmxlZCcsIGVuYWJsZSk7XG4gICAgICB0aGlzLl9pc0dsb2JhbFNjcmlwdEVuYWJsZWQgPSBlbmFibGU7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGNoYXJhY3RlcnNXaXRoU2NyaXB0cyA9IGdldFNldHRpbmdWYWx1ZSgnc2NyaXB0LmNoYXJhY3RlcnNfd2l0aF9zY3JpcHRzJykgfHwgW107XG4gICAgICAvL0B0cy1pZ25vcmVcbiAgICAgIGNvbnN0IGF2YXRhciA9IGNoYXJhY3RlcnM/Llt0aGlzX2NoaWRdPy5hdmF0YXI7XG5cbiAgICAgIGlmIChlbmFibGUpIHtcbiAgICAgICAgaWYgKGF2YXRhciAmJiAhY2hhcmFjdGVyc1dpdGhTY3JpcHRzLmluY2x1ZGVzKGF2YXRhcikpIHtcbiAgICAgICAgICBjaGFyYWN0ZXJzV2l0aFNjcmlwdHMucHVzaChhdmF0YXIpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBpbmRleCA9IGNoYXJhY3RlcnNXaXRoU2NyaXB0cy5pbmRleE9mKGF2YXRhcik7XG4gICAgICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICBjaGFyYWN0ZXJzV2l0aFNjcmlwdHMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBzYXZlU2V0dGluZ1ZhbHVlKCdzY3JpcHQuY2hhcmFjdGVyc193aXRoX3NjcmlwdHMnLCBjaGFyYWN0ZXJzV2l0aFNjcmlwdHMpO1xuICAgICAgdGhpcy5faXNDaGFyYWN0ZXJTY3JpcHRFbmFibGVkID0gZW5hYmxlO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5bohJrmnKznmoTnsbvlnotcbiAgICogQHBhcmFtIHNjcmlwdCDohJrmnKzlr7nosaFcbiAgICogQHJldHVybnMg6ISa5pys57G75Z6LXG4gICAqL1xuICBwdWJsaWMgZ2V0U2NyaXB0VHlwZShzY3JpcHQ6IFNjcmlwdCk6IFNjcmlwdFR5cGUge1xuICAgIHJldHVybiB0aGlzLmdsb2JhbFNjcmlwdHMuc29tZShzID0+IHMuaWQgPT09IHNjcmlwdC5pZCkgPyBTY3JpcHRUeXBlLkdMT0JBTCA6IFNjcmlwdFR5cGUuQ0hBUkFDVEVSO1xuICB9XG5cbiAgLyoqXG4gICAqIOWIt+aWsOinkuiJsuiEmuacrOWQr+eUqOeKtuaAgVxuICAgKi9cbiAgcmVmcmVzaENoYXJhY3RlclNjcmlwdEVuYWJsZWRTdGF0ZSgpOiB2b2lkIHtcbiAgICB0aGlzLl9pc0NoYXJhY3RlclNjcmlwdEVuYWJsZWQgPSB0aGlzLmNoZWNrQ2hhcmFjdGVyU2NyaXB0RW5hYmxlZCgpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluWFqOWxgOiEmuacrOS7k+W6k+mhuVxuICAgKi9cbiAgZ2V0R2xvYmFsUmVwb3NpdG9yeUl0ZW1zKCk6IFNjcmlwdFJlcG9zaXRvcnlJdGVtW10ge1xuICAgIGNvbnN0IHJhd1JlcG9zaXRvcnkgPSBnZXRTZXR0aW5nVmFsdWUoJ3NjcmlwdC5zY3JpcHRzUmVwb3NpdG9yeScpIHx8IFtdO1xuICAgIHJldHVybiB0aGlzLmVuc3VyZVJlcG9zaXRvcnlTdHJ1Y3R1cmUocmF3UmVwb3NpdG9yeSk7XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W6KeS6Imy6ISa5pys5LuT5bqT6aG5XG4gICAqL1xuICBnZXRDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMoKTogU2NyaXB0UmVwb3NpdG9yeUl0ZW1bXSB7XG4gICAgLy9AdHMtaWdub3JlXG4gICAgY29uc3QgcmF3UmVwb3NpdG9yeSA9IGNoYXJhY3RlcnNbdGhpc19jaGlkXT8uZGF0YT8uZXh0ZW5zaW9ucz8uVGF2ZXJuSGVscGVyX3NjcmlwdHMgfHwgW107XG4gICAgcmV0dXJuIHRoaXMuZW5zdXJlUmVwb3NpdG9yeVN0cnVjdHVyZShyYXdSZXBvc2l0b3J5KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDliJvlu7rmlofku7blpLlcbiAgICogQHBhcmFtIG5hbWUg5paH5Lu25aS55ZCN56ewXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKiBAcGFyYW0gaWNvbiDmlofku7blpLnlm77moIfvvIjlj6/pgInvvIlcbiAgICogQHBhcmFtIGNvbG9yIOaWh+S7tuWkueminOiJsu+8iOWPr+mAie+8iVxuICAgKiBAcmV0dXJucyDmlrDliJvlu7rnmoTmlofku7blpLlJRFxuICAgKi9cbiAgYXN5bmMgY3JlYXRlRm9sZGVyKG5hbWU6IHN0cmluZywgdHlwZTogU2NyaXB0VHlwZSwgaWNvbj86IHN0cmluZywgY29sb3I/OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGlmICghbmFtZSB8fCBuYW1lLnRyaW0oKSA9PT0gJycpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignW1NjcmlwdE1hbmFnZXJdIOaWh+S7tuWkueWQjeensOS4jeiDveS4uuepuicpO1xuICAgIH1cblxuICAgIGNvbnN0IHJlcG9zaXRvcnkgPVxuICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyB0aGlzLmdldEdsb2JhbFJlcG9zaXRvcnlJdGVtcygpIDogdGhpcy5nZXRDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMoKTtcblxuICAgIGNvbnN0IGV4aXN0aW5nRm9sZGVyID0gcmVwb3NpdG9yeS5maW5kKGl0ZW0gPT4gaXRlbS50eXBlID09PSAnZm9sZGVyJyAmJiBpdGVtLm5hbWUgPT09IG5hbWUudHJpbSgpKTtcbiAgICBpZiAoZXhpc3RpbmdGb2xkZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignW1NjcmlwdE1hbmFnZXJdIOaWh+S7tuWkueWQjeensOW3suWtmOWcqCcpO1xuICAgIH1cblxuICAgIGNvbnN0IGZvbGRlcklkID0gdXVpZHY0KCk7XG4gICAgY29uc3QgbmV3Rm9sZGVyOiBTY3JpcHRSZXBvc2l0b3J5SXRlbSA9IHtcbiAgICAgIHR5cGU6ICdmb2xkZXInLFxuICAgICAgaWQ6IGZvbGRlcklkLFxuICAgICAgbmFtZTogbmFtZS50cmltKCksXG4gICAgICBpY29uOiBpY29uIHx8ICdmYS1mb2xkZXInLFxuICAgICAgY29sb3I6IGNvbG9yIHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCctLVNtYXJ0VGhlbWVCb2R5Q29sb3InKSxcbiAgICAgIHZhbHVlOiBbXSxcbiAgICB9O1xuXG4gICAgcmVwb3NpdG9yeS51bnNoaWZ0KG5ld0ZvbGRlcik7XG5cbiAgICBpZiAodHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwpIHtcbiAgICAgIGF3YWl0IHRoaXMuc2F2ZUdsb2JhbFJlcG9zaXRvcnlJdGVtcyhyZXBvc2l0b3J5KTtcbiAgICB9IGVsc2Uge1xuICAgICAgYXdhaXQgdGhpcy5zYXZlQ2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKHJlcG9zaXRvcnkpO1xuICAgIH1cblxuICAgIHJldHVybiBmb2xkZXJJZDtcbiAgfVxuXG4gIC8qKlxuICAgKiDnvJbovpHmlofku7blpLlcbiAgICogQHBhcmFtIGZvbGRlcklkIOaWh+S7tuWkuUlEXG4gICAqIEBwYXJhbSBuZXdOYW1lIOaWsOWQjeensFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICogQHBhcmFtIG5ld0ljb24g5paw5Zu+5qCHXG4gICAqIEBwYXJhbSBuZXdDb2xvciDmlrDpopzoibJcbiAgICovXG4gIGFzeW5jIGVkaXRGb2xkZXIoXG4gICAgZm9sZGVySWQ6IHN0cmluZyxcbiAgICBuZXdOYW1lOiBzdHJpbmcsXG4gICAgdHlwZTogU2NyaXB0VHlwZSxcbiAgICBuZXdJY29uPzogc3RyaW5nLFxuICAgIG5ld0NvbG9yPzogc3RyaW5nLFxuICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAoIW5ld05hbWUgfHwgbmV3TmFtZS50cmltKCkgPT09ICcnKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDmlofku7blpLnlkI3np7DkuI3og73kuLrnqbonKTtcbiAgICB9XG5cbiAgICBjb25zdCByZXBvc2l0b3J5ID1cbiAgICAgIHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMID8gdGhpcy5nZXRHbG9iYWxSZXBvc2l0b3J5SXRlbXMoKSA6IHRoaXMuZ2V0Q2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKCk7XG5cbiAgICBjb25zdCBmb2xkZXJJbmRleCA9IHJlcG9zaXRvcnkuZmluZEluZGV4KGl0ZW0gPT4gaXRlbS50eXBlID09PSAnZm9sZGVyJyAmJiBpdGVtLmlkID09PSBmb2xkZXJJZCk7XG4gICAgaWYgKGZvbGRlckluZGV4ID09PSAtMSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdbU2NyaXB0TWFuYWdlcl0g5paH5Lu25aS55LiN5a2Y5ZyoJyk7XG4gICAgfVxuXG4gICAgY29uc3QgZXhpc3RpbmdGb2xkZXIgPSByZXBvc2l0b3J5LmZpbmQoXG4gICAgICBpdGVtID0+IGl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicgJiYgaXRlbS5uYW1lID09PSBuZXdOYW1lLnRyaW0oKSAmJiBpdGVtLmlkICE9PSBmb2xkZXJJZCxcbiAgICApO1xuICAgIGlmIChleGlzdGluZ0ZvbGRlcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdbU2NyaXB0TWFuYWdlcl0g5paH5Lu25aS55ZCN56ew5bey5a2Y5ZyoJyk7XG4gICAgfVxuXG4gICAgcmVwb3NpdG9yeVtmb2xkZXJJbmRleF0ubmFtZSA9IG5ld05hbWUudHJpbSgpO1xuICAgIGlmIChuZXdJY29uICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHJlcG9zaXRvcnlbZm9sZGVySW5kZXhdLmljb24gPSBuZXdJY29uO1xuICAgIH1cbiAgICBpZiAobmV3Q29sb3IgIT09IHVuZGVmaW5lZCkge1xuICAgICAgcmVwb3NpdG9yeVtmb2xkZXJJbmRleF0uY29sb3IgPSBuZXdDb2xvcjtcbiAgICB9XG5cbiAgICBpZiAodHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwpIHtcbiAgICAgIGF3YWl0IHRoaXMuc2F2ZUdsb2JhbFJlcG9zaXRvcnlJdGVtcyhyZXBvc2l0b3J5KTtcbiAgICB9IGVsc2Uge1xuICAgICAgYXdhaXQgdGhpcy5zYXZlQ2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKHJlcG9zaXRvcnkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDliKDpmaTmlofku7blpLnvvIjlkIzml7bliKDpmaTlhoXpg6jnmoTmiYDmnInohJrmnKzvvIlcbiAgICogQHBhcmFtIGZvbGRlcklkIOaWh+S7tuWkuUlEXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgYXN5bmMgZGVsZXRlRm9sZGVyKGZvbGRlcklkOiBzdHJpbmcsIHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCByZXBvc2l0b3J5ID1cbiAgICAgIHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMID8gdGhpcy5nZXRHbG9iYWxSZXBvc2l0b3J5SXRlbXMoKSA6IHRoaXMuZ2V0Q2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKCk7XG5cbiAgICBjb25zdCBmb2xkZXJJbmRleCA9IHJlcG9zaXRvcnkuZmluZEluZGV4KGl0ZW0gPT4gaXRlbS50eXBlID09PSAnZm9sZGVyJyAmJiBpdGVtLmlkID09PSBmb2xkZXJJZCk7XG4gICAgaWYgKGZvbGRlckluZGV4ID09PSAtMSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdbU2NyaXB0TWFuYWdlcl0g5paH5Lu25aS55LiN5a2Y5ZyoJyk7XG4gICAgfVxuXG4gICAgcmVwb3NpdG9yeS5zcGxpY2UoZm9sZGVySW5kZXgsIDEpO1xuXG4gICAgaWYgKHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMKSB7XG4gICAgICBhd2FpdCB0aGlzLnNhdmVHbG9iYWxSZXBvc2l0b3J5SXRlbXMocmVwb3NpdG9yeSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGF3YWl0IHRoaXMuc2F2ZUNoYXJhY3RlclJlcG9zaXRvcnlJdGVtcyhyZXBvc2l0b3J5KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5bCG6aG555uu77yI6ISa5pys5oiW5paH5Lu25aS577yJ56e75Yqo5Yiw5YW25LuW57G75Z6L55qE5LuT5bqTXG4gICAqIEBwYXJhbSBpdGVtIOimgeenu+WKqOeahOmhueebruS/oeaBr1xuICAgKiBAcGFyYW0gc291cmNlVHlwZSDmupDnsbvlnotcbiAgICovXG4gIGFzeW5jIG1vdmVJdGVtVG9PdGhlclR5cGUoXG4gICAgaXRlbTogeyB0eXBlOiAnc2NyaXB0JzsgaWQ6IHN0cmluZzsgdmFsdWU6IFNjcmlwdCB9IHwgeyB0eXBlOiAnZm9sZGVyJzsgaWQ6IHN0cmluZyB9LFxuICAgIHNvdXJjZVR5cGU6IFNjcmlwdFR5cGUsXG4gICk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHRhcmdldFR5cGUgPSBnZXRPcHBvc2l0ZVNjcmlwdFR5cGUoc291cmNlVHlwZSk7XG5cbiAgICBjb25zdCBzb3VyY2VSZXBvc2l0b3J5ID1cbiAgICAgIHNvdXJjZVR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMID8gdGhpcy5nZXRHbG9iYWxSZXBvc2l0b3J5SXRlbXMoKSA6IHRoaXMuZ2V0Q2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKCk7XG5cbiAgICBsZXQgaXRlbUZvdW5kID0gZmFsc2U7XG4gICAgbGV0IGZvdW5kSXRlbTogU2NyaXB0UmVwb3NpdG9yeUl0ZW0gfCBudWxsID0gbnVsbDtcblxuICAgIGlmIChpdGVtLnR5cGUgPT09ICdzY3JpcHQnKSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNvdXJjZVJlcG9zaXRvcnkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgcmVwb0l0ZW0gPSBzb3VyY2VSZXBvc2l0b3J5W2ldO1xuICAgICAgICBpZiAocmVwb0l0ZW0udHlwZSA9PT0gJ3NjcmlwdCcgJiYgKHJlcG9JdGVtLnZhbHVlIGFzIFNjcmlwdCkuaWQgPT09IGl0ZW0uaWQpIHtcbiAgICAgICAgICBmb3VuZEl0ZW0gPSByZXBvSXRlbTtcbiAgICAgICAgICBzb3VyY2VSZXBvc2l0b3J5LnNwbGljZShpLCAxKTtcbiAgICAgICAgICBpdGVtRm91bmQgPSB0cnVlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9IGVsc2UgaWYgKHJlcG9JdGVtLnR5cGUgPT09ICdmb2xkZXInKSB7XG4gICAgICAgICAgY29uc3Qgc2NyaXB0cyA9IHJlcG9JdGVtLnZhbHVlIGFzIFNjcmlwdFtdO1xuICAgICAgICAgIGNvbnN0IGZvdW5kSW5kZXggPSBzY3JpcHRzLmZpbmRJbmRleChzID0+IHMuaWQgPT09IGl0ZW0uaWQpO1xuICAgICAgICAgIGlmIChmb3VuZEluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgZm91bmRJdGVtID0geyB0eXBlOiAnc2NyaXB0JywgdmFsdWU6IHNjcmlwdHNbZm91bmRJbmRleF0gfTtcbiAgICAgICAgICAgIHNjcmlwdHMuc3BsaWNlKGZvdW5kSW5kZXgsIDEpO1xuICAgICAgICAgICAgaXRlbUZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoIWl0ZW1Gb3VuZCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDnp7vliqjohJrmnKzlpLHotKXvvIzohJrmnKzkuI3lrZjlnKgnKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicpIHtcbiAgICAgIGNvbnN0IGZvbGRlckluZGV4ID0gc291cmNlUmVwb3NpdG9yeS5maW5kSW5kZXgocmVwb0l0ZW0gPT4gcmVwb0l0ZW0udHlwZSA9PT0gJ2ZvbGRlcicgJiYgcmVwb0l0ZW0uaWQgPT09IGl0ZW0uaWQpO1xuICAgICAgaWYgKGZvbGRlckluZGV4ID09PSAtMSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDmlofku7blpLnkuI3lrZjlnKgnKTtcbiAgICAgIH1cblxuICAgICAgZm91bmRJdGVtID0gc291cmNlUmVwb3NpdG9yeVtmb2xkZXJJbmRleF07XG4gICAgICBzb3VyY2VSZXBvc2l0b3J5LnNwbGljZShmb2xkZXJJbmRleCwgMSk7XG4gICAgICBpdGVtRm91bmQgPSB0cnVlO1xuICAgIH1cblxuICAgIGlmICghaXRlbUZvdW5kIHx8ICFmb3VuZEl0ZW0pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignW1NjcmlwdE1hbmFnZXJdIOenu+WKqOWksei0pe+8jOmhueebruS4jeWtmOWcqCcpO1xuICAgIH1cblxuICAgIGNvbnN0IHRhcmdldFJlcG9zaXRvcnkgPVxuICAgICAgdGFyZ2V0VHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyB0aGlzLmdldEdsb2JhbFJlcG9zaXRvcnlJdGVtcygpIDogdGhpcy5nZXRDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMoKTtcblxuICAgIGlmIChmb3VuZEl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicpIHtcbiAgICAgIGNvbnN0IGV4aXN0aW5nRm9sZGVyID0gdGFyZ2V0UmVwb3NpdG9yeS5maW5kKFxuICAgICAgICByZXBvSXRlbSA9PiByZXBvSXRlbS50eXBlID09PSAnZm9sZGVyJyAmJiByZXBvSXRlbS5uYW1lID09PSBmb3VuZEl0ZW0hLm5hbWUsXG4gICAgICApO1xuICAgICAgaWYgKGV4aXN0aW5nRm9sZGVyKSB7XG4gICAgICAgIHRvYXN0ci5lcnJvcign55uu5qCH5L2N572u5bey5a2Y5Zyo5ZCM5ZCN5paH5Lu25aS5Jyk7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignW1NjcmlwdE1hbmFnZXJdIOebruagh+S9jee9ruW3suWtmOWcqOWQjOWQjeaWh+S7tuWkuScpO1xuICAgICAgfVxuICAgICAgdGFyZ2V0UmVwb3NpdG9yeS51bnNoaWZ0KGZvdW5kSXRlbSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRhcmdldFJlcG9zaXRvcnkucHVzaChmb3VuZEl0ZW0pO1xuICAgIH1cblxuICAgIGlmIChzb3VyY2VUeXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCkge1xuICAgICAgYXdhaXQgdGhpcy5zYXZlR2xvYmFsUmVwb3NpdG9yeUl0ZW1zKHNvdXJjZVJlcG9zaXRvcnkpO1xuICAgICAgYXdhaXQgdGhpcy5zYXZlQ2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKHRhcmdldFJlcG9zaXRvcnkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBhd2FpdCB0aGlzLnNhdmVDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMoc291cmNlUmVwb3NpdG9yeSk7XG4gICAgICBhd2FpdCB0aGlzLnNhdmVHbG9iYWxSZXBvc2l0b3J5SXRlbXModGFyZ2V0UmVwb3NpdG9yeSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWwhuiEmuacrOenu+WKqOWIsOaWh+S7tuWkuVxuICAgKiBAcGFyYW0gc2NyaXB0SWQg6ISa5pysSURcbiAgICogQHBhcmFtIHRhcmdldEZvbGRlcklkIOebruagh+aWh+S7tuWkuUlE77yM5aaC5p6c5Li6bnVsbOWImeenu+WKqOWIsOaguee6p+WIq1xuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIGFzeW5jIG1vdmVTY3JpcHRUb0ZvbGRlcihzY3JpcHRJZDogc3RyaW5nLCB0YXJnZXRGb2xkZXJJZDogc3RyaW5nIHwgbnVsbCwgdHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHJlcG9zaXRvcnkgPVxuICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyB0aGlzLmdldEdsb2JhbFJlcG9zaXRvcnlJdGVtcygpIDogdGhpcy5nZXRDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMoKTtcblxuICAgIGxldCBzY3JpcHQ6IFNjcmlwdCB8IG51bGwgPSBudWxsO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXBvc2l0b3J5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBpdGVtID0gcmVwb3NpdG9yeVtpXTtcbiAgICAgIGlmIChpdGVtLnR5cGUgPT09ICdzY3JpcHQnICYmIChpdGVtLnZhbHVlIGFzIFNjcmlwdCkuaWQgPT09IHNjcmlwdElkKSB7XG4gICAgICAgIHNjcmlwdCA9IGl0ZW0udmFsdWUgYXMgU2NyaXB0O1xuICAgICAgICByZXBvc2l0b3J5LnNwbGljZShpLCAxKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9IGVsc2UgaWYgKGl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicpIHtcbiAgICAgICAgY29uc3Qgc2NyaXB0cyA9IGl0ZW0udmFsdWUgYXMgU2NyaXB0W107XG4gICAgICAgIGNvbnN0IGZvdW5kSW5kZXggPSBzY3JpcHRzLmZpbmRJbmRleChzID0+IHMuaWQgPT09IHNjcmlwdElkKTtcbiAgICAgICAgaWYgKGZvdW5kSW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgc2NyaXB0ID0gc2NyaXB0c1tmb3VuZEluZGV4XTtcbiAgICAgICAgICBzY3JpcHRzLnNwbGljZShmb3VuZEluZGV4LCAxKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmICghc2NyaXB0KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDohJrmnKzkuI3lrZjlnKgnKTtcbiAgICB9XG5cbiAgICBpZiAodGFyZ2V0Rm9sZGVySWQgPT09IG51bGwpIHtcbiAgICAgIHJlcG9zaXRvcnkucHVzaCh7XG4gICAgICAgIHR5cGU6ICdzY3JpcHQnLFxuICAgICAgICB2YWx1ZTogc2NyaXB0LFxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IHRhcmdldEZvbGRlciA9IHJlcG9zaXRvcnkuZmluZChpdGVtID0+IGl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicgJiYgaXRlbS5pZCA9PT0gdGFyZ2V0Rm9sZGVySWQpO1xuICAgICAgaWYgKCF0YXJnZXRGb2xkZXIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdbU2NyaXB0TWFuYWdlcl0g55uu5qCH5paH5Lu25aS55LiN5a2Y5ZyoJyk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGZvbGRlclNjcmlwdHMgPSB0YXJnZXRGb2xkZXIudmFsdWUgYXMgU2NyaXB0W107XG4gICAgICBjb25zdCBleGlzdGluZ1NjcmlwdCA9IGZvbGRlclNjcmlwdHMuZmluZChzID0+IHMubmFtZSA9PT0gc2NyaXB0Lm5hbWUpO1xuICAgICAgaWYgKGV4aXN0aW5nU2NyaXB0KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignW1NjcmlwdE1hbmFnZXJdIOaWh+S7tuWkueS4reW3suWtmOWcqOWQjOWQjeiEmuacrCcpO1xuICAgICAgfVxuXG4gICAgICBmb2xkZXJTY3JpcHRzLnB1c2goc2NyaXB0KTtcbiAgICB9XG5cbiAgICBpZiAodHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwpIHtcbiAgICAgIGF3YWl0IHRoaXMuc2F2ZUdsb2JhbFJlcG9zaXRvcnlJdGVtcyhyZXBvc2l0b3J5KTtcbiAgICB9IGVsc2Uge1xuICAgICAgYXdhaXQgdGhpcy5zYXZlQ2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKHJlcG9zaXRvcnkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5bmlofku7blpLnkuK3nmoTohJrmnKzliJfooahcbiAgICogQHBhcmFtIGZvbGRlcklkIOaWh+S7tuWkuUlEXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgZ2V0Rm9sZGVyU2NyaXB0cyhmb2xkZXJJZDogc3RyaW5nLCB0eXBlOiBTY3JpcHRUeXBlKTogU2NyaXB0W10ge1xuICAgIGNvbnN0IHJlcG9zaXRvcnkgPVxuICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyB0aGlzLmdldEdsb2JhbFJlcG9zaXRvcnlJdGVtcygpIDogdGhpcy5nZXRDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMoKTtcblxuICAgIGNvbnN0IGZvbGRlciA9IHJlcG9zaXRvcnkuZmluZChpdGVtID0+IGl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicgJiYgaXRlbS5pZCA9PT0gZm9sZGVySWQpO1xuXG4gICAgaWYgKCFmb2xkZXIpIHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICByZXR1cm4gZm9sZGVyLnZhbHVlIGFzIFNjcmlwdFtdO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluaguee6p+WIq+eahOiEmuacrOWIl+ihqFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIGdldFJvb3RTY3JpcHRzKHR5cGU6IFNjcmlwdFR5cGUpOiBTY3JpcHRbXSB7XG4gICAgY29uc3QgcmVwb3NpdG9yeSA9XG4gICAgICB0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCA/IHRoaXMuZ2V0R2xvYmFsUmVwb3NpdG9yeUl0ZW1zKCkgOiB0aGlzLmdldENoYXJhY3RlclJlcG9zaXRvcnlJdGVtcygpO1xuXG4gICAgcmV0dXJuIHJlcG9zaXRvcnkuZmlsdGVyKGl0ZW0gPT4gaXRlbS50eXBlID09PSAnc2NyaXB0JykubWFwKGl0ZW0gPT4gaXRlbS52YWx1ZSBhcyBTY3JpcHQpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluaJgOacieaWh+S7tuWkueWIl+ihqFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIGdldEZvbGRlcnModHlwZTogU2NyaXB0VHlwZSk6IFNjcmlwdFJlcG9zaXRvcnlJdGVtW10ge1xuICAgIGNvbnN0IHJlcG9zaXRvcnkgPVxuICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyB0aGlzLmdldEdsb2JhbFJlcG9zaXRvcnlJdGVtcygpIDogdGhpcy5nZXRDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMoKTtcblxuICAgIHJldHVybiByZXBvc2l0b3J5LmZpbHRlcihpdGVtID0+IGl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicpO1xuICB9XG5cbiAgLyoqXG4gICAqIOaJuemHj+WIh+aNouaWh+S7tuWkueWGheaJgOacieiEmuacrOeahOWQr+eUqOeKtuaAgVxuICAgKiBAcGFyYW0gZm9sZGVySWQg5paH5Lu25aS5SURcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqIEBwYXJhbSBlbmFibGUg5piv5ZCm5ZCv55SoXG4gICAqL1xuICBhc3luYyB0b2dnbGVGb2xkZXJTY3JpcHRzKGZvbGRlcklkOiBzdHJpbmcsIHR5cGU6IFNjcmlwdFR5cGUsIGVuYWJsZTogYm9vbGVhbik6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHJlcG9zaXRvcnkgPVxuICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyB0aGlzLmdldEdsb2JhbFJlcG9zaXRvcnlJdGVtcygpIDogdGhpcy5nZXRDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMoKTtcblxuICAgIGNvbnN0IGZvbGRlciA9IHJlcG9zaXRvcnkuZmluZChpdGVtID0+IGl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicgJiYgaXRlbS5pZCA9PT0gZm9sZGVySWQpO1xuICAgIGlmICghZm9sZGVyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDmlofku7blpLnkuI3lrZjlnKgnKTtcbiAgICB9XG5cbiAgICBjb25zdCBzY3JpcHRzID0gZm9sZGVyLnZhbHVlIGFzIFNjcmlwdFtdO1xuICAgIGxldCBoYXNDaGFuZ2VzID0gZmFsc2U7XG5cbiAgICBmb3IgKGNvbnN0IHNjcmlwdCBvZiBzY3JpcHRzKSB7XG4gICAgICBpZiAoc2NyaXB0LmVuYWJsZWQgIT09IGVuYWJsZSkge1xuICAgICAgICBzY3JpcHQuZW5hYmxlZCA9IGVuYWJsZTtcbiAgICAgICAgaGFzQ2hhbmdlcyA9IHRydWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGhhc0NoYW5nZXMpIHtcbiAgICAgIGlmICh0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCkge1xuICAgICAgICBhd2FpdCB0aGlzLnNhdmVHbG9iYWxSZXBvc2l0b3J5SXRlbXMocmVwb3NpdG9yeSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhd2FpdCB0aGlzLnNhdmVDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMocmVwb3NpdG9yeSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluaWh+S7tuWkueWGheiEmuacrOeahOaVtOS9k+WQr+eUqOeKtuaAgVxuICAgKiBAcGFyYW0gZm9sZGVySWQg5paH5Lu25aS5SURcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqIEByZXR1cm5zICdhbGwnIC0g5YWo6YOo5ZCv55SoLCAnbm9uZScgLSDlhajpg6jnpoHnlKhcbiAgICovXG4gIGdldEZvbGRlclNjcmlwdHNTdGF0ZShmb2xkZXJJZDogc3RyaW5nLCB0eXBlOiBTY3JpcHRUeXBlKTogJ2FsbCcgfCAnbm9uZScge1xuICAgIGNvbnN0IHNjcmlwdHMgPSB0aGlzLmdldEZvbGRlclNjcmlwdHMoZm9sZGVySWQsIHR5cGUpO1xuXG4gICAgaWYgKHNjcmlwdHMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gJ25vbmUnO1xuICAgIH1cblxuICAgIGNvbnN0IGVuYWJsZWRDb3VudCA9IHNjcmlwdHMuZmlsdGVyKHNjcmlwdCA9PiBzY3JpcHQuZW5hYmxlZCkubGVuZ3RoO1xuXG4gICAgaWYgKGVuYWJsZWRDb3VudCA9PT0gMCkge1xuICAgICAgcmV0dXJuICdub25lJztcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuICdhbGwnO1xuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIOS7juiEmuacrOWFgeiuuOWIl+ihqOS4reWIoOmZpOinkuiJslxuICogQHBhcmFtIHBhcmFtMFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcHVyZ2VFbWJlZGRlZFNjcmlwdHMoeyBjaGFyYWN0ZXIgfTogeyBjaGFyYWN0ZXI6IGFueSB9KTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IGF2YXRhciA9IGNoYXJhY3Rlcj8uY2hhcmFjdGVyPy5hdmF0YXI7XG4gIGNvbnN0IGNoYXJhY3RlcnNXaXRoU2NyaXB0cyA9IGdldFNldHRpbmdWYWx1ZSgnc2NyaXB0LmNoYXJhY3RlcnNfd2l0aF9zY3JpcHRzJykgfHwgW107XG4gIGlmIChhdmF0YXIpIHtcbiAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShgQWxlcnRTY3JpcHRfJHthdmF0YXJ9YCk7XG4gICAgaWYgKGNoYXJhY3RlcnNXaXRoU2NyaXB0cz8uaW5jbHVkZXMoYXZhdGFyKSkge1xuICAgICAgY29uc3QgaW5kZXggPSBjaGFyYWN0ZXJzV2l0aFNjcmlwdHMuaW5kZXhPZihhdmF0YXIpO1xuICAgICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgICBjaGFyYWN0ZXJzV2l0aFNjcmlwdHMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgc2F2ZVNldHRpbmdWYWx1ZSgnc2NyaXB0LmNoYXJhY3RlcnNfd2l0aF9zY3JpcHRzJywgY2hhcmFjdGVyc1dpdGhTY3JpcHRzKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/component/script_repository/data.ts\n")},"./src/component/script_repository/events.ts":
/*!***************************************************!*\
  !*** ./src/component/script_repository/events.ts ***!
  \***************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   EventBus: () => (/* binding */ EventBus),\n/* harmony export */   ScriptRepositoryEventType: () => (/* binding */ ScriptRepositoryEventType),\n/* harmony export */   scriptEvents: () => (/* binding */ scriptEvents)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ "@sillytavern/script");\n/**\n * 脚本仓库事件类型\n */\nvar ScriptRepositoryEventType;\n(function (ScriptRepositoryEventType) {\n    ScriptRepositoryEventType["SCRIPT_TOGGLE"] = "script_toggle";\n    ScriptRepositoryEventType["SCRIPT_RUN"] = "script_run";\n    ScriptRepositoryEventType["SCRIPT_STOP"] = "script_stop";\n    ScriptRepositoryEventType["SCRIPT_CREATE"] = "script_create";\n    ScriptRepositoryEventType["SCRIPT_UPDATE"] = "script_update";\n    ScriptRepositoryEventType["SCRIPT_DELETE"] = "script_delete";\n    ScriptRepositoryEventType["SCRIPT_MOVE"] = "script_move";\n    ScriptRepositoryEventType["SCRIPT_EDIT"] = "script_edit";\n    ScriptRepositoryEventType["FOLDER_CREATE"] = "folder_create";\n    ScriptRepositoryEventType["FOLDER_EDIT"] = "folder_edit";\n    ScriptRepositoryEventType["FOLDER_DELETE"] = "folder_delete";\n    ScriptRepositoryEventType["FOLDER_MOVE"] = "folder_move";\n    ScriptRepositoryEventType["FOLDER_SCRIPTS_TOGGLE"] = "folder_scripts_toggle";\n    ScriptRepositoryEventType["TYPE_TOGGLE"] = "type_toggle";\n    ScriptRepositoryEventType["BUTTON_ADD"] = "button_add";\n    ScriptRepositoryEventType["BUTTON_REMOVE"] = "button_remove";\n    ScriptRepositoryEventType["SCRIPT_IMPORT"] = "script_import";\n    ScriptRepositoryEventType["SCRIPT_EXPORT"] = "script_export";\n    //VARIABLE_EDIT = \'variable_edit\',\n    ScriptRepositoryEventType["ORDER_CHANGED"] = "order_changed";\n    ScriptRepositoryEventType["UI_REFRESH"] = "ui_refresh";\n    ScriptRepositoryEventType["UI_LOADED"] = "ui_loaded";\n})(ScriptRepositoryEventType || (ScriptRepositoryEventType = {}));\n\n/**\n * 事件总线类，用于组件间通信\n */\nclass EventBus {\n    static instance;\n    EVENT_NAMESPACE = \'script_repository_\';\n    activeListeners = new Map();\n    constructor() { }\n    /**\n     * 获取事件总线实例\n     */\n    static getInstance() {\n        if (!EventBus.instance) {\n            EventBus.instance = new EventBus();\n        }\n        return EventBus.instance;\n    }\n    /**\n     * 获取带命名空间的事件名称\n     * @param eventType 事件类型\n     * @returns 带命名空间的事件名称\n     */\n    getNamespacedEvent(eventType) {\n        return `${this.EVENT_NAMESPACE}${eventType}`;\n    }\n    /**\n     * 添加事件监听器\n     * @param eventType 事件类型\n     * @param listener 监听器函数\n     */\n    on(eventType, listener) {\n        if (!this.activeListeners.has(eventType)) {\n            this.activeListeners.set(eventType, new Set());\n        }\n        this.activeListeners.get(eventType)?.add(listener);\n        const namespacedEvent = this.getNamespacedEvent(eventType);\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.on(namespacedEvent, listener);\n    }\n    /**\n     * 移除事件监听器\n     * @param eventType 事件类型\n     * @param listener 监听器函数\n     */\n    off(eventType, listener) {\n        const namespacedEvent = this.getNamespacedEvent(eventType);\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.removeListener(namespacedEvent, listener);\n        const listeners = this.activeListeners.get(eventType);\n        if (listeners) {\n            listeners.delete(listener);\n            if (listeners.size === 0) {\n                this.activeListeners.delete(eventType);\n            }\n        }\n    }\n    /**\n     * 触发事件\n     * @param eventType 事件类型\n     * @param data 事件数据\n     */\n    emit(eventType, data) {\n        const namespacedEvent = this.getNamespacedEvent(eventType);\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.emit(namespacedEvent, data);\n    }\n    /**\n     * 清空所有事件监听器\n     */\n    clear() {\n        this.activeListeners.forEach((listeners, eventType) => {\n            const namespacedEvent = this.getNamespacedEvent(eventType);\n            listeners.forEach(listener => {\n                _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.removeListener(namespacedEvent, listener);\n            });\n        });\n        this.activeListeners.clear();\n    }\n    /**\n     * 销毁事件总线实例\n     */\n    static destroyInstance() {\n        if (EventBus.instance) {\n            EventBus.instance.clear();\n            EventBus.instance = undefined;\n        }\n    }\n}\nconst scriptEvents = EventBus.getInstance();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L2V2ZW50cy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0dBRUc7QUFDSCxJQUFZLHlCQThCWDtBQTlCRCxXQUFZLHlCQUF5QjtJQUNuQyw0REFBK0I7SUFDL0Isc0RBQXlCO0lBQ3pCLHdEQUEyQjtJQUMzQiw0REFBK0I7SUFDL0IsNERBQStCO0lBQy9CLDREQUErQjtJQUMvQix3REFBMkI7SUFDM0Isd0RBQTJCO0lBRTNCLDREQUErQjtJQUMvQix3REFBMkI7SUFDM0IsNERBQStCO0lBQy9CLHdEQUEyQjtJQUMzQiw0RUFBK0M7SUFFL0Msd0RBQTJCO0lBRTNCLHNEQUF5QjtJQUN6Qiw0REFBK0I7SUFFL0IsNERBQStCO0lBQy9CLDREQUErQjtJQUUvQixrQ0FBa0M7SUFFbEMsNERBQStCO0lBRS9CLHNEQUF5QjtJQUN6QixvREFBdUI7QUFDekIsQ0FBQyxFQTlCVyx5QkFBeUIsS0FBekIseUJBQXlCLFFBOEJwQztBQU9pRDtBQUVsRDs7R0FFRztBQUNJLE1BQU0sUUFBUTtJQUNYLE1BQU0sQ0FBQyxRQUFRLENBQVc7SUFDakIsZUFBZSxHQUFHLG9CQUFvQixDQUFDO0lBQ2hELGVBQWUsR0FBdUQsSUFBSSxHQUFHLEVBQUUsQ0FBQztJQUV4RixnQkFBdUIsQ0FBQztJQUV4Qjs7T0FFRztJQUNJLE1BQU0sQ0FBQyxXQUFXO1FBQ3ZCLElBQUksQ0FBQyxRQUFRLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDdkIsUUFBUSxDQUFDLFFBQVEsR0FBRyxJQUFJLFFBQVEsRUFBRSxDQUFDO1FBQ3JDLENBQUM7UUFDRCxPQUFPLFFBQVEsQ0FBQyxRQUFRLENBQUM7SUFDM0IsQ0FBQztJQUVEOzs7O09BSUc7SUFDSyxrQkFBa0IsQ0FBQyxTQUFvQztRQUM3RCxPQUFPLEdBQUcsSUFBSSxDQUFDLGVBQWUsR0FBRyxTQUFTLEVBQUUsQ0FBQztJQUMvQyxDQUFDO0lBRUQ7Ozs7T0FJRztJQUNJLEVBQUUsQ0FBQyxTQUFvQyxFQUFFLFFBQXVCO1FBQ3JFLElBQUksQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsRUFBRSxDQUFDO1lBQ3pDLElBQUksQ0FBQyxlQUFlLENBQUMsR0FBRyxDQUFDLFNBQVMsRUFBRSxJQUFJLEdBQUcsRUFBRSxDQUFDLENBQUM7UUFDakQsQ0FBQztRQUNELElBQUksQ0FBQyxlQUFlLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUVuRCxNQUFNLGVBQWUsR0FBRyxJQUFJLENBQUMsa0JBQWtCLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDM0QsNERBQVcsQ0FBQyxFQUFFLENBQUMsZUFBZSxFQUFFLFFBQVEsQ0FBQyxDQUFDO0lBQzVDLENBQUM7SUFFRDs7OztPQUlHO0lBQ0ksR0FBRyxDQUFDLFNBQW9DLEVBQUUsUUFBdUI7UUFDdEUsTUFBTSxlQUFlLEdBQUcsSUFBSSxDQUFDLGtCQUFrQixDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQzNELDREQUFXLENBQUMsY0FBYyxDQUFDLGVBQWUsRUFBRSxRQUFRLENBQUMsQ0FBQztRQUV0RCxNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUN0RCxJQUFJLFNBQVMsRUFBRSxDQUFDO1lBQ2QsU0FBUyxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUMzQixJQUFJLFNBQVMsQ0FBQyxJQUFJLEtBQUssQ0FBQyxFQUFFLENBQUM7Z0JBQ3pCLElBQUksQ0FBQyxlQUFlLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQ3pDLENBQUM7UUFDSCxDQUFDO0lBQ0gsQ0FBQztJQUVEOzs7O09BSUc7SUFDSSxJQUFJLENBQUMsU0FBb0MsRUFBRSxJQUFVO1FBQzFELE1BQU0sZUFBZSxHQUFHLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUMzRCw0REFBVyxDQUFDLElBQUksQ0FBQyxlQUFlLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDMUMsQ0FBQztJQUVEOztPQUVHO0lBQ0ksS0FBSztRQUNWLElBQUksQ0FBQyxlQUFlLENBQUMsT0FBTyxDQUFDLENBQUMsU0FBUyxFQUFFLFNBQVMsRUFBRSxFQUFFO1lBQ3BELE1BQU0sZUFBZSxHQUFHLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUMzRCxTQUFTLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxFQUFFO2dCQUMzQiw0REFBVyxDQUFDLGNBQWMsQ0FBQyxlQUFlLEVBQUUsUUFBUSxDQUFDLENBQUM7WUFDeEQsQ0FBQyxDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztRQUNILElBQUksQ0FBQyxlQUFlLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDL0IsQ0FBQztJQUVEOztPQUVHO0lBQ0ksTUFBTSxDQUFDLGVBQWU7UUFDM0IsSUFBSSxRQUFRLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDdEIsUUFBUSxDQUFDLFFBQVEsQ0FBQyxLQUFLLEVBQUUsQ0FBQztZQUMxQixRQUFRLENBQUMsUUFBUSxHQUFHLFNBQWdDLENBQUM7UUFDdkQsQ0FBQztJQUNILENBQUM7Q0FDRjtBQUVNLE1BQU0sWUFBWSxHQUFHLFFBQVEsQ0FBQyxXQUFXLEVBQUUsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvZXZlbnRzLnRzP2I3ZjIiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiDohJrmnKzku5PlupPkuovku7bnsbvlnotcbiAqL1xuZXhwb3J0IGVudW0gU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZSB7XG4gIFNDUklQVF9UT0dHTEUgPSAnc2NyaXB0X3RvZ2dsZScsXG4gIFNDUklQVF9SVU4gPSAnc2NyaXB0X3J1bicsXG4gIFNDUklQVF9TVE9QID0gJ3NjcmlwdF9zdG9wJyxcbiAgU0NSSVBUX0NSRUFURSA9ICdzY3JpcHRfY3JlYXRlJyxcbiAgU0NSSVBUX1VQREFURSA9ICdzY3JpcHRfdXBkYXRlJyxcbiAgU0NSSVBUX0RFTEVURSA9ICdzY3JpcHRfZGVsZXRlJyxcbiAgU0NSSVBUX01PVkUgPSAnc2NyaXB0X21vdmUnLFxuICBTQ1JJUFRfRURJVCA9ICdzY3JpcHRfZWRpdCcsXG5cbiAgRk9MREVSX0NSRUFURSA9ICdmb2xkZXJfY3JlYXRlJyxcbiAgRk9MREVSX0VESVQgPSAnZm9sZGVyX2VkaXQnLFxuICBGT0xERVJfREVMRVRFID0gJ2ZvbGRlcl9kZWxldGUnLFxuICBGT0xERVJfTU9WRSA9ICdmb2xkZXJfbW92ZScsXG4gIEZPTERFUl9TQ1JJUFRTX1RPR0dMRSA9ICdmb2xkZXJfc2NyaXB0c190b2dnbGUnLFxuXG4gIFRZUEVfVE9HR0xFID0gJ3R5cGVfdG9nZ2xlJyxcblxuICBCVVRUT05fQUREID0gJ2J1dHRvbl9hZGQnLFxuICBCVVRUT05fUkVNT1ZFID0gJ2J1dHRvbl9yZW1vdmUnLFxuXG4gIFNDUklQVF9JTVBPUlQgPSAnc2NyaXB0X2ltcG9ydCcsXG4gIFNDUklQVF9FWFBPUlQgPSAnc2NyaXB0X2V4cG9ydCcsXG5cbiAgLy9WQVJJQUJMRV9FRElUID0gJ3ZhcmlhYmxlX2VkaXQnLFxuXG4gIE9SREVSX0NIQU5HRUQgPSAnb3JkZXJfY2hhbmdlZCcsXG5cbiAgVUlfUkVGUkVTSCA9ICd1aV9yZWZyZXNoJyxcbiAgVUlfTE9BREVEID0gJ3VpX2xvYWRlZCcsXG59XG5cbi8qKlxuICog5LqL5Lu255uR5ZCs5Zmo57G75Z6LXG4gKi9cbmV4cG9ydCB0eXBlIEV2ZW50TGlzdGVuZXIgPSAoZGF0YTogYW55KSA9PiB2b2lkO1xuXG5pbXBvcnQgeyBldmVudFNvdXJjZSB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHQnO1xuXG4vKipcbiAqIOS6i+S7tuaAu+e6v+exu++8jOeUqOS6jue7hOS7tumXtOmAmuS/oVxuICovXG5leHBvcnQgY2xhc3MgRXZlbnRCdXMge1xuICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogRXZlbnRCdXM7XG4gIHByaXZhdGUgcmVhZG9ubHkgRVZFTlRfTkFNRVNQQUNFID0gJ3NjcmlwdF9yZXBvc2l0b3J5Xyc7XG4gIHByaXZhdGUgYWN0aXZlTGlzdGVuZXJzOiBNYXA8U2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZSwgU2V0PEV2ZW50TGlzdGVuZXI+PiA9IG5ldyBNYXAoKTtcblxuICBwcml2YXRlIGNvbnN0cnVjdG9yKCkge31cblxuICAvKipcbiAgICog6I635Y+W5LqL5Lu25oC757q/5a6e5L6LXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGdldEluc3RhbmNlKCk6IEV2ZW50QnVzIHtcbiAgICBpZiAoIUV2ZW50QnVzLmluc3RhbmNlKSB7XG4gICAgICBFdmVudEJ1cy5pbnN0YW5jZSA9IG5ldyBFdmVudEJ1cygpO1xuICAgIH1cbiAgICByZXR1cm4gRXZlbnRCdXMuaW5zdGFuY2U7XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5bim5ZG95ZCN56m66Ze055qE5LqL5Lu25ZCN56ewXG4gICAqIEBwYXJhbSBldmVudFR5cGUg5LqL5Lu257G75Z6LXG4gICAqIEByZXR1cm5zIOW4puWRveWQjeepuumXtOeahOS6i+S7tuWQjeensFxuICAgKi9cbiAgcHJpdmF0ZSBnZXROYW1lc3BhY2VkRXZlbnQoZXZlbnRUeXBlOiBTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYCR7dGhpcy5FVkVOVF9OQU1FU1BBQ0V9JHtldmVudFR5cGV9YDtcbiAgfVxuXG4gIC8qKlxuICAgKiDmt7vliqDkuovku7bnm5HlkKzlmahcbiAgICogQHBhcmFtIGV2ZW50VHlwZSDkuovku7bnsbvlnotcbiAgICogQHBhcmFtIGxpc3RlbmVyIOebkeWQrOWZqOWHveaVsFxuICAgKi9cbiAgcHVibGljIG9uKGV2ZW50VHlwZTogU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZSwgbGlzdGVuZXI6IEV2ZW50TGlzdGVuZXIpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuYWN0aXZlTGlzdGVuZXJzLmhhcyhldmVudFR5cGUpKSB7XG4gICAgICB0aGlzLmFjdGl2ZUxpc3RlbmVycy5zZXQoZXZlbnRUeXBlLCBuZXcgU2V0KCkpO1xuICAgIH1cbiAgICB0aGlzLmFjdGl2ZUxpc3RlbmVycy5nZXQoZXZlbnRUeXBlKT8uYWRkKGxpc3RlbmVyKTtcblxuICAgIGNvbnN0IG5hbWVzcGFjZWRFdmVudCA9IHRoaXMuZ2V0TmFtZXNwYWNlZEV2ZW50KGV2ZW50VHlwZSk7XG4gICAgZXZlbnRTb3VyY2Uub24obmFtZXNwYWNlZEV2ZW50LCBsaXN0ZW5lcik7XG4gIH1cblxuICAvKipcbiAgICog56e76Zmk5LqL5Lu255uR5ZCs5ZmoXG4gICAqIEBwYXJhbSBldmVudFR5cGUg5LqL5Lu257G75Z6LXG4gICAqIEBwYXJhbSBsaXN0ZW5lciDnm5HlkKzlmajlh73mlbBcbiAgICovXG4gIHB1YmxpYyBvZmYoZXZlbnRUeXBlOiBTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLCBsaXN0ZW5lcjogRXZlbnRMaXN0ZW5lcik6IHZvaWQge1xuICAgIGNvbnN0IG5hbWVzcGFjZWRFdmVudCA9IHRoaXMuZ2V0TmFtZXNwYWNlZEV2ZW50KGV2ZW50VHlwZSk7XG4gICAgZXZlbnRTb3VyY2UucmVtb3ZlTGlzdGVuZXIobmFtZXNwYWNlZEV2ZW50LCBsaXN0ZW5lcik7XG5cbiAgICBjb25zdCBsaXN0ZW5lcnMgPSB0aGlzLmFjdGl2ZUxpc3RlbmVycy5nZXQoZXZlbnRUeXBlKTtcbiAgICBpZiAobGlzdGVuZXJzKSB7XG4gICAgICBsaXN0ZW5lcnMuZGVsZXRlKGxpc3RlbmVyKTtcbiAgICAgIGlmIChsaXN0ZW5lcnMuc2l6ZSA9PT0gMCkge1xuICAgICAgICB0aGlzLmFjdGl2ZUxpc3RlbmVycy5kZWxldGUoZXZlbnRUeXBlKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog6Kem5Y+R5LqL5Lu2XG4gICAqIEBwYXJhbSBldmVudFR5cGUg5LqL5Lu257G75Z6LXG4gICAqIEBwYXJhbSBkYXRhIOS6i+S7tuaVsOaNrlxuICAgKi9cbiAgcHVibGljIGVtaXQoZXZlbnRUeXBlOiBTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLCBkYXRhPzogYW55KTogdm9pZCB7XG4gICAgY29uc3QgbmFtZXNwYWNlZEV2ZW50ID0gdGhpcy5nZXROYW1lc3BhY2VkRXZlbnQoZXZlbnRUeXBlKTtcbiAgICBldmVudFNvdXJjZS5lbWl0KG5hbWVzcGFjZWRFdmVudCwgZGF0YSk7XG4gIH1cblxuICAvKipcbiAgICog5riF56m65omA5pyJ5LqL5Lu255uR5ZCs5ZmoXG4gICAqL1xuICBwdWJsaWMgY2xlYXIoKTogdm9pZCB7XG4gICAgdGhpcy5hY3RpdmVMaXN0ZW5lcnMuZm9yRWFjaCgobGlzdGVuZXJzLCBldmVudFR5cGUpID0+IHtcbiAgICAgIGNvbnN0IG5hbWVzcGFjZWRFdmVudCA9IHRoaXMuZ2V0TmFtZXNwYWNlZEV2ZW50KGV2ZW50VHlwZSk7XG4gICAgICBsaXN0ZW5lcnMuZm9yRWFjaChsaXN0ZW5lciA9PiB7XG4gICAgICAgIGV2ZW50U291cmNlLnJlbW92ZUxpc3RlbmVyKG5hbWVzcGFjZWRFdmVudCwgbGlzdGVuZXIpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gICAgdGhpcy5hY3RpdmVMaXN0ZW5lcnMuY2xlYXIoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDplIDmr4Hkuovku7bmgLvnur/lrp7kvotcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgZGVzdHJveUluc3RhbmNlKCk6IHZvaWQge1xuICAgIGlmIChFdmVudEJ1cy5pbnN0YW5jZSkge1xuICAgICAgRXZlbnRCdXMuaW5zdGFuY2UuY2xlYXIoKTtcbiAgICAgIEV2ZW50QnVzLmluc3RhbmNlID0gdW5kZWZpbmVkIGFzIHVua25vd24gYXMgRXZlbnRCdXM7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBjb25zdCBzY3JpcHRFdmVudHMgPSBFdmVudEJ1cy5nZXRJbnN0YW5jZSgpO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/component/script_repository/events.ts\n')},"./src/component/script_repository/index.ts":
/*!**************************************************!*\
  !*** ./src/component/script_repository/index.ts ***!
  \**************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ScriptRepositoryApp: () => (/* binding */ ScriptRepositoryApp),\n/* harmony export */   ScriptType: () => (/* reexport safe */ _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType),\n/* harmony export */   buildScriptRepository: () => (/* binding */ buildScriptRepository),\n/* harmony export */   buildScriptRepositoryOnExtension: () => (/* binding */ buildScriptRepositoryOnExtension),\n/* harmony export */   destroyScriptRepositoryOnExtension: () => (/* binding */ destroyScriptRepositoryOnExtension),\n/* harmony export */   removeScriptRepository: () => (/* binding */ removeScriptRepository)\n/* harmony export */ });\n/* harmony import */ var _component_script_repository_button__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/script_repository/button */ \"./src/component/script_repository/button.ts\");\n/* harmony import */ var _component_script_repository_data__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/component/script_repository/data */ \"./src/component/script_repository/data.ts\");\n/* harmony import */ var _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/component/script_repository/events */ \"./src/component/script_repository/events.ts\");\n/* harmony import */ var _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/component/script_repository/script_controller */ \"./src/component/script_repository/script_controller.ts\");\n/* harmony import */ var _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/component/script_repository/types */ \"./src/component/script_repository/types.ts\");\n/* harmony import */ var _component_script_repository_ui_controller__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/component/script_repository/ui_controller */ \"./src/component/script_repository/ui_controller.ts\");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @sillytavern/scripts/popup */ \"@sillytavern/scripts/popup\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_10__);\n\n\n\n\n\n\n\n\n\n\n\nconst load_events = [_sillytavern_script__WEBPACK_IMPORTED_MODULE_7__.event_types.CHAT_CHANGED];\nconst delete_events = [_sillytavern_script__WEBPACK_IMPORTED_MODULE_7__.event_types.CHARACTER_DELETED];\n/**\n * 脚本仓库应用 - 使用事件驱动架构\n * 负责整合ScriptManager和UIManager，提供统一的接口\n */\nclass ScriptRepositoryApp {\n    static instance;\n    scriptManager;\n    uiManager;\n    initialized = false;\n    constructor() {\n        this.scriptManager = _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_3__.ScriptManager.getInstance();\n        this.uiManager = _component_script_repository_ui_controller__WEBPACK_IMPORTED_MODULE_5__.UIController.getInstance();\n        this.registerEvents();\n    }\n    /**\n     * 获取应用实例\n     */\n    static getInstance() {\n        if (!ScriptRepositoryApp.instance) {\n            ScriptRepositoryApp.instance = new ScriptRepositoryApp();\n        }\n        return ScriptRepositoryApp.instance;\n    }\n    /**\n     * 销毁应用实例\n     */\n    static destroyInstance() {\n        if (ScriptRepositoryApp.instance) {\n            ScriptRepositoryApp.instance.cleanup();\n            ScriptRepositoryApp.instance = undefined;\n            _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_3__.ScriptManager.destroyInstance();\n            _component_script_repository_ui_controller__WEBPACK_IMPORTED_MODULE_5__.UIController.destroyInstance();\n            _component_script_repository_data__WEBPACK_IMPORTED_MODULE_1__.ScriptData.destroyInstance();\n            (0,_component_script_repository_button__WEBPACK_IMPORTED_MODULE_0__.unbindQrEnabledChangeListener)();\n        }\n    }\n    /**\n     * 初始化应用\n     */\n    async initialize() {\n        if (this.initialized) {\n            return;\n        }\n        try {\n            await (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_9__.loadFileToDocument)(`/scripts/extensions/${_util_extension_variables__WEBPACK_IMPORTED_MODULE_6__.extensionFolderPath}/src/component/script_repository/public/style.css`, 'css');\n            await this.uiManager.initialize();\n            this.initialized = true;\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_10___default().error('[ScriptManager] 初始化失败:', error);\n            this.initialized = false;\n        }\n    }\n    /**\n     * 注册事件监听\n     */\n    registerEvents() {\n        load_events.forEach(eventType => {\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_7__.eventSource.on(eventType, this.refreshCharacterRepository.bind(this));\n        });\n        delete_events.forEach(eventType => {\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_7__.eventSource.on(eventType, (character) => (0,_component_script_repository_data__WEBPACK_IMPORTED_MODULE_1__.purgeEmbeddedScripts)({ character }));\n        });\n    }\n    /**\n     * 刷新角色脚本库\n     */\n    async refreshCharacterRepository() {\n        if (!this.initialized) {\n            return;\n        }\n        const previousCharacterScripts = [];\n        $(`#character-script-list`)\n            .find('.script-item')\n            .each((_index, element) => {\n            const $element = $(element);\n            const scriptId = $element.attr('id');\n            if (scriptId) {\n                const script = this.scriptManager.getScriptById(scriptId);\n                if (script) {\n                    previousCharacterScripts.push(script);\n                }\n            }\n        });\n        this.scriptManager.stopScriptsByType(previousCharacterScripts, _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.CHARACTER);\n        const scriptData = _component_script_repository_data__WEBPACK_IMPORTED_MODULE_1__.ScriptData.getInstance();\n        const globalScripts = this.scriptManager.getGlobalScripts();\n        const characterScripts = this.scriptManager.getCharacterScripts();\n        this.scriptManager.refreshCharacterScriptEnabledState();\n        loglevel__WEBPACK_IMPORTED_MODULE_10___default().info('[ScriptManager] 刷新角色脚本库');\n        if (_sillytavern_script__WEBPACK_IMPORTED_MODULE_7__.this_chid && characterScripts.length > 0) {\n            await this.uiManager.checkEmbeddedScripts(_sillytavern_script__WEBPACK_IMPORTED_MODULE_7__.this_chid);\n        }\n        const conflictScripts = characterScripts.filter(charScript => globalScripts.some(globalScript => globalScript.id === charScript.id));\n        if (conflictScripts.length > 0) {\n            loglevel__WEBPACK_IMPORTED_MODULE_10___default().info(`[ScriptManager] 发现${conflictScripts.length}个脚本ID冲突`);\n            for (const charScript of conflictScripts) {\n                const globalScript = globalScripts.find(gs => gs.id === charScript.id);\n                const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)(`全局脚本中已存在 \"${globalScript.name}\" 脚本，是否关闭冲突脚本？`, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.TEXT, '', {\n                    okButton: '关闭全局',\n                    cancelButton: '关闭局部',\n                });\n                charScript.id = (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_9__.uuidv4)();\n                if (result) {\n                    if (globalScript.enabled) {\n                        await this.scriptManager.stopScript(globalScript, _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL);\n                        globalScript.enabled = false;\n                        loglevel__WEBPACK_IMPORTED_MODULE_10___default().info(`[ScriptManager] 关闭全局脚本: ${globalScript.name}`);\n                        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, {\n                            action: 'script_toggle',\n                            script: globalScript,\n                            type: _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.GLOBAL,\n                            enable: false,\n                        });\n                        scriptData.saveGlobalScripts(globalScripts);\n                    }\n                }\n                else if (charScript.enabled) {\n                    charScript.enabled = false;\n                    await scriptData.saveCharacterScripts(characterScripts);\n                    loglevel__WEBPACK_IMPORTED_MODULE_10___default().info(`[ScriptManager] 关闭局部脚本: ${charScript.name}`);\n                }\n            }\n        }\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, { action: 'refresh_charact_scripts' });\n        (0,_component_script_repository_button__WEBPACK_IMPORTED_MODULE_0__.checkQrEnabledStatusAndAddButton)();\n        (0,_component_script_repository_button__WEBPACK_IMPORTED_MODULE_0__.bindQrEnabledChangeListener)();\n        await this.scriptManager.runScriptsByType(characterScripts, _component_script_repository_types__WEBPACK_IMPORTED_MODULE_4__.ScriptType.CHARACTER);\n    }\n    /**\n     * 清理资源\n     */\n    async cleanup() {\n        try {\n            load_events.forEach(eventType => {\n                _sillytavern_script__WEBPACK_IMPORTED_MODULE_7__.eventSource.removeListener(eventType, this.refreshCharacterRepository.bind(this));\n            });\n            await this.scriptManager.cleanup();\n            this.uiManager.cleanup();\n            this.initialized = false;\n            loglevel__WEBPACK_IMPORTED_MODULE_10___default().info('[ScriptManager] 清理完成');\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_10___default().error('[ScriptManager] 清理失败:', error);\n        }\n    }\n}\n/**\n * 构建脚本库应用\n */\nasync function buildScriptRepository() {\n    const app = ScriptRepositoryApp.getInstance();\n    await app.initialize();\n}\n/**\n * 移除脚本库应用\n */\nasync function removeScriptRepository() {\n    ScriptRepositoryApp.destroyInstance();\n}\n/**\n * 扩展开启时构建脚本库\n */\nasync function buildScriptRepositoryOnExtension() {\n    await buildScriptRepository();\n}\n/**\n * 扩展关闭时销毁脚本库\n */\nfunction destroyScriptRepositoryOnExtension() {\n    removeScriptRepository();\n}\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L2luZGV4LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUk4QztBQUN3QztBQUNTO0FBQ2Y7QUFDUDtBQUNFO0FBQ1Y7QUFFUztBQUNBO0FBQ0Y7QUFFN0M7QUFFM0IsTUFBTSxXQUFXLEdBQUcsQ0FBQyw0REFBVyxDQUFDLFlBQVksQ0FBVSxDQUFDO0FBQ3hELE1BQU0sYUFBYSxHQUFHLENBQUMsNERBQVcsQ0FBQyxpQkFBaUIsQ0FBVSxDQUFDO0FBRS9EOzs7R0FHRztBQUNJLE1BQU0sbUJBQW1CO0lBQ3RCLE1BQU0sQ0FBQyxRQUFRLENBQXNCO0lBQ3JDLGFBQWEsQ0FBZ0I7SUFDN0IsU0FBUyxDQUFlO0lBQ3hCLFdBQVcsR0FBWSxLQUFLLENBQUM7SUFFckM7UUFDRSxJQUFJLENBQUMsYUFBYSxHQUFHLHlGQUFhLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDakQsSUFBSSxDQUFDLFNBQVMsR0FBRyxvRkFBWSxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBRTVDLElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQztJQUN4QixDQUFDO0lBRUQ7O09BRUc7SUFDSSxNQUFNLENBQUMsV0FBVztRQUN2QixJQUFJLENBQUMsbUJBQW1CLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDbEMsbUJBQW1CLENBQUMsUUFBUSxHQUFHLElBQUksbUJBQW1CLEVBQUUsQ0FBQztRQUMzRCxDQUFDO1FBQ0QsT0FBTyxtQkFBbUIsQ0FBQyxRQUFRLENBQUM7SUFDdEMsQ0FBQztJQUVEOztPQUVHO0lBQ0ksTUFBTSxDQUFDLGVBQWU7UUFDM0IsSUFBSSxtQkFBbUIsQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUNqQyxtQkFBbUIsQ0FBQyxRQUFRLENBQUMsT0FBTyxFQUFFLENBQUM7WUFDdkMsbUJBQW1CLENBQUMsUUFBUSxHQUFHLFNBQTJDLENBQUM7WUFDM0UseUZBQWEsQ0FBQyxlQUFlLEVBQUUsQ0FBQztZQUNoQyxvRkFB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RXpCLElBQUksQ0FBQyxXQUFXLEdBQUcsS0FBSyxDQUFDO1lBQ3pCLHFEQUFRLENBQUMsc0JBQXNCLENBQUMsQ0FBQztRQUNuQyxDQUFDO1FBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztZQUNmLHNEQUFTLENBQUMsdUJBQXVCLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDNUMsQ0FBQztJQUNILENBQUM7Q0FDRjtBQUVEOztHQUVHO0FBQ0ksS0FBSyxVQUFVLHFCQUFxQjtJQUN6QyxNQUFNLEdBQUcsR0FBRyxtQkFBbUIsQ0FBQyxXQUFXLEVBQUUsQ0FBQztJQUM5QyxNQUFNLEdBQUcsQ0FBQyxVQUFVLEVBQUUsQ0FBQztBQUN6QixDQUFDO0FBRUQ7O0dBRUc7QUFDSSxLQUFLLFVBQVUsc0JBQXNCO0lBQzFDLG1CQUFtQixDQUFDLGVBQWUsRUFBRSxDQUFDO0FBQ3hDLENBQUM7QUFFRDs7R0FFRztBQUNJLEtBQUssVUFBVSxnQ0FBZ0M7SUFDcEQsTUFBTSxxQkFBcUIsRUFBRSxDQUFDO0FBQ2hDLENBQUM7QUFFRDs7R0FFRztBQUNJLFNBQVMsa0NBQWtDO0lBQ2hELHNCQUFzQixFQUFFLENBQUM7QUFDM0IsQ0FBQztBQUVxQiIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvaW5kZXgudHM/MDFhMyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBiaW5kUXJFbmFibGVkQ2hhbmdlTGlzdGVuZXIsXG4gIGNoZWNrUXJFbmFibGVkU3RhdHVzQW5kQWRkQnV0dG9uLFxuICB1bmJpbmRRckVuYWJsZWRDaGFuZ2VMaXN0ZW5lcixcbn0gZnJvbSAnQC9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvYnV0dG9uJztcbmltcG9ydCB7IHB1cmdlRW1iZWRkZWRTY3JpcHRzLCBTY3JpcHREYXRhIH0gZnJvbSAnQC9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvZGF0YSc7XG5pbXBvcnQgeyBzY3JpcHRFdmVudHMsIFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUgfSBmcm9tICdAL2NvbXBvbmVudC9zY3JpcHRfcmVwb3NpdG9yeS9ldmVudHMnO1xuaW1wb3J0IHsgU2NyaXB0TWFuYWdlciB9IGZyb20gJ0AvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3NjcmlwdF9jb250cm9sbGVyJztcbmltcG9ydCB7IFNjcmlwdCwgU2NyaXB0VHlwZSB9IGZyb20gJ0AvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3R5cGVzJztcbmltcG9ydCB7IFVJQ29udHJvbGxlciB9IGZyb20gJ0AvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3VpX2NvbnRyb2xsZXInO1xuaW1wb3J0IHsgZXh0ZW5zaW9uRm9sZGVyUGF0aCB9IGZyb20gJ0AvdXRpbC9leHRlbnNpb25fdmFyaWFibGVzJztcblxuaW1wb3J0IHsgZXZlbnRfdHlwZXMsIGV2ZW50U291cmNlLCB0aGlzX2NoaWQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0JztcbmltcG9ydCB7IGNhbGxHZW5lcmljUG9wdXAsIFBPUFVQX1RZUEUgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9wb3B1cCc7XG5pbXBvcnQgeyBsb2FkRmlsZVRvRG9jdW1lbnQsIHV1aWR2NCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3V0aWxzJztcblxuaW1wb3J0IGxvZyBmcm9tICdsb2dsZXZlbCc7XG5cbmNvbnN0IGxvYWRfZXZlbnRzID0gW2V2ZW50X3R5cGVzLkNIQVRfQ0hBTkdFRF0gYXMgY29uc3Q7XG5jb25zdCBkZWxldGVfZXZlbnRzID0gW2V2ZW50X3R5cGVzLkNIQVJBQ1RFUl9ERUxFVEVEXSBhcyBjb25zdDtcblxuLyoqXG4gKiDohJrmnKzku5PlupPlupTnlKggLSDkvb/nlKjkuovku7bpqbHliqjmnrbmnoRcbiAqIOi0n+i0o+aVtOWQiFNjcmlwdE1hbmFnZXLlkoxVSU1hbmFnZXLvvIzmj5Dkvpvnu5/kuIDnmoTmjqXlj6NcbiAqL1xuZXhwb3J0IGNsYXNzIFNjcmlwdFJlcG9zaXRvcnlBcHAge1xuICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogU2NyaXB0UmVwb3NpdG9yeUFwcDtcbiAgcHJpdmF0ZSBzY3JpcHRNYW5hZ2VyOiBTY3JpcHRNYW5hZ2VyO1xuICBwcml2YXRlIHVpTWFuYWdlcjogVUlDb250cm9sbGVyO1xuICBwcml2YXRlIGluaXRpYWxpemVkOiBib29sZWFuID0gZmFsc2U7XG5cbiAgcHJpdmF0ZSBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLnNjcmlwdE1hbmFnZXIgPSBTY3JpcHRNYW5hZ2VyLmdldEluc3RhbmNlKCk7XG4gICAgdGhpcy51aU1hbmFnZXIgPSBVSUNvbnRyb2xsZXIuZ2V0SW5zdGFuY2UoKTtcblxuICAgIHRoaXMucmVnaXN0ZXJFdmVudHMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5blupTnlKjlrp7kvotcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgZ2V0SW5zdGFuY2UoKTogU2NyaXB0UmVwb3NpdG9yeUFwcCB7XG4gICAgaWYgKCFTY3JpcHRSZXBvc2l0b3J5QXBwLmluc3RhbmNlKSB7XG4gICAgICBTY3JpcHRSZXBvc2l0b3J5QXBwLmluc3RhbmNlID0gbmV3IFNjcmlwdFJlcG9zaXRvcnlBcHAoKTtcbiAgICB9XG4gICAgcmV0dXJuIFNjcmlwdFJlcG9zaXRvcnlBcHAuaW5zdGFuY2U7XG4gIH1cblxuICAvKipcbiAgICog6ZSA5q+B5bqU55So5a6e5L6LXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGRlc3Ryb3lJbnN0YW5jZSgpOiB2b2lkIHtcbiAgICBpZiAoU2NyaXB0UmVwb3NpdG9yeUFwcC5pbnN0YW5jZSkge1xuICAgICAgU2NyaXB0UmVwb3NpdG9yeUFwcC5pbnN0YW5jZS5jbGVhbnVwKCk7XG4gICAgICBTY3JpcHRSZXBvc2l0b3J5QXBwLmluc3RhbmNlID0gdW5kZWZpbmVkIGFzIHVua25vd24gYXMgU2NyaXB0UmVwb3NpdG9yeUFwcDtcbiAgICAgIFNjcmlwdE1hbmFnZXIuZGVzdHJveUluc3RhbmNlKCk7XG4gICAgICBVSUNvbnRyb2xsZXIuZGVzdHJveUluc3RhbmNlKCk7XG4gICAgICBTY3JpcHREYXRhLmRlc3Ryb3lJbnN0YW5jZSgpO1xuICAgICAgdW5iaW5kUXJFbmFibGVkQ2hhbmdlTGlzdGVuZXIoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5Yid5aeL5YyW5bqU55SoXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgaW5pdGlhbGl6ZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAodGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBhd2FpdCBsb2FkRmlsZVRvRG9jdW1lbnQoXG4gICAgICAgIGAvc2NyaXB0cy9leHRlbnNpb25zLyR7ZXh0ZW5zaW9uRm9sZGVyUGF0aH0vc3JjL2NvbXBvbmVudC9zY3JpcHRfcmVwb3NpdG9yeS9wdWJsaWMvc3R5bGUuY3NzYCxcbiAgICAgICAgJ2NzcycsXG4gICAgICApO1xuICAgICAgYXdhaXQgdGhpcy51aU1hbmFnZXIuaW5pdGlhbGl6ZSgpO1xuICAgICAgdGhpcy5pbml0aWFsaXplZCA9IHRydWU7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZy5lcnJvcignW1NjcmlwdE1hbmFnZXJdIOWIneWni+WMluWksei0pTonLCBlcnJvcik7XG4gICAgICB0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOazqOWGjOS6i+S7tuebkeWQrFxuICAgKi9cbiAgcHJpdmF0ZSByZWdpc3RlckV2ZW50cygpOiB2b2lkIHtcbiAgICBsb2FkX2V2ZW50cy5mb3JFYWNoKGV2ZW50VHlwZSA9PiB7XG4gICAgICBldmVudFNvdXJjZS5vbihldmVudFR5cGUsIHRoaXMucmVmcmVzaENoYXJhY3RlclJlcG9zaXRvcnkuYmluZCh0aGlzKSk7XG4gICAgfSk7XG5cbiAgICBkZWxldGVfZXZlbnRzLmZvckVhY2goZXZlbnRUeXBlID0+IHtcbiAgICAgIGV2ZW50U291cmNlLm9uKGV2ZW50VHlwZSwgKGNoYXJhY3RlcjogYW55KSA9PiBwdXJnZUVtYmVkZGVkU2NyaXB0cyh7IGNoYXJhY3RlciB9KSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog5Yi35paw6KeS6Imy6ISa5pys5bqTXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHJlZnJlc2hDaGFyYWN0ZXJSZXBvc2l0b3J5KCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICghdGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBwcmV2aW91c0NoYXJhY3RlclNjcmlwdHM6IFNjcmlwdFtdID0gW107XG4gICAgJChgI2NoYXJhY3Rlci1zY3JpcHQtbGlzdGApXG4gICAgICAuZmluZCgnLnNjcmlwdC1pdGVtJylcbiAgICAgIC5lYWNoKChfaW5kZXgsIGVsZW1lbnQpID0+IHtcbiAgICAgICAgY29uc3QgJGVsZW1lbnQgPSAkKGVsZW1lbnQpO1xuICAgICAgICBjb25zdCBzY3JpcHRJZCA9ICRlbGVtZW50LmF0dHIoJ2lkJyk7XG4gICAgICAgIGlmIChzY3JpcHRJZCkge1xuICAgICAgICAgIGNvbnN0IHNjcmlwdCA9IHRoaXMuc2NyaXB0TWFuYWdlci5nZXRTY3JpcHRCeUlkKHNjcmlwdElkKTtcbiAgICAgICAgICBpZiAoc2NyaXB0KSB7XG4gICAgICAgICAgICBwcmV2aW91c0NoYXJhY3RlclNjcmlwdHMucHVzaChzY3JpcHQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgdGhpcy5zY3JpcHRNYW5hZ2VyLnN0b3BTY3JpcHRzQnlUeXBlKHByZXZpb3VzQ2hhcmFjdGVyU2NyaXB0cywgU2NyaXB0VHlwZS5DSEFSQUNURVIpO1xuXG4gICAgY29uc3Qgc2NyaXB0RGF0YSA9IFNjcmlwdERhdGEuZ2V0SW5zdGFuY2UoKTtcbiAgICBjb25zdCBnbG9iYWxTY3JpcHRzID0gdGhpcy5zY3JpcHRNYW5hZ2VyLmdldEdsb2JhbFNjcmlwdHMoKTtcbiAgICBjb25zdCBjaGFyYWN0ZXJTY3JpcHRzID0gdGhpcy5zY3JpcHRNYW5hZ2VyLmdldENoYXJhY3RlclNjcmlwdHMoKTtcblxuICAgIHRoaXMuc2NyaXB0TWFuYWdlci5yZWZyZXNoQ2hhcmFjdGVyU2NyaXB0RW5hYmxlZFN0YXRlKCk7XG5cbiAgICBsb2cuaW5mbygnW1NjcmlwdE1hbmFnZXJdIOWIt+aWsOinkuiJsuiEmuacrOW6kycpO1xuXG4gICAgaWYgKHRoaXNfY2hpZCAmJiBjaGFyYWN0ZXJTY3JpcHRzLmxlbmd0aCA+IDApIHtcbiAgICAgIGF3YWl0IHRoaXMudWlNYW5hZ2VyLmNoZWNrRW1iZWRkZWRTY3JpcHRzKHRoaXNfY2hpZCk7XG4gICAgfVxuXG4gICAgY29uc3QgY29uZmxpY3RTY3JpcHRzID0gY2hhcmFjdGVyU2NyaXB0cy5maWx0ZXIoY2hhclNjcmlwdCA9PlxuICAgICAgZ2xvYmFsU2NyaXB0cy5zb21lKGdsb2JhbFNjcmlwdCA9PiBnbG9iYWxTY3JpcHQuaWQgPT09IGNoYXJTY3JpcHQuaWQpLFxuICAgICk7XG5cbiAgICBpZiAoY29uZmxpY3RTY3JpcHRzLmxlbmd0aCA+IDApIHtcbiAgICAgIGxvZy5pbmZvKGBbU2NyaXB0TWFuYWdlcl0g5Y+R546wJHtjb25mbGljdFNjcmlwdHMubGVuZ3RofeS4quiEmuacrElE5Yay56qBYCk7XG5cbiAgICAgIGZvciAoY29uc3QgY2hhclNjcmlwdCBvZiBjb25mbGljdFNjcmlwdHMpIHtcbiAgICAgICAgY29uc3QgZ2xvYmFsU2NyaXB0ID0gZ2xvYmFsU2NyaXB0cy5maW5kKGdzID0+IGdzLmlkID09PSBjaGFyU2NyaXB0LmlkKSE7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2FsbEdlbmVyaWNQb3B1cChcbiAgICAgICAgICBg5YWo5bGA6ISa5pys5Lit5bey5a2Y5ZyoIFwiJHtnbG9iYWxTY3JpcHQubmFtZX1cIiDohJrmnKzvvIzmmK/lkKblhbPpl63lhrLnqoHohJrmnKzvvJ9gLFxuICAgICAgICAgIFBPUFVQX1RZUEUuVEVYVCxcbiAgICAgICAgICAnJyxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBva0J1dHRvbjogJ+WFs+mXreWFqOWxgCcsXG4gICAgICAgICAgICBjYW5jZWxCdXR0b246ICflhbPpl63lsYDpg6gnLFxuICAgICAgICAgIH0sXG4gICAgICAgICk7XG5cbiAgICAgICAgY2hhclNjcmlwdC5pZCA9IHV1aWR2NCgpO1xuXG4gICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICBpZiAoZ2xvYmFsU2NyaXB0LmVuYWJsZWQpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuc2NyaXB0TWFuYWdlci5zdG9wU2NyaXB0KGdsb2JhbFNjcmlwdCwgU2NyaXB0VHlwZS5HTE9CQUwpO1xuICAgICAgICAgICAgZ2xvYmFsU2NyaXB0LmVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIGxvZy5pbmZvKGBbU2NyaXB0TWFuYWdlcl0g5YWz6Zet5YWo5bGA6ISa5pysOiAke2dsb2JhbFNjcmlwdC5uYW1lfWApO1xuICAgICAgICAgICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5VSV9SRUZSRVNILCB7XG4gICAgICAgICAgICAgIGFjdGlvbjogJ3NjcmlwdF90b2dnbGUnLFxuICAgICAgICAgICAgICBzY3JpcHQ6IGdsb2JhbFNjcmlwdCxcbiAgICAgICAgICAgICAgdHlwZTogU2NyaXB0VHlwZS5HTE9CQUwsXG4gICAgICAgICAgICAgIGVuYWJsZTogZmFsc2UsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHNjcmlwdERhdGEuc2F2ZUdsb2JhbFNjcmlwdHMoZ2xvYmFsU2NyaXB0cyk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGNoYXJTY3JpcHQuZW5hYmxlZCkge1xuICAgICAgICAgIGNoYXJTY3JpcHQuZW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgIGF3YWl0IHNjcmlwdERhdGEuc2F2ZUNoYXJhY3RlclNjcmlwdHMoY2hhcmFjdGVyU2NyaXB0cyk7XG4gICAgICAgICAgbG9nLmluZm8oYFtTY3JpcHRNYW5hZ2VyXSDlhbPpl63lsYDpg6johJrmnKw6ICR7Y2hhclNjcmlwdC5uYW1lfWApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5VSV9SRUZSRVNILCB7IGFjdGlvbjogJ3JlZnJlc2hfY2hhcmFjdF9zY3JpcHRzJyB9KTtcbiAgICBjaGVja1FyRW5hYmxlZFN0YXR1c0FuZEFkZEJ1dHRvbigpO1xuICAgIGJpbmRRckVuYWJsZWRDaGFuZ2VMaXN0ZW5lcigpO1xuXG4gICAgYXdhaXQgdGhpcy5zY3JpcHRNYW5hZ2VyLnJ1blNjcmlwdHNCeVR5cGUoY2hhcmFjdGVyU2NyaXB0cywgU2NyaXB0VHlwZS5DSEFSQUNURVIpO1xuICB9XG5cbiAgLyoqXG4gICAqIOa4heeQhui1hOa6kFxuICAgKi9cbiAgcHVibGljIGFzeW5jIGNsZWFudXAoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGxvYWRfZXZlbnRzLmZvckVhY2goZXZlbnRUeXBlID0+IHtcbiAgICAgICAgZXZlbnRTb3VyY2UucmVtb3ZlTGlzdGVuZXIoZXZlbnRUeXBlLCB0aGlzLnJlZnJlc2hDaGFyYWN0ZXJSZXBvc2l0b3J5LmJpbmQodGhpcykpO1xuICAgICAgfSk7XG5cbiAgICAgIGF3YWl0IHRoaXMuc2NyaXB0TWFuYWdlci5jbGVhbnVwKCk7XG4gICAgICB0aGlzLnVpTWFuYWdlci5jbGVhbnVwKCk7XG5cbiAgICAgIHRoaXMuaW5pdGlhbGl6ZWQgPSBmYWxzZTtcbiAgICAgIGxvZy5pbmZvKCdbU2NyaXB0TWFuYWdlcl0g5riF55CG5a6M5oiQJyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZy5lcnJvcignW1NjcmlwdE1hbmFnZXJdIOa4heeQhuWksei0pTonLCBlcnJvcik7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICog5p6E5bu66ISa5pys5bqT5bqU55SoXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBidWlsZFNjcmlwdFJlcG9zaXRvcnkoKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IGFwcCA9IFNjcmlwdFJlcG9zaXRvcnlBcHAuZ2V0SW5zdGFuY2UoKTtcbiAgYXdhaXQgYXBwLmluaXRpYWxpemUoKTtcbn1cblxuLyoqXG4gKiDnp7vpmaTohJrmnKzlupPlupTnlKhcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbW92ZVNjcmlwdFJlcG9zaXRvcnkoKTogUHJvbWlzZTx2b2lkPiB7XG4gIFNjcmlwdFJlcG9zaXRvcnlBcHAuZGVzdHJveUluc3RhbmNlKCk7XG59XG5cbi8qKlxuICog5omp5bGV5byA5ZCv5pe25p6E5bu66ISa5pys5bqTXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBidWlsZFNjcmlwdFJlcG9zaXRvcnlPbkV4dGVuc2lvbigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgYXdhaXQgYnVpbGRTY3JpcHRSZXBvc2l0b3J5KCk7XG59XG5cbi8qKlxuICog5omp5bGV5YWz6Zet5pe26ZSA5q+B6ISa5pys5bqTXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkZXN0cm95U2NyaXB0UmVwb3NpdG9yeU9uRXh0ZW5zaW9uKCk6IHZvaWQge1xuICByZW1vdmVTY3JpcHRSZXBvc2l0b3J5KCk7XG59XG5cbmV4cG9ydCB7IFNjcmlwdFR5cGUgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/component/script_repository/index.ts\n")},"./src/component/script_repository/script_controller.ts":
/*!**************************************************************!*\
  !*** ./src/component/script_repository/script_controller.ts ***!
  \**************************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ScriptManager: () => (/* binding */ ScriptManager)\n/* harmony export */ });\n/* harmony import */ var _component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/message_iframe/render_message */ \"./src/component/message_iframe/render_message.ts\");\n/* harmony import */ var _component_script_repository_data__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/component/script_repository/data */ \"./src/component/script_repository/data.ts\");\n/* harmony import */ var _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/component/script_repository/events */ \"./src/component/script_repository/events.ts\");\n/* harmony import */ var _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/component/script_repository/types */ \"./src/component/script_repository/types.ts\");\n/* harmony import */ var _script_url__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/script_url */ \"./src/script_url.ts\");\n/* harmony import */ var _third_party_html__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/third_party.html */ \"./src/third_party.html\");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @sillytavern/scripts/popup */ \"@sillytavern/scripts/popup\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_9__);\n\n\n\n\n\n\n\n\n\n\nclass ScriptExecutor {\n    /**\n     * 创建并运行单个脚本\n     * @param script 脚本\n     * @param type 脚本类型\n     */\n    async runScript(script, type) {\n        const typeName = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? '全局' : '局部';\n        try {\n            const iframeElement = $('iframe').filter((_index, element) => $(element).attr('script-id') === script.id)[0];\n            if (iframeElement) {\n                await (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_0__.destroyIframe)(iframeElement);\n            }\n            const htmlContent = this.createScriptHtml(script);\n            const $iframe = $('<iframe>', {\n                style: 'display: none;',\n                id: `tavern-helper-script-${script.name}`,\n                srcdoc: htmlContent,\n                'script-id': script.id,\n            });\n            $iframe.on('load', () => {\n                loglevel__WEBPACK_IMPORTED_MODULE_9___default().info(`[ScriptManager] 启用${typeName}脚本[\"${script.name}\"]`);\n            });\n            $('body').append($iframe);\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_9___default().error(`[ScriptManager] ${typeName}脚本启用失败:[\"${script.name}\"]`, error);\n            toastr.error(`${typeName}脚本启用失败:[\"${script.name}\"]`);\n            throw error;\n        }\n    }\n    /**\n     * 停止单个脚本，并销毁iframe\n     * @param script 脚本\n     * @param type 脚本类型\n     */\n    async stopScript(script, type) {\n        const typeName = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? '全局' : '局部';\n        const iframeElement = $('iframe').filter((_index, element) => $(element).attr('script-id') === script.id)[0];\n        if (iframeElement) {\n            await (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_0__.destroyIframe)(iframeElement);\n            loglevel__WEBPACK_IMPORTED_MODULE_9___default().info(`[ScriptManager] 禁用${typeName}脚本[\"${script.name}\"]`);\n        }\n    }\n    /**\n     * 创建运行脚本的HTML内容\n     * @param script 脚本对象\n     * @returns HTML内容\n     */\n    createScriptHtml(script) {\n        return `\n      <html>\n      <head>\n        ${_third_party_html__WEBPACK_IMPORTED_MODULE_5__[\"default\"]}\n        <script>\n          (function ($) {\n            var original$ = $;\n            window.$ = function (selector, context) {\n              if (context === undefined || context === null) {\n                if (window.parent && window.parent.document) {\n                  context = window.parent.document;\n                } else {\n                  log.warn('无法访问 window.parent.document，将使用当前 iframe 的 document 作为上下文。');\n                  context = window.document;\n                }\n              }\n              return original$(selector, context);\n            };\n          })(jQuery);\n        <\/script>\n        <script src=\"${_script_url__WEBPACK_IMPORTED_MODULE_4__.script_url.get('iframe_client')}\"><\/script>\n      </head>\n      <body>\n        <script type=\"module\">\n          ${script.content}\n        <\/script>\n      </body>\n      </html>\n    `;\n    }\n    /**\n     * 清理所有脚本iframe\n     */\n    async clearAllScriptsIframe() {\n        const $iframes = $('iframe[id^=\"tavern-helper-script-\"]');\n        for (const iframe of $iframes) {\n            await (0,_component_message_iframe_render_message__WEBPACK_IMPORTED_MODULE_0__.destroyIframe)(iframe);\n        }\n    }\n}\nclass ScriptManager {\n    static instance;\n    scriptData;\n    executor;\n    constructor() {\n        this.scriptData = _component_script_repository_data__WEBPACK_IMPORTED_MODULE_1__.ScriptData.getInstance();\n        this.executor = new ScriptExecutor();\n        this.registerEventListeners();\n    }\n    /**\n     * 获取脚本管理器实例\n     */\n    static getInstance() {\n        if (!ScriptManager.instance) {\n            ScriptManager.instance = new ScriptManager();\n        }\n        return ScriptManager.instance;\n    }\n    /**\n     * 销毁脚本管理器实例\n     */\n    static destroyInstance() {\n        if (ScriptManager.instance) {\n            ScriptManager.instance = undefined;\n        }\n    }\n    /**\n     * 注册事件监听器\n     */\n    registerEventListeners() {\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.SCRIPT_TOGGLE, async (data) => {\n            const { script, type, enable, userInput = true } = data;\n            await this.toggleScript(script, type, enable, userInput);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.TYPE_TOGGLE, async (data) => {\n            const { type, enable, userInput = true } = data;\n            await this.toggleScriptType(type, enable, userInput);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.SCRIPT_IMPORT, async (data) => {\n            const { file, type } = data;\n            await this.importScript(file, type);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.SCRIPT_DELETE, async (data) => {\n            const { scriptId, type } = data;\n            await this.deleteScript(scriptId, type);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.SCRIPT_CREATE, async (data) => {\n            const { script, type } = data;\n            await this.createScript(script, type);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.SCRIPT_UPDATE, async (data) => {\n            const { script, type } = data;\n            await this.updateScript(script, type);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.SCRIPT_MOVE, async (data) => {\n            const { script, fromType } = data;\n            await this.moveScript(script, fromType);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.FOLDER_MOVE, async (data) => {\n            const { folderId, fromType } = data;\n            await this.moveFolder(folderId, fromType);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.ORDER_CHANGED, async (data) => {\n            const { data: orderData, type } = data;\n            await this.saveOrder(orderData, type);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_LOADED, async () => {\n            if (!(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_6__.getSettingValue)('enabled_extension')) {\n                return;\n            }\n            const globalScripts = this.scriptData.getGlobalScripts();\n            const characterScripts = this.scriptData.getCharacterScripts();\n            if (this.scriptData.isGlobalScriptEnabled) {\n                await this.runScriptsByType(globalScripts, _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL);\n            }\n            else {\n                loglevel__WEBPACK_IMPORTED_MODULE_9___default().info('[ScriptManager] 全局脚本类型未启用，跳过运行全局脚本');\n            }\n            if (this.scriptData.isCharacterScriptEnabled) {\n                await this.runScriptsByType(characterScripts, _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER);\n            }\n            else {\n                loglevel__WEBPACK_IMPORTED_MODULE_9___default().info('[ScriptManager] 角色脚本类型未启用，跳过运行角色脚本');\n            }\n        });\n    }\n    /**\n     * 切换脚本启用状态\n     * @param script 脚本\n     * @param type 脚本类型\n     * @param enable 是否启用\n     * @param userInput 是否由用户输入\n     */\n    async toggleScript(script, type, enable, userInput = true) {\n        if (userInput) {\n            script.enabled = enable;\n            await this.scriptData.saveScript(script, type);\n        }\n        try {\n            if (enable) {\n                if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL && !this.scriptData.isGlobalScriptEnabled) {\n                    loglevel__WEBPACK_IMPORTED_MODULE_9___default().info(`[script_manager] 全局脚本类型未启用，跳过启用脚本[\"${script.name}\"]`);\n                    return;\n                }\n                if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER && !this.scriptData.isCharacterScriptEnabled) {\n                    loglevel__WEBPACK_IMPORTED_MODULE_9___default().info(`[script_manager] 角色脚本类型未启用，跳过启用脚本[\"${script.name}\"]`);\n                    return;\n                }\n                await this.runScript(script, type);\n            }\n            else {\n                await this.stopScript(script, type);\n            }\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, {\n                action: 'script_toggle',\n                script,\n                type,\n                enable,\n            });\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_9___default().error(`[ScriptManager] 切换脚本状态失败: ${script.name}`, error);\n            toastr.error(`切换脚本状态失败: ${script.name}`);\n        }\n    }\n    /**\n     * 切换脚本类型启用状态\n     * @param type 脚本类型\n     * @param enable 是否启用\n     * @param userInput 是否由用户输入\n     */\n    async toggleScriptType(type, enable, userInput = true) {\n        if (userInput) {\n            await this.scriptData.updateScriptTypeEnableState(type, enable);\n        }\n        try {\n            const scripts = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? this.scriptData.getGlobalScripts() : this.scriptData.getCharacterScripts();\n            if (enable) {\n                await this.runScriptsByType(scripts, type);\n            }\n            else {\n                await this.stopScriptsByType(scripts, type);\n            }\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, {\n                action: 'type_toggle',\n                type,\n                enable,\n            });\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_9___default().error(`[ScriptManager] 切换脚本类型状态失败: ${type}`, error);\n            toastr.error(`切换脚本类型状态失败: ${type}`);\n        }\n    }\n    /**\n     * 运行单个脚本\n     * @param script 脚本\n     * @param type 脚本类型\n     */\n    async runScript(script, type) {\n        if (!(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_6__.getSettingValue)('enabled_extension')) {\n            toastr.error('[ScriptManager] 扩展未启用');\n            return;\n        }\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL && !this.scriptData.isGlobalScriptEnabled) {\n            return;\n        }\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER && !this.scriptData.isCharacterScriptEnabled) {\n            return;\n        }\n        await this.executor.runScript(script, type);\n        if (script.buttons && script.buttons.length > 0) {\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.BUTTON_ADD, { script });\n        }\n    }\n    /**\n     * 停止单个脚本\n     * @param script 脚本\n     * @param type 脚本类型\n     */\n    async stopScript(script, type) {\n        await this.executor.stopScript(script, type);\n        if (script.buttons && script.buttons.length > 0) {\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.BUTTON_REMOVE, { scriptId: script.id });\n        }\n    }\n    /**\n     * 运行指定类型的所有脚本\n     * @param scripts 脚本列表\n     * @param type 脚本类型\n     */\n    async runScriptsByType(scripts, type) {\n        if (!(0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_6__.getSettingValue)('enabled_extension')) {\n            toastr.error('[ScriptManager] 酒馆助手未启用，无法运行脚本');\n            return;\n        }\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL && !this.scriptData.isGlobalScriptEnabled) {\n            return;\n        }\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER && !this.scriptData.isCharacterScriptEnabled) {\n            return;\n        }\n        const enabledScripts = scripts.filter(script => script.enabled);\n        for (const script of enabledScripts) {\n            await this.executor.runScript(script, type);\n            if (script.buttons && script.buttons.length > 0) {\n                _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.BUTTON_ADD, { script });\n            }\n        }\n    }\n    /**\n     * 停止指定类型的所有脚本\n     * @param scripts 脚本列表\n     * @param type 脚本类型\n     */\n    async stopScriptsByType(scripts, type) {\n        const enabledScripts = scripts.filter(script => script.enabled);\n        for (const script of enabledScripts) {\n            await this.executor.stopScript(script, type);\n            if (script.buttons && script.buttons.length > 0) {\n                _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.BUTTON_REMOVE, { scriptId: script.id });\n            }\n        }\n    }\n    /**\n     * 导入脚本或文件夹\n     * @param file 脚本文件或文件夹导出文件\n     * @param type 导入目标类型\n     */\n    async importScript(file, type) {\n        try {\n            if (file.name.toLowerCase().endsWith('.zip')) {\n                await this.importFromZip(file, type);\n            }\n            else if (file.name.toLowerCase().endsWith('.json')) {\n                const content = await this.readFileAsText(file);\n                const importData = JSON.parse(content);\n                if (Array.isArray(importData)) {\n                    await this.importMultipleItems(importData, type);\n                }\n                else {\n                    await this.importSingleScript(importData, type);\n                }\n            }\n            else {\n                throw new Error('不支持的文件格式，请选择 .json 或 .zip 文件');\n            }\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_9___default().error('[ScriptManager] 导入失败:', error);\n            toastr.error(`导入失败: ${error instanceof Error ? error.message : '无效的文件格式'}`);\n        }\n    }\n    /**\n     * 从ZIP文件导入\n     * @param file ZIP文件\n     * @param type 脚本类型\n     */\n    async importFromZip(file, type) {\n        //@ts-ignore\n        if (!window.JSZip) {\n            loglevel__WEBPACK_IMPORTED_MODULE_9___default().info('import jszip');\n            await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @sillytavern/lib/jszip.min.js */ \"@sillytavern/lib/jszip.min.js\"));\n        }\n        //@ts-ignore\n        const zip = new JSZip();\n        const zipContent = await zip.loadAsync(file);\n        let importedScripts = 0;\n        let importedFolders = 0;\n        const folders = new Set();\n        const rootScripts = [];\n        for (const fileName in zipContent.files) {\n            const file = zipContent.files[fileName];\n            if (!file.dir && fileName.endsWith('.json')) {\n                const pathParts = fileName.split('/');\n                if (pathParts.length === 1) {\n                    rootScripts.push(fileName);\n                }\n                else if (pathParts.length === 2) {\n                    folders.add(pathParts[0]);\n                }\n            }\n        }\n        for (const fileName of rootScripts) {\n            const file = zipContent.files[fileName];\n            const scriptContent = await file.async('string');\n            const scriptData = JSON.parse(scriptContent);\n            if (scriptData.name && 'content' in scriptData) {\n                const script = new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.Script({\n                    ...scriptData,\n                    enabled: false,\n                });\n                await this.handleScriptImport(script, type);\n                importedScripts++;\n            }\n        }\n        for (const folderName of folders) {\n            const folderScriptCount = await this.importFolderFromZipNew(zipContent, folderName, type);\n            importedScripts += folderScriptCount;\n            importedFolders++;\n        }\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, {\n            action: type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? 'refresh_global_scripts' : 'refresh_charact_scripts',\n        });\n        toastr.success(`成功导入 ${importedScripts} 个脚本和 ${importedFolders} 个文件夹`);\n    }\n    /**\n     * 从ZIP中导入文件夹\n     * @param zipContent ZIP内容\n     * @param folderName 文件夹名称\n     * @param type 脚本类型\n     * @returns 导入的脚本数量\n     */\n    async importFolderFromZipNew(zipContent, folderName, type) {\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL\n            ? this.scriptData.getGlobalRepositoryItems()\n            : this.scriptData.getCharacterRepositoryItems();\n        let finalFolderName = folderName;\n        let counter = 1;\n        while (repository.some(item => item.type === 'folder' && item.name === finalFolderName)) {\n            finalFolderName = `${folderName}_${counter}`;\n            counter++;\n        }\n        const folderId = await this.scriptData.createFolder(finalFolderName, type);\n        let folderScriptCount = 0;\n        for (const fileName in zipContent.files) {\n            const file = zipContent.files[fileName];\n            if (!file.dir && fileName.startsWith(`${folderName}/`) && fileName.endsWith('.json')) {\n                const scriptContent = await file.async('string');\n                const scriptData = JSON.parse(scriptContent);\n                if (scriptData.name && 'content' in scriptData) {\n                    const script = new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.Script({\n                        ...scriptData,\n                        enabled: false,\n                    });\n                    await this.handleScriptImport(script, type);\n                    await this.scriptData.moveScriptToFolder(script.id, folderId, type);\n                    folderScriptCount++;\n                }\n            }\n        }\n        return folderScriptCount;\n    }\n    /**\n     * 导入单个脚本\n     * @param scriptData 脚本数据\n     * @param type 脚本类型\n     */\n    async importSingleScript(scriptData, type) {\n        if (!scriptData.name || !('content' in scriptData)) {\n            throw new Error('无效的脚本数据');\n        }\n        const scriptToImport = new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.Script({\n            ...scriptData,\n            enabled: false,\n        });\n        await this.handleScriptImport(scriptToImport, type);\n        toastr.success(`脚本 '${scriptToImport.name}' 导入成功。`);\n    }\n    /**\n     * 导入多个项目（脚本或文件夹）\n     * @param items 项目数组\n     * @param type 脚本类型\n     */\n    async importMultipleItems(items, type) {\n        let importedCount = 0;\n        let folderCount = 0;\n        let scriptCount = 0;\n        for (const item of items) {\n            if (item.type === 'folder') {\n                await this.importFolder(item, type);\n                folderCount++;\n                importedCount++;\n            }\n            else if (item.type === 'script') {\n                const script = new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.Script({\n                    ...item.value,\n                    enabled: false,\n                });\n                await this.handleScriptImport(script, type);\n                scriptCount++;\n                importedCount++;\n            }\n            else if (item.name && 'content' in item) {\n                const script = new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.Script({\n                    ...item,\n                    enabled: false,\n                });\n                await this.handleScriptImport(script, type);\n                scriptCount++;\n                importedCount++;\n            }\n        }\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, {\n            action: type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? 'refresh_global_scripts' : 'refresh_charact_scripts',\n        });\n        toastr.success(`导入成功`);\n    }\n    /**\n     * 导入文件夹\n     * @param folderData 文件夹数据\n     * @param type 脚本类型\n     */\n    async importFolder(folderData, type) {\n        if (!folderData.name || !Array.isArray(folderData.value)) {\n            throw new Error('无效的文件夹数据');\n        }\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL\n            ? this.scriptData.getGlobalRepositoryItems()\n            : this.scriptData.getCharacterRepositoryItems();\n        let folderName = folderData.name;\n        let counter = 1;\n        while (repository.some(item => item.type === 'folder' && item.name === folderName)) {\n            folderName = `${folderData.name}_${counter}`;\n            counter++;\n        }\n        const folderId = await this.scriptData.createFolder(folderName, type);\n        for (const scriptData of folderData.value) {\n            const script = new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.Script({\n                ...scriptData,\n                enabled: false,\n            });\n            await this.handleScriptImport(script, type);\n            await this.scriptData.moveScriptToFolder(script.id, folderId, type);\n        }\n    }\n    /**\n     * 处理脚本导入冲突\n     * @param script 要导入的脚本\n     * @param type 目标类型\n     */\n    async handleScriptImport(script, type) {\n        const globalScripts = this.scriptData.getGlobalScripts();\n        const characterScripts = this.scriptData.getCharacterScripts();\n        const conflictInGlobal = globalScripts.find(s => s.id === script.id);\n        const conflictInCharacter = characterScripts.find(s => s.id === script.id);\n        let existingScript;\n        let conflictType;\n        if (conflictInGlobal) {\n            existingScript = conflictInGlobal;\n            conflictType = _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL;\n        }\n        else if (conflictInCharacter) {\n            existingScript = conflictInCharacter;\n            conflictType = _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER;\n        }\n        if (existingScript && conflictType) {\n            const action = await this.handleScriptIdConflict(script, existingScript, type, 'import');\n            switch (action) {\n                case 'new':\n                    script.id = (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_8__.uuidv4)();\n                    await this.createScript(script, type);\n                    break;\n                case 'override':\n                    await this.deleteScript(existingScript.id, conflictType);\n                    await this.createScript(script, type);\n                    break;\n                case 'cancel':\n                    return;\n            }\n        }\n        else {\n            await this.createScript(script, type);\n        }\n    }\n    /**\n     * 读取文件内容为文本\n     * @param file 文件对象\n     * @returns 文件内容\n     */\n    readFileAsText(file) {\n        return new Promise((resolve, reject) => {\n            const reader = new FileReader();\n            reader.onload = e => resolve(e.target?.result);\n            reader.onerror = e => reject(e);\n            reader.readAsText(file);\n        });\n    }\n    /**\n     * 创建新脚本\n     * @param script 脚本\n     * @param type 脚本类型\n     */\n    async createScript(script, type) {\n        await this.scriptData.saveScript(script, type);\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, {\n            action: 'script_create',\n            script,\n            type,\n        });\n    }\n    /**\n     * 更新现有脚本\n     * @param script 脚本\n     * @param type 脚本类型\n     */\n    async updateScript(script, type) {\n        await this.scriptData.saveScript(script, type);\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, {\n            action: 'script_update',\n            script,\n            type,\n        });\n    }\n    /**\n     * 统一保存排序方法 - 保存仓库项排序\n     * @param repositoryItems 仓库项数组（包含文件夹和脚本的混合结构）\n     * @param type 脚本类型\n     */\n    async saveOrder(repositoryItems, type) {\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL) {\n            await this.scriptData.saveGlobalRepositoryItems(repositoryItems);\n        }\n        else {\n            await this.scriptData.saveCharacterRepositoryItems(repositoryItems);\n        }\n        this.scriptData.loadScripts();\n    }\n    /**\n     * 删除脚本\n     * @param scriptId 脚本ID\n     * @param type 脚本类型\n     */\n    async deleteScript(scriptId, type) {\n        const script = this.scriptData.getScriptById(scriptId);\n        if (!script) {\n            throw new Error('[ScriptManager] 脚本不存在');\n        }\n        await this.stopScript(script, type);\n        await this.scriptData.deleteScript(scriptId, type);\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, {\n            action: 'script_delete',\n            scriptId,\n            type,\n        });\n    }\n    /**\n     * 移动脚本到另一个类型\n     * @param script 脚本\n     * @param fromType 源类型\n     */\n    async moveScript(script, fromType) {\n        await this.stopScript(script, fromType);\n        const targetType = (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getOppositeScriptType)(fromType);\n        const existingScriptInTarget = this.scriptData.getScriptById(script.id);\n        const existingScriptType = existingScriptInTarget ? this.scriptData.getScriptType(existingScriptInTarget) : null;\n        if (existingScriptInTarget && existingScriptType === targetType) {\n            const action = await this.handleScriptIdConflict(script, existingScriptInTarget, targetType, 'move');\n            switch (action) {\n                case 'new':\n                    script.id = (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_8__.uuidv4)();\n                    break;\n                case 'override':\n                    await this.deleteScript(existingScriptInTarget.id, targetType);\n                    break;\n                case 'cancel':\n                    return;\n            }\n        }\n        await this.scriptData.moveItemToOtherType({ type: 'script', id: script.id, value: script }, fromType);\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, {\n            action: 'script_move',\n            script,\n            fromType,\n            targetType,\n        });\n        if (script.enabled &&\n            ((targetType === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL && this.scriptData.isGlobalScriptEnabled) ||\n                (targetType === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER && this.scriptData.isCharacterScriptEnabled))) {\n            await this.runScript(script, targetType);\n        }\n    }\n    /**\n     * 刷新角色脚本数据\n     */\n    refreshCharacterScriptData() {\n        this.scriptData.getCharacterScripts();\n    }\n    /**\n     * 获取全局脚本\n     */\n    getGlobalScripts() {\n        return this.scriptData.getGlobalScripts();\n    }\n    /**\n     * 获取角色脚本\n     */\n    getCharacterScripts() {\n        return this.scriptData.getCharacterScripts();\n    }\n    /**\n     * 刷新角色脚本启用状态\n     */\n    refreshCharacterScriptEnabledState() {\n        this.scriptData.refreshCharacterScriptEnabledState();\n    }\n    /**\n     * 获取全局脚本启用状态\n     */\n    get isGlobalScriptEnabled() {\n        return this.scriptData.isGlobalScriptEnabled;\n    }\n    /**\n     * 获取角色脚本启用状态\n     */\n    get isCharacterScriptEnabled() {\n        return this.scriptData.isCharacterScriptEnabled;\n    }\n    /**\n     * 根据ID获取脚本\n     * @param id 脚本ID\n     */\n    getScriptById(id) {\n        return this.scriptData.getScriptById(id);\n    }\n    /**\n     * 获取全局脚本仓库项（包含文件夹结构）\n     */\n    getGlobalRepositoryItems() {\n        return this.scriptData.getGlobalRepositoryItems();\n    }\n    /**\n     * 获取角色脚本仓库项（包含文件夹结构）\n     */\n    getCharacterRepositoryItems() {\n        return this.scriptData.getCharacterRepositoryItems();\n    }\n    /**\n     * 创建文件夹\n     */\n    async createFolder(name, type, icon, color) {\n        return await this.scriptData.createFolder(name, type, icon, color);\n    }\n    /**\n     * 重命名文件夹\n     */\n    async editFolder(folderId, newName, type, newIcon, newColor) {\n        await this.scriptData.editFolder(folderId, newName, type, newIcon, newColor);\n    }\n    /**\n     * 删除文件夹\n     */\n    async deleteFolder(folderId, type) {\n        await this.scriptData.deleteFolder(folderId, type);\n    }\n    /**\n     * 将脚本移动到文件夹\n     */\n    async moveScriptToFolder(scriptId, targetFolderId, type) {\n        await this.scriptData.moveScriptToFolder(scriptId, targetFolderId, type);\n    }\n    /**\n     * 将文件夹移动到其他类型\n     * @param folderId 文件夹ID\n     * @param fromType 源类型\n     */\n    async moveFolder(folderId, fromType) {\n        const targetType = (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getOppositeScriptType)(fromType);\n        await this.scriptData.moveItemToOtherType({ type: 'folder', id: folderId }, fromType);\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, {\n            action: 'folder_move',\n            folderId,\n            fromType,\n            targetType,\n        });\n    }\n    /**\n     * 获取文件夹中的脚本\n     */\n    getFolderScripts(folderId, type) {\n        return this.scriptData.getFolderScripts(folderId, type);\n    }\n    /**\n     * 获取根级别的脚本\n     */\n    getRootScripts(type) {\n        return this.scriptData.getRootScripts(type);\n    }\n    /**\n     * 获取所有文件夹\n     */\n    getFolders(type) {\n        return this.scriptData.getFolders(type);\n    }\n    /**\n     * 批量切换文件夹内所有脚本的启用状态\n     * @param folderId 文件夹ID\n     * @param type 脚本类型\n     * @param enable 是否启用\n     */\n    async toggleFolderScripts(folderId, type, enable) {\n        try {\n            await this.scriptData.toggleFolderScripts(folderId, type, enable);\n            const scripts = this.scriptData.getFolderScripts(folderId, type);\n            const isTypeEnabled = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? this.scriptData.isGlobalScriptEnabled : this.scriptData.isCharacterScriptEnabled;\n            if (isTypeEnabled) {\n                for (const script of scripts) {\n                    if (enable && script.enabled) {\n                        await this.runScript(script, type);\n                    }\n                    else if (!enable) {\n                        await this.stopScript(script, type);\n                    }\n                }\n            }\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.UI_REFRESH, {\n                action: 'folder_scripts_toggle',\n                folderId,\n                type,\n                enable,\n            });\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_9___default().error(`[ScriptManager] 批量切换文件夹脚本状态失败: ${folderId}`, error);\n            toastr.error(`批量切换文件夹脚本状态失败`);\n        }\n    }\n    /**\n     * 获取文件夹内脚本的整体启用状态\n     * @param folderId 文件夹ID\n     * @param type 脚本类型\n     */\n    getFolderScriptsState(folderId, type) {\n        return this.scriptData.getFolderScriptsState(folderId, type);\n    }\n    /**\n     * 获取指定脚本的按钮数组\n     * @param scriptId 脚本ID\n     * @returns 按钮数组\n     */\n    getScriptButton(scriptId) {\n        const script = this.scriptData.getScriptById(scriptId);\n        if (!script) {\n            loglevel__WEBPACK_IMPORTED_MODULE_9___default().warn(`[ScriptManager] 脚本不存在: ${scriptId}`);\n            return [];\n        }\n        return script.buttons;\n    }\n    /**\n     * 修改后更新脚本按钮（仅重建按钮，不重启脚本）\n     * @param script 脚本对象\n     * @param type 脚本类型\n     */\n    async setScriptButton(script, type) {\n        await this.scriptData.saveScript(script, type);\n        if (script.enabled) {\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.BUTTON_REMOVE, { scriptId: script.id });\n            if (script.buttons && script.buttons.length > 0) {\n                _component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_2__.ScriptRepositoryEventType.BUTTON_ADD, { script });\n            }\n        }\n    }\n    /**\n     * 获取指定脚本的变量数据\n     * @param scriptId 脚本ID\n     * @returns 脚本的data字段，如果脚本不存在返回空对象\n     */\n    getScriptVariables(scriptId) {\n        const script = this.scriptData.getScriptById(scriptId);\n        if (!script) {\n            loglevel__WEBPACK_IMPORTED_MODULE_9___default().warn(`[ScriptManager] 脚本不存在: ${scriptId}`);\n            return {};\n        }\n        return script.data || {};\n    }\n    /**\n     * 更新指定脚本的变量数据\n     * @param scriptId 脚本ID\n     * @param variables 新的变量数据\n     * @param type 脚本类型\n     * @returns 是否更新成功\n     */\n    async updateScriptVariables(scriptId, variables, type) {\n        const script = this.scriptData.getScriptById(scriptId);\n        if (!script) {\n            loglevel__WEBPACK_IMPORTED_MODULE_9___default().warn(`[ScriptManager] 脚本不存在: ${scriptId}`);\n            return false;\n        }\n        script.data = variables;\n        await this.scriptData.saveScript(script, type);\n        loglevel__WEBPACK_IMPORTED_MODULE_9___default().info(`[ScriptManager] 已更新脚本变量: ${script.name}`);\n        return true;\n    }\n    /**\n     * 获取所有脚本的变量数据（用于调试和管理）\n     * @param type 脚本类型\n     * @returns 所有脚本的变量数据映射\n     */\n    getAllScriptVariables(type) {\n        const scripts = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? this.scriptData.getGlobalScripts() : this.scriptData.getCharacterScripts();\n        const variablesMap = new Map();\n        scripts.forEach(script => {\n            if (script.data && Object.keys(script.data).length > 0) {\n                variablesMap.set(script.id, script.data);\n            }\n        });\n        return variablesMap;\n    }\n    /**\n     * 清理所有资源\n     */\n    async cleanup() {\n        await this.executor.clearAllScriptsIframe();\n    }\n    /**\n     * 处理脚本ID冲突\n     * @param script 要处理的脚本\n     * @param existingScript 已存在的脚本\n     * @param targetType 目标类型\n     * @param operationType 操作类型：'import' - 导入, 'move' - 移动\n     * @returns 处理结果：'new' - 使用新ID, 'override' - 覆盖已有脚本, 'cancel' - 取消操作\n     */\n    async handleScriptIdConflict(script, existingScript, targetType, operationType = 'import') {\n        const existingScriptType = this.scriptData.getScriptType(existingScript);\n        const existingTypeText = existingScriptType === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? '全局脚本' : '角色脚本';\n        const targetTypeText = targetType === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? '全局脚本' : '角色脚本';\n        let message;\n        if (operationType === 'import') {\n            message = `要导入的脚本 '${script.name}' 与${existingTypeText}库中的 '${existingScript.name}' id 相同，是否要继续操作？`;\n        }\n        else {\n            message = `要移动到${targetTypeText}库的脚本 '${script.name}' 与目标库中的 '${existingScript.name}' id 相同，是否要继续操作？`;\n        }\n        const input = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_7__.callGenericPopup)(message, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_7__.POPUP_TYPE.TEXT, '', {\n            okButton: '覆盖原脚本',\n            cancelButton: '取消',\n            customButtons: ['新建脚本'],\n        });\n        let action = 'cancel';\n        switch (input) {\n            case 0:\n                action = 'cancel';\n                break;\n            case 1:\n                action = 'override';\n                break;\n            case 2:\n                action = 'new';\n                break;\n        }\n        return action;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3NjcmlwdF9jb250cm9sbGVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUEwRTtBQUNWO0FBQytCO0FBT2xEO0FBQ0g7QUFDRztBQUNnQjtBQUVhO0FBQ3RCO0FBRXpCO0FBRTNCLE1BQU0sY0FBYztJQUNsQjs7OztPQUlHO0lBQ0gsS0FBSyxDQUFDLFNBQVMsQ0FBQyxNQUFjLEVBQUUsSUFBZ0I7UUFDOUMsTUFBTSxRQUFRLEdBQUcsSUFBSSxLQUFLLDBFQUFVLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztRQUUxRCxJQUFJLENBQUM7WUFDSCxNQUFNLGFBQWEsR0FBRyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsTUFBTSxDQUN0QyxDQUFDLE1BQU0sRUFBRSxPQUFPLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLEtBQUssTUFBTSxDQUFDLEVBQUUsQ0FDaEUsQ0FBQyxDQUFDLENBQWtCLENBQUM7WUFFdEIsSUFBSSxhQUFhLEVBQUUsQ0FBQztnQkFDbEIsTUFBTSx1RkFBYSxDQUFDLGFBQWEsQ0FBQyxDQUFDO1lBQ3JDLENBQUM7WUFFRCxNQUFNLFdBQVcsR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsTUFBTSxDQUFDLENBQUM7WUFFbEQsTUFBTSxPQUFPLEdBQUcsQ0FBQyxDQUFDLFVBQVUsRUFBRTtnQkFDNUIsS0FBSyxFQUFFLGdCQUFnQjtnQkFDdkIsRUFBRSxFQUFFLHdCQUF3QixNQUFNLENBQUMsSUFBSSxFQUFFO2dCQUN6QyxNQUFNLEVBQUUsV0FBVztnQkFDbkIsV0FBVyxFQUFFLE1BQU0sQ0FBQyxFQUFFO2FBQ3ZCLENBQUMsQ0FBQztZQUVILE9BQU8sQ0FBQyxFQUFFLENBQUMsTUFBTSxFQUFFLEdBQUcsRUFBRTtnQkFDdEIsb0RBQVEsQ0FBQyxxQkFB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LEdBQUcsSUFBSSxDQUFDO1lBQzlCLE1BQU0sSUFBSSxDQUFDLFlBQVksQ0FBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDeEMsQ0FBQyxDQUFDLENBQUM7UUFFSCw2RUFBWSxDQUFDLEVBQUUsQ0FBQywwRkFBeUIsQ0FBQyxhQUFhLEVBQUUsS0FBSyxFQUFDLElBQUksRUFBQyxFQUFFO1lBQ3BFLE1BQU0sRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLEdBQUcsSUFBSSxDQUFDO1lBQzlCLE1BQU0sSUFBSSxDQUFDLFlBQVksQ0FBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDeEMsQ0FBQyxDQUFDLENBQUM7UUFFSCw2RUFBWSxDQUFDLEVBQUUsQ0FBQywwRkFBeUIsQ0FBQyxXQUFXLEVBQUUsS0FBSyxFQUFDLElBQUksRUFBQyxFQUFFO1lBQ2xFLE1BQU0sRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLEdBQUcsSUFBSSxDQUFDO1lBQ2xDLE1BQU0sSUFBSSxDQUFDLFVBQVUsQ0FBQyxNQUFNLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDMUMsQ0FBQyxDQUFDLENBQUM7UUFFSCw2RUFBWSxDQUFDLEVBQUUsQ0FBQywwRkFBeUIsQ0FBQyxXQUFXLEVBQUUsS0FBSyxFQUFDLElBQUksRUFBQyxFQUFFO1lBQ2xFLE1BQU0sRUFBRSxRQUFRLEVBQUUsUUFBUSxFQUFFLEdBQUcsSUFBSSxDQUFDO1lBQ3BDLE1BQU0sSUFBSSxDQUFDLFVBQVUsQ0FBQyxRQUFRLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDNUMsQ0FBQyxDQUFDLENBQUM7UUFFSCw2RUFBWSxDQUFDLEVBQUUsQ0FBQywwRkFBeUIsQ0FBQyxhQUFhLEVBQUUsS0FBSyxFQUFDLElBQUksRUFBQyxFQUFFO1lBQ3BFLE1BQU0sRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxHQUFHLElBQUksQ0FBQztZQUN2QyxNQUFNLElBQUksQ0FBQyxTQUFTLENBQUMsU0FBUyxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ3hDLENBQUMsQ0FB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QztZQUNOLE9BQU8sR0FBRyxPQUFPLGNBQWMsU0FBUyxNQUFNLENBQUMsSUFBSSxhQUFhLGNBQWMsQ0FBQyxJQUFJLGtCQUFrQixDQUFDO1FBQ3hHLENBQUM7UUFFRCxNQUFNLEtBQUssR0FBRyxNQUFNLDRFQUFnQixDQUFDLE9BQU8sRUFBRSxrRUFBVSxDQUFDLElBQUksRUFBRSxFQUFFLEVBQUU7WUFDakUsUUFBUSxFQUFFLE9BQU87WUFDakIsWUFBWSxFQUFFLElBQUk7WUFDbEIsYUFBYSxFQUFFLENBQUMsTUFBTSxDQUFDO1NBQ3hCLENBQUMsQ0FBQztRQUVILElBQUksTUFBTSxHQUFrQyxRQUFRLENBQUM7UUFFckQsUUFBUSxLQUFLLEVBQUUsQ0FBQztZQUNkLEtBQUssQ0FBQztnQkFDSixNQUFNLEdBQUcsUUFBUSxDQUFDO2dCQUNsQixNQUFNO1lBQ1IsS0FBSyxDQUFDO2dCQUNKLE1BQU0sR0FBRyxVQUFVLENBQUM7Z0JBQ3BCLE1BQU07WUFDUixLQUFLLENBQUM7Z0JBQ0osTUFBTSxHQUFHLEtBQUssQ0FBQztnQkFDZixNQUFNO1FBQ1YsQ0FBQztRQUVELE9BQU8sTUFBTSxDQUFDO0lBQ2hCLENBQUM7Q0FDRiIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvc2NyaXB0X2NvbnRyb2xsZXIudHM/ZmUwYyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBkZXN0cm95SWZyYW1lIH0gZnJvbSAnQC9jb21wb25lbnQvbWVzc2FnZV9pZnJhbWUvcmVuZGVyX21lc3NhZ2UnO1xuaW1wb3J0IHsgU2NyaXB0RGF0YSB9IGZyb20gJ0AvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L2RhdGEnO1xuaW1wb3J0IHsgc2NyaXB0RXZlbnRzLCBTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlIH0gZnJvbSAnQC9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvZXZlbnRzJztcbmltcG9ydCB7XG4gIGdldE9wcG9zaXRlU2NyaXB0VHlwZSxcbiAgSUZyYW1lRWxlbWVudCxcbiAgU2NyaXB0LFxuICBTY3JpcHRSZXBvc2l0b3J5SXRlbSxcbiAgU2NyaXB0VHlwZSxcbn0gZnJvbSAnQC9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvdHlwZXMnO1xuaW1wb3J0IHsgc2NyaXB0X3VybCB9IGZyb20gJ0Avc2NyaXB0X3VybCc7XG5pbXBvcnQgdGhpcmRfcGFydHkgZnJvbSAnQC90aGlyZF9wYXJ0eS5odG1sJztcbmltcG9ydCB7IGdldFNldHRpbmdWYWx1ZSB9IGZyb20gJ0AvdXRpbC9leHRlbnNpb25fdmFyaWFibGVzJztcblxuaW1wb3J0IHsgY2FsbEdlbmVyaWNQb3B1cCwgUE9QVVBfVFlQRSB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3BvcHVwJztcbmltcG9ydCB7IHV1aWR2NCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3V0aWxzJztcblxuaW1wb3J0IGxvZyBmcm9tICdsb2dsZXZlbCc7XG5cbmNsYXNzIFNjcmlwdEV4ZWN1dG9yIHtcbiAgLyoqXG4gICAqIOWIm+W7uuW5tui/kOihjOWNleS4quiEmuacrFxuICAgKiBAcGFyYW0gc2NyaXB0IOiEmuacrFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIGFzeW5jIHJ1blNjcmlwdChzY3JpcHQ6IFNjcmlwdCwgdHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHR5cGVOYW1lID0gdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyAn5YWo5bGAJyA6ICflsYDpg6gnO1xuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGlmcmFtZUVsZW1lbnQgPSAkKCdpZnJhbWUnKS5maWx0ZXIoXG4gICAgICAgIChfaW5kZXgsIGVsZW1lbnQpID0+ICQoZWxlbWVudCkuYXR0cignc2NyaXB0LWlkJykgPT09IHNjcmlwdC5pZCxcbiAgICAgIClbMF0gYXMgSUZyYW1lRWxlbWVudDtcblxuICAgICAgaWYgKGlmcmFtZUVsZW1lbnQpIHtcbiAgICAgICAgYXdhaXQgZGVzdHJveUlmcmFtZShpZnJhbWVFbGVtZW50KTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgaHRtbENvbnRlbnQgPSB0aGlzLmNyZWF0ZVNjcmlwdEh0bWwoc2NyaXB0KTtcblxuICAgICAgY29uc3QgJGlmcmFtZSA9ICQoJzxpZnJhbWU+Jywge1xuICAgICAgICBzdHlsZTogJ2Rpc3BsYXk6IG5vbmU7JyxcbiAgICAgICAgaWQ6IGB0YXZlcm4taGVscGVyLXNjcmlwdC0ke3NjcmlwdC5uYW1lfWAsXG4gICAgICAgIHNyY2RvYzogaHRtbENvbnRlbnQsXG4gICAgICAgICdzY3JpcHQtaWQnOiBzY3JpcHQuaWQsXG4gICAgICB9KTtcblxuICAgICAgJGlmcmFtZS5vbignbG9hZCcsICgpID0+IHtcbiAgICAgICAgbG9nLmluZm8oYFtTY3JpcHRNYW5hZ2VyXSDlkK/nlKgke3R5cGVOYW1lfeiEmuacrFtcIiR7c2NyaXB0Lm5hbWV9XCJdYCk7XG4gICAgICB9KTtcblxuICAgICAgJCgnYm9keScpLmFwcGVuZCgkaWZyYW1lKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nLmVycm9yKGBbU2NyaXB0TWFuYWdlcl0gJHt0eXBlTmFtZX3ohJrmnKzlkK/nlKjlpLHotKU6W1wiJHtzY3JpcHQubmFtZX1cIl1gLCBlcnJvcik7XG4gICAgICB0b2FzdHIuZXJyb3IoYCR7dHlwZU5hbWV96ISa5pys5ZCv55So5aSx6LSlOltcIiR7c2NyaXB0Lm5hbWV9XCJdYCk7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5YGc5q2i5Y2V5Liq6ISa5pys77yM5bm26ZSA5q+BaWZyYW1lXG4gICAqIEBwYXJhbSBzY3JpcHQg6ISa5pysXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgYXN5bmMgc3RvcFNjcmlwdChzY3JpcHQ6IFNjcmlwdCwgdHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHR5cGVOYW1lID0gdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyAn5YWo5bGAJyA6ICflsYDpg6gnO1xuXG4gICAgY29uc3QgaWZyYW1lRWxlbWVudCA9ICQoJ2lmcmFtZScpLmZpbHRlcihcbiAgICAgIChfaW5kZXgsIGVsZW1lbnQpID0+ICQoZWxlbWVudCkuYXR0cignc2NyaXB0LWlkJykgPT09IHNjcmlwdC5pZCxcbiAgICApWzBdIGFzIElGcmFtZUVsZW1lbnQ7XG5cbiAgICBpZiAoaWZyYW1lRWxlbWVudCkge1xuICAgICAgYXdhaXQgZGVzdHJveUlmcmFtZShpZnJhbWVFbGVtZW50KTtcbiAgICAgIGxvZy5pbmZvKGBbU2NyaXB0TWFuYWdlcl0g56aB55SoJHt0eXBlTmFtZX3ohJrmnKxbXCIke3NjcmlwdC5uYW1lfVwiXWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDliJvlu7rov5DooYzohJrmnKznmoRIVE1M5YaF5a65XG4gICAqIEBwYXJhbSBzY3JpcHQg6ISa5pys5a+56LGhXG4gICAqIEByZXR1cm5zIEhUTUzlhoXlrrlcbiAgICovXG4gIHByaXZhdGUgY3JlYXRlU2NyaXB0SHRtbChzY3JpcHQ6IFNjcmlwdCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGBcbiAgICAgIDxodG1sPlxuICAgICAgPGhlYWQ+XG4gICAgICAgICR7dGhpcmRfcGFydHl9XG4gICAgICAgIDxzY3JpcHQ+XG4gICAgICAgICAgKGZ1bmN0aW9uICgkKSB7XG4gICAgICAgICAgICB2YXIgb3JpZ2luYWwkID0gJDtcbiAgICAgICAgICAgIHdpbmRvdy4kID0gZnVuY3Rpb24gKHNlbGVjdG9yLCBjb250ZXh0KSB7XG4gICAgICAgICAgICAgIGlmIChjb250ZXh0ID09PSB1bmRlZmluZWQgfHwgY29udGV4dCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGlmICh3aW5kb3cucGFyZW50ICYmIHdpbmRvdy5wYXJlbnQuZG9jdW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgIGNvbnRleHQgPSB3aW5kb3cucGFyZW50LmRvY3VtZW50O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICBsb2cud2Fybign5peg5rOV6K6/6ZeuIHdpbmRvdy5wYXJlbnQuZG9jdW1lbnTvvIzlsIbkvb/nlKjlvZPliY0gaWZyYW1lIOeahCBkb2N1bWVudCDkvZzkuLrkuIrkuIvmlofjgIInKTtcbiAgICAgICAgICAgICAgICAgIGNvbnRleHQgPSB3aW5kb3cuZG9jdW1lbnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHJldHVybiBvcmlnaW5hbCQoc2VsZWN0b3IsIGNvbnRleHQpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9KShqUXVlcnkpO1xuICAgICAgICA8L3NjcmlwdD5cbiAgICAgICAgPHNjcmlwdCBzcmM9XCIke3NjcmlwdF91cmwuZ2V0KCdpZnJhbWVfY2xpZW50Jyl9XCI+PC9zY3JpcHQ+XG4gICAgICA8L2hlYWQ+XG4gICAgICA8Ym9keT5cbiAgICAgICAgPHNjcmlwdCB0eXBlPVwibW9kdWxlXCI+XG4gICAgICAgICAgJHtzY3JpcHQuY29udGVudH1cbiAgICAgICAgPC9zY3JpcHQ+XG4gICAgICA8L2JvZHk+XG4gICAgICA8L2h0bWw+XG4gICAgYDtcbiAgfVxuXG4gIC8qKlxuICAgKiDmuIXnkIbmiYDmnInohJrmnKxpZnJhbWVcbiAgICovXG4gIGFzeW5jIGNsZWFyQWxsU2NyaXB0c0lmcmFtZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCAkaWZyYW1lcyA9ICQoJ2lmcmFtZVtpZF49XCJ0YXZlcm4taGVscGVyLXNjcmlwdC1cIl0nKTtcbiAgICBmb3IgKGNvbnN0IGlmcmFtZSBvZiAkaWZyYW1lcykge1xuICAgICAgYXdhaXQgZGVzdHJveUlmcmFtZShpZnJhbWUgYXMgSUZyYW1lRWxlbWVudCk7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBTY3JpcHRNYW5hZ2VyIHtcbiAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2U6IFNjcmlwdE1hbmFnZXI7XG4gIHByaXZhdGUgc2NyaXB0RGF0YTogU2NyaXB0RGF0YTtcbiAgcHJpdmF0ZSBleGVjdXRvcjogU2NyaXB0RXhlY3V0b3I7XG5cbiAgcHJpdmF0ZSBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLnNjcmlwdERhdGEgPSBTY3JpcHREYXRhLmdldEluc3RhbmNlKCk7XG4gICAgdGhpcy5leGVjdXRvciA9IG5ldyBTY3JpcHRFeGVjdXRvcigpO1xuICAgIHRoaXMucmVnaXN0ZXJFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluiEmuacrOeuoeeQhuWZqOWunuS+i1xuICAgKi9cbiAgcHVibGljIHN0YXRpYyBnZXRJbnN0YW5jZSgpOiBTY3JpcHRNYW5hZ2VyIHtcbiAgICBpZiAoIVNjcmlwdE1hbmFnZXIuaW5zdGFuY2UpIHtcbiAgICAgIFNjcmlwdE1hbmFnZXIuaW5zdGFuY2UgPSBuZXcgU2NyaXB0TWFuYWdlcigpO1xuICAgIH1cbiAgICByZXR1cm4gU2NyaXB0TWFuYWdlci5pbnN0YW5jZTtcbiAgfVxuXG4gIC8qKlxuICAgKiDplIDmr4HohJrmnKznrqHnkIblmajlrp7kvotcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgZGVzdHJveUluc3RhbmNlKCk6IHZvaWQge1xuICAgIGlmIChTY3JpcHRNYW5hZ2VyLmluc3RhbmNlKSB7XG4gICAgICBTY3JpcHRNYW5hZ2VyLmluc3RhbmNlID0gdW5kZWZpbmVkIGFzIHVua25vd24gYXMgU2NyaXB0TWFuYWdlcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5rOo5YaM5LqL5Lu255uR5ZCs5ZmoXG4gICAqL1xuICBwcml2YXRlIHJlZ2lzdGVyRXZlbnRMaXN0ZW5lcnMoKTogdm9pZCB7XG4gICAgc2NyaXB0RXZlbnRzLm9uKFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuU0NSSVBUX1RPR0dMRSwgYXN5bmMgZGF0YSA9PiB7XG4gICAgICBjb25zdCB7IHNjcmlwdCwgdHlwZSwgZW5hYmxlLCB1c2VySW5wdXQgPSB0cnVlIH0gPSBkYXRhO1xuICAgICAgYXdhaXQgdGhpcy50b2dnbGVTY3JpcHQoc2NyaXB0LCB0eXBlLCBlbmFibGUsIHVzZXJJbnB1dCk7XG4gICAgfSk7XG5cbiAgICBzY3JpcHRFdmVudHMub24oU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5UWVBFX1RPR0dMRSwgYXN5bmMgZGF0YSA9PiB7XG4gICAgICBjb25zdCB7IHR5cGUsIGVuYWJsZSwgdXNlcklucHV0ID0gdHJ1ZSB9ID0gZGF0YTtcbiAgICAgIGF3YWl0IHRoaXMudG9nZ2xlU2NyaXB0VHlwZSh0eXBlLCBlbmFibGUsIHVzZXJJbnB1dCk7XG4gICAgfSk7XG5cbiAgICBzY3JpcHRFdmVudHMub24oU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5TQ1JJUFRfSU1QT1JULCBhc3luYyBkYXRhID0+IHtcbiAgICAgIGNvbnN0IHsgZmlsZSwgdHlwZSB9ID0gZGF0YTtcbiAgICAgIGF3YWl0IHRoaXMuaW1wb3J0U2NyaXB0KGZpbGUsIHR5cGUpO1xuICAgIH0pO1xuXG4gICAgc2NyaXB0RXZlbnRzLm9uKFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuU0NSSVBUX0RFTEVURSwgYXN5bmMgZGF0YSA9PiB7XG4gICAgICBjb25zdCB7IHNjcmlwdElkLCB0eXBlIH0gPSBkYXRhO1xuICAgICAgYXdhaXQgdGhpcy5kZWxldGVTY3JpcHQoc2NyaXB0SWQsIHR5cGUpO1xuICAgIH0pO1xuXG4gICAgc2NyaXB0RXZlbnRzLm9uKFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuU0NSSVBUX0NSRUFURSwgYXN5bmMgZGF0YSA9PiB7XG4gICAgICBjb25zdCB7IHNjcmlwdCwgdHlwZSB9ID0gZGF0YTtcbiAgICAgIGF3YWl0IHRoaXMuY3JlYXRlU2NyaXB0KHNjcmlwdCwgdHlwZSk7XG4gICAgfSk7XG5cbiAgICBzY3JpcHRFdmVudHMub24oU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5TQ1JJUFRfVVBEQVRFLCBhc3luYyBkYXRhID0+IHtcbiAgICAgIGNvbnN0IHsgc2NyaXB0LCB0eXBlIH0gPSBkYXRhO1xuICAgICAgYXdhaXQgdGhpcy51cGRhdGVTY3JpcHQoc2NyaXB0LCB0eXBlKTtcbiAgICB9KTtcblxuICAgIHNjcmlwdEV2ZW50cy5vbihTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlNDUklQVF9NT1ZFLCBhc3luYyBkYXRhID0+IHtcbiAgICAgIGNvbnN0IHsgc2NyaXB0LCBmcm9tVHlwZSB9ID0gZGF0YTtcbiAgICAgIGF3YWl0IHRoaXMubW92ZVNjcmlwdChzY3JpcHQsIGZyb21UeXBlKTtcbiAgICB9KTtcblxuICAgIHNjcmlwdEV2ZW50cy5vbihTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLkZPTERFUl9NT1ZFLCBhc3luYyBkYXRhID0+IHtcbiAgICAgIGNvbnN0IHsgZm9sZGVySWQsIGZyb21UeXBlIH0gPSBkYXRhO1xuICAgICAgYXdhaXQgdGhpcy5tb3ZlRm9sZGVyKGZvbGRlcklkLCBmcm9tVHlwZSk7XG4gICAgfSk7XG5cbiAgICBzY3JpcHRFdmVudHMub24oU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5PUkRFUl9DSEFOR0VELCBhc3luYyBkYXRhID0+IHtcbiAgICAgIGNvbnN0IHsgZGF0YTogb3JkZXJEYXRhLCB0eXBlIH0gPSBkYXRhO1xuICAgICAgYXdhaXQgdGhpcy5zYXZlT3JkZXIob3JkZXJEYXRhLCB0eXBlKTtcbiAgICB9KTtcblxuICAgIHNjcmlwdEV2ZW50cy5vbihTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlVJX0xPQURFRCwgYXN5bmMgKCkgPT4ge1xuICAgICAgaWYgKCFnZXRTZXR0aW5nVmFsdWUoJ2VuYWJsZWRfZXh0ZW5zaW9uJykpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBnbG9iYWxTY3JpcHRzID0gdGhpcy5zY3JpcHREYXRhLmdldEdsb2JhbFNjcmlwdHMoKTtcbiAgICAgIGNvbnN0IGNoYXJhY3RlclNjcmlwdHMgPSB0aGlzLnNjcmlwdERhdGEuZ2V0Q2hhcmFjdGVyU2NyaXB0cygpO1xuXG4gICAgICBpZiAodGhpcy5zY3JpcHREYXRhLmlzR2xvYmFsU2NyaXB0RW5hYmxlZCkge1xuICAgICAgICBhd2FpdCB0aGlzLnJ1blNjcmlwdHNCeVR5cGUoZ2xvYmFsU2NyaXB0cywgU2NyaXB0VHlwZS5HTE9CQUwpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbG9nLmluZm8oJ1tTY3JpcHRNYW5hZ2VyXSDlhajlsYDohJrmnKznsbvlnovmnKrlkK/nlKjvvIzot7Pov4fov5DooYzlhajlsYDohJrmnKwnKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuc2NyaXB0RGF0YS5pc0NoYXJhY3RlclNjcmlwdEVuYWJsZWQpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5ydW5TY3JpcHRzQnlUeXBlKGNoYXJhY3RlclNjcmlwdHMsIFNjcmlwdFR5cGUuQ0hBUkFDVEVSKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxvZy5pbmZvKCdbU2NyaXB0TWFuYWdlcl0g6KeS6Imy6ISa5pys57G75Z6L5pyq5ZCv55So77yM6Lez6L+H6L+Q6KGM6KeS6Imy6ISa5pysJyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog5YiH5o2i6ISa5pys5ZCv55So54q25oCBXG4gICAqIEBwYXJhbSBzY3JpcHQg6ISa5pysXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKiBAcGFyYW0gZW5hYmxlIOaYr+WQpuWQr+eUqFxuICAgKiBAcGFyYW0gdXNlcklucHV0IOaYr+WQpueUseeUqOaIt+i+k+WFpVxuICAgKi9cbiAgcHVibGljIGFzeW5jIHRvZ2dsZVNjcmlwdChcbiAgICBzY3JpcHQ6IFNjcmlwdCxcbiAgICB0eXBlOiBTY3JpcHRUeXBlLFxuICAgIGVuYWJsZTogYm9vbGVhbixcbiAgICB1c2VySW5wdXQ6IGJvb2xlYW4gPSB0cnVlLFxuICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAodXNlcklucHV0KSB7XG4gICAgICBzY3JpcHQuZW5hYmxlZCA9IGVuYWJsZTtcbiAgICAgIGF3YWl0IHRoaXMuc2NyaXB0RGF0YS5zYXZlU2NyaXB0KHNjcmlwdCwgdHlwZSk7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGlmIChlbmFibGUpIHtcbiAgICAgICAgaWYgKHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMICYmICF0aGlzLnNjcmlwdERhdGEuaXNHbG9iYWxTY3JpcHRFbmFibGVkKSB7XG4gICAgICAgICAgbG9nLmluZm8oYFtzY3JpcHRfbWFuYWdlcl0g5YWo5bGA6ISa5pys57G75Z6L5pyq5ZCv55So77yM6Lez6L+H5ZCv55So6ISa5pysW1wiJHtzY3JpcHQubmFtZX1cIl1gKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGUgPT09IFNjcmlwdFR5cGUuQ0hBUkFDVEVSICYmICF0aGlzLnNjcmlwdERhdGEuaXNDaGFyYWN0ZXJTY3JpcHRFbmFibGVkKSB7XG4gICAgICAgICAgbG9nLmluZm8oYFtzY3JpcHRfbWFuYWdlcl0g6KeS6Imy6ISa5pys57G75Z6L5pyq5ZCv55So77yM6Lez6L+H5ZCv55So6ISa5pysW1wiJHtzY3JpcHQubmFtZX1cIl1gKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBhd2FpdCB0aGlzLnJ1blNjcmlwdChzY3JpcHQsIHR5cGUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXdhaXQgdGhpcy5zdG9wU2NyaXB0KHNjcmlwdCwgdHlwZSk7XG4gICAgICB9XG5cbiAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuVUlfUkVGUkVTSCwge1xuICAgICAgICBhY3Rpb246ICdzY3JpcHRfdG9nZ2xlJyxcbiAgICAgICAgc2NyaXB0LFxuICAgICAgICB0eXBlLFxuICAgICAgICBlbmFibGUsXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nLmVycm9yKGBbU2NyaXB0TWFuYWdlcl0g5YiH5o2i6ISa5pys54q25oCB5aSx6LSlOiAke3NjcmlwdC5uYW1lfWAsIGVycm9yKTtcbiAgICAgIHRvYXN0ci5lcnJvcihg5YiH5o2i6ISa5pys54q25oCB5aSx6LSlOiAke3NjcmlwdC5uYW1lfWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDliIfmjaLohJrmnKznsbvlnovlkK/nlKjnirbmgIFcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqIEBwYXJhbSBlbmFibGUg5piv5ZCm5ZCv55SoXG4gICAqIEBwYXJhbSB1c2VySW5wdXQg5piv5ZCm55Sx55So5oi36L6T5YWlXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgdG9nZ2xlU2NyaXB0VHlwZSh0eXBlOiBTY3JpcHRUeXBlLCBlbmFibGU6IGJvb2xlYW4sIHVzZXJJbnB1dDogYm9vbGVhbiA9IHRydWUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAodXNlcklucHV0KSB7XG4gICAgICBhd2FpdCB0aGlzLnNjcmlwdERhdGEudXBkYXRlU2NyaXB0VHlwZUVuYWJsZVN0YXRlKHR5cGUsIGVuYWJsZSk7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHNjcmlwdHMgPVxuICAgICAgICB0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCA/IHRoaXMuc2NyaXB0RGF0YS5nZXRHbG9iYWxTY3JpcHRzKCkgOiB0aGlzLnNjcmlwdERhdGEuZ2V0Q2hhcmFjdGVyU2NyaXB0cygpO1xuXG4gICAgICBpZiAoZW5hYmxlKSB7XG4gICAgICAgIGF3YWl0IHRoaXMucnVuU2NyaXB0c0J5VHlwZShzY3JpcHRzLCB0eXBlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGF3YWl0IHRoaXMuc3RvcFNjcmlwdHNCeVR5cGUoc2NyaXB0cywgdHlwZSk7XG4gICAgICB9XG5cbiAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuVUlfUkVGUkVTSCwge1xuICAgICAgICBhY3Rpb246ICd0eXBlX3RvZ2dsZScsXG4gICAgICAgIHR5cGUsXG4gICAgICAgIGVuYWJsZSxcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2cuZXJyb3IoYFtTY3JpcHRNYW5hZ2VyXSDliIfmjaLohJrmnKznsbvlnovnirbmgIHlpLHotKU6ICR7dHlwZX1gLCBlcnJvcik7XG4gICAgICB0b2FzdHIuZXJyb3IoYOWIh+aNouiEmuacrOexu+Wei+eKtuaAgeWksei0pTogJHt0eXBlfWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDov5DooYzljZXkuKrohJrmnKxcbiAgICogQHBhcmFtIHNjcmlwdCDohJrmnKxcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgcnVuU2NyaXB0KHNjcmlwdDogU2NyaXB0LCB0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgaWYgKCFnZXRTZXR0aW5nVmFsdWUoJ2VuYWJsZWRfZXh0ZW5zaW9uJykpIHtcbiAgICAgIHRvYXN0ci5lcnJvcignW1NjcmlwdE1hbmFnZXJdIOaJqeWxleacquWQr+eUqCcpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICh0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCAmJiAhdGhpcy5zY3JpcHREYXRhLmlzR2xvYmFsU2NyaXB0RW5hYmxlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAodHlwZSA9PT0gU2NyaXB0VHlwZS5DSEFSQUNURVIgJiYgIXRoaXMuc2NyaXB0RGF0YS5pc0NoYXJhY3RlclNjcmlwdEVuYWJsZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBhd2FpdCB0aGlzLmV4ZWN1dG9yLnJ1blNjcmlwdChzY3JpcHQsIHR5cGUpO1xuXG4gICAgaWYgKHNjcmlwdC5idXR0b25zICYmIHNjcmlwdC5idXR0b25zLmxlbmd0aCA+IDApIHtcbiAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuQlVUVE9OX0FERCwgeyBzY3JpcHQgfSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWBnOatouWNleS4quiEmuacrFxuICAgKiBAcGFyYW0gc2NyaXB0IOiEmuacrFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHB1YmxpYyBhc3luYyBzdG9wU2NyaXB0KHNjcmlwdDogU2NyaXB0LCB0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgYXdhaXQgdGhpcy5leGVjdXRvci5zdG9wU2NyaXB0KHNjcmlwdCwgdHlwZSk7XG5cbiAgICBpZiAoc2NyaXB0LmJ1dHRvbnMgJiYgc2NyaXB0LmJ1dHRvbnMubGVuZ3RoID4gMCkge1xuICAgICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5CVVRUT05fUkVNT1ZFLCB7IHNjcmlwdElkOiBzY3JpcHQuaWQgfSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOi/kOihjOaMh+Wumuexu+Wei+eahOaJgOacieiEmuacrFxuICAgKiBAcGFyYW0gc2NyaXB0cyDohJrmnKzliJfooahcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgcnVuU2NyaXB0c0J5VHlwZShzY3JpcHRzOiBTY3JpcHRbXSwgdHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICghZ2V0U2V0dGluZ1ZhbHVlKCdlbmFibGVkX2V4dGVuc2lvbicpKSB7XG4gICAgICB0b2FzdHIuZXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDphZLppobliqnmiYvmnKrlkK/nlKjvvIzml6Dms5Xov5DooYzohJrmnKwnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAodHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgJiYgIXRoaXMuc2NyaXB0RGF0YS5pc0dsb2JhbFNjcmlwdEVuYWJsZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHR5cGUgPT09IFNjcmlwdFR5cGUuQ0hBUkFDVEVSICYmICF0aGlzLnNjcmlwdERhdGEuaXNDaGFyYWN0ZXJTY3JpcHRFbmFibGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgZW5hYmxlZFNjcmlwdHMgPSBzY3JpcHRzLmZpbHRlcihzY3JpcHQgPT4gc2NyaXB0LmVuYWJsZWQpO1xuXG4gICAgZm9yIChjb25zdCBzY3JpcHQgb2YgZW5hYmxlZFNjcmlwdHMpIHtcbiAgICAgIGF3YWl0IHRoaXMuZXhlY3V0b3IucnVuU2NyaXB0KHNjcmlwdCwgdHlwZSk7XG5cbiAgICAgIGlmIChzY3JpcHQuYnV0dG9ucyAmJiBzY3JpcHQuYnV0dG9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuQlVUVE9OX0FERCwgeyBzY3JpcHQgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWBnOatouaMh+Wumuexu+Wei+eahOaJgOacieiEmuacrFxuICAgKiBAcGFyYW0gc2NyaXB0cyDohJrmnKzliJfooahcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgc3RvcFNjcmlwdHNCeVR5cGUoc2NyaXB0czogU2NyaXB0W10sIHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBlbmFibGVkU2NyaXB0cyA9IHNjcmlwdHMuZmlsdGVyKHNjcmlwdCA9PiBzY3JpcHQuZW5hYmxlZCk7XG5cbiAgICBmb3IgKGNvbnN0IHNjcmlwdCBvZiBlbmFibGVkU2NyaXB0cykge1xuICAgICAgYXdhaXQgdGhpcy5leGVjdXRvci5zdG9wU2NyaXB0KHNjcmlwdCwgdHlwZSk7XG5cbiAgICAgIGlmIChzY3JpcHQuYnV0dG9ucyAmJiBzY3JpcHQuYnV0dG9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuQlVUVE9OX1JFTU9WRSwgeyBzY3JpcHRJZDogc2NyaXB0LmlkIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDlr7zlhaXohJrmnKzmiJbmlofku7blpLlcbiAgICogQHBhcmFtIGZpbGUg6ISa5pys5paH5Lu25oiW5paH5Lu25aS55a+85Ye65paH5Lu2XG4gICAqIEBwYXJhbSB0eXBlIOWvvOWFpeebruagh+exu+Wei1xuICAgKi9cbiAgcHVibGljIGFzeW5jIGltcG9ydFNjcmlwdChmaWxlOiBGaWxlLCB0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGlmIChmaWxlLm5hbWUudG9Mb3dlckNhc2UoKS5lbmRzV2l0aCgnLnppcCcpKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuaW1wb3J0RnJvbVppcChmaWxlLCB0eXBlKTtcbiAgICAgIH0gZWxzZSBpZiAoZmlsZS5uYW1lLnRvTG93ZXJDYXNlKCkuZW5kc1dpdGgoJy5qc29uJykpIHtcbiAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMucmVhZEZpbGVBc1RleHQoZmlsZSk7XG4gICAgICAgIGNvbnN0IGltcG9ydERhdGEgPSBKU09OLnBhcnNlKGNvbnRlbnQpO1xuXG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KGltcG9ydERhdGEpKSB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5pbXBvcnRNdWx0aXBsZUl0ZW1zKGltcG9ydERhdGEsIHR5cGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGF3YWl0IHRoaXMuaW1wb3J0U2luZ2xlU2NyaXB0KGltcG9ydERhdGEsIHR5cGUpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ+S4jeaUr+aMgeeahOaWh+S7tuagvOW8j++8jOivt+mAieaLqSAuanNvbiDmiJYgLnppcCDmlofku7YnKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nLmVycm9yKCdbU2NyaXB0TWFuYWdlcl0g5a+85YWl5aSx6LSlOicsIGVycm9yKTtcbiAgICAgIHRvYXN0ci5lcnJvcihg5a+85YWl5aSx6LSlOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ+aXoOaViOeahOaWh+S7tuagvOW8jyd9YCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOS7jlpJUOaWh+S7tuWvvOWFpVxuICAgKiBAcGFyYW0gZmlsZSBaSVDmlofku7ZcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGltcG9ydEZyb21aaXAoZmlsZTogRmlsZSwgdHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIC8vQHRzLWlnbm9yZVxuICAgIGlmICghd2luZG93LkpTWmlwKSB7XG4gICAgICBsb2cuaW5mbygnaW1wb3J0IGpzemlwJyk7XG4gICAgICBhd2FpdCBpbXBvcnQoJ0BzaWxseXRhdmVybi9saWIvanN6aXAubWluLmpzJyk7XG4gICAgfVxuICAgIC8vQHRzLWlnbm9yZVxuICAgIGNvbnN0IHppcCA9IG5ldyBKU1ppcCgpO1xuICAgIGNvbnN0IHppcENvbnRlbnQgPSBhd2FpdCB6aXAubG9hZEFzeW5jKGZpbGUpO1xuXG4gICAgbGV0IGltcG9ydGVkU2NyaXB0cyA9IDA7XG4gICAgbGV0IGltcG9ydGVkRm9sZGVycyA9IDA7XG5cbiAgICBjb25zdCBmb2xkZXJzID0gbmV3IFNldDxzdHJpbmc+KCk7XG4gICAgY29uc3Qgcm9vdFNjcmlwdHM6IHN0cmluZ1tdID0gW107XG5cbiAgICBmb3IgKGNvbnN0IGZpbGVOYW1lIGluIHppcENvbnRlbnQuZmlsZXMpIHtcbiAgICAgIGNvbnN0IGZpbGUgPSB6aXBDb250ZW50LmZpbGVzW2ZpbGVOYW1lXTtcblxuICAgICAgaWYgKCFmaWxlLmRpciAmJiBmaWxlTmFtZS5lbmRzV2l0aCgnLmpzb24nKSkge1xuICAgICAgICBjb25zdCBwYXRoUGFydHMgPSBmaWxlTmFtZS5zcGxpdCgnLycpO1xuXG4gICAgICAgIGlmIChwYXRoUGFydHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgcm9vdFNjcmlwdHMucHVzaChmaWxlTmFtZSk7XG4gICAgICAgIH0gZWxzZSBpZiAocGF0aFBhcnRzLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgIGZvbGRlcnMuYWRkKHBhdGhQYXJ0c1swXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBmb3IgKGNvbnN0IGZpbGVOYW1lIG9mIHJvb3RTY3JpcHRzKSB7XG4gICAgICBjb25zdCBmaWxlID0gemlwQ29udGVudC5maWxlc1tmaWxlTmFtZV07XG4gICAgICBjb25zdCBzY3JpcHRDb250ZW50ID0gYXdhaXQgZmlsZS5hc3luYygnc3RyaW5nJyk7XG4gICAgICBjb25zdCBzY3JpcHREYXRhID0gSlNPTi5wYXJzZShzY3JpcHRDb250ZW50KTtcblxuICAgICAgaWYgKHNjcmlwdERhdGEubmFtZSAmJiAnY29udGVudCcgaW4gc2NyaXB0RGF0YSkge1xuICAgICAgICBjb25zdCBzY3JpcHQgPSBuZXcgU2NyaXB0KHtcbiAgICAgICAgICAuLi5zY3JpcHREYXRhLFxuICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlLFxuICAgICAgICB9KTtcbiAgICAgICAgYXdhaXQgdGhpcy5oYW5kbGVTY3JpcHRJbXBvcnQoc2NyaXB0LCB0eXBlKTtcbiAgICAgICAgaW1wb3J0ZWRTY3JpcHRzKys7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZm9yIChjb25zdCBmb2xkZXJOYW1lIG9mIGZvbGRlcnMpIHtcbiAgICAgIGNvbnN0IGZvbGRlclNjcmlwdENvdW50ID0gYXdhaXQgdGhpcy5pbXBvcnRGb2xkZXJGcm9tWmlwTmV3KHppcENvbnRlbnQsIGZvbGRlck5hbWUsIHR5cGUpO1xuICAgICAgaW1wb3J0ZWRTY3JpcHRzICs9IGZvbGRlclNjcmlwdENvdW50O1xuICAgICAgaW1wb3J0ZWRGb2xkZXJzKys7XG4gICAgfVxuXG4gICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5VSV9SRUZSRVNILCB7XG4gICAgICBhY3Rpb246IHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMID8gJ3JlZnJlc2hfZ2xvYmFsX3NjcmlwdHMnIDogJ3JlZnJlc2hfY2hhcmFjdF9zY3JpcHRzJyxcbiAgICB9KTtcblxuICAgIHRvYXN0ci5zdWNjZXNzKGDmiJDlip/lr7zlhaUgJHtpbXBvcnRlZFNjcmlwdHN9IOS4quiEmuacrOWSjCAke2ltcG9ydGVkRm9sZGVyc30g5Liq5paH5Lu25aS5YCk7XG4gIH1cblxuICAvKipcbiAgICog5LuOWklQ5Lit5a+85YWl5paH5Lu25aS5XG4gICAqIEBwYXJhbSB6aXBDb250ZW50IFpJUOWGheWuuVxuICAgKiBAcGFyYW0gZm9sZGVyTmFtZSDmlofku7blpLnlkI3np7BcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqIEByZXR1cm5zIOWvvOWFpeeahOiEmuacrOaVsOmHj1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBpbXBvcnRGb2xkZXJGcm9tWmlwTmV3KHppcENvbnRlbnQ6IGFueSwgZm9sZGVyTmFtZTogc3RyaW5nLCB0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICBjb25zdCByZXBvc2l0b3J5ID1cbiAgICAgIHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMXG4gICAgICAgID8gdGhpcy5zY3JpcHREYXRhLmdldEdsb2JhbFJlcG9zaXRvcnlJdGVtcygpXG4gICAgICAgIDogdGhpcy5zY3JpcHREYXRhLmdldENoYXJhY3RlclJlcG9zaXRvcnlJdGVtcygpO1xuXG4gICAgbGV0IGZpbmFsRm9sZGVyTmFtZSA9IGZvbGRlck5hbWU7XG4gICAgbGV0IGNvdW50ZXIgPSAxO1xuICAgIHdoaWxlIChyZXBvc2l0b3J5LnNvbWUoaXRlbSA9PiBpdGVtLnR5cGUgPT09ICdmb2xkZXInICYmIGl0ZW0ubmFtZSA9PT0gZmluYWxGb2xkZXJOYW1lKSkge1xuICAgICAgZmluYWxGb2xkZXJOYW1lID0gYCR7Zm9sZGVyTmFtZX1fJHtjb3VudGVyfWA7XG4gICAgICBjb3VudGVyKys7XG4gICAgfVxuXG4gICAgY29uc3QgZm9sZGVySWQgPSBhd2FpdCB0aGlzLnNjcmlwdERhdGEuY3JlYXRlRm9sZGVyKGZpbmFsRm9sZGVyTmFtZSwgdHlwZSk7XG4gICAgbGV0IGZvbGRlclNjcmlwdENvdW50ID0gMDtcblxuICAgIGZvciAoY29uc3QgZmlsZU5hbWUgaW4gemlwQ29udGVudC5maWxlcykge1xuICAgICAgY29uc3QgZmlsZSA9IHppcENvbnRlbnQuZmlsZXNbZmlsZU5hbWVdO1xuXG4gICAgICBpZiAoIWZpbGUuZGlyICYmIGZpbGVOYW1lLnN0YXJ0c1dpdGgoYCR7Zm9sZGVyTmFtZX0vYCkgJiYgZmlsZU5hbWUuZW5kc1dpdGgoJy5qc29uJykpIHtcbiAgICAgICAgY29uc3Qgc2NyaXB0Q29udGVudCA9IGF3YWl0IGZpbGUuYXN5bmMoJ3N0cmluZycpO1xuICAgICAgICBjb25zdCBzY3JpcHREYXRhID0gSlNPTi5wYXJzZShzY3JpcHRDb250ZW50KTtcblxuICAgICAgICBpZiAoc2NyaXB0RGF0YS5uYW1lICYmICdjb250ZW50JyBpbiBzY3JpcHREYXRhKSB7XG4gICAgICAgICAgY29uc3Qgc2NyaXB0ID0gbmV3IFNjcmlwdCh7XG4gICAgICAgICAgICAuLi5zY3JpcHREYXRhLFxuICAgICAgICAgICAgZW5hYmxlZDogZmFsc2UsXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgYXdhaXQgdGhpcy5oYW5kbGVTY3JpcHRJbXBvcnQoc2NyaXB0LCB0eXBlKTtcbiAgICAgICAgICBhd2FpdCB0aGlzLnNjcmlwdERhdGEubW92ZVNjcmlwdFRvRm9sZGVyKHNjcmlwdC5pZCwgZm9sZGVySWQsIHR5cGUpO1xuICAgICAgICAgIGZvbGRlclNjcmlwdENvdW50Kys7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZm9sZGVyU2NyaXB0Q291bnQ7XG4gIH1cblxuICAvKipcbiAgICog5a+85YWl5Y2V5Liq6ISa5pysXG4gICAqIEBwYXJhbSBzY3JpcHREYXRhIOiEmuacrOaVsOaNrlxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgaW1wb3J0U2luZ2xlU2NyaXB0KHNjcmlwdERhdGE6IGFueSwgdHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICghc2NyaXB0RGF0YS5uYW1lIHx8ICEoJ2NvbnRlbnQnIGluIHNjcmlwdERhdGEpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ+aXoOaViOeahOiEmuacrOaVsOaNricpO1xuICAgIH1cblxuICAgIGNvbnN0IHNjcmlwdFRvSW1wb3J0ID0gbmV3IFNjcmlwdCh7XG4gICAgICAuLi5zY3JpcHREYXRhLFxuICAgICAgZW5hYmxlZDogZmFsc2UsXG4gICAgfSk7XG5cbiAgICBhd2FpdCB0aGlzLmhhbmRsZVNjcmlwdEltcG9ydChzY3JpcHRUb0ltcG9ydCwgdHlwZSk7XG5cbiAgICB0b2FzdHIuc3VjY2Vzcyhg6ISa5pysICcke3NjcmlwdFRvSW1wb3J0Lm5hbWV9JyDlr7zlhaXmiJDlip/jgIJgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlr7zlhaXlpJrkuKrpobnnm67vvIjohJrmnKzmiJbmlofku7blpLnvvIlcbiAgICogQHBhcmFtIGl0ZW1zIOmhueebruaVsOe7hFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgaW1wb3J0TXVsdGlwbGVJdGVtcyhpdGVtczogYW55W10sIHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBsZXQgaW1wb3J0ZWRDb3VudCA9IDA7XG4gICAgbGV0IGZvbGRlckNvdW50ID0gMDtcbiAgICBsZXQgc2NyaXB0Q291bnQgPSAwO1xuXG4gICAgZm9yIChjb25zdCBpdGVtIG9mIGl0ZW1zKSB7XG4gICAgICBpZiAoaXRlbS50eXBlID09PSAnZm9sZGVyJykge1xuICAgICAgICBhd2FpdCB0aGlzLmltcG9ydEZvbGRlcihpdGVtLCB0eXBlKTtcbiAgICAgICAgZm9sZGVyQ291bnQrKztcbiAgICAgICAgaW1wb3J0ZWRDb3VudCsrO1xuICAgICAgfSBlbHNlIGlmIChpdGVtLnR5cGUgPT09ICdzY3JpcHQnKSB7XG4gICAgICAgIGNvbnN0IHNjcmlwdCA9IG5ldyBTY3JpcHQoe1xuICAgICAgICAgIC4uLml0ZW0udmFsdWUsXG4gICAgICAgICAgZW5hYmxlZDogZmFsc2UsXG4gICAgICAgIH0pO1xuICAgICAgICBhd2FpdCB0aGlzLmhhbmRsZVNjcmlwdEltcG9ydChzY3JpcHQsIHR5cGUpO1xuICAgICAgICBzY3JpcHRDb3VudCsrO1xuICAgICAgICBpbXBvcnRlZENvdW50Kys7XG4gICAgICB9IGVsc2UgaWYgKGl0ZW0ubmFtZSAmJiAnY29udGVudCcgaW4gaXRlbSkge1xuICAgICAgICBjb25zdCBzY3JpcHQgPSBuZXcgU2NyaXB0KHtcbiAgICAgICAgICAuLi5pdGVtLFxuICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlLFxuICAgICAgICB9KTtcbiAgICAgICAgYXdhaXQgdGhpcy5oYW5kbGVTY3JpcHRJbXBvcnQoc2NyaXB0LCB0eXBlKTtcbiAgICAgICAgc2NyaXB0Q291bnQrKztcbiAgICAgICAgaW1wb3J0ZWRDb3VudCsrO1xuICAgICAgfVxuICAgIH1cblxuICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuVUlfUkVGUkVTSCwge1xuICAgICAgYWN0aW9uOiB0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCA/ICdyZWZyZXNoX2dsb2JhbF9zY3JpcHRzJyA6ICdyZWZyZXNoX2NoYXJhY3Rfc2NyaXB0cycsXG4gICAgfSk7XG5cbiAgICB0b2FzdHIuc3VjY2Vzcyhg5a+85YWl5oiQ5YqfYCk7XG4gIH1cblxuICAvKipcbiAgICog5a+85YWl5paH5Lu25aS5XG4gICAqIEBwYXJhbSBmb2xkZXJEYXRhIOaWh+S7tuWkueaVsOaNrlxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgaW1wb3J0Rm9sZGVyKGZvbGRlckRhdGE6IGFueSwgdHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICghZm9sZGVyRGF0YS5uYW1lIHx8ICFBcnJheS5pc0FycmF5KGZvbGRlckRhdGEudmFsdWUpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ+aXoOaViOeahOaWh+S7tuWkueaVsOaNricpO1xuICAgIH1cblxuICAgIGNvbnN0IHJlcG9zaXRvcnkgPVxuICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUxcbiAgICAgICAgPyB0aGlzLnNjcmlwdERhdGEuZ2V0R2xvYmFsUmVwb3NpdG9yeUl0ZW1zKClcbiAgICAgICAgOiB0aGlzLnNjcmlwdERhdGEuZ2V0Q2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKCk7XG5cbiAgICBsZXQgZm9sZGVyTmFtZSA9IGZvbGRlckRhdGEubmFtZTtcbiAgICBsZXQgY291bnRlciA9IDE7XG4gICAgd2hpbGUgKHJlcG9zaXRvcnkuc29tZShpdGVtID0+IGl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicgJiYgaXRlbS5uYW1lID09PSBmb2xkZXJOYW1lKSkge1xuICAgICAgZm9sZGVyTmFtZSA9IGAke2ZvbGRlckRhdGEubmFtZX1fJHtjb3VudGVyfWA7XG4gICAgICBjb3VudGVyKys7XG4gICAgfVxuXG4gICAgY29uc3QgZm9sZGVySWQgPSBhd2FpdCB0aGlzLnNjcmlwdERhdGEuY3JlYXRlRm9sZGVyKGZvbGRlck5hbWUsIHR5cGUpO1xuXG4gICAgZm9yIChjb25zdCBzY3JpcHREYXRhIG9mIGZvbGRlckRhdGEudmFsdWUpIHtcbiAgICAgIGNvbnN0IHNjcmlwdCA9IG5ldyBTY3JpcHQoe1xuICAgICAgICAuLi5zY3JpcHREYXRhLFxuICAgICAgICBlbmFibGVkOiBmYWxzZSxcbiAgICAgIH0pO1xuICAgICAgYXdhaXQgdGhpcy5oYW5kbGVTY3JpcHRJbXBvcnQoc2NyaXB0LCB0eXBlKTtcbiAgICAgIGF3YWl0IHRoaXMuc2NyaXB0RGF0YS5tb3ZlU2NyaXB0VG9Gb2xkZXIoc2NyaXB0LmlkLCBmb2xkZXJJZCwgdHlwZSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWkhOeQhuiEmuacrOWvvOWFpeWGsueqgVxuICAgKiBAcGFyYW0gc2NyaXB0IOimgeWvvOWFpeeahOiEmuacrFxuICAgKiBAcGFyYW0gdHlwZSDnm67moIfnsbvlnotcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgaGFuZGxlU2NyaXB0SW1wb3J0KHNjcmlwdDogU2NyaXB0LCB0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgZ2xvYmFsU2NyaXB0cyA9IHRoaXMuc2NyaXB0RGF0YS5nZXRHbG9iYWxTY3JpcHRzKCk7XG4gICAgY29uc3QgY2hhcmFjdGVyU2NyaXB0cyA9IHRoaXMuc2NyaXB0RGF0YS5nZXRDaGFyYWN0ZXJTY3JpcHRzKCk7XG5cbiAgICBjb25zdCBjb25mbGljdEluR2xvYmFsID0gZ2xvYmFsU2NyaXB0cy5maW5kKHMgPT4gcy5pZCA9PT0gc2NyaXB0LmlkKTtcbiAgICBjb25zdCBjb25mbGljdEluQ2hhcmFjdGVyID0gY2hhcmFjdGVyU2NyaXB0cy5maW5kKHMgPT4gcy5pZCA9PT0gc2NyaXB0LmlkKTtcblxuICAgIGxldCBleGlzdGluZ1NjcmlwdDogU2NyaXB0IHwgdW5kZWZpbmVkO1xuICAgIGxldCBjb25mbGljdFR5cGU6IFNjcmlwdFR5cGUgfCB1bmRlZmluZWQ7XG5cbiAgICBpZiAoY29uZmxpY3RJbkdsb2JhbCkge1xuICAgICAgZXhpc3RpbmdTY3JpcHQgPSBjb25mbGljdEluR2xvYmFsO1xuICAgICAgY29uZmxpY3RUeXBlID0gU2NyaXB0VHlwZS5HTE9CQUw7XG4gICAgfSBlbHNlIGlmIChjb25mbGljdEluQ2hhcmFjdGVyKSB7XG4gICAgICBleGlzdGluZ1NjcmlwdCA9IGNvbmZsaWN0SW5DaGFyYWN0ZXI7XG4gICAgICBjb25mbGljdFR5cGUgPSBTY3JpcHRUeXBlLkNIQVJBQ1RFUjtcbiAgICB9XG5cbiAgICBpZiAoZXhpc3RpbmdTY3JpcHQgJiYgY29uZmxpY3RUeXBlKSB7XG4gICAgICBjb25zdCBhY3Rpb24gPSBhd2FpdCB0aGlzLmhhbmRsZVNjcmlwdElkQ29uZmxpY3Qoc2NyaXB0LCBleGlzdGluZ1NjcmlwdCwgdHlwZSwgJ2ltcG9ydCcpO1xuXG4gICAgICBzd2l0Y2ggKGFjdGlvbikge1xuICAgICAgICBjYXNlICduZXcnOlxuICAgICAgICAgIHNjcmlwdC5pZCA9IHV1aWR2NCgpO1xuICAgICAgICAgIGF3YWl0IHRoaXMuY3JlYXRlU2NyaXB0KHNjcmlwdCwgdHlwZSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ292ZXJyaWRlJzpcbiAgICAgICAgICBhd2FpdCB0aGlzLmRlbGV0ZVNjcmlwdChleGlzdGluZ1NjcmlwdC5pZCwgY29uZmxpY3RUeXBlKTtcbiAgICAgICAgICBhd2FpdCB0aGlzLmNyZWF0ZVNjcmlwdChzY3JpcHQsIHR5cGUpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdjYW5jZWwnOlxuICAgICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgYXdhaXQgdGhpcy5jcmVhdGVTY3JpcHQoc2NyaXB0LCB0eXBlKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog6K+75Y+W5paH5Lu25YaF5a655Li65paH5pysXG4gICAqIEBwYXJhbSBmaWxlIOaWh+S7tuWvueixoVxuICAgKiBAcmV0dXJucyDmlofku7blhoXlrrlcbiAgICovXG4gIHByaXZhdGUgcmVhZEZpbGVBc1RleHQoZmlsZTogRmlsZSk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG4gICAgICByZWFkZXIub25sb2FkID0gZSA9PiByZXNvbHZlKGUudGFyZ2V0Py5yZXN1bHQgYXMgc3RyaW5nKTtcbiAgICAgIHJlYWRlci5vbmVycm9yID0gZSA9PiByZWplY3QoZSk7XG4gICAgICByZWFkZXIucmVhZEFzVGV4dChmaWxlKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDliJvlu7rmlrDohJrmnKxcbiAgICogQHBhcmFtIHNjcmlwdCDohJrmnKxcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgY3JlYXRlU2NyaXB0KHNjcmlwdDogU2NyaXB0LCB0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgYXdhaXQgdGhpcy5zY3JpcHREYXRhLnNhdmVTY3JpcHQoc2NyaXB0LCB0eXBlKTtcbiAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlVJX1JFRlJFU0gsIHtcbiAgICAgIGFjdGlvbjogJ3NjcmlwdF9jcmVhdGUnLFxuICAgICAgc2NyaXB0LFxuICAgICAgdHlwZSxcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmm7TmlrDnjrDmnInohJrmnKxcbiAgICogQHBhcmFtIHNjcmlwdCDohJrmnKxcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgdXBkYXRlU2NyaXB0KHNjcmlwdDogU2NyaXB0LCB0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgYXdhaXQgdGhpcy5zY3JpcHREYXRhLnNhdmVTY3JpcHQoc2NyaXB0LCB0eXBlKTtcbiAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlVJX1JFRlJFU0gsIHtcbiAgICAgIGFjdGlvbjogJ3NjcmlwdF91cGRhdGUnLFxuICAgICAgc2NyaXB0LFxuICAgICAgdHlwZSxcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDnu5/kuIDkv53lrZjmjpLluo/mlrnms5UgLSDkv53lrZjku5PlupPpobnmjpLluo9cbiAgICogQHBhcmFtIHJlcG9zaXRvcnlJdGVtcyDku5PlupPpobnmlbDnu4TvvIjljIXlkKvmlofku7blpLnlkozohJrmnKznmoTmt7flkIjnu5PmnoTvvIlcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgc2F2ZU9yZGVyKHJlcG9zaXRvcnlJdGVtczogU2NyaXB0UmVwb3NpdG9yeUl0ZW1bXSwgdHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICh0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCkge1xuICAgICAgYXdhaXQgdGhpcy5zY3JpcHREYXRhLnNhdmVHbG9iYWxSZXBvc2l0b3J5SXRlbXMocmVwb3NpdG9yeUl0ZW1zKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYXdhaXQgdGhpcy5zY3JpcHREYXRhLnNhdmVDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMocmVwb3NpdG9yeUl0ZW1zKTtcbiAgICB9XG5cbiAgICB0aGlzLnNjcmlwdERhdGEubG9hZFNjcmlwdHMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDliKDpmaTohJrmnKxcbiAgICogQHBhcmFtIHNjcmlwdElkIOiEmuacrElEXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHVibGljIGFzeW5jIGRlbGV0ZVNjcmlwdChzY3JpcHRJZDogc3RyaW5nLCB0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3Qgc2NyaXB0ID0gdGhpcy5zY3JpcHREYXRhLmdldFNjcmlwdEJ5SWQoc2NyaXB0SWQpO1xuICAgIGlmICghc2NyaXB0KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDohJrmnKzkuI3lrZjlnKgnKTtcbiAgICB9XG5cbiAgICBhd2FpdCB0aGlzLnN0b3BTY3JpcHQoc2NyaXB0LCB0eXBlKTtcblxuICAgIGF3YWl0IHRoaXMuc2NyaXB0RGF0YS5kZWxldGVTY3JpcHQoc2NyaXB0SWQsIHR5cGUpO1xuXG4gICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5VSV9SRUZSRVNILCB7XG4gICAgICBhY3Rpb246ICdzY3JpcHRfZGVsZXRlJyxcbiAgICAgIHNjcmlwdElkLFxuICAgICAgdHlwZSxcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDnp7vliqjohJrmnKzliLDlj6bkuIDkuKrnsbvlnotcbiAgICogQHBhcmFtIHNjcmlwdCDohJrmnKxcbiAgICogQHBhcmFtIGZyb21UeXBlIOa6kOexu+Wei1xuICAgKi9cbiAgcHVibGljIGFzeW5jIG1vdmVTY3JpcHQoc2NyaXB0OiBTY3JpcHQsIGZyb21UeXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgYXdhaXQgdGhpcy5zdG9wU2NyaXB0KHNjcmlwdCwgZnJvbVR5cGUpO1xuXG4gICAgY29uc3QgdGFyZ2V0VHlwZSA9IGdldE9wcG9zaXRlU2NyaXB0VHlwZShmcm9tVHlwZSk7XG5cbiAgICBjb25zdCBleGlzdGluZ1NjcmlwdEluVGFyZ2V0ID0gdGhpcy5zY3JpcHREYXRhLmdldFNjcmlwdEJ5SWQoc2NyaXB0LmlkKTtcbiAgICBjb25zdCBleGlzdGluZ1NjcmlwdFR5cGUgPSBleGlzdGluZ1NjcmlwdEluVGFyZ2V0ID8gdGhpcy5zY3JpcHREYXRhLmdldFNjcmlwdFR5cGUoZXhpc3RpbmdTY3JpcHRJblRhcmdldCkgOiBudWxsO1xuXG4gICAgaWYgKGV4aXN0aW5nU2NyaXB0SW5UYXJnZXQgJiYgZXhpc3RpbmdTY3JpcHRUeXBlID09PSB0YXJnZXRUeXBlKSB7XG4gICAgICBjb25zdCBhY3Rpb24gPSBhd2FpdCB0aGlzLmhhbmRsZVNjcmlwdElkQ29uZmxpY3Qoc2NyaXB0LCBleGlzdGluZ1NjcmlwdEluVGFyZ2V0LCB0YXJnZXRUeXBlLCAnbW92ZScpO1xuXG4gICAgICBzd2l0Y2ggKGFjdGlvbikge1xuICAgICAgICBjYXNlICduZXcnOlxuICAgICAgICAgIHNjcmlwdC5pZCA9IHV1aWR2NCgpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdvdmVycmlkZSc6XG4gICAgICAgICAgYXdhaXQgdGhpcy5kZWxldGVTY3JpcHQoZXhpc3RpbmdTY3JpcHRJblRhcmdldC5pZCwgdGFyZ2V0VHlwZSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ2NhbmNlbCc6XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cblxuICAgIGF3YWl0IHRoaXMuc2NyaXB0RGF0YS5tb3ZlSXRlbVRvT3RoZXJUeXBlKHsgdHlwZTogJ3NjcmlwdCcsIGlkOiBzY3JpcHQuaWQsIHZhbHVlOiBzY3JpcHQgfSwgZnJvbVR5cGUpO1xuXG4gICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5VSV9SRUZSRVNILCB7XG4gICAgICBhY3Rpb246ICdzY3JpcHRfbW92ZScsXG4gICAgICBzY3JpcHQsXG4gICAgICBmcm9tVHlwZSxcbiAgICAgIHRhcmdldFR5cGUsXG4gICAgfSk7XG5cbiAgICBpZiAoXG4gICAgICBzY3JpcHQuZW5hYmxlZCAmJlxuICAgICAgKCh0YXJnZXRUeXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCAmJiB0aGlzLnNjcmlwdERhdGEuaXNHbG9iYWxTY3JpcHRFbmFibGVkKSB8fFxuICAgICAgICAodGFyZ2V0VHlwZSA9PT0gU2NyaXB0VHlwZS5DSEFSQUNURVIgJiYgdGhpcy5zY3JpcHREYXRhLmlzQ2hhcmFjdGVyU2NyaXB0RW5hYmxlZCkpXG4gICAgKSB7XG4gICAgICBhd2FpdCB0aGlzLnJ1blNjcmlwdChzY3JpcHQsIHRhcmdldFR5cGUpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDliLfmlrDop5LoibLohJrmnKzmlbDmja5cbiAgICovXG4gIHB1YmxpYyByZWZyZXNoQ2hhcmFjdGVyU2NyaXB0RGF0YSgpOiB2b2lkIHtcbiAgICB0aGlzLnNjcmlwdERhdGEuZ2V0Q2hhcmFjdGVyU2NyaXB0cygpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluWFqOWxgOiEmuacrFxuICAgKi9cbiAgcHVibGljIGdldEdsb2JhbFNjcmlwdHMoKTogU2NyaXB0W10ge1xuICAgIHJldHVybiB0aGlzLnNjcmlwdERhdGEuZ2V0R2xvYmFsU2NyaXB0cygpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluinkuiJsuiEmuacrFxuICAgKi9cbiAgcHVibGljIGdldENoYXJhY3RlclNjcmlwdHMoKTogU2NyaXB0W10ge1xuICAgIHJldHVybiB0aGlzLnNjcmlwdERhdGEuZ2V0Q2hhcmFjdGVyU2NyaXB0cygpO1xuICB9XG5cbiAgLyoqXG4gICAqIOWIt+aWsOinkuiJsuiEmuacrOWQr+eUqOeKtuaAgVxuICAgKi9cbiAgcHVibGljIHJlZnJlc2hDaGFyYWN0ZXJTY3JpcHRFbmFibGVkU3RhdGUoKTogdm9pZCB7XG4gICAgdGhpcy5zY3JpcHREYXRhLnJlZnJlc2hDaGFyYWN0ZXJTY3JpcHRFbmFibGVkU3RhdGUoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5blhajlsYDohJrmnKzlkK/nlKjnirbmgIFcbiAgICovXG4gIHB1YmxpYyBnZXQgaXNHbG9iYWxTY3JpcHRFbmFibGVkKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLnNjcmlwdERhdGEuaXNHbG9iYWxTY3JpcHRFbmFibGVkO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluinkuiJsuiEmuacrOWQr+eUqOeKtuaAgVxuICAgKi9cbiAgcHVibGljIGdldCBpc0NoYXJhY3RlclNjcmlwdEVuYWJsZWQoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuc2NyaXB0RGF0YS5pc0NoYXJhY3RlclNjcmlwdEVuYWJsZWQ7XG4gIH1cblxuICAvKipcbiAgICog5qC55o2uSUTojrflj5bohJrmnKxcbiAgICogQHBhcmFtIGlkIOiEmuacrElEXG4gICAqL1xuICBwdWJsaWMgZ2V0U2NyaXB0QnlJZChpZDogc3RyaW5nKTogU2NyaXB0IHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5zY3JpcHREYXRhLmdldFNjcmlwdEJ5SWQoaWQpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluWFqOWxgOiEmuacrOS7k+W6k+mhue+8iOWMheWQq+aWh+S7tuWkuee7k+aehO+8iVxuICAgKi9cbiAgcHVibGljIGdldEdsb2JhbFJlcG9zaXRvcnlJdGVtcygpOiBTY3JpcHRSZXBvc2l0b3J5SXRlbVtdIHtcbiAgICByZXR1cm4gdGhpcy5zY3JpcHREYXRhLmdldEdsb2JhbFJlcG9zaXRvcnlJdGVtcygpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluinkuiJsuiEmuacrOS7k+W6k+mhue+8iOWMheWQq+aWh+S7tuWkuee7k+aehO+8iVxuICAgKi9cbiAgcHVibGljIGdldENoYXJhY3RlclJlcG9zaXRvcnlJdGVtcygpOiBTY3JpcHRSZXBvc2l0b3J5SXRlbVtdIHtcbiAgICByZXR1cm4gdGhpcy5zY3JpcHREYXRhLmdldENoYXJhY3RlclJlcG9zaXRvcnlJdGVtcygpO1xuICB9XG5cbiAgLyoqXG4gICAqIOWIm+W7uuaWh+S7tuWkuVxuICAgKi9cbiAgcHVibGljIGFzeW5jIGNyZWF0ZUZvbGRlcihuYW1lOiBzdHJpbmcsIHR5cGU6IFNjcmlwdFR5cGUsIGljb24/OiBzdHJpbmcsIGNvbG9yPzogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5zY3JpcHREYXRhLmNyZWF0ZUZvbGRlcihuYW1lLCB0eXBlLCBpY29uLCBjb2xvcik7XG4gIH1cblxuICAvKipcbiAgICog6YeN5ZG95ZCN5paH5Lu25aS5XG4gICAqL1xuICBwdWJsaWMgYXN5bmMgZWRpdEZvbGRlcihcbiAgICBmb2xkZXJJZDogc3RyaW5nLFxuICAgIG5ld05hbWU6IHN0cmluZyxcbiAgICB0eXBlOiBTY3JpcHRUeXBlLFxuICAgIG5ld0ljb24/OiBzdHJpbmcsXG4gICAgbmV3Q29sb3I/OiBzdHJpbmcsXG4gICk6IFByb21pc2U8dm9pZD4ge1xuICAgIGF3YWl0IHRoaXMuc2NyaXB0RGF0YS5lZGl0Rm9sZGVyKGZvbGRlcklkLCBuZXdOYW1lLCB0eXBlLCBuZXdJY29uLCBuZXdDb2xvcik7XG4gIH1cblxuICAvKipcbiAgICog5Yig6Zmk5paH5Lu25aS5XG4gICAqL1xuICBwdWJsaWMgYXN5bmMgZGVsZXRlRm9sZGVyKGZvbGRlcklkOiBzdHJpbmcsIHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBhd2FpdCB0aGlzLnNjcmlwdERhdGEuZGVsZXRlRm9sZGVyKGZvbGRlcklkLCB0eXBlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlsIbohJrmnKznp7vliqjliLDmlofku7blpLlcbiAgICovXG4gIHB1YmxpYyBhc3luYyBtb3ZlU2NyaXB0VG9Gb2xkZXIoc2NyaXB0SWQ6IHN0cmluZywgdGFyZ2V0Rm9sZGVySWQ6IHN0cmluZyB8IG51bGwsIHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBhd2FpdCB0aGlzLnNjcmlwdERhdGEubW92ZVNjcmlwdFRvRm9sZGVyKHNjcmlwdElkLCB0YXJnZXRGb2xkZXJJZCwgdHlwZSk7XG4gIH1cblxuICAvKipcbiAgICog5bCG5paH5Lu25aS556e75Yqo5Yiw5YW25LuW57G75Z6LXG4gICAqIEBwYXJhbSBmb2xkZXJJZCDmlofku7blpLlJRFxuICAgKiBAcGFyYW0gZnJvbVR5cGUg5rqQ57G75Z6LXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgbW92ZUZvbGRlcihmb2xkZXJJZDogc3RyaW5nLCBmcm9tVHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHRhcmdldFR5cGUgPSBnZXRPcHBvc2l0ZVNjcmlwdFR5cGUoZnJvbVR5cGUpO1xuXG4gICAgYXdhaXQgdGhpcy5zY3JpcHREYXRhLm1vdmVJdGVtVG9PdGhlclR5cGUoeyB0eXBlOiAnZm9sZGVyJywgaWQ6IGZvbGRlcklkIH0sIGZyb21UeXBlKTtcblxuICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuVUlfUkVGUkVTSCwge1xuICAgICAgYWN0aW9uOiAnZm9sZGVyX21vdmUnLFxuICAgICAgZm9sZGVySWQsXG4gICAgICBmcm9tVHlwZSxcbiAgICAgIHRhcmdldFR5cGUsXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5paH5Lu25aS55Lit55qE6ISa5pysXG4gICAqL1xuICBwdWJsaWMgZ2V0Rm9sZGVyU2NyaXB0cyhmb2xkZXJJZDogc3RyaW5nLCB0eXBlOiBTY3JpcHRUeXBlKTogU2NyaXB0W10ge1xuICAgIHJldHVybiB0aGlzLnNjcmlwdERhdGEuZ2V0Rm9sZGVyU2NyaXB0cyhmb2xkZXJJZCwgdHlwZSk7XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5qC557qn5Yir55qE6ISa5pysXG4gICAqL1xuICBwdWJsaWMgZ2V0Um9vdFNjcmlwdHModHlwZTogU2NyaXB0VHlwZSk6IFNjcmlwdFtdIHtcbiAgICByZXR1cm4gdGhpcy5zY3JpcHREYXRhLmdldFJvb3RTY3JpcHRzKHR5cGUpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluaJgOacieaWh+S7tuWkuVxuICAgKi9cbiAgcHVibGljIGdldEZvbGRlcnModHlwZTogU2NyaXB0VHlwZSk6IFNjcmlwdFJlcG9zaXRvcnlJdGVtW10ge1xuICAgIHJldHVybiB0aGlzLnNjcmlwdERhdGEuZ2V0Rm9sZGVycyh0eXBlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmibnph4/liIfmjaLmlofku7blpLnlhoXmiYDmnInohJrmnKznmoTlkK/nlKjnirbmgIFcbiAgICogQHBhcmFtIGZvbGRlcklkIOaWh+S7tuWkuUlEXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKiBAcGFyYW0gZW5hYmxlIOaYr+WQpuWQr+eUqFxuICAgKi9cbiAgcHVibGljIGFzeW5jIHRvZ2dsZUZvbGRlclNjcmlwdHMoZm9sZGVySWQ6IHN0cmluZywgdHlwZTogU2NyaXB0VHlwZSwgZW5hYmxlOiBib29sZWFuKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHRoaXMuc2NyaXB0RGF0YS50b2dnbGVGb2xkZXJTY3JpcHRzKGZvbGRlcklkLCB0eXBlLCBlbmFibGUpO1xuXG4gICAgICBjb25zdCBzY3JpcHRzID0gdGhpcy5zY3JpcHREYXRhLmdldEZvbGRlclNjcmlwdHMoZm9sZGVySWQsIHR5cGUpO1xuXG4gICAgICBjb25zdCBpc1R5cGVFbmFibGVkID1cbiAgICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyB0aGlzLnNjcmlwdERhdGEuaXNHbG9iYWxTY3JpcHRFbmFibGVkIDogdGhpcy5zY3JpcHREYXRhLmlzQ2hhcmFjdGVyU2NyaXB0RW5hYmxlZDtcblxuICAgICAgaWYgKGlzVHlwZUVuYWJsZWQpIHtcbiAgICAgICAgZm9yIChjb25zdCBzY3JpcHQgb2Ygc2NyaXB0cykge1xuICAgICAgICAgIGlmIChlbmFibGUgJiYgc2NyaXB0LmVuYWJsZWQpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucnVuU2NyaXB0KHNjcmlwdCwgdHlwZSk7XG4gICAgICAgICAgfSBlbHNlIGlmICghZW5hYmxlKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnN0b3BTY3JpcHQoc2NyaXB0LCB0eXBlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5VSV9SRUZSRVNILCB7XG4gICAgICAgIGFjdGlvbjogJ2ZvbGRlcl9zY3JpcHRzX3RvZ2dsZScsXG4gICAgICAgIGZvbGRlcklkLFxuICAgICAgICB0eXBlLFxuICAgICAgICBlbmFibGUsXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nLmVycm9yKGBbU2NyaXB0TWFuYWdlcl0g5om56YeP5YiH5o2i5paH5Lu25aS56ISa5pys54q25oCB5aSx6LSlOiAke2ZvbGRlcklkfWAsIGVycm9yKTtcbiAgICAgIHRvYXN0ci5lcnJvcihg5om56YeP5YiH5o2i5paH5Lu25aS56ISa5pys54q25oCB5aSx6LSlYCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluaWh+S7tuWkueWGheiEmuacrOeahOaVtOS9k+WQr+eUqOeKtuaAgVxuICAgKiBAcGFyYW0gZm9sZGVySWQg5paH5Lu25aS5SURcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwdWJsaWMgZ2V0Rm9sZGVyU2NyaXB0c1N0YXRlKGZvbGRlcklkOiBzdHJpbmcsIHR5cGU6IFNjcmlwdFR5cGUpOiAnYWxsJyB8ICdub25lJyB7XG4gICAgcmV0dXJuIHRoaXMuc2NyaXB0RGF0YS5nZXRGb2xkZXJTY3JpcHRzU3RhdGUoZm9sZGVySWQsIHR5cGUpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluaMh+WumuiEmuacrOeahOaMiemSruaVsOe7hFxuICAgKiBAcGFyYW0gc2NyaXB0SWQg6ISa5pysSURcbiAgICogQHJldHVybnMg5oyJ6ZKu5pWw57uEXG4gICAqL1xuICBwdWJsaWMgZ2V0U2NyaXB0QnV0dG9uKHNjcmlwdElkOiBzdHJpbmcpOiBTY3JpcHRbJ2J1dHRvbnMnXSB7XG4gICAgY29uc3Qgc2NyaXB0ID0gdGhpcy5zY3JpcHREYXRhLmdldFNjcmlwdEJ5SWQoc2NyaXB0SWQpO1xuICAgIGlmICghc2NyaXB0KSB7XG4gICAgICBsb2cud2FybihgW1NjcmlwdE1hbmFnZXJdIOiEmuacrOS4jeWtmOWcqDogJHtzY3JpcHRJZH1gKTtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gICAgcmV0dXJuIHNjcmlwdC5idXR0b25zO1xuICB9XG5cbiAgLyoqXG4gICAqIOS/ruaUueWQjuabtOaWsOiEmuacrOaMiemSru+8iOS7hemHjeW7uuaMiemSru+8jOS4jemHjeWQr+iEmuacrO+8iVxuICAgKiBAcGFyYW0gc2NyaXB0IOiEmuacrOWvueixoVxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHB1YmxpYyBhc3luYyBzZXRTY3JpcHRCdXR0b24oc2NyaXB0OiBTY3JpcHQsIHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBhd2FpdCB0aGlzLnNjcmlwdERhdGEuc2F2ZVNjcmlwdChzY3JpcHQsIHR5cGUpO1xuXG4gICAgaWYgKHNjcmlwdC5lbmFibGVkKSB7XG4gICAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLkJVVFRPTl9SRU1PVkUsIHsgc2NyaXB0SWQ6IHNjcmlwdC5pZCB9KTtcblxuICAgICAgaWYgKHNjcmlwdC5idXR0b25zICYmIHNjcmlwdC5idXR0b25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5CVVRUT05fQURELCB7IHNjcmlwdCB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5oyH5a6a6ISa5pys55qE5Y+Y6YeP5pWw5o2uXG4gICAqIEBwYXJhbSBzY3JpcHRJZCDohJrmnKxJRFxuICAgKiBAcmV0dXJucyDohJrmnKznmoRkYXRh5a2X5q6177yM5aaC5p6c6ISa5pys5LiN5a2Y5Zyo6L+U5Zue56m65a+56LGhXG4gICAqL1xuICBwdWJsaWMgZ2V0U2NyaXB0VmFyaWFibGVzKHNjcmlwdElkOiBzdHJpbmcpOiB7IFtrZXk6IHN0cmluZ106IGFueSB9IHtcbiAgICBjb25zdCBzY3JpcHQgPSB0aGlzLnNjcmlwdERhdGEuZ2V0U2NyaXB0QnlJZChzY3JpcHRJZCk7XG4gICAgaWYgKCFzY3JpcHQpIHtcbiAgICAgIGxvZy53YXJuKGBbU2NyaXB0TWFuYWdlcl0g6ISa5pys5LiN5a2Y5ZyoOiAke3NjcmlwdElkfWApO1xuICAgICAgcmV0dXJuIHt9O1xuICAgIH1cbiAgICByZXR1cm4gc2NyaXB0LmRhdGEgfHwge307XG4gIH1cblxuICAvKipcbiAgICog5pu05paw5oyH5a6a6ISa5pys55qE5Y+Y6YeP5pWw5o2uXG4gICAqIEBwYXJhbSBzY3JpcHRJZCDohJrmnKxJRFxuICAgKiBAcGFyYW0gdmFyaWFibGVzIOaWsOeahOWPmOmHj+aVsOaNrlxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICogQHJldHVybnMg5piv5ZCm5pu05paw5oiQ5YqfXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgdXBkYXRlU2NyaXB0VmFyaWFibGVzKFxuICAgIHNjcmlwdElkOiBzdHJpbmcsXG4gICAgdmFyaWFibGVzOiB7IFtrZXk6IHN0cmluZ106IGFueSB9LFxuICAgIHR5cGU6IFNjcmlwdFR5cGUsXG4gICk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGNvbnN0IHNjcmlwdCA9IHRoaXMuc2NyaXB0RGF0YS5nZXRTY3JpcHRCeUlkKHNjcmlwdElkKTtcbiAgICBpZiAoIXNjcmlwdCkge1xuICAgICAgbG9nLndhcm4oYFtTY3JpcHRNYW5hZ2VyXSDohJrmnKzkuI3lrZjlnKg6ICR7c2NyaXB0SWR9YCk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgc2NyaXB0LmRhdGEgPSB2YXJpYWJsZXM7XG4gICAgYXdhaXQgdGhpcy5zY3JpcHREYXRhLnNhdmVTY3JpcHQoc2NyaXB0LCB0eXBlKTtcblxuICAgIGxvZy5pbmZvKGBbU2NyaXB0TWFuYWdlcl0g5bey5pu05paw6ISa5pys5Y+Y6YePOiAke3NjcmlwdC5uYW1lfWApO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluaJgOacieiEmuacrOeahOWPmOmHj+aVsOaNru+8iOeUqOS6juiwg+ivleWSjOeuoeeQhu+8iVxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICogQHJldHVybnMg5omA5pyJ6ISa5pys55qE5Y+Y6YeP5pWw5o2u5pig5bCEXG4gICAqL1xuICBwdWJsaWMgZ2V0QWxsU2NyaXB0VmFyaWFibGVzKHR5cGU6IFNjcmlwdFR5cGUpOiBNYXA8c3RyaW5nLCB7IFtrZXk6IHN0cmluZ106IGFueSB9PiB7XG4gICAgY29uc3Qgc2NyaXB0cyA9XG4gICAgICB0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCA/IHRoaXMuc2NyaXB0RGF0YS5nZXRHbG9iYWxTY3JpcHRzKCkgOiB0aGlzLnNjcmlwdERhdGEuZ2V0Q2hhcmFjdGVyU2NyaXB0cygpO1xuXG4gICAgY29uc3QgdmFyaWFibGVzTWFwID0gbmV3IE1hcDxzdHJpbmcsIHsgW2tleTogc3RyaW5nXTogYW55IH0+KCk7XG5cbiAgICBzY3JpcHRzLmZvckVhY2goc2NyaXB0ID0+IHtcbiAgICAgIGlmIChzY3JpcHQuZGF0YSAmJiBPYmplY3Qua2V5cyhzY3JpcHQuZGF0YSkubGVuZ3RoID4gMCkge1xuICAgICAgICB2YXJpYWJsZXNNYXAuc2V0KHNjcmlwdC5pZCwgc2NyaXB0LmRhdGEpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHZhcmlhYmxlc01hcDtcbiAgfVxuXG4gIC8qKlxuICAgKiDmuIXnkIbmiYDmnInotYTmupBcbiAgICovXG4gIHB1YmxpYyBhc3luYyBjbGVhbnVwKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGF3YWl0IHRoaXMuZXhlY3V0b3IuY2xlYXJBbGxTY3JpcHRzSWZyYW1lKCk7XG4gIH1cblxuICAvKipcbiAgICog5aSE55CG6ISa5pysSUTlhrLnqoFcbiAgICogQHBhcmFtIHNjcmlwdCDopoHlpITnkIbnmoTohJrmnKxcbiAgICogQHBhcmFtIGV4aXN0aW5nU2NyaXB0IOW3suWtmOWcqOeahOiEmuacrFxuICAgKiBAcGFyYW0gdGFyZ2V0VHlwZSDnm67moIfnsbvlnotcbiAgICogQHBhcmFtIG9wZXJhdGlvblR5cGUg5pON5L2c57G75Z6L77yaJ2ltcG9ydCcgLSDlr7zlhaUsICdtb3ZlJyAtIOenu+WKqFxuICAgKiBAcmV0dXJucyDlpITnkIbnu5PmnpzvvJonbmV3JyAtIOS9v+eUqOaWsElELCAnb3ZlcnJpZGUnIC0g6KaG55uW5bey5pyJ6ISa5pysLCAnY2FuY2VsJyAtIOWPlua2iOaTjeS9nFxuICAgKi9cbiAgcHVibGljIGFzeW5jIGhhbmRsZVNjcmlwdElkQ29uZmxpY3QoXG4gICAgc2NyaXB0OiBTY3JpcHQsXG4gICAgZXhpc3RpbmdTY3JpcHQ6IFNjcmlwdCxcbiAgICB0YXJnZXRUeXBlOiBTY3JpcHRUeXBlLFxuICAgIG9wZXJhdGlvblR5cGU6ICdpbXBvcnQnIHwgJ21vdmUnID0gJ2ltcG9ydCcsXG4gICk6IFByb21pc2U8J25ldycgfCAnb3ZlcnJpZGUnIHwgJ2NhbmNlbCc+IHtcbiAgICBjb25zdCBleGlzdGluZ1NjcmlwdFR5cGUgPSB0aGlzLnNjcmlwdERhdGEuZ2V0U2NyaXB0VHlwZShleGlzdGluZ1NjcmlwdCk7XG4gICAgY29uc3QgZXhpc3RpbmdUeXBlVGV4dCA9IGV4aXN0aW5nU2NyaXB0VHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyAn5YWo5bGA6ISa5pysJyA6ICfop5LoibLohJrmnKwnO1xuICAgIGNvbnN0IHRhcmdldFR5cGVUZXh0ID0gdGFyZ2V0VHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyAn5YWo5bGA6ISa5pysJyA6ICfop5LoibLohJrmnKwnO1xuXG4gICAgbGV0IG1lc3NhZ2U6IHN0cmluZztcbiAgICBpZiAob3BlcmF0aW9uVHlwZSA9PT0gJ2ltcG9ydCcpIHtcbiAgICAgIG1lc3NhZ2UgPSBg6KaB5a+85YWl55qE6ISa5pysICcke3NjcmlwdC5uYW1lfScg5LiOJHtleGlzdGluZ1R5cGVUZXh0feW6k+S4reeahCAnJHtleGlzdGluZ1NjcmlwdC5uYW1lfScgaWQg55u45ZCM77yM5piv5ZCm6KaB57un57ut5pON5L2c77yfYDtcbiAgICB9IGVsc2Uge1xuICAgICAgbWVzc2FnZSA9IGDopoHnp7vliqjliLAke3RhcmdldFR5cGVUZXh0feW6k+eahOiEmuacrCAnJHtzY3JpcHQubmFtZX0nIOS4juebruagh+W6k+S4reeahCAnJHtleGlzdGluZ1NjcmlwdC5uYW1lfScgaWQg55u45ZCM77yM5piv5ZCm6KaB57un57ut5pON5L2c77yfYDtcbiAgICB9XG5cbiAgICBjb25zdCBpbnB1dCA9IGF3YWl0IGNhbGxHZW5lcmljUG9wdXAobWVzc2FnZSwgUE9QVVBfVFlQRS5URVhULCAnJywge1xuICAgICAgb2tCdXR0b246ICfopobnm5bljp/ohJrmnKwnLFxuICAgICAgY2FuY2VsQnV0dG9uOiAn5Y+W5raIJyxcbiAgICAgIGN1c3RvbUJ1dHRvbnM6IFsn5paw5bu66ISa5pysJ10sXG4gICAgfSk7XG5cbiAgICBsZXQgYWN0aW9uOiAnbmV3JyB8ICdvdmVycmlkZScgfCAnY2FuY2VsJyA9ICdjYW5jZWwnO1xuXG4gICAgc3dpdGNoIChpbnB1dCkge1xuICAgICAgY2FzZSAwOlxuICAgICAgICBhY3Rpb24gPSAnY2FuY2VsJztcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDE6XG4gICAgICAgIGFjdGlvbiA9ICdvdmVycmlkZSc7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAyOlxuICAgICAgICBhY3Rpb24gPSAnbmV3JztcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgcmV0dXJuIGFjdGlvbjtcbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/component/script_repository/script_controller.ts\n")},"./src/component/script_repository/types.ts":
/*!**************************************************!*\
  !*** ./src/component/script_repository/types.ts ***!
  \**************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Script: () => (/* binding */ Script),\n/* harmony export */   ScriptType: () => (/* binding */ ScriptType),\n/* harmony export */   defaultScriptSettings: () => (/* binding */ defaultScriptSettings),\n/* harmony export */   extractScriptsFromRepository: () => (/* binding */ extractScriptsFromRepository),\n/* harmony export */   getBatchControlsSelector: () => (/* binding */ getBatchControlsSelector),\n/* harmony export */   getOppositeScriptType: () => (/* binding */ getOppositeScriptType),\n/* harmony export */   getScriptListSelector: () => (/* binding */ getScriptListSelector),\n/* harmony export */   getScriptToggleSelector: () => (/* binding */ getScriptToggleSelector),\n/* harmony export */   isScript: () => (/* binding */ isScript),\n/* harmony export */   isScriptRepositoryItem: () => (/* binding */ isScriptRepositoryItem),\n/* harmony export */   migrateScriptsToRepositoryItems: () => (/* binding */ migrateScriptsToRepositoryItems)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n\nclass Script {\n    id;\n    name;\n    content;\n    info;\n    buttons;\n    data;\n    enabled;\n    constructor(data) {\n        this.id = data?.id && data.id.trim() !== '' ? data.id : (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_0__.uuidv4)();\n        this.name = data?.name || '';\n        this.content = data?.content || '';\n        this.info = data?.info || '';\n        this.enabled = data?.enabled || false;\n        this.buttons = data?.buttons || [];\n        this.data = data?.data || {};\n    }\n}\nvar ScriptType;\n(function (ScriptType) {\n    ScriptType[\"GLOBAL\"] = \"global\";\n    ScriptType[\"CHARACTER\"] = \"character\";\n})(ScriptType || (ScriptType = {}));\nconst defaultScriptSettings = {\n    global_script_enabled: true,\n    scriptsRepository: [],\n    characters_with_scripts: [],\n};\nfunction isScriptRepositoryItem(item) {\n    return item && typeof item === 'object' && 'type' in item && 'value' in item;\n}\nfunction isScript(item) {\n    return item && typeof item === 'object' && 'id' in item && 'name' in item && 'content' in item;\n}\nfunction migrateScriptsToRepositoryItems(scripts) {\n    return scripts.map(script => ({\n        type: 'script',\n        value: script,\n    }));\n}\nfunction extractScriptsFromRepository(repository) {\n    const scripts = [];\n    for (const item of repository) {\n        if (isScript(item)) {\n            scripts.push(item);\n        }\n        else if (isScriptRepositoryItem(item)) {\n            if (item.type === 'script') {\n                scripts.push(item.value);\n            }\n            else if (item.type === 'folder') {\n                const folderScripts = item.value;\n                scripts.push(...folderScripts);\n            }\n        }\n    }\n    return scripts;\n}\n/**\n * 获取相对的脚本类型（全局<->角色）\n * @param type 当前脚本类型\n * @returns 相对的脚本类型\n */\nfunction getOppositeScriptType(type) {\n    return type === ScriptType.GLOBAL ? ScriptType.CHARACTER : ScriptType.GLOBAL;\n}\n/**\n * 获取脚本列表容器的选择器\n * @param type 脚本类型\n * @returns 容器选择器字符串\n */\nfunction getScriptListSelector(type) {\n    return type === ScriptType.GLOBAL ? '#global-script-list' : '#character-script-list';\n}\n/**\n * 获取批量控制器的选择器\n * @param type 脚本类型\n * @returns 批量控制器选择器字符串\n */\nfunction getBatchControlsSelector(type) {\n    return type === ScriptType.GLOBAL ? '#global-batch-controls' : '#character-batch-controls';\n}\n/**\n * 获取脚本类型切换器的选择器\n * @param type 脚本类型\n * @returns 切换器选择器字符串\n */\nfunction getScriptToggleSelector(type) {\n    return type === ScriptType.GLOBAL ? '#global-script-enable-toggle' : '#character-script-enable-toggle';\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3R5cGVzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFvRDtBQUU3QyxNQUFNLE1BQU07SUFDakIsRUFBRSxDQUFTO0lBQ1gsSUFBSSxDQUFTO0lBQ2IsT0FBTyxDQUFTO0lBQ2hCLElBQUksQ0FBUztJQUNiLE9BQU8sQ0FBdUM7SUFDOUMsSUFBSSxDQUFrQztJQUN0QyxPQUFPLENBQVU7SUFFakIsWUFBWSxJQUFzQjtRQUNoQyxJQUFJLENBQUMsRUFBRSxHQUFHLElBQUksRUFBRSxFQUFFLElBQUksSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLGtFQUFNLEVBQUUsQ0FBQztRQUNqRSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksRUFBRSxJQUFJLElBQUksRUFBRSxDQUFDO1FBQzdCLElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxFQUFFLE9BQU8sSUFBSSxFQUFFLENBQUM7UUFDbkMsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLEVBQUUsSUFBSSxJQUFJLEVBQUUsQ0FBQztRQUM3QixJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksRUFBRSxPQUFPLElBQUksS0FBSyxDQUFDO1FBQ3RDLElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxFQUFFLE9BQU8sSUFBSSxFQUFFLENBQUM7UUFDbkMsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLEVBQUUsSUFBSSxJQUFJLEVBQUUsQ0FBQztJQUMvQixDQUFDO0NBQ0Y7QUFZRCxJQUFZLFVBR1g7QUFIRCxXQUFZLFVBQVU7SUFDcEIsK0JBQWlCO0lBQ2pCLHFDQUF1QjtBQUN6QixDQUFDLEVBSFcsVUFBVSxLQUFWLFVBQVUsUUFHckI7QUFFTSxNQUFNLHFCQUFxQixHQUFHO0lBQ25DLHFCQUFxQixFQUFFLElBQUk7SUFDM0IsaUJBQWlCLEVBQUUsRUFBdUM7SUFDMUQsdUJBQXVCLEVBQUUsRUFBYztDQUN4QyxDQUFDO0FBT0ssU0FBUyxzQkFBc0IsQ0FBQyxJQUFTO0lBQzlDLE9BQU8sSUFBSSxJQUFJLE9BQU8sSUFBSSxLQUFLLFFBQVEsSUFBSSxNQUFNLElBQUksSUFBSSxJQUFJLE9BQU8sSUFBSSxJQUFJLENBQUM7QUFDL0UsQ0FBQztBQUVNLFNBQVMsUUFBUSxDQUFDLElBQVM7SUFDaEMsT0FBTyxJQUFJLElBQUksT0FBTyxJQUFJLEtBQUssUUFBUSxJQUFJLElBQUksSUFBSSxJQUFJLElBQUksTUFBTSxJQUFJLElBQUksSUFBSSxTQUFTLElBQUksSUFBSSxDQUFDO0FBQ2pHLENBQUM7QUFFTSxTQUFTLCtCQUErQixDQUFDLE9BQWlCO0lBQy9ELE9BQU8sT0FBTyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDNUIsSUFBSSxFQUFFLFFBQVE7UUFDZCxLQUFLLEVBQUUsTUFBTTtLQUNkLENBQUMsQ0FBQyxDQUFDO0FBQ04sQ0FBQztBQUVNLFNBQVMsNEJBQTRCLENBQUMsVUFBNkM7SUFDeEYsTUFBTSxPQUFPLEdBQWEsRUFBRSxDQUFDO0lBRTdCLEtBQUssTUFBTSxJQUFJLElBQUksVUFBVSxFQUFFLENBQUM7UUFDOUIsSUFBSSxRQUFRLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQztZQUNuQixPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3JCLENBQUM7YUFBTSxJQUFJLHNCQUFzQixDQUFDLElBQUksQ0FBQyxFQUFFLENBQUM7WUFDeEMsSUFBSSxJQUFJLENBQUMsSUFBSSxLQUFLLFFBQVEsRUFBRSxDQUFDO2dCQUMzQixPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFlLENBQUMsQ0FBQztZQUNyQyxDQUFDO2lCQUFNLElBQUksSUFBSSxDQUFDLElBQUksS0FBSyxRQUFRLEVBQUUsQ0FBQztnQkFDbEMsTUFBTSxhQUFhLEdBQUcsSUFBSSxDQUFDLEtBQWlCLENBQUM7Z0JBQzdDLE9BQU8sQ0FBQyxJQUFJLENBQUMsR0FBRyxhQUFhLENBQUMsQ0FBQztZQUNqQyxDQUFDO1FBQ0gsQ0FBQztJQUNILENBQUM7SUFFRCxPQUFPLE9BQU8sQ0FBQztBQUNqQixDQUFDO0FBRUQ7Ozs7R0FJRztBQUNJLFNBQVMscUJBQXFCLENBQUMsSUFBZ0I7SUFDcEQsT0FBTyxJQUFJLEtBQUssVUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQztBQUMvRSxDQUFDO0FBRUQ7Ozs7R0FJRztBQUNJLFNBQVMscUJBQXFCLENBQUMsSUFBZ0I7SUFDcEQsT0FBTyxJQUFJLEtBQUssVUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMscUJBQXFCLENBQUMsQ0FBQyxDQUFDLHdCQUF3QixDQUFDO0FBQ3ZGLENBQUM7QUFFRDs7OztHQUlHO0FBQ0ksU0FBUyx3QkFBd0IsQ0FBQyxJQUFnQjtJQUN2RCxPQUFPLElBQUksS0FBSyxVQUFVLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDLENBQUMsMkJBQTJCLENBQUM7QUFDN0YsQ0FBQztBQUVEOzs7O0dBSUc7QUFDSSxTQUFTLHVCQUF1QixDQUFDLElBQWdCO0lBQ3RELE9BQU8sSUFBSSxLQUFLLFVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLDhCQUE4QixDQUFDLENBQUMsQ0FBQyxpQ0FBaUMsQ0FBQztBQUN6RyxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBvbmVudC9zY3JpcHRfcmVwb3NpdG9yeS90eXBlcy50cz8zOTNiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHV1aWR2NCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3V0aWxzJztcblxuZXhwb3J0IGNsYXNzIFNjcmlwdCB7XG4gIGlkOiBzdHJpbmc7XG4gIG5hbWU6IHN0cmluZztcbiAgY29udGVudDogc3RyaW5nO1xuICBpbmZvOiBzdHJpbmc7XG4gIGJ1dHRvbnM6IHsgbmFtZTogc3RyaW5nOyB2aXNpYmxlOiBib29sZWFuIH1bXTtcbiAgZGF0YTogeyBbdmFyaWFibGVOYW1lOiBzdHJpbmddOiBhbnkgfTtcbiAgZW5hYmxlZDogYm9vbGVhbjtcblxuICBjb25zdHJ1Y3RvcihkYXRhPzogUGFydGlhbDxTY3JpcHQ+KSB7XG4gICAgdGhpcy5pZCA9IGRhdGE/LmlkICYmIGRhdGEuaWQudHJpbSgpICE9PSAnJyA/IGRhdGEuaWQgOiB1dWlkdjQoKTtcbiAgICB0aGlzLm5hbWUgPSBkYXRhPy5uYW1lIHx8ICcnO1xuICAgIHRoaXMuY29udGVudCA9IGRhdGE/LmNvbnRlbnQgfHwgJyc7XG4gICAgdGhpcy5pbmZvID0gZGF0YT8uaW5mbyB8fCAnJztcbiAgICB0aGlzLmVuYWJsZWQgPSBkYXRhPy5lbmFibGVkIHx8IGZhbHNlO1xuICAgIHRoaXMuYnV0dG9ucyA9IGRhdGE/LmJ1dHRvbnMgfHwgW107XG4gICAgdGhpcy5kYXRhID0gZGF0YT8uZGF0YSB8fCB7fTtcbiAgfVxufVxuXG5cbmV4cG9ydCBpbnRlcmZhY2UgU2NyaXB0UmVwb3NpdG9yeUl0ZW0ge1xuICB0eXBlOiAnZm9sZGVyJyB8ICdzY3JpcHQnO1xuICBpZD86IHN0cmluZztcbiAgbmFtZT86IHN0cmluZztcbiAgaWNvbj86IHN0cmluZztcbiAgY29sb3I/OiBzdHJpbmc7XG4gIHZhbHVlOiBTY3JpcHRbXSB8IFNjcmlwdDtcbn1cblxuZXhwb3J0IGVudW0gU2NyaXB0VHlwZSB7XG4gIEdMT0JBTCA9ICdnbG9iYWwnLFxuICBDSEFSQUNURVIgPSAnY2hhcmFjdGVyJyxcbn1cblxuZXhwb3J0IGNvbnN0IGRlZmF1bHRTY3JpcHRTZXR0aW5ncyA9IHtcbiAgZ2xvYmFsX3NjcmlwdF9lbmFibGVkOiB0cnVlLFxuICBzY3JpcHRzUmVwb3NpdG9yeTogW10gYXMgKFNjcmlwdCB8IFNjcmlwdFJlcG9zaXRvcnlJdGVtKVtdLFxuICBjaGFyYWN0ZXJzX3dpdGhfc2NyaXB0czogW10gYXMgc3RyaW5nW10sXG59O1xuXG5leHBvcnQgaW50ZXJmYWNlIElGcmFtZUVsZW1lbnQgZXh0ZW5kcyBIVE1MSUZyYW1lRWxlbWVudCB7XG4gIGNsZWFudXA6ICgpID0+IHZvaWQ7XG4gIFtwcm9wOiBzdHJpbmddOiBhbnk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1NjcmlwdFJlcG9zaXRvcnlJdGVtKGl0ZW06IGFueSk6IGl0ZW0gaXMgU2NyaXB0UmVwb3NpdG9yeUl0ZW0ge1xuICByZXR1cm4gaXRlbSAmJiB0eXBlb2YgaXRlbSA9PT0gJ29iamVjdCcgJiYgJ3R5cGUnIGluIGl0ZW0gJiYgJ3ZhbHVlJyBpbiBpdGVtO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNTY3JpcHQoaXRlbTogYW55KTogaXRlbSBpcyBTY3JpcHQge1xuICByZXR1cm4gaXRlbSAmJiB0eXBlb2YgaXRlbSA9PT0gJ29iamVjdCcgJiYgJ2lkJyBpbiBpdGVtICYmICduYW1lJyBpbiBpdGVtICYmICdjb250ZW50JyBpbiBpdGVtO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbWlncmF0ZVNjcmlwdHNUb1JlcG9zaXRvcnlJdGVtcyhzY3JpcHRzOiBTY3JpcHRbXSk6IFNjcmlwdFJlcG9zaXRvcnlJdGVtW10ge1xuICByZXR1cm4gc2NyaXB0cy5tYXAoc2NyaXB0ID0+ICh7XG4gICAgdHlwZTogJ3NjcmlwdCcsXG4gICAgdmFsdWU6IHNjcmlwdCxcbiAgfSkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZXh0cmFjdFNjcmlwdHNGcm9tUmVwb3NpdG9yeShyZXBvc2l0b3J5OiAoU2NyaXB0IHwgU2NyaXB0UmVwb3NpdG9yeUl0ZW0pW10pOiBTY3JpcHRbXSB7XG4gIGNvbnN0IHNjcmlwdHM6IFNjcmlwdFtdID0gW107XG5cbiAgZm9yIChjb25zdCBpdGVtIG9mIHJlcG9zaXRvcnkpIHtcbiAgICBpZiAoaXNTY3JpcHQoaXRlbSkpIHtcbiAgICAgIHNjcmlwdHMucHVzaChpdGVtKTtcbiAgICB9IGVsc2UgaWYgKGlzU2NyaXB0UmVwb3NpdG9yeUl0ZW0oaXRlbSkpIHtcbiAgICAgIGlmIChpdGVtLnR5cGUgPT09ICdzY3JpcHQnKSB7XG4gICAgICAgIHNjcmlwdHMucHVzaChpdGVtLnZhbHVlIGFzIFNjcmlwdCk7XG4gICAgICB9IGVsc2UgaWYgKGl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicpIHtcbiAgICAgICAgY29uc3QgZm9sZGVyU2NyaXB0cyA9IGl0ZW0udmFsdWUgYXMgU2NyaXB0W107XG4gICAgICAgIHNjcmlwdHMucHVzaCguLi5mb2xkZXJTY3JpcHRzKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gc2NyaXB0cztcbn1cblxuLyoqXG4gKiDojrflj5bnm7jlr7nnmoTohJrmnKznsbvlnovvvIjlhajlsYA8LT7op5LoibLvvIlcbiAqIEBwYXJhbSB0eXBlIOW9k+WJjeiEmuacrOexu+Wei1xuICogQHJldHVybnMg55u45a+555qE6ISa5pys57G75Z6LXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRPcHBvc2l0ZVNjcmlwdFR5cGUodHlwZTogU2NyaXB0VHlwZSk6IFNjcmlwdFR5cGUge1xuICByZXR1cm4gdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyBTY3JpcHRUeXBlLkNIQVJBQ1RFUiA6IFNjcmlwdFR5cGUuR0xPQkFMO1xufVxuXG4vKipcbiAqIOiOt+WPluiEmuacrOWIl+ihqOWuueWZqOeahOmAieaLqeWZqFxuICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gKiBAcmV0dXJucyDlrrnlmajpgInmi6nlmajlrZfnrKbkuLJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFNjcmlwdExpc3RTZWxlY3Rvcih0eXBlOiBTY3JpcHRUeXBlKTogc3RyaW5nIHtcbiAgcmV0dXJuIHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMID8gJyNnbG9iYWwtc2NyaXB0LWxpc3QnIDogJyNjaGFyYWN0ZXItc2NyaXB0LWxpc3QnO1xufVxuXG4vKipcbiAqIOiOt+WPluaJuemHj+aOp+WItuWZqOeahOmAieaLqeWZqFxuICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gKiBAcmV0dXJucyDmibnph4/mjqfliLblmajpgInmi6nlmajlrZfnrKbkuLJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEJhdGNoQ29udHJvbHNTZWxlY3Rvcih0eXBlOiBTY3JpcHRUeXBlKTogc3RyaW5nIHtcbiAgcmV0dXJuIHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMID8gJyNnbG9iYWwtYmF0Y2gtY29udHJvbHMnIDogJyNjaGFyYWN0ZXItYmF0Y2gtY29udHJvbHMnO1xufVxuXG4vKipcbiAqIOiOt+WPluiEmuacrOexu+Wei+WIh+aNouWZqOeahOmAieaLqeWZqFxuICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gKiBAcmV0dXJucyDliIfmjaLlmajpgInmi6nlmajlrZfnrKbkuLJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFNjcmlwdFRvZ2dsZVNlbGVjdG9yKHR5cGU6IFNjcmlwdFR5cGUpOiBzdHJpbmcge1xuICByZXR1cm4gdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyAnI2dsb2JhbC1zY3JpcHQtZW5hYmxlLXRvZ2dsZScgOiAnI2NoYXJhY3Rlci1zY3JpcHQtZW5hYmxlLXRvZ2dsZSc7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/component/script_repository/types.ts\n")},"./src/component/script_repository/ui_controller.ts":
/*!**********************************************************!*\
  !*** ./src/component/script_repository/ui_controller.ts ***!
  \**********************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   UIController: () => (/* binding */ UIController)\n/* harmony export */ });\n/* harmony import */ var _component_script_repository_button__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/script_repository/button */ \"./src/component/script_repository/button.ts\");\n/* harmony import */ var _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/component/script_repository/events */ \"./src/component/script_repository/events.ts\");\n/* harmony import */ var _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/component/script_repository/script_controller */ \"./src/component/script_repository/script_controller.ts\");\n/* harmony import */ var _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/component/script_repository/types */ \"./src/component/script_repository/types.ts\");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _util_render_markdown__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/util/render_markdown */ \"./src/util/render_markdown.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @sillytavern/scripts/popup */ \"@sillytavern/scripts/popup\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_10__);\n\n\n\n\n\n\n\n\n\n\n\nclass UIController {\n    static instance;\n    scriptManager;\n    buttonManager;\n    templatePath;\n    baseTemplate = null;\n    defaultScriptTemplate = null;\n    folderTemplate = null;\n    batchModeGlobal = false;\n    batchModeCharacter = false;\n    constructor() {\n        this.scriptManager = _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_2__.ScriptManager.getInstance();\n        this.buttonManager = new _component_script_repository_button__WEBPACK_IMPORTED_MODULE_0__.ButtonManager();\n        this.templatePath = `${_util_extension_variables__WEBPACK_IMPORTED_MODULE_4__.extensionFolderPath}/src/component/script_repository/public`;\n    }\n    /**\n     * 获取UI控制器实例\n     */\n    static getInstance() {\n        if (!UIController.instance) {\n            UIController.instance = new UIController();\n        }\n        return UIController.instance;\n    }\n    /**\n     * 销毁UI控制器实例\n     */\n    static destroyInstance() {\n        if (UIController.instance) {\n            UIController.instance.cleanup();\n            UIController.instance = undefined;\n        }\n    }\n    /**\n     * 清理资源\n     */\n    cleanup() {\n        this.buttonManager.clearButtons();\n        this.baseTemplate = null;\n        this.defaultScriptTemplate = null;\n        this.folderTemplate = null;\n    }\n    /**\n     * 初始化UI\n     */\n    async initialize() {\n        await this.initializeTemplates();\n        this.setupScriptRepositoryEvents();\n        this.registerEventListeners();\n        await this.renderScriptLists();\n        (0,_component_script_repository_button__WEBPACK_IMPORTED_MODULE_0__.initScriptButton)();\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.UI_LOADED);\n    }\n    /**\n     * 初始化模板\n     */\n    async initializeTemplates() {\n        this.baseTemplate = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_7__.renderExtensionTemplateAsync)(this.templatePath, 'script_item_template', {\n            scriptName: '',\n            id: '',\n            moveTo: '',\n            faIcon: '',\n        }));\n        this.defaultScriptTemplate = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_7__.renderExtensionTemplateAsync)(this.templatePath, 'script_default_repository', {\n            scriptName: '',\n            id: '',\n        }));\n        this.folderTemplate = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_7__.renderExtensionTemplateAsync)(this.templatePath, 'folder_template', {\n            folderId: '',\n            folderName: '',\n            folderIcon: 'fa-folder',\n            folderColor: document.documentElement.style.getPropertyValue('--SmartThemeBodyColor'),\n        }));\n    }\n    /**\n     * 初始化脚本库界面事件\n     */\n    setupScriptRepositoryEvents() {\n        $('#global-script-enable-toggle')\n            .prop('checked', this.scriptManager.isGlobalScriptEnabled)\n            .on('click', (event) => {\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.TYPE_TOGGLE, {\n                type: _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL,\n                enable: event.target.checked,\n                userInput: true,\n            });\n        });\n        $('#character-script-enable-toggle')\n            .prop('checked', this.scriptManager.isCharacterScriptEnabled)\n            .on('click', (event) => {\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.TYPE_TOGGLE, {\n                type: _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER,\n                enable: event.target.checked,\n                userInput: true,\n            });\n        });\n        $('#create-script').on('click', async () => {\n            await this.showCreateScriptDialog();\n        });\n        $('#import-script-file').on('change', async function () {\n            let target = 'global';\n            const template = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_7__.renderExtensionTemplateAsync)(`${_util_extension_variables__WEBPACK_IMPORTED_MODULE_4__.extensionFolderPath}/src/component/script_repository/public`, 'script_target_selector', {\n                title: '导入到:',\n                prefix: 'script-import',\n                globalLabel: '全局脚本',\n                characterLabel: '局部脚本',\n            }));\n            template.find('#script-import-target-global').on('input', () => (target = 'global'));\n            template.find('#script-import-target-character').on('input', () => (target = 'character'));\n            const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)(template, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.CONFIRM, '', {\n                okButton: '确认',\n                cancelButton: '取消',\n            });\n            if (result) {\n                const inputElement = this instanceof HTMLInputElement && this;\n                if (inputElement && inputElement.files) {\n                    for (const file of inputElement.files) {\n                        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.SCRIPT_IMPORT, {\n                            file,\n                            type: target === 'global' ? _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL : _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER,\n                        });\n                    }\n                    inputElement.value = '';\n                }\n            }\n        });\n        $('#import-script').on('click', function () {\n            $('#import-script-file').trigger('click');\n        });\n        $('#create-folder').on('click', () => {\n            this.showCreateFolderDialog();\n        });\n        $('#default-script').on('click', () => {\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.UI_REFRESH, { action: 'load_default_scripts' });\n        });\n        $('#extensions_settings').css('min-width', '0');\n        this.setupSearchEvents();\n        this.setupBatchOperationEvents();\n    }\n    /**\n     * 注册事件监听器\n     */\n    registerEventListeners() {\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.UI_REFRESH, async (data) => {\n            const { action } = data;\n            switch (action) {\n                case 'script_toggle':\n                    await this.refreshScriptState(data.script, data.enable);\n                    this.updateParentFolderToggle(data.script.id, data.type);\n                    break;\n                case 'type_toggle':\n                    await this.refreshTypeState(data.type, data.enable);\n                    break;\n                case 'script_import':\n                    await this.addScriptToContainer(data.script, data.type);\n                    break;\n                case 'script_create':\n                    await this.addScriptToContainer(data.script, data.type);\n                    break;\n                case 'script_update':\n                    this.updateScriptUI(data.script, data.type);\n                    break;\n                case 'script_delete':\n                    this.removeScriptElement(data.scriptId);\n                    break;\n                case 'script_move':\n                    this.handleScriptMoved(data.script, data.fromType, data.targetType);\n                    break;\n                case 'folder_move':\n                    await this.renderScriptLists();\n                    break;\n                case 'folder_scripts_toggle':\n                    this.updateFolderAndScriptsUI(data.folderId, data.type, data.enable);\n                    break;\n                case 'load_default_scripts':\n                    await this.loadDefaultScriptsRepository();\n                    break;\n                case 'refresh_global_scripts':\n                    await this.refreshScriptList(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL);\n                    break;\n                case 'refresh_charact_scripts':\n                    await this.refreshScriptList(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER);\n                    break;\n                default:\n                    loglevel__WEBPACK_IMPORTED_MODULE_10___default().warn(`[ScriptManager] 未处理的UI刷新事件: ${action}`);\n            }\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.BUTTON_ADD, data => {\n            const { script } = data;\n            this.addButton(script);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.BUTTON_REMOVE, data => {\n            const { scriptId } = data;\n            this.buttonManager.removeButtonsByScriptId(scriptId);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.SCRIPT_EDIT, async (data) => {\n            const { type, scriptId } = data;\n            await this.openScriptEditor(type, scriptId);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.FOLDER_CREATE, async (data) => {\n            const { name, type, icon, color } = data;\n            await this.handleFolderCreate(name, type, icon, color);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.FOLDER_EDIT, async (data) => {\n            const { folderId, newName, type, newIcon, newColor } = data;\n            await this.handleFolderEdit(folderId, newName, type, newIcon, newColor);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.FOLDER_DELETE, async (data) => {\n            const { folderId, type } = data;\n            await this.handleFolderDelete(folderId, type);\n        });\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.on(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.FOLDER_SCRIPTS_TOGGLE, async (data) => {\n            const { folderId, type, enable } = data;\n            await this.handleFolderScriptsToggle(folderId, type, enable);\n        });\n    }\n    /**\n     * 添加按钮\n     * @param script 脚本\n     */\n    addButton(script) {\n        if (script.buttons && script.buttons.length > 0) {\n            this.buttonManager.addButtonsForScript(script);\n        }\n    }\n    /**\n     * 渲染脚本列表\n     */\n    async renderScriptLists() {\n        this.clearScriptList(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL);\n        this.clearScriptList(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER);\n        await this.renderRepository(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL);\n        await this.renderRepository(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER);\n    }\n    /**\n     * 渲染指定类型的脚本仓库\n     * @param type 脚本类型\n     */\n    async renderRepository(type) {\n        const repositoryItems = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL\n            ? this.scriptManager.getGlobalRepositoryItems()\n            : this.scriptManager.getCharacterRepositoryItems();\n        if (repositoryItems.length > 0) {\n            for (const item of repositoryItems) {\n                if (item.type === 'folder') {\n                    await this.renderFolder(item, type);\n                }\n                else {\n                    await this.addScriptToContainer(item.value, type);\n                }\n            }\n        }\n        else {\n            this.showEmptyScriptListTip(type);\n        }\n        this.setupDraggable(type);\n    }\n    /**\n     * 清除指定类型的脚本列表\n     * @param type 脚本类型\n     */\n    clearScriptList(type) {\n        $((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getScriptListSelector)(type)).empty();\n    }\n    /**\n     * 刷新指定类型的脚本列表\n     * @param type 脚本类型\n     */\n    async refreshScriptList(type) {\n        this.clearScriptList(type);\n        await this.renderRepository(type);\n        const isEnabled = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL\n            ? this.scriptManager.isGlobalScriptEnabled\n            : this.scriptManager.isCharacterScriptEnabled;\n        const toggleSelector = (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getScriptToggleSelector)(type);\n        $(toggleSelector).prop('checked', isEnabled);\n    }\n    /**\n     * 显示空脚本列表提示\n     * @param type 脚本类型\n     */\n    showEmptyScriptListTip(type) {\n        const container = $((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getScriptListSelector)(type));\n        if (container.find('small').length === 0) {\n            container.append('<small>暂无脚本</small>');\n        }\n    }\n    /**\n     * 刷新脚本状态\n     * @param script 脚本\n     * @param enable 是否启用\n     */\n    async refreshScriptState(script, enable) {\n        const $script = $(`#${script.id}`);\n        if ($script.length > 0) {\n            if (enable) {\n                $script.find('.script-toggle').addClass('enabled');\n                $script.find('.script-toggle i.fa-toggle-off').hide();\n                $script.find('.script-toggle i.fa-toggle-on').show();\n            }\n            else {\n                $script.find('.script-toggle').removeClass('enabled');\n                $script.find('.script-toggle i.fa-toggle-off').show();\n                $script.find('.script-toggle i.fa-toggle-on').hide();\n            }\n        }\n    }\n    /**\n     * 刷新脚本类型状态\n     * @param type 脚本类型\n     * @param enable 是否启用\n     */\n    async refreshTypeState(type, enable) {\n        const $toggle = $((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getScriptToggleSelector)(type));\n        $toggle.prop('checked', enable);\n    }\n    /**\n     * 更新文件夹及其内部脚本的UI状态\n     * @param folderId 文件夹ID\n     * @param type 脚本类型\n     * @param enable 是否启用\n     */\n    updateFolderAndScriptsUI(folderId, type, enable) {\n        const $folder = $(`#${folderId}`);\n        if ($folder.length > 0) {\n            this.updateFolderToggleState($folder, folderId, type);\n            const $folderContent = $folder.find('.folder-content');\n            $folderContent.find('.script-item').each((_, element) => {\n                const $script = $(element);\n                const $toggle = $script.find('.script-toggle');\n                if (enable) {\n                    $toggle.addClass('enabled');\n                    $toggle.find('i.fa-toggle-off').hide();\n                    $toggle.find('i.fa-toggle-on').show();\n                }\n                else {\n                    $toggle.removeClass('enabled');\n                    $toggle.find('i.fa-toggle-off').show();\n                    $toggle.find('i.fa-toggle-on').hide();\n                }\n            });\n        }\n    }\n    /**\n     * 增量更新脚本UI\n     * @param script 脚本对象\n     * @param type 脚本类型\n     */\n    updateScriptUI(script, type) {\n        const $existingScript = $(`#${CSS.escape(script.id)}`);\n        if ($existingScript.length === 0) {\n            this.addScriptToContainer(script, type);\n            return;\n        }\n        $existingScript.find('.script-item-name').text(script.name);\n        const $toggle = $existingScript.find('.script-toggle');\n        if (script.enabled) {\n            $toggle.addClass('enabled');\n            $toggle.find('i.fa-toggle-off').hide();\n            $toggle.find('i.fa-toggle-on').show();\n        }\n        else {\n            $toggle.removeClass('enabled');\n            $toggle.find('i.fa-toggle-off').show();\n            $toggle.find('i.fa-toggle-on').hide();\n        }\n        const $moveButton = $existingScript.find('.script-storage-location');\n        $moveButton.removeClass('move-to-character move-to-global');\n        $moveButton.addClass(type === 'global' ? 'move-to-character' : 'move-to-global');\n        const $moveIcon = $moveButton.find('i');\n        $moveIcon.removeClass('fa-arrow-down fa-arrow-up');\n        $moveIcon.addClass(type === 'global' ? 'fa-arrow-down' : 'fa-arrow-up');\n        this.rebindScriptEvents($existingScript, script, type);\n    }\n    /**\n     * 重新绑定脚本事件\n     * @param $scriptElement 脚本DOM元素\n     * @param script 脚本对象\n     * @param type 脚本类型\n     */\n    rebindScriptEvents($scriptElement, script, type) {\n        $scriptElement.find('.script-toggle').off('click.scriptToggle');\n        $scriptElement.find('.script-info').off('click.scriptInfo');\n        $scriptElement.find('.edit-script').off('click.scriptEdit');\n        $scriptElement.find('.script-storage-location').off('click.scriptMove');\n        $scriptElement.find('.export-script').off('click.scriptExport');\n        $scriptElement.find('.delete-script').off('click.scriptDelete');\n        const $toggleButton = $scriptElement.find('.script-toggle');\n        $toggleButton.on('click.scriptToggle', function () {\n            const isEnabled = $(this).hasClass('enabled');\n            const newState = !isEnabled;\n            if (newState) {\n                $(this).addClass('enabled');\n                $(this).find('i.fa-toggle-off').hide();\n                $(this).find('i.fa-toggle-on').show();\n            }\n            else {\n                $(this).removeClass('enabled');\n                $(this).find('i.fa-toggle-off').show();\n                $(this).find('i.fa-toggle-on').hide();\n            }\n            script.enabled = newState;\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.SCRIPT_TOGGLE, {\n                script,\n                type,\n                enable: newState,\n                userInput: true,\n            });\n        });\n        $scriptElement.find('.script-info').on('click.scriptInfo', () => {\n            const scriptInfo = script.info || '';\n            const htmlText = (0,_util_render_markdown__WEBPACK_IMPORTED_MODULE_5__.renderMarkdown)(scriptInfo);\n            (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)(htmlText, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.DISPLAY, undefined, { wide: true });\n        });\n        $scriptElement.find('.edit-script').on('click.scriptEdit', e => {\n            e.preventDefault();\n            e.stopPropagation();\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.SCRIPT_EDIT, { type, scriptId: script.id });\n        });\n        $scriptElement.find('.script-storage-location').on('click.scriptMove', () => {\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.SCRIPT_MOVE, { script, fromType: type });\n        });\n        $scriptElement.find('.export-script').on('click.scriptExport', async () => {\n            const fileName = `${script.name.replace(/[\\s.<>:\"/\\\\|?*\\x00-\\x1F\\x7F]/g, '_').toLowerCase()}.json`;\n            const scriptData = await this.checkScriptDataAndGetExportData(script);\n            if (scriptData === null) {\n                return;\n            }\n            const fileData = JSON.stringify(scriptData, null, 2);\n            (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_9__.download)(fileData, fileName, 'application/json');\n        });\n        $scriptElement.find('.delete-script').on('click.scriptDelete', async () => {\n            const confirm = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)('确定要删除这个脚本吗？', _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.CONFIRM);\n            if (!confirm) {\n                return;\n            }\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.SCRIPT_DELETE, { scriptId: script.id, type });\n            $scriptElement.remove();\n        });\n    }\n    /**\n     * 移除脚本元素\n     * @param scriptId 脚本ID\n     */\n    removeScriptElement(scriptId) {\n        $(`#${scriptId}`).remove();\n    }\n    /**\n     * 处理脚本移动\n     * @param script 脚本\n     * @param fromType 源类型\n     * @param targetType 目标类型\n     */\n    handleScriptMoved(script, fromType, targetType) {\n        $(`#${script.id}`).remove();\n        const sourceList = fromType === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? $('#global-script-list') : $('#character-script-list');\n        if (sourceList.children().length === 0) {\n            this.showEmptyScriptListTip(fromType);\n        }\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.UI_REFRESH, {\n            action: 'script_import',\n            script,\n            type: targetType,\n        });\n    }\n    /**\n     * 向容器添加脚本元素\n     * @param script 脚本\n     * @param type 脚本类型\n     */\n    async addScriptToContainer(script, type) {\n        const $scriptElement = await this.createScriptElement(script, type);\n        const list = $((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getScriptListSelector)(type));\n        const $emptyTip = list.find('small');\n        if ($emptyTip.length > 0) {\n            $emptyTip.remove();\n        }\n        list.append($scriptElement);\n    }\n    /**\n     * 设置脚本拖拽排序\n     * @param type 脚本类型\n     */\n    setupDraggable(type) {\n        const list = $((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getScriptListSelector)(type));\n        list.sortable({\n            delay: (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_9__.getSortableDelay)(),\n            items: '.script-item, .script-folder',\n            handle: '.drag-handle',\n            cursor: 'move',\n            tolerance: 'pointer',\n            placeholder: 'sortable-placeholder',\n            connectWith: '.folder-content',\n            stop: async (_event) => {\n                await this.handleDragStop(type);\n            },\n        });\n        this.setupFolderDropZones(type);\n    }\n    /**\n     * 设置文件夹拖拽功能\n     * @param type 脚本类型\n     */\n    setupFolderDraggable(type) {\n        const list = $((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getScriptListSelector)(type));\n        list.find('.folder-content').sortable({\n            delay: (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_9__.getSortableDelay)(),\n            items: '.script-item',\n            handle: '.drag-handle',\n            cursor: 'move',\n            tolerance: 'pointer',\n            placeholder: 'sortable-placeholder',\n            connectWith: `${(0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getScriptListSelector)(type)}, .folder-content`,\n            stop: async (_event) => {\n                await this.handleDragStop(type);\n            },\n        });\n    }\n    /**\n     * 设置文件夹拖拽接收区域\n     * @param type 脚本类型\n     */\n    setupFolderDropZones(type) {\n        const list = $((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getScriptListSelector)(type));\n        list.find('.script-folder').each((_, folderElement) => {\n            this.setupSingleFolderDropZone($(folderElement), type);\n        });\n    }\n    /**\n     * 为单个文件夹设置拖拽接收区域\n     * @param $folder 文件夹jQuery对象\n     * @param type 脚本类型\n     */\n    setupSingleFolderDropZone($folder, type) {\n        const $folderContent = $folder.find('.folder-content');\n        $folder.off('.dragdrop');\n        $folder.on('dragover dragenter dragleave drop', function (e) {\n            e.preventDefault();\n            e.stopPropagation();\n            return false;\n        });\n        $folder.droppable({\n            accept: '.script-item[data-script-repository=\"true\"]',\n            tolerance: 'pointer',\n            greedy: true,\n            over: (_event, ui) => {\n                if (!ui.draggable.hasClass('script-item') || !ui.draggable.attr('data-script-repository'))\n                    return;\n                const isFromSameFolder = ui.draggable.closest('.script-folder').attr('id') === $folder.attr('id');\n                if (isFromSameFolder)\n                    return;\n                $folder.addClass('folder-drag-target');\n                if (!$folderContent.is(':visible')) {\n                    $folderContent.slideDown(200);\n                    $folder.find('.folder-toggle').addClass('expanded');\n                }\n            },\n            out: (_event, ui) => {\n                if (!ui.draggable.hasClass('script-item') || !ui.draggable.attr('data-script-repository'))\n                    return;\n                const isFromSameFolder = ui.draggable.closest('.script-folder').attr('id') === $folder.attr('id');\n                if (isFromSameFolder)\n                    return;\n                $folder.removeClass('folder-drag-target');\n            },\n            drop: async (event, ui) => {\n                if (event.originalEvent) {\n                    event.originalEvent.preventDefault();\n                    event.originalEvent.stopPropagation();\n                }\n                event.preventDefault();\n                event.stopImmediatePropagation();\n                if (!ui.draggable.hasClass('script-item') || !ui.draggable.attr('data-script-repository'))\n                    return;\n                const scriptId = ui.draggable.attr('id');\n                const folderId = $folder.attr('id');\n                const isFromSameFolder = ui.draggable.closest('.script-folder').attr('id') === folderId;\n                if (isFromSameFolder) {\n                    $folder.removeClass('folder-drag-target');\n                    return false;\n                }\n                if (scriptId && folderId) {\n                    try {\n                        const success = await this.handleScriptDropToFolder(scriptId, folderId, type, ui.draggable);\n                        if (!success) {\n                            $folder.removeClass('folder-drag-target');\n                            setTimeout(async () => {\n                                await this.renderScriptLists();\n                            }, 100);\n                            return false;\n                        }\n                    }\n                    catch (error) {\n                        loglevel__WEBPACK_IMPORTED_MODULE_10___default().error('[ScriptManager] 拖拽脚本到文件夹失败:', error);\n                        toastr.error(`移动脚本失败: ${error instanceof Error ? error.message : String(error)}`);\n                        $folder.removeClass('folder-drag-target');\n                        setTimeout(async () => {\n                            await this.renderScriptLists();\n                        }, 100);\n                        return false;\n                    }\n                }\n                $folder.removeClass('folder-drag-target');\n                return false;\n            },\n        });\n    }\n    /**\n     * 处理脚本拖拽到文件夹的事件\n     * @param scriptId 脚本ID\n     * @param folderId 文件夹ID\n     * @param type 脚本类型\n     * @param $draggedElement 拖拽的元素\n     * @returns 是否成功移动脚本\n     */\n    async handleScriptDropToFolder(scriptId, folderId, type, $draggedElement) {\n        try {\n            const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL\n                ? this.scriptManager.getGlobalRepositoryItems()\n                : this.scriptManager.getCharacterRepositoryItems();\n            const folder = repository.find(item => item.type === 'folder' && item.id === folderId);\n            if (folder) {\n                const scripts = folder.value;\n                const scriptExists = scripts.some(script => script.id === scriptId);\n                if (scriptExists) {\n                    toastr.info('脚本已经在该文件夹中');\n                    return false;\n                }\n            }\n            await this.scriptManager.moveScriptToFolder(scriptId, folderId, type);\n            const $targetFolder = $(`#${folderId}`);\n            const $folderContent = $targetFolder.find('.folder-content');\n            if (!$folderContent.is(':visible')) {\n                $folderContent.show();\n                $targetFolder.find('.folder-toggle').addClass('expanded');\n            }\n            $draggedElement.detach().prependTo($folderContent);\n            return true;\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_10___default().error('[ScriptManager] 移动脚本到文件夹失败:', error);\n            throw error;\n        }\n    }\n    /**\n     * 处理拖拽结束事件\n     * @param ui jQuery UI 拖拽事件对象\n     * @param type 脚本类型\n     */\n    async handleDragStop(type) {\n        try {\n            const repositoryItems = await this.buildRepositoryFromDOM(type);\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.ORDER_CHANGED, {\n                data: repositoryItems,\n                type,\n            });\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_10___default().error('[ScriptManager] handleDragStop: 处理拖拽结束失败:', error);\n        }\n    }\n    /**\n     * 从DOM构建仓库结构\n     * @param type 脚本类型\n     */\n    async buildRepositoryFromDOM(type) {\n        const list = $((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getScriptListSelector)(type));\n        const repository = [];\n        for (const element of list.children().get()) {\n            const $element = $(element);\n            if ($element.hasClass('script-folder')) {\n                const folderId = $element.attr('id');\n                const folderName = $element.find('.folder-name').text();\n                const folderIcon = $element\n                    .find('.folder-icon i')\n                    .attr('class')\n                    ?.split(' ')\n                    .find(cls => cls.startsWith('fa-')) || 'fa-folder';\n                const folderColor = $element.find('.folder-icon').css('color') ||\n                    document.documentElement.style.getPropertyValue('--SmartThemeBodyColor');\n                const scripts = [];\n                const $folderContent = $element.find('.folder-content');\n                for (const scriptElement of $folderContent.children('.script-item').get()) {\n                    const scriptId = $(scriptElement).attr('id');\n                    const script = this.scriptManager.getScriptById(scriptId);\n                    if (script) {\n                        scripts.push(script);\n                    }\n                }\n                repository.push({\n                    type: 'folder',\n                    id: folderId,\n                    name: folderName,\n                    icon: folderIcon,\n                    color: folderColor,\n                    value: scripts,\n                });\n            }\n            else if ($element.hasClass('script-item')) {\n                const scriptId = $element.attr('id');\n                const script = this.scriptManager.getScriptById(scriptId);\n                if (script) {\n                    repository.push({\n                        type: 'script',\n                        value: script,\n                    });\n                }\n            }\n        }\n        return repository;\n    }\n    /**\n     * 克隆默认脚本模板\n     * @param script 脚本\n     */\n    async cloneDefaultScriptTemplate(script) {\n        if (!this.defaultScriptTemplate) {\n            await this.initializeTemplates();\n        }\n        const scriptHtml = this.defaultScriptTemplate.clone();\n        const tempId = `default_lib_${script.id}`;\n        scriptHtml.attr('id', tempId);\n        scriptHtml.find('.script-item-name').text(script.name);\n        scriptHtml.find('.script-info').on('click', () => {\n            const htmlText = (0,_util_render_markdown__WEBPACK_IMPORTED_MODULE_5__.renderMarkdown)(script.info);\n            (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)(htmlText, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.DISPLAY, undefined, { wide: true });\n        });\n        scriptHtml.find('.add-script').on('click', async () => {\n            let target = _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL;\n            const template = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_7__.renderExtensionTemplateAsync)(this.templatePath, 'script_target_selector', {\n                title: '添加到:',\n                prefix: 'script-add',\n                globalLabel: '全局脚本库',\n                characterLabel: '角色脚本库',\n            }));\n            template.find('#script-add-target-global').on('input', () => (target = _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL));\n            template.find('#script-add-target-character').on('input', () => (target = _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER));\n            const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)(template, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.CONFIRM, '', {\n                okButton: '确认',\n                cancelButton: '取消',\n            });\n            if (!result) {\n                return;\n            }\n            const newScript = new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.Script({ ...script, enabled: false });\n            let action = 'new';\n            const existing_script = this.scriptManager.getScriptById(script.id);\n            if (existing_script) {\n                const input = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)(`要导入的脚本 '${script.name}' 与脚本库中的 '${existing_script.name}' id 相同，是否要导入？`, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.TEXT, '', {\n                    okButton: '覆盖原脚本',\n                    cancelButton: '取消',\n                    customButtons: ['新建脚本'],\n                });\n                switch (input) {\n                    case 0:\n                        action = 'cancel';\n                        break;\n                    case 1:\n                        action = 'override';\n                        break;\n                    case 2:\n                        action = 'new';\n                        break;\n                }\n            }\n            switch (action) {\n                case 'new':\n                    if (existing_script) {\n                        newScript.id = (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_9__.uuidv4)();\n                    }\n                    break;\n                case 'override':\n                    {\n                        if (!existing_script) {\n                            return;\n                        }\n                        $(`#${existing_script.id}`).remove();\n                        if (existing_script.enabled) {\n                            await this.scriptManager.stopScript(existing_script, target);\n                            this.buttonManager.removeButtonsByScriptId(existing_script.id);\n                        }\n                    }\n                    break;\n                case 'cancel':\n                    return;\n            }\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.SCRIPT_CREATE, { script: newScript, type: target });\n            toastr.success(`脚本\"${newScript.name}\"已添加到${target === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? '全局' : '角色'}脚本库`);\n        });\n        return scriptHtml;\n    }\n    /**\n     * 创建默认脚本库容器\n     * 避免重复渲染模板\n     */\n    createDefaultScriptContainer() {\n        return $('<div class=\"default-script-repository-container\"></div>');\n    }\n    /**\n     * 加载默认脚本库\n     */\n    async loadDefaultScriptsRepository() {\n        const createDefaultScripts = (await __webpack_require__.e(/*! import() */ \"src_component_script_repository_builtin_scripts_ts\").then(__webpack_require__.bind(__webpack_require__, /*! ./builtin_scripts */ \"./src/component/script_repository/builtin_scripts.ts\"))).createDefaultScripts;\n        const container = this.createDefaultScriptContainer();\n        const defaultScripts = await createDefaultScripts();\n        for (const script of defaultScripts) {\n            if (!script)\n                continue;\n            const scriptHtml = await this.cloneDefaultScriptTemplate(script);\n            container.append(scriptHtml);\n        }\n        await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)(container, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.DISPLAY, '', { wide: true });\n    }\n    /**\n     * 打开脚本编辑器\n     * @param type 脚本类型\n     * @param scriptId 脚本ID\n     */\n    async openScriptEditor(type, scriptId) {\n        const $editorHtml = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_7__.renderExtensionTemplateAsync)(this.templatePath, 'script_editor'));\n        let script;\n        this.updateVariableListVisibility($editorHtml);\n        if (scriptId) {\n            script = this.scriptManager.getScriptById(scriptId);\n            if (script) {\n                $editorHtml.find('#script-name-input').val(script.name);\n                $editorHtml.find('#script-content-textarea').val(script.content);\n                $editorHtml.find('#script-info-textarea').val(script.info);\n                if (script.data && Object.keys(script.data).length > 0) {\n                    this.loadVariablesToEditor($editorHtml, script.data);\n                }\n                if (script.buttons && script.buttons.length > 0) {\n                    script.buttons.forEach((button, buttonIndex) => {\n                        const $buttonHtml = $(`\n              <div class=\"button-item\" id=\"button-${buttonIndex}\">\n                <span class=\"drag-handle menu-handle\">☰</span>\n                <input type=\"checkbox\" id=\"checkbox-button-${buttonIndex}\" class=\"button-visible\" ${button.visible ? 'checked' : ''}>\n                <input class=\"text_pole button-name\" type=\"text\" id=\"text-button-${buttonIndex}\" value=\"${button.name}\" placeholder=\"按钮名称\">\n                <div class=\"delete-button menu_button interactable\" data-index=\"${buttonIndex}\">\n                  <i class=\"fa-solid fa-trash\"></i>\n                </div>\n              </div>\n            `);\n                        $editorHtml.find('.button-list').append($buttonHtml);\n                    });\n                }\n            }\n        }\n        $editorHtml.find('#add-variable-trigger').on('click', () => {\n            this.addVariableToEditor($editorHtml);\n        });\n        $editorHtml.find('#add-button-trigger').on('click', () => {\n            const buttonIndex = $editorHtml.find('.button-list .button-item').length;\n            const buttonId = `button-${buttonIndex}`;\n            const $buttonContent = $(`<div class=\"button-item\" id=\"${buttonId}\">\n        <span class=\"drag-handle menu-handle\">☰</span>\n        <input type=\"checkbox\" id=\"checkbox-${buttonId}\" class=\"button-visible\" checked>\n        <input class=\"text_pole button-name\" type=\"text\" id=\"text-${buttonId}\" placeholder=\"按钮名称\">\n        <div class=\"delete-button menu_button interactable\" data-index=\"${buttonIndex}\">\n          <i class=\"fa-solid fa-trash\"></i>\n        </div>\n      </div>`);\n            $editorHtml.find('.button-list').append($buttonContent);\n        });\n        $editorHtml.find('#script-button-content .button-list').sortable({\n            handle: '.drag-handle',\n            items: '.button-item',\n        });\n        $editorHtml.on('click', '.delete-button', (e) => {\n            $(e.currentTarget).closest('.button-item').remove();\n        });\n        $editorHtml.on('click', '.delete-variable', (e) => {\n            $(e.currentTarget).closest('.variable-item').remove();\n            this.updateVariableListVisibility($editorHtml);\n        });\n        const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)($editorHtml, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.CONFIRM, '', {\n            wide: true,\n            okButton: '保存',\n            cancelButton: '取消',\n        });\n        if (!result) {\n            return;\n        }\n        const scriptName = String($editorHtml.find('#script-name-input').val());\n        const scriptContent = String($editorHtml.find('#script-content-textarea').val());\n        const scriptInfo = String($editorHtml.find('#script-info-textarea').val());\n        const variableData = this.collectVariablesFromEditor($editorHtml);\n        const buttons = [];\n        $editorHtml.find('.button-list .button-item').each(function () {\n            const buttonName = $(this).find('.button-name').val();\n            const visible = $(this).find('.button-visible').prop('checked');\n            if (buttonName && buttonName.trim() !== '') {\n                buttons.push({ name: buttonName, visible });\n            }\n        });\n        if (!script) {\n            script = new _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.Script({\n                id: (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_9__.uuidv4)(),\n                name: scriptName,\n                content: scriptContent,\n                info: scriptInfo,\n                enabled: false,\n                buttons,\n                data: variableData,\n            });\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.SCRIPT_CREATE, { script, type });\n        }\n        else {\n            const wasEnabled = script.enabled;\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.BUTTON_REMOVE, { scriptId: script.id });\n            script.name = scriptName;\n            script.content = scriptContent;\n            script.info = scriptInfo;\n            script.buttons = buttons;\n            script.data = variableData;\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.SCRIPT_UPDATE, { script, type });\n            if (wasEnabled) {\n                try {\n                    await this.scriptManager.stopScript(script, type);\n                    await this.scriptManager.runScript(script, type);\n                }\n                catch (error) {\n                    loglevel__WEBPACK_IMPORTED_MODULE_10___default().error(`[ScriptManager] 重启脚本失败: ${script.name}`, error);\n                    toastr.error(`重启脚本失败: ${script.name}`);\n                }\n            }\n        }\n    }\n    /**\n     * 将变量数据加载到编辑器中\n     * @param $editorHtml 编辑器HTML元素\n     * @param data 变量数据\n     */\n    loadVariablesToEditor($editorHtml, data) {\n        const $variableList = $editorHtml.find('#variable-list');\n        for (const [key, value] of Object.entries(data)) {\n            const $variableItem = this.createVariableItem(key, value);\n            $variableList.append($variableItem);\n        }\n        this.updateVariableListVisibility($editorHtml);\n    }\n    /**\n     * 添加新变量到编辑器\n     * @param $editorHtml 编辑器HTML元素\n     */\n    addVariableToEditor($editorHtml) {\n        const $variableList = $editorHtml.find('#variable-list');\n        const $variableItem = this.createVariableItem('', '');\n        $variableList.append($variableItem);\n        this.updateVariableListVisibility($editorHtml);\n    }\n    /**\n     * 更新变量列表的可见性\n     * @param $editorHtml 编辑器HTML元素\n     */\n    updateVariableListVisibility($editorHtml) {\n        const $variableList = $editorHtml.find('#variable-list');\n        const variableCount = $variableList.find('.variable-item').length;\n        if (variableCount === 0) {\n            $variableList.hide();\n        }\n        else {\n            $variableList.show();\n        }\n    }\n    /**\n     * 创建变量项元素\n     * @param key 变量键\n     * @param value 变量值\n     * @returns JQuery元素\n     */\n    createVariableItem(key, value) {\n        const valueStr = typeof value === 'string' ? value : JSON.stringify(value);\n        const $variableItem = $(`\n      <div class=\"variable-item flex-container flexFlowColumn width100p\">\n        <div class=\"flex flexFlowColumn\">\n        <div class=\"flex-container alignitemscenter spaceBetween wide100p\">\n          <div>名称:</div>\n          <div class=\"menu_button interactable delete-variable\" title=\"删除变量\">\n            <i class=\"fa-solid fa-trash\"></i>\n          </div>\n          </div>\n          <input type=\"text\" class=\"text_pole variable-key\" value=\"${this.escapeHtml(key)}\" placeholder=\"变量名\">\n        </div>\n        <div class=\"flex flexFlowColumn\" style=\"align-items: flex-start;\">\n          <div>值:</div>\n          <textarea class=\"text_pole variable-value\" style=\"min-height: 12px;\" rows=\"1\" placeholder=\"变量值\">${this.escapeHtml(valueStr)}</textarea>\n        </div>\n      <hr>\n      </div>\n    `);\n        return $variableItem;\n    }\n    /**\n     * 从编辑器收集变量数据\n     * @param $editorHtml 编辑器HTML元素\n     * @returns 变量数据对象\n     */\n    collectVariablesFromEditor($editorHtml) {\n        const variables = {};\n        $editorHtml.find('#variable-list .variable-item').each(function () {\n            const key = $(this).find('.variable-key').val();\n            const valueStr = $(this).find('.variable-value').val();\n            if (key && key.trim() !== '') {\n                let value;\n                try {\n                    value = JSON.parse(valueStr);\n                }\n                catch {\n                    value = valueStr;\n                }\n                variables[key.trim()] = value;\n            }\n        });\n        return variables;\n    }\n    /**\n     * HTML转义辅助函数\n     * @param text 要转义的文本\n     * @returns 转义后的文本\n     */\n    escapeHtml(text) {\n        const div = document.createElement('div');\n        div.textContent = text;\n        return div.innerHTML;\n    }\n    /**\n     * 检查角色中的嵌入式脚本\n     * @param characterId 角色id\n     * @param enableableScripts 可启用的脚本列表\n     */\n    async checkEmbeddedScripts(characterId) {\n        const charactersWithScripts = (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_4__.getSettingValue)('script.characters_with_scripts') || [];\n        const avatar = _sillytavern_script__WEBPACK_IMPORTED_MODULE_6__.characters[characterId]?.avatar;\n        if (charactersWithScripts.includes(avatar)) {\n            return;\n        }\n        const checkKey = `AlertScript_${avatar}`;\n        if (!localStorage.getItem(checkKey)) {\n            localStorage.setItem(checkKey, 'true');\n            const template = await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_7__.renderExtensionTemplateAsync)(`${_util_extension_variables__WEBPACK_IMPORTED_MODULE_4__.extensionFolderPath}/src/component/script_repository/public`, 'script_allow_popup');\n            const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)(template, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.CONFIRM, '', {\n                okButton: '确认',\n                cancelButton: '取消',\n            });\n            if (result) {\n                if (avatar && !charactersWithScripts.includes(avatar)) {\n                    charactersWithScripts.push(avatar);\n                    (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_4__.saveSettingValue)('script.characters_with_scripts', charactersWithScripts);\n                }\n                $('#character-script-enable-toggle').prop('checked', true);\n                _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.TYPE_TOGGLE, {\n                    type: _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER,\n                    enable: true,\n                    userInput: false,\n                });\n            }\n            else {\n                $('#character-script-enable-toggle').prop('checked', false);\n                _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.TYPE_TOGGLE, {\n                    type: _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER,\n                    enable: false,\n                    userInput: false,\n                });\n            }\n        }\n    }\n    /**\n     * 渲染单个文件夹\n     * @param folderItem 文件夹项\n     * @param type 脚本类型\n     */\n    async renderFolder(folderItem, type) {\n        const container = $((0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getScriptListSelector)(type));\n        if (!this.folderTemplate) {\n            await this.initializeTemplates();\n        }\n        const folderId = folderItem.id;\n        const folderName = folderItem.name;\n        const folderIcon = folderItem.icon || 'fa-folder';\n        const folderColor = folderItem.color || document.documentElement.style.getPropertyValue('--SmartThemeBodyColor');\n        const moveIcon = type === 'global' ? 'fa-arrow-down' : 'fa-arrow-up';\n        const moveClass = type === 'global' ? 'move-to-character' : 'move-to-global';\n        const moveTitle = type === 'global' ? '移动到角色脚本库' : '移动到全局脚本库';\n        const folderHtml = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_7__.renderExtensionTemplateAsync)(this.templatePath, 'folder_template', {\n            folderId,\n            folderName,\n            folderIcon,\n            folderColor,\n            moveIcon,\n            moveClass,\n            moveTitle,\n        }));\n        this.bindFolderEvents(folderHtml, folderId, folderColor, type);\n        const scripts = folderItem.value;\n        const folderContent = folderHtml.find('.folder-content');\n        for (const script of scripts) {\n            const scriptElement = await this.createScriptElement(script, type);\n            folderContent.append(scriptElement);\n        }\n        container.append(folderHtml);\n        this.setupFolderDraggable(type);\n        this.setupSingleFolderDropZone(folderHtml, type);\n    }\n    /**\n     * 绑定文件夹相关事件和设置图标颜色\n     * @param folderHtml 文件夹HTML元素\n     * @param folderId 文件夹ID\n     * @param folderColor 文件夹颜色\n     * @param type 脚本类型\n     */\n    bindFolderEvents(folderHtml, folderId, folderColor, type) {\n        folderHtml.find('.folder-header').on('click', e => {\n            if ($(e.target).closest('.folder-control').length > 0)\n                return;\n            if ($(e.target).closest('.folder-checkbox').length > 0 || $(e.target).hasClass('folder-checkbox'))\n                return;\n            const content = folderHtml.find('.folder-content');\n            const toggle = folderHtml.find('.folder-toggle');\n            if (content.is(':visible')) {\n                content.slideUp();\n                toggle.removeClass('expanded');\n            }\n            else {\n                content.slideDown();\n                toggle.addClass('expanded');\n            }\n        });\n        const $folderToggle = folderHtml.find('.folder-script-toggle');\n        $folderToggle.on('click', e => {\n            e.stopPropagation();\n            const isEnabled = $folderToggle.hasClass('enabled');\n            const newState = !isEnabled;\n            if (newState) {\n                $folderToggle.addClass('enabled');\n                $folderToggle.find('i.fa-toggle-off').hide();\n                $folderToggle.find('i.fa-toggle-on').show();\n            }\n            else {\n                $folderToggle.removeClass('enabled');\n                $folderToggle.find('i.fa-toggle-off').show();\n                $folderToggle.find('i.fa-toggle-on').hide();\n            }\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.FOLDER_SCRIPTS_TOGGLE, {\n                folderId,\n                type,\n                enable: newState,\n            });\n        });\n        folderHtml.find('.folder-edit').on('click', e => {\n            e.stopPropagation();\n            this.showEditFolderDialog(folderId, type);\n        });\n        folderHtml.find('.folder-export').on('click', e => {\n            e.stopPropagation();\n            this.exportFolder(folderId, type);\n        });\n        folderHtml.find('.folder-move').on('click', e => {\n            e.stopPropagation();\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.FOLDER_MOVE, {\n                folderId,\n                fromType: type,\n            });\n        });\n        folderHtml.find('.folder-delete').on('click', e => {\n            e.stopPropagation();\n            this.showDeleteFolderDialog(folderId, type);\n        });\n        folderHtml.find('.folder-icon').css('color', folderColor);\n        this.updateFolderToggleState(folderHtml, folderId, type);\n    }\n    /**\n     * 更新文件夹开关的UI状态\n     * @param folderHtml 文件夹HTML元素\n     * @param folderId 文件夹ID\n     * @param type 脚本类型\n     */\n    updateFolderToggleState(folderHtml, folderId, type) {\n        const state = this.scriptManager.getFolderScriptsState(folderId, type);\n        const $folderToggle = folderHtml.find('.folder-script-toggle');\n        $folderToggle.removeClass('enabled');\n        if (state === 'all') {\n            $folderToggle.addClass('enabled');\n            $folderToggle.find('i.fa-toggle-off').hide();\n            $folderToggle.find('i.fa-toggle-on').show();\n        }\n        else {\n            $folderToggle.find('i.fa-toggle-off').show();\n            $folderToggle.find('i.fa-toggle-on').hide();\n        }\n    }\n    /**\n     * 更新包含指定脚本的文件夹开关状态\n     * @param scriptId 脚本ID\n     * @param type 脚本类型\n     */\n    updateParentFolderToggle(scriptId, type) {\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL\n            ? this.scriptManager.getGlobalRepositoryItems()\n            : this.scriptManager.getCharacterRepositoryItems();\n        for (const item of repository) {\n            if (item.type === 'folder') {\n                const scripts = item.value;\n                const hasScript = scripts.some(script => script.id === scriptId);\n                if (hasScript) {\n                    const $folder = $(`#${item.id}`);\n                    if ($folder.length > 0) {\n                        this.updateFolderToggleState($folder, item.id, type);\n                    }\n                    break;\n                }\n            }\n        }\n    }\n    /**\n     * 创建脚本元素\n     * @param script 脚本\n     * @param type 脚本类型\n     */\n    async createScriptElement(script, type) {\n        if (!this.baseTemplate) {\n            await this.initializeTemplates();\n        }\n        const scriptHtml = this.baseTemplate.clone();\n        scriptHtml.attr('id', script.id);\n        scriptHtml.attr('data-script-repository', 'true');\n        scriptHtml.find('.script-item-name').text(script.name);\n        scriptHtml.find('.script-storage-location').addClass(type === 'global' ? 'move-to-character' : 'move-to-global');\n        scriptHtml.find('.script-storage-location i').addClass(type === 'global' ? 'fa-arrow-down' : 'fa-arrow-up');\n        const $toggleButton = scriptHtml.find('.script-toggle');\n        if (script.enabled) {\n            $toggleButton.addClass('enabled');\n            $toggleButton.find('i.fa-toggle-off').hide();\n            $toggleButton.find('i.fa-toggle-on').show();\n        }\n        else {\n            $toggleButton.removeClass('enabled');\n            $toggleButton.find('i.fa-toggle-off').show();\n            $toggleButton.find('i.fa-toggle-on').hide();\n        }\n        this.bindScriptEvents(scriptHtml, script, type);\n        return scriptHtml;\n    }\n    /**\n     * 检查脚本data并询问用户如何处理\n     * @param script 脚本对象\n     * @returns 处理后的脚本数据（不包含enabled字段），如果用户取消则返回null\n     */\n    async checkScriptDataAndGetExportData(script) {\n        const { enabled, ...scriptData } = script;\n        const hasData = script.data && Object.keys(script.data).length > 0;\n        if (hasData) {\n            try {\n                const choice = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)(`脚本 \"${script.name}\" 包含数据，导出时如何处理？如有API-KEY等敏感数据，注意清除`, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.TEXT, '', {\n                    okButton: '直接导出（包含数据）',\n                    cancelButton: '取消',\n                    customButtons: ['清除数据后导出'],\n                });\n                switch (choice) {\n                    case 0:\n                        return null;\n                    case 1:\n                        return scriptData;\n                    case 2:\n                        return { ...scriptData, data: {} };\n                    default:\n                        return null;\n                }\n            }\n            catch (error) {\n                loglevel__WEBPACK_IMPORTED_MODULE_10___default().error('[ScriptManager] 导出脚本数据选择对话框出错:', error);\n                return scriptData;\n            }\n        }\n        return scriptData;\n    }\n    /**\n     * 绑定脚本相关事件\n     * @param scriptHtml 脚本HTML元素\n     * @param script 脚本对象\n     * @param type 脚本类型\n     */\n    bindScriptEvents(scriptHtml, script, type) {\n        const $toggleButton = scriptHtml.find('.script-toggle');\n        $toggleButton.on('click.scriptToggle', function () {\n            const isEnabled = $(this).hasClass('enabled');\n            const newState = !isEnabled;\n            if (newState) {\n                $(this).addClass('enabled');\n                $(this).find('i.fa-toggle-off').hide();\n                $(this).find('i.fa-toggle-on').show();\n            }\n            else {\n                $(this).removeClass('enabled');\n                $(this).find('i.fa-toggle-off').show();\n                $(this).find('i.fa-toggle-on').hide();\n            }\n            script.enabled = newState;\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.SCRIPT_TOGGLE, {\n                script,\n                type,\n                enable: newState,\n                userInput: true,\n            });\n        });\n        scriptHtml.find('.script-info').on('click.scriptInfo', () => {\n            const scriptInfo = script.info || '';\n            const htmlText = (0,_util_render_markdown__WEBPACK_IMPORTED_MODULE_5__.renderMarkdown)(scriptInfo);\n            (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)(htmlText, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.DISPLAY, undefined, { wide: true });\n        });\n        scriptHtml.find('.edit-script').on('click.scriptEdit', e => {\n            e.preventDefault();\n            e.stopPropagation();\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.SCRIPT_EDIT, { type, scriptId: script.id });\n        });\n        scriptHtml.find('.script-storage-location').on('click.scriptMove', () => {\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.SCRIPT_MOVE, { script, fromType: type });\n        });\n        scriptHtml.find('.export-script').on('click.scriptExport', async () => {\n            const fileName = `${script.name.replace(/[\\s.<>:\"/\\\\|?*\\x00-\\x1F\\x7F]/g, '_').toLowerCase()}.json`;\n            const scriptData = await this.checkScriptDataAndGetExportData(script);\n            if (scriptData === null) {\n                return;\n            }\n            const fileData = JSON.stringify(scriptData, null, 2);\n            (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_9__.download)(fileData, fileName, 'application/json');\n        });\n        scriptHtml.find('.delete-script').on('click.scriptDelete', async () => {\n            const confirm = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)('确定要删除这个脚本吗？', _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.CONFIRM);\n            if (!confirm) {\n                return;\n            }\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.SCRIPT_DELETE, { scriptId: script.id, type });\n            scriptHtml.remove();\n        });\n    }\n    /**\n     * 显示新建脚本对话框\n     */\n    async showCreateScriptDialog() {\n        let target = _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL;\n        const template = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_7__.renderExtensionTemplateAsync)(this.templatePath, 'script_target_selector', {\n            title: '新建脚本到:',\n            prefix: 'script-create',\n            globalLabel: '全局脚本库',\n            characterLabel: '角色脚本库',\n        }));\n        template.find('#script-create-target-global').on('input', () => (target = _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL));\n        template.find('#script-create-target-character').on('input', () => (target = _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER));\n        const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)(template, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.CONFIRM, '', {\n            okButton: '确认',\n            cancelButton: '取消',\n        });\n        if (result) {\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.SCRIPT_EDIT, {\n                type: target,\n            });\n        }\n    }\n    /**\n     * 显示创建文件夹对话框\n     */\n    async showCreateFolderDialog() {\n        const defaultColor = document.documentElement.style.getPropertyValue('--SmartThemeBodyColor');\n        const template = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_7__.renderExtensionTemplateAsync)(this.templatePath, 'folder_create', { defaultColor }, false));\n        let folderColor;\n        template.find('#folder-icon-preview').on('click', async () => {\n            try {\n                const selectedIcon = await (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_9__.showFontAwesomePicker)();\n                if (selectedIcon && selectedIcon.trim() !== '') {\n                    template.find('#folder-icon-preview').removeClass().addClass(`fa ${selectedIcon}`);\n                    template.find('#folder-icon-value').val(selectedIcon);\n                }\n            }\n            catch (error) {\n                loglevel__WEBPACK_IMPORTED_MODULE_10___default().error('[ScriptManager] 图标选择失败:', error);\n            }\n        });\n        template.find('#folder-color-picker').on('change', evt => {\n            // @ts-ignore\n            folderColor = evt.detail?.rgba;\n        });\n        const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)(template, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.CONFIRM, '', {\n            okButton: '创建',\n            cancelButton: '取消',\n        });\n        if (!result) {\n            return;\n        }\n        const folderName = template.find('#folder-name-input').val();\n        const folderIcon = template.find('#folder-icon-value').val();\n        const selectedType = template.find('#folder-target-global').prop('checked')\n            ? _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL\n            : _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER;\n        if (!folderName || folderName.trim() === '') {\n            toastr.error('请输入文件夹名称');\n            return;\n        }\n        try {\n            const existingFolders = selectedType === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL\n                ? this.scriptManager.getGlobalRepositoryItems()\n                : this.scriptManager.getCharacterRepositoryItems();\n            const folderExists = existingFolders.some(item => item.type === 'folder' && item.name === folderName.trim());\n            if (folderExists) {\n                toastr.error(`${selectedType === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? '全局' : '角色'}脚本库中已存在名为 \"${folderName.trim()}\" 的文件夹`);\n                return;\n            }\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.FOLDER_CREATE, {\n                name: folderName.trim(),\n                type: selectedType,\n                icon: folderIcon,\n                color: folderColor,\n            });\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_10___default().error('[ScriptManager] 创建文件夹失败:', error);\n            toastr.error(`创建文件夹失败: ${error instanceof Error ? error.message : String(error)}`);\n        }\n    }\n    /**\n     * 显示编辑文件夹对话框\n     * @param folderId 文件夹ID\n     * @param type 脚本类型\n     */\n    async showEditFolderDialog(folderId, type) {\n        const currentName = $(`#${folderId} .folder-name`).text();\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL\n            ? this.scriptManager.getGlobalRepositoryItems()\n            : this.scriptManager.getCharacterRepositoryItems();\n        const folder = repository.find(item => item.type === 'folder' && item.id === folderId);\n        const currentIcon = folder?.icon || 'fa-folder';\n        const currentColorRgba = folder?.color || document.documentElement.style.getPropertyValue('--SmartThemeBodyColor');\n        let newColor;\n        const template = $(`\n      <div class=\"folder-edit-dialog\">\n      <h3>编辑文件夹</h3>\n      <div class=\"flex-container flexFlowColumn wide100p padding10 justifyLeft\">\n        <div>\n          <h4>文件夹名称:</h4>\n          <input type=\"text\" id=\"folder-name-input\" class=\"text_pole\" value=\"${currentName}\" />\n        </div>\n        <div>\n          <h4>文件夹图标:</h4>\n          <div class=\"flex\" style=\"gap: 20px; margin: 5px 0; width: 100%;\">\n            <div class=\"flex alignItemsCenter\">\n            <label>选择颜色</label>\n            <toolcool-color-picker id=\"folder-color-picker\" color=\"${currentColorRgba}\"></toolcool-color-picker>\n            </div>\n            <div class=\"flex-container alignItemsCenter\">\n             <label>选择图标</label>\n              <i id=\"folder-icon-preview\" class=\"fa ${currentIcon} marginRight10\" style=\"cursor: pointer; font-size: 12px; padding: 4px; border: 1px solid #ccc; border-radius: 4px;\" title=\"点击选择图标\"></i>\n              <input type=\"hidden\" id=\"folder-icon-value\" value=\"${currentIcon}\" />\n            </div>\n          </div>\n        </div>\n      </div>\n    `);\n        template.find('#folder-icon-preview').on('click', async () => {\n            try {\n                const selectedIcon = await (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_9__.showFontAwesomePicker)();\n                if (selectedIcon && selectedIcon.trim() !== '') {\n                    template.find('#folder-icon-preview').removeClass().addClass(`fa ${selectedIcon}`);\n                    template.find('#folder-icon-value').val(selectedIcon);\n                }\n            }\n            catch (error) {\n                loglevel__WEBPACK_IMPORTED_MODULE_10___default().error('[ScriptManager] 图标选择失败:', error);\n            }\n        });\n        template.find('#folder-color-picker').on('change', evt => {\n            // @ts-ignore\n            newColor = evt.detail?.rgba;\n        });\n        const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)(template, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.CONFIRM, '', {\n            okButton: '保存',\n            cancelButton: '取消',\n        });\n        if (!result) {\n            return;\n        }\n        const newName = template.find('#folder-name-input').val();\n        const newIcon = template.find('#folder-icon-value').val();\n        _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.FOLDER_EDIT, {\n            folderId,\n            newName: newName?.trim() || currentName,\n            type,\n            newIcon: newIcon,\n            newColor: newColor,\n        });\n    }\n    /**\n     * 导出文件夹为压缩包\n     * @param folderId 文件夹ID\n     * @param type 脚本类型\n     */\n    async exportFolder(folderId, type) {\n        try {\n            const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL\n                ? this.scriptManager.getGlobalRepositoryItems()\n                : this.scriptManager.getCharacterRepositoryItems();\n            const folder = repository.find(item => item.type === 'folder' && item.id === folderId);\n            if (!folder) {\n                toastr.error('未找到指定的文件夹');\n                return;\n            }\n            //@ts-ignore\n            if (!window.JSZip) {\n                await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @sillytavern/lib/jszip.min.js */ \"@sillytavern/lib/jszip.min.js\"));\n            }\n            //@ts-ignore\n            const zip = new JSZip();\n            const folderName = folder.name || 'folder';\n            const sanitizedFolderName = folderName.replace(/[<>:\"/\\\\|?*]/g, '_');\n            if (Array.isArray(folder.value)) {\n                let cancelExport = false;\n                for (const script of folder.value) {\n                    const scriptData = await this.checkScriptDataAndGetExportData(script);\n                    if (scriptData === null) {\n                        cancelExport = true;\n                        break;\n                    }\n                    const scriptFileName = `${script.name.replace(/[<>:\"/\\\\|?*]/g, '_')}.json`;\n                    zip.file(`${sanitizedFolderName}/${scriptFileName}`, JSON.stringify(scriptData, null, 2));\n                }\n                if (cancelExport) {\n                    return;\n                }\n            }\n            const zipBlob = await zip.generateAsync({ type: 'blob' });\n            const timestamp = new Date().toISOString().slice(0, 19).replace(/:/g, '-');\n            const typeName = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? 'global' : 'character';\n            const filename = `folder_${sanitizedFolderName}_${typeName}_${timestamp}.zip`;\n            const url = URL.createObjectURL(zipBlob);\n            const a = document.createElement('a');\n            a.href = url;\n            a.download = filename;\n            document.body.appendChild(a);\n            a.click();\n            document.body.removeChild(a);\n            URL.revokeObjectURL(url);\n            toastr.success(`文件夹 \"${folder.name}\" 导出成功`);\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_10___default().error('[ScriptManager] 导出文件夹失败:', error);\n            toastr.error(`导出文件夹失败: ${error instanceof Error ? error.message : String(error)}`);\n        }\n    }\n    /**\n     * 显示删除文件夹确认对话框\n     * @param folderId 文件夹ID\n     * @param type 脚本类型\n     */\n    async showDeleteFolderDialog(folderId, type) {\n        const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL\n            ? this.scriptManager.getGlobalRepositoryItems()\n            : this.scriptManager.getCharacterRepositoryItems();\n        const folder = repository.find(item => item.type === 'folder' && item.id === folderId);\n        const folderName = folder?.name || '未知文件夹';\n        const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)(`确定要删除文件夹 \"${folderName}\" 及其中的所有脚本吗？此操作不可撤销。`, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.CONFIRM, '', { okButton: '删除', cancelButton: '取消' });\n        if (result) {\n            _component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.scriptEvents.emit(_component_script_repository_events__WEBPACK_IMPORTED_MODULE_1__.ScriptRepositoryEventType.FOLDER_DELETE, {\n                folderId,\n                type,\n            });\n        }\n    }\n    /**\n     * 设置搜索功能事件\n     */\n    setupSearchEvents() {\n        const searchInput = $('#script-search-input');\n        searchInput.on('input', event => {\n            const query = event.target.value.trim();\n            if (query) {\n                this.performSearch(query);\n            }\n            else {\n                this.clearSearch();\n            }\n        });\n        searchInput.on('keypress', event => {\n            if (event.which === 13) {\n                const query = searchInput.val();\n                if (query && query.trim()) {\n                    this.performSearch(query.trim());\n                }\n            }\n        });\n    }\n    /**\n     * 执行搜索\n     * @param query 搜索关键词\n     */\n    performSearch(query) {\n        if (!query) {\n            this.clearSearch();\n            return;\n        }\n        const globalScripts = this.scriptManager.getGlobalScripts();\n        const characterScripts = this.scriptManager.getCharacterScripts();\n        const globalMatches = this.searchScripts(globalScripts, query);\n        const characterMatches = this.searchScripts(characterScripts, query);\n        this.displaySearchResults(globalMatches, characterMatches);\n    }\n    /**\n     * 在脚本数组中搜索匹配的脚本\n     * @param scripts 脚本数组\n     * @param query 搜索关键词\n     * @returns 匹配的脚本数组\n     */\n    searchScripts(scripts, query) {\n        const lowerQuery = query.toLowerCase();\n        return scripts.filter(script => script.name.toLowerCase().includes(lowerQuery));\n    }\n    /**\n     * 显示搜索结果\n     * @param globalMatches 全局脚本匹配结果\n     * @param characterMatches 角色脚本匹配结果\n     */\n    async displaySearchResults(globalMatches, characterMatches) {\n        this.clearScriptList(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL);\n        this.clearScriptList(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER);\n        const globalContainer = $('#global-script-list');\n        if (globalMatches.length > 0) {\n            for (const script of globalMatches) {\n                await this.addScriptToContainer(script, _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL);\n            }\n        }\n        else {\n            globalContainer.append('<small>无匹配的全局脚本</small>');\n        }\n        const characterContainer = $('#character-script-list');\n        if (characterMatches.length > 0) {\n            for (const script of characterMatches) {\n                await this.addScriptToContainer(script, _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER);\n            }\n        }\n        else {\n            characterContainer.append('<small>无匹配的角色脚本</small>');\n        }\n    }\n    /**\n     * 清除搜索结果，恢复正常显示\n     */\n    clearSearch() {\n        this.renderScriptLists();\n    }\n    /**\n     * 设置批量操作事件\n     */\n    setupBatchOperationEvents() {\n        $('#global-batch-manager').on('click', () => {\n            this.toggleBatchMode(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL);\n        });\n        $('#character-batch-manager').on('click', () => {\n            this.toggleBatchMode(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER);\n        });\n        $('#global-batch-delete').on('click', () => {\n            this.performBatchDelete(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL);\n        });\n        $('#global-batch-export').on('click', () => {\n            this.performBatchExport(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL);\n        });\n        $('#global-batch-move').on('click', () => {\n            this.performBatchMove(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL);\n        });\n        $('#global-batch-cancel').on('click', () => {\n            this.exitBatchMode(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL);\n        });\n        $('#character-batch-delete').on('click', () => {\n            this.performBatchDelete(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER);\n        });\n        $('#character-batch-export').on('click', () => {\n            this.performBatchExport(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER);\n        });\n        $('#character-batch-move').on('click', () => {\n            this.performBatchMove(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER);\n        });\n        $('#character-batch-cancel').on('click', () => {\n            this.exitBatchMode(_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.CHARACTER);\n        });\n    }\n    /**\n     * 切换批量模式\n     * @param type 脚本类型\n     */\n    toggleBatchMode(type) {\n        const isBatchMode = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? this.batchModeGlobal : this.batchModeCharacter;\n        if (isBatchMode) {\n            this.exitBatchMode(type);\n        }\n        else {\n            this.enterBatchMode(type);\n        }\n    }\n    /**\n     * 进入批量模式\n     * @param type 脚本类型\n     */\n    enterBatchMode(type) {\n        const listSelector = (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getScriptListSelector)(type);\n        const controlsSelector = (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getBatchControlsSelector)(type);\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL) {\n            this.batchModeGlobal = true;\n        }\n        else {\n            this.batchModeCharacter = true;\n        }\n        $(controlsSelector).show();\n        const $list = $(listSelector);\n        $list.find('.script-item').each((_, element) => {\n            const $element = $(element);\n            $element.addClass('batch-mode');\n            $element.find('.script-checkbox').show();\n            $element.find('.drag-handle').hide();\n            $element.find('.script-item-control').hide();\n            $element\n                .find('.script-checkbox')\n                .off('change.batch')\n                .on('change.batch', () => {\n                this.handleCheckboxChange($element);\n            });\n        });\n        $list.find('.script-folder').each((_, element) => {\n            const $element = $(element);\n            $element.addClass('batch-mode');\n            $element.find('.folder-checkbox').show();\n            $element.find('.drag-handle').hide();\n            $element.find('.folder-control .folder-script-toggle').hide();\n            $element.find('.folder-control .folder-edit').hide();\n            $element.find('.folder-control .folder-export').hide();\n            $element.find('.folder-control .folder-move').hide();\n            $element.find('.folder-control .folder-delete').hide();\n            $element\n                .find('.folder-checkbox')\n                .off('change.batch')\n                .on('change.batch', () => {\n                this.handleCheckboxChange($element);\n            });\n        });\n    }\n    /**\n     * 退出批量模式\n     * @param type 脚本类型\n     */\n    exitBatchMode(type) {\n        const listSelector = (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getScriptListSelector)(type);\n        const controlsSelector = (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getBatchControlsSelector)(type);\n        if (type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL) {\n            this.batchModeGlobal = false;\n        }\n        else {\n            this.batchModeCharacter = false;\n        }\n        $(controlsSelector).hide();\n        const $list = $(listSelector);\n        $list.find('.script-item, .script-folder').each((_, element) => {\n            const $element = $(element);\n            $element.removeClass('batch-mode selected');\n            $element.find('.script-checkbox, .folder-checkbox').hide().prop('checked', false);\n            $element.find('.script-item-control').show();\n            $element.find('.drag-handle').show();\n            $element.find('.script-controls').show();\n            $element.find('.folder-control .folder-script-toggle').show();\n            $element.find('.folder-control .folder-edit').show();\n            $element.find('.folder-control .folder-export').show();\n            $element.find('.folder-control .folder-move').show();\n            $element.find('.folder-control .folder-delete').show();\n            $element.find('.script-checkbox, .folder-checkbox').off('change.batch');\n        });\n    }\n    /**\n     * 复选框状态变化时添加选中状态css\n     * @param $element 元素jQuery对象\n     */\n    handleCheckboxChange($element) {\n        const isChecked = $element.find('.script-checkbox, .folder-checkbox').prop('checked');\n        if (isChecked) {\n            $element.addClass('selected');\n        }\n        else {\n            $element.removeClass('selected');\n        }\n    }\n    /**\n     * 获取选中的项目\n     * @param type 脚本类型\n     * @returns 选中的脚本ID和文件夹ID数组\n     */\n    getSelectedItems(type) {\n        const listSelector = (0,_component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.getScriptListSelector)(type);\n        const scriptIds = [];\n        const folderIds = [];\n        $(listSelector)\n            .find('.script-item.selected')\n            .each((_, element) => {\n            const id = $(element).attr('id');\n            if (id)\n                scriptIds.push(id);\n        });\n        $(listSelector)\n            .find('.script-folder.selected')\n            .each((_, element) => {\n            const id = $(element).attr('id');\n            if (id)\n                folderIds.push(id);\n        });\n        return { scriptIds, folderIds };\n    }\n    /**\n     * 执行批量删除\n     * @param type 脚本类型\n     */\n    async performBatchDelete(type) {\n        const { scriptIds, folderIds } = this.getSelectedItems(type);\n        if (scriptIds.length === 0 && folderIds.length === 0) {\n            toastr.warning('请至少选择一个项目进行删除');\n            return;\n        }\n        const totalCount = scriptIds.length + folderIds.length;\n        const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)(`确定要删除选中的 ${totalCount} 个项目吗？此操作不可撤销。`, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.CONFIRM, '', { okButton: '删除', cancelButton: '取消' });\n        if (!result)\n            return;\n        try {\n            for (const scriptId of scriptIds) {\n                await this.scriptManager.deleteScript(scriptId, type);\n            }\n            for (const folderId of folderIds) {\n                await this.handleFolderDelete(folderId, type, true);\n            }\n            toastr.success(`成功删除 ${totalCount} 个项目`);\n            this.exitBatchMode(type);\n            await this.renderScriptLists();\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_10___default().error('[ScriptManager] 批量删除失败:', error);\n            toastr.error(`批量删除失败: ${error instanceof Error ? error.message : String(error)}`);\n        }\n    }\n    /**\n     * 执行批量导出\n     * @param type 脚本类型\n     */\n    async performBatchExport(type) {\n        const { scriptIds, folderIds } = this.getSelectedItems(type);\n        if (scriptIds.length === 0 && folderIds.length === 0) {\n            toastr.warning('请至少选择一个项目进行导出');\n            return;\n        }\n        try {\n            //@ts-ignore\n            if (!window.JSZip) {\n                await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @sillytavern/lib/jszip.min.js */ \"@sillytavern/lib/jszip.min.js\"));\n            }\n            //@ts-ignore\n            const zip = new JSZip();\n            let exportedCount = 0;\n            let cancelExport = false;\n            for (const scriptId of scriptIds) {\n                const script = this.scriptManager.getScriptById(scriptId);\n                if (script) {\n                    const scriptData = await this.checkScriptDataAndGetExportData(script);\n                    if (scriptData === null) {\n                        cancelExport = true;\n                        break;\n                    }\n                    const scriptFileName = `${script.name.replace(/[<>:\"/\\\\|?*]/g, '_')}.json`;\n                    zip.file(scriptFileName, JSON.stringify(scriptData, null, 2));\n                    exportedCount++;\n                }\n            }\n            if (cancelExport) {\n                return;\n            }\n            const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL\n                ? this.scriptManager.getGlobalRepositoryItems()\n                : this.scriptManager.getCharacterRepositoryItems();\n            for (const folderId of folderIds) {\n                const folder = repository.find(item => item.type === 'folder' && item.id === folderId);\n                if (folder) {\n                    const folderName = folder.name || 'folder';\n                    const sanitizedFolderName = folderName.replace(/[<>:\"/\\\\|?*]/g, '_');\n                    if (Array.isArray(folder.value)) {\n                        for (const script of folder.value) {\n                            const scriptData = await this.checkScriptDataAndGetExportData(script);\n                            if (scriptData === null) {\n                                cancelExport = true;\n                                break;\n                            }\n                            const scriptFileName = `${script.name.replace(/[<>:\"/\\\\|?*]/g, '_')}.json`;\n                            zip.file(`${sanitizedFolderName}/${scriptFileName}`, JSON.stringify(scriptData, null, 2));\n                        }\n                        if (cancelExport) {\n                            break;\n                        }\n                    }\n                    exportedCount++;\n                }\n            }\n            if (cancelExport) {\n                return;\n            }\n            if (exportedCount === 0) {\n                toastr.error('没有找到有效的导出数据');\n                return;\n            }\n            const zipBlob = await zip.generateAsync({ type: 'blob' });\n            const timestamp = new Date().toISOString().slice(0, 19).replace(/:/g, '-');\n            const typeName = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL ? 'global' : 'character';\n            const filename = `batch_export_${typeName}_${timestamp}.zip`;\n            const url = URL.createObjectURL(zipBlob);\n            const a = document.createElement('a');\n            a.href = url;\n            a.download = filename;\n            document.body.appendChild(a);\n            a.click();\n            document.body.removeChild(a);\n            URL.revokeObjectURL(url);\n            toastr.success(`成功导出 ${exportedCount} 个项目`);\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_10___default().error('[ScriptManager] 批量导出失败:', error);\n            toastr.error(`批量导出失败: ${error instanceof Error ? error.message : String(error)}`);\n        }\n    }\n    /**\n     * 执行批量移动到文件夹\n     * @param type 脚本类型\n     */\n    async performBatchMove(type) {\n        const { scriptIds, folderIds } = this.getSelectedItems(type);\n        if (folderIds.length > 0) {\n            toastr.error('不能移动文件夹，请只选择脚本进行移动操作');\n            return;\n        }\n        if (scriptIds.length === 0) {\n            toastr.warning('请至少选择一个脚本进行移动');\n            return;\n        }\n        try {\n            const repository = type === _component_script_repository_types__WEBPACK_IMPORTED_MODULE_3__.ScriptType.GLOBAL\n                ? this.scriptManager.getGlobalRepositoryItems()\n                : this.scriptManager.getCharacterRepositoryItems();\n            const folders = repository.filter(item => item.type === 'folder');\n            if (folders.length === 0) {\n                toastr.error('没有可用的文件夹，请先创建一个文件夹');\n                return;\n            }\n            const folderOptions = folders.map(folder => `<option value=\"${folder.id}\">${folder.name}</option>`).join('');\n            const template = $(`\n        <div>\n          <p>选择要移动到的文件夹：</p>\n          <select id=\"target-folder-select\" class=\"text_pole\" style=\"width: 100%;\">\n            <option value=\"\">根目录</option>\n            ${folderOptions}\n          </select>\n        </div>\n      `);\n            const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.callGenericPopup)(template, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_8__.POPUP_TYPE.CONFIRM, '', {\n                okButton: '移动',\n                cancelButton: '取消',\n            });\n            if (!result)\n                return;\n            const targetFolderId = template.find('#target-folder-select').val() || null;\n            for (const scriptId of scriptIds) {\n                await this.scriptManager.moveScriptToFolder(scriptId, targetFolderId, type);\n            }\n            const targetName = targetFolderId ? folders.find(f => f.id === targetFolderId)?.name || '未知文件夹' : '根目录';\n            toastr.success(`成功将 ${scriptIds.length} 个脚本移动到\"${targetName}\"`);\n            this.exitBatchMode(type);\n            await this.renderScriptLists();\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_10___default().error('[ScriptManager] 批量移动失败:', error);\n            toastr.error(`批量移动失败: ${error instanceof Error ? error.message : String(error)}`);\n        }\n    }\n    /**\n     * 处理文件夹创建事件\n     * @param name 文件夹名称\n     * @param type 脚本类型\n     * @param icon 文件夹图标\n     */\n    async handleFolderCreate(name, type, icon, color) {\n        try {\n            await this.scriptManager.createFolder(name, type, icon, color);\n            await this.renderScriptLists();\n            toastr.success(`文件夹 \"${name}\" 创建成功`);\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_10___default().error('[ScriptManager] 创建文件夹失败:', error);\n            toastr.error(`创建文件夹失败: ${error instanceof Error ? error.message : String(error)}`);\n        }\n    }\n    /**\n     * 处理文件夹编辑事件\n     * @param folderId 文件夹ID\n     * @param newName 新名称\n     * @param type 脚本类型\n     * @param newIcon 新图标\n     * @param newColor 新颜色\n     */\n    async handleFolderEdit(folderId, newName, type, newIcon, newColor) {\n        try {\n            await this.scriptManager.editFolder(folderId, newName, type, newIcon, newColor);\n            if (newName) {\n                $(`#${folderId} .folder-name`).text(newName);\n            }\n            if (newIcon) {\n                $(`#${folderId} .folder-icon`).removeClass().addClass(`fa ${newIcon} folder-icon marginLeft5`);\n            }\n            if (newColor) {\n                $(`#${folderId} .folder-icon`).css('color', newColor);\n                $(`#${folderId} .folder-header`).css('border-left-color', newColor);\n            }\n            toastr.success(`文件夹更新成功`);\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_10___default().error('[ScriptManager] 更新文件夹失败:', error);\n            toastr.error(`更新文件夹失败: ${error instanceof Error ? error.message : String(error)}`);\n        }\n    }\n    /**\n     * 处理文件夹删除事件\n     * @param folderId 文件夹ID\n     * @param type 脚本类型\n     * @param skipUIRefresh 是否跳过UI刷新（用于批量操作）\n     */\n    async handleFolderDelete(folderId, type, skipUIRefresh = false) {\n        try {\n            await this.scriptManager.deleteFolder(folderId, type);\n            if (!skipUIRefresh) {\n                await this.renderScriptLists();\n                toastr.success('文件夹删除成功');\n            }\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_10___default().error('[ScriptManager] 删除文件夹失败:', error);\n            if (!skipUIRefresh) {\n                toastr.error(`删除文件夹失败: ${error instanceof Error ? error.message : String(error)}`);\n            }\n            throw error;\n        }\n    }\n    /**\n     * 处理文件夹脚本批量开关\n     * @param folderId 文件夹ID\n     * @param type 脚本类型\n     * @param enable 是否启用\n     */\n    async handleFolderScriptsToggle(folderId, type, enable) {\n        try {\n            await this.scriptManager.toggleFolderScripts(folderId, type, enable);\n            this.updateFolderAndScriptsUI(folderId, type, enable);\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_10___default().error('[ScriptManager] 批量切换文件夹脚本状态失败:', error);\n            toastr.error(`批量切换脚本状态失败: ${error instanceof Error ? error.message : '未知错误'}`);\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3VpX2NvbnRyb2xsZXIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7OztBQUF1RjtBQUNRO0FBQ2Y7QUFRbkM7QUFDdUQ7QUFDNUM7QUFFUDtBQUM4QjtBQUNMO0FBQzZCO0FBRTVFO0FBRXBCLE1BQU0sWUFBWTtJQUNmLE1BQU0sQ0FBQyxRQUFRLENBQWU7SUFFOUIsYUFBYSxDQUFnQjtJQUM3QixhQUFhLENBQWdCO0lBRTdCLFlBQVksQ0FBUztJQUNyQixZQUFZLEdBQStCLElBQUksQ0FBQztJQUNoRCxxQkFBcUIsR0FBK0IsSUFBSSxDQUFDO0lBQ3pELGNBQWMsR0FBK0IsSUFBSSxDQUFDO0lBRWxELGVBQWUsR0FBWSxLQUFLLENBQUM7SUFDakMsa0JBQWtCLEdBQVksS0FBSyxDQUFDO0lBRTVDO1FBQ0UsSUFBSSxDQUFDLGFBQWEsR0FBRyx5RkFBYSxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQ2pELElBQUksQ0FBQyxhQUFhLEdBQUcsSUFBSSw4RUFBYSxFQUFFLENBQUM7UUFDekMsSUFBSSxDQUFDLFlBQVksR0FBRyxHQUFHLDBFQUFtQix5Q0FBeUMsQ0FBQztJQUN0RixDQUFDO0lBRUQ7O09BRUc7SUFDSSxNQUFNLENBQUMsV0FBVztRQUN2QixJQUFJLENBQUMsWUFBWSxDQUFDLFFBQVEsRUFBRSxDQUFDO1lBQzNCLFlBQVksQ0FBQyxRQUFRLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUM3QyxDQUFDO1FBQ0QsT0FBTyxZQUFZLENBQUMsUUFBUSxDQUFDO0lBQy9CLENBQUM7SUFFRDs7T0FFRztJQUNJLE1BQU0sQ0FBQyxlQUFlO1FBQzNCLElBQUksWUFBWSxDQUFDLFFBQVEsRUFBRSxDQUFDO1lBQzFCLFlBQVksQ0FBQyxRQUFRLENBQUMsT0FBTyxFQUFFLENBQUM7WUFDaEMsWUFBWSxDQUFDLFFBQVEsR0FBRyxTQUFvQyxDQUFDO1FBQy9ELENBQUM7SUFDSCxDQUFDO0lBRUQ7O09B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QkFBbUIsQ0FBQyxRQUFRLEVBQUUsSUFBSSxFQUFFLE1BQU0sQ0FBQyxDQUFDO1lBQ3JFLElBQUksQ0FBQyx3QkFBd0IsQ0FBQyxRQUFRLEVBQUUsSUFBSSxFQUFFLE1BQU0sQ0FBQyxDQUFDO1FBQ3hELENBQUM7UUFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO1lBQ2Ysc0RBQVMsQ0FBQyxnQ0FBZ0MsRUFBRSxLQUFLLENBQUMsQ0FBQztZQUNuRCxNQUFNLENBQUMsS0FBSyxDQUFDLGVBQWUsS0FBSyxZQUFZLEtBQUssQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQztRQUNqRixDQUFDO0lBQ0gsQ0FBQztDQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBvbmVudC9zY3JpcHRfcmVwb3NpdG9yeS91aV9jb250cm9sbGVyLnRzPzgwNmEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQnV0dG9uTWFuYWdlciwgaW5pdFNjcmlwdEJ1dHRvbiB9IGZyb20gJ0AvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L2J1dHRvbic7XG5pbXBvcnQgeyBzY3JpcHRFdmVudHMsIFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUgfSBmcm9tICdAL2NvbXBvbmVudC9zY3JpcHRfcmVwb3NpdG9yeS9ldmVudHMnO1xuaW1wb3J0IHsgU2NyaXB0TWFuYWdlciB9IGZyb20gJ0AvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3NjcmlwdF9jb250cm9sbGVyJztcbmltcG9ydCB7XG4gIGdldEJhdGNoQ29udHJvbHNTZWxlY3RvcixcbiAgZ2V0U2NyaXB0TGlzdFNlbGVjdG9yLFxuICBnZXRTY3JpcHRUb2dnbGVTZWxlY3RvcixcbiAgU2NyaXB0LFxuICBTY3JpcHRSZXBvc2l0b3J5SXRlbSxcbiAgU2NyaXB0VHlwZSxcbn0gZnJvbSAnQC9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvdHlwZXMnO1xuaW1wb3J0IHsgZXh0ZW5zaW9uRm9sZGVyUGF0aCwgZ2V0U2V0dGluZ1ZhbHVlLCBzYXZlU2V0dGluZ1ZhbHVlIH0gZnJvbSAnQC91dGlsL2V4dGVuc2lvbl92YXJpYWJsZXMnO1xuaW1wb3J0IHsgcmVuZGVyTWFya2Rvd24gfSBmcm9tICdAL3V0aWwvcmVuZGVyX21hcmtkb3duJztcblxuaW1wb3J0IHsgY2hhcmFjdGVycyB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHQnO1xuaW1wb3J0IHsgcmVuZGVyRXh0ZW5zaW9uVGVtcGxhdGVBc3luYyB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL2V4dGVuc2lvbnMnO1xuaW1wb3J0IHsgY2FsbEdlbmVyaWNQb3B1cCwgUE9QVVBfVFlQRSB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3BvcHVwJztcbmltcG9ydCB7IGRvd25sb2FkLCBnZXRTb3J0YWJsZURlbGF5LCBzaG93Rm9udEF3ZXNvbWVQaWNrZXIsIHV1aWR2NCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3V0aWxzJztcblxuaW1wb3J0IGxvZyBmcm9tICdsb2dsZXZlbCc7XG5cbmV4cG9ydCBjbGFzcyBVSUNvbnRyb2xsZXIge1xuICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogVUlDb250cm9sbGVyO1xuXG4gIHByaXZhdGUgc2NyaXB0TWFuYWdlcjogU2NyaXB0TWFuYWdlcjtcbiAgcHJpdmF0ZSBidXR0b25NYW5hZ2VyOiBCdXR0b25NYW5hZ2VyO1xuXG4gIHByaXZhdGUgdGVtcGxhdGVQYXRoOiBzdHJpbmc7XG4gIHByaXZhdGUgYmFzZVRlbXBsYXRlOiBKUXVlcnk8SFRNTEVsZW1lbnQ+IHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgZGVmYXVsdFNjcmlwdFRlbXBsYXRlOiBKUXVlcnk8SFRNTEVsZW1lbnQ+IHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgZm9sZGVyVGVtcGxhdGU6IEpRdWVyeTxIVE1MRWxlbWVudD4gfCBudWxsID0gbnVsbDtcblxuICBwcml2YXRlIGJhdGNoTW9kZUdsb2JhbDogYm9vbGVhbiA9IGZhbHNlO1xuICBwcml2YXRlIGJhdGNoTW9kZUNoYXJhY3RlcjogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIHByaXZhdGUgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5zY3JpcHRNYW5hZ2VyID0gU2NyaXB0TWFuYWdlci5nZXRJbnN0YW5jZSgpO1xuICAgIHRoaXMuYnV0dG9uTWFuYWdlciA9IG5ldyBCdXR0b25NYW5hZ2VyKCk7XG4gICAgdGhpcy50ZW1wbGF0ZVBhdGggPSBgJHtleHRlbnNpb25Gb2xkZXJQYXRofS9zcmMvY29tcG9uZW50L3NjcmlwdF9yZXBvc2l0b3J5L3B1YmxpY2A7XG4gIH1cblxuICAvKipcbiAgICog6I635Y+WVUnmjqfliLblmajlrp7kvotcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgZ2V0SW5zdGFuY2UoKTogVUlDb250cm9sbGVyIHtcbiAgICBpZiAoIVVJQ29udHJvbGxlci5pbnN0YW5jZSkge1xuICAgICAgVUlDb250cm9sbGVyLmluc3RhbmNlID0gbmV3IFVJQ29udHJvbGxlcigpO1xuICAgIH1cbiAgICByZXR1cm4gVUlDb250cm9sbGVyLmluc3RhbmNlO1xuICB9XG5cbiAgLyoqXG4gICAqIOmUgOavgVVJ5o6n5Yi25Zmo5a6e5L6LXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGRlc3Ryb3lJbnN0YW5jZSgpOiB2b2lkIHtcbiAgICBpZiAoVUlDb250cm9sbGVyLmluc3RhbmNlKSB7XG4gICAgICBVSUNvbnRyb2xsZXIuaW5zdGFuY2UuY2xlYW51cCgpO1xuICAgICAgVUlDb250cm9sbGVyLmluc3RhbmNlID0gdW5kZWZpbmVkIGFzIHVua25vd24gYXMgVUlDb250cm9sbGVyO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmuIXnkIbotYTmupBcbiAgICovXG4gIHB1YmxpYyBjbGVhbnVwKCk6IHZvaWQge1xuICAgIHRoaXMuYnV0dG9uTWFuYWdlci5jbGVhckJ1dHRvbnMoKTtcbiAgICB0aGlzLmJhc2VUZW1wbGF0ZSA9IG51bGw7XG4gICAgdGhpcy5kZWZhdWx0U2NyaXB0VGVtcGxhdGUgPSBudWxsO1xuICAgIHRoaXMuZm9sZGVyVGVtcGxhdGUgPSBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIOWIneWni+WMllVJXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgaW5pdGlhbGl6ZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBhd2FpdCB0aGlzLmluaXRpYWxpemVUZW1wbGF0ZXMoKTtcblxuICAgIHRoaXMuc2V0dXBTY3JpcHRSZXBvc2l0b3J5RXZlbnRzKCk7XG5cbiAgICB0aGlzLnJlZ2lzdGVyRXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIGF3YWl0IHRoaXMucmVuZGVyU2NyaXB0TGlzdHMoKTtcblxuICAgIGluaXRTY3JpcHRCdXR0b24oKTtcblxuICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuVUlfTE9BREVEKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDliJ3lp4vljJbmqKHmnb9cbiAgICovXG4gIHByaXZhdGUgYXN5bmMgaW5pdGlhbGl6ZVRlbXBsYXRlcygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0aGlzLmJhc2VUZW1wbGF0ZSA9ICQoXG4gICAgICBhd2FpdCByZW5kZXJFeHRlbnNpb25UZW1wbGF0ZUFzeW5jKHRoaXMudGVtcGxhdGVQYXRoLCAnc2NyaXB0X2l0ZW1fdGVtcGxhdGUnLCB7XG4gICAgICAgIHNjcmlwdE5hbWU6ICcnLFxuICAgICAgICBpZDogJycsXG4gICAgICAgIG1vdmVUbzogJycsXG4gICAgICAgIGZhSWNvbjogJycsXG4gICAgICB9KSxcbiAgICApO1xuXG4gICAgdGhpcy5kZWZhdWx0U2NyaXB0VGVtcGxhdGUgPSAkKFxuICAgICAgYXdhaXQgcmVuZGVyRXh0ZW5zaW9uVGVtcGxhdGVBc3luYyh0aGlzLnRlbXBsYXRlUGF0aCwgJ3NjcmlwdF9kZWZhdWx0X3JlcG9zaXRvcnknLCB7XG4gICAgICAgIHNjcmlwdE5hbWU6ICcnLFxuICAgICAgICBpZDogJycsXG4gICAgICB9KSxcbiAgICApO1xuXG4gICAgdGhpcy5mb2xkZXJUZW1wbGF0ZSA9ICQoXG4gICAgICBhd2FpdCByZW5kZXJFeHRlbnNpb25UZW1wbGF0ZUFzeW5jKHRoaXMudGVtcGxhdGVQYXRoLCAnZm9sZGVyX3RlbXBsYXRlJywge1xuICAgICAgICBmb2xkZXJJZDogJycsXG4gICAgICAgIGZvbGRlck5hbWU6ICcnLFxuICAgICAgICBmb2xkZXJJY29uOiAnZmEtZm9sZGVyJyxcbiAgICAgICAgZm9sZGVyQ29sb3I6IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCctLVNtYXJ0VGhlbWVCb2R5Q29sb3InKSxcbiAgICAgIH0pLFxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICog5Yid5aeL5YyW6ISa5pys5bqT55WM6Z2i5LqL5Lu2XG4gICAqL1xuICBwcml2YXRlIHNldHVwU2NyaXB0UmVwb3NpdG9yeUV2ZW50cygpOiB2b2lkIHtcbiAgICAkKCcjZ2xvYmFsLXNjcmlwdC1lbmFibGUtdG9nZ2xlJylcbiAgICAgIC5wcm9wKCdjaGVja2VkJywgdGhpcy5zY3JpcHRNYW5hZ2VyLmlzR2xvYmFsU2NyaXB0RW5hYmxlZClcbiAgICAgIC5vbignY2xpY2snLCAoZXZlbnQ6IEpRdWVyeS5DbGlja0V2ZW50KSA9PiB7XG4gICAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuVFlQRV9UT0dHTEUsIHtcbiAgICAgICAgICB0eXBlOiBTY3JpcHRUeXBlLkdMT0JBTCxcbiAgICAgICAgICBlbmFibGU6IGV2ZW50LnRhcmdldC5jaGVja2VkLFxuICAgICAgICAgIHVzZXJJbnB1dDogdHJ1ZSxcbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICQoJyNjaGFyYWN0ZXItc2NyaXB0LWVuYWJsZS10b2dnbGUnKVxuICAgICAgLnByb3AoJ2NoZWNrZWQnLCB0aGlzLnNjcmlwdE1hbmFnZXIuaXNDaGFyYWN0ZXJTY3JpcHRFbmFibGVkKVxuICAgICAgLm9uKCdjbGljaycsIChldmVudDogSlF1ZXJ5LkNsaWNrRXZlbnQpID0+IHtcbiAgICAgICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5UWVBFX1RPR0dMRSwge1xuICAgICAgICAgIHR5cGU6IFNjcmlwdFR5cGUuQ0hBUkFDVEVSLFxuICAgICAgICAgIGVuYWJsZTogZXZlbnQudGFyZ2V0LmNoZWNrZWQsXG4gICAgICAgICAgdXNlcklucHV0OiB0cnVlLFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgJCgnI2NyZWF0ZS1zY3JpcHQnKS5vbignY2xpY2snLCBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCB0aGlzLnNob3dDcmVhdGVTY3JpcHREaWFsb2coKTtcbiAgICB9KTtcblxuICAgICQoJyNpbXBvcnQtc2NyaXB0LWZpbGUnKS5vbignY2hhbmdlJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IHRhcmdldCA9ICdnbG9iYWwnO1xuICAgICAgY29uc3QgdGVtcGxhdGUgPSAkKFxuICAgICAgICBhd2FpdCByZW5kZXJFeHRlbnNpb25UZW1wbGF0ZUFzeW5jKFxuICAgICAgICAgIGAke2V4dGVuc2lvbkZvbGRlclBhdGh9L3NyYy9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvcHVibGljYCxcbiAgICAgICAgICAnc2NyaXB0X3RhcmdldF9zZWxlY3RvcicsXG4gICAgICAgICAge1xuICAgICAgICAgICAgdGl0bGU6ICflr7zlhaXliLA6JyxcbiAgICAgICAgICAgIHByZWZpeDogJ3NjcmlwdC1pbXBvcnQnLFxuICAgICAgICAgICAgZ2xvYmFsTGFiZWw6ICflhajlsYDohJrmnKwnLFxuICAgICAgICAgICAgY2hhcmFjdGVyTGFiZWw6ICflsYDpg6johJrmnKwnLFxuICAgICAgICAgIH0sXG4gICAgICAgICksXG4gICAgICApO1xuICAgICAgdGVtcGxhdGUuZmluZCgnI3NjcmlwdC1pbXBvcnQtdGFyZ2V0LWdsb2JhbCcpLm9uKCdpbnB1dCcsICgpID0+ICh0YXJnZXQgPSAnZ2xvYmFsJykpO1xuICAgICAgdGVtcGxhdGUuZmluZCgnI3NjcmlwdC1pbXBvcnQtdGFyZ2V0LWNoYXJhY3RlcicpLm9uKCdpbnB1dCcsICgpID0+ICh0YXJnZXQgPSAnY2hhcmFjdGVyJykpO1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2FsbEdlbmVyaWNQb3B1cCh0ZW1wbGF0ZSwgUE9QVVBfVFlQRS5DT05GSVJNLCAnJywge1xuICAgICAgICBva0J1dHRvbjogJ+ehruiupCcsXG4gICAgICAgIGNhbmNlbEJ1dHRvbjogJ+WPlua2iCcsXG4gICAgICB9KTtcblxuICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICBjb25zdCBpbnB1dEVsZW1lbnQgPSB0aGlzIGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCAmJiB0aGlzO1xuICAgICAgICBpZiAoaW5wdXRFbGVtZW50ICYmIGlucHV0RWxlbWVudC5maWxlcykge1xuICAgICAgICAgIGZvciAoY29uc3QgZmlsZSBvZiBpbnB1dEVsZW1lbnQuZmlsZXMpIHtcbiAgICAgICAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuU0NSSVBUX0lNUE9SVCwge1xuICAgICAgICAgICAgICBmaWxlLFxuICAgICAgICAgICAgICB0eXBlOiB0YXJnZXQgPT09ICdnbG9iYWwnID8gU2NyaXB0VHlwZS5HTE9CQUwgOiBTY3JpcHRUeXBlLkNIQVJBQ1RFUixcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpbnB1dEVsZW1lbnQudmFsdWUgPSAnJztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgJCgnI2ltcG9ydC1zY3JpcHQnKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAkKCcjaW1wb3J0LXNjcmlwdC1maWxlJykudHJpZ2dlcignY2xpY2snKTtcbiAgICB9KTtcblxuICAgICQoJyNjcmVhdGUtZm9sZGVyJykub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5zaG93Q3JlYXRlRm9sZGVyRGlhbG9nKCk7XG4gICAgfSk7XG5cbiAgICAkKCcjZGVmYXVsdC1zY3JpcHQnKS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlVJX1JFRlJFU0gsIHsgYWN0aW9uOiAnbG9hZF9kZWZhdWx0X3NjcmlwdHMnIH0pO1xuICAgIH0pO1xuXG4gICAgJCgnI2V4dGVuc2lvbnNfc2V0dGluZ3MnKS5jc3MoJ21pbi13aWR0aCcsICcwJyk7XG5cbiAgICB0aGlzLnNldHVwU2VhcmNoRXZlbnRzKCk7XG5cbiAgICB0aGlzLnNldHVwQmF0Y2hPcGVyYXRpb25FdmVudHMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDms6jlhozkuovku7bnm5HlkKzlmahcbiAgICovXG4gIHByaXZhdGUgcmVnaXN0ZXJFdmVudExpc3RlbmVycygpOiB2b2lkIHtcbiAgICBzY3JpcHRFdmVudHMub24oU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5VSV9SRUZSRVNILCBhc3luYyBkYXRhID0+IHtcbiAgICAgIGNvbnN0IHsgYWN0aW9uIH0gPSBkYXRhO1xuXG4gICAgICBzd2l0Y2ggKGFjdGlvbikge1xuICAgICAgICBjYXNlICdzY3JpcHRfdG9nZ2xlJzpcbiAgICAgICAgICBhd2FpdCB0aGlzLnJlZnJlc2hTY3JpcHRTdGF0ZShkYXRhLnNjcmlwdCwgZGF0YS5lbmFibGUpO1xuICAgICAgICAgIHRoaXMudXBkYXRlUGFyZW50Rm9sZGVyVG9nZ2xlKGRhdGEuc2NyaXB0LmlkLCBkYXRhLnR5cGUpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICd0eXBlX3RvZ2dsZSc6XG4gICAgICAgICAgYXdhaXQgdGhpcy5yZWZyZXNoVHlwZVN0YXRlKGRhdGEudHlwZSwgZGF0YS5lbmFibGUpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdzY3JpcHRfaW1wb3J0JzpcbiAgICAgICAgICBhd2FpdCB0aGlzLmFkZFNjcmlwdFRvQ29udGFpbmVyKGRhdGEuc2NyaXB0LCBkYXRhLnR5cGUpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdzY3JpcHRfY3JlYXRlJzpcbiAgICAgICAgICBhd2FpdCB0aGlzLmFkZFNjcmlwdFRvQ29udGFpbmVyKGRhdGEuc2NyaXB0LCBkYXRhLnR5cGUpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdzY3JpcHRfdXBkYXRlJzpcbiAgICAgICAgICB0aGlzLnVwZGF0ZVNjcmlwdFVJKGRhdGEuc2NyaXB0LCBkYXRhLnR5cGUpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdzY3JpcHRfZGVsZXRlJzpcbiAgICAgICAgICB0aGlzLnJlbW92ZVNjcmlwdEVsZW1lbnQoZGF0YS5zY3JpcHRJZCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ3NjcmlwdF9tb3ZlJzpcbiAgICAgICAgICB0aGlzLmhhbmRsZVNjcmlwdE1vdmVkKGRhdGEuc2NyaXB0LCBkYXRhLmZyb21UeXBlLCBkYXRhLnRhcmdldFR5cGUpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdmb2xkZXJfbW92ZSc6XG4gICAgICAgICAgYXdhaXQgdGhpcy5yZW5kZXJTY3JpcHRMaXN0cygpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdmb2xkZXJfc2NyaXB0c190b2dnbGUnOlxuICAgICAgICAgIHRoaXMudXBkYXRlRm9sZGVyQW5kU2NyaXB0c1VJKGRhdGEuZm9sZGVySWQsIGRhdGEudHlwZSwgZGF0YS5lbmFibGUpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdsb2FkX2RlZmF1bHRfc2NyaXB0cyc6XG4gICAgICAgICAgYXdhaXQgdGhpcy5sb2FkRGVmYXVsdFNjcmlwdHNSZXBvc2l0b3J5KCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ3JlZnJlc2hfZ2xvYmFsX3NjcmlwdHMnOlxuICAgICAgICAgIGF3YWl0IHRoaXMucmVmcmVzaFNjcmlwdExpc3QoU2NyaXB0VHlwZS5HTE9CQUwpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdyZWZyZXNoX2NoYXJhY3Rfc2NyaXB0cyc6XG4gICAgICAgICAgYXdhaXQgdGhpcy5yZWZyZXNoU2NyaXB0TGlzdChTY3JpcHRUeXBlLkNIQVJBQ1RFUik7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgbG9nLndhcm4oYFtTY3JpcHRNYW5hZ2VyXSDmnKrlpITnkIbnmoRVSeWIt+aWsOS6i+S7tjogJHthY3Rpb259YCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBzY3JpcHRFdmVudHMub24oU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5CVVRUT05fQURELCBkYXRhID0+IHtcbiAgICAgIGNvbnN0IHsgc2NyaXB0IH0gPSBkYXRhO1xuICAgICAgdGhpcy5hZGRCdXR0b24oc2NyaXB0KTtcbiAgICB9KTtcblxuICAgIHNjcmlwdEV2ZW50cy5vbihTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLkJVVFRPTl9SRU1PVkUsIGRhdGEgPT4ge1xuICAgICAgY29uc3QgeyBzY3JpcHRJZCB9ID0gZGF0YTtcbiAgICAgIHRoaXMuYnV0dG9uTWFuYWdlci5yZW1vdmVCdXR0b25zQnlTY3JpcHRJZChzY3JpcHRJZCk7XG4gICAgfSk7XG5cbiAgICBzY3JpcHRFdmVudHMub24oU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5TQ1JJUFRfRURJVCwgYXN5bmMgZGF0YSA9PiB7XG4gICAgICBjb25zdCB7IHR5cGUsIHNjcmlwdElkIH0gPSBkYXRhO1xuICAgICAgYXdhaXQgdGhpcy5vcGVuU2NyaXB0RWRpdG9yKHR5cGUsIHNjcmlwdElkKTtcbiAgICB9KTtcblxuICAgIHNjcmlwdEV2ZW50cy5vbihTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLkZPTERFUl9DUkVBVEUsIGFzeW5jIGRhdGEgPT4ge1xuICAgICAgY29uc3QgeyBuYW1lLCB0eXBlLCBpY29uLCBjb2xvciB9ID0gZGF0YTtcbiAgICAgIGF3YWl0IHRoaXMuaGFuZGxlRm9sZGVyQ3JlYXRlKG5hbWUsIHR5cGUsIGljb24sIGNvbG9yKTtcbiAgICB9KTtcblxuICAgIHNjcmlwdEV2ZW50cy5vbihTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLkZPTERFUl9FRElULCBhc3luYyBkYXRhID0+IHtcbiAgICAgIGNvbnN0IHsgZm9sZGVySWQsIG5ld05hbWUsIHR5cGUsIG5ld0ljb24sIG5ld0NvbG9yIH0gPSBkYXRhO1xuICAgICAgYXdhaXQgdGhpcy5oYW5kbGVGb2xkZXJFZGl0KGZvbGRlcklkLCBuZXdOYW1lLCB0eXBlLCBuZXdJY29uLCBuZXdDb2xvcik7XG4gICAgfSk7XG5cbiAgICBzY3JpcHRFdmVudHMub24oU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5GT0xERVJfREVMRVRFLCBhc3luYyBkYXRhID0+IHtcbiAgICAgIGNvbnN0IHsgZm9sZGVySWQsIHR5cGUgfSA9IGRhdGE7XG4gICAgICBhd2FpdCB0aGlzLmhhbmRsZUZvbGRlckRlbGV0ZShmb2xkZXJJZCwgdHlwZSk7XG4gICAgfSk7XG5cbiAgICBzY3JpcHRFdmVudHMub24oU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5GT0xERVJfU0NSSVBUU19UT0dHTEUsIGFzeW5jIGRhdGEgPT4ge1xuICAgICAgY29uc3QgeyBmb2xkZXJJZCwgdHlwZSwgZW5hYmxlIH0gPSBkYXRhO1xuICAgICAgYXdhaXQgdGhpcy5oYW5kbGVGb2xkZXJTY3JpcHRzVG9nZ2xlKGZvbGRlcklkLCB0eXBlLCBlbmFibGUpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOa3u+WKoOaMiemSrlxuICAgKiBAcGFyYW0gc2NyaXB0IOiEmuacrFxuICAgKi9cbiAgcHJpdmF0ZSBhZGRCdXR0b24oc2NyaXB0OiBTY3JpcHQpOiB2b2lkIHtcbiAgICBpZiAoc2NyaXB0LmJ1dHRvbnMgJiYgc2NyaXB0LmJ1dHRvbnMubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy5idXR0b25NYW5hZ2VyLmFkZEJ1dHRvbnNGb3JTY3JpcHQoc2NyaXB0KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5riy5p+T6ISa5pys5YiX6KGoXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHJlbmRlclNjcmlwdExpc3RzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRoaXMuY2xlYXJTY3JpcHRMaXN0KFNjcmlwdFR5cGUuR0xPQkFMKTtcbiAgICB0aGlzLmNsZWFyU2NyaXB0TGlzdChTY3JpcHRUeXBlLkNIQVJBQ1RFUik7XG5cbiAgICBhd2FpdCB0aGlzLnJlbmRlclJlcG9zaXRvcnkoU2NyaXB0VHlwZS5HTE9CQUwpO1xuXG4gICAgYXdhaXQgdGhpcy5yZW5kZXJSZXBvc2l0b3J5KFNjcmlwdFR5cGUuQ0hBUkFDVEVSKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmuLLmn5PmjIflrprnsbvlnovnmoTohJrmnKzku5PlupNcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHJlbmRlclJlcG9zaXRvcnkodHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHJlcG9zaXRvcnlJdGVtcyA9XG4gICAgICB0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTFxuICAgICAgICA/IHRoaXMuc2NyaXB0TWFuYWdlci5nZXRHbG9iYWxSZXBvc2l0b3J5SXRlbXMoKVxuICAgICAgICA6IHRoaXMuc2NyaXB0TWFuYWdlci5nZXRDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMoKTtcblxuICAgIGlmIChyZXBvc2l0b3J5SXRlbXMubGVuZ3RoID4gMCkge1xuICAgICAgZm9yIChjb25zdCBpdGVtIG9mIHJlcG9zaXRvcnlJdGVtcykge1xuICAgICAgICBpZiAoaXRlbS50eXBlID09PSAnZm9sZGVyJykge1xuICAgICAgICAgIGF3YWl0IHRoaXMucmVuZGVyRm9sZGVyKGl0ZW0sIHR5cGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGF3YWl0IHRoaXMuYWRkU2NyaXB0VG9Db250YWluZXIoaXRlbS52YWx1ZSBhcyBTY3JpcHQsIHR5cGUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc2hvd0VtcHR5U2NyaXB0TGlzdFRpcCh0eXBlKTtcbiAgICB9XG5cbiAgICB0aGlzLnNldHVwRHJhZ2dhYmxlKHR5cGUpO1xuICB9XG5cbiAgLyoqXG4gICAqIOa4hemZpOaMh+Wumuexu+Wei+eahOiEmuacrOWIl+ihqFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHByaXZhdGUgY2xlYXJTY3JpcHRMaXN0KHR5cGU6IFNjcmlwdFR5cGUpOiB2b2lkIHtcbiAgICAkKGdldFNjcmlwdExpc3RTZWxlY3Rvcih0eXBlKSkuZW1wdHkoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDliLfmlrDmjIflrprnsbvlnovnmoTohJrmnKzliJfooahcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHJlZnJlc2hTY3JpcHRMaXN0KHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0aGlzLmNsZWFyU2NyaXB0TGlzdCh0eXBlKTtcblxuICAgIGF3YWl0IHRoaXMucmVuZGVyUmVwb3NpdG9yeSh0eXBlKTtcblxuICAgIGNvbnN0IGlzRW5hYmxlZCA9XG4gICAgICB0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTFxuICAgICAgICA/IHRoaXMuc2NyaXB0TWFuYWdlci5pc0dsb2JhbFNjcmlwdEVuYWJsZWRcbiAgICAgICAgOiB0aGlzLnNjcmlwdE1hbmFnZXIuaXNDaGFyYWN0ZXJTY3JpcHRFbmFibGVkO1xuICAgIGNvbnN0IHRvZ2dsZVNlbGVjdG9yID0gZ2V0U2NyaXB0VG9nZ2xlU2VsZWN0b3IodHlwZSk7XG4gICAgJCh0b2dnbGVTZWxlY3RvcikucHJvcCgnY2hlY2tlZCcsIGlzRW5hYmxlZCk7XG4gIH1cblxuICAvKipcbiAgICog5pi+56S656m66ISa5pys5YiX6KGo5o+Q56S6XG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBzaG93RW1wdHlTY3JpcHRMaXN0VGlwKHR5cGU6IFNjcmlwdFR5cGUpOiB2b2lkIHtcbiAgICBjb25zdCBjb250YWluZXIgPSAkKGdldFNjcmlwdExpc3RTZWxlY3Rvcih0eXBlKSk7XG4gICAgaWYgKGNvbnRhaW5lci5maW5kKCdzbWFsbCcpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgY29udGFpbmVyLmFwcGVuZCgnPHNtYWxsPuaaguaXoOiEmuacrDwvc21hbGw+Jyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWIt+aWsOiEmuacrOeKtuaAgVxuICAgKiBAcGFyYW0gc2NyaXB0IOiEmuacrFxuICAgKiBAcGFyYW0gZW5hYmxlIOaYr+WQpuWQr+eUqFxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyByZWZyZXNoU2NyaXB0U3RhdGUoc2NyaXB0OiBTY3JpcHQsIGVuYWJsZTogYm9vbGVhbik6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0ICRzY3JpcHQgPSAkKGAjJHtzY3JpcHQuaWR9YCk7XG4gICAgaWYgKCRzY3JpcHQubGVuZ3RoID4gMCkge1xuICAgICAgaWYgKGVuYWJsZSkge1xuICAgICAgICAkc2NyaXB0LmZpbmQoJy5zY3JpcHQtdG9nZ2xlJykuYWRkQ2xhc3MoJ2VuYWJsZWQnKTtcbiAgICAgICAgJHNjcmlwdC5maW5kKCcuc2NyaXB0LXRvZ2dsZSBpLmZhLXRvZ2dsZS1vZmYnKS5oaWRlKCk7XG4gICAgICAgICRzY3JpcHQuZmluZCgnLnNjcmlwdC10b2dnbGUgaS5mYS10b2dnbGUtb24nKS5zaG93KCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkc2NyaXB0LmZpbmQoJy5zY3JpcHQtdG9nZ2xlJykucmVtb3ZlQ2xhc3MoJ2VuYWJsZWQnKTtcbiAgICAgICAgJHNjcmlwdC5maW5kKCcuc2NyaXB0LXRvZ2dsZSBpLmZhLXRvZ2dsZS1vZmYnKS5zaG93KCk7XG4gICAgICAgICRzY3JpcHQuZmluZCgnLnNjcmlwdC10b2dnbGUgaS5mYS10b2dnbGUtb24nKS5oaWRlKCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWIt+aWsOiEmuacrOexu+Wei+eKtuaAgVxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICogQHBhcmFtIGVuYWJsZSDmmK/lkKblkK/nlKhcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgcmVmcmVzaFR5cGVTdGF0ZSh0eXBlOiBTY3JpcHRUeXBlLCBlbmFibGU6IGJvb2xlYW4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCAkdG9nZ2xlID0gJChnZXRTY3JpcHRUb2dnbGVTZWxlY3Rvcih0eXBlKSk7XG4gICAgJHRvZ2dsZS5wcm9wKCdjaGVja2VkJywgZW5hYmxlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmm7TmlrDmlofku7blpLnlj4rlhbblhoXpg6johJrmnKznmoRVSeeKtuaAgVxuICAgKiBAcGFyYW0gZm9sZGVySWQg5paH5Lu25aS5SURcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqIEBwYXJhbSBlbmFibGUg5piv5ZCm5ZCv55SoXG4gICAqL1xuICBwcml2YXRlIHVwZGF0ZUZvbGRlckFuZFNjcmlwdHNVSShmb2xkZXJJZDogc3RyaW5nLCB0eXBlOiBTY3JpcHRUeXBlLCBlbmFibGU6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICBjb25zdCAkZm9sZGVyID0gJChgIyR7Zm9sZGVySWR9YCk7XG4gICAgaWYgKCRmb2xkZXIubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy51cGRhdGVGb2xkZXJUb2dnbGVTdGF0ZSgkZm9sZGVyLCBmb2xkZXJJZCwgdHlwZSk7XG5cbiAgICAgIGNvbnN0ICRmb2xkZXJDb250ZW50ID0gJGZvbGRlci5maW5kKCcuZm9sZGVyLWNvbnRlbnQnKTtcbiAgICAgICRmb2xkZXJDb250ZW50LmZpbmQoJy5zY3JpcHQtaXRlbScpLmVhY2goKF8sIGVsZW1lbnQpID0+IHtcbiAgICAgICAgY29uc3QgJHNjcmlwdCA9ICQoZWxlbWVudCk7XG4gICAgICAgIGNvbnN0ICR0b2dnbGUgPSAkc2NyaXB0LmZpbmQoJy5zY3JpcHQtdG9nZ2xlJyk7XG5cbiAgICAgICAgaWYgKGVuYWJsZSkge1xuICAgICAgICAgICR0b2dnbGUuYWRkQ2xhc3MoJ2VuYWJsZWQnKTtcbiAgICAgICAgICAkdG9nZ2xlLmZpbmQoJ2kuZmEtdG9nZ2xlLW9mZicpLmhpZGUoKTtcbiAgICAgICAgICAkdG9nZ2xlLmZpbmQoJ2kuZmEtdG9nZ2xlLW9uJykuc2hvdygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICR0b2dnbGUucmVtb3ZlQ2xhc3MoJ2VuYWJsZWQnKTtcbiAgICAgICAgICAkdG9nZ2xlLmZpbmQoJ2kuZmEtdG9nZ2xlLW9mZicpLnNob3coKTtcbiAgICAgICAgICAkdG9nZ2xlLmZpbmQoJ2kuZmEtdG9nZ2xlLW9uJykuaGlkZSgpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5aKe6YeP5pu05paw6ISa5pysVUlcbiAgICogQHBhcmFtIHNjcmlwdCDohJrmnKzlr7nosaFcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwcml2YXRlIHVwZGF0ZVNjcmlwdFVJKHNjcmlwdDogU2NyaXB0LCB0eXBlOiBTY3JpcHRUeXBlKTogdm9pZCB7XG4gICAgY29uc3QgJGV4aXN0aW5nU2NyaXB0ID0gJChgIyR7Q1NTLmVzY2FwZShzY3JpcHQuaWQpfWApO1xuXG4gICAgaWYgKCRleGlzdGluZ1NjcmlwdC5sZW5ndGggPT09IDApIHtcbiAgICAgIHRoaXMuYWRkU2NyaXB0VG9Db250YWluZXIoc2NyaXB0LCB0eXBlKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAkZXhpc3RpbmdTY3JpcHQuZmluZCgnLnNjcmlwdC1pdGVtLW5hbWUnKS50ZXh0KHNjcmlwdC5uYW1lKTtcblxuICAgIGNvbnN0ICR0b2dnbGUgPSAkZXhpc3RpbmdTY3JpcHQuZmluZCgnLnNjcmlwdC10b2dnbGUnKTtcbiAgICBpZiAoc2NyaXB0LmVuYWJsZWQpIHtcbiAgICAgICR0b2dnbGUuYWRkQ2xhc3MoJ2VuYWJsZWQnKTtcbiAgICAgICR0b2dnbGUuZmluZCgnaS5mYS10b2dnbGUtb2ZmJykuaGlkZSgpO1xuICAgICAgJHRvZ2dsZS5maW5kKCdpLmZhLXRvZ2dsZS1vbicpLnNob3coKTtcbiAgICB9IGVsc2Uge1xuICAgICAgJHRvZ2dsZS5yZW1vdmVDbGFzcygnZW5hYmxlZCcpO1xuICAgICAgJHRvZ2dsZS5maW5kKCdpLmZhLXRvZ2dsZS1vZmYnKS5zaG93KCk7XG4gICAgICAkdG9nZ2xlLmZpbmQoJ2kuZmEtdG9nZ2xlLW9uJykuaGlkZSgpO1xuICAgIH1cblxuICAgIGNvbnN0ICRtb3ZlQnV0dG9uID0gJGV4aXN0aW5nU2NyaXB0LmZpbmQoJy5zY3JpcHQtc3RvcmFnZS1sb2NhdGlvbicpO1xuICAgICRtb3ZlQnV0dG9uLnJlbW92ZUNsYXNzKCdtb3ZlLXRvLWNoYXJhY3RlciBtb3ZlLXRvLWdsb2JhbCcpO1xuICAgICRtb3ZlQnV0dG9uLmFkZENsYXNzKHR5cGUgPT09ICdnbG9iYWwnID8gJ21vdmUtdG8tY2hhcmFjdGVyJyA6ICdtb3ZlLXRvLWdsb2JhbCcpO1xuXG4gICAgY29uc3QgJG1vdmVJY29uID0gJG1vdmVCdXR0b24uZmluZCgnaScpO1xuICAgICRtb3ZlSWNvbi5yZW1vdmVDbGFzcygnZmEtYXJyb3ctZG93biBmYS1hcnJvdy11cCcpO1xuICAgICRtb3ZlSWNvbi5hZGRDbGFzcyh0eXBlID09PSAnZ2xvYmFsJyA/ICdmYS1hcnJvdy1kb3duJyA6ICdmYS1hcnJvdy11cCcpO1xuXG4gICAgdGhpcy5yZWJpbmRTY3JpcHRFdmVudHMoJGV4aXN0aW5nU2NyaXB0LCBzY3JpcHQsIHR5cGUpO1xuICB9XG5cbiAgLyoqXG4gICAqIOmHjeaWsOe7keWumuiEmuacrOS6i+S7tlxuICAgKiBAcGFyYW0gJHNjcmlwdEVsZW1lbnQg6ISa5pysRE9N5YWD57SgXG4gICAqIEBwYXJhbSBzY3JpcHQg6ISa5pys5a+56LGhXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSByZWJpbmRTY3JpcHRFdmVudHMoJHNjcmlwdEVsZW1lbnQ6IEpRdWVyeTxIVE1MRWxlbWVudD4sIHNjcmlwdDogU2NyaXB0LCB0eXBlOiBTY3JpcHRUeXBlKTogdm9pZCB7XG4gICAgJHNjcmlwdEVsZW1lbnQuZmluZCgnLnNjcmlwdC10b2dnbGUnKS5vZmYoJ2NsaWNrLnNjcmlwdFRvZ2dsZScpO1xuICAgICRzY3JpcHRFbGVtZW50LmZpbmQoJy5zY3JpcHQtaW5mbycpLm9mZignY2xpY2suc2NyaXB0SW5mbycpO1xuICAgICRzY3JpcHRFbGVtZW50LmZpbmQoJy5lZGl0LXNjcmlwdCcpLm9mZignY2xpY2suc2NyaXB0RWRpdCcpO1xuICAgICRzY3JpcHRFbGVtZW50LmZpbmQoJy5zY3JpcHQtc3RvcmFnZS1sb2NhdGlvbicpLm9mZignY2xpY2suc2NyaXB0TW92ZScpO1xuICAgICRzY3JpcHRFbGVtZW50LmZpbmQoJy5leHBvcnQtc2NyaXB0Jykub2ZmKCdjbGljay5zY3JpcHRFeHBvcnQnKTtcbiAgICAkc2NyaXB0RWxlbWVudC5maW5kKCcuZGVsZXRlLXNjcmlwdCcpLm9mZignY2xpY2suc2NyaXB0RGVsZXRlJyk7XG5cbiAgICBjb25zdCAkdG9nZ2xlQnV0dG9uID0gJHNjcmlwdEVsZW1lbnQuZmluZCgnLnNjcmlwdC10b2dnbGUnKTtcbiAgICAkdG9nZ2xlQnV0dG9uLm9uKCdjbGljay5zY3JpcHRUb2dnbGUnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCBpc0VuYWJsZWQgPSAkKHRoaXMpLmhhc0NsYXNzKCdlbmFibGVkJyk7XG4gICAgICBjb25zdCBuZXdTdGF0ZSA9ICFpc0VuYWJsZWQ7XG5cbiAgICAgIGlmIChuZXdTdGF0ZSkge1xuICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCdlbmFibGVkJyk7XG4gICAgICAgICQodGhpcykuZmluZCgnaS5mYS10b2dnbGUtb2ZmJykuaGlkZSgpO1xuICAgICAgICAkKHRoaXMpLmZpbmQoJ2kuZmEtdG9nZ2xlLW9uJykuc2hvdygpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcygnZW5hYmxlZCcpO1xuICAgICAgICAkKHRoaXMpLmZpbmQoJ2kuZmEtdG9nZ2xlLW9mZicpLnNob3coKTtcbiAgICAgICAgJCh0aGlzKS5maW5kKCdpLmZhLXRvZ2dsZS1vbicpLmhpZGUoKTtcbiAgICAgIH1cblxuICAgICAgc2NyaXB0LmVuYWJsZWQgPSBuZXdTdGF0ZTtcblxuICAgICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5TQ1JJUFRfVE9HR0xFLCB7XG4gICAgICAgIHNjcmlwdCxcbiAgICAgICAgdHlwZSxcbiAgICAgICAgZW5hYmxlOiBuZXdTdGF0ZSxcbiAgICAgICAgdXNlcklucHV0OiB0cnVlLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAkc2NyaXB0RWxlbWVudC5maW5kKCcuc2NyaXB0LWluZm8nKS5vbignY2xpY2suc2NyaXB0SW5mbycsICgpID0+IHtcbiAgICAgIGNvbnN0IHNjcmlwdEluZm8gPSBzY3JpcHQuaW5mbyB8fCAnJztcbiAgICAgIGNvbnN0IGh0bWxUZXh0ID0gcmVuZGVyTWFya2Rvd24oc2NyaXB0SW5mbyk7XG4gICAgICBjYWxsR2VuZXJpY1BvcHVwKGh0bWxUZXh0LCBQT1BVUF9UWVBFLkRJU1BMQVksIHVuZGVmaW5lZCwgeyB3aWRlOiB0cnVlIH0pO1xuICAgIH0pO1xuXG4gICAgJHNjcmlwdEVsZW1lbnQuZmluZCgnLmVkaXQtc2NyaXB0Jykub24oJ2NsaWNrLnNjcmlwdEVkaXQnLCBlID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlNDUklQVF9FRElULCB7IHR5cGUsIHNjcmlwdElkOiBzY3JpcHQuaWQgfSk7XG4gICAgfSk7XG5cbiAgICAkc2NyaXB0RWxlbWVudC5maW5kKCcuc2NyaXB0LXN0b3JhZ2UtbG9jYXRpb24nKS5vbignY2xpY2suc2NyaXB0TW92ZScsICgpID0+IHtcbiAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuU0NSSVBUX01PVkUsIHsgc2NyaXB0LCBmcm9tVHlwZTogdHlwZSB9KTtcbiAgICB9KTtcblxuICAgICRzY3JpcHRFbGVtZW50LmZpbmQoJy5leHBvcnQtc2NyaXB0Jykub24oJ2NsaWNrLnNjcmlwdEV4cG9ydCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGZpbGVOYW1lID0gYCR7c2NyaXB0Lm5hbWUucmVwbGFjZSgvW1xccy48PjpcIi9cXFxcfD8qXFx4MDAtXFx4MUZcXHg3Rl0vZywgJ18nKS50b0xvd2VyQ2FzZSgpfS5qc29uYDtcbiAgICAgIGNvbnN0IHNjcmlwdERhdGEgPSBhd2FpdCB0aGlzLmNoZWNrU2NyaXB0RGF0YUFuZEdldEV4cG9ydERhdGEoc2NyaXB0KTtcblxuICAgICAgaWYgKHNjcmlwdERhdGEgPT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBmaWxlRGF0YSA9IEpTT04uc3RyaW5naWZ5KHNjcmlwdERhdGEsIG51bGwsIDIpO1xuICAgICAgZG93bmxvYWQoZmlsZURhdGEsIGZpbGVOYW1lLCAnYXBwbGljYXRpb24vanNvbicpO1xuICAgIH0pO1xuXG4gICAgJHNjcmlwdEVsZW1lbnQuZmluZCgnLmRlbGV0ZS1zY3JpcHQnKS5vbignY2xpY2suc2NyaXB0RGVsZXRlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY29uZmlybSA9IGF3YWl0IGNhbGxHZW5lcmljUG9wdXAoJ+ehruWumuimgeWIoOmZpOi/meS4quiEmuacrOWQl++8nycsIFBPUFVQX1RZUEUuQ09ORklSTSk7XG5cbiAgICAgIGlmICghY29uZmlybSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuU0NSSVBUX0RFTEVURSwgeyBzY3JpcHRJZDogc2NyaXB0LmlkLCB0eXBlIH0pO1xuICAgICAgJHNjcmlwdEVsZW1lbnQucmVtb3ZlKCk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog56e76Zmk6ISa5pys5YWD57SgXG4gICAqIEBwYXJhbSBzY3JpcHRJZCDohJrmnKxJRFxuICAgKi9cbiAgcHJpdmF0ZSByZW1vdmVTY3JpcHRFbGVtZW50KHNjcmlwdElkOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAkKGAjJHtzY3JpcHRJZH1gKS5yZW1vdmUoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlpITnkIbohJrmnKznp7vliqhcbiAgICogQHBhcmFtIHNjcmlwdCDohJrmnKxcbiAgICogQHBhcmFtIGZyb21UeXBlIOa6kOexu+Wei1xuICAgKiBAcGFyYW0gdGFyZ2V0VHlwZSDnm67moIfnsbvlnotcbiAgICovXG4gIHByaXZhdGUgaGFuZGxlU2NyaXB0TW92ZWQoc2NyaXB0OiBTY3JpcHQsIGZyb21UeXBlOiBTY3JpcHRUeXBlLCB0YXJnZXRUeXBlOiBTY3JpcHRUeXBlKTogdm9pZCB7XG4gICAgJChgIyR7c2NyaXB0LmlkfWApLnJlbW92ZSgpO1xuXG4gICAgY29uc3Qgc291cmNlTGlzdCA9IGZyb21UeXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCA/ICQoJyNnbG9iYWwtc2NyaXB0LWxpc3QnKSA6ICQoJyNjaGFyYWN0ZXItc2NyaXB0LWxpc3QnKTtcbiAgICBpZiAoc291cmNlTGlzdC5jaGlsZHJlbigpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdGhpcy5zaG93RW1wdHlTY3JpcHRMaXN0VGlwKGZyb21UeXBlKTtcbiAgICB9XG5cbiAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlVJX1JFRlJFU0gsIHtcbiAgICAgIGFjdGlvbjogJ3NjcmlwdF9pbXBvcnQnLFxuICAgICAgc2NyaXB0LFxuICAgICAgdHlwZTogdGFyZ2V0VHlwZSxcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlkJHlrrnlmajmt7vliqDohJrmnKzlhYPntKBcbiAgICogQHBhcmFtIHNjcmlwdCDohJrmnKxcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGFkZFNjcmlwdFRvQ29udGFpbmVyKHNjcmlwdDogU2NyaXB0LCB0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgJHNjcmlwdEVsZW1lbnQgPSBhd2FpdCB0aGlzLmNyZWF0ZVNjcmlwdEVsZW1lbnQoc2NyaXB0LCB0eXBlKTtcbiAgICBjb25zdCBsaXN0ID0gJChnZXRTY3JpcHRMaXN0U2VsZWN0b3IodHlwZSkpO1xuXG4gICAgY29uc3QgJGVtcHR5VGlwID0gbGlzdC5maW5kKCdzbWFsbCcpO1xuICAgIGlmICgkZW1wdHlUaXAubGVuZ3RoID4gMCkge1xuICAgICAgJGVtcHR5VGlwLnJlbW92ZSgpO1xuICAgIH1cblxuICAgIGxpc3QuYXBwZW5kKCRzY3JpcHRFbGVtZW50KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDorr7nva7ohJrmnKzmi5bmi73mjpLluo9cbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwcml2YXRlIHNldHVwRHJhZ2dhYmxlKHR5cGU6IFNjcmlwdFR5cGUpOiB2b2lkIHtcbiAgICBjb25zdCBsaXN0ID0gJChnZXRTY3JpcHRMaXN0U2VsZWN0b3IodHlwZSkpO1xuXG4gICAgbGlzdC5zb3J0YWJsZSh7XG4gICAgICBkZWxheTogZ2V0U29ydGFibGVEZWxheSgpLFxuICAgICAgaXRlbXM6ICcuc2NyaXB0LWl0ZW0sIC5zY3JpcHQtZm9sZGVyJyxcbiAgICAgIGhhbmRsZTogJy5kcmFnLWhhbmRsZScsXG4gICAgICBjdXJzb3I6ICdtb3ZlJyxcbiAgICAgIHRvbGVyYW5jZTogJ3BvaW50ZXInLFxuICAgICAgcGxhY2Vob2xkZXI6ICdzb3J0YWJsZS1wbGFjZWhvbGRlcicsXG4gICAgICBjb25uZWN0V2l0aDogJy5mb2xkZXItY29udGVudCcsXG5cbiAgICAgIHN0b3A6IGFzeW5jIF9ldmVudCA9PiB7XG4gICAgICAgIGF3YWl0IHRoaXMuaGFuZGxlRHJhZ1N0b3AodHlwZSk7XG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgdGhpcy5zZXR1cEZvbGRlckRyb3Bab25lcyh0eXBlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDorr7nva7mlofku7blpLnmi5bmi73lip/og71cbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwcml2YXRlIHNldHVwRm9sZGVyRHJhZ2dhYmxlKHR5cGU6IFNjcmlwdFR5cGUpOiB2b2lkIHtcbiAgICBjb25zdCBsaXN0ID0gJChnZXRTY3JpcHRMaXN0U2VsZWN0b3IodHlwZSkpO1xuXG4gICAgbGlzdC5maW5kKCcuZm9sZGVyLWNvbnRlbnQnKS5zb3J0YWJsZSh7XG4gICAgICBkZWxheTogZ2V0U29ydGFibGVEZWxheSgpLFxuICAgICAgaXRlbXM6ICcuc2NyaXB0LWl0ZW0nLFxuICAgICAgaGFuZGxlOiAnLmRyYWctaGFuZGxlJyxcbiAgICAgIGN1cnNvcjogJ21vdmUnLFxuICAgICAgdG9sZXJhbmNlOiAncG9pbnRlcicsXG4gICAgICBwbGFjZWhvbGRlcjogJ3NvcnRhYmxlLXBsYWNlaG9sZGVyJyxcbiAgICAgIGNvbm5lY3RXaXRoOiBgJHtnZXRTY3JpcHRMaXN0U2VsZWN0b3IodHlwZSl9LCAuZm9sZGVyLWNvbnRlbnRgLFxuICAgICAgc3RvcDogYXN5bmMgX2V2ZW50ID0+IHtcbiAgICAgICAgYXdhaXQgdGhpcy5oYW5kbGVEcmFnU3RvcCh0eXBlKTtcbiAgICAgIH0sXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog6K6+572u5paH5Lu25aS55ouW5ou95o6l5pS25Yy65Z+fXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBzZXR1cEZvbGRlckRyb3Bab25lcyh0eXBlOiBTY3JpcHRUeXBlKTogdm9pZCB7XG4gICAgY29uc3QgbGlzdCA9ICQoZ2V0U2NyaXB0TGlzdFNlbGVjdG9yKHR5cGUpKTtcblxuICAgIGxpc3QuZmluZCgnLnNjcmlwdC1mb2xkZXInKS5lYWNoKChfLCBmb2xkZXJFbGVtZW50KSA9PiB7XG4gICAgICB0aGlzLnNldHVwU2luZ2xlRm9sZGVyRHJvcFpvbmUoJChmb2xkZXJFbGVtZW50KSwgdHlwZSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog5Li65Y2V5Liq5paH5Lu25aS56K6+572u5ouW5ou95o6l5pS25Yy65Z+fXG4gICAqIEBwYXJhbSAkZm9sZGVyIOaWh+S7tuWkuWpRdWVyeeWvueixoVxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHByaXZhdGUgc2V0dXBTaW5nbGVGb2xkZXJEcm9wWm9uZSgkZm9sZGVyOiBKUXVlcnk8SFRNTEVsZW1lbnQ+LCB0eXBlOiBTY3JpcHRUeXBlKTogdm9pZCB7XG4gICAgY29uc3QgJGZvbGRlckNvbnRlbnQgPSAkZm9sZGVyLmZpbmQoJy5mb2xkZXItY29udGVudCcpO1xuXG4gICAgJGZvbGRlci5vZmYoJy5kcmFnZHJvcCcpO1xuXG4gICAgJGZvbGRlci5vbignZHJhZ292ZXIgZHJhZ2VudGVyIGRyYWdsZWF2ZSBkcm9wJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSk7XG5cbiAgICAkZm9sZGVyLmRyb3BwYWJsZSh7XG4gICAgICBhY2NlcHQ6ICcuc2NyaXB0LWl0ZW1bZGF0YS1zY3JpcHQtcmVwb3NpdG9yeT1cInRydWVcIl0nLFxuICAgICAgdG9sZXJhbmNlOiAncG9pbnRlcicsXG4gICAgICBncmVlZHk6IHRydWUsXG4gICAgICBvdmVyOiAoX2V2ZW50LCB1aSkgPT4ge1xuICAgICAgICBpZiAoIXVpLmRyYWdnYWJsZS5oYXNDbGFzcygnc2NyaXB0LWl0ZW0nKSB8fCAhdWkuZHJhZ2dhYmxlLmF0dHIoJ2RhdGEtc2NyaXB0LXJlcG9zaXRvcnknKSkgcmV0dXJuO1xuXG4gICAgICAgIGNvbnN0IGlzRnJvbVNhbWVGb2xkZXIgPSB1aS5kcmFnZ2FibGUuY2xvc2VzdCgnLnNjcmlwdC1mb2xkZXInKS5hdHRyKCdpZCcpID09PSAkZm9sZGVyLmF0dHIoJ2lkJyk7XG4gICAgICAgIGlmIChpc0Zyb21TYW1lRm9sZGVyKSByZXR1cm47XG5cbiAgICAgICAgJGZvbGRlci5hZGRDbGFzcygnZm9sZGVyLWRyYWctdGFyZ2V0Jyk7XG5cbiAgICAgICAgaWYgKCEkZm9sZGVyQ29udGVudC5pcygnOnZpc2libGUnKSkge1xuICAgICAgICAgICRmb2xkZXJDb250ZW50LnNsaWRlRG93bigyMDApO1xuICAgICAgICAgICRmb2xkZXIuZmluZCgnLmZvbGRlci10b2dnbGUnKS5hZGRDbGFzcygnZXhwYW5kZWQnKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIG91dDogKF9ldmVudCwgdWkpID0+IHtcbiAgICAgICAgaWYgKCF1aS5kcmFnZ2FibGUuaGFzQ2xhc3MoJ3NjcmlwdC1pdGVtJykgfHwgIXVpLmRyYWdnYWJsZS5hdHRyKCdkYXRhLXNjcmlwdC1yZXBvc2l0b3J5JykpIHJldHVybjtcblxuICAgICAgICBjb25zdCBpc0Zyb21TYW1lRm9sZGVyID0gdWkuZHJhZ2dhYmxlLmNsb3Nlc3QoJy5zY3JpcHQtZm9sZGVyJykuYXR0cignaWQnKSA9PT0gJGZvbGRlci5hdHRyKCdpZCcpO1xuICAgICAgICBpZiAoaXNGcm9tU2FtZUZvbGRlcikgcmV0dXJuO1xuXG4gICAgICAgICRmb2xkZXIucmVtb3ZlQ2xhc3MoJ2ZvbGRlci1kcmFnLXRhcmdldCcpO1xuICAgICAgfSxcbiAgICAgIGRyb3A6IGFzeW5jIChldmVudCwgdWkpID0+IHtcbiAgICAgICAgaWYgKGV2ZW50Lm9yaWdpbmFsRXZlbnQpIHtcbiAgICAgICAgICBldmVudC5vcmlnaW5hbEV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgZXZlbnQub3JpZ2luYWxFdmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgfVxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcblxuICAgICAgICBpZiAoIXVpLmRyYWdnYWJsZS5oYXNDbGFzcygnc2NyaXB0LWl0ZW0nKSB8fCAhdWkuZHJhZ2dhYmxlLmF0dHIoJ2RhdGEtc2NyaXB0LXJlcG9zaXRvcnknKSkgcmV0dXJuO1xuXG4gICAgICAgIGNvbnN0IHNjcmlwdElkID0gdWkuZHJhZ2dhYmxlLmF0dHIoJ2lkJyk7XG4gICAgICAgIGNvbnN0IGZvbGRlcklkID0gJGZvbGRlci5hdHRyKCdpZCcpO1xuXG4gICAgICAgIGNvbnN0IGlzRnJvbVNhbWVGb2xkZXIgPSB1aS5kcmFnZ2FibGUuY2xvc2VzdCgnLnNjcmlwdC1mb2xkZXInKS5hdHRyKCdpZCcpID09PSBmb2xkZXJJZDtcbiAgICAgICAgaWYgKGlzRnJvbVNhbWVGb2xkZXIpIHtcbiAgICAgICAgICAkZm9sZGVyLnJlbW92ZUNsYXNzKCdmb2xkZXItZHJhZy10YXJnZXQnKTtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc2NyaXB0SWQgJiYgZm9sZGVySWQpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3Qgc3VjY2VzcyA9IGF3YWl0IHRoaXMuaGFuZGxlU2NyaXB0RHJvcFRvRm9sZGVyKHNjcmlwdElkLCBmb2xkZXJJZCwgdHlwZSwgdWkuZHJhZ2dhYmxlKTtcblxuICAgICAgICAgICAgaWYgKCFzdWNjZXNzKSB7XG4gICAgICAgICAgICAgICRmb2xkZXIucmVtb3ZlQ2xhc3MoJ2ZvbGRlci1kcmFnLXRhcmdldCcpO1xuICAgICAgICAgICAgICBzZXRUaW1lb3V0KGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnJlbmRlclNjcmlwdExpc3RzKCk7XG4gICAgICAgICAgICAgIH0sIDEwMCk7XG4gICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgbG9nLmVycm9yKCdbU2NyaXB0TWFuYWdlcl0g5ouW5ou96ISa5pys5Yiw5paH5Lu25aS55aSx6LSlOicsIGVycm9yKTtcbiAgICAgICAgICAgIHRvYXN0ci5lcnJvcihg56e75Yqo6ISa5pys5aSx6LSlOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKX1gKTtcblxuICAgICAgICAgICAgJGZvbGRlci5yZW1vdmVDbGFzcygnZm9sZGVyLWRyYWctdGFyZ2V0Jyk7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgYXdhaXQgdGhpcy5yZW5kZXJTY3JpcHRMaXN0cygpO1xuICAgICAgICAgICAgfSwgMTAwKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAkZm9sZGVyLnJlbW92ZUNsYXNzKCdmb2xkZXItZHJhZy10YXJnZXQnKTtcblxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9LFxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOWkhOeQhuiEmuacrOaLluaLveWIsOaWh+S7tuWkueeahOS6i+S7tlxuICAgKiBAcGFyYW0gc2NyaXB0SWQg6ISa5pysSURcbiAgICogQHBhcmFtIGZvbGRlcklkIOaWh+S7tuWkuUlEXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKiBAcGFyYW0gJGRyYWdnZWRFbGVtZW50IOaLluaLveeahOWFg+e0oFxuICAgKiBAcmV0dXJucyDmmK/lkKbmiJDlip/np7vliqjohJrmnKxcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgaGFuZGxlU2NyaXB0RHJvcFRvRm9sZGVyKFxuICAgIHNjcmlwdElkOiBzdHJpbmcsXG4gICAgZm9sZGVySWQ6IHN0cmluZyxcbiAgICB0eXBlOiBTY3JpcHRUeXBlLFxuICAgICRkcmFnZ2VkRWxlbWVudDogSlF1ZXJ5PEhUTUxFbGVtZW50PixcbiAgKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlcG9zaXRvcnkgPVxuICAgICAgICB0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTFxuICAgICAgICAgID8gdGhpcy5zY3JpcHRNYW5hZ2VyLmdldEdsb2JhbFJlcG9zaXRvcnlJdGVtcygpXG4gICAgICAgICAgOiB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0Q2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKCk7XG5cbiAgICAgIGNvbnN0IGZvbGRlciA9IHJlcG9zaXRvcnkuZmluZChpdGVtID0+IGl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicgJiYgaXRlbS5pZCA9PT0gZm9sZGVySWQpO1xuICAgICAgaWYgKGZvbGRlcikge1xuICAgICAgICBjb25zdCBzY3JpcHRzID0gZm9sZGVyLnZhbHVlIGFzIFNjcmlwdFtdO1xuICAgICAgICBjb25zdCBzY3JpcHRFeGlzdHMgPSBzY3JpcHRzLnNvbWUoc2NyaXB0ID0+IHNjcmlwdC5pZCA9PT0gc2NyaXB0SWQpO1xuXG4gICAgICAgIGlmIChzY3JpcHRFeGlzdHMpIHtcbiAgICAgICAgICB0b2FzdHIuaW5mbygn6ISa5pys5bey57uP5Zyo6K+l5paH5Lu25aS55LitJyk7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGF3YWl0IHRoaXMuc2NyaXB0TWFuYWdlci5tb3ZlU2NyaXB0VG9Gb2xkZXIoc2NyaXB0SWQsIGZvbGRlcklkLCB0eXBlKTtcblxuICAgICAgY29uc3QgJHRhcmdldEZvbGRlciA9ICQoYCMke2ZvbGRlcklkfWApO1xuICAgICAgY29uc3QgJGZvbGRlckNvbnRlbnQgPSAkdGFyZ2V0Rm9sZGVyLmZpbmQoJy5mb2xkZXItY29udGVudCcpO1xuXG4gICAgICBpZiAoISRmb2xkZXJDb250ZW50LmlzKCc6dmlzaWJsZScpKSB7XG4gICAgICAgICRmb2xkZXJDb250ZW50LnNob3coKTtcbiAgICAgICAgJHRhcmdldEZvbGRlci5maW5kKCcuZm9sZGVyLXRvZ2dsZScpLmFkZENsYXNzKCdleHBhbmRlZCcpO1xuICAgICAgfVxuXG4gICAgICAkZHJhZ2dlZEVsZW1lbnQuZGV0YWNoKCkucHJlcGVuZFRvKCRmb2xkZXJDb250ZW50KTtcblxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZy5lcnJvcignW1NjcmlwdE1hbmFnZXJdIOenu+WKqOiEmuacrOWIsOaWh+S7tuWkueWksei0pTonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5aSE55CG5ouW5ou957uT5p2f5LqL5Lu2XG4gICAqIEBwYXJhbSB1aSBqUXVlcnkgVUkg5ouW5ou95LqL5Lu25a+56LGhXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBoYW5kbGVEcmFnU3RvcCh0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlcG9zaXRvcnlJdGVtcyA9IGF3YWl0IHRoaXMuYnVpbGRSZXBvc2l0b3J5RnJvbURPTSh0eXBlKTtcblxuICAgICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5PUkRFUl9DSEFOR0VELCB7XG4gICAgICAgIGRhdGE6IHJlcG9zaXRvcnlJdGVtcyxcbiAgICAgICAgdHlwZSxcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2cuZXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSBoYW5kbGVEcmFnU3RvcDog5aSE55CG5ouW5ou957uT5p2f5aSx6LSlOicsIGVycm9yKTtcbiAgICB9XG4gIH1cbiAgLyoqXG4gICAqIOS7jkRPTeaehOW7uuS7k+W6k+e7k+aehFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgYnVpbGRSZXBvc2l0b3J5RnJvbURPTSh0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTxTY3JpcHRSZXBvc2l0b3J5SXRlbVtdPiB7XG4gICAgY29uc3QgbGlzdCA9ICQoZ2V0U2NyaXB0TGlzdFNlbGVjdG9yKHR5cGUpKTtcbiAgICBjb25zdCByZXBvc2l0b3J5OiBTY3JpcHRSZXBvc2l0b3J5SXRlbVtdID0gW107XG5cbiAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgbGlzdC5jaGlsZHJlbigpLmdldCgpKSB7XG4gICAgICBjb25zdCAkZWxlbWVudCA9ICQoZWxlbWVudCk7XG5cbiAgICAgIGlmICgkZWxlbWVudC5oYXNDbGFzcygnc2NyaXB0LWZvbGRlcicpKSB7XG4gICAgICAgIGNvbnN0IGZvbGRlcklkID0gJGVsZW1lbnQuYXR0cignaWQnKSE7XG4gICAgICAgIGNvbnN0IGZvbGRlck5hbWUgPSAkZWxlbWVudC5maW5kKCcuZm9sZGVyLW5hbWUnKS50ZXh0KCk7XG4gICAgICAgIGNvbnN0IGZvbGRlckljb24gPVxuICAgICAgICAgICRlbGVtZW50XG4gICAgICAgICAgICAuZmluZCgnLmZvbGRlci1pY29uIGknKVxuICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJylcbiAgICAgICAgICAgID8uc3BsaXQoJyAnKVxuICAgICAgICAgICAgLmZpbmQoY2xzID0+IGNscy5zdGFydHNXaXRoKCdmYS0nKSkgfHwgJ2ZhLWZvbGRlcic7XG4gICAgICAgIGNvbnN0IGZvbGRlckNvbG9yID1cbiAgICAgICAgICAkZWxlbWVudC5maW5kKCcuZm9sZGVyLWljb24nKS5jc3MoJ2NvbG9yJykgfHxcbiAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnLS1TbWFydFRoZW1lQm9keUNvbG9yJyk7XG5cbiAgICAgICAgY29uc3Qgc2NyaXB0czogU2NyaXB0W10gPSBbXTtcbiAgICAgICAgY29uc3QgJGZvbGRlckNvbnRlbnQgPSAkZWxlbWVudC5maW5kKCcuZm9sZGVyLWNvbnRlbnQnKTtcblxuICAgICAgICBmb3IgKGNvbnN0IHNjcmlwdEVsZW1lbnQgb2YgJGZvbGRlckNvbnRlbnQuY2hpbGRyZW4oJy5zY3JpcHQtaXRlbScpLmdldCgpKSB7XG4gICAgICAgICAgY29uc3Qgc2NyaXB0SWQgPSAkKHNjcmlwdEVsZW1lbnQpLmF0dHIoJ2lkJykhO1xuICAgICAgICAgIGNvbnN0IHNjcmlwdCA9IHRoaXMuc2NyaXB0TWFuYWdlci5nZXRTY3JpcHRCeUlkKHNjcmlwdElkKTtcbiAgICAgICAgICBpZiAoc2NyaXB0KSB7XG4gICAgICAgICAgICBzY3JpcHRzLnB1c2goc2NyaXB0KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXBvc2l0b3J5LnB1c2goe1xuICAgICAgICAgIHR5cGU6ICdmb2xkZXInLFxuICAgICAgICAgIGlkOiBmb2xkZXJJZCxcbiAgICAgICAgICBuYW1lOiBmb2xkZXJOYW1lLFxuICAgICAgICAgIGljb246IGZvbGRlckljb24sXG4gICAgICAgICAgY29sb3I6IGZvbGRlckNvbG9yLFxuICAgICAgICAgIHZhbHVlOiBzY3JpcHRzLFxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSBpZiAoJGVsZW1lbnQuaGFzQ2xhc3MoJ3NjcmlwdC1pdGVtJykpIHtcbiAgICAgICAgY29uc3Qgc2NyaXB0SWQgPSAkZWxlbWVudC5hdHRyKCdpZCcpITtcbiAgICAgICAgY29uc3Qgc2NyaXB0ID0gdGhpcy5zY3JpcHRNYW5hZ2VyLmdldFNjcmlwdEJ5SWQoc2NyaXB0SWQpO1xuICAgICAgICBpZiAoc2NyaXB0KSB7XG4gICAgICAgICAgcmVwb3NpdG9yeS5wdXNoKHtcbiAgICAgICAgICAgIHR5cGU6ICdzY3JpcHQnLFxuICAgICAgICAgICAgdmFsdWU6IHNjcmlwdCxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiByZXBvc2l0b3J5O1xuICB9XG5cbiAgLyoqXG4gICAqIOWFi+mahum7mOiupOiEmuacrOaooeadv1xuICAgKiBAcGFyYW0gc2NyaXB0IOiEmuacrFxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBjbG9uZURlZmF1bHRTY3JpcHRUZW1wbGF0ZShzY3JpcHQ6IFNjcmlwdCk6IFByb21pc2U8SlF1ZXJ5PEhUTUxFbGVtZW50Pj4ge1xuICAgIGlmICghdGhpcy5kZWZhdWx0U2NyaXB0VGVtcGxhdGUpIHtcbiAgICAgIGF3YWl0IHRoaXMuaW5pdGlhbGl6ZVRlbXBsYXRlcygpO1xuICAgIH1cblxuICAgIGNvbnN0IHNjcmlwdEh0bWwgPSB0aGlzLmRlZmF1bHRTY3JpcHRUZW1wbGF0ZSEuY2xvbmUoKTtcblxuICAgIGNvbnN0IHRlbXBJZCA9IGBkZWZhdWx0X2xpYl8ke3NjcmlwdC5pZH1gO1xuICAgIHNjcmlwdEh0bWwuYXR0cignaWQnLCB0ZW1wSWQpO1xuXG4gICAgc2NyaXB0SHRtbC5maW5kKCcuc2NyaXB0LWl0ZW0tbmFtZScpLnRleHQoc2NyaXB0Lm5hbWUpO1xuICAgIHNjcmlwdEh0bWwuZmluZCgnLnNjcmlwdC1pbmZvJykub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgY29uc3QgaHRtbFRleHQgPSByZW5kZXJNYXJrZG93bihzY3JpcHQuaW5mbyk7XG4gICAgICBjYWxsR2VuZXJpY1BvcHVwKGh0bWxUZXh0LCBQT1BVUF9UWVBFLkRJU1BMQVksIHVuZGVmaW5lZCwgeyB3aWRlOiB0cnVlIH0pO1xuICAgIH0pO1xuXG4gICAgc2NyaXB0SHRtbC5maW5kKCcuYWRkLXNjcmlwdCcpLm9uKCdjbGljaycsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCB0YXJnZXQ6IFNjcmlwdFR5cGUgPSBTY3JpcHRUeXBlLkdMT0JBTDtcbiAgICAgIGNvbnN0IHRlbXBsYXRlID0gJChcbiAgICAgICAgYXdhaXQgcmVuZGVyRXh0ZW5zaW9uVGVtcGxhdGVBc3luYyh0aGlzLnRlbXBsYXRlUGF0aCwgJ3NjcmlwdF90YXJnZXRfc2VsZWN0b3InLCB7XG4gICAgICAgICAgdGl0bGU6ICfmt7vliqDliLA6JyxcbiAgICAgICAgICBwcmVmaXg6ICdzY3JpcHQtYWRkJyxcbiAgICAgICAgICBnbG9iYWxMYWJlbDogJ+WFqOWxgOiEmuacrOW6kycsXG4gICAgICAgICAgY2hhcmFjdGVyTGFiZWw6ICfop5LoibLohJrmnKzlupMnLFxuICAgICAgICB9KSxcbiAgICAgICk7XG4gICAgICB0ZW1wbGF0ZS5maW5kKCcjc2NyaXB0LWFkZC10YXJnZXQtZ2xvYmFsJykub24oJ2lucHV0JywgKCkgPT4gKHRhcmdldCA9IFNjcmlwdFR5cGUuR0xPQkFMKSk7XG4gICAgICB0ZW1wbGF0ZS5maW5kKCcjc2NyaXB0LWFkZC10YXJnZXQtY2hhcmFjdGVyJykub24oJ2lucHV0JywgKCkgPT4gKHRhcmdldCA9IFNjcmlwdFR5cGUuQ0hBUkFDVEVSKSk7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjYWxsR2VuZXJpY1BvcHVwKHRlbXBsYXRlLCBQT1BVUF9UWVBFLkNPTkZJUk0sICcnLCB7XG4gICAgICAgIG9rQnV0dG9uOiAn56Gu6K6kJyxcbiAgICAgICAgY2FuY2VsQnV0dG9uOiAn5Y+W5raIJyxcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IG5ld1NjcmlwdCA9IG5ldyBTY3JpcHQoeyAuLi5zY3JpcHQsIGVuYWJsZWQ6IGZhbHNlIH0pO1xuXG4gICAgICBsZXQgYWN0aW9uOiAnbmV3JyB8ICdvdmVycmlkZScgfCAnY2FuY2VsJyA9ICduZXcnO1xuXG4gICAgICBjb25zdCBleGlzdGluZ19zY3JpcHQgPSB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0U2NyaXB0QnlJZChzY3JpcHQuaWQpO1xuICAgICAgaWYgKGV4aXN0aW5nX3NjcmlwdCkge1xuICAgICAgICBjb25zdCBpbnB1dCA9IGF3YWl0IGNhbGxHZW5lcmljUG9wdXAoXG4gICAgICAgICAgYOimgeWvvOWFpeeahOiEmuacrCAnJHtzY3JpcHQubmFtZX0nIOS4juiEmuacrOW6k+S4reeahCAnJHtleGlzdGluZ19zY3JpcHQubmFtZX0nIGlkIOebuOWQjO+8jOaYr+WQpuimgeWvvOWFpe+8n2AsXG4gICAgICAgICAgUE9QVVBfVFlQRS5URVhULFxuICAgICAgICAgICcnLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIG9rQnV0dG9uOiAn6KaG55uW5Y6f6ISa5pysJyxcbiAgICAgICAgICAgIGNhbmNlbEJ1dHRvbjogJ+WPlua2iCcsXG4gICAgICAgICAgICBjdXN0b21CdXR0b25zOiBbJ+aWsOW7uuiEmuacrCddLFxuICAgICAgICAgIH0sXG4gICAgICAgICk7XG5cbiAgICAgICAgc3dpdGNoIChpbnB1dCkge1xuICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIGFjdGlvbiA9ICdjYW5jZWwnO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgYWN0aW9uID0gJ292ZXJyaWRlJztcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgIGFjdGlvbiA9ICduZXcnO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgc3dpdGNoIChhY3Rpb24pIHtcbiAgICAgICAgY2FzZSAnbmV3JzpcbiAgICAgICAgICBpZiAoZXhpc3Rpbmdfc2NyaXB0KSB7XG4gICAgICAgICAgICBuZXdTY3JpcHQuaWQgPSB1dWlkdjQoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ292ZXJyaWRlJzpcbiAgICAgICAgICB7XG4gICAgICAgICAgICBpZiAoIWV4aXN0aW5nX3NjcmlwdCkge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICQoYCMke2V4aXN0aW5nX3NjcmlwdC5pZH1gKS5yZW1vdmUoKTtcblxuICAgICAgICAgICAgaWYgKGV4aXN0aW5nX3NjcmlwdC5lbmFibGVkKSB7XG4gICAgICAgICAgICAgIGF3YWl0IHRoaXMuc2NyaXB0TWFuYWdlci5zdG9wU2NyaXB0KGV4aXN0aW5nX3NjcmlwdCwgdGFyZ2V0KTtcbiAgICAgICAgICAgICAgdGhpcy5idXR0b25NYW5hZ2VyLnJlbW92ZUJ1dHRvbnNCeVNjcmlwdElkKGV4aXN0aW5nX3NjcmlwdC5pZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdjYW5jZWwnOlxuICAgICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5TQ1JJUFRfQ1JFQVRFLCB7IHNjcmlwdDogbmV3U2NyaXB0LCB0eXBlOiB0YXJnZXQgfSk7XG5cbiAgICAgIHRvYXN0ci5zdWNjZXNzKGDohJrmnKxcIiR7bmV3U2NyaXB0Lm5hbWV9XCLlt7Lmt7vliqDliLAke3RhcmdldCA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyAn5YWo5bGAJyA6ICfop5LoibInfeiEmuacrOW6k2ApO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHNjcmlwdEh0bWw7XG4gIH1cblxuICAvKipcbiAgICog5Yib5bu66buY6K6k6ISa5pys5bqT5a655ZmoXG4gICAqIOmBv+WFjemHjeWkjea4suafk+aooeadv1xuICAgKi9cbiAgcHJpdmF0ZSBjcmVhdGVEZWZhdWx0U2NyaXB0Q29udGFpbmVyKCk6IEpRdWVyeTxIVE1MRWxlbWVudD4ge1xuICAgIHJldHVybiAkKCc8ZGl2IGNsYXNzPVwiZGVmYXVsdC1zY3JpcHQtcmVwb3NpdG9yeS1jb250YWluZXJcIj48L2Rpdj4nKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDliqDovb3pu5jorqTohJrmnKzlupNcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgbG9hZERlZmF1bHRTY3JpcHRzUmVwb3NpdG9yeSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBjcmVhdGVEZWZhdWx0U2NyaXB0cyA9IChhd2FpdCBpbXBvcnQoJy4vYnVpbHRpbl9zY3JpcHRzJykpLmNyZWF0ZURlZmF1bHRTY3JpcHRzO1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IHRoaXMuY3JlYXRlRGVmYXVsdFNjcmlwdENvbnRhaW5lcigpO1xuXG4gICAgY29uc3QgZGVmYXVsdFNjcmlwdHMgPSBhd2FpdCBjcmVhdGVEZWZhdWx0U2NyaXB0cygpO1xuICAgIGZvciAoY29uc3Qgc2NyaXB0IG9mIGRlZmF1bHRTY3JpcHRzKSB7XG4gICAgICBpZiAoIXNjcmlwdCkgY29udGludWU7XG4gICAgICBjb25zdCBzY3JpcHRIdG1sID0gYXdhaXQgdGhpcy5jbG9uZURlZmF1bHRTY3JpcHRUZW1wbGF0ZShzY3JpcHQpO1xuICAgICAgY29udGFpbmVyLmFwcGVuZChzY3JpcHRIdG1sKTtcbiAgICB9XG5cbiAgICBhd2FpdCBjYWxsR2VuZXJpY1BvcHVwKGNvbnRhaW5lciwgUE9QVVBfVFlQRS5ESVNQTEFZLCAnJywgeyB3aWRlOiB0cnVlIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOaJk+W8gOiEmuacrOe8lui+keWZqFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICogQHBhcmFtIHNjcmlwdElkIOiEmuacrElEXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIG9wZW5TY3JpcHRFZGl0b3IodHlwZTogU2NyaXB0VHlwZSwgc2NyaXB0SWQ/OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCAkZWRpdG9ySHRtbCA9ICQoYXdhaXQgcmVuZGVyRXh0ZW5zaW9uVGVtcGxhdGVBc3luYyh0aGlzLnRlbXBsYXRlUGF0aCwgJ3NjcmlwdF9lZGl0b3InKSk7XG4gICAgbGV0IHNjcmlwdDogU2NyaXB0IHwgdW5kZWZpbmVkO1xuXG4gICAgdGhpcy51cGRhdGVWYXJpYWJsZUxpc3RWaXNpYmlsaXR5KCRlZGl0b3JIdG1sKTtcblxuICAgIGlmIChzY3JpcHRJZCkge1xuICAgICAgc2NyaXB0ID0gdGhpcy5zY3JpcHRNYW5hZ2VyLmdldFNjcmlwdEJ5SWQoc2NyaXB0SWQpO1xuXG4gICAgICBpZiAoc2NyaXB0KSB7XG4gICAgICAgICRlZGl0b3JIdG1sLmZpbmQoJyNzY3JpcHQtbmFtZS1pbnB1dCcpLnZhbChzY3JpcHQubmFtZSk7XG4gICAgICAgICRlZGl0b3JIdG1sLmZpbmQoJyNzY3JpcHQtY29udGVudC10ZXh0YXJlYScpLnZhbChzY3JpcHQuY29udGVudCk7XG4gICAgICAgICRlZGl0b3JIdG1sLmZpbmQoJyNzY3JpcHQtaW5mby10ZXh0YXJlYScpLnZhbChzY3JpcHQuaW5mbyk7XG5cbiAgICAgICAgaWYgKHNjcmlwdC5kYXRhICYmIE9iamVjdC5rZXlzKHNjcmlwdC5kYXRhKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgdGhpcy5sb2FkVmFyaWFibGVzVG9FZGl0b3IoJGVkaXRvckh0bWwsIHNjcmlwdC5kYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChzY3JpcHQuYnV0dG9ucyAmJiBzY3JpcHQuYnV0dG9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgc2NyaXB0LmJ1dHRvbnMuZm9yRWFjaCgoYnV0dG9uLCBidXR0b25JbmRleCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgJGJ1dHRvbkh0bWwgPSAkKGBcbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImJ1dHRvbi1pdGVtXCIgaWQ9XCJidXR0b24tJHtidXR0b25JbmRleH1cIj5cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImRyYWctaGFuZGxlIG1lbnUtaGFuZGxlXCI+4piwPC9zcGFuPlxuICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBpZD1cImNoZWNrYm94LWJ1dHRvbi0ke2J1dHRvbkluZGV4fVwiIGNsYXNzPVwiYnV0dG9uLXZpc2libGVcIiAke1xuICAgICAgICAgICAgICBidXR0b24udmlzaWJsZSA/ICdjaGVja2VkJyA6ICcnXG4gICAgICAgICAgICB9PlxuICAgICAgICAgICAgICAgIDxpbnB1dCBjbGFzcz1cInRleHRfcG9sZSBidXR0b24tbmFtZVwiIHR5cGU9XCJ0ZXh0XCIgaWQ9XCJ0ZXh0LWJ1dHRvbi0ke2J1dHRvbkluZGV4fVwiIHZhbHVlPVwiJHtcbiAgICAgICAgICAgICAgYnV0dG9uLm5hbWVcbiAgICAgICAgICAgIH1cIiBwbGFjZWhvbGRlcj1cIuaMiemSruWQjeensFwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJkZWxldGUtYnV0dG9uIG1lbnVfYnV0dG9uIGludGVyYWN0YWJsZVwiIGRhdGEtaW5kZXg9XCIke2J1dHRvbkluZGV4fVwiPlxuICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9XCJmYS1zb2xpZCBmYS10cmFzaFwiPjwvaT5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICBgKTtcblxuICAgICAgICAgICAgJGVkaXRvckh0bWwuZmluZCgnLmJ1dHRvbi1saXN0JykuYXBwZW5kKCRidXR0b25IdG1sKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgICRlZGl0b3JIdG1sLmZpbmQoJyNhZGQtdmFyaWFibGUtdHJpZ2dlcicpLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuYWRkVmFyaWFibGVUb0VkaXRvcigkZWRpdG9ySHRtbCk7XG4gICAgfSk7XG5cbiAgICAkZWRpdG9ySHRtbC5maW5kKCcjYWRkLWJ1dHRvbi10cmlnZ2VyJykub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgY29uc3QgYnV0dG9uSW5kZXggPSAkZWRpdG9ySHRtbC5maW5kKCcuYnV0dG9uLWxpc3QgLmJ1dHRvbi1pdGVtJykubGVuZ3RoO1xuICAgICAgY29uc3QgYnV0dG9uSWQgPSBgYnV0dG9uLSR7YnV0dG9uSW5kZXh9YDtcbiAgICAgIGNvbnN0ICRidXR0b25Db250ZW50ID0gJChgPGRpdiBjbGFzcz1cImJ1dHRvbi1pdGVtXCIgaWQ9XCIke2J1dHRvbklkfVwiPlxuICAgICAgICA8c3BhbiBjbGFzcz1cImRyYWctaGFuZGxlIG1lbnUtaGFuZGxlXCI+4piwPC9zcGFuPlxuICAgICAgICA8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgaWQ9XCJjaGVja2JveC0ke2J1dHRvbklkfVwiIGNsYXNzPVwiYnV0dG9uLXZpc2libGVcIiBjaGVja2VkPlxuICAgICAgICA8aW5wdXQgY2xhc3M9XCJ0ZXh0X3BvbGUgYnV0dG9uLW5hbWVcIiB0eXBlPVwidGV4dFwiIGlkPVwidGV4dC0ke2J1dHRvbklkfVwiIHBsYWNlaG9sZGVyPVwi5oyJ6ZKu5ZCN56ewXCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJkZWxldGUtYnV0dG9uIG1lbnVfYnV0dG9uIGludGVyYWN0YWJsZVwiIGRhdGEtaW5kZXg9XCIke2J1dHRvbkluZGV4fVwiPlxuICAgICAgICAgIDxpIGNsYXNzPVwiZmEtc29saWQgZmEtdHJhc2hcIj48L2k+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+YCk7XG4gICAgICAkZWRpdG9ySHRtbC5maW5kKCcuYnV0dG9uLWxpc3QnKS5hcHBlbmQoJGJ1dHRvbkNvbnRlbnQpO1xuICAgIH0pO1xuXG4gICAgJGVkaXRvckh0bWwuZmluZCgnI3NjcmlwdC1idXR0b24tY29udGVudCAuYnV0dG9uLWxpc3QnKS5zb3J0YWJsZSh7XG4gICAgICBoYW5kbGU6ICcuZHJhZy1oYW5kbGUnLFxuICAgICAgaXRlbXM6ICcuYnV0dG9uLWl0ZW0nLFxuICAgIH0pO1xuXG4gICAgJGVkaXRvckh0bWwub24oJ2NsaWNrJywgJy5kZWxldGUtYnV0dG9uJywgKGU6IEpRdWVyeS5DbGlja0V2ZW50KSA9PiB7XG4gICAgICAkKGUuY3VycmVudFRhcmdldCkuY2xvc2VzdCgnLmJ1dHRvbi1pdGVtJykucmVtb3ZlKCk7XG4gICAgfSk7XG5cbiAgICAkZWRpdG9ySHRtbC5vbignY2xpY2snLCAnLmRlbGV0ZS12YXJpYWJsZScsIChlOiBKUXVlcnkuQ2xpY2tFdmVudCkgPT4ge1xuICAgICAgJChlLmN1cnJlbnRUYXJnZXQpLmNsb3Nlc3QoJy52YXJpYWJsZS1pdGVtJykucmVtb3ZlKCk7XG4gICAgICB0aGlzLnVwZGF0ZVZhcmlhYmxlTGlzdFZpc2liaWxpdHkoJGVkaXRvckh0bWwpO1xuICAgIH0pO1xuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2FsbEdlbmVyaWNQb3B1cCgkZWRpdG9ySHRtbCwgUE9QVVBfVFlQRS5DT05GSVJNLCAnJywge1xuICAgICAgd2lkZTogdHJ1ZSxcbiAgICAgIG9rQnV0dG9uOiAn5L+d5a2YJyxcbiAgICAgIGNhbmNlbEJ1dHRvbjogJ+WPlua2iCcsXG4gICAgfSk7XG5cbiAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHNjcmlwdE5hbWUgPSBTdHJpbmcoJGVkaXRvckh0bWwuZmluZCgnI3NjcmlwdC1uYW1lLWlucHV0JykudmFsKCkpO1xuICAgIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBTdHJpbmcoJGVkaXRvckh0bWwuZmluZCgnI3NjcmlwdC1jb250ZW50LXRleHRhcmVhJykudmFsKCkpO1xuICAgIGNvbnN0IHNjcmlwdEluZm8gPSBTdHJpbmcoJGVkaXRvckh0bWwuZmluZCgnI3NjcmlwdC1pbmZvLXRleHRhcmVhJykudmFsKCkpO1xuXG4gICAgY29uc3QgdmFyaWFibGVEYXRhID0gdGhpcy5jb2xsZWN0VmFyaWFibGVzRnJvbUVkaXRvcigkZWRpdG9ySHRtbCk7XG5cbiAgICBjb25zdCBidXR0b25zOiB7IG5hbWU6IHN0cmluZzsgdmlzaWJsZTogYm9vbGVhbiB9W10gPSBbXTtcbiAgICAkZWRpdG9ySHRtbC5maW5kKCcuYnV0dG9uLWxpc3QgLmJ1dHRvbi1pdGVtJykuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCBidXR0b25OYW1lID0gJCh0aGlzKS5maW5kKCcuYnV0dG9uLW5hbWUnKS52YWwoKSBhcyBzdHJpbmc7XG4gICAgICBjb25zdCB2aXNpYmxlID0gJCh0aGlzKS5maW5kKCcuYnV0dG9uLXZpc2libGUnKS5wcm9wKCdjaGVja2VkJykgYXMgYm9vbGVhbjtcbiAgICAgIGlmIChidXR0b25OYW1lICYmIGJ1dHRvbk5hbWUudHJpbSgpICE9PSAnJykge1xuICAgICAgICBidXR0b25zLnB1c2goeyBuYW1lOiBidXR0b25OYW1lLCB2aXNpYmxlIH0pO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaWYgKCFzY3JpcHQpIHtcbiAgICAgIHNjcmlwdCA9IG5ldyBTY3JpcHQoe1xuICAgICAgICBpZDogdXVpZHY0KCksXG4gICAgICAgIG5hbWU6IHNjcmlwdE5hbWUsXG4gICAgICAgIGNvbnRlbnQ6IHNjcmlwdENvbnRlbnQsXG4gICAgICAgIGluZm86IHNjcmlwdEluZm8sXG4gICAgICAgIGVuYWJsZWQ6IGZhbHNlLFxuICAgICAgICBidXR0b25zLFxuICAgICAgICBkYXRhOiB2YXJpYWJsZURhdGEsXG4gICAgICB9KTtcblxuICAgICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5TQ1JJUFRfQ1JFQVRFLCB7IHNjcmlwdCwgdHlwZSB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3Qgd2FzRW5hYmxlZCA9IHNjcmlwdC5lbmFibGVkO1xuXG4gICAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLkJVVFRPTl9SRU1PVkUsIHsgc2NyaXB0SWQ6IHNjcmlwdC5pZCB9KTtcblxuICAgICAgc2NyaXB0Lm5hbWUgPSBzY3JpcHROYW1lO1xuICAgICAgc2NyaXB0LmNvbnRlbnQgPSBzY3JpcHRDb250ZW50O1xuICAgICAgc2NyaXB0LmluZm8gPSBzY3JpcHRJbmZvO1xuICAgICAgc2NyaXB0LmJ1dHRvbnMgPSBidXR0b25zO1xuICAgICAgc2NyaXB0LmRhdGEgPSB2YXJpYWJsZURhdGE7XG5cbiAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuU0NSSVBUX1VQREFURSwgeyBzY3JpcHQsIHR5cGUgfSk7XG5cbiAgICAgIGlmICh3YXNFbmFibGVkKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5zY3JpcHRNYW5hZ2VyLnN0b3BTY3JpcHQoc2NyaXB0LCB0eXBlKTtcbiAgICAgICAgICBhd2FpdCB0aGlzLnNjcmlwdE1hbmFnZXIucnVuU2NyaXB0KHNjcmlwdCwgdHlwZSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgbG9nLmVycm9yKGBbU2NyaXB0TWFuYWdlcl0g6YeN5ZCv6ISa5pys5aSx6LSlOiAke3NjcmlwdC5uYW1lfWAsIGVycm9yKTtcbiAgICAgICAgICB0b2FzdHIuZXJyb3IoYOmHjeWQr+iEmuacrOWksei0pTogJHtzY3JpcHQubmFtZX1gKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDlsIblj5jph4/mlbDmja7liqDovb3liLDnvJbovpHlmajkuK1cbiAgICogQHBhcmFtICRlZGl0b3JIdG1sIOe8lui+keWZqEhUTUzlhYPntKBcbiAgICogQHBhcmFtIGRhdGEg5Y+Y6YeP5pWw5o2uXG4gICAqL1xuICBwcml2YXRlIGxvYWRWYXJpYWJsZXNUb0VkaXRvcigkZWRpdG9ySHRtbDogSlF1ZXJ5PEhUTUxFbGVtZW50PiwgZGF0YTogeyBba2V5OiBzdHJpbmddOiBhbnkgfSk6IHZvaWQge1xuICAgIGNvbnN0ICR2YXJpYWJsZUxpc3QgPSAkZWRpdG9ySHRtbC5maW5kKCcjdmFyaWFibGUtbGlzdCcpO1xuXG4gICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoZGF0YSkpIHtcbiAgICAgIGNvbnN0ICR2YXJpYWJsZUl0ZW0gPSB0aGlzLmNyZWF0ZVZhcmlhYmxlSXRlbShrZXksIHZhbHVlKTtcbiAgICAgICR2YXJpYWJsZUxpc3QuYXBwZW5kKCR2YXJpYWJsZUl0ZW0pO1xuICAgIH1cblxuICAgIHRoaXMudXBkYXRlVmFyaWFibGVMaXN0VmlzaWJpbGl0eSgkZWRpdG9ySHRtbCk7XG4gIH1cblxuICAvKipcbiAgICog5re75Yqg5paw5Y+Y6YeP5Yiw57yW6L6R5ZmoXG4gICAqIEBwYXJhbSAkZWRpdG9ySHRtbCDnvJbovpHlmahIVE1M5YWD57SgXG4gICAqL1xuICBwcml2YXRlIGFkZFZhcmlhYmxlVG9FZGl0b3IoJGVkaXRvckh0bWw6IEpRdWVyeTxIVE1MRWxlbWVudD4pOiB2b2lkIHtcbiAgICBjb25zdCAkdmFyaWFibGVMaXN0ID0gJGVkaXRvckh0bWwuZmluZCgnI3ZhcmlhYmxlLWxpc3QnKTtcbiAgICBjb25zdCAkdmFyaWFibGVJdGVtID0gdGhpcy5jcmVhdGVWYXJpYWJsZUl0ZW0oJycsICcnKTtcbiAgICAkdmFyaWFibGVMaXN0LmFwcGVuZCgkdmFyaWFibGVJdGVtKTtcblxuICAgIHRoaXMudXBkYXRlVmFyaWFibGVMaXN0VmlzaWJpbGl0eSgkZWRpdG9ySHRtbCk7XG4gIH1cblxuICAvKipcbiAgICog5pu05paw5Y+Y6YeP5YiX6KGo55qE5Y+v6KeB5oCnXG4gICAqIEBwYXJhbSAkZWRpdG9ySHRtbCDnvJbovpHlmahIVE1M5YWD57SgXG4gICAqL1xuICBwcml2YXRlIHVwZGF0ZVZhcmlhYmxlTGlzdFZpc2liaWxpdHkoJGVkaXRvckh0bWw6IEpRdWVyeTxIVE1MRWxlbWVudD4pOiB2b2lkIHtcbiAgICBjb25zdCAkdmFyaWFibGVMaXN0ID0gJGVkaXRvckh0bWwuZmluZCgnI3ZhcmlhYmxlLWxpc3QnKTtcbiAgICBjb25zdCB2YXJpYWJsZUNvdW50ID0gJHZhcmlhYmxlTGlzdC5maW5kKCcudmFyaWFibGUtaXRlbScpLmxlbmd0aDtcblxuICAgIGlmICh2YXJpYWJsZUNvdW50ID09PSAwKSB7XG4gICAgICAkdmFyaWFibGVMaXN0LmhpZGUoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgJHZhcmlhYmxlTGlzdC5zaG93KCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWIm+W7uuWPmOmHj+mhueWFg+e0oFxuICAgKiBAcGFyYW0ga2V5IOWPmOmHj+mUrlxuICAgKiBAcGFyYW0gdmFsdWUg5Y+Y6YeP5YC8XG4gICAqIEByZXR1cm5zIEpRdWVyeeWFg+e0oFxuICAgKi9cbiAgcHJpdmF0ZSBjcmVhdGVWYXJpYWJsZUl0ZW0oa2V5OiBzdHJpbmcsIHZhbHVlOiBhbnkpOiBKUXVlcnk8SFRNTEVsZW1lbnQ+IHtcbiAgICBjb25zdCB2YWx1ZVN0ciA9IHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgPyB2YWx1ZSA6IEpTT04uc3RyaW5naWZ5KHZhbHVlKTtcblxuICAgIGNvbnN0ICR2YXJpYWJsZUl0ZW0gPSAkKGBcbiAgICAgIDxkaXYgY2xhc3M9XCJ2YXJpYWJsZS1pdGVtIGZsZXgtY29udGFpbmVyIGZsZXhGbG93Q29sdW1uIHdpZHRoMTAwcFwiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwiZmxleCBmbGV4Rmxvd0NvbHVtblwiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwiZmxleC1jb250YWluZXIgYWxpZ25pdGVtc2NlbnRlciBzcGFjZUJldHdlZW4gd2lkZTEwMHBcIj5cbiAgICAgICAgICA8ZGl2PuWQjeensDo8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwibWVudV9idXR0b24gaW50ZXJhY3RhYmxlIGRlbGV0ZS12YXJpYWJsZVwiIHRpdGxlPVwi5Yig6Zmk5Y+Y6YePXCI+XG4gICAgICAgICAgICA8aSBjbGFzcz1cImZhLXNvbGlkIGZhLXRyYXNoXCI+PC9pPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIGNsYXNzPVwidGV4dF9wb2xlIHZhcmlhYmxlLWtleVwiIHZhbHVlPVwiJHt0aGlzLmVzY2FwZUh0bWwoa2V5KX1cIiBwbGFjZWhvbGRlcj1cIuWPmOmHj+WQjVwiPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImZsZXggZmxleEZsb3dDb2x1bW5cIiBzdHlsZT1cImFsaWduLWl0ZW1zOiBmbGV4LXN0YXJ0O1wiPlxuICAgICAgICAgIDxkaXY+5YC8OjwvZGl2PlxuICAgICAgICAgIDx0ZXh0YXJlYSBjbGFzcz1cInRleHRfcG9sZSB2YXJpYWJsZS12YWx1ZVwiIHN0eWxlPVwibWluLWhlaWdodDogMTJweDtcIiByb3dzPVwiMVwiIHBsYWNlaG9sZGVyPVwi5Y+Y6YeP5YC8XCI+JHt0aGlzLmVzY2FwZUh0bWwoXG4gICAgICAgICAgICB2YWx1ZVN0cixcbiAgICAgICAgICApfTwvdGV4dGFyZWE+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPGhyPlxuICAgICAgPC9kaXY+XG4gICAgYCk7XG5cbiAgICByZXR1cm4gJHZhcmlhYmxlSXRlbTtcbiAgfVxuXG4gIC8qKlxuICAgKiDku47nvJbovpHlmajmlLbpm4blj5jph4/mlbDmja5cbiAgICogQHBhcmFtICRlZGl0b3JIdG1sIOe8lui+keWZqEhUTUzlhYPntKBcbiAgICogQHJldHVybnMg5Y+Y6YeP5pWw5o2u5a+56LGhXG4gICAqL1xuICBwcml2YXRlIGNvbGxlY3RWYXJpYWJsZXNGcm9tRWRpdG9yKCRlZGl0b3JIdG1sOiBKUXVlcnk8SFRNTEVsZW1lbnQ+KTogeyBba2V5OiBzdHJpbmddOiBhbnkgfSB7XG4gICAgY29uc3QgdmFyaWFibGVzOiB7IFtrZXk6IHN0cmluZ106IGFueSB9ID0ge307XG5cbiAgICAkZWRpdG9ySHRtbC5maW5kKCcjdmFyaWFibGUtbGlzdCAudmFyaWFibGUtaXRlbScpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3Qga2V5ID0gJCh0aGlzKS5maW5kKCcudmFyaWFibGUta2V5JykudmFsKCkgYXMgc3RyaW5nO1xuICAgICAgY29uc3QgdmFsdWVTdHIgPSAkKHRoaXMpLmZpbmQoJy52YXJpYWJsZS12YWx1ZScpLnZhbCgpIGFzIHN0cmluZztcblxuICAgICAgaWYgKGtleSAmJiBrZXkudHJpbSgpICE9PSAnJykge1xuICAgICAgICBsZXQgdmFsdWU6IGFueTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICB2YWx1ZSA9IEpTT04ucGFyc2UodmFsdWVTdHIpO1xuICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICB2YWx1ZSA9IHZhbHVlU3RyO1xuICAgICAgICB9XG4gICAgICAgIHZhcmlhYmxlc1trZXkudHJpbSgpXSA9IHZhbHVlO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHZhcmlhYmxlcztcbiAgfVxuXG4gIC8qKlxuICAgKiBIVE1M6L2s5LmJ6L6F5Yqp5Ye95pWwXG4gICAqIEBwYXJhbSB0ZXh0IOimgei9rOS5ieeahOaWh+acrFxuICAgKiBAcmV0dXJucyDovazkuYnlkI7nmoTmlofmnKxcbiAgICovXG4gIHByaXZhdGUgZXNjYXBlSHRtbCh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGRpdi50ZXh0Q29udGVudCA9IHRleHQ7XG4gICAgcmV0dXJuIGRpdi5pbm5lckhUTUw7XG4gIH1cblxuICAvKipcbiAgICog5qOA5p+l6KeS6Imy5Lit55qE5bWM5YWl5byP6ISa5pysXG4gICAqIEBwYXJhbSBjaGFyYWN0ZXJJZCDop5LoibJpZFxuICAgKiBAcGFyYW0gZW5hYmxlYWJsZVNjcmlwdHMg5Y+v5ZCv55So55qE6ISa5pys5YiX6KGoXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgY2hlY2tFbWJlZGRlZFNjcmlwdHMoY2hhcmFjdGVySWQ6IGFueSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGNoYXJhY3RlcnNXaXRoU2NyaXB0cyA9IGdldFNldHRpbmdWYWx1ZSgnc2NyaXB0LmNoYXJhY3RlcnNfd2l0aF9zY3JpcHRzJykgfHwgW107XG4gICAgY29uc3QgYXZhdGFyID0gY2hhcmFjdGVyc1tjaGFyYWN0ZXJJZF0/LmF2YXRhcjtcbiAgICBpZiAoY2hhcmFjdGVyc1dpdGhTY3JpcHRzLmluY2x1ZGVzKGF2YXRhcikpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgY2hlY2tLZXkgPSBgQWxlcnRTY3JpcHRfJHthdmF0YXJ9YDtcbiAgICBpZiAoIWxvY2FsU3RvcmFnZS5nZXRJdGVtKGNoZWNrS2V5KSkge1xuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oY2hlY2tLZXksICd0cnVlJyk7XG4gICAgICBjb25zdCB0ZW1wbGF0ZSA9IGF3YWl0IHJlbmRlckV4dGVuc2lvblRlbXBsYXRlQXN5bmMoXG4gICAgICAgIGAke2V4dGVuc2lvbkZvbGRlclBhdGh9L3NyYy9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvcHVibGljYCxcbiAgICAgICAgJ3NjcmlwdF9hbGxvd19wb3B1cCcsXG4gICAgICApO1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2FsbEdlbmVyaWNQb3B1cCh0ZW1wbGF0ZSwgUE9QVVBfVFlQRS5DT05GSVJNLCAnJywge1xuICAgICAgICBva0J1dHRvbjogJ+ehruiupCcsXG4gICAgICAgIGNhbmNlbEJ1dHRvbjogJ+WPlua2iCcsXG4gICAgICB9KTtcblxuICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICBpZiAoYXZhdGFyICYmICFjaGFyYWN0ZXJzV2l0aFNjcmlwdHMuaW5jbHVkZXMoYXZhdGFyKSkge1xuICAgICAgICAgIGNoYXJhY3RlcnNXaXRoU2NyaXB0cy5wdXNoKGF2YXRhcik7XG4gICAgICAgICAgc2F2ZVNldHRpbmdWYWx1ZSgnc2NyaXB0LmNoYXJhY3RlcnNfd2l0aF9zY3JpcHRzJywgY2hhcmFjdGVyc1dpdGhTY3JpcHRzKTtcbiAgICAgICAgfVxuXG4gICAgICAgICQoJyNjaGFyYWN0ZXItc2NyaXB0LWVuYWJsZS10b2dnbGUnKS5wcm9wKCdjaGVja2VkJywgdHJ1ZSk7XG5cbiAgICAgICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5UWVBFX1RPR0dMRSwge1xuICAgICAgICAgIHR5cGU6IFNjcmlwdFR5cGUuQ0hBUkFDVEVSLFxuICAgICAgICAgIGVuYWJsZTogdHJ1ZSxcbiAgICAgICAgICB1c2VySW5wdXQ6IGZhbHNlLFxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICQoJyNjaGFyYWN0ZXItc2NyaXB0LWVuYWJsZS10b2dnbGUnKS5wcm9wKCdjaGVja2VkJywgZmFsc2UpO1xuXG4gICAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuVFlQRV9UT0dHTEUsIHtcbiAgICAgICAgICB0eXBlOiBTY3JpcHRUeXBlLkNIQVJBQ1RFUixcbiAgICAgICAgICBlbmFibGU6IGZhbHNlLFxuICAgICAgICAgIHVzZXJJbnB1dDogZmFsc2UsXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmuLLmn5PljZXkuKrmlofku7blpLlcbiAgICogQHBhcmFtIGZvbGRlckl0ZW0g5paH5Lu25aS56aG5XG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyByZW5kZXJGb2xkZXIoZm9sZGVySXRlbTogU2NyaXB0UmVwb3NpdG9yeUl0ZW0sIHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBjb250YWluZXIgPSAkKGdldFNjcmlwdExpc3RTZWxlY3Rvcih0eXBlKSk7XG4gICAgaWYgKCF0aGlzLmZvbGRlclRlbXBsYXRlKSB7XG4gICAgICBhd2FpdCB0aGlzLmluaXRpYWxpemVUZW1wbGF0ZXMoKTtcbiAgICB9XG5cbiAgICBjb25zdCBmb2xkZXJJZCA9IGZvbGRlckl0ZW0uaWQhO1xuICAgIGNvbnN0IGZvbGRlck5hbWUgPSBmb2xkZXJJdGVtLm5hbWUhO1xuICAgIGNvbnN0IGZvbGRlckljb24gPSBmb2xkZXJJdGVtLmljb24gfHwgJ2ZhLWZvbGRlcic7XG4gICAgY29uc3QgZm9sZGVyQ29sb3IgPSBmb2xkZXJJdGVtLmNvbG9yIHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCctLVNtYXJ0VGhlbWVCb2R5Q29sb3InKTtcblxuICAgIGNvbnN0IG1vdmVJY29uID0gdHlwZSA9PT0gJ2dsb2JhbCcgPyAnZmEtYXJyb3ctZG93bicgOiAnZmEtYXJyb3ctdXAnO1xuICAgIGNvbnN0IG1vdmVDbGFzcyA9IHR5cGUgPT09ICdnbG9iYWwnID8gJ21vdmUtdG8tY2hhcmFjdGVyJyA6ICdtb3ZlLXRvLWdsb2JhbCc7XG4gICAgY29uc3QgbW92ZVRpdGxlID0gdHlwZSA9PT0gJ2dsb2JhbCcgPyAn56e75Yqo5Yiw6KeS6Imy6ISa5pys5bqTJyA6ICfnp7vliqjliLDlhajlsYDohJrmnKzlupMnO1xuXG4gICAgY29uc3QgZm9sZGVySHRtbCA9ICQoXG4gICAgICBhd2FpdCByZW5kZXJFeHRlbnNpb25UZW1wbGF0ZUFzeW5jKHRoaXMudGVtcGxhdGVQYXRoLCAnZm9sZGVyX3RlbXBsYXRlJywge1xuICAgICAgICBmb2xkZXJJZCxcbiAgICAgICAgZm9sZGVyTmFtZSxcbiAgICAgICAgZm9sZGVySWNvbixcbiAgICAgICAgZm9sZGVyQ29sb3IsXG4gICAgICAgIG1vdmVJY29uLFxuICAgICAgICBtb3ZlQ2xhc3MsXG4gICAgICAgIG1vdmVUaXRsZSxcbiAgICAgIH0pLFxuICAgICk7XG5cbiAgICB0aGlzLmJpbmRGb2xkZXJFdmVudHMoZm9sZGVySHRtbCwgZm9sZGVySWQsIGZvbGRlckNvbG9yLCB0eXBlKTtcblxuICAgIGNvbnN0IHNjcmlwdHMgPSBmb2xkZXJJdGVtLnZhbHVlIGFzIFNjcmlwdFtdO1xuICAgIGNvbnN0IGZvbGRlckNvbnRlbnQgPSBmb2xkZXJIdG1sLmZpbmQoJy5mb2xkZXItY29udGVudCcpO1xuICAgIGZvciAoY29uc3Qgc2NyaXB0IG9mIHNjcmlwdHMpIHtcbiAgICAgIGNvbnN0IHNjcmlwdEVsZW1lbnQgPSBhd2FpdCB0aGlzLmNyZWF0ZVNjcmlwdEVsZW1lbnQoc2NyaXB0LCB0eXBlKTtcbiAgICAgIGZvbGRlckNvbnRlbnQuYXBwZW5kKHNjcmlwdEVsZW1lbnQpO1xuICAgIH1cblxuICAgIGNvbnRhaW5lci5hcHBlbmQoZm9sZGVySHRtbCk7XG5cbiAgICB0aGlzLnNldHVwRm9sZGVyRHJhZ2dhYmxlKHR5cGUpO1xuXG4gICAgdGhpcy5zZXR1cFNpbmdsZUZvbGRlckRyb3Bab25lKGZvbGRlckh0bWwsIHR5cGUpO1xuICB9XG5cbiAgLyoqXG4gICAqIOe7keWumuaWh+S7tuWkueebuOWFs+S6i+S7tuWSjOiuvue9ruWbvuagh+minOiJslxuICAgKiBAcGFyYW0gZm9sZGVySHRtbCDmlofku7blpLlIVE1M5YWD57SgXG4gICAqIEBwYXJhbSBmb2xkZXJJZCDmlofku7blpLlJRFxuICAgKiBAcGFyYW0gZm9sZGVyQ29sb3Ig5paH5Lu25aS56aKc6ImyXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBiaW5kRm9sZGVyRXZlbnRzKFxuICAgIGZvbGRlckh0bWw6IEpRdWVyeTxIVE1MRWxlbWVudD4sXG4gICAgZm9sZGVySWQ6IHN0cmluZyxcbiAgICBmb2xkZXJDb2xvcjogc3RyaW5nLFxuICAgIHR5cGU6IFNjcmlwdFR5cGUsXG4gICk6IHZvaWQge1xuICAgIGZvbGRlckh0bWwuZmluZCgnLmZvbGRlci1oZWFkZXInKS5vbignY2xpY2snLCBlID0+IHtcbiAgICAgIGlmICgkKGUudGFyZ2V0KS5jbG9zZXN0KCcuZm9sZGVyLWNvbnRyb2wnKS5sZW5ndGggPiAwKSByZXR1cm47XG4gICAgICBpZiAoJChlLnRhcmdldCkuY2xvc2VzdCgnLmZvbGRlci1jaGVja2JveCcpLmxlbmd0aCA+IDAgfHwgJChlLnRhcmdldCkuaGFzQ2xhc3MoJ2ZvbGRlci1jaGVja2JveCcpKSByZXR1cm47XG5cbiAgICAgIGNvbnN0IGNvbnRlbnQgPSBmb2xkZXJIdG1sLmZpbmQoJy5mb2xkZXItY29udGVudCcpO1xuICAgICAgY29uc3QgdG9nZ2xlID0gZm9sZGVySHRtbC5maW5kKCcuZm9sZGVyLXRvZ2dsZScpO1xuXG4gICAgICBpZiAoY29udGVudC5pcygnOnZpc2libGUnKSkge1xuICAgICAgICBjb250ZW50LnNsaWRlVXAoKTtcbiAgICAgICAgdG9nZ2xlLnJlbW92ZUNsYXNzKCdleHBhbmRlZCcpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29udGVudC5zbGlkZURvd24oKTtcbiAgICAgICAgdG9nZ2xlLmFkZENsYXNzKCdleHBhbmRlZCcpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgY29uc3QgJGZvbGRlclRvZ2dsZSA9IGZvbGRlckh0bWwuZmluZCgnLmZvbGRlci1zY3JpcHQtdG9nZ2xlJyk7XG4gICAgJGZvbGRlclRvZ2dsZS5vbignY2xpY2snLCBlID0+IHtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgIGNvbnN0IGlzRW5hYmxlZCA9ICRmb2xkZXJUb2dnbGUuaGFzQ2xhc3MoJ2VuYWJsZWQnKTtcbiAgICAgIGNvbnN0IG5ld1N0YXRlID0gIWlzRW5hYmxlZDtcblxuICAgICAgaWYgKG5ld1N0YXRlKSB7XG4gICAgICAgICRmb2xkZXJUb2dnbGUuYWRkQ2xhc3MoJ2VuYWJsZWQnKTtcbiAgICAgICAgJGZvbGRlclRvZ2dsZS5maW5kKCdpLmZhLXRvZ2dsZS1vZmYnKS5oaWRlKCk7XG4gICAgICAgICRmb2xkZXJUb2dnbGUuZmluZCgnaS5mYS10b2dnbGUtb24nKS5zaG93KCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkZm9sZGVyVG9nZ2xlLnJlbW92ZUNsYXNzKCdlbmFibGVkJyk7XG4gICAgICAgICRmb2xkZXJUb2dnbGUuZmluZCgnaS5mYS10b2dnbGUtb2ZmJykuc2hvdygpO1xuICAgICAgICAkZm9sZGVyVG9nZ2xlLmZpbmQoJ2kuZmEtdG9nZ2xlLW9uJykuaGlkZSgpO1xuICAgICAgfVxuXG4gICAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLkZPTERFUl9TQ1JJUFRTX1RPR0dMRSwge1xuICAgICAgICBmb2xkZXJJZCxcbiAgICAgICAgdHlwZSxcbiAgICAgICAgZW5hYmxlOiBuZXdTdGF0ZSxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZm9sZGVySHRtbC5maW5kKCcuZm9sZGVyLWVkaXQnKS5vbignY2xpY2snLCBlID0+IHtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICB0aGlzLnNob3dFZGl0Rm9sZGVyRGlhbG9nKGZvbGRlcklkLCB0eXBlKTtcbiAgICB9KTtcblxuICAgIGZvbGRlckh0bWwuZmluZCgnLmZvbGRlci1leHBvcnQnKS5vbignY2xpY2snLCBlID0+IHtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICB0aGlzLmV4cG9ydEZvbGRlcihmb2xkZXJJZCwgdHlwZSk7XG4gICAgfSk7XG5cbiAgICBmb2xkZXJIdG1sLmZpbmQoJy5mb2xkZXItbW92ZScpLm9uKCdjbGljaycsIGUgPT4ge1xuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuRk9MREVSX01PVkUsIHtcbiAgICAgICAgZm9sZGVySWQsXG4gICAgICAgIGZyb21UeXBlOiB0eXBlLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBmb2xkZXJIdG1sLmZpbmQoJy5mb2xkZXItZGVsZXRlJykub24oJ2NsaWNrJywgZSA9PiB7XG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgdGhpcy5zaG93RGVsZXRlRm9sZGVyRGlhbG9nKGZvbGRlcklkLCB0eXBlKTtcbiAgICB9KTtcblxuICAgIGZvbGRlckh0bWwuZmluZCgnLmZvbGRlci1pY29uJykuY3NzKCdjb2xvcicsIGZvbGRlckNvbG9yKTtcblxuICAgIHRoaXMudXBkYXRlRm9sZGVyVG9nZ2xlU3RhdGUoZm9sZGVySHRtbCwgZm9sZGVySWQsIHR5cGUpO1xuICB9XG5cbiAgLyoqXG4gICAqIOabtOaWsOaWh+S7tuWkueW8gOWFs+eahFVJ54q25oCBXG4gICAqIEBwYXJhbSBmb2xkZXJIdG1sIOaWh+S7tuWkuUhUTUzlhYPntKBcbiAgICogQHBhcmFtIGZvbGRlcklkIOaWh+S7tuWkuUlEXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSB1cGRhdGVGb2xkZXJUb2dnbGVTdGF0ZShmb2xkZXJIdG1sOiBKUXVlcnk8SFRNTEVsZW1lbnQ+LCBmb2xkZXJJZDogc3RyaW5nLCB0eXBlOiBTY3JpcHRUeXBlKTogdm9pZCB7XG4gICAgY29uc3Qgc3RhdGUgPSB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0Rm9sZGVyU2NyaXB0c1N0YXRlKGZvbGRlcklkLCB0eXBlKTtcbiAgICBjb25zdCAkZm9sZGVyVG9nZ2xlID0gZm9sZGVySHRtbC5maW5kKCcuZm9sZGVyLXNjcmlwdC10b2dnbGUnKTtcblxuICAgICRmb2xkZXJUb2dnbGUucmVtb3ZlQ2xhc3MoJ2VuYWJsZWQnKTtcblxuICAgIGlmIChzdGF0ZSA9PT0gJ2FsbCcpIHtcbiAgICAgICRmb2xkZXJUb2dnbGUuYWRkQ2xhc3MoJ2VuYWJsZWQnKTtcbiAgICAgICRmb2xkZXJUb2dnbGUuZmluZCgnaS5mYS10b2dnbGUtb2ZmJykuaGlkZSgpO1xuICAgICAgJGZvbGRlclRvZ2dsZS5maW5kKCdpLmZhLXRvZ2dsZS1vbicpLnNob3coKTtcbiAgICB9IGVsc2Uge1xuICAgICAgJGZvbGRlclRvZ2dsZS5maW5kKCdpLmZhLXRvZ2dsZS1vZmYnKS5zaG93KCk7XG4gICAgICAkZm9sZGVyVG9nZ2xlLmZpbmQoJ2kuZmEtdG9nZ2xlLW9uJykuaGlkZSgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmm7TmlrDljIXlkKvmjIflrprohJrmnKznmoTmlofku7blpLnlvIDlhbPnirbmgIFcbiAgICogQHBhcmFtIHNjcmlwdElkIOiEmuacrElEXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSB1cGRhdGVQYXJlbnRGb2xkZXJUb2dnbGUoc2NyaXB0SWQ6IHN0cmluZywgdHlwZTogU2NyaXB0VHlwZSk6IHZvaWQge1xuICAgIGNvbnN0IHJlcG9zaXRvcnkgPVxuICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUxcbiAgICAgICAgPyB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0R2xvYmFsUmVwb3NpdG9yeUl0ZW1zKClcbiAgICAgICAgOiB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0Q2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKCk7XG5cbiAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgcmVwb3NpdG9yeSkge1xuICAgICAgaWYgKGl0ZW0udHlwZSA9PT0gJ2ZvbGRlcicpIHtcbiAgICAgICAgY29uc3Qgc2NyaXB0cyA9IGl0ZW0udmFsdWUgYXMgU2NyaXB0W107XG4gICAgICAgIGNvbnN0IGhhc1NjcmlwdCA9IHNjcmlwdHMuc29tZShzY3JpcHQgPT4gc2NyaXB0LmlkID09PSBzY3JpcHRJZCk7XG5cbiAgICAgICAgaWYgKGhhc1NjcmlwdCkge1xuICAgICAgICAgIGNvbnN0ICRmb2xkZXIgPSAkKGAjJHtpdGVtLmlkfWApO1xuICAgICAgICAgIGlmICgkZm9sZGVyLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlRm9sZGVyVG9nZ2xlU3RhdGUoJGZvbGRlciwgaXRlbS5pZCEsIHR5cGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDliJvlu7rohJrmnKzlhYPntKBcbiAgICogQHBhcmFtIHNjcmlwdCDohJrmnKxcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGNyZWF0ZVNjcmlwdEVsZW1lbnQoc2NyaXB0OiBTY3JpcHQsIHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPEpRdWVyeTxIVE1MRWxlbWVudD4+IHtcbiAgICBpZiAoIXRoaXMuYmFzZVRlbXBsYXRlKSB7XG4gICAgICBhd2FpdCB0aGlzLmluaXRpYWxpemVUZW1wbGF0ZXMoKTtcbiAgICB9XG5cbiAgICBjb25zdCBzY3JpcHRIdG1sID0gdGhpcy5iYXNlVGVtcGxhdGUhLmNsb25lKCk7XG5cbiAgICBzY3JpcHRIdG1sLmF0dHIoJ2lkJywgc2NyaXB0LmlkKTtcbiAgICBzY3JpcHRIdG1sLmF0dHIoJ2RhdGEtc2NyaXB0LXJlcG9zaXRvcnknLCAndHJ1ZScpO1xuICAgIHNjcmlwdEh0bWwuZmluZCgnLnNjcmlwdC1pdGVtLW5hbWUnKS50ZXh0KHNjcmlwdC5uYW1lKTtcbiAgICBzY3JpcHRIdG1sLmZpbmQoJy5zY3JpcHQtc3RvcmFnZS1sb2NhdGlvbicpLmFkZENsYXNzKHR5cGUgPT09ICdnbG9iYWwnID8gJ21vdmUtdG8tY2hhcmFjdGVyJyA6ICdtb3ZlLXRvLWdsb2JhbCcpO1xuICAgIHNjcmlwdEh0bWwuZmluZCgnLnNjcmlwdC1zdG9yYWdlLWxvY2F0aW9uIGknKS5hZGRDbGFzcyh0eXBlID09PSAnZ2xvYmFsJyA/ICdmYS1hcnJvdy1kb3duJyA6ICdmYS1hcnJvdy11cCcpO1xuXG4gICAgY29uc3QgJHRvZ2dsZUJ1dHRvbiA9IHNjcmlwdEh0bWwuZmluZCgnLnNjcmlwdC10b2dnbGUnKTtcbiAgICBpZiAoc2NyaXB0LmVuYWJsZWQpIHtcbiAgICAgICR0b2dnbGVCdXR0b24uYWRkQ2xhc3MoJ2VuYWJsZWQnKTtcbiAgICAgICR0b2dnbGVCdXR0b24uZmluZCgnaS5mYS10b2dnbGUtb2ZmJykuaGlkZSgpO1xuICAgICAgJHRvZ2dsZUJ1dHRvbi5maW5kKCdpLmZhLXRvZ2dsZS1vbicpLnNob3coKTtcbiAgICB9IGVsc2Uge1xuICAgICAgJHRvZ2dsZUJ1dHRvbi5yZW1vdmVDbGFzcygnZW5hYmxlZCcpO1xuICAgICAgJHRvZ2dsZUJ1dHRvbi5maW5kKCdpLmZhLXRvZ2dsZS1vZmYnKS5zaG93KCk7XG4gICAgICAkdG9nZ2xlQnV0dG9uLmZpbmQoJ2kuZmEtdG9nZ2xlLW9uJykuaGlkZSgpO1xuICAgIH1cblxuICAgIHRoaXMuYmluZFNjcmlwdEV2ZW50cyhzY3JpcHRIdG1sLCBzY3JpcHQsIHR5cGUpO1xuXG4gICAgcmV0dXJuIHNjcmlwdEh0bWw7XG4gIH1cblxuICAvKipcbiAgICog5qOA5p+l6ISa5pysZGF0YeW5tuivoumXrueUqOaIt+WmguS9leWkhOeQhlxuICAgKiBAcGFyYW0gc2NyaXB0IOiEmuacrOWvueixoVxuICAgKiBAcmV0dXJucyDlpITnkIblkI7nmoTohJrmnKzmlbDmja7vvIjkuI3ljIXlkKtlbmFibGVk5a2X5q6177yJ77yM5aaC5p6c55So5oi35Y+W5raI5YiZ6L+U5ZuebnVsbFxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBjaGVja1NjcmlwdERhdGFBbmRHZXRFeHBvcnREYXRhKHNjcmlwdDogU2NyaXB0KTogUHJvbWlzZTxhbnk+IHtcbiAgICBjb25zdCB7IGVuYWJsZWQsIC4uLnNjcmlwdERhdGEgfSA9IHNjcmlwdDtcblxuICAgIGNvbnN0IGhhc0RhdGEgPSBzY3JpcHQuZGF0YSAmJiBPYmplY3Qua2V5cyhzY3JpcHQuZGF0YSkubGVuZ3RoID4gMDtcblxuICAgIGlmIChoYXNEYXRhKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBjaG9pY2UgPSBhd2FpdCBjYWxsR2VuZXJpY1BvcHVwKFxuICAgICAgICAgIGDohJrmnKwgXCIke3NjcmlwdC5uYW1lfVwiIOWMheWQq+aVsOaNru+8jOWvvOWHuuaXtuWmguS9leWkhOeQhu+8n+WmguaciUFQSS1LRVnnrYnmlY/mhJ/mlbDmja7vvIzms6jmhI/muIXpmaRgLFxuICAgICAgICAgIFBPUFVQX1RZUEUuVEVYVCxcbiAgICAgICAgICAnJyxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBva0J1dHRvbjogJ+ebtOaOpeWvvOWHuu+8iOWMheWQq+aVsOaNru+8iScsXG4gICAgICAgICAgICBjYW5jZWxCdXR0b246ICflj5bmtognLFxuICAgICAgICAgICAgY3VzdG9tQnV0dG9uczogWyfmuIXpmaTmlbDmja7lkI7lr7zlh7onXSxcbiAgICAgICAgICB9LFxuICAgICAgICApO1xuXG4gICAgICAgIHN3aXRjaCAoY2hvaWNlKSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgcmV0dXJuIHNjcmlwdERhdGE7XG4gICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgcmV0dXJuIHsgLi4uc2NyaXB0RGF0YSwgZGF0YToge30gfTtcbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGxvZy5lcnJvcignW1NjcmlwdE1hbmFnZXJdIOWvvOWHuuiEmuacrOaVsOaNrumAieaLqeWvueivneahhuWHuumUmTonLCBlcnJvcik7XG4gICAgICAgIHJldHVybiBzY3JpcHREYXRhO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBzY3JpcHREYXRhO1xuICB9XG5cbiAgLyoqXG4gICAqIOe7keWumuiEmuacrOebuOWFs+S6i+S7tlxuICAgKiBAcGFyYW0gc2NyaXB0SHRtbCDohJrmnKxIVE1M5YWD57SgXG4gICAqIEBwYXJhbSBzY3JpcHQg6ISa5pys5a+56LGhXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBiaW5kU2NyaXB0RXZlbnRzKHNjcmlwdEh0bWw6IEpRdWVyeTxIVE1MRWxlbWVudD4sIHNjcmlwdDogU2NyaXB0LCB0eXBlOiBTY3JpcHRUeXBlKTogdm9pZCB7XG4gICAgY29uc3QgJHRvZ2dsZUJ1dHRvbiA9IHNjcmlwdEh0bWwuZmluZCgnLnNjcmlwdC10b2dnbGUnKTtcbiAgICAkdG9nZ2xlQnV0dG9uLm9uKCdjbGljay5zY3JpcHRUb2dnbGUnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCBpc0VuYWJsZWQgPSAkKHRoaXMpLmhhc0NsYXNzKCdlbmFibGVkJyk7XG4gICAgICBjb25zdCBuZXdTdGF0ZSA9ICFpc0VuYWJsZWQ7XG5cbiAgICAgIGlmIChuZXdTdGF0ZSkge1xuICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCdlbmFibGVkJyk7XG4gICAgICAgICQodGhpcykuZmluZCgnaS5mYS10b2dnbGUtb2ZmJykuaGlkZSgpO1xuICAgICAgICAkKHRoaXMpLmZpbmQoJ2kuZmEtdG9nZ2xlLW9uJykuc2hvdygpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcygnZW5hYmxlZCcpO1xuICAgICAgICAkKHRoaXMpLmZpbmQoJ2kuZmEtdG9nZ2xlLW9mZicpLnNob3coKTtcbiAgICAgICAgJCh0aGlzKS5maW5kKCdpLmZhLXRvZ2dsZS1vbicpLmhpZGUoKTtcbiAgICAgIH1cblxuICAgICAgc2NyaXB0LmVuYWJsZWQgPSBuZXdTdGF0ZTtcblxuICAgICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5TQ1JJUFRfVE9HR0xFLCB7XG4gICAgICAgIHNjcmlwdCxcbiAgICAgICAgdHlwZSxcbiAgICAgICAgZW5hYmxlOiBuZXdTdGF0ZSxcbiAgICAgICAgdXNlcklucHV0OiB0cnVlLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBzY3JpcHRIdG1sLmZpbmQoJy5zY3JpcHQtaW5mbycpLm9uKCdjbGljay5zY3JpcHRJbmZvJywgKCkgPT4ge1xuICAgICAgY29uc3Qgc2NyaXB0SW5mbyA9IHNjcmlwdC5pbmZvIHx8ICcnO1xuICAgICAgY29uc3QgaHRtbFRleHQgPSByZW5kZXJNYXJrZG93bihzY3JpcHRJbmZvKTtcbiAgICAgIGNhbGxHZW5lcmljUG9wdXAoaHRtbFRleHQsIFBPUFVQX1RZUEUuRElTUExBWSwgdW5kZWZpbmVkLCB7IHdpZGU6IHRydWUgfSk7XG4gICAgfSk7XG5cbiAgICBzY3JpcHRIdG1sLmZpbmQoJy5lZGl0LXNjcmlwdCcpLm9uKCdjbGljay5zY3JpcHRFZGl0JywgZSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5TQ1JJUFRfRURJVCwgeyB0eXBlLCBzY3JpcHRJZDogc2NyaXB0LmlkIH0pO1xuICAgIH0pO1xuXG4gICAgc2NyaXB0SHRtbC5maW5kKCcuc2NyaXB0LXN0b3JhZ2UtbG9jYXRpb24nKS5vbignY2xpY2suc2NyaXB0TW92ZScsICgpID0+IHtcbiAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuU0NSSVBUX01PVkUsIHsgc2NyaXB0LCBmcm9tVHlwZTogdHlwZSB9KTtcbiAgICB9KTtcblxuICAgIHNjcmlwdEh0bWwuZmluZCgnLmV4cG9ydC1zY3JpcHQnKS5vbignY2xpY2suc2NyaXB0RXhwb3J0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZmlsZU5hbWUgPSBgJHtzY3JpcHQubmFtZS5yZXBsYWNlKC9bXFxzLjw+OlwiL1xcXFx8PypcXHgwMC1cXHgxRlxceDdGXS9nLCAnXycpLnRvTG93ZXJDYXNlKCl9Lmpzb25gO1xuICAgICAgY29uc3Qgc2NyaXB0RGF0YSA9IGF3YWl0IHRoaXMuY2hlY2tTY3JpcHREYXRhQW5kR2V0RXhwb3J0RGF0YShzY3JpcHQpO1xuXG4gICAgICBpZiAoc2NyaXB0RGF0YSA9PT0gbnVsbCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGZpbGVEYXRhID0gSlNPTi5zdHJpbmdpZnkoc2NyaXB0RGF0YSwgbnVsbCwgMik7XG4gICAgICBkb3dubG9hZChmaWxlRGF0YSwgZmlsZU5hbWUsICdhcHBsaWNhdGlvbi9qc29uJyk7XG4gICAgfSk7XG5cbiAgICBzY3JpcHRIdG1sLmZpbmQoJy5kZWxldGUtc2NyaXB0Jykub24oJ2NsaWNrLnNjcmlwdERlbGV0ZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbmZpcm0gPSBhd2FpdCBjYWxsR2VuZXJpY1BvcHVwKCfnoa7lrpropoHliKDpmaTov5nkuKrohJrmnKzlkJfvvJ8nLCBQT1BVUF9UWVBFLkNPTkZJUk0pO1xuXG4gICAgICBpZiAoIWNvbmZpcm0pIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBzY3JpcHRFdmVudHMuZW1pdChTY3JpcHRSZXBvc2l0b3J5RXZlbnRUeXBlLlNDUklQVF9ERUxFVEUsIHsgc2NyaXB0SWQ6IHNjcmlwdC5pZCwgdHlwZSB9KTtcbiAgICAgIHNjcmlwdEh0bWwucmVtb3ZlKCk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog5pi+56S65paw5bu66ISa5pys5a+56K+d5qGGXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHNob3dDcmVhdGVTY3JpcHREaWFsb2coKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgbGV0IHRhcmdldDogU2NyaXB0VHlwZSA9IFNjcmlwdFR5cGUuR0xPQkFMO1xuICAgIGNvbnN0IHRlbXBsYXRlID0gJChcbiAgICAgIGF3YWl0IHJlbmRlckV4dGVuc2lvblRlbXBsYXRlQXN5bmModGhpcy50ZW1wbGF0ZVBhdGgsICdzY3JpcHRfdGFyZ2V0X3NlbGVjdG9yJywge1xuICAgICAgICB0aXRsZTogJ+aWsOW7uuiEmuacrOWIsDonLFxuICAgICAgICBwcmVmaXg6ICdzY3JpcHQtY3JlYXRlJyxcbiAgICAgICAgZ2xvYmFsTGFiZWw6ICflhajlsYDohJrmnKzlupMnLFxuICAgICAgICBjaGFyYWN0ZXJMYWJlbDogJ+inkuiJsuiEmuacrOW6kycsXG4gICAgICB9KSxcbiAgICApO1xuICAgIHRlbXBsYXRlLmZpbmQoJyNzY3JpcHQtY3JlYXRlLXRhcmdldC1nbG9iYWwnKS5vbignaW5wdXQnLCAoKSA9PiAodGFyZ2V0ID0gU2NyaXB0VHlwZS5HTE9CQUwpKTtcbiAgICB0ZW1wbGF0ZS5maW5kKCcjc2NyaXB0LWNyZWF0ZS10YXJnZXQtY2hhcmFjdGVyJykub24oJ2lucHV0JywgKCkgPT4gKHRhcmdldCA9IFNjcmlwdFR5cGUuQ0hBUkFDVEVSKSk7XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjYWxsR2VuZXJpY1BvcHVwKHRlbXBsYXRlLCBQT1BVUF9UWVBFLkNPTkZJUk0sICcnLCB7XG4gICAgICBva0J1dHRvbjogJ+ehruiupCcsXG4gICAgICBjYW5jZWxCdXR0b246ICflj5bmtognLFxuICAgIH0pO1xuXG4gICAgaWYgKHJlc3VsdCkge1xuICAgICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5TQ1JJUFRfRURJVCwge1xuICAgICAgICB0eXBlOiB0YXJnZXQsXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5pi+56S65Yib5bu65paH5Lu25aS55a+56K+d5qGGXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHNob3dDcmVhdGVGb2xkZXJEaWFsb2coKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgZGVmYXVsdENvbG9yID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLmdldFByb3BlcnR5VmFsdWUoJy0tU21hcnRUaGVtZUJvZHlDb2xvcicpO1xuICAgIGNvbnN0IHRlbXBsYXRlID0gJChhd2FpdCByZW5kZXJFeHRlbnNpb25UZW1wbGF0ZUFzeW5jKHRoaXMudGVtcGxhdGVQYXRoLCAnZm9sZGVyX2NyZWF0ZScsIHsgZGVmYXVsdENvbG9yIH0sIGZhbHNlKSk7XG5cbiAgICBsZXQgZm9sZGVyQ29sb3I7XG5cbiAgICB0ZW1wbGF0ZS5maW5kKCcjZm9sZGVyLWljb24tcHJldmlldycpLm9uKCdjbGljaycsIGFzeW5jICgpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHNlbGVjdGVkSWNvbiA9IGF3YWl0IHNob3dGb250QXdlc29tZVBpY2tlcigpO1xuICAgICAgICBpZiAoc2VsZWN0ZWRJY29uICYmIHNlbGVjdGVkSWNvbi50cmltKCkgIT09ICcnKSB7XG4gICAgICAgICAgdGVtcGxhdGUuZmluZCgnI2ZvbGRlci1pY29uLXByZXZpZXcnKS5yZW1vdmVDbGFzcygpLmFkZENsYXNzKGBmYSAke3NlbGVjdGVkSWNvbn1gKTtcbiAgICAgICAgICB0ZW1wbGF0ZS5maW5kKCcjZm9sZGVyLWljb24tdmFsdWUnKS52YWwoc2VsZWN0ZWRJY29uKTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgbG9nLmVycm9yKCdbU2NyaXB0TWFuYWdlcl0g5Zu+5qCH6YCJ5oup5aSx6LSlOicsIGVycm9yKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHRlbXBsYXRlLmZpbmQoJyNmb2xkZXItY29sb3ItcGlja2VyJykub24oJ2NoYW5nZScsIGV2dCA9PiB7XG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICBmb2xkZXJDb2xvciA9IGV2dC5kZXRhaWw/LnJnYmE7XG4gICAgfSk7XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjYWxsR2VuZXJpY1BvcHVwKHRlbXBsYXRlLCBQT1BVUF9UWVBFLkNPTkZJUk0sICcnLCB7XG4gICAgICBva0J1dHRvbjogJ+WIm+W7uicsXG4gICAgICBjYW5jZWxCdXR0b246ICflj5bmtognLFxuICAgIH0pO1xuXG4gICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBmb2xkZXJOYW1lID0gdGVtcGxhdGUuZmluZCgnI2ZvbGRlci1uYW1lLWlucHV0JykudmFsKCkgYXMgc3RyaW5nO1xuICAgIGNvbnN0IGZvbGRlckljb24gPSB0ZW1wbGF0ZS5maW5kKCcjZm9sZGVyLWljb24tdmFsdWUnKS52YWwoKSBhcyBzdHJpbmc7XG4gICAgY29uc3Qgc2VsZWN0ZWRUeXBlID0gdGVtcGxhdGUuZmluZCgnI2ZvbGRlci10YXJnZXQtZ2xvYmFsJykucHJvcCgnY2hlY2tlZCcpXG4gICAgICA/IFNjcmlwdFR5cGUuR0xPQkFMXG4gICAgICA6IFNjcmlwdFR5cGUuQ0hBUkFDVEVSO1xuXG4gICAgaWYgKCFmb2xkZXJOYW1lIHx8IGZvbGRlck5hbWUudHJpbSgpID09PSAnJykge1xuICAgICAgdG9hc3RyLmVycm9yKCfor7fovpPlhaXmlofku7blpLnlkI3np7AnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgZXhpc3RpbmdGb2xkZXJzID1cbiAgICAgICAgc2VsZWN0ZWRUeXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTFxuICAgICAgICAgID8gdGhpcy5zY3JpcHRNYW5hZ2VyLmdldEdsb2JhbFJlcG9zaXRvcnlJdGVtcygpXG4gICAgICAgICAgOiB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0Q2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKCk7XG5cbiAgICAgIGNvbnN0IGZvbGRlckV4aXN0cyA9IGV4aXN0aW5nRm9sZGVycy5zb21lKGl0ZW0gPT4gaXRlbS50eXBlID09PSAnZm9sZGVyJyAmJiBpdGVtLm5hbWUgPT09IGZvbGRlck5hbWUudHJpbSgpKTtcblxuICAgICAgaWYgKGZvbGRlckV4aXN0cykge1xuICAgICAgICB0b2FzdHIuZXJyb3IoXG4gICAgICAgICAgYCR7c2VsZWN0ZWRUeXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCA/ICflhajlsYAnIDogJ+inkuiJsid96ISa5pys5bqT5Lit5bey5a2Y5Zyo5ZCN5Li6IFwiJHtmb2xkZXJOYW1lLnRyaW0oKX1cIiDnmoTmlofku7blpLlgLFxuICAgICAgICApO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuRk9MREVSX0NSRUFURSwge1xuICAgICAgICBuYW1lOiBmb2xkZXJOYW1lLnRyaW0oKSxcbiAgICAgICAgdHlwZTogc2VsZWN0ZWRUeXBlLFxuICAgICAgICBpY29uOiBmb2xkZXJJY29uLFxuICAgICAgICBjb2xvcjogZm9sZGVyQ29sb3IsXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nLmVycm9yKCdbU2NyaXB0TWFuYWdlcl0g5Yib5bu65paH5Lu25aS55aSx6LSlOicsIGVycm9yKTtcbiAgICAgIHRvYXN0ci5lcnJvcihg5Yib5bu65paH5Lu25aS55aSx6LSlOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKX1gKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5pi+56S657yW6L6R5paH5Lu25aS55a+56K+d5qGGXG4gICAqIEBwYXJhbSBmb2xkZXJJZCDmlofku7blpLlJRFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgc2hvd0VkaXRGb2xkZXJEaWFsb2coZm9sZGVySWQ6IHN0cmluZywgdHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGN1cnJlbnROYW1lID0gJChgIyR7Zm9sZGVySWR9IC5mb2xkZXItbmFtZWApLnRleHQoKTtcblxuICAgIGNvbnN0IHJlcG9zaXRvcnkgPVxuICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUxcbiAgICAgICAgPyB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0R2xvYmFsUmVwb3NpdG9yeUl0ZW1zKClcbiAgICAgICAgOiB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0Q2hhcmFjdGVyUmVwb3NpdG9yeUl0ZW1zKCk7XG4gICAgY29uc3QgZm9sZGVyID0gcmVwb3NpdG9yeS5maW5kKGl0ZW0gPT4gaXRlbS50eXBlID09PSAnZm9sZGVyJyAmJiBpdGVtLmlkID09PSBmb2xkZXJJZCk7XG4gICAgY29uc3QgY3VycmVudEljb24gPSBmb2xkZXI/Lmljb24gfHwgJ2ZhLWZvbGRlcic7XG4gICAgY29uc3QgY3VycmVudENvbG9yUmdiYSA9IGZvbGRlcj8uY29sb3IgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLmdldFByb3BlcnR5VmFsdWUoJy0tU21hcnRUaGVtZUJvZHlDb2xvcicpO1xuICAgIGxldCBuZXdDb2xvcjtcblxuICAgIGNvbnN0IHRlbXBsYXRlID0gJChgXG4gICAgICA8ZGl2IGNsYXNzPVwiZm9sZGVyLWVkaXQtZGlhbG9nXCI+XG4gICAgICA8aDM+57yW6L6R5paH5Lu25aS5PC9oMz5cbiAgICAgIDxkaXYgY2xhc3M9XCJmbGV4LWNvbnRhaW5lciBmbGV4Rmxvd0NvbHVtbiB3aWRlMTAwcCBwYWRkaW5nMTAganVzdGlmeUxlZnRcIj5cbiAgICAgICAgPGRpdj5cbiAgICAgICAgICA8aDQ+5paH5Lu25aS55ZCN56ewOjwvaDQ+XG4gICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgaWQ9XCJmb2xkZXItbmFtZS1pbnB1dFwiIGNsYXNzPVwidGV4dF9wb2xlXCIgdmFsdWU9XCIke2N1cnJlbnROYW1lfVwiIC8+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2PlxuICAgICAgICAgIDxoND7mlofku7blpLnlm77moIc6PC9oND5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiZmxleFwiIHN0eWxlPVwiZ2FwOiAyMHB4OyBtYXJnaW46IDVweCAwOyB3aWR0aDogMTAwJTtcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJmbGV4IGFsaWduSXRlbXNDZW50ZXJcIj5cbiAgICAgICAgICAgIDxsYWJlbD7pgInmi6npopzoibI8L2xhYmVsPlxuICAgICAgICAgICAgPHRvb2xjb29sLWNvbG9yLXBpY2tlciBpZD1cImZvbGRlci1jb2xvci1waWNrZXJcIiBjb2xvcj1cIiR7Y3VycmVudENvbG9yUmdiYX1cIj48L3Rvb2xjb29sLWNvbG9yLXBpY2tlcj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImZsZXgtY29udGFpbmVyIGFsaWduSXRlbXNDZW50ZXJcIj5cbiAgICAgICAgICAgICA8bGFiZWw+6YCJ5oup5Zu+5qCHPC9sYWJlbD5cbiAgICAgICAgICAgICAgPGkgaWQ9XCJmb2xkZXItaWNvbi1wcmV2aWV3XCIgY2xhc3M9XCJmYSAke2N1cnJlbnRJY29ufSBtYXJnaW5SaWdodDEwXCIgc3R5bGU9XCJjdXJzb3I6IHBvaW50ZXI7IGZvbnQtc2l6ZTogMTJweDsgcGFkZGluZzogNHB4OyBib3JkZXI6IDFweCBzb2xpZCAjY2NjOyBib3JkZXItcmFkaXVzOiA0cHg7XCIgdGl0bGU9XCLngrnlh7vpgInmi6nlm77moIdcIj48L2k+XG4gICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwiaGlkZGVuXCIgaWQ9XCJmb2xkZXItaWNvbi12YWx1ZVwiIHZhbHVlPVwiJHtjdXJyZW50SWNvbn1cIiAvPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgYCk7XG5cbiAgICB0ZW1wbGF0ZS5maW5kKCcjZm9sZGVyLWljb24tcHJldmlldycpLm9uKCdjbGljaycsIGFzeW5jICgpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHNlbGVjdGVkSWNvbiA9IGF3YWl0IHNob3dGb250QXdlc29tZVBpY2tlcigpO1xuICAgICAgICBpZiAoc2VsZWN0ZWRJY29uICYmIHNlbGVjdGVkSWNvbi50cmltKCkgIT09ICcnKSB7XG4gICAgICAgICAgdGVtcGxhdGUuZmluZCgnI2ZvbGRlci1pY29uLXByZXZpZXcnKS5yZW1vdmVDbGFzcygpLmFkZENsYXNzKGBmYSAke3NlbGVjdGVkSWNvbn1gKTtcbiAgICAgICAgICB0ZW1wbGF0ZS5maW5kKCcjZm9sZGVyLWljb24tdmFsdWUnKS52YWwoc2VsZWN0ZWRJY29uKTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgbG9nLmVycm9yKCdbU2NyaXB0TWFuYWdlcl0g5Zu+5qCH6YCJ5oup5aSx6LSlOicsIGVycm9yKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICB0ZW1wbGF0ZS5maW5kKCcjZm9sZGVyLWNvbG9yLXBpY2tlcicpLm9uKCdjaGFuZ2UnLCBldnQgPT4ge1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgbmV3Q29sb3IgPSBldnQuZGV0YWlsPy5yZ2JhO1xuICAgIH0pO1xuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2FsbEdlbmVyaWNQb3B1cCh0ZW1wbGF0ZSwgUE9QVVBfVFlQRS5DT05GSVJNLCAnJywge1xuICAgICAgb2tCdXR0b246ICfkv53lrZgnLFxuICAgICAgY2FuY2VsQnV0dG9uOiAn5Y+W5raIJyxcbiAgICB9KTtcblxuICAgIGlmICghcmVzdWx0KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgbmV3TmFtZSA9IHRlbXBsYXRlLmZpbmQoJyNmb2xkZXItbmFtZS1pbnB1dCcpLnZhbCgpIGFzIHN0cmluZztcbiAgICBjb25zdCBuZXdJY29uID0gdGVtcGxhdGUuZmluZCgnI2ZvbGRlci1pY29uLXZhbHVlJykudmFsKCkgYXMgc3RyaW5nO1xuXG4gICAgc2NyaXB0RXZlbnRzLmVtaXQoU2NyaXB0UmVwb3NpdG9yeUV2ZW50VHlwZS5GT0xERVJfRURJVCwge1xuICAgICAgZm9sZGVySWQsXG4gICAgICBuZXdOYW1lOiBuZXdOYW1lPy50cmltKCkgfHwgY3VycmVudE5hbWUsXG4gICAgICB0eXBlLFxuICAgICAgbmV3SWNvbjogbmV3SWNvbixcbiAgICAgIG5ld0NvbG9yOiBuZXdDb2xvcixcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlr7zlh7rmlofku7blpLnkuLrljovnvKnljIVcbiAgICogQHBhcmFtIGZvbGRlcklkIOaWh+S7tuWkuUlEXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBleHBvcnRGb2xkZXIoZm9sZGVySWQ6IHN0cmluZywgdHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXBvc2l0b3J5ID1cbiAgICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUxcbiAgICAgICAgICA/IHRoaXMuc2NyaXB0TWFuYWdlci5nZXRHbG9iYWxSZXBvc2l0b3J5SXRlbXMoKVxuICAgICAgICAgIDogdGhpcy5zY3JpcHRNYW5hZ2VyLmdldENoYXJhY3RlclJlcG9zaXRvcnlJdGVtcygpO1xuXG4gICAgICBjb25zdCBmb2xkZXIgPSByZXBvc2l0b3J5LmZpbmQoaXRlbSA9PiBpdGVtLnR5cGUgPT09ICdmb2xkZXInICYmIGl0ZW0uaWQgPT09IGZvbGRlcklkKTtcblxuICAgICAgaWYgKCFmb2xkZXIpIHtcbiAgICAgICAgdG9hc3RyLmVycm9yKCfmnKrmib7liLDmjIflrprnmoTmlofku7blpLknKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgLy9AdHMtaWdub3JlXG4gICAgICBpZiAoIXdpbmRvdy5KU1ppcCkge1xuICAgICAgICBhd2FpdCBpbXBvcnQoJ0BzaWxseXRhdmVybi9saWIvanN6aXAubWluLmpzJyk7XG4gICAgICB9XG4gICAgICAvL0B0cy1pZ25vcmVcbiAgICAgIGNvbnN0IHppcCA9IG5ldyBKU1ppcCgpO1xuXG4gICAgICBjb25zdCBmb2xkZXJOYW1lID0gZm9sZGVyLm5hbWUgfHwgJ2ZvbGRlcic7XG4gICAgICBjb25zdCBzYW5pdGl6ZWRGb2xkZXJOYW1lID0gZm9sZGVyTmFtZS5yZXBsYWNlKC9bPD46XCIvXFxcXHw/Kl0vZywgJ18nKTtcblxuICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZm9sZGVyLnZhbHVlKSkge1xuICAgICAgICBsZXQgY2FuY2VsRXhwb3J0ID0gZmFsc2U7XG5cbiAgICAgICAgZm9yIChjb25zdCBzY3JpcHQgb2YgZm9sZGVyLnZhbHVlKSB7XG4gICAgICAgICAgY29uc3Qgc2NyaXB0RGF0YSA9IGF3YWl0IHRoaXMuY2hlY2tTY3JpcHREYXRhQW5kR2V0RXhwb3J0RGF0YShzY3JpcHQpO1xuXG4gICAgICAgICAgaWYgKHNjcmlwdERhdGEgPT09IG51bGwpIHtcbiAgICAgICAgICAgIGNhbmNlbEV4cG9ydCA9IHRydWU7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb25zdCBzY3JpcHRGaWxlTmFtZSA9IGAke3NjcmlwdC5uYW1lLnJlcGxhY2UoL1s8PjpcIi9cXFxcfD8qXS9nLCAnXycpfS5qc29uYDtcbiAgICAgICAgICB6aXAuZmlsZShgJHtzYW5pdGl6ZWRGb2xkZXJOYW1lfS8ke3NjcmlwdEZpbGVOYW1lfWAsIEpTT04uc3RyaW5naWZ5KHNjcmlwdERhdGEsIG51bGwsIDIpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjYW5jZWxFeHBvcnQpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY29uc3QgemlwQmxvYiA9IGF3YWl0IHppcC5nZW5lcmF0ZUFzeW5jKHsgdHlwZTogJ2Jsb2InIH0pO1xuXG4gICAgICBjb25zdCB0aW1lc3RhbXAgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc2xpY2UoMCwgMTkpLnJlcGxhY2UoLzovZywgJy0nKTtcbiAgICAgIGNvbnN0IHR5cGVOYW1lID0gdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUwgPyAnZ2xvYmFsJyA6ICdjaGFyYWN0ZXInO1xuICAgICAgY29uc3QgZmlsZW5hbWUgPSBgZm9sZGVyXyR7c2FuaXRpemVkRm9sZGVyTmFtZX1fJHt0eXBlTmFtZX1fJHt0aW1lc3RhbXB9LnppcGA7XG5cbiAgICAgIGNvbnN0IHVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoemlwQmxvYik7XG4gICAgICBjb25zdCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuICAgICAgYS5ocmVmID0gdXJsO1xuICAgICAgYS5kb3dubG9hZCA9IGZpbGVuYW1lO1xuICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhKTtcbiAgICAgIGEuY2xpY2soKTtcbiAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoYSk7XG4gICAgICBVUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7XG5cbiAgICAgIHRvYXN0ci5zdWNjZXNzKGDmlofku7blpLkgXCIke2ZvbGRlci5uYW1lfVwiIOWvvOWHuuaIkOWKn2ApO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2cuZXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDlr7zlh7rmlofku7blpLnlpLHotKU6JywgZXJyb3IpO1xuICAgICAgdG9hc3RyLmVycm9yKGDlr7zlh7rmlofku7blpLnlpLHotKU6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpfWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmmL7npLrliKDpmaTmlofku7blpLnnoa7orqTlr7nor53moYZcbiAgICogQHBhcmFtIGZvbGRlcklkIOaWh+S7tuWkuUlEXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBzaG93RGVsZXRlRm9sZGVyRGlhbG9nKGZvbGRlcklkOiBzdHJpbmcsIHR5cGU6IFNjcmlwdFR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCByZXBvc2l0b3J5ID1cbiAgICAgIHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMXG4gICAgICAgID8gdGhpcy5zY3JpcHRNYW5hZ2VyLmdldEdsb2JhbFJlcG9zaXRvcnlJdGVtcygpXG4gICAgICAgIDogdGhpcy5zY3JpcHRNYW5hZ2VyLmdldENoYXJhY3RlclJlcG9zaXRvcnlJdGVtcygpO1xuXG4gICAgY29uc3QgZm9sZGVyID0gcmVwb3NpdG9yeS5maW5kKGl0ZW0gPT4gaXRlbS50eXBlID09PSAnZm9sZGVyJyAmJiBpdGVtLmlkID09PSBmb2xkZXJJZCk7XG4gICAgY29uc3QgZm9sZGVyTmFtZSA9IGZvbGRlcj8ubmFtZSB8fCAn5pyq55+l5paH5Lu25aS5JztcblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNhbGxHZW5lcmljUG9wdXAoXG4gICAgICBg56Gu5a6a6KaB5Yig6Zmk5paH5Lu25aS5IFwiJHtmb2xkZXJOYW1lfVwiIOWPiuWFtuS4reeahOaJgOacieiEmuacrOWQl++8n+atpOaTjeS9nOS4jeWPr+aSpOmUgOOAgmAsXG4gICAgICBQT1BVUF9UWVBFLkNPTkZJUk0sXG4gICAgICAnJyxcbiAgICAgIHsgb2tCdXR0b246ICfliKDpmaQnLCBjYW5jZWxCdXR0b246ICflj5bmtognIH0sXG4gICAgKTtcblxuICAgIGlmIChyZXN1bHQpIHtcbiAgICAgIHNjcmlwdEV2ZW50cy5lbWl0KFNjcmlwdFJlcG9zaXRvcnlFdmVudFR5cGUuRk9MREVSX0RFTEVURSwge1xuICAgICAgICBmb2xkZXJJZCxcbiAgICAgICAgdHlwZSxcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDorr7nva7mkJzntKLlip/og73kuovku7ZcbiAgICovXG4gIHByaXZhdGUgc2V0dXBTZWFyY2hFdmVudHMoKTogdm9pZCB7XG4gICAgY29uc3Qgc2VhcmNoSW5wdXQgPSAkKCcjc2NyaXB0LXNlYXJjaC1pbnB1dCcpO1xuXG4gICAgc2VhcmNoSW5wdXQub24oJ2lucHV0JywgZXZlbnQgPT4ge1xuICAgICAgY29uc3QgcXVlcnkgPSAoZXZlbnQudGFyZ2V0IGFzIEhUTUxJbnB1dEVsZW1lbnQpLnZhbHVlLnRyaW0oKTtcbiAgICAgIGlmIChxdWVyeSkge1xuICAgICAgICB0aGlzLnBlcmZvcm1TZWFyY2gocXVlcnkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5jbGVhclNlYXJjaCgpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgc2VhcmNoSW5wdXQub24oJ2tleXByZXNzJywgZXZlbnQgPT4ge1xuICAgICAgaWYgKGV2ZW50LndoaWNoID09PSAxMykge1xuICAgICAgICBjb25zdCBxdWVyeSA9IHNlYXJjaElucHV0LnZhbCgpIGFzIHN0cmluZztcbiAgICAgICAgaWYgKHF1ZXJ5ICYmIHF1ZXJ5LnRyaW0oKSkge1xuICAgICAgICAgIHRoaXMucGVyZm9ybVNlYXJjaChxdWVyeS50cmltKCkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog5omn6KGM5pCc57SiXG4gICAqIEBwYXJhbSBxdWVyeSDmkJzntKLlhbPplK7or41cbiAgICovXG4gIHByaXZhdGUgcGVyZm9ybVNlYXJjaChxdWVyeTogc3RyaW5nKTogdm9pZCB7XG4gICAgaWYgKCFxdWVyeSkge1xuICAgICAgdGhpcy5jbGVhclNlYXJjaCgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGdsb2JhbFNjcmlwdHMgPSB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0R2xvYmFsU2NyaXB0cygpO1xuICAgIGNvbnN0IGNoYXJhY3RlclNjcmlwdHMgPSB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0Q2hhcmFjdGVyU2NyaXB0cygpO1xuXG4gICAgY29uc3QgZ2xvYmFsTWF0Y2hlcyA9IHRoaXMuc2VhcmNoU2NyaXB0cyhnbG9iYWxTY3JpcHRzLCBxdWVyeSk7XG4gICAgY29uc3QgY2hhcmFjdGVyTWF0Y2hlcyA9IHRoaXMuc2VhcmNoU2NyaXB0cyhjaGFyYWN0ZXJTY3JpcHRzLCBxdWVyeSk7XG5cbiAgICB0aGlzLmRpc3BsYXlTZWFyY2hSZXN1bHRzKGdsb2JhbE1hdGNoZXMsIGNoYXJhY3Rlck1hdGNoZXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIOWcqOiEmuacrOaVsOe7hOS4reaQnOe0ouWMuemFjeeahOiEmuacrFxuICAgKiBAcGFyYW0gc2NyaXB0cyDohJrmnKzmlbDnu4RcbiAgICogQHBhcmFtIHF1ZXJ5IOaQnOe0ouWFs+mUruivjVxuICAgKiBAcmV0dXJucyDljLnphY3nmoTohJrmnKzmlbDnu4RcbiAgICovXG4gIHByaXZhdGUgc2VhcmNoU2NyaXB0cyhzY3JpcHRzOiBTY3JpcHRbXSwgcXVlcnk6IHN0cmluZyk6IFNjcmlwdFtdIHtcbiAgICBjb25zdCBsb3dlclF1ZXJ5ID0gcXVlcnkudG9Mb3dlckNhc2UoKTtcbiAgICByZXR1cm4gc2NyaXB0cy5maWx0ZXIoc2NyaXB0ID0+IHNjcmlwdC5uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMobG93ZXJRdWVyeSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIOaYvuekuuaQnOe0oue7k+aenFxuICAgKiBAcGFyYW0gZ2xvYmFsTWF0Y2hlcyDlhajlsYDohJrmnKzljLnphY3nu5PmnpxcbiAgICogQHBhcmFtIGNoYXJhY3Rlck1hdGNoZXMg6KeS6Imy6ISa5pys5Yy56YWN57uT5p6cXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGRpc3BsYXlTZWFyY2hSZXN1bHRzKGdsb2JhbE1hdGNoZXM6IFNjcmlwdFtdLCBjaGFyYWN0ZXJNYXRjaGVzOiBTY3JpcHRbXSk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRoaXMuY2xlYXJTY3JpcHRMaXN0KFNjcmlwdFR5cGUuR0xPQkFMKTtcbiAgICB0aGlzLmNsZWFyU2NyaXB0TGlzdChTY3JpcHRUeXBlLkNIQVJBQ1RFUik7XG5cbiAgICBjb25zdCBnbG9iYWxDb250YWluZXIgPSAkKCcjZ2xvYmFsLXNjcmlwdC1saXN0Jyk7XG4gICAgaWYgKGdsb2JhbE1hdGNoZXMubGVuZ3RoID4gMCkge1xuICAgICAgZm9yIChjb25zdCBzY3JpcHQgb2YgZ2xvYmFsTWF0Y2hlcykge1xuICAgICAgICBhd2FpdCB0aGlzLmFkZFNjcmlwdFRvQ29udGFpbmVyKHNjcmlwdCwgU2NyaXB0VHlwZS5HTE9CQUwpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBnbG9iYWxDb250YWluZXIuYXBwZW5kKCc8c21hbGw+5peg5Yy56YWN55qE5YWo5bGA6ISa5pysPC9zbWFsbD4nKTtcbiAgICB9XG5cbiAgICBjb25zdCBjaGFyYWN0ZXJDb250YWluZXIgPSAkKCcjY2hhcmFjdGVyLXNjcmlwdC1saXN0Jyk7XG4gICAgaWYgKGNoYXJhY3Rlck1hdGNoZXMubGVuZ3RoID4gMCkge1xuICAgICAgZm9yIChjb25zdCBzY3JpcHQgb2YgY2hhcmFjdGVyTWF0Y2hlcykge1xuICAgICAgICBhd2FpdCB0aGlzLmFkZFNjcmlwdFRvQ29udGFpbmVyKHNjcmlwdCwgU2NyaXB0VHlwZS5DSEFSQUNURVIpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBjaGFyYWN0ZXJDb250YWluZXIuYXBwZW5kKCc8c21hbGw+5peg5Yy56YWN55qE6KeS6Imy6ISa5pysPC9zbWFsbD4nKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5riF6Zmk5pCc57Si57uT5p6c77yM5oGi5aSN5q2j5bi45pi+56S6XG4gICAqL1xuICBwcml2YXRlIGNsZWFyU2VhcmNoKCk6IHZvaWQge1xuICAgIHRoaXMucmVuZGVyU2NyaXB0TGlzdHMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDorr7nva7mibnph4/mk43kvZzkuovku7ZcbiAgICovXG4gIHByaXZhdGUgc2V0dXBCYXRjaE9wZXJhdGlvbkV2ZW50cygpOiB2b2lkIHtcbiAgICAkKCcjZ2xvYmFsLWJhdGNoLW1hbmFnZXInKS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLnRvZ2dsZUJhdGNoTW9kZShTY3JpcHRUeXBlLkdMT0JBTCk7XG4gICAgfSk7XG5cbiAgICAkKCcjY2hhcmFjdGVyLWJhdGNoLW1hbmFnZXInKS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLnRvZ2dsZUJhdGNoTW9kZShTY3JpcHRUeXBlLkNIQVJBQ1RFUik7XG4gICAgfSk7XG5cbiAgICAkKCcjZ2xvYmFsLWJhdGNoLWRlbGV0ZScpLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMucGVyZm9ybUJhdGNoRGVsZXRlKFNjcmlwdFR5cGUuR0xPQkFMKTtcbiAgICB9KTtcblxuICAgICQoJyNnbG9iYWwtYmF0Y2gtZXhwb3J0Jykub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5wZXJmb3JtQmF0Y2hFeHBvcnQoU2NyaXB0VHlwZS5HTE9CQUwpO1xuICAgIH0pO1xuXG4gICAgJCgnI2dsb2JhbC1iYXRjaC1tb3ZlJykub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5wZXJmb3JtQmF0Y2hNb3ZlKFNjcmlwdFR5cGUuR0xPQkFMKTtcbiAgICB9KTtcblxuICAgICQoJyNnbG9iYWwtYmF0Y2gtY2FuY2VsJykub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5leGl0QmF0Y2hNb2RlKFNjcmlwdFR5cGUuR0xPQkFMKTtcbiAgICB9KTtcblxuICAgICQoJyNjaGFyYWN0ZXItYmF0Y2gtZGVsZXRlJykub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5wZXJmb3JtQmF0Y2hEZWxldGUoU2NyaXB0VHlwZS5DSEFSQUNURVIpO1xuICAgIH0pO1xuXG4gICAgJCgnI2NoYXJhY3Rlci1iYXRjaC1leHBvcnQnKS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLnBlcmZvcm1CYXRjaEV4cG9ydChTY3JpcHRUeXBlLkNIQVJBQ1RFUik7XG4gICAgfSk7XG5cbiAgICAkKCcjY2hhcmFjdGVyLWJhdGNoLW1vdmUnKS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLnBlcmZvcm1CYXRjaE1vdmUoU2NyaXB0VHlwZS5DSEFSQUNURVIpO1xuICAgIH0pO1xuXG4gICAgJCgnI2NoYXJhY3Rlci1iYXRjaC1jYW5jZWwnKS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLmV4aXRCYXRjaE1vZGUoU2NyaXB0VHlwZS5DSEFSQUNURVIpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOWIh+aNouaJuemHj+aooeW8j1xuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICovXG4gIHByaXZhdGUgdG9nZ2xlQmF0Y2hNb2RlKHR5cGU6IFNjcmlwdFR5cGUpOiB2b2lkIHtcbiAgICBjb25zdCBpc0JhdGNoTW9kZSA9IHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMID8gdGhpcy5iYXRjaE1vZGVHbG9iYWwgOiB0aGlzLmJhdGNoTW9kZUNoYXJhY3RlcjtcblxuICAgIGlmIChpc0JhdGNoTW9kZSkge1xuICAgICAgdGhpcy5leGl0QmF0Y2hNb2RlKHR5cGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmVudGVyQmF0Y2hNb2RlKHR5cGUpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDov5vlhaXmibnph4/mqKHlvI9cbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwcml2YXRlIGVudGVyQmF0Y2hNb2RlKHR5cGU6IFNjcmlwdFR5cGUpOiB2b2lkIHtcbiAgICBjb25zdCBsaXN0U2VsZWN0b3IgPSBnZXRTY3JpcHRMaXN0U2VsZWN0b3IodHlwZSk7XG4gICAgY29uc3QgY29udHJvbHNTZWxlY3RvciA9IGdldEJhdGNoQ29udHJvbHNTZWxlY3Rvcih0eXBlKTtcblxuICAgIGlmICh0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCkge1xuICAgICAgdGhpcy5iYXRjaE1vZGVHbG9iYWwgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmJhdGNoTW9kZUNoYXJhY3RlciA9IHRydWU7XG4gICAgfVxuXG4gICAgJChjb250cm9sc1NlbGVjdG9yKS5zaG93KCk7XG5cbiAgICBjb25zdCAkbGlzdCA9ICQobGlzdFNlbGVjdG9yKTtcblxuICAgICRsaXN0LmZpbmQoJy5zY3JpcHQtaXRlbScpLmVhY2goKF8sIGVsZW1lbnQpID0+IHtcbiAgICAgIGNvbnN0ICRlbGVtZW50ID0gJChlbGVtZW50KTtcbiAgICAgICRlbGVtZW50LmFkZENsYXNzKCdiYXRjaC1tb2RlJyk7XG4gICAgICAkZWxlbWVudC5maW5kKCcuc2NyaXB0LWNoZWNrYm94Jykuc2hvdygpO1xuICAgICAgJGVsZW1lbnQuZmluZCgnLmRyYWctaGFuZGxlJykuaGlkZSgpO1xuICAgICAgJGVsZW1lbnQuZmluZCgnLnNjcmlwdC1pdGVtLWNvbnRyb2wnKS5oaWRlKCk7XG5cbiAgICAgICRlbGVtZW50XG4gICAgICAgIC5maW5kKCcuc2NyaXB0LWNoZWNrYm94JylcbiAgICAgICAgLm9mZignY2hhbmdlLmJhdGNoJylcbiAgICAgICAgLm9uKCdjaGFuZ2UuYmF0Y2gnLCAoKSA9PiB7XG4gICAgICAgICAgdGhpcy5oYW5kbGVDaGVja2JveENoYW5nZSgkZWxlbWVudCk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgJGxpc3QuZmluZCgnLnNjcmlwdC1mb2xkZXInKS5lYWNoKChfLCBlbGVtZW50KSA9PiB7XG4gICAgICBjb25zdCAkZWxlbWVudCA9ICQoZWxlbWVudCk7XG4gICAgICAkZWxlbWVudC5hZGRDbGFzcygnYmF0Y2gtbW9kZScpO1xuICAgICAgJGVsZW1lbnQuZmluZCgnLmZvbGRlci1jaGVja2JveCcpLnNob3coKTtcbiAgICAgICRlbGVtZW50LmZpbmQoJy5kcmFnLWhhbmRsZScpLmhpZGUoKTtcbiAgICAgICRlbGVtZW50LmZpbmQoJy5mb2xkZXItY29udHJvbCAuZm9sZGVyLXNjcmlwdC10b2dnbGUnKS5oaWRlKCk7XG4gICAgICAkZWxlbWVudC5maW5kKCcuZm9sZGVyLWNvbnRyb2wgLmZvbGRlci1lZGl0JykuaGlkZSgpO1xuICAgICAgJGVsZW1lbnQuZmluZCgnLmZvbGRlci1jb250cm9sIC5mb2xkZXItZXhwb3J0JykuaGlkZSgpO1xuICAgICAgJGVsZW1lbnQuZmluZCgnLmZvbGRlci1jb250cm9sIC5mb2xkZXItbW92ZScpLmhpZGUoKTtcbiAgICAgICRlbGVtZW50LmZpbmQoJy5mb2xkZXItY29udHJvbCAuZm9sZGVyLWRlbGV0ZScpLmhpZGUoKTtcblxuICAgICAgJGVsZW1lbnRcbiAgICAgICAgLmZpbmQoJy5mb2xkZXItY2hlY2tib3gnKVxuICAgICAgICAub2ZmKCdjaGFuZ2UuYmF0Y2gnKVxuICAgICAgICAub24oJ2NoYW5nZS5iYXRjaCcsICgpID0+IHtcbiAgICAgICAgICB0aGlzLmhhbmRsZUNoZWNrYm94Q2hhbmdlKCRlbGVtZW50KTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog6YCA5Ye65om56YeP5qih5byPXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBleGl0QmF0Y2hNb2RlKHR5cGU6IFNjcmlwdFR5cGUpOiB2b2lkIHtcbiAgICBjb25zdCBsaXN0U2VsZWN0b3IgPSBnZXRTY3JpcHRMaXN0U2VsZWN0b3IodHlwZSk7XG4gICAgY29uc3QgY29udHJvbHNTZWxlY3RvciA9IGdldEJhdGNoQ29udHJvbHNTZWxlY3Rvcih0eXBlKTtcblxuICAgIGlmICh0eXBlID09PSBTY3JpcHRUeXBlLkdMT0JBTCkge1xuICAgICAgdGhpcy5iYXRjaE1vZGVHbG9iYWwgPSBmYWxzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5iYXRjaE1vZGVDaGFyYWN0ZXIgPSBmYWxzZTtcbiAgICB9XG5cbiAgICAkKGNvbnRyb2xzU2VsZWN0b3IpLmhpZGUoKTtcblxuICAgIGNvbnN0ICRsaXN0ID0gJChsaXN0U2VsZWN0b3IpO1xuXG4gICAgJGxpc3QuZmluZCgnLnNjcmlwdC1pdGVtLCAuc2NyaXB0LWZvbGRlcicpLmVhY2goKF8sIGVsZW1lbnQpID0+IHtcbiAgICAgIGNvbnN0ICRlbGVtZW50ID0gJChlbGVtZW50KTtcbiAgICAgICRlbGVtZW50LnJlbW92ZUNsYXNzKCdiYXRjaC1tb2RlIHNlbGVjdGVkJyk7XG4gICAgICAkZWxlbWVudC5maW5kKCcuc2NyaXB0LWNoZWNrYm94LCAuZm9sZGVyLWNoZWNrYm94JykuaGlkZSgpLnByb3AoJ2NoZWNrZWQnLCBmYWxzZSk7XG4gICAgICAkZWxlbWVudC5maW5kKCcuc2NyaXB0LWl0ZW0tY29udHJvbCcpLnNob3coKTtcbiAgICAgICRlbGVtZW50LmZpbmQoJy5kcmFnLWhhbmRsZScpLnNob3coKTtcbiAgICAgICRlbGVtZW50LmZpbmQoJy5zY3JpcHQtY29udHJvbHMnKS5zaG93KCk7XG4gICAgICAkZWxlbWVudC5maW5kKCcuZm9sZGVyLWNvbnRyb2wgLmZvbGRlci1zY3JpcHQtdG9nZ2xlJykuc2hvdygpO1xuICAgICAgJGVsZW1lbnQuZmluZCgnLmZvbGRlci1jb250cm9sIC5mb2xkZXItZWRpdCcpLnNob3coKTtcbiAgICAgICRlbGVtZW50LmZpbmQoJy5mb2xkZXItY29udHJvbCAuZm9sZGVyLWV4cG9ydCcpLnNob3coKTtcbiAgICAgICRlbGVtZW50LmZpbmQoJy5mb2xkZXItY29udHJvbCAuZm9sZGVyLW1vdmUnKS5zaG93KCk7XG4gICAgICAkZWxlbWVudC5maW5kKCcuZm9sZGVyLWNvbnRyb2wgLmZvbGRlci1kZWxldGUnKS5zaG93KCk7XG4gICAgICAkZWxlbWVudC5maW5kKCcuc2NyaXB0LWNoZWNrYm94LCAuZm9sZGVyLWNoZWNrYm94Jykub2ZmKCdjaGFuZ2UuYmF0Y2gnKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlpI3pgInmoYbnirbmgIHlj5jljJbml7bmt7vliqDpgInkuK3nirbmgIFjc3NcbiAgICogQHBhcmFtICRlbGVtZW50IOWFg+e0oGpRdWVyeeWvueixoVxuICAgKi9cbiAgcHJpdmF0ZSBoYW5kbGVDaGVja2JveENoYW5nZSgkZWxlbWVudDogSlF1ZXJ5PEhUTUxFbGVtZW50Pik6IHZvaWQge1xuICAgIGNvbnN0IGlzQ2hlY2tlZCA9ICRlbGVtZW50LmZpbmQoJy5zY3JpcHQtY2hlY2tib3gsIC5mb2xkZXItY2hlY2tib3gnKS5wcm9wKCdjaGVja2VkJyk7XG5cbiAgICBpZiAoaXNDaGVja2VkKSB7XG4gICAgICAkZWxlbWVudC5hZGRDbGFzcygnc2VsZWN0ZWQnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgJGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ3NlbGVjdGVkJyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPlumAieS4reeahOmhueebrlxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICogQHJldHVybnMg6YCJ5Lit55qE6ISa5pysSUTlkozmlofku7blpLlJROaVsOe7hFxuICAgKi9cbiAgcHJpdmF0ZSBnZXRTZWxlY3RlZEl0ZW1zKHR5cGU6IFNjcmlwdFR5cGUpOiB7IHNjcmlwdElkczogc3RyaW5nW107IGZvbGRlcklkczogc3RyaW5nW10gfSB7XG4gICAgY29uc3QgbGlzdFNlbGVjdG9yID0gZ2V0U2NyaXB0TGlzdFNlbGVjdG9yKHR5cGUpO1xuICAgIGNvbnN0IHNjcmlwdElkczogc3RyaW5nW10gPSBbXTtcbiAgICBjb25zdCBmb2xkZXJJZHM6IHN0cmluZ1tdID0gW107XG5cbiAgICAkKGxpc3RTZWxlY3RvcilcbiAgICAgIC5maW5kKCcuc2NyaXB0LWl0ZW0uc2VsZWN0ZWQnKVxuICAgICAgLmVhY2goKF8sIGVsZW1lbnQpID0+IHtcbiAgICAgICAgY29uc3QgaWQgPSAkKGVsZW1lbnQpLmF0dHIoJ2lkJyk7XG4gICAgICAgIGlmIChpZCkgc2NyaXB0SWRzLnB1c2goaWQpO1xuICAgICAgfSk7XG5cbiAgICAkKGxpc3RTZWxlY3RvcilcbiAgICAgIC5maW5kKCcuc2NyaXB0LWZvbGRlci5zZWxlY3RlZCcpXG4gICAgICAuZWFjaCgoXywgZWxlbWVudCkgPT4ge1xuICAgICAgICBjb25zdCBpZCA9ICQoZWxlbWVudCkuYXR0cignaWQnKTtcbiAgICAgICAgaWYgKGlkKSBmb2xkZXJJZHMucHVzaChpZCk7XG4gICAgICB9KTtcblxuICAgIHJldHVybiB7IHNjcmlwdElkcywgZm9sZGVySWRzIH07XG4gIH1cblxuICAvKipcbiAgICog5omn6KGM5om56YeP5Yig6ZmkXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBwZXJmb3JtQmF0Y2hEZWxldGUodHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHsgc2NyaXB0SWRzLCBmb2xkZXJJZHMgfSA9IHRoaXMuZ2V0U2VsZWN0ZWRJdGVtcyh0eXBlKTtcblxuICAgIGlmIChzY3JpcHRJZHMubGVuZ3RoID09PSAwICYmIGZvbGRlcklkcy5sZW5ndGggPT09IDApIHtcbiAgICAgIHRvYXN0ci53YXJuaW5nKCfor7foh7PlsJHpgInmi6nkuIDkuKrpobnnm67ov5vooYzliKDpmaQnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCB0b3RhbENvdW50ID0gc2NyaXB0SWRzLmxlbmd0aCArIGZvbGRlcklkcy5sZW5ndGg7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2FsbEdlbmVyaWNQb3B1cChcbiAgICAgIGDnoa7lrpropoHliKDpmaTpgInkuK3nmoQgJHt0b3RhbENvdW50fSDkuKrpobnnm67lkJfvvJ/mraTmk43kvZzkuI3lj6/mkqTplIDjgIJgLFxuICAgICAgUE9QVVBfVFlQRS5DT05GSVJNLFxuICAgICAgJycsXG4gICAgICB7IG9rQnV0dG9uOiAn5Yig6ZmkJywgY2FuY2VsQnV0dG9uOiAn5Y+W5raIJyB9LFxuICAgICk7XG5cbiAgICBpZiAoIXJlc3VsdCkgcmV0dXJuO1xuXG4gICAgdHJ5IHtcbiAgICAgIGZvciAoY29uc3Qgc2NyaXB0SWQgb2Ygc2NyaXB0SWRzKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuc2NyaXB0TWFuYWdlci5kZWxldGVTY3JpcHQoc2NyaXB0SWQsIHR5cGUpO1xuICAgICAgfVxuXG4gICAgICBmb3IgKGNvbnN0IGZvbGRlcklkIG9mIGZvbGRlcklkcykge1xuICAgICAgICBhd2FpdCB0aGlzLmhhbmRsZUZvbGRlckRlbGV0ZShmb2xkZXJJZCwgdHlwZSwgdHJ1ZSk7XG4gICAgICB9XG5cbiAgICAgIHRvYXN0ci5zdWNjZXNzKGDmiJDlip/liKDpmaQgJHt0b3RhbENvdW50fSDkuKrpobnnm65gKTtcblxuICAgICAgdGhpcy5leGl0QmF0Y2hNb2RlKHR5cGUpO1xuICAgICAgYXdhaXQgdGhpcy5yZW5kZXJTY3JpcHRMaXN0cygpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2cuZXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDmibnph4/liKDpmaTlpLHotKU6JywgZXJyb3IpO1xuICAgICAgdG9hc3RyLmVycm9yKGDmibnph4/liKDpmaTlpLHotKU6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpfWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmiafooYzmibnph4/lr7zlh7pcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHBlcmZvcm1CYXRjaEV4cG9ydCh0eXBlOiBTY3JpcHRUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgeyBzY3JpcHRJZHMsIGZvbGRlcklkcyB9ID0gdGhpcy5nZXRTZWxlY3RlZEl0ZW1zKHR5cGUpO1xuXG4gICAgaWYgKHNjcmlwdElkcy5sZW5ndGggPT09IDAgJiYgZm9sZGVySWRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdG9hc3RyLndhcm5pbmcoJ+ivt+iHs+WwkemAieaLqeS4gOS4qumhueebrui/m+ihjOWvvOWHuicpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICAvL0B0cy1pZ25vcmVcbiAgICAgIGlmICghd2luZG93LkpTWmlwKSB7XG4gICAgICAgIGF3YWl0IGltcG9ydCgnQHNpbGx5dGF2ZXJuL2xpYi9qc3ppcC5taW4uanMnKTtcbiAgICAgIH1cbiAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgY29uc3QgemlwID0gbmV3IEpTWmlwKCk7XG4gICAgICBsZXQgZXhwb3J0ZWRDb3VudCA9IDA7XG5cbiAgICAgIGxldCBjYW5jZWxFeHBvcnQgPSBmYWxzZTtcblxuICAgICAgZm9yIChjb25zdCBzY3JpcHRJZCBvZiBzY3JpcHRJZHMpIHtcbiAgICAgICAgY29uc3Qgc2NyaXB0ID0gdGhpcy5zY3JpcHRNYW5hZ2VyLmdldFNjcmlwdEJ5SWQoc2NyaXB0SWQpO1xuICAgICAgICBpZiAoc2NyaXB0KSB7XG4gICAgICAgICAgY29uc3Qgc2NyaXB0RGF0YSA9IGF3YWl0IHRoaXMuY2hlY2tTY3JpcHREYXRhQW5kR2V0RXhwb3J0RGF0YShzY3JpcHQpO1xuXG4gICAgICAgICAgaWYgKHNjcmlwdERhdGEgPT09IG51bGwpIHtcbiAgICAgICAgICAgIGNhbmNlbEV4cG9ydCA9IHRydWU7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb25zdCBzY3JpcHRGaWxlTmFtZSA9IGAke3NjcmlwdC5uYW1lLnJlcGxhY2UoL1s8PjpcIi9cXFxcfD8qXS9nLCAnXycpfS5qc29uYDtcbiAgICAgICAgICB6aXAuZmlsZShzY3JpcHRGaWxlTmFtZSwgSlNPTi5zdHJpbmdpZnkoc2NyaXB0RGF0YSwgbnVsbCwgMikpO1xuICAgICAgICAgIGV4cG9ydGVkQ291bnQrKztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoY2FuY2VsRXhwb3J0KSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcmVwb3NpdG9yeSA9XG4gICAgICAgIHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMXG4gICAgICAgICAgPyB0aGlzLnNjcmlwdE1hbmFnZXIuZ2V0R2xvYmFsUmVwb3NpdG9yeUl0ZW1zKClcbiAgICAgICAgICA6IHRoaXMuc2NyaXB0TWFuYWdlci5nZXRDaGFyYWN0ZXJSZXBvc2l0b3J5SXRlbXMoKTtcblxuICAgICAgZm9yIChjb25zdCBmb2xkZXJJZCBvZiBmb2xkZXJJZHMpIHtcbiAgICAgICAgY29uc3QgZm9sZGVyID0gcmVwb3NpdG9yeS5maW5kKGl0ZW0gPT4gaXRlbS50eXBlID09PSAnZm9sZGVyJyAmJiBpdGVtLmlkID09PSBmb2xkZXJJZCk7XG4gICAgICAgIGlmIChmb2xkZXIpIHtcbiAgICAgICAgICBjb25zdCBmb2xkZXJOYW1lID0gZm9sZGVyLm5hbWUgfHwgJ2ZvbGRlcic7XG4gICAgICAgICAgY29uc3Qgc2FuaXRpemVkRm9sZGVyTmFtZSA9IGZvbGRlck5hbWUucmVwbGFjZSgvWzw+OlwiL1xcXFx8PypdL2csICdfJyk7XG5cbiAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShmb2xkZXIudmFsdWUpKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHNjcmlwdCBvZiBmb2xkZXIudmFsdWUpIHtcbiAgICAgICAgICAgICAgY29uc3Qgc2NyaXB0RGF0YSA9IGF3YWl0IHRoaXMuY2hlY2tTY3JpcHREYXRhQW5kR2V0RXhwb3J0RGF0YShzY3JpcHQpO1xuXG4gICAgICAgICAgICAgIGlmIChzY3JpcHREYXRhID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY2FuY2VsRXhwb3J0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGNvbnN0IHNjcmlwdEZpbGVOYW1lID0gYCR7c2NyaXB0Lm5hbWUucmVwbGFjZSgvWzw+OlwiL1xcXFx8PypdL2csICdfJyl9Lmpzb25gO1xuICAgICAgICAgICAgICB6aXAuZmlsZShgJHtzYW5pdGl6ZWRGb2xkZXJOYW1lfS8ke3NjcmlwdEZpbGVOYW1lfWAsIEpTT04uc3RyaW5naWZ5KHNjcmlwdERhdGEsIG51bGwsIDIpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGNhbmNlbEV4cG9ydCkge1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgZXhwb3J0ZWRDb3VudCsrO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChjYW5jZWxFeHBvcnQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAoZXhwb3J0ZWRDb3VudCA9PT0gMCkge1xuICAgICAgICB0b2FzdHIuZXJyb3IoJ+ayoeacieaJvuWIsOacieaViOeahOWvvOWHuuaVsOaNricpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHppcEJsb2IgPSBhd2FpdCB6aXAuZ2VuZXJhdGVBc3luYyh7IHR5cGU6ICdibG9iJyB9KTtcblxuICAgICAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNsaWNlKDAsIDE5KS5yZXBsYWNlKC86L2csICctJyk7XG4gICAgICBjb25zdCB0eXBlTmFtZSA9IHR5cGUgPT09IFNjcmlwdFR5cGUuR0xPQkFMID8gJ2dsb2JhbCcgOiAnY2hhcmFjdGVyJztcbiAgICAgIGNvbnN0IGZpbGVuYW1lID0gYGJhdGNoX2V4cG9ydF8ke3R5cGVOYW1lfV8ke3RpbWVzdGFtcH0uemlwYDtcblxuICAgICAgY29uc3QgdXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTCh6aXBCbG9iKTtcbiAgICAgIGNvbnN0IGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgICBhLmhyZWYgPSB1cmw7XG4gICAgICBhLmRvd25sb2FkID0gZmlsZW5hbWU7XG4gICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGEpO1xuICAgICAgYS5jbGljaygpO1xuICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChhKTtcbiAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwodXJsKTtcblxuICAgICAgdG9hc3RyLnN1Y2Nlc3MoYOaIkOWKn+WvvOWHuiAke2V4cG9ydGVkQ291bnR9IOS4qumhueebrmApO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2cuZXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDmibnph4/lr7zlh7rlpLHotKU6JywgZXJyb3IpO1xuICAgICAgdG9hc3RyLmVycm9yKGDmibnph4/lr7zlh7rlpLHotKU6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpfWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmiafooYzmibnph4/np7vliqjliLDmlofku7blpLlcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHBlcmZvcm1CYXRjaE1vdmUodHlwZTogU2NyaXB0VHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHsgc2NyaXB0SWRzLCBmb2xkZXJJZHMgfSA9IHRoaXMuZ2V0U2VsZWN0ZWRJdGVtcyh0eXBlKTtcblxuICAgIGlmIChmb2xkZXJJZHMubGVuZ3RoID4gMCkge1xuICAgICAgdG9hc3RyLmVycm9yKCfkuI3og73np7vliqjmlofku7blpLnvvIzor7flj6rpgInmi6nohJrmnKzov5vooYznp7vliqjmk43kvZwnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoc2NyaXB0SWRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdG9hc3RyLndhcm5pbmcoJ+ivt+iHs+WwkemAieaLqeS4gOS4quiEmuacrOi/m+ihjOenu+WKqCcpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXBvc2l0b3J5ID1cbiAgICAgICAgdHlwZSA9PT0gU2NyaXB0VHlwZS5HTE9CQUxcbiAgICAgICAgICA/IHRoaXMuc2NyaXB0TWFuYWdlci5nZXRHbG9iYWxSZXBvc2l0b3J5SXRlbXMoKVxuICAgICAgICAgIDogdGhpcy5zY3JpcHRNYW5hZ2VyLmdldENoYXJhY3RlclJlcG9zaXRvcnlJdGVtcygpO1xuXG4gICAgICBjb25zdCBmb2xkZXJzID0gcmVwb3NpdG9yeS5maWx0ZXIoaXRlbSA9PiBpdGVtLnR5cGUgPT09ICdmb2xkZXInKTtcblxuICAgICAgaWYgKGZvbGRlcnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHRvYXN0ci5lcnJvcign5rKh5pyJ5Y+v55So55qE5paH5Lu25aS577yM6K+35YWI5Yib5bu65LiA5Liq5paH5Lu25aS5Jyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZm9sZGVyT3B0aW9ucyA9IGZvbGRlcnMubWFwKGZvbGRlciA9PiBgPG9wdGlvbiB2YWx1ZT1cIiR7Zm9sZGVyLmlkfVwiPiR7Zm9sZGVyLm5hbWV9PC9vcHRpb24+YCkuam9pbignJyk7XG5cbiAgICAgIGNvbnN0IHRlbXBsYXRlID0gJChgXG4gICAgICAgIDxkaXY+XG4gICAgICAgICAgPHA+6YCJ5oup6KaB56e75Yqo5Yiw55qE5paH5Lu25aS577yaPC9wPlxuICAgICAgICAgIDxzZWxlY3QgaWQ9XCJ0YXJnZXQtZm9sZGVyLXNlbGVjdFwiIGNsYXNzPVwidGV4dF9wb2xlXCIgc3R5bGU9XCJ3aWR0aDogMTAwJTtcIj5cbiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCJcIj7moLnnm67lvZU8L29wdGlvbj5cbiAgICAgICAgICAgICR7Zm9sZGVyT3B0aW9uc31cbiAgICAgICAgICA8L3NlbGVjdD5cbiAgICAgICAgPC9kaXY+XG4gICAgICBgKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2FsbEdlbmVyaWNQb3B1cCh0ZW1wbGF0ZSwgUE9QVVBfVFlQRS5DT05GSVJNLCAnJywge1xuICAgICAgICBva0J1dHRvbjogJ+enu+WKqCcsXG4gICAgICAgIGNhbmNlbEJ1dHRvbjogJ+WPlua2iCcsXG4gICAgICB9KTtcblxuICAgICAgaWYgKCFyZXN1bHQpIHJldHVybjtcblxuICAgICAgY29uc3QgdGFyZ2V0Rm9sZGVySWQgPSAodGVtcGxhdGUuZmluZCgnI3RhcmdldC1mb2xkZXItc2VsZWN0JykudmFsKCkgYXMgc3RyaW5nKSB8fCBudWxsO1xuXG4gICAgICBmb3IgKGNvbnN0IHNjcmlwdElkIG9mIHNjcmlwdElkcykge1xuICAgICAgICBhd2FpdCB0aGlzLnNjcmlwdE1hbmFnZXIubW92ZVNjcmlwdFRvRm9sZGVyKHNjcmlwdElkLCB0YXJnZXRGb2xkZXJJZCwgdHlwZSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHRhcmdldE5hbWUgPSB0YXJnZXRGb2xkZXJJZCA/IGZvbGRlcnMuZmluZChmID0+IGYuaWQgPT09IHRhcmdldEZvbGRlcklkKT8ubmFtZSB8fCAn5pyq55+l5paH5Lu25aS5JyA6ICfmoLnnm67lvZUnO1xuXG4gICAgICB0b2FzdHIuc3VjY2Vzcyhg5oiQ5Yqf5bCGICR7c2NyaXB0SWRzLmxlbmd0aH0g5Liq6ISa5pys56e75Yqo5YiwXCIke3RhcmdldE5hbWV9XCJgKTtcblxuICAgICAgdGhpcy5leGl0QmF0Y2hNb2RlKHR5cGUpO1xuICAgICAgYXdhaXQgdGhpcy5yZW5kZXJTY3JpcHRMaXN0cygpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2cuZXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDmibnph4/np7vliqjlpLHotKU6JywgZXJyb3IpO1xuICAgICAgdG9hc3RyLmVycm9yKGDmibnph4/np7vliqjlpLHotKU6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpfWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDlpITnkIbmlofku7blpLnliJvlu7rkuovku7ZcbiAgICogQHBhcmFtIG5hbWUg5paH5Lu25aS55ZCN56ewXG4gICAqIEBwYXJhbSB0eXBlIOiEmuacrOexu+Wei1xuICAgKiBAcGFyYW0gaWNvbiDmlofku7blpLnlm77moIdcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgaGFuZGxlRm9sZGVyQ3JlYXRlKG5hbWU6IHN0cmluZywgdHlwZTogU2NyaXB0VHlwZSwgaWNvbj86IHN0cmluZywgY29sb3I/OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgdGhpcy5zY3JpcHRNYW5hZ2VyLmNyZWF0ZUZvbGRlcihuYW1lLCB0eXBlLCBpY29uLCBjb2xvcik7XG4gICAgICBhd2FpdCB0aGlzLnJlbmRlclNjcmlwdExpc3RzKCk7XG4gICAgICB0b2FzdHIuc3VjY2Vzcyhg5paH5Lu25aS5IFwiJHtuYW1lfVwiIOWIm+W7uuaIkOWKn2ApO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2cuZXJyb3IoJ1tTY3JpcHRNYW5hZ2VyXSDliJvlu7rmlofku7blpLnlpLHotKU6JywgZXJyb3IpO1xuICAgICAgdG9hc3RyLmVycm9yKGDliJvlu7rmlofku7blpLnlpLHotKU6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpfWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDlpITnkIbmlofku7blpLnnvJbovpHkuovku7ZcbiAgICogQHBhcmFtIGZvbGRlcklkIOaWh+S7tuWkuUlEXG4gICAqIEBwYXJhbSBuZXdOYW1lIOaWsOWQjeensFxuICAgKiBAcGFyYW0gdHlwZSDohJrmnKznsbvlnotcbiAgICogQHBhcmFtIG5ld0ljb24g5paw5Zu+5qCHXG4gICAqIEBwYXJhbSBuZXdDb2xvciDmlrDpopzoibJcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgaGFuZGxlRm9sZGVyRWRpdChcbiAgICBmb2xkZXJJZDogc3RyaW5nLFxuICAgIG5ld05hbWU6IHN0cmluZyxcbiAgICB0eXBlOiBTY3JpcHRUeXBlLFxuICAgIG5ld0ljb24/OiBzdHJpbmcsXG4gICAgbmV3Q29sb3I/OiBzdHJpbmcsXG4gICk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCB0aGlzLnNjcmlwdE1hbmFnZXIuZWRpdEZvbGRlcihmb2xkZXJJZCwgbmV3TmFtZSwgdHlwZSwgbmV3SWNvbiwgbmV3Q29sb3IpO1xuXG4gICAgICBpZiAobmV3TmFtZSkge1xuICAgICAgICAkKGAjJHtmb2xkZXJJZH0gLmZvbGRlci1uYW1lYCkudGV4dChuZXdOYW1lKTtcbiAgICAgIH1cblxuICAgICAgaWYgKG5ld0ljb24pIHtcbiAgICAgICAgJChgIyR7Zm9sZGVySWR9IC5mb2xkZXItaWNvbmApLnJlbW92ZUNsYXNzKCkuYWRkQ2xhc3MoYGZhICR7bmV3SWNvbn0gZm9sZGVyLWljb24gbWFyZ2luTGVmdDVgKTtcbiAgICAgIH1cblxuICAgICAgaWYgKG5ld0NvbG9yKSB7XG4gICAgICAgICQoYCMke2ZvbGRlcklkfSAuZm9sZGVyLWljb25gKS5jc3MoJ2NvbG9yJywgbmV3Q29sb3IpO1xuICAgICAgICAkKGAjJHtmb2xkZXJJZH0gLmZvbGRlci1oZWFkZXJgKS5jc3MoJ2JvcmRlci1sZWZ0LWNvbG9yJywgbmV3Q29sb3IpO1xuICAgICAgfVxuXG4gICAgICB0b2FzdHIuc3VjY2Vzcyhg5paH5Lu25aS55pu05paw5oiQ5YqfYCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZy5lcnJvcignW1NjcmlwdE1hbmFnZXJdIOabtOaWsOaWh+S7tuWkueWksei0pTonLCBlcnJvcik7XG4gICAgICB0b2FzdHIuZXJyb3IoYOabtOaWsOaWh+S7tuWkueWksei0pTogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcil9YCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWkhOeQhuaWh+S7tuWkueWIoOmZpOS6i+S7tlxuICAgKiBAcGFyYW0gZm9sZGVySWQg5paH5Lu25aS5SURcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqIEBwYXJhbSBza2lwVUlSZWZyZXNoIOaYr+WQpui3s+i/h1VJ5Yi35paw77yI55So5LqO5om56YeP5pON5L2c77yJXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGhhbmRsZUZvbGRlckRlbGV0ZShmb2xkZXJJZDogc3RyaW5nLCB0eXBlOiBTY3JpcHRUeXBlLCBza2lwVUlSZWZyZXNoOiBib29sZWFuID0gZmFsc2UpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgdGhpcy5zY3JpcHRNYW5hZ2VyLmRlbGV0ZUZvbGRlcihmb2xkZXJJZCwgdHlwZSk7XG4gICAgICBpZiAoIXNraXBVSVJlZnJlc2gpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5yZW5kZXJTY3JpcHRMaXN0cygpO1xuICAgICAgICB0b2FzdHIuc3VjY2Vzcygn5paH5Lu25aS55Yig6Zmk5oiQ5YqfJyk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZy5lcnJvcignW1NjcmlwdE1hbmFnZXJdIOWIoOmZpOaWh+S7tuWkueWksei0pTonLCBlcnJvcik7XG4gICAgICBpZiAoIXNraXBVSVJlZnJlc2gpIHtcbiAgICAgICAgdG9hc3RyLmVycm9yKGDliKDpmaTmlofku7blpLnlpLHotKU6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpfWApO1xuICAgICAgfVxuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWkhOeQhuaWh+S7tuWkueiEmuacrOaJuemHj+W8gOWFs1xuICAgKiBAcGFyYW0gZm9sZGVySWQg5paH5Lu25aS5SURcbiAgICogQHBhcmFtIHR5cGUg6ISa5pys57G75Z6LXG4gICAqIEBwYXJhbSBlbmFibGUg5piv5ZCm5ZCv55SoXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGhhbmRsZUZvbGRlclNjcmlwdHNUb2dnbGUoZm9sZGVySWQ6IHN0cmluZywgdHlwZTogU2NyaXB0VHlwZSwgZW5hYmxlOiBib29sZWFuKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHRoaXMuc2NyaXB0TWFuYWdlci50b2dnbGVGb2xkZXJTY3JpcHRzKGZvbGRlcklkLCB0eXBlLCBlbmFibGUpO1xuICAgICAgdGhpcy51cGRhdGVGb2xkZXJBbmRTY3JpcHRzVUkoZm9sZGVySWQsIHR5cGUsIGVuYWJsZSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZy5lcnJvcignW1NjcmlwdE1hbmFnZXJdIOaJuemHj+WIh+aNouaWh+S7tuWkueiEmuacrOeKtuaAgeWksei0pTonLCBlcnJvcik7XG4gICAgICB0b2FzdHIuZXJyb3IoYOaJuemHj+WIh+aNouiEmuacrOeKtuaAgeWksei0pTogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICfmnKrnn6XplJnor68nfWApO1xuICAgIH1cbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/component/script_repository/ui_controller.ts\n")},"./src/component/toastr.ts":
/*!*********************************!*\
  !*** ./src/component/toastr.ts ***!
  \*********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   initializeToastr: () => (/* binding */ initializeToastr)\n/* harmony export */ });\nfunction initializeToastr() {\n    globalThis.toastr = toastr;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3RvYXN0ci50cyIsIm1hcHBpbmdzIjoiOzs7O0FBSU8sU0FBUyxnQkFBZ0I7SUFDOUIsVUFBVSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7QUFDN0IsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9jb21wb25lbnQvdG9hc3RyLnRzPzg3YzYiXSwic291cmNlc0NvbnRlbnQiOlsiZGVjbGFyZSBuYW1lc3BhY2UgZ2xvYmFsVGhpcyB7XG4gIGxldCB0b2FzdHI6IHR5cGVvZiBpbXBvcnQoJ3RvYXN0cicpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaW5pdGlhbGl6ZVRvYXN0cigpIHtcbiAgZ2xvYmFsVGhpcy50b2FzdHIgPSB0b2FzdHI7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/component/toastr.ts\n")},"./src/component/variable_manager/card.ts":
/*!************************************************!*\
  !*** ./src/component/variable_manager/card.ts ***!
  \************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VariableCardFactory: () => (/* binding */ VariableCardFactory)\n/* harmony export */ });\n/* harmony import */ var _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/variable_manager/util */ \"./src/component/variable_manager/util.ts\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\nclass VariableCardFactory {\n    defaultTypeDialogCallback;\n    /**\n     * 构造函数\n     * @param defaultTypeDialogCallback 默认的类型选择对话框回调函数\n     */\n    constructor(defaultTypeDialogCallback) {\n        this.defaultTypeDialogCallback = defaultTypeDialogCallback;\n        this.setupGlobalEventDelegation();\n    }\n    /**\n     * 设置全局事件委托\n     */\n    setupGlobalEventDelegation() {\n        $(document).on('click', '.variable-action-btn.object-save-btn', event => {\n            event.stopPropagation();\n            event.stopImmediatePropagation();\n            const $button = $(event.currentTarget);\n            const $nestedCard = $button.closest('.variable-card');\n            const $parentCard = this.findTopLevelCard($nestedCard);\n            if ($parentCard) {\n                this.saveNestedCardValue($parentCard);\n            }\n        });\n        $(document).on('click', '.variable-action-btn.object-delete-btn', event => {\n            event.stopPropagation();\n            event.stopImmediatePropagation();\n            const $button = $(event.currentTarget);\n            const $nestedCard = $button.closest('.variable-card');\n            const $parentCard = this.findTopLevelCard($nestedCard);\n            if ($parentCard) {\n                this.deleteNestedCardValue($parentCard, $nestedCard);\n            }\n        });\n        $(document).on('click', '.variable-action-btn.add-nested-key-btn', async (event) => {\n            event.stopPropagation();\n            event.stopImmediatePropagation();\n            const $button = $(event.currentTarget);\n            const $card = $button.closest('.variable-card');\n            const dialogCallback = this.defaultTypeDialogCallback;\n            if (dialogCallback) {\n                await dialogCallback((dataType) => {\n                    this.addObjectKey($card, dataType, this.defaultTypeDialogCallback);\n                });\n            }\n            else {\n                loglevel__WEBPACK_IMPORTED_MODULE_2___default().error('添加卡片出错');\n                toastr.error('添加卡片出错');\n            }\n        });\n        $(document).on('click', '.variable-action-btn.add-key-btn', async (event) => {\n            event.stopPropagation();\n            event.stopImmediatePropagation();\n            const $button = $(event.currentTarget);\n            const $card = $button.closest('.variable-card');\n            const dialogCallback = this.defaultTypeDialogCallback;\n            if (dialogCallback) {\n                await dialogCallback((dataType) => {\n                    this.addObjectKey($card, dataType, this.defaultTypeDialogCallback);\n                });\n            }\n            else {\n                loglevel__WEBPACK_IMPORTED_MODULE_2___default().error('未提供类型选择对话框回调函数');\n                toastr.error('未提供类型选择对话框回调函数');\n            }\n        });\n    }\n    /**\n     * 创建变量卡片\n     * @param variable 变量\n     * @param isNested 是否为嵌套卡片\n     * @param showTypeDialogCallback 显示类型选择对话框的回调函数（仅用于对象类型）\n     * @returns 变量卡片jQuery对象\n     */\n    createCard(variable, isNested, showTypeDialogCallback) {\n        let card;\n        const { name, value, dataType, id } = variable;\n        card = $(`\n      <div class=\"variable-card\" data-type=\"${dataType}\" data-variable-id=\"${id}\">\n        <div class=\"variable-card-header\">\n          <div class=\"variable-title-container\">\n            <i></i>\n            <input type=\"text\" class=\"variable-title\" value=\"${name}\" placeholder=\"变量名称\">\n          </div>\n          <div class=\"variable-actions\">\n            <div class=\"variable-action-btn save-btn\" title=\"保存\">\n              <i class=\"fa-regular fa-save\"></i>\n            </div>\n            <div class=\"variable-action-btn delete-btn\" title=\"删除\">\n              <i class=\"fa-regular fa-trash-can\"></i>\n            </div>\n          </div>\n        </div>\n        <div class=\"variable-card-content\">\n        </div>\n      </div>\n    `);\n        if (isNested) {\n            card.removeAttr('data-variable-id');\n            card\n                .find('.variable-action-btn.save-btn')\n                .removeClass('save-btn')\n                .addClass('object-save-btn')\n                .end()\n                .find('.variable-action-btn.delete-btn')\n                .removeClass('delete-btn')\n                .addClass('object-delete-btn');\n        }\n        switch (dataType) {\n            case 'array':\n                card\n                    .find('.variable-title-container i')\n                    .addClass('fa-solid fa-list')\n                    .end()\n                    .find('.variable-card-content')\n                    .append(`<div class=\"list-items-container\"></div><div class=\"add-list-item\"><i class=\"fa-solid fa-plus\"></i> 添加项目</div>`);\n                this.populateArrayItems(card, value);\n                {\n                    const listContainer = card.find('.list-items-container');\n                    listContainer.sortable({\n                        delay: (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_1__.getSortableDelay)(),\n                        handle: '.drag-handle',\n                    });\n                }\n                break;\n            case 'object':\n                card.find('.variable-title-container i').addClass('fa-regular fa-code');\n                this.setupObjectCard(card, variable, isNested, showTypeDialogCallback);\n                break;\n            case 'boolean':\n                card\n                    .find('.variable-title-container i')\n                    .addClass('fa-regular fa-toggle-on')\n                    .end()\n                    .find('.variable-card-content')\n                    .append(`\n              <div class=\"boolean-input-container\">\n                <div class=\"boolean-buttons-container\">\n                  <div class=\"boolean-btn ${value ? 'active' : ''}\" data-value=\"true\">True</div>\n                  <div class=\"boolean-btn ${!value ? 'active' : ''}\" data-value=\"false\">False</div>\n                </div>\n              </div>\n            `)\n                    .find('.boolean-btn')\n                    .on('click', function () {\n                    card.find('.boolean-btn').removeClass('active');\n                    $(this).addClass('active');\n                });\n                break;\n            case 'number':\n                card\n                    .find('.variable-title-container i')\n                    .addClass('fa-solid fa-hashtag')\n                    .end()\n                    .find('.variable-card-content')\n                    .append(`<input type=\"number\" class=\"number-input variable-content-input\" value=\"${value}\" step=\"any\">`);\n                break;\n            case 'string':\n                card\n                    .find('.variable-title-container i')\n                    .addClass('fa-solid fa-font')\n                    .end()\n                    .find('.variable-card-content')\n                    .append(`<textarea class=\"string-input variable-content-input\" placeholder=\"输入字符串值\">${value}</textarea>`);\n                break;\n        }\n        return card;\n    }\n    /**\n     * 从卡片获取变量信息\n     * @param card 变量卡片\n     * @returns 变量信息\n     */\n    getVariableFromCard(card) {\n        const id = card.attr('data-variable-id') || '';\n        const name = card.find('.variable-title').val();\n        const dataType = card.attr('data-type');\n        const value = this.extractValueFromCard(card, dataType);\n        return {\n            id,\n            name,\n            dataType,\n            value,\n        };\n    }\n    /**\n     * 从卡片提取值（统一处理所有类型的卡片值提取）\n     * @param card 卡片\n     * @param dataType 数据类型\n     * @returns 提取的值\n     */\n    extractValueFromCard(card, dataType) {\n        switch (dataType) {\n            case 'string':\n                return card.find('.string-input').val();\n            case 'number': {\n                const numberValue = card.find('.number-input').val();\n                return numberValue ? parseFloat(numberValue) : 0;\n            }\n            case 'boolean':\n                return card.find('.boolean-btn.active').attr('data-value') === 'true';\n            case 'array': {\n                const arrayItems = [];\n                card.find('.list-item').each((_, elem) => {\n                    const $listItem = $(elem);\n                    const itemValue = $listItem.find('.variable-content-input').val();\n                    try {\n                        arrayItems.push(JSON.parse(itemValue));\n                    }\n                    catch {\n                        arrayItems.push(itemValue);\n                    }\n                });\n                return arrayItems;\n            }\n            case 'object': {\n                const viewMode = card.attr('data-view-mode') || 'card';\n                if (viewMode === 'card') {\n                    const extracted = this.extractObjectFromNestedCards(card);\n                    return extracted;\n                }\n                const jsonValue = card.find('.json-input').val();\n                if (jsonValue && jsonValue.trim()) {\n                    try {\n                        const parsed = JSON.parse(jsonValue);\n                        return parsed;\n                    }\n                    catch (e) {\n                        loglevel__WEBPACK_IMPORTED_MODULE_2___default().error('JSON解析错误:', e);\n                        toastr.error('JSON解析错误');\n                        return {};\n                    }\n                }\n                else {\n                    const extracted = this.extractObjectFromNestedCards(card);\n                    return extracted;\n                }\n            }\n            default:\n                return card.find('.variable-content-input').val();\n        }\n    }\n    /**\n     * 从嵌套卡片提取对象值\n     * @param card 对象卡片\n     * @returns 提取的对象值\n     */\n    extractObjectFromNestedCards(card) {\n        const result = {};\n        let $container = card.find('> .variable-card-content > .object-card-view > .nested-cards-container');\n        if ($container.length === 0) {\n            $container = card.find('> .variable-card-content > .nested-object-container > .nested-cards-container');\n        }\n        if ($container.length === 0) {\n            $container = card.find('.nested-cards-container').first();\n        }\n        $container.children('.variable-card').each((_index, element) => {\n            const $nestedCard = $(element);\n            const key = $nestedCard.find('.variable-title').val();\n            const nestedDataType = $nestedCard.attr('data-type');\n            loglevel__WEBPACK_IMPORTED_MODULE_2___default().info('[VariableManager] 处理嵌套卡片:', {\n                index: _index,\n                key: key,\n                dataType: nestedDataType,\n                cardHtml: $nestedCard[0].outerHTML.substring(0, 200) + '...',\n            });\n            if (key) {\n                const nestedValue = this.extractValueFromCard($nestedCard, nestedDataType);\n                result[key] = nestedValue;\n            }\n            else {\n                loglevel__WEBPACK_IMPORTED_MODULE_2___default().warn('[VariableManager] 跳过空键的嵌套卡片:', _index);\n            }\n        });\n        loglevel__WEBPACK_IMPORTED_MODULE_2___default().info('[VariableManager] 最终提取结果:', result);\n        return result;\n    }\n    /**\n     * 渲染对象卡片的卡片视图\n     * @param card 对象卡片jQuery对象\n     * @param variable 对象变量\n     * @param showTypeDialogCallback 显示类型选择对话框的回调函数\n     */\n    renderObjectCardView(card, variable, showTypeDialogCallback) {\n        const $container = card.find('.nested-cards-container');\n        $container.empty();\n        if (!variable.value || typeof variable.value !== 'object') {\n            return;\n        }\n        Object.entries(variable.value).forEach(([key, propertyValue]) => {\n            const dataType = _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_0__.VariableManagerUtil.inferDataType(propertyValue);\n            const propertyVariable = {\n                name: key,\n                dataType: dataType,\n                value: propertyValue,\n                id: '',\n            };\n            const nestedCard = this.createCard(propertyVariable, true, showTypeDialogCallback);\n            $container.append(nestedCard);\n        });\n    }\n    /**\n     * 触发嵌套卡片保存事件\n     * @param parentCard 父级卡片\n     */\n    saveNestedCardValue(parentCard) {\n        this.syncCardViewToJsonInput(parentCard);\n        const topLevelCard = this.findTopLevelCard(parentCard);\n        if (topLevelCard) {\n            topLevelCard.trigger('nested-card:changed');\n        }\n    }\n    /**\n     * 找到顶级对象卡片\n     * @param card 当前卡片\n     * @returns 具有data-variable-id属性的卡片或null\n     */\n    findTopLevelCard(card) {\n        if (card.attr('data-variable-id')) {\n            return card;\n        }\n        const cardWithId = card.closest('[data-variable-id]');\n        return cardWithId.length > 0 ? cardWithId : null;\n    }\n    /**\n     * 删除嵌套卡片\n     * @param parentCard 父级卡片\n     * @param nestedCard 嵌套卡片\n     */\n    deleteNestedCardValue(parentCard, nestedCard) {\n        nestedCard.remove();\n        this.syncCardViewToJsonInput(parentCard);\n        const topLevelCard = this.findTopLevelCard(parentCard);\n        if (topLevelCard) {\n            topLevelCard.trigger('nested-card:changed');\n        }\n    }\n    /**\n     * 为对象卡片添加新的键值对（统一处理顶级和嵌套对象卡片）\n     * @param card 对象卡片（顶级或嵌套）\n     * @param dataType 新键值对的数据类型\n     * @param showTypeDialogCallback 显示类型选择对话框的回调函数\n     */\n    addObjectKey(card, newDataType, showTypeDialogCallback) {\n        const defaultValue = _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_0__.VariableManagerUtil.getDefaultValueForType(newDataType);\n        const existingKeys = new Set();\n        const $targetCard = card.closest('.variable-card');\n        $targetCard\n            .find('.nested-cards-container')\n            .first()\n            .children('.variable-card')\n            .each((_, element) => {\n            const key = $(element).find('.variable-title').val();\n            if (key) {\n                existingKeys.add(key);\n            }\n        });\n        const newKey = _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_0__.VariableManagerUtil.generateUniqueKey(existingKeys);\n        const newVariable = {\n            name: newKey,\n            dataType: newDataType,\n            value: defaultValue,\n            id: '',\n        };\n        const newNestedCard = this.createCard(newVariable, true, showTypeDialogCallback);\n        const $targetCardHeader = $targetCard.find('.variable-card-header').first();\n        const $targetCardContent = $targetCardHeader.siblings('.variable-card-content').first();\n        const $container = $targetCardContent.find('.nested-cards-container').first();\n        $container.prepend(newNestedCard);\n        newNestedCard.find('.variable-title').focus().select();\n        const topLevelCard = this.findTopLevelCard($targetCard);\n        if (topLevelCard && topLevelCard.is($targetCard)) {\n            this.syncCardViewToJsonInput($targetCard);\n        }\n    }\n    /**\n     * 设置对象卡片（统一处理嵌套和非嵌套对象卡片）\n     * @param card 对象卡片\n     * @param variable 变量对象\n     * @param isNested 是否为嵌套卡片\n     * @param showTypeDialogCallback 显示类型选择对话框的回调函数\n     */\n    setupObjectCard(card, variable, isNested, showTypeDialogCallback) {\n        if (isNested) {\n            card.find('.variable-card-content').append(`\n        <div class=\"nested-object-container\">\n          <div class=\"nested-cards-container\"></div>\n        </div>\n      `);\n            card.find('.variable-actions .object-save-btn').before(`\n        <div class=\"variable-action-btn add-nested-key-btn\" title=\"添加键值对\">\n          <i class=\"fa-regular fa-plus\"></i>\n        </div>\n      `);\n        }\n        else {\n            card.find('.variable-card-content').append(`\n        <textarea class=\"json-input variable-content-input\" placeholder=\"输入JSON对象\" style=\"display: none;\"></textarea>\n            <div class=\"object-card-view\">\n              <div class=\"nested-cards-container\"></div>\n            </div>\n      `);\n            card.find('.variable-actions .save-btn').before(`\n        <div class=\"variable-action-btn toggle-view-btn\" title=\"切换到JSON视图\">\n          <i class=\"fa-regular fa-list\"></i>\n        </div>\n        <div class=\"variable-action-btn add-key-btn\" title=\"添加键值对\">\n          <i class=\"fa-regular fa-plus\"></i>\n        </div>\n      `);\n            card.find('.variable-actions .delete-btn').after(`\n        <div class=\"variable-action-btn collapse-btn flex\" title=\"折叠\">\n          <i class=\"fa-solid fa-chevron-down\"></i>\n        </div>\n      `);\n            card.find('.variable-card-content').addClass('expanded');\n            card.find('.collapse-btn').addClass('expanded');\n            card.find('.collapse-btn').on('click', () => {\n                const $icon = card.find('.collapse-btn');\n                const $body = card.children('.variable-card-content');\n                $icon.toggleClass('expanded');\n                $body.toggleClass('expanded');\n            });\n            card.find('.json-input').val(JSON.stringify(variable.value, null, 2)).end().attr('data-view-mode', 'card');\n            card.find('.json-input').on('blur change', () => {\n                const currentMode = card.attr('data-view-mode') || 'card';\n                if (currentMode === 'card') {\n                    this.syncJsonInputToCardView(card, showTypeDialogCallback);\n                }\n            });\n            card.find('.toggle-view-btn').on('click', () => {\n                const $card = card;\n                const currentMode = $card.attr('data-view-mode') || 'card';\n                const newMode = currentMode === 'json' ? 'card' : 'json';\n                $card.attr('data-view-mode', newMode);\n                if (newMode === 'json') {\n                    $card\n                        .find('.toggle-view-btn i')\n                        .removeClass('fa-list')\n                        .addClass('fa-eye')\n                        .end()\n                        .attr('title', '切换到卡片视图');\n                    $card.find('.variable-action-btn.add-key-btn').hide();\n                    $card.find('.json-input').show().end().find('.object-card-view').hide();\n                    this.syncCardViewToJsonInput($card);\n                }\n                else {\n                    $card\n                        .find('.toggle-view-btn i')\n                        .removeClass('fa-eye')\n                        .addClass('fa-list')\n                        .end()\n                        .attr('title', '切换到JSON视图');\n                    $card.find('.variable-action-btn.add-key-btn').show();\n                    $card.find('.json-input').hide().end().find('.object-card-view').show();\n                    this.syncJsonInputToCardView($card, showTypeDialogCallback);\n                }\n            });\n        }\n        try {\n            this.renderObjectCardView(card, variable, showTypeDialogCallback);\n        }\n        catch (e) {\n            loglevel__WEBPACK_IMPORTED_MODULE_2___default().error('渲染初始对象卡片视图错误:', e);\n            toastr.error('渲染对象卡片视图错误');\n        }\n    }\n    /**\n     * 同步卡片视图到JSON输入框\n     * @param card 对象卡片\n     */\n    syncCardViewToJsonInput(card) {\n        const objectValue = this.extractObjectFromNestedCards(card);\n        card.find('.json-input').val(JSON.stringify(objectValue, null, 2));\n    }\n    /**\n     * 同步JSON输入框到卡片视图\n     * @param card 对象卡片\n     * @param showTypeDialogCallback 显示类型选择对话框的回调函数\n     */\n    syncJsonInputToCardView(card, showTypeDialogCallback) {\n        try {\n            const jsonValue = card.find('.json-input').val();\n            if (jsonValue && jsonValue.trim()) {\n                const objectValue = JSON.parse(jsonValue);\n                const tempVariable = {\n                    id: card.attr('data-variable-id') || '',\n                    name: card.find('.variable-title').val(),\n                    dataType: 'object',\n                    value: objectValue,\n                };\n                this.renderObjectCardView(card, tempVariable, showTypeDialogCallback);\n            }\n        }\n        catch (parseError) {\n            loglevel__WEBPACK_IMPORTED_MODULE_2___default().error('JSON解析错误:', parseError);\n            toastr.error('JSON格式错误，无法同步到卡片视图');\n        }\n    }\n    /**\n     * 创建数组项（所有项都显示为字符串输入框）\n     * @param card 数组卡片\n     * @param items 数组项\n     */\n    populateArrayItems(card, items) {\n        if (!items || items.length === 0) {\n            return;\n        }\n        const listContainer = card.find('.list-items-container');\n        listContainer.empty();\n        items.forEach(item => {\n            const displayValue = typeof item === 'object' ? JSON.stringify(item) : String(item);\n            const listItem = $(`\n        <div class=\"list-item\">\n          <span class=\"drag-handle\">☰</span>\n          <textarea class=\"variable-content-input\">${displayValue}</textarea>\n          <div class=\"list-item-delete\"><i class=\"fa-solid fa-times\"></i></div>\n        </div>\n      `);\n            listContainer.append(listItem);\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvY2FyZC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUN3RTtBQUVWO0FBRW5DO0FBSXBCLE1BQU0sbUJBQW1CO0lBQ3RCLHlCQUF5QixDQUFxRTtJQUV0Rzs7O09BR0c7SUFDSCxZQUFZLHlCQUE2RjtRQUN2RyxJQUFJLENBQUMseUJBQXlCLEdBQUcseUJBQXlCLENBQUM7UUFDM0QsSUFBSSxDQUFDLDBCQUEwQixFQUFFLENBQUM7SUFDcEMsQ0FBQztJQUVEOztPQUVHO0lBQ0ssMEJBQTBCO1FBQ2hDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLENBQUMsT0FBTyxFQUFFLHNDQUFzQyxFQUFFLEtBQUssQ0FBQyxFQUFFO1lBQ3RFLEtBQUssQ0FBQyxlQUFlLEVBQUUsQ0FBQztZQUN4QixLQUFLLENBQUMsd0JBQXdCLEVBQUUsQ0FBQztZQUVqQyxNQUFNLE9BQU8sR0FBRyxDQUFDLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxDQUFDO1lBQ3ZDLE1BQU0sV0FBVyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztZQUV0RCxNQUFNLFdBQVcsR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsV0FBVyxDQUFDLENBQUM7WUFFdkQsSUFBSSxXQUFXLEVBQUUsQ0FBQztnQkFDaEIsSUFBSSxDQUFDLG1CQUFtQixDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBQ3hDLENBQUM7UUFDSCxDQUFDLENBQUMsQ0FBQztRQUVILENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLENBQUMsT0FBTyxFQUFFLHdDQUF3QyxFQUFFLEtBQUssQ0FBQyxFQUFFO1lBQ3hFLEtBQUssQ0FBQyxlQUFlLEVBQUUsQ0FBQztZQUN4QixLQUFLLENBQUMsd0JBQXdCLEVBQUUsQ0FBQztZQUVqQyxNQUFNLE9BQU8sR0FBRyxDQUFDLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxDQUFDO1lBQ3ZDLE1BQU0sV0FB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QyxDQUFDO1FBQ2pDLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztDQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL2NhcmQudHM/MjQ2OSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBWYXJpYWJsZURhdGFUeXBlLCBWYXJpYWJsZUl0ZW0gfSBmcm9tICdAL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL3R5cGVzJztcbmltcG9ydCB7IFZhcmlhYmxlTWFuYWdlclV0aWwgfSBmcm9tICdAL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL3V0aWwnO1xuXG5pbXBvcnQgeyBnZXRTb3J0YWJsZURlbGF5IH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvdXRpbHMnO1xuXG5pbXBvcnQgbG9nIGZyb20gJ2xvZ2xldmVsJztcblxuZGVjbGFyZSBjb25zdCB0b2FzdHI6IGFueTtcblxuZXhwb3J0IGNsYXNzIFZhcmlhYmxlQ2FyZEZhY3Rvcnkge1xuICBwcml2YXRlIGRlZmF1bHRUeXBlRGlhbG9nQ2FsbGJhY2s/OiAoY2FsbGJhY2s6IChkYXRhVHlwZTogVmFyaWFibGVEYXRhVHlwZSkgPT4gdm9pZCkgPT4gUHJvbWlzZTx2b2lkPjtcblxuICAvKipcbiAgICog5p6E6YCg5Ye95pWwXG4gICAqIEBwYXJhbSBkZWZhdWx0VHlwZURpYWxvZ0NhbGxiYWNrIOm7mOiupOeahOexu+Wei+mAieaLqeWvueivneahhuWbnuiwg+WHveaVsFxuICAgKi9cbiAgY29uc3RydWN0b3IoZGVmYXVsdFR5cGVEaWFsb2dDYWxsYmFjaz86IChjYWxsYmFjazogKGRhdGFUeXBlOiBWYXJpYWJsZURhdGFUeXBlKSA9PiB2b2lkKSA9PiBQcm9taXNlPHZvaWQ+KSB7XG4gICAgdGhpcy5kZWZhdWx0VHlwZURpYWxvZ0NhbGxiYWNrID0gZGVmYXVsdFR5cGVEaWFsb2dDYWxsYmFjaztcbiAgICB0aGlzLnNldHVwR2xvYmFsRXZlbnREZWxlZ2F0aW9uKCk7XG4gIH1cblxuICAvKipcbiAgICog6K6+572u5YWo5bGA5LqL5Lu25aeU5omYXG4gICAqL1xuICBwcml2YXRlIHNldHVwR2xvYmFsRXZlbnREZWxlZ2F0aW9uKCk6IHZvaWQge1xuICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcudmFyaWFibGUtYWN0aW9uLWJ0bi5vYmplY3Qtc2F2ZS1idG4nLCBldmVudCA9PiB7XG4gICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIGV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuXG4gICAgICBjb25zdCAkYnV0dG9uID0gJChldmVudC5jdXJyZW50VGFyZ2V0KTtcbiAgICAgIGNvbnN0ICRuZXN0ZWRDYXJkID0gJGJ1dHRvbi5jbG9zZXN0KCcudmFyaWFibGUtY2FyZCcpO1xuXG4gICAgICBjb25zdCAkcGFyZW50Q2FyZCA9IHRoaXMuZmluZFRvcExldmVsQ2FyZCgkbmVzdGVkQ2FyZCk7XG5cbiAgICAgIGlmICgkcGFyZW50Q2FyZCkge1xuICAgICAgICB0aGlzLnNhdmVOZXN0ZWRDYXJkVmFsdWUoJHBhcmVudENhcmQpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy52YXJpYWJsZS1hY3Rpb24tYnRuLm9iamVjdC1kZWxldGUtYnRuJywgZXZlbnQgPT4ge1xuICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcblxuICAgICAgY29uc3QgJGJ1dHRvbiA9ICQoZXZlbnQuY3VycmVudFRhcmdldCk7XG4gICAgICBjb25zdCAkbmVzdGVkQ2FyZCA9ICRidXR0b24uY2xvc2VzdCgnLnZhcmlhYmxlLWNhcmQnKTtcblxuICAgICAgY29uc3QgJHBhcmVudENhcmQgPSB0aGlzLmZpbmRUb3BMZXZlbENhcmQoJG5lc3RlZENhcmQpO1xuXG4gICAgICBpZiAoJHBhcmVudENhcmQpIHtcbiAgICAgICAgdGhpcy5kZWxldGVOZXN0ZWRDYXJkVmFsdWUoJHBhcmVudENhcmQsICRuZXN0ZWRDYXJkKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcudmFyaWFibGUtYWN0aW9uLWJ0bi5hZGQtbmVzdGVkLWtleS1idG4nLCBhc3luYyBldmVudCA9PiB7XG4gICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIGV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuXG4gICAgICBjb25zdCAkYnV0dG9uID0gJChldmVudC5jdXJyZW50VGFyZ2V0KTtcbiAgICAgIGNvbnN0ICRjYXJkID0gJGJ1dHRvbi5jbG9zZXN0KCcudmFyaWFibGUtY2FyZCcpO1xuXG4gICAgICBjb25zdCBkaWFsb2dDYWxsYmFjayA9IHRoaXMuZGVmYXVsdFR5cGVEaWFsb2dDYWxsYmFjaztcbiAgICAgIGlmIChkaWFsb2dDYWxsYmFjaykge1xuICAgICAgICBhd2FpdCBkaWFsb2dDYWxsYmFjaygoZGF0YVR5cGU6IFZhcmlhYmxlRGF0YVR5cGUpID0+IHtcbiAgICAgICAgICB0aGlzLmFkZE9iamVjdEtleSgkY2FyZCwgZGF0YVR5cGUsIHRoaXMuZGVmYXVsdFR5cGVEaWFsb2dDYWxsYmFjayk7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbG9nLmVycm9yKCfmt7vliqDljaHniYflh7rplJknKTtcbiAgICAgICAgdG9hc3RyLmVycm9yKCfmt7vliqDljaHniYflh7rplJknKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcudmFyaWFibGUtYWN0aW9uLWJ0bi5hZGQta2V5LWJ0bicsIGFzeW5jIGV2ZW50ID0+IHtcbiAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgZXZlbnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG5cbiAgICAgIGNvbnN0ICRidXR0b24gPSAkKGV2ZW50LmN1cnJlbnRUYXJnZXQpO1xuICAgICAgY29uc3QgJGNhcmQgPSAkYnV0dG9uLmNsb3Nlc3QoJy52YXJpYWJsZS1jYXJkJyk7XG5cbiAgICAgIGNvbnN0IGRpYWxvZ0NhbGxiYWNrID0gdGhpcy5kZWZhdWx0VHlwZURpYWxvZ0NhbGxiYWNrO1xuICAgICAgaWYgKGRpYWxvZ0NhbGxiYWNrKSB7XG4gICAgICAgIGF3YWl0IGRpYWxvZ0NhbGxiYWNrKChkYXRhVHlwZTogVmFyaWFibGVEYXRhVHlwZSkgPT4ge1xuICAgICAgICAgIHRoaXMuYWRkT2JqZWN0S2V5KCRjYXJkLCBkYXRhVHlwZSwgdGhpcy5kZWZhdWx0VHlwZURpYWxvZ0NhbGxiYWNrKTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBsb2cuZXJyb3IoJ+acquaPkOS+m+exu+Wei+mAieaLqeWvueivneahhuWbnuiwg+WHveaVsCcpO1xuICAgICAgICB0b2FzdHIuZXJyb3IoJ+acquaPkOS+m+exu+Wei+mAieaLqeWvueivneahhuWbnuiwg+WHveaVsCcpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOWIm+W7uuWPmOmHj+WNoeeJh1xuICAgKiBAcGFyYW0gdmFyaWFibGUg5Y+Y6YePXG4gICAqIEBwYXJhbSBpc05lc3RlZCDmmK/lkKbkuLrltYzlpZfljaHniYdcbiAgICogQHBhcmFtIHNob3dUeXBlRGlhbG9nQ2FsbGJhY2sg5pi+56S657G75Z6L6YCJ5oup5a+56K+d5qGG55qE5Zue6LCD5Ye95pWw77yI5LuF55So5LqO5a+56LGh57G75Z6L77yJXG4gICAqIEByZXR1cm5zIOWPmOmHj+WNoeeJh2pRdWVyeeWvueixoVxuICAgKi9cbiAgcHVibGljIGNyZWF0ZUNhcmQoXG4gICAgdmFyaWFibGU6IFZhcmlhYmxlSXRlbSxcbiAgICBpc05lc3RlZD86IGJvb2xlYW4sXG4gICAgc2hvd1R5cGVEaWFsb2dDYWxsYmFjaz86IChjYWxsYmFjazogKGRhdGFUeXBlOiBWYXJpYWJsZURhdGFUeXBlKSA9PiB2b2lkKSA9PiBQcm9taXNlPHZvaWQ+LFxuICApOiBKUXVlcnk8SFRNTEVsZW1lbnQ+IHtcbiAgICBsZXQgY2FyZDogSlF1ZXJ5PEhUTUxFbGVtZW50PjtcbiAgICBjb25zdCB7IG5hbWUsIHZhbHVlLCBkYXRhVHlwZSwgaWQgfSA9IHZhcmlhYmxlO1xuICAgIGNhcmQgPSAkKGBcbiAgICAgIDxkaXYgY2xhc3M9XCJ2YXJpYWJsZS1jYXJkXCIgZGF0YS10eXBlPVwiJHtkYXRhVHlwZX1cIiBkYXRhLXZhcmlhYmxlLWlkPVwiJHtpZH1cIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cInZhcmlhYmxlLWNhcmQtaGVhZGVyXCI+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cInZhcmlhYmxlLXRpdGxlLWNvbnRhaW5lclwiPlxuICAgICAgICAgICAgPGk+PC9pPlxuICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgY2xhc3M9XCJ2YXJpYWJsZS10aXRsZVwiIHZhbHVlPVwiJHtuYW1lfVwiIHBsYWNlaG9sZGVyPVwi5Y+Y6YeP5ZCN56ewXCI+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cInZhcmlhYmxlLWFjdGlvbnNcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ2YXJpYWJsZS1hY3Rpb24tYnRuIHNhdmUtYnRuXCIgdGl0bGU9XCLkv53lrZhcIj5cbiAgICAgICAgICAgICAgPGkgY2xhc3M9XCJmYS1yZWd1bGFyIGZhLXNhdmVcIj48L2k+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ2YXJpYWJsZS1hY3Rpb24tYnRuIGRlbGV0ZS1idG5cIiB0aXRsZT1cIuWIoOmZpFwiPlxuICAgICAgICAgICAgICA8aSBjbGFzcz1cImZhLXJlZ3VsYXIgZmEtdHJhc2gtY2FuXCI+PC9pPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzPVwidmFyaWFibGUtY2FyZC1jb250ZW50XCI+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgYCk7XG5cbiAgICBpZiAoaXNOZXN0ZWQpIHtcbiAgICAgIGNhcmQucmVtb3ZlQXR0cignZGF0YS12YXJpYWJsZS1pZCcpO1xuICAgICAgY2FyZFxuICAgICAgICAuZmluZCgnLnZhcmlhYmxlLWFjdGlvbi1idG4uc2F2ZS1idG4nKVxuICAgICAgICAucmVtb3ZlQ2xhc3MoJ3NhdmUtYnRuJylcbiAgICAgICAgLmFkZENsYXNzKCdvYmplY3Qtc2F2ZS1idG4nKVxuICAgICAgICAuZW5kKClcbiAgICAgICAgLmZpbmQoJy52YXJpYWJsZS1hY3Rpb24tYnRuLmRlbGV0ZS1idG4nKVxuICAgICAgICAucmVtb3ZlQ2xhc3MoJ2RlbGV0ZS1idG4nKVxuICAgICAgICAuYWRkQ2xhc3MoJ29iamVjdC1kZWxldGUtYnRuJyk7XG4gICAgfVxuXG4gICAgc3dpdGNoIChkYXRhVHlwZSkge1xuICAgICAgY2FzZSAnYXJyYXknOlxuICAgICAgICBjYXJkXG4gICAgICAgICAgLmZpbmQoJy52YXJpYWJsZS10aXRsZS1jb250YWluZXIgaScpXG4gICAgICAgICAgLmFkZENsYXNzKCdmYS1zb2xpZCBmYS1saXN0JylcbiAgICAgICAgICAuZW5kKClcbiAgICAgICAgICAuZmluZCgnLnZhcmlhYmxlLWNhcmQtY29udGVudCcpXG4gICAgICAgICAgLmFwcGVuZChcbiAgICAgICAgICAgIGA8ZGl2IGNsYXNzPVwibGlzdC1pdGVtcy1jb250YWluZXJcIj48L2Rpdj48ZGl2IGNsYXNzPVwiYWRkLWxpc3QtaXRlbVwiPjxpIGNsYXNzPVwiZmEtc29saWQgZmEtcGx1c1wiPjwvaT4g5re75Yqg6aG555uuPC9kaXY+YCxcbiAgICAgICAgICApO1xuXG4gICAgICAgIHRoaXMucG9wdWxhdGVBcnJheUl0ZW1zKGNhcmQsIHZhbHVlKTtcblxuICAgICAgICB7XG4gICAgICAgICAgY29uc3QgbGlzdENvbnRhaW5lciA9IGNhcmQuZmluZCgnLmxpc3QtaXRlbXMtY29udGFpbmVyJyk7XG4gICAgICAgICAgbGlzdENvbnRhaW5lci5zb3J0YWJsZSh7XG4gICAgICAgICAgICBkZWxheTogZ2V0U29ydGFibGVEZWxheSgpLFxuICAgICAgICAgICAgaGFuZGxlOiAnLmRyYWctaGFuZGxlJyxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ29iamVjdCc6XG4gICAgICAgIGNhcmQuZmluZCgnLnZhcmlhYmxlLXRpdGxlLWNvbnRhaW5lciBpJykuYWRkQ2xhc3MoJ2ZhLXJlZ3VsYXIgZmEtY29kZScpO1xuICAgICAgICB0aGlzLnNldHVwT2JqZWN0Q2FyZChjYXJkLCB2YXJpYWJsZSwgaXNOZXN0ZWQsIHNob3dUeXBlRGlhbG9nQ2FsbGJhY2spO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2Jvb2xlYW4nOlxuICAgICAgICBjYXJkXG4gICAgICAgICAgLmZpbmQoJy52YXJpYWJsZS10aXRsZS1jb250YWluZXIgaScpXG4gICAgICAgICAgLmFkZENsYXNzKCdmYS1yZWd1bGFyIGZhLXRvZ2dsZS1vbicpXG4gICAgICAgICAgLmVuZCgpXG4gICAgICAgICAgLmZpbmQoJy52YXJpYWJsZS1jYXJkLWNvbnRlbnQnKVxuICAgICAgICAgIC5hcHBlbmQoXG4gICAgICAgICAgICBgXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJib29sZWFuLWlucHV0LWNvbnRhaW5lclwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJib29sZWFuLWJ1dHRvbnMtY29udGFpbmVyXCI+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiYm9vbGVhbi1idG4gJHt2YWx1ZSA/ICdhY3RpdmUnIDogJyd9XCIgZGF0YS12YWx1ZT1cInRydWVcIj5UcnVlPC9kaXY+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiYm9vbGVhbi1idG4gJHshdmFsdWUgPyAnYWN0aXZlJyA6ICcnfVwiIGRhdGEtdmFsdWU9XCJmYWxzZVwiPkZhbHNlPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgYCxcbiAgICAgICAgICApXG4gICAgICAgICAgLmZpbmQoJy5ib29sZWFuLWJ0bicpXG4gICAgICAgICAgLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGNhcmQuZmluZCgnLmJvb2xlYW4tYnRuJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnbnVtYmVyJzpcbiAgICAgICAgY2FyZFxuICAgICAgICAgIC5maW5kKCcudmFyaWFibGUtdGl0bGUtY29udGFpbmVyIGknKVxuICAgICAgICAgIC5hZGRDbGFzcygnZmEtc29saWQgZmEtaGFzaHRhZycpXG4gICAgICAgICAgLmVuZCgpXG4gICAgICAgICAgLmZpbmQoJy52YXJpYWJsZS1jYXJkLWNvbnRlbnQnKVxuICAgICAgICAgIC5hcHBlbmQoYDxpbnB1dCB0eXBlPVwibnVtYmVyXCIgY2xhc3M9XCJudW1iZXItaW5wdXQgdmFyaWFibGUtY29udGVudC1pbnB1dFwiIHZhbHVlPVwiJHt2YWx1ZX1cIiBzdGVwPVwiYW55XCI+YCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnc3RyaW5nJzpcbiAgICAgICAgY2FyZFxuICAgICAgICAgIC5maW5kKCcudmFyaWFibGUtdGl0bGUtY29udGFpbmVyIGknKVxuICAgICAgICAgIC5hZGRDbGFzcygnZmEtc29saWQgZmEtZm9udCcpXG4gICAgICAgICAgLmVuZCgpXG4gICAgICAgICAgLmZpbmQoJy52YXJpYWJsZS1jYXJkLWNvbnRlbnQnKVxuICAgICAgICAgIC5hcHBlbmQoXG4gICAgICAgICAgICBgPHRleHRhcmVhIGNsYXNzPVwic3RyaW5nLWlucHV0IHZhcmlhYmxlLWNvbnRlbnQtaW5wdXRcIiBwbGFjZWhvbGRlcj1cIui+k+WFpeWtl+espuS4suWAvFwiPiR7dmFsdWV9PC90ZXh0YXJlYT5gLFxuICAgICAgICAgICk7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgICByZXR1cm4gY2FyZDtcbiAgfVxuXG4gIC8qKlxuICAgKiDku47ljaHniYfojrflj5blj5jph4/kv6Hmga9cbiAgICogQHBhcmFtIGNhcmQg5Y+Y6YeP5Y2h54mHXG4gICAqIEByZXR1cm5zIOWPmOmHj+S/oeaBr1xuICAgKi9cbiAgcHVibGljIGdldFZhcmlhYmxlRnJvbUNhcmQoY2FyZDogSlF1ZXJ5PEhUTUxFbGVtZW50Pik6IFZhcmlhYmxlSXRlbSB8IG51bGwge1xuICAgIGNvbnN0IGlkID0gY2FyZC5hdHRyKCdkYXRhLXZhcmlhYmxlLWlkJykgfHwgJyc7XG4gICAgY29uc3QgbmFtZSA9IGNhcmQuZmluZCgnLnZhcmlhYmxlLXRpdGxlJykudmFsKCkgYXMgc3RyaW5nO1xuICAgIGNvbnN0IGRhdGFUeXBlID0gY2FyZC5hdHRyKCdkYXRhLXR5cGUnKSBhcyBWYXJpYWJsZURhdGFUeXBlO1xuICAgIGNvbnN0IHZhbHVlID0gdGhpcy5leHRyYWN0VmFsdWVGcm9tQ2FyZChjYXJkLCBkYXRhVHlwZSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgaWQsXG4gICAgICBuYW1lLFxuICAgICAgZGF0YVR5cGUsXG4gICAgICB2YWx1ZSxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIOS7juWNoeeJh+aPkOWPluWAvO+8iOe7n+S4gOWkhOeQhuaJgOacieexu+Wei+eahOWNoeeJh+WAvOaPkOWPlu+8iVxuICAgKiBAcGFyYW0gY2FyZCDljaHniYdcbiAgICogQHBhcmFtIGRhdGFUeXBlIOaVsOaNruexu+Wei1xuICAgKiBAcmV0dXJucyDmj5Dlj5bnmoTlgLxcbiAgICovXG4gIHByaXZhdGUgZXh0cmFjdFZhbHVlRnJvbUNhcmQoY2FyZDogSlF1ZXJ5PEhUTUxFbGVtZW50PiwgZGF0YVR5cGU6IFZhcmlhYmxlRGF0YVR5cGUpOiBhbnkge1xuICAgIHN3aXRjaCAoZGF0YVR5cGUpIHtcbiAgICAgIGNhc2UgJ3N0cmluZyc6XG4gICAgICAgIHJldHVybiBjYXJkLmZpbmQoJy5zdHJpbmctaW5wdXQnKS52YWwoKSBhcyBzdHJpbmc7XG4gICAgICBjYXNlICdudW1iZXInOiB7XG4gICAgICAgIGNvbnN0IG51bWJlclZhbHVlID0gY2FyZC5maW5kKCcubnVtYmVyLWlucHV0JykudmFsKCkgYXMgc3RyaW5nO1xuICAgICAgICByZXR1cm4gbnVtYmVyVmFsdWUgPyBwYXJzZUZsb2F0KG51bWJlclZhbHVlKSA6IDA7XG4gICAgICB9XG4gICAgICBjYXNlICdib29sZWFuJzpcbiAgICAgICAgcmV0dXJuIGNhcmQuZmluZCgnLmJvb2xlYW4tYnRuLmFjdGl2ZScpLmF0dHIoJ2RhdGEtdmFsdWUnKSA9PT0gJ3RydWUnO1xuICAgICAgY2FzZSAnYXJyYXknOiB7XG4gICAgICAgIGNvbnN0IGFycmF5SXRlbXM6IGFueVtdID0gW107XG4gICAgICAgIGNhcmQuZmluZCgnLmxpc3QtaXRlbScpLmVhY2goKF8sIGVsZW0pID0+IHtcbiAgICAgICAgICBjb25zdCAkbGlzdEl0ZW0gPSAkKGVsZW0pO1xuXG4gICAgICAgICAgY29uc3QgaXRlbVZhbHVlID0gJGxpc3RJdGVtLmZpbmQoJy52YXJpYWJsZS1jb250ZW50LWlucHV0JykudmFsKCkgYXMgc3RyaW5nO1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhcnJheUl0ZW1zLnB1c2goSlNPTi5wYXJzZShpdGVtVmFsdWUpKTtcbiAgICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgIGFycmF5SXRlbXMucHVzaChpdGVtVmFsdWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBhcnJheUl0ZW1zO1xuICAgICAgfVxuICAgICAgY2FzZSAnb2JqZWN0Jzoge1xuICAgICAgICBjb25zdCB2aWV3TW9kZSA9IGNhcmQuYXR0cignZGF0YS12aWV3LW1vZGUnKSB8fCAnY2FyZCc7XG5cbiAgICAgICAgaWYgKHZpZXdNb2RlID09PSAnY2FyZCcpIHtcbiAgICAgICAgICBjb25zdCBleHRyYWN0ZWQgPSB0aGlzLmV4dHJhY3RPYmplY3RGcm9tTmVzdGVkQ2FyZHMoY2FyZCk7XG4gICAgICAgICAgcmV0dXJuIGV4dHJhY3RlZDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGpzb25WYWx1ZSA9IGNhcmQuZmluZCgnLmpzb24taW5wdXQnKS52YWwoKSBhcyBzdHJpbmc7XG5cbiAgICAgICAgaWYgKGpzb25WYWx1ZSAmJiBqc29uVmFsdWUudHJpbSgpKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHBhcnNlZCA9IEpTT04ucGFyc2UoanNvblZhbHVlKTtcbiAgICAgICAgICAgIHJldHVybiBwYXJzZWQ7XG4gICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgbG9nLmVycm9yKCdKU09O6Kej5p6Q6ZSZ6K+vOicsIGUpO1xuICAgICAgICAgICAgdG9hc3RyLmVycm9yKCdKU09O6Kej5p6Q6ZSZ6K+vJyk7XG4gICAgICAgICAgICByZXR1cm4ge307XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnN0IGV4dHJhY3RlZCA9IHRoaXMuZXh0cmFjdE9iamVjdEZyb21OZXN0ZWRDYXJkcyhjYXJkKTtcbiAgICAgICAgICByZXR1cm4gZXh0cmFjdGVkO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gY2FyZC5maW5kKCcudmFyaWFibGUtY29udGVudC1pbnB1dCcpLnZhbCgpIGFzIHN0cmluZztcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5LuO5bWM5aWX5Y2h54mH5o+Q5Y+W5a+56LGh5YC8XG4gICAqIEBwYXJhbSBjYXJkIOWvueixoeWNoeeJh1xuICAgKiBAcmV0dXJucyDmj5Dlj5bnmoTlr7nosaHlgLxcbiAgICovXG4gIHByaXZhdGUgZXh0cmFjdE9iamVjdEZyb21OZXN0ZWRDYXJkcyhjYXJkOiBKUXVlcnk8SFRNTEVsZW1lbnQ+KTogUmVjb3JkPHN0cmluZywgYW55PiB7XG4gICAgY29uc3QgcmVzdWx0OiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0ge307XG5cbiAgICBsZXQgJGNvbnRhaW5lciA9IGNhcmQuZmluZCgnPiAudmFyaWFibGUtY2FyZC1jb250ZW50ID4gLm9iamVjdC1jYXJkLXZpZXcgPiAubmVzdGVkLWNhcmRzLWNvbnRhaW5lcicpO1xuXG4gICAgaWYgKCRjb250YWluZXIubGVuZ3RoID09PSAwKSB7XG4gICAgICAkY29udGFpbmVyID0gY2FyZC5maW5kKCc+IC52YXJpYWJsZS1jYXJkLWNvbnRlbnQgPiAubmVzdGVkLW9iamVjdC1jb250YWluZXIgPiAubmVzdGVkLWNhcmRzLWNvbnRhaW5lcicpO1xuICAgIH1cblxuICAgIGlmICgkY29udGFpbmVyLmxlbmd0aCA9PT0gMCkge1xuICAgICAgJGNvbnRhaW5lciA9IGNhcmQuZmluZCgnLm5lc3RlZC1jYXJkcy1jb250YWluZXInKS5maXJzdCgpO1xuICAgIH1cblxuICAgICRjb250YWluZXIuY2hpbGRyZW4oJy52YXJpYWJsZS1jYXJkJykuZWFjaCgoX2luZGV4LCBlbGVtZW50KSA9PiB7XG4gICAgICBjb25zdCAkbmVzdGVkQ2FyZCA9ICQoZWxlbWVudCk7XG4gICAgICBjb25zdCBrZXkgPSAkbmVzdGVkQ2FyZC5maW5kKCcudmFyaWFibGUtdGl0bGUnKS52YWwoKSBhcyBzdHJpbmc7XG4gICAgICBjb25zdCBuZXN0ZWREYXRhVHlwZSA9ICRuZXN0ZWRDYXJkLmF0dHIoJ2RhdGEtdHlwZScpIGFzIFZhcmlhYmxlRGF0YVR5cGU7XG5cbiAgICAgIGxvZy5pbmZvKCdbVmFyaWFibGVNYW5hZ2VyXSDlpITnkIbltYzlpZfljaHniYc6Jywge1xuICAgICAgICBpbmRleDogX2luZGV4LFxuICAgICAgICBrZXk6IGtleSxcbiAgICAgICAgZGF0YVR5cGU6IG5lc3RlZERhdGFUeXBlLFxuICAgICAgICBjYXJkSHRtbDogJG5lc3RlZENhcmRbMF0ub3V0ZXJIVE1MLnN1YnN0cmluZygwLCAyMDApICsgJy4uLicsXG4gICAgICB9KTtcblxuICAgICAgaWYgKGtleSkge1xuICAgICAgICBjb25zdCBuZXN0ZWRWYWx1ZSA9IHRoaXMuZXh0cmFjdFZhbHVlRnJvbUNhcmQoJG5lc3RlZENhcmQsIG5lc3RlZERhdGFUeXBlKTtcbiAgICAgICAgcmVzdWx0W2tleV0gPSBuZXN0ZWRWYWx1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxvZy53YXJuKCdbVmFyaWFibGVNYW5hZ2VyXSDot7Pov4fnqbrplK7nmoTltYzlpZfljaHniYc6JywgX2luZGV4KTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGxvZy5pbmZvKCdbVmFyaWFibGVNYW5hZ2VyXSDmnIDnu4jmj5Dlj5bnu5Pmnpw6JywgcmVzdWx0KTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLyoqXG4gICAqIOa4suafk+WvueixoeWNoeeJh+eahOWNoeeJh+inhuWbvlxuICAgKiBAcGFyYW0gY2FyZCDlr7nosaHljaHniYdqUXVlcnnlr7nosaFcbiAgICogQHBhcmFtIHZhcmlhYmxlIOWvueixoeWPmOmHj1xuICAgKiBAcGFyYW0gc2hvd1R5cGVEaWFsb2dDYWxsYmFjayDmmL7npLrnsbvlnovpgInmi6nlr7nor53moYbnmoTlm57osIPlh73mlbBcbiAgICovXG4gIHByaXZhdGUgcmVuZGVyT2JqZWN0Q2FyZFZpZXcoXG4gICAgY2FyZDogSlF1ZXJ5PEhUTUxFbGVtZW50PixcbiAgICB2YXJpYWJsZTogVmFyaWFibGVJdGVtLFxuICAgIHNob3dUeXBlRGlhbG9nQ2FsbGJhY2s/OiAoY2FsbGJhY2s6IChkYXRhVHlwZTogVmFyaWFibGVEYXRhVHlwZSkgPT4gdm9pZCkgPT4gUHJvbWlzZTx2b2lkPixcbiAgKTogdm9pZCB7XG4gICAgY29uc3QgJGNvbnRhaW5lciA9IGNhcmQuZmluZCgnLm5lc3RlZC1jYXJkcy1jb250YWluZXInKTtcbiAgICAkY29udGFpbmVyLmVtcHR5KCk7XG5cbiAgICBpZiAoIXZhcmlhYmxlLnZhbHVlIHx8IHR5cGVvZiB2YXJpYWJsZS52YWx1ZSAhPT0gJ29iamVjdCcpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBPYmplY3QuZW50cmllcyh2YXJpYWJsZS52YWx1ZSkuZm9yRWFjaCgoW2tleSwgcHJvcGVydHlWYWx1ZV0pID0+IHtcbiAgICAgIGNvbnN0IGRhdGFUeXBlOiBWYXJpYWJsZURhdGFUeXBlID0gVmFyaWFibGVNYW5hZ2VyVXRpbC5pbmZlckRhdGFUeXBlKHByb3BlcnR5VmFsdWUpO1xuXG4gICAgICBjb25zdCBwcm9wZXJ0eVZhcmlhYmxlOiBWYXJpYWJsZUl0ZW0gPSB7XG4gICAgICAgIG5hbWU6IGtleSxcbiAgICAgICAgZGF0YVR5cGU6IGRhdGFUeXBlLFxuICAgICAgICB2YWx1ZTogcHJvcGVydHlWYWx1ZSxcbiAgICAgICAgaWQ6ICcnLFxuICAgICAgfTtcblxuICAgICAgY29uc3QgbmVzdGVkQ2FyZCA9IHRoaXMuY3JlYXRlQ2FyZChwcm9wZXJ0eVZhcmlhYmxlLCB0cnVlLCBzaG93VHlwZURpYWxvZ0NhbGxiYWNrKTtcblxuICAgICAgJGNvbnRhaW5lci5hcHBlbmQobmVzdGVkQ2FyZCk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog6Kem5Y+R5bWM5aWX5Y2h54mH5L+d5a2Y5LqL5Lu2XG4gICAqIEBwYXJhbSBwYXJlbnRDYXJkIOeItue6p+WNoeeJh1xuICAgKi9cbiAgcHJpdmF0ZSBzYXZlTmVzdGVkQ2FyZFZhbHVlKHBhcmVudENhcmQ6IEpRdWVyeTxIVE1MRWxlbWVudD4pOiB2b2lkIHtcbiAgICB0aGlzLnN5bmNDYXJkVmlld1RvSnNvbklucHV0KHBhcmVudENhcmQpO1xuXG4gICAgY29uc3QgdG9wTGV2ZWxDYXJkID0gdGhpcy5maW5kVG9wTGV2ZWxDYXJkKHBhcmVudENhcmQpO1xuICAgIGlmICh0b3BMZXZlbENhcmQpIHtcbiAgICAgIHRvcExldmVsQ2FyZC50cmlnZ2VyKCduZXN0ZWQtY2FyZDpjaGFuZ2VkJyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOaJvuWIsOmhtue6p+WvueixoeWNoeeJh1xuICAgKiBAcGFyYW0gY2FyZCDlvZPliY3ljaHniYdcbiAgICogQHJldHVybnMg5YW35pyJZGF0YS12YXJpYWJsZS1pZOWxnuaAp+eahOWNoeeJh+aIlm51bGxcbiAgICovXG4gIHByaXZhdGUgZmluZFRvcExldmVsQ2FyZChjYXJkOiBKUXVlcnk8SFRNTEVsZW1lbnQ+KTogSlF1ZXJ5PEhUTUxFbGVtZW50PiB8IG51bGwge1xuICAgIGlmIChjYXJkLmF0dHIoJ2RhdGEtdmFyaWFibGUtaWQnKSkge1xuICAgICAgcmV0dXJuIGNhcmQ7XG4gICAgfVxuXG4gICAgY29uc3QgY2FyZFdpdGhJZCA9IGNhcmQuY2xvc2VzdCgnW2RhdGEtdmFyaWFibGUtaWRdJyk7XG4gICAgcmV0dXJuIGNhcmRXaXRoSWQubGVuZ3RoID4gMCA/IGNhcmRXaXRoSWQgOiBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIOWIoOmZpOW1jOWll+WNoeeJh1xuICAgKiBAcGFyYW0gcGFyZW50Q2FyZCDniLbnuqfljaHniYdcbiAgICogQHBhcmFtIG5lc3RlZENhcmQg5bWM5aWX5Y2h54mHXG4gICAqL1xuICBwcml2YXRlIGRlbGV0ZU5lc3RlZENhcmRWYWx1ZShwYXJlbnRDYXJkOiBKUXVlcnk8SFRNTEVsZW1lbnQ+LCBuZXN0ZWRDYXJkOiBKUXVlcnk8SFRNTEVsZW1lbnQ+KTogdm9pZCB7XG4gICAgbmVzdGVkQ2FyZC5yZW1vdmUoKTtcblxuICAgIHRoaXMuc3luY0NhcmRWaWV3VG9Kc29uSW5wdXQocGFyZW50Q2FyZCk7XG5cbiAgICBjb25zdCB0b3BMZXZlbENhcmQgPSB0aGlzLmZpbmRUb3BMZXZlbENhcmQocGFyZW50Q2FyZCk7XG4gICAgaWYgKHRvcExldmVsQ2FyZCkge1xuICAgICAgdG9wTGV2ZWxDYXJkLnRyaWdnZXIoJ25lc3RlZC1jYXJkOmNoYW5nZWQnKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5Li65a+56LGh5Y2h54mH5re75Yqg5paw55qE6ZSu5YC85a+577yI57uf5LiA5aSE55CG6aG257qn5ZKM5bWM5aWX5a+56LGh5Y2h54mH77yJXG4gICAqIEBwYXJhbSBjYXJkIOWvueixoeWNoeeJh++8iOmhtue6p+aIluW1jOWll++8iVxuICAgKiBAcGFyYW0gZGF0YVR5cGUg5paw6ZSu5YC85a+555qE5pWw5o2u57G75Z6LXG4gICAqIEBwYXJhbSBzaG93VHlwZURpYWxvZ0NhbGxiYWNrIOaYvuekuuexu+Wei+mAieaLqeWvueivneahhueahOWbnuiwg+WHveaVsFxuICAgKi9cbiAgcHJpdmF0ZSBhZGRPYmplY3RLZXkoXG4gICAgY2FyZDogSlF1ZXJ5PEhUTUxFbGVtZW50PixcbiAgICBuZXdEYXRhVHlwZTogVmFyaWFibGVEYXRhVHlwZSxcbiAgICBzaG93VHlwZURpYWxvZ0NhbGxiYWNrPzogKGNhbGxiYWNrOiAoZGF0YVR5cGU6IFZhcmlhYmxlRGF0YVR5cGUpID0+IHZvaWQpID0+IFByb21pc2U8dm9pZD4sXG4gICk6IHZvaWQge1xuICAgIGNvbnN0IGRlZmF1bHRWYWx1ZSA9IFZhcmlhYmxlTWFuYWdlclV0aWwuZ2V0RGVmYXVsdFZhbHVlRm9yVHlwZShuZXdEYXRhVHlwZSk7XG4gICAgY29uc3QgZXhpc3RpbmdLZXlzID0gbmV3IFNldDxzdHJpbmc+KCk7XG5cbiAgICBjb25zdCAkdGFyZ2V0Q2FyZCA9IGNhcmQuY2xvc2VzdCgnLnZhcmlhYmxlLWNhcmQnKTtcbiAgICAkdGFyZ2V0Q2FyZFxuICAgICAgLmZpbmQoJy5uZXN0ZWQtY2FyZHMtY29udGFpbmVyJylcbiAgICAgIC5maXJzdCgpXG4gICAgICAuY2hpbGRyZW4oJy52YXJpYWJsZS1jYXJkJylcbiAgICAgIC5lYWNoKChfLCBlbGVtZW50KSA9PiB7XG4gICAgICAgIGNvbnN0IGtleSA9ICQoZWxlbWVudCkuZmluZCgnLnZhcmlhYmxlLXRpdGxlJykudmFsKCkgYXMgc3RyaW5nO1xuICAgICAgICBpZiAoa2V5KSB7XG4gICAgICAgICAgZXhpc3RpbmdLZXlzLmFkZChrZXkpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgIGNvbnN0IG5ld0tleSA9IFZhcmlhYmxlTWFuYWdlclV0aWwuZ2VuZXJhdGVVbmlxdWVLZXkoZXhpc3RpbmdLZXlzKTtcblxuICAgIGNvbnN0IG5ld1ZhcmlhYmxlOiBWYXJpYWJsZUl0ZW0gPSB7XG4gICAgICBuYW1lOiBuZXdLZXksXG4gICAgICBkYXRhVHlwZTogbmV3RGF0YVR5cGUsXG4gICAgICB2YWx1ZTogZGVmYXVsdFZhbHVlLFxuICAgICAgaWQ6ICcnLFxuICAgIH07XG5cbiAgICBjb25zdCBuZXdOZXN0ZWRDYXJkID0gdGhpcy5jcmVhdGVDYXJkKG5ld1ZhcmlhYmxlLCB0cnVlLCBzaG93VHlwZURpYWxvZ0NhbGxiYWNrKTtcblxuICAgIGNvbnN0ICR0YXJnZXRDYXJkSGVhZGVyID0gJHRhcmdldENhcmQuZmluZCgnLnZhcmlhYmxlLWNhcmQtaGVhZGVyJykuZmlyc3QoKTtcbiAgICBjb25zdCAkdGFyZ2V0Q2FyZENvbnRlbnQgPSAkdGFyZ2V0Q2FyZEhlYWRlci5zaWJsaW5ncygnLnZhcmlhYmxlLWNhcmQtY29udGVudCcpLmZpcnN0KCk7XG4gICAgY29uc3QgJGNvbnRhaW5lciA9ICR0YXJnZXRDYXJkQ29udGVudC5maW5kKCcubmVzdGVkLWNhcmRzLWNvbnRhaW5lcicpLmZpcnN0KCk7XG5cbiAgICAkY29udGFpbmVyLnByZXBlbmQobmV3TmVzdGVkQ2FyZCk7XG5cbiAgICBuZXdOZXN0ZWRDYXJkLmZpbmQoJy52YXJpYWJsZS10aXRsZScpLmZvY3VzKCkuc2VsZWN0KCk7XG5cbiAgICBjb25zdCB0b3BMZXZlbENhcmQgPSB0aGlzLmZpbmRUb3BMZXZlbENhcmQoJHRhcmdldENhcmQpO1xuICAgIGlmICh0b3BMZXZlbENhcmQgJiYgdG9wTGV2ZWxDYXJkLmlzKCR0YXJnZXRDYXJkKSkge1xuICAgICAgdGhpcy5zeW5jQ2FyZFZpZXdUb0pzb25JbnB1dCgkdGFyZ2V0Q2FyZCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOiuvue9ruWvueixoeWNoeeJh++8iOe7n+S4gOWkhOeQhuW1jOWll+WSjOmdnuW1jOWll+WvueixoeWNoeeJh++8iVxuICAgKiBAcGFyYW0gY2FyZCDlr7nosaHljaHniYdcbiAgICogQHBhcmFtIHZhcmlhYmxlIOWPmOmHj+WvueixoVxuICAgKiBAcGFyYW0gaXNOZXN0ZWQg5piv5ZCm5Li65bWM5aWX5Y2h54mHXG4gICAqIEBwYXJhbSBzaG93VHlwZURpYWxvZ0NhbGxiYWNrIOaYvuekuuexu+Wei+mAieaLqeWvueivneahhueahOWbnuiwg+WHveaVsFxuICAgKi9cbiAgcHJpdmF0ZSBzZXR1cE9iamVjdENhcmQoXG4gICAgY2FyZDogSlF1ZXJ5PEhUTUxFbGVtZW50PixcbiAgICB2YXJpYWJsZTogVmFyaWFibGVJdGVtLFxuICAgIGlzTmVzdGVkPzogYm9vbGVhbixcbiAgICBzaG93VHlwZURpYWxvZ0NhbGxiYWNrPzogKGNhbGxiYWNrOiAoZGF0YVR5cGU6IFZhcmlhYmxlRGF0YVR5cGUpID0+IHZvaWQpID0+IFByb21pc2U8dm9pZD4sXG4gICk6IHZvaWQge1xuICAgIGlmIChpc05lc3RlZCkge1xuICAgICAgY2FyZC5maW5kKCcudmFyaWFibGUtY2FyZC1jb250ZW50JykuYXBwZW5kKGBcbiAgICAgICAgPGRpdiBjbGFzcz1cIm5lc3RlZC1vYmplY3QtY29udGFpbmVyXCI+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cIm5lc3RlZC1jYXJkcy1jb250YWluZXJcIj48L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICBgKTtcblxuICAgICAgY2FyZC5maW5kKCcudmFyaWFibGUtYWN0aW9ucyAub2JqZWN0LXNhdmUtYnRuJykuYmVmb3JlKGBcbiAgICAgICAgPGRpdiBjbGFzcz1cInZhcmlhYmxlLWFjdGlvbi1idG4gYWRkLW5lc3RlZC1rZXktYnRuXCIgdGl0bGU9XCLmt7vliqDplK7lgLzlr7lcIj5cbiAgICAgICAgICA8aSBjbGFzcz1cImZhLXJlZ3VsYXIgZmEtcGx1c1wiPjwvaT5cbiAgICAgICAgPC9kaXY+XG4gICAgICBgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY2FyZC5maW5kKCcudmFyaWFibGUtY2FyZC1jb250ZW50JykuYXBwZW5kKGBcbiAgICAgICAgPHRleHRhcmVhIGNsYXNzPVwianNvbi1pbnB1dCB2YXJpYWJsZS1jb250ZW50LWlucHV0XCIgcGxhY2Vob2xkZXI9XCLovpPlhaVKU09O5a+56LGhXCIgc3R5bGU9XCJkaXNwbGF5OiBub25lO1wiPjwvdGV4dGFyZWE+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwib2JqZWN0LWNhcmQtdmlld1wiPlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibmVzdGVkLWNhcmRzLWNvbnRhaW5lclwiPjwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICBgKTtcblxuICAgICAgY2FyZC5maW5kKCcudmFyaWFibGUtYWN0aW9ucyAuc2F2ZS1idG4nKS5iZWZvcmUoYFxuICAgICAgICA8ZGl2IGNsYXNzPVwidmFyaWFibGUtYWN0aW9uLWJ0biB0b2dnbGUtdmlldy1idG5cIiB0aXRsZT1cIuWIh+aNouWIsEpTT07op4blm75cIj5cbiAgICAgICAgICA8aSBjbGFzcz1cImZhLXJlZ3VsYXIgZmEtbGlzdFwiPjwvaT5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJ2YXJpYWJsZS1hY3Rpb24tYnRuIGFkZC1rZXktYnRuXCIgdGl0bGU9XCLmt7vliqDplK7lgLzlr7lcIj5cbiAgICAgICAgICA8aSBjbGFzcz1cImZhLXJlZ3VsYXIgZmEtcGx1c1wiPjwvaT5cbiAgICAgICAgPC9kaXY+XG4gICAgICBgKTtcblxuICAgICAgY2FyZC5maW5kKCcudmFyaWFibGUtYWN0aW9ucyAuZGVsZXRlLWJ0bicpLmFmdGVyKGBcbiAgICAgICAgPGRpdiBjbGFzcz1cInZhcmlhYmxlLWFjdGlvbi1idG4gY29sbGFwc2UtYnRuIGZsZXhcIiB0aXRsZT1cIuaKmOWPoFwiPlxuICAgICAgICAgIDxpIGNsYXNzPVwiZmEtc29saWQgZmEtY2hldnJvbi1kb3duXCI+PC9pPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIGApO1xuXG4gICAgICBjYXJkLmZpbmQoJy52YXJpYWJsZS1jYXJkLWNvbnRlbnQnKS5hZGRDbGFzcygnZXhwYW5kZWQnKTtcbiAgICAgIGNhcmQuZmluZCgnLmNvbGxhcHNlLWJ0bicpLmFkZENsYXNzKCdleHBhbmRlZCcpO1xuXG4gICAgICBjYXJkLmZpbmQoJy5jb2xsYXBzZS1idG4nKS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0ICRpY29uID0gY2FyZC5maW5kKCcuY29sbGFwc2UtYnRuJyk7XG4gICAgICAgIGNvbnN0ICRib2R5ID0gY2FyZC5jaGlsZHJlbignLnZhcmlhYmxlLWNhcmQtY29udGVudCcpO1xuXG4gICAgICAgICRpY29uLnRvZ2dsZUNsYXNzKCdleHBhbmRlZCcpO1xuICAgICAgICAkYm9keS50b2dnbGVDbGFzcygnZXhwYW5kZWQnKTtcbiAgICAgIH0pO1xuXG4gICAgICBjYXJkLmZpbmQoJy5qc29uLWlucHV0JykudmFsKEpTT04uc3RyaW5naWZ5KHZhcmlhYmxlLnZhbHVlLCBudWxsLCAyKSkuZW5kKCkuYXR0cignZGF0YS12aWV3LW1vZGUnLCAnY2FyZCcpO1xuXG4gICAgICBjYXJkLmZpbmQoJy5qc29uLWlucHV0Jykub24oJ2JsdXIgY2hhbmdlJywgKCkgPT4ge1xuICAgICAgICBjb25zdCBjdXJyZW50TW9kZSA9IGNhcmQuYXR0cignZGF0YS12aWV3LW1vZGUnKSB8fCAnY2FyZCc7XG5cbiAgICAgICAgaWYgKGN1cnJlbnRNb2RlID09PSAnY2FyZCcpIHtcbiAgICAgICAgICB0aGlzLnN5bmNKc29uSW5wdXRUb0NhcmRWaWV3KGNhcmQsIHNob3dUeXBlRGlhbG9nQ2FsbGJhY2spO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgY2FyZC5maW5kKCcudG9nZ2xlLXZpZXctYnRuJykub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBjb25zdCAkY2FyZCA9IGNhcmQ7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRNb2RlID0gJGNhcmQuYXR0cignZGF0YS12aWV3LW1vZGUnKSB8fCAnY2FyZCc7XG5cbiAgICAgICAgY29uc3QgbmV3TW9kZSA9IGN1cnJlbnRNb2RlID09PSAnanNvbicgPyAnY2FyZCcgOiAnanNvbic7XG4gICAgICAgICRjYXJkLmF0dHIoJ2RhdGEtdmlldy1tb2RlJywgbmV3TW9kZSk7XG5cbiAgICAgICAgaWYgKG5ld01vZGUgPT09ICdqc29uJykge1xuICAgICAgICAgICRjYXJkXG4gICAgICAgICAgICAuZmluZCgnLnRvZ2dsZS12aWV3LWJ0biBpJylcbiAgICAgICAgICAgIC5yZW1vdmVDbGFzcygnZmEtbGlzdCcpXG4gICAgICAgICAgICAuYWRkQ2xhc3MoJ2ZhLWV5ZScpXG4gICAgICAgICAgICAuZW5kKClcbiAgICAgICAgICAgIC5hdHRyKCd0aXRsZScsICfliIfmjaLliLDljaHniYfop4blm74nKTtcbiAgICAgICAgICAkY2FyZC5maW5kKCcudmFyaWFibGUtYWN0aW9uLWJ0bi5hZGQta2V5LWJ0bicpLmhpZGUoKTtcblxuICAgICAgICAgICRjYXJkLmZpbmQoJy5qc29uLWlucHV0Jykuc2hvdygpLmVuZCgpLmZpbmQoJy5vYmplY3QtY2FyZC12aWV3JykuaGlkZSgpO1xuXG4gICAgICAgICAgdGhpcy5zeW5jQ2FyZFZpZXdUb0pzb25JbnB1dCgkY2FyZCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgJGNhcmRcbiAgICAgICAgICAgIC5maW5kKCcudG9nZ2xlLXZpZXctYnRuIGknKVxuICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCdmYS1leWUnKVxuICAgICAgICAgICAgLmFkZENsYXNzKCdmYS1saXN0JylcbiAgICAgICAgICAgIC5lbmQoKVxuICAgICAgICAgICAgLmF0dHIoJ3RpdGxlJywgJ+WIh+aNouWIsEpTT07op4blm74nKTtcbiAgICAgICAgICAkY2FyZC5maW5kKCcudmFyaWFibGUtYWN0aW9uLWJ0bi5hZGQta2V5LWJ0bicpLnNob3coKTtcblxuICAgICAgICAgICRjYXJkLmZpbmQoJy5qc29uLWlucHV0JykuaGlkZSgpLmVuZCgpLmZpbmQoJy5vYmplY3QtY2FyZC12aWV3Jykuc2hvdygpO1xuXG4gICAgICAgICAgdGhpcy5zeW5jSnNvbklucHV0VG9DYXJkVmlldygkY2FyZCwgc2hvd1R5cGVEaWFsb2dDYWxsYmFjayk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICB0aGlzLnJlbmRlck9iamVjdENhcmRWaWV3KGNhcmQsIHZhcmlhYmxlLCBzaG93VHlwZURpYWxvZ0NhbGxiYWNrKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBsb2cuZXJyb3IoJ+a4suafk+WIneWni+WvueixoeWNoeeJh+inhuWbvumUmeivrzonLCBlKTtcbiAgICAgIHRvYXN0ci5lcnJvcign5riy5p+T5a+56LGh5Y2h54mH6KeG5Zu+6ZSZ6K+vJyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWQjOatpeWNoeeJh+inhuWbvuWIsEpTT07ovpPlhaXmoYZcbiAgICogQHBhcmFtIGNhcmQg5a+56LGh5Y2h54mHXG4gICAqL1xuICBwcml2YXRlIHN5bmNDYXJkVmlld1RvSnNvbklucHV0KGNhcmQ6IEpRdWVyeTxIVE1MRWxlbWVudD4pOiB2b2lkIHtcbiAgICBjb25zdCBvYmplY3RWYWx1ZSA9IHRoaXMuZXh0cmFjdE9iamVjdEZyb21OZXN0ZWRDYXJkcyhjYXJkKTtcbiAgICBjYXJkLmZpbmQoJy5qc29uLWlucHV0JykudmFsKEpTT04uc3RyaW5naWZ5KG9iamVjdFZhbHVlLCBudWxsLCAyKSk7XG4gIH1cblxuICAvKipcbiAgICog5ZCM5q2lSlNPTui+k+WFpeahhuWIsOWNoeeJh+inhuWbvlxuICAgKiBAcGFyYW0gY2FyZCDlr7nosaHljaHniYdcbiAgICogQHBhcmFtIHNob3dUeXBlRGlhbG9nQ2FsbGJhY2sg5pi+56S657G75Z6L6YCJ5oup5a+56K+d5qGG55qE5Zue6LCD5Ye95pWwXG4gICAqL1xuICBwcml2YXRlIHN5bmNKc29uSW5wdXRUb0NhcmRWaWV3KFxuICAgIGNhcmQ6IEpRdWVyeTxIVE1MRWxlbWVudD4sXG4gICAgc2hvd1R5cGVEaWFsb2dDYWxsYmFjaz86IChjYWxsYmFjazogKGRhdGFUeXBlOiBWYXJpYWJsZURhdGFUeXBlKSA9PiB2b2lkKSA9PiBQcm9taXNlPHZvaWQ+LFxuICApOiB2b2lkIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QganNvblZhbHVlID0gY2FyZC5maW5kKCcuanNvbi1pbnB1dCcpLnZhbCgpIGFzIHN0cmluZztcbiAgICAgIGlmIChqc29uVmFsdWUgJiYganNvblZhbHVlLnRyaW0oKSkge1xuICAgICAgICBjb25zdCBvYmplY3RWYWx1ZSA9IEpTT04ucGFyc2UoanNvblZhbHVlKTtcbiAgICAgICAgY29uc3QgdGVtcFZhcmlhYmxlOiBWYXJpYWJsZUl0ZW0gPSB7XG4gICAgICAgICAgaWQ6IGNhcmQuYXR0cignZGF0YS12YXJpYWJsZS1pZCcpIHx8ICcnLFxuICAgICAgICAgIG5hbWU6IGNhcmQuZmluZCgnLnZhcmlhYmxlLXRpdGxlJykudmFsKCkgYXMgc3RyaW5nLFxuICAgICAgICAgIGRhdGFUeXBlOiAnb2JqZWN0JyxcbiAgICAgICAgICB2YWx1ZTogb2JqZWN0VmFsdWUsXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMucmVuZGVyT2JqZWN0Q2FyZFZpZXcoY2FyZCwgdGVtcFZhcmlhYmxlLCBzaG93VHlwZURpYWxvZ0NhbGxiYWNrKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChwYXJzZUVycm9yKSB7XG4gICAgICBsb2cuZXJyb3IoJ0pTT07op6PmnpDplJnor686JywgcGFyc2VFcnJvcik7XG4gICAgICB0b2FzdHIuZXJyb3IoJ0pTT07moLzlvI/plJnor6/vvIzml6Dms5XlkIzmraXliLDljaHniYfop4blm74nKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5Yib5bu65pWw57uE6aG577yI5omA5pyJ6aG56YO95pi+56S65Li65a2X56ym5Liy6L6T5YWl5qGG77yJXG4gICAqIEBwYXJhbSBjYXJkIOaVsOe7hOWNoeeJh1xuICAgKiBAcGFyYW0gaXRlbXMg5pWw57uE6aG5XG4gICAqL1xuICBwcml2YXRlIHBvcHVsYXRlQXJyYXlJdGVtcyhjYXJkOiBKUXVlcnk8SFRNTEVsZW1lbnQ+LCBpdGVtczogYW55W10pOiB2b2lkIHtcbiAgICBpZiAoIWl0ZW1zIHx8IGl0ZW1zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGxpc3RDb250YWluZXIgPSBjYXJkLmZpbmQoJy5saXN0LWl0ZW1zLWNvbnRhaW5lcicpO1xuICAgIGxpc3RDb250YWluZXIuZW1wdHkoKTtcblxuICAgIGl0ZW1zLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICBjb25zdCBkaXNwbGF5VmFsdWUgPSB0eXBlb2YgaXRlbSA9PT0gJ29iamVjdCcgPyBKU09OLnN0cmluZ2lmeShpdGVtKSA6IFN0cmluZyhpdGVtKTtcbiAgICAgIGNvbnN0IGxpc3RJdGVtID0gJChgXG4gICAgICAgIDxkaXYgY2xhc3M9XCJsaXN0LWl0ZW1cIj5cbiAgICAgICAgICA8c3BhbiBjbGFzcz1cImRyYWctaGFuZGxlXCI+4piwPC9zcGFuPlxuICAgICAgICAgIDx0ZXh0YXJlYSBjbGFzcz1cInZhcmlhYmxlLWNvbnRlbnQtaW5wdXRcIj4ke2Rpc3BsYXlWYWx1ZX08L3RleHRhcmVhPlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJsaXN0LWl0ZW0tZGVsZXRlXCI+PGkgY2xhc3M9XCJmYS1zb2xpZCBmYS10aW1lc1wiPjwvaT48L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICBgKTtcbiAgICAgIGxpc3RDb250YWluZXIuYXBwZW5kKGxpc3RJdGVtKTtcbiAgICB9KTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/component/variable_manager/card.ts\n")},"./src/component/variable_manager/controller.ts":
/*!******************************************************!*\
  !*** ./src/component/variable_manager/controller.ts ***!
  \******************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VariableController: () => (/* binding */ VariableController)\n/* harmony export */ });\n/* harmony import */ var _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/variable_manager/util */ \"./src/component/variable_manager/util.ts\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_1__);\n\n\nclass VariableController {\n    /**\n     * 变量数据模型\n     */\n    model;\n    /**\n     * 变量视图\n     */\n    view;\n    /**\n     * 变量同步服务\n     */\n    syncService;\n    /**\n     * 变量卡片工厂\n     */\n    cardFactory;\n    /**\n     * 构造函数\n     * @param model 数据模型\n     * @param view 视图\n     * @param syncService 同步服务\n     * @param cardFactory 卡片工厂\n     */\n    constructor(model, view, syncService, cardFactory) {\n        this.model = model;\n        this.view = view;\n        this.syncService = syncService;\n        this.cardFactory = cardFactory;\n    }\n    /**\n     * 初始化控制器\n     * @param container UI容器\n     */\n    async init(container) {\n        this.view.initUI();\n        this.bindEvents(container);\n        await this.syncService.initCurrentType();\n        await this.syncService.setCurrentType('global');\n        await this.loadVariables('global');\n    }\n    /**\n     * 绑定UI事件\n     * @param container UI容器\n     */\n    bindEvents(container) {\n        container.find('.tab-item').on('click', this.handleTabChange.bind(this));\n        container.on('click', '.add-list-item', this.handleAddListItem.bind(this));\n        container.on('click', '.list-item-delete', this.handleDeleteListItem.bind(this));\n        container.on('click', '.delete-btn', this.handleDeleteVariableCard.bind(this));\n        container.on('click', '.save-btn', this.handleSaveVariableCard.bind(this));\n        container.on('click', '#add-variable', this.handleAddVariable.bind(this));\n        container.on('click', '#clear-all', this.handleClearAll.bind(this));\n        container.on('click', '#filter-icon', this.handleFilterIconClick.bind(this));\n        container.on('change', '.filter-checkbox', this.handleFilterOptionChange.bind(this));\n        container.on('input', '#variable-search', this.handleVariableSearch.bind(this));\n        container.on('click', '#floor-filter-btn', this.handleFloorRangeFilter.bind(this));\n        container.on('nested-card:changed', '.variable-card', this.handleNestedCardChanged.bind(this));\n    }\n    /**\n     * 加载变量\n     * @param type 变量类型\n     */\n    async loadVariables(type) {\n        const variables = await this.model.loadFromTavern(type);\n        if (variables.length === 0) {\n            toastr.warning(`${type}变量为空`);\n            return;\n        }\n        if (type === 'message') {\n            this.view.container.find('#floor-filter-container').show();\n            const [minFloor, maxFloor] = this.model.getFloorRange();\n            this.view.updateFloorRangeInputs(minFloor, maxFloor);\n        }\n        else {\n            this.view.container.find('#floor-filter-container').hide();\n        }\n        this.view.refreshVariableCards(type, variables);\n        this.applyFilters();\n    }\n    /**\n     * 处理标签页切换\n     * @param event 点击事件\n     */\n    async handleTabChange(event) {\n        const target = $(event.currentTarget);\n        const tabId = target.attr('id');\n        if (!tabId)\n            return;\n        const type = tabId.replace('-tab', '');\n        const currentType = this.model.getActiveVariableType();\n        if (type === currentType)\n            return;\n        this.view.setActiveTab(type);\n        await this.syncService.setCurrentType(type);\n        await this.loadVariables(type);\n    }\n    /**\n     * 处理添加列表项\n     * @param event 点击事件\n     */\n    handleAddListItem(event) {\n        const button = $(event.currentTarget);\n        const listContainer = button.siblings('.list-items-container');\n        const newItem = $(`\n      <div class=\"list-item\">\n        <span class=\"drag-handle\">☰</span>\n        <textarea class=\"variable-content-input\" placeholder=\"输入变量内容\"></textarea>\n        <button class=\"list-item-delete\"><i class=\"fa-solid fa-times\"></i></button>\n      </div>\n    `);\n        listContainer.append(newItem);\n        newItem.find('textarea').focus();\n    }\n    /**\n     * 处理删除列表项\n     * @param event 点击事件\n     */\n    handleDeleteListItem(event) {\n        const button = $(event.currentTarget);\n        const listItem = button.closest('.list-item');\n        listItem.css({\n            'background-color': 'rgba(255, 0, 0, 0.2)',\n            transition: 'all 0.3s ease',\n        });\n        setTimeout(() => {\n            listItem.css({\n                transform: 'scale(0.9)',\n                opacity: '0.7',\n            });\n            setTimeout(() => {\n                listItem.remove();\n            }, 200);\n        }, 50);\n    }\n    /**\n     * 处理删除变量卡片\n     * @param event 点击事件\n     */\n    async handleDeleteVariableCard(event) {\n        const button = $(event.currentTarget);\n        const card = button.closest('.variable-card');\n        const variable_id = card.attr('data-variable-id') || '';\n        const type = this.model.getActiveVariableType();\n        if (button.hasClass('object-delete-btn')) {\n            return;\n        }\n        this.view.showConfirmDialog(`确定要删除变量吗？此操作无法撤销。`, async (confirmed) => {\n            if (confirmed) {\n                try {\n                    const isRemoved = this.model.removeFromMap(variable_id);\n                    if (isRemoved) {\n                        await this.model.saveAllVariables(type);\n                        this.view.removeVariableCard(variable_id);\n                    }\n                }\n                catch (error) {\n                    loglevel__WEBPACK_IMPORTED_MODULE_1___default().error(`[VariableManager] 删除变量失败:`, error);\n                }\n            }\n        });\n    }\n    /**\n     * 处理添加变量\n     */\n    async handleAddVariable() {\n        const type = this.model.getActiveVariableType();\n        this.view.showAddVariableDialog((dataType, floorId) => {\n            this.view.addNewVariableCard(type, dataType, floorId);\n            this.applyFilters();\n        });\n    }\n    /**\n     * 处理保存变量卡片\n     * @param event 点击事件\n     */\n    async handleSaveVariableCard(event) {\n        const button = $(event.currentTarget);\n        const card = button.closest('.variable-card');\n        const type = this.model.getActiveVariableType();\n        const dataType = _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_0__.VariableManagerUtil.inferDataType(this.cardFactory.getVariableFromCard(card));\n        if (dataType == 'object') {\n            this.syncObjectCardData(card);\n        }\n        let message_id = undefined;\n        if (type === 'message') {\n            const floorIdStr = card.attr('data-floor-id');\n            if (floorIdStr) {\n                message_id = parseInt(floorIdStr);\n            }\n        }\n        let newVariable = {\n            name: this.view.getVariableCardName(card),\n            value: this.cardFactory.getVariableFromCard(card)?.value,\n            dataType: dataType,\n            id: card.attr('data-variable-id') || '',\n            ...(message_id !== undefined && { message_id }),\n        };\n        if (newVariable.name == undefined || newVariable.name.trim() === '') {\n            toastr.error('变量名不能为空');\n            return;\n        }\n        let sameNameVariables;\n        if (type === 'message' && message_id !== undefined) {\n            sameNameVariables = this.model.getVariablesByMessageId(message_id).filter(v => v.name === newVariable.name);\n        }\n        else {\n            sameNameVariables = this.model.getVariablesByName(newVariable.name);\n        }\n        const otherSameNameVariables = sameNameVariables.filter(v => v.id !== newVariable.id);\n        if (otherSameNameVariables.length > 0) {\n            toastr.error('变量名重复');\n            return;\n        }\n        try {\n            if (newVariable.id && this.model.getVariableById(newVariable.id)) {\n                this.model.updateInMap(newVariable.id, newVariable.name, newVariable.value, message_id);\n            }\n            else {\n                const addedVariable = this.model.addToMap(newVariable.name, newVariable.value, message_id);\n                newVariable.id = addedVariable.id;\n                card.attr('data-variable-id', newVariable.id);\n            }\n            if (type === 'message' && message_id !== undefined) {\n                await this.model.saveAllVariables(type, message_id);\n            }\n            else {\n                await this.model.saveAllVariables(type);\n            }\n            this.view.addAnimation(card, 'variable-changed', () => { });\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_1___default().error(`[VariableManager] 保存变量失败:`, error);\n            toastr.error(`保存变量失败: ${error instanceof Error ? error.message : '未知错误'}`);\n        }\n    }\n    /**\n     * 处理清除所有变量\n     */\n    async handleClearAll() {\n        const type = this.model.getActiveVariableType();\n        this.view.showConfirmDialog(`确定要清除所有${this.getVariableTypeName(type)}变量吗？此操作不可撤销。`, async (confirmed) => {\n            if (confirmed) {\n                try {\n                    await this.model.clearAllVariables(type);\n                    const container = this.view.container.find(`#${type}-content .variable-list`);\n                    container.empty();\n                    if (type == 'message') {\n                        const floorContainer = this.view.container.find(`#${type}-content .floor-variables-container`);\n                        floorContainer.empty();\n                    }\n                    toastr.success(`已清除所有${this.getVariableTypeName(type)}变量`);\n                }\n                catch (error) {\n                    loglevel__WEBPACK_IMPORTED_MODULE_1___default().error(`[VariableManager] 清除${type}变量失败:`, error);\n                    toastr.error(`清除${this.getVariableTypeName(type)}变量时出错: ${error.message || '未知错误'}`);\n                }\n            }\n        });\n    }\n    /**\n     * 处理筛选图标点击\n     */\n    handleFilterIconClick() {\n        const $filterOptions = this.view.container.find('.filter-options');\n        $filterOptions.toggle();\n    }\n    /**\n     * 处理筛选选项变更\n     * @param event 变更事件\n     */\n    handleFilterOptionChange(event) {\n        const $checkbox = $(event.currentTarget);\n        const type = $checkbox.data('type');\n        const isChecked = $checkbox.is(':checked');\n        this.model.updateFilterState(type, isChecked);\n        this.applyFilters();\n    }\n    /**\n     * 处理变量搜索\n     * @param event 输入事件\n     */\n    handleVariableSearch(event) {\n        const keyword = $(event.currentTarget).val();\n        this.model.updateSearchKeyword(keyword);\n        this.applyFilters();\n    }\n    /**\n     * 应用筛选\n     */\n    applyFilters() {\n        const filterState = this.model.getFilterState();\n        const searchKeyword = this.model.getSearchKeyword();\n        this.view.applyClientSideFilters(filterState, searchKeyword);\n    }\n    /**\n     * 处理楼层范围筛选\n     */\n    handleFloorRangeFilter() {\n        const $minInput = this.view.container.find('#floor-min');\n        const $maxInput = this.view.container.find('#floor-max');\n        const minVal = $minInput.val();\n        const maxVal = $maxInput.val();\n        const min = minVal.trim() ? parseInt(minVal, 10) : null;\n        const max = maxVal.trim() ? parseInt(maxVal, 10) : null;\n        if ((minVal.trim() && isNaN(min)) || (maxVal.trim() && isNaN(max))) {\n            this.view.showFloorFilterError('请输入有效的数字');\n            return;\n        }\n        if (min !== null && min < 0) {\n            this.view.showFloorFilterError('最小楼层不能小于0');\n            return;\n        }\n        if (max !== null && max < 0) {\n            this.view.showFloorFilterError('最大楼层不能小于0');\n            return;\n        }\n        if (min !== null && max !== null && min > max) {\n            this.view.showFloorFilterError('最小值不能大于最大值');\n            return;\n        }\n        if (min === null && max === null) {\n            this.view.showFloorFilterError('请至少设置最小楼层或最大楼层');\n            return;\n        }\n        this.view.hideFloorFilterError();\n        const effectiveMin = min ?? 0;\n        const effectiveMax = max ?? 9999;\n        this.applyFloorRangeAndReload(effectiveMin, effectiveMax);\n    }\n    /**\n     * 应用楼层范围并重新加载变量\n     * @param min 最小楼层\n     * @param max 最大楼层\n     */\n    async applyFloorRangeAndReload(min, max) {\n        try {\n            this.model.updateFloorRange(min, max);\n            this.view.updateFloorRangeInputs(min, max);\n            await this.loadVariables('message');\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_1___default().error(`[VariableManager] 应用楼层范围并重新加载变量失败:`, error);\n        }\n    }\n    /**\n     * 清理资源\n     */\n    cleanup() {\n        try {\n            this.syncService.cleanup();\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_1___default().error(`[VariableManager] 清理资源失败:`, error);\n        }\n    }\n    /**\n     * 同步对象卡片的视图数据\n     * @param card 变量卡片\n     */\n    syncObjectCardData(card) {\n        const currentMode = card.attr('data-view-mode') || 'card';\n        if (currentMode === 'card') {\n            const objectValue = this.cardFactory.getVariableFromCard(card);\n            card.find('.json-input').val(JSON.stringify(objectValue?.value, null, 2));\n        }\n    }\n    /**\n     * 处理嵌套卡片变更事件\n     * @param event 事件对象\n     */\n    async handleNestedCardChanged(event) {\n        const card = $(event.currentTarget);\n        const saveBtn = card.find('.variable-action-btn.save-btn');\n        if (saveBtn.length > 0) {\n            saveBtn.trigger('click');\n        }\n    }\n    /**\n     * 获取变量类型的中文名称\n     * @param type 变量类型\n     * @returns 中文名称\n     */\n    getVariableTypeName(type) {\n        switch (type) {\n            case 'global':\n                return '全局';\n            case 'character':\n                return '角色';\n            case 'chat':\n                return '聊天';\n            case 'message':\n                return '消息';\n            default:\n                return type;\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvY29udHJvbGxlci50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBSXdFO0FBRzdDO0FBRXBCLE1BQU0sa0JBQWtCO0lBQzdCOztPQUVHO0lBQ0ssS0FBSyxDQUFnQjtJQUU3Qjs7T0FFRztJQUNLLElBQUksQ0FBZTtJQUUzQjs7T0FFRztJQUNLLFdBQVcsQ0FBc0I7SUFFekM7O09BRUc7SUFDSyxXQUFXLENBQXNCO0lBRXpDOzs7Ozs7T0FNRztJQUNILFlBQ0UsS0FBb0IsRUFDcEIsSUFBa0IsRUFDbEIsV0FBZ0MsRUFDaEMsV0FBZ0M7UUFFaEMsSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7UUFDbkIsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7UUFDakIsSUFBSSxDQUFDLFdBQVcsR0FBRyxXQUFXLENBQUM7UUFDL0IsSUFBSSxDQUFDLFdBQVcsR0FBRyxXQUFXLENBQUM7SUFDakMsQ0FBQztJQUVEOzs7T0FHRztJQUNJLEtBQUssQ0FBQyxJQUFJLENBQUMsU0FBOEI7UUFDOUMsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUNuQixJQUFJLENBQUMsVUFBVSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQzNCLE1BQU0sSUFBSSxDQUFDLFdBQVcsQ0FBQyxlQUFlLEVBQUUsQ0FBQztRQUN6QyxNQUFNLElBQUksQ0FBQyxXQUFXLENBQUMsY0FBYyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ2hELE1BQU0sSUFBSSxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUNyQyxDQUFDO0lBRUQ7OztPQUdHO0lBQ0ssVUFBVSxDQUFDLFNBQThCO1FBQy9DLFNBQVMsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO1FBQ3pFLFNBQVMsQ0FBQyxFQUFF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QUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDNUUsQ0FBQztJQUNILENBQUM7SUFFRDs7O09BR0c7SUFDSyxLQUFLLENBQUMsdUJBQXVCLENBQUMsS0FBNEI7UUFDaEUsTUFBTSxJQUFJLEdBQUcsQ0FBQyxDQUFDLEtBQUssQ0FBQyxhQUFhLENBQUMsQ0FBQztRQUVwQyxNQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLCtCQUErQixDQUFDLENBQUM7UUFDM0QsSUFBSSxPQUFPLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRSxDQUFDO1lBQ3ZCLE9BQU8sQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDM0IsQ0FBQztJQUNILENBQUM7SUFFRDs7OztPQUlHO0lBQ0ssbUJBQW1CLENBQUMsSUFBa0I7UUFDNUMsUUFBUSxJQUFJLEVBQUUsQ0FBQztZQUNiLEtBQUssUUFBUTtnQkFDWCxPQUFPLElBQUksQ0FBQztZQUNkLEtBQUssV0FBVztnQkFDZCxPQUFPLElBQUksQ0FBQztZQUNkLEtBQUssTUFBTTtnQkFDVCxPQUFPLElBQUksQ0FBQztZQUNkLEtBQUssU0FBUztnQkFDWixPQUFPLElBQUksQ0FBQztZQUNkO2dCQUNFLE9BQU8sSUFBSSxDQUFDO1FBQ2hCLENBQUM7SUFDSCxDQUFDO0NBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvY29udHJvbGxlci50cz9mZjE4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFZhcmlhYmxlQ2FyZEZhY3RvcnkgfSBmcm9tICdAL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL2NhcmQnO1xuaW1wb3J0IHsgVmFyaWFibGVNb2RlbCB9IGZyb20gJ0AvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvbW9kZWwnO1xuaW1wb3J0IHsgVmFyaWFibGVTeW5jU2VydmljZSB9IGZyb20gJ0AvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvc3luYyc7XG5pbXBvcnQgeyBWYXJpYWJsZURhdGFUeXBlLCBWYXJpYWJsZUl0ZW0sIFZhcmlhYmxlVHlwZSB9IGZyb20gJ0AvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvdHlwZXMnO1xuaW1wb3J0IHsgVmFyaWFibGVNYW5hZ2VyVXRpbCB9IGZyb20gJ0AvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvdXRpbCc7XG5pbXBvcnQgeyBWYXJpYWJsZVZpZXcgfSBmcm9tICdAL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL3ZpZXcnO1xuXG5pbXBvcnQgbG9nIGZyb20gJ2xvZ2xldmVsJztcblxuZXhwb3J0IGNsYXNzIFZhcmlhYmxlQ29udHJvbGxlciB7XG4gIC8qKlxuICAgKiDlj5jph4/mlbDmja7mqKHlnotcbiAgICovXG4gIHByaXZhdGUgbW9kZWw6IFZhcmlhYmxlTW9kZWw7XG5cbiAgLyoqXG4gICAqIOWPmOmHj+inhuWbvlxuICAgKi9cbiAgcHJpdmF0ZSB2aWV3OiBWYXJpYWJsZVZpZXc7XG5cbiAgLyoqXG4gICAqIOWPmOmHj+WQjOatpeacjeWKoVxuICAgKi9cbiAgcHJpdmF0ZSBzeW5jU2VydmljZTogVmFyaWFibGVTeW5jU2VydmljZTtcblxuICAvKipcbiAgICog5Y+Y6YeP5Y2h54mH5bel5Y6CXG4gICAqL1xuICBwcml2YXRlIGNhcmRGYWN0b3J5OiBWYXJpYWJsZUNhcmRGYWN0b3J5O1xuXG4gIC8qKlxuICAgKiDmnoTpgKDlh73mlbBcbiAgICogQHBhcmFtIG1vZGVsIOaVsOaNruaooeWei1xuICAgKiBAcGFyYW0gdmlldyDop4blm75cbiAgICogQHBhcmFtIHN5bmNTZXJ2aWNlIOWQjOatpeacjeWKoVxuICAgKiBAcGFyYW0gY2FyZEZhY3Rvcnkg5Y2h54mH5bel5Y6CXG4gICAqL1xuICBjb25zdHJ1Y3RvcihcbiAgICBtb2RlbDogVmFyaWFibGVNb2RlbCxcbiAgICB2aWV3OiBWYXJpYWJsZVZpZXcsXG4gICAgc3luY1NlcnZpY2U6IFZhcmlhYmxlU3luY1NlcnZpY2UsXG4gICAgY2FyZEZhY3Rvcnk6IFZhcmlhYmxlQ2FyZEZhY3RvcnksXG4gICkge1xuICAgIHRoaXMubW9kZWwgPSBtb2RlbDtcbiAgICB0aGlzLnZpZXcgPSB2aWV3O1xuICAgIHRoaXMuc3luY1NlcnZpY2UgPSBzeW5jU2VydmljZTtcbiAgICB0aGlzLmNhcmRGYWN0b3J5ID0gY2FyZEZhY3Rvcnk7XG4gIH1cblxuICAvKipcbiAgICog5Yid5aeL5YyW5o6n5Yi25ZmoXG4gICAqIEBwYXJhbSBjb250YWluZXIgVUnlrrnlmahcbiAgICovXG4gIHB1YmxpYyBhc3luYyBpbml0KGNvbnRhaW5lcjogSlF1ZXJ5PEhUTUxFbGVtZW50Pik6IFByb21pc2U8dm9pZD4ge1xuICAgIHRoaXMudmlldy5pbml0VUkoKTtcbiAgICB0aGlzLmJpbmRFdmVudHMoY29udGFpbmVyKTtcbiAgICBhd2FpdCB0aGlzLnN5bmNTZXJ2aWNlLmluaXRDdXJyZW50VHlwZSgpO1xuICAgIGF3YWl0IHRoaXMuc3luY1NlcnZpY2Uuc2V0Q3VycmVudFR5cGUoJ2dsb2JhbCcpO1xuICAgIGF3YWl0IHRoaXMubG9hZFZhcmlhYmxlcygnZ2xvYmFsJyk7XG4gIH1cblxuICAvKipcbiAgICog57uR5a6aVUnkuovku7ZcbiAgICogQHBhcmFtIGNvbnRhaW5lciBVSeWuueWZqFxuICAgKi9cbiAgcHJpdmF0ZSBiaW5kRXZlbnRzKGNvbnRhaW5lcjogSlF1ZXJ5PEhUTUxFbGVtZW50Pik6IHZvaWQge1xuICAgIGNvbnRhaW5lci5maW5kKCcudGFiLWl0ZW0nKS5vbignY2xpY2snLCB0aGlzLmhhbmRsZVRhYkNoYW5nZS5iaW5kKHRoaXMpKTtcbiAgICBjb250YWluZXIub24oJ2NsaWNrJywgJy5hZGQtbGlzdC1pdGVtJywgdGhpcy5oYW5kbGVBZGRMaXN0SXRlbS5iaW5kKHRoaXMpKTtcbiAgICBjb250YWluZXIub24oJ2NsaWNrJywgJy5saXN0LWl0ZW0tZGVsZXRlJywgdGhpcy5oYW5kbGVEZWxldGVMaXN0SXRlbS5iaW5kKHRoaXMpKTtcbiAgICBjb250YWluZXIub24oJ2NsaWNrJywgJy5kZWxldGUtYnRuJywgdGhpcy5oYW5kbGVEZWxldGVWYXJpYWJsZUNhcmQuYmluZCh0aGlzKSk7XG4gICAgY29udGFpbmVyLm9uKCdjbGljaycsICcuc2F2ZS1idG4nLCB0aGlzLmhhbmRsZVNhdmVWYXJpYWJsZUNhcmQuYmluZCh0aGlzKSk7XG4gICAgY29udGFpbmVyLm9uKCdjbGljaycsICcjYWRkLXZhcmlhYmxlJywgdGhpcy5oYW5kbGVBZGRWYXJpYWJsZS5iaW5kKHRoaXMpKTtcbiAgICBjb250YWluZXIub24oJ2NsaWNrJywgJyNjbGVhci1hbGwnLCB0aGlzLmhhbmRsZUNsZWFyQWxsLmJpbmQodGhpcykpO1xuICAgIGNvbnRhaW5lci5vbignY2xpY2snLCAnI2ZpbHRlci1pY29uJywgdGhpcy5oYW5kbGVGaWx0ZXJJY29uQ2xpY2suYmluZCh0aGlzKSk7XG4gICAgY29udGFpbmVyLm9uKCdjaGFuZ2UnLCAnLmZpbHRlci1jaGVja2JveCcsIHRoaXMuaGFuZGxlRmlsdGVyT3B0aW9uQ2hhbmdlLmJpbmQodGhpcykpO1xuICAgIGNvbnRhaW5lci5vbignaW5wdXQnLCAnI3ZhcmlhYmxlLXNlYXJjaCcsIHRoaXMuaGFuZGxlVmFyaWFibGVTZWFyY2guYmluZCh0aGlzKSk7XG4gICAgY29udGFpbmVyLm9uKCdjbGljaycsICcjZmxvb3ItZmlsdGVyLWJ0bicsIHRoaXMuaGFuZGxlRmxvb3JSYW5nZUZpbHRlci5iaW5kKHRoaXMpKTtcbiAgICBjb250YWluZXIub24oJ25lc3RlZC1jYXJkOmNoYW5nZWQnLCAnLnZhcmlhYmxlLWNhcmQnLCB0aGlzLmhhbmRsZU5lc3RlZENhcmRDaGFuZ2VkLmJpbmQodGhpcykpO1xuICB9XG5cbiAgLyoqXG4gICAqIOWKoOi9veWPmOmHj1xuICAgKiBAcGFyYW0gdHlwZSDlj5jph4/nsbvlnotcbiAgICovXG4gIHB1YmxpYyBhc3luYyBsb2FkVmFyaWFibGVzKHR5cGU6IFZhcmlhYmxlVHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHZhcmlhYmxlcyA9IGF3YWl0IHRoaXMubW9kZWwubG9hZEZyb21UYXZlcm4odHlwZSk7XG5cbiAgICBpZiAodmFyaWFibGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdG9hc3RyLndhcm5pbmcoYCR7dHlwZX3lj5jph4/kuLrnqbpgKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAodHlwZSA9PT0gJ21lc3NhZ2UnKSB7XG4gICAgICB0aGlzLnZpZXcuY29udGFpbmVyLmZpbmQoJyNmbG9vci1maWx0ZXItY29udGFpbmVyJykuc2hvdygpO1xuICAgICAgY29uc3QgW21pbkZsb29yLCBtYXhGbG9vcl0gPSB0aGlzLm1vZGVsLmdldEZsb29yUmFuZ2UoKTtcbiAgICAgIHRoaXMudmlldy51cGRhdGVGbG9vclJhbmdlSW5wdXRzKG1pbkZsb29yLCBtYXhGbG9vcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMudmlldy5jb250YWluZXIuZmluZCgnI2Zsb29yLWZpbHRlci1jb250YWluZXInKS5oaWRlKCk7XG4gICAgfVxuXG4gICAgdGhpcy52aWV3LnJlZnJlc2hWYXJpYWJsZUNhcmRzKHR5cGUsIHZhcmlhYmxlcyk7XG5cbiAgICB0aGlzLmFwcGx5RmlsdGVycygpO1xuICB9XG5cbiAgLyoqXG4gICAqIOWkhOeQhuagh+etvumhteWIh+aNolxuICAgKiBAcGFyYW0gZXZlbnQg54K55Ye75LqL5Lu2XG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGhhbmRsZVRhYkNoYW5nZShldmVudDogSlF1ZXJ5LkNsaWNrRXZlbnQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCB0YXJnZXQgPSAkKGV2ZW50LmN1cnJlbnRUYXJnZXQpO1xuICAgIGNvbnN0IHRhYklkID0gdGFyZ2V0LmF0dHIoJ2lkJyk7XG5cbiAgICBpZiAoIXRhYklkKSByZXR1cm47XG5cbiAgICBjb25zdCB0eXBlID0gdGFiSWQucmVwbGFjZSgnLXRhYicsICcnKSBhcyBWYXJpYWJsZVR5cGU7XG4gICAgY29uc3QgY3VycmVudFR5cGUgPSB0aGlzLm1vZGVsLmdldEFjdGl2ZVZhcmlhYmxlVHlwZSgpO1xuXG4gICAgaWYgKHR5cGUgPT09IGN1cnJlbnRUeXBlKSByZXR1cm47XG5cbiAgICB0aGlzLnZpZXcuc2V0QWN0aXZlVGFiKHR5cGUpO1xuXG4gICAgYXdhaXQgdGhpcy5zeW5jU2VydmljZS5zZXRDdXJyZW50VHlwZSh0eXBlKTtcbiAgICBhd2FpdCB0aGlzLmxvYWRWYXJpYWJsZXModHlwZSk7XG4gIH1cblxuICAvKipcbiAgICog5aSE55CG5re75Yqg5YiX6KGo6aG5XG4gICAqIEBwYXJhbSBldmVudCDngrnlh7vkuovku7ZcbiAgICovXG4gIHByaXZhdGUgaGFuZGxlQWRkTGlzdEl0ZW0oZXZlbnQ6IEpRdWVyeS5DbGlja0V2ZW50KTogdm9pZCB7XG4gICAgY29uc3QgYnV0dG9uID0gJChldmVudC5jdXJyZW50VGFyZ2V0KTtcbiAgICBjb25zdCBsaXN0Q29udGFpbmVyID0gYnV0dG9uLnNpYmxpbmdzKCcubGlzdC1pdGVtcy1jb250YWluZXInKTtcblxuICAgIGNvbnN0IG5ld0l0ZW0gPSAkKGBcbiAgICAgIDxkaXYgY2xhc3M9XCJsaXN0LWl0ZW1cIj5cbiAgICAgICAgPHNwYW4gY2xhc3M9XCJkcmFnLWhhbmRsZVwiPuKYsDwvc3Bhbj5cbiAgICAgICAgPHRleHRhcmVhIGNsYXNzPVwidmFyaWFibGUtY29udGVudC1pbnB1dFwiIHBsYWNlaG9sZGVyPVwi6L6T5YWl5Y+Y6YeP5YaF5a65XCI+PC90ZXh0YXJlYT5cbiAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImxpc3QtaXRlbS1kZWxldGVcIj48aSBjbGFzcz1cImZhLXNvbGlkIGZhLXRpbWVzXCI+PC9pPjwvYnV0dG9uPlxuICAgICAgPC9kaXY+XG4gICAgYCk7XG5cbiAgICBsaXN0Q29udGFpbmVyLmFwcGVuZChuZXdJdGVtKTtcbiAgICBuZXdJdGVtLmZpbmQoJ3RleHRhcmVhJykuZm9jdXMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlpITnkIbliKDpmaTliJfooajpoblcbiAgICogQHBhcmFtIGV2ZW50IOeCueWHu+S6i+S7tlxuICAgKi9cbiAgcHJpdmF0ZSBoYW5kbGVEZWxldGVMaXN0SXRlbShldmVudDogSlF1ZXJ5LkNsaWNrRXZlbnQpOiB2b2lkIHtcbiAgICBjb25zdCBidXR0b24gPSAkKGV2ZW50LmN1cnJlbnRUYXJnZXQpO1xuICAgIGNvbnN0IGxpc3RJdGVtID0gYnV0dG9uLmNsb3Nlc3QoJy5saXN0LWl0ZW0nKTtcblxuICAgIGxpc3RJdGVtLmNzcyh7XG4gICAgICAnYmFja2dyb3VuZC1jb2xvcic6ICdyZ2JhKDI1NSwgMCwgMCwgMC4yKScsXG4gICAgICB0cmFuc2l0aW9uOiAnYWxsIDAuM3MgZWFzZScsXG4gICAgfSk7XG5cbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGxpc3RJdGVtLmNzcyh7XG4gICAgICAgIHRyYW5zZm9ybTogJ3NjYWxlKDAuOSknLFxuICAgICAgICBvcGFjaXR5OiAnMC43JyxcbiAgICAgIH0pO1xuXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgbGlzdEl0ZW0ucmVtb3ZlKCk7XG4gICAgICB9LCAyMDApO1xuICAgIH0sIDUwKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlpITnkIbliKDpmaTlj5jph4/ljaHniYdcbiAgICogQHBhcmFtIGV2ZW50IOeCueWHu+S6i+S7tlxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBoYW5kbGVEZWxldGVWYXJpYWJsZUNhcmQoZXZlbnQ6IEpRdWVyeS5DbGlja0V2ZW50KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgYnV0dG9uID0gJChldmVudC5jdXJyZW50VGFyZ2V0KTtcbiAgICBjb25zdCBjYXJkID0gYnV0dG9uLmNsb3Nlc3QoJy52YXJpYWJsZS1jYXJkJyk7XG4gICAgY29uc3QgdmFyaWFibGVfaWQgPSBjYXJkLmF0dHIoJ2RhdGEtdmFyaWFibGUtaWQnKSB8fCAnJztcblxuICAgIGNvbnN0IHR5cGUgPSB0aGlzLm1vZGVsLmdldEFjdGl2ZVZhcmlhYmxlVHlwZSgpO1xuXG4gICAgaWYgKGJ1dHRvbi5oYXNDbGFzcygnb2JqZWN0LWRlbGV0ZS1idG4nKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMudmlldy5zaG93Q29uZmlybURpYWxvZyhg56Gu5a6a6KaB5Yig6Zmk5Y+Y6YeP5ZCX77yf5q2k5pON5L2c5peg5rOV5pKk6ZSA44CCYCwgYXN5bmMgY29uZmlybWVkID0+IHtcbiAgICAgIGlmIChjb25maXJtZWQpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBpc1JlbW92ZWQgPSB0aGlzLm1vZGVsLnJlbW92ZUZyb21NYXAodmFyaWFibGVfaWQpO1xuICAgICAgICAgIGlmIChpc1JlbW92ZWQpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMubW9kZWwuc2F2ZUFsbFZhcmlhYmxlcyh0eXBlKTtcbiAgICAgICAgICAgIHRoaXMudmlldy5yZW1vdmVWYXJpYWJsZUNhcmQodmFyaWFibGVfaWQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBsb2cuZXJyb3IoYFtWYXJpYWJsZU1hbmFnZXJdIOWIoOmZpOWPmOmHj+Wksei0pTpgLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlpITnkIbmt7vliqDlj5jph49cbiAgICovXG4gIHByaXZhdGUgYXN5bmMgaGFuZGxlQWRkVmFyaWFibGUoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgdHlwZSA9IHRoaXMubW9kZWwuZ2V0QWN0aXZlVmFyaWFibGVUeXBlKCk7XG4gICAgdGhpcy52aWV3LnNob3dBZGRWYXJpYWJsZURpYWxvZygoZGF0YVR5cGUsIGZsb29ySWQpID0+IHtcbiAgICAgIHRoaXMudmlldy5hZGROZXdWYXJpYWJsZUNhcmQodHlwZSwgZGF0YVR5cGUsIGZsb29ySWQpO1xuICAgICAgdGhpcy5hcHBseUZpbHRlcnMoKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlpITnkIbkv53lrZjlj5jph4/ljaHniYdcbiAgICogQHBhcmFtIGV2ZW50IOeCueWHu+S6i+S7tlxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBoYW5kbGVTYXZlVmFyaWFibGVDYXJkKGV2ZW50OiBKUXVlcnkuQ2xpY2tFdmVudCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGJ1dHRvbiA9ICQoZXZlbnQuY3VycmVudFRhcmdldCk7XG4gICAgY29uc3QgY2FyZCA9IGJ1dHRvbi5jbG9zZXN0KCcudmFyaWFibGUtY2FyZCcpO1xuICAgIGNvbnN0IHR5cGUgPSB0aGlzLm1vZGVsLmdldEFjdGl2ZVZhcmlhYmxlVHlwZSgpO1xuICAgIGNvbnN0IGRhdGFUeXBlID0gVmFyaWFibGVNYW5hZ2VyVXRpbC5pbmZlckRhdGFUeXBlKHRoaXMuY2FyZEZhY3RvcnkuZ2V0VmFyaWFibGVGcm9tQ2FyZChjYXJkKSk7XG5cbiAgICBpZiAoZGF0YVR5cGUgPT0gJ29iamVjdCcpIHtcbiAgICAgIHRoaXMuc3luY09iamVjdENhcmREYXRhKGNhcmQpO1xuICAgIH1cblxuICAgIGxldCBtZXNzYWdlX2lkOiBudW1iZXIgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQ7XG4gICAgaWYgKHR5cGUgPT09ICdtZXNzYWdlJykge1xuICAgICAgY29uc3QgZmxvb3JJZFN0ciA9IGNhcmQuYXR0cignZGF0YS1mbG9vci1pZCcpO1xuICAgICAgaWYgKGZsb29ySWRTdHIpIHtcbiAgICAgICAgbWVzc2FnZV9pZCA9IHBhcnNlSW50KGZsb29ySWRTdHIpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGxldCBuZXdWYXJpYWJsZTogVmFyaWFibGVJdGVtID0ge1xuICAgICAgbmFtZTogdGhpcy52aWV3LmdldFZhcmlhYmxlQ2FyZE5hbWUoY2FyZCksXG4gICAgICB2YWx1ZTogdGhpcy5jYXJkRmFjdG9yeS5nZXRWYXJpYWJsZUZyb21DYXJkKGNhcmQpPy52YWx1ZSxcbiAgICAgIGRhdGFUeXBlOiBkYXRhVHlwZSxcbiAgICAgIGlkOiBjYXJkLmF0dHIoJ2RhdGEtdmFyaWFibGUtaWQnKSB8fCAnJyxcbiAgICAgIC4uLihtZXNzYWdlX2lkICE9PSB1bmRlZmluZWQgJiYgeyBtZXNzYWdlX2lkIH0pLFxuICAgIH07XG5cbiAgICBpZiAobmV3VmFyaWFibGUubmFtZSA9PSB1bmRlZmluZWQgfHwgbmV3VmFyaWFibGUubmFtZS50cmltKCkgPT09ICcnKSB7XG4gICAgICB0b2FzdHIuZXJyb3IoJ+WPmOmHj+WQjeS4jeiDveS4uuepuicpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGxldCBzYW1lTmFtZVZhcmlhYmxlczogVmFyaWFibGVJdGVtW107XG4gICAgaWYgKHR5cGUgPT09ICdtZXNzYWdlJyAmJiBtZXNzYWdlX2lkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHNhbWVOYW1lVmFyaWFibGVzID0gdGhpcy5tb2RlbC5nZXRWYXJpYWJsZXNCeU1lc3NhZ2VJZChtZXNzYWdlX2lkKS5maWx0ZXIodiA9PiB2Lm5hbWUgPT09IG5ld1ZhcmlhYmxlLm5hbWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzYW1lTmFtZVZhcmlhYmxlcyA9IHRoaXMubW9kZWwuZ2V0VmFyaWFibGVzQnlOYW1lKG5ld1ZhcmlhYmxlLm5hbWUpO1xuICAgIH1cbiAgICBcbiAgICBjb25zdCBvdGhlclNhbWVOYW1lVmFyaWFibGVzID0gc2FtZU5hbWVWYXJpYWJsZXMuZmlsdGVyKHYgPT4gdi5pZCAhPT0gbmV3VmFyaWFibGUuaWQpO1xuICAgIGlmIChvdGhlclNhbWVOYW1lVmFyaWFibGVzLmxlbmd0aCA+IDApIHtcbiAgICAgIHRvYXN0ci5lcnJvcign5Y+Y6YeP5ZCN6YeN5aSNJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGlmIChuZXdWYXJpYWJsZS5pZCAmJiB0aGlzLm1vZGVsLmdldFZhcmlhYmxlQnlJZChuZXdWYXJpYWJsZS5pZCkpIHtcbiAgICAgICAgdGhpcy5tb2RlbC51cGRhdGVJbk1hcChuZXdWYXJpYWJsZS5pZCwgbmV3VmFyaWFibGUubmFtZSwgbmV3VmFyaWFibGUudmFsdWUsIG1lc3NhZ2VfaWQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgYWRkZWRWYXJpYWJsZSA9IHRoaXMubW9kZWwuYWRkVG9NYXAobmV3VmFyaWFibGUubmFtZSwgbmV3VmFyaWFibGUudmFsdWUsIG1lc3NhZ2VfaWQpO1xuICAgICAgICBuZXdWYXJpYWJsZS5pZCA9IGFkZGVkVmFyaWFibGUuaWQ7XG4gICAgICAgIGNhcmQuYXR0cignZGF0YS12YXJpYWJsZS1pZCcsIG5ld1ZhcmlhYmxlLmlkKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHR5cGUgPT09ICdtZXNzYWdlJyAmJiBtZXNzYWdlX2lkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5tb2RlbC5zYXZlQWxsVmFyaWFibGVzKHR5cGUsIG1lc3NhZ2VfaWQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXdhaXQgdGhpcy5tb2RlbC5zYXZlQWxsVmFyaWFibGVzKHR5cGUpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLnZpZXcuYWRkQW5pbWF0aW9uKGNhcmQsICd2YXJpYWJsZS1jaGFuZ2VkJywgKCkgPT4ge30pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2cuZXJyb3IoYFtWYXJpYWJsZU1hbmFnZXJdIOS/neWtmOWPmOmHj+Wksei0pTpgLCBlcnJvcik7XG4gICAgICB0b2FzdHIuZXJyb3IoYOS/neWtmOWPmOmHj+Wksei0pTogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICfmnKrnn6XplJnor68nfWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDlpITnkIbmuIXpmaTmiYDmnInlj5jph49cbiAgICovXG4gIHByaXZhdGUgYXN5bmMgaGFuZGxlQ2xlYXJBbGwoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgdHlwZSA9IHRoaXMubW9kZWwuZ2V0QWN0aXZlVmFyaWFibGVUeXBlKCk7XG5cbiAgICB0aGlzLnZpZXcuc2hvd0NvbmZpcm1EaWFsb2coXG4gICAgICBg56Gu5a6a6KaB5riF6Zmk5omA5pyJJHt0aGlzLmdldFZhcmlhYmxlVHlwZU5hbWUodHlwZSl95Y+Y6YeP5ZCX77yf5q2k5pON5L2c5LiN5Y+v5pKk6ZSA44CCYCxcbiAgICAgIGFzeW5jIGNvbmZpcm1lZCA9PiB7XG4gICAgICAgIGlmIChjb25maXJtZWQpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5tb2RlbC5jbGVhckFsbFZhcmlhYmxlcyh0eXBlKTtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHRoaXMudmlldy5jb250YWluZXIuZmluZChgIyR7dHlwZX0tY29udGVudCAudmFyaWFibGUtbGlzdGApO1xuICAgICAgICAgICAgY29udGFpbmVyLmVtcHR5KCk7XG4gICAgICAgICAgICBpZiAodHlwZSA9PSAnbWVzc2FnZScpIHtcbiAgICAgICAgICAgICAgY29uc3QgZmxvb3JDb250YWluZXIgPSB0aGlzLnZpZXcuY29udGFpbmVyLmZpbmQoYCMke3R5cGV9LWNvbnRlbnQgLmZsb29yLXZhcmlhYmxlcy1jb250YWluZXJgKTtcbiAgICAgICAgICAgICAgZmxvb3JDb250YWluZXIuZW1wdHkoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRvYXN0ci5zdWNjZXNzKGDlt7LmuIXpmaTmiYDmnIkke3RoaXMuZ2V0VmFyaWFibGVUeXBlTmFtZSh0eXBlKX3lj5jph49gKTtcbiAgICAgICAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICAgICAgICBsb2cuZXJyb3IoYFtWYXJpYWJsZU1hbmFnZXJdIOa4hemZpCR7dHlwZX3lj5jph4/lpLHotKU6YCwgZXJyb3IpO1xuICAgICAgICAgICAgdG9hc3RyLmVycm9yKGDmuIXpmaQke3RoaXMuZ2V0VmFyaWFibGVUeXBlTmFtZSh0eXBlKX3lj5jph4/ml7blh7rplJk6ICR7ZXJyb3IubWVzc2FnZSB8fCAn5pyq55+l6ZSZ6K+vJ31gKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlpITnkIbnrZvpgInlm77moIfngrnlh7tcbiAgICovXG4gIHByaXZhdGUgaGFuZGxlRmlsdGVySWNvbkNsaWNrKCk6IHZvaWQge1xuICAgIGNvbnN0ICRmaWx0ZXJPcHRpb25zID0gdGhpcy52aWV3LmNvbnRhaW5lci5maW5kKCcuZmlsdGVyLW9wdGlvbnMnKTtcbiAgICAkZmlsdGVyT3B0aW9ucy50b2dnbGUoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlpITnkIbnrZvpgInpgInpobnlj5jmm7RcbiAgICogQHBhcmFtIGV2ZW50IOWPmOabtOS6i+S7tlxuICAgKi9cbiAgcHJpdmF0ZSBoYW5kbGVGaWx0ZXJPcHRpb25DaGFuZ2UoZXZlbnQ6IEpRdWVyeS5DaGFuZ2VFdmVudCk6IHZvaWQge1xuICAgIGNvbnN0ICRjaGVja2JveCA9ICQoZXZlbnQuY3VycmVudFRhcmdldCk7XG4gICAgY29uc3QgdHlwZSA9ICRjaGVja2JveC5kYXRhKCd0eXBlJykgYXMgVmFyaWFibGVEYXRhVHlwZTtcbiAgICBjb25zdCBpc0NoZWNrZWQgPSAkY2hlY2tib3guaXMoJzpjaGVja2VkJyk7XG5cbiAgICB0aGlzLm1vZGVsLnVwZGF0ZUZpbHRlclN0YXRlKHR5cGUsIGlzQ2hlY2tlZCk7XG4gICAgdGhpcy5hcHBseUZpbHRlcnMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlpITnkIblj5jph4/mkJzntKJcbiAgICogQHBhcmFtIGV2ZW50IOi+k+WFpeS6i+S7tlxuICAgKi9cbiAgcHJpdmF0ZSBoYW5kbGVWYXJpYWJsZVNlYXJjaChldmVudDogSlF1ZXJ5LlRyaWdnZXJlZEV2ZW50KTogdm9pZCB7XG4gICAgY29uc3Qga2V5d29yZCA9ICQoZXZlbnQuY3VycmVudFRhcmdldCkudmFsKCkgYXMgc3RyaW5nO1xuICAgIHRoaXMubW9kZWwudXBkYXRlU2VhcmNoS2V5d29yZChrZXl3b3JkKTtcbiAgICB0aGlzLmFwcGx5RmlsdGVycygpO1xuICB9XG5cbiAgLyoqXG4gICAqIOW6lOeUqOetm+mAiVxuICAgKi9cbiAgcHJpdmF0ZSBhcHBseUZpbHRlcnMoKTogdm9pZCB7XG4gICAgY29uc3QgZmlsdGVyU3RhdGUgPSB0aGlzLm1vZGVsLmdldEZpbHRlclN0YXRlKCk7XG4gICAgY29uc3Qgc2VhcmNoS2V5d29yZCA9IHRoaXMubW9kZWwuZ2V0U2VhcmNoS2V5d29yZCgpO1xuXG4gICAgdGhpcy52aWV3LmFwcGx5Q2xpZW50U2lkZUZpbHRlcnMoZmlsdGVyU3RhdGUsIHNlYXJjaEtleXdvcmQpO1xuICB9XG5cbiAgLyoqXG4gICAqIOWkhOeQhualvOWxguiMg+WbtOetm+mAiVxuICAgKi9cbiAgcHJpdmF0ZSBoYW5kbGVGbG9vclJhbmdlRmlsdGVyKCk6IHZvaWQge1xuICAgIGNvbnN0ICRtaW5JbnB1dCA9IHRoaXMudmlldy5jb250YWluZXIuZmluZCgnI2Zsb29yLW1pbicpO1xuICAgIGNvbnN0ICRtYXhJbnB1dCA9IHRoaXMudmlldy5jb250YWluZXIuZmluZCgnI2Zsb29yLW1heCcpO1xuXG4gICAgY29uc3QgbWluVmFsID0gJG1pbklucHV0LnZhbCgpIGFzIHN0cmluZztcbiAgICBjb25zdCBtYXhWYWwgPSAkbWF4SW5wdXQudmFsKCkgYXMgc3RyaW5nO1xuXG4gICAgY29uc3QgbWluID0gbWluVmFsLnRyaW0oKSA/IHBhcnNlSW50KG1pblZhbCwgMTApIDogbnVsbDtcbiAgICBjb25zdCBtYXggPSBtYXhWYWwudHJpbSgpID8gcGFyc2VJbnQobWF4VmFsLCAxMCkgOiBudWxsO1xuXG4gICAgaWYgKChtaW5WYWwudHJpbSgpICYmIGlzTmFOKG1pbiEpKSB8fCAobWF4VmFsLnRyaW0oKSAmJiBpc05hTihtYXghKSkpIHtcbiAgICAgIHRoaXMudmlldy5zaG93Rmxvb3JGaWx0ZXJFcnJvcign6K+36L6T5YWl5pyJ5pWI55qE5pWw5a2XJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKG1pbiAhPT0gbnVsbCAmJiBtaW4gPCAwKSB7XG4gICAgICB0aGlzLnZpZXcuc2hvd0Zsb29yRmlsdGVyRXJyb3IoJ+acgOWwj+alvOWxguS4jeiDveWwj+S6jjAnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAobWF4ICE9PSBudWxsICYmIG1heCA8IDApIHtcbiAgICAgIHRoaXMudmlldy5zaG93Rmxvb3JGaWx0ZXJFcnJvcign5pyA5aSn5qW85bGC5LiN6IO95bCP5LqOMCcpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChtaW4gIT09IG51bGwgJiYgbWF4ICE9PSBudWxsICYmIG1pbiA+IG1heCkge1xuICAgICAgdGhpcy52aWV3LnNob3dGbG9vckZpbHRlckVycm9yKCfmnIDlsI/lgLzkuI3og73lpKfkuo7mnIDlpKflgLwnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAobWluID09PSBudWxsICYmIG1heCA9PT0gbnVsbCkge1xuICAgICAgdGhpcy52aWV3LnNob3dGbG9vckZpbHRlckVycm9yKCfor7foh7PlsJHorr7nva7mnIDlsI/mpbzlsYLmiJbmnIDlpKfmpbzlsYInKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLnZpZXcuaGlkZUZsb29yRmlsdGVyRXJyb3IoKTtcblxuICAgIGNvbnN0IGVmZmVjdGl2ZU1pbiA9IG1pbiA/PyAwO1xuICAgIGNvbnN0IGVmZmVjdGl2ZU1heCA9IG1heCA/PyA5OTk5O1xuXG4gICAgdGhpcy5hcHBseUZsb29yUmFuZ2VBbmRSZWxvYWQoZWZmZWN0aXZlTWluLCBlZmZlY3RpdmVNYXgpO1xuICB9XG5cbiAgLyoqXG4gICAqIOW6lOeUqOalvOWxguiMg+WbtOW5tumHjeaWsOWKoOi9veWPmOmHj1xuICAgKiBAcGFyYW0gbWluIOacgOWwj+alvOWxglxuICAgKiBAcGFyYW0gbWF4IOacgOWkp+alvOWxglxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBhcHBseUZsb29yUmFuZ2VBbmRSZWxvYWQobWluOiBudW1iZXIsIG1heDogbnVtYmVyKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIHRoaXMubW9kZWwudXBkYXRlRmxvb3JSYW5nZShtaW4sIG1heCk7XG4gICAgICB0aGlzLnZpZXcudXBkYXRlRmxvb3JSYW5nZUlucHV0cyhtaW4sIG1heCk7XG4gICAgICBhd2FpdCB0aGlzLmxvYWRWYXJpYWJsZXMoJ21lc3NhZ2UnKTtcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICBsb2cuZXJyb3IoYFtWYXJpYWJsZU1hbmFnZXJdIOW6lOeUqOalvOWxguiMg+WbtOW5tumHjeaWsOWKoOi9veWPmOmHj+Wksei0pTpgLCBlcnJvcik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOa4heeQhui1hOa6kFxuICAgKi9cbiAgcHVibGljIGNsZWFudXAoKTogdm9pZCB7XG4gICAgdHJ5IHtcbiAgICAgIHRoaXMuc3luY1NlcnZpY2UuY2xlYW51cCgpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2cuZXJyb3IoYFtWYXJpYWJsZU1hbmFnZXJdIOa4heeQhui1hOa6kOWksei0pTpgLCBlcnJvcik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWQjOatpeWvueixoeWNoeeJh+eahOinhuWbvuaVsOaNrlxuICAgKiBAcGFyYW0gY2FyZCDlj5jph4/ljaHniYdcbiAgICovXG4gIHByaXZhdGUgc3luY09iamVjdENhcmREYXRhKGNhcmQ6IEpRdWVyeTxIVE1MRWxlbWVudD4pOiB2b2lkIHtcbiAgICBjb25zdCBjdXJyZW50TW9kZSA9IGNhcmQuYXR0cignZGF0YS12aWV3LW1vZGUnKSB8fCAnY2FyZCc7XG5cbiAgICBpZiAoY3VycmVudE1vZGUgPT09ICdjYXJkJykge1xuICAgICAgY29uc3Qgb2JqZWN0VmFsdWUgPSB0aGlzLmNhcmRGYWN0b3J5LmdldFZhcmlhYmxlRnJvbUNhcmQoY2FyZCk7XG4gICAgICBjYXJkLmZpbmQoJy5qc29uLWlucHV0JykudmFsKEpTT04uc3RyaW5naWZ5KG9iamVjdFZhbHVlPy52YWx1ZSwgbnVsbCwgMikpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDlpITnkIbltYzlpZfljaHniYflj5jmm7Tkuovku7ZcbiAgICogQHBhcmFtIGV2ZW50IOS6i+S7tuWvueixoVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBoYW5kbGVOZXN0ZWRDYXJkQ2hhbmdlZChldmVudDogSlF1ZXJ5LlRyaWdnZXJlZEV2ZW50KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgY2FyZCA9ICQoZXZlbnQuY3VycmVudFRhcmdldCk7XG5cbiAgICBjb25zdCBzYXZlQnRuID0gY2FyZC5maW5kKCcudmFyaWFibGUtYWN0aW9uLWJ0bi5zYXZlLWJ0bicpO1xuICAgIGlmIChzYXZlQnRuLmxlbmd0aCA+IDApIHtcbiAgICAgIHNhdmVCdG4udHJpZ2dlcignY2xpY2snKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5Y+Y6YeP57G75Z6L55qE5Lit5paH5ZCN56ewXG4gICAqIEBwYXJhbSB0eXBlIOWPmOmHj+exu+Wei1xuICAgKiBAcmV0dXJucyDkuK3mloflkI3np7BcbiAgICovXG4gIHByaXZhdGUgZ2V0VmFyaWFibGVUeXBlTmFtZSh0eXBlOiBWYXJpYWJsZVR5cGUpOiBzdHJpbmcge1xuICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgY2FzZSAnZ2xvYmFsJzpcbiAgICAgICAgcmV0dXJuICflhajlsYAnO1xuICAgICAgY2FzZSAnY2hhcmFjdGVyJzpcbiAgICAgICAgcmV0dXJuICfop5LoibInO1xuICAgICAgY2FzZSAnY2hhdCc6XG4gICAgICAgIHJldHVybiAn6IGK5aSpJztcbiAgICAgIGNhc2UgJ21lc3NhZ2UnOlxuICAgICAgICByZXR1cm4gJ+a2iOaBryc7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gdHlwZTtcbiAgICB9XG4gIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/component/variable_manager/controller.ts\n")},"./src/component/variable_manager/index.ts":
/*!*************************************************!*\
  !*** ./src/component/variable_manager/index.ts ***!
  \*************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   initVariableManager: () => (/* binding */ initVariableManager),\n/* harmony export */   openVariableManager: () => (/* binding */ openVariableManager)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ "@sillytavern/scripts/extensions");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/utils */ "@sillytavern/scripts/utils");\n/* harmony import */ var _component_variable_manager_controller__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/component/variable_manager/controller */ "./src/component/variable_manager/controller.ts");\n/* harmony import */ var _component_variable_manager_model__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/component/variable_manager/model */ "./src/component/variable_manager/model.ts");\n/* harmony import */ var _component_variable_manager_sync__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/component/variable_manager/sync */ "./src/component/variable_manager/sync.ts");\n/* harmony import */ var _component_variable_manager_view__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/component/variable_manager/view */ "./src/component/variable_manager/view.ts");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/util/extension_variables */ "./src/util/extension_variables.ts");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! loglevel */ "./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_7__);\n\n\n\n\n\n\n\n\nconst templatePath = `${_util_extension_variables__WEBPACK_IMPORTED_MODULE_6__.extensionFolderPath}/src/component/variable_manager/public`;\nlet variableView = null;\nlet variableController = null;\nlet variableModel = null;\nlet syncService = null;\n/**\n * 初始化变量管理器\n */\nasync function openVariableManager() {\n    await (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_1__.loadFileToDocument)(`/scripts/extensions/${templatePath}/style.css`, \'css\');\n    const $variableManagerContainer = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_0__.renderExtensionTemplateAsync)(`${templatePath}`, \'index\'));\n    variableModel = new _component_variable_manager_model__WEBPACK_IMPORTED_MODULE_3__.VariableModel();\n    variableView = new _component_variable_manager_view__WEBPACK_IMPORTED_MODULE_5__.VariableView($variableManagerContainer);\n    syncService = new _component_variable_manager_sync__WEBPACK_IMPORTED_MODULE_4__.VariableSyncService(variableView, variableModel);\n    variableController = new _component_variable_manager_controller__WEBPACK_IMPORTED_MODULE_2__.VariableController(variableModel, variableView, syncService, variableView.cardFactory);\n    variableView.setController(variableController);\n    await variableController.init($variableManagerContainer);\n    if (variableView) {\n        variableView.render();\n    }\n    else {\n        loglevel__WEBPACK_IMPORTED_MODULE_7___default().error(\'[VariableManager] 变量管理器未初始化\');\n    }\n}\n/**\n * 添加变量管理快速按钮\n */\nfunction addVariableManagerQuickButton() {\n    const buttonHtml = $(`\n  <div id="tavern-helper-variable-container" class="list-group-item flex-container flexGap5 interactable">\n      <div class="fa-solid fa-square-root-variable extensionsMenuExtensionButton" /></div>\n      <span id="tavern-helper-variable-text">变量管理器</span>\n  </div>`);\n    buttonHtml.css(\'display\', \'flex\');\n    $(\'#extensionsMenu\').append(buttonHtml);\n    $(\'#tavern-helper-variable-container\').on(\'click\', async function () {\n        await openVariableManager();\n    });\n}\nfunction initVariableManager() {\n    addVariableManagerQuickButton();\n    const $button = $(\'#open-variable-manager\');\n    if ($button.length) {\n        $button.on(\'click\', async () => {\n            await openVariableManager();\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvaW5kZXgudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBK0U7QUFDZjtBQUVhO0FBQ1Y7QUFDSztBQUNQO0FBQ0E7QUFFdEM7QUFFM0IsTUFBTSxZQUFZLEdBQUcsR0FBRywwRUFBbUIsd0NBQXdDLENBQUM7QUFFcEYsSUFBSSxZQUFZLEdBQXdCLElBQUksQ0FBQztBQUM3QyxJQUFJLGtCQUFrQixHQUE4QixJQUFJLENBQUM7QUFDekQsSUFBSSxhQUFhLEdBQXlCLElBQUksQ0FBQztBQUMvQyxJQUFJLFdBQVcsR0FBK0IsSUFBSSxDQUFDO0FBRW5EOztHQUVHO0FBQ0ksS0FBSyxVQUFVLG1CQUFtQjtJQUN2QyxNQUFNLDhFQUFrQixDQUFDLHVCQUF1QixZQUFZLFlBQVksRUFBRSxLQUFLLENBQUMsQ0FBQztJQUVqRixNQUFNLHlCQUF5QixHQUFHLENBQUMsQ0FBQyxNQUFNLDZGQUE0QixDQUFDLEdBQUcsWUFBWSxFQUFFLEVBQUUsT0FBTyxDQUFDLENBQUMsQ0FBQztJQUVwRyxhQUFhLEdBQUcsSUFBSSw0RUFBYSxFQUFFLENBQUM7SUFDcEMsWUFBWSxHQUFHLElBQUksMEVBQVksQ0FBQyx5QkFBeUIsQ0FBQyxDQUFDO0lBRTNELFdBQVcsR0FBRyxJQUFJLGlGQUFtQixDQUFDLFlBQVksRUFBRSxhQUFhLENBQUMsQ0FBQztJQUVuRSxrQkFBa0IsR0FBRyxJQUFJLHNGQUFrQixDQUFDLGFBQWEsRUFBRSxZQUFZLEVBQUUsV0FBVyxFQUFFLFlBQVksQ0FBQyxXQUFXLENBQUMsQ0FBQztJQUVoSCxZQUFZLENBQUMsYUFBYSxDQUFDLGtCQUFrQixDQUFDLENBQUM7SUFFL0MsTUFBTSxrQkFBa0IsQ0FBQyxJQUFJLENBQUMseUJBQXlCLENBQUMsQ0FBQztJQUN6RCxJQUFJLFlBQVksRUFBRSxDQUFDO1FBQ2pCLFlBQVksQ0FBQyxNQUFNLEVBQUUsQ0FBQztJQUN4QixDQUFDO1NBQU0sQ0FBQztRQUNOLHFEQUFTLENBQUMsNkJBQTZCLENBQUMsQ0FBQztJQUMzQyxDQUFDO0FBQ0gsQ0FBQztBQUVEOztHQUVHO0FBQ0gsU0FBUyw2QkFBNkI7SUFDcEMsTUFBTSxVQUFVLEdBQUcsQ0FBQyxDQUFDOzs7O1NBSWQsQ0FBQyxDQUFDO0lBQ1QsVUFBVSxDQUFDLEdBQUcsQ0FBQyxTQUFTLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDbEMsQ0FBQyxDQUFDLGlCQUFpQixDQUFDLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBQ3hDLENBQUMsQ0FBQyxtQ0FBbUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUUsS0FBSztRQUN0RCxNQUFNLG1CQUFtQixFQUFFLENBQUM7SUFDOUIsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDO0FBRU0sU0FBUyxtQkFBbUI7SUFDakMsNkJBQTZCLEVBQUUsQ0FBQztJQUNoQyxNQUFNLE9BQU8sR0FBRyxDQUFDLENBQUMsd0JBQXdCLENBQUMsQ0FBQztJQUM1QyxJQUFJLE9BQU8sQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUNuQixPQUFPLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxLQUFLLElBQUksRUFBRTtZQUM3QixNQUFNLG1CQUFtQixFQUFFLENBQUM7UUFDOUIsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDO0FBQ0gsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9jb21wb25lbnQvdmFyaWFibGVfbWFuYWdlci9pbmRleC50cz8zNGNmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHJlbmRlckV4dGVuc2lvblRlbXBsYXRlQXN5bmMgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9leHRlbnNpb25zJztcbmltcG9ydCB7IGxvYWRGaWxlVG9Eb2N1bWVudCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3V0aWxzJztcblxuaW1wb3J0IHsgVmFyaWFibGVDb250cm9sbGVyIH0gZnJvbSAnQC9jb21wb25lbnQvdmFyaWFibGVfbWFuYWdlci9jb250cm9sbGVyJztcbmltcG9ydCB7IFZhcmlhYmxlTW9kZWwgfSBmcm9tICdAL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL21vZGVsJztcbmltcG9ydCB7IFZhcmlhYmxlU3luY1NlcnZpY2UgfSBmcm9tICdAL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL3N5bmMnO1xuaW1wb3J0IHsgVmFyaWFibGVWaWV3IH0gZnJvbSAnQC9jb21wb25lbnQvdmFyaWFibGVfbWFuYWdlci92aWV3JztcbmltcG9ydCB7IGV4dGVuc2lvbkZvbGRlclBhdGggfSBmcm9tICdAL3V0aWwvZXh0ZW5zaW9uX3ZhcmlhYmxlcyc7XG5cbmltcG9ydCBsb2cgZnJvbSAnbG9nbGV2ZWwnO1xuXG5jb25zdCB0ZW1wbGF0ZVBhdGggPSBgJHtleHRlbnNpb25Gb2xkZXJQYXRofS9zcmMvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvcHVibGljYDtcblxubGV0IHZhcmlhYmxlVmlldzogVmFyaWFibGVWaWV3IHwgbnVsbCA9IG51bGw7XG5sZXQgdmFyaWFibGVDb250cm9sbGVyOiBWYXJpYWJsZUNvbnRyb2xsZXIgfCBudWxsID0gbnVsbDtcbmxldCB2YXJpYWJsZU1vZGVsOiBWYXJpYWJsZU1vZGVsIHwgbnVsbCA9IG51bGw7XG5sZXQgc3luY1NlcnZpY2U6IFZhcmlhYmxlU3luY1NlcnZpY2UgfCBudWxsID0gbnVsbDtcblxuLyoqXG4gKiDliJ3lp4vljJblj5jph4/nrqHnkIblmahcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG9wZW5WYXJpYWJsZU1hbmFnZXIoKSB7XG4gIGF3YWl0IGxvYWRGaWxlVG9Eb2N1bWVudChgL3NjcmlwdHMvZXh0ZW5zaW9ucy8ke3RlbXBsYXRlUGF0aH0vc3R5bGUuY3NzYCwgJ2NzcycpO1xuXG4gIGNvbnN0ICR2YXJpYWJsZU1hbmFnZXJDb250YWluZXIgPSAkKGF3YWl0IHJlbmRlckV4dGVuc2lvblRlbXBsYXRlQXN5bmMoYCR7dGVtcGxhdGVQYXRofWAsICdpbmRleCcpKTtcblxuICB2YXJpYWJsZU1vZGVsID0gbmV3IFZhcmlhYmxlTW9kZWwoKTtcbiAgdmFyaWFibGVWaWV3ID0gbmV3IFZhcmlhYmxlVmlldygkdmFyaWFibGVNYW5hZ2VyQ29udGFpbmVyKTtcblxuICBzeW5jU2VydmljZSA9IG5ldyBWYXJpYWJsZVN5bmNTZXJ2aWNlKHZhcmlhYmxlVmlldywgdmFyaWFibGVNb2RlbCk7XG5cbiAgdmFyaWFibGVDb250cm9sbGVyID0gbmV3IFZhcmlhYmxlQ29udHJvbGxlcih2YXJpYWJsZU1vZGVsLCB2YXJpYWJsZVZpZXcsIHN5bmNTZXJ2aWNlLCB2YXJpYWJsZVZpZXcuY2FyZEZhY3RvcnkpO1xuXG4gIHZhcmlhYmxlVmlldy5zZXRDb250cm9sbGVyKHZhcmlhYmxlQ29udHJvbGxlcik7XG5cbiAgYXdhaXQgdmFyaWFibGVDb250cm9sbGVyLmluaXQoJHZhcmlhYmxlTWFuYWdlckNvbnRhaW5lcik7XG4gIGlmICh2YXJpYWJsZVZpZXcpIHtcbiAgICB2YXJpYWJsZVZpZXcucmVuZGVyKCk7XG4gIH0gZWxzZSB7XG4gICAgbG9nLmVycm9yKCdbVmFyaWFibGVNYW5hZ2VyXSDlj5jph4/nrqHnkIblmajmnKrliJ3lp4vljJYnKTtcbiAgfVxufVxuXG4vKipcbiAqIOa3u+WKoOWPmOmHj+euoeeQhuW/q+mAn+aMiemSrlxuICovXG5mdW5jdGlvbiBhZGRWYXJpYWJsZU1hbmFnZXJRdWlja0J1dHRvbigpIHtcbiAgY29uc3QgYnV0dG9uSHRtbCA9ICQoYFxuICA8ZGl2IGlkPVwidGF2ZXJuLWhlbHBlci12YXJpYWJsZS1jb250YWluZXJcIiBjbGFzcz1cImxpc3QtZ3JvdXAtaXRlbSBmbGV4LWNvbnRhaW5lciBmbGV4R2FwNSBpbnRlcmFjdGFibGVcIj5cbiAgICAgIDxkaXYgY2xhc3M9XCJmYS1zb2xpZCBmYS1zcXVhcmUtcm9vdC12YXJpYWJsZSBleHRlbnNpb25zTWVudUV4dGVuc2lvbkJ1dHRvblwiIC8+PC9kaXY+XG4gICAgICA8c3BhbiBpZD1cInRhdmVybi1oZWxwZXItdmFyaWFibGUtdGV4dFwiPuWPmOmHj+euoeeQhuWZqDwvc3Bhbj5cbiAgPC9kaXY+YCk7XG4gIGJ1dHRvbkh0bWwuY3NzKCdkaXNwbGF5JywgJ2ZsZXgnKTtcbiAgJCgnI2V4dGVuc2lvbnNNZW51JykuYXBwZW5kKGJ1dHRvbkh0bWwpO1xuICAkKCcjdGF2ZXJuLWhlbHBlci12YXJpYWJsZS1jb250YWluZXInKS5vbignY2xpY2snLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgYXdhaXQgb3BlblZhcmlhYmxlTWFuYWdlcigpO1xuICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGluaXRWYXJpYWJsZU1hbmFnZXIoKSB7XG4gIGFkZFZhcmlhYmxlTWFuYWdlclF1aWNrQnV0dG9uKCk7XG4gIGNvbnN0ICRidXR0b24gPSAkKCcjb3Blbi12YXJpYWJsZS1tYW5hZ2VyJyk7XG4gIGlmICgkYnV0dG9uLmxlbmd0aCkge1xuICAgICRidXR0b24ub24oJ2NsaWNrJywgYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgb3BlblZhcmlhYmxlTWFuYWdlcigpO1xuICAgIH0pO1xuICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/component/variable_manager/index.ts\n')},"./src/component/variable_manager/model.ts":
/*!*************************************************!*\
  !*** ./src/component/variable_manager/model.ts ***!
  \*************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VariableModel: () => (/* binding */ VariableModel)\n/* harmony export */ });\n/* harmony import */ var _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/variable_manager/util */ \"./src/component/variable_manager/util.ts\");\n/* harmony import */ var _function_variables__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/function/variables */ \"./src/function/variables.ts\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_3__);\n\n\n\n\nclass VariableModel {\n    currentVariables = null;\n    variableIdMap = new Map();\n    activeVariableType = 'global';\n    filterState = {\n        string: true,\n        array: true,\n        boolean: true,\n        number: true,\n        object: true,\n    };\n    searchKeyword = '';\n    floorMinRange = null;\n    floorMaxRange = null;\n    constructor() { }\n    /**\n     * 为变量创建唯一ID并建立映射关系\n     * @param name 变量名称\n     * @param value 变量值\n     * @param message_id 消息ID（可选，仅用于message类型变量）\n     * @returns 生成的唯一ID\n     */\n    createVariableItem(name, value, message_id) {\n        const id = (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_2__.uuidv4)();\n        const variable_item = {\n            name,\n            value,\n            dataType: _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_0__.VariableManagerUtil.inferDataType(value),\n            id,\n            ...(message_id !== undefined && { message_id }),\n        };\n        this.variableIdMap.set(id, variable_item);\n        return variable_item;\n    }\n    // ========== 前端和Map之间的存取 ==========\n    /**\n     * 获取当前map中的所有变量 (前端 ← map)\n     */\n    getCurrentMapVariables() {\n        return this.currentVariables ? [...this.currentVariables] : [];\n    }\n    /**\n     * 向map中添加变量 (前端 → map)\n     */\n    addToMap(name, value, message_id) {\n        const variable = this.createVariableItem(name, value, message_id);\n        if (!this.currentVariables) {\n            this.currentVariables = [];\n        }\n        this.currentVariables.push(variable);\n        return variable;\n    }\n    /**\n     * 从map中移除变量 (前端 → map)\n     */\n    removeFromMap(id) {\n        if (!this.currentVariables)\n            return false;\n        const index = this.currentVariables.findIndex(v => v.id === id);\n        if (index >= 0) {\n            this.currentVariables.splice(index, 1);\n            this.variableIdMap.delete(id);\n            return true;\n        }\n        return false;\n    }\n    /**\n     * 在map中更新变量 (前端 → map)\n     */\n    updateInMap(id, newName, newValue, newMessageId) {\n        if (!this.currentVariables)\n            return false;\n        const variable = this.currentVariables.find(v => v.id === id);\n        if (variable) {\n            variable.name = newName;\n            variable.value = newValue;\n            variable.dataType = _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_0__.VariableManagerUtil.inferDataType(newValue);\n            if (newMessageId !== undefined) {\n                variable.message_id = newMessageId;\n            }\n            this.variableIdMap.set(id, variable);\n            return true;\n        }\n        return false;\n    }\n    /**\n     * 清除所有变量ID映射\n     */\n    clearVariableIdMap() {\n        this.variableIdMap.clear();\n    }\n    /**\n     * 通过ID获取变量信息\n     * @param id 变量ID\n     * @returns 变量信息对象 {name, value} 或 undefined\n     */\n    getVariableById(id) {\n        return this.variableIdMap.get(id);\n    }\n    // ========== 酒馆和Map之间的存取 ==========\n    /**\n     * 将酒馆变量转换为VariableItem数组\n     * @param tavernVariables 从酒馆获取的原始变量数据\n     * @param message_id 消息ID（可选，仅用于message类型变量）\n     * @returns 转换后的VariableItem数组\n     * @description 自动推断每个变量的数据类型并分配唯一ID\n     */\n    convertTavernVariablesToItems(tavernVariables, message_id) {\n        return Object.entries(tavernVariables).map(([name, value]) => {\n            return this.createVariableItem(name, value, message_id);\n        });\n    }\n    /**\n     * 将VariableItem数组转换为TavernVariables对象\n     * @param variables VariableItem数组\n     * @param message_id 可选的message_id筛选条件\n     * @returns TavernVariables对象\n     */\n    convertItemsToTavernVariables(variables, message_id) {\n        const result = {};\n        for (const variable of variables) {\n            // 如果指定了message_id，只转换匹配的变量\n            if (message_id !== undefined) {\n                if (variable.message_id === message_id) {\n                    result[variable.name] = variable.value;\n                }\n            }\n            else {\n                // 如果没有指定message_id，转换所有变量\n                result[variable.name] = variable.value;\n            }\n        }\n        return result;\n    }\n    /**\n     * 加载指定类型的变量\n     * @param type 变量类型(global/character/chat/message)\n     * @returns 加载的变量数据\n     */\n    async loadFromTavern(type) {\n        this.clearVariableIdMap();\n        try {\n            this.activeVariableType = type;\n            if (type === 'message') {\n                this.currentVariables = [];\n                // 获取当前楼层范围\n                const [minFloor, maxFloor] = this.getFloorRange();\n                // 确保至少有一个有效的楼层范围\n                if (minFloor !== null || maxFloor !== null) {\n                    const effectiveMinFloor = minFloor ?? 0;\n                    const effectiveMaxFloor = maxFloor ?? minFloor ?? 0;\n                    // 遍历每个楼层，加载各自的变量\n                    for (let floor = effectiveMinFloor; floor <= effectiveMaxFloor; floor++) {\n                        try {\n                            const floorVars = this.getFloorVariables(floor);\n                            // 为每个楼层的变量添加message_id标识\n                            const floorVariableItems = this.convertTavernVariablesToItems(floorVars, floor);\n                            this.currentVariables.push(...floorVariableItems);\n                        }\n                        catch (error) {\n                            loglevel__WEBPACK_IMPORTED_MODULE_3___default().warn(`[VariableModel] 加载第${floor}层变量失败:`, error);\n                            // 继续加载其他楼层\n                        }\n                    }\n                }\n            }\n            else {\n                const variables = (0,_function_variables__WEBPACK_IMPORTED_MODULE_1__.getVariables)({ type });\n                this.currentVariables = this.convertTavernVariablesToItems(variables);\n            }\n            return this.currentVariables;\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_3___default().error(`[VariableManager] 加载${type}变量失败:`, error);\n            return [];\n        }\n    }\n    /**\n     * 保存所有变量到酒馆\n     * @param type 变量类型(global/character/chat/message)\n     * @param message_id 消息ID(仅用于message类型，可选，如果指定则只保存到该楼层)\n     */\n    async saveAllVariables(type, message_id) {\n        if (!this.currentVariables) {\n            loglevel__WEBPACK_IMPORTED_MODULE_3___default().warn('[VariableModel] 当前没有变量数据，跳过保存');\n            return;\n        }\n        if (type === 'message') {\n            const [minFloor, maxFloor] = this.getFloorRange();\n            if (minFloor === null || maxFloor === null) {\n                loglevel__WEBPACK_IMPORTED_MODULE_3___default().warn('[VariableModel] 保存message变量失败: 未设置有效的楼层范围');\n                return;\n            }\n            // 如果指定了特定的message_id，只保存到该楼层\n            if (message_id !== undefined && message_id >= minFloor && message_id <= maxFloor) {\n                const variablesForFloor = this.currentVariables.filter(v => v.message_id === message_id);\n                const tavernVariables = this.convertItemsToTavernVariables(variablesForFloor, message_id);\n                try {\n                    await (0,_function_variables__WEBPACK_IMPORTED_MODULE_1__.replaceVariables)(tavernVariables, { type: 'message', message_id });\n                    loglevel__WEBPACK_IMPORTED_MODULE_3___default().info(`[VariableManager] 成功保存第${message_id}层变量`);\n                }\n                catch (error) {\n                    loglevel__WEBPACK_IMPORTED_MODULE_3___default().error(`[VariableManager] 保存第${message_id}层变量失败:`, error);\n                }\n            }\n            else {\n                // 对于消息类型，按楼层分组保存变量\n                for (let floor = minFloor; floor <= maxFloor; floor++) {\n                    const variablesForFloor = this.currentVariables.filter(v => v.message_id === floor);\n                    const tavernVariables = this.convertItemsToTavernVariables(variablesForFloor, floor);\n                    try {\n                        await (0,_function_variables__WEBPACK_IMPORTED_MODULE_1__.replaceVariables)(tavernVariables, { type: 'message', message_id: floor });\n                    }\n                    catch (error) {\n                        loglevel__WEBPACK_IMPORTED_MODULE_3___default().error(`[VariableManager] 保存第${floor}层变量失败:`, error);\n                    }\n                }\n            }\n        }\n        else {\n            // 对于其他类型（global/character/chat），构建变量对象\n            const tavernVariables = this.convertItemsToTavernVariables(this.currentVariables);\n            await (0,_function_variables__WEBPACK_IMPORTED_MODULE_1__.replaceVariables)(tavernVariables, { type });\n        }\n        loglevel__WEBPACK_IMPORTED_MODULE_3___default().info(`[VariableManager] 保存变量成功`);\n    }\n    /**\n     * 获取当前活动的变量类型\n     * @returns 变量类型\n     */\n    getActiveVariableType() {\n        return this.activeVariableType;\n    }\n    /**\n     * 更新列表变量的顺序\n     * @param type 变量类型(global/character/chat/message)\n     * @param name 变量名称\n     * @param items 新的列表顺序\n     * @param variable_id 变量ID(可选，如果提供则同时更新ID映射)\n     */\n    async updateListOrder(type, name, items, variable_id) {\n        if (type === this.activeVariableType && this.currentVariables) {\n            const variable = this.currentVariables.find(variable => variable.name === name);\n            if (variable && Array.isArray(variable.value)) {\n                variable.value = items;\n                // 如果提供了变量ID，更新映射\n                if (variable_id) {\n                    const varInfo = this.variableIdMap.get(variable_id);\n                    if (varInfo) {\n                        varInfo.value = items;\n                        // 保持变量的message_id不变\n                        this.variableIdMap.set(variable_id, varInfo);\n                    }\n                }\n                // 使用完全覆盖模式保存\n                await this.saveAllVariables(type, variable.message_id);\n            }\n        }\n    }\n    /**\n     * 清除所有变量\n     * @param type 变量类型(global/character/chat/message)\n     */\n    async clearAllVariables(type) {\n        if (type === this.activeVariableType) {\n            this.currentVariables = [];\n            this.clearVariableIdMap();\n        }\n        // 消息类型变量需要逐层清除\n        if (type === 'message') {\n            const [minFloor, maxFloor] = this.getFloorRange();\n            if (minFloor === null || maxFloor === null) {\n                loglevel__WEBPACK_IMPORTED_MODULE_3___default().warn('[VariableModel] 清除message变量失败: 未设置有效的楼层范围');\n                return;\n            }\n            // 逐层清除变量\n            for (let floor = minFloor; floor <= maxFloor; floor++) {\n                try {\n                    const emptyVariables = {};\n                    await (0,_function_variables__WEBPACK_IMPORTED_MODULE_1__.replaceVariables)(emptyVariables, { type: 'message', message_id: floor });\n                }\n                catch (error) {\n                    loglevel__WEBPACK_IMPORTED_MODULE_3___default().error(`[VariableModel] 清除第${floor}层变量失败:`, error);\n                }\n            }\n        }\n        else {\n            // 其他类型变量直接替换为空对象\n            const emptyVariables = {};\n            await (0,_function_variables__WEBPACK_IMPORTED_MODULE_1__.replaceVariables)(emptyVariables, { type });\n        }\n    }\n    /**\n     * 更新筛选状态\n     * @param type 数据类型\n     * @param checked 是否选中\n     */\n    updateFilterState(type, checked) {\n        this.filterState[type] = checked;\n    }\n    /**\n     * 获取筛选状态\n     * @returns 筛选状态\n     */\n    getFilterState() {\n        return this.filterState;\n    }\n    /**\n     * 更新搜索关键词\n     * @param keyword 关键词\n     */\n    updateSearchKeyword(keyword) {\n        this.searchKeyword = keyword;\n    }\n    /**\n     * 获取搜索关键词\n     * @returns 搜索关键词\n     */\n    getSearchKeyword() {\n        return this.searchKeyword;\n    }\n    /**\n     * 更新楼层范围筛选\n     * @param min 最小楼层\n     * @param max 最大楼层\n     */\n    updateFloorRange(min, max) {\n        // 验证楼层不能小于0\n        if (min !== null) {\n            min = Math.max(0, min);\n        }\n        if (max !== null) {\n            max = Math.max(0, max);\n        }\n        // 如果设置了范围但是最小值大于最大值，则交换它们\n        if (min !== null && max !== null && min > max) {\n            [min, max] = [max, min];\n        }\n        this.floorMinRange = min;\n        this.floorMaxRange = max;\n        // 清除缓存，强制重新加载\n        if (this.activeVariableType === 'message') {\n            this.currentVariables = null;\n        }\n    }\n    /**\n     * 获取当前楼层范围筛选\n     * @returns 当前楼层范围 [min, max]\n     */\n    getFloorRange() {\n        return [this.floorMinRange, this.floorMaxRange];\n    }\n    /**\n     * 获取特定楼层的变量数据\n     * @param messageId 消息ID\n     * @returns 楼层变量数据对象\n     */\n    getFloorVariables(messageId) {\n        try {\n            const variables = (0,_function_variables__WEBPACK_IMPORTED_MODULE_1__.getVariables)({ type: 'message', message_id: messageId });\n            return variables || {};\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_3___default().error(`获取第${messageId}层变量失败:`, error);\n            return {};\n        }\n    }\n    /**\n     * 查找变量对应的 ID\n     * @param name 变量名称\n     * @param message_id 消息ID（可选，用于精确匹配message类型变量）\n     * @returns 找到的变量ID，如果不存在则返回undefined\n     */\n    findVariableId(name, message_id) {\n        for (const id of this.variableIdMap.keys()) {\n            const varInfo = this.variableIdMap.get(id);\n            if (varInfo && varInfo.name === name) {\n                // 如果指定了message_id，需要精确匹配\n                if (message_id !== undefined) {\n                    if (varInfo.message_id === message_id) {\n                        return id;\n                    }\n                }\n                else {\n                    // 如果没有指定message_id，返回第一个匹配的变量\n                    return id;\n                }\n            }\n        }\n        return undefined;\n    }\n    /**\n     * 获取指定楼层的变量列表\n     * @param message_id 消息ID\n     * @returns 属于该楼层的变量列表\n     */\n    getVariablesByMessageId(message_id) {\n        if (!this.currentVariables)\n            return [];\n        return this.currentVariables.filter(variable => variable.message_id === message_id);\n    }\n    /**\n     * 获取所有没有message_id的变量（通常是非message类型的变量）\n     * @returns 没有message_id的变量列表\n     */\n    getVariablesWithoutMessageId() {\n        if (!this.currentVariables)\n            return [];\n        return this.currentVariables.filter(variable => variable.message_id === undefined);\n    }\n    /**\n     * 根据变量名获取所有同名变量\n     * @param name 变量名称\n     * @returns 同名变量列表\n     */\n    getVariablesByName(name) {\n        if (!this.currentVariables)\n            return [];\n        return this.currentVariables.filter(variable => variable.name === name);\n    }\n    /**\n     * 通过变量名查找变量\n     * @param name 变量名称\n     * @param message_id 消息ID（可选，用于精确匹配message类型变量）\n     * @returns 找到的变量，如果不存在则返回undefined\n     */\n    findVariableByName(name, message_id) {\n        if (!this.currentVariables)\n            return undefined;\n        for (const variable of this.currentVariables) {\n            if (variable.name === name) {\n                if (message_id !== undefined) {\n                    if (variable.message_id === message_id) {\n                        return variable;\n                    }\n                }\n                else {\n                    return variable;\n                }\n            }\n        }\n        return undefined;\n    }\n    /**\n     * 同步当前变量列表，根据外部变化进行增量更新\n     * @param added 新增的变量\n     * @param removedIds 要删除的变量ID列表\n     * @param updated 要更新的变量\n     */\n    syncCurrentVariables(added, removedIds, updated) {\n        if (!this.currentVariables) {\n            this.currentVariables = [];\n        }\n        // 处理删除\n        removedIds.forEach(id => {\n            const index = this.currentVariables.findIndex(v => v.id === id);\n            if (index >= 0) {\n                this.currentVariables.splice(index, 1);\n                this.variableIdMap.delete(id);\n            }\n        });\n        // 处理新增\n        added.forEach(variable => {\n            this.currentVariables.push(variable);\n            this.variableIdMap.set(variable.id, variable);\n        });\n        // 处理更新\n        updated.forEach(updatedVariable => {\n            const index = this.currentVariables.findIndex(v => v.id === updatedVariable.id);\n            if (index >= 0) {\n                this.currentVariables[index] = updatedVariable;\n                this.variableIdMap.set(updatedVariable.id, updatedVariable);\n            }\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvbW9kZWwudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQ3dFO0FBQ0Y7QUFDbEI7QUFFekI7QUFFcEIsTUFBTSxhQUFhO0lBQ2hCLGdCQUFnQixHQUEwQixJQUFJLENBQUM7SUFDL0MsYUFBYSxHQUE4QixJQUFJLEdBQUcsRUFBRSxDQUFDO0lBRXJELGtCQUFrQixHQUFpQixRQUFRLENBQUM7SUFFNUMsV0FBVyxHQUFzQztRQUN2RCxNQUFNLEVBQUUsSUFBSTtRQUNaLEtBQUssRUFBRSxJQUFJO1FBQ1gsT0FBTyxFQUFFLElBQUk7UUFDYixNQUFNLEVBQUUsSUFBSTtRQUNaLE1BQU0sRUFBRSxJQUFJO0tBQ2IsQ0FBQztJQUVNLGFBQWEsR0FBVyxFQUFFLENBQUM7SUFFM0IsYUFBYSxHQUFrQixJQUFJLENBQUM7SUFDcEMsYUFBYSxHQUFrQixJQUFJLENBQUM7SUFFNUMsZ0JBQWUsQ0FBQztJQUVoQjs7Ozs7O09BTUc7SUFDSSxrQkFBa0IsQ0FBQyxJQUFZLEVBQUUsS0FBVSxFQUFFLFVBQW1CO1FBQ3JFLE1BQU0sRUFBRSxHQUFHLGtFQUFNLEVBQUUsQ0FBQztRQUNwQixNQUFNLGFBQWEsR0FBaUI7WUFDbEMsSUFBSTtZQUNKLEtBQUs7WUFDTCxRQUFRLEVBQUUsaUZBQW1CLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQztZQUNsRCxFQUFFO1lBQ0YsR0FBRyxDQUFDLFVBQVUsS0FBSyxTQUFTLElBQUksRUFBRSxVQUFVLEVBQUUsQ0FBQztTQUNoRCxDQUFDO1FBQ0YsSUFBSSxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsRUFBRSxFQUFFLGFBQWEsQ0FBQyxDQUFDO1FBQzFDLE9BQU8sYUFBYSxDQUFDO0lBQ3ZCLENBQUM7SUFFRCxvQ0FBb0M7SUFFcEM7O09BRUc7SUFDSSxzQkFBc0I7UUFDM0IsT0FBTyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsZ0JB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Q0FBQyxFQUFFLENBQUM7Z0JBQ2YsSUFBSSxDQUFDLGdCQUFpQixDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUM7Z0JBQ3hDLElBQUksQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1lBQ2hDLENBQUM7UUFDSCxDQUFDLENBQUMsQ0FBQztRQUVILE9BQU87UUFDUCxLQUFLLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxFQUFFO1lBQ3ZCLElBQUksQ0FBQyxnQkFBaUIsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDdEMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLEVBQUUsRUFBRSxRQUFRLENBQUMsQ0FBQztRQUNoRCxDQUFDLENBQUMsQ0FBQztRQUVILE9BQU87UUFDUCxPQUFPLENBQUMsT0FBTyxDQUFDLGVBQWUsQ0FBQyxFQUFFO1lBQ2hDLE1BQU0sS0FBSyxHQUFHLElBQUksQ0FBQyxnQkFBaUIsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxLQUFLLGVBQWUsQ0FBQyxFQUFFLENBQUMsQ0FBQztZQUNqRixJQUFJLEtBQUssSUFBSSxDQUFDLEVBQUUsQ0FBQztnQkFDZixJQUFJLENBQUMsZ0JBQWlCLENBQUMsS0FBSyxDQUFDLEdBQUcsZUFBZSxDQUFDO2dCQUNoRCxJQUFJLENBQUMsYUFBYSxDQUFDLEdBQUcsQ0FBQyxlQUFlLENBQUMsRUFBRSxFQUFFLGVBQWUsQ0FBQyxDQUFDO1lBQzlELENBQUM7UUFDSCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7Q0FDRiIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9jb21wb25lbnQvdmFyaWFibGVfbWFuYWdlci9tb2RlbC50cz9iOTYzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFRhdmVyblZhcmlhYmxlcywgVmFyaWFibGVEYXRhVHlwZSwgVmFyaWFibGVJdGVtLCBWYXJpYWJsZVR5cGUgfSBmcm9tICdAL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL3R5cGVzJztcbmltcG9ydCB7IFZhcmlhYmxlTWFuYWdlclV0aWwgfSBmcm9tICdAL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL3V0aWwnO1xuaW1wb3J0IHsgZ2V0VmFyaWFibGVzLCByZXBsYWNlVmFyaWFibGVzIH0gZnJvbSAnQC9mdW5jdGlvbi92YXJpYWJsZXMnO1xuaW1wb3J0IHsgdXVpZHY0IH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvdXRpbHMnO1xuXG5pbXBvcnQgbG9nIGZyb20gJ2xvZ2xldmVsJztcblxuZXhwb3J0IGNsYXNzIFZhcmlhYmxlTW9kZWwge1xuICBwcml2YXRlIGN1cnJlbnRWYXJpYWJsZXM6IFZhcmlhYmxlSXRlbVtdIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgdmFyaWFibGVJZE1hcDogTWFwPHN0cmluZywgVmFyaWFibGVJdGVtPiA9IG5ldyBNYXAoKTtcblxuICBwcml2YXRlIGFjdGl2ZVZhcmlhYmxlVHlwZTogVmFyaWFibGVUeXBlID0gJ2dsb2JhbCc7XG5cbiAgcHJpdmF0ZSBmaWx0ZXJTdGF0ZTogUmVjb3JkPFZhcmlhYmxlRGF0YVR5cGUsIGJvb2xlYW4+ID0ge1xuICAgIHN0cmluZzogdHJ1ZSxcbiAgICBhcnJheTogdHJ1ZSxcbiAgICBib29sZWFuOiB0cnVlLFxuICAgIG51bWJlcjogdHJ1ZSxcbiAgICBvYmplY3Q6IHRydWUsXG4gIH07XG5cbiAgcHJpdmF0ZSBzZWFyY2hLZXl3b3JkOiBzdHJpbmcgPSAnJztcblxuICBwcml2YXRlIGZsb29yTWluUmFuZ2U6IG51bWJlciB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIGZsb29yTWF4UmFuZ2U6IG51bWJlciB8IG51bGwgPSBudWxsO1xuXG4gIGNvbnN0cnVjdG9yKCkge31cblxuICAvKipcbiAgICog5Li65Y+Y6YeP5Yib5bu65ZSv5LiASUTlubblu7rnq4vmmKDlsITlhbPns7tcbiAgICogQHBhcmFtIG5hbWUg5Y+Y6YeP5ZCN56ewXG4gICAqIEBwYXJhbSB2YWx1ZSDlj5jph4/lgLxcbiAgICogQHBhcmFtIG1lc3NhZ2VfaWQg5raI5oGvSUTvvIjlj6/pgInvvIzku4XnlKjkuo5tZXNzYWdl57G75Z6L5Y+Y6YeP77yJXG4gICAqIEByZXR1cm5zIOeUn+aIkOeahOWUr+S4gElEXG4gICAqL1xuICBwdWJsaWMgY3JlYXRlVmFyaWFibGVJdGVtKG5hbWU6IHN0cmluZywgdmFsdWU6IGFueSwgbWVzc2FnZV9pZD86IG51bWJlcik6IFZhcmlhYmxlSXRlbSB7XG4gICAgY29uc3QgaWQgPSB1dWlkdjQoKTtcbiAgICBjb25zdCB2YXJpYWJsZV9pdGVtOiBWYXJpYWJsZUl0ZW0gPSB7XG4gICAgICBuYW1lLFxuICAgICAgdmFsdWUsXG4gICAgICBkYXRhVHlwZTogVmFyaWFibGVNYW5hZ2VyVXRpbC5pbmZlckRhdGFUeXBlKHZhbHVlKSxcbiAgICAgIGlkLFxuICAgICAgLi4uKG1lc3NhZ2VfaWQgIT09IHVuZGVmaW5lZCAmJiB7IG1lc3NhZ2VfaWQgfSksXG4gICAgfTtcbiAgICB0aGlzLnZhcmlhYmxlSWRNYXAuc2V0KGlkLCB2YXJpYWJsZV9pdGVtKTtcbiAgICByZXR1cm4gdmFyaWFibGVfaXRlbTtcbiAgfVxuXG4gIC8vID09PT09PT09PT0g5YmN56uv5ZKMTWFw5LmL6Ze055qE5a2Y5Y+WID09PT09PT09PT1cblxuICAvKipcbiAgICog6I635Y+W5b2T5YmNbWFw5Lit55qE5omA5pyJ5Y+Y6YePICjliY3nq68g4oaQIG1hcClcbiAgICovXG4gIHB1YmxpYyBnZXRDdXJyZW50TWFwVmFyaWFibGVzKCk6IFZhcmlhYmxlSXRlbVtdIHtcbiAgICByZXR1cm4gdGhpcy5jdXJyZW50VmFyaWFibGVzID8gWy4uLnRoaXMuY3VycmVudFZhcmlhYmxlc10gOiBbXTtcbiAgfVxuXG4gIC8qKlxuICAgKiDlkJFtYXDkuK3mt7vliqDlj5jph48gKOWJjeerryDihpIgbWFwKVxuICAgKi9cbiAgcHVibGljIGFkZFRvTWFwKG5hbWU6IHN0cmluZywgdmFsdWU6IGFueSwgbWVzc2FnZV9pZD86IG51bWJlcik6IFZhcmlhYmxlSXRlbSB7XG4gICAgY29uc3QgdmFyaWFibGUgPSB0aGlzLmNyZWF0ZVZhcmlhYmxlSXRlbShuYW1lLCB2YWx1ZSwgbWVzc2FnZV9pZCk7XG4gICAgaWYgKCF0aGlzLmN1cnJlbnRWYXJpYWJsZXMpIHtcbiAgICAgIHRoaXMuY3VycmVudFZhcmlhYmxlcyA9IFtdO1xuICAgIH1cbiAgICB0aGlzLmN1cnJlbnRWYXJpYWJsZXMucHVzaCh2YXJpYWJsZSk7XG4gICAgcmV0dXJuIHZhcmlhYmxlO1xuICB9XG5cbiAgLyoqXG4gICAqIOS7jm1hcOS4reenu+mZpOWPmOmHjyAo5YmN56uvIOKGkiBtYXApXG4gICAqL1xuICBwdWJsaWMgcmVtb3ZlRnJvbU1hcChpZDogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgaWYgKCF0aGlzLmN1cnJlbnRWYXJpYWJsZXMpIHJldHVybiBmYWxzZTtcbiAgICBjb25zdCBpbmRleCA9IHRoaXMuY3VycmVudFZhcmlhYmxlcy5maW5kSW5kZXgodiA9PiB2LmlkID09PSBpZCk7XG4gICAgaWYgKGluZGV4ID49IDApIHtcbiAgICAgIHRoaXMuY3VycmVudFZhcmlhYmxlcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgdGhpcy52YXJpYWJsZUlkTWFwLmRlbGV0ZShpZCk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgLyoqXG4gICAqIOWcqG1hcOS4reabtOaWsOWPmOmHjyAo5YmN56uvIOKGkiBtYXApXG4gICAqL1xuICBwdWJsaWMgdXBkYXRlSW5NYXAoaWQ6IHN0cmluZywgbmV3TmFtZTogc3RyaW5nLCBuZXdWYWx1ZTogYW55LCBuZXdNZXNzYWdlSWQ/OiBudW1iZXIpOiBib29sZWFuIHtcbiAgICBpZiAoIXRoaXMuY3VycmVudFZhcmlhYmxlcykgcmV0dXJuIGZhbHNlO1xuICAgIGNvbnN0IHZhcmlhYmxlID0gdGhpcy5jdXJyZW50VmFyaWFibGVzLmZpbmQodiA9PiB2LmlkID09PSBpZCk7XG4gICAgaWYgKHZhcmlhYmxlKSB7XG4gICAgICB2YXJpYWJsZS5uYW1lID0gbmV3TmFtZTtcbiAgICAgIHZhcmlhYmxlLnZhbHVlID0gbmV3VmFsdWU7XG4gICAgICB2YXJpYWJsZS5kYXRhVHlwZSA9IFZhcmlhYmxlTWFuYWdlclV0aWwuaW5mZXJEYXRhVHlwZShuZXdWYWx1ZSk7XG4gICAgICBpZiAobmV3TWVzc2FnZUlkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdmFyaWFibGUubWVzc2FnZV9pZCA9IG5ld01lc3NhZ2VJZDtcbiAgICAgIH1cbiAgICAgIHRoaXMudmFyaWFibGVJZE1hcC5zZXQoaWQsIHZhcmlhYmxlKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvKipcbiAgICog5riF6Zmk5omA5pyJ5Y+Y6YePSUTmmKDlsIRcbiAgICovXG4gIHB1YmxpYyBjbGVhclZhcmlhYmxlSWRNYXAoKTogdm9pZCB7XG4gICAgdGhpcy52YXJpYWJsZUlkTWFwLmNsZWFyKCk7XG4gIH1cblxuICAvKipcbiAgICog6YCa6L+HSUTojrflj5blj5jph4/kv6Hmga9cbiAgICogQHBhcmFtIGlkIOWPmOmHj0lEXG4gICAqIEByZXR1cm5zIOWPmOmHj+S/oeaBr+WvueixoSB7bmFtZSwgdmFsdWV9IOaIliB1bmRlZmluZWRcbiAgICovXG4gIHB1YmxpYyBnZXRWYXJpYWJsZUJ5SWQoaWQ6IHN0cmluZyk6IFZhcmlhYmxlSXRlbSB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMudmFyaWFibGVJZE1hcC5nZXQoaWQpO1xuICB9XG5cbiAgLy8gPT09PT09PT09PSDphZLppoblkoxNYXDkuYvpl7TnmoTlrZjlj5YgPT09PT09PT09PVxuXG4gIC8qKlxuICAgKiDlsIbphZLppoblj5jph4/ovazmjaLkuLpWYXJpYWJsZUl0ZW3mlbDnu4RcbiAgICogQHBhcmFtIHRhdmVyblZhcmlhYmxlcyDku47phZLppobojrflj5bnmoTljp/lp4vlj5jph4/mlbDmja5cbiAgICogQHBhcmFtIG1lc3NhZ2VfaWQg5raI5oGvSUTvvIjlj6/pgInvvIzku4XnlKjkuo5tZXNzYWdl57G75Z6L5Y+Y6YeP77yJXG4gICAqIEByZXR1cm5zIOi9rOaNouWQjueahFZhcmlhYmxlSXRlbeaVsOe7hFxuICAgKiBAZGVzY3JpcHRpb24g6Ieq5Yqo5o6o5pat5q+P5Liq5Y+Y6YeP55qE5pWw5o2u57G75Z6L5bm25YiG6YWN5ZSv5LiASURcbiAgICovXG4gIHB1YmxpYyBjb252ZXJ0VGF2ZXJuVmFyaWFibGVzVG9JdGVtcyh0YXZlcm5WYXJpYWJsZXM6IFRhdmVyblZhcmlhYmxlcywgbWVzc2FnZV9pZD86IG51bWJlcik6IFZhcmlhYmxlSXRlbVtdIHtcbiAgICByZXR1cm4gT2JqZWN0LmVudHJpZXModGF2ZXJuVmFyaWFibGVzKS5tYXAoKFtuYW1lLCB2YWx1ZV0pID0+IHtcbiAgICAgIHJldHVybiB0aGlzLmNyZWF0ZVZhcmlhYmxlSXRlbShuYW1lLCB2YWx1ZSwgbWVzc2FnZV9pZCk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog5bCGVmFyaWFibGVJdGVt5pWw57uE6L2s5o2i5Li6VGF2ZXJuVmFyaWFibGVz5a+56LGhXG4gICAqIEBwYXJhbSB2YXJpYWJsZXMgVmFyaWFibGVJdGVt5pWw57uEXG4gICAqIEBwYXJhbSBtZXNzYWdlX2lkIOWPr+mAieeahG1lc3NhZ2VfaWTnrZvpgInmnaHku7ZcbiAgICogQHJldHVybnMgVGF2ZXJuVmFyaWFibGVz5a+56LGhXG4gICAqL1xuICBwdWJsaWMgY29udmVydEl0ZW1zVG9UYXZlcm5WYXJpYWJsZXModmFyaWFibGVzOiBWYXJpYWJsZUl0ZW1bXSwgbWVzc2FnZV9pZD86IG51bWJlcik6IFRhdmVyblZhcmlhYmxlcyB7XG4gICAgY29uc3QgcmVzdWx0OiBUYXZlcm5WYXJpYWJsZXMgPSB7fTtcblxuICAgIGZvciAoY29uc3QgdmFyaWFibGUgb2YgdmFyaWFibGVzKSB7XG4gICAgICAvLyDlpoLmnpzmjIflrprkuoZtZXNzYWdlX2lk77yM5Y+q6L2s5o2i5Yy56YWN55qE5Y+Y6YePXG4gICAgICBpZiAobWVzc2FnZV9pZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGlmICh2YXJpYWJsZS5tZXNzYWdlX2lkID09PSBtZXNzYWdlX2lkKSB7XG4gICAgICAgICAgcmVzdWx0W3ZhcmlhYmxlLm5hbWVdID0gdmFyaWFibGUudmFsdWU7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIOWmguaenOayoeacieaMh+Wumm1lc3NhZ2VfaWTvvIzovazmjaLmiYDmnInlj5jph49cbiAgICAgICAgcmVzdWx0W3ZhcmlhYmxlLm5hbWVdID0gdmFyaWFibGUudmFsdWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8qKlxuICAgKiDliqDovb3mjIflrprnsbvlnovnmoTlj5jph49cbiAgICogQHBhcmFtIHR5cGUg5Y+Y6YeP57G75Z6LKGdsb2JhbC9jaGFyYWN0ZXIvY2hhdC9tZXNzYWdlKVxuICAgKiBAcmV0dXJucyDliqDovb3nmoTlj5jph4/mlbDmja5cbiAgICovXG4gIHB1YmxpYyBhc3luYyBsb2FkRnJvbVRhdmVybih0eXBlOiBWYXJpYWJsZVR5cGUpOiBQcm9taXNlPFZhcmlhYmxlSXRlbVtdPiB7XG4gICAgdGhpcy5jbGVhclZhcmlhYmxlSWRNYXAoKTtcblxuICAgIHRyeSB7XG4gICAgICB0aGlzLmFjdGl2ZVZhcmlhYmxlVHlwZSA9IHR5cGU7XG5cbiAgICAgIGlmICh0eXBlID09PSAnbWVzc2FnZScpIHtcbiAgICAgICAgdGhpcy5jdXJyZW50VmFyaWFibGVzID0gW107XG5cbiAgICAgICAgLy8g6I635Y+W5b2T5YmN5qW85bGC6IyD5Zu0XG4gICAgICAgIGNvbnN0IFttaW5GbG9vciwgbWF4Rmxvb3JdID0gdGhpcy5nZXRGbG9vclJhbmdlKCk7XG5cbiAgICAgICAgLy8g56Gu5L+d6Iez5bCR5pyJ5LiA5Liq5pyJ5pWI55qE5qW85bGC6IyD5Zu0XG4gICAgICAgIGlmIChtaW5GbG9vciAhPT0gbnVsbCB8fCBtYXhGbG9vciAhPT0gbnVsbCkge1xuICAgICAgICAgIGNvbnN0IGVmZmVjdGl2ZU1pbkZsb29yID0gbWluRmxvb3IgPz8gMDtcbiAgICAgICAgICBjb25zdCBlZmZlY3RpdmVNYXhGbG9vciA9IG1heEZsb29yID8/IG1pbkZsb29yID8/IDA7XG5cbiAgICAgICAgICAvLyDpgY3ljobmr4/kuKrmpbzlsYLvvIzliqDovb3lkIToh6rnmoTlj5jph49cbiAgICAgICAgICBmb3IgKGxldCBmbG9vciA9IGVmZmVjdGl2ZU1pbkZsb29yOyBmbG9vciA8PSBlZmZlY3RpdmVNYXhGbG9vcjsgZmxvb3IrKykge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgY29uc3QgZmxvb3JWYXJzID0gdGhpcy5nZXRGbG9vclZhcmlhYmxlcyhmbG9vcik7XG4gICAgICAgICAgICAgIC8vIOS4uuavj+S4qualvOWxgueahOWPmOmHj+a3u+WKoG1lc3NhZ2VfaWTmoIfor4ZcbiAgICAgICAgICAgICAgY29uc3QgZmxvb3JWYXJpYWJsZUl0ZW1zID0gdGhpcy5jb252ZXJ0VGF2ZXJuVmFyaWFibGVzVG9JdGVtcyhmbG9vclZhcnMsIGZsb29yKTtcbiAgICAgICAgICAgICAgdGhpcy5jdXJyZW50VmFyaWFibGVzLnB1c2goLi4uZmxvb3JWYXJpYWJsZUl0ZW1zKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgIGxvZy53YXJuKGBbVmFyaWFibGVNb2RlbF0g5Yqg6L2956ysJHtmbG9vcn3lsYLlj5jph4/lpLHotKU6YCwgZXJyb3IpO1xuICAgICAgICAgICAgICAvLyDnu6fnu63liqDovb3lhbbku5bmpbzlsYJcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IHZhcmlhYmxlcyA9IGdldFZhcmlhYmxlcyh7IHR5cGUgfSkgYXMgVGF2ZXJuVmFyaWFibGVzO1xuICAgICAgICB0aGlzLmN1cnJlbnRWYXJpYWJsZXMgPSB0aGlzLmNvbnZlcnRUYXZlcm5WYXJpYWJsZXNUb0l0ZW1zKHZhcmlhYmxlcyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRWYXJpYWJsZXM7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZy5lcnJvcihgW1ZhcmlhYmxlTWFuYWdlcl0g5Yqg6L29JHt0eXBlfeWPmOmHj+Wksei0pTpgLCBlcnJvcik7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOS/neWtmOaJgOacieWPmOmHj+WIsOmFkummhlxuICAgKiBAcGFyYW0gdHlwZSDlj5jph4/nsbvlnosoZ2xvYmFsL2NoYXJhY3Rlci9jaGF0L21lc3NhZ2UpXG4gICAqIEBwYXJhbSBtZXNzYWdlX2lkIOa2iOaBr0lEKOS7heeUqOS6jm1lc3NhZ2XnsbvlnovvvIzlj6/pgInvvIzlpoLmnpzmjIflrprliJnlj6rkv53lrZjliLDor6XmpbzlsYIpXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgc2F2ZUFsbFZhcmlhYmxlcyh0eXBlOiBWYXJpYWJsZVR5cGUsIG1lc3NhZ2VfaWQ/OiBudW1iZXIpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAoIXRoaXMuY3VycmVudFZhcmlhYmxlcykge1xuICAgICAgbG9nLndhcm4oJ1tWYXJpYWJsZU1vZGVsXSDlvZPliY3msqHmnInlj5jph4/mlbDmja7vvIzot7Pov4fkv53lrZgnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAodHlwZSA9PT0gJ21lc3NhZ2UnKSB7XG4gICAgICBjb25zdCBbbWluRmxvb3IsIG1heEZsb29yXSA9IHRoaXMuZ2V0Rmxvb3JSYW5nZSgpO1xuXG4gICAgICBpZiAobWluRmxvb3IgPT09IG51bGwgfHwgbWF4Rmxvb3IgPT09IG51bGwpIHtcbiAgICAgICAgbG9nLndhcm4oJ1tWYXJpYWJsZU1vZGVsXSDkv53lrZhtZXNzYWdl5Y+Y6YeP5aSx6LSlOiDmnKrorr7nva7mnInmlYjnmoTmpbzlsYLojIPlm7QnKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyDlpoLmnpzmjIflrprkuobnibnlrprnmoRtZXNzYWdlX2lk77yM5Y+q5L+d5a2Y5Yiw6K+l5qW85bGCXG4gICAgICBpZiAobWVzc2FnZV9pZCAhPT0gdW5kZWZpbmVkICYmIG1lc3NhZ2VfaWQgPj0gbWluRmxvb3IgJiYgbWVzc2FnZV9pZCA8PSBtYXhGbG9vcikge1xuICAgICAgICBjb25zdCB2YXJpYWJsZXNGb3JGbG9vciA9IHRoaXMuY3VycmVudFZhcmlhYmxlcy5maWx0ZXIodiA9PiB2Lm1lc3NhZ2VfaWQgPT09IG1lc3NhZ2VfaWQpO1xuICAgICAgICBjb25zdCB0YXZlcm5WYXJpYWJsZXMgPSB0aGlzLmNvbnZlcnRJdGVtc1RvVGF2ZXJuVmFyaWFibGVzKHZhcmlhYmxlc0ZvckZsb29yLCBtZXNzYWdlX2lkKTtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgIGF3YWl0IHJlcGxhY2VWYXJpYWJsZXModGF2ZXJuVmFyaWFibGVzLCB7IHR5cGU6ICdtZXNzYWdlJywgbWVzc2FnZV9pZCB9KTtcbiAgICAgICAgICBsb2cuaW5mbyhgW1ZhcmlhYmxlTWFuYWdlcl0g5oiQ5Yqf5L+d5a2Y56ysJHttZXNzYWdlX2lkfeWxguWPmOmHj2ApO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGxvZy5lcnJvcihgW1ZhcmlhYmxlTWFuYWdlcl0g5L+d5a2Y56ysJHttZXNzYWdlX2lkfeWxguWPmOmHj+Wksei0pTpgLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIOWvueS6jua2iOaBr+exu+Wei++8jOaMiealvOWxguWIhue7hOS/neWtmOWPmOmHj1xuICAgICAgICBmb3IgKGxldCBmbG9vciA9IG1pbkZsb29yOyBmbG9vciA8PSBtYXhGbG9vcjsgZmxvb3IrKykge1xuICAgICAgICAgIGNvbnN0IHZhcmlhYmxlc0ZvckZsb29yID0gdGhpcy5jdXJyZW50VmFyaWFibGVzLmZpbHRlcih2ID0+IHYubWVzc2FnZV9pZCA9PT0gZmxvb3IpO1xuICAgICAgICAgIGNvbnN0IHRhdmVyblZhcmlhYmxlcyA9IHRoaXMuY29udmVydEl0ZW1zVG9UYXZlcm5WYXJpYWJsZXModmFyaWFibGVzRm9yRmxvb3IsIGZsb29yKTtcblxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCByZXBsYWNlVmFyaWFibGVzKHRhdmVyblZhcmlhYmxlcywgeyB0eXBlOiAnbWVzc2FnZScsIG1lc3NhZ2VfaWQ6IGZsb29yIH0pO1xuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBsb2cuZXJyb3IoYFtWYXJpYWJsZU1hbmFnZXJdIOS/neWtmOesrCR7Zmxvb3J95bGC5Y+Y6YeP5aSx6LSlOmAsIGVycm9yKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8g5a+55LqO5YW25LuW57G75Z6L77yIZ2xvYmFsL2NoYXJhY3Rlci9jaGF077yJ77yM5p6E5bu65Y+Y6YeP5a+56LGhXG4gICAgICBjb25zdCB0YXZlcm5WYXJpYWJsZXMgPSB0aGlzLmNvbnZlcnRJdGVtc1RvVGF2ZXJuVmFyaWFibGVzKHRoaXMuY3VycmVudFZhcmlhYmxlcyk7XG4gICAgICBhd2FpdCByZXBsYWNlVmFyaWFibGVzKHRhdmVyblZhcmlhYmxlcywgeyB0eXBlIH0pO1xuICAgIH1cblxuICAgIGxvZy5pbmZvKGBbVmFyaWFibGVNYW5hZ2VyXSDkv53lrZjlj5jph4/miJDlip9gKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5blvZPliY3mtLvliqjnmoTlj5jph4/nsbvlnotcbiAgICogQHJldHVybnMg5Y+Y6YeP57G75Z6LXG4gICAqL1xuICBwdWJsaWMgZ2V0QWN0aXZlVmFyaWFibGVUeXBlKCk6IFZhcmlhYmxlVHlwZSB7XG4gICAgcmV0dXJuIHRoaXMuYWN0aXZlVmFyaWFibGVUeXBlO1xuICB9XG5cbiAgLyoqXG4gICAqIOabtOaWsOWIl+ihqOWPmOmHj+eahOmhuuW6j1xuICAgKiBAcGFyYW0gdHlwZSDlj5jph4/nsbvlnosoZ2xvYmFsL2NoYXJhY3Rlci9jaGF0L21lc3NhZ2UpXG4gICAqIEBwYXJhbSBuYW1lIOWPmOmHj+WQjeensFxuICAgKiBAcGFyYW0gaXRlbXMg5paw55qE5YiX6KGo6aG65bqPXG4gICAqIEBwYXJhbSB2YXJpYWJsZV9pZCDlj5jph49JRCjlj6/pgInvvIzlpoLmnpzmj5DkvpvliJnlkIzml7bmm7TmlrBJROaYoOWwhClcbiAgICovXG4gIHB1YmxpYyBhc3luYyB1cGRhdGVMaXN0T3JkZXIodHlwZTogVmFyaWFibGVUeXBlLCBuYW1lOiBzdHJpbmcsIGl0ZW1zOiBzdHJpbmdbXSwgdmFyaWFibGVfaWQ/OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAodHlwZSA9PT0gdGhpcy5hY3RpdmVWYXJpYWJsZVR5cGUgJiYgdGhpcy5jdXJyZW50VmFyaWFibGVzKSB7XG4gICAgICBjb25zdCB2YXJpYWJsZSA9IHRoaXMuY3VycmVudFZhcmlhYmxlcy5maW5kKHZhcmlhYmxlID0+IHZhcmlhYmxlLm5hbWUgPT09IG5hbWUpO1xuICAgICAgaWYgKHZhcmlhYmxlICYmIEFycmF5LmlzQXJyYXkodmFyaWFibGUudmFsdWUpKSB7XG4gICAgICAgIHZhcmlhYmxlLnZhbHVlID0gaXRlbXM7XG5cbiAgICAgICAgLy8g5aaC5p6c5o+Q5L6b5LqG5Y+Y6YePSUTvvIzmm7TmlrDmmKDlsIRcbiAgICAgICAgaWYgKHZhcmlhYmxlX2lkKSB7XG4gICAgICAgICAgY29uc3QgdmFySW5mbyA9IHRoaXMudmFyaWFibGVJZE1hcC5nZXQodmFyaWFibGVfaWQpO1xuICAgICAgICAgIGlmICh2YXJJbmZvKSB7XG4gICAgICAgICAgICB2YXJJbmZvLnZhbHVlID0gaXRlbXM7XG4gICAgICAgICAgICAvLyDkv53mjIHlj5jph4/nmoRtZXNzYWdlX2lk5LiN5Y+YXG4gICAgICAgICAgICB0aGlzLnZhcmlhYmxlSWRNYXAuc2V0KHZhcmlhYmxlX2lkLCB2YXJJbmZvKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyDkvb/nlKjlrozlhajopobnm5bmqKHlvI/kv53lrZhcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlQWxsVmFyaWFibGVzKHR5cGUsIHZhcmlhYmxlLm1lc3NhZ2VfaWQpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmuIXpmaTmiYDmnInlj5jph49cbiAgICogQHBhcmFtIHR5cGUg5Y+Y6YeP57G75Z6LKGdsb2JhbC9jaGFyYWN0ZXIvY2hhdC9tZXNzYWdlKVxuICAgKi9cbiAgcHVibGljIGFzeW5jIGNsZWFyQWxsVmFyaWFibGVzKHR5cGU6IFZhcmlhYmxlVHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICh0eXBlID09PSB0aGlzLmFjdGl2ZVZhcmlhYmxlVHlwZSkge1xuICAgICAgdGhpcy5jdXJyZW50VmFyaWFibGVzID0gW107XG4gICAgICB0aGlzLmNsZWFyVmFyaWFibGVJZE1hcCgpO1xuICAgIH1cblxuICAgIC8vIOa2iOaBr+exu+Wei+WPmOmHj+mcgOimgemAkOWxgua4hemZpFxuICAgIGlmICh0eXBlID09PSAnbWVzc2FnZScpIHtcbiAgICAgIGNvbnN0IFttaW5GbG9vciwgbWF4Rmxvb3JdID0gdGhpcy5nZXRGbG9vclJhbmdlKCk7XG5cbiAgICAgIGlmIChtaW5GbG9vciA9PT0gbnVsbCB8fCBtYXhGbG9vciA9PT0gbnVsbCkge1xuICAgICAgICBsb2cud2FybignW1ZhcmlhYmxlTW9kZWxdIOa4hemZpG1lc3NhZ2Xlj5jph4/lpLHotKU6IOacquiuvue9ruacieaViOeahOalvOWxguiMg+WbtCcpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIOmAkOWxgua4hemZpOWPmOmHj1xuICAgICAgZm9yIChsZXQgZmxvb3IgPSBtaW5GbG9vcjsgZmxvb3IgPD0gbWF4Rmxvb3I7IGZsb29yKyspIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBlbXB0eVZhcmlhYmxlczogVGF2ZXJuVmFyaWFibGVzID0ge307XG4gICAgICAgICAgYXdhaXQgcmVwbGFjZVZhcmlhYmxlcyhlbXB0eVZhcmlhYmxlcywgeyB0eXBlOiAnbWVzc2FnZScsIG1lc3NhZ2VfaWQ6IGZsb29yIH0pO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGxvZy5lcnJvcihgW1ZhcmlhYmxlTW9kZWxdIOa4hemZpOesrCR7Zmxvb3J95bGC5Y+Y6YeP5aSx6LSlOmAsIGVycm9yKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyDlhbbku5bnsbvlnovlj5jph4/nm7TmjqXmm7/mjaLkuLrnqbrlr7nosaFcbiAgICAgIGNvbnN0IGVtcHR5VmFyaWFibGVzOiBUYXZlcm5WYXJpYWJsZXMgPSB7fTtcbiAgICAgIGF3YWl0IHJlcGxhY2VWYXJpYWJsZXMoZW1wdHlWYXJpYWJsZXMsIHsgdHlwZSB9KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5pu05paw562b6YCJ54q25oCBXG4gICAqIEBwYXJhbSB0eXBlIOaVsOaNruexu+Wei1xuICAgKiBAcGFyYW0gY2hlY2tlZCDmmK/lkKbpgInkuK1cbiAgICovXG4gIHB1YmxpYyB1cGRhdGVGaWx0ZXJTdGF0ZSh0eXBlOiBWYXJpYWJsZURhdGFUeXBlLCBjaGVja2VkOiBib29sZWFuKTogdm9pZCB7XG4gICAgdGhpcy5maWx0ZXJTdGF0ZVt0eXBlXSA9IGNoZWNrZWQ7XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W562b6YCJ54q25oCBXG4gICAqIEByZXR1cm5zIOetm+mAieeKtuaAgVxuICAgKi9cbiAgcHVibGljIGdldEZpbHRlclN0YXRlKCk6IFJlY29yZDxWYXJpYWJsZURhdGFUeXBlLCBib29sZWFuPiB7XG4gICAgcmV0dXJuIHRoaXMuZmlsdGVyU3RhdGU7XG4gIH1cblxuICAvKipcbiAgICog5pu05paw5pCc57Si5YWz6ZSu6K+NXG4gICAqIEBwYXJhbSBrZXl3b3JkIOWFs+mUruivjVxuICAgKi9cbiAgcHVibGljIHVwZGF0ZVNlYXJjaEtleXdvcmQoa2V5d29yZDogc3RyaW5nKTogdm9pZCB7XG4gICAgdGhpcy5zZWFyY2hLZXl3b3JkID0ga2V5d29yZDtcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5bmkJzntKLlhbPplK7or41cbiAgICogQHJldHVybnMg5pCc57Si5YWz6ZSu6K+NXG4gICAqL1xuICBwdWJsaWMgZ2V0U2VhcmNoS2V5d29yZCgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLnNlYXJjaEtleXdvcmQ7XG4gIH1cblxuICAvKipcbiAgICog5pu05paw5qW85bGC6IyD5Zu0562b6YCJXG4gICAqIEBwYXJhbSBtaW4g5pyA5bCP5qW85bGCXG4gICAqIEBwYXJhbSBtYXgg5pyA5aSn5qW85bGCXG4gICAqL1xuICBwdWJsaWMgdXBkYXRlRmxvb3JSYW5nZShtaW46IG51bWJlciB8IG51bGwsIG1heDogbnVtYmVyIHwgbnVsbCk6IHZvaWQge1xuICAgIC8vIOmqjOivgealvOWxguS4jeiDveWwj+S6jjBcbiAgICBpZiAobWluICE9PSBudWxsKSB7XG4gICAgICBtaW4gPSBNYXRoLm1heCgwLCBtaW4pO1xuICAgIH1cbiAgICBpZiAobWF4ICE9PSBudWxsKSB7XG4gICAgICBtYXggPSBNYXRoLm1heCgwLCBtYXgpO1xuICAgIH1cblxuICAgIC8vIOWmguaenOiuvue9ruS6huiMg+WbtOS9huaYr+acgOWwj+WAvOWkp+S6juacgOWkp+WAvO+8jOWImeS6pOaNouWug+S7rFxuICAgIGlmIChtaW4gIT09IG51bGwgJiYgbWF4ICE9PSBudWxsICYmIG1pbiA+IG1heCkge1xuICAgICAgW21pbiwgbWF4XSA9IFttYXgsIG1pbl07XG4gICAgfVxuXG4gICAgdGhpcy5mbG9vck1pblJhbmdlID0gbWluO1xuICAgIHRoaXMuZmxvb3JNYXhSYW5nZSA9IG1heDtcblxuICAgIC8vIOa4hemZpOe8k+WtmO+8jOW8uuWItumHjeaWsOWKoOi9vVxuICAgIGlmICh0aGlzLmFjdGl2ZVZhcmlhYmxlVHlwZSA9PT0gJ21lc3NhZ2UnKSB7XG4gICAgICB0aGlzLmN1cnJlbnRWYXJpYWJsZXMgPSBudWxsO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5blvZPliY3mpbzlsYLojIPlm7TnrZvpgIlcbiAgICogQHJldHVybnMg5b2T5YmN5qW85bGC6IyD5Zu0IFttaW4sIG1heF1cbiAgICovXG4gIHB1YmxpYyBnZXRGbG9vclJhbmdlKCk6IFtudW1iZXIgfCBudWxsLCBudW1iZXIgfCBudWxsXSB7XG4gICAgcmV0dXJuIFt0aGlzLmZsb29yTWluUmFuZ2UsIHRoaXMuZmxvb3JNYXhSYW5nZV07XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W54m55a6a5qW85bGC55qE5Y+Y6YeP5pWw5o2uXG4gICAqIEBwYXJhbSBtZXNzYWdlSWQg5raI5oGvSURcbiAgICogQHJldHVybnMg5qW85bGC5Y+Y6YeP5pWw5o2u5a+56LGhXG4gICAqL1xuICBwdWJsaWMgZ2V0Rmxvb3JWYXJpYWJsZXMobWVzc2FnZUlkOiBudW1iZXIpOiBUYXZlcm5WYXJpYWJsZXMge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB2YXJpYWJsZXMgPSBnZXRWYXJpYWJsZXMoeyB0eXBlOiAnbWVzc2FnZScsIG1lc3NhZ2VfaWQ6IG1lc3NhZ2VJZCB9KSBhcyBUYXZlcm5WYXJpYWJsZXM7XG4gICAgICByZXR1cm4gdmFyaWFibGVzIHx8IHt9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2cuZXJyb3IoYOiOt+WPluesrCR7bWVzc2FnZUlkfeWxguWPmOmHj+Wksei0pTpgLCBlcnJvcik7XG4gICAgICByZXR1cm4ge307XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOafpeaJvuWPmOmHj+WvueW6lOeahCBJRFxuICAgKiBAcGFyYW0gbmFtZSDlj5jph4/lkI3np7BcbiAgICogQHBhcmFtIG1lc3NhZ2VfaWQg5raI5oGvSUTvvIjlj6/pgInvvIznlKjkuo7nsr7noa7ljLnphY1tZXNzYWdl57G75Z6L5Y+Y6YeP77yJXG4gICAqIEByZXR1cm5zIOaJvuWIsOeahOWPmOmHj0lE77yM5aaC5p6c5LiN5a2Y5Zyo5YiZ6L+U5ZuedW5kZWZpbmVkXG4gICAqL1xuICBwdWJsaWMgZmluZFZhcmlhYmxlSWQobmFtZTogc3RyaW5nLCBtZXNzYWdlX2lkPzogbnVtYmVyKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICBmb3IgKGNvbnN0IGlkIG9mIHRoaXMudmFyaWFibGVJZE1hcC5rZXlzKCkpIHtcbiAgICAgIGNvbnN0IHZhckluZm8gPSB0aGlzLnZhcmlhYmxlSWRNYXAuZ2V0KGlkKTtcbiAgICAgIGlmICh2YXJJbmZvICYmIHZhckluZm8ubmFtZSA9PT0gbmFtZSkge1xuICAgICAgICAvLyDlpoLmnpzmjIflrprkuoZtZXNzYWdlX2lk77yM6ZyA6KaB57K+56Gu5Yy56YWNXG4gICAgICAgIGlmIChtZXNzYWdlX2lkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBpZiAodmFySW5mby5tZXNzYWdlX2lkID09PSBtZXNzYWdlX2lkKSB7XG4gICAgICAgICAgICByZXR1cm4gaWQ7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIOWmguaenOayoeacieaMh+Wumm1lc3NhZ2VfaWTvvIzov5Tlm57nrKzkuIDkuKrljLnphY3nmoTlj5jph49cbiAgICAgICAgICByZXR1cm4gaWQ7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5bmjIflrprmpbzlsYLnmoTlj5jph4/liJfooahcbiAgICogQHBhcmFtIG1lc3NhZ2VfaWQg5raI5oGvSURcbiAgICogQHJldHVybnMg5bGe5LqO6K+l5qW85bGC55qE5Y+Y6YeP5YiX6KGoXG4gICAqL1xuICBwdWJsaWMgZ2V0VmFyaWFibGVzQnlNZXNzYWdlSWQobWVzc2FnZV9pZDogbnVtYmVyKTogVmFyaWFibGVJdGVtW10ge1xuICAgIGlmICghdGhpcy5jdXJyZW50VmFyaWFibGVzKSByZXR1cm4gW107XG4gICAgcmV0dXJuIHRoaXMuY3VycmVudFZhcmlhYmxlcy5maWx0ZXIodmFyaWFibGUgPT4gdmFyaWFibGUubWVzc2FnZV9pZCA9PT0gbWVzc2FnZV9pZCk7XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5omA5pyJ5rKh5pyJbWVzc2FnZV9pZOeahOWPmOmHj++8iOmAmuW4uOaYr+mdnm1lc3NhZ2XnsbvlnovnmoTlj5jph4/vvIlcbiAgICogQHJldHVybnMg5rKh5pyJbWVzc2FnZV9pZOeahOWPmOmHj+WIl+ihqFxuICAgKi9cbiAgcHVibGljIGdldFZhcmlhYmxlc1dpdGhvdXRNZXNzYWdlSWQoKTogVmFyaWFibGVJdGVtW10ge1xuICAgIGlmICghdGhpcy5jdXJyZW50VmFyaWFibGVzKSByZXR1cm4gW107XG4gICAgcmV0dXJuIHRoaXMuY3VycmVudFZhcmlhYmxlcy5maWx0ZXIodmFyaWFibGUgPT4gdmFyaWFibGUubWVzc2FnZV9pZCA9PT0gdW5kZWZpbmVkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmoLnmja7lj5jph4/lkI3ojrflj5bmiYDmnInlkIzlkI3lj5jph49cbiAgICogQHBhcmFtIG5hbWUg5Y+Y6YeP5ZCN56ewXG4gICAqIEByZXR1cm5zIOWQjOWQjeWPmOmHj+WIl+ihqFxuICAgKi9cbiAgcHVibGljIGdldFZhcmlhYmxlc0J5TmFtZShuYW1lOiBzdHJpbmcpOiBWYXJpYWJsZUl0ZW1bXSB7XG4gICAgaWYgKCF0aGlzLmN1cnJlbnRWYXJpYWJsZXMpIHJldHVybiBbXTtcbiAgICByZXR1cm4gdGhpcy5jdXJyZW50VmFyaWFibGVzLmZpbHRlcih2YXJpYWJsZSA9PiB2YXJpYWJsZS5uYW1lID09PSBuYW1lKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDpgJrov4flj5jph4/lkI3mn6Xmib7lj5jph49cbiAgICogQHBhcmFtIG5hbWUg5Y+Y6YeP5ZCN56ewXG4gICAqIEBwYXJhbSBtZXNzYWdlX2lkIOa2iOaBr0lE77yI5Y+v6YCJ77yM55So5LqO57K+56Gu5Yy56YWNbWVzc2FnZeexu+Wei+WPmOmHj++8iVxuICAgKiBAcmV0dXJucyDmib7liLDnmoTlj5jph4/vvIzlpoLmnpzkuI3lrZjlnKjliJnov5Tlm551bmRlZmluZWRcbiAgICovXG4gIHB1YmxpYyBmaW5kVmFyaWFibGVCeU5hbWUobmFtZTogc3RyaW5nLCBtZXNzYWdlX2lkPzogbnVtYmVyKTogVmFyaWFibGVJdGVtIHwgdW5kZWZpbmVkIHtcbiAgICBpZiAoIXRoaXMuY3VycmVudFZhcmlhYmxlcykgcmV0dXJuIHVuZGVmaW5lZDtcblxuICAgIGZvciAoY29uc3QgdmFyaWFibGUgb2YgdGhpcy5jdXJyZW50VmFyaWFibGVzKSB7XG4gICAgICBpZiAodmFyaWFibGUubmFtZSA9PT0gbmFtZSkge1xuICAgICAgICBpZiAobWVzc2FnZV9pZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgaWYgKHZhcmlhYmxlLm1lc3NhZ2VfaWQgPT09IG1lc3NhZ2VfaWQpIHtcbiAgICAgICAgICAgIHJldHVybiB2YXJpYWJsZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIHZhcmlhYmxlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICAvKipcbiAgICog5ZCM5q2l5b2T5YmN5Y+Y6YeP5YiX6KGo77yM5qC55o2u5aSW6YOo5Y+Y5YyW6L+b6KGM5aKe6YeP5pu05pawXG4gICAqIEBwYXJhbSBhZGRlZCDmlrDlop7nmoTlj5jph49cbiAgICogQHBhcmFtIHJlbW92ZWRJZHMg6KaB5Yig6Zmk55qE5Y+Y6YePSUTliJfooahcbiAgICogQHBhcmFtIHVwZGF0ZWQg6KaB5pu05paw55qE5Y+Y6YePXG4gICAqL1xuICBwdWJsaWMgc3luY0N1cnJlbnRWYXJpYWJsZXMoYWRkZWQ6IFZhcmlhYmxlSXRlbVtdLCByZW1vdmVkSWRzOiBzdHJpbmdbXSwgdXBkYXRlZDogVmFyaWFibGVJdGVtW10pOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuY3VycmVudFZhcmlhYmxlcykge1xuICAgICAgdGhpcy5jdXJyZW50VmFyaWFibGVzID0gW107XG4gICAgfVxuXG4gICAgLy8g5aSE55CG5Yig6ZmkXG4gICAgcmVtb3ZlZElkcy5mb3JFYWNoKGlkID0+IHtcbiAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5jdXJyZW50VmFyaWFibGVzIS5maW5kSW5kZXgodiA9PiB2LmlkID09PSBpZCk7XG4gICAgICBpZiAoaW5kZXggPj0gMCkge1xuICAgICAgICB0aGlzLmN1cnJlbnRWYXJpYWJsZXMhLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIHRoaXMudmFyaWFibGVJZE1hcC5kZWxldGUoaWQpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8g5aSE55CG5paw5aKeXG4gICAgYWRkZWQuZm9yRWFjaCh2YXJpYWJsZSA9PiB7XG4gICAgICB0aGlzLmN1cnJlbnRWYXJpYWJsZXMhLnB1c2godmFyaWFibGUpO1xuICAgICAgdGhpcy52YXJpYWJsZUlkTWFwLnNldCh2YXJpYWJsZS5pZCwgdmFyaWFibGUpO1xuICAgIH0pO1xuXG4gICAgLy8g5aSE55CG5pu05pawXG4gICAgdXBkYXRlZC5mb3JFYWNoKHVwZGF0ZWRWYXJpYWJsZSA9PiB7XG4gICAgICBjb25zdCBpbmRleCA9IHRoaXMuY3VycmVudFZhcmlhYmxlcyEuZmluZEluZGV4KHYgPT4gdi5pZCA9PT0gdXBkYXRlZFZhcmlhYmxlLmlkKTtcbiAgICAgIGlmIChpbmRleCA+PSAwKSB7XG4gICAgICAgIHRoaXMuY3VycmVudFZhcmlhYmxlcyFbaW5kZXhdID0gdXBkYXRlZFZhcmlhYmxlO1xuICAgICAgICB0aGlzLnZhcmlhYmxlSWRNYXAuc2V0KHVwZGF0ZWRWYXJpYWJsZS5pZCwgdXBkYXRlZFZhcmlhYmxlKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/component/variable_manager/model.ts\n")},"./src/component/variable_manager/sync.ts":
/*!************************************************!*\
  !*** ./src/component/variable_manager/sync.ts ***!
  \************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VariableSyncService: () => (/* binding */ VariableSyncService)\n/* harmony export */ });\n/* harmony import */ var _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/variable_manager/util */ \"./src/component/variable_manager/util.ts\");\n/* harmony import */ var _function_variables__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/function/variables */ \"./src/function/variables.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_3__);\n\n\n\n\nconst VARIABLE_EVENTS = {\n    GLOBAL: 'settings_updated',\n    CHARACTER: 'character_variables_changed',\n    MESSAGE: 'message_variables_changed',\n    CHAT: '',\n};\nconst CHAT_POLLING_INTERVAL = 2000;\nclass VariableSyncService {\n    domUpdater;\n    model;\n    currentType = null;\n    _boundListeners = {\n        global: { bound: false, handler: this._handleVariableUpdate.bind(this, 'global') },\n        character: { bound: false, handler: this._handleVariableUpdate.bind(this, 'character') },\n        chat: { bound: false, handler: this._handleVariableUpdate.bind(this, 'chat') },\n        message: { bound: false, handler: this._handleVariableUpdate.bind(this, 'message') },\n    };\n    _chatPollingInterval = null;\n    /**\n     * @param domUpdater DOM更新器\n     * @param model 变量数据模型\n     */\n    constructor(domUpdater, model) {\n        this.domUpdater = domUpdater;\n        this.model = model;\n    }\n    async cleanup() {\n        this._unbindAllEventListeners();\n        this._stopChatPolling();\n        this.currentType = null;\n    }\n    /**\n     * 初始化当前类型\n     */\n    async initCurrentType() {\n        this.currentType = 'global';\n        this._activateCurrentListeners();\n    }\n    /**\n     * 设置当前变量类型，并相应地初始化监听器或轮询\n     * @param type 变量类型\n     */\n    async setCurrentType(type) {\n        if (this.currentType !== type) {\n            this._deactivateCurrentListeners();\n            this.currentType = type;\n            this._activateCurrentListeners();\n        }\n    }\n    /**\n     * 重新激活当前类型的监听器（用于标签页重新激活等场景）\n     */\n    reactivateListeners() {\n        this._deactivateCurrentListeners();\n        this._activateCurrentListeners();\n    }\n    /**\n     * 停用当前的事件监听器或轮询\n     */\n    deactivateListeners() {\n        this._deactivateCurrentListeners();\n    }\n    /**\n     * 激活当前类型的监听器或轮询\n     * @private\n     */\n    _activateCurrentListeners() {\n        if (this.currentType) {\n            if (this.currentType === 'chat') {\n                this._startChatPolling();\n            }\n            else {\n                this._bindVariableListener(this.currentType);\n            }\n        }\n    }\n    /**\n     * 停用当前的监听器或轮询\n     * @private\n     */\n    _deactivateCurrentListeners() {\n        this._unbindAllEventListeners();\n        this._stopChatPolling();\n    }\n    /**\n     * 统一的变量监听器绑定方法\n     * @param type 变量类型\n     * @private\n     */\n    _bindVariableListener(type) {\n        if (type === 'chat')\n            return;\n        const eventName = VARIABLE_EVENTS[type.toUpperCase()];\n        const listenerStatus = this._boundListeners[type];\n        if (!listenerStatus.bound && eventName) {\n            try {\n                _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.eventSource.on(eventName, listenerStatus.handler);\n                this._boundListeners[type].bound = true;\n                loglevel__WEBPACK_IMPORTED_MODULE_3___default().info(`[VariableManager]：开始同步监听${type}变量`);\n            }\n            catch (error) {\n                loglevel__WEBPACK_IMPORTED_MODULE_3___default().error(`[VariableManager]：绑定${type}变量事件监听器时出错:`, error);\n                this._boundListeners[type].bound = false;\n            }\n        }\n    }\n    /**\n     * 解绑所有事件监听器\n     * @private\n     */\n    _unbindAllEventListeners() {\n        for (const type of Object.keys(this._boundListeners)) {\n            if (type === 'chat')\n                continue;\n            const eventName = VARIABLE_EVENTS[type.toUpperCase()];\n            const listenerStatus = this._boundListeners[type];\n            if (listenerStatus.bound && eventName) {\n                try {\n                    _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.eventSource.removeListener(eventName, listenerStatus.handler);\n                    this._boundListeners[type].bound = false;\n                }\n                catch (error) {\n                    loglevel__WEBPACK_IMPORTED_MODULE_3___default().error(`[VariableManager]：解绑${type}变量事件监听器时出错:`, error);\n                    this._boundListeners[type].bound = false;\n                }\n            }\n        }\n    }\n    /**\n     * 启动聊天变量的轮询\n     * @private\n     */\n    _startChatPolling() {\n        this._stopChatPolling();\n        if (this.currentType === 'chat') {\n            try {\n                this._chatPollingInterval = window.setInterval(async () => {\n                    await this._handleVariableUpdate('chat');\n                }, CHAT_POLLING_INTERVAL);\n            }\n            catch (error) {\n                loglevel__WEBPACK_IMPORTED_MODULE_3___default().error('[VariableManager]：启动聊天变量轮询时出错:', error);\n                this._chatPollingInterval = null;\n            }\n        }\n    }\n    /**\n     * 停止聊天变量的轮询\n     * @private\n     */\n    _stopChatPolling() {\n        if (this._chatPollingInterval !== null) {\n            try {\n                window.clearInterval(this._chatPollingInterval);\n                this._chatPollingInterval = null;\n            }\n            catch (error) {\n                loglevel__WEBPACK_IMPORTED_MODULE_3___default().error('[VariableManager]：停止聊天变量轮询时出错:', error);\n            }\n        }\n    }\n    /**\n     * 统一的变量更新处理方法\n     * 适用于所有变量类型（全局、角色、聊天、消息）\n     * @param type 变量类型\n     * @param data 可选的事件数据\n     * @private\n     */\n    async _handleVariableUpdate(type, data) {\n        if (!this.currentType || this.currentType !== type) {\n            return;\n        }\n        try {\n            let newTavernVariables;\n            let messageId;\n            if ((type === 'character' || type === 'message') && data && data.variables) {\n                newTavernVariables = data.variables;\n                messageId = data.message_id;\n            }\n            else {\n                newTavernVariables = (0,_function_variables__WEBPACK_IMPORTED_MODULE_1__.getVariables)({ type });\n            }\n            const oldVariables = this.model.getCurrentMapVariables();\n            const { added, removed, updated } = this._compareTavernVariables(oldVariables, newTavernVariables, messageId);\n            this._processDiff(added, removed, updated, newTavernVariables, messageId);\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_3___default().error(`[VariableManager]：处理${type}变量更新时出错:`, error);\n        }\n    }\n    /**\n     * 比较当前变量与新的 TavernVariables 对象\n     * @param oldVariables 当前的变量列表\n     * @param newVars 新的变量对象\n     * @param messageId 消息ID\n     * @returns 包含已添加、已删除、已更新变量名的对象\n     * @private\n     */\n    _compareTavernVariables(oldVariables, newVars, messageId) {\n        const oldVarsMap = new Map();\n        oldVariables.forEach(variable => {\n            if (messageId !== undefined) {\n                if (variable.message_id === messageId) {\n                    oldVarsMap.set(variable.name, variable.value);\n                }\n            }\n            else if (variable.message_id === undefined) {\n                oldVarsMap.set(variable.name, variable.value);\n            }\n        });\n        const oldKeys = new Set(oldVarsMap.keys());\n        const newKeys = new Set(Object.keys(newVars));\n        const added = [...newKeys].filter(key => !oldKeys.has(key));\n        const removed = [...oldKeys].filter(key => !newKeys.has(key));\n        const updated = [...newKeys].filter(key => oldKeys.has(key) && !_.isEqual(oldVarsMap.get(key), newVars[key]));\n        return { added, removed, updated };\n    }\n    /**\n     * 处理变量差异，更新 DOM 和模型\n     * @param added 新增的变量名列表\n     * @param removed 删除的变量名列表\n     * @param updated 更新的变量名列表\n     * @param newTavernVariables 新的变量数据\n     * @param messageId 消息ID\n     * @private\n     */\n    _processDiff(added, removed, updated, newTavernVariables, messageId) {\n        const addedVariables = [];\n        const removedIds = [];\n        const updatedVariables = [];\n        added.forEach(name => {\n            const variable = this.model.createVariableItem(name, newTavernVariables[name], messageId);\n            this.domUpdater.addVariableCard(variable);\n            addedVariables.push(variable);\n        });\n        removed.forEach(name => {\n            const variable = this.model.findVariableByName(name, messageId);\n            if (variable) {\n                this.domUpdater.removeVariableCard(variable.id);\n                removedIds.push(variable.id);\n            }\n        });\n        updated.forEach(name => {\n            const variable = this.model.findVariableByName(name, messageId);\n            if (variable) {\n                variable.value = newTavernVariables[name];\n                variable.dataType = _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_0__.VariableManagerUtil.inferDataType(variable.value);\n                this.domUpdater.updateVariableCard(variable);\n                updatedVariables.push(variable);\n            }\n        });\n        this.model.syncCurrentVariables(addedVariables, removedIds, updatedVariables);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvc3luYy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFFd0U7QUFDcEI7QUFFRjtBQUV2QjtBQUUzQixNQUFNLGVBQWUsR0FBMkI7SUFDOUMsTUFBTSxFQUFFLGtCQUFrQjtJQUMxQixTQUFTLEVBQUUsNkJBQTZCO0lBQ3hDLE9BQU8sRUFBRSwyQkFBMkI7SUFDcEMsSUFBSSxFQUFFLEVBQUU7Q0FDVCxDQUFDO0FBRUYsTUFBTSxxQkFBcUIsR0FBRyxJQUFJLENBQUM7QUFhNUIsTUFBTSxtQkFBbUI7SUFDdEIsVUFBVSxDQUFjO0lBQ3hCLEtBQUssQ0FBZ0I7SUFDckIsV0FBVyxHQUF3QixJQUFJLENBQUM7SUFDeEMsZUFBZSxHQUF5QztRQUM5RCxNQUFNLEVBQUUsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRSxJQUFJLENBQUMscUJBQXFCLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxRQUFRLENBQUMsRUFBRTtRQUNsRixTQUFTLEVBQUUsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRSxJQUFJLENBQUMscUJBQXFCLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxXQUFXLENBQUMsRUFBRTtRQUN4RixJQUFJLEVBQUUsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRSxJQUFJLENBQUMscUJBQXFCLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxNQUFNLENBQUMsRUFBRTtRQUM5RSxPQUFPLEVBQUUsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRSxJQUFJLENBQUMscUJBQXFCLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxTQUFTLENBQUMsRUFBRTtLQUNyRixDQUFDO0lBRU0sb0JBQW9CLEdBQWtCLElBQUksQ0FBQztJQUVuRDs7O09BR0c7SUFDSCxZQUFZLFVBQXVCLEVBQUUsS0FBb0I7UUFDdkQsSUFBSSxDQUFDLFVBQVUsR0FBRyxVQUFVLENB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RUFBRTtZQUNyQixNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLGtCQUFrQixDQUFDLElBQUksRUFBRSxTQUFTLENBQUMsQ0FBQztZQUNoRSxJQUFJLFFBQVEsRUFBRSxDQUFDO2dCQUNiLElBQUksQ0FBQyxVQUFVLENBQUMsa0JBQWtCLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxDQUFDO2dCQUNoRCxVQUFVLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQztZQUMvQixDQUFDO1FBQ0gsQ0FBQyxDQUFDLENBQUM7UUFFSCxPQUFPLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxFQUFFO1lBQ3JCLE1BQU0sUUFBUSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsa0JBQWtCLENBQUMsSUFBSSxFQUFFLFNBQVMsQ0FBQyxDQUFDO1lBQ2hFLElBQUksUUFBUSxFQUFFLENBQUM7Z0JBQ2IsUUFBUSxDQUFDLEtBQUssR0FBRyxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsQ0FBQztnQkFDMUMsUUFBUSxDQUFDLFFBQVEsR0FBRyxpRkFBbUIsQ0FBQyxhQUFhLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDO2dCQUN0RSxJQUFJLENBQUMsVUFBVSxDQUFDLGtCQUFrQixDQUFDLFFBQVEsQ0FBQyxDQUFDO2dCQUM3QyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDbEMsQ0FBQztRQUNILENBQUMsQ0FBQyxDQUFDO1FBRUgsSUFBSSxDQUFDLEtBQUssQ0FBQyxvQkFBb0IsQ0FBQyxjQUFjLEVBQUUsVUFBVSxFQUFFLGdCQUFnQixDQUFDLENBQUM7SUFDaEYsQ0FBQztDQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL3N5bmMudHM/NjdlYyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBWYXJpYWJsZU1vZGVsIH0gZnJvbSAnQC9jb21wb25lbnQvdmFyaWFibGVfbWFuYWdlci9tb2RlbCc7XG5pbXBvcnQgeyBWYXJpYWJsZUl0ZW0sIFZhcmlhYmxlVHlwZSB9IGZyb20gJ0AvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvdHlwZXMnO1xuaW1wb3J0IHsgVmFyaWFibGVNYW5hZ2VyVXRpbCB9IGZyb20gJ0AvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvdXRpbCc7XG5pbXBvcnQgeyBnZXRWYXJpYWJsZXMgfSBmcm9tICdAL2Z1bmN0aW9uL3ZhcmlhYmxlcyc7XG5cbmltcG9ydCB7IGV2ZW50U291cmNlIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5cbmltcG9ydCBsb2cgZnJvbSAnbG9nbGV2ZWwnO1xuXG5jb25zdCBWQVJJQUJMRV9FVkVOVFM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gIEdMT0JBTDogJ3NldHRpbmdzX3VwZGF0ZWQnLFxuICBDSEFSQUNURVI6ICdjaGFyYWN0ZXJfdmFyaWFibGVzX2NoYW5nZWQnLFxuICBNRVNTQUdFOiAnbWVzc2FnZV92YXJpYWJsZXNfY2hhbmdlZCcsXG4gIENIQVQ6ICcnLFxufTtcblxuY29uc3QgQ0hBVF9QT0xMSU5HX0lOVEVSVkFMID0gMjAwMDtcblxuZXhwb3J0IGludGVyZmFjZSBJRG9tVXBkYXRlciB7XG4gIGFkZFZhcmlhYmxlQ2FyZCh2YXJpYWJsZTogVmFyaWFibGVJdGVtKTogdm9pZDtcbiAgcmVtb3ZlVmFyaWFibGVDYXJkKHZhcmlhYmxlX2lkOiBzdHJpbmcpOiB2b2lkO1xuICB1cGRhdGVWYXJpYWJsZUNhcmQodmFyaWFibGU6IFZhcmlhYmxlSXRlbSk6IHZvaWQ7XG59XG5cbmludGVyZmFjZSBMaXN0ZW5lclN0YXR1cyB7XG4gIGJvdW5kOiBib29sZWFuO1xuICBoYW5kbGVyOiAoLi4uYXJnczogYW55W10pID0+IFByb21pc2U8dm9pZD47XG59XG5cbmV4cG9ydCBjbGFzcyBWYXJpYWJsZVN5bmNTZXJ2aWNlIHtcbiAgcHJpdmF0ZSBkb21VcGRhdGVyOiBJRG9tVXBkYXRlcjtcbiAgcHJpdmF0ZSBtb2RlbDogVmFyaWFibGVNb2RlbDtcbiAgcHJpdmF0ZSBjdXJyZW50VHlwZTogVmFyaWFibGVUeXBlIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgX2JvdW5kTGlzdGVuZXJzOiBSZWNvcmQ8VmFyaWFibGVUeXBlLCBMaXN0ZW5lclN0YXR1cz4gPSB7XG4gICAgZ2xvYmFsOiB7IGJvdW5kOiBmYWxzZSwgaGFuZGxlcjogdGhpcy5faGFuZGxlVmFyaWFibGVVcGRhdGUuYmluZCh0aGlzLCAnZ2xvYmFsJykgfSxcbiAgICBjaGFyYWN0ZXI6IHsgYm91bmQ6IGZhbHNlLCBoYW5kbGVyOiB0aGlzLl9oYW5kbGVWYXJpYWJsZVVwZGF0ZS5iaW5kKHRoaXMsICdjaGFyYWN0ZXInKSB9LFxuICAgIGNoYXQ6IHsgYm91bmQ6IGZhbHNlLCBoYW5kbGVyOiB0aGlzLl9oYW5kbGVWYXJpYWJsZVVwZGF0ZS5iaW5kKHRoaXMsICdjaGF0JykgfSxcbiAgICBtZXNzYWdlOiB7IGJvdW5kOiBmYWxzZSwgaGFuZGxlcjogdGhpcy5faGFuZGxlVmFyaWFibGVVcGRhdGUuYmluZCh0aGlzLCAnbWVzc2FnZScpIH0sXG4gIH07XG5cbiAgcHJpdmF0ZSBfY2hhdFBvbGxpbmdJbnRlcnZhbDogbnVtYmVyIHwgbnVsbCA9IG51bGw7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSBkb21VcGRhdGVyIERPTeabtOaWsOWZqFxuICAgKiBAcGFyYW0gbW9kZWwg5Y+Y6YeP5pWw5o2u5qih5Z6LXG4gICAqL1xuICBjb25zdHJ1Y3Rvcihkb21VcGRhdGVyOiBJRG9tVXBkYXRlciwgbW9kZWw6IFZhcmlhYmxlTW9kZWwpIHtcbiAgICB0aGlzLmRvbVVwZGF0ZXIgPSBkb21VcGRhdGVyO1xuICAgIHRoaXMubW9kZWwgPSBtb2RlbDtcbiAgfVxuXG4gIHB1YmxpYyBhc3luYyBjbGVhbnVwKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRoaXMuX3VuYmluZEFsbEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fc3RvcENoYXRQb2xsaW5nKCk7XG4gICAgdGhpcy5jdXJyZW50VHlwZSA9IG51bGw7XG4gIH1cblxuICAvKipcbiAgICog5Yid5aeL5YyW5b2T5YmN57G75Z6LXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgaW5pdEN1cnJlbnRUeXBlKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRoaXMuY3VycmVudFR5cGUgPSAnZ2xvYmFsJztcbiAgICB0aGlzLl9hY3RpdmF0ZUN1cnJlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDorr7nva7lvZPliY3lj5jph4/nsbvlnovvvIzlubbnm7jlupTlnLDliJ3lp4vljJbnm5HlkKzlmajmiJbova7or6JcbiAgICogQHBhcmFtIHR5cGUg5Y+Y6YeP57G75Z6LXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgc2V0Q3VycmVudFR5cGUodHlwZTogVmFyaWFibGVUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgaWYgKHRoaXMuY3VycmVudFR5cGUgIT09IHR5cGUpIHtcbiAgICAgIHRoaXMuX2RlYWN0aXZhdGVDdXJyZW50TGlzdGVuZXJzKCk7XG4gICAgICB0aGlzLmN1cnJlbnRUeXBlID0gdHlwZTtcbiAgICAgIHRoaXMuX2FjdGl2YXRlQ3VycmVudExpc3RlbmVycygpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDph43mlrDmv4DmtLvlvZPliY3nsbvlnovnmoTnm5HlkKzlmajvvIjnlKjkuo7moIfnrb7pobXph43mlrDmv4DmtLvnrYnlnLrmma/vvIlcbiAgICovXG4gIHB1YmxpYyByZWFjdGl2YXRlTGlzdGVuZXJzKCk6IHZvaWQge1xuICAgIHRoaXMuX2RlYWN0aXZhdGVDdXJyZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fYWN0aXZhdGVDdXJyZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICAvKipcbiAgICog5YGc55So5b2T5YmN55qE5LqL5Lu255uR5ZCs5Zmo5oiW6L2u6K+iXG4gICAqL1xuICBwdWJsaWMgZGVhY3RpdmF0ZUxpc3RlbmVycygpOiB2b2lkIHtcbiAgICB0aGlzLl9kZWFjdGl2YXRlQ3VycmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgLyoqXG4gICAqIOa/gOa0u+W9k+WJjeexu+Wei+eahOebkeWQrOWZqOaIlui9ruivolxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcHJpdmF0ZSBfYWN0aXZhdGVDdXJyZW50TGlzdGVuZXJzKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmN1cnJlbnRUeXBlKSB7XG4gICAgICBpZiAodGhpcy5jdXJyZW50VHlwZSA9PT0gJ2NoYXQnKSB7XG4gICAgICAgIHRoaXMuX3N0YXJ0Q2hhdFBvbGxpbmcoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX2JpbmRWYXJpYWJsZUxpc3RlbmVyKHRoaXMuY3VycmVudFR5cGUpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDlgZznlKjlvZPliY3nmoTnm5HlkKzlmajmiJbova7or6JcbiAgICogQHByaXZhdGVcbiAgICovXG4gIHByaXZhdGUgX2RlYWN0aXZhdGVDdXJyZW50TGlzdGVuZXJzKCk6IHZvaWQge1xuICAgIHRoaXMuX3VuYmluZEFsbEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fc3RvcENoYXRQb2xsaW5nKCk7XG4gIH1cblxuICAvKipcbiAgICog57uf5LiA55qE5Y+Y6YeP55uR5ZCs5Zmo57uR5a6a5pa55rOVXG4gICAqIEBwYXJhbSB0eXBlIOWPmOmHj+exu+Wei1xuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcHJpdmF0ZSBfYmluZFZhcmlhYmxlTGlzdGVuZXIodHlwZTogVmFyaWFibGVUeXBlKTogdm9pZCB7XG4gICAgaWYgKHR5cGUgPT09ICdjaGF0JykgcmV0dXJuO1xuXG4gICAgY29uc3QgZXZlbnROYW1lID0gVkFSSUFCTEVfRVZFTlRTW3R5cGUudG9VcHBlckNhc2UoKV07XG4gICAgY29uc3QgbGlzdGVuZXJTdGF0dXMgPSB0aGlzLl9ib3VuZExpc3RlbmVyc1t0eXBlXTtcblxuICAgIGlmICghbGlzdGVuZXJTdGF0dXMuYm91bmQgJiYgZXZlbnROYW1lKSB7XG4gICAgICB0cnkge1xuICAgICAgICBldmVudFNvdXJjZS5vbihldmVudE5hbWUsIGxpc3RlbmVyU3RhdHVzLmhhbmRsZXIpO1xuICAgICAgICB0aGlzLl9ib3VuZExpc3RlbmVyc1t0eXBlXS5ib3VuZCA9IHRydWU7XG4gICAgICAgIGxvZy5pbmZvKGBbVmFyaWFibGVNYW5hZ2VyXe+8muW8gOWni+WQjOatpeebkeWQrCR7dHlwZX3lj5jph49gKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGxvZy5lcnJvcihgW1ZhcmlhYmxlTWFuYWdlcl3vvJrnu5Hlrpoke3R5cGV95Y+Y6YeP5LqL5Lu255uR5ZCs5Zmo5pe25Ye66ZSZOmAsIGVycm9yKTtcbiAgICAgICAgdGhpcy5fYm91bmRMaXN0ZW5lcnNbdHlwZV0uYm91bmQgPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog6Kej57uR5omA5pyJ5LqL5Lu255uR5ZCs5ZmoXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBwcml2YXRlIF91bmJpbmRBbGxFdmVudExpc3RlbmVycygpOiB2b2lkIHtcbiAgICBmb3IgKGNvbnN0IHR5cGUgb2YgT2JqZWN0LmtleXModGhpcy5fYm91bmRMaXN0ZW5lcnMpIGFzIFZhcmlhYmxlVHlwZVtdKSB7XG4gICAgICBpZiAodHlwZSA9PT0gJ2NoYXQnKSBjb250aW51ZTtcblxuICAgICAgY29uc3QgZXZlbnROYW1lID0gVkFSSUFCTEVfRVZFTlRTW3R5cGUudG9VcHBlckNhc2UoKV07XG4gICAgICBjb25zdCBsaXN0ZW5lclN0YXR1cyA9IHRoaXMuX2JvdW5kTGlzdGVuZXJzW3R5cGVdO1xuXG4gICAgICBpZiAobGlzdGVuZXJTdGF0dXMuYm91bmQgJiYgZXZlbnROYW1lKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgZXZlbnRTb3VyY2UucmVtb3ZlTGlzdGVuZXIoZXZlbnROYW1lLCBsaXN0ZW5lclN0YXR1cy5oYW5kbGVyKTtcbiAgICAgICAgICB0aGlzLl9ib3VuZExpc3RlbmVyc1t0eXBlXS5ib3VuZCA9IGZhbHNlO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGxvZy5lcnJvcihgW1ZhcmlhYmxlTWFuYWdlcl3vvJrop6Pnu5Eke3R5cGV95Y+Y6YeP5LqL5Lu255uR5ZCs5Zmo5pe25Ye66ZSZOmAsIGVycm9yKTtcbiAgICAgICAgICB0aGlzLl9ib3VuZExpc3RlbmVyc1t0eXBlXS5ib3VuZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWQr+WKqOiBiuWkqeWPmOmHj+eahOi9ruivolxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcHJpdmF0ZSBfc3RhcnRDaGF0UG9sbGluZygpOiB2b2lkIHtcbiAgICB0aGlzLl9zdG9wQ2hhdFBvbGxpbmcoKTtcblxuICAgIGlmICh0aGlzLmN1cnJlbnRUeXBlID09PSAnY2hhdCcpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHRoaXMuX2NoYXRQb2xsaW5nSW50ZXJ2YWwgPSB3aW5kb3cuc2V0SW50ZXJ2YWwoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgIGF3YWl0IHRoaXMuX2hhbmRsZVZhcmlhYmxlVXBkYXRlKCdjaGF0Jyk7XG4gICAgICAgIH0sIENIQVRfUE9MTElOR19JTlRFUlZBTCk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBsb2cuZXJyb3IoJ1tWYXJpYWJsZU1hbmFnZXJd77ya5ZCv5Yqo6IGK5aSp5Y+Y6YeP6L2u6K+i5pe25Ye66ZSZOicsIGVycm9yKTtcbiAgICAgICAgdGhpcy5fY2hhdFBvbGxpbmdJbnRlcnZhbCA9IG51bGw7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWBnOatouiBiuWkqeWPmOmHj+eahOi9ruivolxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcHJpdmF0ZSBfc3RvcENoYXRQb2xsaW5nKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLl9jaGF0UG9sbGluZ0ludGVydmFsICE9PSBudWxsKSB7XG4gICAgICB0cnkge1xuICAgICAgICB3aW5kb3cuY2xlYXJJbnRlcnZhbCh0aGlzLl9jaGF0UG9sbGluZ0ludGVydmFsKTtcbiAgICAgICAgdGhpcy5fY2hhdFBvbGxpbmdJbnRlcnZhbCA9IG51bGw7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBsb2cuZXJyb3IoJ1tWYXJpYWJsZU1hbmFnZXJd77ya5YGc5q2i6IGK5aSp5Y+Y6YeP6L2u6K+i5pe25Ye66ZSZOicsIGVycm9yKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog57uf5LiA55qE5Y+Y6YeP5pu05paw5aSE55CG5pa55rOVXG4gICAqIOmAgueUqOS6juaJgOacieWPmOmHj+exu+Wei++8iOWFqOWxgOOAgeinkuiJsuOAgeiBiuWkqeOAgea2iOaBr++8iVxuICAgKiBAcGFyYW0gdHlwZSDlj5jph4/nsbvlnotcbiAgICogQHBhcmFtIGRhdGEg5Y+v6YCJ55qE5LqL5Lu25pWw5o2uXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIF9oYW5kbGVWYXJpYWJsZVVwZGF0ZSh0eXBlOiBWYXJpYWJsZVR5cGUsIGRhdGE/OiBhbnkpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAoIXRoaXMuY3VycmVudFR5cGUgfHwgdGhpcy5jdXJyZW50VHlwZSAhPT0gdHlwZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBsZXQgbmV3VGF2ZXJuVmFyaWFibGVzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xuICAgICAgbGV0IG1lc3NhZ2VJZDogbnVtYmVyIHwgdW5kZWZpbmVkO1xuXG4gICAgICBpZiAoKHR5cGUgPT09ICdjaGFyYWN0ZXInIHx8IHR5cGUgPT09ICdtZXNzYWdlJykgJiYgZGF0YSAmJiBkYXRhLnZhcmlhYmxlcykge1xuICAgICAgICBuZXdUYXZlcm5WYXJpYWJsZXMgPSBkYXRhLnZhcmlhYmxlcztcbiAgICAgICAgbWVzc2FnZUlkID0gZGF0YS5tZXNzYWdlX2lkO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbmV3VGF2ZXJuVmFyaWFibGVzID0gZ2V0VmFyaWFibGVzKHsgdHlwZSB9KTtcbiAgICAgIH1cblxuICAgICAgY29uc3Qgb2xkVmFyaWFibGVzID0gdGhpcy5tb2RlbC5nZXRDdXJyZW50TWFwVmFyaWFibGVzKCk7XG5cbiAgICAgIGNvbnN0IHsgYWRkZWQsIHJlbW92ZWQsIHVwZGF0ZWQgfSA9IHRoaXMuX2NvbXBhcmVUYXZlcm5WYXJpYWJsZXMob2xkVmFyaWFibGVzLCBuZXdUYXZlcm5WYXJpYWJsZXMsIG1lc3NhZ2VJZCk7XG5cbiAgICAgIHRoaXMuX3Byb2Nlc3NEaWZmKGFkZGVkLCByZW1vdmVkLCB1cGRhdGVkLCBuZXdUYXZlcm5WYXJpYWJsZXMsIG1lc3NhZ2VJZCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZy5lcnJvcihgW1ZhcmlhYmxlTWFuYWdlcl3vvJrlpITnkIYke3R5cGV95Y+Y6YeP5pu05paw5pe25Ye66ZSZOmAsIGVycm9yKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5q+U6L6D5b2T5YmN5Y+Y6YeP5LiO5paw55qEIFRhdmVyblZhcmlhYmxlcyDlr7nosaFcbiAgICogQHBhcmFtIG9sZFZhcmlhYmxlcyDlvZPliY3nmoTlj5jph4/liJfooahcbiAgICogQHBhcmFtIG5ld1ZhcnMg5paw55qE5Y+Y6YeP5a+56LGhXG4gICAqIEBwYXJhbSBtZXNzYWdlSWQg5raI5oGvSURcbiAgICogQHJldHVybnMg5YyF5ZCr5bey5re75Yqg44CB5bey5Yig6Zmk44CB5bey5pu05paw5Y+Y6YeP5ZCN55qE5a+56LGhXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBwcml2YXRlIF9jb21wYXJlVGF2ZXJuVmFyaWFibGVzKFxuICAgIG9sZFZhcmlhYmxlczogVmFyaWFibGVJdGVtW10sXG4gICAgbmV3VmFyczogUmVjb3JkPHN0cmluZywgYW55PixcbiAgICBtZXNzYWdlSWQ/OiBudW1iZXIsXG4gICk6IHsgYWRkZWQ6IHN0cmluZ1tdOyByZW1vdmVkOiBzdHJpbmdbXTsgdXBkYXRlZDogc3RyaW5nW10gfSB7XG4gICAgY29uc3Qgb2xkVmFyc01hcCA9IG5ldyBNYXA8c3RyaW5nLCBhbnk+KCk7XG5cbiAgICBvbGRWYXJpYWJsZXMuZm9yRWFjaCh2YXJpYWJsZSA9PiB7XG4gICAgICBpZiAobWVzc2FnZUlkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgaWYgKHZhcmlhYmxlLm1lc3NhZ2VfaWQgPT09IG1lc3NhZ2VJZCkge1xuICAgICAgICAgIG9sZFZhcnNNYXAuc2V0KHZhcmlhYmxlLm5hbWUsIHZhcmlhYmxlLnZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmICh2YXJpYWJsZS5tZXNzYWdlX2lkID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgb2xkVmFyc01hcC5zZXQodmFyaWFibGUubmFtZSwgdmFyaWFibGUudmFsdWUpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgY29uc3Qgb2xkS2V5cyA9IG5ldyBTZXQob2xkVmFyc01hcC5rZXlzKCkpO1xuICAgIGNvbnN0IG5ld0tleXMgPSBuZXcgU2V0KE9iamVjdC5rZXlzKG5ld1ZhcnMpKTtcblxuICAgIGNvbnN0IGFkZGVkID0gWy4uLm5ld0tleXNdLmZpbHRlcihrZXkgPT4gIW9sZEtleXMuaGFzKGtleSkpO1xuICAgIGNvbnN0IHJlbW92ZWQgPSBbLi4ub2xkS2V5c10uZmlsdGVyKGtleSA9PiAhbmV3S2V5cy5oYXMoa2V5KSk7XG4gICAgY29uc3QgdXBkYXRlZCA9IFsuLi5uZXdLZXlzXS5maWx0ZXIoa2V5ID0+IG9sZEtleXMuaGFzKGtleSkgJiYgIV8uaXNFcXVhbChvbGRWYXJzTWFwLmdldChrZXkpLCBuZXdWYXJzW2tleV0pKTtcblxuICAgIHJldHVybiB7IGFkZGVkLCByZW1vdmVkLCB1cGRhdGVkIH07XG4gIH1cblxuICAvKipcbiAgICog5aSE55CG5Y+Y6YeP5beu5byC77yM5pu05pawIERPTSDlkozmqKHlnotcbiAgICogQHBhcmFtIGFkZGVkIOaWsOWinueahOWPmOmHj+WQjeWIl+ihqFxuICAgKiBAcGFyYW0gcmVtb3ZlZCDliKDpmaTnmoTlj5jph4/lkI3liJfooahcbiAgICogQHBhcmFtIHVwZGF0ZWQg5pu05paw55qE5Y+Y6YeP5ZCN5YiX6KGoXG4gICAqIEBwYXJhbSBuZXdUYXZlcm5WYXJpYWJsZXMg5paw55qE5Y+Y6YeP5pWw5o2uXG4gICAqIEBwYXJhbSBtZXNzYWdlSWQg5raI5oGvSURcbiAgICogQHByaXZhdGVcbiAgICovXG4gIHByaXZhdGUgX3Byb2Nlc3NEaWZmKFxuICAgIGFkZGVkOiBzdHJpbmdbXSxcbiAgICByZW1vdmVkOiBzdHJpbmdbXSxcbiAgICB1cGRhdGVkOiBzdHJpbmdbXSxcbiAgICBuZXdUYXZlcm5WYXJpYWJsZXM6IFJlY29yZDxzdHJpbmcsIGFueT4sXG4gICAgbWVzc2FnZUlkPzogbnVtYmVyLFxuICApOiB2b2lkIHtcbiAgICBjb25zdCBhZGRlZFZhcmlhYmxlczogVmFyaWFibGVJdGVtW10gPSBbXTtcbiAgICBjb25zdCByZW1vdmVkSWRzOiBzdHJpbmdbXSA9IFtdO1xuICAgIGNvbnN0IHVwZGF0ZWRWYXJpYWJsZXM6IFZhcmlhYmxlSXRlbVtdID0gW107XG5cbiAgICBhZGRlZC5mb3JFYWNoKG5hbWUgPT4ge1xuICAgICAgY29uc3QgdmFyaWFibGUgPSB0aGlzLm1vZGVsLmNyZWF0ZVZhcmlhYmxlSXRlbShuYW1lLCBuZXdUYXZlcm5WYXJpYWJsZXNbbmFtZV0sIG1lc3NhZ2VJZCk7XG4gICAgICB0aGlzLmRvbVVwZGF0ZXIuYWRkVmFyaWFibGVDYXJkKHZhcmlhYmxlKTtcbiAgICAgIGFkZGVkVmFyaWFibGVzLnB1c2godmFyaWFibGUpO1xuICAgIH0pO1xuXG4gICAgcmVtb3ZlZC5mb3JFYWNoKG5hbWUgPT4ge1xuICAgICAgY29uc3QgdmFyaWFibGUgPSB0aGlzLm1vZGVsLmZpbmRWYXJpYWJsZUJ5TmFtZShuYW1lLCBtZXNzYWdlSWQpO1xuICAgICAgaWYgKHZhcmlhYmxlKSB7XG4gICAgICAgIHRoaXMuZG9tVXBkYXRlci5yZW1vdmVWYXJpYWJsZUNhcmQodmFyaWFibGUuaWQpO1xuICAgICAgICByZW1vdmVkSWRzLnB1c2godmFyaWFibGUuaWQpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgdXBkYXRlZC5mb3JFYWNoKG5hbWUgPT4ge1xuICAgICAgY29uc3QgdmFyaWFibGUgPSB0aGlzLm1vZGVsLmZpbmRWYXJpYWJsZUJ5TmFtZShuYW1lLCBtZXNzYWdlSWQpO1xuICAgICAgaWYgKHZhcmlhYmxlKSB7XG4gICAgICAgIHZhcmlhYmxlLnZhbHVlID0gbmV3VGF2ZXJuVmFyaWFibGVzW25hbWVdO1xuICAgICAgICB2YXJpYWJsZS5kYXRhVHlwZSA9IFZhcmlhYmxlTWFuYWdlclV0aWwuaW5mZXJEYXRhVHlwZSh2YXJpYWJsZS52YWx1ZSk7XG4gICAgICAgIHRoaXMuZG9tVXBkYXRlci51cGRhdGVWYXJpYWJsZUNhcmQodmFyaWFibGUpO1xuICAgICAgICB1cGRhdGVkVmFyaWFibGVzLnB1c2godmFyaWFibGUpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgdGhpcy5tb2RlbC5zeW5jQ3VycmVudFZhcmlhYmxlcyhhZGRlZFZhcmlhYmxlcywgcmVtb3ZlZElkcywgdXBkYXRlZFZhcmlhYmxlcyk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/component/variable_manager/sync.ts\n")},"./src/component/variable_manager/util.ts":
/*!************************************************!*\
  !*** ./src/component/variable_manager/util.ts ***!
  \************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VariableManagerUtil: () => (/* binding */ VariableManagerUtil)\n/* harmony export */ });\n/**\n * 变量管理器通用工具类\n */\nclass VariableManagerUtil {\n    /**\n     * 从值推断变量数据类型\n     * @param value 要推断类型的值\n     * @returns 推断出的变量数据类型\n     */\n    static inferDataType(value) {\n        if (Array.isArray(value)) {\n            return 'array';\n        }\n        else if (typeof value === 'boolean') {\n            return 'boolean';\n        }\n        else if (typeof value === 'number') {\n            return 'number';\n        }\n        else if (typeof value === 'object' && value !== null) {\n            return 'object';\n        }\n        return 'string';\n    }\n    /**\n     * 获取数据类型的默认值\n     * @param dataType 数据类型\n     * @returns 默认值\n     */\n    static getDefaultValueForType(dataType) {\n        switch (dataType) {\n            case 'string':\n                return '';\n            case 'number':\n                return 0;\n            case 'boolean':\n                return false;\n            case 'array':\n                return [];\n            case 'object':\n                return {};\n            default:\n                return '';\n        }\n    }\n    /**\n     * 生成唯一的键名\n     * @param existingKeys 已存在的键名集合\n     * @param baseName 基础键名，默认为 'newKey'\n     * @returns 唯一键名\n     */\n    static generateUniqueKey(existingKeys, baseName = 'newKey') {\n        let newKey = baseName;\n        let counter = 1;\n        while (existingKeys.has(newKey)) {\n            newKey = `${baseName}${counter}`;\n            counter++;\n        }\n        return newKey;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvdXRpbC50cyIsIm1hcHBpbmdzIjoiOzs7O0FBRUE7O0dBRUc7QUFDSSxNQUFNLG1CQUFtQjtJQUM5Qjs7OztPQUlHO0lBQ0ksTUFBTSxDQUFDLGFBQWEsQ0FBQyxLQUFVO1FBQ3BDLElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDO1lBQ3pCLE9BQU8sT0FBTyxDQUFDO1FBQ2pCLENBQUM7YUFBTSxJQUFJLE9BQU8sS0FBSyxLQUFLLFNBQVMsRUFBRSxDQUFDO1lBQ3RDLE9BQU8sU0FBUyxDQUFDO1FBQ25CLENBQUM7YUFBTSxJQUFJLE9BQU8sS0FBSyxLQUFLLFFBQVEsRUFBRSxDQUFDO1lBQ3JDLE9BQU8sUUFBUSxDQUFDO1FBQ2xCLENBQUM7YUFBTSxJQUFJLE9BQU8sS0FBSyxLQUFLLFFBQVEsSUFBSSxLQUFLLEtBQUssSUFBSSxFQUFFLENBQUM7WUFDdkQsT0FBTyxRQUFRLENBQUM7UUFDbEIsQ0FBQztRQUNELE9BQU8sUUFBUSxDQUFDO0lBQ2xCLENBQUM7SUFFRDs7OztPQUlHO0lBQ0ksTUFBTSxDQUFDLHNCQUFzQixDQUFDLFFBQTBCO1FBQzdELFFBQVEsUUFBUSxFQUFFLENBQUM7WUFDakIsS0FBSyxRQUFRO2dCQUNYLE9BQU8sRUFBRSxDQUFDO1lBQ1osS0FBSyxRQUFRO2dCQUNYLE9BQU8sQ0FBQyxDQUFDO1lBQ1gsS0FBSyxTQUFTO2dCQUNaLE9BQU8sS0FBSyxDQUFDO1lBQ2YsS0FBSyxPQUFPO2dCQUNWLE9BQU8sRUFBRSxDQUFDO1lBQ1osS0FBSyxRQUFRO2dCQUNYLE9BQU8sRUFBRSxDQUFDO1lBQ1o7Z0JBQ0UsT0FBTyxFQUFFLENBQUM7UUFDZCxDQUFDO0lBQ0gsQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0ksTUFBTSxDQUFDLGlCQUFpQixDQUFDLFlBQXlCLEVBQUUsV0FBbUIsUUFBUTtRQUNwRixJQUFJLE1BQU0sR0FBRyxRQUFRLENBQUM7UUFDdEIsSUFBSSxPQUFPLEdBQUcsQ0FBQyxDQUFDO1FBQ2hCLE9BQU8sWUFBWSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDO1lBQ2hDLE1BQU0sR0FBRyxHQUFHLFFBQVEsR0FBRyxPQUFPLEVBQUUsQ0FBQztZQUNqQyxPQUFPLEVBQUUsQ0FBQztRQUNaLENBQUM7UUFDRCxPQUFPLE1BQU0sQ0FBQztJQUNoQixDQUFDO0NBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvdXRpbC50cz81ZWQ3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFZhcmlhYmxlRGF0YVR5cGUgfSBmcm9tICdAL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL3R5cGVzJztcblxuLyoqXG4gKiDlj5jph4/nrqHnkIblmajpgJrnlKjlt6XlhbfnsbtcbiAqL1xuZXhwb3J0IGNsYXNzIFZhcmlhYmxlTWFuYWdlclV0aWwge1xuICAvKipcbiAgICog5LuO5YC85o6o5pat5Y+Y6YeP5pWw5o2u57G75Z6LXG4gICAqIEBwYXJhbSB2YWx1ZSDopoHmjqjmlq3nsbvlnovnmoTlgLxcbiAgICogQHJldHVybnMg5o6o5pat5Ye655qE5Y+Y6YeP5pWw5o2u57G75Z6LXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGluZmVyRGF0YVR5cGUodmFsdWU6IGFueSk6IFZhcmlhYmxlRGF0YVR5cGUge1xuICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgcmV0dXJuICdhcnJheSc7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICdib29sZWFuJykge1xuICAgICAgcmV0dXJuICdib29sZWFuJztcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHtcbiAgICAgIHJldHVybiAnbnVtYmVyJztcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgIT09IG51bGwpIHtcbiAgICAgIHJldHVybiAnb2JqZWN0JztcbiAgICB9XG4gICAgcmV0dXJuICdzdHJpbmcnO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluaVsOaNruexu+Wei+eahOm7mOiupOWAvFxuICAgKiBAcGFyYW0gZGF0YVR5cGUg5pWw5o2u57G75Z6LXG4gICAqIEByZXR1cm5zIOm7mOiupOWAvFxuICAgKi9cbiAgcHVibGljIHN0YXRpYyBnZXREZWZhdWx0VmFsdWVGb3JUeXBlKGRhdGFUeXBlOiBWYXJpYWJsZURhdGFUeXBlKTogYW55IHtcbiAgICBzd2l0Y2ggKGRhdGFUeXBlKSB7XG4gICAgICBjYXNlICdzdHJpbmcnOlxuICAgICAgICByZXR1cm4gJyc7XG4gICAgICBjYXNlICdudW1iZXInOlxuICAgICAgICByZXR1cm4gMDtcbiAgICAgIGNhc2UgJ2Jvb2xlYW4nOlxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICBjYXNlICdhcnJheSc6XG4gICAgICAgIHJldHVybiBbXTtcbiAgICAgIGNhc2UgJ29iamVjdCc6XG4gICAgICAgIHJldHVybiB7fTtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiAnJztcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog55Sf5oiQ5ZSv5LiA55qE6ZSu5ZCNXG4gICAqIEBwYXJhbSBleGlzdGluZ0tleXMg5bey5a2Y5Zyo55qE6ZSu5ZCN6ZuG5ZCIXG4gICAqIEBwYXJhbSBiYXNlTmFtZSDln7rnoYDplK7lkI3vvIzpu5jorqTkuLogJ25ld0tleSdcbiAgICogQHJldHVybnMg5ZSv5LiA6ZSu5ZCNXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGdlbmVyYXRlVW5pcXVlS2V5KGV4aXN0aW5nS2V5czogU2V0PHN0cmluZz4sIGJhc2VOYW1lOiBzdHJpbmcgPSAnbmV3S2V5Jyk6IHN0cmluZyB7XG4gICAgbGV0IG5ld0tleSA9IGJhc2VOYW1lO1xuICAgIGxldCBjb3VudGVyID0gMTtcbiAgICB3aGlsZSAoZXhpc3RpbmdLZXlzLmhhcyhuZXdLZXkpKSB7XG4gICAgICBuZXdLZXkgPSBgJHtiYXNlTmFtZX0ke2NvdW50ZXJ9YDtcbiAgICAgIGNvdW50ZXIrKztcbiAgICB9XG4gICAgcmV0dXJuIG5ld0tleTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/component/variable_manager/util.ts\n")},"./src/component/variable_manager/view.ts":
/*!************************************************!*\
  !*** ./src/component/variable_manager/view.ts ***!
  \************************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VariableView: () => (/* binding */ VariableView)\n/* harmony export */ });\n/* harmony import */ var _component_variable_manager_card__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/variable_manager/card */ \"./src/component/variable_manager/card.ts\");\n/* harmony import */ var _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/component/variable_manager/util */ \"./src/component/variable_manager/util.ts\");\n/* harmony import */ var _function_util__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/function/util */ \"./src/function/util.ts\");\n/* harmony import */ var _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/scripts/popup */ \"@sillytavern/scripts/popup\");\n/* harmony import */ var _sillytavern_scripts_RossAscends_mods__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sillytavern/scripts/RossAscends-mods */ \"@sillytavern/scripts/RossAscends-mods\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_6__);\n\n\n\n\n\n\n\nclass VariableView {\n    /**\n     * 最小浮窗宽度（像素）\n     */\n    static MIN_DIALOG_WIDTH = 300;\n    /**\n     * 最小浮窗高度（像素）\n     */\n    static MIN_DIALOG_HEIGHT = 250;\n    /**\n     * UI容器\n     */\n    container;\n    /**\n     * 变量卡片\n     */\n    cardFactory;\n    /**\n     * 浮窗元素\n     */\n    dialog = null;\n    /**\n     * 控制器引用\n     */\n    controller = null;\n    /**\n     * @param container 变量管理器容器\n     */\n    constructor(container) {\n        this.container = container;\n        this.cardFactory = new _component_variable_manager_card__WEBPACK_IMPORTED_MODULE_0__.VariableCardFactory(this.showVariableTypeDialog.bind(this));\n    }\n    /**\n     * 设置控制器引用\n     * @param controller 变量控制器\n     */\n    setController(controller) {\n        this.controller = controller;\n    }\n    /**\n     * 初始化UI\n     */\n    initUI() {\n        this.container.find('#global-tab').addClass('active');\n        this.container.find('#global-content').addClass('active');\n        // 初始化时隐藏楼层筛选控件（仅在消息标签页时才显示）\n        this.container.find('#floor-filter-container').hide();\n        this.initSortable();\n        this.initFloorFilter();\n    }\n    /**\n     * 初始化可排序功能\n     */\n    initSortable() {\n        this.container.find('.list-items-container').sortable({\n            delay: (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_5__.getSortableDelay)(),\n            handle: '.drag-handle',\n            stop: function (_event, ui) {\n                const listContainer = $(ui.item).closest('.list-items-container');\n                const items = [];\n                listContainer.find('.variable-content-input').each(function () {\n                    items.push($(this).val());\n                });\n                const processedItems = _.uniqBy(items, item => item.trim().toLowerCase());\n                if (!_.isEqual(items, processedItems)) {\n                    listContainer.empty();\n                    processedItems.forEach(item => {\n                        const itemHtml = `\n              <div class=\"list-item\">\n                <span class=\"drag-handle\">☰</span>\n                <textarea class=\"variable-content-input\">${item}</textarea>\n                <button class=\"list-item-delete\"><i class=\"fa-solid fa-times\"></i></button>\n              </div>\n            `;\n                        listContainer.append(itemHtml);\n                    });\n                }\n                listContainer.trigger('sortupdate');\n            },\n        });\n    }\n    /**\n     * 初始化楼层筛选功能\n     */\n    initFloorFilter() {\n        this.container.find('#floor-filter-btn').on('click', () => {\n            const minInput = this.container.find('#floor-min').val();\n            const maxInput = this.container.find('#floor-max').val();\n            // 允许空值，但如果有值就必须是有效数字\n            const minVal = minInput.trim() ? parseInt(minInput, 10) : null;\n            const maxVal = maxInput.trim() ? parseInt(maxInput, 10) : null;\n            // 验证数字有效性\n            if ((minInput.trim() && isNaN(minVal)) || (maxInput.trim() && isNaN(maxVal))) {\n                this.showFloorFilterError('请输入有效的楼层数值');\n                return;\n            }\n            // 验证楼层不能小于0\n            if (minVal !== null && minVal < 0) {\n                this.showFloorFilterError('最小楼层不能小于0');\n                return;\n            }\n            if (maxVal !== null && maxVal < 0) {\n                this.showFloorFilterError('最大楼层不能小于0');\n                return;\n            }\n            // 验证范围逻辑：只有当两个值都存在时才比较大小\n            if (minVal !== null && maxVal !== null && maxVal < minVal) {\n                this.showFloorFilterError('最大楼层不能小于最小楼层');\n                return;\n            }\n            // 至少需要设置一个值\n            if (minVal === null && maxVal === null) {\n                this.showFloorFilterError('请至少设置最小楼层或最大楼层');\n                return;\n            }\n            this.hideFloorFilterError();\n        });\n        this.container.find('#floor-min, #floor-max').on('input', () => {\n            const minInput = this.container.find('#floor-min').val();\n            const maxInput = this.container.find('#floor-max').val();\n            const minVal = minInput.trim() ? parseInt(minInput, 10) : null;\n            const maxVal = maxInput.trim() ? parseInt(maxInput, 10) : null;\n            // 实时验证楼层不能小于0\n            if (minVal !== null && minVal < 0) {\n                this.showFloorFilterError('最小楼层不能小于0');\n                return;\n            }\n            if (maxVal !== null && maxVal < 0) {\n                this.showFloorFilterError('最大楼层不能小于0');\n                return;\n            }\n            // 实时验证范围逻辑\n            if (minVal !== null && maxVal !== null && !isNaN(minVal) && !isNaN(maxVal) && maxVal < minVal) {\n                this.showFloorFilterError('最大楼层不能小于最小楼层');\n            }\n            else {\n                this.hideFloorFilterError();\n            }\n        });\n    }\n    /**\n     * 显示楼层筛选错误信息\n     * @param message 错误信息\n     */\n    showFloorFilterError(message) {\n        const $errorEl = this.container.find('#floor-filter-error');\n        $errorEl.text(message).show();\n    }\n    /**\n     * 隐藏楼层筛选错误信息\n     */\n    hideFloorFilterError() {\n        this.container.find('#floor-filter-error').hide();\n    }\n    /**\n     * 更新楼层筛选输入框的值\n     * @param min 最小楼层值\n     * @param max 最大楼层值\n     */\n    updateFloorRangeInputs(min, max) {\n        this.container.find('#floor-min').val(min !== null ? min.toString() : '');\n        this.container.find('#floor-max').val(max !== null ? max.toString() : '');\n        this.hideFloorFilterError();\n    }\n    /**\n     * 获取当前活动的变量类型\n     * @returns 当前活动的变量类型\n     */\n    getActiveVariableType() {\n        return this.container.find('.tab-item.active').attr('id')?.replace('-tab', '') || 'chat';\n    }\n    /**\n     * 设置活动标签页\n     * @param type 要激活的变量类型\n     */\n    setActiveTab(type) {\n        this.container.find('.tab-item').removeClass('active');\n        this.container.find('.tab-content').removeClass('active');\n        this.container.find(`#${type}-tab`).addClass('active');\n        this.container.find(`#${type}-content`).addClass('active');\n        const $floorFilterContainer = this.container.find('#floor-filter-container');\n        if (type === 'message') {\n            $floorFilterContainer.show();\n            const [minFloor, maxFloor] = this.getFloorRange();\n            // 如果楼层范围为空，设置默认范围\n            if (minFloor === null && maxFloor === null) {\n                const lastMessageId = (0,_function_util__WEBPACK_IMPORTED_MODULE_2__.getLastMessageId)();\n                const newMinFloor = Math.max(0, lastMessageId - 4);\n                const newMaxFloor = lastMessageId;\n                this.controller.model.updateFloorRange(newMinFloor, newMaxFloor);\n                this.updateFloorRangeInputs(newMinFloor, newMaxFloor);\n            }\n        }\n        else {\n            $floorFilterContainer.hide();\n        }\n    }\n    getFloorRange() {\n        const minVal = this.container.find('#floor-min').val();\n        const maxVal = this.container.find('#floor-max').val();\n        let minFloor = minVal && minVal.trim() ? parseInt(minVal, 10) : null;\n        let maxFloor = maxVal && maxVal.trim() ? parseInt(maxVal, 10) : null;\n        // 确保楼层不小于0\n        if (minFloor !== null) {\n            minFloor = Math.max(0, minFloor);\n        }\n        if (maxFloor !== null) {\n            maxFloor = Math.max(0, maxFloor);\n        }\n        return [\n            minFloor !== null && !isNaN(minFloor) ? minFloor : null,\n            maxFloor !== null && !isNaN(maxFloor) ? maxFloor : null,\n        ];\n    }\n    /**\n     * 刷新变量卡片\n     * @param type 变量类型\n     * @param variables 过滤后的变量列表\n     */\n    refreshVariableCards(type, variables) {\n        // 更新标签文本\n        this.container.find('.variable-type-label').text(`${type}变量`);\n        // 获取当前活动的内容容器\n        const activeContent = this.container.find(`#${type}-content`);\n        const $variableList = activeContent.find('.variable-list');\n        const scrollTop = $variableList.scrollTop() || 0;\n        $variableList.empty();\n        if (variables.length === 0) {\n            $variableList.html('<div class=\"empty-state\"><p>暂无变量</p></div>');\n            return;\n        }\n        // 根据变量类型选择不同的渲染方式\n        if (type === 'message') {\n            this.renderMessageVariablesByFloor($variableList, variables);\n            $variableList.scrollTop(scrollTop);\n        }\n        else {\n            for (const variable of variables) {\n                const card = this.cardFactory.createCard(variable);\n                $variableList.append(card);\n            }\n            $variableList.scrollTop(scrollTop);\n        }\n    }\n    /**\n     * 应用筛选\n     * @param filterState 筛选状态\n     * @param searchKeyword 搜索关键字\n     */\n    applyClientSideFilters(filterState, searchKeyword) {\n        const activeType = this.getActiveVariableType();\n        const $variableCards = this.container.find(`#${activeType}-content .variable-card`);\n        let visibleCount = 0;\n        $variableCards.each((_, card) => {\n            const $card = $(card);\n            const cardType = $card.attr('data-type');\n            const cardName = $card.find('.variable-title').val() || '';\n            const typeVisible = filterState[cardType];\n            const keywordVisible = !searchKeyword || cardName.toLowerCase().includes(searchKeyword.toLowerCase());\n            if (typeVisible && keywordVisible) {\n                $card.show();\n                visibleCount++;\n            }\n            else {\n                $card.hide();\n            }\n        });\n        // 更新空状态显示\n        this.updateFilterEmptyState(activeType, visibleCount);\n    }\n    /**\n     * 更新筛选后的空状态显示\n     * @param type 变量类型\n     * @param visibleCount 可见卡片数量\n     */\n    updateFilterEmptyState(type, visibleCount) {\n        const $variableList = this.container.find(`#${type}-content .variable-list`);\n        const $existingEmptyState = $variableList.find('.filter-empty-state');\n        if (visibleCount === 0) {\n            // 检查是否有变量卡片（即使被隐藏）\n            const totalCards = $variableList.find('.variable-card').length;\n            if (totalCards > 0) {\n                if ($existingEmptyState.length === 0) {\n                    $variableList.append('<div class=\"filter-empty-state\"><p>没有符合筛选条件的变量</p></div>');\n                }\n            }\n        }\n        else {\n            $existingEmptyState.remove();\n        }\n    }\n    /**\n     * 按楼层渲染message类型的变量\n     * @param container 容器元素\n     * @param variables 变量列表\n     */\n    renderMessageVariablesByFloor(container, variables) {\n        // 按楼层分组变量\n        const floorGroups = new Map();\n        for (const variable of variables) {\n            if (variable.message_id !== undefined) {\n                if (!floorGroups.has(variable.message_id)) {\n                    floorGroups.set(variable.message_id, []);\n                }\n                floorGroups.get(variable.message_id).push(variable);\n            }\n        }\n        const sortedFloors = Array.from(floorGroups.keys()).sort((a, b) => b - a); // 降序排列，最新楼层在上\n        for (let i = 0; i < sortedFloors.length; i++) {\n            const floor = sortedFloors[i];\n            const floorVariables = floorGroups.get(floor);\n            const isExpanded = i === 0; // 只展开最新一层楼\n            const $panel = this.createFloorPanel(floor, isExpanded);\n            const $panelBody = $panel.find('.floor-panel-body');\n            for (const variable of floorVariables) {\n                const card = this.cardFactory.createCard(variable);\n                card.attr('data-floor-id', floor.toString());\n                $panelBody.append(card);\n            }\n            container.append($panel);\n        }\n    }\n    /**\n     * 创建楼层折叠面板\n     * @param floor 楼层号\n     * @param isExpanded 是否默认展开\n     * @returns 折叠面板jQuery对象\n     */\n    createFloorPanel(floor, isExpanded) {\n        const titleContent = `# ${floor} 楼`;\n        const $panel = $(`\n      <div class=\"floor-panel\" data-floor=\"${floor}\">\n        <div class=\"floor-panel-header flex spaceBetween alignItemsCenter\">\n          <div class=\"floor-panel-title\">${titleContent}</div>\n          <div class=\"floor-panel-icon ${isExpanded ? 'expanded' : ''}\">\n            <i class=\"fa-solid fa-chevron-down\"></i>\n          </div>\n        </div>\n        <div class=\"floor-panel-body ${isExpanded ? 'expanded' : ''}\"></div>\n      </div>\n    `);\n        $panel.find('.floor-panel-header').on('click', function () {\n            const $this = $(this);\n            const $icon = $this.find('.floor-panel-icon');\n            const $body = $this.closest('.floor-panel').find('.floor-panel-body');\n            $icon.toggleClass('expanded');\n            $body.toggleClass('expanded');\n        });\n        return $panel;\n    }\n    /**\n     * 创建新变量卡片\n     * @param type 变量类型\n     * @param dataType 变量数据类型\n     * @param floorId 楼层ID(仅用于message类型)\n     */\n    addNewVariableCard(type, dataType, floorId) {\n        const $content = this.container.find(`#${type}-content`).find('.variable-list');\n        $content.find('.empty-state').remove();\n        const defaultVariable = {\n            name: 'new_variable',\n            value: _component_variable_manager_util__WEBPACK_IMPORTED_MODULE_1__.VariableManagerUtil.getDefaultValueForType(dataType),\n            dataType: dataType,\n            id: (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_5__.uuidv4)(),\n        };\n        const newCard = this.cardFactory.createCard(defaultVariable);\n        newCard.attr('data-type', dataType);\n        if (type === 'message' && floorId !== undefined) {\n            this.addCardToFloorPanel($content, newCard, floorId);\n        }\n        else {\n            $content.prepend(newCard);\n            this.addAnimation(newCard, 'variable-added', () => { });\n        }\n    }\n    /**\n     * 将卡片添加到指定楼层面板\n     * @param content 内容容器\n     * @param card 卡片元素\n     * @param floorId 楼层ID\n     */\n    addCardToFloorPanel(content, card, floorId) {\n        let $floorPanel = content.find(`.floor-panel[data-floor=\"${floorId}\"]`);\n        if ($floorPanel.length === 0) {\n            const $panel = this.createFloorPanel(floorId, true);\n            this.insertFloorPanelInOrder(content, $panel, floorId);\n            $floorPanel = $panel;\n        }\n        const $panelBody = $floorPanel.find('.floor-panel-body');\n        if (!$panelBody.hasClass('expanded')) {\n            $floorPanel.find('.floor-panel-icon').addClass('expanded');\n            $panelBody.addClass('expanded');\n        }\n        card.attr('data-floor-id', floorId.toString());\n        $panelBody.prepend(card);\n        this.addAnimation(card, 'variable-added', () => { });\n    }\n    /**\n     * 按楼层号顺序插入楼层面板\n     * @param content 内容容器\n     * @param panel 要插入的面板\n     * @param floorId 楼层ID\n     */\n    insertFloorPanelInOrder(content, panel, floorId) {\n        let inserted = false;\n        content.find('.floor-panel').each(function () {\n            const existingFloor = parseInt($(this).attr('data-floor') || '0');\n            if (floorId > existingFloor) {\n                $(this).before(panel);\n                inserted = true;\n                return false;\n            }\n            return undefined;\n        });\n        if (!inserted) {\n            content.prepend(panel);\n        }\n    }\n    /**\n     * 获取变量卡片信息\n     * @param card 卡片元素\n     * @returns 卡片中的变量信息\n     */\n    getVariableFromCard(card) {\n        return this.cardFactory.getVariableFromCard(card);\n    }\n    /**\n     * 获取变量卡片名称\n     * @param card 卡片元素\n     * @returns 卡片中的变量名称\n     */\n    getVariableCardName(card) {\n        const variable = this.getVariableFromCard(card);\n        return variable?.name || '';\n    }\n    /**\n     * 显示添加变量选择对话框\n     * @param callback 选择后的回调函数\n     */\n    async showAddVariableDialog(callback) {\n        const currentType = this.getActiveVariableType();\n        if (currentType === 'message') {\n            await this.showFloorInputDialog(async (floorId) => {\n                if (floorId === null)\n                    return;\n                await this.showVariableTypeDialog(dataType => {\n                    callback(dataType, floorId);\n                });\n            });\n            return;\n        }\n        await this.showVariableTypeDialog(dataType => {\n            callback(dataType);\n        });\n    }\n    /**\n     * 显示楼层输入对话框\n     * @param callback 输入完成后的回调函数\n     */\n    async showFloorInputDialog(callback) {\n        const content = $(`\n      <div>\n        <h3>输入楼层号码</h3>\n        <div class=\"floor-input-dialog\">\n          <input type=\"number\" id=\"floor-input\" min=\"0\" placeholder=\"请输入楼层号码\" />\n          <div id=\"floor-input-error\" class=\"floor-filter-error\" style=\"display: none\">请输入有效的楼层号码</div>\n        </div>\n      </div>\n    `);\n        const $inputField = content.find('#floor-input');\n        const $errorMsg = content.find('#floor-input-error');\n        const lastMessageId = (0,_function_util__WEBPACK_IMPORTED_MODULE_2__.getLastMessageId)();\n        if (lastMessageId >= 0) {\n            $inputField.val(lastMessageId);\n        }\n        // 添加输入验证\n        $inputField.on('input', function () {\n            const value = parseInt($(this).val(), 10);\n            if ($(this).val() && (isNaN(value) || value < 0)) {\n                $errorMsg.text('楼层号码不能小于0').show();\n            }\n            else {\n                $errorMsg.hide();\n            }\n        });\n        const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_3__.callGenericPopup)(content, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_3__.POPUP_TYPE.CONFIRM, '', {\n            okButton: '确认',\n            cancelButton: '取消',\n        });\n        if (!result) {\n            callback(null);\n            return;\n        }\n        const inputValue = $inputField.val();\n        const floorId = parseInt(inputValue, 10);\n        if (!inputValue.trim() || isNaN(floorId)) {\n            $errorMsg.text('请输入有效的楼层号码').show();\n            setTimeout(() => this.showFloorInputDialog(callback), 100);\n            return;\n        }\n        if (floorId < 0) {\n            $errorMsg.text('楼层号码不能小于0').show();\n            setTimeout(() => this.showFloorInputDialog(callback), 100);\n            return;\n        }\n        callback(floorId);\n    }\n    /**\n     * 显示变量类型选择对话框\n     * @param callback 选择后的回调函数\n     * @param floorId 楼层ID(仅用于message类型)\n     */\n    async showVariableTypeDialog(callback) {\n        const content = $(`\n      <div>\n        <h3>选择变量类型</h3>\n        <div class=\"variable-type-options\">\n          <div data-type=\"string\"><i class=\"fa-regular fa-font\"></i> 字符串</div>\n          <div data-type=\"number\"><i class=\"fa-regular fa-hashtag\"></i> 数字</div>\n          <div data-type=\"boolean\"><i class=\"fa-regular fa-toggle-on\"></i> 布尔值</div>\n          <div data-type=\"array\"><i class=\"fa-regular fa-list\"></i> 数组</div>\n          <div data-type=\"object\"><i class=\"fa-regular fa-code\"></i> 对象</div>\n        </div>\n      </div>\n    `);\n        content.find('.variable-type-options div').on('click', function () {\n            const dataType = $(this).attr('data-type');\n            callback(dataType);\n            $('.popup').find('.popup-button-close').trigger('click');\n        });\n        await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_3__.callGenericPopup)(content, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_3__.POPUP_TYPE.DISPLAY);\n    }\n    /**\n     * 显示确认对话框\n     * @param message 确认信息\n     * @param callback 确认后的回调\n     */\n    async showConfirmDialog(message, callback) {\n        const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_3__.callGenericPopup)(message, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_3__.POPUP_TYPE.CONFIRM, '', {\n            okButton: '确认',\n            cancelButton: '取消',\n        });\n        callback(!!result);\n    }\n    /**\n     * 渲染变量管理器浮窗\n     * 创建可拖动、可调整大小的浮窗\n     */\n    render() {\n        this.unrender();\n        this.dialog = $(`\n      <div class=\"variable-manager-dialog\">\n        <div class=\"dialog-header\">\n          <div class=\"dialog-title\">变量管理器</div>\n          <div class=\"dialog-controls\">\n            <button class=\"dialog-toggle-btn\" title=\"折叠/展开内容\"><i class=\"fa-solid fa-chevron-up\"></i></button>\n            <button class=\"dialog-close-btn\"><i class=\"fa-solid fa-times\"></i></button>\n          </div>\n        </div>\n        <div class=\"dialog-content\"></div>\n        <div class=\"dialog-resize-handle\"></div>\n      </div>\n    `);\n        this.dialog.find('.dialog-content').append(this.container);\n        this.dialog.find('.dialog-close-btn').on('click', () => {\n            this.unrender();\n        });\n        this.dialog.find('.dialog-toggle-btn').on('click', () => {\n            const $content = this.dialog.find('.dialog-content');\n            const $toggleBtn = this.dialog.find('.dialog-toggle-btn i');\n            $content.slideToggle(300, () => {\n                if ($content.is(':visible')) {\n                    $toggleBtn.removeClass('fa-chevron-down').addClass('fa-chevron-up');\n                    this.dialog.find('.dialog-resize-handle').show();\n                }\n                else {\n                    $toggleBtn.removeClass('fa-chevron-up').addClass('fa-chevron-down');\n                    this.dialog.find('.dialog-resize-handle').hide();\n                }\n            });\n            this.dialog.toggleClass('content-collapsed');\n        });\n        $('body').append(this.dialog);\n        this.initDraggableDialog();\n        this.centerDialog();\n        this.container.show();\n    }\n    /**\n     * 关闭并清理变量管理器浮窗\n     */\n    unrender() {\n        if (this.dialog) {\n            this.container.detach();\n            this.dialog.remove();\n            this.dialog = null;\n            if (this.controller) {\n                this.controller.cleanup();\n            }\n        }\n    }\n    /**\n     * 初始化浮窗的拖动和调整大小功能\n     */\n    initDraggableDialog() {\n        if (!this.dialog)\n            return;\n        const isMobileDevice = (0,_sillytavern_scripts_RossAscends_mods__WEBPACK_IMPORTED_MODULE_4__.isMobile)();\n        this.dialog.draggable({\n            handle: '.dialog-header',\n            containment: 'window',\n            start: () => {\n                this.dialog?.addClass('dragging');\n            },\n            stop: () => {\n                this.dialog?.removeClass('dragging');\n            },\n        });\n        this.dialog.resizable({\n            // 桌面设备用所有边缘，移动设备仅用右下角\n            handles: isMobileDevice ? 'se' : 'n,e,s,w,ne,se,sw,nw',\n            minHeight: VariableView.MIN_DIALOG_HEIGHT,\n            minWidth: VariableView.MIN_DIALOG_WIDTH,\n            start: () => {\n                this.dialog?.addClass('resizing');\n            },\n            stop: () => {\n                this.dialog?.removeClass('resizing');\n            },\n        });\n        this.dialog.find('.dialog-resize-handle').toggle(isMobileDevice);\n    }\n    /**\n     * 将浮窗居中显示\n     */\n    centerDialog() {\n        if (!this.dialog)\n            return;\n        const windowWidth = $(window).width() || 0;\n        const windowHeight = $(window).height() || 0;\n        const dialogWidth = this.dialog.outerWidth() || VariableView.MIN_DIALOG_WIDTH;\n        const dialogHeight = this.dialog.outerHeight() || VariableView.MIN_DIALOG_HEIGHT;\n        const left = Math.max(0, (windowWidth - dialogWidth) / 2);\n        const top = Math.max(0, (windowHeight - dialogHeight) / 2);\n        this.dialog.css({\n            left: `${left}px`,\n            top: `${top}px`,\n            position: 'fixed',\n        });\n    }\n    addVariableCard(variable) {\n        try {\n            const newCard = this.cardFactory.createCard(variable);\n            newCard.attr('data-type', variable.dataType);\n            const activeType = this.getActiveVariableType();\n            const $variableList = this.container.find(`#${activeType}-content .variable-list`);\n            if (activeType === 'message' && variable.message_id !== undefined) {\n                this.addCardToFloorPanel($variableList, newCard, variable.message_id);\n            }\n            else {\n                $variableList.find('.empty-state').remove();\n                $variableList.append(newCard);\n                this.addAnimation(newCard, 'variable-added', () => { });\n            }\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_6___default().error(`[VariableManager] 添加卡片\"${variable.name}\"失败:`, error);\n        }\n    }\n    /**\n     * 移除变量卡片\n     * @param variable_id 变量ID\n     */\n    removeVariableCard(variable_id) {\n        try {\n            if (!variable_id) {\n                loglevel__WEBPACK_IMPORTED_MODULE_6___default().warn(`[VariableManager] 变量ID为空，无法移除卡片`);\n                return;\n            }\n            const $card = this.container.find(`.variable-card[data-variable-id=\"${variable_id}\"]`);\n            if ($card.length === 0) {\n                loglevel__WEBPACK_IMPORTED_MODULE_6___default().warn(`[VariableManager] 未找到ID为\"${variable_id}\"的卡片`);\n                return;\n            }\n            this.addAnimation($card, 'variable-deleted', () => {\n                $card.remove();\n                this.checkAndShowEmptyState();\n            });\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_6___default().error(`[VariableManager] 移除卡片失败:`, error);\n        }\n    }\n    /**\n     * 检查并显示空状态提示\n     */\n    checkAndShowEmptyState() {\n        const activeType = this.getActiveVariableType();\n        const $variableList = this.container.find(`#${activeType}-content .variable-list`);\n        if ($variableList.find('.variable-card').length === 0) {\n            $variableList.html('<div class=\"empty-state\"><p>暂无变量</p></div>');\n        }\n    }\n    /**\n     * 更新变量卡片\n     * @param variable 变量\n     */\n    updateVariableCard(variable) {\n        try {\n            const $card = this.container.find(`.variable-card[data-variable-id=\"${variable.id}\"]`);\n            if ($card.length === 0) {\n                loglevel__WEBPACK_IMPORTED_MODULE_6___default().warn(`[VariableManager] 未找到ID为\"${variable.id}\"的卡片`);\n                return;\n            }\n            // 创建新卡片替换旧卡片，保持一致性\n            const newCard = this.cardFactory.createCard(variable);\n            newCard.attr('data-type', variable.dataType);\n            if (variable.message_id !== undefined) {\n                newCard.attr('data-floor-id', variable.message_id.toString());\n            }\n            $card.replaceWith(newCard);\n            this.addAnimation(newCard, 'variable-changed', () => { });\n        }\n        catch (error) {\n            loglevel__WEBPACK_IMPORTED_MODULE_6___default().error(`[VariableManager] 更新卡片失败:`, error);\n        }\n    }\n    /**\n     * 显示键名输入对话框\n     * @param callback 输入完成后的回调函数\n     */\n    async showKeyNameInputDialog(callback) {\n        const content = $(`\n      <div>\n        <h3>输入键名</h3>\n        <div class=\"key-input-dialog\">\n          <input type=\"text\" id=\"key-input\" placeholder=\"请输入键名\" />\n          <div id=\"key-input-error\" class=\"input-error\" style=\"display: none\">请输入有效的键名</div>\n        </div>\n      </div>\n    `);\n        const $inputField = content.find('#key-input');\n        const $errorMsg = content.find('#key-input-error');\n        const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_3__.callGenericPopup)(content, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_3__.POPUP_TYPE.CONFIRM, '', {\n            okButton: '确认',\n            cancelButton: '取消',\n        });\n        if (!result) {\n            callback(null);\n            return;\n        }\n        const keyName = $inputField.val();\n        if (!keyName || keyName.trim() === '') {\n            $errorMsg.show();\n            setTimeout(() => this.showKeyNameInputDialog(callback), 10);\n            return;\n        }\n        callback(keyName.trim());\n    }\n    /**\n     * 添加动画效果\n     * @param element 要添加动画效果的元素\n     * @param animationClass CSS动画类名\n     * @param callback 动画结束后的回调\n     */\n    addAnimation(element, animationClass, callback) {\n        const namespace = `animation.${animationClass}`;\n        element.addClass(animationClass);\n        void element[0].offsetHeight;\n        element.off(`animationend.${namespace}`);\n        element.on(`animationend.${namespace}`, function () {\n            $(this).off(`animationend.${namespace}`);\n            $(this).removeClass(animationClass);\n            callback();\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tcG9uZW50L3ZhcmlhYmxlX21hbmFnZXIvdmlldy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBd0U7QUFHQTtBQUNyQjtBQUV1QjtBQUNUO0FBQ0s7QUFFM0M7QUFNcEIsTUFBTSxZQUFZO0lBQ3ZCOztPQUVHO0lBQ0ssTUFBTSxDQUFVLGdCQUFnQixHQUFHLEdBQUcsQ0FBQztJQUUvQzs7T0FFRztJQUNLLE1BQU0sQ0FBVSxpQkFBaUIsR0FBRyxHQUFHLENBQUM7SUFFaEQ7O09BRUc7SUFDSSxTQUFTLENBQXNCO0lBRXRDOztPQUVHO0lBQ0ksV0FBVyxDQUFzQjtJQUV4Qzs7T0FFRztJQUNLLE1BQU0sR0FBK0IsSUFBSSxDQUFDO0lBRWxEOztPQUVHO0lBQ0ssVUFBVSxHQUF1QixJQUFJLENBQUM7SUFFOUM7O09BRUc7SUFDSCxZQUFZLFNBQThCO1FBQ3hDLElBQUksQ0FBQyxTQUFTLEdBQUcsU0FBUyxDQUFDO1FBQzNCLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxpRkFBbUIsQ0FBQyxJQUFJLENBQUMsc0JBQXNCLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7SUFDckYsQ0FBQztJQUVEOzs7T0FHRztJQUNJLGFBQWEsQ0FBQyxVQUF1QjtRQUMxQyxJQUFJLENBQUMsVUFBVSxHQUFHLFVBQVUsQ0FBQztJQUMvQixDQUFDO0lBRUQ7O09BRUc7SUFDSSxNQUFNO1FBQ1gsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ3RELElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBRTFELDRCQUE0QjtRQUM1QixJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDO1FBRXRELElBQUksQ0FBQyxZQUFZLEVB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ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2NvbXBvbmVudC92YXJpYWJsZV9tYW5hZ2VyL3ZpZXcudHM/NWRiNSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBWYXJpYWJsZUNhcmRGYWN0b3J5IH0gZnJvbSAnQC9jb21wb25lbnQvdmFyaWFibGVfbWFuYWdlci9jYXJkJztcbmltcG9ydCB7IElEb21VcGRhdGVyIH0gZnJvbSAnQC9jb21wb25lbnQvdmFyaWFibGVfbWFuYWdlci9zeW5jJztcbmltcG9ydCB7IFZhcmlhYmxlRGF0YVR5cGUsIFZhcmlhYmxlSXRlbSwgVmFyaWFibGVUeXBlIH0gZnJvbSAnQC9jb21wb25lbnQvdmFyaWFibGVfbWFuYWdlci90eXBlcyc7XG5pbXBvcnQgeyBWYXJpYWJsZU1hbmFnZXJVdGlsIH0gZnJvbSAnQC9jb21wb25lbnQvdmFyaWFibGVfbWFuYWdlci91dGlsJztcbmltcG9ydCB7IGdldExhc3RNZXNzYWdlSWQgfSBmcm9tICdAL2Z1bmN0aW9uL3V0aWwnO1xuXG5pbXBvcnQgeyBQT1BVUF9UWVBFLCBjYWxsR2VuZXJpY1BvcHVwIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvcG9wdXAnO1xuaW1wb3J0IHsgaXNNb2JpbGUgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9Sb3NzQXNjZW5kcy1tb2RzJztcbmltcG9ydCB7IGdldFNvcnRhYmxlRGVsYXksIHV1aWR2NCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3V0aWxzJztcblxuaW1wb3J0IGxvZyBmcm9tICdsb2dsZXZlbCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUNvbnRyb2xsZXIge1xuICBjbGVhbnVwKCk6IHZvaWQ7XG59XG5cbmV4cG9ydCBjbGFzcyBWYXJpYWJsZVZpZXcgaW1wbGVtZW50cyBJRG9tVXBkYXRlciB7XG4gIC8qKlxuICAgKiDmnIDlsI/mta7nqpflrr3luqbvvIjlg4/ntKDvvIlcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IE1JTl9ESUFMT0dfV0lEVEggPSAzMDA7XG5cbiAgLyoqXG4gICAqIOacgOWwj+a1rueql+mrmOW6pu+8iOWDj+e0oO+8iVxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgTUlOX0RJQUxPR19IRUlHSFQgPSAyNTA7XG5cbiAgLyoqXG4gICAqIFVJ5a655ZmoXG4gICAqL1xuICBwdWJsaWMgY29udGFpbmVyOiBKUXVlcnk8SFRNTEVsZW1lbnQ+O1xuXG4gIC8qKlxuICAgKiDlj5jph4/ljaHniYdcbiAgICovXG4gIHB1YmxpYyBjYXJkRmFjdG9yeTogVmFyaWFibGVDYXJkRmFjdG9yeTtcblxuICAvKipcbiAgICog5rWu56qX5YWD57SgXG4gICAqL1xuICBwcml2YXRlIGRpYWxvZzogSlF1ZXJ5PEhUTUxFbGVtZW50PiB8IG51bGwgPSBudWxsO1xuXG4gIC8qKlxuICAgKiDmjqfliLblmajlvJXnlKhcbiAgICovXG4gIHByaXZhdGUgY29udHJvbGxlcjogSUNvbnRyb2xsZXIgfCBudWxsID0gbnVsbDtcblxuICAvKipcbiAgICogQHBhcmFtIGNvbnRhaW5lciDlj5jph4/nrqHnkIblmajlrrnlmahcbiAgICovXG4gIGNvbnN0cnVjdG9yKGNvbnRhaW5lcjogSlF1ZXJ5PEhUTUxFbGVtZW50Pikge1xuICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xuICAgIHRoaXMuY2FyZEZhY3RvcnkgPSBuZXcgVmFyaWFibGVDYXJkRmFjdG9yeSh0aGlzLnNob3dWYXJpYWJsZVR5cGVEaWFsb2cuYmluZCh0aGlzKSk7XG4gIH1cblxuICAvKipcbiAgICog6K6+572u5o6n5Yi25Zmo5byV55SoXG4gICAqIEBwYXJhbSBjb250cm9sbGVyIOWPmOmHj+aOp+WItuWZqFxuICAgKi9cbiAgcHVibGljIHNldENvbnRyb2xsZXIoY29udHJvbGxlcjogSUNvbnRyb2xsZXIpOiB2b2lkIHtcbiAgICB0aGlzLmNvbnRyb2xsZXIgPSBjb250cm9sbGVyO1xuICB9XG5cbiAgLyoqXG4gICAqIOWIneWni+WMllVJXG4gICAqL1xuICBwdWJsaWMgaW5pdFVJKCk6IHZvaWQge1xuICAgIHRoaXMuY29udGFpbmVyLmZpbmQoJyNnbG9iYWwtdGFiJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgIHRoaXMuY29udGFpbmVyLmZpbmQoJyNnbG9iYWwtY29udGVudCcpLmFkZENsYXNzKCdhY3RpdmUnKTtcblxuICAgIC8vIOWIneWni+WMluaXtumakOiXj+alvOWxguetm+mAieaOp+S7tu+8iOS7heWcqOa2iOaBr+agh+etvumhteaXtuaJjeaYvuekuu+8iVxuICAgIHRoaXMuY29udGFpbmVyLmZpbmQoJyNmbG9vci1maWx0ZXItY29udGFpbmVyJykuaGlkZSgpO1xuXG4gICAgdGhpcy5pbml0U29ydGFibGUoKTtcbiAgICB0aGlzLmluaXRGbG9vckZpbHRlcigpO1xuICB9XG5cbiAgLyoqXG4gICAqIOWIneWni+WMluWPr+aOkuW6j+WKn+iDvVxuICAgKi9cbiAgcHJpdmF0ZSBpbml0U29ydGFibGUoKTogdm9pZCB7XG4gICAgdGhpcy5jb250YWluZXIuZmluZCgnLmxpc3QtaXRlbXMtY29udGFpbmVyJykuc29ydGFibGUoe1xuICAgICAgZGVsYXk6IGdldFNvcnRhYmxlRGVsYXkoKSxcbiAgICAgIGhhbmRsZTogJy5kcmFnLWhhbmRsZScsXG4gICAgICBzdG9wOiBmdW5jdGlvbiAoX2V2ZW50LCB1aSkge1xuICAgICAgICBjb25zdCBsaXN0Q29udGFpbmVyID0gJCh1aS5pdGVtKS5jbG9zZXN0KCcubGlzdC1pdGVtcy1jb250YWluZXInKTtcblxuICAgICAgICBjb25zdCBpdGVtczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgbGlzdENvbnRhaW5lci5maW5kKCcudmFyaWFibGUtY29udGVudC1pbnB1dCcpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGl0ZW1zLnB1c2goJCh0aGlzKS52YWwoKSBhcyBzdHJpbmcpO1xuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBwcm9jZXNzZWRJdGVtcyA9IF8udW5pcUJ5KGl0ZW1zLCBpdGVtID0+IGl0ZW0udHJpbSgpLnRvTG93ZXJDYXNlKCkpO1xuXG4gICAgICAgIGlmICghXy5pc0VxdWFsKGl0ZW1zLCBwcm9jZXNzZWRJdGVtcykpIHtcbiAgICAgICAgICBsaXN0Q29udGFpbmVyLmVtcHR5KCk7XG4gICAgICAgICAgcHJvY2Vzc2VkSXRlbXMuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGl0ZW1IdG1sID0gYFxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibGlzdC1pdGVtXCI+XG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJkcmFnLWhhbmRsZVwiPuKYsDwvc3Bhbj5cbiAgICAgICAgICAgICAgICA8dGV4dGFyZWEgY2xhc3M9XCJ2YXJpYWJsZS1jb250ZW50LWlucHV0XCI+JHtpdGVtfTwvdGV4dGFyZWE+XG4gICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImxpc3QtaXRlbS1kZWxldGVcIj48aSBjbGFzcz1cImZhLXNvbGlkIGZhLXRpbWVzXCI+PC9pPjwvYnV0dG9uPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIGA7XG4gICAgICAgICAgICBsaXN0Q29udGFpbmVyLmFwcGVuZChpdGVtSHRtbCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBsaXN0Q29udGFpbmVyLnRyaWdnZXIoJ3NvcnR1cGRhdGUnKTtcbiAgICAgIH0sXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog5Yid5aeL5YyW5qW85bGC562b6YCJ5Yqf6IO9XG4gICAqL1xuICBwcml2YXRlIGluaXRGbG9vckZpbHRlcigpOiB2b2lkIHtcbiAgICB0aGlzLmNvbnRhaW5lci5maW5kKCcjZmxvb3ItZmlsdGVyLWJ0bicpLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAgIGNvbnN0IG1pbklucHV0ID0gdGhpcy5jb250YWluZXIuZmluZCgnI2Zsb29yLW1pbicpLnZhbCgpIGFzIHN0cmluZztcbiAgICAgIGNvbnN0IG1heElucHV0ID0gdGhpcy5jb250YWluZXIuZmluZCgnI2Zsb29yLW1heCcpLnZhbCgpIGFzIHN0cmluZztcblxuICAgICAgLy8g5YWB6K6456m65YC877yM5L2G5aaC5p6c5pyJ5YC85bCx5b+F6aG75piv5pyJ5pWI5pWw5a2XXG4gICAgICBjb25zdCBtaW5WYWwgPSBtaW5JbnB1dC50cmltKCkgPyBwYXJzZUludChtaW5JbnB1dCwgMTApIDogbnVsbDtcbiAgICAgIGNvbnN0IG1heFZhbCA9IG1heElucHV0LnRyaW0oKSA/IHBhcnNlSW50KG1heElucHV0LCAxMCkgOiBudWxsO1xuXG4gICAgICAvLyDpqozor4HmlbDlrZfmnInmlYjmgKdcbiAgICAgIGlmICgobWluSW5wdXQudHJpbSgpICYmIGlzTmFOKG1pblZhbCEpKSB8fCAobWF4SW5wdXQudHJpbSgpICYmIGlzTmFOKG1heFZhbCEpKSkge1xuICAgICAgICB0aGlzLnNob3dGbG9vckZpbHRlckVycm9yKCfor7fovpPlhaXmnInmlYjnmoTmpbzlsYLmlbDlgLwnKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyDpqozor4HmpbzlsYLkuI3og73lsI/kuo4wXG4gICAgICBpZiAobWluVmFsICE9PSBudWxsICYmIG1pblZhbCA8IDApIHtcbiAgICAgICAgdGhpcy5zaG93Rmxvb3JGaWx0ZXJFcnJvcign5pyA5bCP5qW85bGC5LiN6IO95bCP5LqOMCcpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmIChtYXhWYWwgIT09IG51bGwgJiYgbWF4VmFsIDwgMCkge1xuICAgICAgICB0aGlzLnNob3dGbG9vckZpbHRlckVycm9yKCfmnIDlpKfmpbzlsYLkuI3og73lsI/kuo4wJyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8g6aqM6K+B6IyD5Zu06YC76L6R77ya5Y+q5pyJ5b2T5Lik5Liq5YC86YO95a2Y5Zyo5pe25omN5q+U6L6D5aSn5bCPXG4gICAgICBpZiAobWluVmFsICE9PSBudWxsICYmIG1heFZhbCAhPT0gbnVsbCAmJiBtYXhWYWwgPCBtaW5WYWwpIHtcbiAgICAgICAgdGhpcy5zaG93Rmxvb3JGaWx0ZXJFcnJvcign5pyA5aSn5qW85bGC5LiN6IO95bCP5LqO5pyA5bCP5qW85bGCJyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8g6Iez5bCR6ZyA6KaB6K6+572u5LiA5Liq5YC8XG4gICAgICBpZiAobWluVmFsID09PSBudWxsICYmIG1heFZhbCA9PT0gbnVsbCkge1xuICAgICAgICB0aGlzLnNob3dGbG9vckZpbHRlckVycm9yKCfor7foh7PlsJHorr7nva7mnIDlsI/mpbzlsYLmiJbmnIDlpKfmpbzlsYInKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmhpZGVGbG9vckZpbHRlckVycm9yKCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLmNvbnRhaW5lci5maW5kKCcjZmxvb3ItbWluLCAjZmxvb3ItbWF4Jykub24oJ2lucHV0JywgKCkgPT4ge1xuICAgICAgY29uc3QgbWluSW5wdXQgPSB0aGlzLmNvbnRhaW5lci5maW5kKCcjZmxvb3ItbWluJykudmFsKCkgYXMgc3RyaW5nO1xuICAgICAgY29uc3QgbWF4SW5wdXQgPSB0aGlzLmNvbnRhaW5lci5maW5kKCcjZmxvb3ItbWF4JykudmFsKCkgYXMgc3RyaW5nO1xuXG4gICAgICBjb25zdCBtaW5WYWwgPSBtaW5JbnB1dC50cmltKCkgPyBwYXJzZUludChtaW5JbnB1dCwgMTApIDogbnVsbDtcbiAgICAgIGNvbnN0IG1heFZhbCA9IG1heElucHV0LnRyaW0oKSA/IHBhcnNlSW50KG1heElucHV0LCAxMCkgOiBudWxsO1xuXG4gICAgICAvLyDlrp7ml7bpqozor4HmpbzlsYLkuI3og73lsI/kuo4wXG4gICAgICBpZiAobWluVmFsICE9PSBudWxsICYmIG1pblZhbCA8IDApIHtcbiAgICAgICAgdGhpcy5zaG93Rmxvb3JGaWx0ZXJFcnJvcign5pyA5bCP5qW85bGC5LiN6IO95bCP5LqOMCcpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmIChtYXhWYWwgIT09IG51bGwgJiYgbWF4VmFsIDwgMCkge1xuICAgICAgICB0aGlzLnNob3dGbG9vckZpbHRlckVycm9yKCfmnIDlpKfmpbzlsYLkuI3og73lsI/kuo4wJyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8g5a6e5pe26aqM6K+B6IyD5Zu06YC76L6RXG4gICAgICBpZiAobWluVmFsICE9PSBudWxsICYmIG1heFZhbCAhPT0gbnVsbCAmJiAhaXNOYU4obWluVmFsKSAmJiAhaXNOYU4obWF4VmFsKSAmJiBtYXhWYWwgPCBtaW5WYWwpIHtcbiAgICAgICAgdGhpcy5zaG93Rmxvb3JGaWx0ZXJFcnJvcign5pyA5aSn5qW85bGC5LiN6IO95bCP5LqO5pyA5bCP5qW85bGCJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmhpZGVGbG9vckZpbHRlckVycm9yKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog5pi+56S65qW85bGC562b6YCJ6ZSZ6K+v5L+h5oGvXG4gICAqIEBwYXJhbSBtZXNzYWdlIOmUmeivr+S/oeaBr1xuICAgKi9cbiAgcHVibGljIHNob3dGbG9vckZpbHRlckVycm9yKG1lc3NhZ2U6IHN0cmluZyk6IHZvaWQge1xuICAgIGNvbnN0ICRlcnJvckVsID0gdGhpcy5jb250YWluZXIuZmluZCgnI2Zsb29yLWZpbHRlci1lcnJvcicpO1xuICAgICRlcnJvckVsLnRleHQobWVzc2FnZSkuc2hvdygpO1xuICB9XG5cbiAgLyoqXG4gICAqIOmakOiXj+alvOWxguetm+mAiemUmeivr+S/oeaBr1xuICAgKi9cbiAgcHVibGljIGhpZGVGbG9vckZpbHRlckVycm9yKCk6IHZvaWQge1xuICAgIHRoaXMuY29udGFpbmVyLmZpbmQoJyNmbG9vci1maWx0ZXItZXJyb3InKS5oaWRlKCk7XG4gIH1cblxuICAvKipcbiAgICog5pu05paw5qW85bGC562b6YCJ6L6T5YWl5qGG55qE5YC8XG4gICAqIEBwYXJhbSBtaW4g5pyA5bCP5qW85bGC5YC8XG4gICAqIEBwYXJhbSBtYXgg5pyA5aSn5qW85bGC5YC8XG4gICAqL1xuICBwdWJsaWMgdXBkYXRlRmxvb3JSYW5nZUlucHV0cyhtaW46IG51bWJlciB8IG51bGwsIG1heDogbnVtYmVyIHwgbnVsbCk6IHZvaWQge1xuICAgIHRoaXMuY29udGFpbmVyLmZpbmQoJyNmbG9vci1taW4nKS52YWwobWluICE9PSBudWxsID8gbWluLnRvU3RyaW5nKCkgOiAnJyk7XG4gICAgdGhpcy5jb250YWluZXIuZmluZCgnI2Zsb29yLW1heCcpLnZhbChtYXggIT09IG51bGwgPyBtYXgudG9TdHJpbmcoKSA6ICcnKTtcbiAgICB0aGlzLmhpZGVGbG9vckZpbHRlckVycm9yKCk7XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5b2T5YmN5rS75Yqo55qE5Y+Y6YeP57G75Z6LXG4gICAqIEByZXR1cm5zIOW9k+WJjea0u+WKqOeahOWPmOmHj+exu+Wei1xuICAgKi9cbiAgcHJpdmF0ZSBnZXRBY3RpdmVWYXJpYWJsZVR5cGUoKTogVmFyaWFibGVUeXBlIHtcbiAgICByZXR1cm4gKHRoaXMuY29udGFpbmVyLmZpbmQoJy50YWItaXRlbS5hY3RpdmUnKS5hdHRyKCdpZCcpPy5yZXBsYWNlKCctdGFiJywgJycpIGFzIFZhcmlhYmxlVHlwZSkgfHwgJ2NoYXQnO1xuICB9XG5cbiAgLyoqXG4gICAqIOiuvue9rua0u+WKqOagh+etvumhtVxuICAgKiBAcGFyYW0gdHlwZSDopoHmv4DmtLvnmoTlj5jph4/nsbvlnotcbiAgICovXG4gIHB1YmxpYyBzZXRBY3RpdmVUYWIodHlwZTogVmFyaWFibGVUeXBlKTogdm9pZCB7XG4gICAgdGhpcy5jb250YWluZXIuZmluZCgnLnRhYi1pdGVtJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgIHRoaXMuY29udGFpbmVyLmZpbmQoJy50YWItY29udGVudCcpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcblxuICAgIHRoaXMuY29udGFpbmVyLmZpbmQoYCMke3R5cGV9LXRhYmApLmFkZENsYXNzKCdhY3RpdmUnKTtcbiAgICB0aGlzLmNvbnRhaW5lci5maW5kKGAjJHt0eXBlfS1jb250ZW50YCkuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuXG4gICAgY29uc3QgJGZsb29yRmlsdGVyQ29udGFpbmVyID0gdGhpcy5jb250YWluZXIuZmluZCgnI2Zsb29yLWZpbHRlci1jb250YWluZXInKTtcbiAgICBpZiAodHlwZSA9PT0gJ21lc3NhZ2UnKSB7XG4gICAgICAkZmxvb3JGaWx0ZXJDb250YWluZXIuc2hvdygpO1xuICAgICAgY29uc3QgW21pbkZsb29yLCBtYXhGbG9vcl0gPSB0aGlzLmdldEZsb29yUmFuZ2UoKTtcblxuICAgICAgLy8g5aaC5p6c5qW85bGC6IyD5Zu05Li656m677yM6K6+572u6buY6K6k6IyD5Zu0XG4gICAgICBpZiAobWluRmxvb3IgPT09IG51bGwgJiYgbWF4Rmxvb3IgPT09IG51bGwpIHtcbiAgICAgICAgY29uc3QgbGFzdE1lc3NhZ2VJZCA9IGdldExhc3RNZXNzYWdlSWQoKTtcbiAgICAgICAgY29uc3QgbmV3TWluRmxvb3IgPSBNYXRoLm1heCgwLCBsYXN0TWVzc2FnZUlkIC0gNCk7XG4gICAgICAgIGNvbnN0IG5ld01heEZsb29yID0gbGFzdE1lc3NhZ2VJZDtcbiAgICAgICAgKHRoaXMuY29udHJvbGxlciBhcyBhbnkpLm1vZGVsLnVwZGF0ZUZsb29yUmFuZ2UobmV3TWluRmxvb3IsIG5ld01heEZsb29yKTtcbiAgICAgICAgdGhpcy51cGRhdGVGbG9vclJhbmdlSW5wdXRzKG5ld01pbkZsb29yLCBuZXdNYXhGbG9vcik7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICRmbG9vckZpbHRlckNvbnRhaW5lci5oaWRlKCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBnZXRGbG9vclJhbmdlKCk6IFtudW1iZXIgfCBudWxsLCBudW1iZXIgfCBudWxsXSB7XG4gICAgY29uc3QgbWluVmFsID0gdGhpcy5jb250YWluZXIuZmluZCgnI2Zsb29yLW1pbicpLnZhbCgpIGFzIHN0cmluZztcbiAgICBjb25zdCBtYXhWYWwgPSB0aGlzLmNvbnRhaW5lci5maW5kKCcjZmxvb3ItbWF4JykudmFsKCkgYXMgc3RyaW5nO1xuXG4gICAgbGV0IG1pbkZsb29yID0gbWluVmFsICYmIG1pblZhbC50cmltKCkgPyBwYXJzZUludChtaW5WYWwsIDEwKSA6IG51bGw7XG4gICAgbGV0IG1heEZsb29yID0gbWF4VmFsICYmIG1heFZhbC50cmltKCkgPyBwYXJzZUludChtYXhWYWwsIDEwKSA6IG51bGw7XG5cbiAgICAvLyDnoa7kv53mpbzlsYLkuI3lsI/kuo4wXG4gICAgaWYgKG1pbkZsb29yICE9PSBudWxsKSB7XG4gICAgICBtaW5GbG9vciA9IE1hdGgubWF4KDAsIG1pbkZsb29yKTtcbiAgICB9XG4gICAgaWYgKG1heEZsb29yICE9PSBudWxsKSB7XG4gICAgICBtYXhGbG9vciA9IE1hdGgubWF4KDAsIG1heEZsb29yKTtcbiAgICB9XG5cbiAgICByZXR1cm4gW1xuICAgICAgbWluRmxvb3IgIT09IG51bGwgJiYgIWlzTmFOKG1pbkZsb29yKSA/IG1pbkZsb29yIDogbnVsbCxcbiAgICAgIG1heEZsb29yICE9PSBudWxsICYmICFpc05hTihtYXhGbG9vcikgPyBtYXhGbG9vciA6IG51bGwsXG4gICAgXTtcbiAgfVxuXG4gIC8qKlxuICAgKiDliLfmlrDlj5jph4/ljaHniYdcbiAgICogQHBhcmFtIHR5cGUg5Y+Y6YeP57G75Z6LXG4gICAqIEBwYXJhbSB2YXJpYWJsZXMg6L+H5ruk5ZCO55qE5Y+Y6YeP5YiX6KGoXG4gICAqL1xuICBwdWJsaWMgcmVmcmVzaFZhcmlhYmxlQ2FyZHModHlwZTogVmFyaWFibGVUeXBlLCB2YXJpYWJsZXM6IFZhcmlhYmxlSXRlbVtdKTogdm9pZCB7XG4gICAgLy8g5pu05paw5qCH562+5paH5pysXG4gICAgdGhpcy5jb250YWluZXIuZmluZCgnLnZhcmlhYmxlLXR5cGUtbGFiZWwnKS50ZXh0KGAke3R5cGV95Y+Y6YePYCk7XG5cbiAgICAvLyDojrflj5blvZPliY3mtLvliqjnmoTlhoXlrrnlrrnlmahcbiAgICBjb25zdCBhY3RpdmVDb250ZW50ID0gdGhpcy5jb250YWluZXIuZmluZChgIyR7dHlwZX0tY29udGVudGApO1xuICAgIGNvbnN0ICR2YXJpYWJsZUxpc3QgPSBhY3RpdmVDb250ZW50LmZpbmQoJy52YXJpYWJsZS1saXN0Jyk7XG5cbiAgICBjb25zdCBzY3JvbGxUb3AgPSAkdmFyaWFibGVMaXN0LnNjcm9sbFRvcCgpIHx8IDA7XG5cbiAgICAkdmFyaWFibGVMaXN0LmVtcHR5KCk7XG5cbiAgICBpZiAodmFyaWFibGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgJHZhcmlhYmxlTGlzdC5odG1sKCc8ZGl2IGNsYXNzPVwiZW1wdHktc3RhdGVcIj48cD7mmoLml6Dlj5jph488L3A+PC9kaXY+Jyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8g5qC55o2u5Y+Y6YeP57G75Z6L6YCJ5oup5LiN5ZCM55qE5riy5p+T5pa55byPXG4gICAgaWYgKHR5cGUgPT09ICdtZXNzYWdlJykge1xuICAgICAgdGhpcy5yZW5kZXJNZXNzYWdlVmFyaWFibGVzQnlGbG9vcigkdmFyaWFibGVMaXN0LCB2YXJpYWJsZXMpO1xuICAgICAgJHZhcmlhYmxlTGlzdC5zY3JvbGxUb3Aoc2Nyb2xsVG9wKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZm9yIChjb25zdCB2YXJpYWJsZSBvZiB2YXJpYWJsZXMpIHtcbiAgICAgICAgY29uc3QgY2FyZCA9IHRoaXMuY2FyZEZhY3RvcnkuY3JlYXRlQ2FyZCh2YXJpYWJsZSk7XG4gICAgICAgICR2YXJpYWJsZUxpc3QuYXBwZW5kKGNhcmQpO1xuICAgICAgfVxuICAgICAgJHZhcmlhYmxlTGlzdC5zY3JvbGxUb3Aoc2Nyb2xsVG9wKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5bqU55So562b6YCJXG4gICAqIEBwYXJhbSBmaWx0ZXJTdGF0ZSDnrZvpgInnirbmgIFcbiAgICogQHBhcmFtIHNlYXJjaEtleXdvcmQg5pCc57Si5YWz6ZSu5a2XXG4gICAqL1xuICBwdWJsaWMgYXBwbHlDbGllbnRTaWRlRmlsdGVycyhmaWx0ZXJTdGF0ZTogUmVjb3JkPFZhcmlhYmxlRGF0YVR5cGUsIGJvb2xlYW4+LCBzZWFyY2hLZXl3b3JkOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBjb25zdCBhY3RpdmVUeXBlID0gdGhpcy5nZXRBY3RpdmVWYXJpYWJsZVR5cGUoKTtcbiAgICBjb25zdCAkdmFyaWFibGVDYXJkcyA9IHRoaXMuY29udGFpbmVyLmZpbmQoYCMke2FjdGl2ZVR5cGV9LWNvbnRlbnQgLnZhcmlhYmxlLWNhcmRgKTtcbiAgICBsZXQgdmlzaWJsZUNvdW50ID0gMDtcblxuICAgICR2YXJpYWJsZUNhcmRzLmVhY2goKF8sIGNhcmQpID0+IHtcbiAgICAgIGNvbnN0ICRjYXJkID0gJChjYXJkKTtcbiAgICAgIGNvbnN0IGNhcmRUeXBlID0gJGNhcmQuYXR0cignZGF0YS10eXBlJykgYXMgVmFyaWFibGVEYXRhVHlwZTtcbiAgICAgIGNvbnN0IGNhcmROYW1lID0gKCRjYXJkLmZpbmQoJy52YXJpYWJsZS10aXRsZScpLnZhbCgpIGFzIHN0cmluZykgfHwgJyc7XG5cbiAgICAgIGNvbnN0IHR5cGVWaXNpYmxlID0gZmlsdGVyU3RhdGVbY2FyZFR5cGVdO1xuICAgICAgY29uc3Qga2V5d29yZFZpc2libGUgPSAhc2VhcmNoS2V5d29yZCB8fCBjYXJkTmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHNlYXJjaEtleXdvcmQudG9Mb3dlckNhc2UoKSk7XG5cbiAgICAgIGlmICh0eXBlVmlzaWJsZSAmJiBrZXl3b3JkVmlzaWJsZSkge1xuICAgICAgICAkY2FyZC5zaG93KCk7XG4gICAgICAgIHZpc2libGVDb3VudCsrO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgJGNhcmQuaGlkZSgpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8g5pu05paw56m654q25oCB5pi+56S6XG4gICAgdGhpcy51cGRhdGVGaWx0ZXJFbXB0eVN0YXRlKGFjdGl2ZVR5cGUsIHZpc2libGVDb3VudCk7XG4gIH1cblxuICAvKipcbiAgICog5pu05paw562b6YCJ5ZCO55qE56m654q25oCB5pi+56S6XG4gICAqIEBwYXJhbSB0eXBlIOWPmOmHj+exu+Wei1xuICAgKiBAcGFyYW0gdmlzaWJsZUNvdW50IOWPr+ingeWNoeeJh+aVsOmHj1xuICAgKi9cbiAgcHJpdmF0ZSB1cGRhdGVGaWx0ZXJFbXB0eVN0YXRlKHR5cGU6IFZhcmlhYmxlVHlwZSwgdmlzaWJsZUNvdW50OiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zdCAkdmFyaWFibGVMaXN0ID0gdGhpcy5jb250YWluZXIuZmluZChgIyR7dHlwZX0tY29udGVudCAudmFyaWFibGUtbGlzdGApO1xuICAgIGNvbnN0ICRleGlzdGluZ0VtcHR5U3RhdGUgPSAkdmFyaWFibGVMaXN0LmZpbmQoJy5maWx0ZXItZW1wdHktc3RhdGUnKTtcblxuICAgIGlmICh2aXNpYmxlQ291bnQgPT09IDApIHtcbiAgICAgIC8vIOajgOafpeaYr+WQpuacieWPmOmHj+WNoeeJh++8iOWNs+S9v+iiq+makOiXj++8iVxuICAgICAgY29uc3QgdG90YWxDYXJkcyA9ICR2YXJpYWJsZUxpc3QuZmluZCgnLnZhcmlhYmxlLWNhcmQnKS5sZW5ndGg7XG4gICAgICBpZiAodG90YWxDYXJkcyA+IDApIHtcbiAgICAgICAgaWYgKCRleGlzdGluZ0VtcHR5U3RhdGUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgJHZhcmlhYmxlTGlzdC5hcHBlbmQoJzxkaXYgY2xhc3M9XCJmaWx0ZXItZW1wdHktc3RhdGVcIj48cD7msqHmnInnrKblkIjnrZvpgInmnaHku7bnmoTlj5jph488L3A+PC9kaXY+Jyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgJGV4aXN0aW5nRW1wdHlTdGF0ZS5yZW1vdmUoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5oyJ5qW85bGC5riy5p+TbWVzc2FnZeexu+Wei+eahOWPmOmHj1xuICAgKiBAcGFyYW0gY29udGFpbmVyIOWuueWZqOWFg+e0oFxuICAgKiBAcGFyYW0gdmFyaWFibGVzIOWPmOmHj+WIl+ihqFxuICAgKi9cbiAgcHJpdmF0ZSByZW5kZXJNZXNzYWdlVmFyaWFibGVzQnlGbG9vcihjb250YWluZXI6IEpRdWVyeTxIVE1MRWxlbWVudD4sIHZhcmlhYmxlczogVmFyaWFibGVJdGVtW10pOiB2b2lkIHtcbiAgICAvLyDmjInmpbzlsYLliIbnu4Tlj5jph49cbiAgICBjb25zdCBmbG9vckdyb3VwczogTWFwPG51bWJlciwgVmFyaWFibGVJdGVtW10+ID0gbmV3IE1hcCgpO1xuXG4gICAgZm9yIChjb25zdCB2YXJpYWJsZSBvZiB2YXJpYWJsZXMpIHtcbiAgICAgIGlmICh2YXJpYWJsZS5tZXNzYWdlX2lkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgaWYgKCFmbG9vckdyb3Vwcy5oYXModmFyaWFibGUubWVzc2FnZV9pZCkpIHtcbiAgICAgICAgICBmbG9vckdyb3Vwcy5zZXQodmFyaWFibGUubWVzc2FnZV9pZCwgW10pO1xuICAgICAgICB9XG4gICAgICAgIGZsb29yR3JvdXBzLmdldCh2YXJpYWJsZS5tZXNzYWdlX2lkKSEucHVzaCh2YXJpYWJsZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3Qgc29ydGVkRmxvb3JzID0gQXJyYXkuZnJvbShmbG9vckdyb3Vwcy5rZXlzKCkpLnNvcnQoKGEsIGIpID0+IGIgLSBhKTsgLy8g6ZmN5bqP5o6S5YiX77yM5pyA5paw5qW85bGC5Zyo5LiKXG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNvcnRlZEZsb29ycy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgZmxvb3IgPSBzb3J0ZWRGbG9vcnNbaV07XG4gICAgICBjb25zdCBmbG9vclZhcmlhYmxlcyA9IGZsb29yR3JvdXBzLmdldChmbG9vcikhO1xuICAgICAgY29uc3QgaXNFeHBhbmRlZCA9IGkgPT09IDA7IC8vIOWPquWxleW8gOacgOaWsOS4gOWxgualvFxuXG4gICAgICBjb25zdCAkcGFuZWwgPSB0aGlzLmNyZWF0ZUZsb29yUGFuZWwoZmxvb3IsIGlzRXhwYW5kZWQpO1xuICAgICAgY29uc3QgJHBhbmVsQm9keSA9ICRwYW5lbC5maW5kKCcuZmxvb3ItcGFuZWwtYm9keScpO1xuXG4gICAgICBmb3IgKGNvbnN0IHZhcmlhYmxlIG9mIGZsb29yVmFyaWFibGVzKSB7XG4gICAgICAgIGNvbnN0IGNhcmQgPSB0aGlzLmNhcmRGYWN0b3J5LmNyZWF0ZUNhcmQodmFyaWFibGUpO1xuICAgICAgICBjYXJkLmF0dHIoJ2RhdGEtZmxvb3ItaWQnLCBmbG9vci50b1N0cmluZygpKTtcbiAgICAgICAgJHBhbmVsQm9keS5hcHBlbmQoY2FyZCk7XG4gICAgICB9XG5cbiAgICAgIGNvbnRhaW5lci5hcHBlbmQoJHBhbmVsKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog5Yib5bu65qW85bGC5oqY5Y+g6Z2i5p2/XG4gICAqIEBwYXJhbSBmbG9vciDmpbzlsYLlj7dcbiAgICogQHBhcmFtIGlzRXhwYW5kZWQg5piv5ZCm6buY6K6k5bGV5byAXG4gICAqIEByZXR1cm5zIOaKmOWPoOmdouadv2pRdWVyeeWvueixoVxuICAgKi9cbiAgcHJpdmF0ZSBjcmVhdGVGbG9vclBhbmVsKGZsb29yOiBudW1iZXIsIGlzRXhwYW5kZWQ6IGJvb2xlYW4pOiBKUXVlcnk8SFRNTEVsZW1lbnQ+IHtcbiAgICBjb25zdCB0aXRsZUNvbnRlbnQgPSBgIyAke2Zsb29yfSDmpbxgO1xuXG4gICAgY29uc3QgJHBhbmVsID0gJChgXG4gICAgICA8ZGl2IGNsYXNzPVwiZmxvb3ItcGFuZWxcIiBkYXRhLWZsb29yPVwiJHtmbG9vcn1cIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImZsb29yLXBhbmVsLWhlYWRlciBmbGV4IHNwYWNlQmV0d2VlbiBhbGlnbkl0ZW1zQ2VudGVyXCI+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cImZsb29yLXBhbmVsLXRpdGxlXCI+JHt0aXRsZUNvbnRlbnR9PC9kaXY+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cImZsb29yLXBhbmVsLWljb24gJHtpc0V4cGFuZGVkID8gJ2V4cGFuZGVkJyA6ICcnfVwiPlxuICAgICAgICAgICAgPGkgY2xhc3M9XCJmYS1zb2xpZCBmYS1jaGV2cm9uLWRvd25cIj48L2k+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzPVwiZmxvb3ItcGFuZWwtYm9keSAke2lzRXhwYW5kZWQgPyAnZXhwYW5kZWQnIDogJyd9XCI+PC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICBgKTtcblxuICAgICRwYW5lbC5maW5kKCcuZmxvb3ItcGFuZWwtaGVhZGVyJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgJHRoaXMgPSAkKHRoaXMpO1xuICAgICAgY29uc3QgJGljb24gPSAkdGhpcy5maW5kKCcuZmxvb3ItcGFuZWwtaWNvbicpO1xuICAgICAgY29uc3QgJGJvZHkgPSAkdGhpcy5jbG9zZXN0KCcuZmxvb3ItcGFuZWwnKS5maW5kKCcuZmxvb3ItcGFuZWwtYm9keScpO1xuXG4gICAgICAkaWNvbi50b2dnbGVDbGFzcygnZXhwYW5kZWQnKTtcbiAgICAgICRib2R5LnRvZ2dsZUNsYXNzKCdleHBhbmRlZCcpO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuICRwYW5lbDtcbiAgfVxuXG4gIC8qKlxuICAgKiDliJvlu7rmlrDlj5jph4/ljaHniYdcbiAgICogQHBhcmFtIHR5cGUg5Y+Y6YeP57G75Z6LXG4gICAqIEBwYXJhbSBkYXRhVHlwZSDlj5jph4/mlbDmja7nsbvlnotcbiAgICogQHBhcmFtIGZsb29ySWQg5qW85bGCSUQo5LuF55So5LqObWVzc2FnZeexu+WeiylcbiAgICovXG4gIHB1YmxpYyBhZGROZXdWYXJpYWJsZUNhcmQodHlwZTogVmFyaWFibGVUeXBlLCBkYXRhVHlwZTogVmFyaWFibGVEYXRhVHlwZSwgZmxvb3JJZD86IG51bWJlcik6IHZvaWQge1xuICAgIGNvbnN0ICRjb250ZW50ID0gdGhpcy5jb250YWluZXIuZmluZChgIyR7dHlwZX0tY29udGVudGApLmZpbmQoJy52YXJpYWJsZS1saXN0Jyk7XG4gICAgJGNvbnRlbnQuZmluZCgnLmVtcHR5LXN0YXRlJykucmVtb3ZlKCk7XG5cbiAgICBjb25zdCBkZWZhdWx0VmFyaWFibGU6IFZhcmlhYmxlSXRlbSA9IHtcbiAgICAgIG5hbWU6ICduZXdfdmFyaWFibGUnLFxuICAgICAgdmFsdWU6IFZhcmlhYmxlTWFuYWdlclV0aWwuZ2V0RGVmYXVsdFZhbHVlRm9yVHlwZShkYXRhVHlwZSksXG4gICAgICBkYXRhVHlwZTogZGF0YVR5cGUsXG4gICAgICBpZDogdXVpZHY0KCksXG4gICAgfTtcblxuICAgIGNvbnN0IG5ld0NhcmQgPSB0aGlzLmNhcmRGYWN0b3J5LmNyZWF0ZUNhcmQoZGVmYXVsdFZhcmlhYmxlKTtcbiAgICBuZXdDYXJkLmF0dHIoJ2RhdGEtdHlwZScsIGRhdGFUeXBlKTtcblxuICAgIGlmICh0eXBlID09PSAnbWVzc2FnZScgJiYgZmxvb3JJZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLmFkZENhcmRUb0Zsb29yUGFuZWwoJGNvbnRlbnQsIG5ld0NhcmQsIGZsb29ySWQpO1xuICAgIH0gZWxzZSB7XG4gICAgICAkY29udGVudC5wcmVwZW5kKG5ld0NhcmQpO1xuICAgICAgdGhpcy5hZGRBbmltYXRpb24obmV3Q2FyZCwgJ3ZhcmlhYmxlLWFkZGVkJywgKCkgPT4ge30pO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDlsIbljaHniYfmt7vliqDliLDmjIflrprmpbzlsYLpnaLmnb9cbiAgICogQHBhcmFtIGNvbnRlbnQg5YaF5a655a655ZmoXG4gICAqIEBwYXJhbSBjYXJkIOWNoeeJh+WFg+e0oFxuICAgKiBAcGFyYW0gZmxvb3JJZCDmpbzlsYJJRFxuICAgKi9cbiAgcHJpdmF0ZSBhZGRDYXJkVG9GbG9vclBhbmVsKGNvbnRlbnQ6IEpRdWVyeTxIVE1MRWxlbWVudD4sIGNhcmQ6IEpRdWVyeTxIVE1MRWxlbWVudD4sIGZsb29ySWQ6IG51bWJlcik6IHZvaWQge1xuICAgIGxldCAkZmxvb3JQYW5lbCA9IGNvbnRlbnQuZmluZChgLmZsb29yLXBhbmVsW2RhdGEtZmxvb3I9XCIke2Zsb29ySWR9XCJdYCk7XG5cbiAgICBpZiAoJGZsb29yUGFuZWwubGVuZ3RoID09PSAwKSB7XG4gICAgICBjb25zdCAkcGFuZWwgPSB0aGlzLmNyZWF0ZUZsb29yUGFuZWwoZmxvb3JJZCwgdHJ1ZSk7XG4gICAgICB0aGlzLmluc2VydEZsb29yUGFuZWxJbk9yZGVyKGNvbnRlbnQsICRwYW5lbCwgZmxvb3JJZCk7XG4gICAgICAkZmxvb3JQYW5lbCA9ICRwYW5lbDtcbiAgICB9XG5cbiAgICBjb25zdCAkcGFuZWxCb2R5ID0gJGZsb29yUGFuZWwuZmluZCgnLmZsb29yLXBhbmVsLWJvZHknKTtcblxuICAgIGlmICghJHBhbmVsQm9keS5oYXNDbGFzcygnZXhwYW5kZWQnKSkge1xuICAgICAgJGZsb29yUGFuZWwuZmluZCgnLmZsb29yLXBhbmVsLWljb24nKS5hZGRDbGFzcygnZXhwYW5kZWQnKTtcbiAgICAgICRwYW5lbEJvZHkuYWRkQ2xhc3MoJ2V4cGFuZGVkJyk7XG4gICAgfVxuXG4gICAgY2FyZC5hdHRyKCdkYXRhLWZsb29yLWlkJywgZmxvb3JJZC50b1N0cmluZygpKTtcbiAgICAkcGFuZWxCb2R5LnByZXBlbmQoY2FyZCk7XG4gICAgdGhpcy5hZGRBbmltYXRpb24oY2FyZCwgJ3ZhcmlhYmxlLWFkZGVkJywgKCkgPT4ge30pO1xuICB9XG5cbiAgLyoqXG4gICAqIOaMiealvOWxguWPt+mhuuW6j+aPkuWFpealvOWxgumdouadv1xuICAgKiBAcGFyYW0gY29udGVudCDlhoXlrrnlrrnlmahcbiAgICogQHBhcmFtIHBhbmVsIOimgeaPkuWFpeeahOmdouadv1xuICAgKiBAcGFyYW0gZmxvb3JJZCDmpbzlsYJJRFxuICAgKi9cbiAgcHJpdmF0ZSBpbnNlcnRGbG9vclBhbmVsSW5PcmRlcihjb250ZW50OiBKUXVlcnk8SFRNTEVsZW1lbnQ+LCBwYW5lbDogSlF1ZXJ5PEhUTUxFbGVtZW50PiwgZmxvb3JJZDogbnVtYmVyKTogdm9pZCB7XG4gICAgbGV0IGluc2VydGVkID0gZmFsc2U7XG4gICAgY29udGVudC5maW5kKCcuZmxvb3ItcGFuZWwnKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIGNvbnN0IGV4aXN0aW5nRmxvb3IgPSBwYXJzZUludCgkKHRoaXMpLmF0dHIoJ2RhdGEtZmxvb3InKSB8fCAnMCcpO1xuICAgICAgaWYgKGZsb29ySWQgPiBleGlzdGluZ0Zsb29yKSB7XG4gICAgICAgICQodGhpcykuYmVmb3JlKHBhbmVsKTtcbiAgICAgICAgaW5zZXJ0ZWQgPSB0cnVlO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH0pO1xuXG4gICAgaWYgKCFpbnNlcnRlZCkge1xuICAgICAgY29udGVudC5wcmVwZW5kKHBhbmVsKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog6I635Y+W5Y+Y6YeP5Y2h54mH5L+h5oGvXG4gICAqIEBwYXJhbSBjYXJkIOWNoeeJh+WFg+e0oFxuICAgKiBAcmV0dXJucyDljaHniYfkuK3nmoTlj5jph4/kv6Hmga9cbiAgICovXG4gIHB1YmxpYyBnZXRWYXJpYWJsZUZyb21DYXJkKGNhcmQ6IEpRdWVyeTxIVE1MRWxlbWVudD4pOiBWYXJpYWJsZUl0ZW0gfCBudWxsIHtcbiAgICByZXR1cm4gdGhpcy5jYXJkRmFjdG9yeS5nZXRWYXJpYWJsZUZyb21DYXJkKGNhcmQpO1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPluWPmOmHj+WNoeeJh+WQjeensFxuICAgKiBAcGFyYW0gY2FyZCDljaHniYflhYPntKBcbiAgICogQHJldHVybnMg5Y2h54mH5Lit55qE5Y+Y6YeP5ZCN56ewXG4gICAqL1xuICBwdWJsaWMgZ2V0VmFyaWFibGVDYXJkTmFtZShjYXJkOiBKUXVlcnk8SFRNTEVsZW1lbnQ+KTogc3RyaW5nIHtcbiAgICBjb25zdCB2YXJpYWJsZSA9IHRoaXMuZ2V0VmFyaWFibGVGcm9tQ2FyZChjYXJkKTtcbiAgICByZXR1cm4gdmFyaWFibGU/Lm5hbWUgfHwgJyc7XG4gIH1cblxuICAvKipcbiAgICog5pi+56S65re75Yqg5Y+Y6YeP6YCJ5oup5a+56K+d5qGGXG4gICAqIEBwYXJhbSBjYWxsYmFjayDpgInmi6nlkI7nmoTlm57osIPlh73mlbBcbiAgICovXG4gIHB1YmxpYyBhc3luYyBzaG93QWRkVmFyaWFibGVEaWFsb2coY2FsbGJhY2s6IChkYXRhVHlwZTogVmFyaWFibGVEYXRhVHlwZSwgZmxvb3JJZD86IG51bWJlcikgPT4gdm9pZCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGN1cnJlbnRUeXBlID0gdGhpcy5nZXRBY3RpdmVWYXJpYWJsZVR5cGUoKTtcblxuICAgIGlmIChjdXJyZW50VHlwZSA9PT0gJ21lc3NhZ2UnKSB7XG4gICAgICBhd2FpdCB0aGlzLnNob3dGbG9vcklucHV0RGlhbG9nKGFzeW5jIGZsb29ySWQgPT4ge1xuICAgICAgICBpZiAoZmxvb3JJZCA9PT0gbnVsbCkgcmV0dXJuO1xuXG4gICAgICAgIGF3YWl0IHRoaXMuc2hvd1ZhcmlhYmxlVHlwZURpYWxvZyhkYXRhVHlwZSA9PiB7XG4gICAgICAgICAgY2FsbGJhY2soZGF0YVR5cGUsIGZsb29ySWQpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGF3YWl0IHRoaXMuc2hvd1ZhcmlhYmxlVHlwZURpYWxvZyhkYXRhVHlwZSA9PiB7XG4gICAgICBjYWxsYmFjayhkYXRhVHlwZSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog5pi+56S65qW85bGC6L6T5YWl5a+56K+d5qGGXG4gICAqIEBwYXJhbSBjYWxsYmFjayDovpPlhaXlrozmiJDlkI7nmoTlm57osIPlh73mlbBcbiAgICovXG4gIHB1YmxpYyBhc3luYyBzaG93Rmxvb3JJbnB1dERpYWxvZyhjYWxsYmFjazogKGZsb29ySWQ6IG51bWJlciB8IG51bGwpID0+IHZvaWQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBjb250ZW50ID0gJChgXG4gICAgICA8ZGl2PlxuICAgICAgICA8aDM+6L6T5YWl5qW85bGC5Y+356CBPC9oMz5cbiAgICAgICAgPGRpdiBjbGFzcz1cImZsb29yLWlucHV0LWRpYWxvZ1wiPlxuICAgICAgICAgIDxpbnB1dCB0eXBlPVwibnVtYmVyXCIgaWQ9XCJmbG9vci1pbnB1dFwiIG1pbj1cIjBcIiBwbGFjZWhvbGRlcj1cIuivt+i+k+WFpealvOWxguWPt+eggVwiIC8+XG4gICAgICAgICAgPGRpdiBpZD1cImZsb29yLWlucHV0LWVycm9yXCIgY2xhc3M9XCJmbG9vci1maWx0ZXItZXJyb3JcIiBzdHlsZT1cImRpc3BsYXk6IG5vbmVcIj7or7fovpPlhaXmnInmlYjnmoTmpbzlsYLlj7fnoIE8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICBgKTtcblxuICAgIGNvbnN0ICRpbnB1dEZpZWxkID0gY29udGVudC5maW5kKCcjZmxvb3ItaW5wdXQnKTtcbiAgICBjb25zdCAkZXJyb3JNc2cgPSBjb250ZW50LmZpbmQoJyNmbG9vci1pbnB1dC1lcnJvcicpO1xuXG4gICAgY29uc3QgbGFzdE1lc3NhZ2VJZCA9IGdldExhc3RNZXNzYWdlSWQoKTtcbiAgICBpZiAobGFzdE1lc3NhZ2VJZCA+PSAwKSB7XG4gICAgICAkaW5wdXRGaWVsZC52YWwobGFzdE1lc3NhZ2VJZCk7XG4gICAgfVxuXG4gICAgLy8g5re75Yqg6L6T5YWl6aqM6K+BXG4gICAgJGlucHV0RmllbGQub24oJ2lucHV0JywgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgdmFsdWUgPSBwYXJzZUludCgkKHRoaXMpLnZhbCgpIGFzIHN0cmluZywgMTApO1xuICAgICAgaWYgKCQodGhpcykudmFsKCkgJiYgKGlzTmFOKHZhbHVlKSB8fCB2YWx1ZSA8IDApKSB7XG4gICAgICAgICRlcnJvck1zZy50ZXh0KCfmpbzlsYLlj7fnoIHkuI3og73lsI/kuo4wJykuc2hvdygpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgJGVycm9yTXNnLmhpZGUoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNhbGxHZW5lcmljUG9wdXAoY29udGVudCwgUE9QVVBfVFlQRS5DT05GSVJNLCAnJywge1xuICAgICAgb2tCdXR0b246ICfnoa7orqQnLFxuICAgICAgY2FuY2VsQnV0dG9uOiAn5Y+W5raIJyxcbiAgICB9KTtcblxuICAgIGlmICghcmVzdWx0KSB7XG4gICAgICBjYWxsYmFjayhudWxsKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBpbnB1dFZhbHVlID0gJGlucHV0RmllbGQudmFsKCkgYXMgc3RyaW5nO1xuICAgIGNvbnN0IGZsb29ySWQgPSBwYXJzZUludChpbnB1dFZhbHVlLCAxMCk7XG5cbiAgICBpZiAoIWlucHV0VmFsdWUudHJpbSgpIHx8IGlzTmFOKGZsb29ySWQpKSB7XG4gICAgICAkZXJyb3JNc2cudGV4dCgn6K+36L6T5YWl5pyJ5pWI55qE5qW85bGC5Y+356CBJykuc2hvdygpO1xuICAgICAgc2V0VGltZW91dCgoKSA9PiB0aGlzLnNob3dGbG9vcklucHV0RGlhbG9nKGNhbGxiYWNrKSwgMTAwKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoZmxvb3JJZCA8IDApIHtcbiAgICAgICRlcnJvck1zZy50ZXh0KCfmpbzlsYLlj7fnoIHkuI3og73lsI/kuo4wJykuc2hvdygpO1xuICAgICAgc2V0VGltZW91dCgoKSA9PiB0aGlzLnNob3dGbG9vcklucHV0RGlhbG9nKGNhbGxiYWNrKSwgMTAwKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjYWxsYmFjayhmbG9vcklkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmmL7npLrlj5jph4/nsbvlnovpgInmi6nlr7nor53moYZcbiAgICogQHBhcmFtIGNhbGxiYWNrIOmAieaLqeWQjueahOWbnuiwg+WHveaVsFxuICAgKiBAcGFyYW0gZmxvb3JJZCDmpbzlsYJJRCjku4XnlKjkuo5tZXNzYWdl57G75Z6LKVxuICAgKi9cbiAgcHVibGljIGFzeW5jIHNob3dWYXJpYWJsZVR5cGVEaWFsb2coY2FsbGJhY2s6IChkYXRhVHlwZTogVmFyaWFibGVEYXRhVHlwZSkgPT4gdm9pZCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGNvbnRlbnQgPSAkKGBcbiAgICAgIDxkaXY+XG4gICAgICAgIDxoMz7pgInmi6nlj5jph4/nsbvlnos8L2gzPlxuICAgICAgICA8ZGl2IGNsYXNzPVwidmFyaWFibGUtdHlwZS1vcHRpb25zXCI+XG4gICAgICAgICAgPGRpdiBkYXRhLXR5cGU9XCJzdHJpbmdcIj48aSBjbGFzcz1cImZhLXJlZ3VsYXIgZmEtZm9udFwiPjwvaT4g5a2X56ym5LiyPC9kaXY+XG4gICAgICAgICAgPGRpdiBkYXRhLXR5cGU9XCJudW1iZXJcIj48aSBjbGFzcz1cImZhLXJlZ3VsYXIgZmEtaGFzaHRhZ1wiPjwvaT4g5pWw5a2XPC9kaXY+XG4gICAgICAgICAgPGRpdiBkYXRhLXR5cGU9XCJib29sZWFuXCI+PGkgY2xhc3M9XCJmYS1yZWd1bGFyIGZhLXRvZ2dsZS1vblwiPjwvaT4g5biD5bCU5YC8PC9kaXY+XG4gICAgICAgICAgPGRpdiBkYXRhLXR5cGU9XCJhcnJheVwiPjxpIGNsYXNzPVwiZmEtcmVndWxhciBmYS1saXN0XCI+PC9pPiDmlbDnu4Q8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGRhdGEtdHlwZT1cIm9iamVjdFwiPjxpIGNsYXNzPVwiZmEtcmVndWxhciBmYS1jb2RlXCI+PC9pPiDlr7nosaE8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICBgKTtcblxuICAgIGNvbnRlbnQuZmluZCgnLnZhcmlhYmxlLXR5cGUtb3B0aW9ucyBkaXYnKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCBkYXRhVHlwZSA9ICQodGhpcykuYXR0cignZGF0YS10eXBlJykgYXMgVmFyaWFibGVEYXRhVHlwZTtcbiAgICAgIGNhbGxiYWNrKGRhdGFUeXBlKTtcblxuICAgICAgJCgnLnBvcHVwJykuZmluZCgnLnBvcHVwLWJ1dHRvbi1jbG9zZScpLnRyaWdnZXIoJ2NsaWNrJyk7XG4gICAgfSk7XG5cbiAgICBhd2FpdCBjYWxsR2VuZXJpY1BvcHVwKGNvbnRlbnQsIFBPUFVQX1RZUEUuRElTUExBWSk7XG4gIH1cblxuICAvKipcbiAgICog5pi+56S656Gu6K6k5a+56K+d5qGGXG4gICAqIEBwYXJhbSBtZXNzYWdlIOehruiupOS/oeaBr1xuICAgKiBAcGFyYW0gY2FsbGJhY2sg56Gu6K6k5ZCO55qE5Zue6LCDXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgc2hvd0NvbmZpcm1EaWFsb2cobWVzc2FnZTogc3RyaW5nLCBjYWxsYmFjazogKGNvbmZpcm1lZDogYm9vbGVhbikgPT4gdm9pZCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNhbGxHZW5lcmljUG9wdXAobWVzc2FnZSwgUE9QVVBfVFlQRS5DT05GSVJNLCAnJywge1xuICAgICAgb2tCdXR0b246ICfnoa7orqQnLFxuICAgICAgY2FuY2VsQnV0dG9uOiAn5Y+W5raIJyxcbiAgICB9KTtcblxuICAgIGNhbGxiYWNrKCEhcmVzdWx0KTtcbiAgfVxuXG4gIC8qKlxuICAgKiDmuLLmn5Plj5jph4/nrqHnkIblmajmta7nqpdcbiAgICog5Yib5bu65Y+v5ouW5Yqo44CB5Y+v6LCD5pW05aSn5bCP55qE5rWu56qXXG4gICAqL1xuICBwdWJsaWMgcmVuZGVyKCk6IHZvaWQge1xuICAgIHRoaXMudW5yZW5kZXIoKTtcblxuICAgIHRoaXMuZGlhbG9nID0gJChgXG4gICAgICA8ZGl2IGNsYXNzPVwidmFyaWFibGUtbWFuYWdlci1kaWFsb2dcIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImRpYWxvZy1oZWFkZXJcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiZGlhbG9nLXRpdGxlXCI+5Y+Y6YeP566h55CG5ZmoPC9kaXY+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cImRpYWxvZy1jb250cm9sc1wiPlxuICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImRpYWxvZy10b2dnbGUtYnRuXCIgdGl0bGU9XCLmipjlj6Av5bGV5byA5YaF5a65XCI+PGkgY2xhc3M9XCJmYS1zb2xpZCBmYS1jaGV2cm9uLXVwXCI+PC9pPjwvYnV0dG9uPlxuICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImRpYWxvZy1jbG9zZS1idG5cIj48aSBjbGFzcz1cImZhLXNvbGlkIGZhLXRpbWVzXCI+PC9pPjwvYnV0dG9uPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImRpYWxvZy1jb250ZW50XCI+PC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJkaWFsb2ctcmVzaXplLWhhbmRsZVwiPjwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgYCk7XG5cbiAgICB0aGlzLmRpYWxvZy5maW5kKCcuZGlhbG9nLWNvbnRlbnQnKS5hcHBlbmQodGhpcy5jb250YWluZXIpO1xuXG4gICAgdGhpcy5kaWFsb2cuZmluZCgnLmRpYWxvZy1jbG9zZS1idG4nKS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLnVucmVuZGVyKCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLmRpYWxvZy5maW5kKCcuZGlhbG9nLXRvZ2dsZS1idG4nKS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgICBjb25zdCAkY29udGVudCA9IHRoaXMuZGlhbG9nIS5maW5kKCcuZGlhbG9nLWNvbnRlbnQnKTtcbiAgICAgIGNvbnN0ICR0b2dnbGVCdG4gPSB0aGlzLmRpYWxvZyEuZmluZCgnLmRpYWxvZy10b2dnbGUtYnRuIGknKTtcblxuICAgICAgJGNvbnRlbnQuc2xpZGVUb2dnbGUoMzAwLCAoKSA9PiB7XG4gICAgICAgIGlmICgkY29udGVudC5pcygnOnZpc2libGUnKSkge1xuICAgICAgICAgICR0b2dnbGVCdG4ucmVtb3ZlQ2xhc3MoJ2ZhLWNoZXZyb24tZG93bicpLmFkZENsYXNzKCdmYS1jaGV2cm9uLXVwJyk7XG4gICAgICAgICAgdGhpcy5kaWFsb2chLmZpbmQoJy5kaWFsb2ctcmVzaXplLWhhbmRsZScpLnNob3coKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAkdG9nZ2xlQnRuLnJlbW92ZUNsYXNzKCdmYS1jaGV2cm9uLXVwJykuYWRkQ2xhc3MoJ2ZhLWNoZXZyb24tZG93bicpO1xuICAgICAgICAgIHRoaXMuZGlhbG9nIS5maW5kKCcuZGlhbG9nLXJlc2l6ZS1oYW5kbGUnKS5oaWRlKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLmRpYWxvZyEudG9nZ2xlQ2xhc3MoJ2NvbnRlbnQtY29sbGFwc2VkJyk7XG4gICAgfSk7XG5cbiAgICAkKCdib2R5JykuYXBwZW5kKHRoaXMuZGlhbG9nKTtcblxuICAgIHRoaXMuaW5pdERyYWdnYWJsZURpYWxvZygpO1xuICAgIHRoaXMuY2VudGVyRGlhbG9nKCk7XG4gICAgdGhpcy5jb250YWluZXIuc2hvdygpO1xuICB9XG5cbiAgLyoqXG4gICAqIOWFs+mXreW5tua4heeQhuWPmOmHj+euoeeQhuWZqOa1rueql1xuICAgKi9cbiAgcHVibGljIHVucmVuZGVyKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmRpYWxvZykge1xuICAgICAgdGhpcy5jb250YWluZXIuZGV0YWNoKCk7XG4gICAgICB0aGlzLmRpYWxvZy5yZW1vdmUoKTtcbiAgICAgIHRoaXMuZGlhbG9nID0gbnVsbDtcblxuICAgICAgaWYgKHRoaXMuY29udHJvbGxlcikge1xuICAgICAgICB0aGlzLmNvbnRyb2xsZXIuY2xlYW51cCgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDliJ3lp4vljJbmta7nqpfnmoTmi5bliqjlkozosIPmlbTlpKflsI/lip/og71cbiAgICovXG4gIHByaXZhdGUgaW5pdERyYWdnYWJsZURpYWxvZygpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuZGlhbG9nKSByZXR1cm47XG5cbiAgICBjb25zdCBpc01vYmlsZURldmljZSA9IGlzTW9iaWxlKCk7XG5cbiAgICAodGhpcy5kaWFsb2cgYXMgYW55KS5kcmFnZ2FibGUoe1xuICAgICAgaGFuZGxlOiAnLmRpYWxvZy1oZWFkZXInLFxuICAgICAgY29udGFpbm1lbnQ6ICd3aW5kb3cnLFxuICAgICAgc3RhcnQ6ICgpID0+IHtcbiAgICAgICAgdGhpcy5kaWFsb2c/LmFkZENsYXNzKCdkcmFnZ2luZycpO1xuICAgICAgfSxcbiAgICAgIHN0b3A6ICgpID0+IHtcbiAgICAgICAgdGhpcy5kaWFsb2c/LnJlbW92ZUNsYXNzKCdkcmFnZ2luZycpO1xuICAgICAgfSxcbiAgICB9KTtcblxuICAgICh0aGlzLmRpYWxvZyBhcyBhbnkpLnJlc2l6YWJsZSh7XG4gICAgICAvLyDmoYzpnaLorr7lpIfnlKjmiYDmnInovrnnvJjvvIznp7vliqjorr7lpIfku4XnlKjlj7PkuIvop5JcbiAgICAgIGhhbmRsZXM6IGlzTW9iaWxlRGV2aWNlID8gJ3NlJyA6ICduLGUscyx3LG5lLHNlLHN3LG53JyxcbiAgICAgIG1pbkhlaWdodDogVmFyaWFibGVWaWV3Lk1JTl9ESUFMT0dfSEVJR0hULFxuICAgICAgbWluV2lkdGg6IFZhcmlhYmxlVmlldy5NSU5fRElBTE9HX1dJRFRILFxuICAgICAgc3RhcnQ6ICgpID0+IHtcbiAgICAgICAgdGhpcy5kaWFsb2c/LmFkZENsYXNzKCdyZXNpemluZycpO1xuICAgICAgfSxcbiAgICAgIHN0b3A6ICgpID0+IHtcbiAgICAgICAgdGhpcy5kaWFsb2c/LnJlbW92ZUNsYXNzKCdyZXNpemluZycpO1xuICAgICAgfSxcbiAgICB9KTtcblxuICAgIHRoaXMuZGlhbG9nLmZpbmQoJy5kaWFsb2ctcmVzaXplLWhhbmRsZScpLnRvZ2dsZShpc01vYmlsZURldmljZSk7XG4gIH1cblxuICAvKipcbiAgICog5bCG5rWu56qX5bGF5Lit5pi+56S6XG4gICAqL1xuICBwcml2YXRlIGNlbnRlckRpYWxvZygpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuZGlhbG9nKSByZXR1cm47XG5cbiAgICBjb25zdCB3aW5kb3dXaWR0aCA9ICQod2luZG93KS53aWR0aCgpIHx8IDA7XG4gICAgY29uc3Qgd2luZG93SGVpZ2h0ID0gJCh3aW5kb3cpLmhlaWdodCgpIHx8IDA7XG5cbiAgICBjb25zdCBkaWFsb2dXaWR0aCA9IHRoaXMuZGlhbG9nLm91dGVyV2lkdGgoKSB8fCBWYXJpYWJsZVZpZXcuTUlOX0RJQUxPR19XSURUSDtcbiAgICBjb25zdCBkaWFsb2dIZWlnaHQgPSB0aGlzLmRpYWxvZy5vdXRlckhlaWdodCgpIHx8IFZhcmlhYmxlVmlldy5NSU5fRElBTE9HX0hFSUdIVDtcblxuICAgIGNvbnN0IGxlZnQgPSBNYXRoLm1heCgwLCAod2luZG93V2lkdGggLSBkaWFsb2dXaWR0aCkgLyAyKTtcbiAgICBjb25zdCB0b3AgPSBNYXRoLm1heCgwLCAod2luZG93SGVpZ2h0IC0gZGlhbG9nSGVpZ2h0KSAvIDIpO1xuXG4gICAgdGhpcy5kaWFsb2cuY3NzKHtcbiAgICAgIGxlZnQ6IGAke2xlZnR9cHhgLFxuICAgICAgdG9wOiBgJHt0b3B9cHhgLFxuICAgICAgcG9zaXRpb246ICdmaXhlZCcsXG4gICAgfSk7XG4gIH1cblxuICBwdWJsaWMgYWRkVmFyaWFibGVDYXJkKHZhcmlhYmxlOiBWYXJpYWJsZUl0ZW0pOiB2b2lkIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgbmV3Q2FyZCA9IHRoaXMuY2FyZEZhY3RvcnkuY3JlYXRlQ2FyZCh2YXJpYWJsZSk7XG4gICAgICBuZXdDYXJkLmF0dHIoJ2RhdGEtdHlwZScsIHZhcmlhYmxlLmRhdGFUeXBlKTtcblxuICAgICAgY29uc3QgYWN0aXZlVHlwZSA9IHRoaXMuZ2V0QWN0aXZlVmFyaWFibGVUeXBlKCk7XG4gICAgICBjb25zdCAkdmFyaWFibGVMaXN0ID0gdGhpcy5jb250YWluZXIuZmluZChgIyR7YWN0aXZlVHlwZX0tY29udGVudCAudmFyaWFibGUtbGlzdGApO1xuXG4gICAgICBpZiAoYWN0aXZlVHlwZSA9PT0gJ21lc3NhZ2UnICYmIHZhcmlhYmxlLm1lc3NhZ2VfaWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aGlzLmFkZENhcmRUb0Zsb29yUGFuZWwoJHZhcmlhYmxlTGlzdCwgbmV3Q2FyZCwgdmFyaWFibGUubWVzc2FnZV9pZCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkdmFyaWFibGVMaXN0LmZpbmQoJy5lbXB0eS1zdGF0ZScpLnJlbW92ZSgpO1xuICAgICAgICAkdmFyaWFibGVMaXN0LmFwcGVuZChuZXdDYXJkKTtcbiAgICAgICAgdGhpcy5hZGRBbmltYXRpb24obmV3Q2FyZCwgJ3ZhcmlhYmxlLWFkZGVkJywgKCkgPT4ge30pO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2cuZXJyb3IoYFtWYXJpYWJsZU1hbmFnZXJdIOa3u+WKoOWNoeeJh1wiJHt2YXJpYWJsZS5uYW1lfVwi5aSx6LSlOmAsIGVycm9yKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog56e76Zmk5Y+Y6YeP5Y2h54mHXG4gICAqIEBwYXJhbSB2YXJpYWJsZV9pZCDlj5jph49JRFxuICAgKi9cbiAgcHVibGljIHJlbW92ZVZhcmlhYmxlQ2FyZCh2YXJpYWJsZV9pZDogc3RyaW5nKTogdm9pZCB7XG4gICAgdHJ5IHtcbiAgICAgIGlmICghdmFyaWFibGVfaWQpIHtcbiAgICAgICAgbG9nLndhcm4oYFtWYXJpYWJsZU1hbmFnZXJdIOWPmOmHj0lE5Li656m677yM5peg5rOV56e76Zmk5Y2h54mHYCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgJGNhcmQgPSB0aGlzLmNvbnRhaW5lci5maW5kKGAudmFyaWFibGUtY2FyZFtkYXRhLXZhcmlhYmxlLWlkPVwiJHt2YXJpYWJsZV9pZH1cIl1gKTtcblxuICAgICAgaWYgKCRjYXJkLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBsb2cud2FybihgW1ZhcmlhYmxlTWFuYWdlcl0g5pyq5om+5YiwSUTkuLpcIiR7dmFyaWFibGVfaWR9XCLnmoTljaHniYdgKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmFkZEFuaW1hdGlvbigkY2FyZCwgJ3ZhcmlhYmxlLWRlbGV0ZWQnLCAoKSA9PiB7XG4gICAgICAgICRjYXJkLnJlbW92ZSgpO1xuICAgICAgICB0aGlzLmNoZWNrQW5kU2hvd0VtcHR5U3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2cuZXJyb3IoYFtWYXJpYWJsZU1hbmFnZXJdIOenu+mZpOWNoeeJh+Wksei0pTpgLCBlcnJvcik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOajgOafpeW5tuaYvuekuuepuueKtuaAgeaPkOekulxuICAgKi9cbiAgcHJpdmF0ZSBjaGVja0FuZFNob3dFbXB0eVN0YXRlKCk6IHZvaWQge1xuICAgIGNvbnN0IGFjdGl2ZVR5cGUgPSB0aGlzLmdldEFjdGl2ZVZhcmlhYmxlVHlwZSgpO1xuICAgIGNvbnN0ICR2YXJpYWJsZUxpc3QgPSB0aGlzLmNvbnRhaW5lci5maW5kKGAjJHthY3RpdmVUeXBlfS1jb250ZW50IC52YXJpYWJsZS1saXN0YCk7XG5cbiAgICBpZiAoJHZhcmlhYmxlTGlzdC5maW5kKCcudmFyaWFibGUtY2FyZCcpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgJHZhcmlhYmxlTGlzdC5odG1sKCc8ZGl2IGNsYXNzPVwiZW1wdHktc3RhdGVcIj48cD7mmoLml6Dlj5jph488L3A+PC9kaXY+Jyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOabtOaWsOWPmOmHj+WNoeeJh1xuICAgKiBAcGFyYW0gdmFyaWFibGUg5Y+Y6YePXG4gICAqL1xuICBwdWJsaWMgdXBkYXRlVmFyaWFibGVDYXJkKHZhcmlhYmxlOiBWYXJpYWJsZUl0ZW0pOiB2b2lkIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgJGNhcmQgPSB0aGlzLmNvbnRhaW5lci5maW5kKGAudmFyaWFibGUtY2FyZFtkYXRhLXZhcmlhYmxlLWlkPVwiJHt2YXJpYWJsZS5pZH1cIl1gKTtcblxuICAgICAgaWYgKCRjYXJkLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBsb2cud2FybihgW1ZhcmlhYmxlTWFuYWdlcl0g5pyq5om+5YiwSUTkuLpcIiR7dmFyaWFibGUuaWR9XCLnmoTljaHniYdgKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyDliJvlu7rmlrDljaHniYfmm7/mjaLml6fljaHniYfvvIzkv53mjIHkuIDoh7TmgKdcbiAgICAgIGNvbnN0IG5ld0NhcmQgPSB0aGlzLmNhcmRGYWN0b3J5LmNyZWF0ZUNhcmQodmFyaWFibGUpO1xuICAgICAgbmV3Q2FyZC5hdHRyKCdkYXRhLXR5cGUnLCB2YXJpYWJsZS5kYXRhVHlwZSk7XG5cbiAgICAgIGlmICh2YXJpYWJsZS5tZXNzYWdlX2lkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgbmV3Q2FyZC5hdHRyKCdkYXRhLWZsb29yLWlkJywgdmFyaWFibGUubWVzc2FnZV9pZC50b1N0cmluZygpKTtcbiAgICAgIH1cblxuICAgICAgJGNhcmQucmVwbGFjZVdpdGgobmV3Q2FyZCk7XG4gICAgICB0aGlzLmFkZEFuaW1hdGlvbihuZXdDYXJkLCAndmFyaWFibGUtY2hhbmdlZCcsICgpID0+IHt9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nLmVycm9yKGBbVmFyaWFibGVNYW5hZ2VyXSDmm7TmlrDljaHniYflpLHotKU6YCwgZXJyb3IpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDmmL7npLrplK7lkI3ovpPlhaXlr7nor53moYZcbiAgICogQHBhcmFtIGNhbGxiYWNrIOi+k+WFpeWujOaIkOWQjueahOWbnuiwg+WHveaVsFxuICAgKi9cbiAgcHVibGljIGFzeW5jIHNob3dLZXlOYW1lSW5wdXREaWFsb2coY2FsbGJhY2s6IChrZXlOYW1lOiBzdHJpbmcgfCBudWxsKSA9PiB2b2lkKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgY29udGVudCA9ICQoYFxuICAgICAgPGRpdj5cbiAgICAgICAgPGgzPui+k+WFpemUruWQjTwvaDM+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJrZXktaW5wdXQtZGlhbG9nXCI+XG4gICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgaWQ9XCJrZXktaW5wdXRcIiBwbGFjZWhvbGRlcj1cIuivt+i+k+WFpemUruWQjVwiIC8+XG4gICAgICAgICAgPGRpdiBpZD1cImtleS1pbnB1dC1lcnJvclwiIGNsYXNzPVwiaW5wdXQtZXJyb3JcIiBzdHlsZT1cImRpc3BsYXk6IG5vbmVcIj7or7fovpPlhaXmnInmlYjnmoTplK7lkI08L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICBgKTtcblxuICAgIGNvbnN0ICRpbnB1dEZpZWxkID0gY29udGVudC5maW5kKCcja2V5LWlucHV0Jyk7XG4gICAgY29uc3QgJGVycm9yTXNnID0gY29udGVudC5maW5kKCcja2V5LWlucHV0LWVycm9yJyk7XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjYWxsR2VuZXJpY1BvcHVwKGNvbnRlbnQsIFBPUFVQX1RZUEUuQ09ORklSTSwgJycsIHtcbiAgICAgIG9rQnV0dG9uOiAn56Gu6K6kJyxcbiAgICAgIGNhbmNlbEJ1dHRvbjogJ+WPlua2iCcsXG4gICAgfSk7XG5cbiAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgY2FsbGJhY2sobnVsbCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3Qga2V5TmFtZSA9ICRpbnB1dEZpZWxkLnZhbCgpIGFzIHN0cmluZztcbiAgICBpZiAoIWtleU5hbWUgfHwga2V5TmFtZS50cmltKCkgPT09ICcnKSB7XG4gICAgICAkZXJyb3JNc2cuc2hvdygpO1xuICAgICAgc2V0VGltZW91dCgoKSA9PiB0aGlzLnNob3dLZXlOYW1lSW5wdXREaWFsb2coY2FsbGJhY2spLCAxMCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY2FsbGJhY2soa2V5TmFtZS50cmltKCkpO1xuICB9XG5cbiAgLyoqXG4gICAqIOa3u+WKoOWKqOeUu+aViOaenFxuICAgKiBAcGFyYW0gZWxlbWVudCDopoHmt7vliqDliqjnlLvmlYjmnpznmoTlhYPntKBcbiAgICogQHBhcmFtIGFuaW1hdGlvbkNsYXNzIENTU+WKqOeUu+exu+WQjVxuICAgKiBAcGFyYW0gY2FsbGJhY2sg5Yqo55S757uT5p2f5ZCO55qE5Zue6LCDXG4gICAqL1xuICBwdWJsaWMgYWRkQW5pbWF0aW9uKGVsZW1lbnQ6IEpRdWVyeTxIVE1MRWxlbWVudD4sIGFuaW1hdGlvbkNsYXNzOiBzdHJpbmcsIGNhbGxiYWNrOiAoKSA9PiB2b2lkKTogdm9pZCB7XG4gICAgY29uc3QgbmFtZXNwYWNlID0gYGFuaW1hdGlvbi4ke2FuaW1hdGlvbkNsYXNzfWA7XG5cbiAgICBlbGVtZW50LmFkZENsYXNzKGFuaW1hdGlvbkNsYXNzKTtcblxuICAgIHZvaWQgZWxlbWVudFswXS5vZmZzZXRIZWlnaHQ7XG5cbiAgICBlbGVtZW50Lm9mZihgYW5pbWF0aW9uZW5kLiR7bmFtZXNwYWNlfWApO1xuXG4gICAgZWxlbWVudC5vbihgYW5pbWF0aW9uZW5kLiR7bmFtZXNwYWNlfWAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICQodGhpcykub2ZmKGBhbmltYXRpb25lbmQuJHtuYW1lc3BhY2V9YCk7XG4gICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKGFuaW1hdGlvbkNsYXNzKTtcbiAgICAgIGNhbGxiYWNrKCk7XG4gICAgfSk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/component/variable_manager/view.ts\n")},"./src/function/builtin.ts":
/*!*********************************!*\
  !*** ./src/function/builtin.ts ***!
  \*********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   builtin: () => (/* binding */ builtin)\n/* harmony export */ });\n/* harmony import */ var _compatibility__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/compatibility */ "./src/compatibility.ts");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/script */ "@sillytavern/script");\n\n\nconst builtin = {\n    addOneMessage: _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.addOneMessage,\n    saveSettings: _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.saveSettings,\n    reloadEditor: _compatibility__WEBPACK_IMPORTED_MODULE_0__.reloadEditor,\n    reloadEditorDebounced: _compatibility__WEBPACK_IMPORTED_MODULE_0__.reloadEditorDebounced,\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZnVuY3Rpb24vYnVpbHRpbi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBc0U7QUFDSjtBQUUzRCxNQUFNLE9BQU8sR0FBRztJQUNyQixhQUFhO0lBQ2IsWUFBWTtJQUNaLFlBQVk7SUFDWixxQkFBcUI7Q0FDdEIsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9mdW5jdGlvbi9idWlsdGluLnRzP2YyNzgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcmVsb2FkRWRpdG9yLCByZWxvYWRFZGl0b3JEZWJvdW5jZWQgfSBmcm9tICdAL2NvbXBhdGliaWxpdHknO1xuaW1wb3J0IHsgYWRkT25lTWVzc2FnZSwgc2F2ZVNldHRpbmdzIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5cbmV4cG9ydCBjb25zdCBidWlsdGluID0ge1xuICBhZGRPbmVNZXNzYWdlLFxuICBzYXZlU2V0dGluZ3MsXG4gIHJlbG9hZEVkaXRvcixcbiAgcmVsb2FkRWRpdG9yRGVib3VuY2VkLFxufTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/function/builtin.ts\n')},"./src/function/character.ts":
/*!***********************************!*\
  !*** ./src/function/character.ts ***!
  \***********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Character: () => (/* binding */ Character),\n/* harmony export */   getCharAvatarPath: () => (/* binding */ getCharAvatarPath),\n/* harmony export */   getCharData: () => (/* binding */ getCharData),\n/* harmony export */   getChatHistoryBrief: () => (/* binding */ getChatHistoryBrief),\n/* harmony export */   getChatHistoryDetail: () => (/* binding */ getChatHistoryDetail)\n/* harmony export */ });\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\nclass Character {\n    charData;\n    constructor(characterData) {\n        this.charData = characterData;\n    }\n    static find({ name, allowAvatar = true } = {}) {\n        if (name === undefined) {\n            // @ts-ignore\n            const currentChar = _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.this_chid];\n            if (currentChar) {\n                name = currentChar.avatar;\n                // 确保allowAvatar为true，以便可以通过avatar准确查找角色\n                allowAvatar = true;\n            }\n        }\n        const matches = (char) => !name || char.name === name || (allowAvatar && char.avatar === name);\n        const filteredCharacters = _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.characters;\n        // 如果有确定的角色头像id提供，则返回该角色\n        if (allowAvatar && name) {\n            const characterByAvatar = filteredCharacters.find(char => char.avatar === name);\n            if (characterByAvatar) {\n                return characterByAvatar;\n            }\n        }\n        // 查找所有匹配的角色\n        const matchingCharacters = name ? filteredCharacters.filter(matches) : filteredCharacters;\n        if (matchingCharacters.length > 1) {\n            loglevel__WEBPACK_IMPORTED_MODULE_2___default().warn(`找到多个符合条件的角色，返回导入时间最早的角色: ${name}`);\n        }\n        if (matchingCharacters.length === 0) {\n            throw new Error(`提供的名称或头像ID为: ${name}，未找到符合条件的角色`);\n        }\n        return matchingCharacters[0];\n    }\n    static findCharacterIndex(name) {\n        const matchTypes = [\n            (a, b) => a === b,\n            (a, b) => a.startsWith(b),\n            (a, b) => a.includes(b),\n        ];\n        const exactAvatarMatch = _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.characters.findIndex(x => x.avatar === name);\n        if (exactAvatarMatch !== -1) {\n            return exactAvatarMatch;\n        }\n        for (const matchType of matchTypes) {\n            const index = _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.characters.findIndex(x => matchType(x.name.toLowerCase(), name.toLowerCase()));\n            if (index !== -1) {\n                return index;\n            }\n        }\n        return -1;\n    }\n    static async getChatsFromFiles(data, isGroupChat) {\n        const chat_dict = {};\n        const chat_list = Object.values(data)\n            .sort((a, b) => a['file_name'].localeCompare(b['file_name']))\n            .reverse();\n        const chat_promise = chat_list.map(async ({ file_name }) => {\n            // 从文件名中提取角色名称（破折号前的部分）\n            const ch_name = isGroupChat ? '' : file_name.split(' - ')[0];\n            // 使用Character.find方法查找角色，获取头像\n            let characterData = null;\n            let avatar_url = '';\n            if (!isGroupChat && ch_name) {\n                characterData = Character.find({ name: ch_name });\n                if (characterData) {\n                    avatar_url = characterData.avatar;\n                }\n            }\n            const endpoint = isGroupChat ? '/api/chats/group/get' : '/api/chats/get';\n            const requestBody = isGroupChat\n                ? JSON.stringify({ id: file_name })\n                : JSON.stringify({\n                    ch_name: ch_name,\n                    file_name: file_name.replace('.jsonl', ''),\n                    avatar_url: avatar_url,\n                });\n            const chatResponse = await fetch(endpoint, {\n                method: 'POST',\n                headers: (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.getRequestHeaders)(),\n                body: requestBody,\n                cache: 'no-cache',\n            });\n            if (!chatResponse.ok) {\n                return;\n            }\n            const currentChat = await chatResponse.json();\n            if (!isGroupChat) {\n                // remove the first message, which is metadata, only for individual chats\n                currentChat.shift();\n            }\n            chat_dict[file_name] = currentChat;\n        });\n        await Promise.all(chat_promise);\n        return chat_dict;\n    }\n    getCardData() {\n        return this.charData;\n    }\n    getAvatarId() {\n        return this.charData.avatar || '';\n    }\n    getRegexScripts() {\n        return this.charData.data?.extensions?.regex_scripts || [];\n    }\n    getCharacterBook() {\n        return this.charData.data?.character_book || null;\n    }\n    getWorldName() {\n        return this.charData.data?.extensions?.world || '';\n    }\n}\nfunction getCharData(name, allowAvatar = true) {\n    try {\n        const characterData = Character.find({ name, allowAvatar });\n        if (!characterData)\n            return null;\n        const character = new Character(characterData);\n        loglevel__WEBPACK_IMPORTED_MODULE_2___default().info(`获取角色卡数据成功, 角色: ${name || '未知'}`);\n        return character.getCardData();\n    }\n    catch (error) {\n        loglevel__WEBPACK_IMPORTED_MODULE_2___default().error(`获取角色卡数据失败, 角色: ${name || '未知'}`, error);\n        return null;\n    }\n}\nfunction getCharAvatarPath(name, allowAvatar = true) {\n    try {\n        const characterData = Character.find({ name, allowAvatar });\n        if (!characterData)\n            return null;\n        const character = new Character(characterData);\n        const avatarId = character.getAvatarId();\n        // 使用getThumbnailUrl获取缩略图URL，然后提取实际文件名\n        const thumbnailPath = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.getThumbnailUrl)('avatar', avatarId);\n        const targetAvatarImg = thumbnailPath.substring(thumbnailPath.lastIndexOf('=') + 1);\n        // 假设charsPath在其他地方定义\n        loglevel__WEBPACK_IMPORTED_MODULE_2___default().info(`获取角色头像路径成功, 角色: ${name || '未知'}`);\n        return _util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.charsPath + targetAvatarImg;\n    }\n    catch (error) {\n        loglevel__WEBPACK_IMPORTED_MODULE_2___default().error(`获取角色头像路径失败, 角色: ${name || '未知'}`, error);\n        return null;\n    }\n}\nasync function getChatHistoryBrief(name, allowAvatar = true) {\n    try {\n        const characterData = Character.find({ name, allowAvatar });\n        if (!characterData)\n            return null;\n        const character = new Character(characterData);\n        const index = Character.findCharacterIndex(character.getAvatarId());\n        if (index === -1)\n            return null;\n        const chats = await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.getPastCharacterChats)(index);\n        loglevel__WEBPACK_IMPORTED_MODULE_2___default().info(`获取角色聊天历史摘要成功, 角色: ${name || '未知'}`);\n        return chats;\n    }\n    catch (error) {\n        loglevel__WEBPACK_IMPORTED_MODULE_2___default().error(`获取角色聊天历史摘要失败, 角色: ${name || '未知'}`, error);\n        return null;\n    }\n}\nasync function getChatHistoryDetail(data, isGroupChat = false) {\n    try {\n        const result = await Character.getChatsFromFiles(data, isGroupChat);\n        loglevel__WEBPACK_IMPORTED_MODULE_2___default().info(`获取聊天文件详情成功`);\n        return result;\n    }\n    catch (error) {\n        loglevel__WEBPACK_IMPORTED_MODULE_2___default().error(`获取聊天文件详情失败`, error);\n        return null;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFPLElBQUksQ0FBQztRQUU5QixNQUFNLEtBQUssR0FBRyxNQUFNLDBFQUFxQixDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ2pELG9EQUFRLENBQUMscUJBQXFCLElBQUksSUFBSSxJQUFJLEVBQUUsQ0FBQyxDQUFDO1FBQzlDLE9BQU8sS0FBSyxDQUFDO0lBQ2YsQ0FBQztJQUFDLE9BQU8sS0FBSyxFQUFFLENBQUM7UUFDZixxREFBUyxDQUFDLHFCQUFxQixJQUFJLElBQUksSUFBSSxFQUFFLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDdEQsT0FBTyxJQUFJLENBQUM7SUFDZCxDQUFDO0FBQ0gsQ0FBQztBQUVNLEtBQUssVUFBVSxvQkFBb0IsQ0FDeEMsSUFBVyxFQUNYLGNBQXVCLEtBQUs7SUFFNUIsSUFBSSxDQUFDO1FBQ0gsTUFBTSxNQUFNLEdBQUcsTUFBTSxTQUFTLENBQUMsaUJBQWlCLENBQUMsSUFBSSxFQUFFLFdBQVcsQ0FBQyxDQUFDO1FBQ3BFLG9EQUFRLENBQUMsWUFBWSxDQUFDLENBQUM7UUFDdkIsT0FBTyxNQUFNLENBQUM7SUFDaEIsQ0FBQztJQUFDLE9BQU8sS0FBSyxFQUFFLENBQUM7UUFDZixxREFBUyxDQUFDLFlBQVksRUFBRSxLQUFLLENBQUMsQ0FBQztRQUMvQixPQUFPLElBQUksQ0FBQztJQUNkLENBQUM7QUFDSCxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2Z1bmN0aW9uL2NoYXJhY3Rlci50cz8zNDY4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNoYXJzUGF0aCB9IGZyb20gJ0AvdXRpbC9leHRlbnNpb25fdmFyaWFibGVzJztcblxuaW1wb3J0IHsgY2hhcmFjdGVycywgZ2V0UGFzdENoYXJhY3RlckNoYXRzLCBnZXRSZXF1ZXN0SGVhZGVycywgZ2V0VGh1bWJuYWlsVXJsLCB0aGlzX2NoaWQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0JztcbmltcG9ydCB7IHYxQ2hhckRhdGEgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9jaGFyLWRhdGEnO1xuXG5pbXBvcnQgbG9nIGZyb20gJ2xvZ2xldmVsJztcblxuZXhwb3J0IGNsYXNzIENoYXJhY3RlciB7XG4gIHByaXZhdGUgY2hhckRhdGE6IHYxQ2hhckRhdGE7XG5cbiAgY29uc3RydWN0b3IoY2hhcmFjdGVyRGF0YTogdjFDaGFyRGF0YSkge1xuICAgIHRoaXMuY2hhckRhdGEgPSBjaGFyYWN0ZXJEYXRhO1xuICB9XG5cbiAgc3RhdGljIGZpbmQoeyBuYW1lLCBhbGxvd0F2YXRhciA9IHRydWUgfTogeyBuYW1lPzogc3RyaW5nOyBhbGxvd0F2YXRhcj86IGJvb2xlYW4gfSA9IHt9KTogdjFDaGFyRGF0YSB7XG4gICAgaWYgKG5hbWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgY29uc3QgY3VycmVudENoYXIgPSBjaGFyYWN0ZXJzW3RoaXNfY2hpZF07XG4gICAgICBpZiAoY3VycmVudENoYXIpIHtcbiAgICAgICAgbmFtZSA9IGN1cnJlbnRDaGFyLmF2YXRhcjtcbiAgICAgICAgLy8g56Gu5L+dYWxsb3dBdmF0YXLkuLp0cnVl77yM5Lul5L6/5Y+v5Lul6YCa6L+HYXZhdGFy5YeG56Gu5p+l5om+6KeS6ImyXG4gICAgICAgIGFsbG93QXZhdGFyID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBtYXRjaGVzID0gKGNoYXI6IHsgYXZhdGFyOiBzdHJpbmc7IG5hbWU6IHN0cmluZyB9KSA9PlxuICAgICAgIW5hbWUgfHwgY2hhci5uYW1lID09PSBuYW1lIHx8IChhbGxvd0F2YXRhciAmJiBjaGFyLmF2YXRhciA9PT0gbmFtZSk7XG5cbiAgICBjb25zdCBmaWx0ZXJlZENoYXJhY3RlcnMgPSBjaGFyYWN0ZXJzO1xuXG4gICAgLy8g5aaC5p6c5pyJ56Gu5a6a55qE6KeS6Imy5aS05YOPaWTmj5DkvpvvvIzliJnov5Tlm57or6Xop5LoibJcbiAgICBpZiAoYWxsb3dBdmF0YXIgJiYgbmFtZSkge1xuICAgICAgY29uc3QgY2hhcmFjdGVyQnlBdmF0YXIgPSBmaWx0ZXJlZENoYXJhY3RlcnMuZmluZChjaGFyID0+IGNoYXIuYXZhdGFyID09PSBuYW1lKTtcbiAgICAgIGlmIChjaGFyYWN0ZXJCeUF2YXRhcikge1xuICAgICAgICByZXR1cm4gY2hhcmFjdGVyQnlBdmF0YXI7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8g5p+l5om+5omA5pyJ5Yy56YWN55qE6KeS6ImyXG4gICAgY29uc3QgbWF0Y2hpbmdDaGFyYWN0ZXJzID0gbmFtZSA/IGZpbHRlcmVkQ2hhcmFjdGVycy5maWx0ZXIobWF0Y2hlcykgOiBmaWx0ZXJlZENoYXJhY3RlcnM7XG4gICAgaWYgKG1hdGNoaW5nQ2hhcmFjdGVycy5sZW5ndGggPiAxKSB7XG4gICAgICBsb2cud2Fybihg5om+5Yiw5aSa5Liq56ym5ZCI5p2h5Lu255qE6KeS6Imy77yM6L+U5Zue5a+85YWl5pe26Ze05pyA5pep55qE6KeS6ImyOiAke25hbWV9YCk7XG4gICAgfVxuXG4gICAgaWYgKG1hdGNoaW5nQ2hhcmFjdGVycy5sZW5ndGggPT09IDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihg5o+Q5L6b55qE5ZCN56ew5oiW5aS05YOPSUTkuLo6ICR7bmFtZX3vvIzmnKrmib7liLDnrKblkIjmnaHku7bnmoTop5LoibJgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbWF0Y2hpbmdDaGFyYWN0ZXJzWzBdO1xuICB9XG5cbiAgc3RhdGljIGZpbmRDaGFyYWN0ZXJJbmRleChuYW1lOiBzdHJpbmcpOiBudW1iZXIge1xuICAgIGNvbnN0IG1hdGNoVHlwZXMgPSBbXG4gICAgICAoYTogc3RyaW5nLCBiOiBzdHJpbmcpID0+IGEgPT09IGIsXG4gICAgICAoYTogc3RyaW5nLCBiOiBzdHJpbmcpID0+IGEuc3RhcnRzV2l0aChiKSxcbiAgICAgIChhOiBzdHJpbmcsIGI6IHN0cmluZykgPT4gYS5pbmNsdWRlcyhiKSxcbiAgICBdO1xuXG4gICAgY29uc3QgZXhhY3RBdmF0YXJNYXRjaCA9IGNoYXJhY3RlcnMuZmluZEluZGV4KHggPT4geC5hdmF0YXIgPT09IG5hbWUpO1xuXG4gICAgaWYgKGV4YWN0QXZhdGFyTWF0Y2ggIT09IC0xKSB7XG4gICAgICByZXR1cm4gZXhhY3RBdmF0YXJNYXRjaDtcbiAgICB9XG5cbiAgICBmb3IgKGNvbnN0IG1hdGNoVHlwZSBvZiBtYXRjaFR5cGVzKSB7XG4gICAgICBjb25zdCBpbmRleCA9IGNoYXJhY3RlcnMuZmluZEluZGV4KHggPT4gbWF0Y2hUeXBlKHgubmFtZS50b0xvd2VyQ2FzZSgpLCBuYW1lLnRvTG93ZXJDYXNlKCkpKTtcbiAgICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgICAgcmV0dXJuIGluZGV4O1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiAtMTtcbiAgfVxuXG4gIHN0YXRpYyBhc3luYyBnZXRDaGF0c0Zyb21GaWxlcyhkYXRhOiBhbnlbXSwgaXNHcm91cENoYXQ6IGJvb2xlYW4pOiBQcm9taXNlPFJlY29yZDxzdHJpbmcsIGFueT4+IHtcbiAgICBjb25zdCBjaGF0X2RpY3Q6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fTtcbiAgICBjb25zdCBjaGF0X2xpc3QgPSBPYmplY3QudmFsdWVzKGRhdGEpXG4gICAgICAuc29ydCgoYSwgYikgPT4gYVsnZmlsZV9uYW1lJ10ubG9jYWxlQ29tcGFyZShiWydmaWxlX25hbWUnXSkpXG4gICAgICAucmV2ZXJzZSgpO1xuXG4gICAgY29uc3QgY2hhdF9wcm9taXNlID0gY2hhdF9saXN0Lm1hcChhc3luYyAoeyBmaWxlX25hbWUgfSkgPT4ge1xuICAgICAgLy8g5LuO5paH5Lu25ZCN5Lit5o+Q5Y+W6KeS6Imy5ZCN56ew77yI56C05oqY5Y+35YmN55qE6YOo5YiG77yJXG4gICAgICBjb25zdCBjaF9uYW1lID0gaXNHcm91cENoYXQgPyAnJyA6IGZpbGVfbmFtZS5zcGxpdCgnIC0gJylbMF07XG5cbiAgICAgIC8vIOS9v+eUqENoYXJhY3Rlci5maW5k5pa55rOV5p+l5om+6KeS6Imy77yM6I635Y+W5aS05YOPXG4gICAgICBsZXQgY2hhcmFjdGVyRGF0YSA9IG51bGw7XG4gICAgICBsZXQgYXZhdGFyX3VybCA9ICcnO1xuXG4gICAgICBpZiAoIWlzR3JvdXBDaGF0ICYmIGNoX25hbWUpIHtcbiAgICAgICAgY2hhcmFjdGVyRGF0YSA9IENoYXJhY3Rlci5maW5kKHsgbmFtZTogY2hfbmFtZSB9KTtcbiAgICAgICAgaWYgKGNoYXJhY3RlckRhdGEpIHtcbiAgICAgICAgICBhdmF0YXJfdXJsID0gY2hhcmFjdGVyRGF0YS5hdmF0YXI7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY29uc3QgZW5kcG9pbnQgPSBpc0dyb3VwQ2hhdCA/ICcvYXBpL2NoYXRzL2dyb3VwL2dldCcgOiAnL2FwaS9jaGF0cy9nZXQnO1xuICAgICAgY29uc3QgcmVxdWVzdEJvZHkgPSBpc0dyb3VwQ2hhdFxuICAgICAgICA/IEpTT04uc3RyaW5naWZ5KHsgaWQ6IGZpbGVfbmFtZSB9KVxuICAgICAgICA6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIGNoX25hbWU6IGNoX25hbWUsXG4gICAgICAgICAgICBmaWxlX25hbWU6IGZpbGVfbmFtZS5yZXBsYWNlKCcuanNvbmwnLCAnJyksXG4gICAgICAgICAgICBhdmF0YXJfdXJsOiBhdmF0YXJfdXJsLFxuICAgICAgICAgIH0pO1xuXG4gICAgICBjb25zdCBjaGF0UmVzcG9uc2UgPSBhd2FpdCBmZXRjaChlbmRwb2ludCwge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgaGVhZGVyczogZ2V0UmVxdWVzdEhlYWRlcnMoKSxcbiAgICAgICAgYm9keTogcmVxdWVzdEJvZHksXG4gICAgICAgIGNhY2hlOiAnbm8tY2FjaGUnLFxuICAgICAgfSk7XG5cbiAgICAgIGlmICghY2hhdFJlc3BvbnNlLm9rKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgY3VycmVudENoYXQgPSBhd2FpdCBjaGF0UmVzcG9uc2UuanNvbigpO1xuICAgICAgaWYgKCFpc0dyb3VwQ2hhdCkge1xuICAgICAgICAvLyByZW1vdmUgdGhlIGZpcnN0IG1lc3NhZ2UsIHdoaWNoIGlzIG1ldGFkYXRhLCBvbmx5IGZvciBpbmRpdmlkdWFsIGNoYXRzXG4gICAgICAgIGN1cnJlbnRDaGF0LnNoaWZ0KCk7XG4gICAgICB9XG4gICAgICBjaGF0X2RpY3RbZmlsZV9uYW1lXSA9IGN1cnJlbnRDaGF0O1xuICAgIH0pO1xuXG4gICAgYXdhaXQgUHJvbWlzZS5hbGwoY2hhdF9wcm9taXNlKTtcblxuICAgIHJldHVybiBjaGF0X2RpY3Q7XG4gIH1cblxuICBnZXRDYXJkRGF0YSgpOiB2MUNoYXJEYXRhIHtcbiAgICByZXR1cm4gdGhpcy5jaGFyRGF0YTtcbiAgfVxuXG4gIGdldEF2YXRhcklkKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuY2hhckRhdGEuYXZhdGFyIHx8ICcnO1xuICB9XG5cbiAgZ2V0UmVnZXhTY3JpcHRzKCk6IEFycmF5PHtcbiAgICBpZDogc3RyaW5nO1xuICAgIHNjcmlwdE5hbWU6IHN0cmluZztcbiAgICBmaW5kUmVnZXg6IHN0cmluZztcbiAgICByZXBsYWNlU3RyaW5nOiBzdHJpbmc7XG4gICAgdHJpbVN0cmluZ3M6IHN0cmluZ1tdO1xuICAgIHBsYWNlbWVudDogbnVtYmVyW107XG4gICAgZGlzYWJsZWQ6IGJvb2xlYW47XG4gICAgbWFya2Rvd25Pbmx5OiBib29sZWFuO1xuICAgIHByb21wdE9ubHk6IGJvb2xlYW47XG4gICAgcnVuT25FZGl0OiBib29sZWFuO1xuICAgIHN1YnN0aXR1dGVSZWdleDogbnVtYmVyIHwgYm9vbGVhbjtcbiAgICBtaW5EZXB0aDogbnVtYmVyO1xuICAgIG1heERlcHRoOiBudW1iZXI7XG4gIH0+IHtcbiAgICByZXR1cm4gdGhpcy5jaGFyRGF0YS5kYXRhPy5leHRlbnNpb25zPy5yZWdleF9zY3JpcHRzIHx8IFtdO1xuICB9XG5cbiAgZ2V0Q2hhcmFjdGVyQm9vaygpOiB7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIGVudHJpZXM6IEFycmF5PHtcbiAgICAgIGtleXM6IHN0cmluZ1tdO1xuICAgICAgc2Vjb25kYXJ5X2tleXM/OiBzdHJpbmdbXTtcbiAgICAgIGNvbW1lbnQ6IHN0cmluZztcbiAgICAgIGNvbnRlbnQ6IHN0cmluZztcbiAgICAgIGNvbnN0YW50OiBib29sZWFuO1xuICAgICAgc2VsZWN0aXZlOiBib29sZWFuO1xuICAgICAgaW5zZXJ0aW9uX29yZGVyOiBudW1iZXI7XG4gICAgICBlbmFibGVkOiBib29sZWFuO1xuICAgICAgcG9zaXRpb246IHN0cmluZztcbiAgICAgIGV4dGVuc2lvbnM6IGFueTtcbiAgICAgIGlkOiBudW1iZXI7XG4gICAgfT47XG4gIH0gfCBudWxsIHtcbiAgICByZXR1cm4gdGhpcy5jaGFyRGF0YS5kYXRhPy5jaGFyYWN0ZXJfYm9vayB8fCBudWxsO1xuICB9XG5cbiAgZ2V0V29ybGROYW1lKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuY2hhckRhdGEuZGF0YT8uZXh0ZW5zaW9ucz8ud29ybGQgfHwgJyc7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldENoYXJEYXRhKG5hbWU/OiBzdHJpbmcsIGFsbG93QXZhdGFyOiBib29sZWFuID0gdHJ1ZSk6IHYxQ2hhckRhdGEgfCBudWxsIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBjaGFyYWN0ZXJEYXRhID0gQ2hhcmFjdGVyLmZpbmQoeyBuYW1lLCBhbGxvd0F2YXRhciB9KTtcbiAgICBpZiAoIWNoYXJhY3RlckRhdGEpIHJldHVybiBudWxsO1xuXG4gICAgY29uc3QgY2hhcmFjdGVyID0gbmV3IENoYXJhY3RlcihjaGFyYWN0ZXJEYXRhKTtcbiAgICBsb2cuaW5mbyhg6I635Y+W6KeS6Imy5Y2h5pWw5o2u5oiQ5YqfLCDop5LoibI6ICR7bmFtZSB8fCAn5pyq55+lJ31gKTtcbiAgICByZXR1cm4gY2hhcmFjdGVyLmdldENhcmREYXRhKCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nLmVycm9yKGDojrflj5bop5LoibLljaHmlbDmja7lpLHotKUsIOinkuiJsjogJHtuYW1lIHx8ICfmnKrnn6UnfWAsIGVycm9yKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q2hhckF2YXRhclBhdGgobmFtZT86IHN0cmluZywgYWxsb3dBdmF0YXI6IGJvb2xlYW4gPSB0cnVlKTogc3RyaW5nIHwgbnVsbCB7XG4gIHRyeSB7XG4gICAgY29uc3QgY2hhcmFjdGVyRGF0YSA9IENoYXJhY3Rlci5maW5kKHsgbmFtZSwgYWxsb3dBdmF0YXIgfSk7XG4gICAgaWYgKCFjaGFyYWN0ZXJEYXRhKSByZXR1cm4gbnVsbDtcblxuICAgIGNvbnN0IGNoYXJhY3RlciA9IG5ldyBDaGFyYWN0ZXIoY2hhcmFjdGVyRGF0YSk7XG4gICAgY29uc3QgYXZhdGFySWQgPSBjaGFyYWN0ZXIuZ2V0QXZhdGFySWQoKTtcblxuICAgIC8vIOS9v+eUqGdldFRodW1ibmFpbFVybOiOt+WPlue8qeeVpeWbvlVSTO+8jOeEtuWQjuaPkOWPluWunumZheaWh+S7tuWQjVxuICAgIGNvbnN0IHRodW1ibmFpbFBhdGggPSBnZXRUaHVtYm5haWxVcmwoJ2F2YXRhcicsIGF2YXRhcklkKTtcbiAgICBjb25zdCB0YXJnZXRBdmF0YXJJbWcgPSB0aHVtYm5haWxQYXRoLnN1YnN0cmluZyh0aHVtYm5haWxQYXRoLmxhc3RJbmRleE9mKCc9JykgKyAxKTtcblxuICAgIC8vIOWBh+iuvmNoYXJzUGF0aOWcqOWFtuS7luWcsOaWueWumuS5iVxuICAgIGxvZy5pbmZvKGDojrflj5bop5LoibLlpLTlg4/ot6/lvoTmiJDlip8sIOinkuiJsjogJHtuYW1lIHx8ICfmnKrnn6UnfWApO1xuICAgIHJldHVybiBjaGFyc1BhdGggKyB0YXJnZXRBdmF0YXJJbWc7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nLmVycm9yKGDojrflj5bop5LoibLlpLTlg4/ot6/lvoTlpLHotKUsIOinkuiJsjogJHtuYW1lIHx8ICfmnKrnn6UnfWAsIGVycm9yKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q2hhdEhpc3RvcnlCcmllZihuYW1lPzogc3RyaW5nLCBhbGxvd0F2YXRhcjogYm9vbGVhbiA9IHRydWUpOiBQcm9taXNlPGFueVtdIHwgbnVsbD4ge1xuICB0cnkge1xuICAgIGNvbnN0IGNoYXJhY3RlckRhdGEgPSBDaGFyYWN0ZXIuZmluZCh7IG5hbWUsIGFsbG93QXZhdGFyIH0pO1xuICAgIGlmICghY2hhcmFjdGVyRGF0YSkgcmV0dXJuIG51bGw7XG5cbiAgICBjb25zdCBjaGFyYWN0ZXIgPSBuZXcgQ2hhcmFjdGVyKGNoYXJhY3RlckRhdGEpO1xuICAgIGNvbnN0IGluZGV4ID0gQ2hhcmFjdGVyLmZpbmRDaGFyYWN0ZXJJbmRleChjaGFyYWN0ZXIuZ2V0QXZhdGFySWQoKSk7XG5cbiAgICBpZiAoaW5kZXggPT09IC0xKSByZXR1cm4gbnVsbDtcblxuICAgIGNvbnN0IGNoYXRzID0gYXdhaXQgZ2V0UGFzdENoYXJhY3RlckNoYXRzKGluZGV4KTtcbiAgICBsb2cuaW5mbyhg6I635Y+W6KeS6Imy6IGK5aSp5Y6G5Y+y5pGY6KaB5oiQ5YqfLCDop5LoibI6ICR7bmFtZSB8fCAn5pyq55+lJ31gKTtcbiAgICByZXR1cm4gY2hhdHM7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nLmVycm9yKGDojrflj5bop5LoibLogYrlpKnljoblj7LmkZjopoHlpLHotKUsIOinkuiJsjogJHtuYW1lIHx8ICfmnKrnn6UnfWAsIGVycm9yKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q2hhdEhpc3RvcnlEZXRhaWwoXG4gIGRhdGE6IGFueVtdLFxuICBpc0dyb3VwQ2hhdDogYm9vbGVhbiA9IGZhbHNlLFxuKTogUHJvbWlzZTxSZWNvcmQ8c3RyaW5nLCBhbnk+IHwgbnVsbD4ge1xuICB0cnkge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IENoYXJhY3Rlci5nZXRDaGF0c0Zyb21GaWxlcyhkYXRhLCBpc0dyb3VwQ2hhdCk7XG4gICAgbG9nLmluZm8oYOiOt+WPluiBiuWkqeaWh+S7tuivpuaDheaIkOWKn2ApO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nLmVycm9yKGDojrflj5bogYrlpKnmlofku7bor6bmg4XlpLHotKVgLCBlcnJvcik7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/function/character.ts\n")},"./src/function/chat_message.ts":
/*!**************************************!*\
  !*** ./src/function/chat_message.ts ***!
  \**************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createChatMessages: () => (/* binding */ createChatMessages),\n/* harmony export */   deleteChatMessages: () => (/* binding */ deleteChatMessages),\n/* harmony export */   getChatMessages: () => (/* binding */ getChatMessages),\n/* harmony export */   rotateChatMessages: () => (/* binding */ rotateChatMessages),\n/* harmony export */   setChatMessage: () => (/* binding */ setChatMessage),\n/* harmony export */   setChatMessages: () => (/* binding */ setChatMessages)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_1__);\n\n\nfunction string_to_range(input, min, max) {\n    let start, end;\n    if (input.match(/^(-?\\d+)$/)) {\n        const value = Number(input);\n        start = end = value < 0 ? max + value + 1 : value;\n    }\n    else {\n        const match = input.match(/^(-?\\d+)-(-?\\d+)$/);\n        if (!match) {\n            return null;\n        }\n        [start, end] = _.sortBy([match[1], match[2]].map(value => Number(value)).map(value => (value < 0 ? max + value + 1 : value)));\n    }\n    if (isNaN(start) || isNaN(end) || start > end || start < min || end > max) {\n        return null;\n    }\n    return { start, end };\n}\nfunction getChatMessages(range, { role = 'all', hide_state = 'all', include_swipes = false } = {}) {\n    const range_demacroed = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.substituteParamsExtended)(range.toString());\n    const range_number = string_to_range(range_demacroed, 0, _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.length - 1);\n    if (!range_number) {\n        throw Error(`提供的消息范围 range 无效: ${range}`);\n    }\n    if (!['all', 'system', 'assistant', 'user'].includes(role)) {\n        throw Error(`提供的 role 无效, 请提供 'all', 'system', 'assistant' 或 'user', 你提供的是: ${role}`);\n    }\n    if (!['all', 'hidden', 'unhidden'].includes(hide_state)) {\n        throw Error(`提供的 hide_state 无效, 请提供 'all', 'hidden' 或 'unhidden', 你提供的是: ${hide_state}`);\n    }\n    const { start, end } = range_number;\n    const get_role = (chat_message) => {\n        const is_narrator = chat_message.extra?.type === _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.system_message_types.NARRATOR;\n        if (is_narrator) {\n            if (chat_message.is_user) {\n                return 'unknown';\n            }\n            return 'system';\n        }\n        if (chat_message.is_user) {\n            return 'user';\n        }\n        return 'assistant';\n    };\n    const process_message = (message_id) => {\n        const message = _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat[message_id];\n        if (!message) {\n            loglevel__WEBPACK_IMPORTED_MODULE_1___default().warn(`没找到第 ${message_id} 楼的消息`);\n            return null;\n        }\n        const message_role = get_role(message);\n        if (role !== 'all' && message_role !== role) {\n            loglevel__WEBPACK_IMPORTED_MODULE_1___default().debug(`筛去了第 ${message_id} 楼的消息因为它的身份不是 ${role}`);\n            return null;\n        }\n        if (hide_state !== 'all' && (hide_state === 'hidden') !== message.is_system) {\n            loglevel__WEBPACK_IMPORTED_MODULE_1___default().debug(`筛去了第 ${message_id} 楼的消息因为它${hide_state === 'hidden' ? `` : `没`} 被隐藏`);\n            return null;\n        }\n        const swipe_id = message?.swipe_id ?? 0;\n        const swipes = message?.swipes ?? [message.mes];\n        const swipes_data = message?.variables ?? [{}];\n        const swipes_info = message?.swipes_info ?? [message?.extra ?? {}];\n        const extra = swipes_info[swipe_id];\n        const data = swipes_data[swipe_id];\n        if (include_swipes) {\n            return {\n                message_id: message_id,\n                name: message.name,\n                role: message_role,\n                is_hidden: message.is_system,\n                swipe_id: swipe_id,\n                swipes: swipes,\n                swipes_data: swipes_data,\n                swipes_info: swipes_info,\n            };\n        }\n        return {\n            message_id: message_id,\n            name: message.name,\n            role: message_role,\n            is_hidden: message.is_system,\n            message: message.mes,\n            data: data,\n            extra: extra,\n            // for compatibility\n            swipe_id: swipe_id,\n            swipes: swipes,\n            swipes_data: swipes_data,\n        };\n    };\n    const chat_messages = _.range(start, end + 1)\n        .map(i => process_message(i))\n        .filter(chat_message => chat_message !== null);\n    loglevel__WEBPACK_IMPORTED_MODULE_1___default().info(`获取${start == end ? `第 ${start} ` : ` ${start}-${end} `}楼的消息, 选项: ${JSON.stringify({\n        role,\n        hide_state,\n        include_swipes,\n    })} `);\n    return structuredClone(chat_messages);\n}\nasync function setChatMessages(chat_messages, { refresh = 'affected' } = {}) {\n    const is_chat_message = (chat_message) => {\n        return _.has(chat_message, 'message') || _.has(chat_message, 'data');\n    };\n    const modify = async (chat_message) => {\n        const data = _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat[chat_message.message_id];\n        if (data === undefined) {\n            return;\n        }\n        if (chat_message?.name !== undefined) {\n            _.set(data, 'name', chat_message.name);\n        }\n        if (chat_message?.role !== undefined) {\n            _.set(data, 'is_user', chat_message.role === 'user');\n        }\n        if (chat_message?.is_hidden !== undefined) {\n            _.set(data, 'is_system', chat_message.is_hidden);\n        }\n        if (is_chat_message(chat_message)) {\n            if (chat_message?.message !== undefined) {\n                _.set(data, 'mes', chat_message.message);\n                if (data?.swipes !== undefined) {\n                    _.set(data, ['swipes', data.swipe_id], chat_message.message);\n                }\n            }\n            if (chat_message?.data !== undefined) {\n                if (data?.variables === undefined) {\n                    _.set(data, 'variables', _.times(data.swipes?.length ?? 1, _.constant({})));\n                }\n                _.set(data, ['variables', data.swipe_id ?? 0], chat_message.data);\n                _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.emit('message_variables_changed', {\n                    message_id: chat_message.message_id,\n                    variables: chat_message.data,\n                });\n            }\n            if (chat_message?.extra !== undefined) {\n                if (data?.swipes_info === undefined) {\n                    _.set(data, 'swipes_info', _.times(data.swipes?.length ?? 1, _.constant({})));\n                }\n                _.set(data, 'extra', chat_message?.extra);\n                _.set(data, ['swipes_info', data.swipe_id ?? 0], chat_message?.extra);\n            }\n        }\n        else if (chat_message?.swipe_id !== undefined ||\n            chat_message?.swipes !== undefined ||\n            chat_message?.swipes_data !== undefined ||\n            chat_message?.swipes_info !== undefined) {\n            _.set(chat_message, 'swipe_id', chat_message.swipe_id ?? data.swipe_id ?? 0);\n            _.set(chat_message, 'swipes', chat_message.swipes ?? data.swipes ?? [data.mes]);\n            _.set(chat_message, 'swipes_data', chat_message.swipes_data ?? data.variables ?? [{}]);\n            _.set(chat_message, 'swipes_info', chat_message.swipes_info ?? data.swipes_info ?? [{}]);\n            const max_length = _.max([chat_message.swipes?.length, chat_message.swipes_data?.length, chat_message.swipes_info?.length]) ?? 1;\n            chat_message.swipes.length = max_length;\n            chat_message.swipes_data.length = max_length;\n            chat_message.swipes_info.length = max_length;\n            _.set(data, 'swipes', chat_message.swipes);\n            _.set(data, 'variables', chat_message.swipes_data);\n            _.set(data, 'swipes_info', chat_message.swipes_info);\n            _.set(data, 'swipe_id', chat_message.swipe_id);\n            _.set(data, 'mes', data.swipes[data.swipe_id]);\n            _.set(data, 'extra', data.swipes_info[data.swipe_id]);\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.emit('message_variables_changed', {\n                message_id: chat_message.message_id,\n                variables: chat_message.swipes_data[chat_message.swipe_id],\n            });\n        }\n    };\n    const render = async (message_id) => {\n        const $mes_html = $(`div.mes[mesid = \"${message_id}\"]`);\n        if (!$mes_html) {\n            return;\n        }\n        const chat_message = _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat[message_id];\n        if (chat_message.swipes) {\n            $mes_html.find('.swipes-counter').text(`${chat_message.swipe_id + 1}\\u200b/\\u200b${chat_message.swipes.length}`);\n        }\n        $mes_html\n            .find('.mes_text')\n            .empty()\n            .append((0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.messageFormatting)(chat_message.mes, chat_message.name, chat_message.is_system, chat_message.is_user, message_id));\n        await _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.emit(chat_message.is_user ? _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.USER_MESSAGE_RENDERED : _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.CHARACTER_MESSAGE_RENDERED, message_id);\n    };\n    await Promise.all(chat_messages.map(modify));\n    await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveChatConditional)();\n    if (refresh === 'all') {\n        await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.reloadCurrentChat)();\n    }\n    else if (refresh === 'affected') {\n        await Promise.all(chat_messages.map(message => render(message.message_id)));\n    }\n    loglevel__WEBPACK_IMPORTED_MODULE_1___default().info(`修改第 '${chat_messages.map(message => message.message_id).join(', ')}' 楼的消息, 选项: ${JSON.stringify({\n        refresh,\n    })}`);\n}\nasync function createChatMessages(chat_messages, { insert_at = 'end', refresh = 'all' } = {}) {\n    if (insert_at !== 'end') {\n        insert_at = insert_at < 0 ? _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.length + insert_at : insert_at;\n        if (insert_at < 0 || insert_at > _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.length) {\n            throw Error(`提供的 insert_at 无效, 请提供一个在 '0' 到 '${_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.length}' 之间的整数, 你提供的是: '${insert_at}'`);\n        }\n    }\n    const convert = async (chat_message) => {\n        const result = {};\n        if (chat_message?.name !== undefined) {\n            _.set(result, 'name', chat_message.name);\n        }\n        else if (chat_message.role === 'user') {\n            _.set(result, 'name', _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name1);\n        }\n        else {\n            _.set(result, 'name', _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name2);\n        }\n        // TODO: avatar\n        _.set(result, 'is_user', chat_message.role === 'user');\n        _.set(result, 'is_system', chat_message.is_hidden ?? false);\n        _.set(result, 'mes', chat_message.message);\n        _.set(result, ['variables', 0], chat_message.data ?? {});\n        return result;\n    };\n    const converted = await Promise.all(chat_messages.map(convert));\n    if (insert_at === 'end') {\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.push(...converted);\n    }\n    else {\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.splice(insert_at, 0, ...converted);\n    }\n    await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveChatConditional)();\n    if (refresh === 'affected' && insert_at === 'end') {\n        converted.forEach(message => (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.addOneMessage)(message));\n    }\n    else {\n        await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.reloadCurrentChat)();\n    }\n    loglevel__WEBPACK_IMPORTED_MODULE_1___default().info(`在${insert_at === 'end' ? '最后' : `第 ${insert_at} 楼前`}创建 ${chat_messages.length} 条消息, 选项: ${JSON.stringify({\n        insert_at,\n        refresh,\n    })}`);\n}\nasync function deleteChatMessages(message_ids, { refresh = 'all' } = {}) {\n    message_ids = message_ids.map(id => (id < 0 ? _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.length + id : id)).filter(id => id >= 0 && id < _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.length);\n    _.pullAt(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat, message_ids);\n    await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveChatConditional)();\n    if (refresh === 'all') {\n        await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.reloadCurrentChat)();\n    }\n    loglevel__WEBPACK_IMPORTED_MODULE_1___default().info(`删除第 '${message_ids.join(', ')}' 楼的消息, 选项: ${JSON.stringify({\n        refresh,\n    })}`);\n}\nasync function rotateChatMessages(begin, middle, end, { refresh = 'all' } = {}) {\n    const right_part = _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.splice(middle, end - middle);\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.splice(begin, 0, ...right_part);\n    await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveChatConditional)();\n    if (refresh === 'all') {\n        await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.reloadCurrentChat)();\n    }\n    loglevel__WEBPACK_IMPORTED_MODULE_1___default().info(`旋转第 '[${begin}, ${middle}) [${middle}, ${end})' 楼的消息, 选项: ${JSON.stringify({\n        refresh,\n    })}`);\n}\n//----------------------------------------------------------------------------------------------------------------------\n/** @deprecated 请使用 `setChatMessages` 代替 */\nasync function setChatMessage(field_values, message_id, { swipe_id = 'current', refresh = 'display_and_render_current', } = {}) {\n    field_values = typeof field_values === 'string' ? { message: field_values } : field_values;\n    if (typeof swipe_id !== 'number' && swipe_id !== 'current') {\n        throw Error(`提供的 swipe_id 无效, 请提供 'current' 或序号, 你提供的是: ${swipe_id} `);\n    }\n    if (!['none', 'display_current', 'display_and_render_current', 'all'].includes(refresh)) {\n        throw Error(`提供的 refresh 无效, 请提供 'none', 'display_current', 'display_and_render_current' 或 'all', 你提供的是: ${refresh} `);\n    }\n    const chat_message = _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat.at(message_id);\n    if (!chat_message) {\n        loglevel__WEBPACK_IMPORTED_MODULE_1___default().warn(`未找到第 ${message_id} 楼的消息`);\n        return;\n    }\n    const add_swipes_if_required = () => {\n        if (swipe_id === 'current') {\n            return false;\n        }\n        // swipe_id 对应的消息页存在\n        if (swipe_id == 0 || (chat_message.swipes && swipe_id < chat_message.swipes.length)) {\n            return true;\n        }\n        if (!chat_message.swipes) {\n            chat_message.swipe_id = 0;\n            chat_message.swipes = [chat_message.mes];\n            chat_message.variables = [{}];\n        }\n        for (let i = chat_message.swipes.length; i <= swipe_id; ++i) {\n            chat_message.swipes.push('');\n            chat_message.variables.push({});\n        }\n        return true;\n    };\n    const swipe_id_previous_index = chat_message.swipe_id ?? 0;\n    const swipe_id_to_set_index = swipe_id == 'current' ? swipe_id_previous_index : swipe_id;\n    const swipe_id_to_use_index = refresh != 'none' ? swipe_id_to_set_index : swipe_id_previous_index;\n    const message = field_values.message ??\n        (chat_message.swipes ? chat_message.swipes[swipe_id_to_set_index] : undefined) ??\n        chat_message.mes;\n    const update_chat_message = () => {\n        const message_demacroed = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.substituteParamsExtended)(message);\n        if (field_values.data) {\n            if (!chat_message.variables) {\n                chat_message.variables = [];\n            }\n            chat_message.variables[swipe_id_to_set_index] = field_values.data;\n        }\n        if (chat_message.swipes) {\n            chat_message.swipes[swipe_id_to_set_index] = message_demacroed;\n            chat_message.swipe_id = swipe_id_to_use_index;\n        }\n        if (swipe_id_to_use_index === swipe_id_to_set_index) {\n            chat_message.mes = message_demacroed;\n        }\n    };\n    const update_partial_html = async (should_update_swipe) => {\n        // @ts-ignore\n        const mes_html = $(`div.mes[mesid = \"${message_id}\"]`);\n        if (!mes_html) {\n            return;\n        }\n        if (should_update_swipe) {\n            // FIXME: 只有一条消息时, swipes-counter 不会正常显示; 此外还要考虑 swipes-counter 的 \"Swipe # for All Messages\" 选项\n            mes_html.find('.swipes-counter').text(`${swipe_id_to_use_index + 1}\\u200b/\\u200b${chat_message.swipes.length}`);\n        }\n        if (refresh != 'none') {\n            mes_html\n                .find('.mes_text')\n                .empty()\n                .append((0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.messageFormatting)(message, chat_message.name, chat_message.is_system, chat_message.is_user, message_id));\n            if (refresh === 'display_and_render_current') {\n                await _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.emit(chat_message.is_user ? _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.USER_MESSAGE_RENDERED : _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.event_types.CHARACTER_MESSAGE_RENDERED, message_id);\n            }\n        }\n    };\n    const should_update_swipe = add_swipes_if_required();\n    update_chat_message();\n    await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveChatConditional)();\n    if (refresh == 'all') {\n        await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.reloadCurrentChat)();\n    }\n    else {\n        await update_partial_html(should_update_swipe);\n    }\n    loglevel__WEBPACK_IMPORTED_MODULE_1___default().info(`设置第 ${message_id} 楼消息, 选项: ${JSON.stringify({\n        swipe_id,\n        refresh,\n    })}, 设置前使用的消息页: ${swipe_id_previous_index}, 设置的消息页: ${swipe_id_to_set_index}, 现在使用的消息页: ${swipe_id_to_use_index} `);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEVBQUUsWUFBWSxDQUFDLElBQUksRUFBRSxZQUFZLENBQUMsU0FBUyxFQUFFLFlBQVksQ0FBQyxPQUFPLEVBQUUsVUFBVSxDQUFDLENBQ3hHLENBQUM7WUFDSixJQUFJLE9BQU8sS0FBSyw0QkFBNEIsRUFBRSxDQUFDO2dCQUM3QyxNQUFNLDREQUFXLENBQUMsSUFBSSxDQUNwQixZQUFZLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyw0REFBVyxDQUFDLHFCQUFxQixDQUFDLENBQUMsQ0FBQyw0REFBVyxDQUFDLDBCQUEwQixFQUNqRyxVQUFVLENBQ1gsQ0FBQztZQUNKLENBQUM7UUFDSCxDQUFDO0lBQ0gsQ0FBQyxDQUFDO0lBRUYsTUFBTSxtQkFBbUIsR0FBWSxzQkFBc0IsRUFBRSxDQUFDO0lBQzlELG1CQUFtQixFQUFFLENBQUM7SUFDdEIsTUFBTSx3RUFBbUIsRUFBRSxDQUFDO0lBQzVCLElBQUksT0FBTyxJQUFJLEtBQUssRUFBRSxDQUFDO1FBQ3JCLE1BQU0sc0VBQWlCLEVBQUUsQ0FBQztJQUM1QixDQUFDO1NBQU0sQ0FBQztRQUNOLE1BQU0sbUJBQW1CLENBQUMsbUJBQW1CLENBQUMsQ0FBQztJQUNqRCxDQUFDO0lBRUQsb0RBQVEsQ0FDTixPQUFPLFVBQVUsYUFBYSxJQUFJLENBQUMsU0FBUyxDQUFDO1FBQzNDLFFBQVE7UUFDUixPQUFPO0tBQ1IsQ0FBQyxnQkFBZ0IsdUJBQXVCLGFBQWEscUJBQXFCLGVBQWUscUJBQXFCLEdBQUcsQ0FDbkgsQ0FBQztBQUNKLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvZnVuY3Rpb24vY2hhdF9tZXNzYWdlLnRzPzk2NzgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgYWRkT25lTWVzc2FnZSxcbiAgY2hhdCxcbiAgZXZlbnRfdHlwZXMsXG4gIGV2ZW50U291cmNlLFxuICBtZXNzYWdlRm9ybWF0dGluZyxcbiAgbmFtZTEsXG4gIG5hbWUyLFxuICByZWxvYWRDdXJyZW50Q2hhdCxcbiAgc2F2ZUNoYXRDb25kaXRpb25hbCxcbiAgc3Vic3RpdHV0ZVBhcmFtc0V4dGVuZGVkLFxuICBzeXN0ZW1fbWVzc2FnZV90eXBlcyxcbn0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5cbmltcG9ydCBsb2cgZnJvbSAnbG9nbGV2ZWwnO1xuXG5pbnRlcmZhY2UgQ2hhdE1lc3NhZ2Uge1xuICBtZXNzYWdlX2lkOiBudW1iZXI7XG4gIG5hbWU6IHN0cmluZztcbiAgcm9sZTogJ3N5c3RlbScgfCAnYXNzaXN0YW50JyB8ICd1c2VyJztcbiAgaXNfaGlkZGVuOiBib29sZWFuO1xuICBtZXNzYWdlOiBzdHJpbmc7XG4gIGRhdGE6IFJlY29yZDxzdHJpbmcsIGFueT47XG4gIGV4dHJhOiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xufVxuXG5pbnRlcmZhY2UgQ2hhdE1lc3NhZ2VTd2lwZWQge1xuICBtZXNzYWdlX2lkOiBudW1iZXI7XG4gIG5hbWU6IHN0cmluZztcbiAgcm9sZTogJ3N5c3RlbScgfCAnYXNzaXN0YW50JyB8ICd1c2VyJztcbiAgaXNfaGlkZGVuOiBib29sZWFuO1xuICBzd2lwZV9pZDogbnVtYmVyO1xuICBzd2lwZXM6IHN0cmluZ1tdO1xuICBzd2lwZXNfZGF0YTogUmVjb3JkPHN0cmluZywgYW55PltdO1xuICBzd2lwZXNfaW5mbzogUmVjb3JkPHN0cmluZywgYW55PltdO1xufVxuXG5pbnRlcmZhY2UgR2V0Q2hhdE1lc3NhZ2VzT3B0aW9uIHtcbiAgcm9sZT86ICdhbGwnIHwgJ3N5c3RlbScgfCAnYXNzaXN0YW50JyB8ICd1c2VyJztcbiAgaGlkZV9zdGF0ZT86ICdhbGwnIHwgJ2hpZGRlbicgfCAndW5oaWRkZW4nO1xuICBpbmNsdWRlX3N3aXBlcz86IGJvb2xlYW47XG59XG5cbmZ1bmN0aW9uIHN0cmluZ190b19yYW5nZShpbnB1dDogc3RyaW5nLCBtaW46IG51bWJlciwgbWF4OiBudW1iZXIpIHtcbiAgbGV0IHN0YXJ0LCBlbmQ7XG5cbiAgaWYgKGlucHV0Lm1hdGNoKC9eKC0/XFxkKykkLykpIHtcbiAgICBjb25zdCB2YWx1ZSA9IE51bWJlcihpbnB1dCk7XG4gICAgc3RhcnQgPSBlbmQgPSB2YWx1ZSA8IDAgPyBtYXggKyB2YWx1ZSArIDEgOiB2YWx1ZTtcbiAgfSBlbHNlIHtcbiAgICBjb25zdCBtYXRjaCA9IGlucHV0Lm1hdGNoKC9eKC0/XFxkKyktKC0/XFxkKykkLyk7XG4gICAgaWYgKCFtYXRjaCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgW3N0YXJ0LCBlbmRdID0gXy5zb3J0QnkoXG4gICAgICBbbWF0Y2hbMV0sIG1hdGNoWzJdXS5tYXAodmFsdWUgPT4gTnVtYmVyKHZhbHVlKSkubWFwKHZhbHVlID0+ICh2YWx1ZSA8IDAgPyBtYXggKyB2YWx1ZSArIDEgOiB2YWx1ZSkpLFxuICAgICk7XG4gIH1cblxuICBpZiAoaXNOYU4oc3RhcnQpIHx8IGlzTmFOKGVuZCkgfHwgc3RhcnQgPiBlbmQgfHwgc3RhcnQgPCBtaW4gfHwgZW5kID4gbWF4KSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgcmV0dXJuIHsgc3RhcnQsIGVuZCB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q2hhdE1lc3NhZ2VzKFxuICByYW5nZTogc3RyaW5nIHwgbnVtYmVyLFxuICB7IHJvbGUsIGhpZGVfc3RhdGUsIGluY2x1ZGVfc3dpcGVzIH0/OiBPbWl0PEdldENoYXRNZXNzYWdlc09wdGlvbiwgJ2luY2x1ZGVfc3dpcGVzJz4gJiB7IGluY2x1ZGVfc3dpcGVzPzogZmFsc2UgfSxcbik6IENoYXRNZXNzYWdlW107XG5leHBvcnQgZnVuY3Rpb24gZ2V0Q2hhdE1lc3NhZ2VzKFxuICByYW5nZTogc3RyaW5nIHwgbnVtYmVyLFxuICB7IHJvbGUsIGhpZGVfc3RhdGUsIGluY2x1ZGVfc3dpcGVzIH0/OiBPbWl0PEdldENoYXRNZXNzYWdlc09wdGlvbiwgJ2luY2x1ZGVfc3dpcGVzJz4gJiB7IGluY2x1ZGVfc3dpcGVzPzogdHJ1ZSB9LFxuKTogQ2hhdE1lc3NhZ2VTd2lwZWRbXTtcbmV4cG9ydCBmdW5jdGlvbiBnZXRDaGF0TWVzc2FnZXMoXG4gIHJhbmdlOiBzdHJpbmcgfCBudW1iZXIsXG4gIHsgcm9sZSA9ICdhbGwnLCBoaWRlX3N0YXRlID0gJ2FsbCcsIGluY2x1ZGVfc3dpcGVzID0gZmFsc2UgfTogR2V0Q2hhdE1lc3NhZ2VzT3B0aW9uID0ge30sXG4pOiAoQ2hhdE1lc3NhZ2UgfCBDaGF0TWVzc2FnZVN3aXBlZClbXSB7XG4gIGNvbnN0IHJhbmdlX2RlbWFjcm9lZCA9IHN1YnN0aXR1dGVQYXJhbXNFeHRlbmRlZChyYW5nZS50b1N0cmluZygpKTtcbiAgY29uc3QgcmFuZ2VfbnVtYmVyID0gc3RyaW5nX3RvX3JhbmdlKHJhbmdlX2RlbWFjcm9lZCwgMCwgY2hhdC5sZW5ndGggLSAxKTtcbiAgaWYgKCFyYW5nZV9udW1iZXIpIHtcbiAgICB0aHJvdyBFcnJvcihg5o+Q5L6b55qE5raI5oGv6IyD5Zu0IHJhbmdlIOaXoOaViDogJHtyYW5nZX1gKTtcbiAgfVxuICBpZiAoIVsnYWxsJywgJ3N5c3RlbScsICdhc3Npc3RhbnQnLCAndXNlciddLmluY2x1ZGVzKHJvbGUpKSB7XG4gICAgdGhyb3cgRXJyb3IoYOaPkOS+m+eahCByb2xlIOaXoOaViCwg6K+35o+Q5L6bICdhbGwnLCAnc3lzdGVtJywgJ2Fzc2lzdGFudCcg5oiWICd1c2VyJywg5L2g5o+Q5L6b55qE5pivOiAke3JvbGV9YCk7XG4gIH1cbiAgaWYgKCFbJ2FsbCcsICdoaWRkZW4nLCAndW5oaWRkZW4nXS5pbmNsdWRlcyhoaWRlX3N0YXRlKSkge1xuICAgIHRocm93IEVycm9yKGDmj5DkvpvnmoQgaGlkZV9zdGF0ZSDml6DmlYgsIOivt+aPkOS+myAnYWxsJywgJ2hpZGRlbicg5oiWICd1bmhpZGRlbicsIOS9oOaPkOS+m+eahOaYrzogJHtoaWRlX3N0YXRlfWApO1xuICB9XG5cbiAgY29uc3QgeyBzdGFydCwgZW5kIH0gPSByYW5nZV9udW1iZXI7XG5cbiAgY29uc3QgZ2V0X3JvbGUgPSAoY2hhdF9tZXNzYWdlOiBhbnkpID0+IHtcbiAgICBjb25zdCBpc19uYXJyYXRvciA9IGNoYXRfbWVzc2FnZS5leHRyYT8udHlwZSA9PT0gc3lzdGVtX21lc3NhZ2VfdHlwZXMuTkFSUkFUT1I7XG4gICAgaWYgKGlzX25hcnJhdG9yKSB7XG4gICAgICBpZiAoY2hhdF9tZXNzYWdlLmlzX3VzZXIpIHtcbiAgICAgICAgcmV0dXJuICd1bmtub3duJztcbiAgICAgIH1cbiAgICAgIHJldHVybiAnc3lzdGVtJztcbiAgICB9XG4gICAgaWYgKGNoYXRfbWVzc2FnZS5pc191c2VyKSB7XG4gICAgICByZXR1cm4gJ3VzZXInO1xuICAgIH1cbiAgICByZXR1cm4gJ2Fzc2lzdGFudCc7XG4gIH07XG5cbiAgY29uc3QgcHJvY2Vzc19tZXNzYWdlID0gKG1lc3NhZ2VfaWQ6IG51bWJlcik6IChDaGF0TWVzc2FnZSB8IENoYXRNZXNzYWdlU3dpcGVkKSB8IG51bGwgPT4ge1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBjaGF0W21lc3NhZ2VfaWRdO1xuICAgIGlmICghbWVzc2FnZSkge1xuICAgICAgbG9nLndhcm4oYOayoeaJvuWIsOesrCAke21lc3NhZ2VfaWR9IOalvOeahOa2iOaBr2ApO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgY29uc3QgbWVzc2FnZV9yb2xlID0gZ2V0X3JvbGUobWVzc2FnZSk7XG4gICAgaWYgKHJvbGUgIT09ICdhbGwnICYmIG1lc3NhZ2Vfcm9sZSAhPT0gcm9sZSkge1xuICAgICAgbG9nLmRlYnVnKGDnrZvljrvkuobnrKwgJHttZXNzYWdlX2lkfSDmpbznmoTmtojmga/lm6DkuLrlroPnmoTouqvku73kuI3mmK8gJHtyb2xlfWApO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgaWYgKGhpZGVfc3RhdGUgIT09ICdhbGwnICYmIChoaWRlX3N0YXRlID09PSAnaGlkZGVuJykgIT09IG1lc3NhZ2UuaXNfc3lzdGVtKSB7XG4gICAgICBsb2cuZGVidWcoYOetm+WOu+S6huesrCAke21lc3NhZ2VfaWR9IOalvOeahOa2iOaBr+WboOS4uuWugyR7aGlkZV9zdGF0ZSA9PT0gJ2hpZGRlbicgPyBgYCA6IGDmsqFgfSDooqvpmpDol49gKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGNvbnN0IHN3aXBlX2lkID0gbWVzc2FnZT8uc3dpcGVfaWQgPz8gMDtcbiAgICBjb25zdCBzd2lwZXMgPSBtZXNzYWdlPy5zd2lwZXMgPz8gW21lc3NhZ2UubWVzXTtcbiAgICBjb25zdCBzd2lwZXNfZGF0YSA9IG1lc3NhZ2U/LnZhcmlhYmxlcyA/PyBbe31dO1xuICAgIGNvbnN0IHN3aXBlc19pbmZvID0gbWVzc2FnZT8uc3dpcGVzX2luZm8gPz8gW21lc3NhZ2U/LmV4dHJhID8/IHt9XTtcbiAgICBjb25zdCBleHRyYSA9IHN3aXBlc19pbmZvW3N3aXBlX2lkXTtcbiAgICBjb25zdCBkYXRhID0gc3dpcGVzX2RhdGFbc3dpcGVfaWRdO1xuXG4gICAgaWYgKGluY2x1ZGVfc3dpcGVzKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBtZXNzYWdlX2lkOiBtZXNzYWdlX2lkLFxuICAgICAgICBuYW1lOiBtZXNzYWdlLm5hbWUsXG4gICAgICAgIHJvbGU6IG1lc3NhZ2Vfcm9sZSBhcyAnc3lzdGVtJyB8ICdhc3Npc3RhbnQnIHwgJ3VzZXInLFxuICAgICAgICBpc19oaWRkZW46IG1lc3NhZ2UuaXNfc3lzdGVtLFxuICAgICAgICBzd2lwZV9pZDogc3dpcGVfaWQsXG4gICAgICAgIHN3aXBlczogc3dpcGVzLFxuICAgICAgICBzd2lwZXNfZGF0YTogc3dpcGVzX2RhdGEsXG4gICAgICAgIHN3aXBlc19pbmZvOiBzd2lwZXNfaW5mbyxcbiAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICBtZXNzYWdlX2lkOiBtZXNzYWdlX2lkLFxuICAgICAgbmFtZTogbWVzc2FnZS5uYW1lLFxuICAgICAgcm9sZTogbWVzc2FnZV9yb2xlIGFzICdzeXN0ZW0nIHwgJ2Fzc2lzdGFudCcgfCAndXNlcicsXG4gICAgICBpc19oaWRkZW46IG1lc3NhZ2UuaXNfc3lzdGVtLFxuICAgICAgbWVzc2FnZTogbWVzc2FnZS5tZXMsXG4gICAgICBkYXRhOiBkYXRhLFxuICAgICAgZXh0cmE6IGV4dHJhLFxuXG4gICAgICAvLyBmb3IgY29tcGF0aWJpbGl0eVxuICAgICAgc3dpcGVfaWQ6IHN3aXBlX2lkLFxuICAgICAgc3dpcGVzOiBzd2lwZXMsXG4gICAgICBzd2lwZXNfZGF0YTogc3dpcGVzX2RhdGEsXG4gICAgfTtcbiAgfTtcblxuICBjb25zdCBjaGF0X21lc3NhZ2VzOiAoQ2hhdE1lc3NhZ2UgfCBDaGF0TWVzc2FnZVN3aXBlZClbXSA9IF8ucmFuZ2Uoc3RhcnQsIGVuZCArIDEpXG4gICAgLm1hcChpID0+IHByb2Nlc3NfbWVzc2FnZShpKSlcbiAgICAuZmlsdGVyKGNoYXRfbWVzc2FnZSA9PiBjaGF0X21lc3NhZ2UgIT09IG51bGwpO1xuXG4gIGxvZy5pbmZvKFxuICAgIGDojrflj5Yke3N0YXJ0ID09IGVuZCA/IGDnrKwgJHtzdGFydH0gYCA6IGAgJHtzdGFydH0tJHtlbmR9IGB95qW855qE5raI5oGvLCDpgInpobk6ICR7SlNPTi5zdHJpbmdpZnkoe1xuICAgICAgcm9sZSxcbiAgICAgIGhpZGVfc3RhdGUsXG4gICAgICBpbmNsdWRlX3N3aXBlcyxcbiAgICB9KX0gYCxcbiAgKTtcbiAgcmV0dXJuIHN0cnVjdHVyZWRDbG9uZShjaGF0X21lc3NhZ2VzKTtcbn1cblxuaW50ZXJmYWNlIFNldENoYXRNZXNzYWdlc09wdGlvbiB7XG4gIHJlZnJlc2g/OiAnbm9uZScgfCAnYWZmZWN0ZWQnIHwgJ2FsbCc7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZXRDaGF0TWVzc2FnZXMoXG4gIGNoYXRfbWVzc2FnZXM6IEFycmF5PHsgbWVzc2FnZV9pZDogbnVtYmVyIH0gJiAoUGFydGlhbDxDaGF0TWVzc2FnZT4gfCBQYXJ0aWFsPENoYXRNZXNzYWdlU3dpcGVkPik+LFxuICB7IHJlZnJlc2ggPSAnYWZmZWN0ZWQnIH06IFNldENoYXRNZXNzYWdlc09wdGlvbiA9IHt9LFxuKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IGlzX2NoYXRfbWVzc2FnZSA9IChcbiAgICBjaGF0X21lc3NhZ2U6IHsgbWVzc2FnZV9pZDogbnVtYmVyIH0gJiAoUGFydGlhbDxDaGF0TWVzc2FnZT4gfCBQYXJ0aWFsPENoYXRNZXNzYWdlU3dpcGVkPiksXG4gICk6IGNoYXRfbWVzc2FnZSBpcyB7IG1lc3NhZ2VfaWQ6IG51bWJlciB9ICYgUGFydGlhbDxDaGF0TWVzc2FnZT4gPT4ge1xuICAgIHJldHVybiBfLmhhcyhjaGF0X21lc3NhZ2UsICdtZXNzYWdlJykgfHwgXy5oYXMoY2hhdF9tZXNzYWdlLCAnZGF0YScpO1xuICB9O1xuXG4gIGNvbnN0IG1vZGlmeSA9IGFzeW5jIChjaGF0X21lc3NhZ2U6IHsgbWVzc2FnZV9pZDogbnVtYmVyIH0gJiAoUGFydGlhbDxDaGF0TWVzc2FnZT4gfCBQYXJ0aWFsPENoYXRNZXNzYWdlU3dpcGVkPikpID0+IHtcbiAgICBjb25zdCBkYXRhID0gY2hhdFtjaGF0X21lc3NhZ2UubWVzc2FnZV9pZF07XG4gICAgaWYgKGRhdGEgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChjaGF0X21lc3NhZ2U/Lm5hbWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgXy5zZXQoZGF0YSwgJ25hbWUnLCBjaGF0X21lc3NhZ2UubmFtZSk7XG4gICAgfVxuICAgIGlmIChjaGF0X21lc3NhZ2U/LnJvbGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgXy5zZXQoZGF0YSwgJ2lzX3VzZXInLCBjaGF0X21lc3NhZ2Uucm9sZSA9PT0gJ3VzZXInKTtcbiAgICB9XG4gICAgaWYgKGNoYXRfbWVzc2FnZT8uaXNfaGlkZGVuICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIF8uc2V0KGRhdGEsICdpc19zeXN0ZW0nLCBjaGF0X21lc3NhZ2UuaXNfaGlkZGVuKTtcbiAgICB9XG5cbiAgICBpZiAoaXNfY2hhdF9tZXNzYWdlKGNoYXRfbWVzc2FnZSkpIHtcbiAgICAgIGlmIChjaGF0X21lc3NhZ2U/Lm1lc3NhZ2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBfLnNldChkYXRhLCAnbWVzJywgY2hhdF9tZXNzYWdlLm1lc3NhZ2UpO1xuICAgICAgICBpZiAoZGF0YT8uc3dpcGVzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBfLnNldChkYXRhLCBbJ3N3aXBlcycsIGRhdGEuc3dpcGVfaWRdLCBjaGF0X21lc3NhZ2UubWVzc2FnZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChjaGF0X21lc3NhZ2U/LmRhdGEgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBpZiAoZGF0YT8udmFyaWFibGVzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBfLnNldChkYXRhLCAndmFyaWFibGVzJywgXy50aW1lcyhkYXRhLnN3aXBlcz8ubGVuZ3RoID8/IDEsIF8uY29uc3RhbnQoe30pKSk7XG4gICAgICAgIH1cbiAgICAgICAgXy5zZXQoZGF0YSwgWyd2YXJpYWJsZXMnLCBkYXRhLnN3aXBlX2lkID8/IDBdLCBjaGF0X21lc3NhZ2UuZGF0YSk7XG4gICAgICAgIGV2ZW50U291cmNlLmVtaXQoJ21lc3NhZ2VfdmFyaWFibGVzX2NoYW5nZWQnLCB7XG4gICAgICAgICAgbWVzc2FnZV9pZDogY2hhdF9tZXNzYWdlLm1lc3NhZ2VfaWQsXG4gICAgICAgICAgdmFyaWFibGVzOiBjaGF0X21lc3NhZ2UuZGF0YSxcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBpZiAoY2hhdF9tZXNzYWdlPy5leHRyYSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGlmIChkYXRhPy5zd2lwZXNfaW5mbyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgXy5zZXQoZGF0YSwgJ3N3aXBlc19pbmZvJywgXy50aW1lcyhkYXRhLnN3aXBlcz8ubGVuZ3RoID8/IDEsIF8uY29uc3RhbnQoe30pKSk7XG4gICAgICAgIH1cbiAgICAgICAgXy5zZXQoZGF0YSwgJ2V4dHJhJywgY2hhdF9tZXNzYWdlPy5leHRyYSk7XG4gICAgICAgIF8uc2V0KGRhdGEsIFsnc3dpcGVzX2luZm8nLCBkYXRhLnN3aXBlX2lkID8/IDBdLCBjaGF0X21lc3NhZ2U/LmV4dHJhKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKFxuICAgICAgY2hhdF9tZXNzYWdlPy5zd2lwZV9pZCAhPT0gdW5kZWZpbmVkIHx8XG4gICAgICBjaGF0X21lc3NhZ2U/LnN3aXBlcyAhPT0gdW5kZWZpbmVkIHx8XG4gICAgICBjaGF0X21lc3NhZ2U/LnN3aXBlc19kYXRhICE9PSB1bmRlZmluZWQgfHxcbiAgICAgIGNoYXRfbWVzc2FnZT8uc3dpcGVzX2luZm8gIT09IHVuZGVmaW5lZFxuICAgICkge1xuICAgICAgXy5zZXQoY2hhdF9tZXNzYWdlLCAnc3dpcGVfaWQnLCBjaGF0X21lc3NhZ2Uuc3dpcGVfaWQgPz8gZGF0YS5zd2lwZV9pZCA/PyAwKTtcbiAgICAgIF8uc2V0KGNoYXRfbWVzc2FnZSwgJ3N3aXBlcycsIGNoYXRfbWVzc2FnZS5zd2lwZXMgPz8gZGF0YS5zd2lwZXMgPz8gW2RhdGEubWVzXSk7XG4gICAgICBfLnNldChjaGF0X21lc3NhZ2UsICdzd2lwZXNfZGF0YScsIGNoYXRfbWVzc2FnZS5zd2lwZXNfZGF0YSA/PyBkYXRhLnZhcmlhYmxlcyA/PyBbe31dKTtcbiAgICAgIF8uc2V0KGNoYXRfbWVzc2FnZSwgJ3N3aXBlc19pbmZvJywgY2hhdF9tZXNzYWdlLnN3aXBlc19pbmZvID8/IGRhdGEuc3dpcGVzX2luZm8gPz8gW3t9XSk7XG4gICAgICBjb25zdCBtYXhfbGVuZ3RoID1cbiAgICAgICAgXy5tYXgoW2NoYXRfbWVzc2FnZS5zd2lwZXM/Lmxlbmd0aCwgY2hhdF9tZXNzYWdlLnN3aXBlc19kYXRhPy5sZW5ndGgsIGNoYXRfbWVzc2FnZS5zd2lwZXNfaW5mbz8ubGVuZ3RoXSkgPz8gMTtcbiAgICAgIChjaGF0X21lc3NhZ2Uuc3dpcGVzIGFzIHN0cmluZ1tdKS5sZW5ndGggPSBtYXhfbGVuZ3RoO1xuICAgICAgKGNoYXRfbWVzc2FnZS5zd2lwZXNfZGF0YSBhcyBSZWNvcmQ8c3RyaW5nLCBhbnk+W10pLmxlbmd0aCA9IG1heF9sZW5ndGg7XG4gICAgICAoY2hhdF9tZXNzYWdlLnN3aXBlc19pbmZvIGFzIFJlY29yZDxzdHJpbmcsIGFueT5bXSkubGVuZ3RoID0gbWF4X2xlbmd0aDtcblxuICAgICAgXy5zZXQoZGF0YSwgJ3N3aXBlcycsIGNoYXRfbWVzc2FnZS5zd2lwZXMpO1xuICAgICAgXy5zZXQoZGF0YSwgJ3ZhcmlhYmxlcycsIGNoYXRfbWVzc2FnZS5zd2lwZXNfZGF0YSk7XG4gICAgICBfLnNldChkYXRhLCAnc3dpcGVzX2luZm8nLCBjaGF0X21lc3NhZ2Uuc3dpcGVzX2luZm8pO1xuICAgICAgXy5zZXQoZGF0YSwgJ3N3aXBlX2lkJywgY2hhdF9tZXNzYWdlLnN3aXBlX2lkKTtcbiAgICAgIF8uc2V0KGRhdGEsICdtZXMnLCBkYXRhLnN3aXBlc1tkYXRhLnN3aXBlX2lkXSk7XG4gICAgICBfLnNldChkYXRhLCAnZXh0cmEnLCBkYXRhLnN3aXBlc19pbmZvW2RhdGEuc3dpcGVfaWRdKTtcblxuICAgICAgZXZlbnRTb3VyY2UuZW1pdCgnbWVzc2FnZV92YXJpYWJsZXNfY2hhbmdlZCcsIHtcbiAgICAgICAgbWVzc2FnZV9pZDogY2hhdF9tZXNzYWdlLm1lc3NhZ2VfaWQsXG4gICAgICAgIHZhcmlhYmxlczogKGNoYXRfbWVzc2FnZS5zd2lwZXNfZGF0YSBhcyBSZWNvcmQ8c3RyaW5nLCBhbnk+W10pW2NoYXRfbWVzc2FnZS5zd2lwZV9pZCBhcyBudW1iZXJdLFxuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IHJlbmRlciA9IGFzeW5jIChtZXNzYWdlX2lkOiBudW1iZXIpID0+IHtcbiAgICBjb25zdCAkbWVzX2h0bWwgPSAkKGBkaXYubWVzW21lc2lkID0gXCIke21lc3NhZ2VfaWR9XCJdYCk7XG4gICAgaWYgKCEkbWVzX2h0bWwpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBjaGF0X21lc3NhZ2UgPSBjaGF0W21lc3NhZ2VfaWRdO1xuICAgIGlmIChjaGF0X21lc3NhZ2Uuc3dpcGVzKSB7XG4gICAgICAkbWVzX2h0bWwuZmluZCgnLnN3aXBlcy1jb3VudGVyJykudGV4dChgJHtjaGF0X21lc3NhZ2Uuc3dpcGVfaWQgKyAxfVxcdTIwMGIvXFx1MjAwYiR7Y2hhdF9tZXNzYWdlLnN3aXBlcy5sZW5ndGh9YCk7XG4gICAgfVxuICAgICRtZXNfaHRtbFxuICAgICAgLmZpbmQoJy5tZXNfdGV4dCcpXG4gICAgICAuZW1wdHkoKVxuICAgICAgLmFwcGVuZChcbiAgICAgICAgbWVzc2FnZUZvcm1hdHRpbmcoXG4gICAgICAgICAgY2hhdF9tZXNzYWdlLm1lcyxcbiAgICAgICAgICBjaGF0X21lc3NhZ2UubmFtZSxcbiAgICAgICAgICBjaGF0X21lc3NhZ2UuaXNfc3lzdGVtLFxuICAgICAgICAgIGNoYXRfbWVzc2FnZS5pc191c2VyLFxuICAgICAgICAgIG1lc3NhZ2VfaWQsXG4gICAgICAgICksXG4gICAgICApO1xuICAgIGF3YWl0IGV2ZW50U291cmNlLmVtaXQoXG4gICAgICBjaGF0X21lc3NhZ2UuaXNfdXNlciA/IGV2ZW50X3R5cGVzLlVTRVJfTUVTU0FHRV9SRU5ERVJFRCA6IGV2ZW50X3R5cGVzLkNIQVJBQ1RFUl9NRVNTQUdFX1JFTkRFUkVELFxuICAgICAgbWVzc2FnZV9pZCxcbiAgICApO1xuICB9O1xuXG4gIGF3YWl0IFByb21pc2UuYWxsKGNoYXRfbWVzc2FnZXMubWFwKG1vZGlmeSkpO1xuICBhd2FpdCBzYXZlQ2hhdENvbmRpdGlvbmFsKCk7XG4gIGlmIChyZWZyZXNoID09PSAnYWxsJykge1xuICAgIGF3YWl0IHJlbG9hZEN1cnJlbnRDaGF0KCk7XG4gIH0gZWxzZSBpZiAocmVmcmVzaCA9PT0gJ2FmZmVjdGVkJykge1xuICAgIGF3YWl0IFByb21pc2UuYWxsKGNoYXRfbWVzc2FnZXMubWFwKG1lc3NhZ2UgPT4gcmVuZGVyKG1lc3NhZ2UubWVzc2FnZV9pZCkpKTtcbiAgfVxuICBsb2cuaW5mbyhcbiAgICBg5L+u5pS556ysICcke2NoYXRfbWVzc2FnZXMubWFwKG1lc3NhZ2UgPT4gbWVzc2FnZS5tZXNzYWdlX2lkKS5qb2luKCcsICcpfScg5qW855qE5raI5oGvLCDpgInpobk6ICR7SlNPTi5zdHJpbmdpZnkoe1xuICAgICAgcmVmcmVzaCxcbiAgICB9KX1gLFxuICApO1xufVxuXG5pbnRlcmZhY2UgQ2hhdE1lc3NhZ2VDcmVhdGluZyB7XG4gIG5hbWU/OiBzdHJpbmc7XG4gIHJvbGU6ICdzeXN0ZW0nIHwgJ2Fzc2lzdGFudCcgfCAndXNlcic7XG4gIGlzX2hpZGRlbj86IGJvb2xlYW47XG4gIG1lc3NhZ2U6IHN0cmluZztcbiAgZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT47XG59XG5cbmludGVyZmFjZSBDcmVhdGVDaGF0TWVzc2FnZXNPcHRpb24ge1xuICBpbnNlcnRfYXQ/OiBudW1iZXIgfCAnZW5kJztcbiAgcmVmcmVzaD86ICdub25lJyB8ICdhZmZlY3RlZCcgfCAnYWxsJztcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNoYXRNZXNzYWdlcyhcbiAgY2hhdF9tZXNzYWdlczogQ2hhdE1lc3NhZ2VDcmVhdGluZ1tdLFxuICB7IGluc2VydF9hdCA9ICdlbmQnLCByZWZyZXNoID0gJ2FsbCcgfTogQ3JlYXRlQ2hhdE1lc3NhZ2VzT3B0aW9uID0ge30sXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgaWYgKGluc2VydF9hdCAhPT0gJ2VuZCcpIHtcbiAgICBpbnNlcnRfYXQgPSBpbnNlcnRfYXQgPCAwID8gY2hhdC5sZW5ndGggKyBpbnNlcnRfYXQgOiBpbnNlcnRfYXQ7XG4gICAgaWYgKGluc2VydF9hdCA8IDAgfHwgaW5zZXJ0X2F0ID4gY2hhdC5sZW5ndGgpIHtcbiAgICAgIHRocm93IEVycm9yKGDmj5DkvpvnmoQgaW5zZXJ0X2F0IOaXoOaViCwg6K+35o+Q5L6b5LiA5Liq5ZyoICcwJyDliLAgJyR7Y2hhdC5sZW5ndGh9JyDkuYvpl7TnmoTmlbTmlbAsIOS9oOaPkOS+m+eahOaYrzogJyR7aW5zZXJ0X2F0fSdgKTtcbiAgICB9XG4gIH1cblxuICBjb25zdCBjb252ZXJ0ID0gYXN5bmMgKGNoYXRfbWVzc2FnZTogQ2hhdE1lc3NhZ2VDcmVhdGluZykgPT4ge1xuICAgIGNvbnN0IHJlc3VsdDogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9O1xuXG4gICAgaWYgKGNoYXRfbWVzc2FnZT8ubmFtZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBfLnNldChyZXN1bHQsICduYW1lJywgY2hhdF9tZXNzYWdlLm5hbWUpO1xuICAgIH0gZWxzZSBpZiAoY2hhdF9tZXNzYWdlLnJvbGUgPT09ICd1c2VyJykge1xuICAgICAgXy5zZXQocmVzdWx0LCAnbmFtZScsIG5hbWUxKTtcbiAgICB9IGVsc2Uge1xuICAgICAgXy5zZXQocmVzdWx0LCAnbmFtZScsIG5hbWUyKTtcbiAgICB9XG5cbiAgICAvLyBUT0RPOiBhdmF0YXJcblxuICAgIF8uc2V0KHJlc3VsdCwgJ2lzX3VzZXInLCBjaGF0X21lc3NhZ2Uucm9sZSA9PT0gJ3VzZXInKTtcbiAgICBfLnNldChyZXN1bHQsICdpc19zeXN0ZW0nLCBjaGF0X21lc3NhZ2UuaXNfaGlkZGVuID8/IGZhbHNlKTtcbiAgICBfLnNldChyZXN1bHQsICdtZXMnLCBjaGF0X21lc3NhZ2UubWVzc2FnZSk7XG4gICAgXy5zZXQocmVzdWx0LCBbJ3ZhcmlhYmxlcycsIDBdLCBjaGF0X21lc3NhZ2UuZGF0YSA/PyB7fSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICBjb25zdCBjb252ZXJ0ZWQgPSBhd2FpdCBQcm9taXNlLmFsbChjaGF0X21lc3NhZ2VzLm1hcChjb252ZXJ0KSk7XG4gIGlmIChpbnNlcnRfYXQgPT09ICdlbmQnKSB7XG4gICAgY2hhdC5wdXNoKC4uLmNvbnZlcnRlZCk7XG4gIH0gZWxzZSB7XG4gICAgY2hhdC5zcGxpY2UoaW5zZXJ0X2F0LCAwLCAuLi5jb252ZXJ0ZWQpO1xuICB9XG4gIGF3YWl0IHNhdmVDaGF0Q29uZGl0aW9uYWwoKTtcbiAgaWYgKHJlZnJlc2ggPT09ICdhZmZlY3RlZCcgJiYgaW5zZXJ0X2F0ID09PSAnZW5kJykge1xuICAgIGNvbnZlcnRlZC5mb3JFYWNoKG1lc3NhZ2UgPT4gYWRkT25lTWVzc2FnZShtZXNzYWdlKSk7XG4gIH0gZWxzZSB7XG4gICAgYXdhaXQgcmVsb2FkQ3VycmVudENoYXQoKTtcbiAgfVxuICBsb2cuaW5mbyhcbiAgICBg5ZyoJHtpbnNlcnRfYXQgPT09ICdlbmQnID8gJ+acgOWQjicgOiBg56ysICR7aW5zZXJ0X2F0fSDmpbzliY1gfeWIm+W7uiAke1xuICAgICAgY2hhdF9tZXNzYWdlcy5sZW5ndGhcbiAgICB9IOadoea2iOaBrywg6YCJ6aG5OiAke0pTT04uc3RyaW5naWZ5KHtcbiAgICAgIGluc2VydF9hdCxcbiAgICAgIHJlZnJlc2gsXG4gICAgfSl9YCxcbiAgKTtcbn1cblxuaW50ZXJmYWNlIERlbGV0ZUNoYXRNZXNzYWdlc09wdGlvbiB7XG4gIHJlZnJlc2g/OiAnbm9uZScgfCAnYWxsJztcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUNoYXRNZXNzYWdlcyhcbiAgbWVzc2FnZV9pZHM6IG51bWJlcltdLFxuICB7IHJlZnJlc2ggPSAnYWxsJyB9OiBEZWxldGVDaGF0TWVzc2FnZXNPcHRpb24gPSB7fSxcbik6IFByb21pc2U8dm9pZD4ge1xuICBtZXNzYWdlX2lkcyA9IG1lc3NhZ2VfaWRzLm1hcChpZCA9PiAoaWQgPCAwID8gY2hhdC5sZW5ndGggKyBpZCA6IGlkKSkuZmlsdGVyKGlkID0+IGlkID49IDAgJiYgaWQgPCBjaGF0Lmxlbmd0aCk7XG5cbiAgXy5wdWxsQXQoY2hhdCwgbWVzc2FnZV9pZHMpO1xuICBhd2FpdCBzYXZlQ2hhdENvbmRpdGlvbmFsKCk7XG4gIGlmIChyZWZyZXNoID09PSAnYWxsJykge1xuICAgIGF3YWl0IHJlbG9hZEN1cnJlbnRDaGF0KCk7XG4gIH1cbiAgbG9nLmluZm8oXG4gICAgYOWIoOmZpOesrCAnJHttZXNzYWdlX2lkcy5qb2luKCcsICcpfScg5qW855qE5raI5oGvLCDpgInpobk6ICR7SlNPTi5zdHJpbmdpZnkoe1xuICAgICAgcmVmcmVzaCxcbiAgICB9KX1gLFxuICApO1xufVxuXG5pbnRlcmZhY2UgUm90YXRlQ2hhdE1lc3NhZ2VzT3B0aW9uIHtcbiAgcmVmcmVzaD86ICdub25lJyB8ICdhbGwnO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcm90YXRlQ2hhdE1lc3NhZ2VzKFxuICBiZWdpbjogbnVtYmVyLFxuICBtaWRkbGU6IG51bWJlcixcbiAgZW5kOiBudW1iZXIsXG4gIHsgcmVmcmVzaCA9ICdhbGwnIH06IFJvdGF0ZUNoYXRNZXNzYWdlc09wdGlvbiA9IHt9LFxuKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IHJpZ2h0X3BhcnQgPSBjaGF0LnNwbGljZShtaWRkbGUsIGVuZCAtIG1pZGRsZSk7XG4gIGNoYXQuc3BsaWNlKGJlZ2luLCAwLCAuLi5yaWdodF9wYXJ0KTtcbiAgYXdhaXQgc2F2ZUNoYXRDb25kaXRpb25hbCgpO1xuICBpZiAocmVmcmVzaCA9PT0gJ2FsbCcpIHtcbiAgICBhd2FpdCByZWxvYWRDdXJyZW50Q2hhdCgpO1xuICB9XG4gIGxvZy5pbmZvKFxuICAgIGDml4vovaznrKwgJ1ske2JlZ2lufSwgJHttaWRkbGV9KSBbJHttaWRkbGV9LCAke2VuZH0pJyDmpbznmoTmtojmga8sIOmAiemhuTogJHtKU09OLnN0cmluZ2lmeSh7XG4gICAgICByZWZyZXNoLFxuICAgIH0pfWAsXG4gICk7XG59XG5cbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqIEBkZXByZWNhdGVkIOivt+S9v+eUqCBgc2V0Q2hhdE1lc3NhZ2VzYCDku6Pmm78gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZXRDaGF0TWVzc2FnZShcbiAgZmllbGRfdmFsdWVzOiB7IG1lc3NhZ2U/OiBzdHJpbmc7IGRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+IH0sXG4gIG1lc3NhZ2VfaWQ6IG51bWJlcixcbiAge1xuICAgIHN3aXBlX2lkID0gJ2N1cnJlbnQnLFxuICAgIHJlZnJlc2ggPSAnZGlzcGxheV9hbmRfcmVuZGVyX2N1cnJlbnQnLFxuICB9OiB7XG4gICAgc3dpcGVfaWQ/OiAnY3VycmVudCcgfCBudW1iZXI7XG4gICAgcmVmcmVzaD86ICdub25lJyB8ICdkaXNwbGF5X2N1cnJlbnQnIHwgJ2Rpc3BsYXlfYW5kX3JlbmRlcl9jdXJyZW50JyB8ICdhbGwnO1xuICB9ID0ge30sXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgZmllbGRfdmFsdWVzID0gdHlwZW9mIGZpZWxkX3ZhbHVlcyA9PT0gJ3N0cmluZycgPyB7IG1lc3NhZ2U6IGZpZWxkX3ZhbHVlcyB9IDogZmllbGRfdmFsdWVzO1xuICBpZiAodHlwZW9mIHN3aXBlX2lkICE9PSAnbnVtYmVyJyAmJiBzd2lwZV9pZCAhPT0gJ2N1cnJlbnQnKSB7XG4gICAgdGhyb3cgRXJyb3IoYOaPkOS+m+eahCBzd2lwZV9pZCDml6DmlYgsIOivt+aPkOS+myAnY3VycmVudCcg5oiW5bqP5Y+3LCDkvaDmj5DkvpvnmoTmmK86ICR7c3dpcGVfaWR9IGApO1xuICB9XG4gIGlmICghWydub25lJywgJ2Rpc3BsYXlfY3VycmVudCcsICdkaXNwbGF5X2FuZF9yZW5kZXJfY3VycmVudCcsICdhbGwnXS5pbmNsdWRlcyhyZWZyZXNoKSkge1xuICAgIHRocm93IEVycm9yKFxuICAgICAgYOaPkOS+m+eahCByZWZyZXNoIOaXoOaViCwg6K+35o+Q5L6bICdub25lJywgJ2Rpc3BsYXlfY3VycmVudCcsICdkaXNwbGF5X2FuZF9yZW5kZXJfY3VycmVudCcg5oiWICdhbGwnLCDkvaDmj5DkvpvnmoTmmK86ICR7cmVmcmVzaH0gYCxcbiAgICApO1xuICB9XG5cbiAgY29uc3QgY2hhdF9tZXNzYWdlID0gY2hhdC5hdChtZXNzYWdlX2lkKTtcbiAgaWYgKCFjaGF0X21lc3NhZ2UpIHtcbiAgICBsb2cud2Fybihg5pyq5om+5Yiw56ysICR7bWVzc2FnZV9pZH0g5qW855qE5raI5oGvYCk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgYWRkX3N3aXBlc19pZl9yZXF1aXJlZCA9ICgpOiBib29sZWFuID0+IHtcbiAgICBpZiAoc3dpcGVfaWQgPT09ICdjdXJyZW50Jykge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIHN3aXBlX2lkIOWvueW6lOeahOa2iOaBr+mhteWtmOWcqFxuICAgIGlmIChzd2lwZV9pZCA9PSAwIHx8IChjaGF0X21lc3NhZ2Uuc3dpcGVzICYmIHN3aXBlX2lkIDwgY2hhdF9tZXNzYWdlLnN3aXBlcy5sZW5ndGgpKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBpZiAoIWNoYXRfbWVzc2FnZS5zd2lwZXMpIHtcbiAgICAgIGNoYXRfbWVzc2FnZS5zd2lwZV9pZCA9IDA7XG4gICAgICBjaGF0X21lc3NhZ2Uuc3dpcGVzID0gW2NoYXRfbWVzc2FnZS5tZXNdO1xuICAgICAgY2hhdF9tZXNzYWdlLnZhcmlhYmxlcyA9IFt7fV07XG4gICAgfVxuICAgIGZvciAobGV0IGkgPSBjaGF0X21lc3NhZ2Uuc3dpcGVzLmxlbmd0aDsgaSA8PSBzd2lwZV9pZDsgKytpKSB7XG4gICAgICBjaGF0X21lc3NhZ2Uuc3dpcGVzLnB1c2goJycpO1xuICAgICAgY2hhdF9tZXNzYWdlLnZhcmlhYmxlcy5wdXNoKHt9KTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH07XG5cbiAgY29uc3Qgc3dpcGVfaWRfcHJldmlvdXNfaW5kZXg6IG51bWJlciA9IGNoYXRfbWVzc2FnZS5zd2lwZV9pZCA/PyAwO1xuICBjb25zdCBzd2lwZV9pZF90b19zZXRfaW5kZXg6IG51bWJlciA9IHN3aXBlX2lkID09ICdjdXJyZW50JyA/IHN3aXBlX2lkX3ByZXZpb3VzX2luZGV4IDogc3dpcGVfaWQ7XG4gIGNvbnN0IHN3aXBlX2lkX3RvX3VzZV9pbmRleDogbnVtYmVyID0gcmVmcmVzaCAhPSAnbm9uZScgPyBzd2lwZV9pZF90b19zZXRfaW5kZXggOiBzd2lwZV9pZF9wcmV2aW91c19pbmRleDtcbiAgY29uc3QgbWVzc2FnZTogc3RyaW5nID1cbiAgICBmaWVsZF92YWx1ZXMubWVzc2FnZSA/P1xuICAgIChjaGF0X21lc3NhZ2Uuc3dpcGVzID8gY2hhdF9tZXNzYWdlLnN3aXBlc1tzd2lwZV9pZF90b19zZXRfaW5kZXhdIDogdW5kZWZpbmVkKSA/P1xuICAgIGNoYXRfbWVzc2FnZS5tZXM7XG5cbiAgY29uc3QgdXBkYXRlX2NoYXRfbWVzc2FnZSA9ICgpID0+IHtcbiAgICBjb25zdCBtZXNzYWdlX2RlbWFjcm9lZCA9IHN1YnN0aXR1dGVQYXJhbXNFeHRlbmRlZChtZXNzYWdlKTtcblxuICAgIGlmIChmaWVsZF92YWx1ZXMuZGF0YSkge1xuICAgICAgaWYgKCFjaGF0X21lc3NhZ2UudmFyaWFibGVzKSB7XG4gICAgICAgIGNoYXRfbWVzc2FnZS52YXJpYWJsZXMgPSBbXTtcbiAgICAgIH1cbiAgICAgIGNoYXRfbWVzc2FnZS52YXJpYWJsZXNbc3dpcGVfaWRfdG9fc2V0X2luZGV4XSA9IGZpZWxkX3ZhbHVlcy5kYXRhO1xuICAgIH1cblxuICAgIGlmIChjaGF0X21lc3NhZ2Uuc3dpcGVzKSB7XG4gICAgICBjaGF0X21lc3NhZ2Uuc3dpcGVzW3N3aXBlX2lkX3RvX3NldF9pbmRleF0gPSBtZXNzYWdlX2RlbWFjcm9lZDtcbiAgICAgIGNoYXRfbWVzc2FnZS5zd2lwZV9pZCA9IHN3aXBlX2lkX3RvX3VzZV9pbmRleDtcbiAgICB9XG5cbiAgICBpZiAoc3dpcGVfaWRfdG9fdXNlX2luZGV4ID09PSBzd2lwZV9pZF90b19zZXRfaW5kZXgpIHtcbiAgICAgIGNoYXRfbWVzc2FnZS5tZXMgPSBtZXNzYWdlX2RlbWFjcm9lZDtcbiAgICB9XG4gIH07XG5cbiAgY29uc3QgdXBkYXRlX3BhcnRpYWxfaHRtbCA9IGFzeW5jIChzaG91bGRfdXBkYXRlX3N3aXBlOiBib29sZWFuKSA9PiB7XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGNvbnN0IG1lc19odG1sID0gJChgZGl2Lm1lc1ttZXNpZCA9IFwiJHttZXNzYWdlX2lkfVwiXWApO1xuICAgIGlmICghbWVzX2h0bWwpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoc2hvdWxkX3VwZGF0ZV9zd2lwZSkge1xuICAgICAgLy8gRklYTUU6IOWPquacieS4gOadoea2iOaBr+aXtiwgc3dpcGVzLWNvdW50ZXIg5LiN5Lya5q2j5bi45pi+56S6OyDmraTlpJbov5jopoHogIPomZEgc3dpcGVzLWNvdW50ZXIg55qEIFwiU3dpcGUgIyBmb3IgQWxsIE1lc3NhZ2VzXCIg6YCJ6aG5XG4gICAgICBtZXNfaHRtbC5maW5kKCcuc3dpcGVzLWNvdW50ZXInKS50ZXh0KGAke3N3aXBlX2lkX3RvX3VzZV9pbmRleCArIDF9XFx1MjAwYi9cXHUyMDBiJHtjaGF0X21lc3NhZ2Uuc3dpcGVzLmxlbmd0aH1gKTtcbiAgICB9XG4gICAgaWYgKHJlZnJlc2ggIT0gJ25vbmUnKSB7XG4gICAgICBtZXNfaHRtbFxuICAgICAgICAuZmluZCgnLm1lc190ZXh0JylcbiAgICAgICAgLmVtcHR5KClcbiAgICAgICAgLmFwcGVuZChcbiAgICAgICAgICBtZXNzYWdlRm9ybWF0dGluZyhtZXNzYWdlLCBjaGF0X21lc3NhZ2UubmFtZSwgY2hhdF9tZXNzYWdlLmlzX3N5c3RlbSwgY2hhdF9tZXNzYWdlLmlzX3VzZXIsIG1lc3NhZ2VfaWQpLFxuICAgICAgICApO1xuICAgICAgaWYgKHJlZnJlc2ggPT09ICdkaXNwbGF5X2FuZF9yZW5kZXJfY3VycmVudCcpIHtcbiAgICAgICAgYXdhaXQgZXZlbnRTb3VyY2UuZW1pdChcbiAgICAgICAgICBjaGF0X21lc3NhZ2UuaXNfdXNlciA/IGV2ZW50X3R5cGVzLlVTRVJfTUVTU0FHRV9SRU5ERVJFRCA6IGV2ZW50X3R5cGVzLkNIQVJBQ1RFUl9NRVNTQUdFX1JFTkRFUkVELFxuICAgICAgICAgIG1lc3NhZ2VfaWQsXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IHNob3VsZF91cGRhdGVfc3dpcGU6IGJvb2xlYW4gPSBhZGRfc3dpcGVzX2lmX3JlcXVpcmVkKCk7XG4gIHVwZGF0ZV9jaGF0X21lc3NhZ2UoKTtcbiAgYXdhaXQgc2F2ZUNoYXRDb25kaXRpb25hbCgpO1xuICBpZiAocmVmcmVzaCA9PSAnYWxsJykge1xuICAgIGF3YWl0IHJlbG9hZEN1cnJlbnRDaGF0KCk7XG4gIH0gZWxzZSB7XG4gICAgYXdhaXQgdXBkYXRlX3BhcnRpYWxfaHRtbChzaG91bGRfdXBkYXRlX3N3aXBlKTtcbiAgfVxuXG4gIGxvZy5pbmZvKFxuICAgIGDorr7nva7nrKwgJHttZXNzYWdlX2lkfSDmpbzmtojmga8sIOmAiemhuTogJHtKU09OLnN0cmluZ2lmeSh7XG4gICAgICBzd2lwZV9pZCxcbiAgICAgIHJlZnJlc2gsXG4gICAgfSl9LCDorr7nva7liY3kvb/nlKjnmoTmtojmga/pobU6ICR7c3dpcGVfaWRfcHJldmlvdXNfaW5kZXh9LCDorr7nva7nmoTmtojmga/pobU6ICR7c3dpcGVfaWRfdG9fc2V0X2luZGV4fSwg546w5Zyo5L2/55So55qE5raI5oGv6aG1OiAke3N3aXBlX2lkX3RvX3VzZV9pbmRleH0gYCxcbiAgKTtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/function/chat_message.ts\n")},"./src/function/displayed_message.ts":
/*!*******************************************!*\
  !*** ./src/function/displayed_message.ts ***!
  \*******************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   formatAsDisplayedMessage: () => (/* binding */ formatAsDisplayedMessage),\n/* harmony export */   retrieveDisplayedMessage: () => (/* binding */ retrieveDisplayedMessage)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_macros__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/macros */ \"@sillytavern/scripts/macros\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\nfunction formatAsDisplayedMessage(text, { message_id = 'last' } = {}) {\n    if (typeof message_id !== 'number' && !['last', 'last_user', 'last_char'].includes(message_id)) {\n        throw Error(`提供的 message_id 无效, 请提供 'last', 'last_user', 'last_char' 或楼层消息号, 你提供的是: ${message_id}`);\n    }\n    const last_message_id = (0,_sillytavern_scripts_macros__WEBPACK_IMPORTED_MODULE_1__.getLastMessageId)();\n    if (last_message_id === null) {\n        throw Error(`未找到任何消息楼层, 你提供的是: ${message_id}`);\n    }\n    switch (message_id) {\n        case 'last':\n            message_id = last_message_id;\n            break;\n        case 'last_user': {\n            const last_user_message_id = (0,_sillytavern_scripts_macros__WEBPACK_IMPORTED_MODULE_1__.getLastMessageId)({ filter: (m) => m.is_user && !m.is_system });\n            if (last_user_message_id === null) {\n                throw Error(`未找到任何 user 消息楼层, 你提供的是: ${message_id}`);\n            }\n            message_id = last_user_message_id;\n            break;\n        }\n        case 'last_char': {\n            const last_char_message_id = (0,_sillytavern_scripts_macros__WEBPACK_IMPORTED_MODULE_1__.getLastMessageId)({ filter: (m) => !m.is_user && !m.is_system });\n            if (last_char_message_id === null) {\n                throw Error(`未找到任何 char 消息楼层, 你提供的是: ${message_id}`);\n            }\n            message_id = last_char_message_id;\n            break;\n        }\n    }\n    if (message_id < 0 || message_id > last_message_id) {\n        throw Error(`提供的 message_id 不在 [0, ${last_message_id}] 内, 你提供的是: ${message_id} `);\n    }\n    const chat_message = _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat[message_id];\n    const result = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.messageFormatting)(text, chat_message.name, chat_message.is_system, chat_message.is_user, message_id);\n    loglevel__WEBPACK_IMPORTED_MODULE_2___default().info(`将字符串处理为酒馆用于显示的 html 格式, 字符串: '${text}', 选项: '${JSON.stringify({\n        message_id,\n    })}', 结果: '${result}'`);\n    return result;\n}\nfunction retrieveDisplayedMessage(message_id) {\n    return $(`div.mes[mesid = \"${message_id}\"]`, window.parent.document).find(`div.mes_text`);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZnVuY3Rpb24vZGlzcGxheWVkX21lc3NhZ2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQThEO0FBQ0M7QUFFcEM7QUFNcEIsU0FBUyx3QkFBd0IsQ0FDdEMsSUFBWSxFQUNaLEVBQUUsVUFBVSxHQUFHLE1BQU0sS0FBcUMsRUFBRTtJQUU1RCxJQUFJLE9BQU8sVUFBVSxLQUFLLFFBQVEsSUFBSSxDQUFDLENBQUMsTUFBTSxFQUFFLFdBQVcsRUFBRSxXQUFXLENBQUMsQ0FBQyxRQUFRLENBQUMsVUFBVSxDQUFDLEVBQUUsQ0FBQztRQUMvRixNQUFNLEtBQUssQ0FDVCwwRUFBMEUsVUFBVSxFQUFFLENBQ3ZGLENBQUM7SUFDSixDQUFDO0lBRUQsTUFBTSxlQUFlLEdBQUcsNkVBQWdCLEVBQUUsQ0FBQztJQUMzQyxJQUFJLGVBQWUsS0FBSyxJQUFJLEVBQUUsQ0FBQztRQUM3QixNQUFNLEtBQUssQ0FBQyxxQkFBcUIsVUFBVSxFQUFFLENBQUMsQ0FBQztJQUNqRCxDQUFDO0lBRUQsUUFBUSxVQUFVLEVBQUUsQ0FBQztRQUNuQixLQUFLLE1BQU07WUFDVCxVQUFVLEdBQUcsZUFBZSxDQUFDO1lBQzdCLE1BQU07UUFDUixLQUFLLFdBQVcsQ0FBQyxDQUFDLENBQUM7WUFDakIsTUFBTSxvQkFBb0IsR0FBRyw2RUFBZ0IsQ0FBQyxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQU0sRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLE9BQU8sSUFBSSxDQUFDLENBQUMsQ0FBQyxTQUFTLEVBQUUsQ0FBVyxDQUFDO1lBQzNHLElBQUksb0JBQW9CLEtBQUssSUFBSSxFQUFFLENBQUM7Z0JBQ2xDLE1BQU0sS0FBSyxDQUFDLDJCQUEyQixVQUFVLEVBQUUsQ0FBQyxDQUFDO1lBQ3ZELENBQUM7WUFDRCxVQUFVLEdBQUcsb0JBQW9CLENBQUM7WUFDbEMsTUFBTTtRQUNSLENBQUM7UUFDRCxLQUFLLFdBQVcsQ0FBQyxDQUFDLENBQUM7WUFDakIsTUFBTSxvQkFBb0IsR0FBRyw2RUFBZ0IsQ0FBQyxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQU0sRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxJQUFJLENBQUMsQ0FBQyxDQUFDLFNBQVMsRUFBRSxDQUFXLENBQUM7WUFDNUcsSUFBSSxvQkFBb0IsS0FBSyxJQUFJLEVBQUUsQ0FBQztnQkFDbEMsTUFBTSxLQUFLLENBQUMsMkJBQTJCLFVBQVUsRUFBRSxDQUFDLENBQUM7WUFDdkQsQ0FBQztZQUNELFVBQVUsR0FBRyxvQkFBb0IsQ0FBQztZQUNsQyxNQUFNO1FBQ1IsQ0FBQztJQUNILENBQUM7SUFDRCxJQUFJLFVBQVUsR0FBRyxDQUFDLElBQUksVUFBVSxHQUFHLGVBQWUsRUFBRSxDQUFDO1FBQ25ELE1BQU0sS0FBSyxDQUFDLHlCQUF5QixlQUFlLGVBQWUsVUFBVSxHQUFHLENBQUMsQ0FBQztJQUNwRixDQUFDO0lBRUQsTUFBTSxZQUFZLEdBQUcscURBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUN0QyxNQUFNLE1BQU0sR0FBRyxzRUFBaUIsQ0FBQyxJQUFJLEVBQUUsWUFBWSxDQUFDLElBQUksRUFBRSxZQUFZLENBQUMsU0FBUyxFQUFFLFlBQVksQ0FBQyxPQUFPLEVBQUUsVUFBVSxDQUFDLENBQUM7SUFFcEgsb0RBQVEsQ0FDTixpQ0FBaUMsSUFBSSxXQUFXLElBQUksQ0FBQyxTQUFTLENBQUM7UUFDN0QsVUFBVTtLQUNYLENBQUMsV0FBVyxNQUFNLEdBQUcsQ0FDdkIsQ0FBQztJQUNGLE9BQU8sTUFBTSxDQUFDO0FBQ2hCLENBQUM7QUFFTSxTQUFTLHdCQUF3QixDQUFDLFVBQWtCO0lBQ3pELE9BQU8sQ0FBQyxDQUFDLG9CQUFvQixVQUFVLElBQUksRUFBRSxNQUFNLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsQ0FBQztBQUM1RixDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2Z1bmN0aW9uL2Rpc3BsYXllZF9tZXNzYWdlLnRzP2UxOTQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY2hhdCwgbWVzc2FnZUZvcm1hdHRpbmcgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0JztcbmltcG9ydCB7IGdldExhc3RNZXNzYWdlSWQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9tYWNyb3MnO1xuXG5pbXBvcnQgbG9nIGZyb20gJ2xvZ2xldmVsJztcblxuaW50ZXJmYWNlIEZvcm1hdEFzRGlzcGxheWVkTWVzc2FnZU9wdGlvbiB7XG4gIG1lc3NhZ2VfaWQ/OiAnbGFzdCcgfCAnbGFzdF91c2VyJyB8ICdsYXN0X2NoYXInIHwgbnVtYmVyO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZm9ybWF0QXNEaXNwbGF5ZWRNZXNzYWdlKFxuICB0ZXh0OiBzdHJpbmcsXG4gIHsgbWVzc2FnZV9pZCA9ICdsYXN0JyB9OiBGb3JtYXRBc0Rpc3BsYXllZE1lc3NhZ2VPcHRpb24gPSB7fSxcbik6IHN0cmluZyB7XG4gIGlmICh0eXBlb2YgbWVzc2FnZV9pZCAhPT0gJ251bWJlcicgJiYgIVsnbGFzdCcsICdsYXN0X3VzZXInLCAnbGFzdF9jaGFyJ10uaW5jbHVkZXMobWVzc2FnZV9pZCkpIHtcbiAgICB0aHJvdyBFcnJvcihcbiAgICAgIGDmj5DkvpvnmoQgbWVzc2FnZV9pZCDml6DmlYgsIOivt+aPkOS+myAnbGFzdCcsICdsYXN0X3VzZXInLCAnbGFzdF9jaGFyJyDmiJbmpbzlsYLmtojmga/lj7csIOS9oOaPkOS+m+eahOaYrzogJHttZXNzYWdlX2lkfWAsXG4gICAgKTtcbiAgfVxuXG4gIGNvbnN0IGxhc3RfbWVzc2FnZV9pZCA9IGdldExhc3RNZXNzYWdlSWQoKTtcbiAgaWYgKGxhc3RfbWVzc2FnZV9pZCA9PT0gbnVsbCkge1xuICAgIHRocm93IEVycm9yKGDmnKrmib7liLDku7vkvZXmtojmga/mpbzlsYIsIOS9oOaPkOS+m+eahOaYrzogJHttZXNzYWdlX2lkfWApO1xuICB9XG5cbiAgc3dpdGNoIChtZXNzYWdlX2lkKSB7XG4gICAgY2FzZSAnbGFzdCc6XG4gICAgICBtZXNzYWdlX2lkID0gbGFzdF9tZXNzYWdlX2lkO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAnbGFzdF91c2VyJzoge1xuICAgICAgY29uc3QgbGFzdF91c2VyX21lc3NhZ2VfaWQgPSBnZXRMYXN0TWVzc2FnZUlkKHsgZmlsdGVyOiAobTogYW55KSA9PiBtLmlzX3VzZXIgJiYgIW0uaXNfc3lzdGVtIH0pIGFzIG51bWJlcjtcbiAgICAgIGlmIChsYXN0X3VzZXJfbWVzc2FnZV9pZCA9PT0gbnVsbCkge1xuICAgICAgICB0aHJvdyBFcnJvcihg5pyq5om+5Yiw5Lu75L2VIHVzZXIg5raI5oGv5qW85bGCLCDkvaDmj5DkvpvnmoTmmK86ICR7bWVzc2FnZV9pZH1gKTtcbiAgICAgIH1cbiAgICAgIG1lc3NhZ2VfaWQgPSBsYXN0X3VzZXJfbWVzc2FnZV9pZDtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBjYXNlICdsYXN0X2NoYXInOiB7XG4gICAgICBjb25zdCBsYXN0X2NoYXJfbWVzc2FnZV9pZCA9IGdldExhc3RNZXNzYWdlSWQoeyBmaWx0ZXI6IChtOiBhbnkpID0+ICFtLmlzX3VzZXIgJiYgIW0uaXNfc3lzdGVtIH0pIGFzIG51bWJlcjtcbiAgICAgIGlmIChsYXN0X2NoYXJfbWVzc2FnZV9pZCA9PT0gbnVsbCkge1xuICAgICAgICB0aHJvdyBFcnJvcihg5pyq5om+5Yiw5Lu75L2VIGNoYXIg5raI5oGv5qW85bGCLCDkvaDmj5DkvpvnmoTmmK86ICR7bWVzc2FnZV9pZH1gKTtcbiAgICAgIH1cbiAgICAgIG1lc3NhZ2VfaWQgPSBsYXN0X2NoYXJfbWVzc2FnZV9pZDtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuICBpZiAobWVzc2FnZV9pZCA8IDAgfHwgbWVzc2FnZV9pZCA+IGxhc3RfbWVzc2FnZV9pZCkge1xuICAgIHRocm93IEVycm9yKGDmj5DkvpvnmoQgbWVzc2FnZV9pZCDkuI3lnKggWzAsICR7bGFzdF9tZXNzYWdlX2lkfV0g5YaFLCDkvaDmj5DkvpvnmoTmmK86ICR7bWVzc2FnZV9pZH0gYCk7XG4gIH1cblxuICBjb25zdCBjaGF0X21lc3NhZ2UgPSBjaGF0W21lc3NhZ2VfaWRdO1xuICBjb25zdCByZXN1bHQgPSBtZXNzYWdlRm9ybWF0dGluZyh0ZXh0LCBjaGF0X21lc3NhZ2UubmFtZSwgY2hhdF9tZXNzYWdlLmlzX3N5c3RlbSwgY2hhdF9tZXNzYWdlLmlzX3VzZXIsIG1lc3NhZ2VfaWQpO1xuXG4gIGxvZy5pbmZvKFxuICAgIGDlsIblrZfnrKbkuLLlpITnkIbkuLrphZLppobnlKjkuo7mmL7npLrnmoQgaHRtbCDmoLzlvI8sIOWtl+espuS4sjogJyR7dGV4dH0nLCDpgInpobk6ICcke0pTT04uc3RyaW5naWZ5KHtcbiAgICAgIG1lc3NhZ2VfaWQsXG4gICAgfSl9Jywg57uT5p6cOiAnJHtyZXN1bHR9J2AsXG4gICk7XG4gIHJldHVybiByZXN1bHQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZXRyaWV2ZURpc3BsYXllZE1lc3NhZ2UobWVzc2FnZV9pZDogbnVtYmVyKTogSlF1ZXJ5PEhUTUxEaXZFbGVtZW50PiB7XG4gIHJldHVybiAkKGBkaXYubWVzW21lc2lkID0gXCIke21lc3NhZ2VfaWR9XCJdYCwgd2luZG93LnBhcmVudC5kb2N1bWVudCkuZmluZChgZGl2Lm1lc190ZXh0YCk7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/function/displayed_message.ts\n")},"./src/function/generate.ts":
/*!**********************************!*\
  !*** ./src/function/generate.ts ***!
  \**********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   builtin_prompt_default_order: () => (/* binding */ builtin_prompt_default_order),\n/* harmony export */   generate: () => (/* binding */ generate),\n/* harmony export */   generateRaw: () => (/* binding */ generateRaw)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/authors-note */ \"@sillytavern/scripts/authors-note\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var _sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/scripts/extensions/regex/engine */ \"@sillytavern/scripts/extensions/regex/engine\");\n/* harmony import */ var _sillytavern_scripts_i18n__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sillytavern/scripts/i18n */ \"@sillytavern/scripts/i18n\");\n/* harmony import */ var _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @sillytavern/scripts/openai */ \"@sillytavern/scripts/openai\");\n/* harmony import */ var _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @sillytavern/scripts/power-user */ \"@sillytavern/scripts/power-user\");\n/* harmony import */ var _sillytavern_scripts_PromptManager__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @sillytavern/scripts/PromptManager */ \"@sillytavern/scripts/PromptManager\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n/* harmony import */ var _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @sillytavern/scripts/world-info */ \"@sillytavern/scripts/world-info\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_10__);\n\n\n\n\n\n\n\n\n\n\n\nconst builtin_prompt_default_order = [\n    'world_info_before',\n    'persona_description',\n    'char_description',\n    'char_personality',\n    'scenario',\n    'world_info_after',\n    'dialogue_examples',\n    'chat_history',\n    'user_input',\n];\nlet abortController = new AbortController();\nfunction fromOverrides(overrides) {\n    return {\n        world_info_before: overrides.world_info_before,\n        persona_description: overrides.persona_description,\n        char_description: overrides.char_description,\n        char_personality: overrides.char_personality,\n        scenario: overrides.scenario,\n        world_info_after: overrides.world_info_after,\n        dialogue_examples: overrides.dialogue_examples,\n        with_depth_entries: overrides.chat_history?.with_depth_entries,\n        author_note: overrides.chat_history?.author_note,\n        chat_history: overrides.chat_history?.prompts,\n    };\n}\nfunction fromInjectionPrompt(inject) {\n    const position_map = {\n        before_prompt: 'before_prompt',\n        in_chat: 'in_chat',\n        after_prompt: 'after_prompt',\n        none: 'none',\n    };\n    return {\n        role: inject.role,\n        content: inject.content,\n        position: position_map[inject.position],\n        depth: inject.depth,\n        should_scan: inject.should_scan,\n    };\n}\nfunction fromGenerateConfig(config) {\n    return {\n        user_input: config.user_input,\n        use_preset: true,\n        image: config.image,\n        stream: config.should_stream ?? false,\n        overrides: config.overrides !== undefined ? fromOverrides(config.overrides) : undefined,\n        inject: config.injects !== undefined ? config.injects.map(fromInjectionPrompt) : undefined,\n        max_chat_history: typeof config.max_chat_history === 'number' ? config.max_chat_history : undefined,\n    };\n}\nfunction fromGenerateRawConfig(config) {\n    return {\n        user_input: config.user_input,\n        use_preset: false,\n        image: config.image,\n        stream: config.should_stream ?? false,\n        max_chat_history: typeof config.max_chat_history === 'number' ? config.max_chat_history : undefined,\n        overrides: config.overrides ? fromOverrides(config.overrides) : undefined,\n        inject: config.injects ? config.injects.map(fromInjectionPrompt) : undefined,\n        order: config.ordered_prompts,\n    };\n}\nconst type = 'quiet';\nconst dryRun = false;\nconst character_names_behavior = {\n    NONE: -1,\n    DEFAULT: 0,\n    COMPLETION: 1,\n    CONTENT: 2,\n};\nconst roleTypes = {\n    system: _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_roles.SYSTEM,\n    user: _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_roles.USER,\n    assistant: _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_roles.ASSISTANT,\n};\nconst default_order = [\n    'world_info_before',\n    'persona_description',\n    'char_description',\n    'char_personality',\n    'scenario',\n    'world_info_after',\n    'dialogue_examples',\n    'chat_history',\n    'user_input',\n];\nclass StreamingProcessor {\n    generator;\n    stoppingStrings;\n    result;\n    isStopped;\n    isFinished;\n    abortController;\n    messageBuffer;\n    constructor() {\n        this.result = '';\n        this.messageBuffer = '';\n        this.isStopped = false;\n        this.isFinished = false;\n        this.generator = this.nullStreamingGeneration;\n        this.abortController = new AbortController();\n    }\n    onProgressStreaming(text, isFinal) {\n        // 计算增量文本\n        const newText = text.slice(this.messageBuffer.length);\n        this.messageBuffer = text;\n        // 兼容旧版本\n        // @ts-ignore\n        let processedText = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.cleanUpMessage)(newText, false, false, !isFinal, this.stoppingStrings);\n        const charsToBalance = ['*', '\"', '```'];\n        for (const char of charsToBalance) {\n            if (!isFinal && (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.isOdd)((0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.countOccurrences)(processedText, char))) {\n                const separator = char.length > 1 ? '\\n' : '';\n                processedText = processedText.trimEnd() + separator + char;\n            }\n        }\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.emit('js_stream_token_received_fully', text);\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.emit('js_stream_token_received_incrementally', processedText);\n        if (isFinal) {\n            // 兼容旧版本\n            // @ts-ignore\n            const fullText = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.cleanUpMessage)(text, false, false, false, this.stoppingStrings);\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.emit('js_generation_ended', fullText);\n        }\n    }\n    onErrorStreaming() {\n        if (this.abortController) {\n            this.abortController.abort();\n        }\n        this.isStopped = true;\n        unblockGeneration();\n        (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveChatConditional)();\n    }\n    // eslint-disable-next-line require-yield\n    async *nullStreamingGeneration() {\n        throw Error('Generation function for streaming is not hooked up');\n    }\n    async generate() {\n        try {\n            const sw = new _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_8__.Stopwatch(1000 / _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.power_user.streaming_fps);\n            const timestamps = [];\n            for await (const { text } of this.generator()) {\n                timestamps.push(Date.now());\n                if (this.isStopped) {\n                    this.messageBuffer = '';\n                    return;\n                }\n                this.result = text;\n                await sw.tick(() => this.onProgressStreaming(text, false));\n            }\n            if (!this.isStopped) {\n                this.onProgressStreaming(this.result, true);\n            }\n            else {\n                this.messageBuffer = '';\n            }\n            const seconds = (timestamps[timestamps.length - 1] - timestamps[0]) / 1000;\n            loglevel__WEBPACK_IMPORTED_MODULE_10___default().warn(`Stream stats: ${timestamps.length} tokens, ${seconds.toFixed(2)} seconds, rate: ${Number(timestamps.length / seconds).toFixed(2)} TPS`);\n        }\n        catch (err) {\n            if (!this.isFinished) {\n                this.onErrorStreaming();\n                throw Error(`Generate method error: ${err}`);\n            }\n            this.messageBuffer = '';\n            return this.result;\n        }\n        this.isFinished = true;\n        return this.result;\n    }\n}\nasync function iframeGenerate({ user_input = '', use_preset = true, image = undefined, overrides = undefined, max_chat_history = undefined, inject = [], order = undefined, stream = false, } = {}) {\n    //初始化\n    abortController = new AbortController();\n    // 1. 处理用户输入（正则，宏）\n    const processedUserInput = processUserInput((0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.substituteParams)(user_input)) || '';\n    // 2. 准备过滤后的基础数据\n    const baseData = await prepareAndOverrideData({\n        overrides,\n        max_chat_history,\n        inject,\n        order,\n    }, processedUserInput);\n    // 3. 根据 use_preset 分流处理\n    const generate_data = use_preset\n        ? await handlePresetPath(baseData, processedUserInput, {\n            image,\n            overrides,\n            max_chat_history,\n            inject,\n            order,\n        })\n        : await handleCustomPath(baseData, {\n            image,\n            overrides,\n            max_chat_history,\n            inject,\n            order,\n        }, processedUserInput);\n    loglevel__WEBPACK_IMPORTED_MODULE_10___default().info('[Generate:发送提示词]', generate_data);\n    // 4. 根据 stream 参数决定生成方式\n    return await generateResponse(generate_data, stream);\n}\nasync function prepareAndOverrideData(config, processedUserInput) {\n    const getOverrideContent = (identifier) => {\n        if (!config.overrides)\n            return undefined;\n        const value = config.overrides[identifier];\n        if (typeof value === 'boolean')\n            return undefined;\n        return value;\n    };\n    // 1. 处理角色卡高级定义角色备注 - 仅在chat_history未被过滤时执行\n    if (!isPromptFiltered('chat_history', config)) {\n        handleCharDepthPrompt();\n    }\n    // 2. 设置作者注释 - 仅在chat_history未被过滤时执行\n    if (!isPromptFiltered('chat_history', config) && !isPromptFiltered('author_note', config)) {\n        setAuthorNotePrompt(config);\n    }\n    // 3. 处理user角色描述 - 仅在chat_history和persona_description都未被过滤时执行\n    if (!isPromptFiltered('chat_history', config) && !isPromptFiltered('persona_description', config)) {\n        setPersonaDescriptionExtensionPrompt();\n    }\n    // 4. 获取角色卡基础字段\n    const charDepthPrompt = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.baseChatReplace)(\n    // @ts-ignore\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid]?.data?.extensions?.depth_prompt?.prompt?.trim(), _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name1, _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name2);\n    const creatorNotes = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.baseChatReplace)(\n    // @ts-ignore\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid]?.data?.creator_notes?.trim(), _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name1, _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name2);\n    const { description: rawDescription, personality: rawPersonality, persona: rawPersona, scenario: rawScenario, mesExamples: rawMesExamples, system, jailbreak, } = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.getCharacterCardFields)();\n    // 判断是否被过滤,如果被过滤返回空字符串,否则返回override的值或原始值\n    const description = isPromptFiltered('char_description', config)\n        ? ''\n        : getOverrideContent('char_description') ?? rawDescription;\n    const personality = isPromptFiltered('char_personality', config)\n        ? ''\n        : getOverrideContent('char_personality') ?? rawPersonality;\n    const persona = isPromptFiltered('persona_description', config)\n        ? ''\n        : getOverrideContent('persona_description') ?? rawPersona;\n    const scenario = isPromptFiltered('scenario', config) ? '' : getOverrideContent('scenario') ?? rawScenario;\n    const mesExamples = isPromptFiltered('dialogue_examples', config)\n        ? ''\n        : getOverrideContent('dialogue_examples') ?? rawMesExamples;\n    let mesExamplesArray = parseMesExamples(mesExamples);\n    let oaiMessageExamples = [];\n    oaiMessageExamples = (0,_sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.setOpenAIMessageExamples)(mesExamplesArray);\n    // 5. 获取偏置字符串\n    const { promptBias } = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.getBiasStrings)(processedUserInput, type);\n    // 6. 处理自定义注入的提示词\n    if (config.inject) {\n        await handleInjectedPrompts(config);\n    }\n    // 7. 处理聊天记录\n    let oaiMessages = [];\n    if (config.overrides?.chat_history) {\n        oaiMessages = [...config.overrides.chat_history].reverse();\n    }\n    else {\n        oaiMessages = (0,_sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.setOpenAIMessages)(await processChatHistory(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat));\n        if (config.max_chat_history !== undefined) {\n            oaiMessages = oaiMessages.slice(0, config.max_chat_history);\n        }\n    }\n    // 添加临时消息用于激活世界书\n    addTemporaryUserMessage(processedUserInput);\n    // 8. 处理世界信息\n    const worldInfo = await processWorldInfo(oaiMessages, config, {\n        description: rawDescription,\n        personality: rawPersonality,\n        persona: rawPersona,\n        scenario: rawScenario,\n        charDepthPrompt,\n        creatorNotes,\n    });\n    // 移除临时消息\n    removeTemporaryUserMessage();\n    // 9. 处理世界书消息示例\n    mesExamplesArray = !isPromptFiltered('dialogue_examples', config)\n        ? await processMessageExamples(mesExamplesArray, worldInfo.worldInfoExamples)\n        : [];\n    return {\n        characterInfo: {\n            description,\n            personality,\n            persona,\n            scenario,\n            system: system,\n            jailbreak: jailbreak,\n        },\n        chatContext: {\n            oaiMessages,\n            oaiMessageExamples,\n            promptBias,\n        },\n        worldInfo,\n    };\n}\n//处理角色卡中的深度提示词\nfunction handleCharDepthPrompt() {\n    const depthPromptText = \n    // @ts-ignore\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.baseChatReplace)(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid]?.data?.extensions?.depth_prompt?.prompt?.trim(), _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name1, _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name2) || '';\n    // @ts-ignore\n    const depthPromptDepth = _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid]?.data?.extensions?.depth_prompt?.depth ?? '4';\n    const depthPromptRole = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.getExtensionPromptRoleByName)(\n    // @ts-ignore\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid]?.data?.extensions?.depth_prompt?.role ?? 'system');\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.setExtensionPrompt)('DEPTH_PROMPT', depthPromptText, _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_types.IN_CHAT, depthPromptDepth, \n    // @ts-ignore\n    _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.extension_settings.note.allowWIScan, depthPromptRole);\n}\n//处理作者注释\nfunction setAuthorNotePrompt(config) {\n    const authorNoteOverride = config?.overrides?.author_note;\n    // @ts-ignore\n    const prompt = authorNoteOverride ?? $('#extension_floating_prompt').val();\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.setExtensionPrompt)(_sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__.NOTE_MODULE_NAME, prompt, \n    // @ts-ignore\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat_metadata[_sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__.metadata_keys.position], \n    // @ts-ignore\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat_metadata[_sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__.metadata_keys.depth], \n    // @ts-ignore\n    _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.extension_settings.note.allowWIScan, \n    // @ts-ignore\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat_metadata[_sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__.metadata_keys.role]);\n}\n//用户角色描述提示词设置为提示词管理器之外的选项的情况\nfunction setPersonaDescriptionExtensionPrompt() {\n    const description = _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.power_user.persona_description;\n    const INJECT_TAG = 'PERSONA_DESCRIPTION';\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.setExtensionPrompt)(INJECT_TAG, '', _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_types.IN_PROMPT, 0);\n    if (!description || _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.power_user.persona_description_position === _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.persona_description_positions.NONE) {\n        return;\n    }\n    //当user信息在作者注释前后 - 仅在作者注释未被过滤时执行\n    const promptPositions = [_sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.persona_description_positions.BOTTOM_AN, _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.persona_description_positions.TOP_AN];\n    if (promptPositions.includes(_sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.power_user.persona_description_position) && _sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__.shouldWIAddPrompt) {\n        // @ts-ignore\n        const originalAN = (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.getContext)().extensionPrompts[_sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__.NOTE_MODULE_NAME].value;\n        const ANWithDesc = _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.power_user.persona_description_position === _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.persona_description_positions.TOP_AN\n            ? `${description}\\n${originalAN}`\n            : `${originalAN}\\n${description}`;\n        (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.setExtensionPrompt)(_sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__.NOTE_MODULE_NAME, ANWithDesc, \n        // @ts-ignore\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat_metadata[_sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__.metadata_keys.position], \n        // @ts-ignore\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat_metadata[_sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__.metadata_keys.depth], \n        // @ts-ignore\n        _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.extension_settings.note.allowWIScan, \n        // @ts-ignore\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat_metadata[_sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__.metadata_keys.role]);\n    }\n    // user信息深度注入不依赖于作者注释的状态，直接应用\n    if (_sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.power_user.persona_description_position === _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.persona_description_positions.AT_DEPTH) {\n        (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.setExtensionPrompt)(INJECT_TAG, description, _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_types.IN_CHAT, _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.power_user.persona_description_depth, true, _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.power_user.persona_description_role);\n    }\n}\nasync function handleInjectedPrompts(promptConfig) {\n    if (!promptConfig || !Array.isArray(promptConfig.inject))\n        return;\n    const injects = promptConfig.inject;\n    const position_map = {\n        before_prompt: _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_types.BEFORE_PROMPT,\n        in_chat: _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_types.IN_CHAT,\n        after_prompt: _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_types.IN_PROMPT,\n        none: _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_types.NONE,\n    };\n    for (const inject of injects) {\n        const validatedInject = {\n            role: roleTypes[inject.role] ?? _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_roles.SYSTEM,\n            content: inject.content || '',\n            depth: Number(inject.depth) || 0,\n            should_scan: Boolean(inject.should_scan) || true,\n            position: position_map[inject.position] ?? _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_types.IN_CHAT,\n        };\n        // 设置用户自定义注入提示词\n        (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.setExtensionPrompt)(`INJECTION-${inject.depth}-${inject.role}`, validatedInject.content, validatedInject.position, validatedInject.depth, validatedInject.should_scan, validatedInject.role);\n    }\n}\n// 处理聊天记录\nasync function processChatHistory(chatHistory) {\n    const coreChat = chatHistory.filter(x => !x.is_system);\n    return await Promise.all(coreChat.map(async (chatItem, index) => {\n        const message = chatItem.mes;\n        const regexType = chatItem.is_user ? _sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_3__.regex_placement.USER_INPUT : _sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_3__.regex_placement.AI_OUTPUT;\n        const regexedMessage = (0,_sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_3__.getRegexedString)(message, regexType, {\n            isPrompt: true,\n            depth: coreChat.length - index - 1,\n        });\n        return {\n            ...chatItem,\n            mes: regexedMessage,\n            index,\n        };\n    }));\n}\n// 处理世界书\nasync function processWorldInfo(oaiMessages, config, characterInfo) {\n    const chatForWI = oaiMessages\n        .filter(x => x.role !== 'system')\n        .map(x => {\n        const name = x.role === 'user' ? _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name1 : _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name2;\n        return _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_9__.world_info_include_names ? `${name}: ${x.content}` : x.content;\n    })\n        .reverse();\n    const this_max_context = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.getMaxContextSize)();\n    const globalScanData = {\n        personaDescription: config.overrides?.persona_description ?? characterInfo.persona,\n        characterDescription: config.overrides?.char_description ?? characterInfo.description,\n        characterPersonality: config.overrides?.char_personality ?? characterInfo.personality,\n        characterDepthPrompt: characterInfo.charDepthPrompt,\n        scenario: config.overrides?.scenario ?? characterInfo.scenario,\n        creatorNotes: characterInfo.creatorNotes,\n    };\n    const { worldInfoString, worldInfoBefore, worldInfoAfter, worldInfoExamples, worldInfoDepth } = \n    // globalScanData只在新的酒馆版本中存在\n    // @ts-ignore\n    await (0,_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_9__.getWorldInfoPrompt)(chatForWI, this_max_context, dryRun, globalScanData);\n    await clearInjectionPrompts(['customDepthWI']);\n    if (!isPromptFiltered('with_depth_entries', config)) {\n        processWorldInfoDepth(worldInfoDepth);\n    }\n    // 先检查是否被过滤，如果被过滤直接返回null\n    const finalWorldInfoBefore = isPromptFiltered('world_info_before', config)\n        ? null\n        : config.overrides?.world_info_before !== undefined\n            ? config.overrides.world_info_before\n            : worldInfoBefore;\n    const finalWorldInfoAfter = isPromptFiltered('world_info_after', config)\n        ? null\n        : config.overrides?.world_info_after !== undefined\n            ? config.overrides.world_info_after\n            : worldInfoAfter;\n    return {\n        worldInfoString,\n        worldInfoBefore: finalWorldInfoBefore,\n        worldInfoAfter: finalWorldInfoAfter,\n        worldInfoExamples,\n        worldInfoDepth: !isPromptFiltered('with_depth_entries', config) ? worldInfoDepth : null,\n    };\n}\n// 处理世界信息深度部分\nfunction processWorldInfoDepth(worldInfoDepth) {\n    if (Array.isArray(worldInfoDepth)) {\n        worldInfoDepth.forEach(entry => {\n            const joinedEntries = entry.entries.join('\\n');\n            (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.setExtensionPrompt)(`customDepthWI-${entry.depth}-${entry.role}`, joinedEntries, _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_types.IN_CHAT, entry.depth, false, entry.role);\n        });\n    }\n}\n// 处理世界书中示例前后\nasync function processMessageExamples(mesExamplesArray, worldInfoExamples) {\n    // 处理世界信息中的示例\n    for (const example of worldInfoExamples) {\n        if (!example.content.length)\n            continue;\n        const formattedExample = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.baseChatReplace)(example.content, _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name1, _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name2);\n        const cleanedExample = parseMesExamples(formattedExample);\n        if (example.position === _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_9__.wi_anchor_position.before) {\n            mesExamplesArray.unshift(...cleanedExample);\n        }\n        else {\n            mesExamplesArray.push(...cleanedExample);\n        }\n    }\n    return mesExamplesArray;\n}\n//处理对话示例格式\nfunction parseMesExamples(examplesStr) {\n    if (examplesStr.length === 0 || examplesStr === '<START>') {\n        return [];\n    }\n    if (!examplesStr.startsWith('<START>')) {\n        examplesStr = '<START>\\n' + examplesStr.trim();\n    }\n    const blockHeading = '<START>\\n';\n    const splitExamples = examplesStr\n        .split(/<START>/gi)\n        .slice(1)\n        .map(block => `${blockHeading}${block.trim()}\\n`);\n    return splitExamples;\n}\n//用户输入先正则处理\nfunction processUserInput(user_input) {\n    if (user_input === '') {\n        user_input = _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.oai_settings.send_if_empty.trim();\n    }\n    return (0,_sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_3__.getRegexedString)(user_input, _sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_3__.regex_placement.USER_INPUT, {\n        isPrompt: true,\n        depth: 0,\n    });\n}\n//使用预设\nasync function handlePresetPath(baseData, processedUserInput, config) {\n    // prepareOpenAIMessages会从设置里读取场景因此临时覆盖\n    let originalScenario = null;\n    try {\n        const scenarioOverride = config?.overrides?.scenario;\n        // @ts-ignore\n        if (scenarioOverride && _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters && _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid]) {\n            // 保存原始场景\n            // @ts-ignore\n            originalScenario = _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid].scenario || null;\n            // @ts-ignore\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid].scenario = scenarioOverride;\n        }\n        // 添加user消息(一次性)\n        const userMessageTemp = {\n            role: 'user',\n            content: processedUserInput,\n            image: config.image,\n        };\n        if (config.image) {\n            userMessageTemp.image = await convertFileToBase64(config.image);\n        }\n        baseData.chatContext.oaiMessages.unshift(userMessageTemp);\n        const messageData = {\n            name2: _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.name2,\n            charDescription: baseData.characterInfo.description,\n            charPersonality: baseData.characterInfo.personality,\n            Scenario: baseData.characterInfo.scenario,\n            worldInfoBefore: baseData.worldInfo.worldInfoBefore,\n            worldInfoAfter: baseData.worldInfo.worldInfoAfter,\n            extensionPrompts: (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.getContext)().extensionPrompts,\n            bias: baseData.chatContext.promptBias,\n            type: 'normal',\n            quietPrompt: '',\n            quietImage: null,\n            cyclePrompt: '',\n            systemPromptOverride: baseData.characterInfo.system,\n            jailbreakPromptOverride: baseData.characterInfo.jailbreak,\n            personaDescription: baseData.characterInfo.persona,\n            messages: baseData.chatContext.oaiMessages,\n            messageExamples: baseData.chatContext.oaiMessageExamples,\n        };\n        const [prompt] = await (0,_sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.prepareOpenAIMessages)(messageData, dryRun);\n        return { prompt };\n    }\n    finally {\n        // 恢复原始场景\n        // @ts-ignore\n        if (originalScenario !== null && _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters && _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid]) {\n            // @ts-ignore\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid].scenario = originalScenario;\n        }\n    }\n}\nasync function convertSystemPromptsToCollection(baseData, promptConfig) {\n    const promptCollection = new _sillytavern_scripts_PromptManager__WEBPACK_IMPORTED_MODULE_7__.PromptCollection();\n    const examplesCollection = new _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.MessageCollection('dialogue_examples');\n    const orderArray = promptConfig.order || builtin_prompt_default_order;\n    const builtinPromptContents = {\n        world_info_before: baseData.worldInfo.worldInfoBefore,\n        persona_description: _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.power_user.persona_description &&\n            _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.power_user.persona_description_position === _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.persona_description_positions.IN_PROMPT\n            ? baseData.characterInfo.persona\n            : null,\n        char_description: baseData.characterInfo.description,\n        char_personality: baseData.characterInfo.personality,\n        scenario: baseData.characterInfo.scenario,\n        world_info_after: baseData.worldInfo.worldInfoAfter,\n    };\n    for (const [index, item] of orderArray.entries()) {\n        if (typeof item === 'string') {\n            // 处理内置提示词\n            const content = builtinPromptContents[item];\n            if (content) {\n                promptCollection.add(\n                // @ts-ignore\n                new _sillytavern_scripts_PromptManager__WEBPACK_IMPORTED_MODULE_7__.Prompt({\n                    identifier: item,\n                    role: 'system',\n                    content: content,\n                    system_prompt: true,\n                }));\n            }\n        }\n        else if (typeof item === 'object' && item.role && item.content) {\n            // 处理自定义注入\n            const identifier = `custom_prompt_${index}`;\n            promptCollection.add(\n            // @ts-ignore\n            new _sillytavern_scripts_PromptManager__WEBPACK_IMPORTED_MODULE_7__.Prompt({\n                identifier: identifier,\n                role: item.role,\n                content: item.content,\n                system_prompt: item.role === 'system',\n            }));\n        }\n    }\n    if (baseData.chatContext.oaiMessageExamples.length > 0) {\n        // 遍历所有对话示例\n        for (const dialogue of [...baseData.chatContext.oaiMessageExamples]) {\n            const dialogueIndex = baseData.chatContext.oaiMessageExamples.indexOf(dialogue);\n            const chatMessages = [];\n            for (let promptIndex = 0; promptIndex < dialogue.length; promptIndex++) {\n                const prompt = dialogue[promptIndex];\n                const role = 'system';\n                const content = prompt.content || '';\n                const identifier = `dialogue_examples ${dialogueIndex}-${promptIndex}`;\n                const chatMessage = await _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.Message.createAsync(role, content, identifier);\n                await chatMessage.setName(prompt.name);\n                chatMessages.push(chatMessage);\n            }\n            for (const message of chatMessages) {\n                examplesCollection.add(message);\n            }\n        }\n    }\n    return {\n        systemPrompts: promptCollection,\n        dialogue_examples: examplesCollection,\n    };\n}\n//不使用预设\nasync function handleCustomPath(baseData, config, processedUserInput) {\n    const chatCompletion = new _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.ChatCompletion();\n    chatCompletion.setTokenBudget(_sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.oai_settings.openai_max_context, _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.oai_settings.openai_max_tokens);\n    chatCompletion.reserveBudget(3);\n    const orderArray = config.order || default_order;\n    const positionMap = orderArray.reduce((acc, item, index) => {\n        if (typeof item === 'string') {\n            acc[item.toLowerCase()] = index;\n        }\n        else if (typeof item === 'object') {\n            acc[`custom_prompt_${index}`] = index;\n        }\n        return acc;\n    }, {});\n    //转换为集合\n    const { systemPrompts, dialogue_examples } = await convertSystemPromptsToCollection(baseData, config);\n    const addToChatCompletionInOrder = async (source, index) => {\n        if (typeof source === 'object') {\n            // 处理自定义注入\n            const collection = new _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.MessageCollection(`custom_prompt_${index}`);\n            const message = await _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.Message.createAsync(source.role, source.content, `custom_prompt_${index}`);\n            collection.add(message);\n            chatCompletion.add(collection, index);\n        }\n        else if (systemPrompts.has(source)) {\n            // 处理普通提示词\n            const prompt = systemPrompts.get(source);\n            const collection = new _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.MessageCollection(source);\n            const message = await _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.Message.fromPromptAsync(prompt);\n            collection.add(message);\n            chatCompletion.add(collection, positionMap[source]);\n        }\n    };\n    // 处理所有类型的提示词\n    for (const [index, item] of orderArray.entries()) {\n        if (typeof item === 'string') {\n            if (!isPromptFiltered(item, config)) {\n                await addToChatCompletionInOrder(item, index);\n            }\n        }\n        else if (typeof item === 'object' && item.role && item.content) {\n            await addToChatCompletionInOrder(item, index);\n        }\n    }\n    const dialogue_examplesIndex = orderArray.findIndex(item => typeof item === 'string' && item.toLowerCase() === 'dialogue_examples');\n    if (dialogue_examplesIndex !== -1 && !isPromptFiltered('dialogue_examples', config)) {\n        chatCompletion.add(dialogue_examples, dialogue_examplesIndex);\n    }\n    //给user输入预留token\n    const userInputMessage = await _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.Message.createAsync('user', processedUserInput, 'user_input');\n    chatCompletion.reserveBudget(userInputMessage);\n    await processChatHistoryAndInject(baseData, config, chatCompletion, processedUserInput);\n    chatCompletion.freeBudget(userInputMessage);\n    //根据当前预设决定是否合并连续系统role消息\n    if (_sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.oai_settings.squash_system_messages) {\n        await chatCompletion.squashSystemMessages();\n    }\n    const prompt = chatCompletion.getChat();\n    return { prompt };\n}\nasync function processChatHistoryAndInject(baseData, promptConfig, chatCompletion, processedUserInput) {\n    const orderArray = promptConfig.order || default_order;\n    const chatHistoryIndex = orderArray.findIndex(item => typeof item === 'string' && item.toLowerCase() === 'chat_history');\n    const userInputIndex = orderArray.findIndex(item => typeof item === 'string' && item.toLowerCase() === 'user_input');\n    const hasUserInput = userInputIndex !== -1;\n    const hasChatHistory = chatHistoryIndex !== -1;\n    const isChatHistoryFiltered = isPromptFiltered('chat_history', promptConfig);\n    // 创建用户输入消息\n    const userMessage = await _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.Message.createAsync('user', processedUserInput, 'user_input');\n    if (promptConfig.image && hasUserInput) {\n        await userMessage.addImage(await convertFileToBase64(promptConfig.image));\n    }\n    // 如果聊天记录被过滤或不在order中，只处理用户输入\n    if (isChatHistoryFiltered || !hasChatHistory) {\n        const insertIndex = hasUserInput ? userInputIndex : orderArray.length;\n        chatCompletion.add(new _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.MessageCollection('user_input', userMessage), insertIndex);\n        return;\n    }\n    // 处理聊天记录\n    const chatCollection = new _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.MessageCollection('chat_history');\n    // 为新聊天指示预留token\n    const newChat = _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.oai_settings.new_chat_prompt;\n    const newChatMessage = await _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.Message.createAsync('system', (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.substituteParams)(newChat), 'newMainChat');\n    chatCompletion.reserveBudget(newChatMessage);\n    // 添加新聊天提示词到集合的最前面\n    chatCollection.add(newChatMessage);\n    // 处理空消息替换\n    const lastChatPrompt = baseData.chatContext.oaiMessages[baseData.chatContext.oaiMessages.length - 1];\n    const emptyMessage = await _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.Message.createAsync('user', _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.oai_settings.send_if_empty, 'emptyUserMessageReplacement');\n    if (lastChatPrompt &&\n        lastChatPrompt.role === 'assistant' &&\n        _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.oai_settings.send_if_empty &&\n        chatCompletion.canAfford(emptyMessage)) {\n        chatCollection.add(emptyMessage);\n    }\n    // 将用户消息添加到消息数组中准备处理注入\n    if (!hasUserInput) {\n        const userPrompt = {\n            role: 'user',\n            content: processedUserInput,\n            identifier: 'user_input',\n            image: promptConfig.image ? await convertFileToBase64(promptConfig.image) : undefined,\n        };\n        baseData.chatContext.oaiMessages.unshift(userPrompt);\n    }\n    // 处理注入和添加消息\n    const messages = (await populationInjectionPrompts(baseData, baseData.chatContext.oaiMessages, promptConfig.inject, promptConfig)).reverse();\n    const imageInlining = (0,_sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.isImageInliningSupported)();\n    // 添加聊天记录\n    const chatPool = [...messages];\n    for (const chatPrompt of chatPool) {\n        const prompt = new _sillytavern_scripts_PromptManager__WEBPACK_IMPORTED_MODULE_7__.Prompt(chatPrompt);\n        prompt.identifier = `chat_history-${messages.length - chatPool.indexOf(chatPrompt)}`;\n        prompt.content = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.substituteParams)(prompt.content);\n        const chatMessage = await _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.Message.fromPromptAsync(prompt);\n        const promptManager = (0,_sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.setupChatCompletionPromptManager)(_sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.oai_settings);\n        if (promptManager) {\n            // @ts-ignore\n            if (promptManager.serviceSettings.names_behavior === character_names_behavior.COMPLETION && prompt.name) {\n                const messageName = promptManager.isValidName(prompt.name)\n                    ? prompt.name\n                    : promptManager.sanitizeName(prompt.name);\n                await chatMessage.setName(messageName);\n            }\n        }\n        if (imageInlining && chatPrompt.image) {\n            await chatMessage.addImage(chatPrompt.image);\n        }\n        if (chatCompletion.canAfford(chatMessage)) {\n            chatCollection.add(chatMessage);\n        }\n        else {\n            break;\n        }\n    }\n    // 释放新聊天提示词的预留token\n    chatCompletion.freeBudget(newChatMessage);\n    if (hasUserInput) {\n        // 按各自在order中的位置添加聊天记录和用户输入\n        chatCompletion.add(chatCollection, chatHistoryIndex);\n        chatCompletion.add(new _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.MessageCollection('user_input', userMessage), userInputIndex);\n    }\n    else {\n        // 聊天记录中已包含用户输入，直接添加到chat_history位置\n        chatCompletion.add(chatCollection, chatHistoryIndex);\n    }\n}\nasync function populationInjectionPrompts(baseData, messages, customInjects = [], config) {\n    const processedMessages = [...messages];\n    let totalInsertedMessages = 0;\n    const injectionPrompts = [];\n    // @ts-ignore\n    const authorsNote = (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.getContext)().extensionPrompts[_sillytavern_scripts_authors_note__WEBPACK_IMPORTED_MODULE_1__.NOTE_MODULE_NAME];\n    if (authorsNote && authorsNote.value) {\n        injectionPrompts.push({\n            role: getPromptRole(authorsNote.role),\n            content: authorsNote.value,\n            identifier: 'authorsNote',\n            injection_depth: authorsNote.depth,\n            injected: true,\n        });\n    }\n    if (_sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.power_user.persona_description &&\n        _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.power_user.persona_description_position === _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.persona_description_positions.AT_DEPTH) {\n        injectionPrompts.push({\n            role: 'system',\n            content: _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.power_user.persona_description,\n            identifier: 'persona_description',\n            injection_depth: _sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.power_user.persona_description_depth,\n            injected: true,\n        });\n    }\n    if (!isPromptFiltered('char_depth_prompt', config)) {\n        const wiDepthPrompt = baseData.worldInfo.worldInfoDepth;\n        if (wiDepthPrompt) {\n            for (const entry of wiDepthPrompt) {\n                const content = await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.getExtensionPromptByName)(`customDepthWI-${entry.depth}-${entry.role}`);\n                injectionPrompts.push({\n                    role: getPromptRole(entry.role),\n                    content: content,\n                    injection_depth: entry.depth,\n                    injected: true,\n                });\n                loglevel__WEBPACK_IMPORTED_MODULE_10___default().info('injectionPrompts', injectionPrompts);\n            }\n        }\n    }\n    // 处理自定义注入\n    if (Array.isArray(customInjects)) {\n        for (const inject of customInjects) {\n            injectionPrompts.push({\n                identifier: `INJECTION-${inject.role}-${inject.depth}`,\n                role: inject.role,\n                content: inject.content,\n                injection_depth: inject.depth || 0,\n                injected: true,\n            });\n        }\n    }\n    for (let i = 0; i <= _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.MAX_INJECTION_DEPTH; i++) {\n        const depthPrompts = injectionPrompts.filter(prompt => prompt.injection_depth === i && prompt.content);\n        const roles = ['system', 'user', 'assistant'];\n        const roleMessages = [];\n        const separator = '\\n';\n        for (const role of roles) {\n            // 直接处理当前深度和角色的所有提示词\n            const rolePrompts = depthPrompts\n                .filter(prompt => prompt.role === role)\n                .map(x => x.content.trim())\n                .join(separator);\n            if (rolePrompts) {\n                roleMessages.push({\n                    role: role,\n                    content: rolePrompts,\n                    injected: true,\n                });\n            }\n        }\n        if (roleMessages.length) {\n            const injectIdx = i + totalInsertedMessages;\n            processedMessages.splice(injectIdx, 0, ...roleMessages);\n            totalInsertedMessages += roleMessages.length;\n        }\n    }\n    return processedMessages;\n}\nfunction getPromptRole(role) {\n    switch (role) {\n        case _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_roles.SYSTEM:\n            return 'system';\n        case _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_roles.USER:\n            return 'user';\n        case _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_roles.ASSISTANT:\n            return 'assistant';\n        default:\n            return 'system';\n    }\n}\n//生成响应\nasync function generateResponse(generate_data, useStream = false) {\n    let result = '';\n    try {\n        (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.deactivateSendButtons)();\n        if (useStream) {\n            const originalStreamSetting = _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.oai_settings.stream_openai;\n            if (!originalStreamSetting) {\n                _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.oai_settings.stream_openai = true;\n                (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveSettingsDebounced)();\n            }\n            const streamingProcessor = new StreamingProcessor();\n            // @ts-ignore\n            streamingProcessor.generator = await (0,_sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.sendOpenAIRequest)('normal', generate_data.prompt, abortController.signal);\n            result = (await streamingProcessor.generate());\n            if (originalStreamSetting !== _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.oai_settings.stream_openai) {\n                _sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.oai_settings.stream_openai = originalStreamSetting;\n                (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveSettingsDebounced)();\n            }\n        }\n        else {\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.emit('js_generation_started');\n            const response = await (0,_sillytavern_scripts_openai__WEBPACK_IMPORTED_MODULE_5__.sendOpenAIRequest)(type, generate_data.prompt, abortController.signal);\n            result = await handleResponse(response);\n        }\n    }\n    catch (error) {\n        loglevel__WEBPACK_IMPORTED_MODULE_10___default().error(error);\n    }\n    finally {\n        unblockGeneration();\n        await clearInjectionPrompts(['INJECTION']);\n    }\n    return result;\n}\n// 处理响应\nasync function handleResponse(response) {\n    if (!response) {\n        throw Error(`未得到响应`);\n    }\n    if (response.error) {\n        if (response?.response) {\n            toastr.error(response.response, (0,_sillytavern_scripts_i18n__WEBPACK_IMPORTED_MODULE_4__.t) `API Error`, {\n                preventDuplicates: true,\n            });\n        }\n        throw Error(response?.response);\n    }\n    const message = extractMessageFromData(response);\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.emit('js_generation_ended', message);\n    return message;\n}\nfunction unblockGeneration() {\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.activateSendButtons)();\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.showSwipeButtons)();\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.setGenerationProgress)(0);\n    (0,_sillytavern_scripts_power_user__WEBPACK_IMPORTED_MODULE_6__.flushEphemeralStoppingStrings)();\n}\n// 清理注入\nasync function clearInjectionPrompts(prefixes) {\n    const prompts = (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.getContext)().extensionPrompts;\n    Object.keys(prompts)\n        .filter(key => prefixes.some(prefix => key.startsWith(prefix)))\n        .forEach(key => delete prompts[key]);\n    await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveChatConditional)();\n}\nfunction extractMessageFromData(data) {\n    if (typeof data === 'string') {\n        return data;\n    }\n    return (data?.choices?.[0]?.message?.content ??\n        data?.choices?.[0]?.text ??\n        data?.text ??\n        data?.message?.content?.[0]?.text ??\n        data?.message?.tool_plan ??\n        '');\n}\nasync function convertFileToBase64(image) {\n    if (typeof image === 'string') {\n        return image;\n    }\n    return await (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_8__.getBase64Async)(image);\n}\nfunction addTemporaryUserMessage(userContent) {\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.setExtensionPrompt)('TEMP_USER_MESSAGE', userContent, _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_types.IN_PROMPT, 0, true, 1);\n}\nfunction removeTemporaryUserMessage() {\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.setExtensionPrompt)('TEMP_USER_MESSAGE', '', _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.extension_prompt_types.IN_PROMPT, 0, true, 1);\n}\nfunction isPromptFiltered(promptId, config) {\n    if (!config.overrides) {\n        return false;\n    }\n    if (promptId === 'with_depth_entries') {\n        return config.overrides.with_depth_entries === false;\n    }\n    // 特殊处理 chat_history\n    if (promptId === 'chat_history') {\n        const prompts = config.overrides.chat_history;\n        return prompts !== undefined && prompts.length === 0;\n    }\n    // 对于普通提示词，只有当它在 overrides 中存在且为空字符串时才被过滤\n    const override = config.overrides[promptId];\n    return override !== undefined && override === '';\n}\nasync function generate(config) {\n    const converted_config = fromGenerateConfig(config);\n    return await iframeGenerate(converted_config);\n}\nasync function generateRaw(config) {\n    const converted_config = fromGenerateRawConfig(config);\n    return await iframeGenerate(converted_config);\n}\n// @ts-ignore\n$(document).on('click', '#mes_stop', function () {\n    const wasStopped = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.stopGeneration)();\n    if (wasStopped) {\n        if (abortController) {\n            abortController.abort('Clicked stop button');\n        }\n        unblockGeneration();\n    }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Z2VuZXJhdGUudHM/MjA0YyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBNQVhfSU5KRUNUSU9OX0RFUFRILFxuICBhY3RpdmF0ZVNlbmRCdXR0b25zLFxuICBiYXNlQ2hhdFJlcGxhY2UsXG4gIGNoYXJhY3RlcnMsXG4gIGNoYXQsXG4gIGNoYXRfbWV0YWRhdGEsXG4gIGNsZWFuVXBNZXNzYWdlLFxuICBjb3VudE9jY3VycmVuY2VzLFxuICBkZWFjdGl2YXRlU2VuZEJ1dHRvbnMsXG4gIGV2ZW50U291cmNlLFxuICBleHRlbnNpb25fcHJvbXB0X3JvbGVzLFxuICBleHRlbnNpb25fcHJvbXB0X3R5cGVzLFxuICBnZXRCaWFzU3RyaW5ncyxcbiAgZ2V0Q2hhcmFjdGVyQ2FyZEZpZWxkcyxcbiAgZ2V0RXh0ZW5zaW9uUHJvbXB0QnlOYW1lLFxuICBnZXRFeHRlbnNpb25Qcm9tcHRSb2xlQnlOYW1lLFxuICBnZXRNYXhDb250ZXh0U2l6ZSxcbiAgaXNPZGQsXG4gIG5hbWUxLFxuICBuYW1lMixcbiAgc2F2ZUNoYXRDb25kaXRpb25hbCxcbiAgc2F2ZVNldHRpbmdzRGVib3VuY2VkLFxuICBzZXRFeHRlbnNpb25Qcm9tcHQsXG4gIHNldEdlbmVyYXRpb25Qcm9ncmVzcyxcbiAgc2hvd1N3aXBlQnV0dG9ucyxcbiAgc3RvcEdlbmVyYXRpb24sXG4gIHN1YnN0aXR1dGVQYXJhbXMsXG4gIHRoaXNfY2hpZCxcbn0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5pbXBvcnQgeyBOT1RFX01PRFVMRV9OQU1FLCBtZXRhZGF0YV9rZXlzLCBzaG91bGRXSUFkZFByb21wdCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL2F1dGhvcnMtbm90ZSc7XG5pbXBvcnQgeyBleHRlbnNpb25fc2V0dGluZ3MsIGdldENvbnRleHQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9leHRlbnNpb25zJztcbmltcG9ydCB7IGdldFJlZ2V4ZWRTdHJpbmcsIHJlZ2V4X3BsYWNlbWVudCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL2V4dGVuc2lvbnMvcmVnZXgvZW5naW5lJztcbmltcG9ydCB7IHQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9pMThuJztcbmltcG9ydCB7XG4gIENoYXRDb21wbGV0aW9uLFxuICBNZXNzYWdlLFxuICBNZXNzYWdlQ29sbGVjdGlvbixcbiAgaXNJbWFnZUlubGluaW5nU3VwcG9ydGVkLFxuICBvYWlfc2V0dGluZ3MsXG4gIHByZXBhcmVPcGVuQUlNZXNzYWdlcyxcbiAgc2VuZE9wZW5BSVJlcXVlc3QsXG4gIHNldE9wZW5BSU1lc3NhZ2VFeGFtcGxlcyxcbiAgc2V0T3BlbkFJTWVzc2FnZXMsXG4gIHNldHVwQ2hhdENvbXBsZXRpb25Qcm9tcHRNYW5hZ2VyLFxufSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9vcGVuYWknO1xuaW1wb3J0IHtcbiAgZmx1c2hFcGhlbWVyYWxTdG9wcGluZ1N0cmluZ3MsXG4gIHBlcnNvbmFfZGVzY3JpcHRpb25fcG9zaXRpb25zLFxuICBwb3dlcl91c2VyLFxufSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9wb3dlci11c2VyJztcbmltcG9ydCB7IFByb21wdCwgUHJvbXB0Q29sbGVjdGlvbiB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL1Byb21wdE1hbmFnZXInO1xuaW1wb3J0IHsgU3RvcHdhdGNoLCBnZXRCYXNlNjRBc3luYyB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3V0aWxzJztcbmltcG9ydCB7IGdldFdvcmxkSW5mb1Byb21wdCwgd2lfYW5jaG9yX3Bvc2l0aW9uLCB3b3JsZF9pbmZvX2luY2x1ZGVfbmFtZXMgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy93b3JsZC1pbmZvJztcblxuaW1wb3J0IGxvZyBmcm9tICdsb2dsZXZlbCc7XG5cbmludGVyZmFjZSBHZW5lcmF0ZUNvbmZpZyB7XG4gIHVzZXJfaW5wdXQ/OiBzdHJpbmc7XG4gIGltYWdlPzogRmlsZSB8IHN0cmluZztcbiAgc2hvdWxkX3N0cmVhbT86IGJvb2xlYW47XG4gIG92ZXJyaWRlcz86IE92ZXJyaWRlcztcbiAgaW5qZWN0cz86IEluamVjdGlvblByb21wdFtdO1xuICBtYXhfY2hhdF9oaXN0b3J5PzogJ2FsbCcgfCBudW1iZXI7XG59XG5cbmludGVyZmFjZSBHZW5lcmF0ZVJhd0NvbmZpZyB7XG4gIHVzZXJfaW5wdXQ/OiBzdHJpbmc7XG4gIGltYWdlPzogRmlsZSB8IHN0cmluZztcbiAgc2hvdWxkX3N0cmVhbT86IGJvb2xlYW47XG4gIG92ZXJyaWRlcz86IE92ZXJyaWRlcztcbiAgaW5qZWN0cz86IEluamVjdGlvblJhd1Byb21wdFtdO1xuICBvcmRlcmVkX3Byb21wdHM/OiAoQnVpbHRpblByb21wdCB8IFJvbGVQcm9tcHQpW107XG4gIG1heF9jaGF0X2hpc3Rvcnk/OiAnYWxsJyB8IG51bWJlcjtcbn1cblxuaW50ZXJmYWNlIFJvbGVQcm9tcHQge1xuICByb2xlOiAnc3lzdGVtJyB8ICdhc3Npc3RhbnQnIHwgJ3VzZXInO1xuICBjb250ZW50OiBzdHJpbmc7XG4gIGltYWdlPzogRmlsZSB8IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIEluamVjdGlvblByb21wdCB7XG4gIHJvbGU6ICdzeXN0ZW0nIHwgJ2Fzc2lzdGFudCcgfCAndXNlcic7XG4gIGNvbnRlbnQ6IHN0cmluZztcbiAgcG9zaXRpb246ICdiZWZvcmVfcHJvbXB0JyB8ICdpbl9jaGF0JyB8ICdhZnRlcl9wcm9tcHQnIHwgJ25vbmUnO1xuICBkZXB0aDogbnVtYmVyO1xuICBzaG91bGRfc2NhbjogYm9vbGVhbjtcbn1cblxuaW50ZXJmYWNlIEluamVjdGlvblJhd1Byb21wdCB7XG4gIHJvbGU6ICdzeXN0ZW0nIHwgJ2Fzc2lzdGFudCcgfCAndXNlcic7XG4gIGNvbnRlbnQ6IHN0cmluZztcbiAgcG9zaXRpb246ICdpbl9jaGF0JyB8ICdub25lJztcbiAgZGVwdGg6IG51bWJlcjtcbiAgc2hvdWxkX3NjYW46IGJvb2xlYW47XG59XG5cbmludGVyZmFjZSBPdmVycmlkZXMge1xuICB3b3JsZF9pbmZvX2JlZm9yZT86IHN0cmluZzsgLy8g5LiW55WM5LmmKOinkuiJsuWumuS5ieWJjSlcbiAgcGVyc29uYV9kZXNjcmlwdGlvbj86IHN0cmluZzsgLy8g55So5oi35o+P6L+wXG4gIGNoYXJfZGVzY3JpcHRpb24/OiBzdHJpbmc7IC8vIOinkuiJsuaPj+i/sFxuICBjaGFyX3BlcnNvbmFsaXR5Pzogc3RyaW5nOyAvLyDop5LoibLmgKfmoLxcbiAgc2NlbmFyaW8/OiBzdHJpbmc7IC8vIOWcuuaZr1xuICB3b3JsZF9pbmZvX2FmdGVyPzogc3RyaW5nOyAvLyDkuJbnlYzkuaYo6KeS6Imy5a6a5LmJ5ZCOKVxuICBkaWFsb2d1ZV9leGFtcGxlcz86IHN0cmluZzsgLy8g5a+56K+d56S65L6LXG4gIGNoYXRfaGlzdG9yeT86IHtcbiAgICB3aXRoX2RlcHRoX2VudHJpZXM/OiBib29sZWFuO1xuICAgIGF1dGhvcl9ub3RlPzogc3RyaW5nO1xuICAgIHByb21wdHM/OiBSb2xlUHJvbXB0W107XG4gIH07XG59XG5cbmV4cG9ydCBjb25zdCBidWlsdGluX3Byb21wdF9kZWZhdWx0X29yZGVyOiBCdWlsdGluUHJvbXB0W10gPSBbXG4gICd3b3JsZF9pbmZvX2JlZm9yZScsXG4gICdwZXJzb25hX2Rlc2NyaXB0aW9uJyxcbiAgJ2NoYXJfZGVzY3JpcHRpb24nLFxuICAnY2hhcl9wZXJzb25hbGl0eScsXG4gICdzY2VuYXJpbycsXG4gICd3b3JsZF9pbmZvX2FmdGVyJyxcbiAgJ2RpYWxvZ3VlX2V4YW1wbGVzJyxcbiAgJ2NoYXRfaGlzdG9yeScsXG4gICd1c2VyX2lucHV0Jyxcbl07XG5cbnR5cGUgQnVpbHRpblByb21wdCA9XG4gIHwgJ3dvcmxkX2luZm9fYmVmb3JlJ1xuICB8ICdwZXJzb25hX2Rlc2NyaXB0aW9uJ1xuICB8ICdjaGFyX2Rlc2NyaXB0aW9uJ1xuICB8ICdjaGFyX3BlcnNvbmFsaXR5J1xuICB8ICdzY2VuYXJpbydcbiAgfCAnd29ybGRfaW5mb19hZnRlcidcbiAgfCAnZGlhbG9ndWVfZXhhbXBsZXMnXG4gIHwgJ2NoYXRfaGlzdG9yeSdcbiAgfCAndXNlcl9pbnB1dCc7XG5cbmludGVyZmFjZSBCYXNlRGF0YSB7XG4gIGNoYXJhY3RlckluZm86IHtcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgIHBlcnNvbmFsaXR5OiBzdHJpbmc7XG4gICAgcGVyc29uYTogc3RyaW5nO1xuICAgIHNjZW5hcmlvOiBzdHJpbmc7XG4gICAgc3lzdGVtOiBzdHJpbmc7XG4gICAgamFpbGJyZWFrOiBzdHJpbmc7XG4gIH07XG4gIGNoYXRDb250ZXh0OiB7XG4gICAgb2FpTWVzc2FnZXM6IFJvbGVQcm9tcHRbXTtcbiAgICBvYWlNZXNzYWdlRXhhbXBsZXM6IHN0cmluZ1tdO1xuICAgIHByb21wdEJpYXM6IHN0cmluZ1tdO1xuICB9O1xuICB3b3JsZEluZm86IHtcbiAgICB3b3JsZEluZm9BZnRlcjogQXJyYXk8c3RyaW5nPjtcbiAgICB3b3JsZEluZm9CZWZvcmU6IEFycmF5PHN0cmluZz47XG4gICAgd29ybGRJbmZvRGVwdGg6IEFycmF5PHsgZW50cmllczogc3RyaW5nOyBkZXB0aDogbnVtYmVyOyByb2xlOiBudW1iZXIgfT47XG4gICAgd29ybGRJbmZvRXhhbXBsZXM6IEFycmF5PHN0cmluZz47XG4gICAgd29ybGRJbmZvU3RyaW5nOiBBcnJheTxzdHJpbmc+O1xuICB9O1xufVxuXG5sZXQgYWJvcnRDb250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpO1xuXG5mdW5jdGlvbiBmcm9tT3ZlcnJpZGVzKG92ZXJyaWRlczogT3ZlcnJpZGVzKTogZGV0YWlsLk92ZXJyaWRlQ29uZmlnIHtcbiAgcmV0dXJuIHtcbiAgICB3b3JsZF9pbmZvX2JlZm9yZTogb3ZlcnJpZGVzLndvcmxkX2luZm9fYmVmb3JlLFxuICAgIHBlcnNvbmFfZGVzY3JpcHRpb246IG92ZXJyaWRlcy5wZXJzb25hX2Rlc2NyaXB0aW9uLFxuICAgIGNoYXJfZGVzY3JpcHRpb246IG92ZXJyaWRlcy5jaGFyX2Rlc2NyaXB0aW9uLFxuICAgIGNoYXJfcGVyc29uYWxpdHk6IG92ZXJyaWRlcy5jaGFyX3BlcnNvbmFsaXR5LFxuICAgIHNjZW5hcmlvOiBvdmVycmlkZXMuc2NlbmFyaW8sXG4gICAgd29ybGRfaW5mb19hZnRlcjogb3ZlcnJpZGVzLndvcmxkX2luZm9fYWZ0ZXIsXG4gICAgZGlhbG9ndWVfZXhhbXBsZXM6IG92ZXJyaWRlcy5kaWFsb2d1ZV9leGFtcGxlcyxcblxuICAgIHdpdGhfZGVwdGhfZW50cmllczogb3ZlcnJpZGVzLmNoYXRfaGlzdG9yeT8ud2l0aF9kZXB0aF9lbnRyaWVzLFxuICAgIGF1dGhvcl9ub3RlOiBvdmVycmlkZXMuY2hhdF9oaXN0b3J5Py5hdXRob3Jfbm90ZSxcbiAgICBjaGF0X2hpc3Rvcnk6IG92ZXJyaWRlcy5jaGF0X2hpc3Rvcnk/LnByb21wdHMsXG4gIH07XG59XG5cbmZ1bmN0aW9uIGZyb21JbmplY3Rpb25Qcm9tcHQoaW5qZWN0OiBJbmplY3Rpb25Qcm9tcHQpOiBJbmplY3Rpb25Qcm9tcHQge1xuICBjb25zdCBwb3NpdGlvbl9tYXAgPSB7XG4gICAgYmVmb3JlX3Byb21wdDogJ2JlZm9yZV9wcm9tcHQnLFxuICAgIGluX2NoYXQ6ICdpbl9jaGF0JyxcbiAgICBhZnRlcl9wcm9tcHQ6ICdhZnRlcl9wcm9tcHQnLFxuICAgIG5vbmU6ICdub25lJyxcbiAgfSBhcyBjb25zdDtcbiAgcmV0dXJuIHtcbiAgICByb2xlOiBpbmplY3Qucm9sZSxcbiAgICBjb250ZW50OiBpbmplY3QuY29udGVudCxcbiAgICBwb3NpdGlvbjogcG9zaXRpb25fbWFwW2luamVjdC5wb3NpdGlvbl0gYXMgJ2JlZm9yZV9wcm9tcHQnIHwgJ2luX2NoYXQnIHwgJ2FmdGVyX3Byb21wdCcgfCAnbm9uZScsXG4gICAgZGVwdGg6IGluamVjdC5kZXB0aCxcbiAgICBzaG91bGRfc2NhbjogaW5qZWN0LnNob3VsZF9zY2FuLFxuICB9O1xufVxuXG5mdW5jdGlvbiBmcm9tR2VuZXJhdGVDb25maWcoY29uZmlnOiBHZW5lcmF0ZUNvbmZpZyk6IGRldGFpbC5HZW5lcmF0ZVBhcmFtcyB7XG4gIHJldHVybiB7XG4gICAgdXNlcl9pbnB1dDogY29uZmlnLnVzZXJfaW5wdXQsXG4gICAgdXNlX3ByZXNldDogdHJ1ZSxcbiAgICBpbWFnZTogY29uZmlnLmltYWdlLFxuICAgIHN0cmVhbTogY29uZmlnLnNob3VsZF9zdHJlYW0gPz8gZmFsc2UsXG4gICAgb3ZlcnJpZGVzOiBjb25maWcub3ZlcnJpZGVzICE9PSB1bmRlZmluZWQgPyBmcm9tT3ZlcnJpZGVzKGNvbmZpZy5vdmVycmlkZXMpIDogdW5kZWZpbmVkLFxuICAgIGluamVjdDogY29uZmlnLmluamVjdHMgIT09IHVuZGVmaW5lZCA/IGNvbmZpZy5pbmplY3RzLm1hcChmcm9tSW5qZWN0aW9uUHJvbXB0KSA6IHVuZGVmaW5lZCxcbiAgICBtYXhfY2hhdF9oaXN0b3J5OiB0eXBlb2YgY29uZmlnLm1heF9jaGF0X2hpc3RvcnkgPT09ICdudW1iZXInID8gY29uZmlnLm1heF9jaGF0X2hpc3RvcnkgOiB1bmRlZmluZWQsXG4gIH07XG59XG5cbmZ1bmN0aW9uIGZyb21HZW5lcmF0ZVJhd0NvbmZpZyhjb25maWc6IEdlbmVyYXRlUmF3Q29uZmlnKTogZGV0YWlsLkdlbmVyYXRlUGFyYW1zIHtcbiAgcmV0dXJuIHtcbiAgICB1c2VyX2lucHV0OiBjb25maWcudXNlcl9pbnB1dCxcbiAgICB1c2VfcHJlc2V0OiBmYWxzZSxcbiAgICBpbWFnZTogY29uZmlnLmltYWdlLFxuICAgIHN0cmVhbTogY29uZmlnLnNob3VsZF9zdHJlYW0gPz8gZmFsc2UsXG4gICAgbWF4X2NoYXRfaGlzdG9yeTogdHlwZW9mIGNvbmZpZy5tYXhfY2hhdF9oaXN0b3J5ID09PSAnbnVtYmVyJyA/IGNvbmZpZy5tYXhfY2hhdF9oaXN0b3J5IDogdW5kZWZpbmVkLFxuICAgIG92ZXJyaWRlczogY29uZmlnLm92ZXJyaWRlcyA/IGZyb21PdmVycmlkZXMoY29uZmlnLm92ZXJyaWRlcykgOiB1bmRlZmluZWQsXG4gICAgaW5qZWN0OiBjb25maWcuaW5qZWN0cyA/IGNvbmZpZy5pbmplY3RzLm1hcChmcm9tSW5qZWN0aW9uUHJvbXB0KSA6IHVuZGVmaW5lZCxcbiAgICBvcmRlcjogY29uZmlnLm9yZGVyZWRfcHJvbXB0cyxcbiAgfTtcbn1cblxubmFtZXNwYWNlIGRldGFpbCB7XG4gIGV4cG9ydCBpbnRlcmZhY2UgQ3VzdG9tUHJvbXB0IHtcbiAgICByb2xlOiAnc3lzdGVtJyB8ICd1c2VyJyB8ICdhc3Npc3RhbnQnO1xuICAgIGNvbnRlbnQ6IHN0cmluZztcbiAgfVxuXG4gIC8vIOimhueblumFjee9ruexu+Wei1xuICBleHBvcnQgaW50ZXJmYWNlIE92ZXJyaWRlQ29uZmlnIHtcbiAgICB3b3JsZF9pbmZvX2JlZm9yZT86IHN0cmluZzsgLy8g5LiW55WM5Lmm77yI6KeS6Imy5a6a5LmJ5LmL5YmN55qE6YOo5YiG77yJXG4gICAgcGVyc29uYV9kZXNjcmlwdGlvbj86IHN0cmluZzsgLy8g55So5oi35o+P6L+wXG4gICAgY2hhcl9kZXNjcmlwdGlvbj86IHN0cmluZzsgLy8g6KeS6Imy5o+P6L+wXG4gICAgY2hhcl9wZXJzb25hbGl0eT86IHN0cmluZzsgLy8g6KeS6Imy6auY57qn5a6a5LmJLeaAp+agvFxuICAgIHNjZW5hcmlvPzogc3RyaW5nOyAvLyDlnLrmma9cbiAgICB3b3JsZF9pbmZvX2FmdGVyPzogc3RyaW5nOyAvLyDkuJbnlYzkuabvvIjop5LoibLlrprkuYnkuYvlkI7nmoTpg6jliIbvvIlcbiAgICBkaWFsb2d1ZV9leGFtcGxlcz86IHN0cmluZzsgLy8g6KeS6Imy6auY57qn5a6a5LmJLeWvueivneekuuS+i1xuXG4gICAgd2l0aF9kZXB0aF9lbnRyaWVzPzogYm9vbGVhbjsgLy8g5LiW55WM5Lmm5rex5bqmXG4gICAgYXV0aG9yX25vdGU/OiBzdHJpbmc7IC8vIOS9nOiAheazqOmHilxuICAgIGNoYXRfaGlzdG9yeT86IFJvbGVQcm9tcHRbXTsgLy8g6IGK5aSp5Y6G5Y+yXG4gIH1cblxuICAvLyDlhoXnva7mj5DnpLror43mnaHnm67nsbvlnotcbiAgZXhwb3J0IHR5cGUgQnVpbHRpblByb21wdEVudHJ5ID1cbiAgICB8ICd3b3JsZF9pbmZvX2JlZm9yZScgLy8g5LiW55WM5LmmKOinkuiJsuWumuS5ieWJjSlcbiAgICB8ICdwZXJzb25hX2Rlc2NyaXB0aW9uJyAvLyDnlKjmiLfmj4/ov7BcbiAgICB8ICdjaGFyX2Rlc2NyaXB0aW9uJyAvLyDop5LoibLmj4/ov7BcbiAgICB8ICdjaGFyX3BlcnNvbmFsaXR5JyAvLyDop5LoibLmgKfmoLxcbiAgICB8ICdzY2VuYXJpbycgLy8g5Zy65pmvXG4gICAgfCAnd29ybGRfaW5mb19hZnRlcicgLy8g5LiW55WM5LmmKOinkuiJsuWumuS5ieWQjilcbiAgICB8ICdkaWFsb2d1ZV9leGFtcGxlcycgLy8g5a+56K+d56S65L6LXG4gICAgfCAnY2hhdF9oaXN0b3J5JyAvLyDogYrlpKnljoblj7JcbiAgICB8ICd1c2VyX2lucHV0JzsgLy8g55So5oi36L6T5YWlXG5cbiAgLy8g55Sf5oiQ5Y+C5pWw57G75Z6LXG4gIGV4cG9ydCBpbnRlcmZhY2UgR2VuZXJhdGVQYXJhbXMge1xuICAgIHVzZXJfaW5wdXQ/OiBzdHJpbmc7XG4gICAgdXNlX3ByZXNldD86IGJvb2xlYW47XG4gICAgaW1hZ2U/OiBGaWxlIHwgc3RyaW5nO1xuICAgIHN0cmVhbT86IGJvb2xlYW47XG4gICAgb3ZlcnJpZGVzPzogT3ZlcnJpZGVDb25maWc7XG4gICAgbWF4X2NoYXRfaGlzdG9yeT86IG51bWJlcjtcbiAgICBpbmplY3Q/OiBJbmplY3Rpb25Qcm9tcHRbXTtcbiAgICBvcmRlcj86IEFycmF5PEJ1aWx0aW5Qcm9tcHRFbnRyeSB8IEN1c3RvbVByb21wdD47XG4gIH1cbn1cblxuY29uc3QgdHlwZSA9ICdxdWlldCc7XG5jb25zdCBkcnlSdW4gPSBmYWxzZTtcblxuY29uc3QgY2hhcmFjdGVyX25hbWVzX2JlaGF2aW9yID0ge1xuICBOT05FOiAtMSxcbiAgREVGQVVMVDogMCxcbiAgQ09NUExFVElPTjogMSxcbiAgQ09OVEVOVDogMixcbn07XG5cbmNvbnN0IHJvbGVUeXBlczogUmVjb3JkPFxuICAnc3lzdGVtJyB8ICd1c2VyJyB8ICdhc3Npc3RhbnQnLFxuICAodHlwZW9mIGV4dGVuc2lvbl9wcm9tcHRfcm9sZXMpW2tleW9mIHR5cGVvZiBleHRlbnNpb25fcHJvbXB0X3JvbGVzXVxuPiA9IHtcbiAgc3lzdGVtOiBleHRlbnNpb25fcHJvbXB0X3JvbGVzLlNZU1RFTSxcbiAgdXNlcjogZXh0ZW5zaW9uX3Byb21wdF9yb2xlcy5VU0VSLFxuICBhc3Npc3RhbnQ6IGV4dGVuc2lvbl9wcm9tcHRfcm9sZXMuQVNTSVNUQU5ULFxufTtcbmNvbnN0IGRlZmF1bHRfb3JkZXI6IGRldGFpbC5CdWlsdGluUHJvbXB0RW50cnlbXSA9IFtcbiAgJ3dvcmxkX2luZm9fYmVmb3JlJyxcbiAgJ3BlcnNvbmFfZGVzY3JpcHRpb24nLFxuICAnY2hhcl9kZXNjcmlwdGlvbicsXG4gICdjaGFyX3BlcnNvbmFsaXR5JyxcbiAgJ3NjZW5hcmlvJyxcbiAgJ3dvcmxkX2luZm9fYWZ0ZXInLFxuICAnZGlhbG9ndWVfZXhhbXBsZXMnLFxuICAnY2hhdF9oaXN0b3J5JyxcbiAgJ3VzZXJfaW5wdXQnLFxuXTtcblxuY2xhc3MgU3RyZWFtaW5nUHJvY2Vzc29yIHtcbiAgcHVibGljIGdlbmVyYXRvcjogKCkgPT4gQXN5bmNHZW5lcmF0b3I8eyB0ZXh0OiBzdHJpbmcgfSwgdm9pZCwgdm9pZD47XG4gIHB1YmxpYyBzdG9wcGluZ1N0cmluZ3M/OiBhbnk7XG4gIHB1YmxpYyByZXN1bHQ6IHN0cmluZztcbiAgcHVibGljIGlzU3RvcHBlZDogYm9vbGVhbjtcbiAgcHVibGljIGlzRmluaXNoZWQ6IGJvb2xlYW47XG4gIHB1YmxpYyBhYm9ydENvbnRyb2xsZXI6IEFib3J0Q29udHJvbGxlcjtcbiAgcHJpdmF0ZSBtZXNzYWdlQnVmZmVyOiBzdHJpbmc7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5yZXN1bHQgPSAnJztcbiAgICB0aGlzLm1lc3NhZ2VCdWZmZXIgPSAnJztcbiAgICB0aGlzLmlzU3RvcHBlZCA9IGZhbHNlO1xuICAgIHRoaXMuaXNGaW5pc2hlZCA9IGZhbHNlO1xuICAgIHRoaXMuZ2VuZXJhdG9yID0gdGhpcy5udWxsU3RyZWFtaW5nR2VuZXJhdGlvbjtcbiAgICB0aGlzLmFib3J0Q29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcbiAgfVxuXG4gIG9uUHJvZ3Jlc3NTdHJlYW1pbmcodGV4dDogc3RyaW5nLCBpc0ZpbmFsOiBib29sZWFuKSB7XG4gICAgLy8g6K6h566X5aKe6YeP5paH5pysXG4gICAgY29uc3QgbmV3VGV4dCA9IHRleHQuc2xpY2UodGhpcy5tZXNzYWdlQnVmZmVyLmxlbmd0aCk7XG4gICAgdGhpcy5tZXNzYWdlQnVmZmVyID0gdGV4dDtcbiAgICAvLyDlhbzlrrnml6fniYjmnKxcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgbGV0IHByb2Nlc3NlZFRleHQgPSBjbGVhblVwTWVzc2FnZShuZXdUZXh0LCBmYWxzZSwgZmFsc2UsICFpc0ZpbmFsLCB0aGlzLnN0b3BwaW5nU3RyaW5ncyk7XG5cbiAgICBjb25zdCBjaGFyc1RvQmFsYW5jZSA9IFsnKicsICdcIicsICdgYGAnXTtcbiAgICBmb3IgKGNvbnN0IGNoYXIgb2YgY2hhcnNUb0JhbGFuY2UpIHtcbiAgICAgIGlmICghaXNGaW5hbCAmJiBpc09kZChjb3VudE9jY3VycmVuY2VzKHByb2Nlc3NlZFRleHQsIGNoYXIpKSkge1xuICAgICAgICBjb25zdCBzZXBhcmF0b3IgPSBjaGFyLmxlbmd0aCA+IDEgPyAnXFxuJyA6ICcnO1xuICAgICAgICBwcm9jZXNzZWRUZXh0ID0gcHJvY2Vzc2VkVGV4dC50cmltRW5kKCkgKyBzZXBhcmF0b3IgKyBjaGFyO1xuICAgICAgfVxuICAgIH1cblxuICAgIGV2ZW50U291cmNlLmVtaXQoJ2pzX3N0cmVhbV90b2tlbl9yZWNlaXZlZF9mdWxseScsIHRleHQpO1xuICAgIGV2ZW50U291cmNlLmVtaXQoJ2pzX3N0cmVhbV90b2tlbl9yZWNlaXZlZF9pbmNyZW1lbnRhbGx5JywgcHJvY2Vzc2VkVGV4dCk7XG5cbiAgICBpZiAoaXNGaW5hbCkge1xuICAgICAgLy8g5YW85a655pen54mI5pysXG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICBjb25zdCBmdWxsVGV4dCA9IGNsZWFuVXBNZXNzYWdlKHRleHQsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIHRoaXMuc3RvcHBpbmdTdHJpbmdzKTtcbiAgICAgIGV2ZW50U291cmNlLmVtaXQoJ2pzX2dlbmVyYXRpb25fZW5kZWQnLCBmdWxsVGV4dCk7XG4gICAgfVxuICB9XG5cbiAgb25FcnJvclN0cmVhbWluZygpIHtcbiAgICBpZiAodGhpcy5hYm9ydENvbnRyb2xsZXIpIHtcbiAgICAgIHRoaXMuYWJvcnRDb250cm9sbGVyLmFib3J0KCk7XG4gICAgfVxuICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICB1bmJsb2NrR2VuZXJhdGlvbigpO1xuICAgIHNhdmVDaGF0Q29uZGl0aW9uYWwoKTtcbiAgfVxuXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZXF1aXJlLXlpZWxkXG4gIGFzeW5jICpudWxsU3RyZWFtaW5nR2VuZXJhdGlvbigpOiBBc3luY0dlbmVyYXRvcjx7IHRleHQ6IHN0cmluZyB9LCB2b2lkLCB2b2lkPiB7XG4gICAgdGhyb3cgRXJyb3IoJ0dlbmVyYXRpb24gZnVuY3Rpb24gZm9yIHN0cmVhbWluZyBpcyBub3QgaG9va2VkIHVwJyk7XG4gIH1cblxuICBhc3luYyBnZW5lcmF0ZSgpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc3cgPSBuZXcgU3RvcHdhdGNoKDEwMDAgLyBwb3dlcl91c2VyLnN0cmVhbWluZ19mcHMpO1xuICAgICAgY29uc3QgdGltZXN0YW1wcyA9IFtdO1xuXG4gICAgICBmb3IgYXdhaXQgKGNvbnN0IHsgdGV4dCB9IG9mIHRoaXMuZ2VuZXJhdG9yKCkpIHtcbiAgICAgICAgdGltZXN0YW1wcy5wdXNoKERhdGUubm93KCkpO1xuICAgICAgICBpZiAodGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgICB0aGlzLm1lc3NhZ2VCdWZmZXIgPSAnJztcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnJlc3VsdCA9IHRleHQ7XG4gICAgICAgIGF3YWl0IHN3LnRpY2soKCkgPT4gdGhpcy5vblByb2dyZXNzU3RyZWFtaW5nKHRleHQsIGZhbHNlKSk7XG4gICAgICB9XG5cbiAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgdGhpcy5vblByb2dyZXNzU3RyZWFtaW5nKHRoaXMucmVzdWx0LCB0cnVlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMubWVzc2FnZUJ1ZmZlciA9ICcnO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBzZWNvbmRzID0gKHRpbWVzdGFtcHNbdGltZXN0YW1wcy5sZW5ndGggLSAxXSAtIHRpbWVzdGFtcHNbMF0pIC8gMTAwMDtcbiAgICAgIGxvZy53YXJuKFxuICAgICAgICBgU3RyZWFtIHN0YXRzOiAke3RpbWVzdGFtcHMubGVuZ3RofSB0b2tlbnMsICR7c2Vjb25kcy50b0ZpeGVkKDIpfSBzZWNvbmRzLCByYXRlOiAke051bWJlcihcbiAgICAgICAgICB0aW1lc3RhbXBzLmxlbmd0aCAvIHNlY29uZHMsXG4gICAgICAgICkudG9GaXhlZCgyKX0gVFBTYCxcbiAgICAgICk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBpZiAoIXRoaXMuaXNGaW5pc2hlZCkge1xuICAgICAgICB0aGlzLm9uRXJyb3JTdHJlYW1pbmcoKTtcbiAgICAgICAgdGhyb3cgRXJyb3IoYEdlbmVyYXRlIG1ldGhvZCBlcnJvcjogJHtlcnJ9YCk7XG4gICAgICB9XG4gICAgICB0aGlzLm1lc3NhZ2VCdWZmZXIgPSAnJztcbiAgICAgIHJldHVybiB0aGlzLnJlc3VsdDtcbiAgICB9XG5cbiAgICB0aGlzLmlzRmluaXNoZWQgPSB0cnVlO1xuICAgIHJldHVybiB0aGlzLnJlc3VsdDtcbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBpZnJhbWVHZW5lcmF0ZSh7XG4gIHVzZXJfaW5wdXQgPSAnJyxcbiAgdXNlX3ByZXNldCA9IHRydWUsXG4gIGltYWdlID0gdW5kZWZpbmVkLFxuICBvdmVycmlkZXMgPSB1bmRlZmluZWQsXG4gIG1heF9jaGF0X2hpc3RvcnkgPSB1bmRlZmluZWQsXG4gIGluamVjdCA9IFtdLFxuICBvcmRlciA9IHVuZGVmaW5lZCxcbiAgc3RyZWFtID0gZmFsc2UsXG59OiBkZXRhaWwuR2VuZXJhdGVQYXJhbXMgPSB7fSk6IFByb21pc2U8c3RyaW5nPiB7XG4gIC8v5Yid5aeL5YyWXG4gIGFib3J0Q29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcblxuICAvLyAxLiDlpITnkIbnlKjmiLfovpPlhaXvvIjmraPliJnvvIzlro/vvIlcbiAgY29uc3QgcHJvY2Vzc2VkVXNlcklucHV0ID0gcHJvY2Vzc1VzZXJJbnB1dChzdWJzdGl0dXRlUGFyYW1zKHVzZXJfaW5wdXQpKSB8fCAnJztcblxuICAvLyAyLiDlh4blpIfov4fmu6TlkI7nmoTln7rnoYDmlbDmja5cbiAgY29uc3QgYmFzZURhdGEgPSBhd2FpdCBwcmVwYXJlQW5kT3ZlcnJpZGVEYXRhKFxuICAgIHtcbiAgICAgIG92ZXJyaWRlcyxcbiAgICAgIG1heF9jaGF0X2hpc3RvcnksXG4gICAgICBpbmplY3QsXG4gICAgICBvcmRlcixcbiAgICB9LFxuICAgIHByb2Nlc3NlZFVzZXJJbnB1dCxcbiAgKTtcblxuICAvLyAzLiDmoLnmja4gdXNlX3ByZXNldCDliIbmtYHlpITnkIZcbiAgY29uc3QgZ2VuZXJhdGVfZGF0YSA9IHVzZV9wcmVzZXRcbiAgICA/IGF3YWl0IGhhbmRsZVByZXNldFBhdGgoYmFzZURhdGEsIHByb2Nlc3NlZFVzZXJJbnB1dCwge1xuICAgICAgICBpbWFnZSxcbiAgICAgICAgb3ZlcnJpZGVzLFxuICAgICAgICBtYXhfY2hhdF9oaXN0b3J5LFxuICAgICAgICBpbmplY3QsXG4gICAgICAgIG9yZGVyLFxuICAgICAgfSlcbiAgICA6IGF3YWl0IGhhbmRsZUN1c3RvbVBhdGgoXG4gICAgICAgIGJhc2VEYXRhLFxuICAgICAgICB7XG4gICAgICAgICAgaW1hZ2UsXG4gICAgICAgICAgb3ZlcnJpZGVzLFxuICAgICAgICAgIG1heF9jaGF0X2hpc3RvcnksXG4gICAgICAgICAgaW5qZWN0LFxuICAgICAgICAgIG9yZGVyLFxuICAgICAgICB9LFxuICAgICAgICBwcm9jZXNzZWRVc2VySW5wdXQsXG4gICAgICApO1xuICBsb2cuaW5mbygnW0dlbmVyYXRlOuWPkemAgeaPkOekuuivjV0nLCBnZW5lcmF0ZV9kYXRhKTtcbiAgLy8gNC4g5qC55o2uIHN0cmVhbSDlj4LmlbDlhrPlrprnlJ/miJDmlrnlvI9cbiAgcmV0dXJuIGF3YWl0IGdlbmVyYXRlUmVzcG9uc2UoZ2VuZXJhdGVfZGF0YSwgc3RyZWFtKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gcHJlcGFyZUFuZE92ZXJyaWRlRGF0YShcbiAgY29uZmlnOiBPbWl0PGRldGFpbC5HZW5lcmF0ZVBhcmFtcywgJ3VzZXJfaW5wdXQnIHwgJ3VzZV9wcmVzZXQnPixcbiAgcHJvY2Vzc2VkVXNlcklucHV0OiBzdHJpbmcsXG4pIHtcbiAgY29uc3QgZ2V0T3ZlcnJpZGVDb250ZW50ID0gKGlkZW50aWZpZXI6IHN0cmluZyk6IHN0cmluZyB8IFJvbGVQcm9tcHRbXSB8IHVuZGVmaW5lZCA9PiB7XG4gICAgaWYgKCFjb25maWcub3ZlcnJpZGVzKSByZXR1cm4gdW5kZWZpbmVkO1xuICAgIGNvbnN0IHZhbHVlID0gY29uZmlnLm92ZXJyaWRlc1tpZGVudGlmaWVyIGFzIGtleW9mIGRldGFpbC5PdmVycmlkZUNvbmZpZ107XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ2Jvb2xlYW4nKSByZXR1cm4gdW5kZWZpbmVkO1xuICAgIHJldHVybiB2YWx1ZTtcbiAgfTtcblxuICAvLyAxLiDlpITnkIbop5LoibLljaHpq5jnuqflrprkuYnop5LoibLlpIfms6ggLSDku4XlnKhjaGF0X2hpc3RvcnnmnKrooqvov4fmu6Tml7bmiafooYxcbiAgaWYgKCFpc1Byb21wdEZpbHRlcmVkKCdjaGF0X2hpc3RvcnknLCBjb25maWcpKSB7XG4gICAgaGFuZGxlQ2hhckRlcHRoUHJvbXB0KCk7XG4gIH1cblxuICAvLyAyLiDorr7nva7kvZzogIXms6jph4ogLSDku4XlnKhjaGF0X2hpc3RvcnnmnKrooqvov4fmu6Tml7bmiafooYxcbiAgaWYgKCFpc1Byb21wdEZpbHRlcmVkKCdjaGF0X2hpc3RvcnknLCBjb25maWcpICYmICFpc1Byb21wdEZpbHRlcmVkKCdhdXRob3Jfbm90ZScsIGNvbmZpZykpIHtcbiAgICBzZXRBdXRob3JOb3RlUHJvbXB0KGNvbmZpZyk7XG4gIH1cblxuICAvLyAzLiDlpITnkIZ1c2Vy6KeS6Imy5o+P6L+wIC0g5LuF5ZyoY2hhdF9oaXN0b3J55ZKMcGVyc29uYV9kZXNjcmlwdGlvbumDveacquiiq+i/h+a7pOaXtuaJp+ihjFxuICBpZiAoIWlzUHJvbXB0RmlsdGVyZWQoJ2NoYXRfaGlzdG9yeScsIGNvbmZpZykgJiYgIWlzUHJvbXB0RmlsdGVyZWQoJ3BlcnNvbmFfZGVzY3JpcHRpb24nLCBjb25maWcpKSB7XG4gICAgc2V0UGVyc29uYURlc2NyaXB0aW9uRXh0ZW5zaW9uUHJvbXB0KCk7XG4gIH1cblxuICAvLyA0LiDojrflj5bop5LoibLljaHln7rnoYDlrZfmrrVcbiAgY29uc3QgY2hhckRlcHRoUHJvbXB0ID0gYmFzZUNoYXRSZXBsYWNlKFxuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBjaGFyYWN0ZXJzW3RoaXNfY2hpZF0/LmRhdGE/LmV4dGVuc2lvbnM/LmRlcHRoX3Byb21wdD8ucHJvbXB0Py50cmltKCksXG4gICAgbmFtZTEsXG4gICAgbmFtZTIsXG4gICk7XG4gIGNvbnN0IGNyZWF0b3JOb3RlcyA9IGJhc2VDaGF0UmVwbGFjZShcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgY2hhcmFjdGVyc1t0aGlzX2NoaWRdPy5kYXRhPy5jcmVhdG9yX25vdGVzPy50cmltKCksXG4gICAgbmFtZTEsXG4gICAgbmFtZTIsXG4gICk7XG4gIGNvbnN0IHtcbiAgICBkZXNjcmlwdGlvbjogcmF3RGVzY3JpcHRpb24sXG4gICAgcGVyc29uYWxpdHk6IHJhd1BlcnNvbmFsaXR5LFxuICAgIHBlcnNvbmE6IHJhd1BlcnNvbmEsXG4gICAgc2NlbmFyaW86IHJhd1NjZW5hcmlvLFxuICAgIG1lc0V4YW1wbGVzOiByYXdNZXNFeGFtcGxlcyxcbiAgICBzeXN0ZW0sXG4gICAgamFpbGJyZWFrLFxuICB9ID0gZ2V0Q2hhcmFjdGVyQ2FyZEZpZWxkcygpO1xuXG4gIC8vIOWIpOaWreaYr+WQpuiiq+i/h+a7pCzlpoLmnpzooqvov4fmu6Tov5Tlm57nqbrlrZfnrKbkuLIs5ZCm5YiZ6L+U5Zueb3ZlcnJpZGXnmoTlgLzmiJbljp/lp4vlgLxcbiAgY29uc3QgZGVzY3JpcHRpb24gPSBpc1Byb21wdEZpbHRlcmVkKCdjaGFyX2Rlc2NyaXB0aW9uJywgY29uZmlnKVxuICAgID8gJydcbiAgICA6IGdldE92ZXJyaWRlQ29udGVudCgnY2hhcl9kZXNjcmlwdGlvbicpID8/IHJhd0Rlc2NyaXB0aW9uO1xuXG4gIGNvbnN0IHBlcnNvbmFsaXR5ID0gaXNQcm9tcHRGaWx0ZXJlZCgnY2hhcl9wZXJzb25hbGl0eScsIGNvbmZpZylcbiAgICA/ICcnXG4gICAgOiBnZXRPdmVycmlkZUNvbnRlbnQoJ2NoYXJfcGVyc29uYWxpdHknKSA/PyByYXdQZXJzb25hbGl0eTtcblxuICBjb25zdCBwZXJzb25hID0gaXNQcm9tcHRGaWx0ZXJlZCgncGVyc29uYV9kZXNjcmlwdGlvbicsIGNvbmZpZylcbiAgICA/ICcnXG4gICAgOiBnZXRPdmVycmlkZUNvbnRlbnQoJ3BlcnNvbmFfZGVzY3JpcHRpb24nKSA/PyByYXdQZXJzb25hO1xuXG4gIGNvbnN0IHNjZW5hcmlvID0gaXNQcm9tcHRGaWx0ZXJlZCgnc2NlbmFyaW8nLCBjb25maWcpID8gJycgOiBnZXRPdmVycmlkZUNvbnRlbnQoJ3NjZW5hcmlvJykgPz8gcmF3U2NlbmFyaW87XG5cbiAgY29uc3QgbWVzRXhhbXBsZXMgPSBpc1Byb21wdEZpbHRlcmVkKCdkaWFsb2d1ZV9leGFtcGxlcycsIGNvbmZpZylcbiAgICA/ICcnXG4gICAgOiAoZ2V0T3ZlcnJpZGVDb250ZW50KCdkaWFsb2d1ZV9leGFtcGxlcycpIGFzIHN0cmluZykgPz8gcmF3TWVzRXhhbXBsZXM7XG5cbiAgbGV0IG1lc0V4YW1wbGVzQXJyYXkgPSBwYXJzZU1lc0V4YW1wbGVzKG1lc0V4YW1wbGVzKTtcbiAgbGV0IG9haU1lc3NhZ2VFeGFtcGxlcyA9IFtdO1xuICBvYWlNZXNzYWdlRXhhbXBsZXMgPSBzZXRPcGVuQUlNZXNzYWdlRXhhbXBsZXMobWVzRXhhbXBsZXNBcnJheSk7XG5cbiAgLy8gNS4g6I635Y+W5YGP572u5a2X56ym5LiyXG4gIGNvbnN0IHsgcHJvbXB0QmlhcyB9ID0gZ2V0Qmlhc1N0cmluZ3MocHJvY2Vzc2VkVXNlcklucHV0LCB0eXBlKTtcblxuICAvLyA2LiDlpITnkIboh6rlrprkuYnms6jlhaXnmoTmj5DnpLror41cbiAgaWYgKGNvbmZpZy5pbmplY3QpIHtcbiAgICBhd2FpdCBoYW5kbGVJbmplY3RlZFByb21wdHMoY29uZmlnKTtcbiAgfVxuXG4gIC8vIDcuIOWkhOeQhuiBiuWkqeiusOW9lVxuICBsZXQgb2FpTWVzc2FnZXMgPSBbXTtcbiAgaWYgKGNvbmZpZy5vdmVycmlkZXM/LmNoYXRfaGlzdG9yeSkge1xuICAgIG9haU1lc3NhZ2VzID0gWy4uLmNvbmZpZy5vdmVycmlkZXMuY2hhdF9oaXN0b3J5XS5yZXZlcnNlKCk7XG4gIH0gZWxzZSB7XG4gICAgb2FpTWVzc2FnZXMgPSBzZXRPcGVuQUlNZXNzYWdlcyhhd2FpdCBwcm9jZXNzQ2hhdEhpc3RvcnkoY2hhdCkpO1xuICAgIGlmIChjb25maWcubWF4X2NoYXRfaGlzdG9yeSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBvYWlNZXNzYWdlcyA9IG9haU1lc3NhZ2VzLnNsaWNlKDAsIGNvbmZpZy5tYXhfY2hhdF9oaXN0b3J5KTtcbiAgICB9XG4gIH1cblxuICAvLyDmt7vliqDkuLTml7bmtojmga/nlKjkuo7mv4DmtLvkuJbnlYzkuaZcbiAgYWRkVGVtcG9yYXJ5VXNlck1lc3NhZ2UocHJvY2Vzc2VkVXNlcklucHV0KTtcbiAgLy8gOC4g5aSE55CG5LiW55WM5L+h5oGvXG4gIGNvbnN0IHdvcmxkSW5mbyA9IGF3YWl0IHByb2Nlc3NXb3JsZEluZm8ob2FpTWVzc2FnZXMgYXMgUm9sZVByb21wdFtdLCBjb25maWcsIHtcbiAgICBkZXNjcmlwdGlvbjogcmF3RGVzY3JpcHRpb24sXG4gICAgcGVyc29uYWxpdHk6IHJhd1BlcnNvbmFsaXR5LFxuICAgIHBlcnNvbmE6IHJhd1BlcnNvbmEsXG4gICAgc2NlbmFyaW86IHJhd1NjZW5hcmlvLFxuICAgIGNoYXJEZXB0aFByb21wdCxcbiAgICBjcmVhdG9yTm90ZXMsXG4gIH0pO1xuXG4gIC8vIOenu+mZpOS4tOaXtua2iOaBr1xuICByZW1vdmVUZW1wb3JhcnlVc2VyTWVzc2FnZSgpO1xuXG4gIC8vIDkuIOWkhOeQhuS4lueVjOS5pua2iOaBr+ekuuS+i1xuICBtZXNFeGFtcGxlc0FycmF5ID0gIWlzUHJvbXB0RmlsdGVyZWQoJ2RpYWxvZ3VlX2V4YW1wbGVzJywgY29uZmlnKVxuICAgID8gYXdhaXQgcHJvY2Vzc01lc3NhZ2VFeGFtcGxlcyhtZXNFeGFtcGxlc0FycmF5LCB3b3JsZEluZm8ud29ybGRJbmZvRXhhbXBsZXMpXG4gICAgOiBbXTtcblxuICByZXR1cm4ge1xuICAgIGNoYXJhY3RlckluZm86IHtcbiAgICAgIGRlc2NyaXB0aW9uLFxuICAgICAgcGVyc29uYWxpdHksXG4gICAgICBwZXJzb25hLFxuICAgICAgc2NlbmFyaW8sXG4gICAgICBzeXN0ZW06IHN5c3RlbSxcbiAgICAgIGphaWxicmVhazogamFpbGJyZWFrLFxuICAgIH0sXG4gICAgY2hhdENvbnRleHQ6IHtcbiAgICAgIG9haU1lc3NhZ2VzLFxuICAgICAgb2FpTWVzc2FnZUV4YW1wbGVzLFxuICAgICAgcHJvbXB0QmlhcyxcbiAgICB9LFxuICAgIHdvcmxkSW5mbyxcbiAgfTtcbn1cblxuLy/lpITnkIbop5LoibLljaHkuK3nmoTmt7Hluqbmj5DnpLror41cbmZ1bmN0aW9uIGhhbmRsZUNoYXJEZXB0aFByb21wdCgpIHtcbiAgY29uc3QgZGVwdGhQcm9tcHRUZXh0ID1cbiAgICAvLyBAdHMtaWdub3JlXG4gICAgYmFzZUNoYXRSZXBsYWNlKGNoYXJhY3RlcnNbdGhpc19jaGlkXT8uZGF0YT8uZXh0ZW5zaW9ucz8uZGVwdGhfcHJvbXB0Py5wcm9tcHQ/LnRyaW0oKSwgbmFtZTEsIG5hbWUyKSB8fCAnJztcbiAgLy8gQHRzLWlnbm9yZVxuICBjb25zdCBkZXB0aFByb21wdERlcHRoID0gY2hhcmFjdGVyc1t0aGlzX2NoaWRdPy5kYXRhPy5leHRlbnNpb25zPy5kZXB0aF9wcm9tcHQ/LmRlcHRoID8/ICc0JztcbiAgY29uc3QgZGVwdGhQcm9tcHRSb2xlID0gZ2V0RXh0ZW5zaW9uUHJvbXB0Um9sZUJ5TmFtZShcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgY2hhcmFjdGVyc1t0aGlzX2NoaWRdPy5kYXRhPy5leHRlbnNpb25zPy5kZXB0aF9wcm9tcHQ/LnJvbGUgPz8gJ3N5c3RlbScsXG4gICk7XG4gIHNldEV4dGVuc2lvblByb21wdChcbiAgICAnREVQVEhfUFJPTVBUJyxcbiAgICBkZXB0aFByb21wdFRleHQsXG4gICAgZXh0ZW5zaW9uX3Byb21wdF90eXBlcy5JTl9DSEFULFxuICAgIGRlcHRoUHJvbXB0RGVwdGgsXG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGV4dGVuc2lvbl9zZXR0aW5ncy5ub3RlLmFsbG93V0lTY2FuLFxuICAgIGRlcHRoUHJvbXB0Um9sZSxcbiAgKTtcbn1cbi8v5aSE55CG5L2c6ICF5rOo6YeKXG5mdW5jdGlvbiBzZXRBdXRob3JOb3RlUHJvbXB0KGNvbmZpZzogZGV0YWlsLkdlbmVyYXRlUGFyYW1zKSB7XG4gIGNvbnN0IGF1dGhvck5vdGVPdmVycmlkZSA9IGNvbmZpZz8ub3ZlcnJpZGVzPy5hdXRob3Jfbm90ZTtcbiAgLy8gQHRzLWlnbm9yZVxuICBjb25zdCBwcm9tcHQgPSBhdXRob3JOb3RlT3ZlcnJpZGUgPz8gKCQoJyNleHRlbnNpb25fZmxvYXRpbmdfcHJvbXB0JykudmFsKCkgYXMgc3RyaW5nKTtcblxuICBzZXRFeHRlbnNpb25Qcm9tcHQoXG4gICAgTk9URV9NT0RVTEVfTkFNRSxcbiAgICBwcm9tcHQsXG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGNoYXRfbWV0YWRhdGFbbWV0YWRhdGFfa2V5cy5wb3NpdGlvbl0sXG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGNoYXRfbWV0YWRhdGFbbWV0YWRhdGFfa2V5cy5kZXB0aF0sXG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGV4dGVuc2lvbl9zZXR0aW5ncy5ub3RlLmFsbG93V0lTY2FuLFxuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBjaGF0X21ldGFkYXRhW21ldGFkYXRhX2tleXMucm9sZV0sXG4gICk7XG59XG4vL+eUqOaIt+inkuiJsuaPj+i/sOaPkOekuuivjeiuvue9ruS4uuaPkOekuuivjeeuoeeQhuWZqOS5i+WklueahOmAiemhueeahOaDheWGtVxuZnVuY3Rpb24gc2V0UGVyc29uYURlc2NyaXB0aW9uRXh0ZW5zaW9uUHJvbXB0KCkge1xuICBjb25zdCBkZXNjcmlwdGlvbiA9IHBvd2VyX3VzZXIucGVyc29uYV9kZXNjcmlwdGlvbjtcbiAgY29uc3QgSU5KRUNUX1RBRyA9ICdQRVJTT05BX0RFU0NSSVBUSU9OJztcbiAgc2V0RXh0ZW5zaW9uUHJvbXB0KElOSkVDVF9UQUcsICcnLCBleHRlbnNpb25fcHJvbXB0X3R5cGVzLklOX1BST01QVCwgMCk7XG5cbiAgaWYgKCFkZXNjcmlwdGlvbiB8fCBwb3dlcl91c2VyLnBlcnNvbmFfZGVzY3JpcHRpb25fcG9zaXRpb24gPT09IHBlcnNvbmFfZGVzY3JpcHRpb25fcG9zaXRpb25zLk5PTkUpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICAvL+W9k3VzZXLkv6Hmga/lnKjkvZzogIXms6jph4rliY3lkI4gLSDku4XlnKjkvZzogIXms6jph4rmnKrooqvov4fmu6Tml7bmiafooYxcbiAgY29uc3QgcHJvbXB0UG9zaXRpb25zID0gW3BlcnNvbmFfZGVzY3JpcHRpb25fcG9zaXRpb25zLkJPVFRPTV9BTiwgcGVyc29uYV9kZXNjcmlwdGlvbl9wb3NpdGlvbnMuVE9QX0FOXTtcblxuICBpZiAocHJvbXB0UG9zaXRpb25zLmluY2x1ZGVzKHBvd2VyX3VzZXIucGVyc29uYV9kZXNjcmlwdGlvbl9wb3NpdGlvbikgJiYgc2hvdWxkV0lBZGRQcm9tcHQpIHtcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgY29uc3Qgb3JpZ2luYWxBTiA9IGdldENvbnRleHQoKS5leHRlbnNpb25Qcm9tcHRzW05PVEVfTU9EVUxFX05BTUVdLnZhbHVlO1xuICAgIGNvbnN0IEFOV2l0aERlc2MgPVxuICAgICAgcG93ZXJfdXNlci5wZXJzb25hX2Rlc2NyaXB0aW9uX3Bvc2l0aW9uID09PSBwZXJzb25hX2Rlc2NyaXB0aW9uX3Bvc2l0aW9ucy5UT1BfQU5cbiAgICAgICAgPyBgJHtkZXNjcmlwdGlvbn1cXG4ke29yaWdpbmFsQU59YFxuICAgICAgICA6IGAke29yaWdpbmFsQU59XFxuJHtkZXNjcmlwdGlvbn1gO1xuXG4gICAgc2V0RXh0ZW5zaW9uUHJvbXB0KFxuICAgICAgTk9URV9NT0RVTEVfTkFNRSxcbiAgICAgIEFOV2l0aERlc2MsXG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICBjaGF0X21ldGFkYXRhW21ldGFkYXRhX2tleXMucG9zaXRpb25dLFxuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgY2hhdF9tZXRhZGF0YVttZXRhZGF0YV9rZXlzLmRlcHRoXSxcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgIGV4dGVuc2lvbl9zZXR0aW5ncy5ub3RlLmFsbG93V0lTY2FuLFxuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgY2hhdF9tZXRhZGF0YVttZXRhZGF0YV9rZXlzLnJvbGVdLFxuICAgICk7XG4gIH1cblxuICAvLyB1c2Vy5L+h5oGv5rex5bqm5rOo5YWl5LiN5L6d6LWW5LqO5L2c6ICF5rOo6YeK55qE54q25oCB77yM55u05o6l5bqU55SoXG4gIGlmIChwb3dlcl91c2VyLnBlcnNvbmFfZGVzY3JpcHRpb25fcG9zaXRpb24gPT09IHBlcnNvbmFfZGVzY3JpcHRpb25fcG9zaXRpb25zLkFUX0RFUFRIKSB7XG4gICAgc2V0RXh0ZW5zaW9uUHJvbXB0KFxuICAgICAgSU5KRUNUX1RBRyxcbiAgICAgIGRlc2NyaXB0aW9uLFxuICAgICAgZXh0ZW5zaW9uX3Byb21wdF90eXBlcy5JTl9DSEFULFxuICAgICAgcG93ZXJfdXNlci5wZXJzb25hX2Rlc2NyaXB0aW9uX2RlcHRoLFxuICAgICAgdHJ1ZSxcbiAgICAgIHBvd2VyX3VzZXIucGVyc29uYV9kZXNjcmlwdGlvbl9yb2xlLFxuICAgICk7XG4gIH1cbn1cbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUluamVjdGVkUHJvbXB0cyhwcm9tcHRDb25maWc6IE9taXQ8ZGV0YWlsLkdlbmVyYXRlUGFyYW1zLCAndXNlcl9pbnB1dCcgfCAndXNlX3ByZXNldCc+KSB7XG4gIGlmICghcHJvbXB0Q29uZmlnIHx8ICFBcnJheS5pc0FycmF5KHByb21wdENvbmZpZy5pbmplY3QpKSByZXR1cm47XG5cbiAgY29uc3QgaW5qZWN0cyA9IHByb21wdENvbmZpZy5pbmplY3Q7XG5cbiAgY29uc3QgcG9zaXRpb25fbWFwID0ge1xuICAgIGJlZm9yZV9wcm9tcHQ6IGV4dGVuc2lvbl9wcm9tcHRfdHlwZXMuQkVGT1JFX1BST01QVCxcbiAgICBpbl9jaGF0OiBleHRlbnNpb25fcHJvbXB0X3R5cGVzLklOX0NIQVQsXG4gICAgYWZ0ZXJfcHJvbXB0OiBleHRlbnNpb25fcHJvbXB0X3R5cGVzLklOX1BST01QVCxcbiAgICBub25lOiBleHRlbnNpb25fcHJvbXB0X3R5cGVzLk5PTkUsXG4gIH0gYXMgY29uc3Q7XG5cbiAgZm9yIChjb25zdCBpbmplY3Qgb2YgaW5qZWN0cykge1xuICAgIGNvbnN0IHZhbGlkYXRlZEluamVjdCA9IHtcbiAgICAgIHJvbGU6IHJvbGVUeXBlc1tpbmplY3Qucm9sZV0gPz8gZXh0ZW5zaW9uX3Byb21wdF9yb2xlcy5TWVNURU0sXG4gICAgICBjb250ZW50OiBpbmplY3QuY29udGVudCB8fCAnJyxcbiAgICAgIGRlcHRoOiBOdW1iZXIoaW5qZWN0LmRlcHRoKSB8fCAwLFxuICAgICAgc2hvdWxkX3NjYW46IEJvb2xlYW4oaW5qZWN0LnNob3VsZF9zY2FuKSB8fCB0cnVlLFxuICAgICAgcG9zaXRpb246IHBvc2l0aW9uX21hcFtpbmplY3QucG9zaXRpb24gYXMga2V5b2YgdHlwZW9mIHBvc2l0aW9uX21hcF0gPz8gZXh0ZW5zaW9uX3Byb21wdF90eXBlcy5JTl9DSEFULFxuICAgIH07XG5cbiAgICAvLyDorr7nva7nlKjmiLfoh6rlrprkuYnms6jlhaXmj5DnpLror41cbiAgICBzZXRFeHRlbnNpb25Qcm9tcHQoXG4gICAgICBgSU5KRUNUSU9OLSR7aW5qZWN0LmRlcHRofS0ke2luamVjdC5yb2xlfWAsXG4gICAgICB2YWxpZGF0ZWRJbmplY3QuY29udGVudCxcbiAgICAgIHZhbGlkYXRlZEluamVjdC5wb3NpdGlvbixcbiAgICAgIHZhbGlkYXRlZEluamVjdC5kZXB0aCxcbiAgICAgIHZhbGlkYXRlZEluamVjdC5zaG91bGRfc2NhbixcbiAgICAgIHZhbGlkYXRlZEluamVjdC5yb2xlLFxuICAgICk7XG4gIH1cbn1cbi8vIOWkhOeQhuiBiuWkqeiusOW9lVxuYXN5bmMgZnVuY3Rpb24gcHJvY2Vzc0NoYXRIaXN0b3J5KGNoYXRIaXN0b3J5OiBhbnlbXSkge1xuICBjb25zdCBjb3JlQ2hhdCA9IGNoYXRIaXN0b3J5LmZpbHRlcih4ID0+ICF4LmlzX3N5c3RlbSk7XG5cbiAgcmV0dXJuIGF3YWl0IFByb21pc2UuYWxsKFxuICAgIGNvcmVDaGF0Lm1hcChhc3luYyAoY2hhdEl0ZW0sIGluZGV4KSA9PiB7XG4gICAgICBjb25zdCBtZXNzYWdlID0gY2hhdEl0ZW0ubWVzO1xuICAgICAgY29uc3QgcmVnZXhUeXBlID0gY2hhdEl0ZW0uaXNfdXNlciA/IHJlZ2V4X3BsYWNlbWVudC5VU0VSX0lOUFVUIDogcmVnZXhfcGxhY2VtZW50LkFJX09VVFBVVDtcblxuICAgICAgY29uc3QgcmVnZXhlZE1lc3NhZ2UgPSBnZXRSZWdleGVkU3RyaW5nKG1lc3NhZ2UsIHJlZ2V4VHlwZSwge1xuICAgICAgICBpc1Byb21wdDogdHJ1ZSxcbiAgICAgICAgZGVwdGg6IGNvcmVDaGF0Lmxlbmd0aCAtIGluZGV4IC0gMSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5jaGF0SXRlbSxcbiAgICAgICAgbWVzOiByZWdleGVkTWVzc2FnZSxcbiAgICAgICAgaW5kZXgsXG4gICAgICB9O1xuICAgIH0pLFxuICApO1xufVxuXG4vLyDlpITnkIbkuJbnlYzkuaZcbmFzeW5jIGZ1bmN0aW9uIHByb2Nlc3NXb3JsZEluZm8oXG4gIG9haU1lc3NhZ2VzOiBSb2xlUHJvbXB0W10sXG4gIGNvbmZpZzogT21pdDxkZXRhaWwuR2VuZXJhdGVQYXJhbXMsICd1c2VyX2lucHV0JyB8ICd1c2VfcHJlc2V0Jz4sXG4gIGNoYXJhY3RlckluZm86IHtcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgIHBlcnNvbmFsaXR5OiBzdHJpbmc7XG4gICAgcGVyc29uYTogc3RyaW5nO1xuICAgIHNjZW5hcmlvOiBzdHJpbmc7XG4gICAgY2hhckRlcHRoUHJvbXB0OiBzdHJpbmc7XG4gICAgY3JlYXRvck5vdGVzOiBzdHJpbmc7XG4gIH0sXG4pIHtcbiAgY29uc3QgY2hhdEZvcldJID0gb2FpTWVzc2FnZXNcbiAgICAuZmlsdGVyKHggPT4geC5yb2xlICE9PSAnc3lzdGVtJylcbiAgICAubWFwKHggPT4ge1xuICAgICAgY29uc3QgbmFtZSA9IHgucm9sZSA9PT0gJ3VzZXInID8gbmFtZTEgOiBuYW1lMjtcbiAgICAgIHJldHVybiB3b3JsZF9pbmZvX2luY2x1ZGVfbmFtZXMgPyBgJHtuYW1lfTogJHt4LmNvbnRlbnR9YCA6IHguY29udGVudDtcbiAgICB9KVxuICAgIC5yZXZlcnNlKCk7XG5cbiAgY29uc3QgdGhpc19tYXhfY29udGV4dCA9IGdldE1heENvbnRleHRTaXplKCk7XG4gIGNvbnN0IGdsb2JhbFNjYW5EYXRhID0ge1xuICAgIHBlcnNvbmFEZXNjcmlwdGlvbjogY29uZmlnLm92ZXJyaWRlcz8ucGVyc29uYV9kZXNjcmlwdGlvbiA/PyBjaGFyYWN0ZXJJbmZvLnBlcnNvbmEsXG4gICAgY2hhcmFjdGVyRGVzY3JpcHRpb246IGNvbmZpZy5vdmVycmlkZXM/LmNoYXJfZGVzY3JpcHRpb24gPz8gY2hhcmFjdGVySW5mby5kZXNjcmlwdGlvbixcbiAgICBjaGFyYWN0ZXJQZXJzb25hbGl0eTogY29uZmlnLm92ZXJyaWRlcz8uY2hhcl9wZXJzb25hbGl0eSA/PyBjaGFyYWN0ZXJJbmZvLnBlcnNvbmFsaXR5LFxuICAgIGNoYXJhY3RlckRlcHRoUHJvbXB0OiBjaGFyYWN0ZXJJbmZvLmNoYXJEZXB0aFByb21wdCxcbiAgICBzY2VuYXJpbzogY29uZmlnLm92ZXJyaWRlcz8uc2NlbmFyaW8gPz8gY2hhcmFjdGVySW5mby5zY2VuYXJpbyxcbiAgICBjcmVhdG9yTm90ZXM6IGNoYXJhY3RlckluZm8uY3JlYXRvck5vdGVzLFxuICB9O1xuICBjb25zdCB7IHdvcmxkSW5mb1N0cmluZywgd29ybGRJbmZvQmVmb3JlLCB3b3JsZEluZm9BZnRlciwgd29ybGRJbmZvRXhhbXBsZXMsIHdvcmxkSW5mb0RlcHRoIH0gPVxuICAgIC8vIGdsb2JhbFNjYW5EYXRh5Y+q5Zyo5paw55qE6YWS6aaG54mI5pys5Lit5a2Y5ZyoXG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGF3YWl0IGdldFdvcmxkSW5mb1Byb21wdChjaGF0Rm9yV0ksIHRoaXNfbWF4X2NvbnRleHQsIGRyeVJ1biwgZ2xvYmFsU2NhbkRhdGEpO1xuXG4gIGF3YWl0IGNsZWFySW5qZWN0aW9uUHJvbXB0cyhbJ2N1c3RvbURlcHRoV0knXSk7XG5cbiAgaWYgKCFpc1Byb21wdEZpbHRlcmVkKCd3aXRoX2RlcHRoX2VudHJpZXMnLCBjb25maWcpKSB7XG4gICAgcHJvY2Vzc1dvcmxkSW5mb0RlcHRoKHdvcmxkSW5mb0RlcHRoKTtcbiAgfVxuXG4gIC8vIOWFiOajgOafpeaYr+WQpuiiq+i/h+a7pO+8jOWmguaenOiiq+i/h+a7pOebtOaOpei/lOWbnm51bGxcbiAgY29uc3QgZmluYWxXb3JsZEluZm9CZWZvcmUgPSBpc1Byb21wdEZpbHRlcmVkKCd3b3JsZF9pbmZvX2JlZm9yZScsIGNvbmZpZylcbiAgICA/IG51bGxcbiAgICA6IGNvbmZpZy5vdmVycmlkZXM/LndvcmxkX2luZm9fYmVmb3JlICE9PSB1bmRlZmluZWRcbiAgICA/IGNvbmZpZy5vdmVycmlkZXMud29ybGRfaW5mb19iZWZvcmVcbiAgICA6IHdvcmxkSW5mb0JlZm9yZTtcblxuICBjb25zdCBmaW5hbFdvcmxkSW5mb0FmdGVyID0gaXNQcm9tcHRGaWx0ZXJlZCgnd29ybGRfaW5mb19hZnRlcicsIGNvbmZpZylcbiAgICA/IG51bGxcbiAgICA6IGNvbmZpZy5vdmVycmlkZXM/LndvcmxkX2luZm9fYWZ0ZXIgIT09IHVuZGVmaW5lZFxuICAgID8gY29uZmlnLm92ZXJyaWRlcy53b3JsZF9pbmZvX2FmdGVyXG4gICAgOiB3b3JsZEluZm9BZnRlcjtcblxuICByZXR1cm4ge1xuICAgIHdvcmxkSW5mb1N0cmluZyxcbiAgICB3b3JsZEluZm9CZWZvcmU6IGZpbmFsV29ybGRJbmZvQmVmb3JlLFxuICAgIHdvcmxkSW5mb0FmdGVyOiBmaW5hbFdvcmxkSW5mb0FmdGVyLFxuICAgIHdvcmxkSW5mb0V4YW1wbGVzLFxuICAgIHdvcmxkSW5mb0RlcHRoOiAhaXNQcm9tcHRGaWx0ZXJlZCgnd2l0aF9kZXB0aF9lbnRyaWVzJywgY29uZmlnKSA/IHdvcmxkSW5mb0RlcHRoIDogbnVsbCxcbiAgfTtcbn1cbi8vIOWkhOeQhuS4lueVjOS/oeaBr+a3seW6pumDqOWIhlxuZnVuY3Rpb24gcHJvY2Vzc1dvcmxkSW5mb0RlcHRoKHdvcmxkSW5mb0RlcHRoOiBhbnlbXSkge1xuICBpZiAoQXJyYXkuaXNBcnJheSh3b3JsZEluZm9EZXB0aCkpIHtcbiAgICB3b3JsZEluZm9EZXB0aC5mb3JFYWNoKGVudHJ5ID0+IHtcbiAgICAgIGNvbnN0IGpvaW5lZEVudHJpZXMgPSBlbnRyeS5lbnRyaWVzLmpvaW4oJ1xcbicpO1xuICAgICAgc2V0RXh0ZW5zaW9uUHJvbXB0KFxuICAgICAgICBgY3VzdG9tRGVwdGhXSS0ke2VudHJ5LmRlcHRofS0ke2VudHJ5LnJvbGV9YCxcbiAgICAgICAgam9pbmVkRW50cmllcyxcbiAgICAgICAgZXh0ZW5zaW9uX3Byb21wdF90eXBlcy5JTl9DSEFULFxuICAgICAgICBlbnRyeS5kZXB0aCxcbiAgICAgICAgZmFsc2UsXG4gICAgICAgIGVudHJ5LnJvbGUsXG4gICAgICApO1xuICAgIH0pO1xuICB9XG59XG4vLyDlpITnkIbkuJbnlYzkuabkuK3npLrkvovliY3lkI5cbmFzeW5jIGZ1bmN0aW9uIHByb2Nlc3NNZXNzYWdlRXhhbXBsZXMobWVzRXhhbXBsZXNBcnJheTogc3RyaW5nW10sIHdvcmxkSW5mb0V4YW1wbGVzOiBhbnlbXSk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgLy8g5aSE55CG5LiW55WM5L+h5oGv5Lit55qE56S65L6LXG4gIGZvciAoY29uc3QgZXhhbXBsZSBvZiB3b3JsZEluZm9FeGFtcGxlcykge1xuICAgIGlmICghZXhhbXBsZS5jb250ZW50Lmxlbmd0aCkgY29udGludWU7XG5cbiAgICBjb25zdCBmb3JtYXR0ZWRFeGFtcGxlID0gYmFzZUNoYXRSZXBsYWNlKGV4YW1wbGUuY29udGVudCwgbmFtZTEsIG5hbWUyKTtcbiAgICBjb25zdCBjbGVhbmVkRXhhbXBsZSA9IHBhcnNlTWVzRXhhbXBsZXMoZm9ybWF0dGVkRXhhbXBsZSk7XG5cbiAgICBpZiAoZXhhbXBsZS5wb3NpdGlvbiA9PT0gd2lfYW5jaG9yX3Bvc2l0aW9uLmJlZm9yZSkge1xuICAgICAgbWVzRXhhbXBsZXNBcnJheS51bnNoaWZ0KC4uLmNsZWFuZWRFeGFtcGxlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgbWVzRXhhbXBsZXNBcnJheS5wdXNoKC4uLmNsZWFuZWRFeGFtcGxlKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gbWVzRXhhbXBsZXNBcnJheTtcbn1cbi8v5aSE55CG5a+56K+d56S65L6L5qC85byPXG5mdW5jdGlvbiBwYXJzZU1lc0V4YW1wbGVzKGV4YW1wbGVzU3RyOiBzdHJpbmcpIHtcbiAgaWYgKGV4YW1wbGVzU3RyLmxlbmd0aCA9PT0gMCB8fCBleGFtcGxlc1N0ciA9PT0gJzxTVEFSVD4nKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG5cbiAgaWYgKCFleGFtcGxlc1N0ci5zdGFydHNXaXRoKCc8U1RBUlQ+JykpIHtcbiAgICBleGFtcGxlc1N0ciA9ICc8U1RBUlQ+XFxuJyArIGV4YW1wbGVzU3RyLnRyaW0oKTtcbiAgfVxuICBjb25zdCBibG9ja0hlYWRpbmcgPSAnPFNUQVJUPlxcbic7XG4gIGNvbnN0IHNwbGl0RXhhbXBsZXMgPSBleGFtcGxlc1N0clxuICAgIC5zcGxpdCgvPFNUQVJUPi9naSlcbiAgICAuc2xpY2UoMSlcbiAgICAubWFwKGJsb2NrID0+IGAke2Jsb2NrSGVhZGluZ30ke2Jsb2NrLnRyaW0oKX1cXG5gKTtcblxuICByZXR1cm4gc3BsaXRFeGFtcGxlcztcbn1cbi8v55So5oi36L6T5YWl5YWI5q2j5YiZ5aSE55CGXG5mdW5jdGlvbiBwcm9jZXNzVXNlcklucHV0KHVzZXJfaW5wdXQ6IHN0cmluZykge1xuICBpZiAodXNlcl9pbnB1dCA9PT0gJycpIHtcbiAgICB1c2VyX2lucHV0ID0gb2FpX3NldHRpbmdzLnNlbmRfaWZfZW1wdHkudHJpbSgpO1xuICB9XG4gIHJldHVybiBnZXRSZWdleGVkU3RyaW5nKHVzZXJfaW5wdXQsIHJlZ2V4X3BsYWNlbWVudC5VU0VSX0lOUFVULCB7XG4gICAgaXNQcm9tcHQ6IHRydWUsXG4gICAgZGVwdGg6IDAsXG4gIH0pO1xufVxuLy/kvb/nlKjpooTorr5cbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZVByZXNldFBhdGgoXG4gIGJhc2VEYXRhOiBhbnksXG4gIHByb2Nlc3NlZFVzZXJJbnB1dDogc3RyaW5nLFxuICBjb25maWc6IE9taXQ8ZGV0YWlsLkdlbmVyYXRlUGFyYW1zLCAndXNlcl9pbnB1dCcgfCAndXNlX3ByZXNldCc+LFxuKSB7XG4gIC8vIHByZXBhcmVPcGVuQUlNZXNzYWdlc+S8muS7juiuvue9rumHjOivu+WPluWcuuaZr+WboOatpOS4tOaXtuimhuebllxuICBsZXQgb3JpZ2luYWxTY2VuYXJpbyA9IG51bGw7XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBzY2VuYXJpb092ZXJyaWRlID0gY29uZmlnPy5vdmVycmlkZXM/LnNjZW5hcmlvO1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBpZiAoc2NlbmFyaW9PdmVycmlkZSAmJiBjaGFyYWN0ZXJzICYmIGNoYXJhY3RlcnNbdGhpc19jaGlkXSkge1xuICAgICAgLy8g5L+d5a2Y5Y6f5aeL5Zy65pmvXG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICBvcmlnaW5hbFNjZW5hcmlvID0gY2hhcmFjdGVyc1t0aGlzX2NoaWRdLnNjZW5hcmlvIHx8IG51bGw7XG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICBjaGFyYWN0ZXJzW3RoaXNfY2hpZF0uc2NlbmFyaW8gPSBzY2VuYXJpb092ZXJyaWRlO1xuICAgIH1cbiAgICAvLyDmt7vliqB1c2Vy5raI5oGvKOS4gOasoeaApylcbiAgICBjb25zdCB1c2VyTWVzc2FnZVRlbXAgPSB7XG4gICAgICByb2xlOiAndXNlcicsXG4gICAgICBjb250ZW50OiBwcm9jZXNzZWRVc2VySW5wdXQsXG4gICAgICBpbWFnZTogY29uZmlnLmltYWdlLFxuICAgIH07XG5cbiAgICBpZiAoY29uZmlnLmltYWdlKSB7XG4gICAgICB1c2VyTWVzc2FnZVRlbXAuaW1hZ2UgPSBhd2FpdCBjb252ZXJ0RmlsZVRvQmFzZTY0KGNvbmZpZy5pbWFnZSk7XG4gICAgfVxuXG4gICAgYmFzZURhdGEuY2hhdENvbnRleHQub2FpTWVzc2FnZXMudW5zaGlmdCh1c2VyTWVzc2FnZVRlbXApO1xuXG4gICAgY29uc3QgbWVzc2FnZURhdGEgPSB7XG4gICAgICBuYW1lMixcbiAgICAgIGNoYXJEZXNjcmlwdGlvbjogYmFzZURhdGEuY2hhcmFjdGVySW5mby5kZXNjcmlwdGlvbixcbiAgICAgIGNoYXJQZXJzb25hbGl0eTogYmFzZURhdGEuY2hhcmFjdGVySW5mby5wZXJzb25hbGl0eSxcbiAgICAgIFNjZW5hcmlvOiBiYXNlRGF0YS5jaGFyYWN0ZXJJbmZvLnNjZW5hcmlvLFxuICAgICAgd29ybGRJbmZvQmVmb3JlOiBiYXNlRGF0YS53b3JsZEluZm8ud29ybGRJbmZvQmVmb3JlLFxuICAgICAgd29ybGRJbmZvQWZ0ZXI6IGJhc2VEYXRhLndvcmxkSW5mby53b3JsZEluZm9BZnRlcixcbiAgICAgIGV4dGVuc2lvblByb21wdHM6IGdldENvbnRleHQoKS5leHRlbnNpb25Qcm9tcHRzLFxuICAgICAgYmlhczogYmFzZURhdGEuY2hhdENvbnRleHQucHJvbXB0QmlhcyxcbiAgICAgIHR5cGU6ICdub3JtYWwnLFxuICAgICAgcXVpZXRQcm9tcHQ6ICcnLFxuICAgICAgcXVpZXRJbWFnZTogbnVsbCxcbiAgICAgIGN5Y2xlUHJvbXB0OiAnJyxcbiAgICAgIHN5c3RlbVByb21wdE92ZXJyaWRlOiBiYXNlRGF0YS5jaGFyYWN0ZXJJbmZvLnN5c3RlbSxcbiAgICAgIGphaWxicmVha1Byb21wdE92ZXJyaWRlOiBiYXNlRGF0YS5jaGFyYWN0ZXJJbmZvLmphaWxicmVhayxcbiAgICAgIHBlcnNvbmFEZXNjcmlwdGlvbjogYmFzZURhdGEuY2hhcmFjdGVySW5mby5wZXJzb25hLFxuICAgICAgbWVzc2FnZXM6IGJhc2VEYXRhLmNoYXRDb250ZXh0Lm9haU1lc3NhZ2VzLFxuICAgICAgbWVzc2FnZUV4YW1wbGVzOiBiYXNlRGF0YS5jaGF0Q29udGV4dC5vYWlNZXNzYWdlRXhhbXBsZXMsXG4gICAgfTtcblxuICAgIGNvbnN0IFtwcm9tcHRdID0gYXdhaXQgcHJlcGFyZU9wZW5BSU1lc3NhZ2VzKG1lc3NhZ2VEYXRhIGFzIGFueSwgZHJ5UnVuKTtcblxuICAgIHJldHVybiB7IHByb21wdCB9O1xuICB9IGZpbmFsbHkge1xuICAgIC8vIOaBouWkjeWOn+Wni+WcuuaZr1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBpZiAob3JpZ2luYWxTY2VuYXJpbyAhPT0gbnVsbCAmJiBjaGFyYWN0ZXJzICYmIGNoYXJhY3RlcnNbdGhpc19jaGlkXSkge1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgY2hhcmFjdGVyc1t0aGlzX2NoaWRdLnNjZW5hcmlvID0gb3JpZ2luYWxTY2VuYXJpbztcbiAgICB9XG4gIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gY29udmVydFN5c3RlbVByb21wdHNUb0NvbGxlY3Rpb24oXG4gIGJhc2VEYXRhOiBhbnksXG4gIHByb21wdENvbmZpZzogT21pdDxkZXRhaWwuR2VuZXJhdGVQYXJhbXMsICd1c2VyX2lucHV0JyB8ICd1c2VfcHJlc2V0Jz4sXG4pIHtcbiAgY29uc3QgcHJvbXB0Q29sbGVjdGlvbiA9IG5ldyBQcm9tcHRDb2xsZWN0aW9uKCk7XG4gIGNvbnN0IGV4YW1wbGVzQ29sbGVjdGlvbiA9IG5ldyBNZXNzYWdlQ29sbGVjdGlvbignZGlhbG9ndWVfZXhhbXBsZXMnKTtcblxuICBjb25zdCBvcmRlckFycmF5ID0gcHJvbXB0Q29uZmlnLm9yZGVyIHx8IGJ1aWx0aW5fcHJvbXB0X2RlZmF1bHRfb3JkZXI7XG5cbiAgY29uc3QgYnVpbHRpblByb21wdENvbnRlbnRzID0ge1xuICAgIHdvcmxkX2luZm9fYmVmb3JlOiBiYXNlRGF0YS53b3JsZEluZm8ud29ybGRJbmZvQmVmb3JlLFxuICAgIHBlcnNvbmFfZGVzY3JpcHRpb246XG4gICAgICBwb3dlcl91c2VyLnBlcnNvbmFfZGVzY3JpcHRpb24gJiZcbiAgICAgIHBvd2VyX3VzZXIucGVyc29uYV9kZXNjcmlwdGlvbl9wb3NpdGlvbiA9PT0gcGVyc29uYV9kZXNjcmlwdGlvbl9wb3NpdGlvbnMuSU5fUFJPTVBUXG4gICAgICAgID8gYmFzZURhdGEuY2hhcmFjdGVySW5mby5wZXJzb25hXG4gICAgICAgIDogbnVsbCxcbiAgICBjaGFyX2Rlc2NyaXB0aW9uOiBiYXNlRGF0YS5jaGFyYWN0ZXJJbmZvLmRlc2NyaXB0aW9uLFxuICAgIGNoYXJfcGVyc29uYWxpdHk6IGJhc2VEYXRhLmNoYXJhY3RlckluZm8ucGVyc29uYWxpdHksXG4gICAgc2NlbmFyaW86IGJhc2VEYXRhLmNoYXJhY3RlckluZm8uc2NlbmFyaW8sXG4gICAgd29ybGRfaW5mb19hZnRlcjogYmFzZURhdGEud29ybGRJbmZvLndvcmxkSW5mb0FmdGVyLFxuICB9O1xuXG4gIGZvciAoY29uc3QgW2luZGV4LCBpdGVtXSBvZiBvcmRlckFycmF5LmVudHJpZXMoKSkge1xuICAgIGlmICh0eXBlb2YgaXRlbSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIC8vIOWkhOeQhuWGhee9ruaPkOekuuivjVxuICAgICAgY29uc3QgY29udGVudCA9IGJ1aWx0aW5Qcm9tcHRDb250ZW50c1tpdGVtIGFzIGtleW9mIHR5cGVvZiBidWlsdGluUHJvbXB0Q29udGVudHNdO1xuICAgICAgaWYgKGNvbnRlbnQpIHtcbiAgICAgICAgcHJvbXB0Q29sbGVjdGlvbi5hZGQoXG4gICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgIG5ldyBQcm9tcHQoe1xuICAgICAgICAgICAgaWRlbnRpZmllcjogaXRlbSxcbiAgICAgICAgICAgIHJvbGU6ICdzeXN0ZW0nLFxuICAgICAgICAgICAgY29udGVudDogY29udGVudCxcbiAgICAgICAgICAgIHN5c3RlbV9wcm9tcHQ6IHRydWUsXG4gICAgICAgICAgfSksXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgaXRlbSA9PT0gJ29iamVjdCcgJiYgaXRlbS5yb2xlICYmIGl0ZW0uY29udGVudCkge1xuICAgICAgLy8g5aSE55CG6Ieq5a6a5LmJ5rOo5YWlXG4gICAgICBjb25zdCBpZGVudGlmaWVyID0gYGN1c3RvbV9wcm9tcHRfJHtpbmRleH1gO1xuICAgICAgcHJvbXB0Q29sbGVjdGlvbi5hZGQoXG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgbmV3IFByb21wdCh7XG4gICAgICAgICAgaWRlbnRpZmllcjogaWRlbnRpZmllcixcbiAgICAgICAgICByb2xlOiBpdGVtLnJvbGUsXG4gICAgICAgICAgY29udGVudDogaXRlbS5jb250ZW50LFxuICAgICAgICAgIHN5c3RlbV9wcm9tcHQ6IGl0ZW0ucm9sZSA9PT0gJ3N5c3RlbScsXG4gICAgICAgIH0pLFxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICBpZiAoYmFzZURhdGEuY2hhdENvbnRleHQub2FpTWVzc2FnZUV4YW1wbGVzLmxlbmd0aCA+IDApIHtcbiAgICAvLyDpgY3ljobmiYDmnInlr7nor53npLrkvotcbiAgICBmb3IgKGNvbnN0IGRpYWxvZ3VlIG9mIFsuLi5iYXNlRGF0YS5jaGF0Q29udGV4dC5vYWlNZXNzYWdlRXhhbXBsZXNdKSB7XG4gICAgICBjb25zdCBkaWFsb2d1ZUluZGV4ID0gYmFzZURhdGEuY2hhdENvbnRleHQub2FpTWVzc2FnZUV4YW1wbGVzLmluZGV4T2YoZGlhbG9ndWUpO1xuICAgICAgY29uc3QgY2hhdE1lc3NhZ2VzID0gW107XG5cbiAgICAgIGZvciAobGV0IHByb21wdEluZGV4ID0gMDsgcHJvbXB0SW5kZXggPCBkaWFsb2d1ZS5sZW5ndGg7IHByb21wdEluZGV4KyspIHtcbiAgICAgICAgY29uc3QgcHJvbXB0ID0gZGlhbG9ndWVbcHJvbXB0SW5kZXhdO1xuICAgICAgICBjb25zdCByb2xlID0gJ3N5c3RlbSc7XG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSBwcm9tcHQuY29udGVudCB8fCAnJztcbiAgICAgICAgY29uc3QgaWRlbnRpZmllciA9IGBkaWFsb2d1ZV9leGFtcGxlcyAke2RpYWxvZ3VlSW5kZXh9LSR7cHJvbXB0SW5kZXh9YDtcblxuICAgICAgICBjb25zdCBjaGF0TWVzc2FnZSA9IGF3YWl0IE1lc3NhZ2UuY3JlYXRlQXN5bmMocm9sZSwgY29udGVudCwgaWRlbnRpZmllcik7XG4gICAgICAgIGF3YWl0IGNoYXRNZXNzYWdlLnNldE5hbWUocHJvbXB0Lm5hbWUpO1xuICAgICAgICBjaGF0TWVzc2FnZXMucHVzaChjaGF0TWVzc2FnZSk7XG4gICAgICB9XG4gICAgICBmb3IgKGNvbnN0IG1lc3NhZ2Ugb2YgY2hhdE1lc3NhZ2VzKSB7XG4gICAgICAgIGV4YW1wbGVzQ29sbGVjdGlvbi5hZGQobWVzc2FnZSk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiB7XG4gICAgc3lzdGVtUHJvbXB0czogcHJvbXB0Q29sbGVjdGlvbixcbiAgICBkaWFsb2d1ZV9leGFtcGxlczogZXhhbXBsZXNDb2xsZWN0aW9uLFxuICB9O1xufVxuXG4vL+S4jeS9v+eUqOmihOiuvlxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlQ3VzdG9tUGF0aChcbiAgYmFzZURhdGE6IGFueSxcbiAgY29uZmlnOiBPbWl0PGRldGFpbC5HZW5lcmF0ZVBhcmFtcywgJ3VzZXJfaW5wdXQnIHwgJ3VzZV9wcmVzZXQnPixcbiAgcHJvY2Vzc2VkVXNlcklucHV0OiBzdHJpbmcsXG4pIHtcbiAgY29uc3QgY2hhdENvbXBsZXRpb24gPSBuZXcgQ2hhdENvbXBsZXRpb24oKTtcbiAgY2hhdENvbXBsZXRpb24uc2V0VG9rZW5CdWRnZXQob2FpX3NldHRpbmdzLm9wZW5haV9tYXhfY29udGV4dCwgb2FpX3NldHRpbmdzLm9wZW5haV9tYXhfdG9rZW5zKTtcbiAgY2hhdENvbXBsZXRpb24ucmVzZXJ2ZUJ1ZGdldCgzKTtcbiAgY29uc3Qgb3JkZXJBcnJheSA9IGNvbmZpZy5vcmRlciB8fCBkZWZhdWx0X29yZGVyO1xuICBjb25zdCBwb3NpdGlvbk1hcDogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IG9yZGVyQXJyYXkucmVkdWNlKChhY2M6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4sIGl0ZW0sIGluZGV4KSA9PiB7XG4gICAgaWYgKHR5cGVvZiBpdGVtID09PSAnc3RyaW5nJykge1xuICAgICAgYWNjW2l0ZW0udG9Mb3dlckNhc2UoKV0gPSBpbmRleDtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBpdGVtID09PSAnb2JqZWN0Jykge1xuICAgICAgYWNjW2BjdXN0b21fcHJvbXB0XyR7aW5kZXh9YF0gPSBpbmRleDtcbiAgICB9XG4gICAgcmV0dXJuIGFjYztcbiAgfSwge30pO1xuXG4gIC8v6L2s5o2i5Li66ZuG5ZCIXG4gIGNvbnN0IHsgc3lzdGVtUHJvbXB0cywgZGlhbG9ndWVfZXhhbXBsZXMgfSA9IGF3YWl0IGNvbnZlcnRTeXN0ZW1Qcm9tcHRzVG9Db2xsZWN0aW9uKGJhc2VEYXRhLCBjb25maWcpO1xuICBjb25zdCBhZGRUb0NoYXRDb21wbGV0aW9uSW5PcmRlciA9IGFzeW5jIChzb3VyY2U6IGFueSwgaW5kZXg6IG51bWJlcikgPT4ge1xuICAgIGlmICh0eXBlb2Ygc291cmNlID09PSAnb2JqZWN0Jykge1xuICAgICAgLy8g5aSE55CG6Ieq5a6a5LmJ5rOo5YWlXG4gICAgICBjb25zdCBjb2xsZWN0aW9uID0gbmV3IE1lc3NhZ2VDb2xsZWN0aW9uKGBjdXN0b21fcHJvbXB0XyR7aW5kZXh9YCk7XG4gICAgICBjb25zdCBtZXNzYWdlID0gYXdhaXQgTWVzc2FnZS5jcmVhdGVBc3luYyhzb3VyY2Uucm9sZSwgc291cmNlLmNvbnRlbnQsIGBjdXN0b21fcHJvbXB0XyR7aW5kZXh9YCk7XG4gICAgICBjb2xsZWN0aW9uLmFkZChtZXNzYWdlKTtcbiAgICAgIGNoYXRDb21wbGV0aW9uLmFkZChjb2xsZWN0aW9uLCBpbmRleCk7XG4gICAgfSBlbHNlIGlmIChzeXN0ZW1Qcm9tcHRzLmhhcyhzb3VyY2UpKSB7XG4gICAgICAvLyDlpITnkIbmma7pgJrmj5DnpLror41cbiAgICAgIGNvbnN0IHByb21wdCA9IHN5c3RlbVByb21wdHMuZ2V0KHNvdXJjZSk7XG4gICAgICBjb25zdCBjb2xsZWN0aW9uID0gbmV3IE1lc3NhZ2VDb2xsZWN0aW9uKHNvdXJjZSk7XG4gICAgICBjb25zdCBtZXNzYWdlID0gYXdhaXQgTWVzc2FnZS5mcm9tUHJvbXB0QXN5bmMocHJvbXB0KTtcbiAgICAgIGNvbGxlY3Rpb24uYWRkKG1lc3NhZ2UpO1xuICAgICAgY2hhdENvbXBsZXRpb24uYWRkKGNvbGxlY3Rpb24sIHBvc2l0aW9uTWFwW3NvdXJjZV0pO1xuICAgIH1cbiAgfTtcblxuICAvLyDlpITnkIbmiYDmnInnsbvlnovnmoTmj5DnpLror41cbiAgZm9yIChjb25zdCBbaW5kZXgsIGl0ZW1dIG9mIG9yZGVyQXJyYXkuZW50cmllcygpKSB7XG4gICAgaWYgKHR5cGVvZiBpdGVtID09PSAnc3RyaW5nJykge1xuICAgICAgaWYgKCFpc1Byb21wdEZpbHRlcmVkKGl0ZW0sIGNvbmZpZykpIHtcbiAgICAgICAgYXdhaXQgYWRkVG9DaGF0Q29tcGxldGlvbkluT3JkZXIoaXRlbSwgaW5kZXgpO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodHlwZW9mIGl0ZW0gPT09ICdvYmplY3QnICYmIGl0ZW0ucm9sZSAmJiBpdGVtLmNvbnRlbnQpIHtcbiAgICAgIGF3YWl0IGFkZFRvQ2hhdENvbXBsZXRpb25Jbk9yZGVyKGl0ZW0sIGluZGV4KTtcbiAgICB9XG4gIH1cblxuICBjb25zdCBkaWFsb2d1ZV9leGFtcGxlc0luZGV4ID0gb3JkZXJBcnJheS5maW5kSW5kZXgoXG4gICAgaXRlbSA9PiB0eXBlb2YgaXRlbSA9PT0gJ3N0cmluZycgJiYgaXRlbS50b0xvd2VyQ2FzZSgpID09PSAnZGlhbG9ndWVfZXhhbXBsZXMnLFxuICApO1xuXG4gIGlmIChkaWFsb2d1ZV9leGFtcGxlc0luZGV4ICE9PSAtMSAmJiAhaXNQcm9tcHRGaWx0ZXJlZCgnZGlhbG9ndWVfZXhhbXBsZXMnLCBjb25maWcpKSB7XG4gICAgY2hhdENvbXBsZXRpb24uYWRkKGRpYWxvZ3VlX2V4YW1wbGVzLCBkaWFsb2d1ZV9leGFtcGxlc0luZGV4KTtcbiAgfVxuICAvL+e7mXVzZXLovpPlhaXpooTnlZl0b2tlblxuICBjb25zdCB1c2VySW5wdXRNZXNzYWdlID0gYXdhaXQgTWVzc2FnZS5jcmVhdGVBc3luYygndXNlcicsIHByb2Nlc3NlZFVzZXJJbnB1dCwgJ3VzZXJfaW5wdXQnKTtcbiAgY2hhdENvbXBsZXRpb24ucmVzZXJ2ZUJ1ZGdldCh1c2VySW5wdXRNZXNzYWdlKTtcblxuICBhd2FpdCBwcm9jZXNzQ2hhdEhpc3RvcnlBbmRJbmplY3QoYmFzZURhdGEsIGNvbmZpZywgY2hhdENvbXBsZXRpb24sIHByb2Nlc3NlZFVzZXJJbnB1dCk7XG4gIGNoYXRDb21wbGV0aW9uLmZyZWVCdWRnZXQodXNlcklucHV0TWVzc2FnZSk7XG5cbiAgLy/moLnmja7lvZPliY3pooTorr7lhrPlrprmmK/lkKblkIjlubbov57nu63ns7vnu59yb2xl5raI5oGvXG4gIGlmIChvYWlfc2V0dGluZ3Muc3F1YXNoX3N5c3RlbV9tZXNzYWdlcykge1xuICAgIGF3YWl0IGNoYXRDb21wbGV0aW9uLnNxdWFzaFN5c3RlbU1lc3NhZ2VzKCk7XG4gIH1cbiAgY29uc3QgcHJvbXB0ID0gY2hhdENvbXBsZXRpb24uZ2V0Q2hhdCgpO1xuICByZXR1cm4geyBwcm9tcHQgfTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gcHJvY2Vzc0NoYXRIaXN0b3J5QW5kSW5qZWN0KFxuICBiYXNlRGF0YTogYW55LFxuICBwcm9tcHRDb25maWc6IE9taXQ8ZGV0YWlsLkdlbmVyYXRlUGFyYW1zLCAndXNlcl9pbnB1dCcgfCAndXNlX3ByZXNldCc+LFxuICBjaGF0Q29tcGxldGlvbjogQ2hhdENvbXBsZXRpb24sXG4gIHByb2Nlc3NlZFVzZXJJbnB1dDogc3RyaW5nLFxuKSB7XG4gIGNvbnN0IG9yZGVyQXJyYXkgPSBwcm9tcHRDb25maWcub3JkZXIgfHwgZGVmYXVsdF9vcmRlcjtcbiAgY29uc3QgY2hhdEhpc3RvcnlJbmRleCA9IG9yZGVyQXJyYXkuZmluZEluZGV4KFxuICAgIGl0ZW0gPT4gdHlwZW9mIGl0ZW0gPT09ICdzdHJpbmcnICYmIGl0ZW0udG9Mb3dlckNhc2UoKSA9PT0gJ2NoYXRfaGlzdG9yeScsXG4gICk7XG4gIGNvbnN0IHVzZXJJbnB1dEluZGV4ID0gb3JkZXJBcnJheS5maW5kSW5kZXgoaXRlbSA9PiB0eXBlb2YgaXRlbSA9PT0gJ3N0cmluZycgJiYgaXRlbS50b0xvd2VyQ2FzZSgpID09PSAndXNlcl9pbnB1dCcpO1xuXG4gIGNvbnN0IGhhc1VzZXJJbnB1dCA9IHVzZXJJbnB1dEluZGV4ICE9PSAtMTtcbiAgY29uc3QgaGFzQ2hhdEhpc3RvcnkgPSBjaGF0SGlzdG9yeUluZGV4ICE9PSAtMTtcbiAgY29uc3QgaXNDaGF0SGlzdG9yeUZpbHRlcmVkID0gaXNQcm9tcHRGaWx0ZXJlZCgnY2hhdF9oaXN0b3J5JywgcHJvbXB0Q29uZmlnKTtcblxuICAvLyDliJvlu7rnlKjmiLfovpPlhaXmtojmga9cbiAgY29uc3QgdXNlck1lc3NhZ2UgPSBhd2FpdCBNZXNzYWdlLmNyZWF0ZUFzeW5jKCd1c2VyJywgcHJvY2Vzc2VkVXNlcklucHV0LCAndXNlcl9pbnB1dCcpO1xuXG4gIGlmIChwcm9tcHRDb25maWcuaW1hZ2UgJiYgaGFzVXNlcklucHV0KSB7XG4gICAgYXdhaXQgdXNlck1lc3NhZ2UuYWRkSW1hZ2UoYXdhaXQgY29udmVydEZpbGVUb0Jhc2U2NChwcm9tcHRDb25maWcuaW1hZ2UpKTtcbiAgfVxuXG4gIC8vIOWmguaenOiBiuWkqeiusOW9leiiq+i/h+a7pOaIluS4jeWcqG9yZGVy5Lit77yM5Y+q5aSE55CG55So5oi36L6T5YWlXG4gIGlmIChpc0NoYXRIaXN0b3J5RmlsdGVyZWQgfHwgIWhhc0NoYXRIaXN0b3J5KSB7XG4gICAgY29uc3QgaW5zZXJ0SW5kZXggPSBoYXNVc2VySW5wdXQgPyB1c2VySW5wdXRJbmRleCA6IG9yZGVyQXJyYXkubGVuZ3RoO1xuICAgIGNoYXRDb21wbGV0aW9uLmFkZChuZXcgTWVzc2FnZUNvbGxlY3Rpb24oJ3VzZXJfaW5wdXQnLCB1c2VyTWVzc2FnZSksIGluc2VydEluZGV4KTtcbiAgICByZXR1cm47XG4gIH1cblxuICAvLyDlpITnkIbogYrlpKnorrDlvZVcbiAgY29uc3QgY2hhdENvbGxlY3Rpb24gPSBuZXcgTWVzc2FnZUNvbGxlY3Rpb24oJ2NoYXRfaGlzdG9yeScpO1xuXG4gIC8vIOS4uuaWsOiBiuWkqeaMh+ekuumihOeVmXRva2VuXG4gIGNvbnN0IG5ld0NoYXQgPSBvYWlfc2V0dGluZ3MubmV3X2NoYXRfcHJvbXB0O1xuICBjb25zdCBuZXdDaGF0TWVzc2FnZSA9IGF3YWl0IE1lc3NhZ2UuY3JlYXRlQXN5bmMoJ3N5c3RlbScsIHN1YnN0aXR1dGVQYXJhbXMobmV3Q2hhdCksICduZXdNYWluQ2hhdCcpO1xuICBjaGF0Q29tcGxldGlvbi5yZXNlcnZlQnVkZ2V0KG5ld0NoYXRNZXNzYWdlKTtcblxuICAvLyDmt7vliqDmlrDogYrlpKnmj5DnpLror43liLDpm4blkIjnmoTmnIDliY3pnaJcbiAgY2hhdENvbGxlY3Rpb24uYWRkKG5ld0NoYXRNZXNzYWdlKTtcblxuICAvLyDlpITnkIbnqbrmtojmga/mm7/mjaJcbiAgY29uc3QgbGFzdENoYXRQcm9tcHQgPSBiYXNlRGF0YS5jaGF0Q29udGV4dC5vYWlNZXNzYWdlc1tiYXNlRGF0YS5jaGF0Q29udGV4dC5vYWlNZXNzYWdlcy5sZW5ndGggLSAxXTtcbiAgY29uc3QgZW1wdHlNZXNzYWdlID0gYXdhaXQgTWVzc2FnZS5jcmVhdGVBc3luYygndXNlcicsIG9haV9zZXR0aW5ncy5zZW5kX2lmX2VtcHR5LCAnZW1wdHlVc2VyTWVzc2FnZVJlcGxhY2VtZW50Jyk7XG5cbiAgaWYgKFxuICAgIGxhc3RDaGF0UHJvbXB0ICYmXG4gICAgbGFzdENoYXRQcm9tcHQucm9sZSA9PT0gJ2Fzc2lzdGFudCcgJiZcbiAgICBvYWlfc2V0dGluZ3Muc2VuZF9pZl9lbXB0eSAmJlxuICAgIGNoYXRDb21wbGV0aW9uLmNhbkFmZm9yZChlbXB0eU1lc3NhZ2UpXG4gICkge1xuICAgIGNoYXRDb2xsZWN0aW9uLmFkZChlbXB0eU1lc3NhZ2UpO1xuICB9XG5cbiAgLy8g5bCG55So5oi35raI5oGv5re75Yqg5Yiw5raI5oGv5pWw57uE5Lit5YeG5aSH5aSE55CG5rOo5YWlXG4gIGlmICghaGFzVXNlcklucHV0KSB7XG4gICAgY29uc3QgdXNlclByb21wdCA9IHtcbiAgICAgIHJvbGU6ICd1c2VyJyxcbiAgICAgIGNvbnRlbnQ6IHByb2Nlc3NlZFVzZXJJbnB1dCxcbiAgICAgIGlkZW50aWZpZXI6ICd1c2VyX2lucHV0JyxcbiAgICAgIGltYWdlOiBwcm9tcHRDb25maWcuaW1hZ2UgPyBhd2FpdCBjb252ZXJ0RmlsZVRvQmFzZTY0KHByb21wdENvbmZpZy5pbWFnZSkgOiB1bmRlZmluZWQsXG4gICAgfTtcbiAgICBiYXNlRGF0YS5jaGF0Q29udGV4dC5vYWlNZXNzYWdlcy51bnNoaWZ0KHVzZXJQcm9tcHQpO1xuICB9XG5cbiAgLy8g5aSE55CG5rOo5YWl5ZKM5re75Yqg5raI5oGvXG4gIGNvbnN0IG1lc3NhZ2VzID0gKFxuICAgIGF3YWl0IHBvcHVsYXRpb25JbmplY3Rpb25Qcm9tcHRzKGJhc2VEYXRhLCBiYXNlRGF0YS5jaGF0Q29udGV4dC5vYWlNZXNzYWdlcywgcHJvbXB0Q29uZmlnLmluamVjdCwgcHJvbXB0Q29uZmlnKVxuICApLnJldmVyc2UoKTtcbiAgY29uc3QgaW1hZ2VJbmxpbmluZyA9IGlzSW1hZ2VJbmxpbmluZ1N1cHBvcnRlZCgpO1xuICAvLyDmt7vliqDogYrlpKnorrDlvZVcbiAgY29uc3QgY2hhdFBvb2wgPSBbLi4ubWVzc2FnZXNdO1xuICBmb3IgKGNvbnN0IGNoYXRQcm9tcHQgb2YgY2hhdFBvb2wpIHtcbiAgICBjb25zdCBwcm9tcHQgPSBuZXcgUHJvbXB0KGNoYXRQcm9tcHQgYXMgYW55KTtcbiAgICBwcm9tcHQuaWRlbnRpZmllciA9IGBjaGF0X2hpc3RvcnktJHttZXNzYWdlcy5sZW5ndGggLSBjaGF0UG9vbC5pbmRleE9mKGNoYXRQcm9tcHQpfWA7XG4gICAgcHJvbXB0LmNvbnRlbnQgPSBzdWJzdGl0dXRlUGFyYW1zKHByb21wdC5jb250ZW50KTtcblxuICAgIGNvbnN0IGNoYXRNZXNzYWdlID0gYXdhaXQgTWVzc2FnZS5mcm9tUHJvbXB0QXN5bmMocHJvbXB0KTtcbiAgICBjb25zdCBwcm9tcHRNYW5hZ2VyID0gc2V0dXBDaGF0Q29tcGxldGlvblByb21wdE1hbmFnZXIob2FpX3NldHRpbmdzKTtcblxuICAgIGlmIChwcm9tcHRNYW5hZ2VyKSB7XG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICBpZiAocHJvbXB0TWFuYWdlci5zZXJ2aWNlU2V0dGluZ3MubmFtZXNfYmVoYXZpb3IgPT09IGNoYXJhY3Rlcl9uYW1lc19iZWhhdmlvci5DT01QTEVUSU9OICYmIHByb21wdC5uYW1lKSB7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2VOYW1lID0gcHJvbXB0TWFuYWdlci5pc1ZhbGlkTmFtZShwcm9tcHQubmFtZSlcbiAgICAgICAgICA/IHByb21wdC5uYW1lXG4gICAgICAgICAgOiBwcm9tcHRNYW5hZ2VyLnNhbml0aXplTmFtZShwcm9tcHQubmFtZSk7XG4gICAgICAgIGF3YWl0IGNoYXRNZXNzYWdlLnNldE5hbWUobWVzc2FnZU5hbWUpO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoaW1hZ2VJbmxpbmluZyAmJiBjaGF0UHJvbXB0LmltYWdlKSB7XG4gICAgICBhd2FpdCBjaGF0TWVzc2FnZS5hZGRJbWFnZShjaGF0UHJvbXB0LmltYWdlIGFzIHN0cmluZyk7XG4gICAgfVxuICAgIGlmIChjaGF0Q29tcGxldGlvbi5jYW5BZmZvcmQoY2hhdE1lc3NhZ2UpKSB7XG4gICAgICBjaGF0Q29sbGVjdGlvbi5hZGQoY2hhdE1lc3NhZ2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICAvLyDph4rmlL7mlrDogYrlpKnmj5DnpLror43nmoTpooTnlZl0b2tlblxuICBjaGF0Q29tcGxldGlvbi5mcmVlQnVkZ2V0KG5ld0NoYXRNZXNzYWdlKTtcblxuICBpZiAoaGFzVXNlcklucHV0KSB7XG4gICAgLy8g5oyJ5ZCE6Ieq5Zyob3JkZXLkuK3nmoTkvY3nva7mt7vliqDogYrlpKnorrDlvZXlkoznlKjmiLfovpPlhaVcbiAgICBjaGF0Q29tcGxldGlvbi5hZGQoY2hhdENvbGxlY3Rpb24sIGNoYXRIaXN0b3J5SW5kZXgpO1xuICAgIGNoYXRDb21wbGV0aW9uLmFkZChuZXcgTWVzc2FnZUNvbGxlY3Rpb24oJ3VzZXJfaW5wdXQnLCB1c2VyTWVzc2FnZSksIHVzZXJJbnB1dEluZGV4KTtcbiAgfSBlbHNlIHtcbiAgICAvLyDogYrlpKnorrDlvZXkuK3lt7LljIXlkKvnlKjmiLfovpPlhaXvvIznm7TmjqXmt7vliqDliLBjaGF0X2hpc3RvcnnkvY3nva5cbiAgICBjaGF0Q29tcGxldGlvbi5hZGQoY2hhdENvbGxlY3Rpb24sIGNoYXRIaXN0b3J5SW5kZXgpO1xuICB9XG59XG5hc3luYyBmdW5jdGlvbiBwb3B1bGF0aW9uSW5qZWN0aW9uUHJvbXB0cyhcbiAgYmFzZURhdGE6IEJhc2VEYXRhLFxuICBtZXNzYWdlczogUm9sZVByb21wdFtdLFxuICBjdXN0b21JbmplY3RzOiBJbmplY3Rpb25Qcm9tcHRbXSA9IFtdLFxuICBjb25maWc6IE9taXQ8ZGV0YWlsLkdlbmVyYXRlUGFyYW1zLCAndXNlcl9pbnB1dCcgfCAndXNlX3ByZXNldCc+LFxuKSB7XG4gIGNvbnN0IHByb2Nlc3NlZE1lc3NhZ2VzID0gWy4uLm1lc3NhZ2VzXTtcbiAgbGV0IHRvdGFsSW5zZXJ0ZWRNZXNzYWdlcyA9IDA7XG4gIGNvbnN0IGluamVjdGlvblByb21wdHMgPSBbXTtcbiAgLy8gQHRzLWlnbm9yZVxuXG4gIGNvbnN0IGF1dGhvcnNOb3RlID0gZ2V0Q29udGV4dCgpLmV4dGVuc2lvblByb21wdHNbTk9URV9NT0RVTEVfTkFNRV07XG4gIGlmIChhdXRob3JzTm90ZSAmJiBhdXRob3JzTm90ZS52YWx1ZSkge1xuICAgIGluamVjdGlvblByb21wdHMucHVzaCh7XG4gICAgICByb2xlOiBnZXRQcm9tcHRSb2xlKGF1dGhvcnNOb3RlLnJvbGUpLFxuICAgICAgY29udGVudDogYXV0aG9yc05vdGUudmFsdWUsXG4gICAgICBpZGVudGlmaWVyOiAnYXV0aG9yc05vdGUnLFxuICAgICAgaW5qZWN0aW9uX2RlcHRoOiBhdXRob3JzTm90ZS5kZXB0aCxcbiAgICAgIGluamVjdGVkOiB0cnVlLFxuICAgIH0pO1xuICB9XG5cbiAgaWYgKFxuICAgIHBvd2VyX3VzZXIucGVyc29uYV9kZXNjcmlwdGlvbiAmJlxuICAgIHBvd2VyX3VzZXIucGVyc29uYV9kZXNjcmlwdGlvbl9wb3NpdGlvbiA9PT0gcGVyc29uYV9kZXNjcmlwdGlvbl9wb3NpdGlvbnMuQVRfREVQVEhcbiAgKSB7XG4gICAgaW5qZWN0aW9uUHJvbXB0cy5wdXNoKHtcbiAgICAgIHJvbGU6ICdzeXN0ZW0nLFxuICAgICAgY29udGVudDogcG93ZXJfdXNlci5wZXJzb25hX2Rlc2NyaXB0aW9uLFxuICAgICAgaWRlbnRpZmllcjogJ3BlcnNvbmFfZGVzY3JpcHRpb24nLFxuICAgICAgaW5qZWN0aW9uX2RlcHRoOiBwb3dlcl91c2VyLnBlcnNvbmFfZGVzY3JpcHRpb25fZGVwdGgsXG4gICAgICBpbmplY3RlZDogdHJ1ZSxcbiAgICB9KTtcbiAgfVxuXG4gIGlmICghaXNQcm9tcHRGaWx0ZXJlZCgnY2hhcl9kZXB0aF9wcm9tcHQnLCBjb25maWcpKSB7XG4gICAgY29uc3Qgd2lEZXB0aFByb21wdCA9IGJhc2VEYXRhLndvcmxkSW5mby53b3JsZEluZm9EZXB0aDtcbiAgICBpZiAod2lEZXB0aFByb21wdCkge1xuICAgICAgZm9yIChjb25zdCBlbnRyeSBvZiB3aURlcHRoUHJvbXB0KSB7XG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCBnZXRFeHRlbnNpb25Qcm9tcHRCeU5hbWUoYGN1c3RvbURlcHRoV0ktJHtlbnRyeS5kZXB0aH0tJHtlbnRyeS5yb2xlfWApO1xuICAgICAgICBpbmplY3Rpb25Qcm9tcHRzLnB1c2goe1xuICAgICAgICAgIHJvbGU6IGdldFByb21wdFJvbGUoZW50cnkucm9sZSksXG4gICAgICAgICAgY29udGVudDogY29udGVudCxcbiAgICAgICAgICBpbmplY3Rpb25fZGVwdGg6IGVudHJ5LmRlcHRoLFxuICAgICAgICAgIGluamVjdGVkOiB0cnVlLFxuICAgICAgICB9KTtcbiAgICAgICAgbG9nLmluZm8oJ2luamVjdGlvblByb21wdHMnLCBpbmplY3Rpb25Qcm9tcHRzKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyDlpITnkIboh6rlrprkuYnms6jlhaVcbiAgaWYgKEFycmF5LmlzQXJyYXkoY3VzdG9tSW5qZWN0cykpIHtcbiAgICBmb3IgKGNvbnN0IGluamVjdCBvZiBjdXN0b21JbmplY3RzKSB7XG4gICAgICBpbmplY3Rpb25Qcm9tcHRzLnB1c2goe1xuICAgICAgICBpZGVudGlmaWVyOiBgSU5KRUNUSU9OLSR7aW5qZWN0LnJvbGV9LSR7aW5qZWN0LmRlcHRofWAsXG4gICAgICAgIHJvbGU6IGluamVjdC5yb2xlLFxuICAgICAgICBjb250ZW50OiBpbmplY3QuY29udGVudCxcbiAgICAgICAgaW5qZWN0aW9uX2RlcHRoOiBpbmplY3QuZGVwdGggfHwgMCxcbiAgICAgICAgaW5qZWN0ZWQ6IHRydWUsXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBmb3IgKGxldCBpID0gMDsgaSA8PSBNQVhfSU5KRUNUSU9OX0RFUFRIOyBpKyspIHtcbiAgICBjb25zdCBkZXB0aFByb21wdHMgPSBpbmplY3Rpb25Qcm9tcHRzLmZpbHRlcihwcm9tcHQgPT4gcHJvbXB0LmluamVjdGlvbl9kZXB0aCA9PT0gaSAmJiBwcm9tcHQuY29udGVudCk7XG5cbiAgICBjb25zdCByb2xlcyA9IFsnc3lzdGVtJywgJ3VzZXInLCAnYXNzaXN0YW50J107XG4gICAgY29uc3Qgcm9sZU1lc3NhZ2VzID0gW107XG4gICAgY29uc3Qgc2VwYXJhdG9yID0gJ1xcbic7XG5cbiAgICBmb3IgKGNvbnN0IHJvbGUgb2Ygcm9sZXMpIHtcbiAgICAgIC8vIOebtOaOpeWkhOeQhuW9k+WJjea3seW6puWSjOinkuiJsueahOaJgOacieaPkOekuuivjVxuICAgICAgY29uc3Qgcm9sZVByb21wdHMgPSBkZXB0aFByb21wdHNcbiAgICAgICAgLmZpbHRlcihwcm9tcHQgPT4gcHJvbXB0LnJvbGUgPT09IHJvbGUpXG4gICAgICAgIC5tYXAoeCA9PiB4LmNvbnRlbnQudHJpbSgpKVxuICAgICAgICAuam9pbihzZXBhcmF0b3IpO1xuXG4gICAgICBpZiAocm9sZVByb21wdHMpIHtcbiAgICAgICAgcm9sZU1lc3NhZ2VzLnB1c2goe1xuICAgICAgICAgIHJvbGU6IHJvbGUgYXMgJ3VzZXInIHwgJ3N5c3RlbScgfCAnYXNzaXN0YW50JyxcbiAgICAgICAgICBjb250ZW50OiByb2xlUHJvbXB0cyxcbiAgICAgICAgICBpbmplY3RlZDogdHJ1ZSxcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHJvbGVNZXNzYWdlcy5sZW5ndGgpIHtcbiAgICAgIGNvbnN0IGluamVjdElkeCA9IGkgKyB0b3RhbEluc2VydGVkTWVzc2FnZXM7XG4gICAgICBwcm9jZXNzZWRNZXNzYWdlcy5zcGxpY2UoaW5qZWN0SWR4LCAwLCAuLi5yb2xlTWVzc2FnZXMpO1xuICAgICAgdG90YWxJbnNlcnRlZE1lc3NhZ2VzICs9IHJvbGVNZXNzYWdlcy5sZW5ndGg7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHByb2Nlc3NlZE1lc3NhZ2VzO1xufVxuXG5mdW5jdGlvbiBnZXRQcm9tcHRSb2xlKHJvbGU6IG51bWJlcikge1xuICBzd2l0Y2ggKHJvbGUpIHtcbiAgICBjYXNlIGV4dGVuc2lvbl9wcm9tcHRfcm9sZXMuU1lTVEVNOlxuICAgICAgcmV0dXJuICdzeXN0ZW0nO1xuICAgIGNhc2UgZXh0ZW5zaW9uX3Byb21wdF9yb2xlcy5VU0VSOlxuICAgICAgcmV0dXJuICd1c2VyJztcbiAgICBjYXNlIGV4dGVuc2lvbl9wcm9tcHRfcm9sZXMuQVNTSVNUQU5UOlxuICAgICAgcmV0dXJuICdhc3Npc3RhbnQnO1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gJ3N5c3RlbSc7XG4gIH1cbn1cblxuLy/nlJ/miJDlk43lupRcbmFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlUmVzcG9uc2UoZ2VuZXJhdGVfZGF0YTogYW55LCB1c2VTdHJlYW0gPSBmYWxzZSk6IFByb21pc2U8c3RyaW5nPiB7XG4gIGxldCByZXN1bHQgPSAnJztcbiAgdHJ5IHtcbiAgICBkZWFjdGl2YXRlU2VuZEJ1dHRvbnMoKTtcblxuICAgIGlmICh1c2VTdHJlYW0pIHtcbiAgICAgIGNvbnN0IG9yaWdpbmFsU3RyZWFtU2V0dGluZyA9IG9haV9zZXR0aW5ncy5zdHJlYW1fb3BlbmFpO1xuICAgICAgaWYgKCFvcmlnaW5hbFN0cmVhbVNldHRpbmcpIHtcbiAgICAgICAgb2FpX3NldHRpbmdzLnN0cmVhbV9vcGVuYWkgPSB0cnVlO1xuICAgICAgICBzYXZlU2V0dGluZ3NEZWJvdW5jZWQoKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHN0cmVhbWluZ1Byb2Nlc3NvciA9IG5ldyBTdHJlYW1pbmdQcm9jZXNzb3IoKTtcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgIHN0cmVhbWluZ1Byb2Nlc3Nvci5nZW5lcmF0b3IgPSBhd2FpdCBzZW5kT3BlbkFJUmVxdWVzdCgnbm9ybWFsJywgZ2VuZXJhdGVfZGF0YS5wcm9tcHQsIGFib3J0Q29udHJvbGxlci5zaWduYWwpO1xuICAgICAgcmVzdWx0ID0gKGF3YWl0IHN0cmVhbWluZ1Byb2Nlc3Nvci5nZW5lcmF0ZSgpKSBhcyBzdHJpbmc7XG4gICAgICBpZiAob3JpZ2luYWxTdHJlYW1TZXR0aW5nICE9PSBvYWlfc2V0dGluZ3Muc3RyZWFtX29wZW5haSkge1xuICAgICAgICBvYWlfc2V0dGluZ3Muc3RyZWFtX29wZW5haSA9IG9yaWdpbmFsU3RyZWFtU2V0dGluZztcbiAgICAgICAgc2F2ZVNldHRpbmdzRGVib3VuY2VkKCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGV2ZW50U291cmNlLmVtaXQoJ2pzX2dlbmVyYXRpb25fc3RhcnRlZCcpO1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBzZW5kT3BlbkFJUmVxdWVzdCh0eXBlLCBnZW5lcmF0ZV9kYXRhLnByb21wdCwgYWJvcnRDb250cm9sbGVyLnNpZ25hbCk7XG4gICAgICByZXN1bHQgPSBhd2FpdCBoYW5kbGVSZXNwb25zZShyZXNwb25zZSk7XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGxvZy5lcnJvcihlcnJvcik7XG4gIH0gZmluYWxseSB7XG4gICAgdW5ibG9ja0dlbmVyYXRpb24oKTtcbiAgICBhd2FpdCBjbGVhckluamVjdGlvblByb21wdHMoWydJTkpFQ1RJT04nXSk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLy8g5aSE55CG5ZON5bqUXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVSZXNwb25zZShyZXNwb25zZTogYW55KSB7XG4gIGlmICghcmVzcG9uc2UpIHtcbiAgICB0aHJvdyBFcnJvcihg5pyq5b6X5Yiw5ZON5bqUYCk7XG4gIH1cbiAgaWYgKHJlc3BvbnNlLmVycm9yKSB7XG4gICAgaWYgKHJlc3BvbnNlPy5yZXNwb25zZSkge1xuICAgICAgdG9hc3RyLmVycm9yKHJlc3BvbnNlLnJlc3BvbnNlLCB0YEFQSSBFcnJvcmAsIHtcbiAgICAgICAgcHJldmVudER1cGxpY2F0ZXM6IHRydWUsXG4gICAgICB9KTtcbiAgICB9XG4gICAgdGhyb3cgRXJyb3IocmVzcG9uc2U/LnJlc3BvbnNlKTtcbiAgfVxuICBjb25zdCBtZXNzYWdlOiBzdHJpbmcgPSBleHRyYWN0TWVzc2FnZUZyb21EYXRhKHJlc3BvbnNlKTtcbiAgZXZlbnRTb3VyY2UuZW1pdCgnanNfZ2VuZXJhdGlvbl9lbmRlZCcsIG1lc3NhZ2UpO1xuICByZXR1cm4gbWVzc2FnZTtcbn1cblxuZnVuY3Rpb24gdW5ibG9ja0dlbmVyYXRpb24oKSB7XG4gIGFjdGl2YXRlU2VuZEJ1dHRvbnMoKTtcbiAgc2hvd1N3aXBlQnV0dG9ucygpO1xuICBzZXRHZW5lcmF0aW9uUHJvZ3Jlc3MoMCk7XG4gIGZsdXNoRXBoZW1lcmFsU3RvcHBpbmdTdHJpbmdzKCk7XG59XG5cbi8vIOa4heeQhuazqOWFpVxuYXN5bmMgZnVuY3Rpb24gY2xlYXJJbmplY3Rpb25Qcm9tcHRzKHByZWZpeGVzOiBzdHJpbmdbXSkge1xuICBjb25zdCBwcm9tcHRzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0gZ2V0Q29udGV4dCgpLmV4dGVuc2lvblByb21wdHM7XG4gIE9iamVjdC5rZXlzKHByb21wdHMpXG4gICAgLmZpbHRlcihrZXkgPT4gcHJlZml4ZXMuc29tZShwcmVmaXggPT4ga2V5LnN0YXJ0c1dpdGgocHJlZml4KSkpXG4gICAgLmZvckVhY2goa2V5ID0+IGRlbGV0ZSBwcm9tcHRzW2tleV0pO1xuXG4gIGF3YWl0IHNhdmVDaGF0Q29uZGl0aW9uYWwoKTtcbn1cbmZ1bmN0aW9uIGV4dHJhY3RNZXNzYWdlRnJvbURhdGEoZGF0YTogYW55KSB7XG4gIGlmICh0eXBlb2YgZGF0YSA9PT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gZGF0YTtcbiAgfVxuXG4gIHJldHVybiAoXG4gICAgZGF0YT8uY2hvaWNlcz8uWzBdPy5tZXNzYWdlPy5jb250ZW50ID8/XG4gICAgZGF0YT8uY2hvaWNlcz8uWzBdPy50ZXh0ID8/XG4gICAgZGF0YT8udGV4dCA/P1xuICAgIGRhdGE/Lm1lc3NhZ2U/LmNvbnRlbnQ/LlswXT8udGV4dCA/P1xuICAgIGRhdGE/Lm1lc3NhZ2U/LnRvb2xfcGxhbiA/P1xuICAgICcnXG4gICk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNvbnZlcnRGaWxlVG9CYXNlNjQoaW1hZ2U6IEZpbGUgfCBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICBpZiAodHlwZW9mIGltYWdlID09PSAnc3RyaW5nJykge1xuICAgIHJldHVybiBpbWFnZTtcbiAgfVxuICByZXR1cm4gYXdhaXQgZ2V0QmFzZTY0QXN5bmMoaW1hZ2UpO1xufVxuXG5mdW5jdGlvbiBhZGRUZW1wb3JhcnlVc2VyTWVzc2FnZSh1c2VyQ29udGVudDogc3RyaW5nKSB7XG4gIHNldEV4dGVuc2lvblByb21wdCgnVEVNUF9VU0VSX01FU1NBR0UnLCB1c2VyQ29udGVudCwgZXh0ZW5zaW9uX3Byb21wdF90eXBlcy5JTl9QUk9NUFQsIDAsIHRydWUsIDEpO1xufVxuXG5mdW5jdGlvbiByZW1vdmVUZW1wb3JhcnlVc2VyTWVzc2FnZSgpIHtcbiAgc2V0RXh0ZW5zaW9uUHJvbXB0KCdURU1QX1VTRVJfTUVTU0FHRScsICcnLCBleHRlbnNpb25fcHJvbXB0X3R5cGVzLklOX1BST01QVCwgMCwgdHJ1ZSwgMSk7XG59XG5cbmZ1bmN0aW9uIGlzUHJvbXB0RmlsdGVyZWQocHJvbXB0SWQ6IHN0cmluZywgY29uZmlnOiB7IG92ZXJyaWRlcz86IGRldGFpbC5PdmVycmlkZUNvbmZpZyB9KTogYm9vbGVhbiB7XG4gIGlmICghY29uZmlnLm92ZXJyaWRlcykge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGlmIChwcm9tcHRJZCA9PT0gJ3dpdGhfZGVwdGhfZW50cmllcycpIHtcbiAgICByZXR1cm4gY29uZmlnLm92ZXJyaWRlcy53aXRoX2RlcHRoX2VudHJpZXMgPT09IGZhbHNlO1xuICB9XG5cbiAgLy8g54m55q6K5aSE55CGIGNoYXRfaGlzdG9yeVxuICBpZiAocHJvbXB0SWQgPT09ICdjaGF0X2hpc3RvcnknKSB7XG4gICAgY29uc3QgcHJvbXB0cyA9IGNvbmZpZy5vdmVycmlkZXMuY2hhdF9oaXN0b3J5O1xuICAgIHJldHVybiBwcm9tcHRzICE9PSB1bmRlZmluZWQgJiYgcHJvbXB0cy5sZW5ndGggPT09IDA7XG4gIH1cblxuICAvLyDlr7nkuo7mma7pgJrmj5DnpLror43vvIzlj6rmnInlvZPlroPlnKggb3ZlcnJpZGVzIOS4reWtmOWcqOS4lOS4uuepuuWtl+espuS4suaXtuaJjeiiq+i/h+a7pFxuICBjb25zdCBvdmVycmlkZSA9IGNvbmZpZy5vdmVycmlkZXNbcHJvbXB0SWQgYXMga2V5b2YgT21pdDxkZXRhaWwuT3ZlcnJpZGVDb25maWcsICdjaGF0X2hpc3RvcnknPl07XG4gIHJldHVybiBvdmVycmlkZSAhPT0gdW5kZWZpbmVkICYmIG92ZXJyaWRlID09PSAnJztcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlKGNvbmZpZzogR2VuZXJhdGVDb25maWcpIHtcbiAgY29uc3QgY29udmVydGVkX2NvbmZpZyA9IGZyb21HZW5lcmF0ZUNvbmZpZyhjb25maWcpO1xuICByZXR1cm4gYXdhaXQgaWZyYW1lR2VuZXJhdGUoY29udmVydGVkX2NvbmZpZyk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZW5lcmF0ZVJhdyhjb25maWc6IEdlbmVyYXRlUmF3Q29uZmlnKSB7XG4gIGNvbnN0IGNvbnZlcnRlZF9jb25maWcgPSBmcm9tR2VuZXJhdGVSYXdDb25maWcoY29uZmlnKTtcbiAgcmV0dXJuIGF3YWl0IGlmcmFtZUdlbmVyYXRlKGNvbnZlcnRlZF9jb25maWcpO1xufVxuXG4vLyBAdHMtaWdub3JlXG4kKGRvY3VtZW50KS5vbignY2xpY2snLCAnI21lc19zdG9wJywgZnVuY3Rpb24gKCkge1xuICBjb25zdCB3YXNTdG9wcGVkID0gc3RvcEdlbmVyYXRpb24oKTtcbiAgaWYgKHdhc1N0b3BwZWQpIHtcbiAgICBpZiAoYWJvcnRDb250cm9sbGVyKSB7XG4gICAgICBhYm9ydENvbnRyb2xsZXIuYWJvcnQoJ0NsaWNrZWQgc3RvcCBidXR0b24nKTtcbiAgICB9XG4gICAgdW5ibG9ja0dlbmVyYXRpb24oKTtcbiAgfVxufSk7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/function/generate.ts\n")},"./src/function/index.ts":
/*!*******************************!*\
  !*** ./src/function/index.ts ***!
  \*******************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   initTavernHelperObject: () => (/* binding */ initTavernHelperObject)\n/* harmony export */ });\n/* harmony import */ var _component_macrolike__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/macrolike */ "./src/component/macrolike.ts");\n/* harmony import */ var _function_character__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/function/character */ "./src/function/character.ts");\n/* harmony import */ var _function_chat_message__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/function/chat_message */ "./src/function/chat_message.ts");\n/* harmony import */ var _function_displayed_message__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/function/displayed_message */ "./src/function/displayed_message.ts");\n/* harmony import */ var _function_generate__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/function/generate */ "./src/function/generate.ts");\n/* harmony import */ var _function_lorebook__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/function/lorebook */ "./src/function/lorebook.ts");\n/* harmony import */ var _function_lorebook_entry__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/function/lorebook_entry */ "./src/function/lorebook_entry.ts");\n/* harmony import */ var _function_script_repository__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @/function/script_repository */ "./src/function/script_repository.ts");\n/* harmony import */ var _function_slash__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @/function/slash */ "./src/function/slash.ts");\n/* harmony import */ var _function_tavern_regex__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @/function/tavern_regex */ "./src/function/tavern_regex.ts");\n/* harmony import */ var _function_util__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @/function/util */ "./src/function/util.ts");\n/* harmony import */ var _function_variables__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @/function/variables */ "./src/function/variables.ts");\n/* harmony import */ var _function_version__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @/function/version */ "./src/function/version.ts");\n/* harmony import */ var _slash_command_audio__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @/slash_command/audio */ "./src/slash_command/audio.ts");\n/* harmony import */ var _builtin__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./builtin */ "./src/function/builtin.ts");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction getTavernHelper() {\n    return {\n        // audio\n        audioEnable: _slash_command_audio__WEBPACK_IMPORTED_MODULE_13__.audioEnable,\n        audioImport: _slash_command_audio__WEBPACK_IMPORTED_MODULE_13__.audioImport,\n        audioMode: _slash_command_audio__WEBPACK_IMPORTED_MODULE_13__.audioMode,\n        audioPlay: _slash_command_audio__WEBPACK_IMPORTED_MODULE_13__.audioPlay,\n        audioSelect: _slash_command_audio__WEBPACK_IMPORTED_MODULE_13__.audioSelect,\n        // builtin\n        builtin: _builtin__WEBPACK_IMPORTED_MODULE_14__.builtin,\n        // character\n        Character: _function_character__WEBPACK_IMPORTED_MODULE_1__.Character,\n        getCharData: _function_character__WEBPACK_IMPORTED_MODULE_1__.getCharData,\n        getCharAvatarPath: _function_character__WEBPACK_IMPORTED_MODULE_1__.getCharAvatarPath,\n        getChatHistoryBrief: _function_character__WEBPACK_IMPORTED_MODULE_1__.getChatHistoryBrief,\n        getChatHistoryDetail: _function_character__WEBPACK_IMPORTED_MODULE_1__.getChatHistoryDetail,\n        // chat_message\n        getChatMessages: _function_chat_message__WEBPACK_IMPORTED_MODULE_2__.getChatMessages,\n        setChatMessages: _function_chat_message__WEBPACK_IMPORTED_MODULE_2__.setChatMessages,\n        setChatMessage: _function_chat_message__WEBPACK_IMPORTED_MODULE_2__.setChatMessage,\n        createChatMessages: _function_chat_message__WEBPACK_IMPORTED_MODULE_2__.createChatMessages,\n        deleteChatMessages: _function_chat_message__WEBPACK_IMPORTED_MODULE_2__.deleteChatMessages,\n        rotateChatMessages: _function_chat_message__WEBPACK_IMPORTED_MODULE_2__.rotateChatMessages,\n        // displayed_message\n        formatAsDisplayedMessage: _function_displayed_message__WEBPACK_IMPORTED_MODULE_3__.formatAsDisplayedMessage,\n        retrieveDisplayedMessage: _function_displayed_message__WEBPACK_IMPORTED_MODULE_3__.retrieveDisplayedMessage,\n        // generate\n        builtin_prompt_default_order: _function_generate__WEBPACK_IMPORTED_MODULE_4__.builtin_prompt_default_order,\n        generate: _function_generate__WEBPACK_IMPORTED_MODULE_4__.generate,\n        generateRaw: _function_generate__WEBPACK_IMPORTED_MODULE_4__.generateRaw,\n        // lorebook_entry\n        getLorebookEntries: _function_lorebook_entry__WEBPACK_IMPORTED_MODULE_6__.getLorebookEntries,\n        replaceLorebookEntries: _function_lorebook_entry__WEBPACK_IMPORTED_MODULE_6__.replaceLorebookEntries,\n        updateLorebookEntriesWith: _function_lorebook_entry__WEBPACK_IMPORTED_MODULE_6__.updateLorebookEntriesWith,\n        setLorebookEntries: _function_lorebook_entry__WEBPACK_IMPORTED_MODULE_6__.setLorebookEntries,\n        createLorebookEntries: _function_lorebook_entry__WEBPACK_IMPORTED_MODULE_6__.createLorebookEntries,\n        createLorebookEntry: _function_lorebook_entry__WEBPACK_IMPORTED_MODULE_6__.createLorebookEntry,\n        deleteLorebookEntries: _function_lorebook_entry__WEBPACK_IMPORTED_MODULE_6__.deleteLorebookEntries,\n        deleteLorebookEntry: _function_lorebook_entry__WEBPACK_IMPORTED_MODULE_6__.deleteLorebookEntry,\n        // lorebook\n        getLorebookSettings: _function_lorebook__WEBPACK_IMPORTED_MODULE_5__.getLorebookSettings,\n        setLorebookSettings: _function_lorebook__WEBPACK_IMPORTED_MODULE_5__.setLorebookSettings,\n        getCharLorebooks: _function_lorebook__WEBPACK_IMPORTED_MODULE_5__.getCharLorebooks,\n        setCurrentCharLorebooks: _function_lorebook__WEBPACK_IMPORTED_MODULE_5__.setCurrentCharLorebooks,\n        getLorebooks: _function_lorebook__WEBPACK_IMPORTED_MODULE_5__.getLorebooks,\n        deleteLorebook: _function_lorebook__WEBPACK_IMPORTED_MODULE_5__.deleteLorebook,\n        createLorebook: _function_lorebook__WEBPACK_IMPORTED_MODULE_5__.createLorebook,\n        getCurrentCharPrimaryLorebook: _function_lorebook__WEBPACK_IMPORTED_MODULE_5__.getCurrentCharPrimaryLorebook,\n        getChatLorebook: _function_lorebook__WEBPACK_IMPORTED_MODULE_5__.getChatLorebook,\n        setChatLorebook: _function_lorebook__WEBPACK_IMPORTED_MODULE_5__.setChatLorebook,\n        getOrCreateChatLorebook: _function_lorebook__WEBPACK_IMPORTED_MODULE_5__.getOrCreateChatLorebook,\n        // macrolike\n        registerMacroLike: _component_macrolike__WEBPACK_IMPORTED_MODULE_0__.registerMacroLike,\n        // slash\n        triggerSlash: _function_slash__WEBPACK_IMPORTED_MODULE_8__.triggerSlash,\n        triggerSlashWithResult: _function_slash__WEBPACK_IMPORTED_MODULE_8__.triggerSlash,\n        // tavern_regex\n        isCharacterTavernRegexesEnabled: _function_tavern_regex__WEBPACK_IMPORTED_MODULE_9__.isCharacterTavernRegexesEnabled,\n        getTavernRegexes: _function_tavern_regex__WEBPACK_IMPORTED_MODULE_9__.getTavernRegexes,\n        replaceTavernRegexes: _function_tavern_regex__WEBPACK_IMPORTED_MODULE_9__.replaceTavernRegexes,\n        updateTavernRegexesWith: _function_tavern_regex__WEBPACK_IMPORTED_MODULE_9__.updateTavernRegexesWith,\n        // util\n        substitudeMacros: _function_util__WEBPACK_IMPORTED_MODULE_10__.substitudeMacros,\n        getLastMessageId: _function_util__WEBPACK_IMPORTED_MODULE_10__.getLastMessageId,\n        errorCatched: _function_util__WEBPACK_IMPORTED_MODULE_10__.errorCatched,\n        // variables\n        getVariables: _function_variables__WEBPACK_IMPORTED_MODULE_11__.getVariables,\n        replaceVariables: _function_variables__WEBPACK_IMPORTED_MODULE_11__.replaceVariables,\n        updateVariablesWith: _function_variables__WEBPACK_IMPORTED_MODULE_11__.updateVariablesWith,\n        insertOrAssignVariables: _function_variables__WEBPACK_IMPORTED_MODULE_11__.insertOrAssignVariables,\n        deleteVariable: _function_variables__WEBPACK_IMPORTED_MODULE_11__.deleteVariable,\n        insertVariables: _function_variables__WEBPACK_IMPORTED_MODULE_11__.insertVariables,\n        // script_repository\n        getScriptButtons: _function_script_repository__WEBPACK_IMPORTED_MODULE_7__.getScriptButtons,\n        replaceScriptButtons: _function_script_repository__WEBPACK_IMPORTED_MODULE_7__.replaceScriptButtons,\n        // version\n        getTavernHelperVersion: _function_version__WEBPACK_IMPORTED_MODULE_12__.getTavernHelperVersion,\n        updateTavernHelper: _function_version__WEBPACK_IMPORTED_MODULE_12__.updateTavernHelper,\n        getFrontendVersion: _function_version__WEBPACK_IMPORTED_MODULE_12__.getTavernHelperVersion,\n        updateFrontendVersion: _function_version__WEBPACK_IMPORTED_MODULE_12__.updateTavernHelper,\n    };\n}\n/**\n * 初始化TavernHelper全局对象\n * 将各种功能函数暴露到全局作用域\n */\nfunction initTavernHelperObject() {\n    globalThis.TavernHelper = getTavernHelper();\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZnVuY3Rpb24vaW5kZXgudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUEwRDtBQU81QjtBQVFHO0FBQ2lFO0FBQ1I7QUFhN0Q7QUFVTTtBQUNtRDtBQUN0QztBQU1mO0FBQ2tEO0FBUXJEO0FBQ2tEO0FBQ29CO0FBQ2hFO0FBRXBDLFNBQVMsZUFBZTtJQUN0QixPQUFPO1FBQ0wsUUFBUTtRQUNSLFdBQVc7UUFDWCxXQUFXO1FBQ1gsU0FBUztRQUNULFNBQVM7UUFDVCxXQUFXO1FBRVgsVUFBVTtRQUNWLE9BQU87UUFFUCxZQUFZO1FBQ1osU0FBUztRQUNULFdBQVc7UUFDWCxpQkFBaUI7UUFDakIsbUJBQW1CO1FBQ25CLG9CQUFvQjtRQUVwQixlQUFlO1FBQ2YsZUFBZTtRQUNmLGVBQWU7UUFDZixjQUFjO1FBQ2Qsa0JBQWtCO1FBQ2xCLGtCQUFrQjtRQUNsQixrQkFBa0I7UUFFbEIsb0JBQW9CO1FBQ3BCLHdCQUF3QjtRQUN4Qix3QkFBd0I7UUFFeEIsV0FBVztRQUNYLDRCQUE0QjtRQUM1QixRQUFRO1FBQ1IsV0FBVztRQUVYLGlCQUFpQjtRQUNqQixrQkFBa0I7UUFDbEIsc0JBQXNCO1FBQ3RCLHlCQUF5QjtRQUN6QixrQkFBa0I7UUFDbEIscUJBQXFCO1FBQ3JCLG1CQUFtQjtRQUNuQixxQkFBcUI7UUFDckIsbUJBQW1CO1FBRW5CLFdBQVc7UUFDWCxtQkFBbUI7UUFDbkIsbUJBQW1CO1FBQ25CLGdCQUFnQjtRQUNoQix1QkFBdUI7UUFDdkIsWUFBWTtRQUNaLGNBQWM7UUFDZCxjQUFjO1FBQ2QsNkJBQTZCO1FBQzdCLGVBQWU7UUFDZixlQUFlO1FBQ2YsdUJBQXVCO1FBRXZCLFlBQVk7UUFDWixpQkFBaUI7UUFFakIsUUFBUTtRQUNSLFlBQVk7UUFDWixzQkFBc0IsRUFBRSx5REFBWTtRQUVwQyxlQUFlO1FBQ2YsK0JBQStCO1FBQy9CLGdCQUFnQjtRQUNoQixvQkFBb0I7UUFDcEIsdUJBQXVCO1FBRXZCLE9BQU87UUFDUCxnQkFBZ0I7UUFDaEIsZ0JBQWdCO1FBQ2hCLFlBQVk7UUFFWixZQUFZO1FBQ1osWUFBWTtRQUNaLGdCQUFnQjtRQUNoQixtQkFBbUI7UUFDbkIsdUJBQXVCO1FBQ3ZCLGNBQWM7UUFDZCxlQUFlO1FBRWYsb0JBQW9CO1FBQ3BCLGdCQUFnQjtRQUNoQixvQkFBb0I7UUFFcEIsVUFBVTtRQUNWLHNCQUFzQjtRQUN0QixrQkFBa0I7UUFDbEIsa0JBQWtCLEVBQUUsc0VBQXNCO1FBQzFDLHFCQUFxQixFQUFFLGtFQUFrQjtLQUMxQyxDQUFDO0FBQ0osQ0FBQztBQU1EOzs7R0FHRztBQUNJLFNBQVMsc0JBQXNCO0lBQ3BDLFVBQVUsQ0FBQyxZQUFZLEdBQUcsZUFBZSxFQUFFLENBQUM7QUFDOUMsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9mdW5jdGlvbi9pbmRleC50cz83ZWJmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHJlZ2lzdGVyTWFjcm9MaWtlIH0gZnJvbSAnQC9jb21wb25lbnQvbWFjcm9saWtlJztcbmltcG9ydCB7XG4gIENoYXJhY3RlcixcbiAgZ2V0Q2hhckF2YXRhclBhdGgsXG4gIGdldENoYXJEYXRhLFxuICBnZXRDaGF0SGlzdG9yeUJyaWVmLFxuICBnZXRDaGF0SGlzdG9yeURldGFpbCxcbn0gZnJvbSAnQC9mdW5jdGlvbi9jaGFyYWN0ZXInO1xuaW1wb3J0IHtcbiAgY3JlYXRlQ2hhdE1lc3NhZ2VzLFxuICBkZWxldGVDaGF0TWVzc2FnZXMsXG4gIGdldENoYXRNZXNzYWdlcyxcbiAgcm90YXRlQ2hhdE1lc3NhZ2VzLFxuICBzZXRDaGF0TWVzc2FnZSxcbiAgc2V0Q2hhdE1lc3NhZ2VzLFxufSBmcm9tICdAL2Z1bmN0aW9uL2NoYXRfbWVzc2FnZSc7XG5pbXBvcnQgeyBmb3JtYXRBc0Rpc3BsYXllZE1lc3NhZ2UsIHJldHJpZXZlRGlzcGxheWVkTWVzc2FnZSB9IGZyb20gJ0AvZnVuY3Rpb24vZGlzcGxheWVkX21lc3NhZ2UnO1xuaW1wb3J0IHsgYnVpbHRpbl9wcm9tcHRfZGVmYXVsdF9vcmRlciwgZ2VuZXJhdGUsIGdlbmVyYXRlUmF3IH0gZnJvbSAnQC9mdW5jdGlvbi9nZW5lcmF0ZSc7XG5pbXBvcnQge1xuICBjcmVhdGVMb3JlYm9vayxcbiAgZGVsZXRlTG9yZWJvb2ssXG4gIGdldENoYXJMb3JlYm9va3MsXG4gIGdldENoYXRMb3JlYm9vayxcbiAgZ2V0Q3VycmVudENoYXJQcmltYXJ5TG9yZWJvb2ssXG4gIGdldExvcmVib29rcyxcbiAgZ2V0TG9yZWJvb2tTZXR0aW5ncyxcbiAgZ2V0T3JDcmVhdGVDaGF0TG9yZWJvb2ssXG4gIHNldENoYXRMb3JlYm9vayxcbiAgc2V0Q3VycmVudENoYXJMb3JlYm9va3MsXG4gIHNldExvcmVib29rU2V0dGluZ3MsXG59IGZyb20gJ0AvZnVuY3Rpb24vbG9yZWJvb2snO1xuaW1wb3J0IHtcbiAgY3JlYXRlTG9yZWJvb2tFbnRyaWVzLFxuICBjcmVhdGVMb3JlYm9va0VudHJ5LFxuICBkZWxldGVMb3JlYm9va0VudHJpZXMsXG4gIGRlbGV0ZUxvcmVib29rRW50cnksXG4gIGdldExvcmVib29rRW50cmllcyxcbiAgcmVwbGFjZUxvcmVib29rRW50cmllcyxcbiAgc2V0TG9yZWJvb2tFbnRyaWVzLFxuICB1cGRhdGVMb3JlYm9va0VudHJpZXNXaXRoLFxufSBmcm9tICdAL2Z1bmN0aW9uL2xvcmVib29rX2VudHJ5JztcbmltcG9ydCB7IGdldFNjcmlwdEJ1dHRvbnMsIHJlcGxhY2VTY3JpcHRCdXR0b25zIH0gZnJvbSAnQC9mdW5jdGlvbi9zY3JpcHRfcmVwb3NpdG9yeSc7XG5pbXBvcnQgeyB0cmlnZ2VyU2xhc2ggfSBmcm9tICdAL2Z1bmN0aW9uL3NsYXNoJztcbmltcG9ydCB7XG4gIGdldFRhdmVyblJlZ2V4ZXMsXG4gIGlzQ2hhcmFjdGVyVGF2ZXJuUmVnZXhlc0VuYWJsZWQsXG4gIHJlcGxhY2VUYXZlcm5SZWdleGVzLFxuICB1cGRhdGVUYXZlcm5SZWdleGVzV2l0aCxcbn0gZnJvbSAnQC9mdW5jdGlvbi90YXZlcm5fcmVnZXgnO1xuaW1wb3J0IHsgZXJyb3JDYXRjaGVkLCBnZXRMYXN0TWVzc2FnZUlkLCBzdWJzdGl0dWRlTWFjcm9zIH0gZnJvbSAnQC9mdW5jdGlvbi91dGlsJztcbmltcG9ydCB7XG4gIGRlbGV0ZVZhcmlhYmxlLFxuICBnZXRWYXJpYWJsZXMsXG4gIGluc2VydE9yQXNzaWduVmFyaWFibGVzLFxuICBpbnNlcnRWYXJpYWJsZXMsXG4gIHJlcGxhY2VWYXJpYWJsZXMsXG4gIHVwZGF0ZVZhcmlhYmxlc1dpdGgsXG59IGZyb20gJ0AvZnVuY3Rpb24vdmFyaWFibGVzJztcbmltcG9ydCB7IGdldFRhdmVybkhlbHBlclZlcnNpb24sIHVwZGF0ZVRhdmVybkhlbHBlciB9IGZyb20gJ0AvZnVuY3Rpb24vdmVyc2lvbic7XG5pbXBvcnQgeyBhdWRpb0VuYWJsZSwgYXVkaW9JbXBvcnQsIGF1ZGlvTW9kZSwgYXVkaW9QbGF5LCBhdWRpb1NlbGVjdCB9IGZyb20gJ0Avc2xhc2hfY29tbWFuZC9hdWRpbyc7XG5pbXBvcnQgeyBidWlsdGluIH0gZnJvbSAnLi9idWlsdGluJztcblxuZnVuY3Rpb24gZ2V0VGF2ZXJuSGVscGVyKCkge1xuICByZXR1cm4ge1xuICAgIC8vIGF1ZGlvXG4gICAgYXVkaW9FbmFibGUsXG4gICAgYXVkaW9JbXBvcnQsXG4gICAgYXVkaW9Nb2RlLFxuICAgIGF1ZGlvUGxheSxcbiAgICBhdWRpb1NlbGVjdCxcblxuICAgIC8vIGJ1aWx0aW5cbiAgICBidWlsdGluLFxuXG4gICAgLy8gY2hhcmFjdGVyXG4gICAgQ2hhcmFjdGVyLFxuICAgIGdldENoYXJEYXRhLFxuICAgIGdldENoYXJBdmF0YXJQYXRoLFxuICAgIGdldENoYXRIaXN0b3J5QnJpZWYsXG4gICAgZ2V0Q2hhdEhpc3RvcnlEZXRhaWwsXG5cbiAgICAvLyBjaGF0X21lc3NhZ2VcbiAgICBnZXRDaGF0TWVzc2FnZXMsXG4gICAgc2V0Q2hhdE1lc3NhZ2VzLFxuICAgIHNldENoYXRNZXNzYWdlLFxuICAgIGNyZWF0ZUNoYXRNZXNzYWdlcyxcbiAgICBkZWxldGVDaGF0TWVzc2FnZXMsXG4gICAgcm90YXRlQ2hhdE1lc3NhZ2VzLFxuXG4gICAgLy8gZGlzcGxheWVkX21lc3NhZ2VcbiAgICBmb3JtYXRBc0Rpc3BsYXllZE1lc3NhZ2UsXG4gICAgcmV0cmlldmVEaXNwbGF5ZWRNZXNzYWdlLFxuXG4gICAgLy8gZ2VuZXJhdGVcbiAgICBidWlsdGluX3Byb21wdF9kZWZhdWx0X29yZGVyLFxuICAgIGdlbmVyYXRlLFxuICAgIGdlbmVyYXRlUmF3LFxuXG4gICAgLy8gbG9yZWJvb2tfZW50cnlcbiAgICBnZXRMb3JlYm9va0VudHJpZXMsXG4gICAgcmVwbGFjZUxvcmVib29rRW50cmllcyxcbiAgICB1cGRhdGVMb3JlYm9va0VudHJpZXNXaXRoLFxuICAgIHNldExvcmVib29rRW50cmllcyxcbiAgICBjcmVhdGVMb3JlYm9va0VudHJpZXMsXG4gICAgY3JlYXRlTG9yZWJvb2tFbnRyeSxcbiAgICBkZWxldGVMb3JlYm9va0VudHJpZXMsXG4gICAgZGVsZXRlTG9yZWJvb2tFbnRyeSxcblxuICAgIC8vIGxvcmVib29rXG4gICAgZ2V0TG9yZWJvb2tTZXR0aW5ncyxcbiAgICBzZXRMb3JlYm9va1NldHRpbmdzLFxuICAgIGdldENoYXJMb3JlYm9va3MsXG4gICAgc2V0Q3VycmVudENoYXJMb3JlYm9va3MsXG4gICAgZ2V0TG9yZWJvb2tzLFxuICAgIGRlbGV0ZUxvcmVib29rLFxuICAgIGNyZWF0ZUxvcmVib29rLFxuICAgIGdldEN1cnJlbnRDaGFyUHJpbWFyeUxvcmVib29rLFxuICAgIGdldENoYXRMb3JlYm9vayxcbiAgICBzZXRDaGF0TG9yZWJvb2ssXG4gICAgZ2V0T3JDcmVhdGVDaGF0TG9yZWJvb2ssXG5cbiAgICAvLyBtYWNyb2xpa2VcbiAgICByZWdpc3Rlck1hY3JvTGlrZSxcblxuICAgIC8vIHNsYXNoXG4gICAgdHJpZ2dlclNsYXNoLFxuICAgIHRyaWdnZXJTbGFzaFdpdGhSZXN1bHQ6IHRyaWdnZXJTbGFzaCxcblxuICAgIC8vIHRhdmVybl9yZWdleFxuICAgIGlzQ2hhcmFjdGVyVGF2ZXJuUmVnZXhlc0VuYWJsZWQsXG4gICAgZ2V0VGF2ZXJuUmVnZXhlcyxcbiAgICByZXBsYWNlVGF2ZXJuUmVnZXhlcyxcbiAgICB1cGRhdGVUYXZlcm5SZWdleGVzV2l0aCxcblxuICAgIC8vIHV0aWxcbiAgICBzdWJzdGl0dWRlTWFjcm9zLFxuICAgIGdldExhc3RNZXNzYWdlSWQsXG4gICAgZXJyb3JDYXRjaGVkLFxuXG4gICAgLy8gdmFyaWFibGVzXG4gICAgZ2V0VmFyaWFibGVzLFxuICAgIHJlcGxhY2VWYXJpYWJsZXMsXG4gICAgdXBkYXRlVmFyaWFibGVzV2l0aCxcbiAgICBpbnNlcnRPckFzc2lnblZhcmlhYmxlcyxcbiAgICBkZWxldGVWYXJpYWJsZSxcbiAgICBpbnNlcnRWYXJpYWJsZXMsXG5cbiAgICAvLyBzY3JpcHRfcmVwb3NpdG9yeVxuICAgIGdldFNjcmlwdEJ1dHRvbnMsXG4gICAgcmVwbGFjZVNjcmlwdEJ1dHRvbnMsXG5cbiAgICAvLyB2ZXJzaW9uXG4gICAgZ2V0VGF2ZXJuSGVscGVyVmVyc2lvbixcbiAgICB1cGRhdGVUYXZlcm5IZWxwZXIsXG4gICAgZ2V0RnJvbnRlbmRWZXJzaW9uOiBnZXRUYXZlcm5IZWxwZXJWZXJzaW9uLFxuICAgIHVwZGF0ZUZyb250ZW5kVmVyc2lvbjogdXBkYXRlVGF2ZXJuSGVscGVyLFxuICB9O1xufVxuXG5kZWNsYXJlIG5hbWVzcGFjZSBnbG9iYWxUaGlzIHtcbiAgbGV0IFRhdmVybkhlbHBlcjogUmV0dXJuVHlwZTx0eXBlb2YgZ2V0VGF2ZXJuSGVscGVyPjtcbn1cblxuLyoqXG4gKiDliJ3lp4vljJZUYXZlcm5IZWxwZXLlhajlsYDlr7nosaFcbiAqIOWwhuWQhOenjeWKn+iDveWHveaVsOaatOmcsuWIsOWFqOWxgOS9nOeUqOWfn1xuICovXG5leHBvcnQgZnVuY3Rpb24gaW5pdFRhdmVybkhlbHBlck9iamVjdCgpIHtcbiAgZ2xvYmFsVGhpcy5UYXZlcm5IZWxwZXIgPSBnZXRUYXZlcm5IZWxwZXIoKTtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/function/index.ts\n')},"./src/function/lorebook.ts":
/*!**********************************!*\
  !*** ./src/function/lorebook.ts ***!
  \**********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createLorebook: () => (/* binding */ createLorebook),\n/* harmony export */   deleteLorebook: () => (/* binding */ deleteLorebook),\n/* harmony export */   getCharLorebooks: () => (/* binding */ getCharLorebooks),\n/* harmony export */   getChatLorebook: () => (/* binding */ getChatLorebook),\n/* harmony export */   getCurrentCharPrimaryLorebook: () => (/* binding */ getCurrentCharPrimaryLorebook),\n/* harmony export */   getLorebookSettings: () => (/* binding */ getLorebookSettings),\n/* harmony export */   getLorebooks: () => (/* binding */ getLorebooks),\n/* harmony export */   getOrCreateChatLorebook: () => (/* binding */ getOrCreateChatLorebook),\n/* harmony export */   setChatLorebook: () => (/* binding */ setChatLorebook),\n/* harmony export */   setCurrentCharLorebooks: () => (/* binding */ setCurrentCharLorebooks),\n/* harmony export */   setLorebookSettings: () => (/* binding */ setLorebookSettings)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_group_chats__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/group-chats */ \"@sillytavern/scripts/group-chats\");\n/* harmony import */ var _sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/scripts/utils */ \"@sillytavern/scripts/utils\");\n/* harmony import */ var _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/scripts/world-info */ \"@sillytavern/scripts/world-info\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_4__);\n\n// @ts-ignore\n\n\n\n\nasync function editCurrentCharacter() {\n    // @ts-ignore\n    $('#rm_info_avatar').html('');\n    // @ts-ignore\n    const form_data = new FormData($('#form_create').get(0));\n    const raw_file = form_data.get('avatar');\n    if (raw_file instanceof File) {\n        const converted_file = await (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_2__.ensureImageFormatSupported)(raw_file);\n        form_data.set('avatar', converted_file);\n    }\n    const headers = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.getRequestHeaders)();\n    // @ts-ignore\n    delete headers['Content-Type'];\n    // TODO: 这里的代码可以用来修改第一条消息!\n    form_data.delete('alternate_greetings');\n    // @ts-ignore\n    const chid = $('.open_alternate_greetings').data('chid');\n    if (chid && Array.isArray(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[chid]?.data?.alternate_greetings)) {\n        for (const value of _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[chid].data.alternate_greetings) {\n            form_data.append('alternate_greetings', value);\n        }\n    }\n    const response = await fetch('/api/characters/edit', {\n        method: 'POST',\n        headers: headers,\n        body: form_data,\n        cache: 'no-cache',\n    });\n    if (!response.ok) {\n        return false;\n    }\n    await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.getOneCharacter)(form_data.get('avatar_url'));\n    // @ts-ignore\n    $('#add_avatar_button').replaceWith($('#add_avatar_button').val('').clone(true));\n    // @ts-ignore\n    $('#create_button').attr('value', 'Save');\n    return true;\n}\nfunction toLorebookSettings(world_info_settings) {\n    return {\n        selected_global_lorebooks: world_info_settings.world_info.globalSelect,\n        scan_depth: world_info_settings.world_info_depth,\n        context_percentage: world_info_settings.world_info_budget,\n        budget_cap: world_info_settings.world_info_budget_cap,\n        min_activations: world_info_settings.world_info_min_activations,\n        max_depth: world_info_settings.world_info_min_activations_depth_max,\n        max_recursion_steps: world_info_settings.world_info_max_recursion_steps,\n        insertion_strategy: { 0: 'evenly', 1: 'character_first', 2: 'global_first' }[world_info_settings.world_info_character_strategy],\n        include_names: world_info_settings.world_info_include_names,\n        recursive: world_info_settings.world_info_recursive,\n        case_sensitive: world_info_settings.world_info_case_sensitive,\n        match_whole_words: world_info_settings.world_info_match_whole_words,\n        use_group_scoring: world_info_settings.world_info_use_group_scoring,\n        overflow_alert: world_info_settings.world_info_overflow_alert,\n    };\n}\nfunction assignPartialLorebookSettings(settings) {\n    const for_eachs = {\n        selected_global_lorebooks: (value) => {\n            // @ts-ignore\n            $('#world_info').find('option[value!=\"\"]').remove();\n            _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.world_names.forEach((item, i) => \n            // @ts-ignore\n            $('#world_info').append(`<option value='${i}'${value.includes(item) ? ' selected' : ''}>${item}</option>`));\n            _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.selected_world_info.length = 0;\n            _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.selected_world_info.push(...value);\n            (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveSettings)();\n        },\n        scan_depth: (value) => {\n            // @ts-ignore\n            $('#world_info_depth').val(value).trigger('input');\n        },\n        context_percentage: (value) => {\n            // @ts-ignore\n            $('#world_info_budget').val(value).trigger('input');\n        },\n        budget_cap: (value) => {\n            // @ts-ignore\n            $('#world_info_budget_cap').val(value).trigger('input');\n        },\n        min_activations: (value) => {\n            // @ts-ignore\n            $('#world_info_min_activations').val(value).trigger('input');\n        },\n        max_depth: (value) => {\n            // @ts-ignore\n            $('#world_info_min_activations_depth_max').val(value).trigger('input');\n        },\n        max_recursion_steps: (value) => {\n            // @ts-ignore\n            $('#world_info_max_recursion_steps').val(value).trigger('input');\n        },\n        insertion_strategy: (value) => {\n            const converted_value = { evenly: 0, character_first: 1, global_first: 2 }[value];\n            // @ts-ignore\n            $(`#world_info_character_strategy option[value='${converted_value}']`).prop('selected', true);\n            // @ts-ignore\n            $('#world_info_character_strategy').val(converted_value).trigger('change');\n        },\n        include_names: (value) => {\n            // @ts-ignore\n            $('#world_info_include_names').prop('checked', value).trigger('input');\n        },\n        recursive: (value) => {\n            // @ts-ignore\n            $('#world_info_recursive').prop('checked', value).trigger('input');\n        },\n        case_sensitive: (value) => {\n            // @ts-ignore\n            $('#world_info_case_sensitive').prop('checked', value).trigger('input');\n        },\n        match_whole_words: (value) => {\n            // @ts-ignore\n            $('#world_info_match_whole_words').prop('checked', value).trigger('input');\n        },\n        use_group_scoring: (value) => {\n            // @ts-ignore\n            $('#world_info_use_group_scoring').prop('checked', value).trigger('change');\n        },\n        overflow_alert: (value) => {\n            // @ts-ignore\n            $('#world_info_overflow_alert').prop('checked', value).trigger('change');\n        },\n    };\n    Object.entries(settings)\n        .filter(([_, value]) => value !== undefined)\n        .forEach(([field, value]) => {\n        // @ts-ignore\n        for_eachs[field]?.(value);\n    });\n}\nfunction getLorebookSettings() {\n    const lorebook_settings = toLorebookSettings((0,_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.getWorldInfoSettings)());\n    loglevel__WEBPACK_IMPORTED_MODULE_4___default().info(`获取世界书全局设置:\\n${JSON.stringify(lorebook_settings)}`);\n    return structuredClone(lorebook_settings);\n}\nfunction setLorebookSettings(settings) {\n    if (settings.selected_global_lorebooks) {\n        const inexisting_lorebooks = settings.selected_global_lorebooks.filter(lorebook => !_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.world_names.includes(lorebook));\n        if (inexisting_lorebooks.length > 0) {\n            throw Error(`尝试修改要全局启用的世界书, 但未找到以下世界书: ${JSON.stringify(inexisting_lorebooks)}`);\n        }\n    }\n    assignPartialLorebookSettings(settings);\n    loglevel__WEBPACK_IMPORTED_MODULE_4___default().info(`修改世界书全局设置:\\n${JSON.stringify(settings)}`);\n}\nfunction getLorebooks() {\n    loglevel__WEBPACK_IMPORTED_MODULE_4___default().info(`获取世界书列表: ${JSON.stringify(_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.world_names)}`);\n    return structuredClone(_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.world_names);\n}\nasync function deleteLorebook(lorebook) {\n    const success = await (0,_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.deleteWorldInfo)(lorebook);\n    loglevel__WEBPACK_IMPORTED_MODULE_4___default().info(`移除世界书 '${lorebook}' ${success ? '成功' : '失败'}`);\n    return success;\n}\nasync function createLorebook(lorebook) {\n    const success = await (0,_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.createNewWorldInfo)(lorebook, { interactive: false });\n    loglevel__WEBPACK_IMPORTED_MODULE_4___default().info(`新建世界书 '${lorebook}' ${success ? '成功' : '失败'}`);\n    return success;\n}\nfunction getCharLorebooks({ name = _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid]?.avatar ?? null, type = 'all', } = {}) {\n    // @ts-ignore\n    if (_sillytavern_scripts_group_chats__WEBPACK_IMPORTED_MODULE_1__.selected_group && !name) {\n        throw Error(`不要在群组中调用这个功能`);\n    }\n    // @ts-ignore\n    const character = (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_2__.findChar)({ name });\n    if (!character) {\n        throw Error(`未找到名为 '${name}' 的角色卡`);\n    }\n    const books = { primary: null, additional: [] };\n    if (character.data?.extensions?.world) {\n        books.primary = character.data?.extensions?.world;\n    }\n    const filename = (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_2__.getCharaFilename)(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters.indexOf(character));\n    const extraCharLore = _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.world_info.charLore?.find(e => e.name === filename);\n    if (extraCharLore && Array.isArray(extraCharLore.extraBooks)) {\n        books.additional = extraCharLore.extraBooks;\n    }\n    // 根据 type 参数过滤结果\n    if (type) {\n        switch (type) {\n            case 'primary':\n                return { primary: books.primary, additional: [] };\n            case 'additional':\n                return { primary: null, additional: books.additional };\n            case 'all':\n            default:\n                return books;\n        }\n    }\n    loglevel__WEBPACK_IMPORTED_MODULE_4___default().info(`获取角色卡绑定的世界书, 选项: ${JSON.stringify({ name, type })}, 获取结果: ${JSON.stringify(books)}`);\n    return structuredClone(books);\n}\nfunction getCurrentCharPrimaryLorebook() {\n    return getCharLorebooks().primary;\n}\nasync function setCurrentCharLorebooks(lorebooks) {\n    // @ts-ignore\n    if (_sillytavern_scripts_group_chats__WEBPACK_IMPORTED_MODULE_1__.selected_group && !name) {\n        throw Error(`不要在群组中调用这个功能`);\n    }\n    // @ts-ignore\n    const filename = name ?? (0,_sillytavern_scripts_utils__WEBPACK_IMPORTED_MODULE_2__.getCharaFilename)(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid);\n    if (!filename) {\n        throw Error(`未打开任何角色卡`);\n    }\n    const inexisting_lorebooks = [\n        ...(lorebooks.primary && !_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.world_names.includes(lorebooks.primary) ? [lorebooks.primary] : []),\n        ...(lorebooks.additional ? lorebooks.additional.filter(lorebook => !_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.world_names.includes(lorebook)) : []),\n    ];\n    if (inexisting_lorebooks.length > 0) {\n        throw Error(`尝试修改 '${filename}' 绑定的世界书, 但未找到以下世界书: ${inexisting_lorebooks}`);\n    }\n    if (lorebooks.primary !== undefined) {\n        // @ts-ignore\n        const previous_primary = String($('#character_world').val());\n        // @ts-ignore\n        $('#character_world').val(lorebooks.primary ? lorebooks.primary : '');\n        // @ts-ignore\n        $('.character_world_info_selector')\n            .find('option:selected')\n            .val(lorebooks.primary ? _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.world_names.indexOf(lorebooks.primary) : '');\n        if (previous_primary && !lorebooks.primary) {\n            // @ts-ignore\n            const data = JSON.parse(String($('#character_json_data').val()));\n            if (data?.data?.character_book) {\n                data.data.character_book = undefined;\n            }\n            // @ts-ignore\n            $('#character_json_data').val(JSON.stringify(data));\n        }\n        if (!(await editCurrentCharacter())) {\n            throw Error(`尝试为 '${filename}' 绑定主要世界书, 但在访问酒馆后端时出错`);\n        }\n        // @ts-ignore\n        (0,_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.setWorldInfoButtonClass)(undefined, !!lorebooks.primary);\n    }\n    if (lorebooks.additional !== undefined) {\n        const char_lore = _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.world_info.charLore ?? [];\n        const existing_char_index = char_lore.findIndex(entry => entry.name === filename);\n        if (existing_char_index === -1) {\n            char_lore.push({ name: filename, extraBooks: lorebooks.additional });\n        }\n        else if (lorebooks.additional.length === 0) {\n            char_lore.splice(existing_char_index, 1);\n        }\n        else {\n            char_lore[existing_char_index].extraBooks = lorebooks.additional;\n        }\n        Object.assign(_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.world_info, { charLore: char_lore });\n    }\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveCharacterDebounced)();\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveSettingsDebounced)();\n    loglevel__WEBPACK_IMPORTED_MODULE_4___default().info(`修改角色卡绑定的世界书, 要修改的部分: ${JSON.stringify(lorebooks)}${lorebooks.primary === undefined ? ', 主要世界书保持不变' : ''}${lorebooks.additional === undefined ? ', 附加世界书保持不变' : ''}`);\n}\nasync function getChatLorebook() {\n    const chat_id = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.getCurrentChatId)();\n    if (!chat_id) {\n        throw Error(`未打开任何聊天, 不可获取聊天世界书`);\n    }\n    const existing_lorebook = _.get(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat_metadata, _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.METADATA_KEY, '');\n    if (_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.world_names.includes(existing_lorebook)) {\n        return existing_lorebook;\n    }\n    _.unset(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat_metadata, _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.METADATA_KEY);\n    return null;\n}\nasync function setChatLorebook(lorebook) {\n    if (lorebook === null) {\n        _.unset(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat_metadata, _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.METADATA_KEY);\n        $('.chat_lorebook_button').removeClass('world_set');\n    }\n    else {\n        if (!_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.world_names.includes(lorebook)) {\n            throw new Error(`尝试为角色卡绑定聊天世界书, 当该世界书 '${lorebook}' 不存在`);\n        }\n        _.set(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.chat_metadata, _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.METADATA_KEY, lorebook);\n        $('.chat_lorebook_button').addClass('world_set');\n    }\n    await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveMetadata)();\n}\nasync function getOrCreateChatLorebook(lorebook) {\n    const existing_lorebook = await getChatLorebook();\n    if (existing_lorebook !== null) {\n        return existing_lorebook;\n    }\n    const new_lorebook = (() => {\n        if (lorebook) {\n            if (_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.world_names.includes(lorebook)) {\n                throw new Error(`尝试创建聊天世界书, 但该名称 '${lorebook}' 已存在`);\n            }\n            return lorebook;\n        }\n        return `Chat Book ${(0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.getCurrentChatId)()}`\n            .replace(/[^a-z0-9]/gi, '_')\n            .replace(/_{2,}/g, '_')\n            .substring(0, 64);\n    })();\n    await (0,_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_3__.createNewWorldInfo)(new_lorebook);\n    await setChatLorebook(new_lorebook);\n    return new_lorebook;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFBRSxDQUFDO0lBQ0wsTUFBTSxtRkFBa0IsQ0FBQyxZQUFZLENBQUMsQ0FBQztJQUV2QyxNQUFNLGVBQWUsQ0FBQyxZQUFZLENBQUMsQ0FBQztJQUNwQyxPQUFPLFlBQVksQ0FBQztBQUN0QixDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2Z1bmN0aW9uL2xvcmVib29rLnRzPzY3ZTAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgY2hhcmFjdGVycyxcbiAgY2hhdF9tZXRhZGF0YSxcbiAgZ2V0Q3VycmVudENoYXRJZCxcbiAgZ2V0T25lQ2hhcmFjdGVyLFxuICBnZXRSZXF1ZXN0SGVhZGVycyxcbiAgc2F2ZUNoYXJhY3RlckRlYm91bmNlZCxcbiAgc2F2ZU1ldGFkYXRhLFxuICBzYXZlU2V0dGluZ3MsXG4gIHNhdmVTZXR0aW5nc0RlYm91bmNlZCxcbiAgdGhpc19jaGlkLFxufSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0Jztcbi8vIEB0cy1pZ25vcmVcbmltcG9ydCB7IHNlbGVjdGVkX2dyb3VwIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvZ3JvdXAtY2hhdHMnO1xuaW1wb3J0IHsgZW5zdXJlSW1hZ2VGb3JtYXRTdXBwb3J0ZWQsIGZpbmRDaGFyLCBnZXRDaGFyYUZpbGVuYW1lIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvdXRpbHMnO1xuaW1wb3J0IHtcbiAgY3JlYXRlTmV3V29ybGRJbmZvLFxuICBkZWxldGVXb3JsZEluZm8sXG4gIGdldFdvcmxkSW5mb1NldHRpbmdzLFxuICBNRVRBREFUQV9LRVksXG4gIHNlbGVjdGVkX3dvcmxkX2luZm8sXG4gIHNldFdvcmxkSW5mb0J1dHRvbkNsYXNzLFxuICB3b3JsZF9pbmZvLFxuICB3b3JsZF9uYW1lcyxcbn0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvd29ybGQtaW5mbyc7XG5cbmltcG9ydCBsb2cgZnJvbSAnbG9nbGV2ZWwnO1xuXG5pbnRlcmZhY2UgTG9yZWJvb2tTZXR0aW5ncyB7XG4gIHNlbGVjdGVkX2dsb2JhbF9sb3JlYm9va3M6IHN0cmluZ1tdO1xuXG4gIHNjYW5fZGVwdGg6IG51bWJlcjtcbiAgY29udGV4dF9wZXJjZW50YWdlOiBudW1iZXI7XG4gIGJ1ZGdldF9jYXA6IG51bWJlcjsgLy8gMCDooajnpLrnpoHnlKhcbiAgbWluX2FjdGl2YXRpb25zOiBudW1iZXI7XG4gIG1heF9kZXB0aDogbnVtYmVyOyAvLyAwIOihqOekuuaXoOmZkOWItlxuICBtYXhfcmVjdXJzaW9uX3N0ZXBzOiBudW1iZXI7XG5cbiAgaW5zZXJ0aW9uX3N0cmF0ZWd5OiAnZXZlbmx5JyB8ICdjaGFyYWN0ZXJfZmlyc3QnIHwgJ2dsb2JhbF9maXJzdCc7XG5cbiAgaW5jbHVkZV9uYW1lczogYm9vbGVhbjtcbiAgcmVjdXJzaXZlOiBib29sZWFuO1xuICBjYXNlX3NlbnNpdGl2ZTogYm9vbGVhbjtcbiAgbWF0Y2hfd2hvbGVfd29yZHM6IGJvb2xlYW47XG4gIHVzZV9ncm91cF9zY29yaW5nOiBib29sZWFuO1xuICBvdmVyZmxvd19hbGVydDogYm9vbGVhbjtcbn1cblxuYXN5bmMgZnVuY3Rpb24gZWRpdEN1cnJlbnRDaGFyYWN0ZXIoKTogUHJvbWlzZTxib29sZWFuPiB7XG4gIC8vIEB0cy1pZ25vcmVcbiAgJCgnI3JtX2luZm9fYXZhdGFyJykuaHRtbCgnJyk7XG4gIC8vIEB0cy1pZ25vcmVcbiAgY29uc3QgZm9ybV9kYXRhID0gbmV3IEZvcm1EYXRhKCgkKCcjZm9ybV9jcmVhdGUnKSBhcyBKUXVlcnk8SFRNTEZvcm1FbGVtZW50PikuZ2V0KDApKTtcblxuICBjb25zdCByYXdfZmlsZSA9IGZvcm1fZGF0YS5nZXQoJ2F2YXRhcicpO1xuICBpZiAocmF3X2ZpbGUgaW5zdGFuY2VvZiBGaWxlKSB7XG4gICAgY29uc3QgY29udmVydGVkX2ZpbGUgPSBhd2FpdCBlbnN1cmVJbWFnZUZvcm1hdFN1cHBvcnRlZChyYXdfZmlsZSk7XG4gICAgZm9ybV9kYXRhLnNldCgnYXZhdGFyJywgY29udmVydGVkX2ZpbGUpO1xuICB9XG5cbiAgY29uc3QgaGVhZGVycyA9IGdldFJlcXVlc3RIZWFkZXJzKCk7XG4gIC8vIEB0cy1pZ25vcmVcbiAgZGVsZXRlIGhlYWRlcnNbJ0NvbnRlbnQtVHlwZSddO1xuXG4gIC8vIFRPRE86IOi/memHjOeahOS7o+eggeWPr+S7peeUqOadpeS/ruaUueesrOS4gOadoea2iOaBryFcbiAgZm9ybV9kYXRhLmRlbGV0ZSgnYWx0ZXJuYXRlX2dyZWV0aW5ncycpO1xuICAvLyBAdHMtaWdub3JlXG4gIGNvbnN0IGNoaWQgPSAkKCcub3Blbl9hbHRlcm5hdGVfZ3JlZXRpbmdzJykuZGF0YSgnY2hpZCcpO1xuICBpZiAoY2hpZCAmJiBBcnJheS5pc0FycmF5KGNoYXJhY3RlcnNbY2hpZF0/LmRhdGE/LmFsdGVybmF0ZV9ncmVldGluZ3MpKSB7XG4gICAgZm9yIChjb25zdCB2YWx1ZSBvZiBjaGFyYWN0ZXJzW2NoaWRdLmRhdGEuYWx0ZXJuYXRlX2dyZWV0aW5ncykge1xuICAgICAgZm9ybV9kYXRhLmFwcGVuZCgnYWx0ZXJuYXRlX2dyZWV0aW5ncycsIHZhbHVlKTtcbiAgICB9XG4gIH1cblxuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCcvYXBpL2NoYXJhY3RlcnMvZWRpdCcsIHtcbiAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICBoZWFkZXJzOiBoZWFkZXJzLFxuICAgIGJvZHk6IGZvcm1fZGF0YSxcbiAgICBjYWNoZTogJ25vLWNhY2hlJyxcbiAgfSk7XG5cbiAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGF3YWl0IGdldE9uZUNoYXJhY3Rlcihmb3JtX2RhdGEuZ2V0KCdhdmF0YXJfdXJsJykpO1xuICAvLyBAdHMtaWdub3JlXG4gICQoJyNhZGRfYXZhdGFyX2J1dHRvbicpLnJlcGxhY2VXaXRoKCQoJyNhZGRfYXZhdGFyX2J1dHRvbicpLnZhbCgnJykuY2xvbmUodHJ1ZSkpO1xuICAvLyBAdHMtaWdub3JlXG4gICQoJyNjcmVhdGVfYnV0dG9uJykuYXR0cigndmFsdWUnLCAnU2F2ZScpO1xuXG4gIHJldHVybiB0cnVlO1xufVxuXG5mdW5jdGlvbiB0b0xvcmVib29rU2V0dGluZ3Mod29ybGRfaW5mb19zZXR0aW5nczogUmV0dXJuVHlwZTx0eXBlb2YgZ2V0V29ybGRJbmZvU2V0dGluZ3M+KTogTG9yZWJvb2tTZXR0aW5ncyB7XG4gIHJldHVybiB7XG4gICAgc2VsZWN0ZWRfZ2xvYmFsX2xvcmVib29rczogKHdvcmxkX2luZm9fc2V0dGluZ3Mud29ybGRfaW5mbyBhcyB7IGdsb2JhbFNlbGVjdDogc3RyaW5nW10gfSkuZ2xvYmFsU2VsZWN0LFxuXG4gICAgc2Nhbl9kZXB0aDogd29ybGRfaW5mb19zZXR0aW5ncy53b3JsZF9pbmZvX2RlcHRoLFxuICAgIGNvbnRleHRfcGVyY2VudGFnZTogd29ybGRfaW5mb19zZXR0aW5ncy53b3JsZF9pbmZvX2J1ZGdldCxcbiAgICBidWRnZXRfY2FwOiB3b3JsZF9pbmZvX3NldHRpbmdzLndvcmxkX2luZm9fYnVkZ2V0X2NhcCxcbiAgICBtaW5fYWN0aXZhdGlvbnM6IHdvcmxkX2luZm9fc2V0dGluZ3Mud29ybGRfaW5mb19taW5fYWN0aXZhdGlvbnMsXG4gICAgbWF4X2RlcHRoOiB3b3JsZF9pbmZvX3NldHRpbmdzLndvcmxkX2luZm9fbWluX2FjdGl2YXRpb25zX2RlcHRoX21heCxcbiAgICBtYXhfcmVjdXJzaW9uX3N0ZXBzOiB3b3JsZF9pbmZvX3NldHRpbmdzLndvcmxkX2luZm9fbWF4X3JlY3Vyc2lvbl9zdGVwcyxcblxuICAgIGluc2VydGlvbl9zdHJhdGVneTogeyAwOiAnZXZlbmx5JywgMTogJ2NoYXJhY3Rlcl9maXJzdCcsIDI6ICdnbG9iYWxfZmlyc3QnIH1bXG4gICAgICB3b3JsZF9pbmZvX3NldHRpbmdzLndvcmxkX2luZm9fY2hhcmFjdGVyX3N0cmF0ZWd5XG4gICAgXSBhcyAnZXZlbmx5JyB8ICdjaGFyYWN0ZXJfZmlyc3QnIHwgJ2dsb2JhbF9maXJzdCcsXG5cbiAgICBpbmNsdWRlX25hbWVzOiB3b3JsZF9pbmZvX3NldHRpbmdzLndvcmxkX2luZm9faW5jbHVkZV9uYW1lcyxcbiAgICByZWN1cnNpdmU6IHdvcmxkX2luZm9fc2V0dGluZ3Mud29ybGRfaW5mb19yZWN1cnNpdmUsXG4gICAgY2FzZV9zZW5zaXRpdmU6IHdvcmxkX2luZm9fc2V0dGluZ3Mud29ybGRfaW5mb19jYXNlX3NlbnNpdGl2ZSxcbiAgICBtYXRjaF93aG9sZV93b3Jkczogd29ybGRfaW5mb19zZXR0aW5ncy53b3JsZF9pbmZvX21hdGNoX3dob2xlX3dvcmRzLFxuICAgIHVzZV9ncm91cF9zY29yaW5nOiB3b3JsZF9pbmZvX3NldHRpbmdzLndvcmxkX2luZm9fdXNlX2dyb3VwX3Njb3JpbmcsXG4gICAgb3ZlcmZsb3dfYWxlcnQ6IHdvcmxkX2luZm9fc2V0dGluZ3Mud29ybGRfaW5mb19vdmVyZmxvd19hbGVydCxcbiAgfTtcbn1cblxuZnVuY3Rpb24gYXNzaWduUGFydGlhbExvcmVib29rU2V0dGluZ3Moc2V0dGluZ3M6IFBhcnRpYWw8TG9yZWJvb2tTZXR0aW5ncz4pOiB2b2lkIHtcbiAgY29uc3QgZm9yX2VhY2hzID0ge1xuICAgIHNlbGVjdGVkX2dsb2JhbF9sb3JlYm9va3M6ICh2YWx1ZTogTG9yZWJvb2tTZXR0aW5nc1snc2VsZWN0ZWRfZ2xvYmFsX2xvcmVib29rcyddKSA9PiB7XG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAkKCcjd29ybGRfaW5mbycpLmZpbmQoJ29wdGlvblt2YWx1ZSE9XCJcIl0nKS5yZW1vdmUoKTtcbiAgICAgIHdvcmxkX25hbWVzLmZvckVhY2goKGl0ZW0sIGkpID0+XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgJCgnI3dvcmxkX2luZm8nKS5hcHBlbmQoYDxvcHRpb24gdmFsdWU9JyR7aX0nJHt2YWx1ZS5pbmNsdWRlcyhpdGVtKSA/ICcgc2VsZWN0ZWQnIDogJyd9PiR7aXRlbX08L29wdGlvbj5gKSxcbiAgICAgICk7XG5cbiAgICAgIHNlbGVjdGVkX3dvcmxkX2luZm8ubGVuZ3RoID0gMDtcbiAgICAgIHNlbGVjdGVkX3dvcmxkX2luZm8ucHVzaCguLi52YWx1ZSk7XG4gICAgICBzYXZlU2V0dGluZ3MoKTtcbiAgICB9LFxuXG4gICAgc2Nhbl9kZXB0aDogKHZhbHVlOiBMb3JlYm9va1NldHRpbmdzWydzY2FuX2RlcHRoJ10pID0+IHtcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICQoJyN3b3JsZF9pbmZvX2RlcHRoJykudmFsKHZhbHVlKS50cmlnZ2VyKCdpbnB1dCcpO1xuICAgIH0sXG4gICAgY29udGV4dF9wZXJjZW50YWdlOiAodmFsdWU6IExvcmVib29rU2V0dGluZ3NbJ2NvbnRleHRfcGVyY2VudGFnZSddKSA9PiB7XG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAkKCcjd29ybGRfaW5mb19idWRnZXQnKS52YWwodmFsdWUpLnRyaWdnZXIoJ2lucHV0Jyk7XG4gICAgfSxcbiAgICBidWRnZXRfY2FwOiAodmFsdWU6IExvcmVib29rU2V0dGluZ3NbJ2J1ZGdldF9jYXAnXSkgPT4ge1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgJCgnI3dvcmxkX2luZm9fYnVkZ2V0X2NhcCcpLnZhbCh2YWx1ZSkudHJpZ2dlcignaW5wdXQnKTtcbiAgICB9LFxuICAgIG1pbl9hY3RpdmF0aW9uczogKHZhbHVlOiBMb3JlYm9va1NldHRpbmdzWydtaW5fYWN0aXZhdGlvbnMnXSkgPT4ge1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgJCgnI3dvcmxkX2luZm9fbWluX2FjdGl2YXRpb25zJykudmFsKHZhbHVlKS50cmlnZ2VyKCdpbnB1dCcpO1xuICAgIH0sXG4gICAgbWF4X2RlcHRoOiAodmFsdWU6IExvcmVib29rU2V0dGluZ3NbJ21heF9kZXB0aCddKSA9PiB7XG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAkKCcjd29ybGRfaW5mb19taW5fYWN0aXZhdGlvbnNfZGVwdGhfbWF4JykudmFsKHZhbHVlKS50cmlnZ2VyKCdpbnB1dCcpO1xuICAgIH0sXG4gICAgbWF4X3JlY3Vyc2lvbl9zdGVwczogKHZhbHVlOiBMb3JlYm9va1NldHRpbmdzWydtYXhfcmVjdXJzaW9uX3N0ZXBzJ10pID0+IHtcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICQoJyN3b3JsZF9pbmZvX21heF9yZWN1cnNpb25fc3RlcHMnKS52YWwodmFsdWUpLnRyaWdnZXIoJ2lucHV0Jyk7XG4gICAgfSxcblxuICAgIGluc2VydGlvbl9zdHJhdGVneTogKHZhbHVlOiBMb3JlYm9va1NldHRpbmdzWydpbnNlcnRpb25fc3RyYXRlZ3knXSkgPT4ge1xuICAgICAgY29uc3QgY29udmVydGVkX3ZhbHVlID0geyBldmVubHk6IDAsIGNoYXJhY3Rlcl9maXJzdDogMSwgZ2xvYmFsX2ZpcnN0OiAyIH1bdmFsdWVdO1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgJChgI3dvcmxkX2luZm9fY2hhcmFjdGVyX3N0cmF0ZWd5IG9wdGlvblt2YWx1ZT0nJHtjb252ZXJ0ZWRfdmFsdWV9J11gKS5wcm9wKCdzZWxlY3RlZCcsIHRydWUpO1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgJCgnI3dvcmxkX2luZm9fY2hhcmFjdGVyX3N0cmF0ZWd5JykudmFsKGNvbnZlcnRlZF92YWx1ZSkudHJpZ2dlcignY2hhbmdlJyk7XG4gICAgfSxcblxuICAgIGluY2x1ZGVfbmFtZXM6ICh2YWx1ZTogTG9yZWJvb2tTZXR0aW5nc1snaW5jbHVkZV9uYW1lcyddKSA9PiB7XG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAkKCcjd29ybGRfaW5mb19pbmNsdWRlX25hbWVzJykucHJvcCgnY2hlY2tlZCcsIHZhbHVlKS50cmlnZ2VyKCdpbnB1dCcpO1xuICAgIH0sXG4gICAgcmVjdXJzaXZlOiAodmFsdWU6IExvcmVib29rU2V0dGluZ3NbJ3JlY3Vyc2l2ZSddKSA9PiB7XG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAkKCcjd29ybGRfaW5mb19yZWN1cnNpdmUnKS5wcm9wKCdjaGVja2VkJywgdmFsdWUpLnRyaWdnZXIoJ2lucHV0Jyk7XG4gICAgfSxcbiAgICBjYXNlX3NlbnNpdGl2ZTogKHZhbHVlOiBMb3JlYm9va1NldHRpbmdzWydjYXNlX3NlbnNpdGl2ZSddKSA9PiB7XG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAkKCcjd29ybGRfaW5mb19jYXNlX3NlbnNpdGl2ZScpLnByb3AoJ2NoZWNrZWQnLCB2YWx1ZSkudHJpZ2dlcignaW5wdXQnKTtcbiAgICB9LFxuICAgIG1hdGNoX3dob2xlX3dvcmRzOiAodmFsdWU6IExvcmVib29rU2V0dGluZ3NbJ21hdGNoX3dob2xlX3dvcmRzJ10pID0+IHtcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICQoJyN3b3JsZF9pbmZvX21hdGNoX3dob2xlX3dvcmRzJykucHJvcCgnY2hlY2tlZCcsIHZhbHVlKS50cmlnZ2VyKCdpbnB1dCcpO1xuICAgIH0sXG4gICAgdXNlX2dyb3VwX3Njb3Jpbmc6ICh2YWx1ZTogTG9yZWJvb2tTZXR0aW5nc1sndXNlX2dyb3VwX3Njb3JpbmcnXSkgPT4ge1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgJCgnI3dvcmxkX2luZm9fdXNlX2dyb3VwX3Njb3JpbmcnKS5wcm9wKCdjaGVja2VkJywgdmFsdWUpLnRyaWdnZXIoJ2NoYW5nZScpO1xuICAgIH0sXG4gICAgb3ZlcmZsb3dfYWxlcnQ6ICh2YWx1ZTogTG9yZWJvb2tTZXR0aW5nc1snb3ZlcmZsb3dfYWxlcnQnXSkgPT4ge1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgJCgnI3dvcmxkX2luZm9fb3ZlcmZsb3dfYWxlcnQnKS5wcm9wKCdjaGVja2VkJywgdmFsdWUpLnRyaWdnZXIoJ2NoYW5nZScpO1xuICAgIH0sXG4gIH07XG5cbiAgT2JqZWN0LmVudHJpZXMoc2V0dGluZ3MpXG4gICAgLmZpbHRlcigoW18sIHZhbHVlXSkgPT4gdmFsdWUgIT09IHVuZGVmaW5lZClcbiAgICAuZm9yRWFjaCgoW2ZpZWxkLCB2YWx1ZV0pID0+IHtcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgIGZvcl9lYWNoc1tmaWVsZF0/Lih2YWx1ZSk7XG4gICAgfSk7XG59XG5cbmludGVyZmFjZSBHZXRDaGFyTG9yZWJvb2tzT3B0aW9uIHtcbiAgbmFtZT86IHN0cmluZztcbiAgdHlwZT86ICdhbGwnIHwgJ3ByaW1hcnknIHwgJ2FkZGl0aW9uYWwnO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TG9yZWJvb2tTZXR0aW5ncygpOiBMb3JlYm9va1NldHRpbmdzIHtcbiAgY29uc3QgbG9yZWJvb2tfc2V0dGluZ3MgPSB0b0xvcmVib29rU2V0dGluZ3MoZ2V0V29ybGRJbmZvU2V0dGluZ3MoKSk7XG5cbiAgbG9nLmluZm8oYOiOt+WPluS4lueVjOS5puWFqOWxgOiuvue9rjpcXG4ke0pTT04uc3RyaW5naWZ5KGxvcmVib29rX3NldHRpbmdzKX1gKTtcbiAgcmV0dXJuIHN0cnVjdHVyZWRDbG9uZShsb3JlYm9va19zZXR0aW5ncyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzZXRMb3JlYm9va1NldHRpbmdzKHNldHRpbmdzOiBQYXJ0aWFsPExvcmVib29rU2V0dGluZ3M+KTogdm9pZCB7XG4gIGlmIChzZXR0aW5ncy5zZWxlY3RlZF9nbG9iYWxfbG9yZWJvb2tzKSB7XG4gICAgY29uc3QgaW5leGlzdGluZ19sb3JlYm9va3MgPSBzZXR0aW5ncy5zZWxlY3RlZF9nbG9iYWxfbG9yZWJvb2tzLmZpbHRlcihsb3JlYm9vayA9PiAhd29ybGRfbmFtZXMuaW5jbHVkZXMobG9yZWJvb2spKTtcbiAgICBpZiAoaW5leGlzdGluZ19sb3JlYm9va3MubGVuZ3RoID4gMCkge1xuICAgICAgdGhyb3cgRXJyb3IoYOWwneivleS/ruaUueimgeWFqOWxgOWQr+eUqOeahOS4lueVjOS5piwg5L2G5pyq5om+5Yiw5Lul5LiL5LiW55WM5LmmOiAke0pTT04uc3RyaW5naWZ5KGluZXhpc3RpbmdfbG9yZWJvb2tzKX1gKTtcbiAgICB9XG4gIH1cblxuICBhc3NpZ25QYXJ0aWFsTG9yZWJvb2tTZXR0aW5ncyhzZXR0aW5ncyk7XG5cbiAgbG9nLmluZm8oYOS/ruaUueS4lueVjOS5puWFqOWxgOiuvue9rjpcXG4ke0pTT04uc3RyaW5naWZ5KHNldHRpbmdzKX1gKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldExvcmVib29rcygpOiBzdHJpbmdbXSB7XG4gIGxvZy5pbmZvKGDojrflj5bkuJbnlYzkuabliJfooag6ICR7SlNPTi5zdHJpbmdpZnkod29ybGRfbmFtZXMpfWApO1xuICByZXR1cm4gc3RydWN0dXJlZENsb25lKHdvcmxkX25hbWVzKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUxvcmVib29rKGxvcmVib29rOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgY29uc3Qgc3VjY2VzcyA9IGF3YWl0IGRlbGV0ZVdvcmxkSW5mbyhsb3JlYm9vayk7XG5cbiAgbG9nLmluZm8oYOenu+mZpOS4lueVjOS5piAnJHtsb3JlYm9va30nICR7c3VjY2VzcyA/ICfmiJDlip8nIDogJ+Wksei0pSd9YCk7XG4gIHJldHVybiBzdWNjZXNzO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlTG9yZWJvb2sobG9yZWJvb2s6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICBjb25zdCBzdWNjZXNzID0gYXdhaXQgY3JlYXRlTmV3V29ybGRJbmZvKGxvcmVib29rLCB7IGludGVyYWN0aXZlOiBmYWxzZSB9KTtcblxuICBsb2cuaW5mbyhg5paw5bu65LiW55WM5LmmICcke2xvcmVib29rfScgJHtzdWNjZXNzID8gJ+aIkOWKnycgOiAn5aSx6LSlJ31gKTtcbiAgcmV0dXJuIHN1Y2Nlc3M7XG59XG5cbmludGVyZmFjZSBDaGFyTG9yZWJvb2tzIHtcbiAgcHJpbWFyeTogc3RyaW5nIHwgbnVsbDtcbiAgYWRkaXRpb25hbDogc3RyaW5nW107XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDaGFyTG9yZWJvb2tzKHtcbiAgbmFtZSA9IChjaGFyYWN0ZXJzIGFzIGFueSlbdGhpc19jaGlkIGFzIHN0cmluZ10/LmF2YXRhciA/PyBudWxsLFxuICB0eXBlID0gJ2FsbCcsXG59OiBHZXRDaGFyTG9yZWJvb2tzT3B0aW9uID0ge30pOiBDaGFyTG9yZWJvb2tzIHtcbiAgLy8gQHRzLWlnbm9yZVxuICBpZiAoc2VsZWN0ZWRfZ3JvdXAgJiYgIW5hbWUpIHtcbiAgICB0aHJvdyBFcnJvcihg5LiN6KaB5Zyo576k57uE5Lit6LCD55So6L+Z5Liq5Yqf6IO9YCk7XG4gIH1cbiAgLy8gQHRzLWlnbm9yZVxuICBjb25zdCBjaGFyYWN0ZXIgPSBmaW5kQ2hhcih7IG5hbWUgfSk7XG4gIGlmICghY2hhcmFjdGVyKSB7XG4gICAgdGhyb3cgRXJyb3IoYOacquaJvuWIsOWQjeS4uiAnJHtuYW1lfScg55qE6KeS6Imy5Y2hYCk7XG4gIH1cblxuICBjb25zdCBib29rczogQ2hhckxvcmVib29rcyA9IHsgcHJpbWFyeTogbnVsbCwgYWRkaXRpb25hbDogW10gfTtcblxuICBpZiAoY2hhcmFjdGVyLmRhdGE/LmV4dGVuc2lvbnM/LndvcmxkKSB7XG4gICAgYm9va3MucHJpbWFyeSA9IGNoYXJhY3Rlci5kYXRhPy5leHRlbnNpb25zPy53b3JsZDtcbiAgfVxuXG4gIGNvbnN0IGZpbGVuYW1lID0gZ2V0Q2hhcmFGaWxlbmFtZShjaGFyYWN0ZXJzLmluZGV4T2YoY2hhcmFjdGVyKSkgYXMgc3RyaW5nO1xuICBjb25zdCBleHRyYUNoYXJMb3JlID0gKHdvcmxkX2luZm8gYXMgeyBjaGFyTG9yZTogeyBuYW1lOiBzdHJpbmc7IGV4dHJhQm9va3M6IHN0cmluZ1tdIH1bXSB9KS5jaGFyTG9yZT8uZmluZChcbiAgICBlID0+IGUubmFtZSA9PT0gZmlsZW5hbWUsXG4gICk7XG4gIGlmIChleHRyYUNoYXJMb3JlICYmIEFycmF5LmlzQXJyYXkoZXh0cmFDaGFyTG9yZS5leHRyYUJvb2tzKSkge1xuICAgIGJvb2tzLmFkZGl0aW9uYWwgPSBleHRyYUNoYXJMb3JlLmV4dHJhQm9va3M7XG4gIH1cblxuICAvLyDmoLnmja4gdHlwZSDlj4LmlbDov4fmu6Tnu5PmnpxcbiAgaWYgKHR5cGUpIHtcbiAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgIGNhc2UgJ3ByaW1hcnknOlxuICAgICAgICByZXR1cm4geyBwcmltYXJ5OiBib29rcy5wcmltYXJ5LCBhZGRpdGlvbmFsOiBbXSB9O1xuICAgICAgY2FzZSAnYWRkaXRpb25hbCc6XG4gICAgICAgIHJldHVybiB7IHByaW1hcnk6IG51bGwsIGFkZGl0aW9uYWw6IGJvb2tzLmFkZGl0aW9uYWwgfTtcbiAgICAgIGNhc2UgJ2FsbCc6XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gYm9va3M7XG4gICAgfVxuICB9XG5cbiAgbG9nLmluZm8oYOiOt+WPluinkuiJsuWNoee7keWumueahOS4lueVjOS5piwg6YCJ6aG5OiAke0pTT04uc3RyaW5naWZ5KHsgbmFtZSwgdHlwZSB9KX0sIOiOt+WPlue7k+aenDogJHtKU09OLnN0cmluZ2lmeShib29rcyl9YCk7XG4gIHJldHVybiBzdHJ1Y3R1cmVkQ2xvbmUoYm9va3MpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q3VycmVudENoYXJQcmltYXJ5TG9yZWJvb2soKTogc3RyaW5nIHwgbnVsbCB7XG4gIHJldHVybiBnZXRDaGFyTG9yZWJvb2tzKCkucHJpbWFyeTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNldEN1cnJlbnRDaGFyTG9yZWJvb2tzKGxvcmVib29rczogUGFydGlhbDxDaGFyTG9yZWJvb2tzPik6IFByb21pc2U8dm9pZD4ge1xuICAvLyBAdHMtaWdub3JlXG4gIGlmIChzZWxlY3RlZF9ncm91cCAmJiAhbmFtZSkge1xuICAgIHRocm93IEVycm9yKGDkuI3opoHlnKjnvqTnu4TkuK3osIPnlKjov5nkuKrlip/og71gKTtcbiAgfVxuICAvLyBAdHMtaWdub3JlXG4gIGNvbnN0IGZpbGVuYW1lID0gbmFtZSA/PyBnZXRDaGFyYUZpbGVuYW1lKHRoaXNfY2hpZCk7XG4gIGlmICghZmlsZW5hbWUpIHtcbiAgICB0aHJvdyBFcnJvcihg5pyq5omT5byA5Lu75L2V6KeS6Imy5Y2hYCk7XG4gIH1cblxuICBjb25zdCBpbmV4aXN0aW5nX2xvcmVib29rczogc3RyaW5nW10gPSBbXG4gICAgLi4uKGxvcmVib29rcy5wcmltYXJ5ICYmICF3b3JsZF9uYW1lcy5pbmNsdWRlcyhsb3JlYm9va3MucHJpbWFyeSkgPyBbbG9yZWJvb2tzLnByaW1hcnldIDogW10pLFxuICAgIC4uLihsb3JlYm9va3MuYWRkaXRpb25hbCA/IGxvcmVib29rcy5hZGRpdGlvbmFsLmZpbHRlcihsb3JlYm9vayA9PiAhd29ybGRfbmFtZXMuaW5jbHVkZXMobG9yZWJvb2spKSA6IFtdKSxcbiAgXTtcbiAgaWYgKGluZXhpc3RpbmdfbG9yZWJvb2tzLmxlbmd0aCA+IDApIHtcbiAgICB0aHJvdyBFcnJvcihg5bCd6K+V5L+u5pS5ICcke2ZpbGVuYW1lfScg57uR5a6a55qE5LiW55WM5LmmLCDkvYbmnKrmib7liLDku6XkuIvkuJbnlYzkuaY6ICR7aW5leGlzdGluZ19sb3JlYm9va3N9YCk7XG4gIH1cblxuICBpZiAobG9yZWJvb2tzLnByaW1hcnkgIT09IHVuZGVmaW5lZCkge1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBjb25zdCBwcmV2aW91c19wcmltYXJ5ID0gU3RyaW5nKCQoJyNjaGFyYWN0ZXJfd29ybGQnKS52YWwoKSk7XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgICQoJyNjaGFyYWN0ZXJfd29ybGQnKS52YWwobG9yZWJvb2tzLnByaW1hcnkgPyBsb3JlYm9va3MucHJpbWFyeSA6ICcnKTtcblxuICAgIC8vIEB0cy1pZ25vcmVcbiAgICAkKCcuY2hhcmFjdGVyX3dvcmxkX2luZm9fc2VsZWN0b3InKVxuICAgICAgLmZpbmQoJ29wdGlvbjpzZWxlY3RlZCcpXG4gICAgICAudmFsKGxvcmVib29rcy5wcmltYXJ5ID8gd29ybGRfbmFtZXMuaW5kZXhPZihsb3JlYm9va3MucHJpbWFyeSkgOiAnJyk7XG5cbiAgICBpZiAocHJldmlvdXNfcHJpbWFyeSAmJiAhbG9yZWJvb2tzLnByaW1hcnkpIHtcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKFN0cmluZygkKCcjY2hhcmFjdGVyX2pzb25fZGF0YScpLnZhbCgpKSk7XG4gICAgICBpZiAoZGF0YT8uZGF0YT8uY2hhcmFjdGVyX2Jvb2spIHtcbiAgICAgICAgZGF0YS5kYXRhLmNoYXJhY3Rlcl9ib29rID0gdW5kZWZpbmVkO1xuICAgICAgfVxuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgJCgnI2NoYXJhY3Rlcl9qc29uX2RhdGEnKS52YWwoSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xuICAgIH1cblxuICAgIGlmICghKGF3YWl0IGVkaXRDdXJyZW50Q2hhcmFjdGVyKCkpKSB7XG4gICAgICB0aHJvdyBFcnJvcihg5bCd6K+V5Li6ICcke2ZpbGVuYW1lfScg57uR5a6a5Li76KaB5LiW55WM5LmmLCDkvYblnKjorr/pl67phZLppoblkI7nq6/ml7blh7rplJlgKTtcbiAgICB9XG5cbiAgICAvLyBAdHMtaWdub3JlXG4gICAgc2V0V29ybGRJbmZvQnV0dG9uQ2xhc3ModW5kZWZpbmVkLCAhIWxvcmVib29rcy5wcmltYXJ5KTtcbiAgfVxuXG4gIGlmIChsb3JlYm9va3MuYWRkaXRpb25hbCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgaW50ZXJmYWNlIENoYXJMb3JlRW50cnkge1xuICAgICAgbmFtZTogc3RyaW5nO1xuICAgICAgZXh0cmFCb29rczogc3RyaW5nW107XG4gICAgfVxuICAgIGNvbnN0IGNoYXJfbG9yZSA9ICh3b3JsZF9pbmZvIGFzIHsgY2hhckxvcmU6IENoYXJMb3JlRW50cnlbXSB9KS5jaGFyTG9yZSA/PyBbXTtcblxuICAgIGNvbnN0IGV4aXN0aW5nX2NoYXJfaW5kZXggPSBjaGFyX2xvcmUuZmluZEluZGV4KGVudHJ5ID0+IGVudHJ5Lm5hbWUgPT09IGZpbGVuYW1lKTtcbiAgICBpZiAoZXhpc3RpbmdfY2hhcl9pbmRleCA9PT0gLTEpIHtcbiAgICAgIGNoYXJfbG9yZS5wdXNoKHsgbmFtZTogZmlsZW5hbWUsIGV4dHJhQm9va3M6IGxvcmVib29rcy5hZGRpdGlvbmFsIH0pO1xuICAgIH0gZWxzZSBpZiAobG9yZWJvb2tzLmFkZGl0aW9uYWwubGVuZ3RoID09PSAwKSB7XG4gICAgICBjaGFyX2xvcmUuc3BsaWNlKGV4aXN0aW5nX2NoYXJfaW5kZXgsIDEpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjaGFyX2xvcmVbZXhpc3RpbmdfY2hhcl9pbmRleF0uZXh0cmFCb29rcyA9IGxvcmVib29rcy5hZGRpdGlvbmFsO1xuICAgIH1cblxuICAgIE9iamVjdC5hc3NpZ24od29ybGRfaW5mbywgeyBjaGFyTG9yZTogY2hhcl9sb3JlIH0pO1xuICB9XG5cbiAgc2F2ZUNoYXJhY3RlckRlYm91bmNlZCgpO1xuICBzYXZlU2V0dGluZ3NEZWJvdW5jZWQoKTtcblxuICBsb2cuaW5mbyhcbiAgICBg5L+u5pS56KeS6Imy5Y2h57uR5a6a55qE5LiW55WM5LmmLCDopoHkv67mlLnnmoTpg6jliIY6ICR7SlNPTi5zdHJpbmdpZnkobG9yZWJvb2tzKX0ke1xuICAgICAgbG9yZWJvb2tzLnByaW1hcnkgPT09IHVuZGVmaW5lZCA/ICcsIOS4u+imgeS4lueVjOS5puS/neaMgeS4jeWPmCcgOiAnJ1xuICAgIH0ke2xvcmVib29rcy5hZGRpdGlvbmFsID09PSB1bmRlZmluZWQgPyAnLCDpmYTliqDkuJbnlYzkuabkv53mjIHkuI3lj5gnIDogJyd9YCxcbiAgKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENoYXRMb3JlYm9vaygpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgY29uc3QgY2hhdF9pZCA9IGdldEN1cnJlbnRDaGF0SWQoKTtcbiAgaWYgKCFjaGF0X2lkKSB7XG4gICAgdGhyb3cgRXJyb3IoYOacquaJk+W8gOS7u+S9leiBiuWkqSwg5LiN5Y+v6I635Y+W6IGK5aSp5LiW55WM5LmmYCk7XG4gIH1cblxuICBjb25zdCBleGlzdGluZ19sb3JlYm9vayA9IF8uZ2V0KGNoYXRfbWV0YWRhdGEsIE1FVEFEQVRBX0tFWSwgJycpIGFzIHN0cmluZztcbiAgaWYgKHdvcmxkX25hbWVzLmluY2x1ZGVzKGV4aXN0aW5nX2xvcmVib29rKSkge1xuICAgIHJldHVybiBleGlzdGluZ19sb3JlYm9vaztcbiAgfVxuICBfLnVuc2V0KGNoYXRfbWV0YWRhdGEsIE1FVEFEQVRBX0tFWSk7XG4gIHJldHVybiBudWxsO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2V0Q2hhdExvcmVib29rKGxvcmVib29rOiBzdHJpbmcgfCBudWxsKTogUHJvbWlzZTx2b2lkPiB7XG4gIGlmIChsb3JlYm9vayA9PT0gbnVsbCkge1xuICAgIF8udW5zZXQoY2hhdF9tZXRhZGF0YSwgTUVUQURBVEFfS0VZKTtcbiAgICAkKCcuY2hhdF9sb3JlYm9va19idXR0b24nKS5yZW1vdmVDbGFzcygnd29ybGRfc2V0Jyk7XG4gIH0gZWxzZSB7XG4gICAgaWYgKCF3b3JsZF9uYW1lcy5pbmNsdWRlcyhsb3JlYm9vaykpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihg5bCd6K+V5Li66KeS6Imy5Y2h57uR5a6a6IGK5aSp5LiW55WM5LmmLCDlvZPor6XkuJbnlYzkuaYgJyR7bG9yZWJvb2t9JyDkuI3lrZjlnKhgKTtcbiAgICB9XG5cbiAgICBfLnNldChjaGF0X21ldGFkYXRhLCBNRVRBREFUQV9LRVksIGxvcmVib29rKTtcbiAgICAkKCcuY2hhdF9sb3JlYm9va19idXR0b24nKS5hZGRDbGFzcygnd29ybGRfc2V0Jyk7XG4gIH1cbiAgYXdhaXQgc2F2ZU1ldGFkYXRhKCk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRPckNyZWF0ZUNoYXRMb3JlYm9vayhsb3JlYm9vaz86IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gIGNvbnN0IGV4aXN0aW5nX2xvcmVib29rID0gYXdhaXQgZ2V0Q2hhdExvcmVib29rKCk7XG4gIGlmIChleGlzdGluZ19sb3JlYm9vayAhPT0gbnVsbCkge1xuICAgIHJldHVybiBleGlzdGluZ19sb3JlYm9vaztcbiAgfVxuXG4gIGNvbnN0IG5ld19sb3JlYm9vayA9ICgoKSA9PiB7XG4gICAgaWYgKGxvcmVib29rKSB7XG4gICAgICBpZiAod29ybGRfbmFtZXMuaW5jbHVkZXMobG9yZWJvb2spKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihg5bCd6K+V5Yib5bu66IGK5aSp5LiW55WM5LmmLCDkvYbor6XlkI3np7AgJyR7bG9yZWJvb2t9JyDlt7LlrZjlnKhgKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBsb3JlYm9vaztcbiAgICB9XG5cbiAgICByZXR1cm4gYENoYXQgQm9vayAke2dldEN1cnJlbnRDaGF0SWQoKX1gXG4gICAgICAucmVwbGFjZSgvW15hLXowLTldL2dpLCAnXycpXG4gICAgICAucmVwbGFjZSgvX3syLH0vZywgJ18nKVxuICAgICAgLnN1YnN0cmluZygwLCA2NCk7XG4gIH0pKCk7XG4gIGF3YWl0IGNyZWF0ZU5ld1dvcmxkSW5mbyhuZXdfbG9yZWJvb2spO1xuXG4gIGF3YWl0IHNldENoYXRMb3JlYm9vayhuZXdfbG9yZWJvb2spO1xuICByZXR1cm4gbmV3X2xvcmVib29rO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/function/lorebook.ts\n")},"./src/function/lorebook_entry.ts":
/*!****************************************!*\
  !*** ./src/function/lorebook_entry.ts ***!
  \****************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createLorebookEntries: () => (/* binding */ createLorebookEntries),\n/* harmony export */   createLorebookEntry: () => (/* binding */ createLorebookEntry),\n/* harmony export */   deleteLorebookEntries: () => (/* binding */ deleteLorebookEntries),\n/* harmony export */   deleteLorebookEntry: () => (/* binding */ deleteLorebookEntry),\n/* harmony export */   getLorebookEntries: () => (/* binding */ getLorebookEntries),\n/* harmony export */   replaceLorebookEntries: () => (/* binding */ replaceLorebookEntries),\n/* harmony export */   setLorebookEntries: () => (/* binding */ setLorebookEntries),\n/* harmony export */   updateLorebookEntriesWith: () => (/* binding */ updateLorebookEntriesWith)\n/* harmony export */ });\n/* harmony import */ var _compatibility__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/compatibility */ \"./src/compatibility.ts\");\n/* harmony import */ var _sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/world-info */ \"@sillytavern/scripts/world-info\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\nconst default_original_lorebook_entry = {\n    key: [],\n    keysecondary: [],\n    comment: '',\n    content: '',\n    constant: false,\n    vectorized: false,\n    selective: true,\n    selectiveLogic: 0,\n    addMemo: true,\n    order: 100,\n    position: 0,\n    disable: false,\n    excludeRecursion: false,\n    preventRecursion: false,\n    matchPersonaDescription: false,\n    matchCharacterDescription: false,\n    matchCharacterPersonality: false,\n    matchCharacterDepthPrompt: false,\n    matchScenario: false,\n    matchCreatorNotes: false,\n    delayUntilRecursion: 0,\n    probability: 100,\n    useProbability: true,\n    depth: 4,\n    group: '',\n    groupOverride: false,\n    groupWeight: 100,\n    scanDepth: null,\n    caseSensitive: null,\n    matchWholeWords: null,\n    useGroupScoring: null,\n    automationId: '',\n    role: 0,\n    sticky: null,\n    cooldown: null,\n    delay: null,\n};\nfunction toLorebookEntry(entry) {\n    return {\n        uid: entry.uid,\n        display_index: entry.displayIndex,\n        comment: entry.comment,\n        enabled: !entry.disable,\n        type: entry.constant ? 'constant' : entry.vectorized ? 'vectorized' : 'selective',\n        // @ts-ignore\n        position: {\n            0: 'before_character_definition',\n            1: 'after_character_definition',\n            5: 'before_example_messages',\n            6: 'after_example_messages',\n            2: 'before_author_note',\n            3: 'after_author_note',\n        }[entry.position] ??\n            (entry.role === 0 ? 'at_depth_as_system' : entry.role === 1 ? 'at_depth_as_user' : 'at_depth_as_assistant'),\n        depth: entry.position === 4 ? entry.depth : null,\n        order: entry.order,\n        probability: entry.probability,\n        key: entry.key,\n        keys: entry.key,\n        logic: {\n            0: 'and_any',\n            1: 'and_all',\n            2: 'not_any',\n            3: 'not_all',\n        }[entry.selectiveLogic],\n        filter: entry.keysecondary,\n        filters: entry.keysecondary,\n        scan_depth: entry.scanDepth ?? 'same_as_global',\n        case_sensitive: entry.caseSensitive ?? 'same_as_global',\n        match_whole_words: entry.matchWholeWords ?? 'same_as_global',\n        use_group_scoring: entry.useGroupScoring ?? 'same_as_global',\n        automation_id: entry.automationId || null,\n        exclude_recursion: entry.excludeRecursion,\n        prevent_recursion: entry.preventRecursion,\n        delay_until_recursion: entry.delayUntilRecursion,\n        content: entry.content,\n        group: entry.group,\n        group_prioritized: entry.groupOverride,\n        group_weight: entry.groupWeight,\n        sticky: entry.sticky || null,\n        cooldown: entry.cooldown || null,\n        delay: entry.delay || null,\n    };\n}\nasync function getLorebookEntries(lorebook, { filter = 'none' } = {}) {\n    if (!_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_1__.world_names.includes(lorebook)) {\n        throw Error(`未能找到世界书 '${lorebook}'`);\n    }\n    // @ts-ignore\n    let entries = Object.values((await (0,_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_1__.loadWorldInfo)(lorebook)).entries).map(toLorebookEntry);\n    if (filter !== 'none') {\n        entries = entries.filter(entry => Object.entries(filter).every(([field, expected_value]) => {\n            // @ts-ignore\n            const entry_value = entry[field];\n            if (Array.isArray(entry_value)) {\n                return expected_value.every(value => entry_value.includes(value));\n            }\n            if (typeof entry_value === 'string') {\n                return entry_value.includes(expected_value);\n            }\n            return entry_value === expected_value;\n        }));\n    }\n    loglevel__WEBPACK_IMPORTED_MODULE_2___default().info(`获取世界书 '${lorebook}' 中的条目, 选项: ${JSON.stringify({ filter })}`);\n    return structuredClone(entries);\n}\nfunction fromPartialLorebookEntry(entry) {\n    if (_.has(entry, 'key') && !_.has(entry, 'keys')) {\n        _.set(entry, 'keys', entry.key);\n    }\n    if (_.has(entry, 'filter') && !_.has(entry, 'filters')) {\n        _.set(entry, 'filters', entry.filter);\n    }\n    const transformers = {\n        uid: (value) => ({ uid: value }),\n        display_index: (value) => ({ displayIndex: value }),\n        comment: (value) => ({ comment: value }),\n        enabled: (value) => ({ disable: !value }),\n        type: (value) => ({\n            constant: value === 'constant',\n            vectorized: value === 'vectorized',\n        }),\n        position: (value) => ({\n            position: {\n                before_character_definition: 0,\n                after_character_definition: 1,\n                before_example_messages: 5,\n                after_example_messages: 6,\n                before_author_note: 2,\n                after_author_note: 3,\n                at_depth_as_system: 4,\n                at_depth_as_user: 4,\n                at_depth_as_assistant: 4,\n            }[value],\n            role: \n            // @ts-ignore\n            {\n                at_depth_as_system: 0,\n                at_depth_as_user: 1,\n                at_depth_as_assistant: 2,\n            }[value] ?? null,\n        }),\n        depth: (value) => ({ depth: value === null ? 4 : value }),\n        order: (value) => ({ order: value }),\n        probability: (value) => ({ probability: value }),\n        keys: (value) => ({ key: value }),\n        logic: (value) => ({\n            selectiveLogic: {\n                and_any: 0,\n                and_all: 1,\n                not_any: 2,\n                not_all: 3,\n            }[value],\n        }),\n        filters: (value) => ({ keysecondary: value }),\n        scan_depth: (value) => ({ scanDepth: value === 'same_as_global' ? null : value }),\n        case_sensitive: (value) => ({\n            caseSensitive: value === 'same_as_global' ? null : value,\n        }),\n        match_whole_words: (value) => ({\n            matchWholeWords: value === 'same_as_global' ? null : value,\n        }),\n        use_group_scoring: (value) => ({\n            useGroupScoring: value === 'same_as_global' ? null : value,\n        }),\n        automation_id: (value) => ({ automationId: value === null ? '' : value }),\n        exclude_recursion: (value) => ({ excludeRecursion: value }),\n        prevent_recursion: (value) => ({ preventRecursion: value }),\n        delay_until_recursion: (value) => ({ delayUntilRecursion: value }),\n        content: (value) => ({ content: value }),\n        group: (value) => ({ group: value }),\n        group_prioritized: (value) => ({ groupOverride: value }),\n        group_weight: (value) => ({ groupWeight: value }),\n        sticky: (value) => ({ sticky: value === null ? 0 : value }),\n        cooldown: (value) => ({ cooldown: value === null ? 0 : value }),\n        delay: (value) => ({ delay: value === null ? 0 : value }),\n    };\n    return _.merge({}, default_original_lorebook_entry, ...Object.entries(entry)\n        .filter(([_, value]) => value !== undefined)\n        // @ts-ignore\n        .map(([key, value]) => transformers[key]?.(value)));\n}\nconst MAX_UID = 1_000_000;\nfunction handleLorebookEntriesCollision(entries) {\n    const uid_set = new Set();\n    const handle_uid_collision = (index) => {\n        if (index === undefined) {\n            index = _.random(0, MAX_UID - 1);\n        }\n        let i = 1;\n        while (true) {\n            if (!uid_set.has(index)) {\n                uid_set.add(index);\n                return index;\n            }\n            index = (index + i * i) % MAX_UID;\n            ++i;\n        }\n    };\n    let max_display_index = _.max(entries.map(entry => entry.display_index ?? -1)) ?? -1;\n    return entries.map(entry => ({\n        ...entry,\n        uid: handle_uid_collision(entry.uid),\n        display_index: entry.display_index ?? ++max_display_index,\n    }));\n}\nasync function replaceLorebookEntries(lorebook, entries) {\n    if (!_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_1__.world_names.includes(lorebook)) {\n        throw Error(`未能找到世界书 '${lorebook}'`);\n    }\n    const data = {\n        entries: _.merge({}, ...handleLorebookEntriesCollision(entries)\n            .map(fromPartialLorebookEntry)\n            .map(entry => ({ [entry.uid]: entry }))),\n    };\n    await (0,_sillytavern_scripts_world_info__WEBPACK_IMPORTED_MODULE_1__.saveWorldInfo)(lorebook, data);\n    (0,_compatibility__WEBPACK_IMPORTED_MODULE_0__.reloadEditorDebounced)(lorebook);\n    loglevel__WEBPACK_IMPORTED_MODULE_2___default().info(`更新世界书 '${lorebook}' 中的条目`);\n}\nasync function updateLorebookEntriesWith(lorebook, updater) {\n    loglevel__WEBPACK_IMPORTED_MODULE_2___default().info(`对世界书 '${lorebook}' 中的条目进行更新`);\n    await replaceLorebookEntries(lorebook, await updater(await getLorebookEntries(lorebook)));\n    return getLorebookEntries(lorebook);\n}\nasync function setLorebookEntries(lorebook, entries) {\n    return await updateLorebookEntriesWith(lorebook, data => {\n        for (const entry_to_set of entries) {\n            const data_entry = data.find(entry => entry.uid === entry_to_set.uid);\n            if (data_entry) {\n                _.merge(data_entry, entry_to_set);\n            }\n        }\n        return data;\n    });\n}\nasync function createLorebookEntries(lorebook, entries) {\n    const new_uids = [];\n    const updated_entries = await updateLorebookEntriesWith(lorebook, data => {\n        const uid_set = new Set(data.map(entry => entry.uid));\n        const get_free_uid = () => {\n            for (let i = 0; i < MAX_UID; ++i) {\n                if (!uid_set.has(i)) {\n                    uid_set.add(i);\n                    new_uids.push(i);\n                    return i;\n                }\n            }\n            throw Error(`无法找到可用的世界书条目 uid`);\n        };\n        entries.forEach(entry => (entry.uid = get_free_uid()));\n        return [...data, ...entries];\n    });\n    return { entries: updated_entries, new_uids: new_uids };\n}\nasync function deleteLorebookEntries(lorebook, uids) {\n    let deleted = false;\n    const updated_entires = await updateLorebookEntriesWith(lorebook, data => {\n        const removed_data = _.remove(data, entry => uids.includes(entry.uid));\n        deleted = removed_data.length > 0;\n        return data;\n    });\n    return { entries: updated_entires, delete_occurred: deleted };\n}\n//----------------------------------------------------------------------------------------------------------------------\n/** @deprecated 请使用 `createLorebookEntries` 代替 */\nasync function createLorebookEntry(lorebook, field_values) {\n    return (await createLorebookEntries(lorebook, [field_values])).new_uids[0];\n}\n/** @deprecated 请使用 `deleteLorebookEntries` 代替 */\nasync function deleteLorebookEntry(lorebook, uid) {\n    return (await deleteLorebookEntries(lorebook, [uid])).delete_occurred;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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aURBQWlEO0FBQzFDLEtBQUssVUFBVSxtQkFBbUIsQ0FBQyxRQUFnQixFQUFFLEdBQVc7SUFDckUsT0FBTyxDQUFDLE1BQU0scUJBQXFCLENBQUMsUUFBUSxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLGVBQWUsQ0FBQztBQUN4RSxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2Z1bmN0aW9uL2xvcmVib29rX2VudHJ5LnRzPzJhZjgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcmVsb2FkRWRpdG9yRGVib3VuY2VkIH0gZnJvbSAnQC9jb21wYXRpYmlsaXR5JztcblxuaW1wb3J0IHsgbG9hZFdvcmxkSW5mbywgc2F2ZVdvcmxkSW5mbywgd29ybGRfbmFtZXMgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy93b3JsZC1pbmZvJztcblxuaW1wb3J0IGxvZyBmcm9tICdsb2dsZXZlbCc7XG5cbmludGVyZmFjZSBMb3JlYm9va0VudHJ5IHtcbiAgdWlkOiBudW1iZXI7XG4gIGRpc3BsYXlfaW5kZXg6IG51bWJlcjtcblxuICBjb21tZW50OiBzdHJpbmc7XG4gIGVuYWJsZWQ6IGJvb2xlYW47XG4gIHR5cGU6ICdjb25zdGFudCcgfCAnc2VsZWN0aXZlJyB8ICd2ZWN0b3JpemVkJztcbiAgcG9zaXRpb246XG4gICAgfCAnYmVmb3JlX2NoYXJhY3Rlcl9kZWZpbml0aW9uJyAvLyDop5LoibLlrprkuYnkuYvliY1cbiAgICB8ICdhZnRlcl9jaGFyYWN0ZXJfZGVmaW5pdGlvbicgLy8g6KeS6Imy5a6a5LmJ5LmL5ZCOXG4gICAgfCAnYmVmb3JlX2V4YW1wbGVfbWVzc2FnZXMnIC8vIOekuuS+i+a2iOaBr+S5i+WJjVxuICAgIHwgJ2FmdGVyX2V4YW1wbGVfbWVzc2FnZXMnIC8vIOekuuS+i+a2iOaBr+S5i+WQjlxuICAgIHwgJ2JlZm9yZV9hdXRob3Jfbm90ZScgLy8g5L2c6ICF5rOo6YeK5LmL5YmNXG4gICAgfCAnYWZ0ZXJfYXV0aG9yX25vdGUnIC8vIOS9nOiAheazqOmHiuS5i+WQjlxuICAgIHwgJ2F0X2RlcHRoX2FzX3N5c3RlbScgLy8gQETimplcbiAgICB8ICdhdF9kZXB0aF9hc19hc3Npc3RhbnQnIC8vIEBE8J+RpFxuICAgIHwgJ2F0X2RlcHRoX2FzX3VzZXInOyAvLyBARPCfpJZcbiAgZGVwdGg6IG51bWJlciB8IG51bGw7XG4gIG9yZGVyOiBudW1iZXI7XG4gIHByb2JhYmlsaXR5OiBudW1iZXI7XG5cbiAgLyoqIEBkZXByZWNhdGVkIOivt+S9v+eUqCBga2V5c2Ag5Luj5pu/ICovXG4gIGtleTogc3RyaW5nW107XG4gIGtleXM6IHN0cmluZ1tdO1xuICBsb2dpYzogJ2FuZF9hbnknIHwgJ2FuZF9hbGwnIHwgJ25vdF9hbGwnIHwgJ25vdF9hbnknO1xuICAvKiogQGRlcHJlY2F0ZWQg6K+35L2/55SoIGBmaWx0ZXJzYCDku6Pmm78gKi9cbiAgZmlsdGVyOiBzdHJpbmdbXTtcbiAgZmlsdGVyczogc3RyaW5nW107XG5cbiAgc2Nhbl9kZXB0aDogJ3NhbWVfYXNfZ2xvYmFsJyB8IG51bWJlcjtcbiAgY2FzZV9zZW5zaXRpdmU6ICdzYW1lX2FzX2dsb2JhbCcgfCBib29sZWFuO1xuICBtYXRjaF93aG9sZV93b3JkczogJ3NhbWVfYXNfZ2xvYmFsJyB8IGJvb2xlYW47XG4gIHVzZV9ncm91cF9zY29yaW5nOiAnc2FtZV9hc19nbG9iYWwnIHwgYm9vbGVhbjtcbiAgYXV0b21hdGlvbl9pZDogc3RyaW5nIHwgbnVsbDtcblxuICBleGNsdWRlX3JlY3Vyc2lvbjogYm9vbGVhbjtcbiAgcHJldmVudF9yZWN1cnNpb246IGJvb2xlYW47XG4gIGRlbGF5X3VudGlsX3JlY3Vyc2lvbjogYm9vbGVhbiB8IG51bWJlcjtcblxuICBjb250ZW50OiBzdHJpbmc7XG5cbiAgZ3JvdXA6IHN0cmluZztcbiAgZ3JvdXBfcHJpb3JpdGl6ZWQ6IGJvb2xlYW47XG4gIGdyb3VwX3dlaWdodDogbnVtYmVyO1xuICBzdGlja3k6IG51bWJlciB8IG51bGw7XG4gIGNvb2xkb3duOiBudW1iZXIgfCBudWxsO1xuICBkZWxheTogbnVtYmVyIHwgbnVsbDtcbn1cblxuaW50ZXJmYWNlIF9PcmlnaW5hbExvcmVib29rRW50cnkge1xuICB1aWQ6IG51bWJlcjtcbiAga2V5OiBzdHJpbmdbXTtcbiAga2V5c2Vjb25kYXJ5OiBzdHJpbmdbXTtcbiAgY29tbWVudDogc3RyaW5nO1xuICBjb250ZW50OiBzdHJpbmc7XG4gIGNvbnN0YW50OiBib29sZWFuO1xuICB2ZWN0b3JpemVkOiBib29sZWFuO1xuICBzZWxlY3RpdmU6IGJvb2xlYW47XG4gIHNlbGVjdGl2ZUxvZ2ljOiAwIHwgMSB8IDIgfCAzOyAvLyAwOiBhbmRfYW55LCAxOiBhbmRfYWxsLCAyOiBub3RfYW55LCAzOiBub3RfYWxsXG4gIGFkZE1lbW86IGJvb2xlYW47XG4gIG9yZGVyOiBudW1iZXI7XG4gIHBvc2l0aW9uOiBudW1iZXI7XG4gIGRpc2FibGU6IGJvb2xlYW47XG4gIGV4Y2x1ZGVSZWN1cnNpb246IGJvb2xlYW47XG4gIHByZXZlbnRSZWN1cnNpb246IGJvb2xlYW47XG4gIG1hdGNoUGVyc29uYURlc2NyaXB0aW9uOiBib29sZWFuO1xuICBtYXRjaENoYXJhY3RlckRlc2NyaXB0aW9uOiBib29sZWFuO1xuICBtYXRjaENoYXJhY3RlclBlcnNvbmFsaXR5OiBib29sZWFuO1xuICBtYXRjaENoYXJhY3RlckRlcHRoUHJvbXB0OiBib29sZWFuO1xuICBtYXRjaFNjZW5hcmlvOiBib29sZWFuO1xuICBtYXRjaENyZWF0b3JOb3RlczogYm9vbGVhbjtcbiAgZGVsYXlVbnRpbFJlY3Vyc2lvbjogbnVtYmVyO1xuICBwcm9iYWJpbGl0eTogbnVtYmVyO1xuICB1c2VQcm9iYWJpbGl0eTogYm9vbGVhbjtcbiAgZGVwdGg6IG51bWJlcjtcbiAgZ3JvdXA6IHN0cmluZztcbiAgZ3JvdXBPdmVycmlkZTogYm9vbGVhbjtcbiAgZ3JvdXBXZWlnaHQ6IG51bWJlcjtcbiAgc2NhbkRlcHRoOiBudW1iZXIgfCBudWxsO1xuICBjYXNlU2Vuc2l0aXZlOiBib29sZWFuIHwgbnVsbDtcbiAgbWF0Y2hXaG9sZVdvcmRzOiBib29sZWFuIHwgbnVsbDtcbiAgdXNlR3JvdXBTY29yaW5nOiBib29sZWFuIHwgbnVsbDtcbiAgYXV0b21hdGlvbklkOiBzdHJpbmc7XG4gIHJvbGU6IDAgfCAxIHwgMjsgLy8gMDogc3lzdGVtLCAxOiB1c2VyLCAyOiBhc3Npc3RhbnRcbiAgc3RpY2t5OiBudW1iZXIgfCBudWxsO1xuICBjb29sZG93bjogbnVtYmVyIHwgbnVsbDtcbiAgZGVsYXk6IG51bWJlciB8IG51bGw7XG4gIGRpc3BsYXlJbmRleDogbnVtYmVyO1xufVxuXG5jb25zdCBkZWZhdWx0X29yaWdpbmFsX2xvcmVib29rX2VudHJ5OiBPbWl0PF9PcmlnaW5hbExvcmVib29rRW50cnksICd1aWQnIHwgJ2Rpc3BsYXlJbmRleCc+ID0ge1xuICBrZXk6IFtdLFxuICBrZXlzZWNvbmRhcnk6IFtdLFxuICBjb21tZW50OiAnJyxcbiAgY29udGVudDogJycsXG4gIGNvbnN0YW50OiBmYWxzZSxcbiAgdmVjdG9yaXplZDogZmFsc2UsXG4gIHNlbGVjdGl2ZTogdHJ1ZSxcbiAgc2VsZWN0aXZlTG9naWM6IDAsXG4gIGFkZE1lbW86IHRydWUsXG4gIG9yZGVyOiAxMDAsXG4gIHBvc2l0aW9uOiAwLFxuICBkaXNhYmxlOiBmYWxzZSxcbiAgZXhjbHVkZVJlY3Vyc2lvbjogZmFsc2UsXG4gIHByZXZlbnRSZWN1cnNpb246IGZhbHNlLFxuICBtYXRjaFBlcnNvbmFEZXNjcmlwdGlvbjogZmFsc2UsXG4gIG1hdGNoQ2hhcmFjdGVyRGVzY3JpcHRpb246IGZhbHNlLFxuICBtYXRjaENoYXJhY3RlclBlcnNvbmFsaXR5OiBmYWxzZSxcbiAgbWF0Y2hDaGFyYWN0ZXJEZXB0aFByb21wdDogZmFsc2UsXG4gIG1hdGNoU2NlbmFyaW86IGZhbHNlLFxuICBtYXRjaENyZWF0b3JOb3RlczogZmFsc2UsXG4gIGRlbGF5VW50aWxSZWN1cnNpb246IDAsXG4gIHByb2JhYmlsaXR5OiAxMDAsXG4gIHVzZVByb2JhYmlsaXR5OiB0cnVlLFxuICBkZXB0aDogNCxcbiAgZ3JvdXA6ICcnLFxuICBncm91cE92ZXJyaWRlOiBmYWxzZSxcbiAgZ3JvdXBXZWlnaHQ6IDEwMCxcbiAgc2NhbkRlcHRoOiBudWxsLFxuICBjYXNlU2Vuc2l0aXZlOiBudWxsLFxuICBtYXRjaFdob2xlV29yZHM6IG51bGwsXG4gIHVzZUdyb3VwU2NvcmluZzogbnVsbCxcbiAgYXV0b21hdGlvbklkOiAnJyxcbiAgcm9sZTogMCxcbiAgc3RpY2t5OiBudWxsLFxuICBjb29sZG93bjogbnVsbCxcbiAgZGVsYXk6IG51bGwsXG59O1xuXG5mdW5jdGlvbiB0b0xvcmVib29rRW50cnkoZW50cnk6IF9PcmlnaW5hbExvcmVib29rRW50cnkpOiBMb3JlYm9va0VudHJ5IHtcbiAgcmV0dXJuIHtcbiAgICB1aWQ6IGVudHJ5LnVpZCxcbiAgICBkaXNwbGF5X2luZGV4OiBlbnRyeS5kaXNwbGF5SW5kZXgsXG5cbiAgICBjb21tZW50OiBlbnRyeS5jb21tZW50LFxuICAgIGVuYWJsZWQ6ICFlbnRyeS5kaXNhYmxlLFxuICAgIHR5cGU6IGVudHJ5LmNvbnN0YW50ID8gJ2NvbnN0YW50JyA6IGVudHJ5LnZlY3Rvcml6ZWQgPyAndmVjdG9yaXplZCcgOiAnc2VsZWN0aXZlJyxcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgcG9zaXRpb246XG4gICAgICB7XG4gICAgICAgIDA6ICdiZWZvcmVfY2hhcmFjdGVyX2RlZmluaXRpb24nLFxuICAgICAgICAxOiAnYWZ0ZXJfY2hhcmFjdGVyX2RlZmluaXRpb24nLFxuICAgICAgICA1OiAnYmVmb3JlX2V4YW1wbGVfbWVzc2FnZXMnLFxuICAgICAgICA2OiAnYWZ0ZXJfZXhhbXBsZV9tZXNzYWdlcycsXG4gICAgICAgIDI6ICdiZWZvcmVfYXV0aG9yX25vdGUnLFxuICAgICAgICAzOiAnYWZ0ZXJfYXV0aG9yX25vdGUnLFxuICAgICAgfVtlbnRyeS5wb3NpdGlvbl0gPz9cbiAgICAgIChlbnRyeS5yb2xlID09PSAwID8gJ2F0X2RlcHRoX2FzX3N5c3RlbScgOiBlbnRyeS5yb2xlID09PSAxID8gJ2F0X2RlcHRoX2FzX3VzZXInIDogJ2F0X2RlcHRoX2FzX2Fzc2lzdGFudCcpLFxuICAgIGRlcHRoOiBlbnRyeS5wb3NpdGlvbiA9PT0gNCA/IGVudHJ5LmRlcHRoIDogbnVsbCxcbiAgICBvcmRlcjogZW50cnkub3JkZXIsXG4gICAgcHJvYmFiaWxpdHk6IGVudHJ5LnByb2JhYmlsaXR5LFxuXG4gICAga2V5OiBlbnRyeS5rZXksXG4gICAga2V5czogZW50cnkua2V5LFxuICAgIGxvZ2ljOiB7XG4gICAgICAwOiAnYW5kX2FueScsXG4gICAgICAxOiAnYW5kX2FsbCcsXG4gICAgICAyOiAnbm90X2FueScsXG4gICAgICAzOiAnbm90X2FsbCcsXG4gICAgfVtlbnRyeS5zZWxlY3RpdmVMb2dpYyBhcyBudW1iZXJdIGFzICdhbmRfYW55JyB8ICdhbmRfYWxsJyB8ICdub3RfYW55JyB8ICdub3RfYWxsJyxcbiAgICBmaWx0ZXI6IGVudHJ5LmtleXNlY29uZGFyeSxcbiAgICBmaWx0ZXJzOiBlbnRyeS5rZXlzZWNvbmRhcnksXG5cbiAgICBzY2FuX2RlcHRoOiBlbnRyeS5zY2FuRGVwdGggPz8gJ3NhbWVfYXNfZ2xvYmFsJyxcbiAgICBjYXNlX3NlbnNpdGl2ZTogZW50cnkuY2FzZVNlbnNpdGl2ZSA/PyAnc2FtZV9hc19nbG9iYWwnLFxuICAgIG1hdGNoX3dob2xlX3dvcmRzOiBlbnRyeS5tYXRjaFdob2xlV29yZHMgPz8gJ3NhbWVfYXNfZ2xvYmFsJyxcbiAgICB1c2VfZ3JvdXBfc2NvcmluZzogZW50cnkudXNlR3JvdXBTY29yaW5nID8/ICdzYW1lX2FzX2dsb2JhbCcsXG4gICAgYXV0b21hdGlvbl9pZDogZW50cnkuYXV0b21hdGlvbklkIHx8IG51bGwsXG5cbiAgICBleGNsdWRlX3JlY3Vyc2lvbjogZW50cnkuZXhjbHVkZVJlY3Vyc2lvbixcbiAgICBwcmV2ZW50X3JlY3Vyc2lvbjogZW50cnkucHJldmVudFJlY3Vyc2lvbixcbiAgICBkZWxheV91bnRpbF9yZWN1cnNpb246IGVudHJ5LmRlbGF5VW50aWxSZWN1cnNpb24sXG5cbiAgICBjb250ZW50OiBlbnRyeS5jb250ZW50LFxuXG4gICAgZ3JvdXA6IGVudHJ5Lmdyb3VwLFxuICAgIGdyb3VwX3ByaW9yaXRpemVkOiBlbnRyeS5ncm91cE92ZXJyaWRlLFxuICAgIGdyb3VwX3dlaWdodDogZW50cnkuZ3JvdXBXZWlnaHQsXG4gICAgc3RpY2t5OiBlbnRyeS5zdGlja3kgfHwgbnVsbCxcbiAgICBjb29sZG93bjogZW50cnkuY29vbGRvd24gfHwgbnVsbCxcbiAgICBkZWxheTogZW50cnkuZGVsYXkgfHwgbnVsbCxcbiAgfTtcbn1cblxuaW50ZXJmYWNlIEdldExvcmVib29rRW50cmllc09wdGlvbiB7XG4gIGZpbHRlcj86ICdub25lJyB8IFBhcnRpYWw8TG9yZWJvb2tFbnRyeT47XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRMb3JlYm9va0VudHJpZXMoXG4gIGxvcmVib29rOiBzdHJpbmcsXG4gIHsgZmlsdGVyID0gJ25vbmUnIH06IEdldExvcmVib29rRW50cmllc09wdGlvbiA9IHt9LFxuKTogUHJvbWlzZTxMb3JlYm9va0VudHJ5W10+IHtcbiAgaWYgKCF3b3JsZF9uYW1lcy5pbmNsdWRlcyhsb3JlYm9vaykpIHtcbiAgICB0aHJvdyBFcnJvcihg5pyq6IO95om+5Yiw5LiW55WM5LmmICcke2xvcmVib29rfSdgKTtcbiAgfVxuXG4gIC8vIEB0cy1pZ25vcmVcbiAgbGV0IGVudHJpZXM6IExvcmVib29rRW50cnlbXSA9IE9iamVjdC52YWx1ZXMoKGF3YWl0IGxvYWRXb3JsZEluZm8obG9yZWJvb2spKS5lbnRyaWVzKS5tYXAodG9Mb3JlYm9va0VudHJ5KTtcbiAgaWYgKGZpbHRlciAhPT0gJ25vbmUnKSB7XG4gICAgZW50cmllcyA9IGVudHJpZXMuZmlsdGVyKGVudHJ5ID0+XG4gICAgICBPYmplY3QuZW50cmllcyhmaWx0ZXIpLmV2ZXJ5KChbZmllbGQsIGV4cGVjdGVkX3ZhbHVlXSkgPT4ge1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGNvbnN0IGVudHJ5X3ZhbHVlID0gZW50cnlbZmllbGRdO1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShlbnRyeV92YWx1ZSkpIHtcbiAgICAgICAgICByZXR1cm4gKGV4cGVjdGVkX3ZhbHVlIGFzIHN0cmluZ1tdKS5ldmVyeSh2YWx1ZSA9PiBlbnRyeV92YWx1ZS5pbmNsdWRlcyh2YWx1ZSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgZW50cnlfdmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgcmV0dXJuIGVudHJ5X3ZhbHVlLmluY2x1ZGVzKGV4cGVjdGVkX3ZhbHVlIGFzIHN0cmluZyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGVudHJ5X3ZhbHVlID09PSBleHBlY3RlZF92YWx1ZTtcbiAgICAgIH0pLFxuICAgICk7XG4gIH1cblxuICBsb2cuaW5mbyhg6I635Y+W5LiW55WM5LmmICcke2xvcmVib29rfScg5Lit55qE5p2h55uuLCDpgInpobk6ICR7SlNPTi5zdHJpbmdpZnkoeyBmaWx0ZXIgfSl9YCk7XG4gIHJldHVybiBzdHJ1Y3R1cmVkQ2xvbmUoZW50cmllcyk7XG59XG5cbmZ1bmN0aW9uIGZyb21QYXJ0aWFsTG9yZWJvb2tFbnRyeShcbiAgZW50cnk6IFBpY2s8TG9yZWJvb2tFbnRyeSwgJ3VpZCcgfCAnZGlzcGxheV9pbmRleCc+ICYgUGFydGlhbDxMb3JlYm9va0VudHJ5Pixcbik6IFBpY2s8X09yaWdpbmFsTG9yZWJvb2tFbnRyeSwgJ3VpZCcgfCAnZGlzcGxheUluZGV4Jz4gJiBQYXJ0aWFsPF9PcmlnaW5hbExvcmVib29rRW50cnk+IHtcbiAgaWYgKF8uaGFzKGVudHJ5LCAna2V5JykgJiYgIV8uaGFzKGVudHJ5LCAna2V5cycpKSB7XG4gICAgXy5zZXQoZW50cnksICdrZXlzJywgZW50cnkua2V5KTtcbiAgfVxuICBpZiAoXy5oYXMoZW50cnksICdmaWx0ZXInKSAmJiAhXy5oYXMoZW50cnksICdmaWx0ZXJzJykpIHtcbiAgICBfLnNldChlbnRyeSwgJ2ZpbHRlcnMnLCBlbnRyeS5maWx0ZXIpO1xuICB9XG5cbiAgY29uc3QgdHJhbnNmb3JtZXJzID0ge1xuICAgIHVpZDogKHZhbHVlOiBMb3JlYm9va0VudHJ5Wyd1aWQnXSkgPT4gKHsgdWlkOiB2YWx1ZSB9KSxcbiAgICBkaXNwbGF5X2luZGV4OiAodmFsdWU6IExvcmVib29rRW50cnlbJ2Rpc3BsYXlfaW5kZXgnXSkgPT4gKHsgZGlzcGxheUluZGV4OiB2YWx1ZSB9KSxcblxuICAgIGNvbW1lbnQ6ICh2YWx1ZTogTG9yZWJvb2tFbnRyeVsnY29tbWVudCddKSA9PiAoeyBjb21tZW50OiB2YWx1ZSB9KSxcbiAgICBlbmFibGVkOiAodmFsdWU6IExvcmVib29rRW50cnlbJ2VuYWJsZWQnXSkgPT4gKHsgZGlzYWJsZTogIXZhbHVlIH0pLFxuICAgIHR5cGU6ICh2YWx1ZTogTG9yZWJvb2tFbnRyeVsndHlwZSddKSA9PiAoe1xuICAgICAgY29uc3RhbnQ6IHZhbHVlID09PSAnY29uc3RhbnQnLFxuICAgICAgdmVjdG9yaXplZDogdmFsdWUgPT09ICd2ZWN0b3JpemVkJyxcbiAgICB9KSxcbiAgICBwb3NpdGlvbjogKHZhbHVlOiBMb3JlYm9va0VudHJ5Wydwb3NpdGlvbiddKSA9PiAoe1xuICAgICAgcG9zaXRpb246IHtcbiAgICAgICAgYmVmb3JlX2NoYXJhY3Rlcl9kZWZpbml0aW9uOiAwLFxuICAgICAgICBhZnRlcl9jaGFyYWN0ZXJfZGVmaW5pdGlvbjogMSxcbiAgICAgICAgYmVmb3JlX2V4YW1wbGVfbWVzc2FnZXM6IDUsXG4gICAgICAgIGFmdGVyX2V4YW1wbGVfbWVzc2FnZXM6IDYsXG4gICAgICAgIGJlZm9yZV9hdXRob3Jfbm90ZTogMixcbiAgICAgICAgYWZ0ZXJfYXV0aG9yX25vdGU6IDMsXG4gICAgICAgIGF0X2RlcHRoX2FzX3N5c3RlbTogNCxcbiAgICAgICAgYXRfZGVwdGhfYXNfdXNlcjogNCxcbiAgICAgICAgYXRfZGVwdGhfYXNfYXNzaXN0YW50OiA0LFxuICAgICAgfVt2YWx1ZV0sXG4gICAgICByb2xlOlxuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIHtcbiAgICAgICAgICBhdF9kZXB0aF9hc19zeXN0ZW06IDAsXG4gICAgICAgICAgYXRfZGVwdGhfYXNfdXNlcjogMSxcbiAgICAgICAgICBhdF9kZXB0aF9hc19hc3Npc3RhbnQ6IDIsXG4gICAgICAgIH1bdmFsdWVdID8/IG51bGwsXG4gICAgfSksXG4gICAgZGVwdGg6ICh2YWx1ZTogTG9yZWJvb2tFbnRyeVsnZGVwdGgnXSkgPT4gKHsgZGVwdGg6IHZhbHVlID09PSBudWxsID8gNCA6IHZhbHVlIH0pLFxuICAgIG9yZGVyOiAodmFsdWU6IExvcmVib29rRW50cnlbJ29yZGVyJ10pID0+ICh7IG9yZGVyOiB2YWx1ZSB9KSxcbiAgICBwcm9iYWJpbGl0eTogKHZhbHVlOiBMb3JlYm9va0VudHJ5Wydwcm9iYWJpbGl0eSddKSA9PiAoeyBwcm9iYWJpbGl0eTogdmFsdWUgfSksXG5cbiAgICBrZXlzOiAodmFsdWU6IExvcmVib29rRW50cnlbJ2tleXMnXSkgPT4gKHsga2V5OiB2YWx1ZSB9KSxcbiAgICBsb2dpYzogKHZhbHVlOiBMb3JlYm9va0VudHJ5Wydsb2dpYyddKSA9PiAoe1xuICAgICAgc2VsZWN0aXZlTG9naWM6IHtcbiAgICAgICAgYW5kX2FueTogMCxcbiAgICAgICAgYW5kX2FsbDogMSxcbiAgICAgICAgbm90X2FueTogMixcbiAgICAgICAgbm90X2FsbDogMyxcbiAgICAgIH1bdmFsdWVdLFxuICAgIH0pLFxuICAgIGZpbHRlcnM6ICh2YWx1ZTogTG9yZWJvb2tFbnRyeVsnZmlsdGVyJ10pID0+ICh7IGtleXNlY29uZGFyeTogdmFsdWUgfSksXG5cbiAgICBzY2FuX2RlcHRoOiAodmFsdWU6IExvcmVib29rRW50cnlbJ3NjYW5fZGVwdGgnXSkgPT4gKHsgc2NhbkRlcHRoOiB2YWx1ZSA9PT0gJ3NhbWVfYXNfZ2xvYmFsJyA/IG51bGwgOiB2YWx1ZSB9KSxcbiAgICBjYXNlX3NlbnNpdGl2ZTogKHZhbHVlOiBMb3JlYm9va0VudHJ5WydjYXNlX3NlbnNpdGl2ZSddKSA9PiAoe1xuICAgICAgY2FzZVNlbnNpdGl2ZTogdmFsdWUgPT09ICdzYW1lX2FzX2dsb2JhbCcgPyBudWxsIDogdmFsdWUsXG4gICAgfSksXG4gICAgbWF0Y2hfd2hvbGVfd29yZHM6ICh2YWx1ZTogTG9yZWJvb2tFbnRyeVsnbWF0Y2hfd2hvbGVfd29yZHMnXSkgPT4gKHtcbiAgICAgIG1hdGNoV2hvbGVXb3JkczogdmFsdWUgPT09ICdzYW1lX2FzX2dsb2JhbCcgPyBudWxsIDogdmFsdWUsXG4gICAgfSksXG4gICAgdXNlX2dyb3VwX3Njb3Jpbmc6ICh2YWx1ZTogTG9yZWJvb2tFbnRyeVsndXNlX2dyb3VwX3Njb3JpbmcnXSkgPT4gKHtcbiAgICAgIHVzZUdyb3VwU2NvcmluZzogdmFsdWUgPT09ICdzYW1lX2FzX2dsb2JhbCcgPyBudWxsIDogdmFsdWUsXG4gICAgfSksXG4gICAgYXV0b21hdGlvbl9pZDogKHZhbHVlOiBMb3JlYm9va0VudHJ5WydhdXRvbWF0aW9uX2lkJ10pID0+ICh7IGF1dG9tYXRpb25JZDogdmFsdWUgPT09IG51bGwgPyAnJyA6IHZhbHVlIH0pLFxuXG4gICAgZXhjbHVkZV9yZWN1cnNpb246ICh2YWx1ZTogTG9yZWJvb2tFbnRyeVsnZXhjbHVkZV9yZWN1cnNpb24nXSkgPT4gKHsgZXhjbHVkZVJlY3Vyc2lvbjogdmFsdWUgfSksXG4gICAgcHJldmVudF9yZWN1cnNpb246ICh2YWx1ZTogTG9yZWJvb2tFbnRyeVsncHJldmVudF9yZWN1cnNpb24nXSkgPT4gKHsgcHJldmVudFJlY3Vyc2lvbjogdmFsdWUgfSksXG4gICAgZGVsYXlfdW50aWxfcmVjdXJzaW9uOiAodmFsdWU6IExvcmVib29rRW50cnlbJ2RlbGF5X3VudGlsX3JlY3Vyc2lvbiddKSA9PiAoeyBkZWxheVVudGlsUmVjdXJzaW9uOiB2YWx1ZSB9KSxcblxuICAgIGNvbnRlbnQ6ICh2YWx1ZTogTG9yZWJvb2tFbnRyeVsnY29udGVudCddKSA9PiAoeyBjb250ZW50OiB2YWx1ZSB9KSxcblxuICAgIGdyb3VwOiAodmFsdWU6IExvcmVib29rRW50cnlbJ2dyb3VwJ10pID0+ICh7IGdyb3VwOiB2YWx1ZSB9KSxcbiAgICBncm91cF9wcmlvcml0aXplZDogKHZhbHVlOiBMb3JlYm9va0VudHJ5Wydncm91cF9wcmlvcml0aXplZCddKSA9PiAoeyBncm91cE92ZXJyaWRlOiB2YWx1ZSB9KSxcbiAgICBncm91cF93ZWlnaHQ6ICh2YWx1ZTogTG9yZWJvb2tFbnRyeVsnZ3JvdXBfd2VpZ2h0J10pID0+ICh7IGdyb3VwV2VpZ2h0OiB2YWx1ZSB9KSxcbiAgICBzdGlja3k6ICh2YWx1ZTogTG9yZWJvb2tFbnRyeVsnc3RpY2t5J10pID0+ICh7IHN0aWNreTogdmFsdWUgPT09IG51bGwgPyAwIDogdmFsdWUgfSksXG4gICAgY29vbGRvd246ICh2YWx1ZTogTG9yZWJvb2tFbnRyeVsnY29vbGRvd24nXSkgPT4gKHsgY29vbGRvd246IHZhbHVlID09PSBudWxsID8gMCA6IHZhbHVlIH0pLFxuICAgIGRlbGF5OiAodmFsdWU6IExvcmVib29rRW50cnlbJ2RlbGF5J10pID0+ICh7IGRlbGF5OiB2YWx1ZSA9PT0gbnVsbCA/IDAgOiB2YWx1ZSB9KSxcbiAgfTtcblxuICByZXR1cm4gXy5tZXJnZShcbiAgICB7fSxcbiAgICBkZWZhdWx0X29yaWdpbmFsX2xvcmVib29rX2VudHJ5LFxuICAgIC4uLk9iamVjdC5lbnRyaWVzKGVudHJ5KVxuICAgICAgLmZpbHRlcigoW18sIHZhbHVlXSkgPT4gdmFsdWUgIT09IHVuZGVmaW5lZClcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgIC5tYXAoKFtrZXksIHZhbHVlXSkgPT4gdHJhbnNmb3JtZXJzW2tleV0/Lih2YWx1ZSkpLFxuICApO1xufVxuXG5jb25zdCBNQVhfVUlEID0gMV8wMDBfMDAwO1xuXG5mdW5jdGlvbiBoYW5kbGVMb3JlYm9va0VudHJpZXNDb2xsaXNpb24oXG4gIGVudHJpZXM6IFBhcnRpYWw8TG9yZWJvb2tFbnRyeT5bXSxcbik6IEFycmF5PFBpY2s8TG9yZWJvb2tFbnRyeSwgJ3VpZCcgfCAnZGlzcGxheV9pbmRleCc+ICYgUGFydGlhbDxMb3JlYm9va0VudHJ5Pj4ge1xuICBjb25zdCB1aWRfc2V0ID0gbmV3IFNldDxudW1iZXI+KCk7XG4gIGNvbnN0IGhhbmRsZV91aWRfY29sbGlzaW9uID0gKGluZGV4OiBudW1iZXIgfCB1bmRlZmluZWQpID0+IHtcbiAgICBpZiAoaW5kZXggPT09IHVuZGVmaW5lZCkge1xuICAgICAgaW5kZXggPSBfLnJhbmRvbSgwLCBNQVhfVUlEIC0gMSk7XG4gICAgfVxuXG4gICAgbGV0IGkgPSAxO1xuICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICBpZiAoIXVpZF9zZXQuaGFzKGluZGV4KSkge1xuICAgICAgICB1aWRfc2V0LmFkZChpbmRleCk7XG4gICAgICAgIHJldHVybiBpbmRleDtcbiAgICAgIH1cblxuICAgICAgaW5kZXggPSAoaW5kZXggKyBpICogaSkgJSBNQVhfVUlEO1xuICAgICAgKytpO1xuICAgIH1cbiAgfTtcblxuICBsZXQgbWF4X2Rpc3BsYXlfaW5kZXggPSBfLm1heChlbnRyaWVzLm1hcChlbnRyeSA9PiBlbnRyeS5kaXNwbGF5X2luZGV4ID8/IC0xKSkgPz8gLTE7XG4gIHJldHVybiBlbnRyaWVzLm1hcChlbnRyeSA9PiAoe1xuICAgIC4uLmVudHJ5LFxuICAgIHVpZDogaGFuZGxlX3VpZF9jb2xsaXNpb24oZW50cnkudWlkKSxcbiAgICBkaXNwbGF5X2luZGV4OiBlbnRyeS5kaXNwbGF5X2luZGV4ID8/ICsrbWF4X2Rpc3BsYXlfaW5kZXgsXG4gIH0pKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlcGxhY2VMb3JlYm9va0VudHJpZXMobG9yZWJvb2s6IHN0cmluZywgZW50cmllczogUGFydGlhbDxMb3JlYm9va0VudHJ5PltdKTogUHJvbWlzZTx2b2lkPiB7XG4gIGlmICghd29ybGRfbmFtZXMuaW5jbHVkZXMobG9yZWJvb2spKSB7XG4gICAgdGhyb3cgRXJyb3IoYOacquiDveaJvuWIsOS4lueVjOS5piAnJHtsb3JlYm9va30nYCk7XG4gIH1cblxuICBjb25zdCBkYXRhID0ge1xuICAgIGVudHJpZXM6IF8ubWVyZ2UoXG4gICAgICB7fSxcbiAgICAgIC4uLmhhbmRsZUxvcmVib29rRW50cmllc0NvbGxpc2lvbihlbnRyaWVzKVxuICAgICAgICAubWFwKGZyb21QYXJ0aWFsTG9yZWJvb2tFbnRyeSlcbiAgICAgICAgLm1hcChlbnRyeSA9PiAoeyBbZW50cnkudWlkXTogZW50cnkgfSkpLFxuICAgICksXG4gIH07XG4gIGF3YWl0IHNhdmVXb3JsZEluZm8obG9yZWJvb2ssIGRhdGEpO1xuICByZWxvYWRFZGl0b3JEZWJvdW5jZWQobG9yZWJvb2spO1xuXG4gIGxvZy5pbmZvKGDmm7TmlrDkuJbnlYzkuaYgJyR7bG9yZWJvb2t9JyDkuK3nmoTmnaHnm65gKTtcbn1cblxudHlwZSBMb3JlYm9va0VudHJpZXNVcGRhdGVyID1cbiAgfCAoKGVudHJpZXM6IExvcmVib29rRW50cnlbXSkgPT4gUGFydGlhbDxMb3JlYm9va0VudHJ5PltdKVxuICB8ICgoZW50cmllczogTG9yZWJvb2tFbnRyeVtdKSA9PiBQcm9taXNlPFBhcnRpYWw8TG9yZWJvb2tFbnRyeT5bXT4pO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlTG9yZWJvb2tFbnRyaWVzV2l0aChcbiAgbG9yZWJvb2s6IHN0cmluZyxcbiAgdXBkYXRlcjogTG9yZWJvb2tFbnRyaWVzVXBkYXRlcixcbik6IFByb21pc2U8TG9yZWJvb2tFbnRyeVtdPiB7XG4gIGxvZy5pbmZvKGDlr7nkuJbnlYzkuaYgJyR7bG9yZWJvb2t9JyDkuK3nmoTmnaHnm67ov5vooYzmm7TmlrBgKTtcbiAgYXdhaXQgcmVwbGFjZUxvcmVib29rRW50cmllcyhsb3JlYm9vaywgYXdhaXQgdXBkYXRlcihhd2FpdCBnZXRMb3JlYm9va0VudHJpZXMobG9yZWJvb2spKSk7XG4gIHJldHVybiBnZXRMb3JlYm9va0VudHJpZXMobG9yZWJvb2spO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2V0TG9yZWJvb2tFbnRyaWVzKFxuICBsb3JlYm9vazogc3RyaW5nLFxuICBlbnRyaWVzOiBBcnJheTxQaWNrPExvcmVib29rRW50cnksICd1aWQnPiAmIFBhcnRpYWw8TG9yZWJvb2tFbnRyeT4+LFxuKTogUHJvbWlzZTxMb3JlYm9va0VudHJ5W10+IHtcbiAgcmV0dXJuIGF3YWl0IHVwZGF0ZUxvcmVib29rRW50cmllc1dpdGgobG9yZWJvb2ssIGRhdGEgPT4ge1xuICAgIGZvciAoY29uc3QgZW50cnlfdG9fc2V0IG9mIGVudHJpZXMpIHtcbiAgICAgIGNvbnN0IGRhdGFfZW50cnkgPSBkYXRhLmZpbmQoZW50cnkgPT4gZW50cnkudWlkID09PSBlbnRyeV90b19zZXQudWlkKTtcbiAgICAgIGlmIChkYXRhX2VudHJ5KSB7XG4gICAgICAgIF8ubWVyZ2UoZGF0YV9lbnRyeSwgZW50cnlfdG9fc2V0KTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGRhdGE7XG4gIH0pO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlTG9yZWJvb2tFbnRyaWVzKFxuICBsb3JlYm9vazogc3RyaW5nLFxuICBlbnRyaWVzOiBQYXJ0aWFsPExvcmVib29rRW50cnk+W10sXG4pOiBQcm9taXNlPHsgZW50cmllczogTG9yZWJvb2tFbnRyeVtdOyBuZXdfdWlkczogbnVtYmVyW10gfT4ge1xuICBjb25zdCBuZXdfdWlkczogbnVtYmVyW10gPSBbXTtcbiAgY29uc3QgdXBkYXRlZF9lbnRyaWVzID0gYXdhaXQgdXBkYXRlTG9yZWJvb2tFbnRyaWVzV2l0aChsb3JlYm9vaywgZGF0YSA9PiB7XG4gICAgY29uc3QgdWlkX3NldCA9IG5ldyBTZXQoZGF0YS5tYXAoZW50cnkgPT4gZW50cnkudWlkKSk7XG4gICAgY29uc3QgZ2V0X2ZyZWVfdWlkID0gKCkgPT4ge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBNQVhfVUlEOyArK2kpIHtcbiAgICAgICAgaWYgKCF1aWRfc2V0LmhhcyhpKSkge1xuICAgICAgICAgIHVpZF9zZXQuYWRkKGkpO1xuICAgICAgICAgIG5ld191aWRzLnB1c2goaSk7XG4gICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHRocm93IEVycm9yKGDml6Dms5Xmib7liLDlj6/nlKjnmoTkuJbnlYzkuabmnaHnm64gdWlkYCk7XG4gICAgfTtcblxuICAgIGVudHJpZXMuZm9yRWFjaChlbnRyeSA9PiAoZW50cnkudWlkID0gZ2V0X2ZyZWVfdWlkKCkpKTtcbiAgICByZXR1cm4gWy4uLmRhdGEsIC4uLmVudHJpZXNdO1xuICB9KTtcbiAgcmV0dXJuIHsgZW50cmllczogdXBkYXRlZF9lbnRyaWVzLCBuZXdfdWlkczogbmV3X3VpZHMgfTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUxvcmVib29rRW50cmllcyhcbiAgbG9yZWJvb2s6IHN0cmluZyxcbiAgdWlkczogbnVtYmVyW10sXG4pOiBQcm9taXNlPHsgZW50cmllczogTG9yZWJvb2tFbnRyeVtdOyBkZWxldGVfb2NjdXJyZWQ6IGJvb2xlYW4gfT4ge1xuICBsZXQgZGVsZXRlZDogYm9vbGVhbiA9IGZhbHNlO1xuICBjb25zdCB1cGRhdGVkX2VudGlyZXMgPSBhd2FpdCB1cGRhdGVMb3JlYm9va0VudHJpZXNXaXRoKGxvcmVib29rLCBkYXRhID0+IHtcbiAgICBjb25zdCByZW1vdmVkX2RhdGEgPSBfLnJlbW92ZShkYXRhLCBlbnRyeSA9PiB1aWRzLmluY2x1ZGVzKGVudHJ5LnVpZCkpO1xuICAgIGRlbGV0ZWQgPSByZW1vdmVkX2RhdGEubGVuZ3RoID4gMDtcbiAgICByZXR1cm4gZGF0YTtcbiAgfSk7XG4gIHJldHVybiB7IGVudHJpZXM6IHVwZGF0ZWRfZW50aXJlcywgZGVsZXRlX29jY3VycmVkOiBkZWxldGVkIH07XG59XG5cbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqIEBkZXByZWNhdGVkIOivt+S9v+eUqCBgY3JlYXRlTG9yZWJvb2tFbnRyaWVzYCDku6Pmm78gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVMb3JlYm9va0VudHJ5KGxvcmVib29rOiBzdHJpbmcsIGZpZWxkX3ZhbHVlczogUGFydGlhbDxMb3JlYm9va0VudHJ5Pik6IFByb21pc2U8bnVtYmVyPiB7XG4gIHJldHVybiAoYXdhaXQgY3JlYXRlTG9yZWJvb2tFbnRyaWVzKGxvcmVib29rLCBbZmllbGRfdmFsdWVzXSkpLm5ld191aWRzWzBdO1xufVxuXG4vKiogQGRlcHJlY2F0ZWQg6K+35L2/55SoIGBkZWxldGVMb3JlYm9va0VudHJpZXNgIOS7o+abvyAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUxvcmVib29rRW50cnkobG9yZWJvb2s6IHN0cmluZywgdWlkOiBudW1iZXIpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgcmV0dXJuIChhd2FpdCBkZWxldGVMb3JlYm9va0VudHJpZXMobG9yZWJvb2ssIFt1aWRdKSkuZGVsZXRlX29jY3VycmVkO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/function/lorebook_entry.ts\n")},"./src/function/script_repository.ts":
/*!*******************************************!*\
  !*** ./src/function/script_repository.ts ***!
  \*******************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getScriptButtons: () => (/* binding */ getScriptButtons),\n/* harmony export */   replaceScriptButtons: () => (/* binding */ replaceScriptButtons)\n/* harmony export */ });\n/* harmony import */ var _component_script_repository_data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/script_repository/data */ "./src/component/script_repository/data.ts");\n/* harmony import */ var _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/component/script_repository/script_controller */ "./src/component/script_repository/script_controller.ts");\n\n\n/**\n * 获取指定脚本的按钮数组\n * @param script_id 脚本ID\n * @returns 按钮数组\n */\nfunction getScriptButtons(script_id) {\n    if (!script_id) {\n        throw new Error(\'脚本ID不能为空\');\n    }\n    return _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_1__.ScriptManager.getInstance().getScriptButton(script_id);\n}\n/**\n * 修改指定脚本的按钮数组\n * @param script_id 脚本ID\n * @param buttons 脚本数组\n */\nfunction replaceScriptButtons(script_id, buttons) {\n    if (!script_id) {\n        throw new Error(`脚本ID不能为空`);\n    }\n    const script = _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_1__.ScriptManager.getInstance().getScriptById(script_id);\n    if (!script) {\n        throw new Error(`脚本不存在: ${script_id}`);\n    }\n    const type = _component_script_repository_data__WEBPACK_IMPORTED_MODULE_0__.ScriptData.getInstance().getScriptType(script);\n    script.buttons = buttons;\n    _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_1__.ScriptManager.getInstance().setScriptButton(script, type);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZnVuY3Rpb24vc2NyaXB0X3JlcG9zaXRvcnkudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFnRTtBQUNnQjtBQU9oRjs7OztHQUlHO0FBQ0ksU0FBUyxnQkFBZ0IsQ0FBQyxTQUFpQjtJQUNoRCxJQUFJLENBQUMsU0FBUyxFQUFFLENBQUM7UUFDZixNQUFNLElBQUksS0FBSyxDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBQzlCLENBQUM7SUFDRCxPQUFPLHlGQUFhLENBQUMsV0FBVyxFQUFFLENBQUMsZUFBZSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQ2hFLENBQUM7QUFFRDs7OztHQUlHO0FBQ0ksU0FBUyxvQkFBb0IsQ0FBQyxTQUFpQixFQUFFLE9BQXVCO0lBQzdFLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQztRQUNmLE1BQU0sSUFBSSxLQUFLLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDOUIsQ0FBQztJQUVELE1BQU0sTUFBTSxHQUFHLHlGQUFhLENBQUMsV0FBVyxFQUFFLENBQUMsYUFBYSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBQ3BFLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUNaLE1BQU0sSUFBSSxLQUFLLENBQUMsVUFBVSxTQUFTLEVBQUUsQ0FBQyxDQUFDO0lBQ3pDLENBQUM7SUFFRCxNQUFNLElBQUksR0FBRyx5RUFBVSxDQUFDLFdBQVcsRUFBRSxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUU1RCxNQUFNLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQztJQUN6Qix5RkFBYSxDQUFDLFdBQVcsRUFBRSxDQUFDLGVBQWUsQ0FBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLENBQUM7QUFDNUQsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9mdW5jdGlvbi9zY3JpcHRfcmVwb3NpdG9yeS50cz8xMjEwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFNjcmlwdERhdGEgfSBmcm9tICdAL2NvbXBvbmVudC9zY3JpcHRfcmVwb3NpdG9yeS9kYXRhJztcbmltcG9ydCB7IFNjcmlwdE1hbmFnZXIgfSBmcm9tICdAL2NvbXBvbmVudC9zY3JpcHRfcmVwb3NpdG9yeS9zY3JpcHRfY29udHJvbGxlcic7XG5cbmludGVyZmFjZSBTY3JpcHRCdXR0b24ge1xuICBuYW1lOiBzdHJpbmc7XG4gIHZpc2libGU6IGJvb2xlYW47XG59XG5cbi8qKlxuICog6I635Y+W5oyH5a6a6ISa5pys55qE5oyJ6ZKu5pWw57uEXG4gKiBAcGFyYW0gc2NyaXB0X2lkIOiEmuacrElEXG4gKiBAcmV0dXJucyDmjInpkq7mlbDnu4RcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFNjcmlwdEJ1dHRvbnMoc2NyaXB0X2lkOiBzdHJpbmcpOiBTY3JpcHRCdXR0b25bXSB7XG4gIGlmICghc2NyaXB0X2lkKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCfohJrmnKxJROS4jeiDveS4uuepuicpO1xuICB9XG4gIHJldHVybiBTY3JpcHRNYW5hZ2VyLmdldEluc3RhbmNlKCkuZ2V0U2NyaXB0QnV0dG9uKHNjcmlwdF9pZCk7XG59XG5cbi8qKlxuICog5L+u5pS55oyH5a6a6ISa5pys55qE5oyJ6ZKu5pWw57uEXG4gKiBAcGFyYW0gc2NyaXB0X2lkIOiEmuacrElEXG4gKiBAcGFyYW0gYnV0dG9ucyDohJrmnKzmlbDnu4RcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlcGxhY2VTY3JpcHRCdXR0b25zKHNjcmlwdF9pZDogc3RyaW5nLCBidXR0b25zOiBTY3JpcHRCdXR0b25bXSk6IHZvaWQge1xuICBpZiAoIXNjcmlwdF9pZCkge1xuICAgIHRocm93IG5ldyBFcnJvcihg6ISa5pysSUTkuI3og73kuLrnqbpgKTtcbiAgfVxuXG4gIGNvbnN0IHNjcmlwdCA9IFNjcmlwdE1hbmFnZXIuZ2V0SW5zdGFuY2UoKS5nZXRTY3JpcHRCeUlkKHNjcmlwdF9pZCk7XG4gIGlmICghc2NyaXB0KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGDohJrmnKzkuI3lrZjlnKg6ICR7c2NyaXB0X2lkfWApO1xuICB9XG5cbiAgY29uc3QgdHlwZSA9IFNjcmlwdERhdGEuZ2V0SW5zdGFuY2UoKS5nZXRTY3JpcHRUeXBlKHNjcmlwdCk7XG5cbiAgc2NyaXB0LmJ1dHRvbnMgPSBidXR0b25zO1xuICBTY3JpcHRNYW5hZ2VyLmdldEluc3RhbmNlKCkuc2V0U2NyaXB0QnV0dG9uKHNjcmlwdCwgdHlwZSk7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/function/script_repository.ts\n')},"./src/function/slash.ts":
/*!*******************************!*\
  !*** ./src/function/slash.ts ***!
  \*******************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   triggerSlash: () => (/* binding */ triggerSlash)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_scripts_slash_commands__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/scripts/slash-commands */ "@sillytavern/scripts/slash-commands");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! loglevel */ "./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_1__);\n\n\nasync function triggerSlash(command) {\n    const result = await (0,_sillytavern_scripts_slash_commands__WEBPACK_IMPORTED_MODULE_0__.executeSlashCommandsWithOptions)(command);\n    if (result.isError) {\n        throw Error(`运行 Slash 命令 \'${command}\' 时出错: ${result.errorMessage}`);\n    }\n    loglevel__WEBPACK_IMPORTED_MODULE_1___default().info(`运行 Slash 命令: ${command}`);\n    return result.pipe;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZnVuY3Rpb24vc2xhc2gudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFzRjtBQUUzRDtBQUVwQixLQUFLLFVBQVUsWUFBWSxDQUFDLE9BQWU7SUFDaEQsTUFBTSxNQUFNLEdBQUcsTUFBTSxvR0FBK0IsQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUM5RCxJQUFJLE1BQU0sQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUNuQixNQUFNLEtBQUssQ0FBQyxnQkFBZ0IsT0FBTyxVQUFVLE1BQU0sQ0FBQyxZQUFZLEVBQUUsQ0FBQyxDQUFDO0lBQ3RFLENBQUM7SUFFRCxvREFBUSxDQUFDLGdCQUFnQixPQUFPLEVBQUUsQ0FBQyxDQUFDO0lBQ3BDLE9BQU8sTUFBTSxDQUFDLElBQUksQ0FBQztBQUNyQixDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2Z1bmN0aW9uL3NsYXNoLnRzPzM1ZDAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZXhlY3V0ZVNsYXNoQ29tbWFuZHNXaXRoT3B0aW9ucyB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3NsYXNoLWNvbW1hbmRzJztcblxuaW1wb3J0IGxvZyBmcm9tICdsb2dsZXZlbCc7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB0cmlnZ2VyU2xhc2goY29tbWFuZDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZXhlY3V0ZVNsYXNoQ29tbWFuZHNXaXRoT3B0aW9ucyhjb21tYW5kKTtcbiAgaWYgKHJlc3VsdC5pc0Vycm9yKSB7XG4gICAgdGhyb3cgRXJyb3IoYOi/kOihjCBTbGFzaCDlkb3ku6QgJyR7Y29tbWFuZH0nIOaXtuWHuumUmTogJHtyZXN1bHQuZXJyb3JNZXNzYWdlfWApO1xuICB9XG5cbiAgbG9nLmluZm8oYOi/kOihjCBTbGFzaCDlkb3ku6Q6ICR7Y29tbWFuZH1gKTtcbiAgcmV0dXJuIHJlc3VsdC5waXBlO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/function/slash.ts\n')},"./src/function/tavern_regex.ts":
/*!**************************************!*\
  !*** ./src/function/tavern_regex.ts ***!
  \**************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getCharacterRegexes: () => (/* binding */ getCharacterRegexes),\n/* harmony export */   getGlobalRegexes: () => (/* binding */ getGlobalRegexes),\n/* harmony export */   getTavernRegexes: () => (/* binding */ getTavernRegexes),\n/* harmony export */   isCharacterTavernRegexEnabled: () => (/* binding */ isCharacterTavernRegexEnabled),\n/* harmony export */   isCharacterTavernRegexesEnabled: () => (/* binding */ isCharacterTavernRegexesEnabled),\n/* harmony export */   replaceTavernRegexes: () => (/* binding */ replaceTavernRegexes),\n/* harmony export */   updateTavernRegexesWith: () => (/* binding */ updateTavernRegexesWith)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var _sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/scripts/extensions/regex/engine */ \"@sillytavern/scripts/extensions/regex/engine\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_3__);\n\n\n\n\nfunction isCharacterTavernRegexEnabled() {\n    // @ts-ignore 2345\n    return _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__.extension_settings?.character_allowed_regex?.includes(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters?.[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid]?.avatar);\n}\nfunction getGlobalRegexes() {\n    return _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__.extension_settings.regex ?? [];\n}\nfunction getCharacterRegexes() {\n    // @ts-ignore\n    return _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid]?.data?.extensions?.regex_scripts ?? [];\n}\nfunction toTavernRegex(regex_script_data, scope) {\n    return {\n        id: regex_script_data.id,\n        script_name: regex_script_data.scriptName,\n        enabled: !regex_script_data.disabled,\n        run_on_edit: regex_script_data.runOnEdit,\n        scope: scope,\n        find_regex: regex_script_data.findRegex,\n        replace_string: regex_script_data.replaceString,\n        source: {\n            user_input: regex_script_data.placement.includes(_sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_2__.regex_placement.USER_INPUT),\n            ai_output: regex_script_data.placement.includes(_sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_2__.regex_placement.AI_OUTPUT),\n            slash_command: regex_script_data.placement.includes(_sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_2__.regex_placement.SLASH_COMMAND),\n            world_info: regex_script_data.placement.includes(_sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_2__.regex_placement.WORLD_INFO),\n        },\n        destination: {\n            display: regex_script_data.markdownOnly,\n            prompt: regex_script_data.promptOnly,\n        },\n        min_depth: typeof regex_script_data.minDepth === 'number' ? regex_script_data.minDepth : null,\n        max_depth: typeof regex_script_data.maxDepth === 'number' ? regex_script_data.maxDepth : null,\n    };\n}\nfunction fromTavernRegex(tavern_regex) {\n    return {\n        id: tavern_regex.id,\n        scriptName: tavern_regex.script_name,\n        disabled: !tavern_regex.enabled,\n        runOnEdit: tavern_regex.run_on_edit,\n        findRegex: tavern_regex.find_regex,\n        replaceString: tavern_regex.replace_string,\n        trimStrings: [], // TODO: handle this?\n        placement: [\n            ...(tavern_regex.source.user_input ? [_sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_2__.regex_placement.USER_INPUT] : []),\n            ...(tavern_regex.source.ai_output ? [_sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_2__.regex_placement.AI_OUTPUT] : []),\n            ...(tavern_regex.source.slash_command ? [_sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_2__.regex_placement.SLASH_COMMAND] : []),\n            ...(tavern_regex.source.world_info ? [_sillytavern_scripts_extensions_regex_engine__WEBPACK_IMPORTED_MODULE_2__.regex_placement.WORLD_INFO] : []),\n        ],\n        substituteRegex: 0, // TODO: handle this?\n        // @ts-ignore\n        minDepth: tavern_regex.min_depth,\n        // @ts-ignore\n        maxDepth: tavern_regex.max_depth,\n        markdownOnly: tavern_regex.destination.display,\n        promptOnly: tavern_regex.destination.prompt,\n    };\n}\nfunction isCharacterTavernRegexesEnabled() {\n    const result = isCharacterTavernRegexEnabled();\n    loglevel__WEBPACK_IMPORTED_MODULE_3___default().info(`查询到局部正则${result ? '被启用' : '被禁用'}`);\n    return result;\n}\nfunction getTavernRegexes({ scope = 'all', enable_state = 'all' } = {}) {\n    if (!['all', 'enabled', 'disabled'].includes(enable_state)) {\n        throw Error(`提供的 enable_state 无效, 请提供 'all', 'enabled' 或 'disabled', 你提供的是: ${enable_state}`);\n    }\n    if (!['all', 'global', 'character'].includes(scope)) {\n        throw Error(`提供的 scope 无效, 请提供 'all', 'global' 或 'character', 你提供的是: ${scope}`);\n    }\n    let regexes = [];\n    if (scope === 'all' || scope === 'global') {\n        regexes = [...regexes, ...getGlobalRegexes().map(regex => toTavernRegex(regex, 'global'))];\n    }\n    if (scope === 'all' || scope === 'character') {\n        regexes = [...regexes, ...getCharacterRegexes().map(regex => toTavernRegex(regex, 'character'))];\n    }\n    if (enable_state !== 'all') {\n        regexes = regexes.filter(regex => regex.enabled === (enable_state === 'enabled'));\n    }\n    return structuredClone(regexes);\n}\nasync function replaceTavernRegexes(regexes, { scope = 'all' }) {\n    if (!['all', 'global', 'character'].includes(scope)) {\n        throw Error(`提供的 scope 无效, 请提供 'all', 'global' 或 'character', 你提供的是: ${scope}`);\n    }\n    // FIXME: `trimStrings` and `substituteRegex` are not considered\n    const emptied_regexes = regexes.filter(regex => regex.script_name == '');\n    if (emptied_regexes.length > 0) {\n        throw Error(`不能将酒馆正则的名称设置为空字符串:\\n${JSON.stringify(emptied_regexes.map(regex => regex.id))}`);\n    }\n    const [global_regexes, character_regexes] = _.partition(regexes, regex => regex.scope === 'global').map(paritioned => paritioned.map(fromTavernRegex));\n    // @ts-ignore\n    const character = _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid];\n    if (scope === 'all' || scope === 'global') {\n        _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__.extension_settings.regex = global_regexes;\n    }\n    if (scope === 'all' || scope === 'character') {\n        if (character) {\n            // @ts-ignore\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid].data.extensions.regex_scripts = character_regexes;\n            // @ts-ignore\n            await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__.writeExtensionField)(_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid, 'regex_scripts', character_regexes);\n        }\n    }\n    await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveSettings)();\n    if (character) {\n        await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveChatConditional)();\n    }\n    await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.reloadCurrentChat)();\n    loglevel__WEBPACK_IMPORTED_MODULE_3___default().info(`替换酒馆正则\\\n${scope === 'all' || scope === 'global' ? `, 全局正则:\\n${JSON.stringify(global_regexes)}` : ``}\\\n${scope === 'all' || scope === 'character' ? `, 局部正则:\\n${JSON.stringify(character_regexes)}` : ``}`);\n}\nasync function updateTavernRegexesWith(updater, { scope = 'all' } = {}) {\n    let regexes = getTavernRegexes({ scope });\n    regexes = await updater(regexes);\n    loglevel__WEBPACK_IMPORTED_MODULE_3___default().info(`对${{ all: '全部', global: '全局', character: '局部' }[scope]}变量表进行更新`);\n    await replaceTavernRegexes(regexes, { scope });\n    return regexes;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O0lBQ0gsQ0FBQztJQUNELE1BQU0saUVBQVksRUFBRSxDQUFDO0lBQ3JCLElBQUksU0FBUyxFQUFFLENBQUM7UUFDZCxNQUFNLHdFQUFtQixFQUFFLENBQUM7SUFDOUIsQ0FBQztJQUNELE1BQU0sc0VBQWlCLEVBQUUsQ0FBQztJQUUxQixvREFBUSxDQUFDO0VBQ1QsS0FBSyxLQUFLLEtBQUssSUFBSSxLQUFLLEtBQUssUUFBUSxDQUFDLENBQUMsQ0FBQyxZQUFZLElBQUksQ0FBQyxTQUFTLENBQUMsY0FBYyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRTtFQUN6RixLQUFLLEtBQUssS0FBSyxJQUFJLEtBQUssS0FBSyxXQUFXLENBQUMsQ0FBQyxDQUFDLFlBQVksSUFBSSxDQUFDLFNBQVMsQ0FBQyxpQkFBaUIsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7QUFDckcsQ0FBQztBQU1NLEtBQUssVUFBVSx1QkFBdUIsQ0FDM0MsT0FBMkIsRUFDM0IsRUFBRSxLQUFLLEdBQUcsS0FBSyxLQUFpQyxFQUFFO0lBRWxELElBQUksT0FBTyxHQUFHLGdCQUFnQixDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQztJQUMxQyxPQUFPLEdBQUcsTUFBTSxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDakMsb0RBQVEsQ0FBQyxJQUFJLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxJQUFJLEVBQUUsQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDM0UsTUFBTSxvQkFBb0IsQ0FBQyxPQUFPLEVBQUUsRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDO0lBQy9DLE9BQU8sT0FBTyxDQUFDO0FBQ2pCLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvZnVuY3Rpb24vdGF2ZXJuX3JlZ2V4LnRzPzY4OWIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY2hhcmFjdGVycywgcmVsb2FkQ3VycmVudENoYXQsIHNhdmVDaGF0Q29uZGl0aW9uYWwsIHNhdmVTZXR0aW5ncywgdGhpc19jaGlkIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5pbXBvcnQgeyBSZWdleFNjcmlwdERhdGEgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9jaGFyLWRhdGEnO1xuaW1wb3J0IHsgZXh0ZW5zaW9uX3NldHRpbmdzLCB3cml0ZUV4dGVuc2lvbkZpZWxkIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvZXh0ZW5zaW9ucyc7XG5pbXBvcnQgeyByZWdleF9wbGFjZW1lbnQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9leHRlbnNpb25zL3JlZ2V4L2VuZ2luZSc7XG5cbmltcG9ydCBsb2cgZnJvbSAnbG9nbGV2ZWwnO1xuXG5pbnRlcmZhY2UgVGF2ZXJuUmVnZXgge1xuICBpZDogc3RyaW5nO1xuICBzY3JpcHRfbmFtZTogc3RyaW5nO1xuICBlbmFibGVkOiBib29sZWFuO1xuICBydW5fb25fZWRpdDogYm9vbGVhbjtcbiAgc2NvcGU6ICdnbG9iYWwnIHwgJ2NoYXJhY3Rlcic7XG5cbiAgZmluZF9yZWdleDogc3RyaW5nO1xuICByZXBsYWNlX3N0cmluZzogc3RyaW5nO1xuXG4gIHNvdXJjZToge1xuICAgIHVzZXJfaW5wdXQ6IGJvb2xlYW47XG4gICAgYWlfb3V0cHV0OiBib29sZWFuO1xuICAgIHNsYXNoX2NvbW1hbmQ6IGJvb2xlYW47XG4gICAgd29ybGRfaW5mbzogYm9vbGVhbjtcbiAgfTtcblxuICBkZXN0aW5hdGlvbjoge1xuICAgIGRpc3BsYXk6IGJvb2xlYW47XG4gICAgcHJvbXB0OiBib29sZWFuO1xuICB9O1xuXG4gIG1pbl9kZXB0aDogbnVtYmVyIHwgbnVsbDtcbiAgbWF4X2RlcHRoOiBudW1iZXIgfCBudWxsO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNDaGFyYWN0ZXJUYXZlcm5SZWdleEVuYWJsZWQoKTogYm9vbGVhbiB7XG4gIC8vIEB0cy1pZ25vcmUgMjM0NVxuICByZXR1cm4gZXh0ZW5zaW9uX3NldHRpbmdzPy5jaGFyYWN0ZXJfYWxsb3dlZF9yZWdleD8uaW5jbHVkZXMoY2hhcmFjdGVycz8uW3RoaXNfY2hpZF0/LmF2YXRhcik7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRHbG9iYWxSZWdleGVzKCk6IFJlZ2V4U2NyaXB0RGF0YVtdIHtcbiAgcmV0dXJuIGV4dGVuc2lvbl9zZXR0aW5ncy5yZWdleCA/PyBbXTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldENoYXJhY3RlclJlZ2V4ZXMoKTogUmVnZXhTY3JpcHREYXRhW10ge1xuICAvLyBAdHMtaWdub3JlXG4gIHJldHVybiBjaGFyYWN0ZXJzW3RoaXNfY2hpZF0/LmRhdGE/LmV4dGVuc2lvbnM/LnJlZ2V4X3NjcmlwdHMgPz8gW107XG59XG5cbmZ1bmN0aW9uIHRvVGF2ZXJuUmVnZXgocmVnZXhfc2NyaXB0X2RhdGE6IFJlZ2V4U2NyaXB0RGF0YSwgc2NvcGU6ICdnbG9iYWwnIHwgJ2NoYXJhY3RlcicpOiBUYXZlcm5SZWdleCB7XG4gIHJldHVybiB7XG4gICAgaWQ6IHJlZ2V4X3NjcmlwdF9kYXRhLmlkLFxuICAgIHNjcmlwdF9uYW1lOiByZWdleF9zY3JpcHRfZGF0YS5zY3JpcHROYW1lLFxuICAgIGVuYWJsZWQ6ICFyZWdleF9zY3JpcHRfZGF0YS5kaXNhYmxlZCxcbiAgICBydW5fb25fZWRpdDogcmVnZXhfc2NyaXB0X2RhdGEucnVuT25FZGl0LFxuICAgIHNjb3BlOiBzY29wZSxcblxuICAgIGZpbmRfcmVnZXg6IHJlZ2V4X3NjcmlwdF9kYXRhLmZpbmRSZWdleCxcbiAgICByZXBsYWNlX3N0cmluZzogcmVnZXhfc2NyaXB0X2RhdGEucmVwbGFjZVN0cmluZyxcblxuICAgIHNvdXJjZToge1xuICAgICAgdXNlcl9pbnB1dDogcmVnZXhfc2NyaXB0X2RhdGEucGxhY2VtZW50LmluY2x1ZGVzKHJlZ2V4X3BsYWNlbWVudC5VU0VSX0lOUFVUKSxcbiAgICAgIGFpX291dHB1dDogcmVnZXhfc2NyaXB0X2RhdGEucGxhY2VtZW50LmluY2x1ZGVzKHJlZ2V4X3BsYWNlbWVudC5BSV9PVVRQVVQpLFxuICAgICAgc2xhc2hfY29tbWFuZDogcmVnZXhfc2NyaXB0X2RhdGEucGxhY2VtZW50LmluY2x1ZGVzKHJlZ2V4X3BsYWNlbWVudC5TTEFTSF9DT01NQU5EKSxcbiAgICAgIHdvcmxkX2luZm86IHJlZ2V4X3NjcmlwdF9kYXRhLnBsYWNlbWVudC5pbmNsdWRlcyhyZWdleF9wbGFjZW1lbnQuV09STERfSU5GTyksXG4gICAgfSxcblxuICAgIGRlc3RpbmF0aW9uOiB7XG4gICAgICBkaXNwbGF5OiByZWdleF9zY3JpcHRfZGF0YS5tYXJrZG93bk9ubHksXG4gICAgICBwcm9tcHQ6IHJlZ2V4X3NjcmlwdF9kYXRhLnByb21wdE9ubHksXG4gICAgfSxcblxuICAgIG1pbl9kZXB0aDogdHlwZW9mIHJlZ2V4X3NjcmlwdF9kYXRhLm1pbkRlcHRoID09PSAnbnVtYmVyJyA/IHJlZ2V4X3NjcmlwdF9kYXRhLm1pbkRlcHRoIDogbnVsbCxcbiAgICBtYXhfZGVwdGg6IHR5cGVvZiByZWdleF9zY3JpcHRfZGF0YS5tYXhEZXB0aCA9PT0gJ251bWJlcicgPyByZWdleF9zY3JpcHRfZGF0YS5tYXhEZXB0aCA6IG51bGwsXG4gIH07XG59XG5cbmZ1bmN0aW9uIGZyb21UYXZlcm5SZWdleCh0YXZlcm5fcmVnZXg6IFRhdmVyblJlZ2V4KTogUmVnZXhTY3JpcHREYXRhIHtcbiAgcmV0dXJuIHtcbiAgICBpZDogdGF2ZXJuX3JlZ2V4LmlkLFxuICAgIHNjcmlwdE5hbWU6IHRhdmVybl9yZWdleC5zY3JpcHRfbmFtZSxcbiAgICBkaXNhYmxlZDogIXRhdmVybl9yZWdleC5lbmFibGVkLFxuICAgIHJ1bk9uRWRpdDogdGF2ZXJuX3JlZ2V4LnJ1bl9vbl9lZGl0LFxuXG4gICAgZmluZFJlZ2V4OiB0YXZlcm5fcmVnZXguZmluZF9yZWdleCxcbiAgICByZXBsYWNlU3RyaW5nOiB0YXZlcm5fcmVnZXgucmVwbGFjZV9zdHJpbmcsXG4gICAgdHJpbVN0cmluZ3M6IFtdLCAvLyBUT0RPOiBoYW5kbGUgdGhpcz9cblxuICAgIHBsYWNlbWVudDogW1xuICAgICAgLi4uKHRhdmVybl9yZWdleC5zb3VyY2UudXNlcl9pbnB1dCA/IFtyZWdleF9wbGFjZW1lbnQuVVNFUl9JTlBVVF0gOiBbXSksXG4gICAgICAuLi4odGF2ZXJuX3JlZ2V4LnNvdXJjZS5haV9vdXRwdXQgPyBbcmVnZXhfcGxhY2VtZW50LkFJX09VVFBVVF0gOiBbXSksXG4gICAgICAuLi4odGF2ZXJuX3JlZ2V4LnNvdXJjZS5zbGFzaF9jb21tYW5kID8gW3JlZ2V4X3BsYWNlbWVudC5TTEFTSF9DT01NQU5EXSA6IFtdKSxcbiAgICAgIC4uLih0YXZlcm5fcmVnZXguc291cmNlLndvcmxkX2luZm8gPyBbcmVnZXhfcGxhY2VtZW50LldPUkxEX0lORk9dIDogW10pLFxuICAgIF0sXG5cbiAgICBzdWJzdGl0dXRlUmVnZXg6IDAsIC8vIFRPRE86IGhhbmRsZSB0aGlzP1xuXG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIG1pbkRlcHRoOiB0YXZlcm5fcmVnZXgubWluX2RlcHRoLFxuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBtYXhEZXB0aDogdGF2ZXJuX3JlZ2V4Lm1heF9kZXB0aCxcblxuICAgIG1hcmtkb3duT25seTogdGF2ZXJuX3JlZ2V4LmRlc3RpbmF0aW9uLmRpc3BsYXksXG4gICAgcHJvbXB0T25seTogdGF2ZXJuX3JlZ2V4LmRlc3RpbmF0aW9uLnByb21wdCxcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzQ2hhcmFjdGVyVGF2ZXJuUmVnZXhlc0VuYWJsZWQoKTogYm9vbGVhbiB7XG4gIGNvbnN0IHJlc3VsdCA9IGlzQ2hhcmFjdGVyVGF2ZXJuUmVnZXhFbmFibGVkKCk7XG5cbiAgbG9nLmluZm8oYOafpeivouWIsOWxgOmDqOato+WImSR7cmVzdWx0ID8gJ+iiq+WQr+eUqCcgOiAn6KKr56aB55SoJ31gKTtcbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuaW50ZXJmYWNlIEdldFRhdmVyblJlZ2V4ZXNPcHRpb24ge1xuICBzY29wZT86ICdhbGwnIHwgJ2dsb2JhbCcgfCAnY2hhcmFjdGVyJzsgLy8g5oyJ5omA5Zyo5Yy65Z+f562b6YCJ5q2j5YiZXG4gIGVuYWJsZV9zdGF0ZT86ICdhbGwnIHwgJ2VuYWJsZWQnIHwgJ2Rpc2FibGVkJzsgLy8g5oyJ5piv5ZCm6KKr5byA5ZCv562b6YCJ5q2j5YiZXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRUYXZlcm5SZWdleGVzKHsgc2NvcGUgPSAnYWxsJywgZW5hYmxlX3N0YXRlID0gJ2FsbCcgfTogR2V0VGF2ZXJuUmVnZXhlc09wdGlvbiA9IHt9KTogVGF2ZXJuUmVnZXhbXSB7XG4gIGlmICghWydhbGwnLCAnZW5hYmxlZCcsICdkaXNhYmxlZCddLmluY2x1ZGVzKGVuYWJsZV9zdGF0ZSkpIHtcbiAgICB0aHJvdyBFcnJvcihg5o+Q5L6b55qEIGVuYWJsZV9zdGF0ZSDml6DmlYgsIOivt+aPkOS+myAnYWxsJywgJ2VuYWJsZWQnIOaIliAnZGlzYWJsZWQnLCDkvaDmj5DkvpvnmoTmmK86ICR7ZW5hYmxlX3N0YXRlfWApO1xuICB9XG4gIGlmICghWydhbGwnLCAnZ2xvYmFsJywgJ2NoYXJhY3RlciddLmluY2x1ZGVzKHNjb3BlKSkge1xuICAgIHRocm93IEVycm9yKGDmj5DkvpvnmoQgc2NvcGUg5peg5pWILCDor7fmj5DkvpsgJ2FsbCcsICdnbG9iYWwnIOaIliAnY2hhcmFjdGVyJywg5L2g5o+Q5L6b55qE5pivOiAke3Njb3BlfWApO1xuICB9XG5cbiAgbGV0IHJlZ2V4ZXM6IFRhdmVyblJlZ2V4W10gPSBbXTtcbiAgaWYgKHNjb3BlID09PSAnYWxsJyB8fCBzY29wZSA9PT0gJ2dsb2JhbCcpIHtcbiAgICByZWdleGVzID0gWy4uLnJlZ2V4ZXMsIC4uLmdldEdsb2JhbFJlZ2V4ZXMoKS5tYXAocmVnZXggPT4gdG9UYXZlcm5SZWdleChyZWdleCwgJ2dsb2JhbCcpKV07XG4gIH1cbiAgaWYgKHNjb3BlID09PSAnYWxsJyB8fCBzY29wZSA9PT0gJ2NoYXJhY3RlcicpIHtcbiAgICByZWdleGVzID0gWy4uLnJlZ2V4ZXMsIC4uLmdldENoYXJhY3RlclJlZ2V4ZXMoKS5tYXAocmVnZXggPT4gdG9UYXZlcm5SZWdleChyZWdleCwgJ2NoYXJhY3RlcicpKV07XG4gIH1cbiAgaWYgKGVuYWJsZV9zdGF0ZSAhPT0gJ2FsbCcpIHtcbiAgICByZWdleGVzID0gcmVnZXhlcy5maWx0ZXIocmVnZXggPT4gcmVnZXguZW5hYmxlZCA9PT0gKGVuYWJsZV9zdGF0ZSA9PT0gJ2VuYWJsZWQnKSk7XG4gIH1cblxuICByZXR1cm4gc3RydWN0dXJlZENsb25lKHJlZ2V4ZXMpO1xufVxuXG5pbnRlcmZhY2UgUmVwbGFjZVRhdmVyblJlZ2V4ZXNPcHRpb24ge1xuICBzY29wZT86ICdhbGwnIHwgJ2dsb2JhbCcgfCAnY2hhcmFjdGVyJzsgLy8g6KaB5pu/5o2i55qE6YWS6aaG5q2j5YiZ6YOo5YiGXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXBsYWNlVGF2ZXJuUmVnZXhlcyhcbiAgcmVnZXhlczogVGF2ZXJuUmVnZXhbXSxcbiAgeyBzY29wZSA9ICdhbGwnIH06IFJlcGxhY2VUYXZlcm5SZWdleGVzT3B0aW9uLFxuKTogUHJvbWlzZTx2b2lkPiB7XG4gIGlmICghWydhbGwnLCAnZ2xvYmFsJywgJ2NoYXJhY3RlciddLmluY2x1ZGVzKHNjb3BlKSkge1xuICAgIHRocm93IEVycm9yKGDmj5DkvpvnmoQgc2NvcGUg5peg5pWILCDor7fmj5DkvpsgJ2FsbCcsICdnbG9iYWwnIOaIliAnY2hhcmFjdGVyJywg5L2g5o+Q5L6b55qE5pivOiAke3Njb3BlfWApO1xuICB9XG5cbiAgLy8gRklYTUU6IGB0cmltU3RyaW5nc2AgYW5kIGBzdWJzdGl0dXRlUmVnZXhgIGFyZSBub3QgY29uc2lkZXJlZFxuICBjb25zdCBlbXB0aWVkX3JlZ2V4ZXMgPSByZWdleGVzLmZpbHRlcihyZWdleCA9PiByZWdleC5zY3JpcHRfbmFtZSA9PSAnJyk7XG4gIGlmIChlbXB0aWVkX3JlZ2V4ZXMubGVuZ3RoID4gMCkge1xuICAgIHRocm93IEVycm9yKGDkuI3og73lsIbphZLppobmraPliJnnmoTlkI3np7Dorr7nva7kuLrnqbrlrZfnrKbkuLI6XFxuJHtKU09OLnN0cmluZ2lmeShlbXB0aWVkX3JlZ2V4ZXMubWFwKHJlZ2V4ID0+IHJlZ2V4LmlkKSl9YCk7XG4gIH1cbiAgY29uc3QgW2dsb2JhbF9yZWdleGVzLCBjaGFyYWN0ZXJfcmVnZXhlc10gPSBfLnBhcnRpdGlvbihyZWdleGVzLCByZWdleCA9PiByZWdleC5zY29wZSA9PT0gJ2dsb2JhbCcpLm1hcChwYXJpdGlvbmVkID0+XG4gICAgcGFyaXRpb25lZC5tYXAoZnJvbVRhdmVyblJlZ2V4KSxcbiAgKTtcblxuICAvLyBAdHMtaWdub3JlXG4gIGNvbnN0IGNoYXJhY3RlciA9IGNoYXJhY3RlcnNbdGhpc19jaGlkXTtcbiAgaWYgKHNjb3BlID09PSAnYWxsJyB8fCBzY29wZSA9PT0gJ2dsb2JhbCcpIHtcbiAgICBleHRlbnNpb25fc2V0dGluZ3MucmVnZXggPSBnbG9iYWxfcmVnZXhlcztcbiAgfVxuICBpZiAoc2NvcGUgPT09ICdhbGwnIHx8IHNjb3BlID09PSAnY2hhcmFjdGVyJykge1xuICAgIGlmIChjaGFyYWN0ZXIpIHtcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgIGNoYXJhY3RlcnNbdGhpc19jaGlkXS5kYXRhLmV4dGVuc2lvbnMucmVnZXhfc2NyaXB0cyA9IGNoYXJhY3Rlcl9yZWdleGVzO1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgYXdhaXQgd3JpdGVFeHRlbnNpb25GaWVsZCh0aGlzX2NoaWQsICdyZWdleF9zY3JpcHRzJywgY2hhcmFjdGVyX3JlZ2V4ZXMpO1xuICAgIH1cbiAgfVxuICBhd2FpdCBzYXZlU2V0dGluZ3MoKTtcbiAgaWYgKGNoYXJhY3Rlcikge1xuICAgIGF3YWl0IHNhdmVDaGF0Q29uZGl0aW9uYWwoKTtcbiAgfVxuICBhd2FpdCByZWxvYWRDdXJyZW50Q2hhdCgpO1xuXG4gIGxvZy5pbmZvKGDmm7/mjaLphZLppobmraPliJlcXFxuJHtzY29wZSA9PT0gJ2FsbCcgfHwgc2NvcGUgPT09ICdnbG9iYWwnID8gYCwg5YWo5bGA5q2j5YiZOlxcbiR7SlNPTi5zdHJpbmdpZnkoZ2xvYmFsX3JlZ2V4ZXMpfWAgOiBgYH1cXFxuJHtzY29wZSA9PT0gJ2FsbCcgfHwgc2NvcGUgPT09ICdjaGFyYWN0ZXInID8gYCwg5bGA6YOo5q2j5YiZOlxcbiR7SlNPTi5zdHJpbmdpZnkoY2hhcmFjdGVyX3JlZ2V4ZXMpfWAgOiBgYH1gKTtcbn1cblxudHlwZSBUYXZlcm5SZWdleFVwZGF0ZXIgPVxuICB8ICgocmVnZXhlczogVGF2ZXJuUmVnZXhbXSkgPT4gVGF2ZXJuUmVnZXhbXSlcbiAgfCAoKHJlZ2V4ZXM6IFRhdmVyblJlZ2V4W10pID0+IFByb21pc2U8VGF2ZXJuUmVnZXhbXT4pO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlVGF2ZXJuUmVnZXhlc1dpdGgoXG4gIHVwZGF0ZXI6IFRhdmVyblJlZ2V4VXBkYXRlcixcbiAgeyBzY29wZSA9ICdhbGwnIH06IFJlcGxhY2VUYXZlcm5SZWdleGVzT3B0aW9uID0ge30sXG4pOiBQcm9taXNlPFRhdmVyblJlZ2V4W10+IHtcbiAgbGV0IHJlZ2V4ZXMgPSBnZXRUYXZlcm5SZWdleGVzKHsgc2NvcGUgfSk7XG4gIHJlZ2V4ZXMgPSBhd2FpdCB1cGRhdGVyKHJlZ2V4ZXMpO1xuICBsb2cuaW5mbyhg5a+5JHt7IGFsbDogJ+WFqOmDqCcsIGdsb2JhbDogJ+WFqOWxgCcsIGNoYXJhY3RlcjogJ+WxgOmDqCcgfVtzY29wZV195Y+Y6YeP6KGo6L+b6KGM5pu05pawYCk7XG4gIGF3YWl0IHJlcGxhY2VUYXZlcm5SZWdleGVzKHJlZ2V4ZXMsIHsgc2NvcGUgfSk7XG4gIHJldHVybiByZWdleGVzO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/function/tavern_regex.ts\n")},"./src/function/util.ts":
/*!******************************!*\
  !*** ./src/function/util.ts ***!
  \******************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   errorCatched: () => (/* binding */ errorCatched),\n/* harmony export */   getLastMessageId: () => (/* binding */ getLastMessageId),\n/* harmony export */   substitudeMacros: () => (/* binding */ substitudeMacros)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_1__);\n\n\nfunction substitudeMacros(text) {\n    const text_demacroed = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.substituteParamsExtended)(text);\n    loglevel__WEBPACK_IMPORTED_MODULE_1___default().info(`替换字符串中的宏, 字符串: '${text}', 结果: '${text_demacroed}'`);\n    return text_demacroed;\n}\nfunction getLastMessageId() {\n    return Number(substitudeMacros('{{lastMessageId}}'));\n}\nfunction errorCatched(fn) {\n    const onError = (error) => {\n        toastr.error(`${error.stack ? error.stack : error.name + ': ' + error.message}`);\n        throw error;\n    };\n    return (...args) => {\n        try {\n            const result = fn(...args);\n            if (result instanceof Promise) {\n                return result.catch(error => {\n                    onError(error);\n                });\n            }\n            return result;\n        }\n        catch (error) {\n            return onError(error);\n        }\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZnVuY3Rpb24vdXRpbC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBK0Q7QUFFcEM7QUFFcEIsU0FBUyxnQkFBZ0IsQ0FBQyxJQUFZO0lBQzNDLE1BQU0sY0FBYyxHQUFHLDZFQUF3QixDQUFDLElBQUksQ0FBQyxDQUFDO0lBRXRELG9EQUFRLENBQUMsbUJBQW1CLElBQUksV0FBVyxjQUFjLEdBQUcsQ0FBQyxDQUFDO0lBQzlELE9BQU8sY0FBYyxDQUFDO0FBQ3hCLENBQUM7QUFFTSxTQUFTLGdCQUFnQjtJQUM5QixPQUFPLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLENBQUM7QUFDdkQsQ0FBQztBQUVNLFNBQVMsWUFBWSxDQUFxQixFQUFxQjtJQUNwRSxNQUFNLE9BQU8sR0FBRyxDQUFDLEtBQVksRUFBRSxFQUFFO1FBQy9CLE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsSUFBSSxHQUFHLElBQUksR0FBRyxLQUFLLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQztRQUNqRixNQUFNLEtBQUssQ0FBQztJQUNkLENBQUMsQ0FBQztJQUNGLE9BQU8sQ0FBQyxHQUFHLElBQU8sRUFBSyxFQUFFO1FBQ3ZCLElBQUksQ0FBQztZQUNILE1BQU0sTUFBTSxHQUFHLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQyxDQUFDO1lBQzNCLElBQUksTUFBTSxZQUFZLE9BQU8sRUFBRSxDQUFDO2dCQUM5QixPQUFPLE1BQU0sQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLEVBQUU7b0JBQzFCLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQztnQkFDakIsQ0FBQyxDQUFNLENBQUM7WUFDVixDQUFDO1lBQ0QsT0FBTyxNQUFNLENBQUM7UUFDaEIsQ0FBQztRQUFDLE9BQU8sS0FBSyxFQUFFLENBQUM7WUFDZixPQUFPLE9BQU8sQ0FBQyxLQUFjLENBQUMsQ0FBQztRQUNqQyxDQUFDO0lBQ0gsQ0FBQyxDQUFDO0FBQ0osQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9mdW5jdGlvbi91dGlsLnRzPzUyMDYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc3Vic3RpdHV0ZVBhcmFtc0V4dGVuZGVkIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5cbmltcG9ydCBsb2cgZnJvbSAnbG9nbGV2ZWwnO1xuXG5leHBvcnQgZnVuY3Rpb24gc3Vic3RpdHVkZU1hY3Jvcyh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xuICBjb25zdCB0ZXh0X2RlbWFjcm9lZCA9IHN1YnN0aXR1dGVQYXJhbXNFeHRlbmRlZCh0ZXh0KTtcblxuICBsb2cuaW5mbyhg5pu/5o2i5a2X56ym5Liy5Lit55qE5a6PLCDlrZfnrKbkuLI6ICcke3RleHR9Jywg57uT5p6cOiAnJHt0ZXh0X2RlbWFjcm9lZH0nYCk7XG4gIHJldHVybiB0ZXh0X2RlbWFjcm9lZDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldExhc3RNZXNzYWdlSWQoKTogbnVtYmVyIHtcbiAgcmV0dXJuIE51bWJlcihzdWJzdGl0dWRlTWFjcm9zKCd7e2xhc3RNZXNzYWdlSWR9fScpKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGVycm9yQ2F0Y2hlZDxUIGV4dGVuZHMgYW55W10sIFU+KGZuOiAoLi4uYXJnczogVCkgPT4gVSk6ICguLi5hcmdzOiBUKSA9PiBVIHtcbiAgY29uc3Qgb25FcnJvciA9IChlcnJvcjogRXJyb3IpID0+IHtcbiAgICB0b2FzdHIuZXJyb3IoYCR7ZXJyb3Iuc3RhY2sgPyBlcnJvci5zdGFjayA6IGVycm9yLm5hbWUgKyAnOiAnICsgZXJyb3IubWVzc2FnZX1gKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfTtcbiAgcmV0dXJuICguLi5hcmdzOiBUKTogVSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGZuKC4uLmFyZ3MpO1xuICAgICAgaWYgKHJlc3VsdCBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgcmV0dXJuIHJlc3VsdC5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgICAgb25FcnJvcihlcnJvcik7XG4gICAgICAgIH0pIGFzIFU7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXR1cm4gb25FcnJvcihlcnJvciBhcyBFcnJvcik7XG4gICAgfVxuICB9O1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/function/util.ts\n")},"./src/function/variables.ts":
/*!***********************************!*\
  !*** ./src/function/variables.ts ***!
  \***********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   deleteVariable: () => (/* binding */ deleteVariable),\n/* harmony export */   getVariables: () => (/* binding */ getVariables),\n/* harmony export */   insertOrAssignVariables: () => (/* binding */ insertOrAssignVariables),\n/* harmony export */   insertVariables: () => (/* binding */ insertVariables),\n/* harmony export */   replaceVariables: () => (/* binding */ replaceVariables),\n/* harmony export */   updateVariablesWith: () => (/* binding */ updateVariablesWith)\n/* harmony export */ });\n/* harmony import */ var _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/script_repository/script_controller */ \"./src/component/script_repository/script_controller.ts\");\n/* harmony import */ var _function_chat_message__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/function/chat_message */ \"./src/function/chat_message.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_4__);\n\n\n\n\n\nfunction getVariablesByType({ type = 'chat', message_id = 'latest', script_id }) {\n    switch (type) {\n        case 'message': {\n            if (message_id !== 'latest' && (message_id < -_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat.length || message_id >= _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat.length)) {\n                throw Error(`提供的 message_id(${message_id}) 超出了聊天消息楼层号范围`);\n            }\n            message_id = message_id === 'latest' ? -1 : message_id;\n            return (0,_function_chat_message__WEBPACK_IMPORTED_MODULE_1__.getChatMessages)(message_id)[0].data;\n        }\n        case 'chat': {\n            const metadata = _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata;\n            if (!metadata.variables) {\n                metadata.variables = {};\n            }\n            return metadata.variables;\n        }\n        case 'character': {\n            //@ts-ignore\n            return _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid]?.data?.extensions?.TavernHelper_characterScriptVariables || {};\n        }\n        case 'global':\n            return _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__.extension_settings.variables.global;\n        case 'script':\n            if (!script_id) {\n                throw Error('获取脚本变量失败, 未指定 script_id');\n            }\n            return _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_0__.ScriptManager.getInstance().getScriptVariables(script_id);\n    }\n}\nfunction getVariables({ type = 'chat', message_id = 'latest', script_id } = {}) {\n    const result = getVariablesByType({ type, message_id, script_id });\n    loglevel__WEBPACK_IMPORTED_MODULE_4___default().info(`获取${type === 'message'\n        ? `'${message_id}' 消息`\n        : type === 'chat'\n            ? '聊天'\n            : type === 'character'\n                ? '角色'\n                : type === 'script'\n                    ? `'${script_id}' 脚本`\n                    : '全局'}变量表:\\n${JSON.stringify(result)}`);\n    return structuredClone(result);\n}\nasync function replaceVariables(variables, { type = 'chat', message_id = 'latest', script_id } = {}) {\n    switch (type) {\n        case 'message':\n            if (message_id !== 'latest' && (message_id < -_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat.length || message_id >= _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat.length)) {\n                throw Error(`提供的 message_id(${message_id}) 超出了聊天消息楼层号范围`);\n            }\n            message_id = message_id === 'latest' ? _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat.length - 1 : message_id < 0 ? _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat.length + message_id : message_id;\n            await (0,_function_chat_message__WEBPACK_IMPORTED_MODULE_1__.setChatMessages)([{ message_id, data: variables }], { refresh: 'none' });\n            break;\n        case 'chat':\n            _.set(_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata, 'variables', variables);\n            await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.saveMetadata)();\n            break;\n        case 'character':\n            if (!_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid) {\n                throw new Error('保存变量失败，当前角色为空');\n            }\n            //@ts-ignore\n            await writeExtensionField(_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.this_chid, 'TavernHelper_characterScriptVariables', variables);\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.eventSource.emit('character_variables_changed', { variables });\n            break;\n        case 'global':\n            _.set(_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__.extension_settings.variables, 'global', variables);\n            await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.saveSettings)();\n            break;\n        case 'script':\n            if (!script_id) {\n                throw Error('保存变量失败, 未指定 script_id');\n            }\n            {\n                const script_manager = _component_script_repository_script_controller__WEBPACK_IMPORTED_MODULE_0__.ScriptManager.getInstance();\n                const script = script_manager.getScriptById(script_id);\n                if (!script) {\n                    throw Error(`'${script_id}' 脚本不存在`);\n                }\n                const script_type = script_manager['scriptData'].getScriptType(script);\n                await script_manager.updateScriptVariables(script_id, variables, script_type);\n            }\n            break;\n    }\n    loglevel__WEBPACK_IMPORTED_MODULE_4___default().info(`将${type === 'message'\n        ? `'${message_id}' 消息`\n        : type === 'chat'\n            ? '聊天'\n            : type === 'character'\n                ? '角色'\n                : type === 'script'\n                    ? `'${script_id}' 脚本`\n                    : '全局'}变量表替换为:\\n${JSON.stringify(variables)}`);\n}\nasync function updateVariablesWith(updater, { type = 'chat', message_id = 'latest', script_id } = {}) {\n    let variables = getVariables({ type, message_id, script_id });\n    variables = await updater(variables);\n    loglevel__WEBPACK_IMPORTED_MODULE_4___default().info(`对${type === 'message'\n        ? `'${message_id}' 消息`\n        : type === 'chat'\n            ? '聊天'\n            : type === 'character'\n                ? '角色'\n                : type === 'script'\n                    ? `'${script_id}' 脚本`\n                    : '全局'}变量表进行更新`);\n    await replaceVariables(variables, { type, message_id, script_id });\n    return variables;\n}\nasync function insertOrAssignVariables(variables, { type = 'chat', message_id = 'latest', script_id } = {}) {\n    await updateVariablesWith(old_variables => _.merge(old_variables, variables), { type, message_id, script_id });\n}\nasync function insertVariables(variables, { type = 'chat', message_id = 'latest', script_id } = {}) {\n    await updateVariablesWith(old_variables => _.defaultsDeep(old_variables, variables), { type, message_id, script_id });\n}\nasync function deleteVariable(variable_path, { type = 'chat', message_id = 'latest', script_id } = {}) {\n    let result = false;\n    await updateVariablesWith(old_variables => {\n        result = _.unset(old_variables, variable_path);\n        return old_variables;\n    }, { type, message_id, script_id });\n    return result;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFDLENBQUMsWUFBWSxDQUFDLGFBQWEsRUFBRSxTQUFTLENBQUMsRUFBRSxFQUFFLElBQUksRUFBRSxVQUFVLEVBQUUsU0FBUyxFQUFFLENBQUMsQ0FBQztBQUN4SCxDQUFDO0FBRU0sS0FBSyxVQUFVLGNBQWMsQ0FDbEMsYUFBcUIsRUFDckIsRUFBRSxJQUFJLEdBQUcsTUFBTSxFQUFFLFVBQVUsR0FBRyxRQUFRLEVBQUUsU0FBUyxLQUFxQixFQUFFO0lBRXhFLElBQUksTUFBTSxHQUFZLEtBQUssQ0FBQztJQUM1QixNQUFNLG1CQUFtQixDQUN2QixhQUFhLENBQUMsRUFBRTtRQUNkLE1BQU0sR0FBRyxDQUFDLENBQUMsS0FBSyxDQUFDLGFBQWEsRUFBRSxhQUFhLENBQUMsQ0FBQztRQUMvQyxPQUFPLGFBQWEsQ0FBQztJQUN2QixDQUFDLEVBQ0QsRUFBRSxJQUFJLEVBQUUsVUFBVSxFQUFFLFNBQVMsRUFBRSxDQUNoQyxDQUFDO0lBQ0YsT0FBTyxNQUFNLENBQUM7QUFDaEIsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9mdW5jdGlvbi92YXJpYWJsZXMudHM/ZTNiMyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBTY3JpcHRNYW5hZ2VyIH0gZnJvbSAnQC9jb21wb25lbnQvc2NyaXB0X3JlcG9zaXRvcnkvc2NyaXB0X2NvbnRyb2xsZXInO1xuaW1wb3J0IHsgZ2V0Q2hhdE1lc3NhZ2VzLCBzZXRDaGF0TWVzc2FnZXMgfSBmcm9tICdAL2Z1bmN0aW9uL2NoYXRfbWVzc2FnZSc7XG5cbmltcG9ydCB7XG4gIGNoYXJhY3RlcnMsXG4gIGNoYXQsXG4gIGNoYXRfbWV0YWRhdGEsXG4gIGV2ZW50U291cmNlLFxuICBzYXZlTWV0YWRhdGEsXG4gIHNhdmVTZXR0aW5ncyxcbiAgdGhpc19jaGlkLFxufSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0JztcbmltcG9ydCB7IGV4dGVuc2lvbl9zZXR0aW5ncyB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL2V4dGVuc2lvbnMnO1xuXG5pbXBvcnQgbG9nIGZyb20gJ2xvZ2xldmVsJztcblxuaW50ZXJmYWNlIFZhcmlhYmxlT3B0aW9uIHtcbiAgdHlwZT86ICdtZXNzYWdlJyB8ICdjaGF0JyB8ICdjaGFyYWN0ZXInIHwgJ3NjcmlwdCcgfCAnZ2xvYmFsJztcbiAgbWVzc2FnZV9pZD86IG51bWJlciB8ICdsYXRlc3QnO1xuICBzY3JpcHRfaWQ/OiBzdHJpbmc7XG59XG5cbmZ1bmN0aW9uIGdldFZhcmlhYmxlc0J5VHlwZSh7IHR5cGUgPSAnY2hhdCcsIG1lc3NhZ2VfaWQgPSAnbGF0ZXN0Jywgc2NyaXB0X2lkIH06IFZhcmlhYmxlT3B0aW9uKTogUmVjb3JkPHN0cmluZywgYW55PiB7XG4gIHN3aXRjaCAodHlwZSkge1xuICAgIGNhc2UgJ21lc3NhZ2UnOiB7XG4gICAgICBpZiAobWVzc2FnZV9pZCAhPT0gJ2xhdGVzdCcgJiYgKG1lc3NhZ2VfaWQgPCAtY2hhdC5sZW5ndGggfHwgbWVzc2FnZV9pZCA+PSBjaGF0Lmxlbmd0aCkpIHtcbiAgICAgICAgdGhyb3cgRXJyb3IoYOaPkOS+m+eahCBtZXNzYWdlX2lkKCR7bWVzc2FnZV9pZH0pIOi2heWHuuS6huiBiuWkqea2iOaBr+alvOWxguWPt+iMg+WbtGApO1xuICAgICAgfVxuICAgICAgbWVzc2FnZV9pZCA9IG1lc3NhZ2VfaWQgPT09ICdsYXRlc3QnID8gLTEgOiBtZXNzYWdlX2lkO1xuICAgICAgcmV0dXJuIGdldENoYXRNZXNzYWdlcyhtZXNzYWdlX2lkKVswXS5kYXRhO1xuICAgIH1cbiAgICBjYXNlICdjaGF0Jzoge1xuICAgICAgY29uc3QgbWV0YWRhdGEgPSBjaGF0X21ldGFkYXRhIGFzIHtcbiAgICAgICAgdmFyaWFibGVzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+IHwgdW5kZWZpbmVkO1xuICAgICAgfTtcbiAgICAgIGlmICghbWV0YWRhdGEudmFyaWFibGVzKSB7XG4gICAgICAgIG1ldGFkYXRhLnZhcmlhYmxlcyA9IHt9O1xuICAgICAgfVxuICAgICAgcmV0dXJuIG1ldGFkYXRhLnZhcmlhYmxlcztcbiAgICB9XG4gICAgY2FzZSAnY2hhcmFjdGVyJzoge1xuICAgICAgLy9AdHMtaWdub3JlXG4gICAgICByZXR1cm4gY2hhcmFjdGVyc1t0aGlzX2NoaWRdPy5kYXRhPy5leHRlbnNpb25zPy5UYXZlcm5IZWxwZXJfY2hhcmFjdGVyU2NyaXB0VmFyaWFibGVzIHx8IHt9O1xuICAgIH1cbiAgICBjYXNlICdnbG9iYWwnOlxuICAgICAgcmV0dXJuIGV4dGVuc2lvbl9zZXR0aW5ncy52YXJpYWJsZXMuZ2xvYmFsO1xuICAgIGNhc2UgJ3NjcmlwdCc6XG4gICAgICBpZiAoIXNjcmlwdF9pZCkge1xuICAgICAgICB0aHJvdyBFcnJvcign6I635Y+W6ISa5pys5Y+Y6YeP5aSx6LSlLCDmnKrmjIflrpogc2NyaXB0X2lkJyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gU2NyaXB0TWFuYWdlci5nZXRJbnN0YW5jZSgpLmdldFNjcmlwdFZhcmlhYmxlcyhzY3JpcHRfaWQpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRWYXJpYWJsZXMoeyB0eXBlID0gJ2NoYXQnLCBtZXNzYWdlX2lkID0gJ2xhdGVzdCcsIHNjcmlwdF9pZCB9OiBWYXJpYWJsZU9wdGlvbiA9IHt9KTogUmVjb3JkPFxuICBzdHJpbmcsXG4gIGFueVxuPiB7XG4gIGNvbnN0IHJlc3VsdCA9IGdldFZhcmlhYmxlc0J5VHlwZSh7IHR5cGUsIG1lc3NhZ2VfaWQsIHNjcmlwdF9pZCB9KTtcblxuICBsb2cuaW5mbyhcbiAgICBg6I635Y+WJHtcbiAgICAgIHR5cGUgPT09ICdtZXNzYWdlJ1xuICAgICAgICA/IGAnJHttZXNzYWdlX2lkfScg5raI5oGvYFxuICAgICAgICA6IHR5cGUgPT09ICdjaGF0J1xuICAgICAgICA/ICfogYrlpKknXG4gICAgICAgIDogdHlwZSA9PT0gJ2NoYXJhY3RlcidcbiAgICAgICAgPyAn6KeS6ImyJ1xuICAgICAgICA6IHR5cGUgPT09ICdzY3JpcHQnXG4gICAgICAgID8gYCcke3NjcmlwdF9pZH0nIOiEmuacrGBcbiAgICAgICAgOiAn5YWo5bGAJ1xuICAgIH3lj5jph4/ooag6XFxuJHtKU09OLnN0cmluZ2lmeShyZXN1bHQpfWAsXG4gICk7XG4gIHJldHVybiBzdHJ1Y3R1cmVkQ2xvbmUocmVzdWx0KTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlcGxhY2VWYXJpYWJsZXMoXG4gIHZhcmlhYmxlczogUmVjb3JkPHN0cmluZywgYW55PixcbiAgeyB0eXBlID0gJ2NoYXQnLCBtZXNzYWdlX2lkID0gJ2xhdGVzdCcsIHNjcmlwdF9pZCB9OiBWYXJpYWJsZU9wdGlvbiA9IHt9LFxuKTogUHJvbWlzZTx2b2lkPiB7XG4gIHN3aXRjaCAodHlwZSkge1xuICAgIGNhc2UgJ21lc3NhZ2UnOlxuICAgICAgaWYgKG1lc3NhZ2VfaWQgIT09ICdsYXRlc3QnICYmIChtZXNzYWdlX2lkIDwgLWNoYXQubGVuZ3RoIHx8IG1lc3NhZ2VfaWQgPj0gY2hhdC5sZW5ndGgpKSB7XG4gICAgICAgIHRocm93IEVycm9yKGDmj5DkvpvnmoQgbWVzc2FnZV9pZCgke21lc3NhZ2VfaWR9KSDotoXlh7rkuobogYrlpKnmtojmga/mpbzlsYLlj7fojIPlm7RgKTtcbiAgICAgIH1cbiAgICAgIG1lc3NhZ2VfaWQgPSBtZXNzYWdlX2lkID09PSAnbGF0ZXN0JyA/IGNoYXQubGVuZ3RoIC0gMSA6IG1lc3NhZ2VfaWQgPCAwID8gY2hhdC5sZW5ndGggKyBtZXNzYWdlX2lkIDogbWVzc2FnZV9pZDtcbiAgICAgIGF3YWl0IHNldENoYXRNZXNzYWdlcyhbeyBtZXNzYWdlX2lkLCBkYXRhOiB2YXJpYWJsZXMgfV0sIHsgcmVmcmVzaDogJ25vbmUnIH0pO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAnY2hhdCc6XG4gICAgICBfLnNldChjaGF0X21ldGFkYXRhLCAndmFyaWFibGVzJywgdmFyaWFibGVzKTtcbiAgICAgIGF3YWl0IHNhdmVNZXRhZGF0YSgpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAnY2hhcmFjdGVyJzpcbiAgICAgIGlmICghdGhpc19jaGlkKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcign5L+d5a2Y5Y+Y6YeP5aSx6LSl77yM5b2T5YmN6KeS6Imy5Li656m6Jyk7XG4gICAgICB9XG4gICAgICAvL0B0cy1pZ25vcmVcbiAgICAgIGF3YWl0IHdyaXRlRXh0ZW5zaW9uRmllbGQodGhpc19jaGlkLCAnVGF2ZXJuSGVscGVyX2NoYXJhY3RlclNjcmlwdFZhcmlhYmxlcycsIHZhcmlhYmxlcyk7XG4gICAgICBldmVudFNvdXJjZS5lbWl0KCdjaGFyYWN0ZXJfdmFyaWFibGVzX2NoYW5nZWQnLCB7IHZhcmlhYmxlcyB9KTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ2dsb2JhbCc6XG4gICAgICBfLnNldChleHRlbnNpb25fc2V0dGluZ3MudmFyaWFibGVzLCAnZ2xvYmFsJywgdmFyaWFibGVzKTtcbiAgICAgIGF3YWl0IHNhdmVTZXR0aW5ncygpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAnc2NyaXB0JzpcbiAgICAgIGlmICghc2NyaXB0X2lkKSB7XG4gICAgICAgIHRocm93IEVycm9yKCfkv53lrZjlj5jph4/lpLHotKUsIOacquaMh+WumiBzY3JpcHRfaWQnKTtcbiAgICAgIH1cbiAgICAgIHtcbiAgICAgICAgY29uc3Qgc2NyaXB0X21hbmFnZXIgPSBTY3JpcHRNYW5hZ2VyLmdldEluc3RhbmNlKCk7XG4gICAgICAgIGNvbnN0IHNjcmlwdCA9IHNjcmlwdF9tYW5hZ2VyLmdldFNjcmlwdEJ5SWQoc2NyaXB0X2lkKTtcbiAgICAgICAgaWYgKCFzY3JpcHQpIHtcbiAgICAgICAgICB0aHJvdyBFcnJvcihgJyR7c2NyaXB0X2lkfScg6ISa5pys5LiN5a2Y5ZyoYCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc2NyaXB0X3R5cGUgPSBzY3JpcHRfbWFuYWdlclsnc2NyaXB0RGF0YSddLmdldFNjcmlwdFR5cGUoc2NyaXB0KTtcbiAgICAgICAgYXdhaXQgc2NyaXB0X21hbmFnZXIudXBkYXRlU2NyaXB0VmFyaWFibGVzKHNjcmlwdF9pZCwgdmFyaWFibGVzLCBzY3JpcHRfdHlwZSk7XG4gICAgICB9XG4gICAgICBicmVhaztcbiAgfVxuXG4gIGxvZy5pbmZvKFxuICAgIGDlsIYke1xuICAgICAgdHlwZSA9PT0gJ21lc3NhZ2UnXG4gICAgICAgID8gYCcke21lc3NhZ2VfaWR9JyDmtojmga9gXG4gICAgICAgIDogdHlwZSA9PT0gJ2NoYXQnXG4gICAgICAgID8gJ+iBiuWkqSdcbiAgICAgICAgOiB0eXBlID09PSAnY2hhcmFjdGVyJ1xuICAgICAgICA/ICfop5LoibInXG4gICAgICAgIDogdHlwZSA9PT0gJ3NjcmlwdCdcbiAgICAgICAgPyBgJyR7c2NyaXB0X2lkfScg6ISa5pysYFxuICAgICAgICA6ICflhajlsYAnXG4gICAgfeWPmOmHj+ihqOabv+aNouS4ujpcXG4ke0pTT04uc3RyaW5naWZ5KHZhcmlhYmxlcyl9YCxcbiAgKTtcbn1cblxudHlwZSBWYXJpYWJsZXNVcGRhdGVyID1cbiAgfCAoKHZhcmlhYmxlczogUmVjb3JkPHN0cmluZywgYW55PikgPT4gUmVjb3JkPHN0cmluZywgYW55PilcbiAgfCAoKHZhcmlhYmxlczogUmVjb3JkPHN0cmluZywgYW55PikgPT4gUHJvbWlzZTxSZWNvcmQ8c3RyaW5nLCBhbnk+Pik7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVWYXJpYWJsZXNXaXRoKFxuICB1cGRhdGVyOiBWYXJpYWJsZXNVcGRhdGVyLFxuICB7IHR5cGUgPSAnY2hhdCcsIG1lc3NhZ2VfaWQgPSAnbGF0ZXN0Jywgc2NyaXB0X2lkIH06IFZhcmlhYmxlT3B0aW9uID0ge30sXG4pOiBQcm9taXNlPFJlY29yZDxzdHJpbmcsIGFueT4+IHtcbiAgbGV0IHZhcmlhYmxlcyA9IGdldFZhcmlhYmxlcyh7IHR5cGUsIG1lc3NhZ2VfaWQsIHNjcmlwdF9pZCB9KTtcbiAgdmFyaWFibGVzID0gYXdhaXQgdXBkYXRlcih2YXJpYWJsZXMpO1xuICBsb2cuaW5mbyhcbiAgICBg5a+5JHtcbiAgICAgIHR5cGUgPT09ICdtZXNzYWdlJ1xuICAgICAgICA/IGAnJHttZXNzYWdlX2lkfScg5raI5oGvYFxuICAgICAgICA6IHR5cGUgPT09ICdjaGF0J1xuICAgICAgICA/ICfogYrlpKknXG4gICAgICAgIDogdHlwZSA9PT0gJ2NoYXJhY3RlcidcbiAgICAgICAgPyAn6KeS6ImyJ1xuICAgICAgICA6IHR5cGUgPT09ICdzY3JpcHQnXG4gICAgICAgID8gYCcke3NjcmlwdF9pZH0nIOiEmuacrGBcbiAgICAgICAgOiAn5YWo5bGAJ1xuICAgIH3lj5jph4/ooajov5vooYzmm7TmlrBgLFxuICApO1xuICBhd2FpdCByZXBsYWNlVmFyaWFibGVzKHZhcmlhYmxlcywgeyB0eXBlLCBtZXNzYWdlX2lkLCBzY3JpcHRfaWQgfSk7XG4gIHJldHVybiB2YXJpYWJsZXM7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbnNlcnRPckFzc2lnblZhcmlhYmxlcyhcbiAgdmFyaWFibGVzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+LFxuICB7IHR5cGUgPSAnY2hhdCcsIG1lc3NhZ2VfaWQgPSAnbGF0ZXN0Jywgc2NyaXB0X2lkIH06IFZhcmlhYmxlT3B0aW9uID0ge30sXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgYXdhaXQgdXBkYXRlVmFyaWFibGVzV2l0aChvbGRfdmFyaWFibGVzID0+IF8ubWVyZ2Uob2xkX3ZhcmlhYmxlcywgdmFyaWFibGVzKSwgeyB0eXBlLCBtZXNzYWdlX2lkLCBzY3JpcHRfaWQgfSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbnNlcnRWYXJpYWJsZXMoXG4gIHZhcmlhYmxlczogUmVjb3JkPHN0cmluZywgYW55PixcbiAgeyB0eXBlID0gJ2NoYXQnLCBtZXNzYWdlX2lkID0gJ2xhdGVzdCcsIHNjcmlwdF9pZCB9OiBWYXJpYWJsZU9wdGlvbiA9IHt9LFxuKTogUHJvbWlzZTx2b2lkPiB7XG4gIGF3YWl0IHVwZGF0ZVZhcmlhYmxlc1dpdGgob2xkX3ZhcmlhYmxlcyA9PiBfLmRlZmF1bHRzRGVlcChvbGRfdmFyaWFibGVzLCB2YXJpYWJsZXMpLCB7IHR5cGUsIG1lc3NhZ2VfaWQsIHNjcmlwdF9pZCB9KTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVZhcmlhYmxlKFxuICB2YXJpYWJsZV9wYXRoOiBzdHJpbmcsXG4gIHsgdHlwZSA9ICdjaGF0JywgbWVzc2FnZV9pZCA9ICdsYXRlc3QnLCBzY3JpcHRfaWQgfTogVmFyaWFibGVPcHRpb24gPSB7fSxcbik6IFByb21pc2U8Ym9vbGVhbj4ge1xuICBsZXQgcmVzdWx0OiBib29sZWFuID0gZmFsc2U7XG4gIGF3YWl0IHVwZGF0ZVZhcmlhYmxlc1dpdGgoXG4gICAgb2xkX3ZhcmlhYmxlcyA9PiB7XG4gICAgICByZXN1bHQgPSBfLnVuc2V0KG9sZF92YXJpYWJsZXMsIHZhcmlhYmxlX3BhdGgpO1xuICAgICAgcmV0dXJuIG9sZF92YXJpYWJsZXM7XG4gICAgfSxcbiAgICB7IHR5cGUsIG1lc3NhZ2VfaWQsIHNjcmlwdF9pZCB9LFxuICApO1xuICByZXR1cm4gcmVzdWx0O1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/function/variables.ts\n")},"./src/function/version.ts":
/*!*********************************!*\
  !*** ./src/function/version.ts ***!
  \*********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getTavernHelperVersion: () => (/* binding */ getTavernHelperVersion),\n/* harmony export */   updateTavernHelper: () => (/* binding */ updateTavernHelper)\n/* harmony export */ });\n/* harmony import */ var _util_check_update__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/util/check_update */ \"./src/util/check_update.ts\");\n\nasync function getTavernHelperVersion() {\n    const currentVersion = await (0,_util_check_update__WEBPACK_IMPORTED_MODULE_0__.getCurrentVersion)(_util_check_update__WEBPACK_IMPORTED_MODULE_0__.VERSION_FILE_PATH);\n    if (typeof currentVersion !== 'string') {\n        throw new Error('获取的版本号无效');\n    }\n    return currentVersion;\n}\nasync function updateTavernHelper() {\n    return (0,_util_check_update__WEBPACK_IMPORTED_MODULE_0__.updateTavernHelper)();\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZnVuY3Rpb24vdmVyc2lvbi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFJNkI7QUFFdEIsS0FBSyxVQUFVLHNCQUFzQjtJQUMxQyxNQUFNLGNBQWMsR0FBRyxNQUFNLHFFQUFpQixDQUFDLGlFQUFpQixDQUFDLENBQUM7SUFDbEUsSUFBSSxPQUFPLGNBQWMsS0FBSyxRQUFRLEVBQUUsQ0FBQztRQUN2QyxNQUFNLElBQUksS0FBSyxDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBQzlCLENBQUM7SUFDRCxPQUFPLGNBQWMsQ0FBQztBQUN4QixDQUFDO0FBRU0sS0FBSyxVQUFVLGtCQUFrQjtJQUN0QyxPQUFPLHNFQUFzQixFQUFFLENBQUM7QUFDbEMsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9mdW5jdGlvbi92ZXJzaW9uLnRzPzI5OWQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgZ2V0Q3VycmVudFZlcnNpb24sXG4gIHVwZGF0ZVRhdmVybkhlbHBlciBhcyB1cGRhdGVUYXZlcm5IZWxwZXJJbXBsLFxuICBWRVJTSU9OX0ZJTEVfUEFUSCxcbn0gZnJvbSAnQC91dGlsL2NoZWNrX3VwZGF0ZSc7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRUYXZlcm5IZWxwZXJWZXJzaW9uKCk6IFByb21pc2U8c3RyaW5nPiB7XG4gIGNvbnN0IGN1cnJlbnRWZXJzaW9uID0gYXdhaXQgZ2V0Q3VycmVudFZlcnNpb24oVkVSU0lPTl9GSUxFX1BBVEgpO1xuICBpZiAodHlwZW9mIGN1cnJlbnRWZXJzaW9uICE9PSAnc3RyaW5nJykge1xuICAgIHRocm93IG5ldyBFcnJvcign6I635Y+W55qE54mI5pys5Y+35peg5pWIJyk7XG4gIH1cbiAgcmV0dXJuIGN1cnJlbnRWZXJzaW9uO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlVGF2ZXJuSGVscGVyKCkge1xuICByZXR1cm4gdXBkYXRlVGF2ZXJuSGVscGVySW1wbCgpO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/function/version.ts\n")},"./src/iframe_client/_exported.ts?raw":
/*!********************************************!*\
  !*** ./src/iframe_client/_exported.ts?raw ***!
  \********************************************/Q=>{Q.exports='"use strict";\nconst SillyTavern = window.parent.SillyTavern.getContext();\nconst TavernHelper = window.parent.TavernHelper;\nfor (const key in TavernHelper) {\n    window[key] = TavernHelper[key];\n}\nconst toastr = window.parent.toastr;\nconst log = window.parent.log;\nconst EjsTemplate = window.parent.EjsTemplate;\n'},"./src/iframe_client/_impl.ts?raw":
/*!****************************************!*\
  !*** ./src/iframe_client/_impl.ts?raw ***!
  \****************************************/Q=>{Q.exports="\"use strict\";\n// @ts-expect-error\nvar detail;\n(function (detail) {\n    async function make_iframe_promise(message) {\n        return new Promise((resolve, _) => {\n            const uid = Date.now() + Math.random();\n            function handleMessage(event) {\n                if (event.data?.request === message.request + '_callback' && event.data.uid == uid) {\n                    window.removeEventListener('message', handleMessage);\n                    resolve(event.data.result);\n                }\n            }\n            window.addEventListener('message', handleMessage);\n            window.parent.postMessage({\n                uid: uid,\n                ...message,\n            }, '*');\n        });\n    }\n    detail.make_iframe_promise = make_iframe_promise;\n    function format_function_to_string(fn) {\n        const string = fn.toString();\n        const index = string.indexOf('\\n');\n        if (index > -1) {\n            return string.slice(0, index);\n        }\n        else {\n            return string;\n        }\n    }\n    detail.format_function_to_string = format_function_to_string;\n    function get_or_set(map, key, defaulter) {\n        const existing_value = map.get(key);\n        if (existing_value) {\n            return existing_value;\n        }\n        const default_value = defaulter();\n        map.set(key, default_value);\n        return default_value;\n    }\n    detail.get_or_set = get_or_set;\n    function extract(map, key) {\n        const value = map.get(key);\n        if (!value) {\n            return undefined;\n        }\n        map.delete(key);\n        return value;\n    }\n    detail.extract = extract;\n})(detail || (detail = {}));\n"},"./src/iframe_client/_multimap.ts?raw":
/*!********************************************!*\
  !*** ./src/iframe_client/_multimap.ts?raw ***!
  \********************************************/Q=>{Q.exports="\"use strict\";\n// 命名为 _multimap.ts, 保证它被插入在开头, 虽然最好换一种 iframe 内代码的做法\nclass Multimap {\n    size_ = 0;\n    map = new Map();\n    operator;\n    constructor(operator, iterable) {\n        this.operator = operator;\n        if (iterable) {\n            for (const [key, value] of iterable) {\n                this.put(key, value);\n            }\n        }\n        return this;\n    }\n    get size() {\n        return this.size_;\n    }\n    get(key) {\n        const values = this.map.get(key);\n        if (values) {\n            return this.operator.clone(values);\n        }\n        else {\n            return this.operator.create();\n        }\n    }\n    put(key, value) {\n        let values = this.map.get(key);\n        if (!values) {\n            values = this.operator.create();\n        }\n        if (!this.operator.add(value, values)) {\n            return false;\n        }\n        this.map.set(key, values);\n        this.size_++;\n        return true;\n    }\n    putAll(arg1, arg2) {\n        let pushed = 0;\n        if (arg2) {\n            const key = arg1;\n            const values = arg2;\n            for (const value of values) {\n                this.put(key, value);\n                pushed++;\n            }\n        }\n        else if (arg1 instanceof Multimap) {\n            for (const [key, value] of arg1.entries()) {\n                this.put(key, value);\n                pushed++;\n            }\n        }\n        else {\n            throw new TypeError('unexpected arguments');\n        }\n        return pushed > 0;\n    }\n    has(key) {\n        return this.map.has(key);\n    }\n    hasEntry(key, value) {\n        return this.operator.has(value, this.get(key));\n    }\n    delete(key) {\n        this.size_ -= this.operator.size(this.get(key));\n        return this.map.delete(key);\n    }\n    deleteEntry(key, value) {\n        const current = this.get(key);\n        if (!this.operator.delete(value, current)) {\n            return false;\n        }\n        this.map.set(key, current);\n        this.size_--;\n        return true;\n    }\n    clear() {\n        this.map.clear();\n        this.size_ = 0;\n    }\n    keys() {\n        return this.map.keys();\n    }\n    entries() {\n        const self = this;\n        function* gen() {\n            for (const [key, values] of self.map.entries()) {\n                for (const value of values) {\n                    yield [key, value];\n                }\n            }\n        }\n        return gen();\n    }\n    values() {\n        const self = this;\n        function* gen() {\n            for (const [, value] of self.entries()) {\n                yield value;\n            }\n        }\n        return gen();\n    }\n    forEach(callback, thisArg) {\n        for (const [key, value] of this.entries()) {\n            callback.call(thisArg === undefined ? this : thisArg, value, key, this);\n        }\n    }\n    [Symbol.iterator]() {\n        return this.entries();\n    }\n    asMap() {\n        const ret = new Map();\n        for (const key of this.keys()) {\n            ret.set(key, this.operator.clone(this.get(key)));\n        }\n        return ret;\n    }\n}\nclass ArrayMultimap extends Multimap {\n    constructor(iterable) {\n        super(new ArrayOperator(), iterable);\n    }\n    get [Symbol.toStringTag]() {\n        return 'ArrayMultimap';\n    }\n}\nclass ArrayOperator {\n    create() {\n        return [];\n    }\n    clone(collection) {\n        return collection.slice();\n    }\n    add(value, collection) {\n        collection.push(value);\n        return true;\n    }\n    size(collection) {\n        return collection.length;\n    }\n    delete(value, collection) {\n        const index = collection.indexOf(value);\n        if (index > -1) {\n            collection.splice(index, 1);\n            return true;\n        }\n        return false;\n    }\n    has(value, collection) {\n        return collection.includes(value);\n    }\n}\nclass SetMultimap extends Multimap {\n    constructor(iterable) {\n        super(new SetOperator(), iterable);\n    }\n    get [Symbol.toStringTag]() {\n        return 'SetMultimap';\n    }\n}\nclass SetOperator {\n    create() {\n        return new Set();\n    }\n    clone(collection) {\n        return new Set(collection);\n    }\n    add(value, collection) {\n        const prev = collection.size;\n        collection.add(value);\n        return prev !== collection.size;\n    }\n    size(collection) {\n        return collection.size;\n    }\n    delete(value, collection) {\n        return collection.delete(value);\n    }\n    has(value, collection) {\n        return collection.has(value);\n    }\n}\n"},"./src/iframe_client/event.ts?raw":
/*!****************************************!*\
  !*** ./src/iframe_client/event.ts?raw ***!
  \****************************************/Q=>{Q.exports="\"use strict\";\nfunction eventOn(event_type, listener) {\n    if (detail.try_get_wrapper(listener, event_type)) {\n        log.warn(`[Event][eventOn] 函数已经在监听 '${event_type}' 事件, 调用无效\\n\\n  ${detail.format_function_to_string(listener)}`);\n        return;\n    }\n    SillyTavern.eventSource.on(event_type, detail.get_or_make_wrapper(listener, event_type, false));\n    log.info(`[Event][eventOn] 函数开始监听 '${event_type}' 事件并将随事件触发\\n\\n  ${detail.format_function_to_string(listener)}`);\n}\nfunction eventOnButton(event_type, listener) {\n    const script_id = getScriptId();\n    if (detail.try_get_wrapper(listener, event_type)) {\n        log.warn(`[Event][eventOnButton](id为${String(script_id)}) 的脚本已经在监听 '${event_type}' 事件, 调用无效\\n\\n  ${detail.format_function_to_string(listener)}`);\n        return;\n    }\n    const event_type_with_script_id = `${String(script_id)}_${event_type}`;\n    SillyTavern.eventSource.on(event_type_with_script_id, detail.get_or_make_wrapper(listener, event_type_with_script_id, false));\n    log.info(`[Event][eventOnButton](script_id为${String(script_id)}) 函数开始监听 '${event_type}' 事件并将随事件触发\\n\\n  ${detail.format_function_to_string(listener)}`);\n}\nfunction eventMakeLast(event_type, listener) {\n    const is_listening = detail.try_get_wrapper(listener, event_type) !== undefined;\n    SillyTavern.eventSource.makeLast(event_type, detail.get_or_make_wrapper(listener, event_type, false));\n    if (is_listening) {\n        log.info(`[Event][eventMakeLast](${getIframeName()}) 函数调整为监听到 '${event_type}' 事件时最后触发\\n\\n  ${detail.format_function_to_string(listener)}`);\n    }\n    else {\n        log.info(`[Event][eventMakeLast](${getIframeName()}) 函数开始监听 '${event_type}' 事件并将随事件最后触发\\n\\n  ${detail.format_function_to_string(listener)}`);\n    }\n}\nfunction eventMakeFirst(event_type, listener) {\n    const is_listening = detail.try_get_wrapper(listener, event_type) !== undefined;\n    SillyTavern.eventSource.makeFirst(event_type, detail.get_or_make_wrapper(listener, event_type, false));\n    if (is_listening) {\n        log.info(`[Event][eventMakeFirst](${getIframeName()}) 函数调整为监听到 '${event_type}' 事件时最先触发\\n\\n  ${detail.format_function_to_string(listener)}`);\n    }\n    else {\n        log.info(`[Event][eventMakeFirst](${getIframeName()}) 函数开始监听 '${event_type}' 事件并将随事件最先触发\\n\\n  ${detail.format_function_to_string(listener)}`);\n    }\n}\nfunction eventOnce(event_type, listener) {\n    if (detail.try_get_wrapper(listener, event_type)) {\n        log.warn(`[Event][eventOnce](${getIframeName()}) 函数已经在监听 '${event_type}' 事件, 调用无效\\n\\n  ${detail.format_function_to_string(listener)}`);\n        return;\n    }\n    SillyTavern.eventSource.once(event_type, detail.get_or_make_wrapper(listener, event_type, true));\n    log.info(`[Event][eventOnce](${getIframeName()}) 函数开始监听下一次 '${event_type}' 事件并仅在该次事件时触发\\n\\n  ${detail.format_function_to_string(listener)}`);\n}\nasync function eventWaitOnce(event_type, listener) {\n    if (!listener) {\n        const do_nothing = () => { };\n        eventOnce(event_type, do_nothing);\n        return await eventWaitOnce(event_type, do_nothing);\n    }\n    const entry = `${event_type}#${listener.toString()}`;\n    return new Promise((resolve, _) => {\n        const uid = Date.now() + Math.random();\n        function handleMessage(event) {\n            if (event.data?.request === 'iframe_event_wait_callback' && event.data.uid == uid) {\n                window.removeEventListener('message', handleMessage);\n                resolve(event.data.result);\n                detail.waiting_event_map.deleteEntry(entry, uid);\n                log.info(`[Event][eventWaitOnce](${getIframeName()}) 等待到函数因 '${event_type}' 事件触发后的执行结果: ${JSON.stringify(event.data.result)}\\n\\n  ${detail.format_function_to_string(listener)}`);\n            }\n        }\n        window.addEventListener('message', handleMessage);\n        detail.waiting_event_map.put(entry, uid);\n        log.info(`[Event][eventWaitOnce](${getIframeName()}) 等待函数被 '${event_type}' 事件触发\\n\\n  ${detail.format_function_to_string(listener)}`);\n    });\n}\nasync function eventEmit(event_type, ...data) {\n    await SillyTavern.eventSource.emit(event_type, ...data);\n    log.info(`[Event][eventEmit](${getIframeName()}) 发送 '${event_type}' 事件, 携带数据: ${JSON.stringify(data)}`);\n}\nfunction eventEmitAndWait(event_type, ...data) {\n    SillyTavern.eventSource.emitAndWait(event_type, ...data);\n    log.info(`[Event][eventEmitAndWait](${getIframeName()}) 发送 '${event_type}' 事件, 携带数据: ${JSON.stringify(data)}`);\n}\nfunction eventRemoveListener(event_type, listener) {\n    const wrapper = detail.try_get_wrapper(listener, event_type);\n    if (!wrapper) {\n        log.warn(`[Event][eventRemoveListener](${getIframeName()}) 函数没有监听 '${event_type}' 事件, 调用无效\\n\\n  ${detail.format_function_to_string(listener)}`);\n        return;\n    }\n    SillyTavern.eventSource.removeListener(event_type, wrapper);\n    detail.remove_wrapper(listener, event_type);\n    log.info(`[Event][eventRemoveListener](${getIframeName()}) 函数不再监听 '${event_type}' 事件\\n\\n  ${detail.format_function_to_string(listener)}`);\n}\nfunction eventClearEvent(event_type) {\n    detail.listener_event_wrapper_map.forEach((event_wrapper_map, _) => {\n        const wrapper = event_wrapper_map.get(event_type);\n        if (wrapper) {\n            SillyTavern.eventSource.removeListener(event_type, wrapper);\n            event_wrapper_map.delete(event_type);\n        }\n    });\n    log.info(`[Event][eventClearEvent](${getIframeName()})所有函数都不再监听 '${event_type}' 事件`);\n}\nfunction eventClearListener(listener) {\n    const event_callback_map = detail.extract(detail.listener_event_wrapper_map, listener);\n    if (event_callback_map) {\n        event_callback_map.forEach((callback, event_type) => {\n            SillyTavern.eventSource.removeListener(event_type, callback);\n        });\n    }\n    log.info(`[Event][eventClearListener](${getIframeName()}) 函数不再监听任何事件\\n\\n  ${detail.format_function_to_string(listener)}`);\n}\nfunction eventClearAll() {\n    detail.listener_event_wrapper_map.forEach((event_wrapper_map, _) => {\n        event_wrapper_map.forEach((wrapper, event_type) => {\n            SillyTavern.eventSource.removeListener(event_type, wrapper);\n        });\n    });\n    detail.listener_event_wrapper_map.clear();\n    log.info(`[Event][eventClearAll](${getIframeName()}) 取消所有函数对所有事件的监听`);\n}\nconst iframe_events = {\n    MESSAGE_IFRAME_RENDER_STARTED: 'message_iframe_render_started',\n    MESSAGE_IFRAME_RENDER_ENDED: 'message_iframe_render_ended',\n    GENERATION_STARTED: 'js_generation_started',\n    STREAM_TOKEN_RECEIVED_FULLY: 'js_stream_token_received_fully',\n    STREAM_TOKEN_RECEIVED_INCREMENTALLY: 'js_stream_token_received_incrementally',\n    GENERATION_ENDED: 'js_generation_ended',\n};\nconst tavern_events = {\n    APP_READY: 'app_ready',\n    EXTRAS_CONNECTED: 'extras_connected',\n    MESSAGE_SWIPED: 'message_swiped',\n    MESSAGE_SENT: 'message_sent',\n    MESSAGE_RECEIVED: 'message_received',\n    MESSAGE_EDITED: 'message_edited',\n    MESSAGE_DELETED: 'message_deleted',\n    MESSAGE_UPDATED: 'message_updated',\n    MESSAGE_FILE_EMBEDDED: 'message_file_embedded',\n    IMPERSONATE_READY: 'impersonate_ready',\n    CHAT_CHANGED: 'chat_id_changed',\n    GENERATION_AFTER_COMMANDS: 'GENERATION_AFTER_COMMANDS',\n    GENERATION_STARTED: 'generation_started',\n    GENERATION_STOPPED: 'generation_stopped',\n    GENERATION_ENDED: 'generation_ended',\n    EXTENSIONS_FIRST_LOAD: 'extensions_first_load',\n    EXTENSION_SETTINGS_LOADED: 'extension_settings_loaded',\n    SETTINGS_LOADED: 'settings_loaded',\n    SETTINGS_UPDATED: 'settings_updated',\n    GROUP_UPDATED: 'group_updated',\n    MOVABLE_PANELS_RESET: 'movable_panels_reset',\n    SETTINGS_LOADED_BEFORE: 'settings_loaded_before',\n    SETTINGS_LOADED_AFTER: 'settings_loaded_after',\n    CHATCOMPLETION_SOURCE_CHANGED: 'chatcompletion_source_changed',\n    CHATCOMPLETION_MODEL_CHANGED: 'chatcompletion_model_changed',\n    OAI_PRESET_CHANGED_BEFORE: 'oai_preset_changed_before',\n    OAI_PRESET_CHANGED_AFTER: 'oai_preset_changed_after',\n    OAI_PRESET_EXPORT_READY: 'oai_preset_export_ready',\n    OAI_PRESET_IMPORT_READY: 'oai_preset_import_ready',\n    WORLDINFO_SETTINGS_UPDATED: 'worldinfo_settings_updated',\n    WORLDINFO_UPDATED: 'worldinfo_updated',\n    CHARACTER_EDITED: 'character_edited',\n    CHARACTER_PAGE_LOADED: 'character_page_loaded',\n    CHARACTER_GROUP_OVERLAY_STATE_CHANGE_BEFORE: 'character_group_overlay_state_change_before',\n    CHARACTER_GROUP_OVERLAY_STATE_CHANGE_AFTER: 'character_group_overlay_state_change_after',\n    USER_MESSAGE_RENDERED: 'user_message_rendered',\n    CHARACTER_MESSAGE_RENDERED: 'character_message_rendered',\n    FORCE_SET_BACKGROUND: 'force_set_background',\n    CHAT_DELETED: 'chat_deleted',\n    CHAT_CREATED: 'chat_created',\n    GROUP_CHAT_DELETED: 'group_chat_deleted',\n    GROUP_CHAT_CREATED: 'group_chat_created',\n    GENERATE_BEFORE_COMBINE_PROMPTS: 'generate_before_combine_prompts',\n    GENERATE_AFTER_COMBINE_PROMPTS: 'generate_after_combine_prompts',\n    GENERATE_AFTER_DATA: 'generate_after_data',\n    GROUP_MEMBER_DRAFTED: 'group_member_drafted',\n    WORLD_INFO_ACTIVATED: 'world_info_activated',\n    TEXT_COMPLETION_SETTINGS_READY: 'text_completion_settings_ready',\n    CHAT_COMPLETION_SETTINGS_READY: 'chat_completion_settings_ready',\n    CHAT_COMPLETION_PROMPT_READY: 'chat_completion_prompt_ready',\n    CHARACTER_FIRST_MESSAGE_SELECTED: 'character_first_message_selected',\n    // TODO: Naming convention is inconsistent with other events\n    CHARACTER_DELETED: 'characterDeleted',\n    CHARACTER_DUPLICATED: 'character_duplicated',\n    STREAM_TOKEN_RECEIVED: 'stream_token_received',\n    FILE_ATTACHMENT_DELETED: 'file_attachment_deleted',\n    WORLDINFO_FORCE_ACTIVATE: 'worldinfo_force_activate',\n    OPEN_CHARACTER_LIBRARY: 'open_character_library',\n    ONLINE_STATUS_CHANGED: 'online_status_changed',\n    IMAGE_SWIPED: 'image_swiped',\n    CONNECTION_PROFILE_LOADED: 'connection_profile_loaded',\n    TOOL_CALLS_PERFORMED: 'tool_calls_performed',\n    TOOL_CALLS_RENDERED: 'tool_calls_rendered',\n};\n//------------------------------------------------------------------------------------------------------------------------\n// @ts-expect-error\nvar detail;\n(function (detail) {\n    detail.listener_event_wrapper_map = new Map();\n    function try_get_wrapper(listener, event_type) {\n        return detail.listener_event_wrapper_map.get(listener)?.get(event_type);\n    }\n    detail.try_get_wrapper = try_get_wrapper;\n    function remove_wrapper(listener, event_type) {\n        detail.listener_event_wrapper_map.get(listener)?.delete(event_type);\n    }\n    detail.remove_wrapper = remove_wrapper;\n    function get_or_make_wrapper(listener, event_type, once) {\n        const default_wrapper = async (...args) => {\n            if (once) {\n                remove_wrapper(listener, event_type);\n            }\n            const result = await listener(...args);\n            log.info(`[Event][callback '${event_type}'](${getIframeName()}) 函数因监听到 '${event_type}' 事件而触发\\n\\n  ${detail.format_function_to_string(listener)}`);\n            const uid = detail.waiting_event_map.get(`${event_type}#${listener.toString()}`)[0];\n            if (uid) {\n                window.postMessage({\n                    request: 'iframe_event_wait_callback',\n                    uid: uid,\n                    result: result,\n                }, '*');\n            }\n            return result;\n        };\n        const default_event_wrapper_map = new Map([[event_type, default_wrapper]]);\n        const event_wrapper = detail.get_or_set(detail.listener_event_wrapper_map, listener, () => default_event_wrapper_map);\n        const wrapper = detail.get_or_set(event_wrapper, event_type, () => default_wrapper);\n        return wrapper;\n    }\n    detail.get_or_make_wrapper = get_or_make_wrapper;\n    detail.waiting_event_map = new ArrayMultimap();\n    $(window).on('unload', eventClearAll);\n})(detail || (detail = {}));\n"},"./src/iframe_client/index.ts":
/*!************************************!*\
  !*** ./src/iframe_client/index.ts ***!
  \************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   iframe_client: () => (/* binding */ iframe_client)\n/* harmony export */ });\n/* harmony import */ var _iframe_client_exported_raw__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/iframe_client/_exported?raw */ "./src/iframe_client/_exported.ts?raw");\n/* harmony import */ var _iframe_client_impl_raw__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/iframe_client/_impl?raw */ "./src/iframe_client/_impl.ts?raw");\n/* harmony import */ var _iframe_client_multimap_raw__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/iframe_client/_multimap?raw */ "./src/iframe_client/_multimap.ts?raw");\n/* harmony import */ var _iframe_client_event_raw__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/iframe_client/event?raw */ "./src/iframe_client/event.ts?raw");\n/* harmony import */ var _iframe_client_util_raw__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/iframe_client/util?raw */ "./src/iframe_client/util.ts?raw");\n/* harmony import */ var _iframe_client_variables_raw__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/iframe_client/variables?raw */ "./src/iframe_client/variables.ts?raw");\n// TODO: 导入 index 时使用 raw, 而不是分别使用 raw\n\n\n\n\n\n\nconst iframe_client = [_iframe_client_exported_raw__WEBPACK_IMPORTED_MODULE_0__, _iframe_client_impl_raw__WEBPACK_IMPORTED_MODULE_1__, _iframe_client_multimap_raw__WEBPACK_IMPORTED_MODULE_2__, _iframe_client_event_raw__WEBPACK_IMPORTED_MODULE_3__, _iframe_client_variables_raw__WEBPACK_IMPORTED_MODULE_5__, _iframe_client_util_raw__WEBPACK_IMPORTED_MODULE_4__].join(\'\\n\');\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvaWZyYW1lX2NsaWVudC9pbmRleC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUEsc0NBQXNDO0FBQ2dCO0FBQ1I7QUFDUTtBQUNSO0FBQ0Y7QUFDVTtBQUUvQyxNQUFNLGFBQWEsR0FBRyxDQUFDLHdEQUFTLEVBQUUsb0RBQUssRUFBRSx3REFBUyxFQUFFLHFEQUFLLEVBQUUseURBQVMsRUFBRSxvREFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2lmcmFtZV9jbGllbnQvaW5kZXgudHM/Nzc2YSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUT0RPOiDlr7zlhaUgaW5kZXgg5pe25L2/55SoIHJhdywg6ICM5LiN5piv5YiG5Yir5L2/55SoIHJhd1xuaW1wb3J0IF9leHBvcnRlZCBmcm9tICdAL2lmcmFtZV9jbGllbnQvX2V4cG9ydGVkP3Jhdyc7XG5pbXBvcnQgX2ltcGwgZnJvbSAnQC9pZnJhbWVfY2xpZW50L19pbXBsP3Jhdyc7XG5pbXBvcnQgX211bHRpbWFwIGZyb20gJ0AvaWZyYW1lX2NsaWVudC9fbXVsdGltYXA/cmF3JztcbmltcG9ydCBldmVudCBmcm9tICdAL2lmcmFtZV9jbGllbnQvZXZlbnQ/cmF3JztcbmltcG9ydCB1dGlsIGZyb20gJ0AvaWZyYW1lX2NsaWVudC91dGlsP3Jhdyc7XG5pbXBvcnQgdmFyaWFibGVzIGZyb20gJ0AvaWZyYW1lX2NsaWVudC92YXJpYWJsZXM/cmF3JztcblxuZXhwb3J0IGNvbnN0IGlmcmFtZV9jbGllbnQgPSBbX2V4cG9ydGVkLCBfaW1wbCwgX211bHRpbWFwLCBldmVudCwgdmFyaWFibGVzLCB1dGlsXS5qb2luKCdcXG4nKTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/iframe_client/index.ts\n')},"./src/iframe_client/util.ts?raw":
/*!***************************************!*\
  !*** ./src/iframe_client/util.ts?raw ***!
  \***************************************/Q=>{Q.exports="\"use strict\";\nfunction getIframeName() {\n    return window.frameElement.id;\n}\nfunction getScriptId() {\n    return $(window.frameElement).attr('script-id') ?? 'unknown_script';\n}\nfunction getCurrentMessageId() {\n    return getMessageId(getIframeName());\n}\nfunction getMessageId(iframe_name) {\n    const match = iframe_name.match(/^message-iframe-(\\d+)-\\d+$/);\n    if (!match) {\n        throw Error(`获取 ${iframe_name} 所在楼层 id 时出错: 不要对全局脚本 iframe 调用 getMessageId!`);\n    }\n    return parseInt(match[1].toString());\n}\n"},"./src/iframe_client/variables.ts?raw":
/*!********************************************!*\
  !*** ./src/iframe_client/variables.ts?raw ***!
  \********************************************/Q=>{Q.exports="\"use strict\";\n//------------------------------------------------------------------------------------------------------------------------\n// 已被弃用的接口, 请尽量按照指示更新它们\n/** @deprecated 这个函数是在事件监听功能之前制作的, 现在请使用 `insertOrAssignVariables` 而用事件监听或条件判断来控制怎么更新 */\nasync function setVariables(message_id, new_or_updated_variables) {\n    let actual_message_id;\n    let actual_variables;\n    if (new_or_updated_variables) {\n        actual_message_id = message_id;\n        actual_variables = new_or_updated_variables;\n    }\n    else {\n        actual_message_id = getCurrentMessageId();\n        actual_variables = message_id;\n    }\n    if (typeof actual_message_id !== 'number' || typeof actual_variables !== 'object') {\n        return;\n    }\n    return detail.make_iframe_promise({\n        request: '[Variables][setVariables]',\n        message_id: actual_message_id,\n        variables: actual_variables,\n    });\n}\n"},"./src/iframe_server/_impl.ts":
/*!************************************!*\
  !*** ./src/iframe_server/_impl.ts ***!
  \************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getIframeName: () => (/* binding */ getIframeName),\n/* harmony export */   getLogPrefix: () => (/* binding */ getLogPrefix),\n/* harmony export */   iframe_handlers: () => (/* binding */ iframe_handlers),\n/* harmony export */   registerIframeHandler: () => (/* binding */ registerIframeHandler)\n/* harmony export */ });\nfunction getIframeName(event) {\n    const window = event.source;\n    return window.frameElement?.id;\n}\nfunction getLogPrefix(event) {\n    return `${event.data.request}(${getIframeName(event)}) `;\n}\nconst iframe_handlers = {};\nfunction registerIframeHandler(request, handler) {\n    iframe_handlers[request] = handler;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvaWZyYW1lX3NlcnZlci9faW1wbC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBS08sU0FBUyxhQUFhLENBQTBCLEtBQXNCO0lBQzNFLE1BQU0sTUFBTSxHQUFHLEtBQUssQ0FBQyxNQUFnQixDQUFDO0lBQ3RDLE9BQU8sTUFBTSxDQUFDLFlBQVksRUFBRSxFQUFZLENBQUM7QUFDM0MsQ0FBQztBQUVNLFNBQVMsWUFBWSxDQUEwQixLQUFzQjtJQUMxRSxPQUFPLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyxPQUFPLElBQUksYUFBYSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUM7QUFDM0QsQ0FBQztBQU1NLE1BQU0sZUFBZSxHQUFtQixFQUFFLENBQUM7QUFFM0MsU0FBUyxxQkFBcUIsQ0FDbkMsT0FBZSxFQUNmLE9BQXdEO0lBRXhELGVBQWUsQ0FBQyxPQUFPLENBQUMsR0FBRyxPQUFPLENBQUM7QUFDckMsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9pZnJhbWVfc2VydmVyL19pbXBsLnRzPzRkNWEiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGludGVyZmFjZSBJZnJhbWVNZXNzYWdlIHtcbiAgcmVxdWVzdDogc3RyaW5nO1xuICB1aWQ6IG51bWJlcjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldElmcmFtZU5hbWU8VCBleHRlbmRzIElmcmFtZU1lc3NhZ2U+KGV2ZW50OiBNZXNzYWdlRXZlbnQ8VD4pOiBzdHJpbmcge1xuICBjb25zdCB3aW5kb3cgPSBldmVudC5zb3VyY2UgYXMgV2luZG93O1xuICByZXR1cm4gd2luZG93LmZyYW1lRWxlbWVudD8uaWQgYXMgc3RyaW5nO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TG9nUHJlZml4PFQgZXh0ZW5kcyBJZnJhbWVNZXNzYWdlPihldmVudDogTWVzc2FnZUV2ZW50PFQ+KTogc3RyaW5nIHtcbiAgcmV0dXJuIGAke2V2ZW50LmRhdGEucmVxdWVzdH0oJHtnZXRJZnJhbWVOYW1lKGV2ZW50KX0pIGA7XG59XG5cbnR5cGUgSWZyYW1lSGFuZGxlcnMgPSB7XG4gIFtyZXF1ZXN0OiBzdHJpbmddOiAoZXZlbnQ6IE1lc3NhZ2VFdmVudDxhbnk+KSA9PiBQcm9taXNlPGFueSB8IHZvaWQ+O1xufTtcblxuZXhwb3J0IGNvbnN0IGlmcmFtZV9oYW5kbGVyczogSWZyYW1lSGFuZGxlcnMgPSB7fTtcblxuZXhwb3J0IGZ1bmN0aW9uIHJlZ2lzdGVySWZyYW1lSGFuZGxlcjxUIGV4dGVuZHMgSWZyYW1lTWVzc2FnZT4oXG4gIHJlcXVlc3Q6IHN0cmluZyxcbiAgaGFuZGxlcjogKGV2ZW50OiBNZXNzYWdlRXZlbnQ8VD4pID0+IFByb21pc2U8YW55IHwgdm9pZD4sXG4pIHtcbiAgaWZyYW1lX2hhbmRsZXJzW3JlcXVlc3RdID0gaGFuZGxlcjtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/iframe_server/_impl.ts\n")},"./src/iframe_server/index.ts":
/*!************************************!*\
  !*** ./src/iframe_server/index.ts ***!
  \************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   handleIframe: () => (/* binding */ handleIframe)\n/* harmony export */ });\n/* harmony import */ var _iframe_server_impl__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/iframe_server/_impl */ \"./src/iframe_server/_impl.ts\");\n/* harmony import */ var _iframe_server_variables__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/iframe_server/variables */ \"./src/iframe_server/variables.ts\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\nasync function handleIframe(event) {\n    if (!event.data)\n        return;\n    const handler = _iframe_server_impl__WEBPACK_IMPORTED_MODULE_0__.iframe_handlers[event.data.request];\n    if (!handler) {\n        return;\n    }\n    let result = undefined;\n    try {\n        result = await handler(event);\n    }\n    catch (err) {\n        const error = err;\n        toastr.error(`${(0,_iframe_server_impl__WEBPACK_IMPORTED_MODULE_0__.getLogPrefix)(event)}${error.name + ': ' + error.message}${error.stack ? error.stack : ''}`);\n        loglevel__WEBPACK_IMPORTED_MODULE_2___default().error((0,_iframe_server_impl__WEBPACK_IMPORTED_MODULE_0__.getLogPrefix)(event), error);\n    }\n    finally {\n        event.source.postMessage({\n            request: event.data.request + '_callback',\n            uid: event.data.uid,\n            result: result,\n        }, {\n            targetOrigin: '*',\n        });\n    }\n}\n(0,_iframe_server_variables__WEBPACK_IMPORTED_MODULE_1__.registerIframeVariableHandler)();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvaWZyYW1lX3NlcnZlci9pbmRleC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFxRjtBQUNYO0FBRS9DO0FBRXBCLEtBQUssVUFBVSxZQUFZLENBQUMsS0FBa0M7SUFDbkUsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJO1FBQUUsT0FBTztJQUV4QixNQUFNLE9BQU8sR0FBRyxnRUFBZSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDcEQsSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBQ2IsT0FBTztJQUNULENBQUM7SUFFRCxJQUFJLE1BQU0sR0FBUSxTQUFTLENBQUM7SUFDNUIsSUFBSSxDQUFDO1FBQ0gsTUFBTSxHQUFHLE1BQU0sT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ2hDLENBQUM7SUFBQyxPQUFPLEdBQUcsRUFBRSxDQUFDO1FBQ2IsTUFBTSxLQUFLLEdBQUcsR0FBWSxDQUFDO1FBQzNCLE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxpRUFBWSxDQUFDLEtBQUssQ0FBQyxHQUFHLEtBQUssQ0FBQyxJQUFJLEdBQUcsSUFBSSxHQUFHLEtBQUssQ0FBQyxPQUFPLEdBQUcsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztRQUM1RyxxREFBUyxDQUFDLGlFQUFZLENBQUMsS0FBSyxDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUM7SUFDeEMsQ0FBQztZQUFTLENBQUM7UUFDUixLQUFLLENBQUMsTUFBNkIsQ0FBQyxXQUFXLENBQzlDO1lBQ0UsT0FBTyxFQUFFLEtBQUssQ0FBQyxJQUFJLENBQUMsT0FBTyxHQUFHLFdBQVc7WUFDekMsR0FBRyxFQUFFLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRztZQUNuQixNQUFNLEVBQUUsTUFBTTtTQUNmLEVBQ0Q7WUFDRSxZQUFZLEVBQUUsR0FBRztTQUNsQixDQUNGLENBQUM7SUFDSixDQUFDO0FBQ0gsQ0FBQztBQUVELHVGQUE2QixFQUFFLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvaWZyYW1lX3NlcnZlci9pbmRleC50cz8xNzhmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IElmcmFtZU1lc3NhZ2UsIGdldExvZ1ByZWZpeCwgaWZyYW1lX2hhbmRsZXJzIH0gZnJvbSAnQC9pZnJhbWVfc2VydmVyL19pbXBsJztcbmltcG9ydCB7IHJlZ2lzdGVySWZyYW1lVmFyaWFibGVIYW5kbGVyIH0gZnJvbSAnQC9pZnJhbWVfc2VydmVyL3ZhcmlhYmxlcyc7XG5cbmltcG9ydCBsb2cgZnJvbSAnbG9nbGV2ZWwnO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlSWZyYW1lKGV2ZW50OiBNZXNzYWdlRXZlbnQ8SWZyYW1lTWVzc2FnZT4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgaWYgKCFldmVudC5kYXRhKSByZXR1cm47XG5cbiAgY29uc3QgaGFuZGxlciA9IGlmcmFtZV9oYW5kbGVyc1tldmVudC5kYXRhLnJlcXVlc3RdO1xuICBpZiAoIWhhbmRsZXIpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBsZXQgcmVzdWx0OiBhbnkgPSB1bmRlZmluZWQ7XG4gIHRyeSB7XG4gICAgcmVzdWx0ID0gYXdhaXQgaGFuZGxlcihldmVudCk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGNvbnN0IGVycm9yID0gZXJyIGFzIEVycm9yO1xuICAgIHRvYXN0ci5lcnJvcihgJHtnZXRMb2dQcmVmaXgoZXZlbnQpfSR7ZXJyb3IubmFtZSArICc6ICcgKyBlcnJvci5tZXNzYWdlfSR7ZXJyb3Iuc3RhY2sgPyBlcnJvci5zdGFjayA6ICcnfWApO1xuICAgIGxvZy5lcnJvcihnZXRMb2dQcmVmaXgoZXZlbnQpLCBlcnJvcik7XG4gIH0gZmluYWxseSB7XG4gICAgKGV2ZW50LnNvdXJjZSBhcyBNZXNzYWdlRXZlbnRTb3VyY2UpLnBvc3RNZXNzYWdlKFxuICAgICAge1xuICAgICAgICByZXF1ZXN0OiBldmVudC5kYXRhLnJlcXVlc3QgKyAnX2NhbGxiYWNrJyxcbiAgICAgICAgdWlkOiBldmVudC5kYXRhLnVpZCxcbiAgICAgICAgcmVzdWx0OiByZXN1bHQsXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICB0YXJnZXRPcmlnaW46ICcqJyxcbiAgICAgIH0sXG4gICAgKTtcbiAgfVxufVxuXG5yZWdpc3RlcklmcmFtZVZhcmlhYmxlSGFuZGxlcigpO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/iframe_server/index.ts\n")},"./src/iframe_server/variables.ts":
/*!****************************************!*\
  !*** ./src/iframe_server/variables.ts ***!
  \****************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   checkVariablesEvents: () => (/* binding */ checkVariablesEvents),\n/* harmony export */   clearTempVariables: () => (/* binding */ clearTempVariables),\n/* harmony export */   registerIframeVariableHandler: () => (/* binding */ registerIframeVariableHandler),\n/* harmony export */   shouldUpdateVariables: () => (/* binding */ shouldUpdateVariables)\n/* harmony export */ });\n/* harmony import */ var _iframe_server_impl__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/iframe_server/_impl */ \"./src/iframe_server/_impl.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_3__);\n\n\n\n\nlet latest_set_variables_message_id = null;\nfunction registerIframeVariableHandler() {\n    (0,_iframe_server_impl__WEBPACK_IMPORTED_MODULE_0__.registerIframeHandler)('[Variables][setVariables]', async (event) => {\n        const variables = event.data.variables;\n        const message_id = event.data.message_id;\n        if (isNaN(message_id)) {\n            return;\n        }\n        const chat_length = (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.getContext)().chat.length;\n        const latest_message_id = chat_length - 1;\n        if (message_id !== latest_message_id) {\n            loglevel__WEBPACK_IMPORTED_MODULE_3___default().info(`因为 ${message_id} 楼不是最新楼层 ${latest_message_id} 楼, 取消设置聊天变量. 原本要设置的变量:\\n${JSON.stringify(variables, undefined, 2)} `);\n            return;\n        }\n        latest_set_variables_message_id = message_id;\n        if (\n        // @ts-ignore\n        !_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables ||\n            // @ts-ignore\n            typeof _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables !== 'object') {\n            // @ts-ignore\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables = {};\n        }\n        if (\n        // @ts-ignore\n        !_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables.tempVariables ||\n            // @ts-ignore\n            typeof _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables.tempVariables !== 'object') {\n            // @ts-ignore\n            _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables.tempVariables = {};\n        }\n        if (_.has(variables, 'tempVariables')) {\n            // @ts-ignore\n            delete variables.tempVariables;\n        }\n        // @ts-ignore\n        const tempVariables = _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables.tempVariables;\n        // @ts-ignore\n        const currentVariables = _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables;\n        Object.keys(variables).forEach(key => {\n            // @ts-ignore\n            const newValue = variables[key];\n            const currentValue = currentVariables[key];\n            if (newValue !== currentValue) {\n                tempVariables[key] = newValue;\n            }\n        });\n        // @ts-ignore\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables.tempVariables = tempVariables;\n        (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.saveMetadataDebounced)();\n        loglevel__WEBPACK_IMPORTED_MODULE_3___default().info(`${(0,_iframe_server_impl__WEBPACK_IMPORTED_MODULE_0__.getLogPrefix)(event)}设置聊天变量, 要设置的变量:\\n${JSON.stringify(variables, undefined, 2)} `);\n    });\n}\nfunction clearTempVariables() {\n    if (\n    // @ts-ignore\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables &&\n        // @ts-ignore\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables.tempVariables &&\n        // @ts-ignore\n        Object.keys(_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables.tempVariables).length > 0) {\n        loglevel__WEBPACK_IMPORTED_MODULE_3___default().info('[Var]Clearing tempVariables.');\n        // @ts-ignore\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables.tempVariables = {};\n        (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.saveMetadataDebounced)();\n    }\n}\nfunction shouldUpdateVariables(eventMesId) {\n    if (\n    // @ts-ignore\n    !_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables ||\n        // @ts-ignore\n        !_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables.tempVariables ||\n        // @ts-ignore\n        Object.keys(_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables.tempVariables).length === 0) {\n        return;\n    }\n    if (eventMesId === latest_set_variables_message_id) {\n        loglevel__WEBPACK_IMPORTED_MODULE_3___default().info('[Var]MesId matches the latest setVariables, skipping ST variable update.');\n        return;\n    }\n    else if (latest_set_variables_message_id !== null && eventMesId > latest_set_variables_message_id) {\n        loglevel__WEBPACK_IMPORTED_MODULE_3___default().info('[Var]Event mesId is newer than setVariables mesId, updating ST variables.');\n        // @ts-ignore\n        const newVariables = { ..._sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables.tempVariables };\n        updateVariables(newVariables);\n        // @ts-ignore\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables.tempVariables = {};\n        loglevel__WEBPACK_IMPORTED_MODULE_3___default().info('[Var]TempVariables cleared.');\n    }\n    else {\n        loglevel__WEBPACK_IMPORTED_MODULE_3___default().info('[Var]Event mesId is older than setVariables mesId, ignoring.');\n    }\n}\nfunction updateVariables(newVariables) {\n    // @ts-ignore\n    if (!_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables) {\n        // @ts-ignore\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables = {};\n    }\n    // @ts-ignore\n    const currentVariables = _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables;\n    for (const key in newVariables) {\n        if (_.has(newVariables, key)) {\n            currentVariables[key] = newVariables[key];\n        }\n    }\n    // @ts-ignore\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.chat_metadata.variables = currentVariables;\n    (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_2__.saveMetadataDebounced)();\n}\nconst checkVariablesEvents = [_sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.event_types.CHARACTER_MESSAGE_RENDERED, _sillytavern_script__WEBPACK_IMPORTED_MODULE_1__.event_types.USER_MESSAGE_RENDERED];\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFDO1NBQU0sQ0FBQztRQUNOLG9EQUFRLENBQUMsOERBQThELENBQUMsQ0FBQztJQUMzRSxDQUFDO0FBQ0gsQ0FBQztBQUVELFNBQVMsZUFBZSxDQUFDLFlBQWlDO0lBQ3hELGFBQWE7SUFDYixJQUFJLENBQUMsOERBQWEsQ0FBQyxTQUFTLEVBQUUsQ0FBQztRQUM3QixhQUFhO1FBQ2IsOERBQWEsQ0FBQyxTQUFTLEdBQUcsRUFBRSxDQUFDO0lBQy9CLENBQUM7SUFFRCxhQUFhO0lBQ2IsTUFBTSxnQkFBZ0IsR0FBRyw4REFBYSxDQUFDLFNBQVMsQ0FBQztJQUVqRCxLQUFLLE1BQU0sR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBQy9CLElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBQyxZQUFZLEVBQUUsR0FBRyxDQUFDLEVBQUUsQ0FBQztZQUM3QixnQkFBZ0IsQ0FBQyxHQUFHLENBQUMsR0FBRyxZQUFZLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDNUMsQ0FBQztJQUNILENBQUM7SUFFRCxhQUFhO0lBQ2IsOERBQWEsQ0FBQyxTQUFTLEdBQUcsZ0JBQWdCLENBQUM7SUFFM0Msc0ZBQXFCLEVBQUUsQ0FBQztBQUMxQixDQUFDO0FBRU0sTUFBTSxvQkFBb0IsR0FBRyxDQUFDLDREQUFXLENBQUMsMEJBQTBCLEVBQUUsNERBQVcsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL2lmcmFtZV9zZXJ2ZXIvdmFyaWFibGVzLnRzPzM3MWUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ2V0TG9nUHJlZml4LCBJZnJhbWVNZXNzYWdlLCByZWdpc3RlcklmcmFtZUhhbmRsZXIgfSBmcm9tICdAL2lmcmFtZV9zZXJ2ZXIvX2ltcGwnO1xuXG5pbXBvcnQgeyBjaGF0X21ldGFkYXRhLCBldmVudF90eXBlcyB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHQnO1xuaW1wb3J0IHsgZ2V0Q29udGV4dCwgc2F2ZU1ldGFkYXRhRGVib3VuY2VkIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvZXh0ZW5zaW9ucyc7XG5cbmltcG9ydCBsb2cgZnJvbSAnbG9nbGV2ZWwnO1xuXG5pbnRlcmZhY2UgSWZyYW1lU2V0VmFyaWFibGVzIGV4dGVuZHMgSWZyYW1lTWVzc2FnZSB7XG4gIHJlcXVlc3Q6ICdbVmFyaWFibGVzXVtzZXRWYXJpYWJsZXNdJztcbiAgbWVzc2FnZV9pZDogbnVtYmVyO1xuICB2YXJpYWJsZXM6IFJlY29yZDxzdHJpbmcsIGFueT47XG59XG5cbmxldCBsYXRlc3Rfc2V0X3ZhcmlhYmxlc19tZXNzYWdlX2lkOiBudW1iZXIgfCBudWxsID0gbnVsbDtcblxuZXhwb3J0IGZ1bmN0aW9uIHJlZ2lzdGVySWZyYW1lVmFyaWFibGVIYW5kbGVyKCkge1xuICByZWdpc3RlcklmcmFtZUhhbmRsZXIoJ1tWYXJpYWJsZXNdW3NldFZhcmlhYmxlc10nLCBhc3luYyAoZXZlbnQ6IE1lc3NhZ2VFdmVudDxJZnJhbWVTZXRWYXJpYWJsZXM+KTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gICAgY29uc3QgdmFyaWFibGVzID0gZXZlbnQuZGF0YS52YXJpYWJsZXM7XG4gICAgY29uc3QgbWVzc2FnZV9pZCA9IGV2ZW50LmRhdGEubWVzc2FnZV9pZDtcblxuICAgIGlmIChpc05hTihtZXNzYWdlX2lkKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBjaGF0X2xlbmd0aCA9IGdldENvbnRleHQoKS5jaGF0Lmxlbmd0aDtcbiAgICBjb25zdCBsYXRlc3RfbWVzc2FnZV9pZCA9IGNoYXRfbGVuZ3RoIC0gMTtcblxuICAgIGlmIChtZXNzYWdlX2lkICE9PSBsYXRlc3RfbWVzc2FnZV9pZCkge1xuICAgICAgbG9nLmluZm8oXG4gICAgICAgIGDlm6DkuLogJHttZXNzYWdlX2lkfSDmpbzkuI3mmK/mnIDmlrDmpbzlsYIgJHtsYXRlc3RfbWVzc2FnZV9pZH0g5qW8LCDlj5bmtojorr7nva7ogYrlpKnlj5jph48uIOWOn+acrOimgeiuvue9rueahOWPmOmHjzpcXG4ke0pTT04uc3RyaW5naWZ5KFxuICAgICAgICAgIHZhcmlhYmxlcyxcbiAgICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgICAgMixcbiAgICAgICAgKX0gYCxcbiAgICAgICk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGxhdGVzdF9zZXRfdmFyaWFibGVzX21lc3NhZ2VfaWQgPSBtZXNzYWdlX2lkO1xuICAgIGlmIChcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICFjaGF0X21ldGFkYXRhLnZhcmlhYmxlcyB8fFxuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgdHlwZW9mIGNoYXRfbWV0YWRhdGEudmFyaWFibGVzICE9PSAnb2JqZWN0J1xuICAgICkge1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgY2hhdF9tZXRhZGF0YS52YXJpYWJsZXMgPSB7fTtcbiAgICB9XG4gICAgaWYgKFxuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgIWNoYXRfbWV0YWRhdGEudmFyaWFibGVzLnRlbXBWYXJpYWJsZXMgfHxcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgIHR5cGVvZiBjaGF0X21ldGFkYXRhLnZhcmlhYmxlcy50ZW1wVmFyaWFibGVzICE9PSAnb2JqZWN0J1xuICAgICkge1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgY2hhdF9tZXRhZGF0YS52YXJpYWJsZXMudGVtcFZhcmlhYmxlcyA9IHt9O1xuICAgIH1cbiAgICBpZiAoXy5oYXModmFyaWFibGVzLCAndGVtcFZhcmlhYmxlcycpKSB7XG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICBkZWxldGUgdmFyaWFibGVzLnRlbXBWYXJpYWJsZXM7XG4gICAgfVxuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBjb25zdCB0ZW1wVmFyaWFibGVzID0gY2hhdF9tZXRhZGF0YS52YXJpYWJsZXMudGVtcFZhcmlhYmxlcztcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgY29uc3QgY3VycmVudFZhcmlhYmxlcyA9IGNoYXRfbWV0YWRhdGEudmFyaWFibGVzO1xuICAgIE9iamVjdC5rZXlzKHZhcmlhYmxlcykuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgY29uc3QgbmV3VmFsdWUgPSB2YXJpYWJsZXNba2V5XTtcbiAgICAgIGNvbnN0IGN1cnJlbnRWYWx1ZSA9IGN1cnJlbnRWYXJpYWJsZXNba2V5XTtcbiAgICAgIGlmIChuZXdWYWx1ZSAhPT0gY3VycmVudFZhbHVlKSB7XG4gICAgICAgIHRlbXBWYXJpYWJsZXNba2V5XSA9IG5ld1ZhbHVlO1xuICAgICAgfVxuICAgIH0pO1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBjaGF0X21ldGFkYXRhLnZhcmlhYmxlcy50ZW1wVmFyaWFibGVzID0gdGVtcFZhcmlhYmxlcztcbiAgICBzYXZlTWV0YWRhdGFEZWJvdW5jZWQoKTtcblxuICAgIGxvZy5pbmZvKGAke2dldExvZ1ByZWZpeChldmVudCl96K6+572u6IGK5aSp5Y+Y6YePLCDopoHorr7nva7nmoTlj5jph486XFxuJHtKU09OLnN0cmluZ2lmeSh2YXJpYWJsZXMsIHVuZGVmaW5lZCwgMil9IGApO1xuICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyVGVtcFZhcmlhYmxlcygpIHtcbiAgaWYgKFxuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBjaGF0X21ldGFkYXRhLnZhcmlhYmxlcyAmJlxuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBjaGF0X21ldGFkYXRhLnZhcmlhYmxlcy50ZW1wVmFyaWFibGVzICYmXG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIE9iamVjdC5rZXlzKGNoYXRfbWV0YWRhdGEudmFyaWFibGVzLnRlbXBWYXJpYWJsZXMpLmxlbmd0aCA+IDBcbiAgKSB7XG4gICAgbG9nLmluZm8oJ1tWYXJdQ2xlYXJpbmcgdGVtcFZhcmlhYmxlcy4nKTtcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgY2hhdF9tZXRhZGF0YS52YXJpYWJsZXMudGVtcFZhcmlhYmxlcyA9IHt9O1xuICAgIHNhdmVNZXRhZGF0YURlYm91bmNlZCgpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzaG91bGRVcGRhdGVWYXJpYWJsZXMoZXZlbnRNZXNJZDogbnVtYmVyKSB7XG4gIGlmIChcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgIWNoYXRfbWV0YWRhdGEudmFyaWFibGVzIHx8XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgICFjaGF0X21ldGFkYXRhLnZhcmlhYmxlcy50ZW1wVmFyaWFibGVzIHx8XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIE9iamVjdC5rZXlzKGNoYXRfbWV0YWRhdGEudmFyaWFibGVzLnRlbXBWYXJpYWJsZXMpLmxlbmd0aCA9PT0gMFxuICApIHtcbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKGV2ZW50TWVzSWQgPT09IGxhdGVzdF9zZXRfdmFyaWFibGVzX21lc3NhZ2VfaWQpIHtcbiAgICBsb2cuaW5mbygnW1Zhcl1NZXNJZCBtYXRjaGVzIHRoZSBsYXRlc3Qgc2V0VmFyaWFibGVzLCBza2lwcGluZyBTVCB2YXJpYWJsZSB1cGRhdGUuJyk7XG4gICAgcmV0dXJuO1xuICB9IGVsc2UgaWYgKGxhdGVzdF9zZXRfdmFyaWFibGVzX21lc3NhZ2VfaWQgIT09IG51bGwgJiYgZXZlbnRNZXNJZCA+IGxhdGVzdF9zZXRfdmFyaWFibGVzX21lc3NhZ2VfaWQpIHtcbiAgICBsb2cuaW5mbygnW1Zhcl1FdmVudCBtZXNJZCBpcyBuZXdlciB0aGFuIHNldFZhcmlhYmxlcyBtZXNJZCwgdXBkYXRpbmcgU1QgdmFyaWFibGVzLicpO1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBjb25zdCBuZXdWYXJpYWJsZXMgPSB7IC4uLmNoYXRfbWV0YWRhdGEudmFyaWFibGVzLnRlbXBWYXJpYWJsZXMgfTtcbiAgICB1cGRhdGVWYXJpYWJsZXMobmV3VmFyaWFibGVzKTtcblxuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBjaGF0X21ldGFkYXRhLnZhcmlhYmxlcy50ZW1wVmFyaWFibGVzID0ge307XG4gICAgbG9nLmluZm8oJ1tWYXJdVGVtcFZhcmlhYmxlcyBjbGVhcmVkLicpO1xuICB9IGVsc2Uge1xuICAgIGxvZy5pbmZvKCdbVmFyXUV2ZW50IG1lc0lkIGlzIG9sZGVyIHRoYW4gc2V0VmFyaWFibGVzIG1lc0lkLCBpZ25vcmluZy4nKTtcbiAgfVxufVxuXG5mdW5jdGlvbiB1cGRhdGVWYXJpYWJsZXMobmV3VmFyaWFibGVzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+KSB7XG4gIC8vIEB0cy1pZ25vcmVcbiAgaWYgKCFjaGF0X21ldGFkYXRhLnZhcmlhYmxlcykge1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBjaGF0X21ldGFkYXRhLnZhcmlhYmxlcyA9IHt9O1xuICB9XG5cbiAgLy8gQHRzLWlnbm9yZVxuICBjb25zdCBjdXJyZW50VmFyaWFibGVzID0gY2hhdF9tZXRhZGF0YS52YXJpYWJsZXM7XG5cbiAgZm9yIChjb25zdCBrZXkgaW4gbmV3VmFyaWFibGVzKSB7XG4gICAgaWYgKF8uaGFzKG5ld1ZhcmlhYmxlcywga2V5KSkge1xuICAgICAgY3VycmVudFZhcmlhYmxlc1trZXldID0gbmV3VmFyaWFibGVzW2tleV07XG4gICAgfVxuICB9XG5cbiAgLy8gQHRzLWlnbm9yZVxuICBjaGF0X21ldGFkYXRhLnZhcmlhYmxlcyA9IGN1cnJlbnRWYXJpYWJsZXM7XG5cbiAgc2F2ZU1ldGFkYXRhRGVib3VuY2VkKCk7XG59XG5cbmV4cG9ydCBjb25zdCBjaGVja1ZhcmlhYmxlc0V2ZW50cyA9IFtldmVudF90eXBlcy5DSEFSQUNURVJfTUVTU0FHRV9SRU5ERVJFRCwgZXZlbnRfdHlwZXMuVVNFUl9NRVNTQUdFX1JFTkRFUkVEXTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/iframe_server/variables.ts\n")},"./src/index.ts":
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _component_audio__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/audio */ \"./src/component/audio/index.ts\");\n/* harmony import */ var _component_listener__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/component/listener */ \"./src/component/listener/index.ts\");\n/* harmony import */ var _component_macrolike__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/component/macrolike */ \"./src/component/macrolike.ts\");\n/* harmony import */ var _component_main__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/component/main */ \"./src/component/main.ts\");\n/* harmony import */ var _component_message_iframe__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/component/message_iframe */ \"./src/component/message_iframe/index.ts\");\n/* harmony import */ var _component_reference__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/component/reference */ \"./src/component/reference/index.ts\");\n/* harmony import */ var _component_script_repository_index__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/component/script_repository/index */ \"./src/component/script_repository/index.ts\");\n/* harmony import */ var _component_script_repository_types__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @/component/script_repository/types */ \"./src/component/script_repository/types.ts\");\n/* harmony import */ var _component_variable_manager__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @/component/variable_manager */ \"./src/component/variable_manager/index.ts\");\n/* harmony import */ var _function__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @/function */ \"./src/function/index.ts\");\n/* harmony import */ var _slash_command_audio__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @/slash_command/audio */ \"./src/slash_command/audio.ts\");\n/* harmony import */ var _slash_command_event__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @/slash_command/event */ \"./src/slash_command/event.ts\");\n/* harmony import */ var _util_check_update__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @/util/check_update */ \"./src/util/check_update.ts\");\n/* harmony import */ var _util_collapsible__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @/util/collapsible */ \"./src/util/collapsible.ts\");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_17___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_17__);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst defaultSettings = {\n    enabled_extension: true,\n    render: {\n        ..._component_message_iframe__WEBPACK_IMPORTED_MODULE_4__.defaultIframeSettings,\n    },\n    script: {\n        ..._component_script_repository_types__WEBPACK_IMPORTED_MODULE_7__.defaultScriptSettings,\n    },\n    audio: {\n        ..._component_audio__WEBPACK_IMPORTED_MODULE_0__.defaultAudioSettings,\n    },\n    debug: {\n        enabled: false,\n    },\n};\nconst templatePath = `${_util_extension_variables__WEBPACK_IMPORTED_MODULE_14__.extensionFolderPath}/src/component`;\n/**\n * 设置页面切换\n *  @param event 事件对象\n * */\nfunction handleSettingPageChange(event) {\n    const target = $(event.currentTarget);\n    let id = target.attr('id');\n    if (id === undefined) {\n        return;\n    }\n    id = id.replace('-settings-title', '');\n    function resetAllTitleClasses() {\n        $('#main-settings-title').removeClass('title-item-active');\n        $('#render-settings-title').removeClass('title-item-active');\n        $('#script-settings-title').removeClass('title-item-active');\n        $('#toolbox-settings-title').removeClass('title-item-active');\n    }\n    function hideAllContentPanels() {\n        $('#main-settings-content').hide();\n        $('#render-settings-content').hide();\n        $('#script-settings-content').hide();\n        $('#toolbox-settings-content').hide();\n    }\n    resetAllTitleClasses();\n    hideAllContentPanels();\n    switch (id) {\n        case 'main':\n            $('#main-settings-title').addClass('title-item-active');\n            $('#main-settings-content').show();\n            break;\n        case 'render':\n            $('#render-settings-title').addClass('title-item-active');\n            $('#render-settings-content').show();\n            break;\n        case 'script':\n            $('#script-settings-title').addClass('title-item-active');\n            $('#script-settings-content').show();\n            break;\n        case 'toolbox':\n            $('#toolbox-settings-title').addClass('title-item-active');\n            $('#toolbox-settings-content').show();\n            break;\n    }\n}\n/**界面统一加载 */\nasync function initExtensionPanel() {\n    const getContainer = () => $('#extensions_settings');\n    const windowHtml = await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_16__.renderExtensionTemplateAsync)(`${_util_extension_variables__WEBPACK_IMPORTED_MODULE_14__.extensionFolderPath}`, 'index');\n    getContainer().append(windowHtml);\n    const $script_container = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_16__.renderExtensionTemplateAsync)(`${templatePath}/script_repository/public`, 'index'));\n    $('#script-settings-content').append($script_container);\n    const $iframe_container = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_16__.renderExtensionTemplateAsync)(`${templatePath}/message_iframe`, 'index'));\n    $('#render-settings-content').append($iframe_container);\n    const $audio_container = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_16__.renderExtensionTemplateAsync)(`${templatePath}/audio`, 'index'));\n    $('#toolbox-settings-content').append($audio_container);\n    const $reference_container = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_16__.renderExtensionTemplateAsync)(`${templatePath}/reference`, 'index'));\n    $('#extension-reference').append($reference_container);\n    const $variables_container = $(await (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_16__.renderExtensionTemplateAsync)(`${templatePath}/variable_manager/public`, 'variable_manager_entry'));\n    $('#toolbox-settings-content').prepend($variables_container);\n}\n/**\n * 版本控制\n */\nasync function handleVersionUpdate() {\n    const currentVersion = await (0,_util_check_update__WEBPACK_IMPORTED_MODULE_12__.getCurrentVersion)(_util_check_update__WEBPACK_IMPORTED_MODULE_12__.VERSION_FILE_PATH);\n    $('.version').text(`Ver ${currentVersion}`);\n    const isNeedUpdate = await (0,_util_check_update__WEBPACK_IMPORTED_MODULE_12__.runCheckWithPath)();\n    if (isNeedUpdate) {\n        (0,_util_check_update__WEBPACK_IMPORTED_MODULE_12__.addVersionUpdateElement)();\n    }\n    $('#update-extension').on('click', async () => await (0,_util_check_update__WEBPACK_IMPORTED_MODULE_12__.handleUpdateButton)());\n}\nfunction initLogObject() {\n    globalThis.log = (loglevel__WEBPACK_IMPORTED_MODULE_17___default());\n}\nasync function initDebugMode() {\n    const debugEnabled = await (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_14__.getOrSaveSettingValue)('debug.enabled', defaultSettings.debug.enabled);\n    $('#debug-mode-toggle')\n        .prop('checked', debugEnabled)\n        .on('click', (event) => {\n        const isDebugMode = event.target.checked;\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_14__.saveSettingValue)('debug.enabled', isDebugMode);\n        if (isDebugMode) {\n            log.enableAll();\n        }\n        else {\n            log.setLevel('warn');\n        }\n    });\n}\n/**\n * 初始化扩展面板\n */\njQuery(async () => {\n    await initExtensionPanel();\n    //@ts-ignore\n    if (!_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_16__.extension_settings[_util_extension_variables__WEBPACK_IMPORTED_MODULE_14__.extensionSettingName]) {\n        _.set(_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_16__.extension_settings, _util_extension_variables__WEBPACK_IMPORTED_MODULE_14__.extensionSettingName, defaultSettings);\n        // 删除旧版配置\n        _.unset(_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_16__.extension_settings, _util_extension_variables__WEBPACK_IMPORTED_MODULE_14__.extensionName);\n        (0,_util_check_update__WEBPACK_IMPORTED_MODULE_12__.showNewFeature)();\n        await (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_15__.saveSettings)();\n    }\n    (0,_function__WEBPACK_IMPORTED_MODULE_9__.initTavernHelperObject)();\n    initLogObject();\n    await initDebugMode();\n    // 默认显示主设置界面\n    $('#main-settings-title').addClass('title-item-active');\n    $('#main-settings-content').show();\n    $('#render-settings-content').hide();\n    $('#script-settings-content').hide();\n    $('#toolbox-settings-content').hide();\n    // 监听设置选项卡切换\n    $('#main-settings-title').on('click', (event) => handleSettingPageChange(event));\n    $('#render-settings-title').on('click', (event) => handleSettingPageChange(event));\n    $('#script-settings-title').on('click', (event) => handleSettingPageChange(event));\n    $('#toolbox-settings-title').on('click', (event) => handleSettingPageChange(event));\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_15__.eventSource.once(_sillytavern_script__WEBPACK_IMPORTED_MODULE_15__.event_types.APP_READY, async () => {\n        (0,_component_main__WEBPACK_IMPORTED_MODULE_3__.initExtensionMainPanel)();\n        await handleVersionUpdate();\n        await (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.initAudioComponents)();\n        (0,_slash_command_audio__WEBPACK_IMPORTED_MODULE_10__.initAudioSlashCommands)();\n        (0,_slash_command_event__WEBPACK_IMPORTED_MODULE_11__.initSlashEventEmit)();\n        await (0,_component_script_repository_index__WEBPACK_IMPORTED_MODULE_6__.buildScriptRepository)();\n        await (0,_component_message_iframe__WEBPACK_IMPORTED_MODULE_4__.initIframePanel)();\n        (0,_component_macrolike__WEBPACK_IMPORTED_MODULE_2__.renderAllMacros)();\n        await (0,_component_reference__WEBPACK_IMPORTED_MODULE_5__.initReference)();\n        await (0,_component_listener__WEBPACK_IMPORTED_MODULE_1__.initListener)();\n        (0,_component_variable_manager__WEBPACK_IMPORTED_MODULE_8__.initVariableManager)();\n    });\n    // 通用Collapsible折叠功能\n    _util_collapsible__WEBPACK_IMPORTED_MODULE_13__.Collapsible.initAll('.collapsible', {\n        headerSelector: 'div:first-child',\n        contentSelector: '.collapsible-content',\n        initiallyExpanded: false,\n        animationDuration: {\n            expand: 280,\n            collapse: 250,\n        },\n    });\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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YXNoLVJ1bm5lci8uL3NyYy9pbmRleC50cz9mZmI0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGRlZmF1bHRBdWRpb1NldHRpbmdzLCBpbml0QXVkaW9Db21wb25lbnRzIH0gZnJvbSAnQC9jb21wb25lbnQvYXVkaW8nO1xuaW1wb3J0IHsgaW5pdExpc3RlbmVyIH0gZnJvbSAnQC9jb21wb25lbnQvbGlzdGVuZXInO1xuaW1wb3J0IHsgcmVuZGVyQWxsTWFjcm9zIH0gZnJvbSAnQC9jb21wb25lbnQvbWFjcm9saWtlJztcbmltcG9ydCB7IGluaXRFeHRlbnNpb25NYWluUGFuZWwgfSBmcm9tICdAL2NvbXBvbmVudC9tYWluJztcbmltcG9ydCB7IGRlZmF1bHRJZnJhbWVTZXR0aW5ncywgaW5pdElmcmFtZVBhbmVsIH0gZnJvbSAnQC9jb21wb25lbnQvbWVzc2FnZV9pZnJhbWUnO1xuaW1wb3J0IHsgaW5pdFJlZmVyZW5jZSB9IGZyb20gJ0AvY29tcG9uZW50L3JlZmVyZW5jZSc7XG5pbXBvcnQgeyBidWlsZFNjcmlwdFJlcG9zaXRvcnkgfSBmcm9tICdAL2NvbXBvbmVudC9zY3JpcHRfcmVwb3NpdG9yeS9pbmRleCc7XG5pbXBvcnQgeyBkZWZhdWx0U2NyaXB0U2V0dGluZ3MgfSBmcm9tICdAL2NvbXBvbmVudC9zY3JpcHRfcmVwb3NpdG9yeS90eXBlcyc7XG5pbXBvcnQgeyBpbml0VmFyaWFibGVNYW5hZ2VyIH0gZnJvbSAnQC9jb21wb25lbnQvdmFyaWFibGVfbWFuYWdlcic7XG5pbXBvcnQgeyBpbml0VGF2ZXJuSGVscGVyT2JqZWN0IH0gZnJvbSAnQC9mdW5jdGlvbic7XG5pbXBvcnQgeyBpbml0QXVkaW9TbGFzaENvbW1hbmRzIH0gZnJvbSAnQC9zbGFzaF9jb21tYW5kL2F1ZGlvJztcbmltcG9ydCB7IGluaXRTbGFzaEV2ZW50RW1pdCB9IGZyb20gJ0Avc2xhc2hfY29tbWFuZC9ldmVudCc7XG5pbXBvcnQge1xuICBhZGRWZXJzaW9uVXBkYXRlRWxlbWVudCxcbiAgZ2V0Q3VycmVudFZlcnNpb24sXG4gIGhhbmRsZVVwZGF0ZUJ1dHRvbixcbiAgcnVuQ2hlY2tXaXRoUGF0aCxcbiAgc2hvd05ld0ZlYXR1cmUsXG4gIFZFUlNJT05fRklMRV9QQVRILFxufSBmcm9tICdAL3V0aWwvY2hlY2tfdXBkYXRlJztcbmltcG9ydCB7IENvbGxhcHNpYmxlIH0gZnJvbSAnQC91dGlsL2NvbGxhcHNpYmxlJztcbmltcG9ydCB7XG4gIGV4dGVuc2lvbkZvbGRlclBhdGgsXG4gIGV4dGVuc2lvbk5hbWUsXG4gIGV4dGVuc2lvblNldHRpbmdOYW1lLFxuICBnZXRPclNhdmVTZXR0aW5nVmFsdWUsXG4gIHNhdmVTZXR0aW5nVmFsdWUsXG59IGZyb20gJ0AvdXRpbC9leHRlbnNpb25fdmFyaWFibGVzJztcblxuaW1wb3J0IHsgZXZlbnRfdHlwZXMsIGV2ZW50U291cmNlLCBzYXZlU2V0dGluZ3MgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0JztcbmltcG9ydCB7IGV4dGVuc2lvbl9zZXR0aW5ncywgcmVuZGVyRXh0ZW5zaW9uVGVtcGxhdGVBc3luYyB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL2V4dGVuc2lvbnMnO1xuXG5pbXBvcnQgbG9nX29iamVjdCBmcm9tICdsb2dsZXZlbCc7XG5cbmNvbnN0IGRlZmF1bHRTZXR0aW5ncyA9IHtcbiAgZW5hYmxlZF9leHRlbnNpb246IHRydWUsXG4gIHJlbmRlcjoge1xuICAgIC4uLmRlZmF1bHRJZnJhbWVTZXR0aW5ncyxcbiAgfSxcbiAgc2NyaXB0OiB7XG4gICAgLi4uZGVmYXVsdFNjcmlwdFNldHRpbmdzLFxuICB9LFxuICBhdWRpbzoge1xuICAgIC4uLmRlZmF1bHRBdWRpb1NldHRpbmdzLFxuICB9LFxuICBkZWJ1Zzoge1xuICAgIGVuYWJsZWQ6IGZhbHNlLFxuICB9LFxufTtcblxuY29uc3QgdGVtcGxhdGVQYXRoID0gYCR7ZXh0ZW5zaW9uRm9sZGVyUGF0aH0vc3JjL2NvbXBvbmVudGA7XG5cbi8qKlxuICog6K6+572u6aG16Z2i5YiH5o2iXG4gKiAgQHBhcmFtIGV2ZW50IOS6i+S7tuWvueixoVxuICogKi9cbmZ1bmN0aW9uIGhhbmRsZVNldHRpbmdQYWdlQ2hhbmdlKGV2ZW50OiBKUXVlcnkuQ2xpY2tFdmVudCkge1xuICBjb25zdCB0YXJnZXQgPSAkKGV2ZW50LmN1cnJlbnRUYXJnZXQpO1xuICBsZXQgaWQgPSB0YXJnZXQuYXR0cignaWQnKTtcbiAgaWYgKGlkID09PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgaWQgPSBpZC5yZXBsYWNlKCctc2V0dGluZ3MtdGl0bGUnLCAnJyk7XG5cbiAgZnVuY3Rpb24gcmVzZXRBbGxUaXRsZUNsYXNzZXMoKSB7XG4gICAgJCgnI21haW4tc2V0dGluZ3MtdGl0bGUnKS5yZW1vdmVDbGFzcygndGl0bGUtaXRlbS1hY3RpdmUnKTtcbiAgICAkKCcjcmVuZGVyLXNldHRpbmdzLXRpdGxlJykucmVtb3ZlQ2xhc3MoJ3RpdGxlLWl0ZW0tYWN0aXZlJyk7XG4gICAgJCgnI3NjcmlwdC1zZXR0aW5ncy10aXRsZScpLnJlbW92ZUNsYXNzKCd0aXRsZS1pdGVtLWFjdGl2ZScpO1xuICAgICQoJyN0b29sYm94LXNldHRpbmdzLXRpdGxlJykucmVtb3ZlQ2xhc3MoJ3RpdGxlLWl0ZW0tYWN0aXZlJyk7XG4gIH1cblxuICBmdW5jdGlvbiBoaWRlQWxsQ29udGVudFBhbmVscygpIHtcbiAgICAkKCcjbWFpbi1zZXR0aW5ncy1jb250ZW50JykuaGlkZSgpO1xuICAgICQoJyNyZW5kZXItc2V0dGluZ3MtY29udGVudCcpLmhpZGUoKTtcbiAgICAkKCcjc2NyaXB0LXNldHRpbmdzLWNvbnRlbnQnKS5oaWRlKCk7XG4gICAgJCgnI3Rvb2xib3gtc2V0dGluZ3MtY29udGVudCcpLmhpZGUoKTtcbiAgfVxuXG4gIHJlc2V0QWxsVGl0bGVDbGFzc2VzKCk7XG4gIGhpZGVBbGxDb250ZW50UGFuZWxzKCk7XG5cbiAgc3dpdGNoIChpZCkge1xuICAgIGNhc2UgJ21haW4nOlxuICAgICAgJCgnI21haW4tc2V0dGluZ3MtdGl0bGUnKS5hZGRDbGFzcygndGl0bGUtaXRlbS1hY3RpdmUnKTtcbiAgICAgICQoJyNtYWluLXNldHRpbmdzLWNvbnRlbnQnKS5zaG93KCk7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdyZW5kZXInOlxuICAgICAgJCgnI3JlbmRlci1zZXR0aW5ncy10aXRsZScpLmFkZENsYXNzKCd0aXRsZS1pdGVtLWFjdGl2ZScpO1xuICAgICAgJCgnI3JlbmRlci1zZXR0aW5ncy1jb250ZW50Jykuc2hvdygpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAnc2NyaXB0JzpcbiAgICAgICQoJyNzY3JpcHQtc2V0dGluZ3MtdGl0bGUnKS5hZGRDbGFzcygndGl0bGUtaXRlbS1hY3RpdmUnKTtcbiAgICAgICQoJyNzY3JpcHQtc2V0dGluZ3MtY29udGVudCcpLnNob3coKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ3Rvb2xib3gnOlxuICAgICAgJCgnI3Rvb2xib3gtc2V0dGluZ3MtdGl0bGUnKS5hZGRDbGFzcygndGl0bGUtaXRlbS1hY3RpdmUnKTtcbiAgICAgICQoJyN0b29sYm94LXNldHRpbmdzLWNvbnRlbnQnKS5zaG93KCk7XG4gICAgICBicmVhaztcbiAgfVxufVxuXG4vKirnlYzpnaLnu5/kuIDliqDovb0gKi9cbmFzeW5jIGZ1bmN0aW9uIGluaXRFeHRlbnNpb25QYW5lbCgpIHtcbiAgY29uc3QgZ2V0Q29udGFpbmVyID0gKCkgPT4gJCgnI2V4dGVuc2lvbnNfc2V0dGluZ3MnKTtcbiAgY29uc3Qgd2luZG93SHRtbCA9IGF3YWl0IHJlbmRlckV4dGVuc2lvblRlbXBsYXRlQXN5bmMoYCR7ZXh0ZW5zaW9uRm9sZGVyUGF0aH1gLCAnaW5kZXgnKTtcbiAgZ2V0Q29udGFpbmVyKCkuYXBwZW5kKHdpbmRvd0h0bWwpO1xuICBjb25zdCAkc2NyaXB0X2NvbnRhaW5lciA9ICQoYXdhaXQgcmVuZGVyRXh0ZW5zaW9uVGVtcGxhdGVBc3luYyhgJHt0ZW1wbGF0ZVBhdGh9L3NjcmlwdF9yZXBvc2l0b3J5L3B1YmxpY2AsICdpbmRleCcpKTtcbiAgJCgnI3NjcmlwdC1zZXR0aW5ncy1jb250ZW50JykuYXBwZW5kKCRzY3JpcHRfY29udGFpbmVyKTtcbiAgY29uc3QgJGlmcmFtZV9jb250YWluZXIgPSAkKGF3YWl0IHJlbmRlckV4dGVuc2lvblRlbXBsYXRlQXN5bmMoYCR7dGVtcGxhdGVQYXRofS9tZXNzYWdlX2lmcmFtZWAsICdpbmRleCcpKTtcbiAgJCgnI3JlbmRlci1zZXR0aW5ncy1jb250ZW50JykuYXBwZW5kKCRpZnJhbWVfY29udGFpbmVyKTtcbiAgY29uc3QgJGF1ZGlvX2NvbnRhaW5lciA9ICQoYXdhaXQgcmVuZGVyRXh0ZW5zaW9uVGVtcGxhdGVBc3luYyhgJHt0ZW1wbGF0ZVBhdGh9L2F1ZGlvYCwgJ2luZGV4JykpO1xuICAkKCcjdG9vbGJveC1zZXR0aW5ncy1jb250ZW50JykuYXBwZW5kKCRhdWRpb19jb250YWluZXIpO1xuICBjb25zdCAkcmVmZXJlbmNlX2NvbnRhaW5lciA9ICQoYXdhaXQgcmVuZGVyRXh0ZW5zaW9uVGVtcGxhdGVBc3luYyhgJHt0ZW1wbGF0ZVBhdGh9L3JlZmVyZW5jZWAsICdpbmRleCcpKTtcbiAgJCgnI2V4dGVuc2lvbi1yZWZlcmVuY2UnKS5hcHBlbmQoJHJlZmVyZW5jZV9jb250YWluZXIpO1xuICBjb25zdCAkdmFyaWFibGVzX2NvbnRhaW5lciA9ICQoXG4gICAgYXdhaXQgcmVuZGVyRXh0ZW5zaW9uVGVtcGxhdGVBc3luYyhgJHt0ZW1wbGF0ZVBhdGh9L3ZhcmlhYmxlX21hbmFnZXIvcHVibGljYCwgJ3ZhcmlhYmxlX21hbmFnZXJfZW50cnknKSxcbiAgKTtcbiAgJCgnI3Rvb2xib3gtc2V0dGluZ3MtY29udGVudCcpLnByZXBlbmQoJHZhcmlhYmxlc19jb250YWluZXIpO1xufVxuXG4vKipcbiAqIOeJiOacrOaOp+WItlxuICovXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVWZXJzaW9uVXBkYXRlKCkge1xuICBjb25zdCBjdXJyZW50VmVyc2lvbiA9IGF3YWl0IGdldEN1cnJlbnRWZXJzaW9uKFZFUlNJT05fRklMRV9QQVRIKTtcbiAgJCgnLnZlcnNpb24nKS50ZXh0KGBWZXIgJHtjdXJyZW50VmVyc2lvbn1gKTtcbiAgY29uc3QgaXNOZWVkVXBkYXRlID0gYXdhaXQgcnVuQ2hlY2tXaXRoUGF0aCgpO1xuICBpZiAoaXNOZWVkVXBkYXRlKSB7XG4gICAgYWRkVmVyc2lvblVwZGF0ZUVsZW1lbnQoKTtcbiAgfVxuICAkKCcjdXBkYXRlLWV4dGVuc2lvbicpLm9uKCdjbGljaycsIGFzeW5jICgpID0+IGF3YWl0IGhhbmRsZVVwZGF0ZUJ1dHRvbigpKTtcbn1cblxuZGVjbGFyZSBuYW1lc3BhY2UgZ2xvYmFsVGhpcyB7XG4gIGxldCBsb2c6IHR5cGVvZiBsb2dfb2JqZWN0O1xufVxuXG5mdW5jdGlvbiBpbml0TG9nT2JqZWN0KCkge1xuICBnbG9iYWxUaGlzLmxvZyA9IGxvZ19vYmplY3Q7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGluaXREZWJ1Z01vZGUoKSB7XG4gIGNvbnN0IGRlYnVnRW5hYmxlZCA9IGF3YWl0IGdldE9yU2F2ZVNldHRpbmdWYWx1ZSgnZGVidWcuZW5hYmxlZCcsIGRlZmF1bHRTZXR0aW5ncy5kZWJ1Zy5lbmFibGVkKTtcbiAgJCgnI2RlYnVnLW1vZGUtdG9nZ2xlJylcbiAgICAucHJvcCgnY2hlY2tlZCcsIGRlYnVnRW5hYmxlZClcbiAgICAub24oJ2NsaWNrJywgKGV2ZW50OiBKUXVlcnkuQ2xpY2tFdmVudCkgPT4ge1xuICAgICAgY29uc3QgaXNEZWJ1Z01vZGUgPSBldmVudC50YXJnZXQuY2hlY2tlZDtcbiAgICAgIHNhdmVTZXR0aW5nVmFsdWUoJ2RlYnVnLmVuYWJsZWQnLCBpc0RlYnVnTW9kZSk7XG4gICAgICBpZiAoaXNEZWJ1Z01vZGUpIHtcbiAgICAgICAgbG9nLmVuYWJsZUFsbCgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbG9nLnNldExldmVsKCd3YXJuJyk7XG4gICAgICB9XG4gICAgfSk7XG59XG5cbi8qKlxuICog5Yid5aeL5YyW5omp5bGV6Z2i5p2/XG4gKi9cbmpRdWVyeShhc3luYyAoKSA9PiB7XG4gIGF3YWl0IGluaXRFeHRlbnNpb25QYW5lbCgpO1xuICAvL0B0cy1pZ25vcmVcbiAgaWYgKCFleHRlbnNpb25fc2V0dGluZ3NbZXh0ZW5zaW9uU2V0dGluZ05hbWVdKSB7XG4gICAgXy5zZXQoZXh0ZW5zaW9uX3NldHRpbmdzLCBleHRlbnNpb25TZXR0aW5nTmFtZSwgZGVmYXVsdFNldHRpbmdzKTtcbiAgICAvLyDliKDpmaTml6fniYjphY3nva5cbiAgICBfLnVuc2V0KGV4dGVuc2lvbl9zZXR0aW5ncywgZXh0ZW5zaW9uTmFtZSk7XG4gICAgc2hvd05ld0ZlYXR1cmUoKTtcbiAgICBhd2FpdCBzYXZlU2V0dGluZ3MoKTtcbiAgfVxuXG4gIGluaXRUYXZlcm5IZWxwZXJPYmplY3QoKTtcbiAgaW5pdExvZ09iamVjdCgpO1xuICBhd2FpdCBpbml0RGVidWdNb2RlKCk7XG4gIC8vIOm7mOiupOaYvuekuuS4u+iuvue9rueVjOmdolxuICAkKCcjbWFpbi1zZXR0aW5ncy10aXRsZScpLmFkZENsYXNzKCd0aXRsZS1pdGVtLWFjdGl2ZScpO1xuICAkKCcjbWFpbi1zZXR0aW5ncy1jb250ZW50Jykuc2hvdygpO1xuICAkKCcjcmVuZGVyLXNldHRpbmdzLWNvbnRlbnQnKS5oaWRlKCk7XG4gICQoJyNzY3JpcHQtc2V0dGluZ3MtY29udGVudCcpLmhpZGUoKTtcbiAgJCgnI3Rvb2xib3gtc2V0dGluZ3MtY29udGVudCcpLmhpZGUoKTtcblxuICAvLyDnm5HlkKzorr7nva7pgInpobnljaHliIfmjaJcbiAgJCgnI21haW4tc2V0dGluZ3MtdGl0bGUnKS5vbignY2xpY2snLCAoZXZlbnQ6IEpRdWVyeS5DbGlja0V2ZW50KSA9PiBoYW5kbGVTZXR0aW5nUGFnZUNoYW5nZShldmVudCkpO1xuICAkKCcjcmVuZGVyLXNldHRpbmdzLXRpdGxlJykub24oJ2NsaWNrJywgKGV2ZW50OiBKUXVlcnkuQ2xpY2tFdmVudCkgPT4gaGFuZGxlU2V0dGluZ1BhZ2VDaGFuZ2UoZXZlbnQpKTtcbiAgJCgnI3NjcmlwdC1zZXR0aW5ncy10aXRsZScpLm9uKCdjbGljaycsIChldmVudDogSlF1ZXJ5LkNsaWNrRXZlbnQpID0+IGhhbmRsZVNldHRpbmdQYWdlQ2hhbmdlKGV2ZW50KSk7XG4gICQoJyN0b29sYm94LXNldHRpbmdzLXRpdGxlJykub24oJ2NsaWNrJywgKGV2ZW50OiBKUXVlcnkuQ2xpY2tFdmVudCkgPT4gaGFuZGxlU2V0dGluZ1BhZ2VDaGFuZ2UoZXZlbnQpKTtcblxuICBldmVudFNvdXJjZS5vbmNlKGV2ZW50X3R5cGVzLkFQUF9SRUFEWSwgYXN5bmMgKCkgPT4ge1xuICAgIGluaXRFeHRlbnNpb25NYWluUGFuZWwoKTtcbiAgICBhd2FpdCBoYW5kbGVWZXJzaW9uVXBkYXRlKCk7XG4gICAgYXdhaXQgaW5pdEF1ZGlvQ29tcG9uZW50cygpO1xuICAgIGluaXRBdWRpb1NsYXNoQ29tbWFuZHMoKTtcbiAgICBpbml0U2xhc2hFdmVudEVtaXQoKTtcbiAgICBhd2FpdCBidWlsZFNjcmlwdFJlcG9zaXRvcnkoKTtcbiAgICBhd2FpdCBpbml0SWZyYW1lUGFuZWwoKTtcbiAgICByZW5kZXJBbGxNYWNyb3MoKTtcbiAgICBhd2FpdCBpbml0UmVmZXJlbmNlKCk7XG4gICAgYXdhaXQgaW5pdExpc3RlbmVyKCk7XG4gICAgaW5pdFZhcmlhYmxlTWFuYWdlcigpO1xuICB9KTtcblxuICAvLyDpgJrnlKhDb2xsYXBzaWJsZeaKmOWPoOWKn+iDvVxuICBDb2xsYXBzaWJsZS5pbml0QWxsKCcuY29sbGFwc2libGUnLCB7XG4gICAgaGVhZGVyU2VsZWN0b3I6ICdkaXY6Zmlyc3QtY2hpbGQnLFxuICAgIGNvbnRlbnRTZWxlY3RvcjogJy5jb2xsYXBzaWJsZS1jb250ZW50JyxcbiAgICBpbml0aWFsbHlFeHBhbmRlZDogZmFsc2UsXG4gICAgYW5pbWF0aW9uRHVyYXRpb246IHtcbiAgICAgIGV4cGFuZDogMjgwLFxuICAgICAgY29sbGFwc2U6IDI1MCxcbiAgICB9LFxuICB9KTtcbn0pO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/index.ts\n")},"./src/script_url.ts":
/*!***************************!*\
  !*** ./src/script_url.ts ***!
  \***************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   script_url: () => (/* binding */ script_url)\n/* harmony export */ });\n/* harmony import */ var _util_map_util__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/util/map_util */ \"./src/util/map_util.ts\");\n\nfunction createObjectURLFromScript(code) {\n    return URL.createObjectURL(new Blob([code], { type: 'application/javascript' }));\n}\nclass ScriptUrl {\n    map = new Map();\n    get(name) {\n        return this.map.get(name);\n    }\n    set(name, code) {\n        this.map.set(name, createObjectURLFromScript(code));\n    }\n    delete(name) {\n        const url = (0,_util_map_util__WEBPACK_IMPORTED_MODULE_0__.extract)(this.map, name);\n        if (!url) {\n            return url;\n        }\n        URL.revokeObjectURL(url);\n        return url;\n    }\n}\nconst script_url = new ScriptUrl();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvc2NyaXB0X3VybC50cyIsIm1hcHBpbmdzIjoiOzs7OztBQUEwQztBQUUxQyxTQUFTLHlCQUF5QixDQUFDLElBQVk7SUFDN0MsT0FBTyxHQUFHLENBQUMsZUFBZSxDQUFDLElBQUksSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsRUFBRSxJQUFJLEVBQUUsd0JBQXdCLEVBQUUsQ0FBQyxDQUFDLENBQUM7QUFDbkYsQ0FBQztBQUVELE1BQU0sU0FBUztJQUNMLEdBQUcsR0FBd0IsSUFBSSxHQUFHLEVBQUUsQ0FBQztJQUV0QyxHQUFHLENBQUMsSUFBWTtRQUNyQixPQUFPLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzVCLENBQUM7SUFDTSxHQUFHLENBQUMsSUFBWSxFQUFFLElBQVk7UUFDbkMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsSUFBSSxFQUFFLHlCQUF5QixDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7SUFDdEQsQ0FBQztJQUNNLE1BQU0sQ0FBQyxJQUFZO1FBQ3hCLE1BQU0sR0FBRyxHQUFHLHVEQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsQ0FBQztRQUNwQyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7WUFDVCxPQUFPLEdBQUcsQ0FBQztRQUNiLENBQUM7UUFDRCxHQUFHLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3pCLE9BQU8sR0FBRyxDQUFDO0lBQ2IsQ0FBQztDQUNGO0FBRU0sTUFBTSxVQUFVLEdBQUcsSUFBSSxTQUFTLEVBQUUsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9zY3JpcHRfdXJsLnRzPzUzZjAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZXh0cmFjdCB9IGZyb20gJ0AvdXRpbC9tYXBfdXRpbCc7XG5cbmZ1bmN0aW9uIGNyZWF0ZU9iamVjdFVSTEZyb21TY3JpcHQoY29kZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgcmV0dXJuIFVSTC5jcmVhdGVPYmplY3RVUkwobmV3IEJsb2IoW2NvZGVdLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi9qYXZhc2NyaXB0JyB9KSk7XG59XG5cbmNsYXNzIFNjcmlwdFVybCB7XG4gIHByaXZhdGUgbWFwOiBNYXA8c3RyaW5nLCBzdHJpbmc+ID0gbmV3IE1hcCgpO1xuXG4gIHB1YmxpYyBnZXQobmFtZTogc3RyaW5nKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5tYXAuZ2V0KG5hbWUpO1xuICB9XG4gIHB1YmxpYyBzZXQobmFtZTogc3RyaW5nLCBjb2RlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICB0aGlzLm1hcC5zZXQobmFtZSwgY3JlYXRlT2JqZWN0VVJMRnJvbVNjcmlwdChjb2RlKSk7XG4gIH1cbiAgcHVibGljIGRlbGV0ZShuYW1lOiBzdHJpbmcpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICAgIGNvbnN0IHVybCA9IGV4dHJhY3QodGhpcy5tYXAsIG5hbWUpO1xuICAgIGlmICghdXJsKSB7XG4gICAgICByZXR1cm4gdXJsO1xuICAgIH1cbiAgICBVUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7XG4gICAgcmV0dXJuIHVybDtcbiAgfVxufVxuXG5leHBvcnQgY29uc3Qgc2NyaXB0X3VybCA9IG5ldyBTY3JpcHRVcmwoKTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/script_url.ts\n")},"./src/slash_command/audio.ts":
/*!************************************!*\
  !*** ./src/slash_command/audio.ts ***!
  \************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   audioEnable: () => (/* binding */ audioEnable),\n/* harmony export */   audioImport: () => (/* binding */ audioImport),\n/* harmony export */   audioMode: () => (/* binding */ audioMode),\n/* harmony export */   audioPlay: () => (/* binding */ audioPlay),\n/* harmony export */   audioSelect: () => (/* binding */ audioSelect),\n/* harmony export */   initAudioSlashCommands: () => (/* binding */ initAudioSlashCommands)\n/* harmony export */ });\n/* harmony import */ var _component_audio__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/component/audio */ \"./src/component/audio/index.ts\");\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var _sillytavern_scripts_slash_commands_SlashCommand__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sillytavern/scripts/slash-commands/SlashCommand */ \"@sillytavern/scripts/slash-commands/SlashCommand\");\n/* harmony import */ var _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @sillytavern/scripts/slash-commands/SlashCommandArgument */ \"@sillytavern/scripts/slash-commands/SlashCommandArgument\");\n/* harmony import */ var _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @sillytavern/scripts/slash-commands/SlashCommandCommonEnumsProvider */ \"@sillytavern/scripts/slash-commands/SlashCommandCommonEnumsProvider\");\n/* harmony import */ var _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @sillytavern/scripts/slash-commands/SlashCommandEnumValue */ \"@sillytavern/scripts/slash-commands/SlashCommandEnumValue\");\n/* harmony import */ var _sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @sillytavern/scripts/slash-commands/SlashCommandParser */ \"@sillytavern/scripts/slash-commands/SlashCommandParser\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_9__);\n\n\n\n\n\n\n\n\n\n\n/**\n * 切换音频播放模式\n */\nasync function audioMode(args) {\n    const type = args.type.toLowerCase();\n    const mode = args.mode.toLowerCase();\n    if (!['bgm', 'ambient'].includes(type) || !['repeat', 'random', 'single', 'stop'].includes(mode)) {\n        loglevel__WEBPACK_IMPORTED_MODULE_9___default().warn('WARN: Invalid arguments for /audiomode command');\n        return '';\n    }\n    if (type === 'bgm') {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.bgm_mode', mode);\n        const iconMap = {\n            repeat: 'fa-repeat',\n            random: 'fa-random',\n            single: 'fa-redo-alt',\n            stop: 'fa-cancel',\n        };\n        $('#audio_bgm_mode_icon').removeClass('fa-repeat fa-random fa-redo-alt fa-cancel');\n        $('#audio_bgm_mode_icon').addClass(iconMap[mode]);\n    }\n    else if (type === 'ambient') {\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.ambient_mode', mode);\n        const iconMap = {\n            repeat: 'fa-repeat',\n            random: 'fa-random',\n            single: 'fa-redo-alt',\n            stop: 'fa-cancel',\n        };\n        $('#audio_ambient_mode_icon').removeClass('fa-repeat fa-random fa-redo-alt fa-cancel');\n        $('#audio_ambient_mode_icon').addClass(iconMap[mode]);\n    }\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.saveSettingsDebounced)();\n    return '';\n}\n/**\n * 切换播放器开关状态\n */\nasync function audioEnable(args) {\n    const type = args.type.toLowerCase();\n    const state = (args.state || 'true').toLowerCase();\n    if (!type) {\n        loglevel__WEBPACK_IMPORTED_MODULE_9___default().warn('WARN: Missing arguments for /audioenable command');\n        return '';\n    }\n    if (type === 'bgm') {\n        if (state === 'true') {\n            $('#enable_bgm').prop('checked', true);\n            await (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.onAudioEnabledClick)('bgm');\n        }\n        else if (state === 'false') {\n            $('#enable_bgm').prop('checked', false);\n            await (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.onAudioEnabledClick)('bgm');\n        }\n    }\n    else if (type === 'ambient') {\n        if (state === 'true') {\n            $('#enable_ambient').prop('checked', true);\n            await (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.onAudioEnabledClick)('ambient');\n        }\n        else if (state === 'false') {\n            $('#enable_ambient').prop('checked', false);\n            await (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.onAudioEnabledClick)('ambient');\n        }\n    }\n    return '';\n}\n/**\n * 切换播放/暂停状态\n */\nasync function audioPlay(args) {\n    const type = args.type.toLowerCase();\n    const play = (args.play || 'true').toLowerCase();\n    if (!type) {\n        loglevel__WEBPACK_IMPORTED_MODULE_9___default().warn('WARN: Missing arguments for /audioplaypause command');\n        return '';\n    }\n    if (type === 'bgm') {\n        if (play === 'true') {\n            await (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.playAudio)('bgm');\n        }\n        else if (play === 'false') {\n            const audioElement = $('#audio_bgm')[0];\n            audioElement.pause();\n        }\n    }\n    else if (type === 'ambient') {\n        if (play === 'true') {\n            await (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.playAudio)('ambient');\n        }\n        else if (play === 'false') {\n            const audioElement = $('#audio_ambient')[0];\n            audioElement.pause();\n        }\n    }\n    return '';\n}\n/**\n * 导入音频链接\n */\nasync function audioImport(args, url) {\n    const type = args.type.toLowerCase();\n    const play = (args.play || 'true').toLowerCase();\n    if (!type || !url) {\n        loglevel__WEBPACK_IMPORTED_MODULE_9___default().warn('WARN: Missing arguments for /audioimport command');\n        return '';\n    }\n    const urlArray = url\n        .split(',')\n        .map((url) => url.trim())\n        .filter((url) => url !== '')\n        .filter((url, index, self) => self.indexOf(url) === index);\n    if (urlArray.length === 0) {\n        loglevel__WEBPACK_IMPORTED_MODULE_9___default().warn('WARN: Invalid or empty URLs provided.');\n        return '';\n    }\n    if (!_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata.variables) {\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata.variables = {};\n    }\n    const typeKey = type === 'bgm' ? 'bgmurl' : 'ambienturl';\n    const existingUrls = _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata.variables[typeKey] || [];\n    const mergedUrls = [...new Set([...urlArray, ...existingUrls])];\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata.variables[typeKey] = mergedUrls;\n    (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__.saveMetadataDebounced)();\n    if (type === 'bgm') {\n        (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.updateAudioSelect)('bgm');\n    }\n    else if (type === 'ambient') {\n        (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.updateAudioSelect)('ambient');\n    }\n    if (play === 'true' && urlArray[0]) {\n        const selectedUrl = urlArray[0];\n        if (type === 'bgm') {\n            (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.bgm_selected', selectedUrl);\n            await (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.updateAudio)('bgm', true);\n        }\n        else if (type === 'ambient') {\n            (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.ambient_selected', selectedUrl);\n            await (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.updateAudio)('ambient', true);\n        }\n    }\n    return '';\n}\n/**\n * 选择并播放音频\n */\nasync function audioSelect(args, url) {\n    const type = args.type.toLowerCase();\n    if (!url) {\n        loglevel__WEBPACK_IMPORTED_MODULE_9___default().warn('WARN: Missing URL for /audioselect command');\n        return '';\n    }\n    if (!_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata.variables) {\n        _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata.variables = {};\n    }\n    const playlist = type === 'bgm' ? _component_audio__WEBPACK_IMPORTED_MODULE_0__.list_BGMS : _component_audio__WEBPACK_IMPORTED_MODULE_0__.list_ambients;\n    const typeKey = type === 'bgm' ? 'bgmurl' : 'ambienturl';\n    if (playlist && playlist.includes(url)) {\n        if (type === 'bgm') {\n            (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.bgm_selected', url);\n            await (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.updateAudio)('bgm', true);\n        }\n        else if (type === 'ambient') {\n            (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.ambient_selected', url);\n            await (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.updateAudio)('ambient', true);\n        }\n        return '';\n    }\n    const existingUrls = _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata.variables[typeKey] || [];\n    const mergedUrls = [...new Set([url, ...existingUrls])];\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.chat_metadata.variables[typeKey] = mergedUrls;\n    (0,_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__.saveMetadataDebounced)();\n    if (type === 'bgm') {\n        (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.updateAudioSelect)('bgm');\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.bgm_selected', url);\n        await (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.updateAudio)('bgm', true);\n    }\n    else if (type === 'ambient') {\n        (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.updateAudioSelect)('ambient');\n        (0,_util_extension_variables__WEBPACK_IMPORTED_MODULE_1__.saveSettingValue)('audio.ambient_selected', url);\n        await (0,_component_audio__WEBPACK_IMPORTED_MODULE_0__.updateAudio)('ambient', true);\n    }\n    return '';\n}\n/**\n * 初始化音频相关的 slash command\n */\nfunction initAudioSlashCommands() {\n    // 注册 audioselect 命令\n    _sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_8__.SlashCommandParser.addCommandObject(_sillytavern_scripts_slash_commands_SlashCommand__WEBPACK_IMPORTED_MODULE_4__.SlashCommand.fromProps({\n        name: 'audioselect',\n        callback: audioSelect,\n        namedArgumentList: [\n            _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.SlashCommandNamedArgument.fromProps({\n                name: 'type',\n                description: '选择播放器类型 (bgm 或 ambient)',\n                typeList: [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.ARGUMENT_TYPE.STRING],\n                enumList: [\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.SlashCommandEnumValue('bgm', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__.enumIcons.file),\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.SlashCommandEnumValue('ambient', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__.enumIcons.file),\n                ],\n                isRequired: true,\n            }),\n        ],\n        unnamedArgumentList: [new _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.SlashCommandArgument('url', [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.ARGUMENT_TYPE.STRING], true)],\n        helpString: `\n        <div>\n            选择并播放音频。如果音频链接不存在，则先导入再播放。\n        </div>\n        <div>\n            <strong>Example:</strong>\n            <ul>\n                <li>\n                    <pre><code>/audioselect type=bgm https://example.com/song.mp3</code></pre>\n                    选择并播放指定的音乐。\n                </li>\n                <li>\n                    <pre><code>/audioselect type=ambient https://example.com/sound.mp3</code></pre>\n                    选择并播放指定的音效。\n                </li>\n            </ul>\n        </div>\n      `,\n    }));\n    // 注册 audioimport 命令\n    _sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_8__.SlashCommandParser.addCommandObject(_sillytavern_scripts_slash_commands_SlashCommand__WEBPACK_IMPORTED_MODULE_4__.SlashCommand.fromProps({\n        name: 'audioimport',\n        callback: audioImport,\n        namedArgumentList: [\n            _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.SlashCommandNamedArgument.fromProps({\n                name: 'type',\n                description: '选择导入类型 (bgm 或 ambient)',\n                typeList: [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.ARGUMENT_TYPE.STRING],\n                enumList: [\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.SlashCommandEnumValue('bgm', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__.enumIcons.file),\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.SlashCommandEnumValue('ambient', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__.enumIcons.file),\n                ],\n                isRequired: true,\n            }),\n            _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.SlashCommandNamedArgument.fromProps({\n                name: 'play',\n                description: '导入后是否立即播放第一个链接',\n                typeList: [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.ARGUMENT_TYPE.BOOLEAN],\n                defaultValue: 'true',\n                isRequired: false,\n            }),\n        ],\n        unnamedArgumentList: [new _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.SlashCommandArgument('url', [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.ARGUMENT_TYPE.STRING], true)],\n        helpString: `\n        <div>\n            导入音频或音乐链接，并决定是否立即播放，默认为自动播放。可批量导入链接，使用英文逗号分隔。\n        </div>\n        <div>\n            <strong>Example:</strong>\n            <ul>\n                <li>\n                    <pre><code>/audioimport type=bgm https://example.com/song1.mp3,https://example.com/song2.mp3</code></pre>\n                    导入 BGM 音乐并立即播放第一个链接。\n                </li>\n                <li>\n                    <pre><code>/audioimport type=ambient play=false url=https://example.com/sound1.mp3,https://example.com/sound2.mp3 </code></pre>\n                    导入音效链接 (不自动播放)。\n                </li>\n            </ul>\n        </div>\n      `,\n    }));\n    // 注册 audioplay 命令\n    _sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_8__.SlashCommandParser.addCommandObject(_sillytavern_scripts_slash_commands_SlashCommand__WEBPACK_IMPORTED_MODULE_4__.SlashCommand.fromProps({\n        name: 'audioplay',\n        callback: audioPlay,\n        namedArgumentList: [\n            _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.SlashCommandNamedArgument.fromProps({\n                name: 'type',\n                description: '选择控制的播放器 (bgm 或 ambient)',\n                typeList: [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.ARGUMENT_TYPE.STRING],\n                enumList: [\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.SlashCommandEnumValue('bgm', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__.enumIcons.file),\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.SlashCommandEnumValue('ambient', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__.enumIcons.file),\n                ],\n                isRequired: true,\n            }),\n            new _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.SlashCommandNamedArgument('play', '播放或暂停', [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.ARGUMENT_TYPE.STRING], true, false, 'true', _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__.commonEnumProviders.boolean('trueFalse')()),\n        ],\n        helpString: `\n        <div>\n            控制音乐播放器或音效播放器的播放与暂停。\n        </div>\n        <div>\n            <strong>Example:</strong>\n            <ul>\n                <li>\n                    <pre><code>/audioplay type=bgm</code></pre>\n                    播放当前音乐。\n                </li>\n                <li>\n                    <pre><code>/audioplay type=ambient play=false</code></pre>\n                    暂停当前音效。\n                </li>\n            </ul>\n        </div>\n      `,\n    }));\n    // 注册 audioenable 命令\n    _sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_8__.SlashCommandParser.addCommandObject(_sillytavern_scripts_slash_commands_SlashCommand__WEBPACK_IMPORTED_MODULE_4__.SlashCommand.fromProps({\n        name: 'audioenable',\n        callback: audioEnable,\n        namedArgumentList: [\n            _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.SlashCommandNamedArgument.fromProps({\n                name: 'type',\n                description: '选择控制的播放器 (bgm 或 ambient)',\n                typeList: [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.ARGUMENT_TYPE.STRING],\n                enumList: [\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.SlashCommandEnumValue('bgm', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__.enumIcons.file),\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.SlashCommandEnumValue('ambient', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__.enumIcons.file),\n                ],\n                isRequired: true,\n            }),\n            new _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.SlashCommandNamedArgument('state', '打开或关闭播放器', [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.ARGUMENT_TYPE.STRING], false, false, 'true', _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__.commonEnumProviders.boolean('trueFalse')()),\n        ],\n        helpString: `\n        <div>\n            控制音乐播放器或音效播放器的开启与关闭。\n        </div>\n        <div>\n            <strong>Example:</strong>\n            <ul>\n                <li>\n                    <pre><code>/audioenable type=bgm state=true</code></pre>\n                    打开音乐播放器。\n                </li>\n                <li>\n                    <pre><code>/audioenable type=ambient state=false</code></pre>\n                    关闭音效播放器。\n                </li>\n            </ul>\n        </div>\n    `,\n    }));\n    // 注册 audiomode 命令\n    _sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_8__.SlashCommandParser.addCommandObject(_sillytavern_scripts_slash_commands_SlashCommand__WEBPACK_IMPORTED_MODULE_4__.SlashCommand.fromProps({\n        name: 'audiomode',\n        callback: audioMode,\n        namedArgumentList: [\n            _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.SlashCommandNamedArgument.fromProps({\n                name: 'type',\n                description: '选择控制的播放器 (bgm 或 ambient)',\n                typeList: [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.ARGUMENT_TYPE.STRING],\n                enumList: [\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.SlashCommandEnumValue('bgm', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__.enumIcons.file),\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.SlashCommandEnumValue('ambient', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__.enumIcons.file),\n                ],\n                isRequired: true,\n            }),\n            _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.SlashCommandNamedArgument.fromProps({\n                name: 'mode',\n                description: '选择播放模式',\n                typeList: [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_5__.ARGUMENT_TYPE.STRING],\n                enumList: [\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.SlashCommandEnumValue('repeat', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__.enumIcons.loop),\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.SlashCommandEnumValue('random', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__.enumIcons.shuffle),\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.SlashCommandEnumValue('single', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__.enumIcons.redo),\n                    new _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.SlashCommandEnumValue('stop', null, _sillytavern_scripts_slash_commands_SlashCommandEnumValue__WEBPACK_IMPORTED_MODULE_7__.enumTypes.enum, _sillytavern_scripts_slash_commands_SlashCommandCommonEnumsProvider__WEBPACK_IMPORTED_MODULE_6__.enumIcons.stop),\n                ],\n                isRequired: true,\n            }),\n        ],\n        helpString: `\n        <div>\n            设置音频播放模式。\n        </div>\n        <div>\n            <strong>Example:</strong>\n            <ul>\n                <li>\n                    <pre><code>/audiomode type=bgm mode=repeat</code></pre>\n                    设置音乐为循环播放模式。\n                </li>\n                <li>\n                    <pre><code>/audiomode type=ambient mode=random</code></pre>\n                    设置音效为随机播放模式。\n                </li>\n                <li>\n                    <pre><code>/audiomode type=bgm mode=single</code></pre>\n                    设置音乐为单曲循环模式。\n                </li>\n                <li>\n                    <pre><code>/audiomode type=ambient mode=stop</code></pre>\n                    设置音效为停止播放模式。\n                </li>\n            </ul>\n        </div>\n    `,\n    }));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvc2xhc2hfY29tbWFuZC9hdWRpby50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQU8yQjtBQUNtQztBQUVhO0FBQ0g7QUFDUTtBQUtkO0FBQ21EO0FBQ1I7QUFDakI7QUFFakU7QUFNM0I7O0dBRUc7QUFDSSxLQUFLLFVBQVUsU0FBUyxDQUFDLElBQW9DO0lBQ2xFLE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7SUFDckMsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztJQUVyQyxJQUFJLENBQUMsQ0FBQyxLQUFLLEVBQUUsU0FBUyxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLEVBQUUsUUFBUSxFQUFFLFFBQVEsRUFBRSxNQUFNLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQztRQUNqRyxvREFBUSxDQUFDLGdEQUFnRCxDQUFDLENBQUM7UUFDM0QsT0FBTyxFQUFFLENBQUM7SUFDWixDQUFDO0lBRUQsSUFBSSxJQUFJLEtBQUssS0FBSyxFQUFFLENBQUM7UUFDbkIsMkVBQWdCLENBQUMsZ0JBQWdCLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDekMsTUFBTSxPQUFPLEdBQTJCO1lBQ3RDLE1BQU0sRUFBRSxXQUFXO1lBQ25CLE1BQU0sRUFBRSxXQUFXO1lBQ25CLE1BQU0sRUFBRSxhQUFhO1lBQ3JCLElBQUksRUFBRSxXQUFXO1NBQ2xCLENBQUM7UUFDRixDQUFDLENBQUMsc0JBQXNCLENBQUMsQ0FBQyxXQUFXLENBQUMsMkNBQTJDLENBQUMsQ0FBQztRQUNuRixDQUFDLENBQUMsc0JBQXNCLENBQUMsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7SUFDcEQsQ0FBQztTQUFNLElBQUksSUFBSSxLQUFLLFNBQVMsRUFBRSxDQUFDO1FBQzlCLDJFQUFnQixDQUFDLG9CQUFvQixFQUFFLElBQUksQ0FBQyxDQUFDO1FBQzdDLE1BQU0sT0FBTyxHQUEyQjtZQUN0QyxNQUFNLEVBQUUsV0FBVztZQUNuQixNQUFNLEVBQUUsV0FBVztZQUNuQixNQUFNLEVBQUUsYUFBYTtZQUNyQixJQUFJLEVBQUUsV0FBVztTQUNsQixDQUFDO1FBQ0YsQ0FBQyxDQUFDLDBCQUEwQixDQUFDLENBQUMsV0FBVyxDQUFDLDJDQUEyQyxDQUFDLENBQUM7UUFDdkYsQ0FBQyxDQUFDLDBCQUEwQixDQUFDLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO0lBQ3hELENBQUM7SUFFRCwwRUFBcUIsRUFBRSxDQUFDO0lBQ3hCLE9BQU8sRUFBRSxDQUFDO0FBQ1osQ0FBQztBQUVEOztHQUVHO0FBQ0ksS0FBSyxVQUFVLFdBQVcsQ0FBQyxJQUFzQztJQUN0RSxNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO0lBQ3JDLE1BQU0sS0FBSyxHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUssSUFBSSxNQUFNLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztJQUVuRCxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDVixvREFBUSxDQUFDLGtEQUFrRCxDQUFDLENBQUM7UUFDN0QsT0FBTyxFQUFFLENBQUM7SUFDWixDQUFDO0lBRUQsSUFBSSxJQUFJLEtBQUssS0FBSyxFQUFFLENBQUM7UUFDbkIsSUFBSSxLQUFLLEtBQUssTUFBTSxFQUFFLENBQUM7WUFDckIsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsSUFBSSxDQUFDLENBQUM7WUFDdkMsTUFBTSxxRUFBbUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNuQyxDQUFDO2FBQU0sSUFBSSxLQUFLLEtBQUssT0FBTyxFQUFFLENBQUM7WUFDN0IsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsS0FBSyxDQUFDLENBQUM7WUFDeEMsTUFBTSxxRUFBbUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNuQyxDQUFDO0lBQ0gsQ0FBQztTQUFNLElBQUksSUFBSSxLQUFLLFNBQVMsRUFBRSxDQUFDO1FBQzlCLElBQUksS0FBSyxLQUFLLE1BQU0sRUFBRSxDQUFDO1lBQ3JCLENBQUMsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsSUFBSSxDQUFDLENBQUM7WUFDM0MsTUFBTSxxRUFBbUIsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUN2QyxDQUFDO2FBQU0sSUFBSSxLQUFLLEtBQUssT0FBTyxFQUFFLENBQUM7WUFDN0IsQ0FBQyxDQUFDLGlCQUFpQixDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxLQUFLLENBQUMsQ0FBQztZQUM1QyxNQUFNLHFFQUFtQixDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQ3ZDLENBQUM7SUFDSCxDQUFDO0lBRUQsT0FBTyxFQUFFLENBQUM7QUFDWixDQUFDO0FBRUQ7O0dBRUc7QUFDSSxLQUFLLFVBQVUsU0FBUyxDQUFDLElBQXFDO0lBQ25FLE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7SUFDckMsTUFBTSxJQUFJLEdBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSSxJQUFJLE1BQU0sQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO0lBRWpELElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUNWLG9EQUFRLENBQUMscURBQXFELENBQUMsQ0FBQztRQUNoRSxPQUFPLEVBQUUsQ0FBQztJQUNaLENBQUM7SUFFRCxJQUFJLElBQUksS0FBSyxLQUFLLEVBQUUsQ0FBQztRQUNuQixJQUFJLElBQUksS0FBSyxNQUFNLEVBQUUsQ0FBQztZQUNwQixNQUFNLDJEQUFTLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDekIsQ0FBQzthQUFNLElBQUksSUFBSSxLQUFLLE9BQU8sRUFBRSxDQUFDO1lBQzVCLE1BQU0sWUFBWSxHQUFHLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQWlCLENBQUM7WUFDeEQsWUFBWSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ3ZCLENBQUM7SUFDSCxDQUFDO1NBQU0sSUFBSSxJQUFJLEtBQUssU0FBUyxFQUFFLENBQUM7UUFDOUIsSUFBSSxJQUFJLEtBQUssTUFBTSxFQUFFLENBQUM7WUFDcEIsTUFBTSwyREFBUyxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQzdCLENBQUM7YUFBTSxJQUFJLElBQUksS0FBSyxPQUFPLEVBQUUsQ0FBQztZQUM1QixNQUFNLFlBQVksR0FBRyxDQUFDLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDLENBQWlCLENBQUM7WUFDNUQsWUFBWSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ3ZCLENBQUM7SUFDSCxDQUFDO0lBRUQsT0FBTyxFQUFFLENBQUM7QUFDWixDQUFDO0FBRUQ7O0dBRUc7QUFDSSxLQUFLLFVBQVUsV0FBVyxDQUFDLElBQXFDLEVBQUUsR0FBVztJQUNsRixNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO0lBQ3JDLE1BQU0sSUFBSSxHQUFHLENBQUMsSUFBSSxDQUFDLElBQUksSUFBSSxNQUFNLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztJQUVqRCxJQUFJLENBQUMsSUFBSSxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7UUFDbEIsb0RBQVEsQ0FBQyxrREFBa0QsQ0FBQyxDQUFDO1FBQzdELE9BQU8sRUFBRSxDQUFDO0lBQ1osQ0FBQztJQUVELE1BQU0sUUFBUSxHQUFHLEdBQUc7U0FDakIsS0FBSyxDQUFDLEdBQUcsQ0FBQztTQUNWLEdBQUcsQ0FBQyxDQUFDLEdBQVcsRUFBRSxFQUFFLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxDQUFDO1NBQ2hDLE1BQU0sQ0FBQyxDQUFDLEdBQVcsRUFBRSxFQUFFLENBQUMsR0FBRyxLQUFLLEVBQUUsQ0FBQztTQUNuQyxNQUFNLENBQUMsQ0FBQyxHQUFXLEVBQUUsS0FBYSxFQUFFLElBQWMsRUFBRSxFQUFFLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsS0FBSyxLQUFLLENBQUMsQ0FBQztJQUN2RixJQUFJLFFBQVEsQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFLENBQUM7UUFDMUIsb0RBQVEsQ0FBQyx1Q0FBdUMsQ0FBQyxDQUFDO1FBQ2xELE9BQU8sRUFBRSxDQUFDO0lBQ1osQ0FBQztJQUVELElBQUksQ0FBQyw4REFBYSxDQUFDLFNBQVMsRUFBRSxDQUFDO1FBQzdCLDhEQUFhLENBQUMsU0FBUyxHQUFHLEVBQUUsQ0FBQztJQUMvQixDQUFDO0lBRUQsTUFBTSxPQUFPLEdBQUcsSUFBSSxLQUFLLEtBQUssQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxZQUFZLENBQUM7SUFDekQsTUFBTSxZQUFZLEdBQUcsOERBQWEsQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSxDQUFDO0lBQzVELE1BQU0sVUFBVSxHQUFHLENBQUMsR0FBRyxJQUFJLEdBQUcsQ0FBQyxDQUFDLEdBQUcsUUFBUSxFQUFFLEdBQUcsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBRWhFLDhEQUFhLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxHQUFHLFVBQVUsQ0FBQztJQUM5QyxzRkFBcUIsRUFBRSxDQUFDO0lBRXhCLElBQUksSUFBSSxLQUFLLEtBQUssRUFBRSxDQUFDO1FBQ25CLG1FQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQzNCLENBQUM7U0FBTSxJQUFJLElBQUksS0FBSyxTQUFTLEVBQUUsQ0FBQztRQUM5QixtRUFBaUIsQ0FBQyxTQUFTLENBQUMsQ0FBQztJQUMvQixDQUFDO0lBRUQsSUFBSSxJQUFJLEtBQUssTUFBTSxJQUFJLFFBQVEsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDO1FBQ25DLE1BQU0sV0FBVyxHQUFHLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNoQyxJQUFJLElBQUksS0FBSyxLQUFLLEVBQUUsQ0FBQztZQUNuQiwyRUFBZ0IsQ0FBQyxvQkFBb0IsRUFBRSxXQUFXLENBQUMsQ0FBQztZQUNwRCxNQUFNLDZEQUFXLENBQUMsS0FBSyxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ2pDLENBQUM7YUFBTSxJQUFJLElBQUksS0FBSyxTQUFTLEVBQUUsQ0FBQztZQUM5QiwyRUFBZ0IsQ0FBQyx3QkFBd0IsRUFBRSxXQUFXLENBQUMsQ0FBQztZQUN4RCxNQUFNLDZEQUFXLENBQUMsU0FBUyxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ3JDLENBQUM7SUFDSCxDQUFDO0lBRUQsT0FBTyxFQUFFLENBQUM7QUFDWixDQUFDO0FBRUQ7O0dBRUc7QUFDSSxLQUFLLFVBQVUsV0FBVyxDQUFDLElBQXNCLEVBQUUsR0FBVztJQUNuRSxNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO0lBRXJDLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQztRQUNULG9EQUFRLENBQUMsNENBQTRDLENBQUMsQ0FBQztRQUN2RCxPQUFPLEVBQUUsQ0FBQztJQUNaLENBQUM7SUFFRCxJQUFJLENBQUMsOERBQWEsQ0FBQyxTQUFTLEVBQUUsQ0FBQztRQUM3Qiw4REFBYSxDQUFDLFNBQVMsR0FBRyxFQUFFLENBQUM7SUFDL0IsQ0FBQztJQUVELE1BQU0sUUFBUSxHQUFHLElBQUksS0FBSyxLQUFLLENBQUMsQ0FBQyxDQUFDLHVEQUFTLENBQUMsQ0FBQyxDQUFDLDJEQUFhLENBQUM7SUFDNUQsTUFBTSxPQUFPLEdBQUcsSUFBSSxLQUFLLEtBQUssQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxZQUFZLENBQUM7SUFFekQsSUFBSSxRQUFRLElBQUksUUFBUSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDO1FBQ3ZDLElBQUksSUFBSSxLQUFLLEtBQUssRUFBRSxDQUFDO1lBQ25CLDJFQUFnQixDQUFDLG9CQUFvQixFQUFFLEdBQUcsQ0FBQyxDQUFDO1lBQzVDLE1BQU0sNkRBQVcsQ0FBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDakMsQ0FBQzthQUFNLElBQUksSUFBSSxLQUFLLFNBQVMsRUFBRSxDQUFDO1lBQzlCLDJFQUFnQixDQUFDLHdCQUF3QixFQUFFLEdBQUcsQ0FBQyxDQUFDO1lBQ2hELE1BQU0sNkRBQVcsQ0FBQyxTQUFTLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDckMsQ0FBQztRQUNELE9BQU8sRUFBRSxDQUFDO0lBQ1osQ0FBQztJQUVELE1BQU0sWUFBWSxHQUFHLDhEQUFhLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUU1RCxNQUFNLFVBQVUsR0FBRyxDQUFDLEdBQUcsSUFBSSxHQUFHLENBQUMsQ0FBQyxHQUFHLEVBQUUsR0FBRyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDeEQsOERBQWEsQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLEdBQUcsVUFBVSxDQUFDO0lBQzlDLHNGQUFxQixFQUFFLENBQUM7SUFFeEIsSUFBSSxJQUFJLEtBQUssS0FBSyxFQUFFLENBQUM7UUFDbkIsbUVBQWlCLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDekIsMkVBQWdCLENBQUMsb0JBQW9CLEVBQUUsR0FBRyxDQUFDLENBQUM7UUFDNUMsTUFBTSw2REFBVyxDQUFDLEtBQUssRUFBRSxJQUFJLENBQUMsQ0FBQztJQUNqQyxDQUFDO1NBQU0sSUFBSSxJQUFJLEtBQUssU0FBUyxFQUFFLENBQUM7UUFDOUIsbUVBQWlCLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDN0IsMkVBQWdCLENBQUMsd0JBQXdCLEVBQUUsR0FBRyxDQUFDLENBQUM7UUFDaEQsTUFBTSw2REFBVyxDQUFDLFNBQVMsRUFBRSxJQUFJLENBQUMsQ0FBQztJQUNyQyxDQUFDO0lBRUQsT0FBTyxFQUFFLENBQUM7QUFDWixDQUFDO0FBRUQ7O0dBRUc7QUFDSSxTQUFTLHNCQUFzQjtJQUNwQyxvQkFBb0I7SUFDcEIsc0dBQWtCLENBQUMsZ0JBQWdCLENBQ2pDLDBGQUFZLENBQUMsU0FBUyxDQUFDO1FBQ3JCLElBQUksRUFBRSxhQUFhO1FBQ25CLFFBQVEsRUFBRSxXQUFXO1FBQ3JCLGlCQUFpQixFQUFFO1lBQ2pCLCtHQUF5QixDQUFDLFNBQVMsQ0FBQztnQkFDbEMsSUFBSSxFQUFFLE1BQU07Z0JBQ1osV0FBVyxFQUFFLHlCQUF5QjtnQkFDdEMsUUFBUSxFQUFFLENBQUMsbUdBQWEsQ0FBQyxNQUFNLENBQUM7Z0JBQ2hDLFFBQVEsRUFBRTtvQkFDUixJQUFJLDRHQUFxQixDQUFDLEtBQUssRUFBRSxJQUFJLEVBQUUsZ0dBQVMsQ0FBQyxJQUFJLEVBQUUsMEdBQVMsQ0FBQyxJQUFJLENBQUM7b0JBQ3RFLElBQUksNEdBQXFCLENBQUMsU0FBUyxFQUFFLElBQUksRUFBRSxnR0FBUyxDQUFDLElBQUksRUFBRSwwR0FBUyxDQUFDLElBQUksQ0FBQztpQkFDM0U7Z0JBQ0QsVUFBVSxFQUFFLElBQUk7YUFDakIsQ0FBQztTQUNIO1FBQ0QsbUJBQW1CLEVBQUUsQ0FBQyxJQUFJLDBHQUFvQixDQUFDLEtBQUssRUFBRSxDQUFDLG1HQUFhLENBQUMsTUFBTSxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDcEYsVUFBVSxFQUFFOzs7Ozs7Ozs7Ozs7Ozs7OztPQWlCWDtLQUNGLENBQUMsQ0FDSCxDQUFDO0lBRUYsb0JBQW9CO0lBQ3BCLHNHQUFrQixDQUFDLGdCQUFnQixDQUNqQywwRkFBWSxDQUFDLFNBQVMsQ0FBQztRQUNyQixJQUFJLEVBQUUsYUFBYTtRQUNuQixRQUFRLEVBQUUsV0FBVztRQUNyQixpQkFBaUIsRUFBRTtZQUNqQiwrR0FBeUIsQ0FBQyxTQUFTLENBQUM7Z0JBQ2xDLElBQUksRUFBRSxNQUFNO2dCQUNaLFdBQVcsRUFBRSx3QkFBd0I7Z0JBQ3JDLFFBQVEsRUFBRSxDQUFDLG1HQUFhLENBQUMsTUFBTSxDQUFDO2dCQUNoQyxRQUFRLEVBQUU7b0JBQ1IsSUFBSSw0R0FBcUIsQ0FBQyxLQUFLLEVBQUUsSUFBSSxFQUFFLGdHQUFTLENBQUMsSUFBSSxFQUFFLDBHQUFTLENBQUMsSUFBSSxDQUFDO29CQUN0RSxJQUFJLDRHQUFxQixDQUFDLFNBQVMsRUFBRSxJQUFJLEVBQUUsZ0dBQVMsQ0FBQyxJQUFJLEVBQUUsMEdBQVMsQ0FBQyxJQUFJLENBQUM7aUJBQzNFO2dCQUNELFVBQVUsRUFBRSxJQUFJO2FBQ2pCLENBQUM7WUFDRiwrR0FBeUIsQ0FBQyxTQUFTLENBQUM7Z0JBQ2xDLElBQUksRUFBRSxNQUFNO2dCQUNaLFdBQVcsRUFBRSxnQkFBZ0I7Z0JBQzdCLFFBQVEsRUFBRSxDQUFDLG1HQUFhLENBQUMsT0FBTyxDQUFDO2dCQUNqQyxZQUFZLEVBQUUsTUFBTTtnQkFDcEIsVUFBVSxFQUFFLEtBQUs7YUFDbEIsQ0FBQztTQUNIO1FBQ0QsbUJBQW1CLEVBQUUsQ0FBQyxJQUFJLDBHQUFvQixDQUFDLEtBQUssRUFBRSxDQUFDLG1HQUFhLENBQUMsTUFBTSxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDcEYsVUFBVSxFQUFFOzs7Ozs7Ozs7Ozs7Ozs7OztPQWlCWDtLQUNGLENBQUMsQ0FDSCxDQUFDO0lBRUYsa0JBQWtCO0lBQ2xCLHNHQUFrQixDQUFDLGdCQUFnQixDQUNqQywwRkFBWSxDQUFDLFNBQVMsQ0FBQztRQUNyQixJQUFJLEVBQUUsV0FBVztRQUNqQixRQUFRLEVBQUUsU0FBUztRQUNuQixpQkFBaUIsRUFBRTtZQUNqQiwrR0FBeUIsQ0FBQyxTQUFTLENBQUM7Z0JBQ2xDLElBQUksRUFBRSxNQUFNO2dCQUNaLFdBQVcsRUFBRSwwQkFBMEI7Z0JBQ3ZDLFFBQVEsRUFBRSxDQUFDLG1HQUFhLENBQUMsTUFBTSxDQUFDO2dCQUNoQyxRQUFRLEVBQUU7b0JBQ1IsSUFBSSw0R0FBcUIsQ0FBQyxLQUFLLEVBQUUsSUFBSSxFQUFFLGdHQUFTLENBQUMsSUFBSSxFQUFFLDBHQUFTLENBQUMsSUFBSSxDQUFDO29CQUN0RSxJQUFJLDRHQUFxQixDQUFDLFNBQVMsRUFBRSxJQUFJLEVBQUUsZ0dBQVMsQ0FBQyxJQUFJLEVBQUUsMEdBQVMsQ0FBQyxJQUFJLENBQUM7aUJBQzNFO2dCQUNELFVBQVUsRUFBRSxJQUFJO2FBQ2pCLENBQUM7WUFDRixJQUFJLCtHQUF5QixDQUMzQixNQUFNLEVBQ04sT0FBTyxFQUNQLENBQUMsbUdBQWEsQ0FBQyxNQUFNLENBQUMsRUFDdEIsSUFBSSxFQUNKLEtBQUssRUFDTCxNQUFNLEVBQ04sb0hBQW1CLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxFQUFFLENBQzNDO1NBQ0Y7UUFDRCxVQUFVLEVBQUU7Ozs7Ozs7Ozs7Ozs7Ozs7O09BaUJYO0tBQ0YsQ0FBQyxDQUNILENBQUM7SUFFRixvQkFBb0I7SUFDcEIsc0dBQWtCLENBQUMsZ0JBQWdCLENBQ2pDLDBGQUFZLENBQUMsU0FBUyxDQUFDO1FBQ3JCLElBQUksRUFBRSxhQUFhO1FBQ25CLFFBQVEsRUFBRSxXQUFXO1FBQ3JCLGlCQUFpQixFQUFFO1lBQ2pCLCtHQUF5QixDQUFDLFNBQVMsQ0FBQztnQkFDbEMsSUFBSSxFQUFFLE1BQU07Z0JBQ1osV0FBVyxFQUFFLDBCQUEwQjtnQkFDdkMsUUFBUSxFQUFFLENBQUMsbUdBQWEsQ0FBQyxNQUFNLENBQUM7Z0JBQ2hDLFFBQVEsRUFBRTtvQkFDUixJQUFJLDRHQUFxQixDQUFDLEtBQUssRUFBRSxJQUFJLEVBQUUsZ0dBQVMsQ0FBQyxJQUFJLEVBQUUsMEdBQVMsQ0FBQyxJQUFJLENBQUM7b0JBQ3RFLElBQUksNEdBQXFCLENBQUMsU0FBUyxFQUFFLElBQUksRUFBRSxnR0FBUyxDQUFDLElBQUksRUFBRSwwR0FBUyxDQUFDLElBQUksQ0FBQztpQkFDM0U7Z0JBQ0QsVUFBVSxFQUFFLElBQUk7YUFDakIsQ0FBQztZQUNGLElBQUksK0dBQXlCLENBQzNCLE9BQU8sRUFDUCxVQUFVLEVBQ1YsQ0FBQyxtR0FBYSxDQUFDLE1BQU0sQ0FBQyxFQUN0QixLQUFLLEVBQ0wsS0FBSyxFQUNMLE1BQU0sRUFDTixvSEFBbUIsQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLEVBQUUsQ0FDM0M7U0FDRjtRQUNELFVBQVUsRUFBRTs7Ozs7Ozs7Ozs7Ozs7Ozs7S0FpQmI7S0FDQSxDQUFDLENBQ0gsQ0FBQztJQUVGLGtCQUFrQjtJQUNsQixzR0FBa0IsQ0FBQyxnQkFBZ0IsQ0FDakMsMEZBQVksQ0FBQyxTQUFTLENBQUM7UUFDckIsSUFBSSxFQUFFLFdBQVc7UUFDakIsUUFBUSxFQUFFLFNBQVM7UUFDbkIsaUJBQWlCLEVBQUU7WUFDakIsK0dBQXlCLENBQUMsU0FBUyxDQUFDO2dCQUNsQyxJQUFJLEVBQUUsTUFBTTtnQkFDWixXQUFXLEVBQUUsMEJBQTBCO2dCQUN2QyxRQUFRLEVBQUUsQ0FBQyxtR0FBYSxDQUFDLE1BQU0sQ0FBQztnQkFDaEMsUUFBUSxFQUFFO29CQUNSLElBQUksNEdBQXFCLENBQUMsS0FBSyxFQUFFLElBQUksRUFBRSxnR0FBUyxDQUFDLElBQUksRUFBRSwwR0FBUyxDQUFDLElBQUksQ0FBQztvQkFDdEUsSUFBSSw0R0FBcUIsQ0FBQyxTQUFTLEVBQUUsSUFBSSxFQUFFLGdHQUFTLENBQUMsSUFBSSxFQUFFLDBHQUFTLENBQUMsSUFBSSxDQUFDO2lCQUMzRTtnQkFDRCxVQUFVLEVBQUUsSUFBSTthQUNqQixDQUFDO1lBQ0YsK0dBQXlCLENBQUMsU0FBUyxDQUFDO2dCQUNsQyxJQUFJLEVBQUUsTUFBTTtnQkFDWixXQUFXLEVBQUUsUUFBUTtnQkFDckIsUUFBUSxFQUFFLENBQUMsbUdBQWEsQ0FBQyxNQUFNLENBQUM7Z0JBQ2hDLFFBQVEsRUFBRTtvQkFDUixJQUFJLDRHQUFxQixDQUFDLFFBQVEsRUFBRSxJQUFJLEVBQUUsZ0dBQVMsQ0FBQyxJQUFJLEVBQUUsMEdBQVMsQ0FBQyxJQUFJLENBQUM7b0JBQ3pFLElBQUksNEdBQXFCLENBQUMsUUFBUSxFQUFFLElBQUksRUFBRSxnR0FBUyxDQUFDLElBQUksRUFBRSwwR0FBUyxDQUFDLE9BQU8sQ0FBQztvQkFDNUUsSUFBSSw0R0FBcUIsQ0FBQyxRQUFRLEVBQUUsSUFBSSxFQUFFLGdHQUFTLENBQUMsSUFBSSxFQUFFLDBHQUFTLENBQUMsSUFBSSxDQUFDO29CQUN6RSxJQUFJLDRHQUFxQixDQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsZ0dBQVMsQ0FBQyxJQUFJLEVBQUUsMEdBQVMsQ0FBQyxJQUFJLENBQUM7aUJBQ3hFO2dCQUNELFVBQVUsRUFBRSxJQUFJO2FBQ2pCLENBQUM7U0FDSDtRQUNELFVBQVUsRUFBRTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztLQXlCYjtLQUNBLENBQUMsQ0FDSCxDQUFDO0FBQ0osQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy9zbGFzaF9jb21tYW5kL2F1ZGlvLnRzPzBjODAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgbGlzdF9CR01TLFxuICBsaXN0X2FtYmllbnRzLFxuICBvbkF1ZGlvRW5hYmxlZENsaWNrLFxuICBwbGF5QXVkaW8sXG4gIHVwZGF0ZUF1ZGlvLFxuICB1cGRhdGVBdWRpb1NlbGVjdCxcbn0gZnJvbSAnQC9jb21wb25lbnQvYXVkaW8nO1xuaW1wb3J0IHsgc2F2ZVNldHRpbmdWYWx1ZSB9IGZyb20gJ0AvdXRpbC9leHRlbnNpb25fdmFyaWFibGVzJztcblxuaW1wb3J0IHsgY2hhdF9tZXRhZGF0YSwgc2F2ZVNldHRpbmdzRGVib3VuY2VkIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5pbXBvcnQgeyBzYXZlTWV0YWRhdGFEZWJvdW5jZWQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9leHRlbnNpb25zJztcbmltcG9ydCB7IFNsYXNoQ29tbWFuZCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3NsYXNoLWNvbW1hbmRzL1NsYXNoQ29tbWFuZCc7XG5pbXBvcnQge1xuICBBUkdVTUVOVF9UWVBFLFxuICBTbGFzaENvbW1hbmRBcmd1bWVudCxcbiAgU2xhc2hDb21tYW5kTmFtZWRBcmd1bWVudCxcbn0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvc2xhc2gtY29tbWFuZHMvU2xhc2hDb21tYW5kQXJndW1lbnQnO1xuaW1wb3J0IHsgY29tbW9uRW51bVByb3ZpZGVycywgZW51bUljb25zIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvc2xhc2gtY29tbWFuZHMvU2xhc2hDb21tYW5kQ29tbW9uRW51bXNQcm92aWRlcic7XG5pbXBvcnQgeyBTbGFzaENvbW1hbmRFbnVtVmFsdWUsIGVudW1UeXBlcyB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3NsYXNoLWNvbW1hbmRzL1NsYXNoQ29tbWFuZEVudW1WYWx1ZSc7XG5pbXBvcnQgeyBTbGFzaENvbW1hbmRQYXJzZXIgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9zbGFzaC1jb21tYW5kcy9TbGFzaENvbW1hbmRQYXJzZXInO1xuXG5pbXBvcnQgbG9nIGZyb20gJ2xvZ2xldmVsJztcblxuaW50ZXJmYWNlIEF1ZGlvRWxlbWVudCBleHRlbmRzIEhUTUxFbGVtZW50IHtcbiAgcGF1c2UoKTogdm9pZDtcbn1cblxuLyoqXG4gKiDliIfmjaLpn7PpopHmkq3mlL7mqKHlvI9cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGF1ZGlvTW9kZShhcmdzOiB7IHR5cGU6IHN0cmluZzsgbW9kZTogc3RyaW5nIH0pOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgdHlwZSA9IGFyZ3MudHlwZS50b0xvd2VyQ2FzZSgpO1xuICBjb25zdCBtb2RlID0gYXJncy5tb2RlLnRvTG93ZXJDYXNlKCk7XG5cbiAgaWYgKCFbJ2JnbScsICdhbWJpZW50J10uaW5jbHVkZXModHlwZSkgfHwgIVsncmVwZWF0JywgJ3JhbmRvbScsICdzaW5nbGUnLCAnc3RvcCddLmluY2x1ZGVzKG1vZGUpKSB7XG4gICAgbG9nLndhcm4oJ1dBUk46IEludmFsaWQgYXJndW1lbnRzIGZvciAvYXVkaW9tb2RlIGNvbW1hbmQnKTtcbiAgICByZXR1cm4gJyc7XG4gIH1cblxuICBpZiAodHlwZSA9PT0gJ2JnbScpIHtcbiAgICBzYXZlU2V0dGluZ1ZhbHVlKCdhdWRpby5iZ21fbW9kZScsIG1vZGUpO1xuICAgIGNvbnN0IGljb25NYXA6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gICAgICByZXBlYXQ6ICdmYS1yZXBlYXQnLFxuICAgICAgcmFuZG9tOiAnZmEtcmFuZG9tJyxcbiAgICAgIHNpbmdsZTogJ2ZhLXJlZG8tYWx0JyxcbiAgICAgIHN0b3A6ICdmYS1jYW5jZWwnLFxuICAgIH07XG4gICAgJCgnI2F1ZGlvX2JnbV9tb2RlX2ljb24nKS5yZW1vdmVDbGFzcygnZmEtcmVwZWF0IGZhLXJhbmRvbSBmYS1yZWRvLWFsdCBmYS1jYW5jZWwnKTtcbiAgICAkKCcjYXVkaW9fYmdtX21vZGVfaWNvbicpLmFkZENsYXNzKGljb25NYXBbbW9kZV0pO1xuICB9IGVsc2UgaWYgKHR5cGUgPT09ICdhbWJpZW50Jykge1xuICAgIHNhdmVTZXR0aW5nVmFsdWUoJ2F1ZGlvLmFtYmllbnRfbW9kZScsIG1vZGUpO1xuICAgIGNvbnN0IGljb25NYXA6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gICAgICByZXBlYXQ6ICdmYS1yZXBlYXQnLFxuICAgICAgcmFuZG9tOiAnZmEtcmFuZG9tJyxcbiAgICAgIHNpbmdsZTogJ2ZhLXJlZG8tYWx0JyxcbiAgICAgIHN0b3A6ICdmYS1jYW5jZWwnLFxuICAgIH07XG4gICAgJCgnI2F1ZGlvX2FtYmllbnRfbW9kZV9pY29uJykucmVtb3ZlQ2xhc3MoJ2ZhLXJlcGVhdCBmYS1yYW5kb20gZmEtcmVkby1hbHQgZmEtY2FuY2VsJyk7XG4gICAgJCgnI2F1ZGlvX2FtYmllbnRfbW9kZV9pY29uJykuYWRkQ2xhc3MoaWNvbk1hcFttb2RlXSk7XG4gIH1cblxuICBzYXZlU2V0dGluZ3NEZWJvdW5jZWQoKTtcbiAgcmV0dXJuICcnO1xufVxuXG4vKipcbiAqIOWIh+aNouaSreaUvuWZqOW8gOWFs+eKtuaAgVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXVkaW9FbmFibGUoYXJnczogeyB0eXBlOiBzdHJpbmc7IHN0YXRlPzogc3RyaW5nIH0pOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgdHlwZSA9IGFyZ3MudHlwZS50b0xvd2VyQ2FzZSgpO1xuICBjb25zdCBzdGF0ZSA9IChhcmdzLnN0YXRlIHx8ICd0cnVlJykudG9Mb3dlckNhc2UoKTtcblxuICBpZiAoIXR5cGUpIHtcbiAgICBsb2cud2FybignV0FSTjogTWlzc2luZyBhcmd1bWVudHMgZm9yIC9hdWRpb2VuYWJsZSBjb21tYW5kJyk7XG4gICAgcmV0dXJuICcnO1xuICB9XG5cbiAgaWYgKHR5cGUgPT09ICdiZ20nKSB7XG4gICAgaWYgKHN0YXRlID09PSAndHJ1ZScpIHtcbiAgICAgICQoJyNlbmFibGVfYmdtJykucHJvcCgnY2hlY2tlZCcsIHRydWUpO1xuICAgICAgYXdhaXQgb25BdWRpb0VuYWJsZWRDbGljaygnYmdtJyk7XG4gICAgfSBlbHNlIGlmIChzdGF0ZSA9PT0gJ2ZhbHNlJykge1xuICAgICAgJCgnI2VuYWJsZV9iZ20nKS5wcm9wKCdjaGVja2VkJywgZmFsc2UpO1xuICAgICAgYXdhaXQgb25BdWRpb0VuYWJsZWRDbGljaygnYmdtJyk7XG4gICAgfVxuICB9IGVsc2UgaWYgKHR5cGUgPT09ICdhbWJpZW50Jykge1xuICAgIGlmIChzdGF0ZSA9PT0gJ3RydWUnKSB7XG4gICAgICAkKCcjZW5hYmxlX2FtYmllbnQnKS5wcm9wKCdjaGVja2VkJywgdHJ1ZSk7XG4gICAgICBhd2FpdCBvbkF1ZGlvRW5hYmxlZENsaWNrKCdhbWJpZW50Jyk7XG4gICAgfSBlbHNlIGlmIChzdGF0ZSA9PT0gJ2ZhbHNlJykge1xuICAgICAgJCgnI2VuYWJsZV9hbWJpZW50JykucHJvcCgnY2hlY2tlZCcsIGZhbHNlKTtcbiAgICAgIGF3YWl0IG9uQXVkaW9FbmFibGVkQ2xpY2soJ2FtYmllbnQnKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gJyc7XG59XG5cbi8qKlxuICog5YiH5o2i5pKt5pS+L+aaguWBnOeKtuaAgVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXVkaW9QbGF5KGFyZ3M6IHsgdHlwZTogc3RyaW5nOyBwbGF5Pzogc3RyaW5nIH0pOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgdHlwZSA9IGFyZ3MudHlwZS50b0xvd2VyQ2FzZSgpO1xuICBjb25zdCBwbGF5ID0gKGFyZ3MucGxheSB8fCAndHJ1ZScpLnRvTG93ZXJDYXNlKCk7XG5cbiAgaWYgKCF0eXBlKSB7XG4gICAgbG9nLndhcm4oJ1dBUk46IE1pc3NpbmcgYXJndW1lbnRzIGZvciAvYXVkaW9wbGF5cGF1c2UgY29tbWFuZCcpO1xuICAgIHJldHVybiAnJztcbiAgfVxuXG4gIGlmICh0eXBlID09PSAnYmdtJykge1xuICAgIGlmIChwbGF5ID09PSAndHJ1ZScpIHtcbiAgICAgIGF3YWl0IHBsYXlBdWRpbygnYmdtJyk7XG4gICAgfSBlbHNlIGlmIChwbGF5ID09PSAnZmFsc2UnKSB7XG4gICAgICBjb25zdCBhdWRpb0VsZW1lbnQgPSAkKCcjYXVkaW9fYmdtJylbMF0gYXMgQXVkaW9FbGVtZW50O1xuICAgICAgYXVkaW9FbGVtZW50LnBhdXNlKCk7XG4gICAgfVxuICB9IGVsc2UgaWYgKHR5cGUgPT09ICdhbWJpZW50Jykge1xuICAgIGlmIChwbGF5ID09PSAndHJ1ZScpIHtcbiAgICAgIGF3YWl0IHBsYXlBdWRpbygnYW1iaWVudCcpO1xuICAgIH0gZWxzZSBpZiAocGxheSA9PT0gJ2ZhbHNlJykge1xuICAgICAgY29uc3QgYXVkaW9FbGVtZW50ID0gJCgnI2F1ZGlvX2FtYmllbnQnKVswXSBhcyBBdWRpb0VsZW1lbnQ7XG4gICAgICBhdWRpb0VsZW1lbnQucGF1c2UoKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gJyc7XG59XG5cbi8qKlxuICog5a+85YWl6Z+z6aKR6ZO+5o6lXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhdWRpb0ltcG9ydChhcmdzOiB7IHR5cGU6IHN0cmluZzsgcGxheT86IHN0cmluZyB9LCB1cmw6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCB0eXBlID0gYXJncy50eXBlLnRvTG93ZXJDYXNlKCk7XG4gIGNvbnN0IHBsYXkgPSAoYXJncy5wbGF5IHx8ICd0cnVlJykudG9Mb3dlckNhc2UoKTtcblxuICBpZiAoIXR5cGUgfHwgIXVybCkge1xuICAgIGxvZy53YXJuKCdXQVJOOiBNaXNzaW5nIGFyZ3VtZW50cyBmb3IgL2F1ZGlvaW1wb3J0IGNvbW1hbmQnKTtcbiAgICByZXR1cm4gJyc7XG4gIH1cblxuICBjb25zdCB1cmxBcnJheSA9IHVybFxuICAgIC5zcGxpdCgnLCcpXG4gICAgLm1hcCgodXJsOiBzdHJpbmcpID0+IHVybC50cmltKCkpXG4gICAgLmZpbHRlcigodXJsOiBzdHJpbmcpID0+IHVybCAhPT0gJycpXG4gICAgLmZpbHRlcigodXJsOiBzdHJpbmcsIGluZGV4OiBudW1iZXIsIHNlbGY6IHN0cmluZ1tdKSA9PiBzZWxmLmluZGV4T2YodXJsKSA9PT0gaW5kZXgpO1xuICBpZiAodXJsQXJyYXkubGVuZ3RoID09PSAwKSB7XG4gICAgbG9nLndhcm4oJ1dBUk46IEludmFsaWQgb3IgZW1wdHkgVVJMcyBwcm92aWRlZC4nKTtcbiAgICByZXR1cm4gJyc7XG4gIH1cblxuICBpZiAoIWNoYXRfbWV0YWRhdGEudmFyaWFibGVzKSB7XG4gICAgY2hhdF9tZXRhZGF0YS52YXJpYWJsZXMgPSB7fTtcbiAgfVxuXG4gIGNvbnN0IHR5cGVLZXkgPSB0eXBlID09PSAnYmdtJyA/ICdiZ211cmwnIDogJ2FtYmllbnR1cmwnO1xuICBjb25zdCBleGlzdGluZ1VybHMgPSBjaGF0X21ldGFkYXRhLnZhcmlhYmxlc1t0eXBlS2V5XSB8fCBbXTtcbiAgY29uc3QgbWVyZ2VkVXJscyA9IFsuLi5uZXcgU2V0KFsuLi51cmxBcnJheSwgLi4uZXhpc3RpbmdVcmxzXSldO1xuXG4gIGNoYXRfbWV0YWRhdGEudmFyaWFibGVzW3R5cGVLZXldID0gbWVyZ2VkVXJscztcbiAgc2F2ZU1ldGFkYXRhRGVib3VuY2VkKCk7XG5cbiAgaWYgKHR5cGUgPT09ICdiZ20nKSB7XG4gICAgdXBkYXRlQXVkaW9TZWxlY3QoJ2JnbScpO1xuICB9IGVsc2UgaWYgKHR5cGUgPT09ICdhbWJpZW50Jykge1xuICAgIHVwZGF0ZUF1ZGlvU2VsZWN0KCdhbWJpZW50Jyk7XG4gIH1cblxuICBpZiAocGxheSA9PT0gJ3RydWUnICYmIHVybEFycmF5WzBdKSB7XG4gICAgY29uc3Qgc2VsZWN0ZWRVcmwgPSB1cmxBcnJheVswXTtcbiAgICBpZiAodHlwZSA9PT0gJ2JnbScpIHtcbiAgICAgIHNhdmVTZXR0aW5nVmFsdWUoJ2F1ZGlvLmJnbV9zZWxlY3RlZCcsIHNlbGVjdGVkVXJsKTtcbiAgICAgIGF3YWl0IHVwZGF0ZUF1ZGlvKCdiZ20nLCB0cnVlKTtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdhbWJpZW50Jykge1xuICAgICAgc2F2ZVNldHRpbmdWYWx1ZSgnYXVkaW8uYW1iaWVudF9zZWxlY3RlZCcsIHNlbGVjdGVkVXJsKTtcbiAgICAgIGF3YWl0IHVwZGF0ZUF1ZGlvKCdhbWJpZW50JywgdHJ1ZSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuICcnO1xufVxuXG4vKipcbiAqIOmAieaLqeW5tuaSreaUvumfs+mikVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXVkaW9TZWxlY3QoYXJnczogeyB0eXBlOiBzdHJpbmcgfSwgdXJsOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgdHlwZSA9IGFyZ3MudHlwZS50b0xvd2VyQ2FzZSgpO1xuXG4gIGlmICghdXJsKSB7XG4gICAgbG9nLndhcm4oJ1dBUk46IE1pc3NpbmcgVVJMIGZvciAvYXVkaW9zZWxlY3QgY29tbWFuZCcpO1xuICAgIHJldHVybiAnJztcbiAgfVxuXG4gIGlmICghY2hhdF9tZXRhZGF0YS52YXJpYWJsZXMpIHtcbiAgICBjaGF0X21ldGFkYXRhLnZhcmlhYmxlcyA9IHt9O1xuICB9XG5cbiAgY29uc3QgcGxheWxpc3QgPSB0eXBlID09PSAnYmdtJyA/IGxpc3RfQkdNUyA6IGxpc3RfYW1iaWVudHM7XG4gIGNvbnN0IHR5cGVLZXkgPSB0eXBlID09PSAnYmdtJyA/ICdiZ211cmwnIDogJ2FtYmllbnR1cmwnO1xuXG4gIGlmIChwbGF5bGlzdCAmJiBwbGF5bGlzdC5pbmNsdWRlcyh1cmwpKSB7XG4gICAgaWYgKHR5cGUgPT09ICdiZ20nKSB7XG4gICAgICBzYXZlU2V0dGluZ1ZhbHVlKCdhdWRpby5iZ21fc2VsZWN0ZWQnLCB1cmwpO1xuICAgICAgYXdhaXQgdXBkYXRlQXVkaW8oJ2JnbScsIHRydWUpO1xuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ2FtYmllbnQnKSB7XG4gICAgICBzYXZlU2V0dGluZ1ZhbHVlKCdhdWRpby5hbWJpZW50X3NlbGVjdGVkJywgdXJsKTtcbiAgICAgIGF3YWl0IHVwZGF0ZUF1ZGlvKCdhbWJpZW50JywgdHJ1ZSk7XG4gICAgfVxuICAgIHJldHVybiAnJztcbiAgfVxuXG4gIGNvbnN0IGV4aXN0aW5nVXJscyA9IGNoYXRfbWV0YWRhdGEudmFyaWFibGVzW3R5cGVLZXldIHx8IFtdO1xuXG4gIGNvbnN0IG1lcmdlZFVybHMgPSBbLi4ubmV3IFNldChbdXJsLCAuLi5leGlzdGluZ1VybHNdKV07XG4gIGNoYXRfbWV0YWRhdGEudmFyaWFibGVzW3R5cGVLZXldID0gbWVyZ2VkVXJscztcbiAgc2F2ZU1ldGFkYXRhRGVib3VuY2VkKCk7XG5cbiAgaWYgKHR5cGUgPT09ICdiZ20nKSB7XG4gICAgdXBkYXRlQXVkaW9TZWxlY3QoJ2JnbScpO1xuICAgIHNhdmVTZXR0aW5nVmFsdWUoJ2F1ZGlvLmJnbV9zZWxlY3RlZCcsIHVybCk7XG4gICAgYXdhaXQgdXBkYXRlQXVkaW8oJ2JnbScsIHRydWUpO1xuICB9IGVsc2UgaWYgKHR5cGUgPT09ICdhbWJpZW50Jykge1xuICAgIHVwZGF0ZUF1ZGlvU2VsZWN0KCdhbWJpZW50Jyk7XG4gICAgc2F2ZVNldHRpbmdWYWx1ZSgnYXVkaW8uYW1iaWVudF9zZWxlY3RlZCcsIHVybCk7XG4gICAgYXdhaXQgdXBkYXRlQXVkaW8oJ2FtYmllbnQnLCB0cnVlKTtcbiAgfVxuXG4gIHJldHVybiAnJztcbn1cblxuLyoqXG4gKiDliJ3lp4vljJbpn7PpopHnm7jlhbPnmoQgc2xhc2ggY29tbWFuZFxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5pdEF1ZGlvU2xhc2hDb21tYW5kcygpIHtcbiAgLy8g5rOo5YaMIGF1ZGlvc2VsZWN0IOWRveS7pFxuICBTbGFzaENvbW1hbmRQYXJzZXIuYWRkQ29tbWFuZE9iamVjdChcbiAgICBTbGFzaENvbW1hbmQuZnJvbVByb3BzKHtcbiAgICAgIG5hbWU6ICdhdWRpb3NlbGVjdCcsXG4gICAgICBjYWxsYmFjazogYXVkaW9TZWxlY3QsXG4gICAgICBuYW1lZEFyZ3VtZW50TGlzdDogW1xuICAgICAgICBTbGFzaENvbW1hbmROYW1lZEFyZ3VtZW50LmZyb21Qcm9wcyh7XG4gICAgICAgICAgbmFtZTogJ3R5cGUnLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAn6YCJ5oup5pKt5pS+5Zmo57G75Z6LIChiZ20g5oiWIGFtYmllbnQpJyxcbiAgICAgICAgICB0eXBlTGlzdDogW0FSR1VNRU5UX1RZUEUuU1RSSU5HXSxcbiAgICAgICAgICBlbnVtTGlzdDogW1xuICAgICAgICAgICAgbmV3IFNsYXNoQ29tbWFuZEVudW1WYWx1ZSgnYmdtJywgbnVsbCwgZW51bVR5cGVzLmVudW0sIGVudW1JY29ucy5maWxlKSxcbiAgICAgICAgICAgIG5ldyBTbGFzaENvbW1hbmRFbnVtVmFsdWUoJ2FtYmllbnQnLCBudWxsLCBlbnVtVHlwZXMuZW51bSwgZW51bUljb25zLmZpbGUpLFxuICAgICAgICAgIF0sXG4gICAgICAgICAgaXNSZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgfSksXG4gICAgICBdLFxuICAgICAgdW5uYW1lZEFyZ3VtZW50TGlzdDogW25ldyBTbGFzaENvbW1hbmRBcmd1bWVudCgndXJsJywgW0FSR1VNRU5UX1RZUEUuU1RSSU5HXSwgdHJ1ZSldLFxuICAgICAgaGVscFN0cmluZzogYFxuICAgICAgICA8ZGl2PlxuICAgICAgICAgICAg6YCJ5oup5bm25pKt5pS+6Z+z6aKR44CC5aaC5p6c6Z+z6aKR6ZO+5o6l5LiN5a2Y5Zyo77yM5YiZ5YWI5a+85YWl5YaN5pKt5pS+44CCXG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgPHN0cm9uZz5FeGFtcGxlOjwvc3Ryb25nPlxuICAgICAgICAgICAgPHVsPlxuICAgICAgICAgICAgICAgIDxsaT5cbiAgICAgICAgICAgICAgICAgICAgPHByZT48Y29kZT4vYXVkaW9zZWxlY3QgdHlwZT1iZ20gaHR0cHM6Ly9leGFtcGxlLmNvbS9zb25nLm1wMzwvY29kZT48L3ByZT5cbiAgICAgICAgICAgICAgICAgICAg6YCJ5oup5bm25pKt5pS+5oyH5a6a55qE6Z+z5LmQ44CCXG4gICAgICAgICAgICAgICAgPC9saT5cbiAgICAgICAgICAgICAgICA8bGk+XG4gICAgICAgICAgICAgICAgICAgIDxwcmU+PGNvZGU+L2F1ZGlvc2VsZWN0IHR5cGU9YW1iaWVudCBodHRwczovL2V4YW1wbGUuY29tL3NvdW5kLm1wMzwvY29kZT48L3ByZT5cbiAgICAgICAgICAgICAgICAgICAg6YCJ5oup5bm25pKt5pS+5oyH5a6a55qE6Z+z5pWI44CCXG4gICAgICAgICAgICAgICAgPC9saT5cbiAgICAgICAgICAgIDwvdWw+XG4gICAgICAgIDwvZGl2PlxuICAgICAgYCxcbiAgICB9KSxcbiAgKTtcblxuICAvLyDms6jlhowgYXVkaW9pbXBvcnQg5ZG95LukXG4gIFNsYXNoQ29tbWFuZFBhcnNlci5hZGRDb21tYW5kT2JqZWN0KFxuICAgIFNsYXNoQ29tbWFuZC5mcm9tUHJvcHMoe1xuICAgICAgbmFtZTogJ2F1ZGlvaW1wb3J0JyxcbiAgICAgIGNhbGxiYWNrOiBhdWRpb0ltcG9ydCxcbiAgICAgIG5hbWVkQXJndW1lbnRMaXN0OiBbXG4gICAgICAgIFNsYXNoQ29tbWFuZE5hbWVkQXJndW1lbnQuZnJvbVByb3BzKHtcbiAgICAgICAgICBuYW1lOiAndHlwZScsXG4gICAgICAgICAgZGVzY3JpcHRpb246ICfpgInmi6nlr7zlhaXnsbvlnosgKGJnbSDmiJYgYW1iaWVudCknLFxuICAgICAgICAgIHR5cGVMaXN0OiBbQVJHVU1FTlRfVFlQRS5TVFJJTkddLFxuICAgICAgICAgIGVudW1MaXN0OiBbXG4gICAgICAgICAgICBuZXcgU2xhc2hDb21tYW5kRW51bVZhbHVlKCdiZ20nLCBudWxsLCBlbnVtVHlwZXMuZW51bSwgZW51bUljb25zLmZpbGUpLFxuICAgICAgICAgICAgbmV3IFNsYXNoQ29tbWFuZEVudW1WYWx1ZSgnYW1iaWVudCcsIG51bGwsIGVudW1UeXBlcy5lbnVtLCBlbnVtSWNvbnMuZmlsZSksXG4gICAgICAgICAgXSxcbiAgICAgICAgICBpc1JlcXVpcmVkOiB0cnVlLFxuICAgICAgICB9KSxcbiAgICAgICAgU2xhc2hDb21tYW5kTmFtZWRBcmd1bWVudC5mcm9tUHJvcHMoe1xuICAgICAgICAgIG5hbWU6ICdwbGF5JyxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogJ+WvvOWFpeWQjuaYr+WQpueri+WNs+aSreaUvuesrOS4gOS4qumTvuaOpScsXG4gICAgICAgICAgdHlwZUxpc3Q6IFtBUkdVTUVOVF9UWVBFLkJPT0xFQU5dLFxuICAgICAgICAgIGRlZmF1bHRWYWx1ZTogJ3RydWUnLFxuICAgICAgICAgIGlzUmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICB9KSxcbiAgICAgIF0sXG4gICAgICB1bm5hbWVkQXJndW1lbnRMaXN0OiBbbmV3IFNsYXNoQ29tbWFuZEFyZ3VtZW50KCd1cmwnLCBbQVJHVU1FTlRfVFlQRS5TVFJJTkddLCB0cnVlKV0sXG4gICAgICBoZWxwU3RyaW5nOiBgXG4gICAgICAgIDxkaXY+XG4gICAgICAgICAgICDlr7zlhaXpn7PpopHmiJbpn7PkuZDpk77mjqXvvIzlubblhrPlrprmmK/lkKbnq4vljbPmkq3mlL7vvIzpu5jorqTkuLroh6rliqjmkq3mlL7jgILlj6/mibnph4/lr7zlhaXpk77mjqXvvIzkvb/nlKjoi7HmlofpgJflj7fliIbpmpTjgIJcbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXY+XG4gICAgICAgICAgICA8c3Ryb25nPkV4YW1wbGU6PC9zdHJvbmc+XG4gICAgICAgICAgICA8dWw+XG4gICAgICAgICAgICAgICAgPGxpPlxuICAgICAgICAgICAgICAgICAgICA8cHJlPjxjb2RlPi9hdWRpb2ltcG9ydCB0eXBlPWJnbSBodHRwczovL2V4YW1wbGUuY29tL3NvbmcxLm1wMyxodHRwczovL2V4YW1wbGUuY29tL3NvbmcyLm1wMzwvY29kZT48L3ByZT5cbiAgICAgICAgICAgICAgICAgICAg5a+85YWlIEJHTSDpn7PkuZDlubbnq4vljbPmkq3mlL7nrKzkuIDkuKrpk77mjqXjgIJcbiAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgICAgIDxsaT5cbiAgICAgICAgICAgICAgICAgICAgPHByZT48Y29kZT4vYXVkaW9pbXBvcnQgdHlwZT1hbWJpZW50IHBsYXk9ZmFsc2UgdXJsPWh0dHBzOi8vZXhhbXBsZS5jb20vc291bmQxLm1wMyxodHRwczovL2V4YW1wbGUuY29tL3NvdW5kMi5tcDMgPC9jb2RlPjwvcHJlPlxuICAgICAgICAgICAgICAgICAgICDlr7zlhaXpn7PmlYjpk77mjqUgKOS4jeiHquWKqOaSreaUvinjgIJcbiAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgPC91bD5cbiAgICAgICAgPC9kaXY+XG4gICAgICBgLFxuICAgIH0pLFxuICApO1xuXG4gIC8vIOazqOWGjCBhdWRpb3BsYXkg5ZG95LukXG4gIFNsYXNoQ29tbWFuZFBhcnNlci5hZGRDb21tYW5kT2JqZWN0KFxuICAgIFNsYXNoQ29tbWFuZC5mcm9tUHJvcHMoe1xuICAgICAgbmFtZTogJ2F1ZGlvcGxheScsXG4gICAgICBjYWxsYmFjazogYXVkaW9QbGF5LFxuICAgICAgbmFtZWRBcmd1bWVudExpc3Q6IFtcbiAgICAgICAgU2xhc2hDb21tYW5kTmFtZWRBcmd1bWVudC5mcm9tUHJvcHMoe1xuICAgICAgICAgIG5hbWU6ICd0eXBlJyxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogJ+mAieaLqeaOp+WItueahOaSreaUvuWZqCAoYmdtIOaIliBhbWJpZW50KScsXG4gICAgICAgICAgdHlwZUxpc3Q6IFtBUkdVTUVOVF9UWVBFLlNUUklOR10sXG4gICAgICAgICAgZW51bUxpc3Q6IFtcbiAgICAgICAgICAgIG5ldyBTbGFzaENvbW1hbmRFbnVtVmFsdWUoJ2JnbScsIG51bGwsIGVudW1UeXBlcy5lbnVtLCBlbnVtSWNvbnMuZmlsZSksXG4gICAgICAgICAgICBuZXcgU2xhc2hDb21tYW5kRW51bVZhbHVlKCdhbWJpZW50JywgbnVsbCwgZW51bVR5cGVzLmVudW0sIGVudW1JY29ucy5maWxlKSxcbiAgICAgICAgICBdLFxuICAgICAgICAgIGlzUmVxdWlyZWQ6IHRydWUsXG4gICAgICAgIH0pLFxuICAgICAgICBuZXcgU2xhc2hDb21tYW5kTmFtZWRBcmd1bWVudChcbiAgICAgICAgICAncGxheScsXG4gICAgICAgICAgJ+aSreaUvuaIluaaguWBnCcsXG4gICAgICAgICAgW0FSR1VNRU5UX1RZUEUuU1RSSU5HXSxcbiAgICAgICAgICB0cnVlLFxuICAgICAgICAgIGZhbHNlLFxuICAgICAgICAgICd0cnVlJyxcbiAgICAgICAgICBjb21tb25FbnVtUHJvdmlkZXJzLmJvb2xlYW4oJ3RydWVGYWxzZScpKCksXG4gICAgICAgICksXG4gICAgICBdLFxuICAgICAgaGVscFN0cmluZzogYFxuICAgICAgICA8ZGl2PlxuICAgICAgICAgICAg5o6n5Yi26Z+z5LmQ5pKt5pS+5Zmo5oiW6Z+z5pWI5pKt5pS+5Zmo55qE5pKt5pS+5LiO5pqC5YGc44CCXG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgPHN0cm9uZz5FeGFtcGxlOjwvc3Ryb25nPlxuICAgICAgICAgICAgPHVsPlxuICAgICAgICAgICAgICAgIDxsaT5cbiAgICAgICAgICAgICAgICAgICAgPHByZT48Y29kZT4vYXVkaW9wbGF5IHR5cGU9YmdtPC9jb2RlPjwvcHJlPlxuICAgICAgICAgICAgICAgICAgICDmkq3mlL7lvZPliY3pn7PkuZDjgIJcbiAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgICAgIDxsaT5cbiAgICAgICAgICAgICAgICAgICAgPHByZT48Y29kZT4vYXVkaW9wbGF5IHR5cGU9YW1iaWVudCBwbGF5PWZhbHNlPC9jb2RlPjwvcHJlPlxuICAgICAgICAgICAgICAgICAgICDmmoLlgZzlvZPliY3pn7PmlYjjgIJcbiAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgPC91bD5cbiAgICAgICAgPC9kaXY+XG4gICAgICBgLFxuICAgIH0pLFxuICApO1xuXG4gIC8vIOazqOWGjCBhdWRpb2VuYWJsZSDlkb3ku6RcbiAgU2xhc2hDb21tYW5kUGFyc2VyLmFkZENvbW1hbmRPYmplY3QoXG4gICAgU2xhc2hDb21tYW5kLmZyb21Qcm9wcyh7XG4gICAgICBuYW1lOiAnYXVkaW9lbmFibGUnLFxuICAgICAgY2FsbGJhY2s6IGF1ZGlvRW5hYmxlLFxuICAgICAgbmFtZWRBcmd1bWVudExpc3Q6IFtcbiAgICAgICAgU2xhc2hDb21tYW5kTmFtZWRBcmd1bWVudC5mcm9tUHJvcHMoe1xuICAgICAgICAgIG5hbWU6ICd0eXBlJyxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogJ+mAieaLqeaOp+WItueahOaSreaUvuWZqCAoYmdtIOaIliBhbWJpZW50KScsXG4gICAgICAgICAgdHlwZUxpc3Q6IFtBUkdVTUVOVF9UWVBFLlNUUklOR10sXG4gICAgICAgICAgZW51bUxpc3Q6IFtcbiAgICAgICAgICAgIG5ldyBTbGFzaENvbW1hbmRFbnVtVmFsdWUoJ2JnbScsIG51bGwsIGVudW1UeXBlcy5lbnVtLCBlbnVtSWNvbnMuZmlsZSksXG4gICAgICAgICAgICBuZXcgU2xhc2hDb21tYW5kRW51bVZhbHVlKCdhbWJpZW50JywgbnVsbCwgZW51bVR5cGVzLmVudW0sIGVudW1JY29ucy5maWxlKSxcbiAgICAgICAgICBdLFxuICAgICAgICAgIGlzUmVxdWlyZWQ6IHRydWUsXG4gICAgICAgIH0pLFxuICAgICAgICBuZXcgU2xhc2hDb21tYW5kTmFtZWRBcmd1bWVudChcbiAgICAgICAgICAnc3RhdGUnLFxuICAgICAgICAgICfmiZPlvIDmiJblhbPpl63mkq3mlL7lmagnLFxuICAgICAgICAgIFtBUkdVTUVOVF9UWVBFLlNUUklOR10sXG4gICAgICAgICAgZmFsc2UsXG4gICAgICAgICAgZmFsc2UsXG4gICAgICAgICAgJ3RydWUnLFxuICAgICAgICAgIGNvbW1vbkVudW1Qcm92aWRlcnMuYm9vbGVhbigndHJ1ZUZhbHNlJykoKSxcbiAgICAgICAgKSxcbiAgICAgIF0sXG4gICAgICBoZWxwU3RyaW5nOiBgXG4gICAgICAgIDxkaXY+XG4gICAgICAgICAgICDmjqfliLbpn7PkuZDmkq3mlL7lmajmiJbpn7PmlYjmkq3mlL7lmajnmoTlvIDlkK/kuI7lhbPpl63jgIJcbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXY+XG4gICAgICAgICAgICA8c3Ryb25nPkV4YW1wbGU6PC9zdHJvbmc+XG4gICAgICAgICAgICA8dWw+XG4gICAgICAgICAgICAgICAgPGxpPlxuICAgICAgICAgICAgICAgICAgICA8cHJlPjxjb2RlPi9hdWRpb2VuYWJsZSB0eXBlPWJnbSBzdGF0ZT10cnVlPC9jb2RlPjwvcHJlPlxuICAgICAgICAgICAgICAgICAgICDmiZPlvIDpn7PkuZDmkq3mlL7lmajjgIJcbiAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgICAgIDxsaT5cbiAgICAgICAgICAgICAgICAgICAgPHByZT48Y29kZT4vYXVkaW9lbmFibGUgdHlwZT1hbWJpZW50IHN0YXRlPWZhbHNlPC9jb2RlPjwvcHJlPlxuICAgICAgICAgICAgICAgICAgICDlhbPpl63pn7PmlYjmkq3mlL7lmajjgIJcbiAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgPC91bD5cbiAgICAgICAgPC9kaXY+XG4gICAgYCxcbiAgICB9KSxcbiAgKTtcblxuICAvLyDms6jlhowgYXVkaW9tb2RlIOWRveS7pFxuICBTbGFzaENvbW1hbmRQYXJzZXIuYWRkQ29tbWFuZE9iamVjdChcbiAgICBTbGFzaENvbW1hbmQuZnJvbVByb3BzKHtcbiAgICAgIG5hbWU6ICdhdWRpb21vZGUnLFxuICAgICAgY2FsbGJhY2s6IGF1ZGlvTW9kZSxcbiAgICAgIG5hbWVkQXJndW1lbnRMaXN0OiBbXG4gICAgICAgIFNsYXNoQ29tbWFuZE5hbWVkQXJndW1lbnQuZnJvbVByb3BzKHtcbiAgICAgICAgICBuYW1lOiAndHlwZScsXG4gICAgICAgICAgZGVzY3JpcHRpb246ICfpgInmi6nmjqfliLbnmoTmkq3mlL7lmaggKGJnbSDmiJYgYW1iaWVudCknLFxuICAgICAgICAgIHR5cGVMaXN0OiBbQVJHVU1FTlRfVFlQRS5TVFJJTkddLFxuICAgICAgICAgIGVudW1MaXN0OiBbXG4gICAgICAgICAgICBuZXcgU2xhc2hDb21tYW5kRW51bVZhbHVlKCdiZ20nLCBudWxsLCBlbnVtVHlwZXMuZW51bSwgZW51bUljb25zLmZpbGUpLFxuICAgICAgICAgICAgbmV3IFNsYXNoQ29tbWFuZEVudW1WYWx1ZSgnYW1iaWVudCcsIG51bGwsIGVudW1UeXBlcy5lbnVtLCBlbnVtSWNvbnMuZmlsZSksXG4gICAgICAgICAgXSxcbiAgICAgICAgICBpc1JlcXVpcmVkOiB0cnVlLFxuICAgICAgICB9KSxcbiAgICAgICAgU2xhc2hDb21tYW5kTmFtZWRBcmd1bWVudC5mcm9tUHJvcHMoe1xuICAgICAgICAgIG5hbWU6ICdtb2RlJyxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogJ+mAieaLqeaSreaUvuaooeW8jycsXG4gICAgICAgICAgdHlwZUxpc3Q6IFtBUkdVTUVOVF9UWVBFLlNUUklOR10sXG4gICAgICAgICAgZW51bUxpc3Q6IFtcbiAgICAgICAgICAgIG5ldyBTbGFzaENvbW1hbmRFbnVtVmFsdWUoJ3JlcGVhdCcsIG51bGwsIGVudW1UeXBlcy5lbnVtLCBlbnVtSWNvbnMubG9vcCksXG4gICAgICAgICAgICBuZXcgU2xhc2hDb21tYW5kRW51bVZhbHVlKCdyYW5kb20nLCBudWxsLCBlbnVtVHlwZXMuZW51bSwgZW51bUljb25zLnNodWZmbGUpLFxuICAgICAgICAgICAgbmV3IFNsYXNoQ29tbWFuZEVudW1WYWx1ZSgnc2luZ2xlJywgbnVsbCwgZW51bVR5cGVzLmVudW0sIGVudW1JY29ucy5yZWRvKSxcbiAgICAgICAgICAgIG5ldyBTbGFzaENvbW1hbmRFbnVtVmFsdWUoJ3N0b3AnLCBudWxsLCBlbnVtVHlwZXMuZW51bSwgZW51bUljb25zLnN0b3ApLFxuICAgICAgICAgIF0sXG4gICAgICAgICAgaXNSZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgfSksXG4gICAgICBdLFxuICAgICAgaGVscFN0cmluZzogYFxuICAgICAgICA8ZGl2PlxuICAgICAgICAgICAg6K6+572u6Z+z6aKR5pKt5pS+5qih5byP44CCXG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgPHN0cm9uZz5FeGFtcGxlOjwvc3Ryb25nPlxuICAgICAgICAgICAgPHVsPlxuICAgICAgICAgICAgICAgIDxsaT5cbiAgICAgICAgICAgICAgICAgICAgPHByZT48Y29kZT4vYXVkaW9tb2RlIHR5cGU9YmdtIG1vZGU9cmVwZWF0PC9jb2RlPjwvcHJlPlxuICAgICAgICAgICAgICAgICAgICDorr7nva7pn7PkuZDkuLrlvqrnjq/mkq3mlL7mqKHlvI/jgIJcbiAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgICAgIDxsaT5cbiAgICAgICAgICAgICAgICAgICAgPHByZT48Y29kZT4vYXVkaW9tb2RlIHR5cGU9YW1iaWVudCBtb2RlPXJhbmRvbTwvY29kZT48L3ByZT5cbiAgICAgICAgICAgICAgICAgICAg6K6+572u6Z+z5pWI5Li66ZqP5py65pKt5pS+5qih5byP44CCXG4gICAgICAgICAgICAgICAgPC9saT5cbiAgICAgICAgICAgICAgICA8bGk+XG4gICAgICAgICAgICAgICAgICAgIDxwcmU+PGNvZGU+L2F1ZGlvbW9kZSB0eXBlPWJnbSBtb2RlPXNpbmdsZTwvY29kZT48L3ByZT5cbiAgICAgICAgICAgICAgICAgICAg6K6+572u6Z+z5LmQ5Li65Y2V5puy5b6q546v5qih5byP44CCXG4gICAgICAgICAgICAgICAgPC9saT5cbiAgICAgICAgICAgICAgICA8bGk+XG4gICAgICAgICAgICAgICAgICAgIDxwcmU+PGNvZGU+L2F1ZGlvbW9kZSB0eXBlPWFtYmllbnQgbW9kZT1zdG9wPC9jb2RlPjwvcHJlPlxuICAgICAgICAgICAgICAgICAgICDorr7nva7pn7PmlYjkuLrlgZzmraLmkq3mlL7mqKHlvI/jgIJcbiAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgPC91bD5cbiAgICAgICAgPC9kaXY+XG4gICAgYCxcbiAgICB9KSxcbiAgKTtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/slash_command/audio.ts\n")},"./src/slash_command/event.ts":
/*!************************************!*\
  !*** ./src/slash_command/event.ts ***!
  \************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   initSlashEventEmit: () => (/* binding */ initSlashEventEmit),\n/* harmony export */   slashEventEmit: () => (/* binding */ slashEventEmit)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ "@sillytavern/script");\n/* harmony import */ var _sillytavern_scripts_slash_commands_SlashCommand__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/slash-commands/SlashCommand */ "@sillytavern/scripts/slash-commands/SlashCommand");\n/* harmony import */ var _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/scripts/slash-commands/SlashCommandArgument */ "@sillytavern/scripts/slash-commands/SlashCommandArgument");\n/* harmony import */ var _sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/scripts/slash-commands/SlashCommandParser */ "@sillytavern/scripts/slash-commands/SlashCommandParser");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! loglevel */ "./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_4__);\n\n\n\n\n\nasync function slashEventEmit(named_args) {\n    const event = named_args.event;\n    const data = named_args.data ?? [];\n    _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.eventSource.emit(event, ...data);\n    loglevel__WEBPACK_IMPORTED_MODULE_4___default().info(`[Event][/event-emit] 发送 \'${event}\' 事件, 携带数据: ${JSON.stringify(data)}`);\n    return event;\n}\nfunction initSlashEventEmit() {\n    _sillytavern_scripts_slash_commands_SlashCommandParser__WEBPACK_IMPORTED_MODULE_3__.SlashCommandParser.addCommandObject(_sillytavern_scripts_slash_commands_SlashCommand__WEBPACK_IMPORTED_MODULE_1__.SlashCommand.fromProps({\n        name: \'event-emit\',\n        callback: slashEventEmit,\n        returns: \'发送的事件名称\',\n        namedArgumentList: [\n            _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_2__.SlashCommandNamedArgument.fromProps({\n                name: \'event\',\n                description: \'事件名称\',\n                typeList: [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_2__.ARGUMENT_TYPE.STRING],\n                isRequired: true,\n            }),\n            _sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_2__.SlashCommandNamedArgument.fromProps({\n                name: \'data\',\n                description: \'要传输的数据\',\n                typeList: [_sillytavern_scripts_slash_commands_SlashCommandArgument__WEBPACK_IMPORTED_MODULE_2__.ARGUMENT_TYPE.STRING],\n                isRequired: false,\n                acceptsMultiple: true,\n            }),\n        ],\n        unnamedArgumentList: [],\n        helpString: `\n    <div>\n        发送 \\`event\\` 事件, 同时可以发送一些数据.\n        所有正在监听该消息频道的 listener 函数都会自动运行, 并能用函数参数接收发送来的数据.\n        由于酒馆 STScript 输入方式的局限性, 所有数据将会以字符串 string 类型接收; 如果需要 number 等类型, 请自行转换.\n    </div>\n    <div>\n        <strong>Example:</strong>\n        <ul>\n            <li>\n                <pre><code class="language-stscript">/event-emit event="读档"</code></pre>\n            </li>\n            <li>\n                <pre><code class="language-stscript">/event-emit event="存档" data={{getvar::数据}} data=8 data=你好 {{user}}</code></pre>\n            </li>\n            <li>\n                <pre><code class="language-stscript">/event-emit event="随便什么名称" data="这是一个 数据" data={{user}}</code></pre>\n            </li>\n        </ul>\n    </div>\n  `,\n    }));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvc2xhc2hfY29tbWFuZC9ldmVudC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFrRDtBQUM4QjtBQUNvQztBQUN4QjtBQUVqRTtBQUVwQixLQUFLLFVBQVUsY0FBYyxDQUFDLFVBQWU7SUFDbEQsTUFBTSxLQUFLLEdBQVcsVUFBVSxDQUFDLEtBQUssQ0FBQztJQUN2QyxNQUFNLElBQUksR0FBYSxVQUFVLENBQUMsSUFBSSxJQUFJLEVBQUUsQ0FBQztJQUU3Qyw0REFBVyxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUUsR0FBRyxJQUFJLENBQUMsQ0FBQztJQUVqQyxvREFBUSxDQUFDLDRCQUE0QixLQUFLLGVBQWUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7SUFFakYsT0FBTyxLQUFLLENBQUM7QUFDZixDQUFDO0FBRU0sU0FBUyxrQkFBa0I7SUFDaEMsc0dBQWtCLENBQUMsZ0JBQWdCLENBQ2pDLDBGQUFZLENBQUMsU0FBUyxDQUFDO1FBQ3JCLElBQUksRUFBRSxZQUFZO1FBQ2xCLFFBQVEsRUFBRSxjQUFjO1FBQ3hCLE9BQU8sRUFBRSxTQUFTO1FBQ2xCLGlCQUFpQixFQUFFO1lBQ2pCLCtHQUF5QixDQUFDLFNBQVMsQ0FBQztnQkFDbEMsSUFBSSxFQUFFLE9BQU87Z0JBQ2IsV0FBVyxFQUFFLE1BQU07Z0JBQ25CLFFBQVEsRUFBRSxDQUFDLG1HQUFhLENBQUMsTUFBTSxDQUFDO2dCQUNoQyxVQUFVLEVBQUUsSUFBSTthQUNqQixDQUFDO1lBQ0YsK0dBQXlCLENBQUMsU0FBUyxDQUFDO2dCQUNsQyxJQUFJLEVBQUUsTUFBTTtnQkFDWixXQUFXLEVBQUUsUUFBUTtnQkFDckIsUUFBUSxFQUFFLENBQUMsbUdBQWEsQ0FBQyxNQUFNLENBQUM7Z0JBQ2hDLFVBQVUsRUFBRSxLQUFLO2dCQUNqQixlQUFlLEVBQUUsSUFBSTthQUN0QixDQUFDO1NBQ0g7UUFDRCxtQkFBbUIsRUFBRSxFQUFFO1FBQ3ZCLFVBQVUsRUFBRTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7R0FvQmY7S0FDRSxDQUFDLENBQ0gsQ0FBQztBQUNKLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvc2xhc2hfY29tbWFuZC9ldmVudC50cz9mNmU3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGV2ZW50U291cmNlIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5pbXBvcnQgeyBTbGFzaENvbW1hbmQgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0cy9zbGFzaC1jb21tYW5kcy9TbGFzaENvbW1hbmQnO1xuaW1wb3J0IHsgQVJHVU1FTlRfVFlQRSwgU2xhc2hDb21tYW5kTmFtZWRBcmd1bWVudCB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3NsYXNoLWNvbW1hbmRzL1NsYXNoQ29tbWFuZEFyZ3VtZW50JztcbmltcG9ydCB7IFNsYXNoQ29tbWFuZFBhcnNlciB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL3NsYXNoLWNvbW1hbmRzL1NsYXNoQ29tbWFuZFBhcnNlcic7XG5cbmltcG9ydCBsb2cgZnJvbSAnbG9nbGV2ZWwnO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2xhc2hFdmVudEVtaXQobmFtZWRfYXJnczogYW55KTogUHJvbWlzZTxhbnk+IHtcbiAgY29uc3QgZXZlbnQ6IHN0cmluZyA9IG5hbWVkX2FyZ3MuZXZlbnQ7XG4gIGNvbnN0IGRhdGE6IHN0cmluZ1tdID0gbmFtZWRfYXJncy5kYXRhID8/IFtdO1xuXG4gIGV2ZW50U291cmNlLmVtaXQoZXZlbnQsIC4uLmRhdGEpO1xuXG4gIGxvZy5pbmZvKGBbRXZlbnRdWy9ldmVudC1lbWl0XSDlj5HpgIEgJyR7ZXZlbnR9JyDkuovku7YsIOaQuuW4puaVsOaNrjogJHtKU09OLnN0cmluZ2lmeShkYXRhKX1gKTtcblxuICByZXR1cm4gZXZlbnQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpbml0U2xhc2hFdmVudEVtaXQoKSB7XG4gIFNsYXNoQ29tbWFuZFBhcnNlci5hZGRDb21tYW5kT2JqZWN0KFxuICAgIFNsYXNoQ29tbWFuZC5mcm9tUHJvcHMoe1xuICAgICAgbmFtZTogJ2V2ZW50LWVtaXQnLFxuICAgICAgY2FsbGJhY2s6IHNsYXNoRXZlbnRFbWl0LFxuICAgICAgcmV0dXJuczogJ+WPkemAgeeahOS6i+S7tuWQjeensCcsXG4gICAgICBuYW1lZEFyZ3VtZW50TGlzdDogW1xuICAgICAgICBTbGFzaENvbW1hbmROYW1lZEFyZ3VtZW50LmZyb21Qcm9wcyh7XG4gICAgICAgICAgbmFtZTogJ2V2ZW50JyxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogJ+S6i+S7tuWQjeensCcsXG4gICAgICAgICAgdHlwZUxpc3Q6IFtBUkdVTUVOVF9UWVBFLlNUUklOR10sXG4gICAgICAgICAgaXNSZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgfSksXG4gICAgICAgIFNsYXNoQ29tbWFuZE5hbWVkQXJndW1lbnQuZnJvbVByb3BzKHtcbiAgICAgICAgICBuYW1lOiAnZGF0YScsXG4gICAgICAgICAgZGVzY3JpcHRpb246ICfopoHkvKDovpPnmoTmlbDmja4nLFxuICAgICAgICAgIHR5cGVMaXN0OiBbQVJHVU1FTlRfVFlQRS5TVFJJTkddLFxuICAgICAgICAgIGlzUmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICAgIGFjY2VwdHNNdWx0aXBsZTogdHJ1ZSxcbiAgICAgICAgfSksXG4gICAgICBdLFxuICAgICAgdW5uYW1lZEFyZ3VtZW50TGlzdDogW10sXG4gICAgICBoZWxwU3RyaW5nOiBgXG4gICAgPGRpdj5cbiAgICAgICAg5Y+R6YCBIFxcYGV2ZW50XFxgIOS6i+S7tiwg5ZCM5pe25Y+v5Lul5Y+R6YCB5LiA5Lqb5pWw5o2uLlxuICAgICAgICDmiYDmnInmraPlnKjnm5HlkKzor6Xmtojmga/popHpgZPnmoQgbGlzdGVuZXIg5Ye95pWw6YO95Lya6Ieq5Yqo6L+Q6KGMLCDlubbog73nlKjlh73mlbDlj4LmlbDmjqXmlLblj5HpgIHmnaXnmoTmlbDmja4uXG4gICAgICAgIOeUseS6jumFkummhiBTVFNjcmlwdCDovpPlhaXmlrnlvI/nmoTlsYDpmZDmgKcsIOaJgOacieaVsOaNruWwhuS8muS7peWtl+espuS4siBzdHJpbmcg57G75Z6L5o6l5pS2OyDlpoLmnpzpnIDopoEgbnVtYmVyIOetieexu+Weiywg6K+36Ieq6KGM6L2s5o2iLlxuICAgIDwvZGl2PlxuICAgIDxkaXY+XG4gICAgICAgIDxzdHJvbmc+RXhhbXBsZTo8L3N0cm9uZz5cbiAgICAgICAgPHVsPlxuICAgICAgICAgICAgPGxpPlxuICAgICAgICAgICAgICAgIDxwcmU+PGNvZGUgY2xhc3M9XCJsYW5ndWFnZS1zdHNjcmlwdFwiPi9ldmVudC1lbWl0IGV2ZW50PVwi6K+75qGjXCI8L2NvZGU+PC9wcmU+XG4gICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgPGxpPlxuICAgICAgICAgICAgICAgIDxwcmU+PGNvZGUgY2xhc3M9XCJsYW5ndWFnZS1zdHNjcmlwdFwiPi9ldmVudC1lbWl0IGV2ZW50PVwi5a2Y5qGjXCIgZGF0YT17e2dldHZhcjo65pWw5o2ufX0gZGF0YT04IGRhdGE95L2g5aW9IHt7dXNlcn19PC9jb2RlPjwvcHJlPlxuICAgICAgICAgICAgPC9saT5cbiAgICAgICAgICAgIDxsaT5cbiAgICAgICAgICAgICAgICA8cHJlPjxjb2RlIGNsYXNzPVwibGFuZ3VhZ2Utc3RzY3JpcHRcIj4vZXZlbnQtZW1pdCBldmVudD1cIumaj+S+v+S7gOS5iOWQjeensFwiIGRhdGE9XCLov5nmmK/kuIDkuKog5pWw5o2uXCIgZGF0YT17e3VzZXJ9fTwvY29kZT48L3ByZT5cbiAgICAgICAgICAgIDwvbGk+XG4gICAgICAgIDwvdWw+XG4gICAgPC9kaXY+XG4gIGAsXG4gICAgfSksXG4gICk7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/slash_command/event.ts\n')},"./src/third_party.html":
/*!******************************!*\
  !*** ./src/third_party.html ***!
  \******************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n// Module\nvar code = `<link\n  rel="stylesheet"\n  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"\n  integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="\n  crossorigin="anonymous"\n  referrerpolicy="no-referrer"\n/>\n<link\n  rel="stylesheet"\n  href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.14.1/themes/base/jquery-ui.min.css"\n  integrity="sha512-TFee0335YRJoyiqz8hA8KV3P0tXa5CpRBSoM0Wnkn7JoJx1kaq1yXL/rb8YFpWXkMOjRcv5txv+C6UluttluCQ=="\n  crossorigin="anonymous"\n  referrerpolicy="no-referrer"\n/>\n${"<" + "script"}\n  src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"\n  integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="\n  crossorigin="anonymous"\n  referrerpolicy="no-referrer"\n>${"<" + "/script"}>\n${"<" + "script"}\n  src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.14.1/jquery-ui.min.js"\n  integrity="sha512-MSOo1aY+3pXCOCdGAYoBZ6YGI0aragoQsg1mKKBHXCYPIWxamwOE7Drh+N5CPgGI5SA9IEKJiPjdfqWFWmZtRA=="\n  crossorigin="anonymous"\n  referrerpolicy="no-referrer"\n>${"<" + "/script"}>\n${"<" + "script"}\n  src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.min.js"\n  integrity="sha512-WFN04846sdKMIP5LKNphMaWzU7YpMyCU245etK3g/2ARYbPK9Ub18eG+ljU96qKRCWh+quCY7yefSmlkQw1ANQ=="\n  crossorigin="anonymous"\n  referrerpolicy="no-referrer"\n>${"<" + "/script"}>\n${"<" + "script"}\n  src="https://fastly.jsdelivr.net/gh/N0VI028/JS-Slash-Runner/lib/yaml.min.js"\n  crossorigin="anonymous"\n  referrerpolicy="no-referrer"\n>${"<" + "/script"}>\n`;\n// Exports\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (code);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvdGhpcmRfcGFydHkuaHRtbCIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRyxnQkFBZ0I7QUFDbkIsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRyxnQkFBZ0I7QUFDbkIsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRyxnQkFBZ0I7QUFDbkIsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBLEdBQUcsZ0JBQWdCO0FBQ25CO0FBQ0E7QUFDQSxpRUFBZSxJQUFJIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vSlMtU2xhc2gtUnVubmVyLy4vc3JjL3RoaXJkX3BhcnR5Lmh0bWw/MjgwMyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBNb2R1bGVcbnZhciBjb2RlID0gYDxsaW5rXG4gIHJlbD1cInN0eWxlc2hlZXRcIlxuICBocmVmPVwiaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvZm9udC1hd2Vzb21lLzYuNy4yL2Nzcy9hbGwubWluLmNzc1wiXG4gIGludGVncml0eT1cInNoYTUxMi1FdnY4NE1yNGtxVkdSTlNnSUdML0YvYUlEcVFiN3hRMnZjcmRJd3hmalRoU0g4Q1NSN1BCRWFrQ3I1MUNrK3crL1U2c3dVMkltMXZWWDBTVms5QUJoZz09XCJcbiAgY3Jvc3NvcmlnaW49XCJhbm9ueW1vdXNcIlxuICByZWZlcnJlcnBvbGljeT1cIm5vLXJlZmVycmVyXCJcbi8+XG48bGlua1xuICByZWw9XCJzdHlsZXNoZWV0XCJcbiAgaHJlZj1cImh0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL2pxdWVyeXVpLzEuMTQuMS90aGVtZXMvYmFzZS9qcXVlcnktdWkubWluLmNzc1wiXG4gIGludGVncml0eT1cInNoYTUxMi1URmVlMDMzNVlSSm95aXF6OGhBOEtWM1AwdFhhNUNwUkJTb00wV25rbjdKb0p4MWthcTF5WEwvcmI4WUZwV1hrTU9qUmN2NXR4ditDNlVsdXR0bHVDUT09XCJcbiAgY3Jvc3NvcmlnaW49XCJhbm9ueW1vdXNcIlxuICByZWZlcnJlcnBvbGljeT1cIm5vLXJlZmVycmVyXCJcbi8+XG4ke1wiPFwiICsgXCJzY3JpcHRcIn1cbiAgc3JjPVwiaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvanF1ZXJ5LzMuNy4xL2pxdWVyeS5taW4uanNcIlxuICBpbnRlZ3JpdHk9XCJzaGE1MTItdjJDSjdVYVl5NEp3cUxESXJaVUkvNGhxZW9RaWVPbUFaTlhCZVF5am8yMWRhZG53Uis4WmFJSlZUOEVFMml5STYxT1Y4ZTZNOFBQMi80aHBRSU5RL2c9PVwiXG4gIGNyb3Nzb3JpZ2luPVwiYW5vbnltb3VzXCJcbiAgcmVmZXJyZXJwb2xpY3k9XCJuby1yZWZlcnJlclwiXG4+JHtcIjxcIiArIFwiL3NjcmlwdFwifT5cbiR7XCI8XCIgKyBcInNjcmlwdFwifVxuICBzcmM9XCJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9qcXVlcnl1aS8xLjE0LjEvanF1ZXJ5LXVpLm1pbi5qc1wiXG4gIGludGVncml0eT1cInNoYTUxMi1NU09vMWFZKzNwWENPQ2RHQVlvQlo2WUdJMGFyYWdvUXNnMW1LS0JIWENZUElXeGFtd09FN0RyaCtONUNQZ0dJNVNBOUlFS0ppUGpkZnFXRldtWnRSQT09XCJcbiAgY3Jvc3NvcmlnaW49XCJhbm9ueW1vdXNcIlxuICByZWZlcnJlcnBvbGljeT1cIm5vLXJlZmVycmVyXCJcbj4ke1wiPFwiICsgXCIvc2NyaXB0XCJ9PlxuJHtcIjxcIiArIFwic2NyaXB0XCJ9XG4gIHNyYz1cImh0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL2xvZGFzaC5qcy80LjE3LjIxL2xvZGFzaC5taW4uanNcIlxuICBpbnRlZ3JpdHk9XCJzaGE1MTItV0ZOMDQ4NDZzZEtNSVA1TEtOcGhNYVd6VTdZcE15Q1UyNDVldEszZy8yQVJZYlBLOVViMThlRytsalU5NnFLUkNXaCtxdUNZN3llZlNtbGtRdzFBTlE9PVwiXG4gIGNyb3Nzb3JpZ2luPVwiYW5vbnltb3VzXCJcbiAgcmVmZXJyZXJwb2xpY3k9XCJuby1yZWZlcnJlclwiXG4+JHtcIjxcIiArIFwiL3NjcmlwdFwifT5cbiR7XCI8XCIgKyBcInNjcmlwdFwifVxuICBzcmM9XCJodHRwczovL2Zhc3RseS5qc2RlbGl2ci5uZXQvZ2gvTjBWSTAyOC9KUy1TbGFzaC1SdW5uZXIvbGliL3lhbWwubWluLmpzXCJcbiAgY3Jvc3NvcmlnaW49XCJhbm9ueW1vdXNcIlxuICByZWZlcnJlcnBvbGljeT1cIm5vLXJlZmVycmVyXCJcbj4ke1wiPFwiICsgXCIvc2NyaXB0XCJ9PlxuYDtcbi8vIEV4cG9ydHNcbmV4cG9ydCBkZWZhdWx0IGNvZGU7Il0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/third_party.html\n')},"./src/util/check_update.ts":
/*!**********************************!*\
  !*** ./src/util/check_update.ts ***!
  \**********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VERSION_FILE_PATH: () => (/* binding */ VERSION_FILE_PATH),\n/* harmony export */   addVersionUpdateElement: () => (/* binding */ addVersionUpdateElement),\n/* harmony export */   getChangelog: () => (/* binding */ getChangelog),\n/* harmony export */   getCurrentVersion: () => (/* binding */ getCurrentVersion),\n/* harmony export */   getFileContentByPath: () => (/* binding */ getFileContentByPath),\n/* harmony export */   handleUpdateButton: () => (/* binding */ handleUpdateButton),\n/* harmony export */   parseChangelogBetweenVersions: () => (/* binding */ parseChangelogBetweenVersions),\n/* harmony export */   parseVersionFromFile: () => (/* binding */ parseVersionFromFile),\n/* harmony export */   runCheckWithPath: () => (/* binding */ runCheckWithPath),\n/* harmony export */   showNewFeature: () => (/* binding */ showNewFeature),\n/* harmony export */   updateTavernHelper: () => (/* binding */ updateTavernHelper)\n/* harmony export */ });\n/* harmony import */ var _util_extension_variables__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/util/extension_variables */ \"./src/util/extension_variables.ts\");\n/* harmony import */ var _util_render_markdown__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/util/render_markdown */ \"./src/util/render_markdown.ts\");\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n/* harmony import */ var _sillytavern_scripts_i18n__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sillytavern/scripts/i18n */ \"@sillytavern/scripts/i18n\");\n/* harmony import */ var _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @sillytavern/scripts/popup */ \"@sillytavern/scripts/popup\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! loglevel */ \"./node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_6__);\n\n\n\n\n\n\n\nconst GITLAB_INSTANCE_URL = 'gitlab.com';\nconst GITLAB_PROJECT_PATH = 'novi028/JS-Slash-Runner';\nconst GITLAB_BRANCH = 'main';\nconst VERSION_FILE_PATH_GITLAB = 'manifest.json';\nconst CHANGELOG_FILE_PATH_GITLAB = 'CHANGELOG.md';\nconst VERSION_FILE_PATH = `/scripts/extensions/${_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.extensionFolderPath}/manifest.json`;\nlet CURRENT_VERSION;\nlet LATEST_VERSION;\nlet CHANGELOG_CONTENT;\n/**\n * 从 GitLab 仓库获取指定文件的原始内容 (支持项目 ID 或项目路径)\n * @param filePath 文件在仓库中的路径 (会被自动 URL 编码)\n * @returns 返回文件内容的 Promise<string>\n */\nasync function fetchRawFileContentFromGitLab(filePath) {\n    const idOrPathForUrl = typeof GITLAB_PROJECT_PATH === 'string' && GITLAB_PROJECT_PATH.includes('/')\n        ? encodeURIComponent(GITLAB_PROJECT_PATH)\n        : GITLAB_PROJECT_PATH;\n    const encodedFilePath = encodeURIComponent(filePath);\n    const url = `https://${GITLAB_INSTANCE_URL}/api/v4/projects/${idOrPathForUrl}/repository/files/${encodedFilePath}/raw?ref=${GITLAB_BRANCH}`;\n    const headers = {\n        'Cache-Control': 'no-cache',\n    };\n    try {\n        const response = await fetch(url, { method: 'GET', headers: headers });\n        if (!response.ok) {\n            let errorBody = '';\n            try {\n                errorBody = await response.text();\n            }\n            catch (e) {\n                /* ignore */\n            }\n            throw new Error(`[TavernHelper] 无法获取 GitLab 文件: ${response.status} ${response.statusText}. URL: ${url}. Response: ${errorBody}`);\n        }\n        const content = await response.text();\n        return content.trim();\n    }\n    catch (error) {\n        loglevel__WEBPACK_IMPORTED_MODULE_6___default().error('[TavernHelper] 获取 GitLab 文件内容时出错:', error);\n        throw error;\n    }\n}\n/**\n * 从 JSON 文件内容中解析 'version' 字段的值\n * @param content 文件内容字符串\n * @returns 解析出的版本号字符串 (例如 \"2.5.5\")\n * @throws 如果内容不是有效的 JSON，或者 'version' 字段不存在或不是字符串，则抛出错误\n */\nfunction parseVersionFromFile(content) {\n    try {\n        const data = JSON.parse(content);\n        if (data && typeof data.version === 'string') {\n            return data.version;\n        }\n        else {\n            throw new Error(\"[TavernHelper] 在 JSON 数据中未找到有效的 'version' 字段 (必须是字符串类型)\");\n        }\n    }\n    catch (error) {\n        loglevel__WEBPACK_IMPORTED_MODULE_6___default().error('[TavernHelper] 解析版本文件内容时出错:', error);\n        if (error instanceof SyntaxError) {\n            throw new Error(`[TavernHelper] 无法将文件内容解析为 JSON: ${error.message}`);\n        }\n        throw new Error(`[TavernHelper] 无法从文件内容中解析版本号: ${error instanceof Error ? error.message : String(error)}`);\n    }\n}\n/**\n * 获取当前版本号\n * @param path 版本号文件路径\n * @returns 当前版本号\n */\nasync function getCurrentVersion(path) {\n    CURRENT_VERSION = parseVersionFromFile(await getFileContentByPath(path));\n    return CURRENT_VERSION;\n}\n/**\n * 比较两个语义化版本号 (Semantic Versioning - Major.Minor.Patch)\n * @param versionA 版本号字符串 A (例如 \"2.5.5\")\n * @param versionB 版本号字符串 B (例如 \"1.0.0\")\n * @returns\n * - 正数 (> 0): 如果 versionA > versionB (A 更新)\n * - 负数 (< 0): 如果 versionA < versionB (B 更新)\n * - 0:        如果 versionA == versionB (版本相同)\n * 注意: 这个基础比较器不处理预发布标签 (-beta) 或构建元数据 (+build)。\n * 它会将 \"2.5.5-beta\" 和 \"2.5.5\" 在此比较中视为相等。\n */\nfunction compareSemVer(versionA, versionB) {\n    const cleanVersionA = versionA.split('-')[0].split('+')[0];\n    const cleanVersionB = versionB.split('-')[0].split('+')[0];\n    const partsA = cleanVersionA.split('.').map(Number);\n    const partsB = cleanVersionB.split('.').map(Number);\n    for (let i = 0; i < 3; i++) {\n        // 如果某个版本号部分缺失 (例如 \"1.2\" vs \"1.2.3\")，则视为 0\n        const numA = partsA[i] || 0;\n        const numB = partsB[i] || 0;\n        if (isNaN(numA) || isNaN(numB)) {\n            loglevel__WEBPACK_IMPORTED_MODULE_6___default().warn(`[TavernHelper] 版本号 \"${versionA}\" 或 \"${versionB}\" 包含非数字部分，可能导致比较不准确。`);\n            return 0;\n        }\n        if (numA > numB) {\n            return 1;\n        }\n        if (numA < numB) {\n            return -1;\n        }\n    }\n    return 0;\n}\nasync function getFileContentByPath(filePath) {\n    try {\n        const response = await fetch(filePath);\n        if (!response.ok) {\n            throw new Error(`HTTP error! status: ${response.status}`);\n        }\n        const content = await response.text();\n        return content;\n    }\n    catch (error) {\n        loglevel__WEBPACK_IMPORTED_MODULE_6___default().error(`读取文件 ${filePath} 失败:`, error);\n        throw error;\n    }\n}\nasync function runCheckWithPath() {\n    try {\n        LATEST_VERSION = parseVersionFromFile(await fetchRawFileContentFromGitLab(VERSION_FILE_PATH_GITLAB));\n        const comparisonResult = compareSemVer(LATEST_VERSION, CURRENT_VERSION);\n        if (comparisonResult > 0) {\n            loglevel__WEBPACK_IMPORTED_MODULE_6___default().info(`[TavernHelper] 需要更新！最新版本 ${LATEST_VERSION} > 当前版本 ${CURRENT_VERSION}`);\n            return true;\n        }\n        else if (comparisonResult === 0) {\n            loglevel__WEBPACK_IMPORTED_MODULE_6___default().info(`[TavernHelper] 当前版本 ${CURRENT_VERSION} 已是最新。`);\n            return false;\n        }\n        else {\n            loglevel__WEBPACK_IMPORTED_MODULE_6___default().warn(`[TavernHelper] 当前版本 ${CURRENT_VERSION} 比远程版本 ${LATEST_VERSION} 还新？`);\n            return false;\n        }\n    }\n    catch (error) {\n        loglevel__WEBPACK_IMPORTED_MODULE_6___default().error('[TavernHelper] 版本检查失败:', error);\n        return false;\n    }\n}\n/**\n * 添加版本更新提示元素\n */\nfunction addVersionUpdateElement() {\n    const container = $('#tavern-helper-extension-container .inline-drawer-header b');\n    container.append(`\n    <span style=\"color: red; font-size: 12px; font-weight: bold;\">\n      New!\n    </span>\n  `);\n    $('#version-update-text').closest('.flex-container .alignItemsCenter').append(`\n      <div style='background-color: var(--SmartThemeQuoteColor);border-radius: 50px;padding: 0 5px;height: 50%; font-size: calc(var(--mainFontSize) * 0.7);'>\n        最新：Ver ${LATEST_VERSION}\n      </div>\n    `);\n}\n/**\n * 解析变更日志内容，提取两个版本之间的日志\n * @param changelogContent 变更日志的完整内容\n * @param currentVersion 当前版本号\n * @param latestVersion 最新版本号\n * @returns 两个版本之间的日志内容\n */\nfunction parseChangelogBetweenVersions(changelogContent, currentVersion, latestVersion) {\n    // 查找所有版本标题，支持多种Markdown标题格式\n    // 匹配 ## 版本号 或 # 版本号 或 [版本号] 等格式\n    const versionRegex = /(?:^|\\n)(?:#{1,3}\\s*|\\[)([0-9]+\\.[0-9]+\\.[0-9]+)(?:\\]|\\s|$)/g;\n    const matches = [...changelogContent.matchAll(versionRegex)];\n    if (matches.length === 0) {\n        toastr.error('无法找到版本日志。');\n        return;\n    }\n    // 比较当前版本和最新版本\n    const comparisonResult = compareSemVer(latestVersion, currentVersion);\n    let extractedContent = '';\n    if (comparisonResult <= 0) {\n        // 当前版本大于或等于最新版本，只返回最新版本的日志\n        const latestVersionMatch = matches.find(match => match[1] === latestVersion);\n        if (!latestVersionMatch) {\n            toastr.error('获取更新日志失败');\n            return;\n        }\n        const startIndex = latestVersionMatch.index;\n        const nextVersionMatch = matches.find(match => match.index > startIndex);\n        const endIndex = nextVersionMatch ? nextVersionMatch.index : changelogContent.length;\n        extractedContent = changelogContent.substring(startIndex, endIndex).trim();\n    }\n    else {\n        const currentVersionMatch = matches.find(match => match[1] === currentVersion);\n        if (!currentVersionMatch) {\n            toastr.error(`无法找到版本 ${currentVersion} 的日志。`);\n            return;\n        }\n        const latestVersionMatch = matches.find(match => match[1] === latestVersion);\n        if (!latestVersionMatch) {\n            toastr.error(`无法找到版本 ${latestVersion} 的日志。`);\n            return;\n        }\n        const startIndex = currentVersionMatch.index;\n        const endIndex = latestVersionMatch.index;\n        extractedContent = changelogContent.substring(startIndex, endIndex).trim();\n    }\n    return (0,_util_render_markdown__WEBPACK_IMPORTED_MODULE_1__.renderMarkdown)(extractedContent);\n}\n/**\n * 弹出changeLog的popup\n */\nasync function handleUpdateButton() {\n    if (!CHANGELOG_CONTENT) {\n        await getChangelog();\n    }\n    const result = await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_5__.callGenericPopup)(CHANGELOG_CONTENT, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_5__.POPUP_TYPE.CONFIRM, '', {\n        okButton: '更新',\n        cancelButton: '取消',\n    });\n    if (result) {\n        toastr.info('更新中……');\n        await updateTavernHelper();\n    }\n}\n/**\n * 获取变更日志\n * @returns 两个版本之间的日志内容\n */\nasync function getChangelog() {\n    toastr.info('获取更新日志中……');\n    const changelogContent = await fetchRawFileContentFromGitLab(CHANGELOG_FILE_PATH_GITLAB);\n    if (LATEST_VERSION === undefined) {\n        LATEST_VERSION = parseVersionFromFile(await fetchRawFileContentFromGitLab(VERSION_FILE_PATH_GITLAB));\n    }\n    if (CURRENT_VERSION === undefined) {\n        CURRENT_VERSION = parseVersionFromFile(await getFileContentByPath(VERSION_FILE_PATH));\n    }\n    const logs = parseChangelogBetweenVersions(changelogContent, CURRENT_VERSION, LATEST_VERSION);\n    if (!logs) {\n        toastr.error('无法获取更新日志');\n        return;\n    }\n    else {\n        CHANGELOG_CONTENT = logs;\n    }\n}\n/**\n * 更新酒馆助手\n */\nasync function updateTavernHelper() {\n    const extensionType = getExtensionType(_util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.extensionName);\n    const response = await fetch('/api/extensions/update', {\n        method: 'POST',\n        headers: (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_2__.getRequestHeaders)(),\n        body: JSON.stringify({ extensionName: _util_extension_variables__WEBPACK_IMPORTED_MODULE_0__.extensionName, global: extensionType === 'global' ? true : false }),\n    });\n    if (!response.ok) {\n        const text = await response.text();\n        toastr.error(text || response.statusText, (0,_sillytavern_scripts_i18n__WEBPACK_IMPORTED_MODULE_4__.t) `更新酒馆助手失败`, { timeOut: 5000 });\n        loglevel__WEBPACK_IMPORTED_MODULE_6___default().error(`更新酒馆助手失败: ${text}`);\n        return false;\n    }\n    const data = await response.json();\n    if (data.isUpToDate) {\n        loglevel__WEBPACK_IMPORTED_MODULE_6___default().info(`酒馆助手已是最新版本, 无需更新`);\n    }\n    else {\n        toastr.success((0,_sillytavern_scripts_i18n__WEBPACK_IMPORTED_MODULE_4__.t) `成功更新酒馆助手为 ${data.shortCommitHash}, 准备刷新页面以生效...`);\n        loglevel__WEBPACK_IMPORTED_MODULE_6___default().info(`成功更新酒馆助手为  ${data.shortCommitHash}, 准备刷新页面以生效...`);\n        setTimeout(() => location.reload(), 3000);\n    }\n    return true;\n}\n// 酒馆原代码复制来的\n/**\n * Gets the type of an extension based on its external ID.\n * @param {string} externalId External ID of the extension (excluding or including the leading 'third-party/')\n * @returns {string} Type of the extension (global, local, system, or empty string if not found)\n */\nfunction getExtensionType(externalId) {\n    const id = Object.keys(_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__.extensionTypes).find(\n    // eslint-disable-next-line no-shadow\n    (id) => id === externalId || (id.startsWith('third-party') && id.endsWith(externalId)));\n    return id ? _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_3__.extensionTypes[id] : 'local';\n}\n// 旧版更新后用\n/**\n *\n */\nasync function showNewFeature() {\n    let changelogContent = await fetchRawFileContentFromGitLab(CHANGELOG_FILE_PATH_GITLAB);\n    changelogContent = changelogContent + '\\n\\n*前端助手旧版配置已清除，请重新配置扩展设置*';\n    const logs = parseChangelogBetweenVersions(changelogContent, '3.0.0', '3.0.0');\n    if (logs) {\n        const modifiedLogs = logs.replace(/<h2([^>]*)>([^<]*)<\\/h2>/g, '<h2$1>酒馆助手 $2</h2>');\n        await (0,_sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_5__.callGenericPopup)(modifiedLogs, _sillytavern_scripts_popup__WEBPACK_IMPORTED_MODULE_5__.POPUP_TYPE.TEXT);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUksQ0FBQyxFQUFFLENBQUMsVUFBVSxDQUFDLGFBQWEsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxRQUFRLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FDL0YsQ0FBQztJQUNGLE9BQU8sRUFBRSxDQUFDLENBQUMsQ0FBQywyRUFBYyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUM7QUFDM0MsQ0FBQztBQUVELFNBQVM7QUFDVDs7R0FFRztBQUVJLEtBQUssVUFBVSxjQUFjO0lBQ2xDLElBQUksZ0JBQWdCLEdBQUcsTUFBTSw2QkFBNkIsQ0FBQywwQkFBMEIsQ0FBQyxDQUFDO0lBQ3ZGLGdCQUFnQixHQUFHLGdCQUFnQixHQUFHLDZCQUE2QixDQUFDO0lBQ3BFLE1BQU0sSUFBSSxHQUFHLDZCQUE2QixDQUFDLGdCQUFnQixFQUFFLE9BQU8sRUFBRSxPQUFPLENBQUMsQ0FBQztJQUUvRSxJQUFJLElBQUksRUFBRSxDQUFDO1FBQ1QsTUFBTSxZQUFZLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQywyQkFBMkIsRUFBRSxvQkFBb0IsQ0FBQyxDQUFDO1FBQ3JGLE1BQU0sNEVBQWdCLENBQUMsWUFBWSxFQUFFLGtFQUFVLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDeEQsQ0FBQztBQUNILENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvdXRpbC9jaGVja191cGRhdGUudHM/MWEwOSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBleHRlbnNpb25Gb2xkZXJQYXRoLCBleHRlbnNpb25OYW1lIH0gZnJvbSAnQC91dGlsL2V4dGVuc2lvbl92YXJpYWJsZXMnO1xuaW1wb3J0IHsgcmVuZGVyTWFya2Rvd24gfSBmcm9tICdAL3V0aWwvcmVuZGVyX21hcmtkb3duJztcblxuaW1wb3J0IHsgZ2V0UmVxdWVzdEhlYWRlcnMgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0JztcbmltcG9ydCB7IGV4dGVuc2lvblR5cGVzIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvZXh0ZW5zaW9ucyc7XG5pbXBvcnQgeyB0IH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvaTE4bic7XG5pbXBvcnQgeyBQT1BVUF9UWVBFLCBjYWxsR2VuZXJpY1BvcHVwIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdHMvcG9wdXAnO1xuXG5pbXBvcnQgbG9nIGZyb20gJ2xvZ2xldmVsJztcblxuY29uc3QgR0lUTEFCX0lOU1RBTkNFX1VSTCA9ICdnaXRsYWIuY29tJztcbmNvbnN0IEdJVExBQl9QUk9KRUNUX1BBVEggPSAnbm92aTAyOC9KUy1TbGFzaC1SdW5uZXInO1xuY29uc3QgR0lUTEFCX0JSQU5DSCA9ICdtYWluJztcbmNvbnN0IFZFUlNJT05fRklMRV9QQVRIX0dJVExBQiA9ICdtYW5pZmVzdC5qc29uJztcbmNvbnN0IENIQU5HRUxPR19GSUxFX1BBVEhfR0lUTEFCID0gJ0NIQU5HRUxPRy5tZCc7XG5leHBvcnQgY29uc3QgVkVSU0lPTl9GSUxFX1BBVEggPSBgL3NjcmlwdHMvZXh0ZW5zaW9ucy8ke2V4dGVuc2lvbkZvbGRlclBhdGh9L21hbmlmZXN0Lmpzb25gO1xubGV0IENVUlJFTlRfVkVSU0lPTjogc3RyaW5nO1xubGV0IExBVEVTVF9WRVJTSU9OOiBzdHJpbmc7XG5sZXQgQ0hBTkdFTE9HX0NPTlRFTlQ6IHN0cmluZztcblxuLyoqXG4gKiDku44gR2l0TGFiIOS7k+W6k+iOt+WPluaMh+WumuaWh+S7tueahOWOn+Wni+WGheWuuSAo5pSv5oyB6aG555uuIElEIOaIlumhueebrui3r+W+hClcbiAqIEBwYXJhbSBmaWxlUGF0aCDmlofku7blnKjku5PlupPkuK3nmoTot6/lvoQgKOS8muiiq+iHquWKqCBVUkwg57yW56CBKVxuICogQHJldHVybnMg6L+U5Zue5paH5Lu25YaF5a6555qEIFByb21pc2U8c3RyaW5nPlxuICovXG5hc3luYyBmdW5jdGlvbiBmZXRjaFJhd0ZpbGVDb250ZW50RnJvbUdpdExhYihmaWxlUGF0aDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgY29uc3QgaWRPclBhdGhGb3JVcmwgPVxuICAgIHR5cGVvZiBHSVRMQUJfUFJPSkVDVF9QQVRIID09PSAnc3RyaW5nJyAmJiBHSVRMQUJfUFJPSkVDVF9QQVRILmluY2x1ZGVzKCcvJylcbiAgICAgID8gZW5jb2RlVVJJQ29tcG9uZW50KEdJVExBQl9QUk9KRUNUX1BBVEgpXG4gICAgICA6IEdJVExBQl9QUk9KRUNUX1BBVEg7XG4gIGNvbnN0IGVuY29kZWRGaWxlUGF0aCA9IGVuY29kZVVSSUNvbXBvbmVudChmaWxlUGF0aCk7XG4gIGNvbnN0IHVybCA9IGBodHRwczovLyR7R0lUTEFCX0lOU1RBTkNFX1VSTH0vYXBpL3Y0L3Byb2plY3RzLyR7aWRPclBhdGhGb3JVcmx9L3JlcG9zaXRvcnkvZmlsZXMvJHtlbmNvZGVkRmlsZVBhdGh9L3Jhdz9yZWY9JHtHSVRMQUJfQlJBTkNIfWA7XG5cbiAgY29uc3QgaGVhZGVyczogSGVhZGVyc0luaXQgPSB7XG4gICAgJ0NhY2hlLUNvbnRyb2wnOiAnbm8tY2FjaGUnLFxuICB9O1xuXG4gIHRyeSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHsgbWV0aG9kOiAnR0VUJywgaGVhZGVyczogaGVhZGVycyB9KTtcbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICBsZXQgZXJyb3JCb2R5ID0gJyc7XG4gICAgICB0cnkge1xuICAgICAgICBlcnJvckJvZHkgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIC8qIGlnbm9yZSAqL1xuICAgICAgfVxuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBgW1RhdmVybkhlbHBlcl0g5peg5rOV6I635Y+WIEdpdExhYiDmlofku7Y6ICR7cmVzcG9uc2Uuc3RhdHVzfSAke3Jlc3BvbnNlLnN0YXR1c1RleHR9LiBVUkw6ICR7dXJsfS4gUmVzcG9uc2U6ICR7ZXJyb3JCb2R5fWAsXG4gICAgICApO1xuICAgIH1cbiAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xuICAgIHJldHVybiBjb250ZW50LnRyaW0oKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBsb2cuZXJyb3IoJ1tUYXZlcm5IZWxwZXJdIOiOt+WPliBHaXRMYWIg5paH5Lu25YaF5a655pe25Ye66ZSZOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuXG4vKipcbiAqIOS7jiBKU09OIOaWh+S7tuWGheWuueS4reino+aekCAndmVyc2lvbicg5a2X5q6155qE5YC8XG4gKiBAcGFyYW0gY29udGVudCDmlofku7blhoXlrrnlrZfnrKbkuLJcbiAqIEByZXR1cm5zIOino+aekOWHuueahOeJiOacrOWPt+Wtl+espuS4siAo5L6L5aaCIFwiMi41LjVcIilcbiAqIEB0aHJvd3Mg5aaC5p6c5YaF5a655LiN5piv5pyJ5pWI55qEIEpTT07vvIzmiJbogIUgJ3ZlcnNpb24nIOWtl+auteS4jeWtmOWcqOaIluS4jeaYr+Wtl+espuS4su+8jOWImeaKm+WHuumUmeivr1xuICovXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VWZXJzaW9uRnJvbUZpbGUoY29udGVudDogc3RyaW5nKTogc3RyaW5nIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShjb250ZW50KTtcblxuICAgIGlmIChkYXRhICYmIHR5cGVvZiBkYXRhLnZlcnNpb24gPT09ICdzdHJpbmcnKSB7XG4gICAgICByZXR1cm4gZGF0YS52ZXJzaW9uO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJbVGF2ZXJuSGVscGVyXSDlnKggSlNPTiDmlbDmja7kuK3mnKrmib7liLDmnInmlYjnmoQgJ3ZlcnNpb24nIOWtl+autSAo5b+F6aG75piv5a2X56ym5Liy57G75Z6LKVwiKTtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nLmVycm9yKCdbVGF2ZXJuSGVscGVyXSDop6PmnpDniYjmnKzmlofku7blhoXlrrnml7blh7rplJk6JywgZXJyb3IpO1xuXG4gICAgaWYgKGVycm9yIGluc3RhbmNlb2YgU3ludGF4RXJyb3IpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgW1RhdmVybkhlbHBlcl0g5peg5rOV5bCG5paH5Lu25YaF5a656Kej5p6Q5Li6IEpTT046ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICB9XG5cbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICBgW1RhdmVybkhlbHBlcl0g5peg5rOV5LuO5paH5Lu25YaF5a655Lit6Kej5p6Q54mI5pys5Y+3OiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKX1gLFxuICAgICk7XG4gIH1cbn1cblxuLyoqXG4gKiDojrflj5blvZPliY3niYjmnKzlj7dcbiAqIEBwYXJhbSBwYXRoIOeJiOacrOWPt+aWh+S7tui3r+W+hFxuICogQHJldHVybnMg5b2T5YmN54mI5pys5Y+3XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDdXJyZW50VmVyc2lvbihwYXRoOiBzdHJpbmcpIHtcbiAgQ1VSUkVOVF9WRVJTSU9OID0gcGFyc2VWZXJzaW9uRnJvbUZpbGUoYXdhaXQgZ2V0RmlsZUNvbnRlbnRCeVBhdGgocGF0aCkpO1xuICByZXR1cm4gQ1VSUkVOVF9WRVJTSU9OO1xufVxuXG4vKipcbiAqIOavlOi+g+S4pOS4quivreS5ieWMlueJiOacrOWPtyAoU2VtYW50aWMgVmVyc2lvbmluZyAtIE1ham9yLk1pbm9yLlBhdGNoKVxuICogQHBhcmFtIHZlcnNpb25BIOeJiOacrOWPt+Wtl+espuS4siBBICjkvovlpoIgXCIyLjUuNVwiKVxuICogQHBhcmFtIHZlcnNpb25CIOeJiOacrOWPt+Wtl+espuS4siBCICjkvovlpoIgXCIxLjAuMFwiKVxuICogQHJldHVybnNcbiAqIC0g5q2j5pWwICg+IDApOiDlpoLmnpwgdmVyc2lvbkEgPiB2ZXJzaW9uQiAoQSDmm7TmlrApXG4gKiAtIOi0n+aVsCAoPCAwKTog5aaC5p6cIHZlcnNpb25BIDwgdmVyc2lvbkIgKEIg5pu05pawKVxuICogLSAwOiAgICAgICAg5aaC5p6cIHZlcnNpb25BID09IHZlcnNpb25CICjniYjmnKznm7jlkIwpXG4gKiDms6jmhI86IOi/meS4quWfuuehgOavlOi+g+WZqOS4jeWkhOeQhumihOWPkeW4g+agh+etviAoLWJldGEpIOaIluaehOW7uuWFg+aVsOaNriAoK2J1aWxkKeOAglxuICog5a6D5Lya5bCGIFwiMi41LjUtYmV0YVwiIOWSjCBcIjIuNS41XCIg5Zyo5q2k5q+U6L6D5Lit6KeG5Li655u4562J44CCXG4gKi9cbmZ1bmN0aW9uIGNvbXBhcmVTZW1WZXIodmVyc2lvbkE6IHN0cmluZywgdmVyc2lvbkI6IHN0cmluZyk6IG51bWJlciB7XG4gIGNvbnN0IGNsZWFuVmVyc2lvbkEgPSB2ZXJzaW9uQS5zcGxpdCgnLScpWzBdLnNwbGl0KCcrJylbMF07XG4gIGNvbnN0IGNsZWFuVmVyc2lvbkIgPSB2ZXJzaW9uQi5zcGxpdCgnLScpWzBdLnNwbGl0KCcrJylbMF07XG5cbiAgY29uc3QgcGFydHNBID0gY2xlYW5WZXJzaW9uQS5zcGxpdCgnLicpLm1hcChOdW1iZXIpO1xuICBjb25zdCBwYXJ0c0IgPSBjbGVhblZlcnNpb25CLnNwbGl0KCcuJykubWFwKE51bWJlcik7XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCAzOyBpKyspIHtcbiAgICAvLyDlpoLmnpzmn5DkuKrniYjmnKzlj7fpg6jliIbnvLrlpLEgKOS+i+WmgiBcIjEuMlwiIHZzIFwiMS4yLjNcIinvvIzliJnop4bkuLogMFxuICAgIGNvbnN0IG51bUEgPSBwYXJ0c0FbaV0gfHwgMDtcbiAgICBjb25zdCBudW1CID0gcGFydHNCW2ldIHx8IDA7XG5cbiAgICBpZiAoaXNOYU4obnVtQSkgfHwgaXNOYU4obnVtQikpIHtcbiAgICAgIGxvZy53YXJuKGBbVGF2ZXJuSGVscGVyXSDniYjmnKzlj7cgXCIke3ZlcnNpb25BfVwiIOaIliBcIiR7dmVyc2lvbkJ9XCIg5YyF5ZCr6Z2e5pWw5a2X6YOo5YiG77yM5Y+v6IO95a+86Ie05q+U6L6D5LiN5YeG56Gu44CCYCk7XG4gICAgICByZXR1cm4gMDtcbiAgICB9XG5cbiAgICBpZiAobnVtQSA+IG51bUIpIHtcbiAgICAgIHJldHVybiAxO1xuICAgIH1cbiAgICBpZiAobnVtQSA8IG51bUIpIHtcbiAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gMDtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEZpbGVDb250ZW50QnlQYXRoKGZpbGVQYXRoOiBzdHJpbmcpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGZpbGVQYXRoKTtcbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEhUVFAgZXJyb3IhIHN0YXR1czogJHtyZXNwb25zZS5zdGF0dXN9YCk7XG4gICAgfVxuICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgcmV0dXJuIGNvbnRlbnQ7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nLmVycm9yKGDor7vlj5bmlofku7YgJHtmaWxlUGF0aH0g5aSx6LSlOmAsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcnVuQ2hlY2tXaXRoUGF0aCgpIHtcbiAgdHJ5IHtcbiAgICBMQVRFU1RfVkVSU0lPTiA9IHBhcnNlVmVyc2lvbkZyb21GaWxlKGF3YWl0IGZldGNoUmF3RmlsZUNvbnRlbnRGcm9tR2l0TGFiKFZFUlNJT05fRklMRV9QQVRIX0dJVExBQikpO1xuXG4gICAgY29uc3QgY29tcGFyaXNvblJlc3VsdCA9IGNvbXBhcmVTZW1WZXIoTEFURVNUX1ZFUlNJT04sIENVUlJFTlRfVkVSU0lPTik7XG5cbiAgICBpZiAoY29tcGFyaXNvblJlc3VsdCA+IDApIHtcbiAgICAgIGxvZy5pbmZvKGBbVGF2ZXJuSGVscGVyXSDpnIDopoHmm7TmlrDvvIHmnIDmlrDniYjmnKwgJHtMQVRFU1RfVkVSU0lPTn0gPiDlvZPliY3niYjmnKwgJHtDVVJSRU5UX1ZFUlNJT059YCk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGVsc2UgaWYgKGNvbXBhcmlzb25SZXN1bHQgPT09IDApIHtcbiAgICAgIGxvZy5pbmZvKGBbVGF2ZXJuSGVscGVyXSDlvZPliY3niYjmnKwgJHtDVVJSRU5UX1ZFUlNJT059IOW3suaYr+acgOaWsOOAgmApO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICBsb2cud2FybihgW1RhdmVybkhlbHBlcl0g5b2T5YmN54mI5pysICR7Q1VSUkVOVF9WRVJTSU9OfSDmr5Tov5znqIvniYjmnKwgJHtMQVRFU1RfVkVSU0lPTn0g6L+Y5paw77yfYCk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGxvZy5lcnJvcignW1RhdmVybkhlbHBlcl0g54mI5pys5qOA5p+l5aSx6LSlOicsIGVycm9yKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cblxuLyoqXG4gKiDmt7vliqDniYjmnKzmm7TmlrDmj5DnpLrlhYPntKBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFkZFZlcnNpb25VcGRhdGVFbGVtZW50KCkge1xuICBjb25zdCBjb250YWluZXIgPSAkKCcjdGF2ZXJuLWhlbHBlci1leHRlbnNpb24tY29udGFpbmVyIC5pbmxpbmUtZHJhd2VyLWhlYWRlciBiJyk7XG4gIGNvbnRhaW5lci5hcHBlbmQoYFxuICAgIDxzcGFuIHN0eWxlPVwiY29sb3I6IHJlZDsgZm9udC1zaXplOiAxMnB4OyBmb250LXdlaWdodDogYm9sZDtcIj5cbiAgICAgIE5ldyFcbiAgICA8L3NwYW4+XG4gIGApO1xuICAkKCcjdmVyc2lvbi11cGRhdGUtdGV4dCcpLmNsb3Nlc3QoJy5mbGV4LWNvbnRhaW5lciAuYWxpZ25JdGVtc0NlbnRlcicpLmFwcGVuZChgXG4gICAgICA8ZGl2IHN0eWxlPSdiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1TbWFydFRoZW1lUXVvdGVDb2xvcik7Ym9yZGVyLXJhZGl1czogNTBweDtwYWRkaW5nOiAwIDVweDtoZWlnaHQ6IDUwJTsgZm9udC1zaXplOiBjYWxjKHZhcigtLW1haW5Gb250U2l6ZSkgKiAwLjcpOyc+XG4gICAgICAgIOacgOaWsO+8mlZlciAke0xBVEVTVF9WRVJTSU9OfVxuICAgICAgPC9kaXY+XG4gICAgYCk7XG59XG5cbi8qKlxuICog6Kej5p6Q5Y+Y5pu05pel5b+X5YaF5a6577yM5o+Q5Y+W5Lik5Liq54mI5pys5LmL6Ze055qE5pel5b+XXG4gKiBAcGFyYW0gY2hhbmdlbG9nQ29udGVudCDlj5jmm7Tml6Xlv5fnmoTlrozmlbTlhoXlrrlcbiAqIEBwYXJhbSBjdXJyZW50VmVyc2lvbiDlvZPliY3niYjmnKzlj7dcbiAqIEBwYXJhbSBsYXRlc3RWZXJzaW9uIOacgOaWsOeJiOacrOWPt1xuICogQHJldHVybnMg5Lik5Liq54mI5pys5LmL6Ze055qE5pel5b+X5YaF5a65XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUNoYW5nZWxvZ0JldHdlZW5WZXJzaW9ucyhcbiAgY2hhbmdlbG9nQ29udGVudDogc3RyaW5nLFxuICBjdXJyZW50VmVyc2lvbjogc3RyaW5nLFxuICBsYXRlc3RWZXJzaW9uOiBzdHJpbmcsXG4pOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICAvLyDmn6Xmib7miYDmnInniYjmnKzmoIfpopjvvIzmlK/mjIHlpJrnp41NYXJrZG93buagh+mimOagvOW8j1xuICAvLyDljLnphY0gIyMg54mI5pys5Y+3IOaIliAjIOeJiOacrOWPtyDmiJYgW+eJiOacrOWPt10g562J5qC85byPXG4gIGNvbnN0IHZlcnNpb25SZWdleCA9IC8oPzpefFxcbikoPzojezEsM31cXHMqfFxcWykoWzAtOV0rXFwuWzAtOV0rXFwuWzAtOV0rKSg/OlxcXXxcXHN8JCkvZztcbiAgY29uc3QgbWF0Y2hlcyA9IFsuLi5jaGFuZ2Vsb2dDb250ZW50Lm1hdGNoQWxsKHZlcnNpb25SZWdleCldO1xuXG4gIGlmIChtYXRjaGVzLmxlbmd0aCA9PT0gMCkge1xuICAgIHRvYXN0ci5lcnJvcign5peg5rOV5om+5Yiw54mI5pys5pel5b+X44CCJyk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8g5q+U6L6D5b2T5YmN54mI5pys5ZKM5pyA5paw54mI5pysXG4gIGNvbnN0IGNvbXBhcmlzb25SZXN1bHQgPSBjb21wYXJlU2VtVmVyKGxhdGVzdFZlcnNpb24sIGN1cnJlbnRWZXJzaW9uKTtcbiAgbGV0IGV4dHJhY3RlZENvbnRlbnQgPSAnJztcblxuICBpZiAoY29tcGFyaXNvblJlc3VsdCA8PSAwKSB7XG4gICAgLy8g5b2T5YmN54mI5pys5aSn5LqO5oiW562J5LqO5pyA5paw54mI5pys77yM5Y+q6L+U5Zue5pyA5paw54mI5pys55qE5pel5b+XXG4gICAgY29uc3QgbGF0ZXN0VmVyc2lvbk1hdGNoID0gbWF0Y2hlcy5maW5kKG1hdGNoID0+IG1hdGNoWzFdID09PSBsYXRlc3RWZXJzaW9uKTtcbiAgICBpZiAoIWxhdGVzdFZlcnNpb25NYXRjaCkge1xuICAgICAgdG9hc3RyLmVycm9yKCfojrflj5bmm7TmlrDml6Xlv5flpLHotKUnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBzdGFydEluZGV4ID0gbGF0ZXN0VmVyc2lvbk1hdGNoLmluZGV4O1xuICAgIGNvbnN0IG5leHRWZXJzaW9uTWF0Y2ggPSBtYXRjaGVzLmZpbmQobWF0Y2ggPT4gbWF0Y2guaW5kZXggPiBzdGFydEluZGV4KTtcbiAgICBjb25zdCBlbmRJbmRleCA9IG5leHRWZXJzaW9uTWF0Y2ggPyBuZXh0VmVyc2lvbk1hdGNoLmluZGV4IDogY2hhbmdlbG9nQ29udGVudC5sZW5ndGg7XG5cbiAgICBleHRyYWN0ZWRDb250ZW50ID0gY2hhbmdlbG9nQ29udGVudC5zdWJzdHJpbmcoc3RhcnRJbmRleCwgZW5kSW5kZXgpLnRyaW0oKTtcbiAgfSBlbHNlIHtcbiAgICBjb25zdCBjdXJyZW50VmVyc2lvbk1hdGNoID0gbWF0Y2hlcy5maW5kKG1hdGNoID0+IG1hdGNoWzFdID09PSBjdXJyZW50VmVyc2lvbik7XG4gICAgaWYgKCFjdXJyZW50VmVyc2lvbk1hdGNoKSB7XG4gICAgICB0b2FzdHIuZXJyb3IoYOaXoOazleaJvuWIsOeJiOacrCAke2N1cnJlbnRWZXJzaW9ufSDnmoTml6Xlv5fjgIJgKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBsYXRlc3RWZXJzaW9uTWF0Y2ggPSBtYXRjaGVzLmZpbmQobWF0Y2ggPT4gbWF0Y2hbMV0gPT09IGxhdGVzdFZlcnNpb24pO1xuICAgIGlmICghbGF0ZXN0VmVyc2lvbk1hdGNoKSB7XG4gICAgICB0b2FzdHIuZXJyb3IoYOaXoOazleaJvuWIsOeJiOacrCAke2xhdGVzdFZlcnNpb259IOeahOaXpeW/l+OAgmApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHN0YXJ0SW5kZXggPSBjdXJyZW50VmVyc2lvbk1hdGNoLmluZGV4O1xuICAgIGNvbnN0IGVuZEluZGV4ID0gbGF0ZXN0VmVyc2lvbk1hdGNoLmluZGV4O1xuXG4gICAgZXh0cmFjdGVkQ29udGVudCA9IGNoYW5nZWxvZ0NvbnRlbnQuc3Vic3RyaW5nKHN0YXJ0SW5kZXgsIGVuZEluZGV4KS50cmltKCk7XG4gIH1cblxuICByZXR1cm4gcmVuZGVyTWFya2Rvd24oZXh0cmFjdGVkQ29udGVudCk7XG59XG5cbi8qKlxuICog5by55Ye6Y2hhbmdlTG9n55qEcG9wdXBcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZVVwZGF0ZUJ1dHRvbigpIHtcbiAgaWYgKCFDSEFOR0VMT0dfQ09OVEVOVCkge1xuICAgIGF3YWl0IGdldENoYW5nZWxvZygpO1xuICB9XG4gIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNhbGxHZW5lcmljUG9wdXAoQ0hBTkdFTE9HX0NPTlRFTlQsIFBPUFVQX1RZUEUuQ09ORklSTSwgJycsIHtcbiAgICBva0J1dHRvbjogJ+abtOaWsCcsXG4gICAgY2FuY2VsQnV0dG9uOiAn5Y+W5raIJyxcbiAgfSk7XG4gIGlmIChyZXN1bHQpIHtcbiAgICB0b2FzdHIuaW5mbygn5pu05paw5Lit4oCm4oCmJyk7XG4gICAgYXdhaXQgdXBkYXRlVGF2ZXJuSGVscGVyKCk7XG4gIH1cbn1cblxuLyoqXG4gKiDojrflj5blj5jmm7Tml6Xlv5dcbiAqIEByZXR1cm5zIOS4pOS4queJiOacrOS5i+mXtOeahOaXpeW/l+WGheWuuVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q2hhbmdlbG9nKCkge1xuICB0b2FzdHIuaW5mbygn6I635Y+W5pu05paw5pel5b+X5Lit4oCm4oCmJyk7XG4gIGNvbnN0IGNoYW5nZWxvZ0NvbnRlbnQgPSBhd2FpdCBmZXRjaFJhd0ZpbGVDb250ZW50RnJvbUdpdExhYihDSEFOR0VMT0dfRklMRV9QQVRIX0dJVExBQik7XG4gIGlmIChMQVRFU1RfVkVSU0lPTiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgTEFURVNUX1ZFUlNJT04gPSBwYXJzZVZlcnNpb25Gcm9tRmlsZShhd2FpdCBmZXRjaFJhd0ZpbGVDb250ZW50RnJvbUdpdExhYihWRVJTSU9OX0ZJTEVfUEFUSF9HSVRMQUIpKTtcbiAgfVxuXG4gIGlmIChDVVJSRU5UX1ZFUlNJT04gPT09IHVuZGVmaW5lZCkge1xuICAgIENVUlJFTlRfVkVSU0lPTiA9IHBhcnNlVmVyc2lvbkZyb21GaWxlKGF3YWl0IGdldEZpbGVDb250ZW50QnlQYXRoKFZFUlNJT05fRklMRV9QQVRIKSk7XG4gIH1cblxuICBjb25zdCBsb2dzID0gcGFyc2VDaGFuZ2Vsb2dCZXR3ZWVuVmVyc2lvbnMoY2hhbmdlbG9nQ29udGVudCwgQ1VSUkVOVF9WRVJTSU9OLCBMQVRFU1RfVkVSU0lPTik7XG4gIGlmICghbG9ncykge1xuICAgIHRvYXN0ci5lcnJvcign5peg5rOV6I635Y+W5pu05paw5pel5b+XJyk7XG4gICAgcmV0dXJuO1xuICB9IGVsc2Uge1xuICAgIENIQU5HRUxPR19DT05URU5UID0gbG9ncztcbiAgfVxufVxuXG4vKipcbiAqIOabtOaWsOmFkummhuWKqeaJi1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlVGF2ZXJuSGVscGVyKCkge1xuICBjb25zdCBleHRlbnNpb25UeXBlID0gZ2V0RXh0ZW5zaW9uVHlwZShleHRlbnNpb25OYW1lKTtcbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnL2FwaS9leHRlbnNpb25zL3VwZGF0ZScsIHtcbiAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICBoZWFkZXJzOiBnZXRSZXF1ZXN0SGVhZGVycygpLFxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgZXh0ZW5zaW9uTmFtZTogZXh0ZW5zaW9uTmFtZSwgZ2xvYmFsOiBleHRlbnNpb25UeXBlID09PSAnZ2xvYmFsJyA/IHRydWUgOiBmYWxzZSB9KSxcbiAgfSk7XG4gIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICBjb25zdCB0ZXh0ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xuICAgIHRvYXN0ci5lcnJvcih0ZXh0IHx8IHJlc3BvbnNlLnN0YXR1c1RleHQsIHRg5pu05paw6YWS6aaG5Yqp5omL5aSx6LSlYCwgeyB0aW1lT3V0OiA1MDAwIH0pO1xuICAgIGxvZy5lcnJvcihg5pu05paw6YWS6aaG5Yqp5omL5aSx6LSlOiAke3RleHR9YCk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgaWYgKGRhdGEuaXNVcFRvRGF0ZSkge1xuICAgIGxvZy5pbmZvKGDphZLppobliqnmiYvlt7LmmK/mnIDmlrDniYjmnKwsIOaXoOmcgOabtOaWsGApO1xuICB9IGVsc2Uge1xuICAgIHRvYXN0ci5zdWNjZXNzKHRg5oiQ5Yqf5pu05paw6YWS6aaG5Yqp5omL5Li6ICR7ZGF0YS5zaG9ydENvbW1pdEhhc2h9LCDlh4blpIfliLfmlrDpobXpnaLku6XnlJ/mlYguLi5gKTtcbiAgICBsb2cuaW5mbyhg5oiQ5Yqf5pu05paw6YWS6aaG5Yqp5omL5Li6ICAke2RhdGEuc2hvcnRDb21taXRIYXNofSwg5YeG5aSH5Yi35paw6aG16Z2i5Lul55Sf5pWILi4uYCk7XG4gICAgc2V0VGltZW91dCgoKSA9PiBsb2NhdGlvbi5yZWxvYWQoKSwgMzAwMCk7XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59XG5cbi8vIOmFkummhuWOn+S7o+eggeWkjeWItuadpeeahFxuLyoqXG4gKiBHZXRzIHRoZSB0eXBlIG9mIGFuIGV4dGVuc2lvbiBiYXNlZCBvbiBpdHMgZXh0ZXJuYWwgSUQuXG4gKiBAcGFyYW0ge3N0cmluZ30gZXh0ZXJuYWxJZCBFeHRlcm5hbCBJRCBvZiB0aGUgZXh0ZW5zaW9uIChleGNsdWRpbmcgb3IgaW5jbHVkaW5nIHRoZSBsZWFkaW5nICd0aGlyZC1wYXJ0eS8nKVxuICogQHJldHVybnMge3N0cmluZ30gVHlwZSBvZiB0aGUgZXh0ZW5zaW9uIChnbG9iYWwsIGxvY2FsLCBzeXN0ZW0sIG9yIGVtcHR5IHN0cmluZyBpZiBub3QgZm91bmQpXG4gKi9cbmZ1bmN0aW9uIGdldEV4dGVuc2lvblR5cGUoZXh0ZXJuYWxJZDogc3RyaW5nKSB7XG4gIGNvbnN0IGlkID0gT2JqZWN0LmtleXMoZXh0ZW5zaW9uVHlwZXMpLmZpbmQoXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXNoYWRvd1xuICAgIChpZDogc3RyaW5nKSA9PiBpZCA9PT0gZXh0ZXJuYWxJZCB8fCAoaWQuc3RhcnRzV2l0aCgndGhpcmQtcGFydHknKSAmJiBpZC5lbmRzV2l0aChleHRlcm5hbElkKSksXG4gICk7XG4gIHJldHVybiBpZCA/IGV4dGVuc2lvblR5cGVzW2lkXSA6ICdsb2NhbCc7XG59XG5cbi8vIOaXp+eJiOabtOaWsOWQjueUqFxuLyoqXG4gKlxuICovXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzaG93TmV3RmVhdHVyZSgpIHtcbiAgbGV0IGNoYW5nZWxvZ0NvbnRlbnQgPSBhd2FpdCBmZXRjaFJhd0ZpbGVDb250ZW50RnJvbUdpdExhYihDSEFOR0VMT0dfRklMRV9QQVRIX0dJVExBQik7XG4gIGNoYW5nZWxvZ0NvbnRlbnQgPSBjaGFuZ2Vsb2dDb250ZW50ICsgJ1xcblxcbirliY3nq6/liqnmiYvml6fniYjphY3nva7lt7LmuIXpmaTvvIzor7fph43mlrDphY3nva7mianlsZXorr7nva4qJztcbiAgY29uc3QgbG9ncyA9IHBhcnNlQ2hhbmdlbG9nQmV0d2VlblZlcnNpb25zKGNoYW5nZWxvZ0NvbnRlbnQsICczLjAuMCcsICczLjAuMCcpO1xuXG4gIGlmIChsb2dzKSB7XG4gICAgY29uc3QgbW9kaWZpZWRMb2dzID0gbG9ncy5yZXBsYWNlKC88aDIoW14+XSopPihbXjxdKik8XFwvaDI+L2csICc8aDIkMT7phZLppobliqnmiYsgJDI8L2gyPicpO1xuICAgIGF3YWl0IGNhbGxHZW5lcmljUG9wdXAobW9kaWZpZWRMb2dzLCBQT1BVUF9UWVBFLlRFWFQpO1xuICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/util/check_update.ts\n")},"./src/util/collapsible.ts":
/*!*********************************!*\
  !*** ./src/util/collapsible.ts ***!
  \*********************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Collapsible: () => (/* binding */ Collapsible)\n/* harmony export */ });\n/**\n * 折叠展开功能类\n */\nclass Collapsible {\n    $container;\n    $header;\n    $content;\n    options;\n    isAnimating = false;\n    /**\n     * 静态方法：初始化所有符合选择器的元素为可折叠元素\n     * @param containerSelector 容器选择器\n     * @param options 配置选项\n     * @returns Collapsible实例数组\n     */\n    static initAll(containerSelector, options = {}) {\n        const instances = [];\n        $(containerSelector).each(function () {\n            instances.push(new Collapsible($(this), options));\n        });\n        return instances;\n    }\n    /**\n     * 构造函数\n     * @param $container 容器元素\n     * @param options 配置选项\n     */\n    constructor($container, options = {}) {\n        this.$container = $container;\n        // 默认配置\n        const defaultOptions = {\n            headerSelector: '.collapsible-header',\n            contentSelector: '.collapsible-content',\n            expandedClass: 'expanded',\n            animationDuration: {\n                expand: 280,\n                collapse: 250,\n            },\n            easingFunction: 'swing',\n            initiallyExpanded: false,\n            callbacks: {},\n        };\n        // 合并配置\n        this.options = { ...defaultOptions, ...options };\n        // 获取元素\n        this.$header = this.$container.find(this.options.headerSelector);\n        this.$content = this.$container.find(this.options.contentSelector);\n        // 初始化事件\n        this.initEvents();\n        // 设置初始状态\n        if (!this.options.initiallyExpanded) {\n            this.$container.removeClass(this.options.expandedClass);\n            this.$content.hide();\n        }\n        else {\n            this.$container.addClass(this.options.expandedClass);\n            this.$content.show();\n        }\n    }\n    /**\n     * 初始化事件\n     */\n    initEvents() {\n        this.$header.on('click', (event) => {\n            // 检查点击是否发生在控件上，如果是则不触发折叠\n            if (this.shouldIgnoreClick(event.target)) {\n                return;\n            }\n            this.toggle();\n        });\n    }\n    /**\n     * 判断点击是否应该被忽略（不触发折叠）\n     * @param target 点击的目标元素\n     * @returns 是否应该忽略点击\n     */\n    shouldIgnoreClick(target) {\n        const $target = $(target);\n        // 检查是否点击在开关或其子元素上\n        if ($target.hasClass('toggle-switch') ||\n            $target.hasClass('toggle-input') ||\n            $target.hasClass('toggle-label') ||\n            $target.hasClass('toggle-handle') ||\n            $target.closest('.toggle-switch').length > 0) {\n            return true;\n        }\n        // 检查是否点击在按钮或其子元素上\n        if ($target.hasClass('menu_button') ||\n            $target.closest('.menu_button').length > 0 ||\n            $target.hasClass('TavernHelper-button') ||\n            $target.closest('.TavernHelper-button').length > 0) {\n            return true;\n        }\n        // 检查是否点击在表单元素上\n        if ($target.is('input, select, textarea, button, a') ||\n            $target.closest('input, select, textarea, button, a').length > 0) {\n            return true;\n        }\n        return false;\n    }\n    /**\n     * 切换展开/折叠状态\n     */\n    toggle() {\n        if (this.isAnimating)\n            return;\n        if (this.$container.hasClass(this.options.expandedClass)) {\n            this.collapse();\n        }\n        else {\n            this.expand();\n        }\n    }\n    /**\n     * 展开内容\n     */\n    expand() {\n        if (this.isAnimating || this.$container.hasClass(this.options.expandedClass))\n            return;\n        this.isAnimating = true;\n        // 执行展开前回调\n        if (this.options.callbacks?.beforeExpand) {\n            this.options.callbacks.beforeExpand();\n        }\n        this.$container.addClass(this.options.expandedClass);\n        this.$content.addClass('animating');\n        this.$content.slideDown({\n            duration: this.options.animationDuration.expand,\n            easing: this.options.easingFunction,\n            start: function () {\n                $(this).css({\n                    opacity: 0,\n                    transform: 'translateY(-10px) scaleY(0.95)',\n                });\n            },\n            progress: function (_animation, progress) {\n                $(this).css({\n                    opacity: progress,\n                    transform: `translateY(${-10 * (1 - progress)}px) scaleY(${0.95 + 0.05 * progress})`,\n                });\n            },\n            complete: () => {\n                this.$content\n                    .css({\n                    opacity: '',\n                    transform: '',\n                })\n                    .removeClass('animating');\n                this.isAnimating = false;\n                // 执行展开后回调\n                if (this.options.callbacks?.afterExpand) {\n                    this.options.callbacks.afterExpand();\n                }\n            },\n        });\n    }\n    /**\n     * 折叠内容\n     */\n    collapse() {\n        if (this.isAnimating || !this.$container.hasClass(this.options.expandedClass))\n            return;\n        this.isAnimating = true;\n        // 执行折叠前回调\n        if (this.options.callbacks?.beforeCollapse) {\n            this.options.callbacks.beforeCollapse();\n        }\n        this.$container.removeClass(this.options.expandedClass);\n        this.$content.addClass('animating');\n        this.$content.slideUp({\n            duration: this.options.animationDuration.collapse,\n            easing: this.options.easingFunction,\n            start: function () {\n                $(this).css({\n                    opacity: 1,\n                    transform: 'translateY(0) scaleY(1)',\n                });\n            },\n            progress: function (_animation, progress) {\n                const inverseProgress = 1 - progress;\n                $(this).css({\n                    opacity: inverseProgress,\n                    transform: `translateY(${-5 * progress}px) scaleY(${1 - 0.05 * progress})`,\n                });\n            },\n            complete: () => {\n                this.$content\n                    .css({\n                    opacity: '',\n                    transform: '',\n                })\n                    .removeClass('animating');\n                this.isAnimating = false;\n                // 执行折叠后回调\n                if (this.options.callbacks?.afterCollapse) {\n                    this.options.callbacks.afterCollapse();\n                }\n            },\n        });\n    }\n    /**\n     * 是否已展开\n     * @returns 是否已展开\n     */\n    isExpanded() {\n        return this.$container.hasClass(this.options.expandedClass);\n    }\n    /**\n     * 销毁实例，移除事件监听\n     */\n    destroy() {\n        this.$header.off('click');\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ZXIvLi9zcmMvdXRpbC9jb2xsYXBzaWJsZS50cz83OTlmIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICog5oqY5Y+g5bGV5byA6YWN572u5o6l5Y+jXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQ29sbGFwc2libGVPcHRpb25zIHtcbiAgLyoqIOinpuWPkeWZqOmAieaLqeWZqCAqL1xuICBoZWFkZXJTZWxlY3Rvcjogc3RyaW5nO1xuICAvKiog5YaF5a656YCJ5oup5ZmoICovXG4gIGNvbnRlbnRTZWxlY3Rvcjogc3RyaW5nO1xuICAvKiog5bGV5byA54q25oCB55qE57G75ZCNICovXG4gIGV4cGFuZGVkQ2xhc3M/OiBzdHJpbmc7XG4gIC8qKiDliqjnlLvmjIHnu63ml7bpl7Qo5q+r56eSKSAqL1xuICBhbmltYXRpb25EdXJhdGlvbj86IHtcbiAgICBleHBhbmQ6IG51bWJlcjtcbiAgICBjb2xsYXBzZTogbnVtYmVyO1xuICB9O1xuICAvKiog5Yqo55S757yT5Yqo5Ye95pWwICovXG4gIGVhc2luZ0Z1bmN0aW9uPzogc3RyaW5nO1xuICAvKiog5Yid5aeL54q25oCB5piv5ZCm5bGV5byAICovXG4gIGluaXRpYWxseUV4cGFuZGVkPzogYm9vbGVhbjtcbiAgLyoqIOWbnuiwg+WHveaVsCAqL1xuICBjYWxsYmFja3M/OiB7XG4gICAgYmVmb3JlRXhwYW5kPzogKCkgPT4gdm9pZDtcbiAgICBhZnRlckV4cGFuZD86ICgpID0+IHZvaWQ7XG4gICAgYmVmb3JlQ29sbGFwc2U/OiAoKSA9PiB2b2lkO1xuICAgIGFmdGVyQ29sbGFwc2U/OiAoKSA9PiB2b2lkO1xuICB9O1xufVxuXG4vKipcbiAqIOaKmOWPoOWxleW8gOWKn+iDveexu1xuICovXG5leHBvcnQgY2xhc3MgQ29sbGFwc2libGUge1xuICBwcml2YXRlICRjb250YWluZXI6IEpRdWVyeTtcbiAgcHJpdmF0ZSAkaGVhZGVyOiBKUXVlcnk7XG4gIHByaXZhdGUgJGNvbnRlbnQ6IEpRdWVyeTtcbiAgcHJpdmF0ZSBvcHRpb25zOiBDb2xsYXBzaWJsZU9wdGlvbnM7XG4gIHByaXZhdGUgaXNBbmltYXRpbmc6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAvKipcbiAgICog6Z2Z5oCB5pa55rOV77ya5Yid5aeL5YyW5omA5pyJ56ym5ZCI6YCJ5oup5Zmo55qE5YWD57Sg5Li65Y+v5oqY5Y+g5YWD57SgXG4gICAqIEBwYXJhbSBjb250YWluZXJTZWxlY3RvciDlrrnlmajpgInmi6nlmahcbiAgICogQHBhcmFtIG9wdGlvbnMg6YWN572u6YCJ6aG5XG4gICAqIEByZXR1cm5zIENvbGxhcHNpYmxl5a6e5L6L5pWw57uEXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGluaXRBbGwoY29udGFpbmVyU2VsZWN0b3I6IHN0cmluZywgb3B0aW9uczogUGFydGlhbDxDb2xsYXBzaWJsZU9wdGlvbnM+ID0ge30pOiBDb2xsYXBzaWJsZVtdIHtcbiAgICBjb25zdCBpbnN0YW5jZXM6IENvbGxhcHNpYmxlW10gPSBbXTtcbiAgICAkKGNvbnRhaW5lclNlbGVjdG9yKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIGluc3RhbmNlcy5wdXNoKG5ldyBDb2xsYXBzaWJsZSgkKHRoaXMpLCBvcHRpb25zKSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGluc3RhbmNlcztcbiAgfVxuXG4gIC8qKlxuICAgKiDmnoTpgKDlh73mlbBcbiAgICogQHBhcmFtICRjb250YWluZXIg5a655Zmo5YWD57SgXG4gICAqIEBwYXJhbSBvcHRpb25zIOmFjee9rumAiemhuVxuICAgKi9cbiAgY29uc3RydWN0b3IoJGNvbnRhaW5lcjogSlF1ZXJ5LCBvcHRpb25zOiBQYXJ0aWFsPENvbGxhcHNpYmxlT3B0aW9ucz4gPSB7fSkge1xuICAgIHRoaXMuJGNvbnRhaW5lciA9ICRjb250YWluZXI7XG5cbiAgICAvLyDpu5jorqTphY3nva5cbiAgICBjb25zdCBkZWZhdWx0T3B0aW9uczogQ29sbGFwc2libGVPcHRpb25zID0ge1xuICAgICAgaGVhZGVyU2VsZWN0b3I6ICcuY29sbGFwc2libGUtaGVhZGVyJyxcbiAgICAgIGNvbnRlbnRTZWxlY3RvcjogJy5jb2xsYXBzaWJsZS1jb250ZW50JyxcbiAgICAgIGV4cGFuZGVkQ2xhc3M6ICdleHBhbmRlZCcsXG4gICAgICBhbmltYXRpb25EdXJhdGlvbjoge1xuICAgICAgICBleHBhbmQ6IDI4MCxcbiAgICAgICAgY29sbGFwc2U6IDI1MCxcbiAgICAgIH0sXG4gICAgICBlYXNpbmdGdW5jdGlvbjogJ3N3aW5nJyxcbiAgICAgIGluaXRpYWxseUV4cGFuZGVkOiBmYWxzZSxcbiAgICAgIGNhbGxiYWNrczoge30sXG4gICAgfTtcblxuICAgIC8vIOWQiOW5tumFjee9rlxuICAgIHRoaXMub3B0aW9ucyA9IHsgLi4uZGVmYXVsdE9wdGlvbnMsIC4uLm9wdGlvbnMgfTtcblxuICAgIC8vIOiOt+WPluWFg+e0oFxuICAgIHRoaXMuJGhlYWRlciA9IHRoaXMuJGNvbnRhaW5lci5maW5kKHRoaXMub3B0aW9ucy5oZWFkZXJTZWxlY3Rvcik7XG4gICAgdGhpcy4kY29udGVudCA9IHRoaXMuJGNvbnRhaW5lci5maW5kKHRoaXMub3B0aW9ucy5jb250ZW50U2VsZWN0b3IpO1xuXG4gICAgLy8g5Yid5aeL5YyW5LqL5Lu2XG4gICAgdGhpcy5pbml0RXZlbnRzKCk7XG5cbiAgICAvLyDorr7nva7liJ3lp4vnirbmgIFcbiAgICBpZiAoIXRoaXMub3B0aW9ucy5pbml0aWFsbHlFeHBhbmRlZCkge1xuICAgICAgdGhpcy4kY29udGFpbmVyLnJlbW92ZUNsYXNzKHRoaXMub3B0aW9ucy5leHBhbmRlZENsYXNzKTtcbiAgICAgIHRoaXMuJGNvbnRlbnQuaGlkZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLiRjb250YWluZXIuYWRkQ2xhc3ModGhpcy5vcHRpb25zLmV4cGFuZGVkQ2xhc3MhKTtcbiAgICAgIHRoaXMuJGNvbnRlbnQuc2hvdygpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDliJ3lp4vljJbkuovku7ZcbiAgICovXG4gIHByaXZhdGUgaW5pdEV2ZW50cygpOiB2b2lkIHtcbiAgICB0aGlzLiRoZWFkZXIub24oJ2NsaWNrJywgKGV2ZW50OiBKUXVlcnkuQ2xpY2tFdmVudCkgPT4ge1xuICAgICAgLy8g5qOA5p+l54K55Ye75piv5ZCm5Y+R55Sf5Zyo5o6n5Lu25LiK77yM5aaC5p6c5piv5YiZ5LiN6Kem5Y+R5oqY5Y+gXG4gICAgICBpZiAodGhpcy5zaG91bGRJZ25vcmVDbGljayhldmVudC50YXJnZXQpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRoaXMudG9nZ2xlKCk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog5Yik5pat54K55Ye75piv5ZCm5bqU6K+l6KKr5b+955Wl77yI5LiN6Kem5Y+R5oqY5Y+g77yJXG4gICAqIEBwYXJhbSB0YXJnZXQg54K55Ye755qE55uu5qCH5YWD57SgXG4gICAqIEByZXR1cm5zIOaYr+WQpuW6lOivpeW/veeVpeeCueWHu1xuICAgKi9cbiAgcHJpdmF0ZSBzaG91bGRJZ25vcmVDbGljayh0YXJnZXQ6IEV2ZW50VGFyZ2V0KTogYm9vbGVhbiB7XG4gICAgY29uc3QgJHRhcmdldCA9ICQodGFyZ2V0KTtcblxuICAgIC8vIOajgOafpeaYr+WQpueCueWHu+WcqOW8gOWFs+aIluWFtuWtkOWFg+e0oOS4ilxuICAgIGlmIChcbiAgICAgICR0YXJnZXQuaGFzQ2xhc3MoJ3RvZ2dsZS1zd2l0Y2gnKSB8fFxuICAgICAgJHRhcmdldC5oYXNDbGFzcygndG9nZ2xlLWlucHV0JykgfHxcbiAgICAgICR0YXJnZXQuaGFzQ2xhc3MoJ3RvZ2dsZS1sYWJlbCcpIHx8XG4gICAgICAkdGFyZ2V0Lmhhc0NsYXNzKCd0b2dnbGUtaGFuZGxlJykgfHxcbiAgICAgICR0YXJnZXQuY2xvc2VzdCgnLnRvZ2dsZS1zd2l0Y2gnKS5sZW5ndGggPiAwXG4gICAgKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICAvLyDmo4Dmn6XmmK/lkKbngrnlh7vlnKjmjInpkq7miJblhbblrZDlhYPntKDkuIpcbiAgICBpZiAoXG4gICAgICAkdGFyZ2V0Lmhhc0NsYXNzKCdtZW51X2J1dHRvbicpIHx8XG4gICAgICAkdGFyZ2V0LmNsb3Nlc3QoJy5tZW51X2J1dHRvbicpLmxlbmd0aCA+IDAgfHxcbiAgICAgICR0YXJnZXQuaGFzQ2xhc3MoJ1RhdmVybkhlbHBlci1idXR0b24nKSB8fFxuICAgICAgJHRhcmdldC5jbG9zZXN0KCcuVGF2ZXJuSGVscGVyLWJ1dHRvbicpLmxlbmd0aCA+IDBcbiAgICApIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIC8vIOajgOafpeaYr+WQpueCueWHu+WcqOihqOWNleWFg+e0oOS4ilxuICAgIGlmIChcbiAgICAgICR0YXJnZXQuaXMoJ2lucHV0LCBzZWxlY3QsIHRleHRhcmVhLCBidXR0b24sIGEnKSB8fFxuICAgICAgJHRhcmdldC5jbG9zZXN0KCdpbnB1dCwgc2VsZWN0LCB0ZXh0YXJlYSwgYnV0dG9uLCBhJykubGVuZ3RoID4gMFxuICAgICkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgLyoqXG4gICAqIOWIh+aNouWxleW8gC/mipjlj6DnirbmgIFcbiAgICovXG4gIHB1YmxpYyB0b2dnbGUoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuaXNBbmltYXRpbmcpIHJldHVybjtcblxuICAgIGlmICh0aGlzLiRjb250YWluZXIuaGFzQ2xhc3ModGhpcy5vcHRpb25zLmV4cGFuZGVkQ2xhc3MhKSkge1xuICAgICAgdGhpcy5jb2xsYXBzZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmV4cGFuZCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDlsZXlvIDlhoXlrrlcbiAgICovXG4gIHB1YmxpYyBleHBhbmQoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuaXNBbmltYXRpbmcgfHwgdGhpcy4kY29udGFpbmVyLmhhc0NsYXNzKHRoaXMub3B0aW9ucy5leHBhbmRlZENsYXNzISkpIHJldHVybjtcblxuICAgIHRoaXMuaXNBbmltYXRpbmcgPSB0cnVlO1xuXG4gICAgLy8g5omn6KGM5bGV5byA5YmN5Zue6LCDXG4gICAgaWYgKHRoaXMub3B0aW9ucy5jYWxsYmFja3M/LmJlZm9yZUV4cGFuZCkge1xuICAgICAgdGhpcy5vcHRpb25zLmNhbGxiYWNrcy5iZWZvcmVFeHBhbmQoKTtcbiAgICB9XG5cbiAgICB0aGlzLiRjb250YWluZXIuYWRkQ2xhc3ModGhpcy5vcHRpb25zLmV4cGFuZGVkQ2xhc3MhKTtcbiAgICB0aGlzLiRjb250ZW50LmFkZENsYXNzKCdhbmltYXRpbmcnKTtcblxuICAgIHRoaXMuJGNvbnRlbnQuc2xpZGVEb3duKHtcbiAgICAgIGR1cmF0aW9uOiB0aGlzLm9wdGlvbnMuYW5pbWF0aW9uRHVyYXRpb24hLmV4cGFuZCxcbiAgICAgIGVhc2luZzogdGhpcy5vcHRpb25zLmVhc2luZ0Z1bmN0aW9uLFxuICAgICAgc3RhcnQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJCh0aGlzKS5jc3Moe1xuICAgICAgICAgIG9wYWNpdHk6IDAsXG4gICAgICAgICAgdHJhbnNmb3JtOiAndHJhbnNsYXRlWSgtMTBweCkgc2NhbGVZKDAuOTUpJyxcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgcHJvZ3Jlc3M6IGZ1bmN0aW9uIChfYW5pbWF0aW9uLCBwcm9ncmVzcykge1xuICAgICAgICAkKHRoaXMpLmNzcyh7XG4gICAgICAgICAgb3BhY2l0eTogcHJvZ3Jlc3MsXG4gICAgICAgICAgdHJhbnNmb3JtOiBgdHJhbnNsYXRlWSgkey0xMCAqICgxIC0gcHJvZ3Jlc3MpfXB4KSBzY2FsZVkoJHswLjk1ICsgMC4wNSAqIHByb2dyZXNzfSlgLFxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBjb21wbGV0ZTogKCkgPT4ge1xuICAgICAgICB0aGlzLiRjb250ZW50XG4gICAgICAgICAgLmNzcyh7XG4gICAgICAgICAgICBvcGFjaXR5OiAnJyxcbiAgICAgICAgICAgIHRyYW5zZm9ybTogJycsXG4gICAgICAgICAgfSlcbiAgICAgICAgICAucmVtb3ZlQ2xhc3MoJ2FuaW1hdGluZycpO1xuXG4gICAgICAgIHRoaXMuaXNBbmltYXRpbmcgPSBmYWxzZTtcblxuICAgICAgICAvLyDmiafooYzlsZXlvIDlkI7lm57osINcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5jYWxsYmFja3M/LmFmdGVyRXhwYW5kKSB7XG4gICAgICAgICAgdGhpcy5vcHRpb25zLmNhbGxiYWNrcy5hZnRlckV4cGFuZCgpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIOaKmOWPoOWGheWuuVxuICAgKi9cbiAgcHVibGljIGNvbGxhcHNlKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmlzQW5pbWF0aW5nIHx8ICF0aGlzLiRjb250YWluZXIuaGFzQ2xhc3ModGhpcy5vcHRpb25zLmV4cGFuZGVkQ2xhc3MhKSkgcmV0dXJuO1xuXG4gICAgdGhpcy5pc0FuaW1hdGluZyA9IHRydWU7XG5cbiAgICAvLyDmiafooYzmipjlj6DliY3lm57osINcbiAgICBpZiAodGhpcy5vcHRpb25zLmNhbGxiYWNrcz8uYmVmb3JlQ29sbGFwc2UpIHtcbiAgICAgIHRoaXMub3B0aW9ucy5jYWxsYmFja3MuYmVmb3JlQ29sbGFwc2UoKTtcbiAgICB9XG5cbiAgICB0aGlzLiRjb250YWluZXIucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLmV4cGFuZGVkQ2xhc3MhKTtcbiAgICB0aGlzLiRjb250ZW50LmFkZENsYXNzKCdhbmltYXRpbmcnKTtcblxuICAgIHRoaXMuJGNvbnRlbnQuc2xpZGVVcCh7XG4gICAgICBkdXJhdGlvbjogdGhpcy5vcHRpb25zLmFuaW1hdGlvbkR1cmF0aW9uIS5jb2xsYXBzZSxcbiAgICAgIGVhc2luZzogdGhpcy5vcHRpb25zLmVhc2luZ0Z1bmN0aW9uLFxuICAgICAgc3RhcnQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJCh0aGlzKS5jc3Moe1xuICAgICAgICAgIG9wYWNpdHk6IDEsXG4gICAgICAgICAgdHJhbnNmb3JtOiAndHJhbnNsYXRlWSgwKSBzY2FsZVkoMSknLFxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBwcm9ncmVzczogZnVuY3Rpb24gKF9hbmltYXRpb24sIHByb2dyZXNzKSB7XG4gICAgICAgIGNvbnN0IGludmVyc2VQcm9ncmVzcyA9IDEgLSBwcm9ncmVzcztcbiAgICAgICAgJCh0aGlzKS5jc3Moe1xuICAgICAgICAgIG9wYWNpdHk6IGludmVyc2VQcm9ncmVzcyxcbiAgICAgICAgICB0cmFuc2Zvcm06IGB0cmFuc2xhdGVZKCR7LTUgKiBwcm9ncmVzc31weCkgc2NhbGVZKCR7MSAtIDAuMDUgKiBwcm9ncmVzc30pYCxcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgY29tcGxldGU6ICgpID0+IHtcbiAgICAgICAgdGhpcy4kY29udGVudFxuICAgICAgICAgIC5jc3Moe1xuICAgICAgICAgICAgb3BhY2l0eTogJycsXG4gICAgICAgICAgICB0cmFuc2Zvcm06ICcnLFxuICAgICAgICAgIH0pXG4gICAgICAgICAgLnJlbW92ZUNsYXNzKCdhbmltYXRpbmcnKTtcblxuICAgICAgICB0aGlzLmlzQW5pbWF0aW5nID0gZmFsc2U7XG5cbiAgICAgICAgLy8g5omn6KGM5oqY5Y+g5ZCO5Zue6LCDXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuY2FsbGJhY2tzPy5hZnRlckNvbGxhcHNlKSB7XG4gICAgICAgICAgdGhpcy5vcHRpb25zLmNhbGxiYWNrcy5hZnRlckNvbGxhcHNlKCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICog5piv5ZCm5bey5bGV5byAXG4gICAqIEByZXR1cm5zIOaYr+WQpuW3suWxleW8gFxuICAgKi9cbiAgcHVibGljIGlzRXhwYW5kZWQoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuJGNvbnRhaW5lci5oYXNDbGFzcyh0aGlzLm9wdGlvbnMuZXhwYW5kZWRDbGFzcyEpO1xuICB9XG5cbiAgLyoqXG4gICAqIOmUgOavgeWunuS+i++8jOenu+mZpOS6i+S7tuebkeWQrFxuICAgKi9cbiAgcHVibGljIGRlc3Ryb3koKTogdm9pZCB7XG4gICAgdGhpcy4kaGVhZGVyLm9mZignY2xpY2snKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/util/collapsible.ts\n")},"./src/util/extension_variables.ts":
/*!*****************************************!*\
  !*** ./src/util/extension_variables.ts ***!
  \*****************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   charsPath: () => (/* binding */ charsPath),\n/* harmony export */   extensionFolderPath: () => (/* binding */ extensionFolderPath),\n/* harmony export */   extensionName: () => (/* binding */ extensionName),\n/* harmony export */   extensionSettingName: () => (/* binding */ extensionSettingName),\n/* harmony export */   getCharAvatarPath: () => (/* binding */ getCharAvatarPath),\n/* harmony export */   getOrSaveSettingValue: () => (/* binding */ getOrSaveSettingValue),\n/* harmony export */   getSettingValue: () => (/* binding */ getSettingValue),\n/* harmony export */   getUserAvatarPath: () => (/* binding */ getUserAvatarPath),\n/* harmony export */   saveSettingValue: () => (/* binding */ saveSettingValue)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ \"@sillytavern/script\");\n/* harmony import */ var _sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sillytavern/scripts/extensions */ \"@sillytavern/scripts/extensions\");\n// TODO: 为设置变量添加类型而非使用 any\n\n\nconst extensionName = 'JS-Slash-Runner';\nconst extensionSettingName = 'TavernHelper';\nconst extensionFolderPath = `third-party/${extensionName}`;\n// 获取头像原图\nconst charsPath = '/characters/';\nconst getUserAvatarPath = () => `./User Avatars/${_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.user_avatar}`;\nconst getCharAvatarPath = () => {\n    //@ts-ignore\n    const thumbnailPath = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.getThumbnailUrl)('avatar', _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.characters[_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.this_chid].avatar);\n    const targetAvatarImg = thumbnailPath.substring(thumbnailPath.lastIndexOf('=') + 1);\n    return charsPath + targetAvatarImg;\n};\n/**\n * 获取扩展设置变量的值\n *\n * @param path 设置变量的键\n * @param default_value 没有该键时的默认值\n * @returns 设置变量的值\n */\nfunction getSettingValue(path, default_value = undefined) {\n    // @ts-ignore\n    return _.get(_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__.extension_settings[extensionSettingName], path, default_value);\n}\n/**\n * 保存扩展设置变量的值\n *\n * @param path 设置变量的键\n * @param value 设置变量的值\n * @returns 设置变量的值\n */\nfunction saveSettingValue(path, value) {\n    // @ts-ignore\n    _.set(_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__.extension_settings[extensionSettingName], path, value);\n    (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.saveSettingsDebounced)();\n    return value;\n}\n/**\n * 如果扩展有某设置变量，则返回该设置变量的值，否则设置该设置变量的值为 `default_value`\n *\n * @param path 设置变量的键\n * @param default_value 扩展没有该设置变量时应该设置并返回的默认值\n * @returns 设置变量的值\n */\nasync function getOrSaveSettingValue(path, default_value) {\n    // @ts-ignore\n    if (_.has(_sillytavern_scripts_extensions__WEBPACK_IMPORTED_MODULE_1__.extension_settings[extensionSettingName], path)) {\n        return getSettingValue(path);\n    }\n    return saveSettingValue(path, default_value);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvdXRpbC9leHRlbnNpb25fdmFyaWFibGVzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQUEsMEJBQTBCO0FBQ3VGO0FBQzVDO0FBRTlELE1BQU0sYUFBYSxHQUFHLGlCQUFpQixDQUFDO0FBQ3hDLE1BQU0sb0JBQW9CLEdBQUcsY0FBYyxDQUFDO0FBRTVDLE1BQU0sbUJBQW1CLEdBQUcsZUFBZSxhQUFhLEVBQUUsQ0FBQztBQUVsRSxTQUFTO0FBQ0YsTUFBTSxTQUFTLEdBQUcsY0FBYyxDQUFDO0FBQ2pDLE1BQU0saUJBQWlCLEdBQUcsR0FBRyxFQUFFLENBQUMsa0JBQWtCLDREQUFXLEVBQUUsQ0FBQztBQUNoRSxNQUFNLGlCQUFpQixHQUFHLEdBQUcsRUFBRTtJQUNwQyxZQUFZO0lBQ1osTUFBTSxhQUFhLEdBQUcsb0VBQWUsQ0FBQyxRQUFRLEVBQUUsMkRBQVUsQ0FBQywwREFBUyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDOUUsTUFBTSxlQUFlLEdBQUcsYUFBYSxDQUFDLFNBQVMsQ0FBQyxhQUFhLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO0lBQ3BGLE9BQU8sU0FBUyxHQUFHLGVBQWUsQ0FBQztBQUNyQyxDQUFDLENBQUM7QUFFRjs7Ozs7O0dBTUc7QUFDSSxTQUFTLGVBQWUsQ0FBQyxJQUFZLEVBQUUsZ0JBQXFCLFNBQVM7SUFDMUUsYUFBYTtJQUNiLE9BQU8sQ0FBQyxDQUFDLEdBQUcsQ0FBQywrRUFBa0IsQ0FBQyxvQkFBb0IsQ0FBQyxFQUFFLElBQUksRUFBRSxhQUFhLENBQUMsQ0FBQztBQUM5RSxDQUFDO0FBRUQ7Ozs7OztHQU1HO0FBQ0ksU0FBUyxnQkFBZ0IsQ0FBSSxJQUFZLEVBQUUsS0FBUTtJQUN4RCxhQUFhO0lBQ2IsQ0FBQyxDQUFDLEdBQUcsQ0FBQywrRUFBa0IsQ0FBQyxvQkFBb0IsQ0FBQyxFQUFFLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQztJQUM3RCwwRUFBcUIsRUFBRSxDQUFDO0lBQ3hCLE9BQU8sS0FBSyxDQUFDO0FBQ2YsQ0FBQztBQUVEOzs7Ozs7R0FNRztBQUNJLEtBQUssVUFBVSxxQkFBcUIsQ0FBSSxJQUFZLEVBQUUsYUFBZ0I7SUFDM0UsYUFBYTtJQUNiLElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBQywrRUFBa0IsQ0FBQyxvQkFBb0IsQ0FBQyxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUM7UUFDMUQsT0FBTyxlQUFlLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDL0IsQ0FBQztJQUNELE9BQU8sZ0JBQWdCLENBQUMsSUFBSSxFQUFFLGFBQWEsQ0FBQyxDQUFDO0FBQy9DLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KUy1TbGFzaC1SdW5uZXIvLi9zcmMvdXRpbC9leHRlbnNpb25fdmFyaWFibGVzLnRzP2I4MTEiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVE9ETzog5Li66K6+572u5Y+Y6YeP5re75Yqg57G75Z6L6ICM6Z2e5L2/55SoIGFueVxuaW1wb3J0IHsgY2hhcmFjdGVycywgZ2V0VGh1bWJuYWlsVXJsLCBzYXZlU2V0dGluZ3NEZWJvdW5jZWQsIHRoaXNfY2hpZCwgdXNlcl9hdmF0YXIgfSBmcm9tICdAc2lsbHl0YXZlcm4vc2NyaXB0JztcbmltcG9ydCB7IGV4dGVuc2lvbl9zZXR0aW5ncyB9IGZyb20gJ0BzaWxseXRhdmVybi9zY3JpcHRzL2V4dGVuc2lvbnMnO1xuXG5leHBvcnQgY29uc3QgZXh0ZW5zaW9uTmFtZSA9ICdKUy1TbGFzaC1SdW5uZXInO1xuZXhwb3J0IGNvbnN0IGV4dGVuc2lvblNldHRpbmdOYW1lID0gJ1RhdmVybkhlbHBlcic7XG5cbmV4cG9ydCBjb25zdCBleHRlbnNpb25Gb2xkZXJQYXRoID0gYHRoaXJkLXBhcnR5LyR7ZXh0ZW5zaW9uTmFtZX1gO1xuXG4vLyDojrflj5blpLTlg4/ljp/lm75cbmV4cG9ydCBjb25zdCBjaGFyc1BhdGggPSAnL2NoYXJhY3RlcnMvJztcbmV4cG9ydCBjb25zdCBnZXRVc2VyQXZhdGFyUGF0aCA9ICgpID0+IGAuL1VzZXIgQXZhdGFycy8ke3VzZXJfYXZhdGFyfWA7XG5leHBvcnQgY29uc3QgZ2V0Q2hhckF2YXRhclBhdGggPSAoKSA9PiB7XG4gIC8vQHRzLWlnbm9yZVxuICBjb25zdCB0aHVtYm5haWxQYXRoID0gZ2V0VGh1bWJuYWlsVXJsKCdhdmF0YXInLCBjaGFyYWN0ZXJzW3RoaXNfY2hpZF0uYXZhdGFyKTtcbiAgY29uc3QgdGFyZ2V0QXZhdGFySW1nID0gdGh1bWJuYWlsUGF0aC5zdWJzdHJpbmcodGh1bWJuYWlsUGF0aC5sYXN0SW5kZXhPZignPScpICsgMSk7XG4gIHJldHVybiBjaGFyc1BhdGggKyB0YXJnZXRBdmF0YXJJbWc7XG59O1xuXG4vKipcbiAqIOiOt+WPluaJqeWxleiuvue9ruWPmOmHj+eahOWAvFxuICpcbiAqIEBwYXJhbSBwYXRoIOiuvue9ruWPmOmHj+eahOmUrlxuICogQHBhcmFtIGRlZmF1bHRfdmFsdWUg5rKh5pyJ6K+l6ZSu5pe255qE6buY6K6k5YC8XG4gKiBAcmV0dXJucyDorr7nva7lj5jph4/nmoTlgLxcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFNldHRpbmdWYWx1ZShwYXRoOiBzdHJpbmcsIGRlZmF1bHRfdmFsdWU6IGFueSA9IHVuZGVmaW5lZCk6IGFueSB7XG4gIC8vIEB0cy1pZ25vcmVcbiAgcmV0dXJuIF8uZ2V0KGV4dGVuc2lvbl9zZXR0aW5nc1tleHRlbnNpb25TZXR0aW5nTmFtZV0sIHBhdGgsIGRlZmF1bHRfdmFsdWUpO1xufVxuXG4vKipcbiAqIOS/neWtmOaJqeWxleiuvue9ruWPmOmHj+eahOWAvFxuICpcbiAqIEBwYXJhbSBwYXRoIOiuvue9ruWPmOmHj+eahOmUrlxuICogQHBhcmFtIHZhbHVlIOiuvue9ruWPmOmHj+eahOWAvFxuICogQHJldHVybnMg6K6+572u5Y+Y6YeP55qE5YC8XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzYXZlU2V0dGluZ1ZhbHVlPFQ+KHBhdGg6IHN0cmluZywgdmFsdWU6IFQpOiBUIHtcbiAgLy8gQHRzLWlnbm9yZVxuICBfLnNldChleHRlbnNpb25fc2V0dGluZ3NbZXh0ZW5zaW9uU2V0dGluZ05hbWVdLCBwYXRoLCB2YWx1ZSk7XG4gIHNhdmVTZXR0aW5nc0RlYm91bmNlZCgpO1xuICByZXR1cm4gdmFsdWU7XG59XG5cbi8qKlxuICog5aaC5p6c5omp5bGV5pyJ5p+Q6K6+572u5Y+Y6YeP77yM5YiZ6L+U5Zue6K+l6K6+572u5Y+Y6YeP55qE5YC877yM5ZCm5YiZ6K6+572u6K+l6K6+572u5Y+Y6YeP55qE5YC85Li6IGBkZWZhdWx0X3ZhbHVlYFxuICpcbiAqIEBwYXJhbSBwYXRoIOiuvue9ruWPmOmHj+eahOmUrlxuICogQHBhcmFtIGRlZmF1bHRfdmFsdWUg5omp5bGV5rKh5pyJ6K+l6K6+572u5Y+Y6YeP5pe25bqU6K+l6K6+572u5bm26L+U5Zue55qE6buY6K6k5YC8XG4gKiBAcmV0dXJucyDorr7nva7lj5jph4/nmoTlgLxcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldE9yU2F2ZVNldHRpbmdWYWx1ZTxUPihwYXRoOiBzdHJpbmcsIGRlZmF1bHRfdmFsdWU6IFQpOiBQcm9taXNlPFQ+IHtcbiAgLy8gQHRzLWlnbm9yZVxuICBpZiAoXy5oYXMoZXh0ZW5zaW9uX3NldHRpbmdzW2V4dGVuc2lvblNldHRpbmdOYW1lXSwgcGF0aCkpIHtcbiAgICByZXR1cm4gZ2V0U2V0dGluZ1ZhbHVlKHBhdGgpO1xuICB9XG4gIHJldHVybiBzYXZlU2V0dGluZ1ZhbHVlKHBhdGgsIGRlZmF1bHRfdmFsdWUpO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/util/extension_variables.ts\n")},"./src/util/map_util.ts":
/*!******************************!*\
  !*** ./src/util/map_util.ts ***!
  \******************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   extract: () => (/* binding */ extract),\n/* harmony export */   get_or_set: () => (/* binding */ get_or_set),\n/* harmony export */   try_set: () => (/* binding */ try_set)\n/* harmony export */ });\nfunction try_set(map, key, value) {\n    if (map.has(key)) {\n        return false;\n    }\n    map.set(key, value);\n    return true;\n}\nfunction get_or_set(map, key, defaulter) {\n    const existing_value = map.get(key);\n    if (existing_value) {\n        return existing_value;\n    }\n    const default_value = defaulter();\n    map.set(key, default_value);\n    return default_value;\n}\nfunction extract(map, key) {\n    const value = map.get(key);\n    if (!value) {\n        return undefined;\n    }\n    map.delete(key);\n    return value;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvdXRpbC9tYXBfdXRpbC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBTyxTQUFTLE9BQU8sQ0FBTyxHQUFjLEVBQUUsR0FBTSxFQUFFLEtBQVE7SUFDNUQsSUFBSSxHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUM7UUFDakIsT0FBTyxLQUFLLENBQUM7SUFDZixDQUFDO0lBQ0QsR0FBRyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsS0FBSyxDQUFDLENBQUM7SUFDcEIsT0FBTyxJQUFJLENBQUM7QUFDZCxDQUFDO0FBRU0sU0FBUyxVQUFVLENBQU8sR0FBYyxFQUFFLEdBQU0sRUFBRSxTQUFrQjtJQUN6RSxNQUFNLGNBQWMsR0FBRyxHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ3BDLElBQUksY0FBYyxFQUFFLENBQUM7UUFDbkIsT0FBTyxjQUFjLENBQUM7SUFDeEIsQ0FBQztJQUNELE1BQU0sYUFBYSxHQUFHLFNBQVMsRUFBRSxDQUFDO0lBQ2xDLEdBQUcsQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLGFBQWEsQ0FBQyxDQUFDO0lBQzVCLE9BQU8sYUFBYSxDQUFDO0FBQ3ZCLENBQUM7QUFFTSxTQUFTLE9BQU8sQ0FBTyxHQUFjLEVBQUUsR0FBTTtJQUNsRCxNQUFNLEtBQUssR0FBRyxHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQzNCLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUNYLE9BQU8sU0FBUyxDQUFDO0lBQ25CLENBQUM7SUFDRCxHQUFHLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ2hCLE9BQU8sS0FBSyxDQUFDO0FBQ2YsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy91dGlsL21hcF91dGlsLnRzPzQ5NmUiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGZ1bmN0aW9uIHRyeV9zZXQ8SywgVj4obWFwOiBNYXA8SywgVj4sIGtleTogSywgdmFsdWU6IFYpOiBib29sZWFuIHtcbiAgaWYgKG1hcC5oYXMoa2V5KSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBtYXAuc2V0KGtleSwgdmFsdWUpO1xuICByZXR1cm4gdHJ1ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldF9vcl9zZXQ8SywgVj4obWFwOiBNYXA8SywgVj4sIGtleTogSywgZGVmYXVsdGVyOiAoKSA9PiBWKTogViB7XG4gIGNvbnN0IGV4aXN0aW5nX3ZhbHVlID0gbWFwLmdldChrZXkpO1xuICBpZiAoZXhpc3RpbmdfdmFsdWUpIHtcbiAgICByZXR1cm4gZXhpc3RpbmdfdmFsdWU7XG4gIH1cbiAgY29uc3QgZGVmYXVsdF92YWx1ZSA9IGRlZmF1bHRlcigpO1xuICBtYXAuc2V0KGtleSwgZGVmYXVsdF92YWx1ZSk7XG4gIHJldHVybiBkZWZhdWx0X3ZhbHVlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZXh0cmFjdDxLLCBWPihtYXA6IE1hcDxLLCBWPiwga2V5OiBLKTogViB8IHVuZGVmaW5lZCB7XG4gIGNvbnN0IHZhbHVlID0gbWFwLmdldChrZXkpO1xuICBpZiAoIXZhbHVlKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuICBtYXAuZGVsZXRlKGtleSk7XG4gIHJldHVybiB2YWx1ZTtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/util/map_util.ts\n")},"./src/util/render_markdown.ts":
/*!*************************************!*\
  !*** ./src/util/render_markdown.ts ***!
  \*************************************/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   renderMarkdown: () => (/* binding */ renderMarkdown)\n/* harmony export */ });\n/* harmony import */ var _sillytavern_script__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @sillytavern/script */ "@sillytavern/script");\n\nfunction renderMarkdown(markdown) {\n    const converter = (0,_sillytavern_script__WEBPACK_IMPORTED_MODULE_0__.reloadMarkdownProcessor)();\n    let htmlText = converter.makeHtml(markdown);\n    htmlText = `<div style="text-align: left; max-height:80dvh; overflow-y: auto;">${htmlText}</div>`;\n    return htmlText;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvdXRpbC9yZW5kZXJfbWFya2Rvd24udHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBOEQ7QUFFdkQsU0FBUyxjQUFjLENBQUMsUUFBZ0I7SUFDN0MsTUFBTSxTQUFTLEdBQUcsNEVBQXVCLEVBQUUsQ0FBQztJQUM1QyxJQUFJLFFBQVEsR0FBRyxTQUFTLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQzVDLFFBQVEsR0FBRyxzRUFBc0UsUUFBUSxRQUFRLENBQUM7SUFDbEcsT0FBTyxRQUFRLENBQUM7QUFDbEIsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL0pTLVNsYXNoLVJ1bm5lci8uL3NyYy91dGlsL3JlbmRlcl9tYXJrZG93bi50cz9mOGJhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHJlbG9hZE1hcmtkb3duUHJvY2Vzc29yIH0gZnJvbSAnQHNpbGx5dGF2ZXJuL3NjcmlwdCc7XG5cbmV4cG9ydCBmdW5jdGlvbiByZW5kZXJNYXJrZG93bihtYXJrZG93bjogc3RyaW5nKSB7XG4gIGNvbnN0IGNvbnZlcnRlciA9IHJlbG9hZE1hcmtkb3duUHJvY2Vzc29yKCk7XG4gIGxldCBodG1sVGV4dCA9IGNvbnZlcnRlci5tYWtlSHRtbChtYXJrZG93bik7XG4gIGh0bWxUZXh0ID0gYDxkaXYgc3R5bGU9XCJ0ZXh0LWFsaWduOiBsZWZ0OyBtYXgtaGVpZ2h0OjgwZHZoOyBvdmVyZmxvdy15OiBhdXRvO1wiPiR7aHRtbFRleHR9PC9kaXY+YDtcbiAgcmV0dXJuIGh0bWxUZXh0O1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/util/render_markdown.ts\n')},"@sillytavern/lib/jszip.min.js":
/*!**************************************************!*\
  !*** external "../../../../../lib/jszip.min.js" ***!
  \**************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__lib_jszip_min_js_715b4132__},"@sillytavern/script":
/*!*******************************************!*\
  !*** external "../../../../../script.js" ***!
  \*******************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__script_js_588e7203__},"@sillytavern/scripts/PromptManager":
/*!**********************************************************!*\
  !*** external "../../../../../scripts/PromptManager.js" ***!
  \**********************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_PromptManager_js_3415be00__},"@sillytavern/scripts/RossAscends-mods":
/*!*************************************************************!*\
  !*** external "../../../../../scripts/RossAscends-mods.js" ***!
  \*************************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_RossAscends_mods_js_224b6398__},"@sillytavern/scripts/authors-note":
/*!*********************************************************!*\
  !*** external "../../../../../scripts/authors-note.js" ***!
  \*********************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_authors_note_js_60883899__},"@sillytavern/scripts/extensions":
/*!*******************************************************!*\
  !*** external "../../../../../scripts/extensions.js" ***!
  \*******************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_extensions_js_86ff8498__},"@sillytavern/scripts/extensions/regex/engine":
/*!********************************************************************!*\
  !*** external "../../../../../scripts/extensions/regex/engine.js" ***!
  \********************************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_extensions_regex_engine_js_bce0a3be__},"@sillytavern/scripts/group-chats":
/*!********************************************************!*\
  !*** external "../../../../../scripts/group-chats.js" ***!
  \********************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_group_chats_js_79178f54__},"@sillytavern/scripts/i18n":
/*!*************************************************!*\
  !*** external "../../../../../scripts/i18n.js" ***!
  \*************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_i18n_js_b4bbac2e__},"@sillytavern/scripts/macros":
/*!***************************************************!*\
  !*** external "../../../../../scripts/macros.js" ***!
  \***************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_macros_js_3c1c7442__},"@sillytavern/scripts/openai":
/*!***************************************************!*\
  !*** external "../../../../../scripts/openai.js" ***!
  \***************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_openai_js_991751fb__},"@sillytavern/scripts/popup":
/*!**************************************************!*\
  !*** external "../../../../../scripts/popup.js" ***!
  \**************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_popup_js_d782a329__},"@sillytavern/scripts/power-user":
/*!*******************************************************!*\
  !*** external "../../../../../scripts/power-user.js" ***!
  \*******************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_power_user_js_8eb57d1d__},"@sillytavern/scripts/slash-commands":
/*!***********************************************************!*\
  !*** external "../../../../../scripts/slash-commands.js" ***!
  \***********************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_js_aacea5c1__},"@sillytavern/scripts/slash-commands/SlashCommand":
/*!************************************************************************!*\
  !*** external "../../../../../scripts/slash-commands/SlashCommand.js" ***!
  \************************************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_SlashCommand_js_7714abe5__},"@sillytavern/scripts/slash-commands/SlashCommandArgument":
/*!********************************************************************************!*\
  !*** external "../../../../../scripts/slash-commands/SlashCommandArgument.js" ***!
  \********************************************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_SlashCommandArgument_js_9ae1817d__},"@sillytavern/scripts/slash-commands/SlashCommandCommonEnumsProvider":
/*!*******************************************************************************************!*\
  !*** external "../../../../../scripts/slash-commands/SlashCommandCommonEnumsProvider.js" ***!
  \*******************************************************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_SlashCommandCommonEnumsProvider_js_56229d14__},"@sillytavern/scripts/slash-commands/SlashCommandEnumValue":
/*!*********************************************************************************!*\
  !*** external "../../../../../scripts/slash-commands/SlashCommandEnumValue.js" ***!
  \*********************************************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_SlashCommandEnumValue_js_4a448917__},"@sillytavern/scripts/slash-commands/SlashCommandParser":
/*!******************************************************************************!*\
  !*** external "../../../../../scripts/slash-commands/SlashCommandParser.js" ***!
  \******************************************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_slash_commands_SlashCommandParser_js_585e5f4d__},"@sillytavern/scripts/utils":
/*!**************************************************!*\
  !*** external "../../../../../scripts/utils.js" ***!
  \**************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_utils_js_ee651b62__},"@sillytavern/scripts/world-info":
/*!*******************************************************!*\
  !*** external "../../../../../scripts/world-info.js" ***!
  \*******************************************************/Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE__scripts_world_info_js_1b945dbf__}},__webpack_module_cache__={},installedChunks,installChunk;function __webpack_require__(Q){var F=__webpack_module_cache__[Q];if(void 0!==F)return F.exports;var U=__webpack_module_cache__[Q]={exports:{}};return __webpack_modules__[Q].call(U.exports,U,U.exports,__webpack_require__),U.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.n=Q=>{var F=Q&&Q.__esModule?()=>Q.default:()=>Q;return __webpack_require__.d(F,{a:F}),F},__webpack_require__.d=(Q,F)=>{for(var U in F)__webpack_require__.o(F,U)&&!__webpack_require__.o(Q,U)&&Object.defineProperty(Q,U,{enumerable:!0,get:F[U]})},__webpack_require__.f={},__webpack_require__.e=Q=>Promise.all(Object.keys(__webpack_require__.f).reduce(((F,U)=>(__webpack_require__.f[U](Q,F),F)),[])),__webpack_require__.u=Q=>Q+".9518357a096bb4184347.chunk.js",__webpack_require__.o=(Q,F)=>Object.prototype.hasOwnProperty.call(Q,F),__webpack_require__.r=Q=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(Q,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(Q,"__esModule",{value:!0})},installedChunks={main:0},installChunk=Q=>{var F,U,B=Q.__webpack_ids__,n=Q.__webpack_modules__,s=Q.__webpack_runtime__,e=0;for(F in n)__webpack_require__.o(n,F)&&(__webpack_require__.m[F]=n[F]);for(s&&s(__webpack_require__);e<B.length;e++)U=B[e],__webpack_require__.o(installedChunks,U)&&installedChunks[U]&&installedChunks[U][0](),installedChunks[B[e]]=0},__webpack_require__.f.j=(Q,F)=>{var U=__webpack_require__.o(installedChunks,Q)?installedChunks[Q]:void 0;if(0!==U)if(U)F.push(U[1]);else{var B=import("./"+__webpack_require__.u(Q)).then(installChunk,(F=>{throw 0!==installedChunks[Q]&&(installedChunks[Q]=void 0),F}));B=Promise.race([B,new Promise((F=>U=installedChunks[Q]=[F]))]),F.push(U[1]=B)}};var __webpack_exports__=__webpack_require__("./src/index.ts");